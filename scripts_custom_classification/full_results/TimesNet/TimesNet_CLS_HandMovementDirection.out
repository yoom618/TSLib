Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm128_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 46.10787773132324
Epoch: 1, Steps: 10 | Train Loss: 1.461 Vali Loss: 1.441 Vali Acc: 0.230 Test Loss: 1.441 Test Acc: 0.230
Validation loss decreased (inf --> -0.229715).  Saving model ...
Epoch: 2 cost time: 46.74267768859863
Epoch: 2, Steps: 10 | Train Loss: 1.031 Vali Loss: 1.221 Vali Acc: 0.473 Test Loss: 1.221 Test Acc: 0.473
Validation loss decreased (-0.229715 --> -0.472961).  Saving model ...
Epoch: 3 cost time: 47.44464612007141
Epoch: 3, Steps: 10 | Train Loss: 0.507 Vali Loss: 1.378 Vali Acc: 0.459 Test Loss: 1.378 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 52.06749129295349
Epoch: 4, Steps: 10 | Train Loss: 0.223 Vali Loss: 1.178 Vali Acc: 0.473 Test Loss: 1.178 Test Acc: 0.473
Validation loss decreased (-0.472961 --> -0.472961).  Saving model ...
Epoch: 5 cost time: 50.80031371116638
Epoch: 5, Steps: 10 | Train Loss: 0.075 Vali Loss: 1.122 Vali Acc: 0.514 Test Loss: 1.122 Test Acc: 0.514
Validation loss decreased (-0.472961 --> -0.513502).  Saving model ...
Epoch: 6 cost time: 47.88710856437683
Epoch: 6, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.236 Vali Acc: 0.514 Test Loss: 1.236 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 47.85280680656433
Epoch: 7, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.285 Vali Acc: 0.581 Test Loss: 1.285 Test Acc: 0.581
Validation loss decreased (-0.513502 --> -0.581068).  Saving model ...
Epoch: 8 cost time: 48.0516095161438
Epoch: 8, Steps: 10 | Train Loss: 0.069 Vali Loss: 1.196 Vali Acc: 0.608 Test Loss: 1.196 Test Acc: 0.608
Validation loss decreased (-0.581068 --> -0.608096).  Saving model ...
Epoch: 9 cost time: 48.57455801963806
Epoch: 9, Steps: 10 | Train Loss: 0.046 Vali Loss: 1.502 Vali Acc: 0.554 Test Loss: 1.502 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 48.15304183959961
Epoch: 10, Steps: 10 | Train Loss: 0.041 Vali Loss: 1.293 Vali Acc: 0.527 Test Loss: 1.293 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 45.60317015647888
Epoch: 11, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.617 Vali Acc: 0.581 Test Loss: 1.617 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 47.17928457260132
Epoch: 12, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.389 Vali Acc: 0.581 Test Loss: 1.389 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 49.366211891174316
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.414 Vali Acc: 0.595 Test Loss: 1.414 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 50.674355030059814
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.420 Vali Acc: 0.595 Test Loss: 1.420 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 45.55446696281433
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.394 Vali Acc: 0.608 Test Loss: 1.394 Test Acc: 0.608
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 49.04808974266052
Epoch: 16, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.386 Vali Acc: 0.595 Test Loss: 1.386 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 48.94133520126343
Epoch: 17, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.384 Vali Acc: 0.622 Test Loss: 1.384 Test Acc: 0.622
Validation loss decreased (-0.608096 --> -0.621608).  Saving model ...
Epoch: 18 cost time: 50.35487771034241
Epoch: 18, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.389 Vali Acc: 0.622 Test Loss: 1.389 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 51.816540479660034
Epoch: 19, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.394 Vali Acc: 0.622 Test Loss: 1.394 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 50.98756766319275
Epoch: 20, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.396 Vali Acc: 0.622 Test Loss: 1.396 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 46.83338737487793
Epoch: 21, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.404 Vali Acc: 0.622 Test Loss: 1.404 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 47.63312268257141
Epoch: 22, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.406 Vali Acc: 0.622 Test Loss: 1.406 Test Acc: 0.622
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 50.023688554763794
Epoch: 23, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.413 Vali Acc: 0.622 Test Loss: 1.413 Test Acc: 0.622
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 46.484914779663086
Epoch: 24, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.419 Vali Acc: 0.622 Test Loss: 1.419 Test Acc: 0.622
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 44.19169473648071
Epoch: 25, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.423 Vali Acc: 0.635 Test Loss: 1.423 Test Acc: 0.635
Validation loss decreased (-0.621608 --> -0.635121).  Saving model ...
Epoch: 26 cost time: 43.43122696876526
Epoch: 26, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.426 Vali Acc: 0.635 Test Loss: 1.426 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 43.14874744415283
Epoch: 27, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.433 Vali Acc: 0.635 Test Loss: 1.433 Test Acc: 0.635
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 51.11749625205994
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.433 Vali Acc: 0.635 Test Loss: 1.433 Test Acc: 0.635
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 52.03316617012024
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.439 Vali Acc: 0.635 Test Loss: 1.439 Test Acc: 0.635
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 47.34871959686279
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.440 Vali Acc: 0.635 Test Loss: 1.440 Test Acc: 0.635
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm128_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6351351351351351
model parameter : 75191812
model size : 289.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm128_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 19.278624534606934
Epoch: 1, Steps: 10 | Train Loss: 1.464 Vali Loss: 1.334 Vali Acc: 0.338 Test Loss: 1.334 Test Acc: 0.338
Validation loss decreased (inf --> -0.337824).  Saving model ...
Epoch: 2 cost time: 17.368255376815796
Epoch: 2, Steps: 10 | Train Loss: 1.012 Vali Loss: 1.183 Vali Acc: 0.500 Test Loss: 1.183 Test Acc: 0.500
Validation loss decreased (-0.337824 --> -0.499988).  Saving model ...
Epoch: 3 cost time: 17.73001003265381
Epoch: 3, Steps: 10 | Train Loss: 0.517 Vali Loss: 1.039 Vali Acc: 0.676 Test Loss: 1.039 Test Acc: 0.676
Validation loss decreased (-0.499988 --> -0.675665).  Saving model ...
Epoch: 4 cost time: 17.937398672103882
Epoch: 4, Steps: 10 | Train Loss: 0.194 Vali Loss: 1.128 Vali Acc: 0.541 Test Loss: 1.128 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 17.963531732559204
Epoch: 5, Steps: 10 | Train Loss: 0.066 Vali Loss: 1.123 Vali Acc: 0.568 Test Loss: 1.123 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 18.75162982940674
Epoch: 6, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.187 Vali Acc: 0.581 Test Loss: 1.187 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 16.25257396697998
Epoch: 7, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.355 Vali Acc: 0.554 Test Loss: 1.355 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 17.39425563812256
Epoch: 8, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.300 Vali Acc: 0.595 Test Loss: 1.300 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 17.445480346679688
Epoch: 9, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.205 Vali Acc: 0.581 Test Loss: 1.205 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 16.801005125045776
Epoch: 10, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.166 Vali Acc: 0.595 Test Loss: 1.166 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 17.15104579925537
Epoch: 11, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.194 Vali Acc: 0.622 Test Loss: 1.194 Test Acc: 0.622
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 16.582348108291626
Epoch: 12, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.200 Vali Acc: 0.608 Test Loss: 1.200 Test Acc: 0.608
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 16.4065101146698
Epoch: 13, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.181 Vali Acc: 0.635 Test Loss: 1.181 Test Acc: 0.635
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm128_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6756756756756757
model parameter : 22235652
model size : 87.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm128_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 33.87022542953491
Epoch: 1, Steps: 10 | Train Loss: 1.461 Vali Loss: 1.428 Vali Acc: 0.230 Test Loss: 1.428 Test Acc: 0.230
Validation loss decreased (inf --> -0.229715).  Saving model ...
Epoch: 2 cost time: 31.7327721118927
Epoch: 2, Steps: 10 | Train Loss: 1.050 Vali Loss: 1.225 Vali Acc: 0.486 Test Loss: 1.225 Test Acc: 0.486
Validation loss decreased (-0.229715 --> -0.486474).  Saving model ...
Epoch: 3 cost time: 30.329984664916992
Epoch: 3, Steps: 10 | Train Loss: 0.513 Vali Loss: 1.393 Vali Acc: 0.459 Test Loss: 1.393 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 31.195677280426025
Epoch: 4, Steps: 10 | Train Loss: 0.237 Vali Loss: 1.139 Vali Acc: 0.500 Test Loss: 1.139 Test Acc: 0.500
Validation loss decreased (-0.486474 --> -0.499989).  Saving model ...
Epoch: 5 cost time: 32.801077365875244
Epoch: 5, Steps: 10 | Train Loss: 0.076 Vali Loss: 1.143 Vali Acc: 0.473 Test Loss: 1.143 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 32.145106077194214
Epoch: 6, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.258 Vali Acc: 0.554 Test Loss: 1.258 Test Acc: 0.554
Validation loss decreased (-0.499989 --> -0.554041).  Saving model ...
Epoch: 7 cost time: 32.03765869140625
Epoch: 7, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.110 Vali Acc: 0.595 Test Loss: 1.110 Test Acc: 0.595
Validation loss decreased (-0.554041 --> -0.594583).  Saving model ...
Epoch: 8 cost time: 19.35412049293518
Epoch: 8, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.386 Vali Acc: 0.568 Test Loss: 1.386 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 32.82571792602539
Epoch: 9, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.394 Vali Acc: 0.568 Test Loss: 1.394 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 32.44428300857544
Epoch: 10, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.382 Vali Acc: 0.554 Test Loss: 1.382 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 32.8735556602478
Epoch: 11, Steps: 10 | Train Loss: 0.052 Vali Loss: 2.120 Vali Acc: 0.473 Test Loss: 2.120 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 32.56015706062317
Epoch: 12, Steps: 10 | Train Loss: 0.142 Vali Loss: 1.404 Vali Acc: 0.473 Test Loss: 1.404 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 28.407901525497437
Epoch: 13, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.266 Vali Acc: 0.514 Test Loss: 1.266 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 27.86245083808899
Epoch: 14, Steps: 10 | Train Loss: 0.025 Vali Loss: 2.605 Vali Acc: 0.459 Test Loss: 2.605 Test Acc: 0.459
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 31.305976152420044
Epoch: 15, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.439 Vali Acc: 0.554 Test Loss: 1.439 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 32.14360761642456
Epoch: 16, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.881 Vali Acc: 0.486 Test Loss: 1.881 Test Acc: 0.486
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 31.530900716781616
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.788 Vali Acc: 0.554 Test Loss: 1.788 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm128_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 75191812
model size : 289.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm128_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 13.168678045272827
Epoch: 1, Steps: 10 | Train Loss: 1.467 Vali Loss: 1.335 Vali Acc: 0.351 Test Loss: 1.335 Test Acc: 0.351
Validation loss decreased (inf --> -0.351338).  Saving model ...
Epoch: 2 cost time: 10.687047004699707
Epoch: 2, Steps: 10 | Train Loss: 1.015 Vali Loss: 1.193 Vali Acc: 0.473 Test Loss: 1.193 Test Acc: 0.473
Validation loss decreased (-0.351338 --> -0.472961).  Saving model ...
Epoch: 3 cost time: 11.758799314498901
Epoch: 3, Steps: 10 | Train Loss: 0.520 Vali Loss: 1.023 Vali Acc: 0.635 Test Loss: 1.023 Test Acc: 0.635
Validation loss decreased (-0.472961 --> -0.635125).  Saving model ...
Epoch: 4 cost time: 11.414205074310303
Epoch: 4, Steps: 10 | Train Loss: 0.203 Vali Loss: 1.098 Vali Acc: 0.581 Test Loss: 1.098 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 11.233176469802856
Epoch: 5, Steps: 10 | Train Loss: 0.070 Vali Loss: 1.217 Vali Acc: 0.500 Test Loss: 1.217 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 11.504374504089355
Epoch: 6, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.189 Vali Acc: 0.541 Test Loss: 1.189 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 10.669036626815796
Epoch: 7, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.394 Vali Acc: 0.541 Test Loss: 1.394 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 11.582365274429321
Epoch: 8, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.417 Vali Acc: 0.514 Test Loss: 1.417 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 11.974317789077759
Epoch: 9, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.298 Vali Acc: 0.608 Test Loss: 1.298 Test Acc: 0.608
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 12.234512567520142
Epoch: 10, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.194 Vali Acc: 0.568 Test Loss: 1.194 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 12.365468502044678
Epoch: 11, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.208 Vali Acc: 0.635 Test Loss: 1.208 Test Acc: 0.635
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 11.363668441772461
Epoch: 12, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.197 Vali Acc: 0.622 Test Loss: 1.197 Test Acc: 0.622
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 12.61185884475708
Epoch: 13, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.189 Vali Acc: 0.649 Test Loss: 1.189 Test Acc: 0.649
Validation loss decreased (-0.635125 --> -0.648637).  Saving model ...
Epoch: 14 cost time: 11.947997331619263
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.194 Vali Acc: 0.662 Test Loss: 1.194 Test Acc: 0.662
Validation loss decreased (-0.648637 --> -0.662150).  Saving model ...
Epoch: 15 cost time: 12.41651964187622
Epoch: 15, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.202 Vali Acc: 0.662 Test Loss: 1.202 Test Acc: 0.662
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 11.62299370765686
Epoch: 16, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.195 Vali Acc: 0.662 Test Loss: 1.195 Test Acc: 0.662
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 11.518962383270264
Epoch: 17, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.194 Vali Acc: 0.662 Test Loss: 1.194 Test Acc: 0.662
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 10.648218631744385
Epoch: 18, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.236 Vali Acc: 0.662 Test Loss: 1.236 Test Acc: 0.662
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 10.258033990859985
Epoch: 19, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.249 Vali Acc: 0.649 Test Loss: 1.249 Test Acc: 0.649
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 10.443764448165894
Epoch: 20, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.260 Vali Acc: 0.662 Test Loss: 1.260 Test Acc: 0.662
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 10.011255979537964
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.212 Vali Acc: 0.635 Test Loss: 1.212 Test Acc: 0.635
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 10.35478949546814
Epoch: 22, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.279 Vali Acc: 0.622 Test Loss: 1.279 Test Acc: 0.622
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 10.573883533477783
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.349 Vali Acc: 0.635 Test Loss: 1.349 Test Acc: 0.635
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 11.854142904281616
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.327 Vali Acc: 0.635 Test Loss: 1.327 Test Acc: 0.635
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm128_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6621621621621622
model parameter : 22235652
model size : 87.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm128_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 19.79629945755005
Epoch: 1, Steps: 10 | Train Loss: 1.462 Vali Loss: 1.445 Vali Acc: 0.243 Test Loss: 1.445 Test Acc: 0.243
Validation loss decreased (inf --> -0.243229).  Saving model ...
Epoch: 2 cost time: 19.211783170700073
Epoch: 2, Steps: 10 | Train Loss: 1.135 Vali Loss: 1.199 Vali Acc: 0.473 Test Loss: 1.199 Test Acc: 0.473
Validation loss decreased (-0.243229 --> -0.472961).  Saving model ...
Epoch: 3 cost time: 21.09264087677002
Epoch: 3, Steps: 10 | Train Loss: 0.654 Vali Loss: 1.379 Vali Acc: 0.419 Test Loss: 1.379 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 21.74406385421753
Epoch: 4, Steps: 10 | Train Loss: 0.344 Vali Loss: 1.060 Vali Acc: 0.473 Test Loss: 1.060 Test Acc: 0.473
Validation loss decreased (-0.472961 --> -0.472962).  Saving model ...
Epoch: 5 cost time: 19.95493769645691
Epoch: 5, Steps: 10 | Train Loss: 0.125 Vali Loss: 1.038 Vali Acc: 0.514 Test Loss: 1.038 Test Acc: 0.514
Validation loss decreased (-0.472962 --> -0.513503).  Saving model ...
Epoch: 6 cost time: 18.987624883651733
Epoch: 6, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.153 Vali Acc: 0.568 Test Loss: 1.153 Test Acc: 0.568
Validation loss decreased (-0.513503 --> -0.567556).  Saving model ...
Epoch: 7 cost time: 18.943262815475464
Epoch: 7, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.015 Vali Acc: 0.649 Test Loss: 1.015 Test Acc: 0.649
Validation loss decreased (-0.567556 --> -0.648638).  Saving model ...
Epoch: 8 cost time: 18.082826137542725
Epoch: 8, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.153 Vali Acc: 0.635 Test Loss: 1.153 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 19.85986876487732
Epoch: 9, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.159 Vali Acc: 0.608 Test Loss: 1.159 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 19.542701482772827
Epoch: 10, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.094 Vali Acc: 0.662 Test Loss: 1.094 Test Acc: 0.662
Validation loss decreased (-0.648638 --> -0.662151).  Saving model ...
Epoch: 11 cost time: 20.885173797607422
Epoch: 11, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.136 Vali Acc: 0.649 Test Loss: 1.136 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 20.7735538482666
Epoch: 12, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.140 Vali Acc: 0.649 Test Loss: 1.140 Test Acc: 0.649
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 21.109539031982422
Epoch: 13, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.163 Vali Acc: 0.649 Test Loss: 1.163 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 19.892582654953003
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.159 Vali Acc: 0.649 Test Loss: 1.159 Test Acc: 0.649
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 18.976214170455933
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.183 Vali Acc: 0.649 Test Loss: 1.183 Test Acc: 0.649
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 16.348918676376343
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.182 Vali Acc: 0.649 Test Loss: 1.182 Test Acc: 0.649
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 17.89719009399414
Epoch: 17, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.194 Vali Acc: 0.649 Test Loss: 1.194 Test Acc: 0.649
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 19.563873052597046
Epoch: 18, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.195 Vali Acc: 0.635 Test Loss: 1.195 Test Acc: 0.635
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 19.796518564224243
Epoch: 19, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.202 Vali Acc: 0.635 Test Loss: 1.202 Test Acc: 0.635
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 20.121858596801758
Epoch: 20, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.226 Vali Acc: 0.649 Test Loss: 1.226 Test Acc: 0.649
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm128_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6621621621621622
model parameter : 75191812
model size : 289.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm128_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 9.736984014511108
Epoch: 1, Steps: 10 | Train Loss: 1.458 Vali Loss: 1.340 Vali Acc: 0.324 Test Loss: 1.340 Test Acc: 0.324
Validation loss decreased (inf --> -0.324311).  Saving model ...
Epoch: 2 cost time: 8.047116756439209
Epoch: 2, Steps: 10 | Train Loss: 1.106 Vali Loss: 1.199 Vali Acc: 0.432 Test Loss: 1.199 Test Acc: 0.432
Validation loss decreased (-0.324311 --> -0.432420).  Saving model ...
Epoch: 3 cost time: 8.102365016937256
Epoch: 3, Steps: 10 | Train Loss: 0.686 Vali Loss: 1.035 Vali Acc: 0.635 Test Loss: 1.035 Test Acc: 0.635
Validation loss decreased (-0.432420 --> -0.635125).  Saving model ...
Epoch: 4 cost time: 7.815829277038574
Epoch: 4, Steps: 10 | Train Loss: 0.318 Vali Loss: 1.051 Vali Acc: 0.527 Test Loss: 1.051 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 8.110150575637817
Epoch: 5, Steps: 10 | Train Loss: 0.113 Vali Loss: 1.094 Vali Acc: 0.554 Test Loss: 1.094 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 7.375602960586548
Epoch: 6, Steps: 10 | Train Loss: 0.041 Vali Loss: 1.143 Vali Acc: 0.581 Test Loss: 1.143 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 7.2430078983306885
Epoch: 7, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.227 Vali Acc: 0.622 Test Loss: 1.227 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 6.827516317367554
Epoch: 8, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.970 Vali Acc: 0.581 Test Loss: 0.970 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 6.77648401260376
Epoch: 9, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.067 Vali Acc: 0.635 Test Loss: 1.067 Test Acc: 0.635
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 6.346323013305664
Epoch: 10, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.301 Vali Acc: 0.635 Test Loss: 1.301 Test Acc: 0.635
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 6.834118604660034
Epoch: 11, Steps: 10 | Train Loss: 0.046 Vali Loss: 1.557 Vali Acc: 0.568 Test Loss: 1.557 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 6.861323118209839
Epoch: 12, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.128 Vali Acc: 0.649 Test Loss: 1.128 Test Acc: 0.649
Validation loss decreased (-0.635125 --> -0.648637).  Saving model ...
Epoch: 13 cost time: 6.878949403762817
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.107 Vali Acc: 0.676 Test Loss: 1.107 Test Acc: 0.676
Validation loss decreased (-0.648637 --> -0.675665).  Saving model ...
Epoch: 14 cost time: 7.9009740352630615
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.252 Vali Acc: 0.635 Test Loss: 1.252 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 7.929596900939941
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.183 Vali Acc: 0.635 Test Loss: 1.183 Test Acc: 0.635
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 7.141199350357056
Epoch: 16, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.078 Vali Acc: 0.649 Test Loss: 1.078 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 8.293892621994019
Epoch: 17, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.608 Vali Acc: 0.595 Test Loss: 1.608 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 8.62087869644165
Epoch: 18, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.274 Vali Acc: 0.635 Test Loss: 1.274 Test Acc: 0.635
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 8.557816743850708
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.252 Vali Acc: 0.595 Test Loss: 1.252 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 8.487756252288818
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.356 Vali Acc: 0.608 Test Loss: 1.356 Test Acc: 0.608
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 8.445261716842651
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.419 Vali Acc: 0.608 Test Loss: 1.419 Test Acc: 0.608
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 8.132984399795532
Epoch: 22, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.453 Vali Acc: 0.595 Test Loss: 1.453 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 7.482903480529785
Epoch: 23, Steps: 10 | Train Loss: 0.005 Vali Loss: 2.539 Vali Acc: 0.554 Test Loss: 2.539 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm128_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6756756756756757
model parameter : 22235652
model size : 87.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm128_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 27.155168771743774
Epoch: 1, Steps: 10 | Train Loss: 1.461 Vali Loss: 1.300 Vali Acc: 0.419 Test Loss: 1.300 Test Acc: 0.419
Validation loss decreased (inf --> -0.418906).  Saving model ...
Epoch: 2 cost time: 22.94934916496277
Epoch: 2, Steps: 10 | Train Loss: 1.066 Vali Loss: 1.179 Vali Acc: 0.514 Test Loss: 1.179 Test Acc: 0.514
Validation loss decreased (-0.418906 --> -0.513502).  Saving model ...
Epoch: 3 cost time: 22.480989456176758
Epoch: 3, Steps: 10 | Train Loss: 0.539 Vali Loss: 1.157 Vali Acc: 0.527 Test Loss: 1.157 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527015).  Saving model ...
Epoch: 4 cost time: 22.086490631103516
Epoch: 4, Steps: 10 | Train Loss: 0.243 Vali Loss: 1.079 Vali Acc: 0.541 Test Loss: 1.079 Test Acc: 0.541
Validation loss decreased (-0.527015 --> -0.540530).  Saving model ...
Epoch: 5 cost time: 26.41638469696045
Epoch: 5, Steps: 10 | Train Loss: 0.071 Vali Loss: 1.130 Vali Acc: 0.514 Test Loss: 1.130 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 25.55681872367859
Epoch: 6, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.193 Vali Acc: 0.568 Test Loss: 1.193 Test Acc: 0.568
Validation loss decreased (-0.540530 --> -0.567556).  Saving model ...
Epoch: 7 cost time: 25.720948934555054
Epoch: 7, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.221 Vali Acc: 0.568 Test Loss: 1.221 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 25.37184429168701
Epoch: 8, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.170 Vali Acc: 0.608 Test Loss: 1.170 Test Acc: 0.608
Validation loss decreased (-0.567556 --> -0.608096).  Saving model ...
Epoch: 9 cost time: 24.059772491455078
Epoch: 9, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.209 Vali Acc: 0.595 Test Loss: 1.209 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 22.798341274261475
Epoch: 10, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.173 Vali Acc: 0.595 Test Loss: 1.173 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 21.895878076553345
Epoch: 11, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.224 Vali Acc: 0.568 Test Loss: 1.224 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 22.50914978981018
Epoch: 12, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.218 Vali Acc: 0.608 Test Loss: 1.218 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 25.10122561454773
Epoch: 13, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.191 Vali Acc: 0.608 Test Loss: 1.191 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 25.274105072021484
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.175 Vali Acc: 0.622 Test Loss: 1.175 Test Acc: 0.622
Validation loss decreased (-0.608096 --> -0.621610).  Saving model ...
Epoch: 15 cost time: 25.302093267440796
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.460 Vali Acc: 0.595 Test Loss: 1.460 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 32.71128487586975
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.413 Vali Acc: 0.608 Test Loss: 1.413 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 33.45749640464783
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.384 Vali Acc: 0.622 Test Loss: 1.384 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 32.01608180999756
Epoch: 18, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.344 Vali Acc: 0.622 Test Loss: 1.344 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 30.40864086151123
Epoch: 19, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.321 Vali Acc: 0.635 Test Loss: 1.321 Test Acc: 0.635
Validation loss decreased (-0.621610 --> -0.635122).  Saving model ...
Epoch: 20 cost time: 33.25558161735535
Epoch: 20, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.309 Vali Acc: 0.635 Test Loss: 1.309 Test Acc: 0.635
Validation loss decreased (-0.635122 --> -0.635122).  Saving model ...
Epoch: 21 cost time: 34.373854637145996
Epoch: 21, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.296 Vali Acc: 0.635 Test Loss: 1.296 Test Acc: 0.635
Validation loss decreased (-0.635122 --> -0.635122).  Saving model ...
Epoch: 22 cost time: 34.940858364105225
Epoch: 22, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.302 Vali Acc: 0.635 Test Loss: 1.302 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 34.921635389328
Epoch: 23, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.306 Vali Acc: 0.635 Test Loss: 1.306 Test Acc: 0.635
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 35.25694537162781
Epoch: 24, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.311 Vali Acc: 0.635 Test Loss: 1.311 Test Acc: 0.635
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 34.50822138786316
Epoch: 25, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.315 Vali Acc: 0.635 Test Loss: 1.315 Test Acc: 0.635
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 31.707481145858765
Epoch: 26, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.315 Vali Acc: 0.635 Test Loss: 1.315 Test Acc: 0.635
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 31.502644062042236
Epoch: 27, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.320 Vali Acc: 0.635 Test Loss: 1.320 Test Acc: 0.635
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 28.587581634521484
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.322 Vali Acc: 0.635 Test Loss: 1.322 Test Acc: 0.635
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 31.49651551246643
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.320 Vali Acc: 0.635 Test Loss: 1.320 Test Acc: 0.635
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 32.00257325172424
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.319 Vali Acc: 0.649 Test Loss: 1.319 Test Acc: 0.649
Validation loss decreased (-0.635122 --> -0.648635).  Saving model ...
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm128_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6486486486486487
model parameter : 37702148
model size : 146.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm128_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 14.197257280349731
Epoch: 1, Steps: 10 | Train Loss: 1.469 Vali Loss: 1.324 Vali Acc: 0.405 Test Loss: 1.324 Test Acc: 0.405
Validation loss decreased (inf --> -0.405392).  Saving model ...
Epoch: 2 cost time: 12.269566059112549
Epoch: 2, Steps: 10 | Train Loss: 1.071 Vali Loss: 1.155 Vali Acc: 0.473 Test Loss: 1.155 Test Acc: 0.473
Validation loss decreased (-0.405392 --> -0.472961).  Saving model ...
Epoch: 3 cost time: 11.949384450912476
Epoch: 3, Steps: 10 | Train Loss: 0.558 Vali Loss: 1.128 Vali Acc: 0.432 Test Loss: 1.128 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 12.491644620895386
Epoch: 4, Steps: 10 | Train Loss: 0.230 Vali Loss: 1.242 Vali Acc: 0.432 Test Loss: 1.242 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 12.336565732955933
Epoch: 5, Steps: 10 | Train Loss: 0.073 Vali Loss: 1.096 Vali Acc: 0.486 Test Loss: 1.096 Test Acc: 0.486
Validation loss decreased (-0.472961 --> -0.486476).  Saving model ...
Epoch: 6 cost time: 8.815077781677246
Epoch: 6, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.046 Vali Acc: 0.500 Test Loss: 1.046 Test Acc: 0.500
Validation loss decreased (-0.486476 --> -0.499990).  Saving model ...
Epoch: 7 cost time: 12.603307247161865
Epoch: 7, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.023 Vali Acc: 0.581 Test Loss: 1.023 Test Acc: 0.581
Validation loss decreased (-0.499990 --> -0.581071).  Saving model ...
Epoch: 8 cost time: 11.757666826248169
Epoch: 8, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.181 Vali Acc: 0.554 Test Loss: 1.181 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 10.878320217132568
Epoch: 9, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.118 Vali Acc: 0.595 Test Loss: 1.118 Test Acc: 0.595
Validation loss decreased (-0.581071 --> -0.594583).  Saving model ...
Epoch: 10 cost time: 15.860496759414673
Epoch: 10, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.120 Vali Acc: 0.568 Test Loss: 1.120 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 16.736555099487305
Epoch: 11, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.095 Vali Acc: 0.608 Test Loss: 1.095 Test Acc: 0.608
Validation loss decreased (-0.594583 --> -0.608097).  Saving model ...
Epoch: 12 cost time: 16.002852201461792
Epoch: 12, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.079 Vali Acc: 0.608 Test Loss: 1.079 Test Acc: 0.608
Validation loss decreased (-0.608097 --> -0.608097).  Saving model ...
Epoch: 13 cost time: 15.14058804512024
Epoch: 13, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.082 Vali Acc: 0.622 Test Loss: 1.082 Test Acc: 0.622
Validation loss decreased (-0.608097 --> -0.621611).  Saving model ...
Epoch: 14 cost time: 15.406525135040283
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.088 Vali Acc: 0.608 Test Loss: 1.088 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 16.941720247268677
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.087 Vali Acc: 0.622 Test Loss: 1.087 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 15.655880212783813
Epoch: 16, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.097 Vali Acc: 0.635 Test Loss: 1.097 Test Acc: 0.635
Validation loss decreased (-0.621611 --> -0.635124).  Saving model ...
Epoch: 17 cost time: 13.65614366531372
Epoch: 17, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.105 Vali Acc: 0.622 Test Loss: 1.105 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 17.19640326499939
Epoch: 18, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.107 Vali Acc: 0.635 Test Loss: 1.107 Test Acc: 0.635
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 17.997059106826782
Epoch: 19, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.114 Vali Acc: 0.635 Test Loss: 1.114 Test Acc: 0.635
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 18.292293548583984
Epoch: 20, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.123 Vali Acc: 0.622 Test Loss: 1.123 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 18.10918402671814
Epoch: 21, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.132 Vali Acc: 0.622 Test Loss: 1.132 Test Acc: 0.622
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 17.852043390274048
Epoch: 22, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.134 Vali Acc: 0.622 Test Loss: 1.134 Test Acc: 0.622
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 16.115997314453125
Epoch: 23, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.141 Vali Acc: 0.622 Test Loss: 1.141 Test Acc: 0.622
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 18.30967092514038
Epoch: 24, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.146 Vali Acc: 0.622 Test Loss: 1.146 Test Acc: 0.622
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 18.28006601333618
Epoch: 25, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.153 Vali Acc: 0.635 Test Loss: 1.153 Test Acc: 0.635
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 18.351794481277466
Epoch: 26, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.161 Vali Acc: 0.622 Test Loss: 1.161 Test Acc: 0.622
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm128_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6351351351351351
model parameter : 11223556
model size : 45.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm128_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 31.76285409927368
Epoch: 1, Steps: 10 | Train Loss: 1.463 Vali Loss: 1.297 Vali Acc: 0.405 Test Loss: 1.297 Test Acc: 0.405
Validation loss decreased (inf --> -0.405392).  Saving model ...
Epoch: 2 cost time: 29.229854822158813
Epoch: 2, Steps: 10 | Train Loss: 1.066 Vali Loss: 1.165 Vali Acc: 0.554 Test Loss: 1.165 Test Acc: 0.554
Validation loss decreased (-0.405392 --> -0.554042).  Saving model ...
Epoch: 3 cost time: 31.526881217956543
Epoch: 3, Steps: 10 | Train Loss: 0.529 Vali Loss: 1.168 Vali Acc: 0.473 Test Loss: 1.168 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 31.33162236213684
Epoch: 4, Steps: 10 | Train Loss: 0.261 Vali Loss: 1.039 Vali Acc: 0.527 Test Loss: 1.039 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 30.325039863586426
Epoch: 5, Steps: 10 | Train Loss: 0.074 Vali Loss: 1.053 Vali Acc: 0.595 Test Loss: 1.053 Test Acc: 0.595
Validation loss decreased (-0.554042 --> -0.594584).  Saving model ...
Epoch: 6 cost time: 30.05815076828003
Epoch: 6, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.217 Vali Acc: 0.581 Test Loss: 1.217 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 31.852020263671875
Epoch: 7, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.301 Vali Acc: 0.541 Test Loss: 1.301 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 26.37203860282898
Epoch: 8, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.189 Vali Acc: 0.595 Test Loss: 1.189 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 24.898466110229492
Epoch: 9, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.159 Vali Acc: 0.622 Test Loss: 1.159 Test Acc: 0.622
Validation loss decreased (-0.594584 --> -0.621610).  Saving model ...
Epoch: 10 cost time: 26.57183837890625
Epoch: 10, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.200 Vali Acc: 0.608 Test Loss: 1.200 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 29.050371885299683
Epoch: 11, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.193 Vali Acc: 0.608 Test Loss: 1.193 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 28.579699754714966
Epoch: 12, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.186 Vali Acc: 0.608 Test Loss: 1.186 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 28.113463640213013
Epoch: 13, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.164 Vali Acc: 0.608 Test Loss: 1.164 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 27.940579652786255
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.151 Vali Acc: 0.608 Test Loss: 1.151 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 26.216182231903076
Epoch: 15, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.159 Vali Acc: 0.608 Test Loss: 1.159 Test Acc: 0.608
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 28.842097282409668
Epoch: 16, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.184 Vali Acc: 0.608 Test Loss: 1.184 Test Acc: 0.608
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 31.0229012966156
Epoch: 17, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.183 Vali Acc: 0.595 Test Loss: 1.183 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 31.328004121780396
Epoch: 18, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.184 Vali Acc: 0.595 Test Loss: 1.184 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 30.17631769180298
Epoch: 19, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.585 Vali Acc: 0.568 Test Loss: 1.585 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm128_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 37702148
model size : 146.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm128_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 13.783774852752686
Epoch: 1, Steps: 10 | Train Loss: 1.471 Vali Loss: 1.326 Vali Acc: 0.419 Test Loss: 1.326 Test Acc: 0.419
Validation loss decreased (inf --> -0.418906).  Saving model ...
Epoch: 2 cost time: 12.14115285873413
Epoch: 2, Steps: 10 | Train Loss: 1.064 Vali Loss: 1.158 Vali Acc: 0.473 Test Loss: 1.158 Test Acc: 0.473
Validation loss decreased (-0.418906 --> -0.472961).  Saving model ...
Epoch: 3 cost time: 12.300697565078735
Epoch: 3, Steps: 10 | Train Loss: 0.554 Vali Loss: 1.119 Vali Acc: 0.473 Test Loss: 1.119 Test Acc: 0.473
Validation loss decreased (-0.472961 --> -0.472962).  Saving model ...
Epoch: 4 cost time: 12.432886362075806
Epoch: 4, Steps: 10 | Train Loss: 0.234 Vali Loss: 1.241 Vali Acc: 0.446 Test Loss: 1.241 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 12.175173044204712
Epoch: 5, Steps: 10 | Train Loss: 0.081 Vali Loss: 1.045 Vali Acc: 0.541 Test Loss: 1.045 Test Acc: 0.541
Validation loss decreased (-0.472962 --> -0.540530).  Saving model ...
Epoch: 6 cost time: 12.123192310333252
Epoch: 6, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.026 Vali Acc: 0.581 Test Loss: 1.026 Test Acc: 0.581
Validation loss decreased (-0.540530 --> -0.581071).  Saving model ...
Epoch: 7 cost time: 9.806613445281982
Epoch: 7, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.081 Vali Acc: 0.581 Test Loss: 1.081 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 10.985446214675903
Epoch: 8, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.246 Vali Acc: 0.568 Test Loss: 1.246 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 11.089086532592773
Epoch: 9, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.135 Vali Acc: 0.541 Test Loss: 1.135 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 11.220262289047241
Epoch: 10, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.099 Vali Acc: 0.568 Test Loss: 1.099 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 11.204851388931274
Epoch: 11, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.108 Vali Acc: 0.527 Test Loss: 1.108 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 11.710051536560059
Epoch: 12, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.124 Vali Acc: 0.554 Test Loss: 1.124 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 11.084608316421509
Epoch: 13, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.139 Vali Acc: 0.568 Test Loss: 1.139 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 11.681729793548584
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.142 Vali Acc: 0.581 Test Loss: 1.142 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 11.0114426612854
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.127 Vali Acc: 0.568 Test Loss: 1.127 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 10.876912355422974
Epoch: 16, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.131 Vali Acc: 0.568 Test Loss: 1.131 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm128_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 11223556
model size : 45.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm128_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 20.503589630126953
Epoch: 1, Steps: 10 | Train Loss: 1.459 Vali Loss: 1.298 Vali Acc: 0.432 Test Loss: 1.298 Test Acc: 0.432
Validation loss decreased (inf --> -0.432419).  Saving model ...
Epoch: 2 cost time: 19.475252389907837
Epoch: 2, Steps: 10 | Train Loss: 1.160 Vali Loss: 1.174 Vali Acc: 0.486 Test Loss: 1.174 Test Acc: 0.486
Validation loss decreased (-0.432419 --> -0.486475).  Saving model ...
Epoch: 3 cost time: 20.009451627731323
Epoch: 3, Steps: 10 | Train Loss: 0.681 Vali Loss: 1.087 Vali Acc: 0.500 Test Loss: 1.087 Test Acc: 0.500
Validation loss decreased (-0.486475 --> -0.499989).  Saving model ...
Epoch: 4 cost time: 20.54728889465332
Epoch: 4, Steps: 10 | Train Loss: 0.357 Vali Loss: 0.982 Vali Acc: 0.554 Test Loss: 0.982 Test Acc: 0.554
Validation loss decreased (-0.499989 --> -0.554044).  Saving model ...
Epoch: 5 cost time: 20.561809539794922
Epoch: 5, Steps: 10 | Train Loss: 0.128 Vali Loss: 0.974 Vali Acc: 0.622 Test Loss: 0.974 Test Acc: 0.622
Validation loss decreased (-0.554044 --> -0.621612).  Saving model ...
Epoch: 6 cost time: 20.09882688522339
Epoch: 6, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.991 Vali Acc: 0.608 Test Loss: 0.991 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 19.2719886302948
Epoch: 7, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.987 Vali Acc: 0.568 Test Loss: 0.987 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 19.87481999397278
Epoch: 8, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.119 Vali Acc: 0.635 Test Loss: 1.119 Test Acc: 0.635
Validation loss decreased (-0.621612 --> -0.635124).  Saving model ...
Epoch: 9 cost time: 19.278888463974
Epoch: 9, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.241 Vali Acc: 0.649 Test Loss: 1.241 Test Acc: 0.649
Validation loss decreased (-0.635124 --> -0.648636).  Saving model ...
Epoch: 10 cost time: 19.237717390060425
Epoch: 10, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.393 Vali Acc: 0.608 Test Loss: 1.393 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 17.147541522979736
Epoch: 11, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.059 Vali Acc: 0.662 Test Loss: 1.059 Test Acc: 0.662
Validation loss decreased (-0.648636 --> -0.662152).  Saving model ...
Epoch: 12 cost time: 17.598140001296997
Epoch: 12, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.052 Vali Acc: 0.649 Test Loss: 1.052 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 18.42859673500061
Epoch: 13, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.130 Vali Acc: 0.649 Test Loss: 1.130 Test Acc: 0.649
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 18.013850927352905
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.050 Vali Acc: 0.649 Test Loss: 1.050 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 18.46326780319214
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.023 Vali Acc: 0.662 Test Loss: 1.023 Test Acc: 0.662
Validation loss decreased (-0.662152 --> -0.662152).  Saving model ...
Epoch: 16 cost time: 18.130128860473633
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.074 Vali Acc: 0.662 Test Loss: 1.074 Test Acc: 0.662
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 18.44274663925171
Epoch: 17, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.118 Vali Acc: 0.649 Test Loss: 1.118 Test Acc: 0.649
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 18.218303442001343
Epoch: 18, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.143 Vali Acc: 0.649 Test Loss: 1.143 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 19.013139247894287
Epoch: 19, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.144 Vali Acc: 0.649 Test Loss: 1.144 Test Acc: 0.649
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 18.755818605422974
Epoch: 20, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.144 Vali Acc: 0.649 Test Loss: 1.144 Test Acc: 0.649
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 19.713075637817383
Epoch: 21, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.560 Vali Acc: 0.622 Test Loss: 1.560 Test Acc: 0.622
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 19.316385746002197
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.374 Vali Acc: 0.635 Test Loss: 1.374 Test Acc: 0.635
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 20.303164958953857
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.335 Vali Acc: 0.608 Test Loss: 1.335 Test Acc: 0.608
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 20.314882516860962
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.478 Vali Acc: 0.608 Test Loss: 1.478 Test Acc: 0.608
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 20.062455892562866
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.471 Vali Acc: 0.595 Test Loss: 1.471 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm128_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6621621621621622
model parameter : 37702148
model size : 146.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm128_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 10.345019102096558
Epoch: 1, Steps: 10 | Train Loss: 1.463 Vali Loss: 1.315 Vali Acc: 0.419 Test Loss: 1.315 Test Acc: 0.419
Validation loss decreased (inf --> -0.418906).  Saving model ...
Epoch: 2 cost time: 8.199662685394287
Epoch: 2, Steps: 10 | Train Loss: 1.150 Vali Loss: 1.188 Vali Acc: 0.473 Test Loss: 1.188 Test Acc: 0.473
Validation loss decreased (-0.418906 --> -0.472961).  Saving model ...
Epoch: 3 cost time: 8.426504611968994
Epoch: 3, Steps: 10 | Train Loss: 0.694 Vali Loss: 1.170 Vali Acc: 0.405 Test Loss: 1.170 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 8.278129816055298
Epoch: 4, Steps: 10 | Train Loss: 0.383 Vali Loss: 1.212 Vali Acc: 0.432 Test Loss: 1.212 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 8.406895160675049
Epoch: 5, Steps: 10 | Train Loss: 0.184 Vali Loss: 1.085 Vali Acc: 0.541 Test Loss: 1.085 Test Acc: 0.541
Validation loss decreased (-0.472961 --> -0.540530).  Saving model ...
Epoch: 6 cost time: 8.195954084396362
Epoch: 6, Steps: 10 | Train Loss: 0.065 Vali Loss: 0.957 Vali Acc: 0.595 Test Loss: 0.957 Test Acc: 0.595
Validation loss decreased (-0.540530 --> -0.594585).  Saving model ...
Epoch: 7 cost time: 8.143670320510864
Epoch: 7, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.175 Vali Acc: 0.554 Test Loss: 1.175 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 8.593940258026123
Epoch: 8, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.141 Vali Acc: 0.595 Test Loss: 1.141 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 8.313608407974243
Epoch: 9, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.399 Vali Acc: 0.568 Test Loss: 1.399 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 8.798030376434326
Epoch: 10, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.094 Vali Acc: 0.608 Test Loss: 1.094 Test Acc: 0.608
Validation loss decreased (-0.594585 --> -0.608097).  Saving model ...
Epoch: 11 cost time: 7.657874345779419
Epoch: 11, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.041 Vali Acc: 0.595 Test Loss: 1.041 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 7.017171859741211
Epoch: 12, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.118 Vali Acc: 0.608 Test Loss: 1.118 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 7.937257289886475
Epoch: 13, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.164 Vali Acc: 0.595 Test Loss: 1.164 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 7.913206577301025
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.133 Vali Acc: 0.608 Test Loss: 1.133 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 8.161959171295166
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.120 Vali Acc: 0.595 Test Loss: 1.120 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 7.790699243545532
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.142 Vali Acc: 0.608 Test Loss: 1.142 Test Acc: 0.608
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 8.004461526870728
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.152 Vali Acc: 0.622 Test Loss: 1.152 Test Acc: 0.622
Validation loss decreased (-0.608097 --> -0.621610).  Saving model ...
Epoch: 18 cost time: 8.069268465042114
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.154 Vali Acc: 0.622 Test Loss: 1.154 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 8.239996194839478
Epoch: 19, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.147 Vali Acc: 0.622 Test Loss: 1.147 Test Acc: 0.622
Validation loss decreased (-0.621610 --> -0.621610).  Saving model ...
Epoch: 20 cost time: 8.20484185218811
Epoch: 20, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.150 Vali Acc: 0.622 Test Loss: 1.150 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 8.137593030929565
Epoch: 21, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.167 Vali Acc: 0.622 Test Loss: 1.167 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 7.810379505157471
Epoch: 22, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.178 Vali Acc: 0.622 Test Loss: 1.178 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 7.793982267379761
Epoch: 23, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.182 Vali Acc: 0.622 Test Loss: 1.182 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 7.475143671035767
Epoch: 24, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.182 Vali Acc: 0.622 Test Loss: 1.182 Test Acc: 0.622
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 7.369616746902466
Epoch: 25, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.180 Vali Acc: 0.622 Test Loss: 1.180 Test Acc: 0.622
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 8.048812866210938
Epoch: 26, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.189 Vali Acc: 0.622 Test Loss: 1.189 Test Acc: 0.622
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 7.5184924602508545
Epoch: 27, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.236 Vali Acc: 0.622 Test Loss: 1.236 Test Acc: 0.622
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 7.526740550994873
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.275 Vali Acc: 0.608 Test Loss: 1.275 Test Acc: 0.608
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 7.814162254333496
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.255 Vali Acc: 0.622 Test Loss: 1.255 Test Acc: 0.622
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm128_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 11223556
model size : 45.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm64_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 48.29702401161194
Epoch: 1, Steps: 10 | Train Loss: 1.429 Vali Loss: 1.375 Vali Acc: 0.365 Test Loss: 1.375 Test Acc: 0.365
Validation loss decreased (inf --> -0.364851).  Saving model ...
Epoch: 2 cost time: 43.24536657333374
Epoch: 2, Steps: 10 | Train Loss: 1.154 Vali Loss: 1.209 Vali Acc: 0.500 Test Loss: 1.209 Test Acc: 0.500
Validation loss decreased (-0.364851 --> -0.499988).  Saving model ...
Epoch: 3 cost time: 43.37741661071777
Epoch: 3, Steps: 10 | Train Loss: 0.770 Vali Loss: 1.158 Vali Acc: 0.554 Test Loss: 1.158 Test Acc: 0.554
Validation loss decreased (-0.499988 --> -0.554042).  Saving model ...
Epoch: 4 cost time: 46.0834014415741
Epoch: 4, Steps: 10 | Train Loss: 0.439 Vali Loss: 1.086 Vali Acc: 0.541 Test Loss: 1.086 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 50.56276488304138
Epoch: 5, Steps: 10 | Train Loss: 0.234 Vali Loss: 1.003 Vali Acc: 0.554 Test Loss: 1.003 Test Acc: 0.554
Validation loss decreased (-0.554042 --> -0.554044).  Saving model ...
Epoch: 6 cost time: 51.969764709472656
Epoch: 6, Steps: 10 | Train Loss: 0.083 Vali Loss: 1.097 Vali Acc: 0.608 Test Loss: 1.097 Test Acc: 0.608
Validation loss decreased (-0.554044 --> -0.608097).  Saving model ...
Epoch: 7 cost time: 52.191664934158325
Epoch: 7, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.120 Vali Acc: 0.541 Test Loss: 1.120 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 47.06764197349548
Epoch: 8, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.263 Vali Acc: 0.581 Test Loss: 1.263 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 46.85303711891174
Epoch: 9, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.172 Vali Acc: 0.568 Test Loss: 1.172 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 47.517292499542236
Epoch: 10, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.991 Vali Acc: 0.649 Test Loss: 0.991 Test Acc: 0.649
Validation loss decreased (-0.608097 --> -0.648639).  Saving model ...
Epoch: 11 cost time: 44.88927984237671
Epoch: 11, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.227 Vali Acc: 0.622 Test Loss: 1.227 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 50.85099172592163
Epoch: 12, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.132 Vali Acc: 0.554 Test Loss: 1.132 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 48.97844338417053
Epoch: 13, Steps: 10 | Train Loss: 0.101 Vali Loss: 1.380 Vali Acc: 0.527 Test Loss: 1.380 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 45.56979990005493
Epoch: 14, Steps: 10 | Train Loss: 0.083 Vali Loss: 1.001 Vali Acc: 0.676 Test Loss: 1.001 Test Acc: 0.676
Validation loss decreased (-0.648639 --> -0.675666).  Saving model ...
Epoch: 15 cost time: 43.675384283065796
Epoch: 15, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.502 Vali Acc: 0.527 Test Loss: 1.502 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 42.336891174316406
Epoch: 16, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.081 Vali Acc: 0.608 Test Loss: 1.081 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 46.34793281555176
Epoch: 17, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.329 Vali Acc: 0.581 Test Loss: 1.329 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 45.11876392364502
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.723 Vali Acc: 0.568 Test Loss: 1.723 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 44.67690110206604
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.571 Vali Acc: 0.581 Test Loss: 1.571 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 38.156601667404175
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.435 Vali Acc: 0.568 Test Loss: 1.435 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 47.955601930618286
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.432 Vali Acc: 0.568 Test Loss: 1.432 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 47.964858293533325
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.475 Vali Acc: 0.568 Test Loss: 1.475 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 42.19559121131897
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.503 Vali Acc: 0.568 Test Loss: 1.503 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 43.32055616378784
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.469 Vali Acc: 0.541 Test Loss: 1.469 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm64_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6756756756756757
model parameter : 37598980
model size : 144.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm64_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 19.237854480743408
Epoch: 1, Steps: 10 | Train Loss: 1.452 Vali Loss: 1.415 Vali Acc: 0.230 Test Loss: 1.415 Test Acc: 0.230
Validation loss decreased (inf --> -0.229716).  Saving model ...
Epoch: 2 cost time: 16.86384654045105
Epoch: 2, Steps: 10 | Train Loss: 1.215 Vali Loss: 1.264 Vali Acc: 0.392 Test Loss: 1.264 Test Acc: 0.392
Validation loss decreased (-0.229716 --> -0.391879).  Saving model ...
Epoch: 3 cost time: 14.565755128860474
Epoch: 3, Steps: 10 | Train Loss: 0.792 Vali Loss: 1.163 Vali Acc: 0.486 Test Loss: 1.163 Test Acc: 0.486
Validation loss decreased (-0.391879 --> -0.486475).  Saving model ...
Epoch: 4 cost time: 15.43873381614685
Epoch: 4, Steps: 10 | Train Loss: 0.434 Vali Loss: 1.148 Vali Acc: 0.486 Test Loss: 1.148 Test Acc: 0.486
Validation loss decreased (-0.486475 --> -0.486475).  Saving model ...
Epoch: 5 cost time: 15.200798511505127
Epoch: 5, Steps: 10 | Train Loss: 0.221 Vali Loss: 1.057 Vali Acc: 0.554 Test Loss: 1.057 Test Acc: 0.554
Validation loss decreased (-0.486475 --> -0.554043).  Saving model ...
Epoch: 6 cost time: 15.345603227615356
Epoch: 6, Steps: 10 | Train Loss: 0.081 Vali Loss: 1.158 Vali Acc: 0.541 Test Loss: 1.158 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 14.689121961593628
Epoch: 7, Steps: 10 | Train Loss: 0.036 Vali Loss: 1.070 Vali Acc: 0.541 Test Loss: 1.070 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 15.56470799446106
Epoch: 8, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.991 Vali Acc: 0.635 Test Loss: 0.991 Test Acc: 0.635
Validation loss decreased (-0.554043 --> -0.635125).  Saving model ...
Epoch: 9 cost time: 14.692009210586548
Epoch: 9, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.109 Vali Acc: 0.595 Test Loss: 1.109 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 15.196834564208984
Epoch: 10, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.047 Vali Acc: 0.622 Test Loss: 1.047 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 13.986689805984497
Epoch: 11, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.056 Vali Acc: 0.608 Test Loss: 1.056 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 14.625401496887207
Epoch: 12, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.997 Vali Acc: 0.608 Test Loss: 0.997 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 14.759058237075806
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.023 Vali Acc: 0.595 Test Loss: 1.023 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 13.815772533416748
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.036 Vali Acc: 0.581 Test Loss: 1.036 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 14.975208759307861
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.061 Vali Acc: 0.608 Test Loss: 1.061 Test Acc: 0.608
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 14.394950866699219
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.087 Vali Acc: 0.608 Test Loss: 1.087 Test Acc: 0.608
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 16.28687286376953
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.072 Vali Acc: 0.608 Test Loss: 1.072 Test Acc: 0.608
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 16.708935499191284
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.065 Vali Acc: 0.608 Test Loss: 1.065 Test Acc: 0.608
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm64_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6351351351351351
model parameter : 11119876
model size : 43.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm64_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 33.98766565322876
Epoch: 1, Steps: 10 | Train Loss: 1.429 Vali Loss: 1.370 Vali Acc: 0.378 Test Loss: 1.370 Test Acc: 0.378
Validation loss decreased (inf --> -0.378365).  Saving model ...
Epoch: 2 cost time: 31.611438035964966
Epoch: 2, Steps: 10 | Train Loss: 1.149 Vali Loss: 1.207 Vali Acc: 0.500 Test Loss: 1.207 Test Acc: 0.500
Validation loss decreased (-0.378365 --> -0.499988).  Saving model ...
Epoch: 3 cost time: 31.39575219154358
Epoch: 3, Steps: 10 | Train Loss: 0.777 Vali Loss: 1.163 Vali Acc: 0.514 Test Loss: 1.163 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513502).  Saving model ...
Epoch: 4 cost time: 32.49586462974548
Epoch: 4, Steps: 10 | Train Loss: 0.433 Vali Loss: 1.051 Vali Acc: 0.568 Test Loss: 1.051 Test Acc: 0.568
Validation loss decreased (-0.513502 --> -0.567557).  Saving model ...
Epoch: 5 cost time: 31.34923243522644
Epoch: 5, Steps: 10 | Train Loss: 0.245 Vali Loss: 1.033 Vali Acc: 0.568 Test Loss: 1.033 Test Acc: 0.568
Validation loss decreased (-0.567557 --> -0.567557).  Saving model ...
Epoch: 6 cost time: 29.87532687187195
Epoch: 6, Steps: 10 | Train Loss: 0.090 Vali Loss: 1.051 Vali Acc: 0.595 Test Loss: 1.051 Test Acc: 0.595
Validation loss decreased (-0.567557 --> -0.594584).  Saving model ...
Epoch: 7 cost time: 29.557344436645508
Epoch: 7, Steps: 10 | Train Loss: 0.037 Vali Loss: 1.012 Vali Acc: 0.595 Test Loss: 1.012 Test Acc: 0.595
Validation loss decreased (-0.594584 --> -0.594584).  Saving model ...
Epoch: 8 cost time: 28.91201138496399
Epoch: 8, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.909 Vali Acc: 0.662 Test Loss: 0.909 Test Acc: 0.662
Validation loss decreased (-0.594584 --> -0.662153).  Saving model ...
Epoch: 9 cost time: 31.417706966400146
Epoch: 9, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.982 Vali Acc: 0.635 Test Loss: 0.982 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 31.213425159454346
Epoch: 10, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.987 Vali Acc: 0.622 Test Loss: 0.987 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 29.64934206008911
Epoch: 11, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.988 Vali Acc: 0.649 Test Loss: 0.988 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 29.491204738616943
Epoch: 12, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.136 Vali Acc: 0.649 Test Loss: 1.136 Test Acc: 0.649
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 29.209908723831177
Epoch: 13, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.047 Vali Acc: 0.649 Test Loss: 1.047 Test Acc: 0.649
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 26.690349578857422
Epoch: 14, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.099 Vali Acc: 0.635 Test Loss: 1.099 Test Acc: 0.635
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 23.341577529907227
Epoch: 15, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.122 Vali Acc: 0.622 Test Loss: 1.122 Test Acc: 0.622
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 29.49924373626709
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.276 Vali Acc: 0.608 Test Loss: 1.276 Test Acc: 0.608
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 30.503554105758667
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.174 Vali Acc: 0.635 Test Loss: 1.174 Test Acc: 0.635
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 32.1804735660553
Epoch: 18, Steps: 10 | Train Loss: 0.046 Vali Loss: 1.199 Vali Acc: 0.554 Test Loss: 1.199 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm64_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6621621621621622
model parameter : 37598980
model size : 144.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm64_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 14.080159425735474
Epoch: 1, Steps: 10 | Train Loss: 1.459 Vali Loss: 1.414 Vali Acc: 0.230 Test Loss: 1.414 Test Acc: 0.230
Validation loss decreased (inf --> -0.229716).  Saving model ...
Epoch: 2 cost time: 12.048632860183716
Epoch: 2, Steps: 10 | Train Loss: 1.222 Vali Loss: 1.251 Vali Acc: 0.405 Test Loss: 1.251 Test Acc: 0.405
Validation loss decreased (-0.229716 --> -0.405393).  Saving model ...
Epoch: 3 cost time: 10.58931016921997
Epoch: 3, Steps: 10 | Train Loss: 0.800 Vali Loss: 1.147 Vali Acc: 0.500 Test Loss: 1.147 Test Acc: 0.500
Validation loss decreased (-0.405393 --> -0.499989).  Saving model ...
Epoch: 4 cost time: 12.431413650512695
Epoch: 4, Steps: 10 | Train Loss: 0.433 Vali Loss: 1.132 Vali Acc: 0.527 Test Loss: 1.132 Test Acc: 0.527
Validation loss decreased (-0.499989 --> -0.527016).  Saving model ...
Epoch: 5 cost time: 11.980016946792603
Epoch: 5, Steps: 10 | Train Loss: 0.220 Vali Loss: 1.033 Vali Acc: 0.581 Test Loss: 1.033 Test Acc: 0.581
Validation loss decreased (-0.527016 --> -0.581071).  Saving model ...
Epoch: 6 cost time: 12.091617822647095
Epoch: 6, Steps: 10 | Train Loss: 0.080 Vali Loss: 1.088 Vali Acc: 0.595 Test Loss: 1.088 Test Acc: 0.595
Validation loss decreased (-0.581071 --> -0.594584).  Saving model ...
Epoch: 7 cost time: 12.239564180374146
Epoch: 7, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.042 Vali Acc: 0.554 Test Loss: 1.042 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 11.072789669036865
Epoch: 8, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.030 Vali Acc: 0.608 Test Loss: 1.030 Test Acc: 0.608
Validation loss decreased (-0.594584 --> -0.608098).  Saving model ...
Epoch: 9 cost time: 10.925869703292847
Epoch: 9, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.010 Vali Acc: 0.608 Test Loss: 1.010 Test Acc: 0.608
Validation loss decreased (-0.608098 --> -0.608098).  Saving model ...
Epoch: 10 cost time: 11.890003442764282
Epoch: 10, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.961 Vali Acc: 0.581 Test Loss: 0.961 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 11.504897356033325
Epoch: 11, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.972 Vali Acc: 0.608 Test Loss: 0.972 Test Acc: 0.608
Validation loss decreased (-0.608098 --> -0.608098).  Saving model ...
Epoch: 12 cost time: 11.506805181503296
Epoch: 12, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.979 Vali Acc: 0.635 Test Loss: 0.979 Test Acc: 0.635
Validation loss decreased (-0.608098 --> -0.635125).  Saving model ...
Epoch: 13 cost time: 11.480943202972412
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.996 Vali Acc: 0.635 Test Loss: 0.996 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 11.47874903678894
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.998 Vali Acc: 0.635 Test Loss: 0.998 Test Acc: 0.635
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 10.684201002120972
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.006 Vali Acc: 0.622 Test Loss: 1.006 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 11.560917615890503
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.030 Vali Acc: 0.608 Test Loss: 1.030 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 12.917471647262573
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.017 Vali Acc: 0.635 Test Loss: 1.017 Test Acc: 0.635
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 12.89089560508728
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.012 Vali Acc: 0.622 Test Loss: 1.012 Test Acc: 0.622
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 12.520975351333618
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.026 Vali Acc: 0.608 Test Loss: 1.026 Test Acc: 0.608
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 12.397245407104492
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.035 Vali Acc: 0.608 Test Loss: 1.035 Test Acc: 0.608
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 12.097577095031738
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.042 Vali Acc: 0.622 Test Loss: 1.042 Test Acc: 0.622
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 11.505820751190186
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.042 Vali Acc: 0.622 Test Loss: 1.042 Test Acc: 0.622
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm64_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6351351351351351
model parameter : 11119876
model size : 43.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm64_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 21.263052701950073
Epoch: 1, Steps: 10 | Train Loss: 1.433 Vali Loss: 1.372 Vali Acc: 0.365 Test Loss: 1.372 Test Acc: 0.365
Validation loss decreased (inf --> -0.364851).  Saving model ...
Epoch: 2 cost time: 18.362138509750366
Epoch: 2, Steps: 10 | Train Loss: 1.245 Vali Loss: 1.218 Vali Acc: 0.514 Test Loss: 1.218 Test Acc: 0.514
Validation loss decreased (-0.364851 --> -0.513501).  Saving model ...
Epoch: 3 cost time: 17.959352731704712
Epoch: 3, Steps: 10 | Train Loss: 0.942 Vali Loss: 1.113 Vali Acc: 0.527 Test Loss: 1.113 Test Acc: 0.527
Validation loss decreased (-0.513501 --> -0.527016).  Saving model ...
Epoch: 4 cost time: 17.407052993774414
Epoch: 4, Steps: 10 | Train Loss: 0.609 Vali Loss: 1.111 Vali Acc: 0.541 Test Loss: 1.111 Test Acc: 0.541
Validation loss decreased (-0.527016 --> -0.540529).  Saving model ...
Epoch: 5 cost time: 19.12440586090088
Epoch: 5, Steps: 10 | Train Loss: 0.389 Vali Loss: 1.028 Vali Acc: 0.595 Test Loss: 1.028 Test Acc: 0.595
Validation loss decreased (-0.540529 --> -0.594584).  Saving model ...
Epoch: 6 cost time: 19.8356876373291
Epoch: 6, Steps: 10 | Train Loss: 0.181 Vali Loss: 1.021 Vali Acc: 0.541 Test Loss: 1.021 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 18.137120962142944
Epoch: 7, Steps: 10 | Train Loss: 0.183 Vali Loss: 1.002 Vali Acc: 0.608 Test Loss: 1.002 Test Acc: 0.608
Validation loss decreased (-0.594584 --> -0.608098).  Saving model ...
Epoch: 8 cost time: 17.876752614974976
Epoch: 8, Steps: 10 | Train Loss: 0.036 Vali Loss: 1.050 Vali Acc: 0.595 Test Loss: 1.050 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 17.78018832206726
Epoch: 9, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.005 Vali Acc: 0.662 Test Loss: 1.005 Test Acc: 0.662
Validation loss decreased (-0.608098 --> -0.662152).  Saving model ...
Epoch: 10 cost time: 17.379603624343872
Epoch: 10, Steps: 10 | Train Loss: 0.106 Vali Loss: 1.087 Vali Acc: 0.649 Test Loss: 1.087 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 18.57356333732605
Epoch: 11, Steps: 10 | Train Loss: 0.251 Vali Loss: 1.097 Vali Acc: 0.622 Test Loss: 1.097 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 19.77871799468994
Epoch: 12, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.119 Vali Acc: 0.595 Test Loss: 1.119 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 19.800599813461304
Epoch: 13, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.214 Vali Acc: 0.622 Test Loss: 1.214 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 16.899147033691406
Epoch: 14, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.222 Vali Acc: 0.622 Test Loss: 1.222 Test Acc: 0.622
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 19.089699745178223
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.196 Vali Acc: 0.608 Test Loss: 1.196 Test Acc: 0.608
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 18.42698335647583
Epoch: 16, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.102 Vali Acc: 0.608 Test Loss: 1.102 Test Acc: 0.608
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 18.93981432914734
Epoch: 17, Steps: 10 | Train Loss: 0.120 Vali Loss: 1.326 Vali Acc: 0.595 Test Loss: 1.326 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 17.48357319831848
Epoch: 18, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.915 Vali Acc: 0.622 Test Loss: 0.915 Test Acc: 0.622
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 20.871742725372314
Epoch: 19, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.313 Vali Acc: 0.635 Test Loss: 1.313 Test Acc: 0.635
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm64_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6621621621621622
model parameter : 37598980
model size : 144.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm64_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 9.785214185714722
Epoch: 1, Steps: 10 | Train Loss: 1.459 Vali Loss: 1.405 Vali Acc: 0.216 Test Loss: 1.405 Test Acc: 0.216
Validation loss decreased (inf --> -0.216202).  Saving model ...
Epoch: 2 cost time: 7.539897680282593
Epoch: 2, Steps: 10 | Train Loss: 1.305 Vali Loss: 1.242 Vali Acc: 0.473 Test Loss: 1.242 Test Acc: 0.473
Validation loss decreased (-0.216202 --> -0.472961).  Saving model ...
Epoch: 3 cost time: 7.335701942443848
Epoch: 3, Steps: 10 | Train Loss: 0.965 Vali Loss: 1.206 Vali Acc: 0.432 Test Loss: 1.206 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 8.071897029876709
Epoch: 4, Steps: 10 | Train Loss: 0.612 Vali Loss: 1.204 Vali Acc: 0.486 Test Loss: 1.204 Test Acc: 0.486
Validation loss decreased (-0.472961 --> -0.486474).  Saving model ...
Epoch: 5 cost time: 9.30270791053772
Epoch: 5, Steps: 10 | Train Loss: 0.438 Vali Loss: 1.071 Vali Acc: 0.541 Test Loss: 1.071 Test Acc: 0.541
Validation loss decreased (-0.486474 --> -0.540530).  Saving model ...
Epoch: 6 cost time: 8.86517333984375
Epoch: 6, Steps: 10 | Train Loss: 0.233 Vali Loss: 1.019 Vali Acc: 0.581 Test Loss: 1.019 Test Acc: 0.581
Validation loss decreased (-0.540530 --> -0.581071).  Saving model ...
Epoch: 7 cost time: 8.776034593582153
Epoch: 7, Steps: 10 | Train Loss: 0.120 Vali Loss: 0.909 Vali Acc: 0.676 Test Loss: 0.909 Test Acc: 0.676
Validation loss decreased (-0.581071 --> -0.675667).  Saving model ...
Epoch: 8 cost time: 8.747344970703125
Epoch: 8, Steps: 10 | Train Loss: 0.053 Vali Loss: 1.019 Vali Acc: 0.581 Test Loss: 1.019 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 8.674592018127441
Epoch: 9, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.004 Vali Acc: 0.568 Test Loss: 1.004 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 8.440987586975098
Epoch: 10, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.919 Vali Acc: 0.595 Test Loss: 0.919 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 8.671205520629883
Epoch: 11, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.902 Vali Acc: 0.649 Test Loss: 0.902 Test Acc: 0.649
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 8.668286561965942
Epoch: 12, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.995 Vali Acc: 0.662 Test Loss: 0.995 Test Acc: 0.662
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 8.528524160385132
Epoch: 13, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.918 Vali Acc: 0.662 Test Loss: 0.918 Test Acc: 0.662
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 9.242813110351562
Epoch: 14, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.908 Vali Acc: 0.662 Test Loss: 0.908 Test Acc: 0.662
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 8.900341033935547
Epoch: 15, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.942 Vali Acc: 0.689 Test Loss: 0.942 Test Acc: 0.689
Validation loss decreased (-0.675667 --> -0.689180).  Saving model ...
Epoch: 16 cost time: 8.012161493301392
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.996 Vali Acc: 0.676 Test Loss: 0.996 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 7.567121505737305
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.954 Vali Acc: 0.662 Test Loss: 0.954 Test Acc: 0.662
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 8.482989311218262
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.952 Vali Acc: 0.689 Test Loss: 0.952 Test Acc: 0.689
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 8.559474229812622
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.980 Vali Acc: 0.676 Test Loss: 0.980 Test Acc: 0.676
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 8.499601125717163
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.001 Vali Acc: 0.662 Test Loss: 1.001 Test Acc: 0.662
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 8.082669019699097
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.999 Vali Acc: 0.676 Test Loss: 0.999 Test Acc: 0.676
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 7.96392822265625
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.000 Vali Acc: 0.689 Test Loss: 1.000 Test Acc: 0.689
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 7.510908603668213
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.022 Vali Acc: 0.689 Test Loss: 1.022 Test Acc: 0.689
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 8.114140033721924
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.032 Vali Acc: 0.676 Test Loss: 1.032 Test Acc: 0.676
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 8.115514755249023
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.030 Vali Acc: 0.689 Test Loss: 1.030 Test Acc: 0.689
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm64_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6891891891891891
model parameter : 11119876
model size : 43.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm64_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 25.681740283966064
Epoch: 1, Steps: 10 | Train Loss: 1.397 Vali Loss: 1.372 Vali Acc: 0.351 Test Loss: 1.372 Test Acc: 0.351
Validation loss decreased (inf --> -0.351338).  Saving model ...
Epoch: 2 cost time: 24.09528660774231
Epoch: 2, Steps: 10 | Train Loss: 1.175 Vali Loss: 1.258 Vali Acc: 0.419 Test Loss: 1.258 Test Acc: 0.419
Validation loss decreased (-0.351338 --> -0.418906).  Saving model ...
Epoch: 3 cost time: 23.746827602386475
Epoch: 3, Steps: 10 | Train Loss: 0.822 Vali Loss: 1.143 Vali Acc: 0.541 Test Loss: 1.143 Test Acc: 0.541
Validation loss decreased (-0.418906 --> -0.540529).  Saving model ...
Epoch: 4 cost time: 23.53811550140381
Epoch: 4, Steps: 10 | Train Loss: 0.544 Vali Loss: 1.110 Vali Acc: 0.595 Test Loss: 1.110 Test Acc: 0.595
Validation loss decreased (-0.540529 --> -0.594583).  Saving model ...
Epoch: 5 cost time: 23.092396020889282
Epoch: 5, Steps: 10 | Train Loss: 0.298 Vali Loss: 1.107 Vali Acc: 0.568 Test Loss: 1.107 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 24.415579319000244
Epoch: 6, Steps: 10 | Train Loss: 0.166 Vali Loss: 1.018 Vali Acc: 0.541 Test Loss: 1.018 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 23.372926950454712
Epoch: 7, Steps: 10 | Train Loss: 0.071 Vali Loss: 1.064 Vali Acc: 0.595 Test Loss: 1.064 Test Acc: 0.595
Validation loss decreased (-0.594583 --> -0.594584).  Saving model ...
Epoch: 8 cost time: 24.30427598953247
Epoch: 8, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.041 Vali Acc: 0.568 Test Loss: 1.041 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 24.69236421585083
Epoch: 9, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.147 Vali Acc: 0.568 Test Loss: 1.147 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 24.77952766418457
Epoch: 10, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.082 Vali Acc: 0.595 Test Loss: 1.082 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 24.815845727920532
Epoch: 11, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.109 Vali Acc: 0.568 Test Loss: 1.109 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 23.843045949935913
Epoch: 12, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.163 Vali Acc: 0.595 Test Loss: 1.163 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 23.52582550048828
Epoch: 13, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.105 Vali Acc: 0.635 Test Loss: 1.105 Test Acc: 0.635
Validation loss decreased (-0.594584 --> -0.635124).  Saving model ...
Epoch: 14 cost time: 23.727170944213867
Epoch: 14, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.133 Vali Acc: 0.635 Test Loss: 1.133 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 25.6472110748291
Epoch: 15, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.134 Vali Acc: 0.649 Test Loss: 1.134 Test Acc: 0.649
Validation loss decreased (-0.635124 --> -0.648637).  Saving model ...
Epoch: 16 cost time: 25.182039737701416
Epoch: 16, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.197 Vali Acc: 0.608 Test Loss: 1.197 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 24.989992141723633
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.177 Vali Acc: 0.622 Test Loss: 1.177 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 24.28851580619812
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.156 Vali Acc: 0.608 Test Loss: 1.156 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 24.286076545715332
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.145 Vali Acc: 0.635 Test Loss: 1.145 Test Acc: 0.635
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 23.703930139541626
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.164 Vali Acc: 0.635 Test Loss: 1.164 Test Acc: 0.635
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 25.149303197860718
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.178 Vali Acc: 0.622 Test Loss: 1.178 Test Acc: 0.622
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 24.84438157081604
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.192 Vali Acc: 0.635 Test Loss: 1.192 Test Acc: 0.635
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 22.56017541885376
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.176 Vali Acc: 0.635 Test Loss: 1.176 Test Acc: 0.635
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 22.918797254562378
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.186 Vali Acc: 0.622 Test Loss: 1.186 Test Acc: 0.622
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 21.686132431030273
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.194 Vali Acc: 0.608 Test Loss: 1.194 Test Acc: 0.608
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm64_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6486486486486487
model parameter : 18852612
model size : 73.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm64_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 10.676021337509155
Epoch: 1, Steps: 10 | Train Loss: 1.438 Vali Loss: 1.446 Vali Acc: 0.270 Test Loss: 1.446 Test Acc: 0.270
Validation loss decreased (inf --> -0.270256).  Saving model ...
Epoch: 2 cost time: 9.457424402236938
Epoch: 2, Steps: 10 | Train Loss: 1.207 Vali Loss: 1.309 Vali Acc: 0.378 Test Loss: 1.309 Test Acc: 0.378
Validation loss decreased (-0.270256 --> -0.378365).  Saving model ...
Epoch: 3 cost time: 9.493695497512817
Epoch: 3, Steps: 10 | Train Loss: 0.861 Vali Loss: 1.249 Vali Acc: 0.486 Test Loss: 1.249 Test Acc: 0.486
Validation loss decreased (-0.378365 --> -0.486474).  Saving model ...
Epoch: 4 cost time: 8.836090326309204
Epoch: 4, Steps: 10 | Train Loss: 0.556 Vali Loss: 1.168 Vali Acc: 0.486 Test Loss: 1.168 Test Acc: 0.486
Validation loss decreased (-0.486474 --> -0.486475).  Saving model ...
Epoch: 5 cost time: 9.173992156982422
Epoch: 5, Steps: 10 | Train Loss: 0.326 Vali Loss: 1.114 Vali Acc: 0.541 Test Loss: 1.114 Test Acc: 0.541
Validation loss decreased (-0.486475 --> -0.540529).  Saving model ...
Epoch: 6 cost time: 8.740605115890503
Epoch: 6, Steps: 10 | Train Loss: 0.170 Vali Loss: 1.121 Vali Acc: 0.568 Test Loss: 1.121 Test Acc: 0.568
Validation loss decreased (-0.540529 --> -0.567556).  Saving model ...
Epoch: 7 cost time: 8.427444458007812
Epoch: 7, Steps: 10 | Train Loss: 0.067 Vali Loss: 1.238 Vali Acc: 0.527 Test Loss: 1.238 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 9.4928617477417
Epoch: 8, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.057 Vali Acc: 0.622 Test Loss: 1.057 Test Acc: 0.622
Validation loss decreased (-0.567556 --> -0.621611).  Saving model ...
Epoch: 9 cost time: 9.40665888786316
Epoch: 9, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.148 Vali Acc: 0.608 Test Loss: 1.148 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 10.17112922668457
Epoch: 10, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.117 Vali Acc: 0.581 Test Loss: 1.117 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 10.137037754058838
Epoch: 11, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.200 Vali Acc: 0.568 Test Loss: 1.200 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 9.553613424301147
Epoch: 12, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.303 Vali Acc: 0.595 Test Loss: 1.303 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 9.99571943283081
Epoch: 13, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.159 Vali Acc: 0.595 Test Loss: 1.159 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 9.71519160270691
Epoch: 14, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.184 Vali Acc: 0.608 Test Loss: 1.184 Test Acc: 0.608
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 9.770957708358765
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.228 Vali Acc: 0.608 Test Loss: 1.228 Test Acc: 0.608
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 9.929267168045044
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.250 Vali Acc: 0.595 Test Loss: 1.250 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 10.270371913909912
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.253 Vali Acc: 0.595 Test Loss: 1.253 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 10.120527267456055
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.236 Vali Acc: 0.608 Test Loss: 1.236 Test Acc: 0.608
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm64_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 5612804
model size : 22.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm64_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 18.063496589660645
Epoch: 1, Steps: 10 | Train Loss: 1.396 Vali Loss: 1.379 Vali Acc: 0.351 Test Loss: 1.379 Test Acc: 0.351
Validation loss decreased (inf --> -0.351338).  Saving model ...
Epoch: 2 cost time: 16.059067487716675
Epoch: 2, Steps: 10 | Train Loss: 1.192 Vali Loss: 1.280 Vali Acc: 0.392 Test Loss: 1.280 Test Acc: 0.392
Validation loss decreased (-0.351338 --> -0.391879).  Saving model ...
Epoch: 3 cost time: 15.806923151016235
Epoch: 3, Steps: 10 | Train Loss: 0.840 Vali Loss: 1.147 Vali Acc: 0.554 Test Loss: 1.147 Test Acc: 0.554
Validation loss decreased (-0.391879 --> -0.554043).  Saving model ...
Epoch: 4 cost time: 15.606447696685791
Epoch: 4, Steps: 10 | Train Loss: 0.576 Vali Loss: 1.082 Vali Acc: 0.581 Test Loss: 1.082 Test Acc: 0.581
Validation loss decreased (-0.554043 --> -0.581070).  Saving model ...
Epoch: 5 cost time: 15.944259881973267
Epoch: 5, Steps: 10 | Train Loss: 0.317 Vali Loss: 1.040 Vali Acc: 0.541 Test Loss: 1.040 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 15.856339693069458
Epoch: 6, Steps: 10 | Train Loss: 0.200 Vali Loss: 0.978 Vali Acc: 0.649 Test Loss: 0.978 Test Acc: 0.649
Validation loss decreased (-0.581070 --> -0.648639).  Saving model ...
Epoch: 7 cost time: 16.41451406478882
Epoch: 7, Steps: 10 | Train Loss: 0.091 Vali Loss: 0.939 Vali Acc: 0.608 Test Loss: 0.939 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 16.164985179901123
Epoch: 8, Steps: 10 | Train Loss: 0.064 Vali Loss: 1.094 Vali Acc: 0.595 Test Loss: 1.094 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 14.341542959213257
Epoch: 9, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.037 Vali Acc: 0.622 Test Loss: 1.037 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 15.333491086959839
Epoch: 10, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.075 Vali Acc: 0.635 Test Loss: 1.075 Test Acc: 0.635
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 15.595141649246216
Epoch: 11, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.954 Vali Acc: 0.689 Test Loss: 0.954 Test Acc: 0.689
Validation loss decreased (-0.648639 --> -0.689180).  Saving model ...
Epoch: 12 cost time: 15.537785291671753
Epoch: 12, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.069 Vali Acc: 0.635 Test Loss: 1.069 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 16.228981256484985
Epoch: 13, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.098 Vali Acc: 0.649 Test Loss: 1.098 Test Acc: 0.649
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 16.072816610336304
Epoch: 14, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.972 Vali Acc: 0.649 Test Loss: 0.972 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 14.384792804718018
Epoch: 15, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.001 Vali Acc: 0.662 Test Loss: 1.001 Test Acc: 0.662
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 13.92727017402649
Epoch: 16, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.996 Vali Acc: 0.662 Test Loss: 0.996 Test Acc: 0.662
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 14.306884527206421
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.017 Vali Acc: 0.662 Test Loss: 1.017 Test Acc: 0.662
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 15.645663499832153
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.013 Vali Acc: 0.662 Test Loss: 1.013 Test Acc: 0.662
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 15.806254148483276
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.989 Vali Acc: 0.662 Test Loss: 0.989 Test Acc: 0.662
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 16.5027859210968
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.998 Vali Acc: 0.662 Test Loss: 0.998 Test Acc: 0.662
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 15.660725593566895
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.002 Vali Acc: 0.676 Test Loss: 1.002 Test Acc: 0.676
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm64_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6891891891891891
model parameter : 18852612
model size : 73.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm64_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 7.418633460998535
Epoch: 1, Steps: 10 | Train Loss: 1.442 Vali Loss: 1.447 Vali Acc: 0.270 Test Loss: 1.447 Test Acc: 0.270
Validation loss decreased (inf --> -0.270256).  Saving model ...
Epoch: 2 cost time: 6.131728649139404
Epoch: 2, Steps: 10 | Train Loss: 1.206 Vali Loss: 1.316 Vali Acc: 0.378 Test Loss: 1.316 Test Acc: 0.378
Validation loss decreased (-0.270256 --> -0.378365).  Saving model ...
Epoch: 3 cost time: 5.147027254104614
Epoch: 3, Steps: 10 | Train Loss: 0.857 Vali Loss: 1.253 Vali Acc: 0.486 Test Loss: 1.253 Test Acc: 0.486
Validation loss decreased (-0.378365 --> -0.486474).  Saving model ...
Epoch: 4 cost time: 6.9245827198028564
Epoch: 4, Steps: 10 | Train Loss: 0.550 Vali Loss: 1.180 Vali Acc: 0.514 Test Loss: 1.180 Test Acc: 0.514
Validation loss decreased (-0.486474 --> -0.513502).  Saving model ...
Epoch: 5 cost time: 6.649014472961426
Epoch: 5, Steps: 10 | Train Loss: 0.322 Vali Loss: 1.103 Vali Acc: 0.568 Test Loss: 1.103 Test Acc: 0.568
Validation loss decreased (-0.513502 --> -0.567557).  Saving model ...
Epoch: 6 cost time: 6.525432348251343
Epoch: 6, Steps: 10 | Train Loss: 0.173 Vali Loss: 1.159 Vali Acc: 0.554 Test Loss: 1.159 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.573312520980835
Epoch: 7, Steps: 10 | Train Loss: 0.067 Vali Loss: 1.207 Vali Acc: 0.568 Test Loss: 1.207 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.643067121505737
Epoch: 8, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.053 Vali Acc: 0.622 Test Loss: 1.053 Test Acc: 0.622
Validation loss decreased (-0.567557 --> -0.621611).  Saving model ...
Epoch: 9 cost time: 6.722307205200195
Epoch: 9, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.156 Vali Acc: 0.608 Test Loss: 1.156 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.337679147720337
Epoch: 10, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.140 Vali Acc: 0.595 Test Loss: 1.140 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.727603435516357
Epoch: 11, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.126 Vali Acc: 0.622 Test Loss: 1.126 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 6.692110061645508
Epoch: 12, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.209 Vali Acc: 0.608 Test Loss: 1.209 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 6.9141271114349365
Epoch: 13, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.161 Vali Acc: 0.649 Test Loss: 1.161 Test Acc: 0.649
Validation loss decreased (-0.621611 --> -0.648637).  Saving model ...
Epoch: 14 cost time: 6.9195616245269775
Epoch: 14, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.136 Vali Acc: 0.649 Test Loss: 1.136 Test Acc: 0.649
Validation loss decreased (-0.648637 --> -0.648637).  Saving model ...
Epoch: 15 cost time: 6.857377290725708
Epoch: 15, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.135 Vali Acc: 0.662 Test Loss: 1.135 Test Acc: 0.662
Validation loss decreased (-0.648637 --> -0.662151).  Saving model ...
Epoch: 16 cost time: 6.5197694301605225
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.193 Vali Acc: 0.622 Test Loss: 1.193 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 6.82255220413208
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.139 Vali Acc: 0.649 Test Loss: 1.139 Test Acc: 0.649
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 7.527299642562866
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.214 Vali Acc: 0.622 Test Loss: 1.214 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 6.323444128036499
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.255 Vali Acc: 0.595 Test Loss: 1.255 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 6.439402103424072
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.336 Vali Acc: 0.622 Test Loss: 1.336 Test Acc: 0.622
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 6.63781213760376
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.374 Vali Acc: 0.649 Test Loss: 1.374 Test Acc: 0.649
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 6.896736145019531
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.243 Vali Acc: 0.622 Test Loss: 1.243 Test Acc: 0.622
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 6.854088306427002
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.214 Vali Acc: 0.622 Test Loss: 1.214 Test Acc: 0.622
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 6.71207070350647
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.192 Vali Acc: 0.622 Test Loss: 1.192 Test Acc: 0.622
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 6.620261192321777
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.222 Vali Acc: 0.649 Test Loss: 1.222 Test Acc: 0.649
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm64_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6621621621621622
model parameter : 5612804
model size : 22.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm64_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 11.993134260177612
Epoch: 1, Steps: 10 | Train Loss: 1.397 Vali Loss: 1.374 Vali Acc: 0.378 Test Loss: 1.374 Test Acc: 0.378
Validation loss decreased (inf --> -0.378365).  Saving model ...
Epoch: 2 cost time: 9.677127122879028
Epoch: 2, Steps: 10 | Train Loss: 1.221 Vali Loss: 1.263 Vali Acc: 0.459 Test Loss: 1.263 Test Acc: 0.459
Validation loss decreased (-0.378365 --> -0.459447).  Saving model ...
Epoch: 3 cost time: 8.156968116760254
Epoch: 3, Steps: 10 | Train Loss: 0.934 Vali Loss: 1.141 Vali Acc: 0.554 Test Loss: 1.141 Test Acc: 0.554
Validation loss decreased (-0.459447 --> -0.554043).  Saving model ...
Epoch: 4 cost time: 11.708579063415527
Epoch: 4, Steps: 10 | Train Loss: 0.658 Vali Loss: 1.066 Vali Acc: 0.554 Test Loss: 1.066 Test Acc: 0.554
Validation loss decreased (-0.554043 --> -0.554043).  Saving model ...
Epoch: 5 cost time: 11.296201944351196
Epoch: 5, Steps: 10 | Train Loss: 0.384 Vali Loss: 1.088 Vali Acc: 0.541 Test Loss: 1.088 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 10.716434001922607
Epoch: 6, Steps: 10 | Train Loss: 0.242 Vali Loss: 0.979 Vali Acc: 0.622 Test Loss: 0.979 Test Acc: 0.622
Validation loss decreased (-0.554043 --> -0.621612).  Saving model ...
Epoch: 7 cost time: 11.180882930755615
Epoch: 7, Steps: 10 | Train Loss: 0.110 Vali Loss: 0.908 Vali Acc: 0.622 Test Loss: 0.908 Test Acc: 0.622
Validation loss decreased (-0.621612 --> -0.621613).  Saving model ...
Epoch: 8 cost time: 11.144655227661133
Epoch: 8, Steps: 10 | Train Loss: 0.044 Vali Loss: 1.035 Vali Acc: 0.649 Test Loss: 1.035 Test Acc: 0.649
Validation loss decreased (-0.621613 --> -0.648638).  Saving model ...
Epoch: 9 cost time: 11.17961597442627
Epoch: 9, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.940 Vali Acc: 0.622 Test Loss: 0.940 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 10.502547979354858
Epoch: 10, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.941 Vali Acc: 0.622 Test Loss: 0.941 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 10.564356088638306
Epoch: 11, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.004 Vali Acc: 0.649 Test Loss: 1.004 Test Acc: 0.649
Validation loss decreased (-0.648638 --> -0.648639).  Saving model ...
Epoch: 12 cost time: 10.946948766708374
Epoch: 12, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.999 Vali Acc: 0.622 Test Loss: 0.999 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 10.904700756072998
Epoch: 13, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.944 Vali Acc: 0.662 Test Loss: 0.944 Test Acc: 0.662
Validation loss decreased (-0.648639 --> -0.662153).  Saving model ...
Epoch: 14 cost time: 10.619987726211548
Epoch: 14, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.985 Vali Acc: 0.622 Test Loss: 0.985 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 11.168472290039062
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.032 Vali Acc: 0.622 Test Loss: 1.032 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 8.406033277511597
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.993 Vali Acc: 0.622 Test Loss: 0.993 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 10.412411451339722
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.046 Vali Acc: 0.622 Test Loss: 1.046 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 10.733510255813599
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.046 Vali Acc: 0.622 Test Loss: 1.046 Test Acc: 0.622
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 10.25977897644043
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.034 Vali Acc: 0.622 Test Loss: 1.034 Test Acc: 0.622
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 10.51925015449524
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.067 Vali Acc: 0.622 Test Loss: 1.067 Test Acc: 0.622
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 10.416811227798462
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.073 Vali Acc: 0.622 Test Loss: 1.073 Test Acc: 0.622
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 10.201857328414917
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.090 Vali Acc: 0.622 Test Loss: 1.090 Test Acc: 0.622
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 8.422340154647827
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.074 Vali Acc: 0.635 Test Loss: 1.074 Test Acc: 0.635
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm64_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6621621621621622
model parameter : 18852612
model size : 73.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm64_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 6.288505554199219
Epoch: 1, Steps: 10 | Train Loss: 1.436 Vali Loss: 1.442 Vali Acc: 0.284 Test Loss: 1.442 Test Acc: 0.284
Validation loss decreased (inf --> -0.283769).  Saving model ...
Epoch: 2 cost time: 4.798331022262573
Epoch: 2, Steps: 10 | Train Loss: 1.241 Vali Loss: 1.304 Vali Acc: 0.365 Test Loss: 1.304 Test Acc: 0.365
Validation loss decreased (-0.283769 --> -0.364852).  Saving model ...
Epoch: 3 cost time: 3.305586338043213
Epoch: 3, Steps: 10 | Train Loss: 0.947 Vali Loss: 1.236 Vali Acc: 0.500 Test Loss: 1.236 Test Acc: 0.500
Validation loss decreased (-0.364852 --> -0.499988).  Saving model ...
Epoch: 4 cost time: 4.984129428863525
Epoch: 4, Steps: 10 | Train Loss: 0.667 Vali Loss: 1.139 Vali Acc: 0.514 Test Loss: 1.139 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513502).  Saving model ...
Epoch: 5 cost time: 4.824804782867432
Epoch: 5, Steps: 10 | Train Loss: 0.438 Vali Loss: 1.067 Vali Acc: 0.541 Test Loss: 1.067 Test Acc: 0.541
Validation loss decreased (-0.513502 --> -0.540530).  Saving model ...
Epoch: 6 cost time: 4.686480760574341
Epoch: 6, Steps: 10 | Train Loss: 0.252 Vali Loss: 1.025 Vali Acc: 0.554 Test Loss: 1.025 Test Acc: 0.554
Validation loss decreased (-0.540530 --> -0.554044).  Saving model ...
Epoch: 7 cost time: 4.488461256027222
Epoch: 7, Steps: 10 | Train Loss: 0.118 Vali Loss: 1.099 Vali Acc: 0.608 Test Loss: 1.099 Test Acc: 0.608
Validation loss decreased (-0.554044 --> -0.608097).  Saving model ...
Epoch: 8 cost time: 4.179519176483154
Epoch: 8, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.941 Vali Acc: 0.649 Test Loss: 0.941 Test Acc: 0.649
Validation loss decreased (-0.608097 --> -0.648639).  Saving model ...
Epoch: 9 cost time: 4.56788444519043
Epoch: 9, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.021 Vali Acc: 0.676 Test Loss: 1.021 Test Acc: 0.676
Validation loss decreased (-0.648639 --> -0.675665).  Saving model ...
Epoch: 10 cost time: 5.077948093414307
Epoch: 10, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.011 Vali Acc: 0.635 Test Loss: 1.011 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.04142951965332
Epoch: 11, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.051 Vali Acc: 0.635 Test Loss: 1.051 Test Acc: 0.635
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.078466892242432
Epoch: 12, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.076 Vali Acc: 0.622 Test Loss: 1.076 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.138110399246216
Epoch: 13, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.045 Vali Acc: 0.662 Test Loss: 1.045 Test Acc: 0.662
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.97526216506958
Epoch: 14, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.078 Vali Acc: 0.649 Test Loss: 1.078 Test Acc: 0.649
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.815901756286621
Epoch: 15, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.106 Vali Acc: 0.635 Test Loss: 1.106 Test Acc: 0.635
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 5.392462730407715
Epoch: 16, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.112 Vali Acc: 0.635 Test Loss: 1.112 Test Acc: 0.635
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 5.160289764404297
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.115 Vali Acc: 0.635 Test Loss: 1.115 Test Acc: 0.635
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 5.3476197719573975
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.118 Vali Acc: 0.635 Test Loss: 1.118 Test Acc: 0.635
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 4.70822811126709
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.140 Vali Acc: 0.622 Test Loss: 1.140 Test Acc: 0.622
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm64_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6756756756756757
model parameter : 5612804
model size : 22.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm64_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 17.139914751052856
Epoch: 1, Steps: 10 | Train Loss: 1.420 Vali Loss: 1.360 Vali Acc: 0.311 Test Loss: 1.360 Test Acc: 0.311
Validation loss decreased (inf --> -0.310797).  Saving model ...
Epoch: 2 cost time: 14.168882131576538
Epoch: 2, Steps: 10 | Train Loss: 1.207 Vali Loss: 1.227 Vali Acc: 0.486 Test Loss: 1.227 Test Acc: 0.486
Validation loss decreased (-0.310797 --> -0.486474).  Saving model ...
Epoch: 3 cost time: 14.684312105178833
Epoch: 3, Steps: 10 | Train Loss: 0.870 Vali Loss: 1.162 Vali Acc: 0.446 Test Loss: 1.162 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 13.915854930877686
Epoch: 4, Steps: 10 | Train Loss: 0.554 Vali Loss: 1.176 Vali Acc: 0.500 Test Loss: 1.176 Test Acc: 0.500
Validation loss decreased (-0.486474 --> -0.499988).  Saving model ...
Epoch: 5 cost time: 14.784817934036255
Epoch: 5, Steps: 10 | Train Loss: 0.330 Vali Loss: 1.084 Vali Acc: 0.541 Test Loss: 1.084 Test Acc: 0.541
Validation loss decreased (-0.499988 --> -0.540530).  Saving model ...
Epoch: 6 cost time: 14.765621900558472
Epoch: 6, Steps: 10 | Train Loss: 0.180 Vali Loss: 1.140 Vali Acc: 0.514 Test Loss: 1.140 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 14.719177961349487
Epoch: 7, Steps: 10 | Train Loss: 0.087 Vali Loss: 1.131 Vali Acc: 0.581 Test Loss: 1.131 Test Acc: 0.581
Validation loss decreased (-0.540530 --> -0.581070).  Saving model ...
Epoch: 8 cost time: 13.92171835899353
Epoch: 8, Steps: 10 | Train Loss: 0.040 Vali Loss: 1.289 Vali Acc: 0.500 Test Loss: 1.289 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 14.446698427200317
Epoch: 9, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.250 Vali Acc: 0.581 Test Loss: 1.250 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 14.130994081497192
Epoch: 10, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.250 Vali Acc: 0.581 Test Loss: 1.250 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 14.43307375907898
Epoch: 11, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.308 Vali Acc: 0.527 Test Loss: 1.308 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 15.452144145965576
Epoch: 12, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.298 Vali Acc: 0.568 Test Loss: 1.298 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 14.93365216255188
Epoch: 13, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.283 Vali Acc: 0.608 Test Loss: 1.283 Test Acc: 0.608
Validation loss decreased (-0.581070 --> -0.608095).  Saving model ...
Epoch: 14 cost time: 15.46451711654663
Epoch: 14, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.292 Vali Acc: 0.622 Test Loss: 1.292 Test Acc: 0.622
Validation loss decreased (-0.608095 --> -0.621609).  Saving model ...
Epoch: 15 cost time: 15.343207120895386
Epoch: 15, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.297 Vali Acc: 0.595 Test Loss: 1.297 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 14.48476266860962
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.309 Vali Acc: 0.595 Test Loss: 1.309 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 15.36727237701416
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.299 Vali Acc: 0.622 Test Loss: 1.299 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 15.229355573654175
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.306 Vali Acc: 0.635 Test Loss: 1.306 Test Acc: 0.635
Validation loss decreased (-0.621609 --> -0.635122).  Saving model ...
Epoch: 19 cost time: 15.645782470703125
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.321 Vali Acc: 0.608 Test Loss: 1.321 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 15.231632471084595
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.332 Vali Acc: 0.595 Test Loss: 1.332 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 14.044096231460571
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.338 Vali Acc: 0.581 Test Loss: 1.338 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 13.68348503112793
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.345 Vali Acc: 0.595 Test Loss: 1.345 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 14.61571192741394
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.359 Vali Acc: 0.595 Test Loss: 1.359 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 13.605350255966187
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.413 Vali Acc: 0.581 Test Loss: 1.413 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 14.294590473175049
Epoch: 25, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.309 Vali Acc: 0.595 Test Loss: 1.309 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 13.923619985580444
Epoch: 26, Steps: 10 | Train Loss: 0.049 Vali Loss: 1.590 Vali Acc: 0.459 Test Loss: 1.590 Test Acc: 0.459
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 10.15823245048523
Epoch: 27, Steps: 10 | Train Loss: 0.049 Vali Loss: 1.519 Vali Acc: 0.527 Test Loss: 1.519 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 13.016618013381958
Epoch: 28, Steps: 10 | Train Loss: 0.070 Vali Loss: 1.843 Vali Acc: 0.459 Test Loss: 1.843 Test Acc: 0.459
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm64_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6351351351351351
model parameter : 9479428
model size : 37.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm64_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 7.058417797088623
Epoch: 1, Steps: 10 | Train Loss: 1.380 Vali Loss: 1.307 Vali Acc: 0.405 Test Loss: 1.307 Test Acc: 0.405
Validation loss decreased (inf --> -0.405392).  Saving model ...
Epoch: 2 cost time: 5.247916221618652
Epoch: 2, Steps: 10 | Train Loss: 1.183 Vali Loss: 1.211 Vali Acc: 0.554 Test Loss: 1.211 Test Acc: 0.554
Validation loss decreased (-0.405392 --> -0.554042).  Saving model ...
Epoch: 3 cost time: 4.944461345672607
Epoch: 3, Steps: 10 | Train Loss: 0.861 Vali Loss: 1.147 Vali Acc: 0.486 Test Loss: 1.147 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.334107160568237
Epoch: 4, Steps: 10 | Train Loss: 0.555 Vali Loss: 1.016 Vali Acc: 0.608 Test Loss: 1.016 Test Acc: 0.608
Validation loss decreased (-0.554042 --> -0.608098).  Saving model ...
Epoch: 5 cost time: 5.913788318634033
Epoch: 5, Steps: 10 | Train Loss: 0.323 Vali Loss: 1.149 Vali Acc: 0.459 Test Loss: 1.149 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.667034864425659
Epoch: 6, Steps: 10 | Train Loss: 0.208 Vali Loss: 0.987 Vali Acc: 0.527 Test Loss: 0.987 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.1652350425720215
Epoch: 7, Steps: 10 | Train Loss: 0.088 Vali Loss: 1.133 Vali Acc: 0.500 Test Loss: 1.133 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 5.85702919960022
Epoch: 8, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.921 Vali Acc: 0.595 Test Loss: 0.921 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 5.872358083724976
Epoch: 9, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.010 Vali Acc: 0.581 Test Loss: 1.010 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 6.098930597305298
Epoch: 10, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.063 Vali Acc: 0.554 Test Loss: 1.063 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 6.01154637336731
Epoch: 11, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.974 Vali Acc: 0.622 Test Loss: 0.974 Test Acc: 0.622
Validation loss decreased (-0.608098 --> -0.621612).  Saving model ...
Epoch: 12 cost time: 6.0458948612213135
Epoch: 12, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.973 Vali Acc: 0.608 Test Loss: 0.973 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.769906759262085
Epoch: 13, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.014 Vali Acc: 0.568 Test Loss: 1.014 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.814547777175903
Epoch: 14, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.017 Vali Acc: 0.581 Test Loss: 1.017 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.7664666175842285
Epoch: 15, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.004 Vali Acc: 0.581 Test Loss: 1.004 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 5.852243900299072
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.006 Vali Acc: 0.581 Test Loss: 1.006 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 5.784121751785278
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.019 Vali Acc: 0.581 Test Loss: 1.019 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 5.6191394329071045
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.027 Vali Acc: 0.581 Test Loss: 1.027 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 5.728700399398804
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.032 Vali Acc: 0.581 Test Loss: 1.032 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 5.90010404586792
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.049 Vali Acc: 0.568 Test Loss: 1.049 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 5.607904434204102
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.048 Vali Acc: 0.581 Test Loss: 1.048 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm64_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 2859268
model size : 12.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm64_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 11.30775237083435
Epoch: 1, Steps: 10 | Train Loss: 1.421 Vali Loss: 1.359 Vali Acc: 0.338 Test Loss: 1.359 Test Acc: 0.338
Validation loss decreased (inf --> -0.337824).  Saving model ...
Epoch: 2 cost time: 9.883512735366821
Epoch: 2, Steps: 10 | Train Loss: 1.218 Vali Loss: 1.223 Vali Acc: 0.486 Test Loss: 1.223 Test Acc: 0.486
Validation loss decreased (-0.337824 --> -0.486474).  Saving model ...
Epoch: 3 cost time: 9.914600372314453
Epoch: 3, Steps: 10 | Train Loss: 0.872 Vali Loss: 1.160 Vali Acc: 0.486 Test Loss: 1.160 Test Acc: 0.486
Validation loss decreased (-0.486474 --> -0.486475).  Saving model ...
Epoch: 4 cost time: 9.786983013153076
Epoch: 4, Steps: 10 | Train Loss: 0.565 Vali Loss: 1.189 Vali Acc: 0.486 Test Loss: 1.189 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 9.889442443847656
Epoch: 5, Steps: 10 | Train Loss: 0.326 Vali Loss: 1.089 Vali Acc: 0.581 Test Loss: 1.089 Test Acc: 0.581
Validation loss decreased (-0.486475 --> -0.581070).  Saving model ...
Epoch: 6 cost time: 9.420441150665283
Epoch: 6, Steps: 10 | Train Loss: 0.196 Vali Loss: 1.193 Vali Acc: 0.541 Test Loss: 1.193 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 9.600265264511108
Epoch: 7, Steps: 10 | Train Loss: 0.087 Vali Loss: 1.104 Vali Acc: 0.595 Test Loss: 1.104 Test Acc: 0.595
Validation loss decreased (-0.581070 --> -0.594584).  Saving model ...
Epoch: 8 cost time: 9.643537998199463
Epoch: 8, Steps: 10 | Train Loss: 0.046 Vali Loss: 1.227 Vali Acc: 0.541 Test Loss: 1.227 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 9.632948875427246
Epoch: 9, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.281 Vali Acc: 0.527 Test Loss: 1.281 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 9.38136601448059
Epoch: 10, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.209 Vali Acc: 0.581 Test Loss: 1.209 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 9.67113733291626
Epoch: 11, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.297 Vali Acc: 0.554 Test Loss: 1.297 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 9.67646312713623
Epoch: 12, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.309 Vali Acc: 0.581 Test Loss: 1.309 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 9.457015037536621
Epoch: 13, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.281 Vali Acc: 0.581 Test Loss: 1.281 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 9.790411949157715
Epoch: 14, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.278 Vali Acc: 0.581 Test Loss: 1.278 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 9.580944299697876
Epoch: 15, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.281 Vali Acc: 0.595 Test Loss: 1.281 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 9.329952001571655
Epoch: 16, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.337 Vali Acc: 0.554 Test Loss: 1.337 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 9.200021743774414
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.303 Vali Acc: 0.554 Test Loss: 1.303 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm64_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 9479428
model size : 37.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm64_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.431759357452393
Epoch: 1, Steps: 10 | Train Loss: 1.378 Vali Loss: 1.304 Vali Acc: 0.446 Test Loss: 1.304 Test Acc: 0.446
Validation loss decreased (inf --> -0.445933).  Saving model ...
Epoch: 2 cost time: 4.141726493835449
Epoch: 2, Steps: 10 | Train Loss: 1.178 Vali Loss: 1.212 Vali Acc: 0.527 Test Loss: 1.212 Test Acc: 0.527
Validation loss decreased (-0.445933 --> -0.527015).  Saving model ...
Epoch: 3 cost time: 4.03050971031189
Epoch: 3, Steps: 10 | Train Loss: 0.857 Vali Loss: 1.138 Vali Acc: 0.500 Test Loss: 1.138 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.004338026046753
Epoch: 4, Steps: 10 | Train Loss: 0.547 Vali Loss: 1.016 Vali Acc: 0.568 Test Loss: 1.016 Test Acc: 0.568
Validation loss decreased (-0.527015 --> -0.567557).  Saving model ...
Epoch: 5 cost time: 3.970548629760742
Epoch: 5, Steps: 10 | Train Loss: 0.329 Vali Loss: 1.138 Vali Acc: 0.514 Test Loss: 1.138 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.066017150878906
Epoch: 6, Steps: 10 | Train Loss: 0.199 Vali Loss: 0.981 Vali Acc: 0.541 Test Loss: 0.981 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.8421616554260254
Epoch: 7, Steps: 10 | Train Loss: 0.085 Vali Loss: 1.149 Vali Acc: 0.527 Test Loss: 1.149 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.144724130630493
Epoch: 8, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.961 Vali Acc: 0.568 Test Loss: 0.961 Test Acc: 0.568
Validation loss decreased (-0.567557 --> -0.567558).  Saving model ...
Epoch: 9 cost time: 3.9653778076171875
Epoch: 9, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.035 Vali Acc: 0.595 Test Loss: 1.035 Test Acc: 0.595
Validation loss decreased (-0.567558 --> -0.594584).  Saving model ...
Epoch: 10 cost time: 3.9244916439056396
Epoch: 10, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.063 Vali Acc: 0.608 Test Loss: 1.063 Test Acc: 0.608
Validation loss decreased (-0.594584 --> -0.608097).  Saving model ...
Epoch: 11 cost time: 3.1453909873962402
Epoch: 11, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.955 Vali Acc: 0.608 Test Loss: 0.955 Test Acc: 0.608
Validation loss decreased (-0.608097 --> -0.608099).  Saving model ...
Epoch: 12 cost time: 3.1558308601379395
Epoch: 12, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.960 Vali Acc: 0.595 Test Loss: 0.960 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.259418249130249
Epoch: 13, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.039 Vali Acc: 0.608 Test Loss: 1.039 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.7704832553863525
Epoch: 14, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.032 Vali Acc: 0.635 Test Loss: 1.032 Test Acc: 0.635
Validation loss decreased (-0.608099 --> -0.635125).  Saving model ...
Epoch: 15 cost time: 4.457076787948608
Epoch: 15, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.986 Vali Acc: 0.649 Test Loss: 0.986 Test Acc: 0.649
Validation loss decreased (-0.635125 --> -0.648639).  Saving model ...
Epoch: 16 cost time: 4.393594264984131
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.998 Vali Acc: 0.622 Test Loss: 0.998 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.4713006019592285
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.028 Vali Acc: 0.649 Test Loss: 1.028 Test Acc: 0.649
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.2868945598602295
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.038 Vali Acc: 0.649 Test Loss: 1.038 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 4.796216249465942
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.029 Vali Acc: 0.662 Test Loss: 1.029 Test Acc: 0.662
Validation loss decreased (-0.648639 --> -0.662152).  Saving model ...
Epoch: 20 cost time: 5.826066970825195
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.030 Vali Acc: 0.662 Test Loss: 1.030 Test Acc: 0.662
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 5.876383066177368
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.077 Vali Acc: 0.635 Test Loss: 1.077 Test Acc: 0.635
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 5.55925989151001
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.100 Vali Acc: 0.649 Test Loss: 1.100 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 5.943160533905029
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.090 Vali Acc: 0.649 Test Loss: 1.090 Test Acc: 0.649
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 6.0998215675354
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.093 Vali Acc: 0.608 Test Loss: 1.093 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 5.145304203033447
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.117 Vali Acc: 0.622 Test Loss: 1.117 Test Acc: 0.622
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 5.787745714187622
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.116 Vali Acc: 0.635 Test Loss: 1.116 Test Acc: 0.635
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 5.67849063873291
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.111 Vali Acc: 0.649 Test Loss: 1.111 Test Acc: 0.649
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 5.889643430709839
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.111 Vali Acc: 0.649 Test Loss: 1.111 Test Acc: 0.649
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 6.208336591720581
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.109 Vali Acc: 0.635 Test Loss: 1.109 Test Acc: 0.635
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm64_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6621621621621622
model parameter : 2859268
model size : 12.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm64_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 10.866280317306519
Epoch: 1, Steps: 10 | Train Loss: 1.410 Vali Loss: 1.362 Vali Acc: 0.324 Test Loss: 1.362 Test Acc: 0.324
Validation loss decreased (inf --> -0.324311).  Saving model ...
Epoch: 2 cost time: 8.8155996799469
Epoch: 2, Steps: 10 | Train Loss: 1.238 Vali Loss: 1.233 Vali Acc: 0.446 Test Loss: 1.233 Test Acc: 0.446
Validation loss decreased (-0.324311 --> -0.445934).  Saving model ...
Epoch: 3 cost time: 9.092729330062866
Epoch: 3, Steps: 10 | Train Loss: 0.959 Vali Loss: 1.179 Vali Acc: 0.473 Test Loss: 1.179 Test Acc: 0.473
Validation loss decreased (-0.445934 --> -0.472961).  Saving model ...
Epoch: 4 cost time: 9.24031949043274
Epoch: 4, Steps: 10 | Train Loss: 0.678 Vali Loss: 1.147 Vali Acc: 0.500 Test Loss: 1.147 Test Acc: 0.500
Validation loss decreased (-0.472961 --> -0.499989).  Saving model ...
Epoch: 5 cost time: 8.919737815856934
Epoch: 5, Steps: 10 | Train Loss: 0.446 Vali Loss: 1.101 Vali Acc: 0.486 Test Loss: 1.101 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 9.041162729263306
Epoch: 6, Steps: 10 | Train Loss: 0.283 Vali Loss: 1.063 Vali Acc: 0.541 Test Loss: 1.063 Test Acc: 0.541
Validation loss decreased (-0.499989 --> -0.540530).  Saving model ...
Epoch: 7 cost time: 8.728718519210815
Epoch: 7, Steps: 10 | Train Loss: 0.137 Vali Loss: 1.040 Vali Acc: 0.500 Test Loss: 1.040 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 9.121045112609863
Epoch: 8, Steps: 10 | Train Loss: 0.079 Vali Loss: 1.266 Vali Acc: 0.527 Test Loss: 1.266 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 8.591091632843018
Epoch: 9, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.029 Vali Acc: 0.568 Test Loss: 1.029 Test Acc: 0.568
Validation loss decreased (-0.540530 --> -0.567557).  Saving model ...
Epoch: 10 cost time: 9.083949089050293
Epoch: 10, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.121 Vali Acc: 0.581 Test Loss: 1.121 Test Acc: 0.581
Validation loss decreased (-0.567557 --> -0.581070).  Saving model ...
Epoch: 11 cost time: 8.7261483669281
Epoch: 11, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.054 Vali Acc: 0.568 Test Loss: 1.054 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 9.102022886276245
Epoch: 12, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.048 Vali Acc: 0.568 Test Loss: 1.048 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 8.990556478500366
Epoch: 13, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.100 Vali Acc: 0.608 Test Loss: 1.100 Test Acc: 0.608
Validation loss decreased (-0.581070 --> -0.608097).  Saving model ...
Epoch: 14 cost time: 8.865135669708252
Epoch: 14, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.079 Vali Acc: 0.608 Test Loss: 1.079 Test Acc: 0.608
Validation loss decreased (-0.608097 --> -0.608097).  Saving model ...
Epoch: 15 cost time: 8.937474250793457
Epoch: 15, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.055 Vali Acc: 0.622 Test Loss: 1.055 Test Acc: 0.622
Validation loss decreased (-0.608097 --> -0.621611).  Saving model ...
Epoch: 16 cost time: 9.337299823760986
Epoch: 16, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.085 Vali Acc: 0.608 Test Loss: 1.085 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 9.025568008422852
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.078 Vali Acc: 0.608 Test Loss: 1.078 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 7.602351427078247
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.091 Vali Acc: 0.608 Test Loss: 1.091 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 7.190838575363159
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.085 Vali Acc: 0.608 Test Loss: 1.085 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 8.296529769897461
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.092 Vali Acc: 0.608 Test Loss: 1.092 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 8.314880609512329
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.107 Vali Acc: 0.608 Test Loss: 1.107 Test Acc: 0.608
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 8.32823371887207
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.102 Vali Acc: 0.608 Test Loss: 1.102 Test Acc: 0.608
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 8.699305772781372
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.104 Vali Acc: 0.608 Test Loss: 1.104 Test Acc: 0.608
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 8.538277626037598
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.113 Vali Acc: 0.608 Test Loss: 1.113 Test Acc: 0.608
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 8.355443716049194
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.123 Vali Acc: 0.608 Test Loss: 1.123 Test Acc: 0.608
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm64_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 9479428
model size : 37.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm64_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 6.2136523723602295
Epoch: 1, Steps: 10 | Train Loss: 1.382 Vali Loss: 1.297 Vali Acc: 0.446 Test Loss: 1.297 Test Acc: 0.446
Validation loss decreased (inf --> -0.445933).  Saving model ...
Epoch: 2 cost time: 3.972566604614258
Epoch: 2, Steps: 10 | Train Loss: 1.196 Vali Loss: 1.198 Vali Acc: 0.527 Test Loss: 1.198 Test Acc: 0.527
Validation loss decreased (-0.445933 --> -0.527015).  Saving model ...
Epoch: 3 cost time: 4.047235727310181
Epoch: 3, Steps: 10 | Train Loss: 0.905 Vali Loss: 1.149 Vali Acc: 0.541 Test Loss: 1.149 Test Acc: 0.541
Validation loss decreased (-0.527015 --> -0.540529).  Saving model ...
Epoch: 4 cost time: 4.40103816986084
Epoch: 4, Steps: 10 | Train Loss: 0.634 Vali Loss: 1.000 Vali Acc: 0.635 Test Loss: 1.000 Test Acc: 0.635
Validation loss decreased (-0.540529 --> -0.635125).  Saving model ...
Epoch: 5 cost time: 4.166780948638916
Epoch: 5, Steps: 10 | Train Loss: 0.413 Vali Loss: 1.116 Vali Acc: 0.527 Test Loss: 1.116 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.234101057052612
Epoch: 6, Steps: 10 | Train Loss: 0.293 Vali Loss: 0.933 Vali Acc: 0.622 Test Loss: 0.933 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.511960744857788
Epoch: 7, Steps: 10 | Train Loss: 0.149 Vali Loss: 1.142 Vali Acc: 0.568 Test Loss: 1.142 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.182002782821655
Epoch: 8, Steps: 10 | Train Loss: 0.072 Vali Loss: 0.908 Vali Acc: 0.608 Test Loss: 0.908 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.132116317749023
Epoch: 9, Steps: 10 | Train Loss: 0.036 Vali Loss: 1.032 Vali Acc: 0.635 Test Loss: 1.032 Test Acc: 0.635
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.403681993484497
Epoch: 10, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.945 Vali Acc: 0.662 Test Loss: 0.945 Test Acc: 0.662
Validation loss decreased (-0.635125 --> -0.662153).  Saving model ...
Epoch: 11 cost time: 4.189964294433594
Epoch: 11, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.970 Vali Acc: 0.635 Test Loss: 0.970 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.298146963119507
Epoch: 12, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.985 Vali Acc: 0.635 Test Loss: 0.985 Test Acc: 0.635
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.951735496520996
Epoch: 13, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.004 Vali Acc: 0.608 Test Loss: 1.004 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.4004621505737305
Epoch: 14, Steps: 10 | Train Loss: 0.051 Vali Loss: 1.037 Vali Acc: 0.635 Test Loss: 1.037 Test Acc: 0.635
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 4.217100620269775
Epoch: 15, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.056 Vali Acc: 0.635 Test Loss: 1.056 Test Acc: 0.635
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 4.326555252075195
Epoch: 16, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.069 Vali Acc: 0.622 Test Loss: 1.069 Test Acc: 0.622
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 4.163702011108398
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.059 Vali Acc: 0.608 Test Loss: 1.059 Test Acc: 0.608
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 4.034423351287842
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.044 Vali Acc: 0.595 Test Loss: 1.044 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.4288129806518555
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.060 Vali Acc: 0.595 Test Loss: 1.060 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.388613224029541
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.089 Vali Acc: 0.595 Test Loss: 1.089 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm64_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6621621621621622
model parameter : 2859268
model size : 12.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm32_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 27.504120588302612
Epoch: 1, Steps: 10 | Train Loss: 1.396 Vali Loss: 1.381 Vali Acc: 0.324 Test Loss: 1.381 Test Acc: 0.324
Validation loss decreased (inf --> -0.324311).  Saving model ...
Epoch: 2 cost time: 25.96901774406433
Epoch: 2, Steps: 10 | Train Loss: 1.247 Vali Loss: 1.298 Vali Acc: 0.365 Test Loss: 1.298 Test Acc: 0.365
Validation loss decreased (-0.324311 --> -0.364852).  Saving model ...
Epoch: 3 cost time: 24.607796669006348
Epoch: 3, Steps: 10 | Train Loss: 1.006 Vali Loss: 1.319 Vali Acc: 0.432 Test Loss: 1.319 Test Acc: 0.432
Validation loss decreased (-0.364852 --> -0.432419).  Saving model ...
Epoch: 4 cost time: 24.602197647094727
Epoch: 4, Steps: 10 | Train Loss: 0.738 Vali Loss: 1.203 Vali Acc: 0.405 Test Loss: 1.203 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 24.075782537460327
Epoch: 5, Steps: 10 | Train Loss: 0.516 Vali Loss: 1.186 Vali Acc: 0.486 Test Loss: 1.186 Test Acc: 0.486
Validation loss decreased (-0.432419 --> -0.486475).  Saving model ...
Epoch: 6 cost time: 22.894030332565308
Epoch: 6, Steps: 10 | Train Loss: 0.369 Vali Loss: 1.135 Vali Acc: 0.500 Test Loss: 1.135 Test Acc: 0.500
Validation loss decreased (-0.486475 --> -0.499989).  Saving model ...
Epoch: 7 cost time: 24.48310136795044
Epoch: 7, Steps: 10 | Train Loss: 0.237 Vali Loss: 1.157 Vali Acc: 0.514 Test Loss: 1.157 Test Acc: 0.514
Validation loss decreased (-0.499989 --> -0.513502).  Saving model ...
Epoch: 8 cost time: 24.673964023590088
Epoch: 8, Steps: 10 | Train Loss: 0.140 Vali Loss: 1.210 Vali Acc: 0.514 Test Loss: 1.210 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 24.34152865409851
Epoch: 9, Steps: 10 | Train Loss: 0.098 Vali Loss: 1.199 Vali Acc: 0.486 Test Loss: 1.199 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 23.889867544174194
Epoch: 10, Steps: 10 | Train Loss: 0.060 Vali Loss: 1.270 Vali Acc: 0.473 Test Loss: 1.270 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 23.91579532623291
Epoch: 11, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.260 Vali Acc: 0.500 Test Loss: 1.260 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 25.78374695777893
Epoch: 12, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.221 Vali Acc: 0.459 Test Loss: 1.221 Test Acc: 0.459
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 25.24456787109375
Epoch: 13, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.260 Vali Acc: 0.500 Test Loss: 1.260 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 25.18881106376648
Epoch: 14, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.254 Vali Acc: 0.500 Test Loss: 1.254 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 25.85998821258545
Epoch: 15, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.248 Vali Acc: 0.486 Test Loss: 1.248 Test Acc: 0.486
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 23.712937593460083
Epoch: 16, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.269 Vali Acc: 0.514 Test Loss: 1.269 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 23.230367183685303
Epoch: 17, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.299 Vali Acc: 0.514 Test Loss: 1.299 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm32_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5135135135135135
model parameter : 9427844
model size : 36.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm32_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 15.008123397827148
Epoch: 1, Steps: 10 | Train Loss: 1.435 Vali Loss: 1.434 Vali Acc: 0.230 Test Loss: 1.434 Test Acc: 0.230
Validation loss decreased (inf --> -0.229715).  Saving model ...
Epoch: 2 cost time: 13.018222332000732
Epoch: 2, Steps: 10 | Train Loss: 1.318 Vali Loss: 1.374 Vali Acc: 0.297 Test Loss: 1.374 Test Acc: 0.297
Validation loss decreased (-0.229715 --> -0.297284).  Saving model ...
Epoch: 3 cost time: 12.60433316230774
Epoch: 3, Steps: 10 | Train Loss: 1.085 Vali Loss: 1.305 Vali Acc: 0.392 Test Loss: 1.305 Test Acc: 0.392
Validation loss decreased (-0.297284 --> -0.391879).  Saving model ...
Epoch: 4 cost time: 13.948774337768555
Epoch: 4, Steps: 10 | Train Loss: 0.861 Vali Loss: 1.223 Vali Acc: 0.459 Test Loss: 1.223 Test Acc: 0.459
Validation loss decreased (-0.391879 --> -0.459447).  Saving model ...
Epoch: 5 cost time: 12.610647439956665
Epoch: 5, Steps: 10 | Train Loss: 0.649 Vali Loss: 1.244 Vali Acc: 0.514 Test Loss: 1.244 Test Acc: 0.514
Validation loss decreased (-0.459447 --> -0.513501).  Saving model ...
Epoch: 6 cost time: 12.732815742492676
Epoch: 6, Steps: 10 | Train Loss: 0.462 Vali Loss: 1.150 Vali Acc: 0.527 Test Loss: 1.150 Test Acc: 0.527
Validation loss decreased (-0.513501 --> -0.527016).  Saving model ...
Epoch: 7 cost time: 14.220978021621704
Epoch: 7, Steps: 10 | Train Loss: 0.312 Vali Loss: 1.110 Vali Acc: 0.554 Test Loss: 1.110 Test Acc: 0.554
Validation loss decreased (-0.527016 --> -0.554043).  Saving model ...
Epoch: 8 cost time: 13.931725025177002
Epoch: 8, Steps: 10 | Train Loss: 0.190 Vali Loss: 1.042 Vali Acc: 0.595 Test Loss: 1.042 Test Acc: 0.595
Validation loss decreased (-0.554043 --> -0.594584).  Saving model ...
Epoch: 9 cost time: 14.44851803779602
Epoch: 9, Steps: 10 | Train Loss: 0.093 Vali Loss: 1.070 Vali Acc: 0.500 Test Loss: 1.070 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 13.796977519989014
Epoch: 10, Steps: 10 | Train Loss: 0.051 Vali Loss: 1.073 Vali Acc: 0.527 Test Loss: 1.073 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 14.707834720611572
Epoch: 11, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.103 Vali Acc: 0.568 Test Loss: 1.103 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 14.051990032196045
Epoch: 12, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.091 Vali Acc: 0.541 Test Loss: 1.091 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 14.37837553024292
Epoch: 13, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.089 Vali Acc: 0.581 Test Loss: 1.089 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 14.085891962051392
Epoch: 14, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.122 Vali Acc: 0.554 Test Loss: 1.122 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 11.282962560653687
Epoch: 15, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.109 Vali Acc: 0.568 Test Loss: 1.109 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 13.182865619659424
Epoch: 16, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.135 Vali Acc: 0.581 Test Loss: 1.135 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 13.153138160705566
Epoch: 17, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.187 Vali Acc: 0.554 Test Loss: 1.187 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 12.921685457229614
Epoch: 18, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.132 Vali Acc: 0.581 Test Loss: 1.132 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm32_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 2807428
model size : 11.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm32_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 14.569151401519775
Epoch: 1, Steps: 10 | Train Loss: 1.396 Vali Loss: 1.377 Vali Acc: 0.351 Test Loss: 1.377 Test Acc: 0.351
Validation loss decreased (inf --> -0.351338).  Saving model ...
Epoch: 2 cost time: 12.902671337127686
Epoch: 2, Steps: 10 | Train Loss: 1.244 Vali Loss: 1.291 Vali Acc: 0.392 Test Loss: 1.291 Test Acc: 0.392
Validation loss decreased (-0.351338 --> -0.391879).  Saving model ...
Epoch: 3 cost time: 13.462043762207031
Epoch: 3, Steps: 10 | Train Loss: 0.999 Vali Loss: 1.304 Vali Acc: 0.405 Test Loss: 1.304 Test Acc: 0.405
Validation loss decreased (-0.391879 --> -0.405392).  Saving model ...
Epoch: 4 cost time: 11.956539154052734
Epoch: 4, Steps: 10 | Train Loss: 0.725 Vali Loss: 1.184 Vali Acc: 0.446 Test Loss: 1.184 Test Acc: 0.446
Validation loss decreased (-0.405392 --> -0.445934).  Saving model ...
Epoch: 5 cost time: 12.038228750228882
Epoch: 5, Steps: 10 | Train Loss: 0.497 Vali Loss: 1.154 Vali Acc: 0.446 Test Loss: 1.154 Test Acc: 0.446
Validation loss decreased (-0.445934 --> -0.445934).  Saving model ...
Epoch: 6 cost time: 10.863699674606323
Epoch: 6, Steps: 10 | Train Loss: 0.345 Vali Loss: 1.179 Vali Acc: 0.459 Test Loss: 1.179 Test Acc: 0.459
Validation loss decreased (-0.445934 --> -0.459448).  Saving model ...
Epoch: 7 cost time: 12.89429783821106
Epoch: 7, Steps: 10 | Train Loss: 0.218 Vali Loss: 1.137 Vali Acc: 0.500 Test Loss: 1.137 Test Acc: 0.500
Validation loss decreased (-0.459448 --> -0.499989).  Saving model ...
Epoch: 8 cost time: 13.705908298492432
Epoch: 8, Steps: 10 | Train Loss: 0.133 Vali Loss: 1.261 Vali Acc: 0.486 Test Loss: 1.261 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 14.256859064102173
Epoch: 9, Steps: 10 | Train Loss: 0.086 Vali Loss: 1.202 Vali Acc: 0.473 Test Loss: 1.202 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 13.327343463897705
Epoch: 10, Steps: 10 | Train Loss: 0.051 Vali Loss: 1.275 Vali Acc: 0.459 Test Loss: 1.275 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 13.474481582641602
Epoch: 11, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.148 Vali Acc: 0.527 Test Loss: 1.148 Test Acc: 0.527
Validation loss decreased (-0.499989 --> -0.527016).  Saving model ...
Epoch: 12 cost time: 13.860168218612671
Epoch: 12, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.143 Vali Acc: 0.514 Test Loss: 1.143 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 13.252662420272827
Epoch: 13, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.181 Vali Acc: 0.527 Test Loss: 1.181 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 13.288419246673584
Epoch: 14, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.174 Vali Acc: 0.541 Test Loss: 1.174 Test Acc: 0.541
Validation loss decreased (-0.527016 --> -0.540529).  Saving model ...
Epoch: 15 cost time: 13.298505544662476
Epoch: 15, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.167 Vali Acc: 0.554 Test Loss: 1.167 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554042).  Saving model ...
Epoch: 16 cost time: 14.12897801399231
Epoch: 16, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.189 Vali Acc: 0.568 Test Loss: 1.189 Test Acc: 0.568
Validation loss decreased (-0.554042 --> -0.567556).  Saving model ...
Epoch: 17 cost time: 13.735472679138184
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.182 Vali Acc: 0.568 Test Loss: 1.182 Test Acc: 0.568
Validation loss decreased (-0.567556 --> -0.567556).  Saving model ...
Epoch: 18 cost time: 14.63797903060913
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.153 Vali Acc: 0.568 Test Loss: 1.153 Test Acc: 0.568
Validation loss decreased (-0.567556 --> -0.567556).  Saving model ...
Epoch: 19 cost time: 14.407817125320435
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.158 Vali Acc: 0.554 Test Loss: 1.158 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 13.872328281402588
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.169 Vali Acc: 0.568 Test Loss: 1.169 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 14.376567125320435
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.184 Vali Acc: 0.581 Test Loss: 1.184 Test Acc: 0.581
Validation loss decreased (-0.567556 --> -0.581069).  Saving model ...
Epoch: 22 cost time: 13.930408954620361
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.200 Vali Acc: 0.595 Test Loss: 1.200 Test Acc: 0.595
Validation loss decreased (-0.581069 --> -0.594583).  Saving model ...
Epoch: 23 cost time: 13.816923379898071
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.212 Vali Acc: 0.595 Test Loss: 1.212 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 13.583603858947754
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.204 Vali Acc: 0.595 Test Loss: 1.204 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 12.931191205978394
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.202 Vali Acc: 0.595 Test Loss: 1.202 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 11.086232900619507
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.199 Vali Acc: 0.581 Test Loss: 1.199 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 12.772388696670532
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.203 Vali Acc: 0.581 Test Loss: 1.203 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 12.118309736251831
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.204 Vali Acc: 0.581 Test Loss: 1.204 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 12.322832822799683
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.205 Vali Acc: 0.581 Test Loss: 1.205 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 12.076030731201172
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.220 Vali Acc: 0.595 Test Loss: 1.220 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm32_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 9427844
model size : 36.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm32_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 8.1714608669281
Epoch: 1, Steps: 10 | Train Loss: 1.435 Vali Loss: 1.428 Vali Acc: 0.243 Test Loss: 1.428 Test Acc: 0.243
Validation loss decreased (inf --> -0.243229).  Saving model ...
Epoch: 2 cost time: 6.444979667663574
Epoch: 2, Steps: 10 | Train Loss: 1.323 Vali Loss: 1.374 Vali Acc: 0.338 Test Loss: 1.374 Test Acc: 0.338
Validation loss decreased (-0.243229 --> -0.337824).  Saving model ...
Epoch: 3 cost time: 6.35439920425415
Epoch: 3, Steps: 10 | Train Loss: 1.105 Vali Loss: 1.306 Vali Acc: 0.419 Test Loss: 1.306 Test Acc: 0.419
Validation loss decreased (-0.337824 --> -0.418906).  Saving model ...
Epoch: 4 cost time: 6.431783199310303
Epoch: 4, Steps: 10 | Train Loss: 0.886 Vali Loss: 1.213 Vali Acc: 0.527 Test Loss: 1.213 Test Acc: 0.527
Validation loss decreased (-0.418906 --> -0.527015).  Saving model ...
Epoch: 5 cost time: 6.2480244636535645
Epoch: 5, Steps: 10 | Train Loss: 0.672 Vali Loss: 1.233 Vali Acc: 0.459 Test Loss: 1.233 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.250362396240234
Epoch: 6, Steps: 10 | Train Loss: 0.489 Vali Loss: 1.134 Vali Acc: 0.581 Test Loss: 1.134 Test Acc: 0.581
Validation loss decreased (-0.527015 --> -0.581070).  Saving model ...
Epoch: 7 cost time: 5.6094183921813965
Epoch: 7, Steps: 10 | Train Loss: 0.341 Vali Loss: 1.089 Vali Acc: 0.568 Test Loss: 1.089 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.264822244644165
Epoch: 8, Steps: 10 | Train Loss: 0.220 Vali Loss: 1.025 Vali Acc: 0.568 Test Loss: 1.025 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.205282926559448
Epoch: 9, Steps: 10 | Train Loss: 0.120 Vali Loss: 1.060 Vali Acc: 0.541 Test Loss: 1.060 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.801904201507568
Epoch: 10, Steps: 10 | Train Loss: 0.060 Vali Loss: 1.043 Vali Acc: 0.608 Test Loss: 1.043 Test Acc: 0.608
Validation loss decreased (-0.581070 --> -0.608098).  Saving model ...
Epoch: 11 cost time: 6.276246070861816
Epoch: 11, Steps: 10 | Train Loss: 0.048 Vali Loss: 1.057 Vali Acc: 0.608 Test Loss: 1.057 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.718043088912964
Epoch: 12, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.995 Vali Acc: 0.608 Test Loss: 0.995 Test Acc: 0.608
Validation loss decreased (-0.608098 --> -0.608098).  Saving model ...
Epoch: 13 cost time: 6.582438230514526
Epoch: 13, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.991 Vali Acc: 0.622 Test Loss: 0.991 Test Acc: 0.622
Validation loss decreased (-0.608098 --> -0.621612).  Saving model ...
Epoch: 14 cost time: 6.16478967666626
Epoch: 14, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.012 Vali Acc: 0.635 Test Loss: 1.012 Test Acc: 0.635
Validation loss decreased (-0.621612 --> -0.635125).  Saving model ...
Epoch: 15 cost time: 6.110924482345581
Epoch: 15, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.032 Vali Acc: 0.608 Test Loss: 1.032 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 6.499427318572998
Epoch: 16, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.033 Vali Acc: 0.635 Test Loss: 1.033 Test Acc: 0.635
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 7.0097057819366455
Epoch: 17, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.063 Vali Acc: 0.649 Test Loss: 1.063 Test Acc: 0.649
Validation loss decreased (-0.635125 --> -0.648638).  Saving model ...
Epoch: 18 cost time: 6.681395769119263
Epoch: 18, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.098 Vali Acc: 0.595 Test Loss: 1.098 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 6.375246047973633
Epoch: 19, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.061 Vali Acc: 0.622 Test Loss: 1.061 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 6.433425188064575
Epoch: 20, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.065 Vali Acc: 0.635 Test Loss: 1.065 Test Acc: 0.635
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 6.691212892532349
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.074 Vali Acc: 0.635 Test Loss: 1.074 Test Acc: 0.635
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 7.142288446426392
Epoch: 22, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.074 Vali Acc: 0.635 Test Loss: 1.074 Test Acc: 0.635
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 6.614283084869385
Epoch: 23, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.072 Vali Acc: 0.635 Test Loss: 1.072 Test Acc: 0.635
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 6.028560400009155
Epoch: 24, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.180 Vali Acc: 0.568 Test Loss: 1.180 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 6.480801820755005
Epoch: 25, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.138 Vali Acc: 0.581 Test Loss: 1.138 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 6.642726182937622
Epoch: 26, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.055 Vali Acc: 0.622 Test Loss: 1.055 Test Acc: 0.622
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 6.851407289505005
Epoch: 27, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.077 Vali Acc: 0.649 Test Loss: 1.077 Test Acc: 0.649
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm32_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6486486486486487
model parameter : 2807428
model size : 11.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm32_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 9.092791557312012
Epoch: 1, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.381 Vali Acc: 0.311 Test Loss: 1.381 Test Acc: 0.311
Validation loss decreased (inf --> -0.310797).  Saving model ...
Epoch: 2 cost time: 6.99373197555542
Epoch: 2, Steps: 10 | Train Loss: 1.275 Vali Loss: 1.282 Vali Acc: 0.392 Test Loss: 1.282 Test Acc: 0.392
Validation loss decreased (-0.310797 --> -0.391879).  Saving model ...
Epoch: 3 cost time: 6.9053730964660645
Epoch: 3, Steps: 10 | Train Loss: 1.070 Vali Loss: 1.258 Vali Acc: 0.365 Test Loss: 1.258 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 7.641461372375488
Epoch: 4, Steps: 10 | Train Loss: 0.917 Vali Loss: 1.209 Vali Acc: 0.432 Test Loss: 1.209 Test Acc: 0.432
Validation loss decreased (-0.391879 --> -0.432420).  Saving model ...
Epoch: 5 cost time: 6.246662855148315
Epoch: 5, Steps: 10 | Train Loss: 0.715 Vali Loss: 1.185 Vali Acc: 0.473 Test Loss: 1.185 Test Acc: 0.473
Validation loss decreased (-0.432420 --> -0.472961).  Saving model ...
Epoch: 6 cost time: 6.176879405975342
Epoch: 6, Steps: 10 | Train Loss: 0.582 Vali Loss: 1.137 Vali Acc: 0.500 Test Loss: 1.137 Test Acc: 0.500
Validation loss decreased (-0.472961 --> -0.499989).  Saving model ...
Epoch: 7 cost time: 6.73491096496582
Epoch: 7, Steps: 10 | Train Loss: 0.474 Vali Loss: 1.226 Vali Acc: 0.486 Test Loss: 1.226 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.3694679737091064
Epoch: 8, Steps: 10 | Train Loss: 0.331 Vali Loss: 1.060 Vali Acc: 0.608 Test Loss: 1.060 Test Acc: 0.608
Validation loss decreased (-0.499989 --> -0.608098).  Saving model ...
Epoch: 9 cost time: 6.829857349395752
Epoch: 9, Steps: 10 | Train Loss: 0.207 Vali Loss: 0.952 Vali Acc: 0.568 Test Loss: 0.952 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.646640777587891
Epoch: 10, Steps: 10 | Train Loss: 0.144 Vali Loss: 1.086 Vali Acc: 0.581 Test Loss: 1.086 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.911349296569824
Epoch: 11, Steps: 10 | Train Loss: 0.084 Vali Loss: 1.000 Vali Acc: 0.608 Test Loss: 1.000 Test Acc: 0.608
Validation loss decreased (-0.608098 --> -0.608098).  Saving model ...
Epoch: 12 cost time: 6.573761940002441
Epoch: 12, Steps: 10 | Train Loss: 0.061 Vali Loss: 1.012 Vali Acc: 0.662 Test Loss: 1.012 Test Acc: 0.662
Validation loss decreased (-0.608098 --> -0.662152).  Saving model ...
Epoch: 13 cost time: 7.341585874557495
Epoch: 13, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.934 Vali Acc: 0.676 Test Loss: 0.934 Test Acc: 0.676
Validation loss decreased (-0.662152 --> -0.675666).  Saving model ...
Epoch: 14 cost time: 7.226249933242798
Epoch: 14, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.934 Vali Acc: 0.649 Test Loss: 0.934 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 7.566484212875366
Epoch: 15, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.030 Vali Acc: 0.676 Test Loss: 1.030 Test Acc: 0.676
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 7.194325923919678
Epoch: 16, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.019 Vali Acc: 0.608 Test Loss: 1.019 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 5.702586889266968
Epoch: 17, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.978 Vali Acc: 0.595 Test Loss: 0.978 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 6.725430250167847
Epoch: 18, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.055 Vali Acc: 0.622 Test Loss: 1.055 Test Acc: 0.622
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 7.32498025894165
Epoch: 19, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.051 Vali Acc: 0.622 Test Loss: 1.051 Test Acc: 0.622
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 7.296292781829834
Epoch: 20, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.038 Vali Acc: 0.608 Test Loss: 1.038 Test Acc: 0.608
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 6.96870493888855
Epoch: 21, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.069 Vali Acc: 0.635 Test Loss: 1.069 Test Acc: 0.635
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 8.038596391677856
Epoch: 22, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.070 Vali Acc: 0.649 Test Loss: 1.070 Test Acc: 0.649
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 7.690464735031128
Epoch: 23, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.045 Vali Acc: 0.635 Test Loss: 1.045 Test Acc: 0.635
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm32_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6756756756756757
model parameter : 9427844
model size : 36.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm32_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.286040544509888
Epoch: 1, Steps: 10 | Train Loss: 1.434 Vali Loss: 1.435 Vali Acc: 0.257 Test Loss: 1.435 Test Acc: 0.257
Validation loss decreased (inf --> -0.256742).  Saving model ...
Epoch: 2 cost time: 3.9408364295959473
Epoch: 2, Steps: 10 | Train Loss: 1.338 Vali Loss: 1.379 Vali Acc: 0.324 Test Loss: 1.379 Test Acc: 0.324
Validation loss decreased (-0.256742 --> -0.324311).  Saving model ...
Epoch: 3 cost time: 4.3097639083862305
Epoch: 3, Steps: 10 | Train Loss: 1.138 Vali Loss: 1.306 Vali Acc: 0.432 Test Loss: 1.306 Test Acc: 0.432
Validation loss decreased (-0.324311 --> -0.432419).  Saving model ...
Epoch: 4 cost time: 4.223004102706909
Epoch: 4, Steps: 10 | Train Loss: 0.945 Vali Loss: 1.219 Vali Acc: 0.527 Test Loss: 1.219 Test Acc: 0.527
Validation loss decreased (-0.432419 --> -0.527015).  Saving model ...
Epoch: 5 cost time: 4.671761512756348
Epoch: 5, Steps: 10 | Train Loss: 0.759 Vali Loss: 1.241 Vali Acc: 0.486 Test Loss: 1.241 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.691843032836914
Epoch: 6, Steps: 10 | Train Loss: 0.585 Vali Loss: 1.147 Vali Acc: 0.581 Test Loss: 1.147 Test Acc: 0.581
Validation loss decreased (-0.527015 --> -0.581070).  Saving model ...
Epoch: 7 cost time: 4.2410197257995605
Epoch: 7, Steps: 10 | Train Loss: 0.430 Vali Loss: 1.100 Vali Acc: 0.581 Test Loss: 1.100 Test Acc: 0.581
Validation loss decreased (-0.581070 --> -0.581070).  Saving model ...
Epoch: 8 cost time: 3.9427146911621094
Epoch: 8, Steps: 10 | Train Loss: 0.288 Vali Loss: 1.000 Vali Acc: 0.635 Test Loss: 1.000 Test Acc: 0.635
Validation loss decreased (-0.581070 --> -0.635125).  Saving model ...
Epoch: 9 cost time: 3.99788236618042
Epoch: 9, Steps: 10 | Train Loss: 0.169 Vali Loss: 0.999 Vali Acc: 0.608 Test Loss: 0.999 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.09798789024353
Epoch: 10, Steps: 10 | Train Loss: 0.098 Vali Loss: 0.971 Vali Acc: 0.622 Test Loss: 0.971 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.132208585739136
Epoch: 11, Steps: 10 | Train Loss: 0.057 Vali Loss: 1.024 Vali Acc: 0.581 Test Loss: 1.024 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.364030599594116
Epoch: 12, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.937 Vali Acc: 0.635 Test Loss: 0.937 Test Acc: 0.635
Validation loss decreased (-0.635125 --> -0.635126).  Saving model ...
Epoch: 13 cost time: 3.2840981483459473
Epoch: 13, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.965 Vali Acc: 0.608 Test Loss: 0.965 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.859140634536743
Epoch: 14, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.980 Vali Acc: 0.595 Test Loss: 0.980 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.6003787517547607
Epoch: 15, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.992 Vali Acc: 0.649 Test Loss: 0.992 Test Acc: 0.649
Validation loss decreased (-0.635126 --> -0.648639).  Saving model ...
Epoch: 16 cost time: 3.8935999870300293
Epoch: 16, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.020 Vali Acc: 0.622 Test Loss: 1.020 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.919187545776367
Epoch: 17, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.022 Vali Acc: 0.622 Test Loss: 1.022 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.7289345264434814
Epoch: 18, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.002 Vali Acc: 0.649 Test Loss: 1.002 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.810004949569702
Epoch: 19, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.015 Vali Acc: 0.649 Test Loss: 1.015 Test Acc: 0.649
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.7955174446105957
Epoch: 20, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.036 Vali Acc: 0.635 Test Loss: 1.036 Test Acc: 0.635
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.8152360916137695
Epoch: 21, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.044 Vali Acc: 0.622 Test Loss: 1.044 Test Acc: 0.622
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 4.185398817062378
Epoch: 22, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.066 Vali Acc: 0.622 Test Loss: 1.066 Test Acc: 0.622
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 3.8198537826538086
Epoch: 23, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.064 Vali Acc: 0.622 Test Loss: 1.064 Test Acc: 0.622
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 3.9429571628570557
Epoch: 24, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.076 Vali Acc: 0.649 Test Loss: 1.076 Test Acc: 0.649
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 3.6828722953796387
Epoch: 25, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.085 Vali Acc: 0.649 Test Loss: 1.085 Test Acc: 0.649
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm32_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6486486486486487
model parameter : 2807428
model size : 11.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm32_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 10.101027727127075
Epoch: 1, Steps: 10 | Train Loss: 1.424 Vali Loss: 1.363 Vali Acc: 0.378 Test Loss: 1.363 Test Acc: 0.378
Validation loss decreased (inf --> -0.378365).  Saving model ...
Epoch: 2 cost time: 11.365232467651367
Epoch: 2, Steps: 10 | Train Loss: 1.331 Vali Loss: 1.312 Vali Acc: 0.419 Test Loss: 1.312 Test Acc: 0.419
Validation loss decreased (-0.378365 --> -0.418906).  Saving model ...
Epoch: 3 cost time: 11.287649154663086
Epoch: 3, Steps: 10 | Train Loss: 1.086 Vali Loss: 1.220 Vali Acc: 0.514 Test Loss: 1.220 Test Acc: 0.514
Validation loss decreased (-0.418906 --> -0.513501).  Saving model ...
Epoch: 4 cost time: 11.065576791763306
Epoch: 4, Steps: 10 | Train Loss: 0.855 Vali Loss: 1.162 Vali Acc: 0.554 Test Loss: 1.162 Test Acc: 0.554
Validation loss decreased (-0.513501 --> -0.554042).  Saving model ...
Epoch: 5 cost time: 10.886143207550049
Epoch: 5, Steps: 10 | Train Loss: 0.614 Vali Loss: 1.077 Vali Acc: 0.527 Test Loss: 1.077 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 10.954412460327148
Epoch: 6, Steps: 10 | Train Loss: 0.422 Vali Loss: 1.068 Vali Acc: 0.568 Test Loss: 1.068 Test Acc: 0.568
Validation loss decreased (-0.554042 --> -0.567557).  Saving model ...
Epoch: 7 cost time: 11.353705406188965
Epoch: 7, Steps: 10 | Train Loss: 0.269 Vali Loss: 1.045 Vali Acc: 0.541 Test Loss: 1.045 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 11.598468542098999
Epoch: 8, Steps: 10 | Train Loss: 0.155 Vali Loss: 1.185 Vali Acc: 0.541 Test Loss: 1.185 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 11.665816068649292
Epoch: 9, Steps: 10 | Train Loss: 0.091 Vali Loss: 1.085 Vali Acc: 0.608 Test Loss: 1.085 Test Acc: 0.608
Validation loss decreased (-0.567557 --> -0.608097).  Saving model ...
Epoch: 10 cost time: 11.09676718711853
Epoch: 10, Steps: 10 | Train Loss: 0.059 Vali Loss: 1.149 Vali Acc: 0.622 Test Loss: 1.149 Test Acc: 0.622
Validation loss decreased (-0.608097 --> -0.621610).  Saving model ...
Epoch: 11 cost time: 11.582979917526245
Epoch: 11, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.146 Vali Acc: 0.581 Test Loss: 1.146 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 11.271639347076416
Epoch: 12, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.259 Vali Acc: 0.541 Test Loss: 1.259 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 11.269691467285156
Epoch: 13, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.287 Vali Acc: 0.608 Test Loss: 1.287 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 11.375877857208252
Epoch: 14, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.334 Vali Acc: 0.608 Test Loss: 1.334 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 11.208427429199219
Epoch: 15, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.356 Vali Acc: 0.595 Test Loss: 1.356 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 11.540171384811401
Epoch: 16, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.366 Vali Acc: 0.608 Test Loss: 1.366 Test Acc: 0.608
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 11.262994050979614
Epoch: 17, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.313 Vali Acc: 0.541 Test Loss: 1.313 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 11.68362283706665
Epoch: 18, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.337 Vali Acc: 0.554 Test Loss: 1.337 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 11.413303136825562
Epoch: 19, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.344 Vali Acc: 0.554 Test Loss: 1.344 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 11.30695390701294
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.434 Vali Acc: 0.581 Test Loss: 1.434 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm32_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 4740484
model size : 18.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm32_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 6.810275077819824
Epoch: 1, Steps: 10 | Train Loss: 1.431 Vali Loss: 1.384 Vali Acc: 0.284 Test Loss: 1.384 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 3.836292028427124
Epoch: 2, Steps: 10 | Train Loss: 1.323 Vali Loss: 1.328 Vali Acc: 0.338 Test Loss: 1.328 Test Acc: 0.338
Validation loss decreased (-0.283770 --> -0.337825).  Saving model ...
Epoch: 3 cost time: 4.19270658493042
Epoch: 3, Steps: 10 | Train Loss: 1.141 Vali Loss: 1.265 Vali Acc: 0.473 Test Loss: 1.265 Test Acc: 0.473
Validation loss decreased (-0.337825 --> -0.472960).  Saving model ...
Epoch: 4 cost time: 5.355732202529907
Epoch: 4, Steps: 10 | Train Loss: 0.930 Vali Loss: 1.245 Vali Acc: 0.432 Test Loss: 1.245 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.2951979637146
Epoch: 5, Steps: 10 | Train Loss: 0.696 Vali Loss: 1.152 Vali Acc: 0.581 Test Loss: 1.152 Test Acc: 0.581
Validation loss decreased (-0.472960 --> -0.581070).  Saving model ...
Epoch: 6 cost time: 5.380978584289551
Epoch: 6, Steps: 10 | Train Loss: 0.518 Vali Loss: 1.150 Vali Acc: 0.541 Test Loss: 1.150 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.577475070953369
Epoch: 7, Steps: 10 | Train Loss: 0.369 Vali Loss: 1.066 Vali Acc: 0.622 Test Loss: 1.066 Test Acc: 0.622
Validation loss decreased (-0.581070 --> -0.621611).  Saving model ...
Epoch: 8 cost time: 4.175672769546509
Epoch: 8, Steps: 10 | Train Loss: 0.233 Vali Loss: 1.046 Vali Acc: 0.622 Test Loss: 1.046 Test Acc: 0.622
Validation loss decreased (-0.621611 --> -0.621611).  Saving model ...
Epoch: 9 cost time: 5.095394134521484
Epoch: 9, Steps: 10 | Train Loss: 0.140 Vali Loss: 1.033 Vali Acc: 0.554 Test Loss: 1.033 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.171049118041992
Epoch: 10, Steps: 10 | Train Loss: 0.083 Vali Loss: 1.028 Vali Acc: 0.608 Test Loss: 1.028 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.082983016967773
Epoch: 11, Steps: 10 | Train Loss: 0.051 Vali Loss: 1.023 Vali Acc: 0.581 Test Loss: 1.023 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 5.164720058441162
Epoch: 12, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.058 Vali Acc: 0.527 Test Loss: 1.058 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 5.0911781787872314
Epoch: 13, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.027 Vali Acc: 0.568 Test Loss: 1.027 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 5.3392980098724365
Epoch: 14, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.036 Vali Acc: 0.554 Test Loss: 1.036 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 5.109855651855469
Epoch: 15, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.032 Vali Acc: 0.527 Test Loss: 1.032 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 5.018956184387207
Epoch: 16, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.037 Vali Acc: 0.568 Test Loss: 1.037 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 5.0172646045684814
Epoch: 17, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.060 Vali Acc: 0.527 Test Loss: 1.060 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 5.132026672363281
Epoch: 18, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.083 Vali Acc: 0.514 Test Loss: 1.083 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm32_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 1430148
model size : 6.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm32_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 9.281663179397583
Epoch: 1, Steps: 10 | Train Loss: 1.421 Vali Loss: 1.362 Vali Acc: 0.405 Test Loss: 1.362 Test Acc: 0.405
Validation loss decreased (inf --> -0.405392).  Saving model ...
Epoch: 2 cost time: 7.0953147411346436
Epoch: 2, Steps: 10 | Train Loss: 1.325 Vali Loss: 1.307 Vali Acc: 0.405 Test Loss: 1.307 Test Acc: 0.405
Validation loss decreased (-0.405392 --> -0.405392).  Saving model ...
Epoch: 3 cost time: 7.488424301147461
Epoch: 3, Steps: 10 | Train Loss: 1.079 Vali Loss: 1.206 Vali Acc: 0.541 Test Loss: 1.206 Test Acc: 0.541
Validation loss decreased (-0.405392 --> -0.540528).  Saving model ...
Epoch: 4 cost time: 7.46163535118103
Epoch: 4, Steps: 10 | Train Loss: 0.840 Vali Loss: 1.143 Vali Acc: 0.581 Test Loss: 1.143 Test Acc: 0.581
Validation loss decreased (-0.540528 --> -0.581070).  Saving model ...
Epoch: 5 cost time: 7.257592678070068
Epoch: 5, Steps: 10 | Train Loss: 0.606 Vali Loss: 1.037 Vali Acc: 0.554 Test Loss: 1.037 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 7.230762481689453
Epoch: 6, Steps: 10 | Train Loss: 0.428 Vali Loss: 1.015 Vali Acc: 0.608 Test Loss: 1.015 Test Acc: 0.608
Validation loss decreased (-0.581070 --> -0.608098).  Saving model ...
Epoch: 7 cost time: 8.36259937286377
Epoch: 7, Steps: 10 | Train Loss: 0.288 Vali Loss: 1.017 Vali Acc: 0.581 Test Loss: 1.017 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 8.107504606246948
Epoch: 8, Steps: 10 | Train Loss: 0.176 Vali Loss: 1.133 Vali Acc: 0.595 Test Loss: 1.133 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 7.80759334564209
Epoch: 9, Steps: 10 | Train Loss: 0.100 Vali Loss: 1.081 Vali Acc: 0.581 Test Loss: 1.081 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 7.953810930252075
Epoch: 10, Steps: 10 | Train Loss: 0.056 Vali Loss: 1.083 Vali Acc: 0.595 Test Loss: 1.083 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 6.628040790557861
Epoch: 11, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.110 Vali Acc: 0.581 Test Loss: 1.110 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 7.462454557418823
Epoch: 12, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.184 Vali Acc: 0.608 Test Loss: 1.184 Test Acc: 0.608
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 8.364043235778809
Epoch: 13, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.211 Vali Acc: 0.622 Test Loss: 1.211 Test Acc: 0.622
Validation loss decreased (-0.608098 --> -0.621610).  Saving model ...
Epoch: 14 cost time: 7.897842645645142
Epoch: 14, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.260 Vali Acc: 0.595 Test Loss: 1.260 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 7.864267826080322
Epoch: 15, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.241 Vali Acc: 0.635 Test Loss: 1.241 Test Acc: 0.635
Validation loss decreased (-0.621610 --> -0.635123).  Saving model ...
Epoch: 16 cost time: 8.639697551727295
Epoch: 16, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.233 Vali Acc: 0.622 Test Loss: 1.233 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 8.266796350479126
Epoch: 17, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.250 Vali Acc: 0.608 Test Loss: 1.250 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 7.074849843978882
Epoch: 18, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.259 Vali Acc: 0.608 Test Loss: 1.259 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 8.093759775161743
Epoch: 19, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.252 Vali Acc: 0.608 Test Loss: 1.252 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 8.13341474533081
Epoch: 20, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.059 Vali Acc: 0.581 Test Loss: 1.059 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 7.877027750015259
Epoch: 21, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.263 Vali Acc: 0.541 Test Loss: 1.263 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 8.384502649307251
Epoch: 22, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.358 Vali Acc: 0.581 Test Loss: 1.358 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 8.333215951919556
Epoch: 23, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.229 Vali Acc: 0.554 Test Loss: 1.229 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 8.615129709243774
Epoch: 24, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.448 Vali Acc: 0.554 Test Loss: 1.448 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 8.458868265151978
Epoch: 25, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.441 Vali Acc: 0.595 Test Loss: 1.441 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm32_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6351351351351351
model parameter : 4740484
model size : 18.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm32_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.8130481243133545
Epoch: 1, Steps: 10 | Train Loss: 1.440 Vali Loss: 1.379 Vali Acc: 0.284 Test Loss: 1.379 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 4.075832843780518
Epoch: 2, Steps: 10 | Train Loss: 1.324 Vali Loss: 1.320 Vali Acc: 0.338 Test Loss: 1.320 Test Acc: 0.338
Validation loss decreased (-0.283770 --> -0.337825).  Saving model ...
Epoch: 3 cost time: 4.372188091278076
Epoch: 3, Steps: 10 | Train Loss: 1.149 Vali Loss: 1.258 Vali Acc: 0.473 Test Loss: 1.258 Test Acc: 0.473
Validation loss decreased (-0.337825 --> -0.472960).  Saving model ...
Epoch: 4 cost time: 4.118556261062622
Epoch: 4, Steps: 10 | Train Loss: 0.950 Vali Loss: 1.236 Vali Acc: 0.459 Test Loss: 1.236 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.228712797164917
Epoch: 5, Steps: 10 | Train Loss: 0.732 Vali Loss: 1.139 Vali Acc: 0.527 Test Loss: 1.139 Test Acc: 0.527
Validation loss decreased (-0.472960 --> -0.527016).  Saving model ...
Epoch: 6 cost time: 4.537358045578003
Epoch: 6, Steps: 10 | Train Loss: 0.556 Vali Loss: 1.147 Vali Acc: 0.486 Test Loss: 1.147 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.474200963973999
Epoch: 7, Steps: 10 | Train Loss: 0.413 Vali Loss: 1.043 Vali Acc: 0.608 Test Loss: 1.043 Test Acc: 0.608
Validation loss decreased (-0.527016 --> -0.608098).  Saving model ...
Epoch: 8 cost time: 4.109983205795288
Epoch: 8, Steps: 10 | Train Loss: 0.266 Vali Loss: 1.042 Vali Acc: 0.608 Test Loss: 1.042 Test Acc: 0.608
Validation loss decreased (-0.608098 --> -0.608098).  Saving model ...
Epoch: 9 cost time: 4.515120983123779
Epoch: 9, Steps: 10 | Train Loss: 0.176 Vali Loss: 0.998 Vali Acc: 0.581 Test Loss: 0.998 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.160288333892822
Epoch: 10, Steps: 10 | Train Loss: 0.105 Vali Loss: 1.037 Vali Acc: 0.554 Test Loss: 1.037 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.540592432022095
Epoch: 11, Steps: 10 | Train Loss: 0.064 Vali Loss: 0.986 Vali Acc: 0.595 Test Loss: 0.986 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.222203254699707
Epoch: 12, Steps: 10 | Train Loss: 0.053 Vali Loss: 1.046 Vali Acc: 0.568 Test Loss: 1.046 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.676154851913452
Epoch: 13, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.980 Vali Acc: 0.568 Test Loss: 0.980 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 4.183005332946777
Epoch: 14, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.972 Vali Acc: 0.635 Test Loss: 0.972 Test Acc: 0.635
Validation loss decreased (-0.608098 --> -0.635125).  Saving model ...
Epoch: 15 cost time: 4.509262323379517
Epoch: 15, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.958 Vali Acc: 0.622 Test Loss: 0.958 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.428123474121094
Epoch: 16, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.947 Vali Acc: 0.608 Test Loss: 0.947 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.567831516265869
Epoch: 17, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.962 Vali Acc: 0.635 Test Loss: 0.962 Test Acc: 0.635
Validation loss decreased (-0.635125 --> -0.635126).  Saving model ...
Epoch: 18 cost time: 4.258624792098999
Epoch: 18, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.015 Vali Acc: 0.595 Test Loss: 1.015 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.524225234985352
Epoch: 19, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.997 Vali Acc: 0.595 Test Loss: 0.997 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.587357044219971
Epoch: 20, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.985 Vali Acc: 0.608 Test Loss: 0.985 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 4.3285956382751465
Epoch: 21, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.983 Vali Acc: 0.649 Test Loss: 0.983 Test Acc: 0.649
Validation loss decreased (-0.635126 --> -0.648639).  Saving model ...
Epoch: 22 cost time: 3.6927149295806885
Epoch: 22, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.994 Vali Acc: 0.622 Test Loss: 0.994 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.4398772716522217
Epoch: 23, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.008 Vali Acc: 0.608 Test Loss: 1.008 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.710648536682129
Epoch: 24, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.022 Vali Acc: 0.608 Test Loss: 1.022 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 4.106930494308472
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.018 Vali Acc: 0.595 Test Loss: 1.018 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 4.143854141235352
Epoch: 26, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.019 Vali Acc: 0.608 Test Loss: 1.019 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 4.120429754257202
Epoch: 27, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.014 Vali Acc: 0.635 Test Loss: 1.014 Test Acc: 0.635
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 4.25990891456604
Epoch: 28, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.023 Vali Acc: 0.635 Test Loss: 1.023 Test Acc: 0.635
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 4.3365702629089355
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.033 Vali Acc: 0.635 Test Loss: 1.033 Test Acc: 0.635
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 4.077469348907471
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.043 Vali Acc: 0.622 Test Loss: 1.043 Test Acc: 0.622
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm32_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6486486486486487
model parameter : 1430148
model size : 6.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm32_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 6.234707355499268
Epoch: 1, Steps: 10 | Train Loss: 1.424 Vali Loss: 1.365 Vali Acc: 0.392 Test Loss: 1.365 Test Acc: 0.392
Validation loss decreased (inf --> -0.391878).  Saving model ...
Epoch: 2 cost time: 5.6924543380737305
Epoch: 2, Steps: 10 | Train Loss: 1.357 Vali Loss: 1.314 Vali Acc: 0.365 Test Loss: 1.314 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.091737985610962
Epoch: 3, Steps: 10 | Train Loss: 1.147 Vali Loss: 1.217 Vali Acc: 0.527 Test Loss: 1.217 Test Acc: 0.527
Validation loss decreased (-0.391878 --> -0.527015).  Saving model ...
Epoch: 4 cost time: 5.086051940917969
Epoch: 4, Steps: 10 | Train Loss: 0.946 Vali Loss: 1.148 Vali Acc: 0.622 Test Loss: 1.148 Test Acc: 0.622
Validation loss decreased (-0.527015 --> -0.621610).  Saving model ...
Epoch: 5 cost time: 5.323662996292114
Epoch: 5, Steps: 10 | Train Loss: 0.740 Vali Loss: 1.061 Vali Acc: 0.595 Test Loss: 1.061 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.207453966140747
Epoch: 6, Steps: 10 | Train Loss: 0.548 Vali Loss: 1.015 Vali Acc: 0.608 Test Loss: 1.015 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.819220066070557
Epoch: 7, Steps: 10 | Train Loss: 0.391 Vali Loss: 0.984 Vali Acc: 0.595 Test Loss: 0.984 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.511912822723389
Epoch: 8, Steps: 10 | Train Loss: 0.264 Vali Loss: 1.003 Vali Acc: 0.581 Test Loss: 1.003 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 5.532808542251587
Epoch: 9, Steps: 10 | Train Loss: 0.169 Vali Loss: 0.973 Vali Acc: 0.608 Test Loss: 0.973 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 5.46074652671814
Epoch: 10, Steps: 10 | Train Loss: 0.100 Vali Loss: 0.977 Vali Acc: 0.622 Test Loss: 0.977 Test Acc: 0.622
Validation loss decreased (-0.621610 --> -0.621612).  Saving model ...
Epoch: 11 cost time: 5.360988616943359
Epoch: 11, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.947 Vali Acc: 0.622 Test Loss: 0.947 Test Acc: 0.622
Validation loss decreased (-0.621612 --> -0.621612).  Saving model ...
Epoch: 12 cost time: 5.293806552886963
Epoch: 12, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.999 Vali Acc: 0.608 Test Loss: 0.999 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.9307615756988525
Epoch: 13, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.980 Vali Acc: 0.608 Test Loss: 0.980 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.229434490203857
Epoch: 14, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.042 Vali Acc: 0.608 Test Loss: 1.042 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.03840184211731
Epoch: 15, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.052 Vali Acc: 0.608 Test Loss: 1.052 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 5.147393703460693
Epoch: 16, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.024 Vali Acc: 0.622 Test Loss: 1.024 Test Acc: 0.622
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 5.196821689605713
Epoch: 17, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.082 Vali Acc: 0.622 Test Loss: 1.082 Test Acc: 0.622
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 5.0808961391448975
Epoch: 18, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.045 Vali Acc: 0.635 Test Loss: 1.045 Test Acc: 0.635
Validation loss decreased (-0.621612 --> -0.635125).  Saving model ...
Epoch: 19 cost time: 4.685159683227539
Epoch: 19, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.054 Vali Acc: 0.649 Test Loss: 1.054 Test Acc: 0.649
Validation loss decreased (-0.635125 --> -0.648638).  Saving model ...
Epoch: 20 cost time: 5.149305105209351
Epoch: 20, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.156 Vali Acc: 0.595 Test Loss: 1.156 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 4.946737289428711
Epoch: 21, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.254 Vali Acc: 0.568 Test Loss: 1.254 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 5.070838928222656
Epoch: 22, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.109 Vali Acc: 0.622 Test Loss: 1.109 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 4.971116304397583
Epoch: 23, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.214 Vali Acc: 0.595 Test Loss: 1.214 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 4.643157958984375
Epoch: 24, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.197 Vali Acc: 0.595 Test Loss: 1.197 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 5.32450532913208
Epoch: 25, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.169 Vali Acc: 0.622 Test Loss: 1.169 Test Acc: 0.622
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 5.087772607803345
Epoch: 26, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.157 Vali Acc: 0.622 Test Loss: 1.157 Test Acc: 0.622
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 5.259971380233765
Epoch: 27, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.165 Vali Acc: 0.608 Test Loss: 1.165 Test Acc: 0.608
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 5.101534605026245
Epoch: 28, Steps: 10 | Train Loss: 0.036 Vali Loss: 1.155 Vali Acc: 0.595 Test Loss: 1.155 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 4.8101255893707275
Epoch: 29, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.177 Vali Acc: 0.622 Test Loss: 1.177 Test Acc: 0.622
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm32_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6486486486486487
model parameter : 4740484
model size : 18.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm32_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.675697565078735
Epoch: 1, Steps: 10 | Train Loss: 1.438 Vali Loss: 1.383 Vali Acc: 0.270 Test Loss: 1.383 Test Acc: 0.270
Validation loss decreased (inf --> -0.270256).  Saving model ...
Epoch: 2 cost time: 3.2888236045837402
Epoch: 2, Steps: 10 | Train Loss: 1.332 Vali Loss: 1.323 Vali Acc: 0.351 Test Loss: 1.323 Test Acc: 0.351
Validation loss decreased (-0.270256 --> -0.351338).  Saving model ...
Epoch: 3 cost time: 3.06943678855896
Epoch: 3, Steps: 10 | Train Loss: 1.180 Vali Loss: 1.260 Vali Acc: 0.419 Test Loss: 1.260 Test Acc: 0.419
Validation loss decreased (-0.351338 --> -0.418906).  Saving model ...
Epoch: 4 cost time: 2.4637081623077393
Epoch: 4, Steps: 10 | Train Loss: 0.989 Vali Loss: 1.248 Vali Acc: 0.446 Test Loss: 1.248 Test Acc: 0.446
Validation loss decreased (-0.418906 --> -0.445933).  Saving model ...
Epoch: 5 cost time: 2.506316900253296
Epoch: 5, Steps: 10 | Train Loss: 0.773 Vali Loss: 1.154 Vali Acc: 0.514 Test Loss: 1.154 Test Acc: 0.514
Validation loss decreased (-0.445933 --> -0.513502).  Saving model ...
Epoch: 6 cost time: 2.439318895339966
Epoch: 6, Steps: 10 | Train Loss: 0.596 Vali Loss: 1.148 Vali Acc: 0.500 Test Loss: 1.148 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.5381720066070557
Epoch: 7, Steps: 10 | Train Loss: 0.453 Vali Loss: 1.057 Vali Acc: 0.608 Test Loss: 1.057 Test Acc: 0.608
Validation loss decreased (-0.513502 --> -0.608098).  Saving model ...
Epoch: 8 cost time: 2.475619316101074
Epoch: 8, Steps: 10 | Train Loss: 0.316 Vali Loss: 1.047 Vali Acc: 0.568 Test Loss: 1.047 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.6172115802764893
Epoch: 9, Steps: 10 | Train Loss: 0.200 Vali Loss: 1.006 Vali Acc: 0.581 Test Loss: 1.006 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.491286277770996
Epoch: 10, Steps: 10 | Train Loss: 0.122 Vali Loss: 1.017 Vali Acc: 0.608 Test Loss: 1.017 Test Acc: 0.608
Validation loss decreased (-0.608098 --> -0.608098).  Saving model ...
Epoch: 11 cost time: 2.815772294998169
Epoch: 11, Steps: 10 | Train Loss: 0.075 Vali Loss: 0.991 Vali Acc: 0.568 Test Loss: 0.991 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.1009607315063477
Epoch: 12, Steps: 10 | Train Loss: 0.047 Vali Loss: 1.048 Vali Acc: 0.568 Test Loss: 1.048 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.0111467838287354
Epoch: 13, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.974 Vali Acc: 0.608 Test Loss: 0.974 Test Acc: 0.608
Validation loss decreased (-0.608098 --> -0.608098).  Saving model ...
Epoch: 14 cost time: 3.1726391315460205
Epoch: 14, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.024 Vali Acc: 0.595 Test Loss: 1.024 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.2078754901885986
Epoch: 15, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.001 Vali Acc: 0.608 Test Loss: 1.001 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.080531358718872
Epoch: 16, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.982 Vali Acc: 0.608 Test Loss: 0.982 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.8026742935180664
Epoch: 17, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.009 Vali Acc: 0.608 Test Loss: 1.009 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.9352035522460938
Epoch: 18, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.041 Vali Acc: 0.622 Test Loss: 1.041 Test Acc: 0.622
Validation loss decreased (-0.608098 --> -0.621611).  Saving model ...
Epoch: 19 cost time: 2.763183116912842
Epoch: 19, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.035 Vali Acc: 0.608 Test Loss: 1.035 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.767258405685425
Epoch: 20, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.028 Vali Acc: 0.608 Test Loss: 1.028 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.893421173095703
Epoch: 21, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.036 Vali Acc: 0.608 Test Loss: 1.036 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.992867946624756
Epoch: 22, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.056 Vali Acc: 0.608 Test Loss: 1.056 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.7694342136383057
Epoch: 23, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.070 Vali Acc: 0.608 Test Loss: 1.070 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.618168830871582
Epoch: 24, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.063 Vali Acc: 0.608 Test Loss: 1.063 Test Acc: 0.608
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.5887789726257324
Epoch: 25, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.066 Vali Acc: 0.608 Test Loss: 1.066 Test Acc: 0.608
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 3.2930216789245605
Epoch: 26, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.081 Vali Acc: 0.608 Test Loss: 1.081 Test Acc: 0.608
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 3.278419017791748
Epoch: 27, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.079 Vali Acc: 0.608 Test Loss: 1.079 Test Acc: 0.608
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 3.332014560699463
Epoch: 28, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.084 Vali Acc: 0.608 Test Loss: 1.084 Test Acc: 0.608
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm32_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 1430148
model size : 6.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm32_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 8.935851573944092
Epoch: 1, Steps: 10 | Train Loss: 1.480 Vali Loss: 1.425 Vali Acc: 0.284 Test Loss: 1.425 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 7.279207229614258
Epoch: 2, Steps: 10 | Train Loss: 1.337 Vali Loss: 1.343 Vali Acc: 0.392 Test Loss: 1.343 Test Acc: 0.392
Validation loss decreased (-0.283770 --> -0.391878).  Saving model ...
Epoch: 3 cost time: 7.441808700561523
Epoch: 3, Steps: 10 | Train Loss: 1.100 Vali Loss: 1.272 Vali Acc: 0.473 Test Loss: 1.272 Test Acc: 0.473
Validation loss decreased (-0.391878 --> -0.472960).  Saving model ...
Epoch: 4 cost time: 7.459171533584595
Epoch: 4, Steps: 10 | Train Loss: 0.902 Vali Loss: 1.199 Vali Acc: 0.554 Test Loss: 1.199 Test Acc: 0.554
Validation loss decreased (-0.472960 --> -0.554042).  Saving model ...
Epoch: 5 cost time: 7.234140157699585
Epoch: 5, Steps: 10 | Train Loss: 0.682 Vali Loss: 1.134 Vali Acc: 0.568 Test Loss: 1.134 Test Acc: 0.568
Validation loss decreased (-0.554042 --> -0.567556).  Saving model ...
Epoch: 6 cost time: 7.423517942428589
Epoch: 6, Steps: 10 | Train Loss: 0.481 Vali Loss: 1.099 Vali Acc: 0.581 Test Loss: 1.099 Test Acc: 0.581
Validation loss decreased (-0.567556 --> -0.581070).  Saving model ...
Epoch: 7 cost time: 7.106744766235352
Epoch: 7, Steps: 10 | Train Loss: 0.313 Vali Loss: 1.105 Vali Acc: 0.608 Test Loss: 1.105 Test Acc: 0.608
Validation loss decreased (-0.581070 --> -0.608097).  Saving model ...
Epoch: 8 cost time: 7.1633994579315186
Epoch: 8, Steps: 10 | Train Loss: 0.195 Vali Loss: 1.029 Vali Acc: 0.635 Test Loss: 1.029 Test Acc: 0.635
Validation loss decreased (-0.608097 --> -0.635125).  Saving model ...
Epoch: 9 cost time: 7.124870538711548
Epoch: 9, Steps: 10 | Train Loss: 0.103 Vali Loss: 1.029 Vali Acc: 0.622 Test Loss: 1.029 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 7.758486270904541
Epoch: 10, Steps: 10 | Train Loss: 0.059 Vali Loss: 1.047 Vali Acc: 0.554 Test Loss: 1.047 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 7.724501848220825
Epoch: 11, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.023 Vali Acc: 0.662 Test Loss: 1.023 Test Acc: 0.662
Validation loss decreased (-0.635125 --> -0.662152).  Saving model ...
Epoch: 12 cost time: 7.617781162261963
Epoch: 12, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.980 Vali Acc: 0.662 Test Loss: 0.980 Test Acc: 0.662
Validation loss decreased (-0.662152 --> -0.662152).  Saving model ...
Epoch: 13 cost time: 7.489317178726196
Epoch: 13, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.028 Vali Acc: 0.635 Test Loss: 1.028 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 7.905578851699829
Epoch: 14, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.084 Vali Acc: 0.554 Test Loss: 1.084 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 7.660720109939575
Epoch: 15, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.064 Vali Acc: 0.595 Test Loss: 1.064 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 7.87249231338501
Epoch: 16, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.084 Vali Acc: 0.622 Test Loss: 1.084 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 7.41895604133606
Epoch: 17, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.107 Vali Acc: 0.649 Test Loss: 1.107 Test Acc: 0.649
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 7.512350797653198
Epoch: 18, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.143 Vali Acc: 0.568 Test Loss: 1.143 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 7.124277114868164
Epoch: 19, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.186 Vali Acc: 0.527 Test Loss: 1.186 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 7.117804050445557
Epoch: 20, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.982 Vali Acc: 0.635 Test Loss: 0.982 Test Acc: 0.635
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 7.271983623504639
Epoch: 21, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.996 Vali Acc: 0.595 Test Loss: 0.996 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 6.936364412307739
Epoch: 22, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.110 Vali Acc: 0.581 Test Loss: 1.110 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm32_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6621621621621622
model parameter : 2396804
model size : 9.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm32_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.8634910583496094
Epoch: 1, Steps: 10 | Train Loss: 1.398 Vali Loss: 1.375 Vali Acc: 0.311 Test Loss: 1.375 Test Acc: 0.311
Validation loss decreased (inf --> -0.310797).  Saving model ...
Epoch: 2 cost time: 2.4286551475524902
Epoch: 2, Steps: 10 | Train Loss: 1.300 Vali Loss: 1.324 Vali Acc: 0.392 Test Loss: 1.324 Test Acc: 0.392
Validation loss decreased (-0.310797 --> -0.391879).  Saving model ...
Epoch: 3 cost time: 2.7837624549865723
Epoch: 3, Steps: 10 | Train Loss: 1.132 Vali Loss: 1.273 Vali Acc: 0.419 Test Loss: 1.273 Test Acc: 0.419
Validation loss decreased (-0.391879 --> -0.418906).  Saving model ...
Epoch: 4 cost time: 3.7237794399261475
Epoch: 4, Steps: 10 | Train Loss: 0.919 Vali Loss: 1.202 Vali Acc: 0.486 Test Loss: 1.202 Test Acc: 0.486
Validation loss decreased (-0.418906 --> -0.486474).  Saving model ...
Epoch: 5 cost time: 3.653876781463623
Epoch: 5, Steps: 10 | Train Loss: 0.740 Vali Loss: 1.124 Vali Acc: 0.595 Test Loss: 1.124 Test Acc: 0.595
Validation loss decreased (-0.486474 --> -0.594583).  Saving model ...
Epoch: 6 cost time: 3.6211626529693604
Epoch: 6, Steps: 10 | Train Loss: 0.556 Vali Loss: 1.069 Vali Acc: 0.581 Test Loss: 1.069 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.817638397216797
Epoch: 7, Steps: 10 | Train Loss: 0.391 Vali Loss: 1.015 Vali Acc: 0.595 Test Loss: 1.015 Test Acc: 0.595
Validation loss decreased (-0.594583 --> -0.594584).  Saving model ...
Epoch: 8 cost time: 3.4762942790985107
Epoch: 8, Steps: 10 | Train Loss: 0.250 Vali Loss: 1.009 Vali Acc: 0.595 Test Loss: 1.009 Test Acc: 0.595
Validation loss decreased (-0.594584 --> -0.594585).  Saving model ...
Epoch: 9 cost time: 3.5314688682556152
Epoch: 9, Steps: 10 | Train Loss: 0.155 Vali Loss: 0.971 Vali Acc: 0.554 Test Loss: 0.971 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.414297103881836
Epoch: 10, Steps: 10 | Train Loss: 0.088 Vali Loss: 0.966 Vali Acc: 0.568 Test Loss: 0.966 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.345832586288452
Epoch: 11, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.961 Vali Acc: 0.568 Test Loss: 0.961 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.540994882583618
Epoch: 12, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.966 Vali Acc: 0.541 Test Loss: 0.966 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.309093713760376
Epoch: 13, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.964 Vali Acc: 0.554 Test Loss: 0.964 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.3993210792541504
Epoch: 14, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.933 Vali Acc: 0.595 Test Loss: 0.933 Test Acc: 0.595
Validation loss decreased (-0.594585 --> -0.594585).  Saving model ...
Epoch: 15 cost time: 3.3053183555603027
Epoch: 15, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.990 Vali Acc: 0.568 Test Loss: 0.990 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.5541412830352783
Epoch: 16, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.992 Vali Acc: 0.554 Test Loss: 0.992 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.5087475776672363
Epoch: 17, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.958 Vali Acc: 0.554 Test Loss: 0.958 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 4.00160813331604
Epoch: 18, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.972 Vali Acc: 0.568 Test Loss: 0.972 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.67952561378479
Epoch: 19, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.993 Vali Acc: 0.581 Test Loss: 0.993 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.921607255935669
Epoch: 20, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.977 Vali Acc: 0.568 Test Loss: 0.977 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.1412222385406494
Epoch: 21, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.991 Vali Acc: 0.581 Test Loss: 0.991 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.0414412021636963
Epoch: 22, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.998 Vali Acc: 0.581 Test Loss: 0.998 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 3.4555928707122803
Epoch: 23, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.994 Vali Acc: 0.581 Test Loss: 0.994 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 3.8163509368896484
Epoch: 24, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.007 Vali Acc: 0.581 Test Loss: 1.007 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm32_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 741508
model size : 3.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm32_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 6.597484827041626
Epoch: 1, Steps: 10 | Train Loss: 1.482 Vali Loss: 1.426 Vali Acc: 0.270 Test Loss: 1.426 Test Acc: 0.270
Validation loss decreased (inf --> -0.270256).  Saving model ...
Epoch: 2 cost time: 5.240160226821899
Epoch: 2, Steps: 10 | Train Loss: 1.336 Vali Loss: 1.344 Vali Acc: 0.392 Test Loss: 1.344 Test Acc: 0.392
Validation loss decreased (-0.270256 --> -0.391878).  Saving model ...
Epoch: 3 cost time: 4.897156715393066
Epoch: 3, Steps: 10 | Train Loss: 1.097 Vali Loss: 1.276 Vali Acc: 0.459 Test Loss: 1.276 Test Acc: 0.459
Validation loss decreased (-0.391878 --> -0.459447).  Saving model ...
Epoch: 4 cost time: 4.922720432281494
Epoch: 4, Steps: 10 | Train Loss: 0.898 Vali Loss: 1.204 Vali Acc: 0.554 Test Loss: 1.204 Test Acc: 0.554
Validation loss decreased (-0.459447 --> -0.554042).  Saving model ...
Epoch: 5 cost time: 4.778394460678101
Epoch: 5, Steps: 10 | Train Loss: 0.676 Vali Loss: 1.145 Vali Acc: 0.554 Test Loss: 1.145 Test Acc: 0.554
Validation loss decreased (-0.554042 --> -0.554043).  Saving model ...
Epoch: 6 cost time: 4.846619606018066
Epoch: 6, Steps: 10 | Train Loss: 0.477 Vali Loss: 1.108 Vali Acc: 0.568 Test Loss: 1.108 Test Acc: 0.568
Validation loss decreased (-0.554043 --> -0.567556).  Saving model ...
Epoch: 7 cost time: 4.636672258377075
Epoch: 7, Steps: 10 | Train Loss: 0.304 Vali Loss: 1.122 Vali Acc: 0.608 Test Loss: 1.122 Test Acc: 0.608
Validation loss decreased (-0.567556 --> -0.608097).  Saving model ...
Epoch: 8 cost time: 5.012049198150635
Epoch: 8, Steps: 10 | Train Loss: 0.188 Vali Loss: 1.065 Vali Acc: 0.595 Test Loss: 1.065 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.711071252822876
Epoch: 9, Steps: 10 | Train Loss: 0.102 Vali Loss: 1.090 Vali Acc: 0.568 Test Loss: 1.090 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.196918249130249
Epoch: 10, Steps: 10 | Train Loss: 0.058 Vali Loss: 1.094 Vali Acc: 0.541 Test Loss: 1.094 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.4521894454956055
Epoch: 11, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.087 Vali Acc: 0.608 Test Loss: 1.087 Test Acc: 0.608
Validation loss decreased (-0.608097 --> -0.608097).  Saving model ...
Epoch: 12 cost time: 4.419326305389404
Epoch: 12, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.064 Vali Acc: 0.622 Test Loss: 1.064 Test Acc: 0.622
Validation loss decreased (-0.608097 --> -0.621611).  Saving model ...
Epoch: 13 cost time: 4.512753486633301
Epoch: 13, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.116 Vali Acc: 0.554 Test Loss: 1.116 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.278854131698608
Epoch: 14, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.130 Vali Acc: 0.581 Test Loss: 1.130 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.531916379928589
Epoch: 15, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.121 Vali Acc: 0.581 Test Loss: 1.121 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.739748001098633
Epoch: 16, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.142 Vali Acc: 0.581 Test Loss: 1.142 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.95185923576355
Epoch: 17, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.147 Vali Acc: 0.581 Test Loss: 1.147 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.8669114112854004
Epoch: 18, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.170 Vali Acc: 0.541 Test Loss: 1.170 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.5614283084869385
Epoch: 19, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.198 Vali Acc: 0.541 Test Loss: 1.198 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 4.309207201004028
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.234 Vali Acc: 0.514 Test Loss: 1.234 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 4.200612545013428
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.160 Vali Acc: 0.581 Test Loss: 1.160 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 4.405226230621338
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.185 Vali Acc: 0.568 Test Loss: 1.185 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm32_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 2396804
model size : 9.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm32_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.293027877807617
Epoch: 1, Steps: 10 | Train Loss: 1.395 Vali Loss: 1.380 Vali Acc: 0.297 Test Loss: 1.380 Test Acc: 0.297
Validation loss decreased (inf --> -0.297284).  Saving model ...
Epoch: 2 cost time: 2.8163671493530273
Epoch: 2, Steps: 10 | Train Loss: 1.302 Vali Loss: 1.332 Vali Acc: 0.351 Test Loss: 1.332 Test Acc: 0.351
Validation loss decreased (-0.297284 --> -0.351338).  Saving model ...
Epoch: 3 cost time: 2.710559129714966
Epoch: 3, Steps: 10 | Train Loss: 1.137 Vali Loss: 1.288 Vali Acc: 0.378 Test Loss: 1.288 Test Acc: 0.378
Validation loss decreased (-0.351338 --> -0.378365).  Saving model ...
Epoch: 4 cost time: 2.7142436504364014
Epoch: 4, Steps: 10 | Train Loss: 0.930 Vali Loss: 1.215 Vali Acc: 0.459 Test Loss: 1.215 Test Acc: 0.459
Validation loss decreased (-0.378365 --> -0.459447).  Saving model ...
Epoch: 5 cost time: 2.5866730213165283
Epoch: 5, Steps: 10 | Train Loss: 0.750 Vali Loss: 1.144 Vali Acc: 0.554 Test Loss: 1.144 Test Acc: 0.554
Validation loss decreased (-0.459447 --> -0.554043).  Saving model ...
Epoch: 6 cost time: 2.5489559173583984
Epoch: 6, Steps: 10 | Train Loss: 0.570 Vali Loss: 1.092 Vali Acc: 0.554 Test Loss: 1.092 Test Acc: 0.554
Validation loss decreased (-0.554043 --> -0.554043).  Saving model ...
Epoch: 7 cost time: 2.837803602218628
Epoch: 7, Steps: 10 | Train Loss: 0.400 Vali Loss: 1.050 Vali Acc: 0.581 Test Loss: 1.050 Test Acc: 0.581
Validation loss decreased (-0.554043 --> -0.581071).  Saving model ...
Epoch: 8 cost time: 2.7565627098083496
Epoch: 8, Steps: 10 | Train Loss: 0.273 Vali Loss: 1.057 Vali Acc: 0.581 Test Loss: 1.057 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.847053289413452
Epoch: 9, Steps: 10 | Train Loss: 0.177 Vali Loss: 0.990 Vali Acc: 0.554 Test Loss: 0.990 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.9091570377349854
Epoch: 10, Steps: 10 | Train Loss: 0.100 Vali Loss: 1.013 Vali Acc: 0.568 Test Loss: 1.013 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.3961071968078613
Epoch: 11, Steps: 10 | Train Loss: 0.058 Vali Loss: 0.992 Vali Acc: 0.554 Test Loss: 0.992 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.4188480377197266
Epoch: 12, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.982 Vali Acc: 0.554 Test Loss: 0.982 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.426959991455078
Epoch: 13, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.961 Vali Acc: 0.554 Test Loss: 0.961 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.9121692180633545
Epoch: 14, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.951 Vali Acc: 0.581 Test Loss: 0.951 Test Acc: 0.581
Validation loss decreased (-0.581071 --> -0.581072).  Saving model ...
Epoch: 15 cost time: 2.822988748550415
Epoch: 15, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.071 Vali Acc: 0.581 Test Loss: 1.071 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.7452237606048584
Epoch: 16, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.029 Vali Acc: 0.568 Test Loss: 1.029 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.6863930225372314
Epoch: 17, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.023 Vali Acc: 0.568 Test Loss: 1.023 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.638230323791504
Epoch: 18, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.043 Vali Acc: 0.568 Test Loss: 1.043 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.0378100872039795
Epoch: 19, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.045 Vali Acc: 0.581 Test Loss: 1.045 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.9182190895080566
Epoch: 20, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.035 Vali Acc: 0.568 Test Loss: 1.035 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.950145721435547
Epoch: 21, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.053 Vali Acc: 0.568 Test Loss: 1.053 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.8878650665283203
Epoch: 22, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.109 Vali Acc: 0.581 Test Loss: 1.109 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 3.0095901489257812
Epoch: 23, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.089 Vali Acc: 0.581 Test Loss: 1.089 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.7107670307159424
Epoch: 24, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.077 Vali Acc: 0.581 Test Loss: 1.077 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm32_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 741508
model size : 3.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm32_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.0506391525268555
Epoch: 1, Steps: 10 | Train Loss: 1.482 Vali Loss: 1.420 Vali Acc: 0.270 Test Loss: 1.420 Test Acc: 0.270
Validation loss decreased (inf --> -0.270256).  Saving model ...
Epoch: 2 cost time: 3.308145761489868
Epoch: 2, Steps: 10 | Train Loss: 1.355 Vali Loss: 1.339 Vali Acc: 0.392 Test Loss: 1.339 Test Acc: 0.392
Validation loss decreased (-0.270256 --> -0.391878).  Saving model ...
Epoch: 3 cost time: 3.2724766731262207
Epoch: 3, Steps: 10 | Train Loss: 1.148 Vali Loss: 1.270 Vali Acc: 0.486 Test Loss: 1.270 Test Acc: 0.486
Validation loss decreased (-0.391878 --> -0.486474).  Saving model ...
Epoch: 4 cost time: 3.40771222114563
Epoch: 4, Steps: 10 | Train Loss: 0.983 Vali Loss: 1.196 Vali Acc: 0.541 Test Loss: 1.196 Test Acc: 0.541
Validation loss decreased (-0.486474 --> -0.540529).  Saving model ...
Epoch: 5 cost time: 3.122728109359741
Epoch: 5, Steps: 10 | Train Loss: 0.790 Vali Loss: 1.123 Vali Acc: 0.581 Test Loss: 1.123 Test Acc: 0.581
Validation loss decreased (-0.540529 --> -0.581070).  Saving model ...
Epoch: 6 cost time: 3.172701358795166
Epoch: 6, Steps: 10 | Train Loss: 0.611 Vali Loss: 1.087 Vali Acc: 0.568 Test Loss: 1.087 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.1793084144592285
Epoch: 7, Steps: 10 | Train Loss: 0.446 Vali Loss: 1.051 Vali Acc: 0.622 Test Loss: 1.051 Test Acc: 0.622
Validation loss decreased (-0.581070 --> -0.621611).  Saving model ...
Epoch: 8 cost time: 3.29914927482605
Epoch: 8, Steps: 10 | Train Loss: 0.310 Vali Loss: 1.012 Vali Acc: 0.595 Test Loss: 1.012 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.275800943374634
Epoch: 9, Steps: 10 | Train Loss: 0.206 Vali Loss: 0.999 Vali Acc: 0.595 Test Loss: 0.999 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.8805439472198486
Epoch: 10, Steps: 10 | Train Loss: 0.114 Vali Loss: 0.932 Vali Acc: 0.676 Test Loss: 0.932 Test Acc: 0.676
Validation loss decreased (-0.621611 --> -0.675666).  Saving model ...
Epoch: 11 cost time: 2.9945764541625977
Epoch: 11, Steps: 10 | Train Loss: 0.070 Vali Loss: 0.957 Vali Acc: 0.649 Test Loss: 0.957 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.3661818504333496
Epoch: 12, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.915 Vali Acc: 0.662 Test Loss: 0.915 Test Acc: 0.662
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.3679869174957275
Epoch: 13, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.982 Vali Acc: 0.649 Test Loss: 0.982 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.3409483432769775
Epoch: 14, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.991 Vali Acc: 0.635 Test Loss: 0.991 Test Acc: 0.635
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.321526288986206
Epoch: 15, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.944 Vali Acc: 0.649 Test Loss: 0.944 Test Acc: 0.649
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.2378244400024414
Epoch: 16, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.027 Vali Acc: 0.622 Test Loss: 1.027 Test Acc: 0.622
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.312239408493042
Epoch: 17, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.028 Vali Acc: 0.635 Test Loss: 1.028 Test Acc: 0.635
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.4632294178009033
Epoch: 18, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.026 Vali Acc: 0.635 Test Loss: 1.026 Test Acc: 0.635
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.232689142227173
Epoch: 19, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.044 Vali Acc: 0.635 Test Loss: 1.044 Test Acc: 0.635
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.3951709270477295
Epoch: 20, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.043 Vali Acc: 0.608 Test Loss: 1.043 Test Acc: 0.608
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm32_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6756756756756757
model parameter : 2396804
model size : 9.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm32_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.4193994998931885
Epoch: 1, Steps: 10 | Train Loss: 1.399 Vali Loss: 1.378 Vali Acc: 0.284 Test Loss: 1.378 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 1.999448537826538
Epoch: 2, Steps: 10 | Train Loss: 1.313 Vali Loss: 1.328 Vali Acc: 0.365 Test Loss: 1.328 Test Acc: 0.365
Validation loss decreased (-0.283770 --> -0.364852).  Saving model ...
Epoch: 3 cost time: 2.389812469482422
Epoch: 3, Steps: 10 | Train Loss: 1.152 Vali Loss: 1.277 Vali Acc: 0.392 Test Loss: 1.277 Test Acc: 0.392
Validation loss decreased (-0.364852 --> -0.391879).  Saving model ...
Epoch: 4 cost time: 2.4028894901275635
Epoch: 4, Steps: 10 | Train Loss: 0.960 Vali Loss: 1.206 Vali Acc: 0.473 Test Loss: 1.206 Test Acc: 0.473
Validation loss decreased (-0.391879 --> -0.472961).  Saving model ...
Epoch: 5 cost time: 2.3118696212768555
Epoch: 5, Steps: 10 | Train Loss: 0.790 Vali Loss: 1.122 Vali Acc: 0.541 Test Loss: 1.122 Test Acc: 0.541
Validation loss decreased (-0.472961 --> -0.540529).  Saving model ...
Epoch: 6 cost time: 2.3352410793304443
Epoch: 6, Steps: 10 | Train Loss: 0.614 Vali Loss: 1.073 Vali Acc: 0.541 Test Loss: 1.073 Test Acc: 0.541
Validation loss decreased (-0.540529 --> -0.540530).  Saving model ...
Epoch: 7 cost time: 2.0793979167938232
Epoch: 7, Steps: 10 | Train Loss: 0.451 Vali Loss: 1.022 Vali Acc: 0.622 Test Loss: 1.022 Test Acc: 0.622
Validation loss decreased (-0.540530 --> -0.621611).  Saving model ...
Epoch: 8 cost time: 2.4316821098327637
Epoch: 8, Steps: 10 | Train Loss: 0.306 Vali Loss: 0.997 Vali Acc: 0.608 Test Loss: 0.997 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.3133177757263184
Epoch: 9, Steps: 10 | Train Loss: 0.207 Vali Loss: 0.969 Vali Acc: 0.581 Test Loss: 0.969 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.5558202266693115
Epoch: 10, Steps: 10 | Train Loss: 0.121 Vali Loss: 0.935 Vali Acc: 0.595 Test Loss: 0.935 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.161857843399048
Epoch: 11, Steps: 10 | Train Loss: 0.073 Vali Loss: 0.919 Vali Acc: 0.595 Test Loss: 0.919 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.3987233638763428
Epoch: 12, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.931 Vali Acc: 0.595 Test Loss: 0.931 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.3855342864990234
Epoch: 13, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.947 Vali Acc: 0.622 Test Loss: 0.947 Test Acc: 0.622
Validation loss decreased (-0.621611 --> -0.621612).  Saving model ...
Epoch: 14 cost time: 2.0790703296661377
Epoch: 14, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.897 Vali Acc: 0.595 Test Loss: 0.897 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.4256298542022705
Epoch: 15, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.997 Vali Acc: 0.622 Test Loss: 0.997 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.124297618865967
Epoch: 16, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.963 Vali Acc: 0.622 Test Loss: 0.963 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.5472371578216553
Epoch: 17, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.929 Vali Acc: 0.622 Test Loss: 0.929 Test Acc: 0.622
Validation loss decreased (-0.621612 --> -0.621612).  Saving model ...
Epoch: 18 cost time: 2.2291171550750732
Epoch: 18, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.973 Vali Acc: 0.622 Test Loss: 0.973 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.286491870880127
Epoch: 19, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.981 Vali Acc: 0.635 Test Loss: 0.981 Test Acc: 0.635
Validation loss decreased (-0.621612 --> -0.635125).  Saving model ...
Epoch: 20 cost time: 2.3115594387054443
Epoch: 20, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.964 Vali Acc: 0.622 Test Loss: 0.964 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.1605842113494873
Epoch: 21, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.977 Vali Acc: 0.622 Test Loss: 0.977 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.46600604057312
Epoch: 22, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.011 Vali Acc: 0.635 Test Loss: 1.011 Test Acc: 0.635
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.262830972671509
Epoch: 23, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.017 Vali Acc: 0.635 Test Loss: 1.017 Test Acc: 0.635
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.4087929725646973
Epoch: 24, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.019 Vali Acc: 0.622 Test Loss: 1.019 Test Acc: 0.622
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.2877466678619385
Epoch: 25, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.018 Vali Acc: 0.622 Test Loss: 1.018 Test Acc: 0.622
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.2588934898376465
Epoch: 26, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.029 Vali Acc: 0.635 Test Loss: 1.029 Test Acc: 0.635
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.4541938304901123
Epoch: 27, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.048 Vali Acc: 0.635 Test Loss: 1.048 Test Acc: 0.635
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.135913372039795
Epoch: 28, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.056 Vali Acc: 0.635 Test Loss: 1.056 Test Acc: 0.635
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.9784090518951416
Epoch: 29, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.040 Vali Acc: 0.635 Test Loss: 1.040 Test Acc: 0.635
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm32_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6351351351351351
model parameter : 741508
model size : 3.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm16_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 9.129180192947388
Epoch: 1, Steps: 10 | Train Loss: 1.433 Vali Loss: 1.396 Vali Acc: 0.257 Test Loss: 1.396 Test Acc: 0.257
Validation loss decreased (inf --> -0.256743).  Saving model ...
Epoch: 2 cost time: 7.084511995315552
Epoch: 2, Steps: 10 | Train Loss: 1.346 Vali Loss: 1.332 Vali Acc: 0.338 Test Loss: 1.332 Test Acc: 0.338
Validation loss decreased (-0.256743 --> -0.337825).  Saving model ...
Epoch: 3 cost time: 7.283952236175537
Epoch: 3, Steps: 10 | Train Loss: 1.261 Vali Loss: 1.297 Vali Acc: 0.486 Test Loss: 1.297 Test Acc: 0.486
Validation loss decreased (-0.337825 --> -0.486474).  Saving model ...
Epoch: 4 cost time: 7.428318023681641
Epoch: 4, Steps: 10 | Train Loss: 1.118 Vali Loss: 1.293 Vali Acc: 0.486 Test Loss: 1.293 Test Acc: 0.486
Validation loss decreased (-0.486474 --> -0.486474).  Saving model ...
Epoch: 5 cost time: 7.175937652587891
Epoch: 5, Steps: 10 | Train Loss: 0.991 Vali Loss: 1.238 Vali Acc: 0.527 Test Loss: 1.238 Test Acc: 0.527
Validation loss decreased (-0.486474 --> -0.527015).  Saving model ...
Epoch: 6 cost time: 7.110148906707764
Epoch: 6, Steps: 10 | Train Loss: 0.818 Vali Loss: 1.207 Vali Acc: 0.527 Test Loss: 1.207 Test Acc: 0.527
Validation loss decreased (-0.527015 --> -0.527015).  Saving model ...
Epoch: 7 cost time: 6.335162401199341
Epoch: 7, Steps: 10 | Train Loss: 0.719 Vali Loss: 1.160 Vali Acc: 0.581 Test Loss: 1.160 Test Acc: 0.581
Validation loss decreased (-0.527015 --> -0.581069).  Saving model ...
Epoch: 8 cost time: 6.728734016418457
Epoch: 8, Steps: 10 | Train Loss: 0.603 Vali Loss: 1.159 Vali Acc: 0.486 Test Loss: 1.159 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 7.199718952178955
Epoch: 9, Steps: 10 | Train Loss: 0.471 Vali Loss: 1.087 Vali Acc: 0.568 Test Loss: 1.087 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 7.074754238128662
Epoch: 10, Steps: 10 | Train Loss: 0.363 Vali Loss: 1.046 Vali Acc: 0.608 Test Loss: 1.046 Test Acc: 0.608
Validation loss decreased (-0.581069 --> -0.608098).  Saving model ...
Epoch: 11 cost time: 6.034784555435181
Epoch: 11, Steps: 10 | Train Loss: 0.258 Vali Loss: 1.008 Vali Acc: 0.635 Test Loss: 1.008 Test Acc: 0.635
Validation loss decreased (-0.608098 --> -0.635125).  Saving model ...
Epoch: 12 cost time: 7.890880584716797
Epoch: 12, Steps: 10 | Train Loss: 0.179 Vali Loss: 0.968 Vali Acc: 0.595 Test Loss: 0.968 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 8.112827777862549
Epoch: 13, Steps: 10 | Train Loss: 0.116 Vali Loss: 0.910 Vali Acc: 0.608 Test Loss: 0.910 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 7.925149440765381
Epoch: 14, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.880 Vali Acc: 0.622 Test Loss: 0.880 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 7.857540845870972
Epoch: 15, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.909 Vali Acc: 0.608 Test Loss: 0.909 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 8.104481935501099
Epoch: 16, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.895 Vali Acc: 0.608 Test Loss: 0.895 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 6.562618732452393
Epoch: 17, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.904 Vali Acc: 0.608 Test Loss: 0.904 Test Acc: 0.608
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 7.691391944885254
Epoch: 18, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.884 Vali Acc: 0.662 Test Loss: 0.884 Test Acc: 0.662
Validation loss decreased (-0.635125 --> -0.662153).  Saving model ...
Epoch: 19 cost time: 7.773422002792358
Epoch: 19, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.918 Vali Acc: 0.662 Test Loss: 0.918 Test Acc: 0.662
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 7.60557222366333
Epoch: 20, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.924 Vali Acc: 0.662 Test Loss: 0.924 Test Acc: 0.662
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 6.829160213470459
Epoch: 21, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.932 Vali Acc: 0.635 Test Loss: 0.932 Test Acc: 0.635
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 7.214828252792358
Epoch: 22, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.955 Vali Acc: 0.622 Test Loss: 0.955 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 7.345191717147827
Epoch: 23, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.978 Vali Acc: 0.622 Test Loss: 0.978 Test Acc: 0.622
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 6.733196973800659
Epoch: 24, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.959 Vali Acc: 0.635 Test Loss: 0.959 Test Acc: 0.635
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 7.126309394836426
Epoch: 25, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.978 Vali Acc: 0.635 Test Loss: 0.978 Test Acc: 0.635
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 7.438891172409058
Epoch: 26, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.979 Vali Acc: 0.635 Test Loss: 0.979 Test Acc: 0.635
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 7.253672361373901
Epoch: 27, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.992 Vali Acc: 0.635 Test Loss: 0.992 Test Acc: 0.635
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 7.296277761459351
Epoch: 28, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.047 Vali Acc: 0.622 Test Loss: 1.047 Test Acc: 0.622
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm16_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6621621621621622
model parameter : 2371012
model size : 9.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm16_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.867825984954834
Epoch: 1, Steps: 10 | Train Loss: 1.439 Vali Loss: 1.415 Vali Acc: 0.243 Test Loss: 1.415 Test Acc: 0.243
Validation loss decreased (inf --> -0.243229).  Saving model ...
Epoch: 2 cost time: 2.744412899017334
Epoch: 2, Steps: 10 | Train Loss: 1.376 Vali Loss: 1.395 Vali Acc: 0.243 Test Loss: 1.395 Test Acc: 0.243
Validation loss decreased (-0.243229 --> -0.243229).  Saving model ...
Epoch: 3 cost time: 2.7139410972595215
Epoch: 3, Steps: 10 | Train Loss: 1.222 Vali Loss: 1.372 Vali Acc: 0.284 Test Loss: 1.372 Test Acc: 0.284
Validation loss decreased (-0.243229 --> -0.283770).  Saving model ...
Epoch: 4 cost time: 2.3358917236328125
Epoch: 4, Steps: 10 | Train Loss: 1.094 Vali Loss: 1.298 Vali Acc: 0.338 Test Loss: 1.298 Test Acc: 0.338
Validation loss decreased (-0.283770 --> -0.337825).  Saving model ...
Epoch: 5 cost time: 3.371795415878296
Epoch: 5, Steps: 10 | Train Loss: 0.980 Vali Loss: 1.301 Vali Acc: 0.432 Test Loss: 1.301 Test Acc: 0.432
Validation loss decreased (-0.337825 --> -0.432419).  Saving model ...
Epoch: 6 cost time: 3.863767623901367
Epoch: 6, Steps: 10 | Train Loss: 0.813 Vali Loss: 1.233 Vali Acc: 0.432 Test Loss: 1.233 Test Acc: 0.432
Validation loss decreased (-0.432419 --> -0.432420).  Saving model ...
Epoch: 7 cost time: 3.5842437744140625
Epoch: 7, Steps: 10 | Train Loss: 0.668 Vali Loss: 1.213 Vali Acc: 0.486 Test Loss: 1.213 Test Acc: 0.486
Validation loss decreased (-0.432420 --> -0.486474).  Saving model ...
Epoch: 8 cost time: 3.4336442947387695
Epoch: 8, Steps: 10 | Train Loss: 0.540 Vali Loss: 1.170 Vali Acc: 0.527 Test Loss: 1.170 Test Acc: 0.527
Validation loss decreased (-0.486474 --> -0.527015).  Saving model ...
Epoch: 9 cost time: 3.426650047302246
Epoch: 9, Steps: 10 | Train Loss: 0.409 Vali Loss: 1.136 Vali Acc: 0.527 Test Loss: 1.136 Test Acc: 0.527
Validation loss decreased (-0.527015 --> -0.527016).  Saving model ...
Epoch: 10 cost time: 3.5099759101867676
Epoch: 10, Steps: 10 | Train Loss: 0.308 Vali Loss: 1.122 Vali Acc: 0.554 Test Loss: 1.122 Test Acc: 0.554
Validation loss decreased (-0.527016 --> -0.554043).  Saving model ...
Epoch: 11 cost time: 3.630075216293335
Epoch: 11, Steps: 10 | Train Loss: 0.223 Vali Loss: 1.101 Vali Acc: 0.541 Test Loss: 1.101 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.5647823810577393
Epoch: 12, Steps: 10 | Train Loss: 0.155 Vali Loss: 1.099 Vali Acc: 0.541 Test Loss: 1.099 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.505596160888672
Epoch: 13, Steps: 10 | Train Loss: 0.105 Vali Loss: 1.080 Vali Acc: 0.554 Test Loss: 1.080 Test Acc: 0.554
Validation loss decreased (-0.554043 --> -0.554043).  Saving model ...
Epoch: 14 cost time: 3.670193672180176
Epoch: 14, Steps: 10 | Train Loss: 0.079 Vali Loss: 1.084 Vali Acc: 0.568 Test Loss: 1.084 Test Acc: 0.568
Validation loss decreased (-0.554043 --> -0.567557).  Saving model ...
Epoch: 15 cost time: 3.416750192642212
Epoch: 15, Steps: 10 | Train Loss: 0.057 Vali Loss: 1.129 Vali Acc: 0.568 Test Loss: 1.129 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.6897757053375244
Epoch: 16, Steps: 10 | Train Loss: 0.043 Vali Loss: 1.101 Vali Acc: 0.581 Test Loss: 1.101 Test Acc: 0.581
Validation loss decreased (-0.567557 --> -0.581070).  Saving model ...
Epoch: 17 cost time: 3.8491616249084473
Epoch: 17, Steps: 10 | Train Loss: 0.036 Vali Loss: 1.118 Vali Acc: 0.581 Test Loss: 1.118 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.858844041824341
Epoch: 18, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.142 Vali Acc: 0.568 Test Loss: 1.142 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.5418179035186768
Epoch: 19, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.136 Vali Acc: 0.581 Test Loss: 1.136 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.624173641204834
Epoch: 20, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.146 Vali Acc: 0.581 Test Loss: 1.146 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.348019599914551
Epoch: 21, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.138 Vali Acc: 0.608 Test Loss: 1.138 Test Acc: 0.608
Validation loss decreased (-0.581070 --> -0.608097).  Saving model ...
Epoch: 22 cost time: 3.6182167530059814
Epoch: 22, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.146 Vali Acc: 0.608 Test Loss: 1.146 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.5442895889282227
Epoch: 23, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.155 Vali Acc: 0.608 Test Loss: 1.155 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.4450504779815674
Epoch: 24, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.154 Vali Acc: 0.595 Test Loss: 1.154 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.4835314750671387
Epoch: 25, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.145 Vali Acc: 0.622 Test Loss: 1.145 Test Acc: 0.622
Validation loss decreased (-0.608097 --> -0.621610).  Saving model ...
Epoch: 26 cost time: 3.2943100929260254
Epoch: 26, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.192 Vali Acc: 0.608 Test Loss: 1.192 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.344214677810669
Epoch: 27, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.215 Vali Acc: 0.608 Test Loss: 1.215 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 4.009567499160767
Epoch: 28, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.205 Vali Acc: 0.595 Test Loss: 1.205 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 4.702953100204468
Epoch: 29, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.197 Vali Acc: 0.595 Test Loss: 1.197 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 4.420080900192261
Epoch: 30, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.208 Vali Acc: 0.595 Test Loss: 1.208 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm16_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 715588
model size : 3.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm16_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 7.446413040161133
Epoch: 1, Steps: 10 | Train Loss: 1.432 Vali Loss: 1.392 Vali Acc: 0.297 Test Loss: 1.392 Test Acc: 0.297
Validation loss decreased (inf --> -0.297283).  Saving model ...
Epoch: 2 cost time: 5.939093589782715
Epoch: 2, Steps: 10 | Train Loss: 1.350 Vali Loss: 1.325 Vali Acc: 0.338 Test Loss: 1.325 Test Acc: 0.338
Validation loss decreased (-0.297283 --> -0.337825).  Saving model ...
Epoch: 3 cost time: 5.811750173568726
Epoch: 3, Steps: 10 | Train Loss: 1.276 Vali Loss: 1.290 Vali Acc: 0.473 Test Loss: 1.290 Test Acc: 0.473
Validation loss decreased (-0.337825 --> -0.472960).  Saving model ...
Epoch: 4 cost time: 5.897796869277954
Epoch: 4, Steps: 10 | Train Loss: 1.144 Vali Loss: 1.283 Vali Acc: 0.500 Test Loss: 1.283 Test Acc: 0.500
Validation loss decreased (-0.472960 --> -0.499987).  Saving model ...
Epoch: 5 cost time: 5.776889085769653
Epoch: 5, Steps: 10 | Train Loss: 1.019 Vali Loss: 1.225 Vali Acc: 0.541 Test Loss: 1.225 Test Acc: 0.541
Validation loss decreased (-0.499987 --> -0.540528).  Saving model ...
Epoch: 6 cost time: 6.001311540603638
Epoch: 6, Steps: 10 | Train Loss: 0.858 Vali Loss: 1.190 Vali Acc: 0.527 Test Loss: 1.190 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.764620065689087
Epoch: 7, Steps: 10 | Train Loss: 0.759 Vali Loss: 1.133 Vali Acc: 0.622 Test Loss: 1.133 Test Acc: 0.622
Validation loss decreased (-0.540528 --> -0.621610).  Saving model ...
Epoch: 8 cost time: 4.584771394729614
Epoch: 8, Steps: 10 | Train Loss: 0.639 Vali Loss: 1.133 Vali Acc: 0.527 Test Loss: 1.133 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.112938165664673
Epoch: 9, Steps: 10 | Train Loss: 0.499 Vali Loss: 1.039 Vali Acc: 0.622 Test Loss: 1.039 Test Acc: 0.622
Validation loss decreased (-0.621610 --> -0.621611).  Saving model ...
Epoch: 10 cost time: 5.155059099197388
Epoch: 10, Steps: 10 | Train Loss: 0.377 Vali Loss: 0.961 Vali Acc: 0.568 Test Loss: 0.961 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.640052318572998
Epoch: 11, Steps: 10 | Train Loss: 0.264 Vali Loss: 0.899 Vali Acc: 0.662 Test Loss: 0.899 Test Acc: 0.662
Validation loss decreased (-0.621611 --> -0.662153).  Saving model ...
Epoch: 12 cost time: 5.785510301589966
Epoch: 12, Steps: 10 | Train Loss: 0.176 Vali Loss: 0.837 Vali Acc: 0.635 Test Loss: 0.837 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.237512111663818
Epoch: 13, Steps: 10 | Train Loss: 0.115 Vali Loss: 0.794 Vali Acc: 0.689 Test Loss: 0.794 Test Acc: 0.689
Validation loss decreased (-0.662153 --> -0.689181).  Saving model ...
Epoch: 14 cost time: 6.00028133392334
Epoch: 14, Steps: 10 | Train Loss: 0.075 Vali Loss: 0.828 Vali Acc: 0.649 Test Loss: 0.828 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.00902533531189
Epoch: 15, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.806 Vali Acc: 0.689 Test Loss: 0.806 Test Acc: 0.689
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 6.242342710494995
Epoch: 16, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.788 Vali Acc: 0.689 Test Loss: 0.788 Test Acc: 0.689
Validation loss decreased (-0.689181 --> -0.689181).  Saving model ...
Epoch: 17 cost time: 5.857318878173828
Epoch: 17, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.820 Vali Acc: 0.689 Test Loss: 0.820 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.873014688491821
Epoch: 18, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.816 Vali Acc: 0.662 Test Loss: 0.816 Test Acc: 0.662
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 6.064908266067505
Epoch: 19, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.834 Vali Acc: 0.676 Test Loss: 0.834 Test Acc: 0.676
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 6.195481777191162
Epoch: 20, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.830 Vali Acc: 0.689 Test Loss: 0.830 Test Acc: 0.689
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 5.448416233062744
Epoch: 21, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.838 Vali Acc: 0.676 Test Loss: 0.838 Test Acc: 0.676
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 5.869976997375488
Epoch: 22, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.872 Vali Acc: 0.635 Test Loss: 0.872 Test Acc: 0.635
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 6.455757141113281
Epoch: 23, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.878 Vali Acc: 0.676 Test Loss: 0.878 Test Acc: 0.676
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 6.467541217803955
Epoch: 24, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.817 Vali Acc: 0.649 Test Loss: 0.817 Test Acc: 0.649
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 6.138934850692749
Epoch: 25, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.918 Vali Acc: 0.635 Test Loss: 0.918 Test Acc: 0.635
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 6.452296257019043
Epoch: 26, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.998 Vali Acc: 0.608 Test Loss: 0.998 Test Acc: 0.608
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm16_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6891891891891891
model parameter : 2371012
model size : 9.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm16_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.651819944381714
Epoch: 1, Steps: 10 | Train Loss: 1.441 Vali Loss: 1.418 Vali Acc: 0.230 Test Loss: 1.418 Test Acc: 0.230
Validation loss decreased (inf --> -0.229716).  Saving model ...
Epoch: 2 cost time: 3.8646998405456543
Epoch: 2, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.395 Vali Acc: 0.257 Test Loss: 1.395 Test Acc: 0.257
Validation loss decreased (-0.229716 --> -0.256743).  Saving model ...
Epoch: 3 cost time: 3.506235122680664
Epoch: 3, Steps: 10 | Train Loss: 1.238 Vali Loss: 1.367 Vali Acc: 0.351 Test Loss: 1.367 Test Acc: 0.351
Validation loss decreased (-0.256743 --> -0.351338).  Saving model ...
Epoch: 4 cost time: 3.27811336517334
Epoch: 4, Steps: 10 | Train Loss: 1.125 Vali Loss: 1.290 Vali Acc: 0.392 Test Loss: 1.290 Test Acc: 0.392
Validation loss decreased (-0.351338 --> -0.391879).  Saving model ...
Epoch: 5 cost time: 3.4919490814208984
Epoch: 5, Steps: 10 | Train Loss: 1.037 Vali Loss: 1.292 Vali Acc: 0.432 Test Loss: 1.292 Test Acc: 0.432
Validation loss decreased (-0.391879 --> -0.432420).  Saving model ...
Epoch: 6 cost time: 3.22232723236084
Epoch: 6, Steps: 10 | Train Loss: 0.870 Vali Loss: 1.211 Vali Acc: 0.486 Test Loss: 1.211 Test Acc: 0.486
Validation loss decreased (-0.432420 --> -0.486474).  Saving model ...
Epoch: 7 cost time: 2.5600976943969727
Epoch: 7, Steps: 10 | Train Loss: 0.731 Vali Loss: 1.180 Vali Acc: 0.500 Test Loss: 1.180 Test Acc: 0.500
Validation loss decreased (-0.486474 --> -0.499988).  Saving model ...
Epoch: 8 cost time: 3.3770089149475098
Epoch: 8, Steps: 10 | Train Loss: 0.607 Vali Loss: 1.134 Vali Acc: 0.541 Test Loss: 1.134 Test Acc: 0.541
Validation loss decreased (-0.499988 --> -0.540529).  Saving model ...
Epoch: 9 cost time: 3.0894479751586914
Epoch: 9, Steps: 10 | Train Loss: 0.475 Vali Loss: 1.095 Vali Acc: 0.527 Test Loss: 1.095 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.0057740211486816
Epoch: 10, Steps: 10 | Train Loss: 0.364 Vali Loss: 1.058 Vali Acc: 0.568 Test Loss: 1.058 Test Acc: 0.568
Validation loss decreased (-0.540529 --> -0.567557).  Saving model ...
Epoch: 11 cost time: 2.7190024852752686
Epoch: 11, Steps: 10 | Train Loss: 0.264 Vali Loss: 1.013 Vali Acc: 0.581 Test Loss: 1.013 Test Acc: 0.581
Validation loss decreased (-0.567557 --> -0.581071).  Saving model ...
Epoch: 12 cost time: 3.3418190479278564
Epoch: 12, Steps: 10 | Train Loss: 0.189 Vali Loss: 0.979 Vali Acc: 0.608 Test Loss: 0.979 Test Acc: 0.608
Validation loss decreased (-0.581071 --> -0.608098).  Saving model ...
Epoch: 13 cost time: 2.751805543899536
Epoch: 13, Steps: 10 | Train Loss: 0.133 Vali Loss: 0.943 Vali Acc: 0.581 Test Loss: 0.943 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.0029757022857666
Epoch: 14, Steps: 10 | Train Loss: 0.095 Vali Loss: 0.947 Vali Acc: 0.608 Test Loss: 0.947 Test Acc: 0.608
Validation loss decreased (-0.608098 --> -0.608099).  Saving model ...
Epoch: 15 cost time: 2.60837721824646
Epoch: 15, Steps: 10 | Train Loss: 0.069 Vali Loss: 0.955 Vali Acc: 0.622 Test Loss: 0.955 Test Acc: 0.622
Validation loss decreased (-0.608099 --> -0.621612).  Saving model ...
Epoch: 16 cost time: 2.9517033100128174
Epoch: 16, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.918 Vali Acc: 0.622 Test Loss: 0.918 Test Acc: 0.622
Validation loss decreased (-0.621612 --> -0.621612).  Saving model ...
Epoch: 17 cost time: 3.058311939239502
Epoch: 17, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.941 Vali Acc: 0.608 Test Loss: 0.941 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.914572238922119
Epoch: 18, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.961 Vali Acc: 0.622 Test Loss: 0.961 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.1086182594299316
Epoch: 19, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.938 Vali Acc: 0.608 Test Loss: 0.938 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.204272985458374
Epoch: 20, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.961 Vali Acc: 0.622 Test Loss: 0.961 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.4300696849823
Epoch: 21, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.994 Vali Acc: 0.608 Test Loss: 0.994 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 3.4830358028411865
Epoch: 22, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.995 Vali Acc: 0.622 Test Loss: 0.995 Test Acc: 0.622
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 3.156681537628174
Epoch: 23, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.995 Vali Acc: 0.622 Test Loss: 0.995 Test Acc: 0.622
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 3.2676990032196045
Epoch: 24, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.982 Vali Acc: 0.608 Test Loss: 0.982 Test Acc: 0.608
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 3.364539623260498
Epoch: 25, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.991 Vali Acc: 0.608 Test Loss: 0.991 Test Acc: 0.608
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 3.159494400024414
Epoch: 26, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.024 Vali Acc: 0.622 Test Loss: 1.024 Test Acc: 0.622
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm16_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 715588
model size : 3.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm16_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.532701730728149
Epoch: 1, Steps: 10 | Train Loss: 1.435 Vali Loss: 1.395 Vali Acc: 0.297 Test Loss: 1.395 Test Acc: 0.297
Validation loss decreased (inf --> -0.297283).  Saving model ...
Epoch: 2 cost time: 4.020782709121704
Epoch: 2, Steps: 10 | Train Loss: 1.355 Vali Loss: 1.328 Vali Acc: 0.338 Test Loss: 1.328 Test Acc: 0.338
Validation loss decreased (-0.297283 --> -0.337825).  Saving model ...
Epoch: 3 cost time: 4.156162261962891
Epoch: 3, Steps: 10 | Train Loss: 1.286 Vali Loss: 1.292 Vali Acc: 0.446 Test Loss: 1.292 Test Acc: 0.446
Validation loss decreased (-0.337825 --> -0.445933).  Saving model ...
Epoch: 4 cost time: 4.301846265792847
Epoch: 4, Steps: 10 | Train Loss: 1.162 Vali Loss: 1.288 Vali Acc: 0.500 Test Loss: 1.288 Test Acc: 0.500
Validation loss decreased (-0.445933 --> -0.499987).  Saving model ...
Epoch: 5 cost time: 3.9830095767974854
Epoch: 5, Steps: 10 | Train Loss: 1.044 Vali Loss: 1.234 Vali Acc: 0.527 Test Loss: 1.234 Test Acc: 0.527
Validation loss decreased (-0.499987 --> -0.527015).  Saving model ...
Epoch: 6 cost time: 4.025618314743042
Epoch: 6, Steps: 10 | Train Loss: 0.892 Vali Loss: 1.202 Vali Acc: 0.541 Test Loss: 1.202 Test Acc: 0.541
Validation loss decreased (-0.527015 --> -0.540529).  Saving model ...
Epoch: 7 cost time: 3.923128604888916
Epoch: 7, Steps: 10 | Train Loss: 0.803 Vali Loss: 1.147 Vali Acc: 0.595 Test Loss: 1.147 Test Acc: 0.595
Validation loss decreased (-0.540529 --> -0.594583).  Saving model ...
Epoch: 8 cost time: 3.982785940170288
Epoch: 8, Steps: 10 | Train Loss: 0.690 Vali Loss: 1.142 Vali Acc: 0.527 Test Loss: 1.142 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.762913703918457
Epoch: 9, Steps: 10 | Train Loss: 0.549 Vali Loss: 1.051 Vali Acc: 0.595 Test Loss: 1.051 Test Acc: 0.595
Validation loss decreased (-0.594583 --> -0.594584).  Saving model ...
Epoch: 10 cost time: 3.8134829998016357
Epoch: 10, Steps: 10 | Train Loss: 0.425 Vali Loss: 0.965 Vali Acc: 0.608 Test Loss: 0.965 Test Acc: 0.608
Validation loss decreased (-0.594584 --> -0.608098).  Saving model ...
Epoch: 11 cost time: 4.129851818084717
Epoch: 11, Steps: 10 | Train Loss: 0.313 Vali Loss: 0.884 Vali Acc: 0.662 Test Loss: 0.884 Test Acc: 0.662
Validation loss decreased (-0.608098 --> -0.662153).  Saving model ...
Epoch: 12 cost time: 3.9583358764648438
Epoch: 12, Steps: 10 | Train Loss: 0.218 Vali Loss: 0.842 Vali Acc: 0.622 Test Loss: 0.842 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.13137412071228
Epoch: 13, Steps: 10 | Train Loss: 0.152 Vali Loss: 0.780 Vali Acc: 0.676 Test Loss: 0.780 Test Acc: 0.676
Validation loss decreased (-0.662153 --> -0.675668).  Saving model ...
Epoch: 14 cost time: 4.109507083892822
Epoch: 14, Steps: 10 | Train Loss: 0.106 Vali Loss: 0.802 Vali Acc: 0.649 Test Loss: 0.802 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.245009183883667
Epoch: 15, Steps: 10 | Train Loss: 0.083 Vali Loss: 0.798 Vali Acc: 0.676 Test Loss: 0.798 Test Acc: 0.676
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.279019832611084
Epoch: 16, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.797 Vali Acc: 0.662 Test Loss: 0.797 Test Acc: 0.662
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 4.025087118148804
Epoch: 17, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.812 Vali Acc: 0.662 Test Loss: 0.812 Test Acc: 0.662
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.6033711433410645
Epoch: 18, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.802 Vali Acc: 0.662 Test Loss: 0.802 Test Acc: 0.662
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.7539446353912354
Epoch: 19, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.825 Vali Acc: 0.662 Test Loss: 0.825 Test Acc: 0.662
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.590312957763672
Epoch: 20, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.823 Vali Acc: 0.676 Test Loss: 0.823 Test Acc: 0.676
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.8529138565063477
Epoch: 21, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.804 Vali Acc: 0.662 Test Loss: 0.804 Test Acc: 0.662
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 3.9946300983428955
Epoch: 22, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.856 Vali Acc: 0.662 Test Loss: 0.856 Test Acc: 0.662
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.6680660247802734
Epoch: 23, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.866 Vali Acc: 0.662 Test Loss: 0.866 Test Acc: 0.662
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm16_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6756756756756757
model parameter : 2371012
model size : 9.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm16_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.608433246612549
Epoch: 1, Steps: 10 | Train Loss: 1.446 Vali Loss: 1.417 Vali Acc: 0.230 Test Loss: 1.417 Test Acc: 0.230
Validation loss decreased (inf --> -0.229716).  Saving model ...
Epoch: 2 cost time: 2.0517122745513916
Epoch: 2, Steps: 10 | Train Loss: 1.389 Vali Loss: 1.394 Vali Acc: 0.243 Test Loss: 1.394 Test Acc: 0.243
Validation loss decreased (-0.229716 --> -0.243229).  Saving model ...
Epoch: 3 cost time: 1.9865765571594238
Epoch: 3, Steps: 10 | Train Loss: 1.252 Vali Loss: 1.364 Vali Acc: 0.378 Test Loss: 1.364 Test Acc: 0.378
Validation loss decreased (-0.243229 --> -0.378365).  Saving model ...
Epoch: 4 cost time: 2.0243587493896484
Epoch: 4, Steps: 10 | Train Loss: 1.138 Vali Loss: 1.289 Vali Acc: 0.378 Test Loss: 1.289 Test Acc: 0.378
Validation loss decreased (-0.378365 --> -0.378365).  Saving model ...
Epoch: 5 cost time: 2.219555139541626
Epoch: 5, Steps: 10 | Train Loss: 1.054 Vali Loss: 1.290 Vali Acc: 0.432 Test Loss: 1.290 Test Acc: 0.432
Validation loss decreased (-0.378365 --> -0.432420).  Saving model ...
Epoch: 6 cost time: 2.2058544158935547
Epoch: 6, Steps: 10 | Train Loss: 0.890 Vali Loss: 1.205 Vali Acc: 0.500 Test Loss: 1.205 Test Acc: 0.500
Validation loss decreased (-0.432420 --> -0.499988).  Saving model ...
Epoch: 7 cost time: 2.253004312515259
Epoch: 7, Steps: 10 | Train Loss: 0.759 Vali Loss: 1.172 Vali Acc: 0.500 Test Loss: 1.172 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 8 cost time: 2.237539291381836
Epoch: 8, Steps: 10 | Train Loss: 0.648 Vali Loss: 1.124 Vali Acc: 0.500 Test Loss: 1.124 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499989).  Saving model ...
Epoch: 9 cost time: 2.470003604888916
Epoch: 9, Steps: 10 | Train Loss: 0.514 Vali Loss: 1.083 Vali Acc: 0.527 Test Loss: 1.083 Test Acc: 0.527
Validation loss decreased (-0.499989 --> -0.527016).  Saving model ...
Epoch: 10 cost time: 2.073780059814453
Epoch: 10, Steps: 10 | Train Loss: 0.409 Vali Loss: 1.047 Vali Acc: 0.541 Test Loss: 1.047 Test Acc: 0.541
Validation loss decreased (-0.527016 --> -0.540530).  Saving model ...
Epoch: 11 cost time: 2.189412832260132
Epoch: 11, Steps: 10 | Train Loss: 0.310 Vali Loss: 1.000 Vali Acc: 0.554 Test Loss: 1.000 Test Acc: 0.554
Validation loss decreased (-0.540530 --> -0.554044).  Saving model ...
Epoch: 12 cost time: 2.230189323425293
Epoch: 12, Steps: 10 | Train Loss: 0.239 Vali Loss: 0.978 Vali Acc: 0.554 Test Loss: 0.978 Test Acc: 0.554
Validation loss decreased (-0.554044 --> -0.554044).  Saving model ...
Epoch: 13 cost time: 1.893688440322876
Epoch: 13, Steps: 10 | Train Loss: 0.165 Vali Loss: 0.938 Vali Acc: 0.608 Test Loss: 0.938 Test Acc: 0.608
Validation loss decreased (-0.554044 --> -0.608099).  Saving model ...
Epoch: 14 cost time: 2.067913770675659
Epoch: 14, Steps: 10 | Train Loss: 0.116 Vali Loss: 0.923 Vali Acc: 0.595 Test Loss: 0.923 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.4196202754974365
Epoch: 15, Steps: 10 | Train Loss: 0.095 Vali Loss: 0.927 Vali Acc: 0.622 Test Loss: 0.927 Test Acc: 0.622
Validation loss decreased (-0.608099 --> -0.621612).  Saving model ...
Epoch: 16 cost time: 2.004241943359375
Epoch: 16, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.898 Vali Acc: 0.581 Test Loss: 0.898 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.7105348110198975
Epoch: 17, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.967 Vali Acc: 0.608 Test Loss: 0.967 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.68117356300354
Epoch: 18, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.956 Vali Acc: 0.595 Test Loss: 0.956 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.7272956371307373
Epoch: 19, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.944 Vali Acc: 0.581 Test Loss: 0.944 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.1327133178710938
Epoch: 20, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.999 Vali Acc: 0.595 Test Loss: 0.999 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.1543164253234863
Epoch: 21, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.000 Vali Acc: 0.608 Test Loss: 1.000 Test Acc: 0.608
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.13562273979187
Epoch: 22, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.995 Vali Acc: 0.608 Test Loss: 0.995 Test Acc: 0.608
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.2318108081817627
Epoch: 23, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.005 Vali Acc: 0.595 Test Loss: 1.005 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.061352252960205
Epoch: 24, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.014 Vali Acc: 0.595 Test Loss: 1.014 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.9733262062072754
Epoch: 25, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.014 Vali Acc: 0.608 Test Loss: 1.014 Test Acc: 0.608
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm16_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 715588
model size : 3.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm16_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.723416328430176
Epoch: 1, Steps: 10 | Train Loss: 1.424 Vali Loss: 1.377 Vali Acc: 0.257 Test Loss: 1.377 Test Acc: 0.257
Validation loss decreased (inf --> -0.256743).  Saving model ...
Epoch: 2 cost time: 4.61366605758667
Epoch: 2, Steps: 10 | Train Loss: 1.368 Vali Loss: 1.363 Vali Acc: 0.297 Test Loss: 1.363 Test Acc: 0.297
Validation loss decreased (-0.256743 --> -0.297284).  Saving model ...
Epoch: 3 cost time: 4.8694212436676025
Epoch: 3, Steps: 10 | Train Loss: 1.252 Vali Loss: 1.340 Vali Acc: 0.351 Test Loss: 1.340 Test Acc: 0.351
Validation loss decreased (-0.297284 --> -0.351338).  Saving model ...
Epoch: 4 cost time: 4.88742733001709
Epoch: 4, Steps: 10 | Train Loss: 1.144 Vali Loss: 1.280 Vali Acc: 0.392 Test Loss: 1.280 Test Acc: 0.392
Validation loss decreased (-0.351338 --> -0.391879).  Saving model ...
Epoch: 5 cost time: 4.609555006027222
Epoch: 5, Steps: 10 | Train Loss: 1.036 Vali Loss: 1.223 Vali Acc: 0.432 Test Loss: 1.223 Test Acc: 0.432
Validation loss decreased (-0.391879 --> -0.432420).  Saving model ...
Epoch: 6 cost time: 4.863219499588013
Epoch: 6, Steps: 10 | Train Loss: 0.865 Vali Loss: 1.252 Vali Acc: 0.486 Test Loss: 1.252 Test Acc: 0.486
Validation loss decreased (-0.432420 --> -0.486474).  Saving model ...
Epoch: 7 cost time: 4.393022775650024
Epoch: 7, Steps: 10 | Train Loss: 0.723 Vali Loss: 1.217 Vali Acc: 0.500 Test Loss: 1.217 Test Acc: 0.500
Validation loss decreased (-0.486474 --> -0.499988).  Saving model ...
Epoch: 8 cost time: 4.4844794273376465
Epoch: 8, Steps: 10 | Train Loss: 0.598 Vali Loss: 1.169 Vali Acc: 0.500 Test Loss: 1.169 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 9 cost time: 4.275913715362549
Epoch: 9, Steps: 10 | Train Loss: 0.457 Vali Loss: 1.176 Vali Acc: 0.486 Test Loss: 1.176 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.726110935211182
Epoch: 10, Steps: 10 | Train Loss: 0.359 Vali Loss: 1.168 Vali Acc: 0.500 Test Loss: 1.168 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 11 cost time: 4.325015544891357
Epoch: 11, Steps: 10 | Train Loss: 0.243 Vali Loss: 1.198 Vali Acc: 0.486 Test Loss: 1.198 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.9458062648773193
Epoch: 12, Steps: 10 | Train Loss: 0.187 Vali Loss: 1.184 Vali Acc: 0.486 Test Loss: 1.184 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.294416666030884
Epoch: 13, Steps: 10 | Train Loss: 0.136 Vali Loss: 1.205 Vali Acc: 0.486 Test Loss: 1.205 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.371018409729004
Epoch: 14, Steps: 10 | Train Loss: 0.094 Vali Loss: 1.175 Vali Acc: 0.500 Test Loss: 1.175 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 4.220838785171509
Epoch: 15, Steps: 10 | Train Loss: 0.071 Vali Loss: 1.214 Vali Acc: 0.473 Test Loss: 1.214 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 4.080012798309326
Epoch: 16, Steps: 10 | Train Loss: 0.053 Vali Loss: 1.205 Vali Acc: 0.486 Test Loss: 1.205 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 4.528562784194946
Epoch: 17, Steps: 10 | Train Loss: 0.048 Vali Loss: 1.215 Vali Acc: 0.486 Test Loss: 1.215 Test Acc: 0.486
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 4.462794303894043
Epoch: 18, Steps: 10 | Train Loss: 0.036 Vali Loss: 1.253 Vali Acc: 0.500 Test Loss: 1.253 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 4.933007001876831
Epoch: 19, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.260 Vali Acc: 0.500 Test Loss: 1.260 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 4.126909971237183
Epoch: 20, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.260 Vali Acc: 0.514 Test Loss: 1.260 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513501).  Saving model ...
Epoch: 21 cost time: 4.236026763916016
Epoch: 21, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.277 Vali Acc: 0.500 Test Loss: 1.277 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.409538984298706
Epoch: 22, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.284 Vali Acc: 0.486 Test Loss: 1.284 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 4.388911962509155
Epoch: 23, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.295 Vali Acc: 0.514 Test Loss: 1.295 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 4.098073482513428
Epoch: 24, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.310 Vali Acc: 0.500 Test Loss: 1.310 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 4.538703680038452
Epoch: 25, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.298 Vali Acc: 0.527 Test Loss: 1.298 Test Acc: 0.527
Validation loss decreased (-0.513501 --> -0.527014).  Saving model ...
Epoch: 26 cost time: 4.465194940567017
Epoch: 26, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.316 Vali Acc: 0.554 Test Loss: 1.316 Test Acc: 0.554
Validation loss decreased (-0.527014 --> -0.554041).  Saving model ...
Epoch: 27 cost time: 4.509449481964111
Epoch: 27, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.333 Vali Acc: 0.554 Test Loss: 1.333 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 4.128293514251709
Epoch: 28, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.341 Vali Acc: 0.541 Test Loss: 1.341 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 4.261326551437378
Epoch: 29, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.342 Vali Acc: 0.541 Test Loss: 1.342 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 4.546258926391602
Epoch: 30, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.336 Vali Acc: 0.554 Test Loss: 1.336 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm16_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 1198788
model size : 4.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm16_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.367393255233765
Epoch: 1, Steps: 10 | Train Loss: 1.450 Vali Loss: 1.398 Vali Acc: 0.297 Test Loss: 1.398 Test Acc: 0.297
Validation loss decreased (inf --> -0.297283).  Saving model ...
Epoch: 2 cost time: 2.7917723655700684
Epoch: 2, Steps: 10 | Train Loss: 1.414 Vali Loss: 1.357 Vali Acc: 0.338 Test Loss: 1.357 Test Acc: 0.338
Validation loss decreased (-0.297283 --> -0.337824).  Saving model ...
Epoch: 3 cost time: 2.5996739864349365
Epoch: 3, Steps: 10 | Train Loss: 1.278 Vali Loss: 1.318 Vali Acc: 0.405 Test Loss: 1.318 Test Acc: 0.405
Validation loss decreased (-0.337824 --> -0.405392).  Saving model ...
Epoch: 4 cost time: 2.594094753265381
Epoch: 4, Steps: 10 | Train Loss: 1.171 Vali Loss: 1.273 Vali Acc: 0.446 Test Loss: 1.273 Test Acc: 0.446
Validation loss decreased (-0.405392 --> -0.445933).  Saving model ...
Epoch: 5 cost time: 2.716813087463379
Epoch: 5, Steps: 10 | Train Loss: 1.030 Vali Loss: 1.219 Vali Acc: 0.486 Test Loss: 1.219 Test Acc: 0.486
Validation loss decreased (-0.445933 --> -0.486474).  Saving model ...
Epoch: 6 cost time: 2.540832281112671
Epoch: 6, Steps: 10 | Train Loss: 0.896 Vali Loss: 1.168 Vali Acc: 0.514 Test Loss: 1.168 Test Acc: 0.514
Validation loss decreased (-0.486474 --> -0.513502).  Saving model ...
Epoch: 7 cost time: 2.4850189685821533
Epoch: 7, Steps: 10 | Train Loss: 0.769 Vali Loss: 1.179 Vali Acc: 0.486 Test Loss: 1.179 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.549828290939331
Epoch: 8, Steps: 10 | Train Loss: 0.619 Vali Loss: 1.090 Vali Acc: 0.568 Test Loss: 1.090 Test Acc: 0.568
Validation loss decreased (-0.513502 --> -0.567557).  Saving model ...
Epoch: 9 cost time: 2.5390520095825195
Epoch: 9, Steps: 10 | Train Loss: 0.494 Vali Loss: 1.053 Vali Acc: 0.608 Test Loss: 1.053 Test Acc: 0.608
Validation loss decreased (-0.567557 --> -0.608098).  Saving model ...
Epoch: 10 cost time: 2.6475863456726074
Epoch: 10, Steps: 10 | Train Loss: 0.395 Vali Loss: 1.060 Vali Acc: 0.595 Test Loss: 1.060 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.5072121620178223
Epoch: 11, Steps: 10 | Train Loss: 0.282 Vali Loss: 0.993 Vali Acc: 0.581 Test Loss: 0.993 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.0935001373291016
Epoch: 12, Steps: 10 | Train Loss: 0.213 Vali Loss: 1.027 Vali Acc: 0.568 Test Loss: 1.027 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.4184091091156006
Epoch: 13, Steps: 10 | Train Loss: 0.149 Vali Loss: 0.979 Vali Acc: 0.581 Test Loss: 0.979 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.3465447425842285
Epoch: 14, Steps: 10 | Train Loss: 0.110 Vali Loss: 0.992 Vali Acc: 0.635 Test Loss: 0.992 Test Acc: 0.635
Validation loss decreased (-0.608098 --> -0.635125).  Saving model ...
Epoch: 15 cost time: 2.1712942123413086
Epoch: 15, Steps: 10 | Train Loss: 0.083 Vali Loss: 0.988 Vali Acc: 0.595 Test Loss: 0.988 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.2548651695251465
Epoch: 16, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.994 Vali Acc: 0.595 Test Loss: 0.994 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.412503957748413
Epoch: 17, Steps: 10 | Train Loss: 0.046 Vali Loss: 1.006 Vali Acc: 0.595 Test Loss: 1.006 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.247746229171753
Epoch: 18, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.006 Vali Acc: 0.622 Test Loss: 1.006 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.074456214904785
Epoch: 19, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.005 Vali Acc: 0.608 Test Loss: 1.005 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.0065205097198486
Epoch: 20, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.029 Vali Acc: 0.608 Test Loss: 1.029 Test Acc: 0.608
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.9788556098937988
Epoch: 21, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.042 Vali Acc: 0.568 Test Loss: 1.042 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.194390058517456
Epoch: 22, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.066 Vali Acc: 0.608 Test Loss: 1.066 Test Acc: 0.608
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.2218427658081055
Epoch: 23, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.071 Vali Acc: 0.595 Test Loss: 1.071 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.3530967235565186
Epoch: 24, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.076 Vali Acc: 0.595 Test Loss: 1.076 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm16_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6351351351351351
model parameter : 371012
model size : 1.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm16_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.980828762054443
Epoch: 1, Steps: 10 | Train Loss: 1.419 Vali Loss: 1.372 Vali Acc: 0.284 Test Loss: 1.372 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 3.3677425384521484
Epoch: 2, Steps: 10 | Train Loss: 1.373 Vali Loss: 1.360 Vali Acc: 0.311 Test Loss: 1.360 Test Acc: 0.311
Validation loss decreased (-0.283770 --> -0.310797).  Saving model ...
Epoch: 3 cost time: 3.062278985977173
Epoch: 3, Steps: 10 | Train Loss: 1.266 Vali Loss: 1.339 Vali Acc: 0.378 Test Loss: 1.339 Test Acc: 0.378
Validation loss decreased (-0.310797 --> -0.378365).  Saving model ...
Epoch: 4 cost time: 3.2056639194488525
Epoch: 4, Steps: 10 | Train Loss: 1.165 Vali Loss: 1.277 Vali Acc: 0.432 Test Loss: 1.277 Test Acc: 0.432
Validation loss decreased (-0.378365 --> -0.432420).  Saving model ...
Epoch: 5 cost time: 3.524108648300171
Epoch: 5, Steps: 10 | Train Loss: 1.069 Vali Loss: 1.215 Vali Acc: 0.446 Test Loss: 1.215 Test Acc: 0.446
Validation loss decreased (-0.432420 --> -0.445934).  Saving model ...
Epoch: 6 cost time: 3.476860284805298
Epoch: 6, Steps: 10 | Train Loss: 0.901 Vali Loss: 1.242 Vali Acc: 0.473 Test Loss: 1.242 Test Acc: 0.473
Validation loss decreased (-0.445934 --> -0.472961).  Saving model ...
Epoch: 7 cost time: 3.2633488178253174
Epoch: 7, Steps: 10 | Train Loss: 0.771 Vali Loss: 1.219 Vali Acc: 0.500 Test Loss: 1.219 Test Acc: 0.500
Validation loss decreased (-0.472961 --> -0.499988).  Saving model ...
Epoch: 8 cost time: 3.306802749633789
Epoch: 8, Steps: 10 | Train Loss: 0.664 Vali Loss: 1.184 Vali Acc: 0.486 Test Loss: 1.184 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.393575429916382
Epoch: 9, Steps: 10 | Train Loss: 0.531 Vali Loss: 1.187 Vali Acc: 0.473 Test Loss: 1.187 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.462496280670166
Epoch: 10, Steps: 10 | Train Loss: 0.454 Vali Loss: 1.158 Vali Acc: 0.500 Test Loss: 1.158 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 11 cost time: 3.301445484161377
Epoch: 11, Steps: 10 | Train Loss: 0.325 Vali Loss: 1.202 Vali Acc: 0.486 Test Loss: 1.202 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.633134603500366
Epoch: 12, Steps: 10 | Train Loss: 0.253 Vali Loss: 1.231 Vali Acc: 0.486 Test Loss: 1.231 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.382511615753174
Epoch: 13, Steps: 10 | Train Loss: 0.189 Vali Loss: 1.271 Vali Acc: 0.459 Test Loss: 1.271 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.3608171939849854
Epoch: 14, Steps: 10 | Train Loss: 0.128 Vali Loss: 1.283 Vali Acc: 0.486 Test Loss: 1.283 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.488800048828125
Epoch: 15, Steps: 10 | Train Loss: 0.100 Vali Loss: 1.318 Vali Acc: 0.446 Test Loss: 1.318 Test Acc: 0.446
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.322293996810913
Epoch: 16, Steps: 10 | Train Loss: 0.066 Vali Loss: 1.306 Vali Acc: 0.459 Test Loss: 1.306 Test Acc: 0.459
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.3605599403381348
Epoch: 17, Steps: 10 | Train Loss: 0.067 Vali Loss: 1.293 Vali Acc: 0.486 Test Loss: 1.293 Test Acc: 0.486
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.260255813598633
Epoch: 18, Steps: 10 | Train Loss: 0.042 Vali Loss: 1.324 Vali Acc: 0.486 Test Loss: 1.324 Test Acc: 0.486
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.406245231628418
Epoch: 19, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.339 Vali Acc: 0.473 Test Loss: 1.339 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.2103540897369385
Epoch: 20, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.358 Vali Acc: 0.500 Test Loss: 1.358 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm16_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5
model parameter : 1198788
model size : 4.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm16_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.712682008743286
Epoch: 1, Steps: 10 | Train Loss: 1.451 Vali Loss: 1.391 Vali Acc: 0.297 Test Loss: 1.391 Test Acc: 0.297
Validation loss decreased (inf --> -0.297283).  Saving model ...
Epoch: 2 cost time: 2.250980854034424
Epoch: 2, Steps: 10 | Train Loss: 1.415 Vali Loss: 1.352 Vali Acc: 0.338 Test Loss: 1.352 Test Acc: 0.338
Validation loss decreased (-0.297283 --> -0.337824).  Saving model ...
Epoch: 3 cost time: 2.1262214183807373
Epoch: 3, Steps: 10 | Train Loss: 1.287 Vali Loss: 1.314 Vali Acc: 0.405 Test Loss: 1.314 Test Acc: 0.405
Validation loss decreased (-0.337824 --> -0.405392).  Saving model ...
Epoch: 4 cost time: 1.4889612197875977
Epoch: 4, Steps: 10 | Train Loss: 1.183 Vali Loss: 1.272 Vali Acc: 0.459 Test Loss: 1.272 Test Acc: 0.459
Validation loss decreased (-0.405392 --> -0.459447).  Saving model ...
Epoch: 5 cost time: 1.736250638961792
Epoch: 5, Steps: 10 | Train Loss: 1.048 Vali Loss: 1.221 Vali Acc: 0.486 Test Loss: 1.221 Test Acc: 0.486
Validation loss decreased (-0.459447 --> -0.486474).  Saving model ...
Epoch: 6 cost time: 1.889786958694458
Epoch: 6, Steps: 10 | Train Loss: 0.920 Vali Loss: 1.176 Vali Acc: 0.554 Test Loss: 1.176 Test Acc: 0.554
Validation loss decreased (-0.486474 --> -0.554042).  Saving model ...
Epoch: 7 cost time: 1.93143630027771
Epoch: 7, Steps: 10 | Train Loss: 0.783 Vali Loss: 1.185 Vali Acc: 0.486 Test Loss: 1.185 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5925164222717285
Epoch: 8, Steps: 10 | Train Loss: 0.639 Vali Loss: 1.088 Vali Acc: 0.568 Test Loss: 1.088 Test Acc: 0.568
Validation loss decreased (-0.554042 --> -0.567557).  Saving model ...
Epoch: 9 cost time: 1.5704140663146973
Epoch: 9, Steps: 10 | Train Loss: 0.514 Vali Loss: 1.061 Vali Acc: 0.581 Test Loss: 1.061 Test Acc: 0.581
Validation loss decreased (-0.567557 --> -0.581070).  Saving model ...
Epoch: 10 cost time: 1.5035672187805176
Epoch: 10, Steps: 10 | Train Loss: 0.421 Vali Loss: 1.067 Vali Acc: 0.608 Test Loss: 1.067 Test Acc: 0.608
Validation loss decreased (-0.581070 --> -0.608097).  Saving model ...
Epoch: 11 cost time: 1.9249067306518555
Epoch: 11, Steps: 10 | Train Loss: 0.297 Vali Loss: 0.982 Vali Acc: 0.595 Test Loss: 0.982 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.4191040992736816
Epoch: 12, Steps: 10 | Train Loss: 0.234 Vali Loss: 0.997 Vali Acc: 0.622 Test Loss: 0.997 Test Acc: 0.622
Validation loss decreased (-0.608097 --> -0.621612).  Saving model ...
Epoch: 13 cost time: 2.371281385421753
Epoch: 13, Steps: 10 | Train Loss: 0.162 Vali Loss: 0.953 Vali Acc: 0.608 Test Loss: 0.953 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.365691900253296
Epoch: 14, Steps: 10 | Train Loss: 0.122 Vali Loss: 0.987 Vali Acc: 0.662 Test Loss: 0.987 Test Acc: 0.662
Validation loss decreased (-0.621612 --> -0.662152).  Saving model ...
Epoch: 15 cost time: 2.3003015518188477
Epoch: 15, Steps: 10 | Train Loss: 0.091 Vali Loss: 0.986 Vali Acc: 0.595 Test Loss: 0.986 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.200187921524048
Epoch: 16, Steps: 10 | Train Loss: 0.069 Vali Loss: 0.986 Vali Acc: 0.595 Test Loss: 0.986 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.208611249923706
Epoch: 17, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.979 Vali Acc: 0.595 Test Loss: 0.979 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.275252342224121
Epoch: 18, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.991 Vali Acc: 0.608 Test Loss: 0.991 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.584392547607422
Epoch: 19, Steps: 10 | Train Loss: 0.036 Vali Loss: 1.004 Vali Acc: 0.595 Test Loss: 1.004 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.6969757080078125
Epoch: 20, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.016 Vali Acc: 0.608 Test Loss: 1.016 Test Acc: 0.608
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.372225046157837
Epoch: 21, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.030 Vali Acc: 0.608 Test Loss: 1.030 Test Acc: 0.608
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.8691282272338867
Epoch: 22, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.056 Vali Acc: 0.635 Test Loss: 1.056 Test Acc: 0.635
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.7174746990203857
Epoch: 23, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.053 Vali Acc: 0.608 Test Loss: 1.053 Test Acc: 0.608
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.7327630519866943
Epoch: 24, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.052 Vali Acc: 0.595 Test Loss: 1.052 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm16_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6621621621621622
model parameter : 371012
model size : 1.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm16_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.412327766418457
Epoch: 1, Steps: 10 | Train Loss: 1.428 Vali Loss: 1.371 Vali Acc: 0.297 Test Loss: 1.371 Test Acc: 0.297
Validation loss decreased (inf --> -0.297284).  Saving model ...
Epoch: 2 cost time: 3.292855978012085
Epoch: 2, Steps: 10 | Train Loss: 1.380 Vali Loss: 1.360 Vali Acc: 0.297 Test Loss: 1.360 Test Acc: 0.297
Validation loss decreased (-0.297284 --> -0.297284).  Saving model ...
Epoch: 3 cost time: 3.146662950515747
Epoch: 3, Steps: 10 | Train Loss: 1.279 Vali Loss: 1.339 Vali Acc: 0.338 Test Loss: 1.339 Test Acc: 0.338
Validation loss decreased (-0.297284 --> -0.337824).  Saving model ...
Epoch: 4 cost time: 2.9046471118927
Epoch: 4, Steps: 10 | Train Loss: 1.200 Vali Loss: 1.280 Vali Acc: 0.459 Test Loss: 1.280 Test Acc: 0.459
Validation loss decreased (-0.337824 --> -0.459447).  Saving model ...
Epoch: 5 cost time: 3.1265368461608887
Epoch: 5, Steps: 10 | Train Loss: 1.108 Vali Loss: 1.221 Vali Acc: 0.432 Test Loss: 1.221 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.121187925338745
Epoch: 6, Steps: 10 | Train Loss: 0.967 Vali Loss: 1.243 Vali Acc: 0.500 Test Loss: 1.243 Test Acc: 0.500
Validation loss decreased (-0.459447 --> -0.499988).  Saving model ...
Epoch: 7 cost time: 3.01684832572937
Epoch: 7, Steps: 10 | Train Loss: 0.838 Vali Loss: 1.207 Vali Acc: 0.514 Test Loss: 1.207 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513501).  Saving model ...
Epoch: 8 cost time: 3.3526763916015625
Epoch: 8, Steps: 10 | Train Loss: 0.742 Vali Loss: 1.155 Vali Acc: 0.514 Test Loss: 1.155 Test Acc: 0.514
Validation loss decreased (-0.513501 --> -0.513502).  Saving model ...
Epoch: 9 cost time: 3.3096704483032227
Epoch: 9, Steps: 10 | Train Loss: 0.610 Vali Loss: 1.147 Vali Acc: 0.500 Test Loss: 1.147 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.1478703022003174
Epoch: 10, Steps: 10 | Train Loss: 0.524 Vali Loss: 1.118 Vali Acc: 0.514 Test Loss: 1.118 Test Acc: 0.514
Validation loss decreased (-0.513502 --> -0.513502).  Saving model ...
Epoch: 11 cost time: 3.2137908935546875
Epoch: 11, Steps: 10 | Train Loss: 0.398 Vali Loss: 1.134 Vali Acc: 0.514 Test Loss: 1.134 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.0723819732666016
Epoch: 12, Steps: 10 | Train Loss: 0.338 Vali Loss: 1.113 Vali Acc: 0.527 Test Loss: 1.113 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527016).  Saving model ...
Epoch: 13 cost time: 3.2905383110046387
Epoch: 13, Steps: 10 | Train Loss: 0.260 Vali Loss: 1.134 Vali Acc: 0.500 Test Loss: 1.134 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.1635193824768066
Epoch: 14, Steps: 10 | Train Loss: 0.198 Vali Loss: 1.126 Vali Acc: 0.541 Test Loss: 1.126 Test Acc: 0.541
Validation loss decreased (-0.527016 --> -0.540529).  Saving model ...
Epoch: 15 cost time: 2.8984129428863525
Epoch: 15, Steps: 10 | Train Loss: 0.145 Vali Loss: 1.171 Vali Acc: 0.541 Test Loss: 1.171 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.8988711833953857
Epoch: 16, Steps: 10 | Train Loss: 0.109 Vali Loss: 1.122 Vali Acc: 0.554 Test Loss: 1.122 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554043).  Saving model ...
Epoch: 17 cost time: 2.693063497543335
Epoch: 17, Steps: 10 | Train Loss: 0.097 Vali Loss: 1.143 Vali Acc: 0.554 Test Loss: 1.143 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.3815433979034424
Epoch: 18, Steps: 10 | Train Loss: 0.067 Vali Loss: 1.180 Vali Acc: 0.554 Test Loss: 1.180 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.1831793785095215
Epoch: 19, Steps: 10 | Train Loss: 0.059 Vali Loss: 1.177 Vali Acc: 0.527 Test Loss: 1.177 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.9284863471984863
Epoch: 20, Steps: 10 | Train Loss: 0.047 Vali Loss: 1.178 Vali Acc: 0.554 Test Loss: 1.178 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.221731424331665
Epoch: 21, Steps: 10 | Train Loss: 0.042 Vali Loss: 1.194 Vali Acc: 0.514 Test Loss: 1.194 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.919429063796997
Epoch: 22, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.172 Vali Acc: 0.554 Test Loss: 1.172 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.85414457321167
Epoch: 23, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.185 Vali Acc: 0.541 Test Loss: 1.185 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 3.088709592819214
Epoch: 24, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.196 Vali Acc: 0.527 Test Loss: 1.196 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.982292652130127
Epoch: 25, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.203 Vali Acc: 0.568 Test Loss: 1.203 Test Acc: 0.568
Validation loss decreased (-0.554043 --> -0.567556).  Saving model ...
Epoch: 26 cost time: 3.008220672607422
Epoch: 26, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.187 Vali Acc: 0.554 Test Loss: 1.187 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.700214147567749
Epoch: 27, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.222 Vali Acc: 0.554 Test Loss: 1.222 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.994915246963501
Epoch: 28, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.235 Vali Acc: 0.554 Test Loss: 1.235 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.9313974380493164
Epoch: 29, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.235 Vali Acc: 0.554 Test Loss: 1.235 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.7677345275878906
Epoch: 30, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.210 Vali Acc: 0.568 Test Loss: 1.210 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm16_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 1198788
model size : 4.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm16_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.8724365234375
Epoch: 1, Steps: 10 | Train Loss: 1.447 Vali Loss: 1.394 Vali Acc: 0.270 Test Loss: 1.394 Test Acc: 0.270
Validation loss decreased (inf --> -0.270256).  Saving model ...
Epoch: 2 cost time: 2.0823121070861816
Epoch: 2, Steps: 10 | Train Loss: 1.415 Vali Loss: 1.352 Vali Acc: 0.351 Test Loss: 1.352 Test Acc: 0.351
Validation loss decreased (-0.270256 --> -0.351338).  Saving model ...
Epoch: 3 cost time: 1.9405486583709717
Epoch: 3, Steps: 10 | Train Loss: 1.285 Vali Loss: 1.312 Vali Acc: 0.365 Test Loss: 1.312 Test Acc: 0.365
Validation loss decreased (-0.351338 --> -0.364852).  Saving model ...
Epoch: 4 cost time: 1.929460048675537
Epoch: 4, Steps: 10 | Train Loss: 1.187 Vali Loss: 1.268 Vali Acc: 0.446 Test Loss: 1.268 Test Acc: 0.446
Validation loss decreased (-0.364852 --> -0.445933).  Saving model ...
Epoch: 5 cost time: 1.7366294860839844
Epoch: 5, Steps: 10 | Train Loss: 1.056 Vali Loss: 1.213 Vali Acc: 0.473 Test Loss: 1.213 Test Acc: 0.473
Validation loss decreased (-0.445933 --> -0.472961).  Saving model ...
Epoch: 6 cost time: 1.8522777557373047
Epoch: 6, Steps: 10 | Train Loss: 0.932 Vali Loss: 1.164 Vali Acc: 0.568 Test Loss: 1.164 Test Acc: 0.568
Validation loss decreased (-0.472961 --> -0.567556).  Saving model ...
Epoch: 7 cost time: 1.8485617637634277
Epoch: 7, Steps: 10 | Train Loss: 0.805 Vali Loss: 1.168 Vali Acc: 0.527 Test Loss: 1.168 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8030073642730713
Epoch: 8, Steps: 10 | Train Loss: 0.662 Vali Loss: 1.067 Vali Acc: 0.608 Test Loss: 1.067 Test Acc: 0.608
Validation loss decreased (-0.567556 --> -0.608097).  Saving model ...
Epoch: 9 cost time: 1.7178053855895996
Epoch: 9, Steps: 10 | Train Loss: 0.544 Vali Loss: 1.034 Vali Acc: 0.608 Test Loss: 1.034 Test Acc: 0.608
Validation loss decreased (-0.608097 --> -0.608098).  Saving model ...
Epoch: 10 cost time: 1.9321229457855225
Epoch: 10, Steps: 10 | Train Loss: 0.454 Vali Loss: 1.028 Vali Acc: 0.595 Test Loss: 1.028 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.1442344188690186
Epoch: 11, Steps: 10 | Train Loss: 0.334 Vali Loss: 0.953 Vali Acc: 0.595 Test Loss: 0.953 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.065073013305664
Epoch: 12, Steps: 10 | Train Loss: 0.263 Vali Loss: 0.981 Vali Acc: 0.635 Test Loss: 0.981 Test Acc: 0.635
Validation loss decreased (-0.608098 --> -0.635125).  Saving model ...
Epoch: 13 cost time: 2.0725796222686768
Epoch: 13, Steps: 10 | Train Loss: 0.194 Vali Loss: 0.919 Vali Acc: 0.595 Test Loss: 0.919 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.0911293029785156
Epoch: 14, Steps: 10 | Train Loss: 0.144 Vali Loss: 0.950 Vali Acc: 0.635 Test Loss: 0.950 Test Acc: 0.635
Validation loss decreased (-0.635125 --> -0.635126).  Saving model ...
Epoch: 15 cost time: 2.057251453399658
Epoch: 15, Steps: 10 | Train Loss: 0.108 Vali Loss: 0.924 Vali Acc: 0.608 Test Loss: 0.924 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.9626946449279785
Epoch: 16, Steps: 10 | Train Loss: 0.082 Vali Loss: 0.923 Vali Acc: 0.635 Test Loss: 0.923 Test Acc: 0.635
Validation loss decreased (-0.635126 --> -0.635126).  Saving model ...
Epoch: 17 cost time: 2.158123016357422
Epoch: 17, Steps: 10 | Train Loss: 0.062 Vali Loss: 0.941 Vali Acc: 0.595 Test Loss: 0.941 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.1625375747680664
Epoch: 18, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.931 Vali Acc: 0.662 Test Loss: 0.931 Test Acc: 0.662
Validation loss decreased (-0.635126 --> -0.662153).  Saving model ...
Epoch: 19 cost time: 1.4751827716827393
Epoch: 19, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.933 Vali Acc: 0.622 Test Loss: 0.933 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.9759912490844727
Epoch: 20, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.955 Vali Acc: 0.608 Test Loss: 0.955 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.0290892124176025
Epoch: 21, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.952 Vali Acc: 0.608 Test Loss: 0.952 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.1120500564575195
Epoch: 22, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.971 Vali Acc: 0.622 Test Loss: 0.971 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.0185179710388184
Epoch: 23, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.977 Vali Acc: 0.622 Test Loss: 0.977 Test Acc: 0.622
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.8886001110076904
Epoch: 24, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.970 Vali Acc: 0.662 Test Loss: 0.970 Test Acc: 0.662
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.006429433822632
Epoch: 25, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.969 Vali Acc: 0.676 Test Loss: 0.969 Test Acc: 0.676
Validation loss decreased (-0.662153 --> -0.675666).  Saving model ...
Epoch: 26 cost time: 2.1219630241394043
Epoch: 26, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.986 Vali Acc: 0.635 Test Loss: 0.986 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.044762372970581
Epoch: 27, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.003 Vali Acc: 0.622 Test Loss: 1.003 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.0981318950653076
Epoch: 28, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.018 Vali Acc: 0.635 Test Loss: 1.018 Test Acc: 0.635
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.0920658111572266
Epoch: 29, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.030 Vali Acc: 0.635 Test Loss: 1.030 Test Acc: 0.635
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.052328109741211
Epoch: 30, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.026 Vali Acc: 0.649 Test Loss: 1.026 Test Acc: 0.649
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm16_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6756756756756757
model parameter : 371012
model size : 1.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm16_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.7164154052734375
Epoch: 1, Steps: 10 | Train Loss: 1.463 Vali Loss: 1.433 Vali Acc: 0.324 Test Loss: 1.433 Test Acc: 0.324
Validation loss decreased (inf --> -0.324310).  Saving model ...
Epoch: 2 cost time: 4.263410568237305
Epoch: 2, Steps: 10 | Train Loss: 1.411 Vali Loss: 1.404 Vali Acc: 0.297 Test Loss: 1.404 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.3378665447235107
Epoch: 3, Steps: 10 | Train Loss: 1.303 Vali Loss: 1.385 Vali Acc: 0.351 Test Loss: 1.385 Test Acc: 0.351
Validation loss decreased (-0.324310 --> -0.351338).  Saving model ...
Epoch: 4 cost time: 4.3479838371276855
Epoch: 4, Steps: 10 | Train Loss: 1.186 Vali Loss: 1.335 Vali Acc: 0.459 Test Loss: 1.335 Test Acc: 0.459
Validation loss decreased (-0.351338 --> -0.459446).  Saving model ...
Epoch: 5 cost time: 4.515818357467651
Epoch: 5, Steps: 10 | Train Loss: 1.028 Vali Loss: 1.286 Vali Acc: 0.446 Test Loss: 1.286 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.295521259307861
Epoch: 6, Steps: 10 | Train Loss: 0.898 Vali Loss: 1.246 Vali Acc: 0.473 Test Loss: 1.246 Test Acc: 0.473
Validation loss decreased (-0.459446 --> -0.472961).  Saving model ...
Epoch: 7 cost time: 4.2957923412323
Epoch: 7, Steps: 10 | Train Loss: 0.750 Vali Loss: 1.211 Vali Acc: 0.500 Test Loss: 1.211 Test Acc: 0.500
Validation loss decreased (-0.472961 --> -0.499988).  Saving model ...
Epoch: 8 cost time: 4.219543933868408
Epoch: 8, Steps: 10 | Train Loss: 0.615 Vali Loss: 1.179 Vali Acc: 0.514 Test Loss: 1.179 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513502).  Saving model ...
Epoch: 9 cost time: 4.32440972328186
Epoch: 9, Steps: 10 | Train Loss: 0.504 Vali Loss: 1.129 Vali Acc: 0.568 Test Loss: 1.129 Test Acc: 0.568
Validation loss decreased (-0.513502 --> -0.567556).  Saving model ...
Epoch: 10 cost time: 4.086463212966919
Epoch: 10, Steps: 10 | Train Loss: 0.390 Vali Loss: 1.108 Vali Acc: 0.595 Test Loss: 1.108 Test Acc: 0.595
Validation loss decreased (-0.567556 --> -0.594584).  Saving model ...
Epoch: 11 cost time: 4.283343076705933
Epoch: 11, Steps: 10 | Train Loss: 0.283 Vali Loss: 1.086 Vali Acc: 0.581 Test Loss: 1.086 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.346859455108643
Epoch: 12, Steps: 10 | Train Loss: 0.214 Vali Loss: 1.050 Vali Acc: 0.608 Test Loss: 1.050 Test Acc: 0.608
Validation loss decreased (-0.594584 --> -0.608098).  Saving model ...
Epoch: 13 cost time: 4.365128040313721
Epoch: 13, Steps: 10 | Train Loss: 0.164 Vali Loss: 1.044 Vali Acc: 0.608 Test Loss: 1.044 Test Acc: 0.608
Validation loss decreased (-0.608098 --> -0.608098).  Saving model ...
Epoch: 14 cost time: 4.153400421142578
Epoch: 14, Steps: 10 | Train Loss: 0.110 Vali Loss: 1.054 Vali Acc: 0.581 Test Loss: 1.054 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.5094571113586426
Epoch: 15, Steps: 10 | Train Loss: 0.084 Vali Loss: 1.039 Vali Acc: 0.595 Test Loss: 1.039 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.914108991622925
Epoch: 16, Steps: 10 | Train Loss: 0.065 Vali Loss: 1.018 Vali Acc: 0.622 Test Loss: 1.018 Test Acc: 0.622
Validation loss decreased (-0.608098 --> -0.621611).  Saving model ...
Epoch: 17 cost time: 3.964364528656006
Epoch: 17, Steps: 10 | Train Loss: 0.053 Vali Loss: 1.022 Vali Acc: 0.635 Test Loss: 1.022 Test Acc: 0.635
Validation loss decreased (-0.621611 --> -0.635125).  Saving model ...
Epoch: 18 cost time: 3.870851755142212
Epoch: 18, Steps: 10 | Train Loss: 0.040 Vali Loss: 1.005 Vali Acc: 0.622 Test Loss: 1.005 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.8309247493743896
Epoch: 19, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.026 Vali Acc: 0.635 Test Loss: 1.026 Test Acc: 0.635
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.8139588832855225
Epoch: 20, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.018 Vali Acc: 0.635 Test Loss: 1.018 Test Acc: 0.635
Validation loss decreased (-0.635125 --> -0.635125).  Saving model ...
Epoch: 21 cost time: 3.764512538909912
Epoch: 21, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.011 Vali Acc: 0.635 Test Loss: 1.011 Test Acc: 0.635
Validation loss decreased (-0.635125 --> -0.635125).  Saving model ...
Epoch: 22 cost time: 3.4148669242858887
Epoch: 22, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.008 Vali Acc: 0.622 Test Loss: 1.008 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.649729013442993
Epoch: 23, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.005 Vali Acc: 0.595 Test Loss: 1.005 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.610424041748047
Epoch: 24, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.015 Vali Acc: 0.635 Test Loss: 1.015 Test Acc: 0.635
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 4.195294618606567
Epoch: 25, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.015 Vali Acc: 0.635 Test Loss: 1.015 Test Acc: 0.635
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 4.109807252883911
Epoch: 26, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.023 Vali Acc: 0.649 Test Loss: 1.023 Test Acc: 0.649
Validation loss decreased (-0.635125 --> -0.648638).  Saving model ...
Epoch: 27 cost time: 4.285820245742798
Epoch: 27, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.034 Vali Acc: 0.608 Test Loss: 1.034 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 4.343582630157471
Epoch: 28, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.037 Vali Acc: 0.622 Test Loss: 1.037 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 4.449327707290649
Epoch: 29, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.027 Vali Acc: 0.622 Test Loss: 1.027 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 4.387005805969238
Epoch: 30, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.037 Vali Acc: 0.622 Test Loss: 1.037 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm16_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6486486486486487
model parameter : 612676
model size : 2.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm16_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.123502254486084
Epoch: 1, Steps: 10 | Train Loss: 1.467 Vali Loss: 1.360 Vali Acc: 0.405 Test Loss: 1.360 Test Acc: 0.405
Validation loss decreased (inf --> -0.405392).  Saving model ...
Epoch: 2 cost time: 2.680232048034668
Epoch: 2, Steps: 10 | Train Loss: 1.381 Vali Loss: 1.347 Vali Acc: 0.257 Test Loss: 1.347 Test Acc: 0.257
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.7036309242248535
Epoch: 3, Steps: 10 | Train Loss: 1.289 Vali Loss: 1.327 Vali Acc: 0.365 Test Loss: 1.327 Test Acc: 0.365
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.888970136642456
Epoch: 4, Steps: 10 | Train Loss: 1.182 Vali Loss: 1.274 Vali Acc: 0.459 Test Loss: 1.274 Test Acc: 0.459
Validation loss decreased (-0.405392 --> -0.459447).  Saving model ...
Epoch: 5 cost time: 2.8379175662994385
Epoch: 5, Steps: 10 | Train Loss: 1.045 Vali Loss: 1.240 Vali Acc: 0.446 Test Loss: 1.240 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.587970733642578
Epoch: 6, Steps: 10 | Train Loss: 0.932 Vali Loss: 1.201 Vali Acc: 0.527 Test Loss: 1.201 Test Acc: 0.527
Validation loss decreased (-0.459447 --> -0.527015).  Saving model ...
Epoch: 7 cost time: 2.589507818222046
Epoch: 7, Steps: 10 | Train Loss: 0.806 Vali Loss: 1.213 Vali Acc: 0.486 Test Loss: 1.213 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.563667058944702
Epoch: 8, Steps: 10 | Train Loss: 0.653 Vali Loss: 1.147 Vali Acc: 0.595 Test Loss: 1.147 Test Acc: 0.595
Validation loss decreased (-0.527015 --> -0.594583).  Saving model ...
Epoch: 9 cost time: 2.6934072971343994
Epoch: 9, Steps: 10 | Train Loss: 0.511 Vali Loss: 1.115 Vali Acc: 0.608 Test Loss: 1.115 Test Acc: 0.608
Validation loss decreased (-0.594583 --> -0.608097).  Saving model ...
Epoch: 10 cost time: 3.079030752182007
Epoch: 10, Steps: 10 | Train Loss: 0.428 Vali Loss: 1.158 Vali Acc: 0.554 Test Loss: 1.158 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.954418420791626
Epoch: 11, Steps: 10 | Train Loss: 0.306 Vali Loss: 1.112 Vali Acc: 0.662 Test Loss: 1.112 Test Acc: 0.662
Validation loss decreased (-0.608097 --> -0.662151).  Saving model ...
Epoch: 12 cost time: 3.037475824356079
Epoch: 12, Steps: 10 | Train Loss: 0.230 Vali Loss: 1.111 Vali Acc: 0.635 Test Loss: 1.111 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.9405813217163086
Epoch: 13, Steps: 10 | Train Loss: 0.155 Vali Loss: 1.176 Vali Acc: 0.581 Test Loss: 1.176 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.6242120265960693
Epoch: 14, Steps: 10 | Train Loss: 0.120 Vali Loss: 1.117 Vali Acc: 0.595 Test Loss: 1.117 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.6993484497070312
Epoch: 15, Steps: 10 | Train Loss: 0.086 Vali Loss: 1.163 Vali Acc: 0.595 Test Loss: 1.163 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.6777477264404297
Epoch: 16, Steps: 10 | Train Loss: 0.067 Vali Loss: 1.166 Vali Acc: 0.581 Test Loss: 1.166 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.503882646560669
Epoch: 17, Steps: 10 | Train Loss: 0.053 Vali Loss: 1.166 Vali Acc: 0.554 Test Loss: 1.166 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.660517930984497
Epoch: 18, Steps: 10 | Train Loss: 0.042 Vali Loss: 1.157 Vali Acc: 0.554 Test Loss: 1.157 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.7273151874542236
Epoch: 19, Steps: 10 | Train Loss: 0.037 Vali Loss: 1.184 Vali Acc: 0.568 Test Loss: 1.184 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.8174734115600586
Epoch: 20, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.187 Vali Acc: 0.554 Test Loss: 1.187 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.9453237056732178
Epoch: 21, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.193 Vali Acc: 0.554 Test Loss: 1.193 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm16_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6621621621621622
model parameter : 198724
model size : 1.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm16_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.5800864696502686
Epoch: 1, Steps: 10 | Train Loss: 1.463 Vali Loss: 1.433 Vali Acc: 0.311 Test Loss: 1.433 Test Acc: 0.311
Validation loss decreased (inf --> -0.310796).  Saving model ...
Epoch: 2 cost time: 3.8664095401763916
Epoch: 2, Steps: 10 | Train Loss: 1.420 Vali Loss: 1.405 Vali Acc: 0.297 Test Loss: 1.405 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.8952982425689697
Epoch: 3, Steps: 10 | Train Loss: 1.317 Vali Loss: 1.387 Vali Acc: 0.311 Test Loss: 1.387 Test Acc: 0.311
Validation loss decreased (-0.310796 --> -0.310797).  Saving model ...
Epoch: 4 cost time: 3.6156740188598633
Epoch: 4, Steps: 10 | Train Loss: 1.206 Vali Loss: 1.338 Vali Acc: 0.405 Test Loss: 1.338 Test Acc: 0.405
Validation loss decreased (-0.310797 --> -0.405392).  Saving model ...
Epoch: 5 cost time: 3.6738874912261963
Epoch: 5, Steps: 10 | Train Loss: 1.059 Vali Loss: 1.291 Vali Acc: 0.405 Test Loss: 1.291 Test Acc: 0.405
Validation loss decreased (-0.405392 --> -0.405392).  Saving model ...
Epoch: 6 cost time: 3.2216787338256836
Epoch: 6, Steps: 10 | Train Loss: 0.935 Vali Loss: 1.259 Vali Acc: 0.459 Test Loss: 1.259 Test Acc: 0.459
Validation loss decreased (-0.405392 --> -0.459447).  Saving model ...
Epoch: 7 cost time: 3.38075852394104
Epoch: 7, Steps: 10 | Train Loss: 0.794 Vali Loss: 1.220 Vali Acc: 0.514 Test Loss: 1.220 Test Acc: 0.514
Validation loss decreased (-0.459447 --> -0.513501).  Saving model ...
Epoch: 8 cost time: 3.2454471588134766
Epoch: 8, Steps: 10 | Train Loss: 0.682 Vali Loss: 1.184 Vali Acc: 0.554 Test Loss: 1.184 Test Acc: 0.554
Validation loss decreased (-0.513501 --> -0.554042).  Saving model ...
Epoch: 9 cost time: 3.213088035583496
Epoch: 9, Steps: 10 | Train Loss: 0.570 Vali Loss: 1.135 Vali Acc: 0.595 Test Loss: 1.135 Test Acc: 0.595
Validation loss decreased (-0.554042 --> -0.594583).  Saving model ...
Epoch: 10 cost time: 3.144577980041504
Epoch: 10, Steps: 10 | Train Loss: 0.454 Vali Loss: 1.100 Vali Acc: 0.608 Test Loss: 1.100 Test Acc: 0.608
Validation loss decreased (-0.594583 --> -0.608097).  Saving model ...
Epoch: 11 cost time: 3.15493106842041
Epoch: 11, Steps: 10 | Train Loss: 0.345 Vali Loss: 1.093 Vali Acc: 0.608 Test Loss: 1.093 Test Acc: 0.608
Validation loss decreased (-0.608097 --> -0.608097).  Saving model ...
Epoch: 12 cost time: 3.4495279788970947
Epoch: 12, Steps: 10 | Train Loss: 0.276 Vali Loss: 1.057 Vali Acc: 0.608 Test Loss: 1.057 Test Acc: 0.608
Validation loss decreased (-0.608097 --> -0.608098).  Saving model ...
Epoch: 13 cost time: 3.2525699138641357
Epoch: 13, Steps: 10 | Train Loss: 0.221 Vali Loss: 1.019 Vali Acc: 0.595 Test Loss: 1.019 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.7166147232055664
Epoch: 14, Steps: 10 | Train Loss: 0.151 Vali Loss: 0.994 Vali Acc: 0.581 Test Loss: 0.994 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.638719081878662
Epoch: 15, Steps: 10 | Train Loss: 0.122 Vali Loss: 0.994 Vali Acc: 0.622 Test Loss: 0.994 Test Acc: 0.622
Validation loss decreased (-0.608098 --> -0.621612).  Saving model ...
Epoch: 16 cost time: 3.625314235687256
Epoch: 16, Steps: 10 | Train Loss: 0.083 Vali Loss: 0.967 Vali Acc: 0.635 Test Loss: 0.967 Test Acc: 0.635
Validation loss decreased (-0.621612 --> -0.635125).  Saving model ...
Epoch: 17 cost time: 3.377000093460083
Epoch: 17, Steps: 10 | Train Loss: 0.070 Vali Loss: 1.023 Vali Acc: 0.608 Test Loss: 1.023 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.47650408744812
Epoch: 18, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.998 Vali Acc: 0.635 Test Loss: 0.998 Test Acc: 0.635
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.6729087829589844
Epoch: 19, Steps: 10 | Train Loss: 0.043 Vali Loss: 1.025 Vali Acc: 0.622 Test Loss: 1.025 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.5979039669036865
Epoch: 20, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.020 Vali Acc: 0.581 Test Loss: 1.020 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.8812551498413086
Epoch: 21, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.012 Vali Acc: 0.622 Test Loss: 1.012 Test Acc: 0.622
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 4.025496959686279
Epoch: 22, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.031 Vali Acc: 0.595 Test Loss: 1.031 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 4.021909713745117
Epoch: 23, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.021 Vali Acc: 0.608 Test Loss: 1.021 Test Acc: 0.608
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 3.887910842895508
Epoch: 24, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.041 Vali Acc: 0.608 Test Loss: 1.041 Test Acc: 0.608
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 4.089732885360718
Epoch: 25, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.033 Vali Acc: 0.608 Test Loss: 1.033 Test Acc: 0.608
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 3.3588645458221436
Epoch: 26, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.032 Vali Acc: 0.608 Test Loss: 1.032 Test Acc: 0.608
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm16_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6351351351351351
model parameter : 612676
model size : 2.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm16_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.013610363006592
Epoch: 1, Steps: 10 | Train Loss: 1.466 Vali Loss: 1.363 Vali Acc: 0.392 Test Loss: 1.363 Test Acc: 0.392
Validation loss decreased (inf --> -0.391878).  Saving model ...
Epoch: 2 cost time: 2.2999091148376465
Epoch: 2, Steps: 10 | Train Loss: 1.378 Vali Loss: 1.351 Vali Acc: 0.243 Test Loss: 1.351 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.2183306217193604
Epoch: 3, Steps: 10 | Train Loss: 1.292 Vali Loss: 1.331 Vali Acc: 0.338 Test Loss: 1.331 Test Acc: 0.338
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.177358865737915
Epoch: 4, Steps: 10 | Train Loss: 1.183 Vali Loss: 1.276 Vali Acc: 0.446 Test Loss: 1.276 Test Acc: 0.446
Validation loss decreased (-0.391878 --> -0.445933).  Saving model ...
Epoch: 5 cost time: 2.1689939498901367
Epoch: 5, Steps: 10 | Train Loss: 1.053 Vali Loss: 1.244 Vali Acc: 0.473 Test Loss: 1.244 Test Acc: 0.473
Validation loss decreased (-0.445933 --> -0.472961).  Saving model ...
Epoch: 6 cost time: 2.1842598915100098
Epoch: 6, Steps: 10 | Train Loss: 0.940 Vali Loss: 1.206 Vali Acc: 0.527 Test Loss: 1.206 Test Acc: 0.527
Validation loss decreased (-0.472961 --> -0.527015).  Saving model ...
Epoch: 7 cost time: 2.261155128479004
Epoch: 7, Steps: 10 | Train Loss: 0.807 Vali Loss: 1.213 Vali Acc: 0.459 Test Loss: 1.213 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.988316297531128
Epoch: 8, Steps: 10 | Train Loss: 0.660 Vali Loss: 1.147 Vali Acc: 0.581 Test Loss: 1.147 Test Acc: 0.581
Validation loss decreased (-0.527015 --> -0.581070).  Saving model ...
Epoch: 9 cost time: 2.0320208072662354
Epoch: 9, Steps: 10 | Train Loss: 0.520 Vali Loss: 1.110 Vali Acc: 0.581 Test Loss: 1.110 Test Acc: 0.581
Validation loss decreased (-0.581070 --> -0.581070).  Saving model ...
Epoch: 10 cost time: 1.9249088764190674
Epoch: 10, Steps: 10 | Train Loss: 0.438 Vali Loss: 1.163 Vali Acc: 0.527 Test Loss: 1.163 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.013979911804199
Epoch: 11, Steps: 10 | Train Loss: 0.321 Vali Loss: 1.109 Vali Acc: 0.608 Test Loss: 1.109 Test Acc: 0.608
Validation loss decreased (-0.581070 --> -0.608097).  Saving model ...
Epoch: 12 cost time: 2.192610025405884
Epoch: 12, Steps: 10 | Train Loss: 0.238 Vali Loss: 1.110 Vali Acc: 0.622 Test Loss: 1.110 Test Acc: 0.622
Validation loss decreased (-0.608097 --> -0.621611).  Saving model ...
Epoch: 13 cost time: 2.075106620788574
Epoch: 13, Steps: 10 | Train Loss: 0.166 Vali Loss: 1.160 Vali Acc: 0.581 Test Loss: 1.160 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.104789972305298
Epoch: 14, Steps: 10 | Train Loss: 0.129 Vali Loss: 1.101 Vali Acc: 0.595 Test Loss: 1.101 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.418483018875122
Epoch: 15, Steps: 10 | Train Loss: 0.091 Vali Loss: 1.157 Vali Acc: 0.622 Test Loss: 1.157 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.339914321899414
Epoch: 16, Steps: 10 | Train Loss: 0.073 Vali Loss: 1.119 Vali Acc: 0.622 Test Loss: 1.119 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.4068379402160645
Epoch: 17, Steps: 10 | Train Loss: 0.056 Vali Loss: 1.123 Vali Acc: 0.581 Test Loss: 1.123 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.306185483932495
Epoch: 18, Steps: 10 | Train Loss: 0.044 Vali Loss: 1.136 Vali Acc: 0.568 Test Loss: 1.136 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.2276968955993652
Epoch: 19, Steps: 10 | Train Loss: 0.037 Vali Loss: 1.151 Vali Acc: 0.595 Test Loss: 1.151 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.2029154300689697
Epoch: 20, Steps: 10 | Train Loss: 0.036 Vali Loss: 1.129 Vali Acc: 0.581 Test Loss: 1.129 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.124267339706421
Epoch: 21, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.132 Vali Acc: 0.581 Test Loss: 1.132 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.1156258583068848
Epoch: 22, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.144 Vali Acc: 0.595 Test Loss: 1.144 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm16_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 198724
model size : 1.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm16_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.223674058914185
Epoch: 1, Steps: 10 | Train Loss: 1.469 Vali Loss: 1.431 Vali Acc: 0.324 Test Loss: 1.431 Test Acc: 0.324
Validation loss decreased (inf --> -0.324310).  Saving model ...
Epoch: 2 cost time: 2.769824266433716
Epoch: 2, Steps: 10 | Train Loss: 1.424 Vali Loss: 1.403 Vali Acc: 0.297 Test Loss: 1.403 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.4242804050445557
Epoch: 3, Steps: 10 | Train Loss: 1.325 Vali Loss: 1.385 Vali Acc: 0.311 Test Loss: 1.385 Test Acc: 0.311
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.3373804092407227
Epoch: 4, Steps: 10 | Train Loss: 1.221 Vali Loss: 1.339 Vali Acc: 0.405 Test Loss: 1.339 Test Acc: 0.405
Validation loss decreased (-0.324310 --> -0.405392).  Saving model ...
Epoch: 5 cost time: 2.3585169315338135
Epoch: 5, Steps: 10 | Train Loss: 1.075 Vali Loss: 1.291 Vali Acc: 0.432 Test Loss: 1.291 Test Acc: 0.432
Validation loss decreased (-0.405392 --> -0.432420).  Saving model ...
Epoch: 6 cost time: 2.6304051876068115
Epoch: 6, Steps: 10 | Train Loss: 0.955 Vali Loss: 1.253 Vali Acc: 0.459 Test Loss: 1.253 Test Acc: 0.459
Validation loss decreased (-0.432420 --> -0.459447).  Saving model ...
Epoch: 7 cost time: 2.5691394805908203
Epoch: 7, Steps: 10 | Train Loss: 0.820 Vali Loss: 1.215 Vali Acc: 0.473 Test Loss: 1.215 Test Acc: 0.473
Validation loss decreased (-0.459447 --> -0.472961).  Saving model ...
Epoch: 8 cost time: 2.451397180557251
Epoch: 8, Steps: 10 | Train Loss: 0.697 Vali Loss: 1.187 Vali Acc: 0.541 Test Loss: 1.187 Test Acc: 0.541
Validation loss decreased (-0.472961 --> -0.540529).  Saving model ...
Epoch: 9 cost time: 2.301731824874878
Epoch: 9, Steps: 10 | Train Loss: 0.593 Vali Loss: 1.136 Vali Acc: 0.568 Test Loss: 1.136 Test Acc: 0.568
Validation loss decreased (-0.540529 --> -0.567556).  Saving model ...
Epoch: 10 cost time: 2.393932580947876
Epoch: 10, Steps: 10 | Train Loss: 0.480 Vali Loss: 1.109 Vali Acc: 0.581 Test Loss: 1.109 Test Acc: 0.581
Validation loss decreased (-0.567556 --> -0.581070).  Saving model ...
Epoch: 11 cost time: 2.5435032844543457
Epoch: 11, Steps: 10 | Train Loss: 0.370 Vali Loss: 1.091 Vali Acc: 0.581 Test Loss: 1.091 Test Acc: 0.581
Validation loss decreased (-0.581070 --> -0.581070).  Saving model ...
Epoch: 12 cost time: 2.384000301361084
Epoch: 12, Steps: 10 | Train Loss: 0.298 Vali Loss: 1.055 Vali Acc: 0.595 Test Loss: 1.055 Test Acc: 0.595
Validation loss decreased (-0.581070 --> -0.594584).  Saving model ...
Epoch: 13 cost time: 2.35783052444458
Epoch: 13, Steps: 10 | Train Loss: 0.238 Vali Loss: 1.034 Vali Acc: 0.622 Test Loss: 1.034 Test Acc: 0.622
Validation loss decreased (-0.594584 --> -0.621611).  Saving model ...
Epoch: 14 cost time: 2.2695846557617188
Epoch: 14, Steps: 10 | Train Loss: 0.167 Vali Loss: 1.014 Vali Acc: 0.595 Test Loss: 1.014 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.4159462451934814
Epoch: 15, Steps: 10 | Train Loss: 0.128 Vali Loss: 1.010 Vali Acc: 0.622 Test Loss: 1.010 Test Acc: 0.622
Validation loss decreased (-0.621611 --> -0.621612).  Saving model ...
Epoch: 16 cost time: 2.455624580383301
Epoch: 16, Steps: 10 | Train Loss: 0.093 Vali Loss: 0.989 Vali Acc: 0.568 Test Loss: 0.989 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.398458957672119
Epoch: 17, Steps: 10 | Train Loss: 0.078 Vali Loss: 1.009 Vali Acc: 0.608 Test Loss: 1.009 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.312059164047241
Epoch: 18, Steps: 10 | Train Loss: 0.058 Vali Loss: 0.988 Vali Acc: 0.595 Test Loss: 0.988 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.3729407787323
Epoch: 19, Steps: 10 | Train Loss: 0.047 Vali Loss: 1.017 Vali Acc: 0.608 Test Loss: 1.017 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.3887128829956055
Epoch: 20, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.006 Vali Acc: 0.581 Test Loss: 1.006 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.192619562149048
Epoch: 21, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.999 Vali Acc: 0.608 Test Loss: 0.999 Test Acc: 0.608
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.799623727798462
Epoch: 22, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.017 Vali Acc: 0.595 Test Loss: 1.017 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.7038958072662354
Epoch: 23, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.027 Vali Acc: 0.608 Test Loss: 1.027 Test Acc: 0.608
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.3498013019561768
Epoch: 24, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.048 Vali Acc: 0.608 Test Loss: 1.048 Test Acc: 0.608
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.5179131031036377
Epoch: 25, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.030 Vali Acc: 0.595 Test Loss: 1.030 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm16_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 612676
model size : 2.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm16_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.183779001235962
Epoch: 1, Steps: 10 | Train Loss: 1.457 Vali Loss: 1.361 Vali Acc: 0.459 Test Loss: 1.361 Test Acc: 0.459
Validation loss decreased (inf --> -0.459446).  Saving model ...
Epoch: 2 cost time: 1.6285765171051025
Epoch: 2, Steps: 10 | Train Loss: 1.370 Vali Loss: 1.349 Vali Acc: 0.311 Test Loss: 1.349 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8826251029968262
Epoch: 3, Steps: 10 | Train Loss: 1.288 Vali Loss: 1.331 Vali Acc: 0.338 Test Loss: 1.331 Test Acc: 0.338
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.6971361637115479
Epoch: 4, Steps: 10 | Train Loss: 1.199 Vali Loss: 1.281 Vali Acc: 0.459 Test Loss: 1.281 Test Acc: 0.459
Validation loss decreased (-0.459446 --> -0.459447).  Saving model ...
Epoch: 5 cost time: 1.7022716999053955
Epoch: 5, Steps: 10 | Train Loss: 1.084 Vali Loss: 1.252 Vali Acc: 0.473 Test Loss: 1.252 Test Acc: 0.473
Validation loss decreased (-0.459447 --> -0.472960).  Saving model ...
Epoch: 6 cost time: 1.6726067066192627
Epoch: 6, Steps: 10 | Train Loss: 0.979 Vali Loss: 1.213 Vali Acc: 0.527 Test Loss: 1.213 Test Acc: 0.527
Validation loss decreased (-0.472960 --> -0.527015).  Saving model ...
Epoch: 7 cost time: 1.6788864135742188
Epoch: 7, Steps: 10 | Train Loss: 0.865 Vali Loss: 1.229 Vali Acc: 0.473 Test Loss: 1.229 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7511117458343506
Epoch: 8, Steps: 10 | Train Loss: 0.733 Vali Loss: 1.159 Vali Acc: 0.568 Test Loss: 1.159 Test Acc: 0.568
Validation loss decreased (-0.527015 --> -0.567556).  Saving model ...
Epoch: 9 cost time: 1.784299373626709
Epoch: 9, Steps: 10 | Train Loss: 0.608 Vali Loss: 1.112 Vali Acc: 0.595 Test Loss: 1.112 Test Acc: 0.595
Validation loss decreased (-0.567556 --> -0.594583).  Saving model ...
Epoch: 10 cost time: 1.518545389175415
Epoch: 10, Steps: 10 | Train Loss: 0.533 Vali Loss: 1.149 Vali Acc: 0.514 Test Loss: 1.149 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.1287245750427246
Epoch: 11, Steps: 10 | Train Loss: 0.411 Vali Loss: 1.080 Vali Acc: 0.608 Test Loss: 1.080 Test Acc: 0.608
Validation loss decreased (-0.594583 --> -0.608097).  Saving model ...
Epoch: 12 cost time: 2.052565336227417
Epoch: 12, Steps: 10 | Train Loss: 0.341 Vali Loss: 1.078 Vali Acc: 0.608 Test Loss: 1.078 Test Acc: 0.608
Validation loss decreased (-0.608097 --> -0.608097).  Saving model ...
Epoch: 13 cost time: 1.910818338394165
Epoch: 13, Steps: 10 | Train Loss: 0.247 Vali Loss: 1.140 Vali Acc: 0.622 Test Loss: 1.140 Test Acc: 0.622
Validation loss decreased (-0.608097 --> -0.621610).  Saving model ...
Epoch: 14 cost time: 1.707432508468628
Epoch: 14, Steps: 10 | Train Loss: 0.202 Vali Loss: 1.060 Vali Acc: 0.581 Test Loss: 1.060 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.0012643337249756
Epoch: 15, Steps: 10 | Train Loss: 0.151 Vali Loss: 1.133 Vali Acc: 0.581 Test Loss: 1.133 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.07682466506958
Epoch: 16, Steps: 10 | Train Loss: 0.116 Vali Loss: 1.074 Vali Acc: 0.595 Test Loss: 1.074 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.1102311611175537
Epoch: 17, Steps: 10 | Train Loss: 0.093 Vali Loss: 1.130 Vali Acc: 0.608 Test Loss: 1.130 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.9177582263946533
Epoch: 18, Steps: 10 | Train Loss: 0.068 Vali Loss: 1.122 Vali Acc: 0.608 Test Loss: 1.122 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.8636705875396729
Epoch: 19, Steps: 10 | Train Loss: 0.058 Vali Loss: 1.134 Vali Acc: 0.608 Test Loss: 1.134 Test Acc: 0.608
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.9691238403320312
Epoch: 20, Steps: 10 | Train Loss: 0.049 Vali Loss: 1.135 Vali Acc: 0.595 Test Loss: 1.135 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.0045716762542725
Epoch: 21, Steps: 10 | Train Loss: 0.040 Vali Loss: 1.155 Vali Acc: 0.608 Test Loss: 1.155 Test Acc: 0.608
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.0356452465057373
Epoch: 22, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.131 Vali Acc: 0.608 Test Loss: 1.131 Test Acc: 0.608
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.9462120532989502
Epoch: 23, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.152 Vali Acc: 0.581 Test Loss: 1.152 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm16_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 198724
model size : 1.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm8_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 8.029263019561768
Epoch: 1, Steps: 10 | Train Loss: 1.417 Vali Loss: 1.423 Vali Acc: 0.189 Test Loss: 1.423 Test Acc: 0.189
Validation loss decreased (inf --> -0.189175).  Saving model ...
Epoch: 2 cost time: 6.905898571014404
Epoch: 2, Steps: 10 | Train Loss: 1.334 Vali Loss: 1.373 Vali Acc: 0.284 Test Loss: 1.373 Test Acc: 0.284
Validation loss decreased (-0.189175 --> -0.283770).  Saving model ...
Epoch: 3 cost time: 7.054919004440308
Epoch: 3, Steps: 10 | Train Loss: 1.265 Vali Loss: 1.347 Vali Acc: 0.311 Test Loss: 1.347 Test Acc: 0.311
Validation loss decreased (-0.283770 --> -0.310797).  Saving model ...
Epoch: 4 cost time: 6.18455696105957
Epoch: 4, Steps: 10 | Train Loss: 1.196 Vali Loss: 1.318 Vali Acc: 0.324 Test Loss: 1.318 Test Acc: 0.324
Validation loss decreased (-0.310797 --> -0.324311).  Saving model ...
Epoch: 5 cost time: 6.096271514892578
Epoch: 5, Steps: 10 | Train Loss: 1.094 Vali Loss: 1.285 Vali Acc: 0.432 Test Loss: 1.285 Test Acc: 0.432
Validation loss decreased (-0.324311 --> -0.432420).  Saving model ...
Epoch: 6 cost time: 5.644498825073242
Epoch: 6, Steps: 10 | Train Loss: 1.015 Vali Loss: 1.253 Vali Acc: 0.459 Test Loss: 1.253 Test Acc: 0.459
Validation loss decreased (-0.432420 --> -0.459447).  Saving model ...
Epoch: 7 cost time: 5.726914644241333
Epoch: 7, Steps: 10 | Train Loss: 0.927 Vali Loss: 1.230 Vali Acc: 0.473 Test Loss: 1.230 Test Acc: 0.473
Validation loss decreased (-0.459447 --> -0.472961).  Saving model ...
Epoch: 8 cost time: 6.322876930236816
Epoch: 8, Steps: 10 | Train Loss: 0.837 Vali Loss: 1.198 Vali Acc: 0.473 Test Loss: 1.198 Test Acc: 0.473
Validation loss decreased (-0.472961 --> -0.472961).  Saving model ...
Epoch: 9 cost time: 6.1107213497161865
Epoch: 9, Steps: 10 | Train Loss: 0.755 Vali Loss: 1.146 Vali Acc: 0.568 Test Loss: 1.146 Test Acc: 0.568
Validation loss decreased (-0.472961 --> -0.567556).  Saving model ...
Epoch: 10 cost time: 6.224959135055542
Epoch: 10, Steps: 10 | Train Loss: 0.667 Vali Loss: 1.136 Vali Acc: 0.581 Test Loss: 1.136 Test Acc: 0.581
Validation loss decreased (-0.567556 --> -0.581070).  Saving model ...
Epoch: 11 cost time: 6.641395568847656
Epoch: 11, Steps: 10 | Train Loss: 0.559 Vali Loss: 1.095 Vali Acc: 0.581 Test Loss: 1.095 Test Acc: 0.581
Validation loss decreased (-0.581070 --> -0.581070).  Saving model ...
Epoch: 12 cost time: 6.441131353378296
Epoch: 12, Steps: 10 | Train Loss: 0.508 Vali Loss: 1.058 Vali Acc: 0.595 Test Loss: 1.058 Test Acc: 0.595
Validation loss decreased (-0.581070 --> -0.594584).  Saving model ...
Epoch: 13 cost time: 6.1672515869140625
Epoch: 13, Steps: 10 | Train Loss: 0.406 Vali Loss: 1.036 Vali Acc: 0.595 Test Loss: 1.036 Test Acc: 0.595
Validation loss decreased (-0.594584 --> -0.594584).  Saving model ...
Epoch: 14 cost time: 4.991684436798096
Epoch: 14, Steps: 10 | Train Loss: 0.346 Vali Loss: 1.021 Vali Acc: 0.568 Test Loss: 1.021 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.966863393783569
Epoch: 15, Steps: 10 | Train Loss: 0.275 Vali Loss: 0.982 Vali Acc: 0.554 Test Loss: 0.982 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 6.11037015914917
Epoch: 16, Steps: 10 | Train Loss: 0.212 Vali Loss: 0.973 Vali Acc: 0.635 Test Loss: 0.973 Test Acc: 0.635
Validation loss decreased (-0.594584 --> -0.635125).  Saving model ...
Epoch: 17 cost time: 6.242259502410889
Epoch: 17, Steps: 10 | Train Loss: 0.169 Vali Loss: 0.976 Vali Acc: 0.595 Test Loss: 0.976 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 6.151782035827637
Epoch: 18, Steps: 10 | Train Loss: 0.151 Vali Loss: 0.951 Vali Acc: 0.581 Test Loss: 0.951 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 5.8948259353637695
Epoch: 19, Steps: 10 | Train Loss: 0.115 Vali Loss: 0.979 Vali Acc: 0.527 Test Loss: 0.979 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 4.527986764907837
Epoch: 20, Steps: 10 | Train Loss: 0.100 Vali Loss: 1.002 Vali Acc: 0.554 Test Loss: 1.002 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 4.639399528503418
Epoch: 21, Steps: 10 | Train Loss: 0.100 Vali Loss: 1.004 Vali Acc: 0.568 Test Loss: 1.004 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 4.637094259262085
Epoch: 22, Steps: 10 | Train Loss: 0.081 Vali Loss: 1.034 Vali Acc: 0.595 Test Loss: 1.034 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 7.080546617507935
Epoch: 23, Steps: 10 | Train Loss: 0.064 Vali Loss: 1.101 Vali Acc: 0.568 Test Loss: 1.101 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 6.964027166366577
Epoch: 24, Steps: 10 | Train Loss: 0.056 Vali Loss: 1.045 Vali Acc: 0.554 Test Loss: 1.045 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 7.038248300552368
Epoch: 25, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.983 Vali Acc: 0.595 Test Loss: 0.983 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 7.4242517948150635
Epoch: 26, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.983 Vali Acc: 0.608 Test Loss: 0.983 Test Acc: 0.608
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm8_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6351351351351351
model parameter : 1186276
model size : 4.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm8_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.280626535415649
Epoch: 1, Steps: 10 | Train Loss: 1.473 Vali Loss: 1.447 Vali Acc: 0.189 Test Loss: 1.447 Test Acc: 0.189
Validation loss decreased (inf --> -0.189175).  Saving model ...
Epoch: 2 cost time: 3.6013708114624023
Epoch: 2, Steps: 10 | Train Loss: 1.422 Vali Loss: 1.414 Vali Acc: 0.176 Test Loss: 1.414 Test Acc: 0.176
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.6469473838806152
Epoch: 3, Steps: 10 | Train Loss: 1.390 Vali Loss: 1.384 Vali Acc: 0.311 Test Loss: 1.384 Test Acc: 0.311
Validation loss decreased (-0.189175 --> -0.310797).  Saving model ...
Epoch: 4 cost time: 3.509969711303711
Epoch: 4, Steps: 10 | Train Loss: 1.317 Vali Loss: 1.365 Vali Acc: 0.257 Test Loss: 1.365 Test Acc: 0.257
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.58845591545105
Epoch: 5, Steps: 10 | Train Loss: 1.241 Vali Loss: 1.332 Vali Acc: 0.338 Test Loss: 1.332 Test Acc: 0.338
Validation loss decreased (-0.310797 --> -0.337825).  Saving model ...
Epoch: 6 cost time: 3.7094314098358154
Epoch: 6, Steps: 10 | Train Loss: 1.167 Vali Loss: 1.324 Vali Acc: 0.311 Test Loss: 1.324 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.6743035316467285
Epoch: 7, Steps: 10 | Train Loss: 1.083 Vali Loss: 1.291 Vali Acc: 0.311 Test Loss: 1.291 Test Acc: 0.311
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.560030221939087
Epoch: 8, Steps: 10 | Train Loss: 0.972 Vali Loss: 1.276 Vali Acc: 0.392 Test Loss: 1.276 Test Acc: 0.392
Validation loss decreased (-0.337825 --> -0.391879).  Saving model ...
Epoch: 9 cost time: 3.5371017456054688
Epoch: 9, Steps: 10 | Train Loss: 0.875 Vali Loss: 1.247 Vali Acc: 0.378 Test Loss: 1.247 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.9941928386688232
Epoch: 10, Steps: 10 | Train Loss: 0.800 Vali Loss: 1.223 Vali Acc: 0.392 Test Loss: 1.223 Test Acc: 0.392
Validation loss decreased (-0.391879 --> -0.391880).  Saving model ...
Epoch: 11 cost time: 4.154728889465332
Epoch: 11, Steps: 10 | Train Loss: 0.693 Vali Loss: 1.197 Vali Acc: 0.392 Test Loss: 1.197 Test Acc: 0.392
Validation loss decreased (-0.391880 --> -0.391880).  Saving model ...
Epoch: 12 cost time: 4.0069420337677
Epoch: 12, Steps: 10 | Train Loss: 0.624 Vali Loss: 1.170 Vali Acc: 0.419 Test Loss: 1.170 Test Acc: 0.419
Validation loss decreased (-0.391880 --> -0.418907).  Saving model ...
Epoch: 13 cost time: 4.008455991744995
Epoch: 13, Steps: 10 | Train Loss: 0.555 Vali Loss: 1.155 Vali Acc: 0.446 Test Loss: 1.155 Test Acc: 0.446
Validation loss decreased (-0.418907 --> -0.445934).  Saving model ...
Epoch: 14 cost time: 4.0833518505096436
Epoch: 14, Steps: 10 | Train Loss: 0.498 Vali Loss: 1.119 Vali Acc: 0.432 Test Loss: 1.119 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.987795352935791
Epoch: 15, Steps: 10 | Train Loss: 0.400 Vali Loss: 1.134 Vali Acc: 0.473 Test Loss: 1.134 Test Acc: 0.473
Validation loss decreased (-0.445934 --> -0.472962).  Saving model ...
Epoch: 16 cost time: 3.9815444946289062
Epoch: 16, Steps: 10 | Train Loss: 0.356 Vali Loss: 1.108 Vali Acc: 0.500 Test Loss: 1.108 Test Acc: 0.500
Validation loss decreased (-0.472962 --> -0.499989).  Saving model ...
Epoch: 17 cost time: 3.8979885578155518
Epoch: 17, Steps: 10 | Train Loss: 0.303 Vali Loss: 1.109 Vali Acc: 0.500 Test Loss: 1.109 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.6135640144348145
Epoch: 18, Steps: 10 | Train Loss: 0.245 Vali Loss: 1.115 Vali Acc: 0.486 Test Loss: 1.115 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.658904552459717
Epoch: 19, Steps: 10 | Train Loss: 0.192 Vali Loss: 1.125 Vali Acc: 0.486 Test Loss: 1.125 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.815859794616699
Epoch: 20, Steps: 10 | Train Loss: 0.168 Vali Loss: 1.104 Vali Acc: 0.473 Test Loss: 1.104 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.779435157775879
Epoch: 21, Steps: 10 | Train Loss: 0.150 Vali Loss: 1.069 Vali Acc: 0.500 Test Loss: 1.069 Test Acc: 0.500
Validation loss decreased (-0.499989 --> -0.499989).  Saving model ...
Epoch: 22 cost time: 3.581724166870117
Epoch: 22, Steps: 10 | Train Loss: 0.106 Vali Loss: 1.085 Vali Acc: 0.541 Test Loss: 1.085 Test Acc: 0.541
Validation loss decreased (-0.499989 --> -0.540530).  Saving model ...
Epoch: 23 cost time: 3.8793044090270996
Epoch: 23, Steps: 10 | Train Loss: 0.101 Vali Loss: 1.103 Vali Acc: 0.527 Test Loss: 1.103 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.9680330753326416
Epoch: 24, Steps: 10 | Train Loss: 0.086 Vali Loss: 1.125 Vali Acc: 0.514 Test Loss: 1.125 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.8103561401367188
Epoch: 25, Steps: 10 | Train Loss: 0.094 Vali Loss: 1.157 Vali Acc: 0.473 Test Loss: 1.157 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.7703912258148193
Epoch: 26, Steps: 10 | Train Loss: 0.079 Vali Loss: 1.093 Vali Acc: 0.500 Test Loss: 1.093 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 3.435351848602295
Epoch: 27, Steps: 10 | Train Loss: 0.063 Vali Loss: 1.084 Vali Acc: 0.554 Test Loss: 1.084 Test Acc: 0.554
Validation loss decreased (-0.540530 --> -0.554043).  Saving model ...
Epoch: 28 cost time: 2.798722267150879
Epoch: 28, Steps: 10 | Train Loss: 0.059 Vali Loss: 1.150 Vali Acc: 0.514 Test Loss: 1.150 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.7125356197357178
Epoch: 29, Steps: 10 | Train Loss: 0.058 Vali Loss: 1.143 Vali Acc: 0.527 Test Loss: 1.143 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.448796510696411
Epoch: 30, Steps: 10 | Train Loss: 0.044 Vali Loss: 1.123 Vali Acc: 0.473 Test Loss: 1.123 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm8_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 358308
model size : 1.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm8_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 6.039819717407227
Epoch: 1, Steps: 10 | Train Loss: 1.419 Vali Loss: 1.428 Vali Acc: 0.162 Test Loss: 1.428 Test Acc: 0.162
Validation loss decreased (inf --> -0.162148).  Saving model ...
Epoch: 2 cost time: 4.551113843917847
Epoch: 2, Steps: 10 | Train Loss: 1.332 Vali Loss: 1.380 Vali Acc: 0.270 Test Loss: 1.380 Test Acc: 0.270
Validation loss decreased (-0.162148 --> -0.270256).  Saving model ...
Epoch: 3 cost time: 4.679645776748657
Epoch: 3, Steps: 10 | Train Loss: 1.276 Vali Loss: 1.357 Vali Acc: 0.297 Test Loss: 1.357 Test Acc: 0.297
Validation loss decreased (-0.270256 --> -0.297284).  Saving model ...
Epoch: 4 cost time: 4.518661737442017
Epoch: 4, Steps: 10 | Train Loss: 1.206 Vali Loss: 1.333 Vali Acc: 0.324 Test Loss: 1.333 Test Acc: 0.324
Validation loss decreased (-0.297284 --> -0.324311).  Saving model ...
Epoch: 5 cost time: 4.581265211105347
Epoch: 5, Steps: 10 | Train Loss: 1.113 Vali Loss: 1.306 Vali Acc: 0.338 Test Loss: 1.306 Test Acc: 0.338
Validation loss decreased (-0.324311 --> -0.337825).  Saving model ...
Epoch: 6 cost time: 4.413651704788208
Epoch: 6, Steps: 10 | Train Loss: 1.025 Vali Loss: 1.279 Vali Acc: 0.419 Test Loss: 1.279 Test Acc: 0.419
Validation loss decreased (-0.337825 --> -0.418906).  Saving model ...
Epoch: 7 cost time: 4.402429819107056
Epoch: 7, Steps: 10 | Train Loss: 0.938 Vali Loss: 1.258 Vali Acc: 0.500 Test Loss: 1.258 Test Acc: 0.500
Validation loss decreased (-0.418906 --> -0.499987).  Saving model ...
Epoch: 8 cost time: 4.811727285385132
Epoch: 8, Steps: 10 | Train Loss: 0.859 Vali Loss: 1.220 Vali Acc: 0.514 Test Loss: 1.220 Test Acc: 0.514
Validation loss decreased (-0.499987 --> -0.513501).  Saving model ...
Epoch: 9 cost time: 4.783626556396484
Epoch: 9, Steps: 10 | Train Loss: 0.753 Vali Loss: 1.164 Vali Acc: 0.554 Test Loss: 1.164 Test Acc: 0.554
Validation loss decreased (-0.513501 --> -0.554042).  Saving model ...
Epoch: 10 cost time: 4.724207162857056
Epoch: 10, Steps: 10 | Train Loss: 0.695 Vali Loss: 1.159 Vali Acc: 0.581 Test Loss: 1.159 Test Acc: 0.581
Validation loss decreased (-0.554042 --> -0.581069).  Saving model ...
Epoch: 11 cost time: 5.241962194442749
Epoch: 11, Steps: 10 | Train Loss: 0.559 Vali Loss: 1.115 Vali Acc: 0.568 Test Loss: 1.115 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.478091239929199
Epoch: 12, Steps: 10 | Train Loss: 0.491 Vali Loss: 1.058 Vali Acc: 0.608 Test Loss: 1.058 Test Acc: 0.608
Validation loss decreased (-0.581069 --> -0.608098).  Saving model ...
Epoch: 13 cost time: 4.169192552566528
Epoch: 13, Steps: 10 | Train Loss: 0.420 Vali Loss: 1.027 Vali Acc: 0.635 Test Loss: 1.027 Test Acc: 0.635
Validation loss decreased (-0.608098 --> -0.635125).  Saving model ...
Epoch: 14 cost time: 4.408292770385742
Epoch: 14, Steps: 10 | Train Loss: 0.346 Vali Loss: 1.019 Vali Acc: 0.595 Test Loss: 1.019 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.247680187225342
Epoch: 15, Steps: 10 | Train Loss: 0.261 Vali Loss: 0.984 Vali Acc: 0.568 Test Loss: 0.984 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 5.036201238632202
Epoch: 16, Steps: 10 | Train Loss: 0.199 Vali Loss: 0.974 Vali Acc: 0.595 Test Loss: 0.974 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 5.031062602996826
Epoch: 17, Steps: 10 | Train Loss: 0.165 Vali Loss: 0.980 Vali Acc: 0.622 Test Loss: 0.980 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 4.838496446609497
Epoch: 18, Steps: 10 | Train Loss: 0.150 Vali Loss: 0.986 Vali Acc: 0.689 Test Loss: 0.986 Test Acc: 0.689
Validation loss decreased (-0.635125 --> -0.689179).  Saving model ...
Epoch: 19 cost time: 4.787054538726807
Epoch: 19, Steps: 10 | Train Loss: 0.114 Vali Loss: 0.949 Vali Acc: 0.608 Test Loss: 0.949 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 5.0715107917785645
Epoch: 20, Steps: 10 | Train Loss: 0.097 Vali Loss: 0.905 Vali Acc: 0.662 Test Loss: 0.905 Test Acc: 0.662
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 5.045440435409546
Epoch: 21, Steps: 10 | Train Loss: 0.084 Vali Loss: 0.914 Vali Acc: 0.608 Test Loss: 0.914 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 4.734439849853516
Epoch: 22, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.934 Vali Acc: 0.635 Test Loss: 0.934 Test Acc: 0.635
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 5.182489395141602
Epoch: 23, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.994 Vali Acc: 0.622 Test Loss: 0.994 Test Acc: 0.622
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 5.3281166553497314
Epoch: 24, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.976 Vali Acc: 0.635 Test Loss: 0.976 Test Acc: 0.635
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 5.017578601837158
Epoch: 25, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.981 Vali Acc: 0.649 Test Loss: 0.981 Test Acc: 0.649
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 4.8824143409729
Epoch: 26, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.989 Vali Acc: 0.649 Test Loss: 0.989 Test Acc: 0.649
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 4.910801887512207
Epoch: 27, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.997 Vali Acc: 0.689 Test Loss: 0.997 Test Acc: 0.689
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 4.85910439491272
Epoch: 28, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.988 Vali Acc: 0.662 Test Loss: 0.988 Test Acc: 0.662
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm8_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6891891891891891
model parameter : 1186276
model size : 4.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm8_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.448334455490112
Epoch: 1, Steps: 10 | Train Loss: 1.472 Vali Loss: 1.449 Vali Acc: 0.189 Test Loss: 1.449 Test Acc: 0.189
Validation loss decreased (inf --> -0.189175).  Saving model ...
Epoch: 2 cost time: 2.7139272689819336
Epoch: 2, Steps: 10 | Train Loss: 1.418 Vali Loss: 1.414 Vali Acc: 0.189 Test Loss: 1.414 Test Acc: 0.189
Validation loss decreased (-0.189175 --> -0.189175).  Saving model ...
Epoch: 3 cost time: 2.5671069622039795
Epoch: 3, Steps: 10 | Train Loss: 1.391 Vali Loss: 1.387 Vali Acc: 0.284 Test Loss: 1.387 Test Acc: 0.284
Validation loss decreased (-0.189175 --> -0.283770).  Saving model ...
Epoch: 4 cost time: 2.881713628768921
Epoch: 4, Steps: 10 | Train Loss: 1.315 Vali Loss: 1.367 Vali Acc: 0.270 Test Loss: 1.367 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.470089912414551
Epoch: 5, Steps: 10 | Train Loss: 1.244 Vali Loss: 1.335 Vali Acc: 0.311 Test Loss: 1.335 Test Acc: 0.311
Validation loss decreased (-0.283770 --> -0.310797).  Saving model ...
Epoch: 6 cost time: 2.5648982524871826
Epoch: 6, Steps: 10 | Train Loss: 1.169 Vali Loss: 1.325 Vali Acc: 0.297 Test Loss: 1.325 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.645676374435425
Epoch: 7, Steps: 10 | Train Loss: 1.092 Vali Loss: 1.292 Vali Acc: 0.324 Test Loss: 1.292 Test Acc: 0.324
Validation loss decreased (-0.310797 --> -0.324311).  Saving model ...
Epoch: 8 cost time: 2.691481590270996
Epoch: 8, Steps: 10 | Train Loss: 0.981 Vali Loss: 1.280 Vali Acc: 0.351 Test Loss: 1.280 Test Acc: 0.351
Validation loss decreased (-0.324311 --> -0.351339).  Saving model ...
Epoch: 9 cost time: 2.56852650642395
Epoch: 9, Steps: 10 | Train Loss: 0.883 Vali Loss: 1.250 Vali Acc: 0.378 Test Loss: 1.250 Test Acc: 0.378
Validation loss decreased (-0.351339 --> -0.378366).  Saving model ...
Epoch: 10 cost time: 2.5831754207611084
Epoch: 10, Steps: 10 | Train Loss: 0.813 Vali Loss: 1.225 Vali Acc: 0.392 Test Loss: 1.225 Test Acc: 0.392
Validation loss decreased (-0.378366 --> -0.391880).  Saving model ...
Epoch: 11 cost time: 2.8449928760528564
Epoch: 11, Steps: 10 | Train Loss: 0.714 Vali Loss: 1.196 Vali Acc: 0.405 Test Loss: 1.196 Test Acc: 0.405
Validation loss decreased (-0.391880 --> -0.405393).  Saving model ...
Epoch: 12 cost time: 2.421710252761841
Epoch: 12, Steps: 10 | Train Loss: 0.639 Vali Loss: 1.171 Vali Acc: 0.405 Test Loss: 1.171 Test Acc: 0.405
Validation loss decreased (-0.405393 --> -0.405394).  Saving model ...
Epoch: 13 cost time: 2.6692752838134766
Epoch: 13, Steps: 10 | Train Loss: 0.567 Vali Loss: 1.171 Vali Acc: 0.446 Test Loss: 1.171 Test Acc: 0.446
Validation loss decreased (-0.405394 --> -0.445934).  Saving model ...
Epoch: 14 cost time: 2.534636974334717
Epoch: 14, Steps: 10 | Train Loss: 0.501 Vali Loss: 1.137 Vali Acc: 0.392 Test Loss: 1.137 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.5346970558166504
Epoch: 15, Steps: 10 | Train Loss: 0.405 Vali Loss: 1.149 Vali Acc: 0.486 Test Loss: 1.149 Test Acc: 0.486
Validation loss decreased (-0.445934 --> -0.486475).  Saving model ...
Epoch: 16 cost time: 2.59740948677063
Epoch: 16, Steps: 10 | Train Loss: 0.379 Vali Loss: 1.097 Vali Acc: 0.446 Test Loss: 1.097 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.698619842529297
Epoch: 17, Steps: 10 | Train Loss: 0.305 Vali Loss: 1.105 Vali Acc: 0.473 Test Loss: 1.105 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.949261426925659
Epoch: 18, Steps: 10 | Train Loss: 0.259 Vali Loss: 1.122 Vali Acc: 0.527 Test Loss: 1.122 Test Acc: 0.527
Validation loss decreased (-0.486475 --> -0.527016).  Saving model ...
Epoch: 19 cost time: 2.526444673538208
Epoch: 19, Steps: 10 | Train Loss: 0.214 Vali Loss: 1.127 Vali Acc: 0.473 Test Loss: 1.127 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.5579640865325928
Epoch: 20, Steps: 10 | Train Loss: 0.180 Vali Loss: 1.112 Vali Acc: 0.527 Test Loss: 1.112 Test Acc: 0.527
Validation loss decreased (-0.527016 --> -0.527016).  Saving model ...
Epoch: 21 cost time: 2.6733205318450928
Epoch: 21, Steps: 10 | Train Loss: 0.151 Vali Loss: 1.105 Vali Acc: 0.486 Test Loss: 1.105 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.5403058528900146
Epoch: 22, Steps: 10 | Train Loss: 0.123 Vali Loss: 1.100 Vali Acc: 0.527 Test Loss: 1.100 Test Acc: 0.527
Validation loss decreased (-0.527016 --> -0.527016).  Saving model ...
Epoch: 23 cost time: 2.3813748359680176
Epoch: 23, Steps: 10 | Train Loss: 0.118 Vali Loss: 1.124 Vali Acc: 0.514 Test Loss: 1.124 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.5007479190826416
Epoch: 24, Steps: 10 | Train Loss: 0.097 Vali Loss: 1.134 Vali Acc: 0.500 Test Loss: 1.134 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.812880516052246
Epoch: 25, Steps: 10 | Train Loss: 0.089 Vali Loss: 1.144 Vali Acc: 0.486 Test Loss: 1.144 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.4211833477020264
Epoch: 26, Steps: 10 | Train Loss: 0.099 Vali Loss: 1.128 Vali Acc: 0.527 Test Loss: 1.128 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.4202139377593994
Epoch: 27, Steps: 10 | Train Loss: 0.076 Vali Loss: 1.126 Vali Acc: 0.486 Test Loss: 1.126 Test Acc: 0.486
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.3297476768493652
Epoch: 28, Steps: 10 | Train Loss: 0.060 Vali Loss: 1.170 Vali Acc: 0.554 Test Loss: 1.170 Test Acc: 0.554
Validation loss decreased (-0.527016 --> -0.554042).  Saving model ...
Epoch: 29 cost time: 2.364748239517212
Epoch: 29, Steps: 10 | Train Loss: 0.056 Vali Loss: 1.143 Vali Acc: 0.486 Test Loss: 1.143 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.3938395977020264
Epoch: 30, Steps: 10 | Train Loss: 0.050 Vali Loss: 1.140 Vali Acc: 0.527 Test Loss: 1.140 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm8_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 358308
model size : 1.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm8_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.472192764282227
Epoch: 1, Steps: 10 | Train Loss: 1.412 Vali Loss: 1.426 Vali Acc: 0.216 Test Loss: 1.426 Test Acc: 0.216
Validation loss decreased (inf --> -0.216202).  Saving model ...
Epoch: 2 cost time: 3.2396883964538574
Epoch: 2, Steps: 10 | Train Loss: 1.332 Vali Loss: 1.374 Vali Acc: 0.243 Test Loss: 1.374 Test Acc: 0.243
Validation loss decreased (-0.216202 --> -0.243230).  Saving model ...
Epoch: 3 cost time: 3.1086738109588623
Epoch: 3, Steps: 10 | Train Loss: 1.285 Vali Loss: 1.346 Vali Acc: 0.270 Test Loss: 1.346 Test Acc: 0.270
Validation loss decreased (-0.243230 --> -0.270257).  Saving model ...
Epoch: 4 cost time: 3.0323352813720703
Epoch: 4, Steps: 10 | Train Loss: 1.233 Vali Loss: 1.321 Vali Acc: 0.338 Test Loss: 1.321 Test Acc: 0.338
Validation loss decreased (-0.270257 --> -0.337825).  Saving model ...
Epoch: 5 cost time: 3.3163275718688965
Epoch: 5, Steps: 10 | Train Loss: 1.155 Vali Loss: 1.293 Vali Acc: 0.405 Test Loss: 1.293 Test Acc: 0.405
Validation loss decreased (-0.337825 --> -0.405392).  Saving model ...
Epoch: 6 cost time: 3.3099801540374756
Epoch: 6, Steps: 10 | Train Loss: 1.093 Vali Loss: 1.265 Vali Acc: 0.446 Test Loss: 1.265 Test Acc: 0.446
Validation loss decreased (-0.405392 --> -0.445933).  Saving model ...
Epoch: 7 cost time: 3.197009801864624
Epoch: 7, Steps: 10 | Train Loss: 1.019 Vali Loss: 1.245 Vali Acc: 0.459 Test Loss: 1.245 Test Acc: 0.459
Validation loss decreased (-0.445933 --> -0.459447).  Saving model ...
Epoch: 8 cost time: 3.139000177383423
Epoch: 8, Steps: 10 | Train Loss: 0.955 Vali Loss: 1.211 Vali Acc: 0.514 Test Loss: 1.211 Test Acc: 0.514
Validation loss decreased (-0.459447 --> -0.513501).  Saving model ...
Epoch: 9 cost time: 3.1726694107055664
Epoch: 9, Steps: 10 | Train Loss: 0.873 Vali Loss: 1.161 Vali Acc: 0.527 Test Loss: 1.161 Test Acc: 0.527
Validation loss decreased (-0.513501 --> -0.527015).  Saving model ...
Epoch: 10 cost time: 3.0574750900268555
Epoch: 10, Steps: 10 | Train Loss: 0.794 Vali Loss: 1.148 Vali Acc: 0.554 Test Loss: 1.148 Test Acc: 0.554
Validation loss decreased (-0.527015 --> -0.554043).  Saving model ...
Epoch: 11 cost time: 3.4629862308502197
Epoch: 11, Steps: 10 | Train Loss: 0.686 Vali Loss: 1.087 Vali Acc: 0.608 Test Loss: 1.087 Test Acc: 0.608
Validation loss decreased (-0.554043 --> -0.608097).  Saving model ...
Epoch: 12 cost time: 3.036224603652954
Epoch: 12, Steps: 10 | Train Loss: 0.620 Vali Loss: 1.043 Vali Acc: 0.554 Test Loss: 1.043 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.9984641075134277
Epoch: 13, Steps: 10 | Train Loss: 0.522 Vali Loss: 1.007 Vali Acc: 0.595 Test Loss: 1.007 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.7890429496765137
Epoch: 14, Steps: 10 | Train Loss: 0.465 Vali Loss: 0.984 Vali Acc: 0.608 Test Loss: 0.984 Test Acc: 0.608
Validation loss decreased (-0.608097 --> -0.608098).  Saving model ...
Epoch: 15 cost time: 3.2653160095214844
Epoch: 15, Steps: 10 | Train Loss: 0.399 Vali Loss: 0.946 Vali Acc: 0.635 Test Loss: 0.946 Test Acc: 0.635
Validation loss decreased (-0.608098 --> -0.635126).  Saving model ...
Epoch: 16 cost time: 3.289212703704834
Epoch: 16, Steps: 10 | Train Loss: 0.344 Vali Loss: 0.956 Vali Acc: 0.608 Test Loss: 0.956 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.5232763290405273
Epoch: 17, Steps: 10 | Train Loss: 0.284 Vali Loss: 0.933 Vali Acc: 0.622 Test Loss: 0.933 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.4612948894500732
Epoch: 18, Steps: 10 | Train Loss: 0.256 Vali Loss: 0.927 Vali Acc: 0.622 Test Loss: 0.927 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.523228168487549
Epoch: 19, Steps: 10 | Train Loss: 0.207 Vali Loss: 0.922 Vali Acc: 0.649 Test Loss: 0.922 Test Acc: 0.649
Validation loss decreased (-0.635126 --> -0.648639).  Saving model ...
Epoch: 20 cost time: 2.8517825603485107
Epoch: 20, Steps: 10 | Train Loss: 0.178 Vali Loss: 0.942 Vali Acc: 0.635 Test Loss: 0.942 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.1954119205474854
Epoch: 21, Steps: 10 | Train Loss: 0.163 Vali Loss: 0.913 Vali Acc: 0.622 Test Loss: 0.913 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.038008213043213
Epoch: 22, Steps: 10 | Train Loss: 0.133 Vali Loss: 0.928 Vali Acc: 0.649 Test Loss: 0.928 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.1734302043914795
Epoch: 23, Steps: 10 | Train Loss: 0.119 Vali Loss: 0.943 Vali Acc: 0.622 Test Loss: 0.943 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.194753408432007
Epoch: 24, Steps: 10 | Train Loss: 0.116 Vali Loss: 0.929 Vali Acc: 0.662 Test Loss: 0.929 Test Acc: 0.662
Validation loss decreased (-0.648639 --> -0.662153).  Saving model ...
Epoch: 25 cost time: 3.236053943634033
Epoch: 25, Steps: 10 | Train Loss: 0.092 Vali Loss: 0.953 Vali Acc: 0.622 Test Loss: 0.953 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.1768929958343506
Epoch: 26, Steps: 10 | Train Loss: 0.084 Vali Loss: 0.941 Vali Acc: 0.676 Test Loss: 0.941 Test Acc: 0.676
Validation loss decreased (-0.662153 --> -0.675666).  Saving model ...
Epoch: 27 cost time: 3.1503872871398926
Epoch: 27, Steps: 10 | Train Loss: 0.075 Vali Loss: 0.939 Vali Acc: 0.649 Test Loss: 0.939 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.360595464706421
Epoch: 28, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.960 Vali Acc: 0.635 Test Loss: 0.960 Test Acc: 0.635
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.3558666706085205
Epoch: 29, Steps: 10 | Train Loss: 0.062 Vali Loss: 0.976 Vali Acc: 0.635 Test Loss: 0.976 Test Acc: 0.635
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.2399487495422363
Epoch: 30, Steps: 10 | Train Loss: 0.064 Vali Loss: 0.951 Vali Acc: 0.649 Test Loss: 0.951 Test Acc: 0.649
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm8_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6756756756756757
model parameter : 1186276
model size : 4.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm8_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.632347345352173
Epoch: 1, Steps: 10 | Train Loss: 1.476 Vali Loss: 1.444 Vali Acc: 0.189 Test Loss: 1.444 Test Acc: 0.189
Validation loss decreased (inf --> -0.189175).  Saving model ...
Epoch: 2 cost time: 2.073493480682373
Epoch: 2, Steps: 10 | Train Loss: 1.418 Vali Loss: 1.406 Vali Acc: 0.189 Test Loss: 1.406 Test Acc: 0.189
Validation loss decreased (-0.189175 --> -0.189175).  Saving model ...
Epoch: 3 cost time: 2.275329113006592
Epoch: 3, Steps: 10 | Train Loss: 1.399 Vali Loss: 1.379 Vali Acc: 0.284 Test Loss: 1.379 Test Acc: 0.284
Validation loss decreased (-0.189175 --> -0.283770).  Saving model ...
Epoch: 4 cost time: 2.048959493637085
Epoch: 4, Steps: 10 | Train Loss: 1.332 Vali Loss: 1.358 Vali Acc: 0.297 Test Loss: 1.358 Test Acc: 0.297
Validation loss decreased (-0.283770 --> -0.297284).  Saving model ...
Epoch: 5 cost time: 2.134519338607788
Epoch: 5, Steps: 10 | Train Loss: 1.264 Vali Loss: 1.327 Vali Acc: 0.297 Test Loss: 1.327 Test Acc: 0.297
Validation loss decreased (-0.297284 --> -0.297284).  Saving model ...
Epoch: 6 cost time: 2.0497817993164062
Epoch: 6, Steps: 10 | Train Loss: 1.195 Vali Loss: 1.316 Vali Acc: 0.284 Test Loss: 1.316 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.999413251876831
Epoch: 7, Steps: 10 | Train Loss: 1.123 Vali Loss: 1.277 Vali Acc: 0.324 Test Loss: 1.277 Test Acc: 0.324
Validation loss decreased (-0.297284 --> -0.324312).  Saving model ...
Epoch: 8 cost time: 1.9473528861999512
Epoch: 8, Steps: 10 | Train Loss: 1.023 Vali Loss: 1.264 Vali Acc: 0.351 Test Loss: 1.264 Test Acc: 0.351
Validation loss decreased (-0.324312 --> -0.351339).  Saving model ...
Epoch: 9 cost time: 2.0037946701049805
Epoch: 9, Steps: 10 | Train Loss: 0.940 Vali Loss: 1.234 Vali Acc: 0.405 Test Loss: 1.234 Test Acc: 0.405
Validation loss decreased (-0.351339 --> -0.405393).  Saving model ...
Epoch: 10 cost time: 1.762688159942627
Epoch: 10, Steps: 10 | Train Loss: 0.867 Vali Loss: 1.208 Vali Acc: 0.419 Test Loss: 1.208 Test Acc: 0.419
Validation loss decreased (-0.405393 --> -0.418907).  Saving model ...
Epoch: 11 cost time: 2.246464490890503
Epoch: 11, Steps: 10 | Train Loss: 0.769 Vali Loss: 1.173 Vali Acc: 0.432 Test Loss: 1.173 Test Acc: 0.432
Validation loss decreased (-0.418907 --> -0.432421).  Saving model ...
Epoch: 12 cost time: 1.9682154655456543
Epoch: 12, Steps: 10 | Train Loss: 0.703 Vali Loss: 1.143 Vali Acc: 0.486 Test Loss: 1.143 Test Acc: 0.486
Validation loss decreased (-0.432421 --> -0.486475).  Saving model ...
Epoch: 13 cost time: 1.9595270156860352
Epoch: 13, Steps: 10 | Train Loss: 0.650 Vali Loss: 1.138 Vali Acc: 0.500 Test Loss: 1.138 Test Acc: 0.500
Validation loss decreased (-0.486475 --> -0.499989).  Saving model ...
Epoch: 14 cost time: 1.9220361709594727
Epoch: 14, Steps: 10 | Train Loss: 0.591 Vali Loss: 1.102 Vali Acc: 0.500 Test Loss: 1.102 Test Acc: 0.500
Validation loss decreased (-0.499989 --> -0.499989).  Saving model ...
Epoch: 15 cost time: 2.0660159587860107
Epoch: 15, Steps: 10 | Train Loss: 0.491 Vali Loss: 1.091 Vali Acc: 0.554 Test Loss: 1.091 Test Acc: 0.554
Validation loss decreased (-0.499989 --> -0.554043).  Saving model ...
Epoch: 16 cost time: 2.20094895362854
Epoch: 16, Steps: 10 | Train Loss: 0.451 Vali Loss: 1.058 Vali Acc: 0.514 Test Loss: 1.058 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.141181468963623
Epoch: 17, Steps: 10 | Train Loss: 0.391 Vali Loss: 1.070 Vali Acc: 0.541 Test Loss: 1.070 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.198552370071411
Epoch: 18, Steps: 10 | Train Loss: 0.344 Vali Loss: 1.071 Vali Acc: 0.500 Test Loss: 1.071 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.1062164306640625
Epoch: 19, Steps: 10 | Train Loss: 0.274 Vali Loss: 1.059 Vali Acc: 0.527 Test Loss: 1.059 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.125645160675049
Epoch: 20, Steps: 10 | Train Loss: 0.247 Vali Loss: 1.051 Vali Acc: 0.554 Test Loss: 1.051 Test Acc: 0.554
Validation loss decreased (-0.554043 --> -0.554044).  Saving model ...
Epoch: 21 cost time: 2.1558871269226074
Epoch: 21, Steps: 10 | Train Loss: 0.221 Vali Loss: 1.034 Vali Acc: 0.500 Test Loss: 1.034 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.19020414352417
Epoch: 22, Steps: 10 | Train Loss: 0.172 Vali Loss: 1.044 Vali Acc: 0.541 Test Loss: 1.044 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.145991325378418
Epoch: 23, Steps: 10 | Train Loss: 0.155 Vali Loss: 1.059 Vali Acc: 0.514 Test Loss: 1.059 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.316012382507324
Epoch: 24, Steps: 10 | Train Loss: 0.143 Vali Loss: 1.059 Vali Acc: 0.541 Test Loss: 1.059 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.1795201301574707
Epoch: 25, Steps: 10 | Train Loss: 0.126 Vali Loss: 1.049 Vali Acc: 0.541 Test Loss: 1.049 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.5185372829437256
Epoch: 26, Steps: 10 | Train Loss: 0.115 Vali Loss: 1.063 Vali Acc: 0.527 Test Loss: 1.063 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.20115327835083
Epoch: 27, Steps: 10 | Train Loss: 0.094 Vali Loss: 1.052 Vali Acc: 0.527 Test Loss: 1.052 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.194831609725952
Epoch: 28, Steps: 10 | Train Loss: 0.090 Vali Loss: 1.058 Vali Acc: 0.486 Test Loss: 1.058 Test Acc: 0.486
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.186471939086914
Epoch: 29, Steps: 10 | Train Loss: 0.077 Vali Loss: 1.062 Vali Acc: 0.514 Test Loss: 1.062 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 2.1619086265563965
Epoch: 30, Steps: 10 | Train Loss: 0.069 Vali Loss: 1.066 Vali Acc: 0.554 Test Loss: 1.066 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm8_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 358308
model size : 1.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm8_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.705873012542725
Epoch: 1, Steps: 10 | Train Loss: 1.465 Vali Loss: 1.408 Vali Acc: 0.257 Test Loss: 1.408 Test Acc: 0.257
Validation loss decreased (inf --> -0.256743).  Saving model ...
Epoch: 2 cost time: 3.642186403274536
Epoch: 2, Steps: 10 | Train Loss: 1.431 Vali Loss: 1.394 Vali Acc: 0.270 Test Loss: 1.394 Test Acc: 0.270
Validation loss decreased (-0.256743 --> -0.270256).  Saving model ...
Epoch: 3 cost time: 3.5961556434631348
Epoch: 3, Steps: 10 | Train Loss: 1.348 Vali Loss: 1.392 Vali Acc: 0.284 Test Loss: 1.392 Test Acc: 0.284
Validation loss decreased (-0.270256 --> -0.283770).  Saving model ...
Epoch: 4 cost time: 3.834238052368164
Epoch: 4, Steps: 10 | Train Loss: 1.270 Vali Loss: 1.375 Vali Acc: 0.311 Test Loss: 1.375 Test Acc: 0.311
Validation loss decreased (-0.283770 --> -0.310797).  Saving model ...
Epoch: 5 cost time: 4.075839519500732
Epoch: 5, Steps: 10 | Train Loss: 1.177 Vali Loss: 1.338 Vali Acc: 0.338 Test Loss: 1.338 Test Acc: 0.338
Validation loss decreased (-0.310797 --> -0.337824).  Saving model ...
Epoch: 6 cost time: 3.8239309787750244
Epoch: 6, Steps: 10 | Train Loss: 1.076 Vali Loss: 1.313 Vali Acc: 0.365 Test Loss: 1.313 Test Acc: 0.365
Validation loss decreased (-0.337824 --> -0.364852).  Saving model ...
Epoch: 7 cost time: 3.555751323699951
Epoch: 7, Steps: 10 | Train Loss: 0.987 Vali Loss: 1.279 Vali Acc: 0.405 Test Loss: 1.279 Test Acc: 0.405
Validation loss decreased (-0.364852 --> -0.405393).  Saving model ...
Epoch: 8 cost time: 3.740436315536499
Epoch: 8, Steps: 10 | Train Loss: 0.882 Vali Loss: 1.266 Vali Acc: 0.378 Test Loss: 1.266 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.7595677375793457
Epoch: 9, Steps: 10 | Train Loss: 0.794 Vali Loss: 1.239 Vali Acc: 0.459 Test Loss: 1.239 Test Acc: 0.459
Validation loss decreased (-0.405393 --> -0.459447).  Saving model ...
Epoch: 10 cost time: 4.1010518074035645
Epoch: 10, Steps: 10 | Train Loss: 0.696 Vali Loss: 1.181 Vali Acc: 0.486 Test Loss: 1.181 Test Acc: 0.486
Validation loss decreased (-0.459447 --> -0.486475).  Saving model ...
Epoch: 11 cost time: 3.7017626762390137
Epoch: 11, Steps: 10 | Train Loss: 0.599 Vali Loss: 1.162 Vali Acc: 0.446 Test Loss: 1.162 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.947098970413208
Epoch: 12, Steps: 10 | Train Loss: 0.478 Vali Loss: 1.162 Vali Acc: 0.446 Test Loss: 1.162 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.929558038711548
Epoch: 13, Steps: 10 | Train Loss: 0.390 Vali Loss: 1.083 Vali Acc: 0.554 Test Loss: 1.083 Test Acc: 0.554
Validation loss decreased (-0.486475 --> -0.554043).  Saving model ...
Epoch: 14 cost time: 3.927084445953369
Epoch: 14, Steps: 10 | Train Loss: 0.333 Vali Loss: 1.079 Vali Acc: 0.459 Test Loss: 1.079 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.027730464935303
Epoch: 15, Steps: 10 | Train Loss: 0.257 Vali Loss: 1.023 Vali Acc: 0.541 Test Loss: 1.023 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.8147289752960205
Epoch: 16, Steps: 10 | Train Loss: 0.206 Vali Loss: 0.982 Vali Acc: 0.541 Test Loss: 0.982 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.5725245475769043
Epoch: 17, Steps: 10 | Train Loss: 0.187 Vali Loss: 0.987 Vali Acc: 0.541 Test Loss: 0.987 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 4.22408390045166
Epoch: 18, Steps: 10 | Train Loss: 0.133 Vali Loss: 0.996 Vali Acc: 0.554 Test Loss: 0.996 Test Acc: 0.554
Validation loss decreased (-0.554043 --> -0.554044).  Saving model ...
Epoch: 19 cost time: 4.358232736587524
Epoch: 19, Steps: 10 | Train Loss: 0.106 Vali Loss: 1.000 Vali Acc: 0.541 Test Loss: 1.000 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.410588026046753
Epoch: 20, Steps: 10 | Train Loss: 0.092 Vali Loss: 0.998 Vali Acc: 0.581 Test Loss: 0.998 Test Acc: 0.581
Validation loss decreased (-0.554044 --> -0.581071).  Saving model ...
Epoch: 21 cost time: 4.171229362487793
Epoch: 21, Steps: 10 | Train Loss: 0.082 Vali Loss: 0.941 Vali Acc: 0.608 Test Loss: 0.941 Test Acc: 0.608
Validation loss decreased (-0.581071 --> -0.608099).  Saving model ...
Epoch: 22 cost time: 4.139686584472656
Epoch: 22, Steps: 10 | Train Loss: 0.067 Vali Loss: 0.963 Vali Acc: 0.622 Test Loss: 0.963 Test Acc: 0.622
Validation loss decreased (-0.608099 --> -0.621612).  Saving model ...
Epoch: 23 cost time: 4.1003029346466064
Epoch: 23, Steps: 10 | Train Loss: 0.058 Vali Loss: 0.987 Vali Acc: 0.581 Test Loss: 0.987 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 4.360357999801636
Epoch: 24, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.988 Vali Acc: 0.608 Test Loss: 0.988 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 4.330984115600586
Epoch: 25, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.973 Vali Acc: 0.581 Test Loss: 0.973 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 4.319607734680176
Epoch: 26, Steps: 10 | Train Loss: 0.044 Vali Loss: 1.056 Vali Acc: 0.662 Test Loss: 1.056 Test Acc: 0.662
Validation loss decreased (-0.621612 --> -0.662152).  Saving model ...
Epoch: 27 cost time: 4.1278111934661865
Epoch: 27, Steps: 10 | Train Loss: 0.041 Vali Loss: 1.009 Vali Acc: 0.635 Test Loss: 1.009 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 4.145878076553345
Epoch: 28, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.000 Vali Acc: 0.622 Test Loss: 1.000 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 4.200687646865845
Epoch: 29, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.996 Vali Acc: 0.608 Test Loss: 0.996 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.994696855545044
Epoch: 30, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.042 Vali Acc: 0.622 Test Loss: 1.042 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm8_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6621621621621622
model parameter : 599780
model size : 2.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm8_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.241611480712891
Epoch: 1, Steps: 10 | Train Loss: 1.456 Vali Loss: 1.368 Vali Acc: 0.311 Test Loss: 1.368 Test Acc: 0.311
Validation loss decreased (inf --> -0.310797).  Saving model ...
Epoch: 2 cost time: 2.7239418029785156
Epoch: 2, Steps: 10 | Train Loss: 1.428 Vali Loss: 1.347 Vali Acc: 0.297 Test Loss: 1.347 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.5275063514709473
Epoch: 3, Steps: 10 | Train Loss: 1.373 Vali Loss: 1.329 Vali Acc: 0.311 Test Loss: 1.329 Test Acc: 0.311
Validation loss decreased (-0.310797 --> -0.310798).  Saving model ...
Epoch: 4 cost time: 2.3849430084228516
Epoch: 4, Steps: 10 | Train Loss: 1.298 Vali Loss: 1.300 Vali Acc: 0.405 Test Loss: 1.300 Test Acc: 0.405
Validation loss decreased (-0.310798 --> -0.405392).  Saving model ...
Epoch: 5 cost time: 2.435720205307007
Epoch: 5, Steps: 10 | Train Loss: 1.240 Vali Loss: 1.283 Vali Acc: 0.392 Test Loss: 1.283 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.4694695472717285
Epoch: 6, Steps: 10 | Train Loss: 1.137 Vali Loss: 1.258 Vali Acc: 0.392 Test Loss: 1.258 Test Acc: 0.392
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.440899610519409
Epoch: 7, Steps: 10 | Train Loss: 1.085 Vali Loss: 1.235 Vali Acc: 0.378 Test Loss: 1.235 Test Acc: 0.378
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.22383189201355
Epoch: 8, Steps: 10 | Train Loss: 0.986 Vali Loss: 1.221 Vali Acc: 0.419 Test Loss: 1.221 Test Acc: 0.419
Validation loss decreased (-0.405392 --> -0.418907).  Saving model ...
Epoch: 9 cost time: 2.374131679534912
Epoch: 9, Steps: 10 | Train Loss: 0.916 Vali Loss: 1.185 Vali Acc: 0.500 Test Loss: 1.185 Test Acc: 0.500
Validation loss decreased (-0.418907 --> -0.499988).  Saving model ...
Epoch: 10 cost time: 2.551431179046631
Epoch: 10, Steps: 10 | Train Loss: 0.844 Vali Loss: 1.169 Vali Acc: 0.500 Test Loss: 1.169 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 11 cost time: 1.8794634342193604
Epoch: 11, Steps: 10 | Train Loss: 0.757 Vali Loss: 1.162 Vali Acc: 0.514 Test Loss: 1.162 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513502).  Saving model ...
Epoch: 12 cost time: 2.061880111694336
Epoch: 12, Steps: 10 | Train Loss: 0.671 Vali Loss: 1.127 Vali Acc: 0.527 Test Loss: 1.127 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527016).  Saving model ...
Epoch: 13 cost time: 1.910614252090454
Epoch: 13, Steps: 10 | Train Loss: 0.626 Vali Loss: 1.134 Vali Acc: 0.514 Test Loss: 1.134 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.9276657104492188
Epoch: 14, Steps: 10 | Train Loss: 0.541 Vali Loss: 1.097 Vali Acc: 0.541 Test Loss: 1.097 Test Acc: 0.541
Validation loss decreased (-0.527016 --> -0.540530).  Saving model ...
Epoch: 15 cost time: 2.726321220397949
Epoch: 15, Steps: 10 | Train Loss: 0.478 Vali Loss: 1.126 Vali Acc: 0.595 Test Loss: 1.126 Test Acc: 0.595
Validation loss decreased (-0.540530 --> -0.594583).  Saving model ...
Epoch: 16 cost time: 2.573709726333618
Epoch: 16, Steps: 10 | Train Loss: 0.403 Vali Loss: 1.076 Vali Acc: 0.568 Test Loss: 1.076 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.5237467288970947
Epoch: 17, Steps: 10 | Train Loss: 0.363 Vali Loss: 1.066 Vali Acc: 0.568 Test Loss: 1.066 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.5745928287506104
Epoch: 18, Steps: 10 | Train Loss: 0.313 Vali Loss: 1.069 Vali Acc: 0.541 Test Loss: 1.069 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.745879888534546
Epoch: 19, Steps: 10 | Train Loss: 0.237 Vali Loss: 1.062 Vali Acc: 0.514 Test Loss: 1.062 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.760617256164551
Epoch: 20, Steps: 10 | Train Loss: 0.199 Vali Loss: 1.075 Vali Acc: 0.541 Test Loss: 1.075 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.625093460083008
Epoch: 21, Steps: 10 | Train Loss: 0.178 Vali Loss: 1.051 Vali Acc: 0.554 Test Loss: 1.051 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.386871337890625
Epoch: 22, Steps: 10 | Train Loss: 0.169 Vali Loss: 1.031 Vali Acc: 0.581 Test Loss: 1.031 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.5680947303771973
Epoch: 23, Steps: 10 | Train Loss: 0.128 Vali Loss: 1.060 Vali Acc: 0.554 Test Loss: 1.060 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.615856409072876
Epoch: 24, Steps: 10 | Train Loss: 0.128 Vali Loss: 1.012 Vali Acc: 0.595 Test Loss: 1.012 Test Acc: 0.595
Validation loss decreased (-0.594583 --> -0.594584).  Saving model ...
Epoch: 25 cost time: 2.560685396194458
Epoch: 25, Steps: 10 | Train Loss: 0.110 Vali Loss: 1.014 Vali Acc: 0.554 Test Loss: 1.014 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.6614084243774414
Epoch: 26, Steps: 10 | Train Loss: 0.109 Vali Loss: 1.002 Vali Acc: 0.608 Test Loss: 1.002 Test Acc: 0.608
Validation loss decreased (-0.594584 --> -0.608098).  Saving model ...
Epoch: 27 cost time: 2.0692365169525146
Epoch: 27, Steps: 10 | Train Loss: 0.077 Vali Loss: 1.037 Vali Acc: 0.608 Test Loss: 1.037 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.4440882205963135
Epoch: 28, Steps: 10 | Train Loss: 0.069 Vali Loss: 1.045 Vali Acc: 0.608 Test Loss: 1.045 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.452019453048706
Epoch: 29, Steps: 10 | Train Loss: 0.064 Vali Loss: 1.007 Vali Acc: 0.595 Test Loss: 1.007 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.386970281600952
Epoch: 30, Steps: 10 | Train Loss: 0.067 Vali Loss: 1.070 Vali Acc: 0.581 Test Loss: 1.070 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm8_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 185764
model size : 0.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm8_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.196213245391846
Epoch: 1, Steps: 10 | Train Loss: 1.461 Vali Loss: 1.409 Vali Acc: 0.243 Test Loss: 1.409 Test Acc: 0.243
Validation loss decreased (inf --> -0.243229).  Saving model ...
Epoch: 2 cost time: 3.3264808654785156
Epoch: 2, Steps: 10 | Train Loss: 1.426 Vali Loss: 1.396 Vali Acc: 0.257 Test Loss: 1.396 Test Acc: 0.257
Validation loss decreased (-0.243229 --> -0.256743).  Saving model ...
Epoch: 3 cost time: 3.2971138954162598
Epoch: 3, Steps: 10 | Train Loss: 1.343 Vali Loss: 1.394 Vali Acc: 0.270 Test Loss: 1.394 Test Acc: 0.270
Validation loss decreased (-0.256743 --> -0.270256).  Saving model ...
Epoch: 4 cost time: 3.3082830905914307
Epoch: 4, Steps: 10 | Train Loss: 1.268 Vali Loss: 1.377 Vali Acc: 0.270 Test Loss: 1.377 Test Acc: 0.270
Validation loss decreased (-0.270256 --> -0.270256).  Saving model ...
Epoch: 5 cost time: 2.857499837875366
Epoch: 5, Steps: 10 | Train Loss: 1.178 Vali Loss: 1.341 Vali Acc: 0.338 Test Loss: 1.341 Test Acc: 0.338
Validation loss decreased (-0.270256 --> -0.337824).  Saving model ...
Epoch: 6 cost time: 3.7531111240386963
Epoch: 6, Steps: 10 | Train Loss: 1.068 Vali Loss: 1.315 Vali Acc: 0.351 Test Loss: 1.315 Test Acc: 0.351
Validation loss decreased (-0.337824 --> -0.351338).  Saving model ...
Epoch: 7 cost time: 3.4477577209472656
Epoch: 7, Steps: 10 | Train Loss: 0.986 Vali Loss: 1.280 Vali Acc: 0.392 Test Loss: 1.280 Test Acc: 0.392
Validation loss decreased (-0.351338 --> -0.391879).  Saving model ...
Epoch: 8 cost time: 3.3946568965911865
Epoch: 8, Steps: 10 | Train Loss: 0.865 Vali Loss: 1.260 Vali Acc: 0.405 Test Loss: 1.260 Test Acc: 0.405
Validation loss decreased (-0.391879 --> -0.405393).  Saving model ...
Epoch: 9 cost time: 3.3541343212127686
Epoch: 9, Steps: 10 | Train Loss: 0.772 Vali Loss: 1.237 Vali Acc: 0.459 Test Loss: 1.237 Test Acc: 0.459
Validation loss decreased (-0.405393 --> -0.459447).  Saving model ...
Epoch: 10 cost time: 3.4757394790649414
Epoch: 10, Steps: 10 | Train Loss: 0.672 Vali Loss: 1.171 Vali Acc: 0.500 Test Loss: 1.171 Test Acc: 0.500
Validation loss decreased (-0.459447 --> -0.499988).  Saving model ...
Epoch: 11 cost time: 3.2860419750213623
Epoch: 11, Steps: 10 | Train Loss: 0.568 Vali Loss: 1.145 Vali Acc: 0.486 Test Loss: 1.145 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.5210916996002197
Epoch: 12, Steps: 10 | Train Loss: 0.455 Vali Loss: 1.125 Vali Acc: 0.500 Test Loss: 1.125 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499989).  Saving model ...
Epoch: 13 cost time: 3.359037160873413
Epoch: 13, Steps: 10 | Train Loss: 0.360 Vali Loss: 1.063 Vali Acc: 0.554 Test Loss: 1.063 Test Acc: 0.554
Validation loss decreased (-0.499989 --> -0.554043).  Saving model ...
Epoch: 14 cost time: 3.125290870666504
Epoch: 14, Steps: 10 | Train Loss: 0.311 Vali Loss: 1.033 Vali Acc: 0.541 Test Loss: 1.033 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.5950987339019775
Epoch: 15, Steps: 10 | Train Loss: 0.236 Vali Loss: 1.007 Vali Acc: 0.608 Test Loss: 1.007 Test Acc: 0.608
Validation loss decreased (-0.554043 --> -0.608098).  Saving model ...
Epoch: 16 cost time: 1.7519276142120361
Epoch: 16, Steps: 10 | Train Loss: 0.194 Vali Loss: 0.990 Vali Acc: 0.595 Test Loss: 0.990 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.770456552505493
Epoch: 17, Steps: 10 | Train Loss: 0.156 Vali Loss: 0.966 Vali Acc: 0.581 Test Loss: 0.966 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.619582176208496
Epoch: 18, Steps: 10 | Train Loss: 0.114 Vali Loss: 0.987 Vali Acc: 0.622 Test Loss: 0.987 Test Acc: 0.622
Validation loss decreased (-0.608098 --> -0.621612).  Saving model ...
Epoch: 19 cost time: 3.4751970767974854
Epoch: 19, Steps: 10 | Train Loss: 0.095 Vali Loss: 0.981 Vali Acc: 0.595 Test Loss: 0.981 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.5170323848724365
Epoch: 20, Steps: 10 | Train Loss: 0.080 Vali Loss: 0.995 Vali Acc: 0.608 Test Loss: 0.995 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.5831029415130615
Epoch: 21, Steps: 10 | Train Loss: 0.064 Vali Loss: 0.964 Vali Acc: 0.622 Test Loss: 0.964 Test Acc: 0.622
Validation loss decreased (-0.621612 --> -0.621612).  Saving model ...
Epoch: 22 cost time: 3.3733158111572266
Epoch: 22, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.990 Vali Acc: 0.608 Test Loss: 0.990 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.6994776725769043
Epoch: 23, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.971 Vali Acc: 0.622 Test Loss: 0.971 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.620659589767456
Epoch: 24, Steps: 10 | Train Loss: 0.037 Vali Loss: 1.030 Vali Acc: 0.595 Test Loss: 1.030 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.446934223175049
Epoch: 25, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.993 Vali Acc: 0.622 Test Loss: 0.993 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.441524028778076
Epoch: 26, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.012 Vali Acc: 0.608 Test Loss: 1.012 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 3.758213520050049
Epoch: 27, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.023 Vali Acc: 0.622 Test Loss: 1.023 Test Acc: 0.622
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 3.873258590698242
Epoch: 28, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.994 Vali Acc: 0.635 Test Loss: 0.994 Test Acc: 0.635
Validation loss decreased (-0.621612 --> -0.635125).  Saving model ...
Epoch: 29 cost time: 3.8384716510772705
Epoch: 29, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.036 Vali Acc: 0.649 Test Loss: 1.036 Test Acc: 0.649
Validation loss decreased (-0.635125 --> -0.648638).  Saving model ...
Epoch: 30 cost time: 3.653197765350342
Epoch: 30, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.027 Vali Acc: 0.635 Test Loss: 1.027 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm8_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6486486486486487
model parameter : 599780
model size : 2.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm8_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.8128786087036133
Epoch: 1, Steps: 10 | Train Loss: 1.452 Vali Loss: 1.367 Vali Acc: 0.311 Test Loss: 1.367 Test Acc: 0.311
Validation loss decreased (inf --> -0.310797).  Saving model ...
Epoch: 2 cost time: 2.241145372390747
Epoch: 2, Steps: 10 | Train Loss: 1.425 Vali Loss: 1.345 Vali Acc: 0.297 Test Loss: 1.345 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.2275142669677734
Epoch: 3, Steps: 10 | Train Loss: 1.370 Vali Loss: 1.327 Vali Acc: 0.311 Test Loss: 1.327 Test Acc: 0.311
Validation loss decreased (-0.310797 --> -0.310798).  Saving model ...
Epoch: 4 cost time: 2.1814701557159424
Epoch: 4, Steps: 10 | Train Loss: 1.296 Vali Loss: 1.300 Vali Acc: 0.419 Test Loss: 1.300 Test Acc: 0.419
Validation loss decreased (-0.310798 --> -0.418906).  Saving model ...
Epoch: 5 cost time: 1.7030107975006104
Epoch: 5, Steps: 10 | Train Loss: 1.234 Vali Loss: 1.284 Vali Acc: 0.405 Test Loss: 1.284 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.318769693374634
Epoch: 6, Steps: 10 | Train Loss: 1.130 Vali Loss: 1.262 Vali Acc: 0.432 Test Loss: 1.262 Test Acc: 0.432
Validation loss decreased (-0.418906 --> -0.432420).  Saving model ...
Epoch: 7 cost time: 2.3488805294036865
Epoch: 7, Steps: 10 | Train Loss: 1.080 Vali Loss: 1.241 Vali Acc: 0.419 Test Loss: 1.241 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.214674949645996
Epoch: 8, Steps: 10 | Train Loss: 0.978 Vali Loss: 1.228 Vali Acc: 0.419 Test Loss: 1.228 Test Acc: 0.419
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.1747100353240967
Epoch: 9, Steps: 10 | Train Loss: 0.900 Vali Loss: 1.195 Vali Acc: 0.459 Test Loss: 1.195 Test Acc: 0.459
Validation loss decreased (-0.432420 --> -0.459448).  Saving model ...
Epoch: 10 cost time: 2.0803263187408447
Epoch: 10, Steps: 10 | Train Loss: 0.835 Vali Loss: 1.180 Vali Acc: 0.459 Test Loss: 1.180 Test Acc: 0.459
Validation loss decreased (-0.459448 --> -0.459448).  Saving model ...
Epoch: 11 cost time: 2.177276134490967
Epoch: 11, Steps: 10 | Train Loss: 0.743 Vali Loss: 1.172 Vali Acc: 0.486 Test Loss: 1.172 Test Acc: 0.486
Validation loss decreased (-0.459448 --> -0.486475).  Saving model ...
Epoch: 12 cost time: 2.193692445755005
Epoch: 12, Steps: 10 | Train Loss: 0.663 Vali Loss: 1.149 Vali Acc: 0.486 Test Loss: 1.149 Test Acc: 0.486
Validation loss decreased (-0.486475 --> -0.486475).  Saving model ...
Epoch: 13 cost time: 2.255768060684204
Epoch: 13, Steps: 10 | Train Loss: 0.602 Vali Loss: 1.150 Vali Acc: 0.514 Test Loss: 1.150 Test Acc: 0.514
Validation loss decreased (-0.486475 --> -0.513502).  Saving model ...
Epoch: 14 cost time: 2.2317495346069336
Epoch: 14, Steps: 10 | Train Loss: 0.522 Vali Loss: 1.116 Vali Acc: 0.446 Test Loss: 1.116 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.3124990463256836
Epoch: 15, Steps: 10 | Train Loss: 0.478 Vali Loss: 1.119 Vali Acc: 0.500 Test Loss: 1.119 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.142019033432007
Epoch: 16, Steps: 10 | Train Loss: 0.404 Vali Loss: 1.094 Vali Acc: 0.473 Test Loss: 1.094 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.062180995941162
Epoch: 17, Steps: 10 | Train Loss: 0.357 Vali Loss: 1.073 Vali Acc: 0.595 Test Loss: 1.073 Test Acc: 0.595
Validation loss decreased (-0.513502 --> -0.594584).  Saving model ...
Epoch: 18 cost time: 2.2708592414855957
Epoch: 18, Steps: 10 | Train Loss: 0.295 Vali Loss: 1.064 Vali Acc: 0.568 Test Loss: 1.064 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.211421251296997
Epoch: 19, Steps: 10 | Train Loss: 0.241 Vali Loss: 1.044 Vali Acc: 0.568 Test Loss: 1.044 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.052896022796631
Epoch: 20, Steps: 10 | Train Loss: 0.203 Vali Loss: 1.083 Vali Acc: 0.568 Test Loss: 1.083 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.1167490482330322
Epoch: 21, Steps: 10 | Train Loss: 0.178 Vali Loss: 1.035 Vali Acc: 0.595 Test Loss: 1.035 Test Acc: 0.595
Validation loss decreased (-0.594584 --> -0.594584).  Saving model ...
Epoch: 22 cost time: 2.121276378631592
Epoch: 22, Steps: 10 | Train Loss: 0.169 Vali Loss: 1.002 Vali Acc: 0.581 Test Loss: 1.002 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.1553220748901367
Epoch: 23, Steps: 10 | Train Loss: 0.137 Vali Loss: 1.052 Vali Acc: 0.622 Test Loss: 1.052 Test Acc: 0.622
Validation loss decreased (-0.594584 --> -0.621611).  Saving model ...
Epoch: 24 cost time: 2.1515841484069824
Epoch: 24, Steps: 10 | Train Loss: 0.124 Vali Loss: 1.022 Vali Acc: 0.608 Test Loss: 1.022 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.1836323738098145
Epoch: 25, Steps: 10 | Train Loss: 0.100 Vali Loss: 1.029 Vali Acc: 0.595 Test Loss: 1.029 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.191547393798828
Epoch: 26, Steps: 10 | Train Loss: 0.095 Vali Loss: 1.048 Vali Acc: 0.595 Test Loss: 1.048 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.206965446472168
Epoch: 27, Steps: 10 | Train Loss: 0.075 Vali Loss: 1.045 Vali Acc: 0.608 Test Loss: 1.045 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.1799838542938232
Epoch: 28, Steps: 10 | Train Loss: 0.069 Vali Loss: 1.028 Vali Acc: 0.622 Test Loss: 1.028 Test Acc: 0.622
Validation loss decreased (-0.621611 --> -0.621611).  Saving model ...
Epoch: 29 cost time: 2.1950464248657227
Epoch: 29, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.996 Vali Acc: 0.608 Test Loss: 0.996 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.6587064266204834
Epoch: 30, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.971 Vali Acc: 0.608 Test Loss: 0.971 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm8_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 185764
model size : 0.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm8_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.8204357624053955
Epoch: 1, Steps: 10 | Train Loss: 1.466 Vali Loss: 1.399 Vali Acc: 0.243 Test Loss: 1.399 Test Acc: 0.243
Validation loss decreased (inf --> -0.243229).  Saving model ...
Epoch: 2 cost time: 2.3051507472991943
Epoch: 2, Steps: 10 | Train Loss: 1.428 Vali Loss: 1.381 Vali Acc: 0.243 Test Loss: 1.381 Test Acc: 0.243
Validation loss decreased (-0.243229 --> -0.243229).  Saving model ...
Epoch: 3 cost time: 2.2036733627319336
Epoch: 3, Steps: 10 | Train Loss: 1.350 Vali Loss: 1.375 Vali Acc: 0.270 Test Loss: 1.375 Test Acc: 0.270
Validation loss decreased (-0.243229 --> -0.270257).  Saving model ...
Epoch: 4 cost time: 2.424021005630493
Epoch: 4, Steps: 10 | Train Loss: 1.276 Vali Loss: 1.350 Vali Acc: 0.338 Test Loss: 1.350 Test Acc: 0.338
Validation loss decreased (-0.270257 --> -0.337824).  Saving model ...
Epoch: 5 cost time: 2.541897773742676
Epoch: 5, Steps: 10 | Train Loss: 1.207 Vali Loss: 1.311 Vali Acc: 0.365 Test Loss: 1.311 Test Acc: 0.365
Validation loss decreased (-0.337824 --> -0.364852).  Saving model ...
Epoch: 6 cost time: 2.2061548233032227
Epoch: 6, Steps: 10 | Train Loss: 1.104 Vali Loss: 1.279 Vali Acc: 0.405 Test Loss: 1.279 Test Acc: 0.405
Validation loss decreased (-0.364852 --> -0.405393).  Saving model ...
Epoch: 7 cost time: 2.2616617679595947
Epoch: 7, Steps: 10 | Train Loss: 1.040 Vali Loss: 1.248 Vali Acc: 0.473 Test Loss: 1.248 Test Acc: 0.473
Validation loss decreased (-0.405393 --> -0.472960).  Saving model ...
Epoch: 8 cost time: 2.5131990909576416
Epoch: 8, Steps: 10 | Train Loss: 0.951 Vali Loss: 1.230 Vali Acc: 0.392 Test Loss: 1.230 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.7054243087768555
Epoch: 9, Steps: 10 | Train Loss: 0.871 Vali Loss: 1.196 Vali Acc: 0.432 Test Loss: 1.196 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.158942699432373
Epoch: 10, Steps: 10 | Train Loss: 0.792 Vali Loss: 1.137 Vali Acc: 0.514 Test Loss: 1.137 Test Acc: 0.514
Validation loss decreased (-0.472960 --> -0.513502).  Saving model ...
Epoch: 11 cost time: 2.418973922729492
Epoch: 11, Steps: 10 | Train Loss: 0.655 Vali Loss: 1.106 Vali Acc: 0.486 Test Loss: 1.106 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.438530921936035
Epoch: 12, Steps: 10 | Train Loss: 0.543 Vali Loss: 1.062 Vali Acc: 0.554 Test Loss: 1.062 Test Acc: 0.554
Validation loss decreased (-0.513502 --> -0.554043).  Saving model ...
Epoch: 13 cost time: 2.386134386062622
Epoch: 13, Steps: 10 | Train Loss: 0.495 Vali Loss: 1.007 Vali Acc: 0.568 Test Loss: 1.007 Test Acc: 0.568
Validation loss decreased (-0.554043 --> -0.567557).  Saving model ...
Epoch: 14 cost time: 2.2375755310058594
Epoch: 14, Steps: 10 | Train Loss: 0.429 Vali Loss: 1.011 Vali Acc: 0.581 Test Loss: 1.011 Test Acc: 0.581
Validation loss decreased (-0.567557 --> -0.581071).  Saving model ...
Epoch: 15 cost time: 2.329118490219116
Epoch: 15, Steps: 10 | Train Loss: 0.316 Vali Loss: 0.945 Vali Acc: 0.649 Test Loss: 0.945 Test Acc: 0.649
Validation loss decreased (-0.581071 --> -0.648639).  Saving model ...
Epoch: 16 cost time: 2.4387431144714355
Epoch: 16, Steps: 10 | Train Loss: 0.257 Vali Loss: 0.934 Vali Acc: 0.635 Test Loss: 0.934 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.2921721935272217
Epoch: 17, Steps: 10 | Train Loss: 0.196 Vali Loss: 0.928 Vali Acc: 0.581 Test Loss: 0.928 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.3213536739349365
Epoch: 18, Steps: 10 | Train Loss: 0.203 Vali Loss: 0.951 Vali Acc: 0.581 Test Loss: 0.951 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.32026743888855
Epoch: 19, Steps: 10 | Train Loss: 0.155 Vali Loss: 0.890 Vali Acc: 0.622 Test Loss: 0.890 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.4900200366973877
Epoch: 20, Steps: 10 | Train Loss: 0.145 Vali Loss: 0.917 Vali Acc: 0.622 Test Loss: 0.917 Test Acc: 0.622
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.2929463386535645
Epoch: 21, Steps: 10 | Train Loss: 0.123 Vali Loss: 0.922 Vali Acc: 0.608 Test Loss: 0.922 Test Acc: 0.608
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.3573246002197266
Epoch: 22, Steps: 10 | Train Loss: 0.103 Vali Loss: 0.911 Vali Acc: 0.635 Test Loss: 0.911 Test Acc: 0.635
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.635272741317749
Epoch: 23, Steps: 10 | Train Loss: 0.081 Vali Loss: 0.934 Vali Acc: 0.622 Test Loss: 0.934 Test Acc: 0.622
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.6324117183685303
Epoch: 24, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.979 Vali Acc: 0.595 Test Loss: 0.979 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.3353469371795654
Epoch: 25, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.928 Vali Acc: 0.649 Test Loss: 0.928 Test Acc: 0.649
Validation loss decreased (-0.648639 --> -0.648639).  Saving model ...
Epoch: 26 cost time: 2.444725275039673
Epoch: 26, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.942 Vali Acc: 0.635 Test Loss: 0.942 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.442317485809326
Epoch: 27, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.935 Vali Acc: 0.662 Test Loss: 0.935 Test Acc: 0.662
Validation loss decreased (-0.648639 --> -0.662153).  Saving model ...
Epoch: 28 cost time: 2.600064754486084
Epoch: 28, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.978 Vali Acc: 0.662 Test Loss: 0.978 Test Acc: 0.662
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.60202693939209
Epoch: 29, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.007 Vali Acc: 0.635 Test Loss: 1.007 Test Acc: 0.635
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.7735109329223633
Epoch: 30, Steps: 10 | Train Loss: 0.058 Vali Loss: 0.958 Vali Acc: 0.649 Test Loss: 0.958 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm8_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6621621621621622
model parameter : 599780
model size : 2.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm8_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.1302475929260254
Epoch: 1, Steps: 10 | Train Loss: 1.458 Vali Loss: 1.378 Vali Acc: 0.324 Test Loss: 1.378 Test Acc: 0.324
Validation loss decreased (inf --> -0.324311).  Saving model ...
Epoch: 2 cost time: 1.638798475265503
Epoch: 2, Steps: 10 | Train Loss: 1.431 Vali Loss: 1.356 Vali Acc: 0.311 Test Loss: 1.356 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7168638706207275
Epoch: 3, Steps: 10 | Train Loss: 1.379 Vali Loss: 1.337 Vali Acc: 0.324 Test Loss: 1.337 Test Acc: 0.324
Validation loss decreased (-0.324311 --> -0.324311).  Saving model ...
Epoch: 4 cost time: 1.558788537979126
Epoch: 4, Steps: 10 | Train Loss: 1.313 Vali Loss: 1.308 Vali Acc: 0.392 Test Loss: 1.308 Test Acc: 0.392
Validation loss decreased (-0.324311 --> -0.391879).  Saving model ...
Epoch: 5 cost time: 1.8780357837677002
Epoch: 5, Steps: 10 | Train Loss: 1.261 Vali Loss: 1.289 Vali Acc: 0.392 Test Loss: 1.289 Test Acc: 0.392
Validation loss decreased (-0.391879 --> -0.391879).  Saving model ...
Epoch: 6 cost time: 1.953117847442627
Epoch: 6, Steps: 10 | Train Loss: 1.166 Vali Loss: 1.265 Vali Acc: 0.392 Test Loss: 1.265 Test Acc: 0.392
Validation loss decreased (-0.391879 --> -0.391879).  Saving model ...
Epoch: 7 cost time: 1.963545322418213
Epoch: 7, Steps: 10 | Train Loss: 1.126 Vali Loss: 1.243 Vali Acc: 0.365 Test Loss: 1.243 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7768962383270264
Epoch: 8, Steps: 10 | Train Loss: 1.034 Vali Loss: 1.231 Vali Acc: 0.446 Test Loss: 1.231 Test Acc: 0.446
Validation loss decreased (-0.391879 --> -0.445934).  Saving model ...
Epoch: 9 cost time: 1.9294488430023193
Epoch: 9, Steps: 10 | Train Loss: 0.959 Vali Loss: 1.186 Vali Acc: 0.514 Test Loss: 1.186 Test Acc: 0.514
Validation loss decreased (-0.445934 --> -0.513502).  Saving model ...
Epoch: 10 cost time: 2.051213264465332
Epoch: 10, Steps: 10 | Train Loss: 0.904 Vali Loss: 1.168 Vali Acc: 0.500 Test Loss: 1.168 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.0721685886383057
Epoch: 11, Steps: 10 | Train Loss: 0.819 Vali Loss: 1.162 Vali Acc: 0.500 Test Loss: 1.162 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.006887435913086
Epoch: 12, Steps: 10 | Train Loss: 0.745 Vali Loss: 1.133 Vali Acc: 0.473 Test Loss: 1.133 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.964756965637207
Epoch: 13, Steps: 10 | Train Loss: 0.686 Vali Loss: 1.128 Vali Acc: 0.500 Test Loss: 1.128 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.898909330368042
Epoch: 14, Steps: 10 | Train Loss: 0.607 Vali Loss: 1.078 Vali Acc: 0.500 Test Loss: 1.078 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.9444515705108643
Epoch: 15, Steps: 10 | Train Loss: 0.546 Vali Loss: 1.095 Vali Acc: 0.486 Test Loss: 1.095 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.9229307174682617
Epoch: 16, Steps: 10 | Train Loss: 0.474 Vali Loss: 1.049 Vali Acc: 0.486 Test Loss: 1.049 Test Acc: 0.486
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.0156772136688232
Epoch: 17, Steps: 10 | Train Loss: 0.439 Vali Loss: 1.011 Vali Acc: 0.527 Test Loss: 1.011 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527017).  Saving model ...
Epoch: 18 cost time: 1.9817843437194824
Epoch: 18, Steps: 10 | Train Loss: 0.369 Vali Loss: 0.992 Vali Acc: 0.541 Test Loss: 0.992 Test Acc: 0.541
Validation loss decreased (-0.527017 --> -0.540531).  Saving model ...
Epoch: 19 cost time: 1.9281909465789795
Epoch: 19, Steps: 10 | Train Loss: 0.308 Vali Loss: 0.972 Vali Acc: 0.527 Test Loss: 0.972 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.89625883102417
Epoch: 20, Steps: 10 | Train Loss: 0.273 Vali Loss: 0.982 Vali Acc: 0.527 Test Loss: 0.982 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.956505298614502
Epoch: 21, Steps: 10 | Train Loss: 0.222 Vali Loss: 0.937 Vali Acc: 0.608 Test Loss: 0.937 Test Acc: 0.608
Validation loss decreased (-0.540531 --> -0.608099).  Saving model ...
Epoch: 22 cost time: 1.9063048362731934
Epoch: 22, Steps: 10 | Train Loss: 0.203 Vali Loss: 0.923 Vali Acc: 0.554 Test Loss: 0.923 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.9047961235046387
Epoch: 23, Steps: 10 | Train Loss: 0.173 Vali Loss: 0.933 Vali Acc: 0.595 Test Loss: 0.933 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.136143445968628
Epoch: 24, Steps: 10 | Train Loss: 0.154 Vali Loss: 0.894 Vali Acc: 0.689 Test Loss: 0.894 Test Acc: 0.689
Validation loss decreased (-0.608099 --> -0.689180).  Saving model ...
Epoch: 25 cost time: 1.979621171951294
Epoch: 25, Steps: 10 | Train Loss: 0.128 Vali Loss: 0.905 Vali Acc: 0.608 Test Loss: 0.905 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.86476469039917
Epoch: 26, Steps: 10 | Train Loss: 0.114 Vali Loss: 0.876 Vali Acc: 0.703 Test Loss: 0.876 Test Acc: 0.703
Validation loss decreased (-0.689180 --> -0.702694).  Saving model ...
Epoch: 27 cost time: 1.9493458271026611
Epoch: 27, Steps: 10 | Train Loss: 0.096 Vali Loss: 0.897 Vali Acc: 0.608 Test Loss: 0.897 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.883387565612793
Epoch: 28, Steps: 10 | Train Loss: 0.085 Vali Loss: 0.898 Vali Acc: 0.608 Test Loss: 0.898 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.9864306449890137
Epoch: 29, Steps: 10 | Train Loss: 0.080 Vali Loss: 0.874 Vali Acc: 0.689 Test Loss: 0.874 Test Acc: 0.689
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.126868486404419
Epoch: 30, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.882 Vali Acc: 0.622 Test Loss: 0.882 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm8_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.7027027027027027
model parameter : 185764
model size : 0.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm8_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.2674620151519775
Epoch: 1, Steps: 10 | Train Loss: 1.435 Vali Loss: 1.391 Vali Acc: 0.243 Test Loss: 1.391 Test Acc: 0.243
Validation loss decreased (inf --> -0.243229).  Saving model ...
Epoch: 2 cost time: 3.2054262161254883
Epoch: 2, Steps: 10 | Train Loss: 1.367 Vali Loss: 1.366 Vali Acc: 0.270 Test Loss: 1.366 Test Acc: 0.270
Validation loss decreased (-0.243229 --> -0.270257).  Saving model ...
Epoch: 3 cost time: 3.7400898933410645
Epoch: 3, Steps: 10 | Train Loss: 1.321 Vali Loss: 1.340 Vali Acc: 0.351 Test Loss: 1.340 Test Acc: 0.351
Validation loss decreased (-0.270257 --> -0.351338).  Saving model ...
Epoch: 4 cost time: 3.77144718170166
Epoch: 4, Steps: 10 | Train Loss: 1.261 Vali Loss: 1.320 Vali Acc: 0.378 Test Loss: 1.320 Test Acc: 0.378
Validation loss decreased (-0.351338 --> -0.378365).  Saving model ...
Epoch: 5 cost time: 3.39007830619812
Epoch: 5, Steps: 10 | Train Loss: 1.186 Vali Loss: 1.314 Vali Acc: 0.405 Test Loss: 1.314 Test Acc: 0.405
Validation loss decreased (-0.378365 --> -0.405392).  Saving model ...
Epoch: 6 cost time: 3.462669849395752
Epoch: 6, Steps: 10 | Train Loss: 1.133 Vali Loss: 1.269 Vali Acc: 0.446 Test Loss: 1.269 Test Acc: 0.446
Validation loss decreased (-0.405392 --> -0.445933).  Saving model ...
Epoch: 7 cost time: 3.550163984298706
Epoch: 7, Steps: 10 | Train Loss: 1.038 Vali Loss: 1.230 Vali Acc: 0.486 Test Loss: 1.230 Test Acc: 0.486
Validation loss decreased (-0.445933 --> -0.486474).  Saving model ...
Epoch: 8 cost time: 3.169280767440796
Epoch: 8, Steps: 10 | Train Loss: 0.964 Vali Loss: 1.227 Vali Acc: 0.486 Test Loss: 1.227 Test Acc: 0.486
Validation loss decreased (-0.486474 --> -0.486474).  Saving model ...
Epoch: 9 cost time: 3.3628311157226562
Epoch: 9, Steps: 10 | Train Loss: 0.885 Vali Loss: 1.188 Vali Acc: 0.473 Test Loss: 1.188 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.3221774101257324
Epoch: 10, Steps: 10 | Train Loss: 0.803 Vali Loss: 1.177 Vali Acc: 0.486 Test Loss: 1.177 Test Acc: 0.486
Validation loss decreased (-0.486474 --> -0.486475).  Saving model ...
Epoch: 11 cost time: 3.294137954711914
Epoch: 11, Steps: 10 | Train Loss: 0.733 Vali Loss: 1.147 Vali Acc: 0.486 Test Loss: 1.147 Test Acc: 0.486
Validation loss decreased (-0.486475 --> -0.486475).  Saving model ...
Epoch: 12 cost time: 2.9972479343414307
Epoch: 12, Steps: 10 | Train Loss: 0.640 Vali Loss: 1.147 Vali Acc: 0.486 Test Loss: 1.147 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.45470929145813
Epoch: 13, Steps: 10 | Train Loss: 0.553 Vali Loss: 1.119 Vali Acc: 0.500 Test Loss: 1.119 Test Acc: 0.500
Validation loss decreased (-0.486475 --> -0.499989).  Saving model ...
Epoch: 14 cost time: 3.4519522190093994
Epoch: 14, Steps: 10 | Train Loss: 0.484 Vali Loss: 1.097 Vali Acc: 0.554 Test Loss: 1.097 Test Acc: 0.554
Validation loss decreased (-0.499989 --> -0.554043).  Saving model ...
Epoch: 15 cost time: 3.1544673442840576
Epoch: 15, Steps: 10 | Train Loss: 0.417 Vali Loss: 1.095 Vali Acc: 0.500 Test Loss: 1.095 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.280890703201294
Epoch: 16, Steps: 10 | Train Loss: 0.352 Vali Loss: 1.088 Vali Acc: 0.500 Test Loss: 1.088 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.164926052093506
Epoch: 17, Steps: 10 | Train Loss: 0.312 Vali Loss: 1.097 Vali Acc: 0.514 Test Loss: 1.097 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.088650941848755
Epoch: 18, Steps: 10 | Train Loss: 0.243 Vali Loss: 1.081 Vali Acc: 0.541 Test Loss: 1.081 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.374673366546631
Epoch: 19, Steps: 10 | Train Loss: 0.197 Vali Loss: 1.112 Vali Acc: 0.541 Test Loss: 1.112 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.312650442123413
Epoch: 20, Steps: 10 | Train Loss: 0.177 Vali Loss: 1.089 Vali Acc: 0.554 Test Loss: 1.089 Test Acc: 0.554
Validation loss decreased (-0.554043 --> -0.554043).  Saving model ...
Epoch: 21 cost time: 3.300670862197876
Epoch: 21, Steps: 10 | Train Loss: 0.157 Vali Loss: 1.085 Vali Acc: 0.527 Test Loss: 1.085 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.3006815910339355
Epoch: 22, Steps: 10 | Train Loss: 0.144 Vali Loss: 1.078 Vali Acc: 0.541 Test Loss: 1.078 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.5400969982147217
Epoch: 23, Steps: 10 | Train Loss: 0.117 Vali Loss: 1.110 Vali Acc: 0.568 Test Loss: 1.110 Test Acc: 0.568
Validation loss decreased (-0.554043 --> -0.567556).  Saving model ...
Epoch: 24 cost time: 3.267364501953125
Epoch: 24, Steps: 10 | Train Loss: 0.098 Vali Loss: 1.097 Vali Acc: 0.541 Test Loss: 1.097 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.4685897827148438
Epoch: 25, Steps: 10 | Train Loss: 0.091 Vali Loss: 1.099 Vali Acc: 0.581 Test Loss: 1.099 Test Acc: 0.581
Validation loss decreased (-0.567556 --> -0.581070).  Saving model ...
Epoch: 26 cost time: 3.2782347202301025
Epoch: 26, Steps: 10 | Train Loss: 0.080 Vali Loss: 1.112 Vali Acc: 0.568 Test Loss: 1.112 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.32951021194458
Epoch: 27, Steps: 10 | Train Loss: 0.069 Vali Loss: 1.084 Vali Acc: 0.541 Test Loss: 1.084 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.1944522857666016
Epoch: 28, Steps: 10 | Train Loss: 0.058 Vali Loss: 1.103 Vali Acc: 0.568 Test Loss: 1.103 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.990485668182373
Epoch: 29, Steps: 10 | Train Loss: 0.063 Vali Loss: 1.103 Vali Acc: 0.581 Test Loss: 1.103 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 3.53262996673584
Epoch: 30, Steps: 10 | Train Loss: 0.048 Vali Loss: 1.078 Vali Acc: 0.541 Test Loss: 1.078 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm8_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 306532
model size : 1.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm8_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.8563292026519775
Epoch: 1, Steps: 10 | Train Loss: 1.459 Vali Loss: 1.397 Vali Acc: 0.311 Test Loss: 1.397 Test Acc: 0.311
Validation loss decreased (inf --> -0.310797).  Saving model ...
Epoch: 2 cost time: 2.518935441970825
Epoch: 2, Steps: 10 | Train Loss: 1.432 Vali Loss: 1.386 Vali Acc: 0.311 Test Loss: 1.386 Test Acc: 0.311
Validation loss decreased (-0.310797 --> -0.310797).  Saving model ...
Epoch: 3 cost time: 2.4151158332824707
Epoch: 3, Steps: 10 | Train Loss: 1.401 Vali Loss: 1.383 Vali Acc: 0.311 Test Loss: 1.383 Test Acc: 0.311
Validation loss decreased (-0.310797 --> -0.310797).  Saving model ...
Epoch: 4 cost time: 2.5779571533203125
Epoch: 4, Steps: 10 | Train Loss: 1.314 Vali Loss: 1.363 Vali Acc: 0.365 Test Loss: 1.363 Test Acc: 0.365
Validation loss decreased (-0.310797 --> -0.364851).  Saving model ...
Epoch: 5 cost time: 2.2321629524230957
Epoch: 5, Steps: 10 | Train Loss: 1.281 Vali Loss: 1.324 Vali Acc: 0.365 Test Loss: 1.324 Test Acc: 0.365
Validation loss decreased (-0.364851 --> -0.364852).  Saving model ...
Epoch: 6 cost time: 2.500201463699341
Epoch: 6, Steps: 10 | Train Loss: 1.165 Vali Loss: 1.295 Vali Acc: 0.405 Test Loss: 1.295 Test Acc: 0.405
Validation loss decreased (-0.364852 --> -0.405392).  Saving model ...
Epoch: 7 cost time: 2.472320795059204
Epoch: 7, Steps: 10 | Train Loss: 1.097 Vali Loss: 1.290 Vali Acc: 0.473 Test Loss: 1.290 Test Acc: 0.473
Validation loss decreased (-0.405392 --> -0.472960).  Saving model ...
Epoch: 8 cost time: 2.550217390060425
Epoch: 8, Steps: 10 | Train Loss: 1.027 Vali Loss: 1.255 Vali Acc: 0.432 Test Loss: 1.255 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.343963384628296
Epoch: 9, Steps: 10 | Train Loss: 0.937 Vali Loss: 1.233 Vali Acc: 0.432 Test Loss: 1.233 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.272179365158081
Epoch: 10, Steps: 10 | Train Loss: 0.865 Vali Loss: 1.223 Vali Acc: 0.446 Test Loss: 1.223 Test Acc: 0.446
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.5359625816345215
Epoch: 11, Steps: 10 | Train Loss: 0.785 Vali Loss: 1.197 Vali Acc: 0.459 Test Loss: 1.197 Test Acc: 0.459
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.36861252784729
Epoch: 12, Steps: 10 | Train Loss: 0.722 Vali Loss: 1.169 Vali Acc: 0.405 Test Loss: 1.169 Test Acc: 0.405
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.5078532695770264
Epoch: 13, Steps: 10 | Train Loss: 0.624 Vali Loss: 1.175 Vali Acc: 0.486 Test Loss: 1.175 Test Acc: 0.486
Validation loss decreased (-0.472960 --> -0.486475).  Saving model ...
Epoch: 14 cost time: 2.544687509536743
Epoch: 14, Steps: 10 | Train Loss: 0.556 Vali Loss: 1.142 Vali Acc: 0.500 Test Loss: 1.142 Test Acc: 0.500
Validation loss decreased (-0.486475 --> -0.499989).  Saving model ...
Epoch: 15 cost time: 2.451549530029297
Epoch: 15, Steps: 10 | Train Loss: 0.475 Vali Loss: 1.118 Vali Acc: 0.446 Test Loss: 1.118 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.565545082092285
Epoch: 16, Steps: 10 | Train Loss: 0.404 Vali Loss: 1.106 Vali Acc: 0.486 Test Loss: 1.106 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.360050916671753
Epoch: 17, Steps: 10 | Train Loss: 0.350 Vali Loss: 1.116 Vali Acc: 0.432 Test Loss: 1.116 Test Acc: 0.432
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.6402950286865234
Epoch: 18, Steps: 10 | Train Loss: 0.281 Vali Loss: 1.057 Vali Acc: 0.446 Test Loss: 1.057 Test Acc: 0.446
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.5738117694854736
Epoch: 19, Steps: 10 | Train Loss: 0.236 Vali Loss: 1.061 Vali Acc: 0.514 Test Loss: 1.061 Test Acc: 0.514
Validation loss decreased (-0.499989 --> -0.513503).  Saving model ...
Epoch: 20 cost time: 2.44075608253479
Epoch: 20, Steps: 10 | Train Loss: 0.204 Vali Loss: 1.066 Vali Acc: 0.459 Test Loss: 1.066 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.432698965072632
Epoch: 21, Steps: 10 | Train Loss: 0.169 Vali Loss: 1.066 Vali Acc: 0.459 Test Loss: 1.066 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.5540168285369873
Epoch: 22, Steps: 10 | Train Loss: 0.148 Vali Loss: 1.049 Vali Acc: 0.486 Test Loss: 1.049 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.668562889099121
Epoch: 23, Steps: 10 | Train Loss: 0.130 Vali Loss: 1.021 Vali Acc: 0.500 Test Loss: 1.021 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.5081520080566406
Epoch: 24, Steps: 10 | Train Loss: 0.108 Vali Loss: 1.032 Vali Acc: 0.500 Test Loss: 1.032 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.520136833190918
Epoch: 25, Steps: 10 | Train Loss: 0.089 Vali Loss: 1.027 Vali Acc: 0.541 Test Loss: 1.027 Test Acc: 0.541
Validation loss decreased (-0.513503 --> -0.540530).  Saving model ...
Epoch: 26 cost time: 2.4817962646484375
Epoch: 26, Steps: 10 | Train Loss: 0.077 Vali Loss: 1.021 Vali Acc: 0.581 Test Loss: 1.021 Test Acc: 0.581
Validation loss decreased (-0.540530 --> -0.581071).  Saving model ...
Epoch: 27 cost time: 2.6195154190063477
Epoch: 27, Steps: 10 | Train Loss: 0.065 Vali Loss: 1.017 Vali Acc: 0.554 Test Loss: 1.017 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.4241576194763184
Epoch: 28, Steps: 10 | Train Loss: 0.059 Vali Loss: 1.025 Vali Acc: 0.568 Test Loss: 1.025 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.5998353958129883
Epoch: 29, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.992 Vali Acc: 0.554 Test Loss: 0.992 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.506169557571411
Epoch: 30, Steps: 10 | Train Loss: 0.054 Vali Loss: 1.024 Vali Acc: 0.581 Test Loss: 1.024 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm8_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 99492
model size : 0.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm8_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.444859743118286
Epoch: 1, Steps: 10 | Train Loss: 1.435 Vali Loss: 1.393 Vali Acc: 0.243 Test Loss: 1.393 Test Acc: 0.243
Validation loss decreased (inf --> -0.243229).  Saving model ...
Epoch: 2 cost time: 2.916553020477295
Epoch: 2, Steps: 10 | Train Loss: 1.367 Vali Loss: 1.369 Vali Acc: 0.297 Test Loss: 1.369 Test Acc: 0.297
Validation loss decreased (-0.243229 --> -0.297284).  Saving model ...
Epoch: 3 cost time: 2.8245084285736084
Epoch: 3, Steps: 10 | Train Loss: 1.320 Vali Loss: 1.343 Vali Acc: 0.365 Test Loss: 1.343 Test Acc: 0.365
Validation loss decreased (-0.297284 --> -0.364851).  Saving model ...
Epoch: 4 cost time: 2.8881635665893555
Epoch: 4, Steps: 10 | Train Loss: 1.262 Vali Loss: 1.324 Vali Acc: 0.365 Test Loss: 1.324 Test Acc: 0.365
Validation loss decreased (-0.364851 --> -0.364852).  Saving model ...
Epoch: 5 cost time: 2.8365561962127686
Epoch: 5, Steps: 10 | Train Loss: 1.190 Vali Loss: 1.320 Vali Acc: 0.405 Test Loss: 1.320 Test Acc: 0.405
Validation loss decreased (-0.364852 --> -0.405392).  Saving model ...
Epoch: 6 cost time: 2.937563419342041
Epoch: 6, Steps: 10 | Train Loss: 1.139 Vali Loss: 1.275 Vali Acc: 0.446 Test Loss: 1.275 Test Acc: 0.446
Validation loss decreased (-0.405392 --> -0.445933).  Saving model ...
Epoch: 7 cost time: 2.837937831878662
Epoch: 7, Steps: 10 | Train Loss: 1.046 Vali Loss: 1.236 Vali Acc: 0.486 Test Loss: 1.236 Test Acc: 0.486
Validation loss decreased (-0.445933 --> -0.486474).  Saving model ...
Epoch: 8 cost time: 2.8367671966552734
Epoch: 8, Steps: 10 | Train Loss: 0.980 Vali Loss: 1.235 Vali Acc: 0.459 Test Loss: 1.235 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.863715410232544
Epoch: 9, Steps: 10 | Train Loss: 0.903 Vali Loss: 1.194 Vali Acc: 0.500 Test Loss: 1.194 Test Acc: 0.500
Validation loss decreased (-0.486474 --> -0.499988).  Saving model ...
Epoch: 10 cost time: 2.764894962310791
Epoch: 10, Steps: 10 | Train Loss: 0.808 Vali Loss: 1.180 Vali Acc: 0.514 Test Loss: 1.180 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513502).  Saving model ...
Epoch: 11 cost time: 2.690340280532837
Epoch: 11, Steps: 10 | Train Loss: 0.744 Vali Loss: 1.150 Vali Acc: 0.486 Test Loss: 1.150 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.7332308292388916
Epoch: 12, Steps: 10 | Train Loss: 0.657 Vali Loss: 1.150 Vali Acc: 0.500 Test Loss: 1.150 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.6852498054504395
Epoch: 13, Steps: 10 | Train Loss: 0.579 Vali Loss: 1.119 Vali Acc: 0.514 Test Loss: 1.119 Test Acc: 0.514
Validation loss decreased (-0.513502 --> -0.513502).  Saving model ...
Epoch: 14 cost time: 2.6461281776428223
Epoch: 14, Steps: 10 | Train Loss: 0.496 Vali Loss: 1.125 Vali Acc: 0.500 Test Loss: 1.125 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.595583438873291
Epoch: 15, Steps: 10 | Train Loss: 0.440 Vali Loss: 1.126 Vali Acc: 0.514 Test Loss: 1.126 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.371753454208374
Epoch: 16, Steps: 10 | Train Loss: 0.373 Vali Loss: 1.104 Vali Acc: 0.500 Test Loss: 1.104 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.630021810531616
Epoch: 17, Steps: 10 | Train Loss: 0.336 Vali Loss: 1.116 Vali Acc: 0.500 Test Loss: 1.116 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.4862427711486816
Epoch: 18, Steps: 10 | Train Loss: 0.253 Vali Loss: 1.109 Vali Acc: 0.554 Test Loss: 1.109 Test Acc: 0.554
Validation loss decreased (-0.513502 --> -0.554043).  Saving model ...
Epoch: 19 cost time: 2.5990843772888184
Epoch: 19, Steps: 10 | Train Loss: 0.212 Vali Loss: 1.147 Vali Acc: 0.500 Test Loss: 1.147 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.645949363708496
Epoch: 20, Steps: 10 | Train Loss: 0.195 Vali Loss: 1.135 Vali Acc: 0.500 Test Loss: 1.135 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.6673123836517334
Epoch: 21, Steps: 10 | Train Loss: 0.164 Vali Loss: 1.146 Vali Acc: 0.527 Test Loss: 1.146 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.437547445297241
Epoch: 22, Steps: 10 | Train Loss: 0.148 Vali Loss: 1.133 Vali Acc: 0.527 Test Loss: 1.133 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.6109468936920166
Epoch: 23, Steps: 10 | Train Loss: 0.133 Vali Loss: 1.131 Vali Acc: 0.554 Test Loss: 1.131 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.6550934314727783
Epoch: 24, Steps: 10 | Train Loss: 0.111 Vali Loss: 1.128 Vali Acc: 0.541 Test Loss: 1.128 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.6789321899414062
Epoch: 25, Steps: 10 | Train Loss: 0.099 Vali Loss: 1.159 Vali Acc: 0.554 Test Loss: 1.159 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.7477118968963623
Epoch: 26, Steps: 10 | Train Loss: 0.093 Vali Loss: 1.169 Vali Acc: 0.554 Test Loss: 1.169 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.3613152503967285
Epoch: 27, Steps: 10 | Train Loss: 0.074 Vali Loss: 1.145 Vali Acc: 0.568 Test Loss: 1.145 Test Acc: 0.568
Validation loss decreased (-0.554043 --> -0.567556).  Saving model ...
Epoch: 28 cost time: 2.5308144092559814
Epoch: 28, Steps: 10 | Train Loss: 0.065 Vali Loss: 1.153 Vali Acc: 0.541 Test Loss: 1.153 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.666384220123291
Epoch: 29, Steps: 10 | Train Loss: 0.050 Vali Loss: 1.151 Vali Acc: 0.541 Test Loss: 1.151 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.6622159481048584
Epoch: 30, Steps: 10 | Train Loss: 0.050 Vali Loss: 1.172 Vali Acc: 0.554 Test Loss: 1.172 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm8_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 306532
model size : 1.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm8_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.2544689178466797
Epoch: 1, Steps: 10 | Train Loss: 1.458 Vali Loss: 1.401 Vali Acc: 0.297 Test Loss: 1.401 Test Acc: 0.297
Validation loss decreased (inf --> -0.297283).  Saving model ...
Epoch: 2 cost time: 2.003268241882324
Epoch: 2, Steps: 10 | Train Loss: 1.432 Vali Loss: 1.389 Vali Acc: 0.311 Test Loss: 1.389 Test Acc: 0.311
Validation loss decreased (-0.297283 --> -0.310797).  Saving model ...
Epoch: 3 cost time: 1.8462374210357666
Epoch: 3, Steps: 10 | Train Loss: 1.399 Vali Loss: 1.387 Vali Acc: 0.297 Test Loss: 1.387 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.891944408416748
Epoch: 4, Steps: 10 | Train Loss: 1.313 Vali Loss: 1.366 Vali Acc: 0.351 Test Loss: 1.366 Test Acc: 0.351
Validation loss decreased (-0.310797 --> -0.351338).  Saving model ...
Epoch: 5 cost time: 1.910496473312378
Epoch: 5, Steps: 10 | Train Loss: 1.277 Vali Loss: 1.326 Vali Acc: 0.365 Test Loss: 1.326 Test Acc: 0.365
Validation loss decreased (-0.351338 --> -0.364852).  Saving model ...
Epoch: 6 cost time: 1.723890781402588
Epoch: 6, Steps: 10 | Train Loss: 1.163 Vali Loss: 1.298 Vali Acc: 0.405 Test Loss: 1.298 Test Acc: 0.405
Validation loss decreased (-0.364852 --> -0.405392).  Saving model ...
Epoch: 7 cost time: 1.9312429428100586
Epoch: 7, Steps: 10 | Train Loss: 1.098 Vali Loss: 1.294 Vali Acc: 0.459 Test Loss: 1.294 Test Acc: 0.459
Validation loss decreased (-0.405392 --> -0.459447).  Saving model ...
Epoch: 8 cost time: 1.9066708087921143
Epoch: 8, Steps: 10 | Train Loss: 1.025 Vali Loss: 1.259 Vali Acc: 0.432 Test Loss: 1.259 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8542468547821045
Epoch: 9, Steps: 10 | Train Loss: 0.934 Vali Loss: 1.237 Vali Acc: 0.405 Test Loss: 1.237 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.9325616359710693
Epoch: 10, Steps: 10 | Train Loss: 0.861 Vali Loss: 1.228 Vali Acc: 0.419 Test Loss: 1.228 Test Acc: 0.419
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.8901877403259277
Epoch: 11, Steps: 10 | Train Loss: 0.778 Vali Loss: 1.204 Vali Acc: 0.446 Test Loss: 1.204 Test Acc: 0.446
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.052981376647949
Epoch: 12, Steps: 10 | Train Loss: 0.713 Vali Loss: 1.177 Vali Acc: 0.432 Test Loss: 1.177 Test Acc: 0.432
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.19473934173584
Epoch: 13, Steps: 10 | Train Loss: 0.623 Vali Loss: 1.183 Vali Acc: 0.432 Test Loss: 1.183 Test Acc: 0.432
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.9291572570800781
Epoch: 14, Steps: 10 | Train Loss: 0.549 Vali Loss: 1.143 Vali Acc: 0.500 Test Loss: 1.143 Test Acc: 0.500
Validation loss decreased (-0.459447 --> -0.499989).  Saving model ...
Epoch: 15 cost time: 1.9115889072418213
Epoch: 15, Steps: 10 | Train Loss: 0.465 Vali Loss: 1.118 Vali Acc: 0.419 Test Loss: 1.118 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.9459688663482666
Epoch: 16, Steps: 10 | Train Loss: 0.399 Vali Loss: 1.102 Vali Acc: 0.486 Test Loss: 1.102 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.971684455871582
Epoch: 17, Steps: 10 | Train Loss: 0.347 Vali Loss: 1.112 Vali Acc: 0.459 Test Loss: 1.112 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.0514414310455322
Epoch: 18, Steps: 10 | Train Loss: 0.278 Vali Loss: 1.045 Vali Acc: 0.527 Test Loss: 1.045 Test Acc: 0.527
Validation loss decreased (-0.499989 --> -0.527017).  Saving model ...
Epoch: 19 cost time: 1.888138771057129
Epoch: 19, Steps: 10 | Train Loss: 0.228 Vali Loss: 1.051 Vali Acc: 0.527 Test Loss: 1.051 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.8980157375335693
Epoch: 20, Steps: 10 | Train Loss: 0.191 Vali Loss: 1.041 Vali Acc: 0.500 Test Loss: 1.041 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.061863899230957
Epoch: 21, Steps: 10 | Train Loss: 0.157 Vali Loss: 1.032 Vali Acc: 0.514 Test Loss: 1.032 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.9997820854187012
Epoch: 22, Steps: 10 | Train Loss: 0.140 Vali Loss: 1.044 Vali Acc: 0.541 Test Loss: 1.044 Test Acc: 0.541
Validation loss decreased (-0.527017 --> -0.540530).  Saving model ...
Epoch: 23 cost time: 1.8859479427337646
Epoch: 23, Steps: 10 | Train Loss: 0.117 Vali Loss: 1.020 Vali Acc: 0.527 Test Loss: 1.020 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.003129482269287
Epoch: 24, Steps: 10 | Train Loss: 0.102 Vali Loss: 1.034 Vali Acc: 0.527 Test Loss: 1.034 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.8098325729370117
Epoch: 25, Steps: 10 | Train Loss: 0.081 Vali Loss: 1.035 Vali Acc: 0.581 Test Loss: 1.035 Test Acc: 0.581
Validation loss decreased (-0.540530 --> -0.581071).  Saving model ...
Epoch: 26 cost time: 2.014009714126587
Epoch: 26, Steps: 10 | Train Loss: 0.074 Vali Loss: 1.051 Vali Acc: 0.541 Test Loss: 1.051 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.9824771881103516
Epoch: 27, Steps: 10 | Train Loss: 0.063 Vali Loss: 1.039 Vali Acc: 0.527 Test Loss: 1.039 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.027174472808838
Epoch: 28, Steps: 10 | Train Loss: 0.056 Vali Loss: 1.038 Vali Acc: 0.554 Test Loss: 1.038 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.893038272857666
Epoch: 29, Steps: 10 | Train Loss: 0.049 Vali Loss: 1.049 Vali Acc: 0.568 Test Loss: 1.049 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.6778240203857422
Epoch: 30, Steps: 10 | Train Loss: 0.051 Vali Loss: 1.009 Vali Acc: 0.568 Test Loss: 1.009 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm8_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 99492
model size : 0.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm8_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.635791540145874
Epoch: 1, Steps: 10 | Train Loss: 1.438 Vali Loss: 1.391 Vali Acc: 0.270 Test Loss: 1.391 Test Acc: 0.270
Validation loss decreased (inf --> -0.270256).  Saving model ...
Epoch: 2 cost time: 2.15421986579895
Epoch: 2, Steps: 10 | Train Loss: 1.370 Vali Loss: 1.367 Vali Acc: 0.311 Test Loss: 1.367 Test Acc: 0.311
Validation loss decreased (-0.270256 --> -0.310797).  Saving model ...
Epoch: 3 cost time: 2.1042606830596924
Epoch: 3, Steps: 10 | Train Loss: 1.324 Vali Loss: 1.341 Vali Acc: 0.378 Test Loss: 1.341 Test Acc: 0.378
Validation loss decreased (-0.310797 --> -0.378365).  Saving model ...
Epoch: 4 cost time: 2.1764748096466064
Epoch: 4, Steps: 10 | Train Loss: 1.271 Vali Loss: 1.321 Vali Acc: 0.378 Test Loss: 1.321 Test Acc: 0.378
Validation loss decreased (-0.378365 --> -0.378365).  Saving model ...
Epoch: 5 cost time: 2.1531786918640137
Epoch: 5, Steps: 10 | Train Loss: 1.207 Vali Loss: 1.318 Vali Acc: 0.419 Test Loss: 1.318 Test Acc: 0.419
Validation loss decreased (-0.378365 --> -0.418906).  Saving model ...
Epoch: 6 cost time: 1.9549713134765625
Epoch: 6, Steps: 10 | Train Loss: 1.159 Vali Loss: 1.274 Vali Acc: 0.459 Test Loss: 1.274 Test Acc: 0.459
Validation loss decreased (-0.418906 --> -0.459447).  Saving model ...
Epoch: 7 cost time: 2.016796350479126
Epoch: 7, Steps: 10 | Train Loss: 1.076 Vali Loss: 1.236 Vali Acc: 0.459 Test Loss: 1.236 Test Acc: 0.459
Validation loss decreased (-0.459447 --> -0.459447).  Saving model ...
Epoch: 8 cost time: 2.0940990447998047
Epoch: 8, Steps: 10 | Train Loss: 1.014 Vali Loss: 1.235 Vali Acc: 0.446 Test Loss: 1.235 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.1031877994537354
Epoch: 9, Steps: 10 | Train Loss: 0.942 Vali Loss: 1.196 Vali Acc: 0.473 Test Loss: 1.196 Test Acc: 0.473
Validation loss decreased (-0.459447 --> -0.472961).  Saving model ...
Epoch: 10 cost time: 2.053879976272583
Epoch: 10, Steps: 10 | Train Loss: 0.865 Vali Loss: 1.182 Vali Acc: 0.486 Test Loss: 1.182 Test Acc: 0.486
Validation loss decreased (-0.472961 --> -0.486475).  Saving model ...
Epoch: 11 cost time: 2.2368581295013428
Epoch: 11, Steps: 10 | Train Loss: 0.809 Vali Loss: 1.156 Vali Acc: 0.473 Test Loss: 1.156 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.0053491592407227
Epoch: 12, Steps: 10 | Train Loss: 0.710 Vali Loss: 1.156 Vali Acc: 0.473 Test Loss: 1.156 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.0631003379821777
Epoch: 13, Steps: 10 | Train Loss: 0.647 Vali Loss: 1.126 Vali Acc: 0.500 Test Loss: 1.126 Test Acc: 0.500
Validation loss decreased (-0.486475 --> -0.499989).  Saving model ...
Epoch: 14 cost time: 2.1402506828308105
Epoch: 14, Steps: 10 | Train Loss: 0.569 Vali Loss: 1.105 Vali Acc: 0.527 Test Loss: 1.105 Test Acc: 0.527
Validation loss decreased (-0.499989 --> -0.527016).  Saving model ...
Epoch: 15 cost time: 2.1955931186676025
Epoch: 15, Steps: 10 | Train Loss: 0.506 Vali Loss: 1.110 Vali Acc: 0.486 Test Loss: 1.110 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.1275548934936523
Epoch: 16, Steps: 10 | Train Loss: 0.444 Vali Loss: 1.089 Vali Acc: 0.500 Test Loss: 1.089 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.167837381362915
Epoch: 17, Steps: 10 | Train Loss: 0.396 Vali Loss: 1.085 Vali Acc: 0.527 Test Loss: 1.085 Test Acc: 0.527
Validation loss decreased (-0.527016 --> -0.527016).  Saving model ...
Epoch: 18 cost time: 1.5383970737457275
Epoch: 18, Steps: 10 | Train Loss: 0.327 Vali Loss: 1.069 Vali Acc: 0.527 Test Loss: 1.069 Test Acc: 0.527
Validation loss decreased (-0.527016 --> -0.527016).  Saving model ...
Epoch: 19 cost time: 1.838679313659668
Epoch: 19, Steps: 10 | Train Loss: 0.280 Vali Loss: 1.084 Vali Acc: 0.514 Test Loss: 1.084 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.957857608795166
Epoch: 20, Steps: 10 | Train Loss: 0.239 Vali Loss: 1.048 Vali Acc: 0.541 Test Loss: 1.048 Test Acc: 0.541
Validation loss decreased (-0.527016 --> -0.540530).  Saving model ...
Epoch: 21 cost time: 1.758775234222412
Epoch: 21, Steps: 10 | Train Loss: 0.210 Vali Loss: 1.055 Vali Acc: 0.581 Test Loss: 1.055 Test Acc: 0.581
Validation loss decreased (-0.540530 --> -0.581071).  Saving model ...
Epoch: 22 cost time: 2.0125808715820312
Epoch: 22, Steps: 10 | Train Loss: 0.182 Vali Loss: 1.065 Vali Acc: 0.541 Test Loss: 1.065 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.897217035293579
Epoch: 23, Steps: 10 | Train Loss: 0.154 Vali Loss: 1.053 Vali Acc: 0.554 Test Loss: 1.053 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.140606641769409
Epoch: 24, Steps: 10 | Train Loss: 0.132 Vali Loss: 1.042 Vali Acc: 0.595 Test Loss: 1.042 Test Acc: 0.595
Validation loss decreased (-0.581071 --> -0.594584).  Saving model ...
Epoch: 25 cost time: 1.9345757961273193
Epoch: 25, Steps: 10 | Train Loss: 0.118 Vali Loss: 1.077 Vali Acc: 0.527 Test Loss: 1.077 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.9405252933502197
Epoch: 26, Steps: 10 | Train Loss: 0.100 Vali Loss: 1.060 Vali Acc: 0.554 Test Loss: 1.060 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.911419153213501
Epoch: 27, Steps: 10 | Train Loss: 0.090 Vali Loss: 1.033 Vali Acc: 0.581 Test Loss: 1.033 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.9451093673706055
Epoch: 28, Steps: 10 | Train Loss: 0.082 Vali Loss: 1.066 Vali Acc: 0.581 Test Loss: 1.066 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.5664896965026855
Epoch: 29, Steps: 10 | Train Loss: 0.066 Vali Loss: 1.068 Vali Acc: 0.581 Test Loss: 1.068 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.3300280570983887
Epoch: 30, Steps: 10 | Train Loss: 0.061 Vali Loss: 1.066 Vali Acc: 0.581 Test Loss: 1.066 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm8_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 306532
model size : 1.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm8_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.82108736038208
Epoch: 1, Steps: 10 | Train Loss: 1.443 Vali Loss: 1.412 Vali Acc: 0.257 Test Loss: 1.412 Test Acc: 0.257
Validation loss decreased (inf --> -0.256743).  Saving model ...
Epoch: 2 cost time: 1.4977085590362549
Epoch: 2, Steps: 10 | Train Loss: 1.421 Vali Loss: 1.402 Vali Acc: 0.270 Test Loss: 1.402 Test Acc: 0.270
Validation loss decreased (-0.256743 --> -0.270256).  Saving model ...
Epoch: 3 cost time: 1.36692214012146
Epoch: 3, Steps: 10 | Train Loss: 1.388 Vali Loss: 1.402 Vali Acc: 0.257 Test Loss: 1.402 Test Acc: 0.257
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.55527925491333
Epoch: 4, Steps: 10 | Train Loss: 1.311 Vali Loss: 1.383 Vali Acc: 0.324 Test Loss: 1.383 Test Acc: 0.324
Validation loss decreased (-0.270256 --> -0.324310).  Saving model ...
Epoch: 5 cost time: 1.4170589447021484
Epoch: 5, Steps: 10 | Train Loss: 1.275 Vali Loss: 1.345 Vali Acc: 0.365 Test Loss: 1.345 Test Acc: 0.365
Validation loss decreased (-0.324310 --> -0.364851).  Saving model ...
Epoch: 6 cost time: 1.3068079948425293
Epoch: 6, Steps: 10 | Train Loss: 1.181 Vali Loss: 1.319 Vali Acc: 0.351 Test Loss: 1.319 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6297428607940674
Epoch: 7, Steps: 10 | Train Loss: 1.111 Vali Loss: 1.310 Vali Acc: 0.378 Test Loss: 1.310 Test Acc: 0.378
Validation loss decreased (-0.364851 --> -0.378365).  Saving model ...
Epoch: 8 cost time: 1.1653900146484375
Epoch: 8, Steps: 10 | Train Loss: 1.050 Vali Loss: 1.271 Vali Acc: 0.392 Test Loss: 1.271 Test Acc: 0.392
Validation loss decreased (-0.378365 --> -0.391879).  Saving model ...
Epoch: 9 cost time: 1.6531579494476318
Epoch: 9, Steps: 10 | Train Loss: 0.946 Vali Loss: 1.236 Vali Acc: 0.378 Test Loss: 1.236 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.601525068283081
Epoch: 10, Steps: 10 | Train Loss: 0.896 Vali Loss: 1.228 Vali Acc: 0.419 Test Loss: 1.228 Test Acc: 0.419
Validation loss decreased (-0.391879 --> -0.418907).  Saving model ...
Epoch: 11 cost time: 1.6782732009887695
Epoch: 11, Steps: 10 | Train Loss: 0.827 Vali Loss: 1.211 Vali Acc: 0.405 Test Loss: 1.211 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.6342003345489502
Epoch: 12, Steps: 10 | Train Loss: 0.769 Vali Loss: 1.178 Vali Acc: 0.419 Test Loss: 1.178 Test Acc: 0.419
Validation loss decreased (-0.418907 --> -0.418907).  Saving model ...
Epoch: 13 cost time: 1.995450496673584
Epoch: 13, Steps: 10 | Train Loss: 0.696 Vali Loss: 1.183 Vali Acc: 0.459 Test Loss: 1.183 Test Acc: 0.459
Validation loss decreased (-0.418907 --> -0.459448).  Saving model ...
Epoch: 14 cost time: 1.6819977760314941
Epoch: 14, Steps: 10 | Train Loss: 0.633 Vali Loss: 1.161 Vali Acc: 0.446 Test Loss: 1.161 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.6958274841308594
Epoch: 15, Steps: 10 | Train Loss: 0.549 Vali Loss: 1.138 Vali Acc: 0.459 Test Loss: 1.138 Test Acc: 0.459
Validation loss decreased (-0.459448 --> -0.459448).  Saving model ...
Epoch: 16 cost time: 1.684004545211792
Epoch: 16, Steps: 10 | Train Loss: 0.500 Vali Loss: 1.110 Vali Acc: 0.432 Test Loss: 1.110 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.6072070598602295
Epoch: 17, Steps: 10 | Train Loss: 0.464 Vali Loss: 1.125 Vali Acc: 0.500 Test Loss: 1.125 Test Acc: 0.500
Validation loss decreased (-0.459448 --> -0.499989).  Saving model ...
Epoch: 18 cost time: 1.7868576049804688
Epoch: 18, Steps: 10 | Train Loss: 0.371 Vali Loss: 1.065 Vali Acc: 0.459 Test Loss: 1.065 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.6991233825683594
Epoch: 19, Steps: 10 | Train Loss: 0.340 Vali Loss: 1.054 Vali Acc: 0.473 Test Loss: 1.054 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.501518964767456
Epoch: 20, Steps: 10 | Train Loss: 0.297 Vali Loss: 1.033 Vali Acc: 0.473 Test Loss: 1.033 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.5875070095062256
Epoch: 21, Steps: 10 | Train Loss: 0.251 Vali Loss: 1.027 Vali Acc: 0.500 Test Loss: 1.027 Test Acc: 0.500
Validation loss decreased (-0.499989 --> -0.499990).  Saving model ...
Epoch: 22 cost time: 1.588526725769043
Epoch: 22, Steps: 10 | Train Loss: 0.209 Vali Loss: 1.023 Vali Acc: 0.514 Test Loss: 1.023 Test Acc: 0.514
Validation loss decreased (-0.499990 --> -0.513503).  Saving model ...
Epoch: 23 cost time: 1.5018689632415771
Epoch: 23, Steps: 10 | Train Loss: 0.187 Vali Loss: 1.004 Vali Acc: 0.500 Test Loss: 1.004 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.53236722946167
Epoch: 24, Steps: 10 | Train Loss: 0.187 Vali Loss: 1.009 Vali Acc: 0.554 Test Loss: 1.009 Test Acc: 0.554
Validation loss decreased (-0.513503 --> -0.554044).  Saving model ...
Epoch: 25 cost time: 1.5063624382019043
Epoch: 25, Steps: 10 | Train Loss: 0.145 Vali Loss: 1.004 Vali Acc: 0.568 Test Loss: 1.004 Test Acc: 0.568
Validation loss decreased (-0.554044 --> -0.567558).  Saving model ...
Epoch: 26 cost time: 1.6369705200195312
Epoch: 26, Steps: 10 | Train Loss: 0.119 Vali Loss: 1.005 Vali Acc: 0.541 Test Loss: 1.005 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.5861144065856934
Epoch: 27, Steps: 10 | Train Loss: 0.113 Vali Loss: 0.989 Vali Acc: 0.568 Test Loss: 0.989 Test Acc: 0.568
Validation loss decreased (-0.567558 --> -0.567558).  Saving model ...
Epoch: 28 cost time: 1.5414886474609375
Epoch: 28, Steps: 10 | Train Loss: 0.106 Vali Loss: 0.995 Vali Acc: 0.595 Test Loss: 0.995 Test Acc: 0.595
Validation loss decreased (-0.567558 --> -0.594585).  Saving model ...
Epoch: 29 cost time: 1.3556804656982422
Epoch: 29, Steps: 10 | Train Loss: 0.093 Vali Loss: 1.010 Vali Acc: 0.581 Test Loss: 1.010 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.4276783466339111
Epoch: 30, Steps: 10 | Train Loss: 0.089 Vali Loss: 0.995 Vali Acc: 0.554 Test Loss: 0.995 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el4_dm8_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 99492
model size : 0.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm128_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 40.6746826171875
Epoch: 1, Steps: 10 | Train Loss: 1.453 Vali Loss: 1.356 Vali Acc: 0.338 Test Loss: 1.356 Test Acc: 0.338
Validation loss decreased (inf --> -0.337824).  Saving model ...
Epoch: 2 cost time: 40.65315818786621
Epoch: 2, Steps: 10 | Train Loss: 0.969 Vali Loss: 1.211 Vali Acc: 0.486 Test Loss: 1.211 Test Acc: 0.486
Validation loss decreased (-0.337824 --> -0.486474).  Saving model ...
Epoch: 3 cost time: 37.81292986869812
Epoch: 3, Steps: 10 | Train Loss: 0.463 Vali Loss: 1.099 Vali Acc: 0.514 Test Loss: 1.099 Test Acc: 0.514
Validation loss decreased (-0.486474 --> -0.513503).  Saving model ...
Epoch: 4 cost time: 37.61101317405701
Epoch: 4, Steps: 10 | Train Loss: 0.203 Vali Loss: 1.181 Vali Acc: 0.459 Test Loss: 1.181 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 38.88169574737549
Epoch: 5, Steps: 10 | Train Loss: 0.068 Vali Loss: 1.014 Vali Acc: 0.541 Test Loss: 1.014 Test Acc: 0.541
Validation loss decreased (-0.513503 --> -0.540530).  Saving model ...
Epoch: 6 cost time: 40.94150376319885
Epoch: 6, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.179 Vali Acc: 0.554 Test Loss: 1.179 Test Acc: 0.554
Validation loss decreased (-0.540530 --> -0.554042).  Saving model ...
Epoch: 7 cost time: 42.33371043205261
Epoch: 7, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.155 Vali Acc: 0.541 Test Loss: 1.155 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 41.342005014419556
Epoch: 8, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.173 Vali Acc: 0.635 Test Loss: 1.173 Test Acc: 0.635
Validation loss decreased (-0.554042 --> -0.635123).  Saving model ...
Epoch: 9 cost time: 41.46738147735596
Epoch: 9, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.104 Vali Acc: 0.649 Test Loss: 1.104 Test Acc: 0.649
Validation loss decreased (-0.635123 --> -0.648638).  Saving model ...
Epoch: 10 cost time: 36.5821852684021
Epoch: 10, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.290 Vali Acc: 0.635 Test Loss: 1.290 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 41.14357852935791
Epoch: 11, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.219 Vali Acc: 0.622 Test Loss: 1.219 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 42.87386703491211
Epoch: 12, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.213 Vali Acc: 0.581 Test Loss: 1.213 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 41.26726031303406
Epoch: 13, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.485 Vali Acc: 0.554 Test Loss: 1.485 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 41.58515000343323
Epoch: 14, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.341 Vali Acc: 0.568 Test Loss: 1.341 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 41.10796403884888
Epoch: 15, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.213 Vali Acc: 0.595 Test Loss: 1.213 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 41.37680387496948
Epoch: 16, Steps: 10 | Train Loss: 0.011 Vali Loss: 2.132 Vali Acc: 0.527 Test Loss: 2.132 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 38.187124490737915
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.348 Vali Acc: 0.595 Test Loss: 1.348 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 38.42976403236389
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.235 Vali Acc: 0.649 Test Loss: 1.235 Test Acc: 0.649
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 41.58471059799194
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.322 Vali Acc: 0.622 Test Loss: 1.322 Test Acc: 0.622
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm128_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6486486486486487
model parameter : 56446212
model size : 217.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm128_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 16.75264549255371
Epoch: 1, Steps: 10 | Train Loss: 1.432 Vali Loss: 1.376 Vali Acc: 0.311 Test Loss: 1.376 Test Acc: 0.311
Validation loss decreased (inf --> -0.310797).  Saving model ...
Epoch: 2 cost time: 14.821383714675903
Epoch: 2, Steps: 10 | Train Loss: 1.018 Vali Loss: 1.158 Vali Acc: 0.500 Test Loss: 1.158 Test Acc: 0.500
Validation loss decreased (-0.310797 --> -0.499988).  Saving model ...
Epoch: 3 cost time: 14.95729374885559
Epoch: 3, Steps: 10 | Train Loss: 0.509 Vali Loss: 1.055 Vali Acc: 0.595 Test Loss: 1.055 Test Acc: 0.595
Validation loss decreased (-0.499988 --> -0.594584).  Saving model ...
Epoch: 4 cost time: 14.936400175094604
Epoch: 4, Steps: 10 | Train Loss: 0.200 Vali Loss: 1.206 Vali Acc: 0.554 Test Loss: 1.206 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 15.31853985786438
Epoch: 5, Steps: 10 | Train Loss: 0.078 Vali Loss: 1.026 Vali Acc: 0.541 Test Loss: 1.026 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 14.962404251098633
Epoch: 6, Steps: 10 | Train Loss: 0.037 Vali Loss: 1.013 Vali Acc: 0.595 Test Loss: 1.013 Test Acc: 0.595
Validation loss decreased (-0.594584 --> -0.594584).  Saving model ...
Epoch: 7 cost time: 14.517687320709229
Epoch: 7, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.110 Vali Acc: 0.595 Test Loss: 1.110 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 13.425321340560913
Epoch: 8, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.201 Vali Acc: 0.554 Test Loss: 1.201 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 14.172709941864014
Epoch: 9, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.341 Vali Acc: 0.568 Test Loss: 1.341 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 13.452940940856934
Epoch: 10, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.251 Vali Acc: 0.581 Test Loss: 1.251 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 13.855537176132202
Epoch: 11, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.189 Vali Acc: 0.554 Test Loss: 1.189 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 13.721970796585083
Epoch: 12, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.170 Vali Acc: 0.608 Test Loss: 1.170 Test Acc: 0.608
Validation loss decreased (-0.594584 --> -0.608096).  Saving model ...
Epoch: 13 cost time: 13.200992584228516
Epoch: 13, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.163 Vali Acc: 0.595 Test Loss: 1.163 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 14.881657123565674
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.165 Vali Acc: 0.595 Test Loss: 1.165 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 14.937361478805542
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.172 Vali Acc: 0.608 Test Loss: 1.172 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 14.659749746322632
Epoch: 16, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.174 Vali Acc: 0.608 Test Loss: 1.174 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 15.259855270385742
Epoch: 17, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.180 Vali Acc: 0.595 Test Loss: 1.180 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 14.478419303894043
Epoch: 18, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.187 Vali Acc: 0.595 Test Loss: 1.187 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 14.767740964889526
Epoch: 19, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.187 Vali Acc: 0.608 Test Loss: 1.187 Test Acc: 0.608
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 12.137244701385498
Epoch: 20, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.188 Vali Acc: 0.608 Test Loss: 1.188 Test Acc: 0.608
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 14.417714595794678
Epoch: 21, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.189 Vali Acc: 0.608 Test Loss: 1.189 Test Acc: 0.608
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 13.929492473602295
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.408 Vali Acc: 0.608 Test Loss: 1.408 Test Acc: 0.608
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm128_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 16729092
model size : 66.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm128_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 27.235339879989624
Epoch: 1, Steps: 10 | Train Loss: 1.456 Vali Loss: 1.349 Vali Acc: 0.338 Test Loss: 1.349 Test Acc: 0.338
Validation loss decreased (inf --> -0.337824).  Saving model ...
Epoch: 2 cost time: 23.923797607421875
Epoch: 2, Steps: 10 | Train Loss: 0.982 Vali Loss: 1.211 Vali Acc: 0.459 Test Loss: 1.211 Test Acc: 0.459
Validation loss decreased (-0.337824 --> -0.459447).  Saving model ...
Epoch: 3 cost time: 24.63389301300049
Epoch: 3, Steps: 10 | Train Loss: 0.472 Vali Loss: 1.101 Vali Acc: 0.541 Test Loss: 1.101 Test Acc: 0.541
Validation loss decreased (-0.459447 --> -0.540530).  Saving model ...
Epoch: 4 cost time: 23.87194561958313
Epoch: 4, Steps: 10 | Train Loss: 0.219 Vali Loss: 1.240 Vali Acc: 0.446 Test Loss: 1.240 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 26.97934603691101
Epoch: 5, Steps: 10 | Train Loss: 0.088 Vali Loss: 1.073 Vali Acc: 0.608 Test Loss: 1.073 Test Acc: 0.608
Validation loss decreased (-0.540530 --> -0.608097).  Saving model ...
Epoch: 6 cost time: 26.970919847488403
Epoch: 6, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.115 Vali Acc: 0.541 Test Loss: 1.115 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 27.42753839492798
Epoch: 7, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.219 Vali Acc: 0.581 Test Loss: 1.219 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 27.13804268836975
Epoch: 8, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.288 Vali Acc: 0.581 Test Loss: 1.288 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 27.252824544906616
Epoch: 9, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.348 Vali Acc: 0.541 Test Loss: 1.348 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 24.56197953224182
Epoch: 10, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.430 Vali Acc: 0.541 Test Loss: 1.430 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 24.9894597530365
Epoch: 11, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.232 Vali Acc: 0.622 Test Loss: 1.232 Test Acc: 0.622
Validation loss decreased (-0.608097 --> -0.621609).  Saving model ...
Epoch: 12 cost time: 25.169812440872192
Epoch: 12, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.233 Vali Acc: 0.635 Test Loss: 1.233 Test Acc: 0.635
Validation loss decreased (-0.621609 --> -0.635123).  Saving model ...
Epoch: 13 cost time: 30.104302644729614
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.244 Vali Acc: 0.622 Test Loss: 1.244 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 31.266654014587402
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.188 Vali Acc: 0.649 Test Loss: 1.188 Test Acc: 0.649
Validation loss decreased (-0.635123 --> -0.648637).  Saving model ...
Epoch: 15 cost time: 31.10731077194214
Epoch: 15, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.570 Vali Acc: 0.608 Test Loss: 1.570 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 29.96077251434326
Epoch: 16, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.066 Vali Acc: 0.635 Test Loss: 1.066 Test Acc: 0.635
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 31.187007665634155
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.209 Vali Acc: 0.595 Test Loss: 1.209 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 30.28799295425415
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.294 Vali Acc: 0.635 Test Loss: 1.294 Test Acc: 0.635
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 28.060397624969482
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.296 Vali Acc: 0.622 Test Loss: 1.296 Test Acc: 0.622
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 28.118815660476685
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.249 Vali Acc: 0.608 Test Loss: 1.249 Test Acc: 0.608
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 28.983161211013794
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.235 Vali Acc: 0.595 Test Loss: 1.235 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 30.124382734298706
Epoch: 22, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.263 Vali Acc: 0.608 Test Loss: 1.263 Test Acc: 0.608
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 31.02378487586975
Epoch: 23, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.314 Vali Acc: 0.622 Test Loss: 1.314 Test Acc: 0.622
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 30.201886892318726
Epoch: 24, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.583 Vali Acc: 0.608 Test Loss: 1.583 Test Acc: 0.608
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm128_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6486486486486487
model parameter : 56446212
model size : 217.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm128_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 12.357065439224243
Epoch: 1, Steps: 10 | Train Loss: 1.433 Vali Loss: 1.373 Vali Acc: 0.297 Test Loss: 1.373 Test Acc: 0.297
Validation loss decreased (inf --> -0.297284).  Saving model ...
Epoch: 2 cost time: 11.438076972961426
Epoch: 2, Steps: 10 | Train Loss: 1.014 Vali Loss: 1.166 Vali Acc: 0.500 Test Loss: 1.166 Test Acc: 0.500
Validation loss decreased (-0.297284 --> -0.499988).  Saving model ...
Epoch: 3 cost time: 10.533475875854492
Epoch: 3, Steps: 10 | Train Loss: 0.508 Vali Loss: 1.045 Vali Acc: 0.608 Test Loss: 1.045 Test Acc: 0.608
Validation loss decreased (-0.499988 --> -0.608098).  Saving model ...
Epoch: 4 cost time: 10.63599419593811
Epoch: 4, Steps: 10 | Train Loss: 0.199 Vali Loss: 1.213 Vali Acc: 0.581 Test Loss: 1.213 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 10.305551528930664
Epoch: 5, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.976 Vali Acc: 0.662 Test Loss: 0.976 Test Acc: 0.662
Validation loss decreased (-0.608098 --> -0.662152).  Saving model ...
Epoch: 6 cost time: 10.534156560897827
Epoch: 6, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.953 Vali Acc: 0.608 Test Loss: 0.953 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 10.388269424438477
Epoch: 7, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.087 Vali Acc: 0.554 Test Loss: 1.087 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 10.37245488166809
Epoch: 8, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.235 Vali Acc: 0.595 Test Loss: 1.235 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 10.378644704818726
Epoch: 9, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.066 Vali Acc: 0.541 Test Loss: 1.066 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 10.088620662689209
Epoch: 10, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.535 Vali Acc: 0.608 Test Loss: 1.535 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 10.226434707641602
Epoch: 11, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.148 Vali Acc: 0.622 Test Loss: 1.148 Test Acc: 0.622
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 10.63620638847351
Epoch: 12, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.515 Vali Acc: 0.608 Test Loss: 1.515 Test Acc: 0.608
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 10.854219675064087
Epoch: 13, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.148 Vali Acc: 0.608 Test Loss: 1.148 Test Acc: 0.608
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 11.205688953399658
Epoch: 14, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.408 Vali Acc: 0.581 Test Loss: 1.408 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 11.619125604629517
Epoch: 15, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.441 Vali Acc: 0.635 Test Loss: 1.441 Test Acc: 0.635
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm128_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6621621621621622
model parameter : 16729092
model size : 66.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm128_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 20.29119300842285
Epoch: 1, Steps: 10 | Train Loss: 1.453 Vali Loss: 1.363 Vali Acc: 0.297 Test Loss: 1.363 Test Acc: 0.297
Validation loss decreased (inf --> -0.297284).  Saving model ...
Epoch: 2 cost time: 19.025472402572632
Epoch: 2, Steps: 10 | Train Loss: 1.070 Vali Loss: 1.213 Vali Acc: 0.473 Test Loss: 1.213 Test Acc: 0.473
Validation loss decreased (-0.297284 --> -0.472961).  Saving model ...
Epoch: 3 cost time: 18.52002787590027
Epoch: 3, Steps: 10 | Train Loss: 0.600 Vali Loss: 1.128 Vali Acc: 0.541 Test Loss: 1.128 Test Acc: 0.541
Validation loss decreased (-0.472961 --> -0.540529).  Saving model ...
Epoch: 4 cost time: 18.849710941314697
Epoch: 4, Steps: 10 | Train Loss: 0.320 Vali Loss: 1.098 Vali Acc: 0.446 Test Loss: 1.098 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 19.050606727600098
Epoch: 5, Steps: 10 | Train Loss: 0.124 Vali Loss: 0.946 Vali Acc: 0.581 Test Loss: 0.946 Test Acc: 0.581
Validation loss decreased (-0.540529 --> -0.581072).  Saving model ...
Epoch: 6 cost time: 18.958630800247192
Epoch: 6, Steps: 10 | Train Loss: 0.036 Vali Loss: 1.229 Vali Acc: 0.581 Test Loss: 1.229 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 17.583256721496582
Epoch: 7, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.016 Vali Acc: 0.635 Test Loss: 1.016 Test Acc: 0.635
Validation loss decreased (-0.581072 --> -0.635125).  Saving model ...
Epoch: 8 cost time: 17.67754578590393
Epoch: 8, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.033 Vali Acc: 0.608 Test Loss: 1.033 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 17.41078543663025
Epoch: 9, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.961 Vali Acc: 0.662 Test Loss: 0.961 Test Acc: 0.662
Validation loss decreased (-0.635125 --> -0.662153).  Saving model ...
Epoch: 10 cost time: 17.903591632843018
Epoch: 10, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.008 Vali Acc: 0.662 Test Loss: 1.008 Test Acc: 0.662
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 17.92154550552368
Epoch: 11, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.044 Vali Acc: 0.649 Test Loss: 1.044 Test Acc: 0.649
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 19.11541223526001
Epoch: 12, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.047 Vali Acc: 0.649 Test Loss: 1.047 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 19.810906410217285
Epoch: 13, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.062 Vali Acc: 0.622 Test Loss: 1.062 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 19.21132516860962
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.096 Vali Acc: 0.622 Test Loss: 1.096 Test Acc: 0.622
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 18.743213415145874
Epoch: 15, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.099 Vali Acc: 0.622 Test Loss: 1.099 Test Acc: 0.622
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 19.51824927330017
Epoch: 16, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.101 Vali Acc: 0.622 Test Loss: 1.101 Test Acc: 0.622
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 18.825708389282227
Epoch: 17, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.116 Vali Acc: 0.622 Test Loss: 1.116 Test Acc: 0.622
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 18.643380641937256
Epoch: 18, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.139 Vali Acc: 0.622 Test Loss: 1.139 Test Acc: 0.622
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 19.508899450302124
Epoch: 19, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.137 Vali Acc: 0.622 Test Loss: 1.137 Test Acc: 0.622
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm128_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6621621621621622
model parameter : 56446212
model size : 217.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm128_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 8.491865873336792
Epoch: 1, Steps: 10 | Train Loss: 1.433 Vali Loss: 1.373 Vali Acc: 0.297 Test Loss: 1.373 Test Acc: 0.297
Validation loss decreased (inf --> -0.297284).  Saving model ...
Epoch: 2 cost time: 6.8854289054870605
Epoch: 2, Steps: 10 | Train Loss: 1.072 Vali Loss: 1.166 Vali Acc: 0.486 Test Loss: 1.166 Test Acc: 0.486
Validation loss decreased (-0.297284 --> -0.486475).  Saving model ...
Epoch: 3 cost time: 7.576162815093994
Epoch: 3, Steps: 10 | Train Loss: 0.668 Vali Loss: 1.110 Vali Acc: 0.527 Test Loss: 1.110 Test Acc: 0.527
Validation loss decreased (-0.486475 --> -0.527016).  Saving model ...
Epoch: 4 cost time: 7.46891713142395
Epoch: 4, Steps: 10 | Train Loss: 0.321 Vali Loss: 1.303 Vali Acc: 0.514 Test Loss: 1.303 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 7.195482492446899
Epoch: 5, Steps: 10 | Train Loss: 0.157 Vali Loss: 0.961 Vali Acc: 0.595 Test Loss: 0.961 Test Acc: 0.595
Validation loss decreased (-0.527016 --> -0.594585).  Saving model ...
Epoch: 6 cost time: 7.132607460021973
Epoch: 6, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.954 Vali Acc: 0.595 Test Loss: 0.954 Test Acc: 0.595
Validation loss decreased (-0.594585 --> -0.594585).  Saving model ...
Epoch: 7 cost time: 7.361823558807373
Epoch: 7, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.167 Vali Acc: 0.595 Test Loss: 1.167 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 7.349726676940918
Epoch: 8, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.137 Vali Acc: 0.581 Test Loss: 1.137 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 7.37662148475647
Epoch: 9, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.116 Vali Acc: 0.581 Test Loss: 1.116 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 7.23858118057251
Epoch: 10, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.138 Vali Acc: 0.608 Test Loss: 1.138 Test Acc: 0.608
Validation loss decreased (-0.594585 --> -0.608097).  Saving model ...
Epoch: 11 cost time: 8.062690258026123
Epoch: 11, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.149 Vali Acc: 0.581 Test Loss: 1.149 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 8.26215124130249
Epoch: 12, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.151 Vali Acc: 0.595 Test Loss: 1.151 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 7.92335319519043
Epoch: 13, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.133 Vali Acc: 0.595 Test Loss: 1.133 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 7.553067207336426
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.128 Vali Acc: 0.595 Test Loss: 1.128 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 8.084664344787598
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.137 Vali Acc: 0.595 Test Loss: 1.137 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 8.03584623336792
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.146 Vali Acc: 0.595 Test Loss: 1.146 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 7.674596786499023
Epoch: 17, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.160 Vali Acc: 0.595 Test Loss: 1.160 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 8.015291213989258
Epoch: 18, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.171 Vali Acc: 0.595 Test Loss: 1.171 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 7.7627246379852295
Epoch: 19, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.160 Vali Acc: 0.595 Test Loss: 1.160 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 7.900156021118164
Epoch: 20, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.153 Vali Acc: 0.595 Test Loss: 1.153 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm128_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 16729092
model size : 66.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm128_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 25.433737993240356
Epoch: 1, Steps: 10 | Train Loss: 1.467 Vali Loss: 1.351 Vali Acc: 0.405 Test Loss: 1.351 Test Acc: 0.405
Validation loss decreased (inf --> -0.405392).  Saving model ...
Epoch: 2 cost time: 23.917370080947876
Epoch: 2, Steps: 10 | Train Loss: 1.038 Vali Loss: 1.294 Vali Acc: 0.392 Test Loss: 1.294 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 19.575384855270386
Epoch: 3, Steps: 10 | Train Loss: 0.524 Vali Loss: 1.117 Vali Acc: 0.541 Test Loss: 1.117 Test Acc: 0.541
Validation loss decreased (-0.405392 --> -0.540529).  Saving model ...
Epoch: 4 cost time: 19.52023673057556
Epoch: 4, Steps: 10 | Train Loss: 0.258 Vali Loss: 1.166 Vali Acc: 0.500 Test Loss: 1.166 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 19.94283628463745
Epoch: 5, Steps: 10 | Train Loss: 0.097 Vali Loss: 1.330 Vali Acc: 0.473 Test Loss: 1.330 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 19.672610998153687
Epoch: 6, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.216 Vali Acc: 0.500 Test Loss: 1.216 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 19.873186588287354
Epoch: 7, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.189 Vali Acc: 0.568 Test Loss: 1.189 Test Acc: 0.568
Validation loss decreased (-0.540529 --> -0.567556).  Saving model ...
Epoch: 8 cost time: 21.838927507400513
Epoch: 8, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.455 Vali Acc: 0.514 Test Loss: 1.455 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 21.482887029647827
Epoch: 9, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.239 Vali Acc: 0.541 Test Loss: 1.239 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 21.47902774810791
Epoch: 10, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.236 Vali Acc: 0.541 Test Loss: 1.236 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 21.683658838272095
Epoch: 11, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.229 Vali Acc: 0.581 Test Loss: 1.229 Test Acc: 0.581
Validation loss decreased (-0.567556 --> -0.581069).  Saving model ...
Epoch: 12 cost time: 21.44100332260132
Epoch: 12, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.165 Vali Acc: 0.595 Test Loss: 1.165 Test Acc: 0.595
Validation loss decreased (-0.581069 --> -0.594583).  Saving model ...
Epoch: 13 cost time: 21.59883975982666
Epoch: 13, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.194 Vali Acc: 0.568 Test Loss: 1.194 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 21.80628538131714
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.221 Vali Acc: 0.568 Test Loss: 1.221 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 19.592898845672607
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.225 Vali Acc: 0.568 Test Loss: 1.225 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 19.879714488983154
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.236 Vali Acc: 0.568 Test Loss: 1.236 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 19.60218095779419
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.241 Vali Acc: 0.568 Test Loss: 1.241 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 20.065228700637817
Epoch: 18, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.248 Vali Acc: 0.568 Test Loss: 1.248 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 21.483301401138306
Epoch: 19, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.256 Vali Acc: 0.568 Test Loss: 1.256 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 21.743561506271362
Epoch: 20, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.267 Vali Acc: 0.568 Test Loss: 1.267 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 21.22991371154785
Epoch: 21, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.275 Vali Acc: 0.568 Test Loss: 1.275 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 21.4404034614563
Epoch: 22, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.285 Vali Acc: 0.568 Test Loss: 1.285 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm128_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 28328964
model size : 110.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm128_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 10.152252912521362
Epoch: 1, Steps: 10 | Train Loss: 1.499 Vali Loss: 1.433 Vali Acc: 0.297 Test Loss: 1.433 Test Acc: 0.297
Validation loss decreased (inf --> -0.297283).  Saving model ...
Epoch: 2 cost time: 8.588917970657349
Epoch: 2, Steps: 10 | Train Loss: 1.067 Vali Loss: 1.135 Vali Acc: 0.527 Test Loss: 1.135 Test Acc: 0.527
Validation loss decreased (-0.297283 --> -0.527016).  Saving model ...
Epoch: 3 cost time: 8.186983346939087
Epoch: 3, Steps: 10 | Train Loss: 0.621 Vali Loss: 1.279 Vali Acc: 0.473 Test Loss: 1.279 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 8.48887324333191
Epoch: 4, Steps: 10 | Train Loss: 0.306 Vali Loss: 1.035 Vali Acc: 0.568 Test Loss: 1.035 Test Acc: 0.568
Validation loss decreased (-0.527016 --> -0.567557).  Saving model ...
Epoch: 5 cost time: 8.416247606277466
Epoch: 5, Steps: 10 | Train Loss: 0.127 Vali Loss: 1.410 Vali Acc: 0.541 Test Loss: 1.410 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 7.950194597244263
Epoch: 6, Steps: 10 | Train Loss: 0.059 Vali Loss: 1.232 Vali Acc: 0.595 Test Loss: 1.232 Test Acc: 0.595
Validation loss decreased (-0.567557 --> -0.594582).  Saving model ...
Epoch: 7 cost time: 7.826781988143921
Epoch: 7, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.184 Vali Acc: 0.554 Test Loss: 1.184 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 7.582377195358276
Epoch: 8, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.128 Vali Acc: 0.595 Test Loss: 1.128 Test Acc: 0.595
Validation loss decreased (-0.594582 --> -0.594583).  Saving model ...
Epoch: 9 cost time: 7.717556715011597
Epoch: 9, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.184 Vali Acc: 0.541 Test Loss: 1.184 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 7.3821351528167725
Epoch: 10, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.202 Vali Acc: 0.554 Test Loss: 1.202 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 7.727381944656372
Epoch: 11, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.180 Vali Acc: 0.554 Test Loss: 1.180 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 7.569373846054077
Epoch: 12, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.153 Vali Acc: 0.581 Test Loss: 1.153 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 7.892175912857056
Epoch: 13, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.146 Vali Acc: 0.581 Test Loss: 1.146 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 7.690526008605957
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.153 Vali Acc: 0.581 Test Loss: 1.153 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 7.4294514656066895
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.169 Vali Acc: 0.568 Test Loss: 1.169 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 6.709517955780029
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.172 Vali Acc: 0.568 Test Loss: 1.172 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 9.073415994644165
Epoch: 17, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.179 Vali Acc: 0.581 Test Loss: 1.179 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 9.181605100631714
Epoch: 18, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.181 Vali Acc: 0.595 Test Loss: 1.181 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm128_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 8470020
model size : 34.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm128_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 18.789207935333252
Epoch: 1, Steps: 10 | Train Loss: 1.468 Vali Loss: 1.349 Vali Acc: 0.405 Test Loss: 1.349 Test Acc: 0.405
Validation loss decreased (inf --> -0.405392).  Saving model ...
Epoch: 2 cost time: 16.639198541641235
Epoch: 2, Steps: 10 | Train Loss: 1.036 Vali Loss: 1.299 Vali Acc: 0.365 Test Loss: 1.299 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 17.209012746810913
Epoch: 3, Steps: 10 | Train Loss: 0.515 Vali Loss: 1.122 Vali Acc: 0.527 Test Loss: 1.122 Test Acc: 0.527
Validation loss decreased (-0.405392 --> -0.527016).  Saving model ...
Epoch: 4 cost time: 16.921798944473267
Epoch: 4, Steps: 10 | Train Loss: 0.252 Vali Loss: 1.110 Vali Acc: 0.500 Test Loss: 1.110 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 16.41897940635681
Epoch: 5, Steps: 10 | Train Loss: 0.097 Vali Loss: 1.321 Vali Acc: 0.500 Test Loss: 1.321 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 17.434106588363647
Epoch: 6, Steps: 10 | Train Loss: 0.054 Vali Loss: 1.202 Vali Acc: 0.554 Test Loss: 1.202 Test Acc: 0.554
Validation loss decreased (-0.527016 --> -0.554042).  Saving model ...
Epoch: 7 cost time: 16.401082754135132
Epoch: 7, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.173 Vali Acc: 0.595 Test Loss: 1.173 Test Acc: 0.595
Validation loss decreased (-0.554042 --> -0.594583).  Saving model ...
Epoch: 8 cost time: 14.935586214065552
Epoch: 8, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.221 Vali Acc: 0.554 Test Loss: 1.221 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 15.159613609313965
Epoch: 9, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.218 Vali Acc: 0.595 Test Loss: 1.218 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 14.511789798736572
Epoch: 10, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.206 Vali Acc: 0.608 Test Loss: 1.206 Test Acc: 0.608
Validation loss decreased (-0.594583 --> -0.608096).  Saving model ...
Epoch: 11 cost time: 15.201447486877441
Epoch: 11, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.925 Vali Acc: 0.649 Test Loss: 0.925 Test Acc: 0.649
Validation loss decreased (-0.608096 --> -0.648639).  Saving model ...
Epoch: 12 cost time: 15.588104486465454
Epoch: 12, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.938 Vali Acc: 0.649 Test Loss: 0.938 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 16.07067632675171
Epoch: 13, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.224 Vali Acc: 0.595 Test Loss: 1.224 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 16.917992115020752
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.055 Vali Acc: 0.635 Test Loss: 1.055 Test Acc: 0.635
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 16.554858207702637
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.076 Vali Acc: 0.608 Test Loss: 1.076 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 16.244860887527466
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.099 Vali Acc: 0.608 Test Loss: 1.099 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 16.68830108642578
Epoch: 17, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.125 Vali Acc: 0.595 Test Loss: 1.125 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 16.29323387145996
Epoch: 18, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.122 Vali Acc: 0.595 Test Loss: 1.122 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 17.406665563583374
Epoch: 19, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.122 Vali Acc: 0.608 Test Loss: 1.122 Test Acc: 0.608
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 16.416068077087402
Epoch: 20, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.121 Vali Acc: 0.608 Test Loss: 1.121 Test Acc: 0.608
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 16.59142231941223
Epoch: 21, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.118 Vali Acc: 0.608 Test Loss: 1.118 Test Acc: 0.608
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm128_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6486486486486487
model parameter : 28328964
model size : 110.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm128_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 7.855912923812866
Epoch: 1, Steps: 10 | Train Loss: 1.496 Vali Loss: 1.447 Vali Acc: 0.284 Test Loss: 1.447 Test Acc: 0.284
Validation loss decreased (inf --> -0.283769).  Saving model ...
Epoch: 2 cost time: 6.345473527908325
Epoch: 2, Steps: 10 | Train Loss: 1.086 Vali Loss: 1.139 Vali Acc: 0.527 Test Loss: 1.139 Test Acc: 0.527
Validation loss decreased (-0.283769 --> -0.527016).  Saving model ...
Epoch: 3 cost time: 6.41617488861084
Epoch: 3, Steps: 10 | Train Loss: 0.635 Vali Loss: 1.280 Vali Acc: 0.446 Test Loss: 1.280 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.022240877151489
Epoch: 4, Steps: 10 | Train Loss: 0.323 Vali Loss: 1.012 Vali Acc: 0.581 Test Loss: 1.012 Test Acc: 0.581
Validation loss decreased (-0.527016 --> -0.581071).  Saving model ...
Epoch: 5 cost time: 6.022588014602661
Epoch: 5, Steps: 10 | Train Loss: 0.152 Vali Loss: 1.341 Vali Acc: 0.527 Test Loss: 1.341 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.7865142822265625
Epoch: 6, Steps: 10 | Train Loss: 0.054 Vali Loss: 1.055 Vali Acc: 0.689 Test Loss: 1.055 Test Acc: 0.689
Validation loss decreased (-0.581071 --> -0.689179).  Saving model ...
Epoch: 7 cost time: 6.325100898742676
Epoch: 7, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.091 Vali Acc: 0.608 Test Loss: 1.091 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.075500726699829
Epoch: 8, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.078 Vali Acc: 0.608 Test Loss: 1.078 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 6.081614017486572
Epoch: 9, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.098 Vali Acc: 0.568 Test Loss: 1.098 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 6.152199745178223
Epoch: 10, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.203 Vali Acc: 0.568 Test Loss: 1.203 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 5.867575407028198
Epoch: 11, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.427 Vali Acc: 0.595 Test Loss: 1.427 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.937636137008667
Epoch: 12, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.889 Vali Acc: 0.514 Test Loss: 1.889 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 6.402420520782471
Epoch: 13, Steps: 10 | Train Loss: 0.046 Vali Loss: 1.326 Vali Acc: 0.581 Test Loss: 1.326 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 6.7455785274505615
Epoch: 14, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.213 Vali Acc: 0.649 Test Loss: 1.213 Test Acc: 0.649
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 6.501204252243042
Epoch: 15, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.424 Vali Acc: 0.662 Test Loss: 1.424 Test Acc: 0.662
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 6.4246742725372314
Epoch: 16, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.398 Vali Acc: 0.622 Test Loss: 1.398 Test Acc: 0.622
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm128_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6891891891891891
model parameter : 8470020
model size : 34.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm128_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 8.487696409225464
Epoch: 1, Steps: 10 | Train Loss: 1.454 Vali Loss: 1.348 Vali Acc: 0.392 Test Loss: 1.348 Test Acc: 0.392
Validation loss decreased (inf --> -0.391878).  Saving model ...
Epoch: 2 cost time: 10.179687261581421
Epoch: 2, Steps: 10 | Train Loss: 1.095 Vali Loss: 1.307 Vali Acc: 0.378 Test Loss: 1.307 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 10.460271835327148
Epoch: 3, Steps: 10 | Train Loss: 0.648 Vali Loss: 1.124 Vali Acc: 0.527 Test Loss: 1.124 Test Acc: 0.527
Validation loss decreased (-0.391878 --> -0.527016).  Saving model ...
Epoch: 4 cost time: 10.814615726470947
Epoch: 4, Steps: 10 | Train Loss: 0.360 Vali Loss: 1.139 Vali Acc: 0.500 Test Loss: 1.139 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 10.264342546463013
Epoch: 5, Steps: 10 | Train Loss: 0.158 Vali Loss: 1.189 Vali Acc: 0.500 Test Loss: 1.189 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 10.53625226020813
Epoch: 6, Steps: 10 | Train Loss: 0.062 Vali Loss: 1.119 Vali Acc: 0.541 Test Loss: 1.119 Test Acc: 0.541
Validation loss decreased (-0.527016 --> -0.540529).  Saving model ...
Epoch: 7 cost time: 10.282526016235352
Epoch: 7, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.053 Vali Acc: 0.554 Test Loss: 1.053 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554044).  Saving model ...
Epoch: 8 cost time: 9.854316711425781
Epoch: 8, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.341 Vali Acc: 0.581 Test Loss: 1.341 Test Acc: 0.581
Validation loss decreased (-0.554044 --> -0.581068).  Saving model ...
Epoch: 9 cost time: 9.448415994644165
Epoch: 9, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.230 Vali Acc: 0.568 Test Loss: 1.230 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 8.855648756027222
Epoch: 10, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.161 Vali Acc: 0.595 Test Loss: 1.161 Test Acc: 0.595
Validation loss decreased (-0.581068 --> -0.594583).  Saving model ...
Epoch: 11 cost time: 9.69139552116394
Epoch: 11, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.225 Vali Acc: 0.608 Test Loss: 1.225 Test Acc: 0.608
Validation loss decreased (-0.594583 --> -0.608096).  Saving model ...
Epoch: 12 cost time: 9.401674032211304
Epoch: 12, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.241 Vali Acc: 0.595 Test Loss: 1.241 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 10.559920072555542
Epoch: 13, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.222 Vali Acc: 0.581 Test Loss: 1.222 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 10.451815843582153
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.222 Vali Acc: 0.581 Test Loss: 1.222 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 10.267932891845703
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.228 Vali Acc: 0.595 Test Loss: 1.228 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 10.20720624923706
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.249 Vali Acc: 0.595 Test Loss: 1.249 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 10.395509243011475
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.241 Vali Acc: 0.595 Test Loss: 1.241 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 10.573863744735718
Epoch: 18, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.243 Vali Acc: 0.608 Test Loss: 1.243 Test Acc: 0.608
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 9.400800943374634
Epoch: 19, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.246 Vali Acc: 0.622 Test Loss: 1.246 Test Acc: 0.622
Validation loss decreased (-0.608096 --> -0.621609).  Saving model ...
Epoch: 20 cost time: 9.449961423873901
Epoch: 20, Steps: 10 | Train Loss: 0.296 Vali Loss: 1.426 Vali Acc: 0.541 Test Loss: 1.426 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 9.024724006652832
Epoch: 21, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.239 Vali Acc: 0.581 Test Loss: 1.239 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 9.229771137237549
Epoch: 22, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.760 Vali Acc: 0.514 Test Loss: 1.760 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 9.282816410064697
Epoch: 23, Steps: 10 | Train Loss: 0.351 Vali Loss: 1.277 Vali Acc: 0.568 Test Loss: 1.277 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 9.954609870910645
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.481 Vali Acc: 0.581 Test Loss: 1.481 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 10.456890106201172
Epoch: 25, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.899 Vali Acc: 0.514 Test Loss: 1.899 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 9.67884635925293
Epoch: 26, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.677 Vali Acc: 0.527 Test Loss: 1.677 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 8.496707201004028
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.711 Vali Acc: 0.541 Test Loss: 1.711 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 9.582707405090332
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.831 Vali Acc: 0.595 Test Loss: 1.831 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 9.592424392700195
Epoch: 29, Steps: 10 | Train Loss: 1.003 Vali Loss: 2.448 Vali Acc: 0.541 Test Loss: 2.448 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm128_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 28328964
model size : 110.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm128_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.972943305969238
Epoch: 1, Steps: 10 | Train Loss: 1.496 Vali Loss: 1.438 Vali Acc: 0.257 Test Loss: 1.438 Test Acc: 0.257
Validation loss decreased (inf --> -0.256742).  Saving model ...
Epoch: 2 cost time: 3.709538698196411
Epoch: 2, Steps: 10 | Train Loss: 1.107 Vali Loss: 1.125 Vali Acc: 0.527 Test Loss: 1.125 Test Acc: 0.527
Validation loss decreased (-0.256742 --> -0.527016).  Saving model ...
Epoch: 3 cost time: 3.728027105331421
Epoch: 3, Steps: 10 | Train Loss: 0.703 Vali Loss: 1.288 Vali Acc: 0.432 Test Loss: 1.288 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.7418019771575928
Epoch: 4, Steps: 10 | Train Loss: 0.388 Vali Loss: 0.995 Vali Acc: 0.554 Test Loss: 0.995 Test Acc: 0.554
Validation loss decreased (-0.527016 --> -0.554044).  Saving model ...
Epoch: 5 cost time: 3.5694515705108643
Epoch: 5, Steps: 10 | Train Loss: 0.163 Vali Loss: 1.268 Vali Acc: 0.568 Test Loss: 1.268 Test Acc: 0.568
Validation loss decreased (-0.554044 --> -0.567555).  Saving model ...
Epoch: 6 cost time: 4.229904413223267
Epoch: 6, Steps: 10 | Train Loss: 0.069 Vali Loss: 1.018 Vali Acc: 0.595 Test Loss: 1.018 Test Acc: 0.595
Validation loss decreased (-0.567555 --> -0.594584).  Saving model ...
Epoch: 7 cost time: 4.079272031784058
Epoch: 7, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.988 Vali Acc: 0.635 Test Loss: 0.988 Test Acc: 0.635
Validation loss decreased (-0.594584 --> -0.635125).  Saving model ...
Epoch: 8 cost time: 4.175109386444092
Epoch: 8, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.063 Vali Acc: 0.581 Test Loss: 1.063 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.153693675994873
Epoch: 9, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.090 Vali Acc: 0.595 Test Loss: 1.090 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.259503602981567
Epoch: 10, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.043 Vali Acc: 0.608 Test Loss: 1.043 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.209095001220703
Epoch: 11, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.046 Vali Acc: 0.595 Test Loss: 1.046 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.276336669921875
Epoch: 12, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.080 Vali Acc: 0.581 Test Loss: 1.080 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.10184121131897
Epoch: 13, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.080 Vali Acc: 0.581 Test Loss: 1.080 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.207207441329956
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.077 Vali Acc: 0.581 Test Loss: 1.077 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 4.337463140487671
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.093 Vali Acc: 0.581 Test Loss: 1.093 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 4.016525983810425
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.091 Vali Acc: 0.581 Test Loss: 1.091 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 4.366682529449463
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.111 Vali Acc: 0.581 Test Loss: 1.111 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm128_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6351351351351351
model parameter : 8470020
model size : 34.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm64_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 21.47510552406311
Epoch: 1, Steps: 10 | Train Loss: 1.479 Vali Loss: 1.374 Vali Acc: 0.392 Test Loss: 1.374 Test Acc: 0.392
Validation loss decreased (inf --> -0.391878).  Saving model ...
Epoch: 2 cost time: 22.161012411117554
Epoch: 2, Steps: 10 | Train Loss: 1.173 Vali Loss: 1.283 Vali Acc: 0.459 Test Loss: 1.283 Test Acc: 0.459
Validation loss decreased (-0.391878 --> -0.459447).  Saving model ...
Epoch: 3 cost time: 22.084957122802734
Epoch: 3, Steps: 10 | Train Loss: 0.775 Vali Loss: 1.129 Vali Acc: 0.527 Test Loss: 1.129 Test Acc: 0.527
Validation loss decreased (-0.459447 --> -0.527016).  Saving model ...
Epoch: 4 cost time: 22.68071222305298
Epoch: 4, Steps: 10 | Train Loss: 0.495 Vali Loss: 1.056 Vali Acc: 0.554 Test Loss: 1.056 Test Acc: 0.554
Validation loss decreased (-0.527016 --> -0.554043).  Saving model ...
Epoch: 5 cost time: 19.340734481811523
Epoch: 5, Steps: 10 | Train Loss: 0.256 Vali Loss: 1.009 Vali Acc: 0.608 Test Loss: 1.009 Test Acc: 0.608
Validation loss decreased (-0.554043 --> -0.608098).  Saving model ...
Epoch: 6 cost time: 19.768905639648438
Epoch: 6, Steps: 10 | Train Loss: 0.111 Vali Loss: 0.962 Vali Acc: 0.608 Test Loss: 0.962 Test Acc: 0.608
Validation loss decreased (-0.608098 --> -0.608098).  Saving model ...
Epoch: 7 cost time: 22.804553031921387
Epoch: 7, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.978 Vali Acc: 0.581 Test Loss: 0.978 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 23.390347957611084
Epoch: 8, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.073 Vali Acc: 0.541 Test Loss: 1.073 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 23.00032877922058
Epoch: 9, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.131 Vali Acc: 0.554 Test Loss: 1.131 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 19.988163471221924
Epoch: 10, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.155 Vali Acc: 0.554 Test Loss: 1.155 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 19.370334148406982
Epoch: 11, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.121 Vali Acc: 0.568 Test Loss: 1.121 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 22.86203956604004
Epoch: 12, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.098 Vali Acc: 0.595 Test Loss: 1.098 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 22.922509908676147
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.108 Vali Acc: 0.595 Test Loss: 1.108 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 21.667288064956665
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.131 Vali Acc: 0.608 Test Loss: 1.131 Test Acc: 0.608
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 22.31382417678833
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.118 Vali Acc: 0.608 Test Loss: 1.118 Test Acc: 0.608
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 22.34897017478943
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.118 Vali Acc: 0.608 Test Loss: 1.118 Test Acc: 0.608
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm64_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 28225412
model size : 108.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm64_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 10.602394819259644
Epoch: 1, Steps: 10 | Train Loss: 1.410 Vali Loss: 1.385 Vali Acc: 0.297 Test Loss: 1.385 Test Acc: 0.297
Validation loss decreased (inf --> -0.297283).  Saving model ...
Epoch: 2 cost time: 8.642348051071167
Epoch: 2, Steps: 10 | Train Loss: 1.185 Vali Loss: 1.255 Vali Acc: 0.419 Test Loss: 1.255 Test Acc: 0.419
Validation loss decreased (-0.297283 --> -0.418906).  Saving model ...
Epoch: 3 cost time: 8.77600359916687
Epoch: 3, Steps: 10 | Train Loss: 0.781 Vali Loss: 1.174 Vali Acc: 0.446 Test Loss: 1.174 Test Acc: 0.446
Validation loss decreased (-0.418906 --> -0.445934).  Saving model ...
Epoch: 4 cost time: 9.09407639503479
Epoch: 4, Steps: 10 | Train Loss: 0.469 Vali Loss: 1.096 Vali Acc: 0.473 Test Loss: 1.096 Test Acc: 0.473
Validation loss decreased (-0.445934 --> -0.472962).  Saving model ...
Epoch: 5 cost time: 8.933622121810913
Epoch: 5, Steps: 10 | Train Loss: 0.256 Vali Loss: 1.047 Vali Acc: 0.527 Test Loss: 1.047 Test Acc: 0.527
Validation loss decreased (-0.472962 --> -0.527017).  Saving model ...
Epoch: 6 cost time: 7.80797004699707
Epoch: 6, Steps: 10 | Train Loss: 0.118 Vali Loss: 1.009 Vali Acc: 0.581 Test Loss: 1.009 Test Acc: 0.581
Validation loss decreased (-0.527017 --> -0.581071).  Saving model ...
Epoch: 7 cost time: 7.544256687164307
Epoch: 7, Steps: 10 | Train Loss: 0.054 Vali Loss: 1.118 Vali Acc: 0.554 Test Loss: 1.118 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 7.30936861038208
Epoch: 8, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.977 Vali Acc: 0.595 Test Loss: 0.977 Test Acc: 0.595
Validation loss decreased (-0.581071 --> -0.594585).  Saving model ...
Epoch: 9 cost time: 7.185997009277344
Epoch: 9, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.044 Vali Acc: 0.581 Test Loss: 1.044 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 7.569012880325317
Epoch: 10, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.041 Vali Acc: 0.595 Test Loss: 1.041 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 9.406535863876343
Epoch: 11, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.011 Vali Acc: 0.635 Test Loss: 1.011 Test Acc: 0.635
Validation loss decreased (-0.594585 --> -0.635125).  Saving model ...
Epoch: 12 cost time: 8.93130898475647
Epoch: 12, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.041 Vali Acc: 0.608 Test Loss: 1.041 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 9.014174222946167
Epoch: 13, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.199 Vali Acc: 0.608 Test Loss: 1.199 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 8.722790002822876
Epoch: 14, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.028 Vali Acc: 0.635 Test Loss: 1.028 Test Acc: 0.635
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 8.950748682022095
Epoch: 15, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.056 Vali Acc: 0.635 Test Loss: 1.056 Test Acc: 0.635
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 8.805812358856201
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.036 Vali Acc: 0.608 Test Loss: 1.036 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 9.053663969039917
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.016 Vali Acc: 0.649 Test Loss: 1.016 Test Acc: 0.649
Validation loss decreased (-0.635125 --> -0.648638).  Saving model ...
Epoch: 18 cost time: 7.856675386428833
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.021 Vali Acc: 0.649 Test Loss: 1.021 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 7.736285924911499
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.030 Vali Acc: 0.649 Test Loss: 1.030 Test Acc: 0.649
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 7.665953159332275
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.045 Vali Acc: 0.662 Test Loss: 1.045 Test Acc: 0.662
Validation loss decreased (-0.648638 --> -0.662152).  Saving model ...
Epoch: 21 cost time: 7.933617115020752
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.049 Vali Acc: 0.662 Test Loss: 1.049 Test Acc: 0.662
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 7.646628379821777
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.059 Vali Acc: 0.649 Test Loss: 1.059 Test Acc: 0.649
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 9.142522811889648
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.062 Vali Acc: 0.649 Test Loss: 1.062 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 9.005814790725708
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.069 Vali Acc: 0.649 Test Loss: 1.069 Test Acc: 0.649
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 9.217267990112305
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.075 Vali Acc: 0.649 Test Loss: 1.075 Test Acc: 0.649
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 8.945476293563843
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.087 Vali Acc: 0.662 Test Loss: 1.087 Test Acc: 0.662
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 9.053627490997314
Epoch: 27, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.097 Vali Acc: 0.662 Test Loss: 1.097 Test Acc: 0.662
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 9.045989513397217
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.102 Vali Acc: 0.662 Test Loss: 1.102 Test Acc: 0.662
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 8.931816577911377
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.105 Vali Acc: 0.676 Test Loss: 1.105 Test Acc: 0.676
Validation loss decreased (-0.662152 --> -0.675665).  Saving model ...
Epoch: 30 cost time: 8.207823038101196
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.107 Vali Acc: 0.676 Test Loss: 1.107 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm64_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6756756756756757
model parameter : 8366084
model size : 33.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm64_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 16.642842769622803
Epoch: 1, Steps: 10 | Train Loss: 1.479 Vali Loss: 1.375 Vali Acc: 0.311 Test Loss: 1.375 Test Acc: 0.311
Validation loss decreased (inf --> -0.310797).  Saving model ...
Epoch: 2 cost time: 17.834792375564575
Epoch: 2, Steps: 10 | Train Loss: 1.169 Vali Loss: 1.275 Vali Acc: 0.419 Test Loss: 1.275 Test Acc: 0.419
Validation loss decreased (-0.310797 --> -0.418906).  Saving model ...
Epoch: 3 cost time: 17.772908210754395
Epoch: 3, Steps: 10 | Train Loss: 0.769 Vali Loss: 1.132 Vali Acc: 0.527 Test Loss: 1.132 Test Acc: 0.527
Validation loss decreased (-0.418906 --> -0.527016).  Saving model ...
Epoch: 4 cost time: 17.22015404701233
Epoch: 4, Steps: 10 | Train Loss: 0.502 Vali Loss: 1.042 Vali Acc: 0.568 Test Loss: 1.042 Test Acc: 0.568
Validation loss decreased (-0.527016 --> -0.567557).  Saving model ...
Epoch: 5 cost time: 17.262415170669556
Epoch: 5, Steps: 10 | Train Loss: 0.260 Vali Loss: 1.064 Vali Acc: 0.568 Test Loss: 1.064 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 14.537648677825928
Epoch: 6, Steps: 10 | Train Loss: 0.121 Vali Loss: 1.034 Vali Acc: 0.541 Test Loss: 1.034 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 15.125134229660034
Epoch: 7, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.951 Vali Acc: 0.554 Test Loss: 0.951 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 13.676594018936157
Epoch: 8, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.053 Vali Acc: 0.608 Test Loss: 1.053 Test Acc: 0.608
Validation loss decreased (-0.567557 --> -0.608098).  Saving model ...
Epoch: 9 cost time: 13.576181888580322
Epoch: 9, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.058 Vali Acc: 0.541 Test Loss: 1.058 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 10.171808004379272
Epoch: 10, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.977 Vali Acc: 0.622 Test Loss: 0.977 Test Acc: 0.622
Validation loss decreased (-0.608098 --> -0.621612).  Saving model ...
Epoch: 11 cost time: 10.609689474105835
Epoch: 11, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.968 Vali Acc: 0.635 Test Loss: 0.968 Test Acc: 0.635
Validation loss decreased (-0.621612 --> -0.635125).  Saving model ...
Epoch: 12 cost time: 16.361354112625122
Epoch: 12, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.999 Vali Acc: 0.608 Test Loss: 0.999 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 17.03585147857666
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.048 Vali Acc: 0.595 Test Loss: 1.048 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 16.177889108657837
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.037 Vali Acc: 0.595 Test Loss: 1.037 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 15.890384435653687
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.004 Vali Acc: 0.622 Test Loss: 1.004 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 16.510624885559082
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.014 Vali Acc: 0.622 Test Loss: 1.014 Test Acc: 0.622
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 16.44364094734192
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.034 Vali Acc: 0.608 Test Loss: 1.034 Test Acc: 0.608
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 16.817131996154785
Epoch: 18, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.419 Vali Acc: 0.595 Test Loss: 1.419 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 16.58583927154541
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.165 Vali Acc: 0.581 Test Loss: 1.165 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 16.9662446975708
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.155 Vali Acc: 0.649 Test Loss: 1.155 Test Acc: 0.649
Validation loss decreased (-0.635125 --> -0.648637).  Saving model ...
Epoch: 21 cost time: 16.480244874954224
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.182 Vali Acc: 0.635 Test Loss: 1.182 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 16.83434534072876
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.188 Vali Acc: 0.649 Test Loss: 1.188 Test Acc: 0.649
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 17.011444091796875
Epoch: 23, Steps: 10 | Train Loss: 0.084 Vali Loss: 1.245 Vali Acc: 0.595 Test Loss: 1.245 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 16.432225704193115
Epoch: 24, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.501 Vali Acc: 0.554 Test Loss: 1.501 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 16.056588888168335
Epoch: 25, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.208 Vali Acc: 0.608 Test Loss: 1.208 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 15.234254598617554
Epoch: 26, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.680 Vali Acc: 0.568 Test Loss: 1.680 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 15.570085763931274
Epoch: 27, Steps: 10 | Train Loss: 0.102 Vali Loss: 1.244 Vali Acc: 0.568 Test Loss: 1.244 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 15.076051235198975
Epoch: 28, Steps: 10 | Train Loss: 0.151 Vali Loss: 1.517 Vali Acc: 0.527 Test Loss: 1.517 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 15.863768339157104
Epoch: 29, Steps: 10 | Train Loss: 0.237 Vali Loss: 1.847 Vali Acc: 0.405 Test Loss: 1.847 Test Acc: 0.405
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 15.506128072738647
Epoch: 30, Steps: 10 | Train Loss: 0.070 Vali Loss: 1.844 Vali Acc: 0.527 Test Loss: 1.844 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm64_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6486486486486487
model parameter : 28225412
model size : 108.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm64_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 9.179264545440674
Epoch: 1, Steps: 10 | Train Loss: 1.413 Vali Loss: 1.382 Vali Acc: 0.324 Test Loss: 1.382 Test Acc: 0.324
Validation loss decreased (inf --> -0.324311).  Saving model ...
Epoch: 2 cost time: 7.093130111694336
Epoch: 2, Steps: 10 | Train Loss: 1.181 Vali Loss: 1.250 Vali Acc: 0.419 Test Loss: 1.250 Test Acc: 0.419
Validation loss decreased (-0.324311 --> -0.418906).  Saving model ...
Epoch: 3 cost time: 7.25912070274353
Epoch: 3, Steps: 10 | Train Loss: 0.774 Vali Loss: 1.165 Vali Acc: 0.459 Test Loss: 1.165 Test Acc: 0.459
Validation loss decreased (-0.418906 --> -0.459448).  Saving model ...
Epoch: 4 cost time: 7.260096549987793
Epoch: 4, Steps: 10 | Train Loss: 0.463 Vali Loss: 1.078 Vali Acc: 0.500 Test Loss: 1.078 Test Acc: 0.500
Validation loss decreased (-0.459448 --> -0.499989).  Saving model ...
Epoch: 5 cost time: 7.3142077922821045
Epoch: 5, Steps: 10 | Train Loss: 0.246 Vali Loss: 1.032 Vali Acc: 0.541 Test Loss: 1.032 Test Acc: 0.541
Validation loss decreased (-0.499989 --> -0.540530).  Saving model ...
Epoch: 6 cost time: 7.32862663269043
Epoch: 6, Steps: 10 | Train Loss: 0.124 Vali Loss: 0.997 Vali Acc: 0.554 Test Loss: 0.997 Test Acc: 0.554
Validation loss decreased (-0.540530 --> -0.554044).  Saving model ...
Epoch: 7 cost time: 7.547021150588989
Epoch: 7, Steps: 10 | Train Loss: 0.052 Vali Loss: 1.100 Vali Acc: 0.554 Test Loss: 1.100 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 7.8840906620025635
Epoch: 8, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.975 Vali Acc: 0.595 Test Loss: 0.975 Test Acc: 0.595
Validation loss decreased (-0.554044 --> -0.594585).  Saving model ...
Epoch: 9 cost time: 7.309030055999756
Epoch: 9, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.000 Vali Acc: 0.568 Test Loss: 1.000 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 7.490722894668579
Epoch: 10, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.949 Vali Acc: 0.541 Test Loss: 0.949 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 7.428469896316528
Epoch: 11, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.934 Vali Acc: 0.608 Test Loss: 0.934 Test Acc: 0.608
Validation loss decreased (-0.594585 --> -0.608099).  Saving model ...
Epoch: 12 cost time: 7.428785800933838
Epoch: 12, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.977 Vali Acc: 0.595 Test Loss: 0.977 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 7.319831609725952
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.011 Vali Acc: 0.568 Test Loss: 1.011 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 7.606307029724121
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.007 Vali Acc: 0.581 Test Loss: 1.007 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 7.373877048492432
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.992 Vali Acc: 0.581 Test Loss: 0.992 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 7.262423992156982
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.014 Vali Acc: 0.595 Test Loss: 1.014 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 7.15002179145813
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.033 Vali Acc: 0.608 Test Loss: 1.033 Test Acc: 0.608
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 7.633567810058594
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.039 Vali Acc: 0.608 Test Loss: 1.039 Test Acc: 0.608
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 7.8587610721588135
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.036 Vali Acc: 0.608 Test Loss: 1.036 Test Acc: 0.608
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 7.288439750671387
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.045 Vali Acc: 0.622 Test Loss: 1.045 Test Acc: 0.622
Validation loss decreased (-0.608099 --> -0.621611).  Saving model ...
Epoch: 21 cost time: 7.615548133850098
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.036 Vali Acc: 0.608 Test Loss: 1.036 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 7.597636699676514
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.045 Vali Acc: 0.622 Test Loss: 1.045 Test Acc: 0.622
Validation loss decreased (-0.621611 --> -0.621611).  Saving model ...
Epoch: 23 cost time: 7.448155164718628
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.068 Vali Acc: 0.622 Test Loss: 1.068 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 7.417701005935669
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.083 Vali Acc: 0.595 Test Loss: 1.083 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 7.6445910930633545
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.082 Vali Acc: 0.608 Test Loss: 1.082 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 7.77550196647644
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.088 Vali Acc: 0.595 Test Loss: 1.088 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 7.270423650741577
Epoch: 27, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.096 Vali Acc: 0.595 Test Loss: 1.096 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 7.137399911880493
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.096 Vali Acc: 0.595 Test Loss: 1.096 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 7.163212776184082
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.093 Vali Acc: 0.595 Test Loss: 1.093 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 6.9229559898376465
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.105 Vali Acc: 0.581 Test Loss: 1.105 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm64_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 8366084
model size : 33.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm64_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 13.023870468139648
Epoch: 1, Steps: 10 | Train Loss: 1.472 Vali Loss: 1.389 Vali Acc: 0.297 Test Loss: 1.389 Test Acc: 0.297
Validation loss decreased (inf --> -0.297283).  Saving model ...
Epoch: 2 cost time: 11.481024026870728
Epoch: 2, Steps: 10 | Train Loss: 1.245 Vali Loss: 1.313 Vali Acc: 0.419 Test Loss: 1.313 Test Acc: 0.419
Validation loss decreased (-0.297283 --> -0.418906).  Saving model ...
Epoch: 3 cost time: 11.5325608253479
Epoch: 3, Steps: 10 | Train Loss: 0.919 Vali Loss: 1.136 Vali Acc: 0.500 Test Loss: 1.136 Test Acc: 0.500
Validation loss decreased (-0.418906 --> -0.499989).  Saving model ...
Epoch: 4 cost time: 11.642749309539795
Epoch: 4, Steps: 10 | Train Loss: 0.657 Vali Loss: 1.087 Vali Acc: 0.541 Test Loss: 1.087 Test Acc: 0.541
Validation loss decreased (-0.499989 --> -0.540530).  Saving model ...
Epoch: 5 cost time: 11.391606330871582
Epoch: 5, Steps: 10 | Train Loss: 0.385 Vali Loss: 0.984 Vali Acc: 0.581 Test Loss: 0.984 Test Acc: 0.581
Validation loss decreased (-0.540530 --> -0.581071).  Saving model ...
Epoch: 6 cost time: 11.476627349853516
Epoch: 6, Steps: 10 | Train Loss: 0.193 Vali Loss: 0.960 Vali Acc: 0.581 Test Loss: 0.960 Test Acc: 0.581
Validation loss decreased (-0.581071 --> -0.581071).  Saving model ...
Epoch: 7 cost time: 11.216116189956665
Epoch: 7, Steps: 10 | Train Loss: 0.093 Vali Loss: 1.089 Vali Acc: 0.581 Test Loss: 1.089 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 11.738781929016113
Epoch: 8, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.871 Vali Acc: 0.581 Test Loss: 0.871 Test Acc: 0.581
Validation loss decreased (-0.581071 --> -0.581072).  Saving model ...
Epoch: 9 cost time: 12.349889278411865
Epoch: 9, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.016 Vali Acc: 0.581 Test Loss: 1.016 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 12.33712100982666
Epoch: 10, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.006 Vali Acc: 0.554 Test Loss: 1.006 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 12.168516159057617
Epoch: 11, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.957 Vali Acc: 0.635 Test Loss: 0.957 Test Acc: 0.635
Validation loss decreased (-0.581072 --> -0.635126).  Saving model ...
Epoch: 12 cost time: 12.411066770553589
Epoch: 12, Steps: 10 | Train Loss: 0.091 Vali Loss: 1.106 Vali Acc: 0.595 Test Loss: 1.106 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 12.02553915977478
Epoch: 13, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.062 Vali Acc: 0.581 Test Loss: 1.062 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 12.005707025527954
Epoch: 14, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.953 Vali Acc: 0.622 Test Loss: 0.953 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 12.056552410125732
Epoch: 15, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.146 Vali Acc: 0.595 Test Loss: 1.146 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 12.004803895950317
Epoch: 16, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.357 Vali Acc: 0.622 Test Loss: 1.357 Test Acc: 0.622
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 12.511544704437256
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.288 Vali Acc: 0.581 Test Loss: 1.288 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 12.420480251312256
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.251 Vali Acc: 0.581 Test Loss: 1.251 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 12.536094188690186
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.286 Vali Acc: 0.568 Test Loss: 1.286 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 11.999070882797241
Epoch: 20, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.126 Vali Acc: 0.649 Test Loss: 1.126 Test Acc: 0.649
Validation loss decreased (-0.635126 --> -0.648637).  Saving model ...
Epoch: 21 cost time: 12.114075660705566
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.282 Vali Acc: 0.595 Test Loss: 1.282 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 12.112115144729614
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.282 Vali Acc: 0.595 Test Loss: 1.282 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 12.337061405181885
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.259 Vali Acc: 0.608 Test Loss: 1.259 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 12.494218587875366
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.195 Vali Acc: 0.622 Test Loss: 1.195 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 11.929048776626587
Epoch: 25, Steps: 10 | Train Loss: 0.131 Vali Loss: 1.358 Vali Acc: 0.595 Test Loss: 1.358 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 11.99868392944336
Epoch: 26, Steps: 10 | Train Loss: 0.398 Vali Loss: 1.139 Vali Acc: 0.622 Test Loss: 1.139 Test Acc: 0.622
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 12.220051765441895
Epoch: 27, Steps: 10 | Train Loss: 0.056 Vali Loss: 1.636 Vali Acc: 0.541 Test Loss: 1.636 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 11.696507215499878
Epoch: 28, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.526 Vali Acc: 0.514 Test Loss: 1.526 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 11.585206747055054
Epoch: 29, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.293 Vali Acc: 0.581 Test Loss: 1.293 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 11.471564054489136
Epoch: 30, Steps: 10 | Train Loss: 0.314 Vali Loss: 1.358 Vali Acc: 0.595 Test Loss: 1.358 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm64_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6486486486486487
model parameter : 28225412
model size : 108.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm64_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 6.364699602127075
Epoch: 1, Steps: 10 | Train Loss: 1.404 Vali Loss: 1.377 Vali Acc: 0.351 Test Loss: 1.377 Test Acc: 0.351
Validation loss decreased (inf --> -0.351338).  Saving model ...
Epoch: 2 cost time: 4.9265806674957275
Epoch: 2, Steps: 10 | Train Loss: 1.226 Vali Loss: 1.274 Vali Acc: 0.405 Test Loss: 1.274 Test Acc: 0.405
Validation loss decreased (-0.351338 --> -0.405393).  Saving model ...
Epoch: 3 cost time: 4.600189208984375
Epoch: 3, Steps: 10 | Train Loss: 0.908 Vali Loss: 1.182 Vali Acc: 0.473 Test Loss: 1.182 Test Acc: 0.473
Validation loss decreased (-0.405393 --> -0.472961).  Saving model ...
Epoch: 4 cost time: 4.628048658370972
Epoch: 4, Steps: 10 | Train Loss: 0.617 Vali Loss: 1.092 Vali Acc: 0.541 Test Loss: 1.092 Test Acc: 0.541
Validation loss decreased (-0.472961 --> -0.540530).  Saving model ...
Epoch: 5 cost time: 5.228935956954956
Epoch: 5, Steps: 10 | Train Loss: 0.380 Vali Loss: 1.037 Vali Acc: 0.568 Test Loss: 1.037 Test Acc: 0.568
Validation loss decreased (-0.540530 --> -0.567557).  Saving model ...
Epoch: 6 cost time: 5.205566644668579
Epoch: 6, Steps: 10 | Train Loss: 0.218 Vali Loss: 0.953 Vali Acc: 0.595 Test Loss: 0.953 Test Acc: 0.595
Validation loss decreased (-0.567557 --> -0.594585).  Saving model ...
Epoch: 7 cost time: 5.047543048858643
Epoch: 7, Steps: 10 | Train Loss: 0.110 Vali Loss: 1.045 Vali Acc: 0.608 Test Loss: 1.045 Test Acc: 0.608
Validation loss decreased (-0.594585 --> -0.608098).  Saving model ...
Epoch: 8 cost time: 4.825283765792847
Epoch: 8, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.954 Vali Acc: 0.595 Test Loss: 0.954 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.843871593475342
Epoch: 9, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.994 Vali Acc: 0.649 Test Loss: 0.994 Test Acc: 0.649
Validation loss decreased (-0.608098 --> -0.648639).  Saving model ...
Epoch: 10 cost time: 4.859891176223755
Epoch: 10, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.975 Vali Acc: 0.608 Test Loss: 0.975 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.124236822128296
Epoch: 11, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.973 Vali Acc: 0.595 Test Loss: 0.973 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.957452058792114
Epoch: 12, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.996 Vali Acc: 0.622 Test Loss: 0.996 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.85883092880249
Epoch: 13, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.969 Vali Acc: 0.595 Test Loss: 0.969 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 5.070769548416138
Epoch: 14, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.986 Vali Acc: 0.581 Test Loss: 0.986 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 5.389769792556763
Epoch: 15, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.989 Vali Acc: 0.595 Test Loss: 0.989 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.9929211139678955
Epoch: 16, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.978 Vali Acc: 0.595 Test Loss: 0.978 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 5.12674355506897
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.992 Vali Acc: 0.595 Test Loss: 0.992 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 5.2623045444488525
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.017 Vali Acc: 0.608 Test Loss: 1.017 Test Acc: 0.608
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 5.241819858551025
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.014 Vali Acc: 0.595 Test Loss: 1.014 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm64_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6486486486486487
model parameter : 8366084
model size : 33.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm64_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 16.223323345184326
Epoch: 1, Steps: 10 | Train Loss: 1.453 Vali Loss: 1.392 Vali Acc: 0.270 Test Loss: 1.392 Test Acc: 0.270
Validation loss decreased (inf --> -0.270256).  Saving model ...
Epoch: 2 cost time: 15.023326635360718
Epoch: 2, Steps: 10 | Train Loss: 1.224 Vali Loss: 1.282 Vali Acc: 0.473 Test Loss: 1.282 Test Acc: 0.473
Validation loss decreased (-0.270256 --> -0.472960).  Saving model ...
Epoch: 3 cost time: 13.015901327133179
Epoch: 3, Steps: 10 | Train Loss: 0.827 Vali Loss: 1.159 Vali Acc: 0.514 Test Loss: 1.159 Test Acc: 0.514
Validation loss decreased (-0.472960 --> -0.513502).  Saving model ...
Epoch: 4 cost time: 13.937540769577026
Epoch: 4, Steps: 10 | Train Loss: 0.519 Vali Loss: 1.092 Vali Acc: 0.595 Test Loss: 1.092 Test Acc: 0.595
Validation loss decreased (-0.513502 --> -0.594584).  Saving model ...
Epoch: 5 cost time: 13.294156074523926
Epoch: 5, Steps: 10 | Train Loss: 0.303 Vali Loss: 1.073 Vali Acc: 0.568 Test Loss: 1.073 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 13.47208046913147
Epoch: 6, Steps: 10 | Train Loss: 0.165 Vali Loss: 1.139 Vali Acc: 0.554 Test Loss: 1.139 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 13.819552421569824
Epoch: 7, Steps: 10 | Train Loss: 0.075 Vali Loss: 1.121 Vali Acc: 0.622 Test Loss: 1.121 Test Acc: 0.622
Validation loss decreased (-0.594584 --> -0.621610).  Saving model ...
Epoch: 8 cost time: 13.775797128677368
Epoch: 8, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.003 Vali Acc: 0.568 Test Loss: 1.003 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 13.702913522720337
Epoch: 9, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.090 Vali Acc: 0.581 Test Loss: 1.090 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 13.432815074920654
Epoch: 10, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.098 Vali Acc: 0.608 Test Loss: 1.098 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 13.84446668624878
Epoch: 11, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.096 Vali Acc: 0.595 Test Loss: 1.096 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 13.353898048400879
Epoch: 12, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.123 Vali Acc: 0.595 Test Loss: 1.123 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 13.154648303985596
Epoch: 13, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.144 Vali Acc: 0.608 Test Loss: 1.144 Test Acc: 0.608
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 12.469224214553833
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.126 Vali Acc: 0.595 Test Loss: 1.126 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 13.01965045928955
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.128 Vali Acc: 0.581 Test Loss: 1.128 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 12.830212593078613
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.142 Vali Acc: 0.581 Test Loss: 1.142 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 12.814204454421997
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.151 Vali Acc: 0.581 Test Loss: 1.151 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm64_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 14165636
model size : 55.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm64_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 6.67145562171936
Epoch: 1, Steps: 10 | Train Loss: 1.497 Vali Loss: 1.407 Vali Acc: 0.284 Test Loss: 1.407 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 5.15123176574707
Epoch: 2, Steps: 10 | Train Loss: 1.271 Vali Loss: 1.295 Vali Acc: 0.405 Test Loss: 1.295 Test Acc: 0.405
Validation loss decreased (-0.283770 --> -0.405392).  Saving model ...
Epoch: 3 cost time: 5.343142986297607
Epoch: 3, Steps: 10 | Train Loss: 0.926 Vali Loss: 1.172 Vali Acc: 0.554 Test Loss: 1.172 Test Acc: 0.554
Validation loss decreased (-0.405392 --> -0.554042).  Saving model ...
Epoch: 4 cost time: 5.400487899780273
Epoch: 4, Steps: 10 | Train Loss: 0.624 Vali Loss: 1.054 Vali Acc: 0.622 Test Loss: 1.054 Test Acc: 0.622
Validation loss decreased (-0.554042 --> -0.621611).  Saving model ...
Epoch: 5 cost time: 5.277407169342041
Epoch: 5, Steps: 10 | Train Loss: 0.356 Vali Loss: 1.074 Vali Acc: 0.554 Test Loss: 1.074 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.330358266830444
Epoch: 6, Steps: 10 | Train Loss: 0.185 Vali Loss: 0.980 Vali Acc: 0.595 Test Loss: 0.980 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.923456192016602
Epoch: 7, Steps: 10 | Train Loss: 0.092 Vali Loss: 0.978 Vali Acc: 0.568 Test Loss: 0.978 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 5.611140012741089
Epoch: 8, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.009 Vali Acc: 0.568 Test Loss: 1.009 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 5.641037464141846
Epoch: 9, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.035 Vali Acc: 0.581 Test Loss: 1.035 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 5.813191890716553
Epoch: 10, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.063 Vali Acc: 0.608 Test Loss: 1.063 Test Acc: 0.608
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 5.715166091918945
Epoch: 11, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.021 Vali Acc: 0.595 Test Loss: 1.021 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 5.647838830947876
Epoch: 12, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.055 Vali Acc: 0.581 Test Loss: 1.055 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 5.916638612747192
Epoch: 13, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.078 Vali Acc: 0.595 Test Loss: 1.078 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 5.715858697891235
Epoch: 14, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.084 Vali Acc: 0.581 Test Loss: 1.084 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm64_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 4235780
model size : 17.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm64_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 11.381566524505615
Epoch: 1, Steps: 10 | Train Loss: 1.452 Vali Loss: 1.387 Vali Acc: 0.297 Test Loss: 1.387 Test Acc: 0.297
Validation loss decreased (inf --> -0.297283).  Saving model ...
Epoch: 2 cost time: 10.063216209411621
Epoch: 2, Steps: 10 | Train Loss: 1.231 Vali Loss: 1.286 Vali Acc: 0.432 Test Loss: 1.286 Test Acc: 0.432
Validation loss decreased (-0.297283 --> -0.432420).  Saving model ...
Epoch: 3 cost time: 9.831815242767334
Epoch: 3, Steps: 10 | Train Loss: 0.845 Vali Loss: 1.157 Vali Acc: 0.541 Test Loss: 1.157 Test Acc: 0.541
Validation loss decreased (-0.432420 --> -0.540529).  Saving model ...
Epoch: 4 cost time: 10.05522608757019
Epoch: 4, Steps: 10 | Train Loss: 0.561 Vali Loss: 1.094 Vali Acc: 0.581 Test Loss: 1.094 Test Acc: 0.581
Validation loss decreased (-0.540529 --> -0.581070).  Saving model ...
Epoch: 5 cost time: 9.937472581863403
Epoch: 5, Steps: 10 | Train Loss: 0.329 Vali Loss: 1.095 Vali Acc: 0.581 Test Loss: 1.095 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 9.780014991760254
Epoch: 6, Steps: 10 | Train Loss: 0.203 Vali Loss: 1.145 Vali Acc: 0.541 Test Loss: 1.145 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 10.195770502090454
Epoch: 7, Steps: 10 | Train Loss: 0.110 Vali Loss: 1.186 Vali Acc: 0.541 Test Loss: 1.186 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 10.10155963897705
Epoch: 8, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.971 Vali Acc: 0.527 Test Loss: 0.971 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 9.81993055343628
Epoch: 9, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.085 Vali Acc: 0.595 Test Loss: 1.085 Test Acc: 0.595
Validation loss decreased (-0.581070 --> -0.594584).  Saving model ...
Epoch: 10 cost time: 10.335994243621826
Epoch: 10, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.111 Vali Acc: 0.622 Test Loss: 1.111 Test Acc: 0.622
Validation loss decreased (-0.594584 --> -0.621611).  Saving model ...
Epoch: 11 cost time: 10.213648796081543
Epoch: 11, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.047 Vali Acc: 0.581 Test Loss: 1.047 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 9.754794120788574
Epoch: 12, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.153 Vali Acc: 0.622 Test Loss: 1.153 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 9.237691640853882
Epoch: 13, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.111 Vali Acc: 0.595 Test Loss: 1.111 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 9.730364799499512
Epoch: 14, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.218 Vali Acc: 0.581 Test Loss: 1.218 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 10.518434762954712
Epoch: 15, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.095 Vali Acc: 0.635 Test Loss: 1.095 Test Acc: 0.635
Validation loss decreased (-0.621611 --> -0.635124).  Saving model ...
Epoch: 16 cost time: 9.993562698364258
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.057 Vali Acc: 0.649 Test Loss: 1.057 Test Acc: 0.649
Validation loss decreased (-0.635124 --> -0.648638).  Saving model ...
Epoch: 17 cost time: 9.91539216041565
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.191 Vali Acc: 0.581 Test Loss: 1.191 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 10.03577709197998
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.105 Vali Acc: 0.608 Test Loss: 1.105 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 10.065156698226929
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.077 Vali Acc: 0.649 Test Loss: 1.077 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 10.011875629425049
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.116 Vali Acc: 0.622 Test Loss: 1.116 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 10.10273289680481
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.151 Vali Acc: 0.622 Test Loss: 1.151 Test Acc: 0.622
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 10.210578918457031
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.161 Vali Acc: 0.622 Test Loss: 1.161 Test Acc: 0.622
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 9.748573780059814
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.148 Vali Acc: 0.635 Test Loss: 1.148 Test Acc: 0.635
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 10.076362371444702
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.142 Vali Acc: 0.635 Test Loss: 1.142 Test Acc: 0.635
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 9.885294437408447
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.238 Vali Acc: 0.608 Test Loss: 1.238 Test Acc: 0.608
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 10.00303030014038
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.451 Vali Acc: 0.595 Test Loss: 1.451 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm64_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6486486486486487
model parameter : 14165636
model size : 55.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm64_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.943429470062256
Epoch: 1, Steps: 10 | Train Loss: 1.497 Vali Loss: 1.405 Vali Acc: 0.257 Test Loss: 1.405 Test Acc: 0.257
Validation loss decreased (inf --> -0.256743).  Saving model ...
Epoch: 2 cost time: 4.4558351039886475
Epoch: 2, Steps: 10 | Train Loss: 1.277 Vali Loss: 1.296 Vali Acc: 0.392 Test Loss: 1.296 Test Acc: 0.392
Validation loss decreased (-0.256743 --> -0.391879).  Saving model ...
Epoch: 3 cost time: 4.168323278427124
Epoch: 3, Steps: 10 | Train Loss: 0.927 Vali Loss: 1.168 Vali Acc: 0.527 Test Loss: 1.168 Test Acc: 0.527
Validation loss decreased (-0.391879 --> -0.527015).  Saving model ...
Epoch: 4 cost time: 4.603047609329224
Epoch: 4, Steps: 10 | Train Loss: 0.616 Vali Loss: 1.052 Vali Acc: 0.581 Test Loss: 1.052 Test Acc: 0.581
Validation loss decreased (-0.527015 --> -0.581071).  Saving model ...
Epoch: 5 cost time: 4.795257091522217
Epoch: 5, Steps: 10 | Train Loss: 0.355 Vali Loss: 1.071 Vali Acc: 0.527 Test Loss: 1.071 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.701101779937744
Epoch: 6, Steps: 10 | Train Loss: 0.181 Vali Loss: 0.975 Vali Acc: 0.554 Test Loss: 0.975 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.492652416229248
Epoch: 7, Steps: 10 | Train Loss: 0.094 Vali Loss: 0.967 Vali Acc: 0.581 Test Loss: 0.967 Test Acc: 0.581
Validation loss decreased (-0.581071 --> -0.581071).  Saving model ...
Epoch: 8 cost time: 4.444336652755737
Epoch: 8, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.952 Vali Acc: 0.608 Test Loss: 0.952 Test Acc: 0.608
Validation loss decreased (-0.581071 --> -0.608099).  Saving model ...
Epoch: 9 cost time: 4.798044681549072
Epoch: 9, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.053 Vali Acc: 0.554 Test Loss: 1.053 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.720898628234863
Epoch: 10, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.008 Vali Acc: 0.622 Test Loss: 1.008 Test Acc: 0.622
Validation loss decreased (-0.608099 --> -0.621612).  Saving model ...
Epoch: 11 cost time: 4.698062181472778
Epoch: 11, Steps: 10 | Train Loss: 0.043 Vali Loss: 1.072 Vali Acc: 0.554 Test Loss: 1.072 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.550156354904175
Epoch: 12, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.090 Vali Acc: 0.527 Test Loss: 1.090 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.97612452507019
Epoch: 13, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.116 Vali Acc: 0.568 Test Loss: 1.116 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.679943323135376
Epoch: 14, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.045 Vali Acc: 0.635 Test Loss: 1.045 Test Acc: 0.635
Validation loss decreased (-0.621612 --> -0.635125).  Saving model ...
Epoch: 15 cost time: 4.564366340637207
Epoch: 15, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.044 Vali Acc: 0.635 Test Loss: 1.044 Test Acc: 0.635
Validation loss decreased (-0.635125 --> -0.635125).  Saving model ...
Epoch: 16 cost time: 4.487436056137085
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.062 Vali Acc: 0.581 Test Loss: 1.062 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.754867315292358
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.073 Vali Acc: 0.554 Test Loss: 1.073 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.71186637878418
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.059 Vali Acc: 0.608 Test Loss: 1.059 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 4.438624858856201
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.070 Vali Acc: 0.622 Test Loss: 1.070 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 4.4928834438323975
Epoch: 20, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.436 Vali Acc: 0.541 Test Loss: 1.436 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 4.616732835769653
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.067 Vali Acc: 0.608 Test Loss: 1.067 Test Acc: 0.608
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 4.66546630859375
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.065 Vali Acc: 0.568 Test Loss: 1.065 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 4.71339750289917
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.125 Vali Acc: 0.595 Test Loss: 1.125 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 4.546763896942139
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.154 Vali Acc: 0.595 Test Loss: 1.154 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 4.619318723678589
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.133 Vali Acc: 0.595 Test Loss: 1.133 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm64_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6351351351351351
model parameter : 4235780
model size : 17.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm64_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 8.567036628723145
Epoch: 1, Steps: 10 | Train Loss: 1.452 Vali Loss: 1.392 Vali Acc: 0.257 Test Loss: 1.392 Test Acc: 0.257
Validation loss decreased (inf --> -0.256743).  Saving model ...
Epoch: 2 cost time: 7.144926309585571
Epoch: 2, Steps: 10 | Train Loss: 1.268 Vali Loss: 1.290 Vali Acc: 0.446 Test Loss: 1.290 Test Acc: 0.446
Validation loss decreased (-0.256743 --> -0.445933).  Saving model ...
Epoch: 3 cost time: 6.947325229644775
Epoch: 3, Steps: 10 | Train Loss: 0.931 Vali Loss: 1.167 Vali Acc: 0.527 Test Loss: 1.167 Test Acc: 0.527
Validation loss decreased (-0.445933 --> -0.527015).  Saving model ...
Epoch: 4 cost time: 7.07551908493042
Epoch: 4, Steps: 10 | Train Loss: 0.648 Vali Loss: 1.104 Vali Acc: 0.581 Test Loss: 1.104 Test Acc: 0.581
Validation loss decreased (-0.527015 --> -0.581070).  Saving model ...
Epoch: 5 cost time: 6.985905170440674
Epoch: 5, Steps: 10 | Train Loss: 0.427 Vali Loss: 1.075 Vali Acc: 0.608 Test Loss: 1.075 Test Acc: 0.608
Validation loss decreased (-0.581070 --> -0.608097).  Saving model ...
Epoch: 6 cost time: 6.826294422149658
Epoch: 6, Steps: 10 | Train Loss: 0.259 Vali Loss: 1.098 Vali Acc: 0.595 Test Loss: 1.098 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.905672788619995
Epoch: 7, Steps: 10 | Train Loss: 0.137 Vali Loss: 1.011 Vali Acc: 0.635 Test Loss: 1.011 Test Acc: 0.635
Validation loss decreased (-0.608097 --> -0.635125).  Saving model ...
Epoch: 8 cost time: 6.742265701293945
Epoch: 8, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.935 Vali Acc: 0.635 Test Loss: 0.935 Test Acc: 0.635
Validation loss decreased (-0.635125 --> -0.635126).  Saving model ...
Epoch: 9 cost time: 7.221939563751221
Epoch: 9, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.049 Vali Acc: 0.635 Test Loss: 1.049 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.611859083175659
Epoch: 10, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.047 Vali Acc: 0.608 Test Loss: 1.047 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.635192394256592
Epoch: 11, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.027 Vali Acc: 0.662 Test Loss: 1.027 Test Acc: 0.662
Validation loss decreased (-0.635126 --> -0.662152).  Saving model ...
Epoch: 12 cost time: 6.694281816482544
Epoch: 12, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.135 Vali Acc: 0.635 Test Loss: 1.135 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.588744163513184
Epoch: 13, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.092 Vali Acc: 0.635 Test Loss: 1.092 Test Acc: 0.635
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 6.635896921157837
Epoch: 14, Steps: 10 | Train Loss: 0.077 Vali Loss: 1.106 Vali Acc: 0.622 Test Loss: 1.106 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 6.6653056144714355
Epoch: 15, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.134 Vali Acc: 0.635 Test Loss: 1.134 Test Acc: 0.635
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 6.574989318847656
Epoch: 16, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.128 Vali Acc: 0.649 Test Loss: 1.128 Test Acc: 0.649
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 6.681024789810181
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.155 Vali Acc: 0.649 Test Loss: 1.155 Test Acc: 0.649
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 6.903810024261475
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.200 Vali Acc: 0.649 Test Loss: 1.200 Test Acc: 0.649
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 6.699033260345459
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.174 Vali Acc: 0.649 Test Loss: 1.174 Test Acc: 0.649
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 6.683385372161865
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.180 Vali Acc: 0.649 Test Loss: 1.180 Test Acc: 0.649
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 6.759120464324951
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.204 Vali Acc: 0.649 Test Loss: 1.204 Test Acc: 0.649
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm64_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6621621621621622
model parameter : 14165636
model size : 55.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm64_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.45108437538147
Epoch: 1, Steps: 10 | Train Loss: 1.499 Vali Loss: 1.413 Vali Acc: 0.270 Test Loss: 1.413 Test Acc: 0.270
Validation loss decreased (inf --> -0.270256).  Saving model ...
Epoch: 2 cost time: 3.130798816680908
Epoch: 2, Steps: 10 | Train Loss: 1.297 Vali Loss: 1.306 Vali Acc: 0.378 Test Loss: 1.306 Test Acc: 0.378
Validation loss decreased (-0.270256 --> -0.378365).  Saving model ...
Epoch: 3 cost time: 3.0701611042022705
Epoch: 3, Steps: 10 | Train Loss: 0.995 Vali Loss: 1.184 Vali Acc: 0.486 Test Loss: 1.184 Test Acc: 0.486
Validation loss decreased (-0.378365 --> -0.486475).  Saving model ...
Epoch: 4 cost time: 3.4478838443756104
Epoch: 4, Steps: 10 | Train Loss: 0.711 Vali Loss: 1.069 Vali Acc: 0.622 Test Loss: 1.069 Test Acc: 0.622
Validation loss decreased (-0.486475 --> -0.621611).  Saving model ...
Epoch: 5 cost time: 3.5036609172821045
Epoch: 5, Steps: 10 | Train Loss: 0.453 Vali Loss: 1.079 Vali Acc: 0.514 Test Loss: 1.079 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.270148992538452
Epoch: 6, Steps: 10 | Train Loss: 0.275 Vali Loss: 0.984 Vali Acc: 0.595 Test Loss: 0.984 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.4221079349517822
Epoch: 7, Steps: 10 | Train Loss: 0.156 Vali Loss: 0.971 Vali Acc: 0.608 Test Loss: 0.971 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.186535358428955
Epoch: 8, Steps: 10 | Train Loss: 0.068 Vali Loss: 0.964 Vali Acc: 0.554 Test Loss: 0.964 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.3457179069519043
Epoch: 9, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.022 Vali Acc: 0.595 Test Loss: 1.022 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.3995323181152344
Epoch: 10, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.034 Vali Acc: 0.554 Test Loss: 1.034 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.258824586868286
Epoch: 11, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.983 Vali Acc: 0.581 Test Loss: 0.983 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.398988723754883
Epoch: 12, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.015 Vali Acc: 0.608 Test Loss: 1.015 Test Acc: 0.608
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.444830894470215
Epoch: 13, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.035 Vali Acc: 0.581 Test Loss: 1.035 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 3.5207338333129883
Epoch: 14, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.001 Vali Acc: 0.595 Test Loss: 1.001 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm64_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 4235780
model size : 17.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm64_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 10.967989921569824
Epoch: 1, Steps: 10 | Train Loss: 1.417 Vali Loss: 1.369 Vali Acc: 0.351 Test Loss: 1.369 Test Acc: 0.351
Validation loss decreased (inf --> -0.351338).  Saving model ...
Epoch: 2 cost time: 9.24340271949768
Epoch: 2, Steps: 10 | Train Loss: 1.218 Vali Loss: 1.308 Vali Acc: 0.419 Test Loss: 1.308 Test Acc: 0.419
Validation loss decreased (-0.351338 --> -0.418906).  Saving model ...
Epoch: 3 cost time: 8.807586908340454
Epoch: 3, Steps: 10 | Train Loss: 0.910 Vali Loss: 1.242 Vali Acc: 0.446 Test Loss: 1.242 Test Acc: 0.446
Validation loss decreased (-0.418906 --> -0.445934).  Saving model ...
Epoch: 4 cost time: 8.456480264663696
Epoch: 4, Steps: 10 | Train Loss: 0.603 Vali Loss: 1.153 Vali Acc: 0.527 Test Loss: 1.153 Test Acc: 0.527
Validation loss decreased (-0.445934 --> -0.527015).  Saving model ...
Epoch: 5 cost time: 8.11436676979065
Epoch: 5, Steps: 10 | Train Loss: 0.356 Vali Loss: 1.114 Vali Acc: 0.473 Test Loss: 1.114 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 8.60914134979248
Epoch: 6, Steps: 10 | Train Loss: 0.203 Vali Loss: 1.139 Vali Acc: 0.541 Test Loss: 1.139 Test Acc: 0.541
Validation loss decreased (-0.527015 --> -0.540529).  Saving model ...
Epoch: 7 cost time: 8.473893642425537
Epoch: 7, Steps: 10 | Train Loss: 0.085 Vali Loss: 1.056 Vali Acc: 0.514 Test Loss: 1.056 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 8.928957462310791
Epoch: 8, Steps: 10 | Train Loss: 0.040 Vali Loss: 1.239 Vali Acc: 0.514 Test Loss: 1.239 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 8.71414589881897
Epoch: 9, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.323 Vali Acc: 0.500 Test Loss: 1.323 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 8.457388877868652
Epoch: 10, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.207 Vali Acc: 0.514 Test Loss: 1.207 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 8.748623132705688
Epoch: 11, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.141 Vali Acc: 0.514 Test Loss: 1.141 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 8.894858837127686
Epoch: 12, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.169 Vali Acc: 0.554 Test Loss: 1.169 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554042).  Saving model ...
Epoch: 13 cost time: 8.42167353630066
Epoch: 13, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.241 Vali Acc: 0.554 Test Loss: 1.241 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 8.485689878463745
Epoch: 14, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.197 Vali Acc: 0.541 Test Loss: 1.197 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 8.718446254730225
Epoch: 15, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.188 Vali Acc: 0.554 Test Loss: 1.188 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 8.280241012573242
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.210 Vali Acc: 0.554 Test Loss: 1.210 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 8.58168077468872
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.233 Vali Acc: 0.568 Test Loss: 1.233 Test Acc: 0.568
Validation loss decreased (-0.554042 --> -0.567555).  Saving model ...
Epoch: 18 cost time: 8.689756631851196
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.241 Vali Acc: 0.568 Test Loss: 1.241 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 7.849699258804321
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.237 Vali Acc: 0.554 Test Loss: 1.237 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 7.711189031600952
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.241 Vali Acc: 0.554 Test Loss: 1.241 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 8.119507312774658
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.247 Vali Acc: 0.595 Test Loss: 1.247 Test Acc: 0.595
Validation loss decreased (-0.567555 --> -0.594582).  Saving model ...
Epoch: 22 cost time: 8.277820587158203
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.246 Vali Acc: 0.595 Test Loss: 1.246 Test Acc: 0.595
Validation loss decreased (-0.594582 --> -0.594582).  Saving model ...
Epoch: 23 cost time: 7.98121452331543
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.248 Vali Acc: 0.581 Test Loss: 1.248 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 7.950538635253906
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.254 Vali Acc: 0.568 Test Loss: 1.254 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 7.563822269439697
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.252 Vali Acc: 0.554 Test Loss: 1.252 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 7.941972017288208
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.246 Vali Acc: 0.554 Test Loss: 1.246 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 7.706138610839844
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.232 Vali Acc: 0.568 Test Loss: 1.232 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 7.9338788986206055
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.236 Vali Acc: 0.568 Test Loss: 1.236 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 8.131718873977661
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.243 Vali Acc: 0.554 Test Loss: 1.243 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 7.946395397186279
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.242 Vali Acc: 0.554 Test Loss: 1.242 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm64_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 7135748
model size : 28.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm64_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.325028896331787
Epoch: 1, Steps: 10 | Train Loss: 1.403 Vali Loss: 1.382 Vali Acc: 0.270 Test Loss: 1.382 Test Acc: 0.270
Validation loss decreased (inf --> -0.270256).  Saving model ...
Epoch: 2 cost time: 3.8504602909088135
Epoch: 2, Steps: 10 | Train Loss: 1.205 Vali Loss: 1.275 Vali Acc: 0.432 Test Loss: 1.275 Test Acc: 0.432
Validation loss decreased (-0.270256 --> -0.432420).  Saving model ...
Epoch: 3 cost time: 3.8550286293029785
Epoch: 3, Steps: 10 | Train Loss: 0.886 Vali Loss: 1.146 Vali Acc: 0.459 Test Loss: 1.146 Test Acc: 0.459
Validation loss decreased (-0.432420 --> -0.459448).  Saving model ...
Epoch: 4 cost time: 3.710083484649658
Epoch: 4, Steps: 10 | Train Loss: 0.606 Vali Loss: 1.181 Vali Acc: 0.527 Test Loss: 1.181 Test Acc: 0.527
Validation loss decreased (-0.459448 --> -0.527015).  Saving model ...
Epoch: 5 cost time: 3.6105470657348633
Epoch: 5, Steps: 10 | Train Loss: 0.386 Vali Loss: 1.021 Vali Acc: 0.486 Test Loss: 1.021 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.6134867668151855
Epoch: 6, Steps: 10 | Train Loss: 0.187 Vali Loss: 1.028 Vali Acc: 0.568 Test Loss: 1.028 Test Acc: 0.568
Validation loss decreased (-0.527015 --> -0.567557).  Saving model ...
Epoch: 7 cost time: 4.054214239120483
Epoch: 7, Steps: 10 | Train Loss: 0.086 Vali Loss: 1.003 Vali Acc: 0.608 Test Loss: 1.003 Test Acc: 0.608
Validation loss decreased (-0.567557 --> -0.608098).  Saving model ...
Epoch: 8 cost time: 3.909548282623291
Epoch: 8, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.029 Vali Acc: 0.581 Test Loss: 1.029 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.790583372116089
Epoch: 9, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.031 Vali Acc: 0.581 Test Loss: 1.031 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.0095789432525635
Epoch: 10, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.059 Vali Acc: 0.541 Test Loss: 1.059 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.7744827270507812
Epoch: 11, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.067 Vali Acc: 0.595 Test Loss: 1.067 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.841299057006836
Epoch: 12, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.080 Vali Acc: 0.581 Test Loss: 1.080 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.7766573429107666
Epoch: 13, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.068 Vali Acc: 0.568 Test Loss: 1.068 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.923513650894165
Epoch: 14, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.081 Vali Acc: 0.554 Test Loss: 1.081 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.853667974472046
Epoch: 15, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.086 Vali Acc: 0.541 Test Loss: 1.086 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.6819944381713867
Epoch: 16, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.092 Vali Acc: 0.581 Test Loss: 1.092 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.65863037109375
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.099 Vali Acc: 0.568 Test Loss: 1.099 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm64_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 2170628
model size : 9.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm64_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 7.927931785583496
Epoch: 1, Steps: 10 | Train Loss: 1.418 Vali Loss: 1.369 Vali Acc: 0.365 Test Loss: 1.369 Test Acc: 0.365
Validation loss decreased (inf --> -0.364851).  Saving model ...
Epoch: 2 cost time: 6.52979302406311
Epoch: 2, Steps: 10 | Train Loss: 1.217 Vali Loss: 1.308 Vali Acc: 0.405 Test Loss: 1.308 Test Acc: 0.405
Validation loss decreased (-0.364851 --> -0.405392).  Saving model ...
Epoch: 3 cost time: 6.304538011550903
Epoch: 3, Steps: 10 | Train Loss: 0.909 Vali Loss: 1.246 Vali Acc: 0.459 Test Loss: 1.246 Test Acc: 0.459
Validation loss decreased (-0.405392 --> -0.459447).  Saving model ...
Epoch: 4 cost time: 6.571434736251831
Epoch: 4, Steps: 10 | Train Loss: 0.602 Vali Loss: 1.149 Vali Acc: 0.527 Test Loss: 1.149 Test Acc: 0.527
Validation loss decreased (-0.459447 --> -0.527016).  Saving model ...
Epoch: 5 cost time: 6.5516722202301025
Epoch: 5, Steps: 10 | Train Loss: 0.367 Vali Loss: 1.118 Vali Acc: 0.486 Test Loss: 1.118 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.315067291259766
Epoch: 6, Steps: 10 | Train Loss: 0.200 Vali Loss: 1.136 Vali Acc: 0.459 Test Loss: 1.136 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.558781862258911
Epoch: 7, Steps: 10 | Train Loss: 0.092 Vali Loss: 1.123 Vali Acc: 0.541 Test Loss: 1.123 Test Acc: 0.541
Validation loss decreased (-0.527016 --> -0.540529).  Saving model ...
Epoch: 8 cost time: 6.776201009750366
Epoch: 8, Steps: 10 | Train Loss: 0.046 Vali Loss: 1.274 Vali Acc: 0.514 Test Loss: 1.274 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.436146020889282
Epoch: 9, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.194 Vali Acc: 0.541 Test Loss: 1.194 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.600682258605957
Epoch: 10, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.250 Vali Acc: 0.541 Test Loss: 1.250 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 6.555395841598511
Epoch: 11, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.271 Vali Acc: 0.500 Test Loss: 1.271 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 6.582024812698364
Epoch: 12, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.185 Vali Acc: 0.541 Test Loss: 1.185 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 6.5516602993011475
Epoch: 13, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.182 Vali Acc: 0.568 Test Loss: 1.182 Test Acc: 0.568
Validation loss decreased (-0.540529 --> -0.567556).  Saving model ...
Epoch: 14 cost time: 6.931554794311523
Epoch: 14, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.198 Vali Acc: 0.554 Test Loss: 1.198 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.754707336425781
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.209 Vali Acc: 0.554 Test Loss: 1.209 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 6.645169734954834
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.215 Vali Acc: 0.595 Test Loss: 1.215 Test Acc: 0.595
Validation loss decreased (-0.567556 --> -0.594582).  Saving model ...
Epoch: 17 cost time: 6.035832166671753
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.237 Vali Acc: 0.554 Test Loss: 1.237 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 6.225047826766968
Epoch: 18, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.398 Vali Acc: 0.541 Test Loss: 1.398 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 5.996116638183594
Epoch: 19, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.359 Vali Acc: 0.527 Test Loss: 1.359 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 5.849173545837402
Epoch: 20, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.562 Vali Acc: 0.473 Test Loss: 1.562 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 5.983180999755859
Epoch: 21, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.281 Vali Acc: 0.514 Test Loss: 1.281 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 6.010918617248535
Epoch: 22, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.320 Vali Acc: 0.527 Test Loss: 1.320 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 6.018409967422485
Epoch: 23, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.663 Vali Acc: 0.486 Test Loss: 1.663 Test Acc: 0.486
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 6.041707515716553
Epoch: 24, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.514 Vali Acc: 0.514 Test Loss: 1.514 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 5.88953971862793
Epoch: 25, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.911 Vali Acc: 0.486 Test Loss: 1.911 Test Acc: 0.486
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 5.8881731033325195
Epoch: 26, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.635 Vali Acc: 0.514 Test Loss: 1.635 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm64_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 7135748
model size : 28.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm64_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.145702838897705
Epoch: 1, Steps: 10 | Train Loss: 1.407 Vali Loss: 1.383 Vali Acc: 0.270 Test Loss: 1.383 Test Acc: 0.270
Validation loss decreased (inf --> -0.270256).  Saving model ...
Epoch: 2 cost time: 2.6765623092651367
Epoch: 2, Steps: 10 | Train Loss: 1.204 Vali Loss: 1.273 Vali Acc: 0.419 Test Loss: 1.273 Test Acc: 0.419
Validation loss decreased (-0.270256 --> -0.418906).  Saving model ...
Epoch: 3 cost time: 2.7124385833740234
Epoch: 3, Steps: 10 | Train Loss: 0.885 Vali Loss: 1.146 Vali Acc: 0.486 Test Loss: 1.146 Test Acc: 0.486
Validation loss decreased (-0.418906 --> -0.486475).  Saving model ...
Epoch: 4 cost time: 2.799307107925415
Epoch: 4, Steps: 10 | Train Loss: 0.603 Vali Loss: 1.176 Vali Acc: 0.514 Test Loss: 1.176 Test Acc: 0.514
Validation loss decreased (-0.486475 --> -0.513502).  Saving model ...
Epoch: 5 cost time: 2.77268123626709
Epoch: 5, Steps: 10 | Train Loss: 0.383 Vali Loss: 1.018 Vali Acc: 0.554 Test Loss: 1.018 Test Acc: 0.554
Validation loss decreased (-0.513502 --> -0.554044).  Saving model ...
Epoch: 6 cost time: 2.6907880306243896
Epoch: 6, Steps: 10 | Train Loss: 0.182 Vali Loss: 1.026 Vali Acc: 0.554 Test Loss: 1.026 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.070436716079712
Epoch: 7, Steps: 10 | Train Loss: 0.088 Vali Loss: 1.010 Vali Acc: 0.554 Test Loss: 1.010 Test Acc: 0.554
Validation loss decreased (-0.554044 --> -0.554044).  Saving model ...
Epoch: 8 cost time: 3.004032850265503
Epoch: 8, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.043 Vali Acc: 0.568 Test Loss: 1.043 Test Acc: 0.568
Validation loss decreased (-0.554044 --> -0.567557).  Saving model ...
Epoch: 9 cost time: 2.9890689849853516
Epoch: 9, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.030 Vali Acc: 0.554 Test Loss: 1.030 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.0045034885406494
Epoch: 10, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.046 Vali Acc: 0.568 Test Loss: 1.046 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.969066858291626
Epoch: 11, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.060 Vali Acc: 0.608 Test Loss: 1.060 Test Acc: 0.608
Validation loss decreased (-0.567557 --> -0.608098).  Saving model ...
Epoch: 12 cost time: 2.9784963130950928
Epoch: 12, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.065 Vali Acc: 0.608 Test Loss: 1.065 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.034822702407837
Epoch: 13, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.055 Vali Acc: 0.581 Test Loss: 1.055 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.9019081592559814
Epoch: 14, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.063 Vali Acc: 0.595 Test Loss: 1.063 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.0812301635742188
Epoch: 15, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.065 Vali Acc: 0.608 Test Loss: 1.065 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.9322898387908936
Epoch: 16, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.070 Vali Acc: 0.622 Test Loss: 1.070 Test Acc: 0.622
Validation loss decreased (-0.608098 --> -0.621611).  Saving model ...
Epoch: 17 cost time: 3.044400215148926
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.075 Vali Acc: 0.608 Test Loss: 1.075 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.1872172355651855
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.069 Vali Acc: 0.608 Test Loss: 1.069 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.979912519454956
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.076 Vali Acc: 0.608 Test Loss: 1.076 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.8350539207458496
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.059 Vali Acc: 0.649 Test Loss: 1.059 Test Acc: 0.649
Validation loss decreased (-0.621611 --> -0.648638).  Saving model ...
Epoch: 21 cost time: 2.937044858932495
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.082 Vali Acc: 0.662 Test Loss: 1.082 Test Acc: 0.662
Validation loss decreased (-0.648638 --> -0.662151).  Saving model ...
Epoch: 22 cost time: 2.8464787006378174
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.127 Vali Acc: 0.608 Test Loss: 1.127 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.0768041610717773
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.139 Vali Acc: 0.595 Test Loss: 1.139 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.02270245552063
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.107 Vali Acc: 0.649 Test Loss: 1.107 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.0166962146759033
Epoch: 25, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.611 Vali Acc: 0.554 Test Loss: 1.611 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.0688509941101074
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.268 Vali Acc: 0.595 Test Loss: 1.268 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.849210500717163
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.228 Vali Acc: 0.608 Test Loss: 1.228 Test Acc: 0.608
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.9838831424713135
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.215 Vali Acc: 0.608 Test Loss: 1.215 Test Acc: 0.608
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 2.9819672107696533
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.246 Vali Acc: 0.622 Test Loss: 1.246 Test Acc: 0.622
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 2.9430782794952393
Epoch: 30, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.322 Vali Acc: 0.635 Test Loss: 1.322 Test Acc: 0.635
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm64_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6621621621621622
model parameter : 2170628
model size : 9.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm64_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.726980686187744
Epoch: 1, Steps: 10 | Train Loss: 1.413 Vali Loss: 1.370 Vali Acc: 0.324 Test Loss: 1.370 Test Acc: 0.324
Validation loss decreased (inf --> -0.324311).  Saving model ...
Epoch: 2 cost time: 4.476930379867554
Epoch: 2, Steps: 10 | Train Loss: 1.239 Vali Loss: 1.310 Vali Acc: 0.392 Test Loss: 1.310 Test Acc: 0.392
Validation loss decreased (-0.324311 --> -0.391879).  Saving model ...
Epoch: 3 cost time: 4.389036178588867
Epoch: 3, Steps: 10 | Train Loss: 0.973 Vali Loss: 1.231 Vali Acc: 0.473 Test Loss: 1.231 Test Acc: 0.473
Validation loss decreased (-0.391879 --> -0.472961).  Saving model ...
Epoch: 4 cost time: 4.3919031620025635
Epoch: 4, Steps: 10 | Train Loss: 0.688 Vali Loss: 1.128 Vali Acc: 0.541 Test Loss: 1.128 Test Acc: 0.541
Validation loss decreased (-0.472961 --> -0.540529).  Saving model ...
Epoch: 5 cost time: 4.515614986419678
Epoch: 5, Steps: 10 | Train Loss: 0.456 Vali Loss: 1.105 Vali Acc: 0.486 Test Loss: 1.105 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.452121019363403
Epoch: 6, Steps: 10 | Train Loss: 0.293 Vali Loss: 1.136 Vali Acc: 0.527 Test Loss: 1.136 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.415423154830933
Epoch: 7, Steps: 10 | Train Loss: 0.147 Vali Loss: 1.036 Vali Acc: 0.514 Test Loss: 1.036 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.586641788482666
Epoch: 8, Steps: 10 | Train Loss: 0.070 Vali Loss: 1.103 Vali Acc: 0.527 Test Loss: 1.103 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.375790596008301
Epoch: 9, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.153 Vali Acc: 0.514 Test Loss: 1.153 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.465018033981323
Epoch: 10, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.174 Vali Acc: 0.554 Test Loss: 1.174 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554042).  Saving model ...
Epoch: 11 cost time: 4.453348398208618
Epoch: 11, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.213 Vali Acc: 0.527 Test Loss: 1.213 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.429433584213257
Epoch: 12, Steps: 10 | Train Loss: 0.076 Vali Loss: 1.240 Vali Acc: 0.554 Test Loss: 1.240 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.431871652603149
Epoch: 13, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.242 Vali Acc: 0.500 Test Loss: 1.242 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.413698673248291
Epoch: 14, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.182 Vali Acc: 0.554 Test Loss: 1.182 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 4.323244571685791
Epoch: 15, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.246 Vali Acc: 0.595 Test Loss: 1.246 Test Acc: 0.595
Validation loss decreased (-0.554042 --> -0.594582).  Saving model ...
Epoch: 16 cost time: 4.29411506652832
Epoch: 16, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.245 Vali Acc: 0.595 Test Loss: 1.245 Test Acc: 0.595
Validation loss decreased (-0.594582 --> -0.594582).  Saving model ...
Epoch: 17 cost time: 4.546271800994873
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.180 Vali Acc: 0.554 Test Loss: 1.180 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.411435127258301
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.192 Vali Acc: 0.568 Test Loss: 1.192 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 4.632596492767334
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.219 Vali Acc: 0.622 Test Loss: 1.219 Test Acc: 0.622
Validation loss decreased (-0.594582 --> -0.621609).  Saving model ...
Epoch: 20 cost time: 4.530941486358643
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.241 Vali Acc: 0.608 Test Loss: 1.241 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 4.440074682235718
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.239 Vali Acc: 0.622 Test Loss: 1.239 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 4.063058853149414
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.224 Vali Acc: 0.608 Test Loss: 1.224 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 4.312820911407471
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.224 Vali Acc: 0.608 Test Loss: 1.224 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 4.27539587020874
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.240 Vali Acc: 0.622 Test Loss: 1.240 Test Acc: 0.622
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 4.243002653121948
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.256 Vali Acc: 0.608 Test Loss: 1.256 Test Acc: 0.608
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 3.995208263397217
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.246 Vali Acc: 0.608 Test Loss: 1.246 Test Acc: 0.608
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 3.927441358566284
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.242 Vali Acc: 0.595 Test Loss: 1.242 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 4.201850175857544
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.252 Vali Acc: 0.608 Test Loss: 1.252 Test Acc: 0.608
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 3.621612548828125
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.266 Vali Acc: 0.608 Test Loss: 1.266 Test Acc: 0.608
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm64_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 7135748
model size : 28.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm64_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.304819345474243
Epoch: 1, Steps: 10 | Train Loss: 1.397 Vali Loss: 1.390 Vali Acc: 0.270 Test Loss: 1.390 Test Acc: 0.270
Validation loss decreased (inf --> -0.270256).  Saving model ...
Epoch: 2 cost time: 1.8527419567108154
Epoch: 2, Steps: 10 | Train Loss: 1.211 Vali Loss: 1.275 Vali Acc: 0.473 Test Loss: 1.275 Test Acc: 0.473
Validation loss decreased (-0.270256 --> -0.472960).  Saving model ...
Epoch: 3 cost time: 1.9149878025054932
Epoch: 3, Steps: 10 | Train Loss: 0.922 Vali Loss: 1.152 Vali Acc: 0.459 Test Loss: 1.152 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8600664138793945
Epoch: 4, Steps: 10 | Train Loss: 0.661 Vali Loss: 1.185 Vali Acc: 0.527 Test Loss: 1.185 Test Acc: 0.527
Validation loss decreased (-0.472960 --> -0.527015).  Saving model ...
Epoch: 5 cost time: 1.971092939376831
Epoch: 5, Steps: 10 | Train Loss: 0.458 Vali Loss: 1.019 Vali Acc: 0.541 Test Loss: 1.019 Test Acc: 0.541
Validation loss decreased (-0.527015 --> -0.540530).  Saving model ...
Epoch: 6 cost time: 2.057511806488037
Epoch: 6, Steps: 10 | Train Loss: 0.242 Vali Loss: 1.021 Vali Acc: 0.595 Test Loss: 1.021 Test Acc: 0.595
Validation loss decreased (-0.540530 --> -0.594584).  Saving model ...
Epoch: 7 cost time: 1.9081463813781738
Epoch: 7, Steps: 10 | Train Loss: 0.130 Vali Loss: 0.964 Vali Acc: 0.568 Test Loss: 0.964 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.9169838428497314
Epoch: 8, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.991 Vali Acc: 0.581 Test Loss: 0.991 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.9823949337005615
Epoch: 9, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.023 Vali Acc: 0.595 Test Loss: 1.023 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.9094455242156982
Epoch: 10, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.980 Vali Acc: 0.635 Test Loss: 0.980 Test Acc: 0.635
Validation loss decreased (-0.594584 --> -0.635125).  Saving model ...
Epoch: 11 cost time: 1.9394822120666504
Epoch: 11, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.000 Vali Acc: 0.608 Test Loss: 1.000 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.9715003967285156
Epoch: 12, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.018 Vali Acc: 0.608 Test Loss: 1.018 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.9046401977539062
Epoch: 13, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.976 Vali Acc: 0.622 Test Loss: 0.976 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.9482989311218262
Epoch: 14, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.007 Vali Acc: 0.622 Test Loss: 1.007 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.9591240882873535
Epoch: 15, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.020 Vali Acc: 0.635 Test Loss: 1.020 Test Acc: 0.635
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.758826494216919
Epoch: 16, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.000 Vali Acc: 0.649 Test Loss: 1.000 Test Acc: 0.649
Validation loss decreased (-0.635125 --> -0.648639).  Saving model ...
Epoch: 17 cost time: 2.104961395263672
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.010 Vali Acc: 0.649 Test Loss: 1.010 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.150557279586792
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.999 Vali Acc: 0.622 Test Loss: 0.999 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.200758695602417
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.005 Vali Acc: 0.622 Test Loss: 1.005 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.114746332168579
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.008 Vali Acc: 0.622 Test Loss: 1.008 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.149709939956665
Epoch: 21, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.052 Vali Acc: 0.649 Test Loss: 1.052 Test Acc: 0.649
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.1639182567596436
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.108 Vali Acc: 0.581 Test Loss: 1.108 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.0999755859375
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.095 Vali Acc: 0.595 Test Loss: 1.095 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.1211111545562744
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.050 Vali Acc: 0.635 Test Loss: 1.050 Test Acc: 0.635
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.9932749271392822
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.044 Vali Acc: 0.608 Test Loss: 1.044 Test Acc: 0.608
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.05570650100708
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.045 Vali Acc: 0.595 Test Loss: 1.045 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm64_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6486486486486487
model parameter : 2170628
model size : 9.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm32_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 13.019383907318115
Epoch: 1, Steps: 10 | Train Loss: 1.432 Vali Loss: 1.428 Vali Acc: 0.176 Test Loss: 1.428 Test Acc: 0.176
Validation loss decreased (inf --> -0.175661).  Saving model ...
Epoch: 2 cost time: 11.446174383163452
Epoch: 2, Steps: 10 | Train Loss: 1.296 Vali Loss: 1.293 Vali Acc: 0.432 Test Loss: 1.293 Test Acc: 0.432
Validation loss decreased (-0.175661 --> -0.432420).  Saving model ...
Epoch: 3 cost time: 11.509002208709717
Epoch: 3, Steps: 10 | Train Loss: 1.082 Vali Loss: 1.289 Vali Acc: 0.392 Test Loss: 1.289 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 11.251410007476807
Epoch: 4, Steps: 10 | Train Loss: 0.830 Vali Loss: 1.176 Vali Acc: 0.554 Test Loss: 1.176 Test Acc: 0.554
Validation loss decreased (-0.432420 --> -0.554042).  Saving model ...
Epoch: 5 cost time: 11.139830589294434
Epoch: 5, Steps: 10 | Train Loss: 0.644 Vali Loss: 1.129 Vali Acc: 0.554 Test Loss: 1.129 Test Acc: 0.554
Validation loss decreased (-0.554042 --> -0.554043).  Saving model ...
Epoch: 6 cost time: 11.314918518066406
Epoch: 6, Steps: 10 | Train Loss: 0.450 Vali Loss: 1.058 Vali Acc: 0.541 Test Loss: 1.058 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 11.673374891281128
Epoch: 7, Steps: 10 | Train Loss: 0.323 Vali Loss: 1.009 Vali Acc: 0.622 Test Loss: 1.009 Test Acc: 0.622
Validation loss decreased (-0.554043 --> -0.621612).  Saving model ...
Epoch: 8 cost time: 11.347461462020874
Epoch: 8, Steps: 10 | Train Loss: 0.199 Vali Loss: 0.980 Vali Acc: 0.635 Test Loss: 0.980 Test Acc: 0.635
Validation loss decreased (-0.621612 --> -0.635125).  Saving model ...
Epoch: 9 cost time: 11.058506488800049
Epoch: 9, Steps: 10 | Train Loss: 0.116 Vali Loss: 0.989 Vali Acc: 0.595 Test Loss: 0.989 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 11.595930814743042
Epoch: 10, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.991 Vali Acc: 0.581 Test Loss: 0.991 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 11.457003593444824
Epoch: 11, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.985 Vali Acc: 0.635 Test Loss: 0.985 Test Acc: 0.635
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 11.31704068183899
Epoch: 12, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.995 Vali Acc: 0.622 Test Loss: 0.995 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 11.382079362869263
Epoch: 13, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.988 Vali Acc: 0.622 Test Loss: 0.988 Test Acc: 0.622
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 11.065461874008179
Epoch: 14, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.014 Vali Acc: 0.595 Test Loss: 1.014 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 10.105860948562622
Epoch: 15, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.033 Vali Acc: 0.595 Test Loss: 1.033 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 10.828621864318848
Epoch: 16, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.025 Vali Acc: 0.608 Test Loss: 1.025 Test Acc: 0.608
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 10.423202753067017
Epoch: 17, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.076 Vali Acc: 0.581 Test Loss: 1.076 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 10.314160108566284
Epoch: 18, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.184 Vali Acc: 0.608 Test Loss: 1.184 Test Acc: 0.608
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm32_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6351351351351351
model parameter : 7083972
model size : 27.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm32_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 8.69047212600708
Epoch: 1, Steps: 10 | Train Loss: 1.397 Vali Loss: 1.401 Vali Acc: 0.297 Test Loss: 1.401 Test Acc: 0.297
Validation loss decreased (inf --> -0.297283).  Saving model ...
Epoch: 2 cost time: 7.050925254821777
Epoch: 2, Steps: 10 | Train Loss: 1.270 Vali Loss: 1.398 Vali Acc: 0.243 Test Loss: 1.398 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.148962020874023
Epoch: 3, Steps: 10 | Train Loss: 1.086 Vali Loss: 1.304 Vali Acc: 0.419 Test Loss: 1.304 Test Acc: 0.419
Validation loss decreased (-0.297283 --> -0.418906).  Saving model ...
Epoch: 4 cost time: 7.2082929611206055
Epoch: 4, Steps: 10 | Train Loss: 0.885 Vali Loss: 1.238 Vali Acc: 0.486 Test Loss: 1.238 Test Acc: 0.486
Validation loss decreased (-0.418906 --> -0.486474).  Saving model ...
Epoch: 5 cost time: 7.088935375213623
Epoch: 5, Steps: 10 | Train Loss: 0.682 Vali Loss: 1.239 Vali Acc: 0.486 Test Loss: 1.239 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.932977676391602
Epoch: 6, Steps: 10 | Train Loss: 0.499 Vali Loss: 1.122 Vali Acc: 0.527 Test Loss: 1.122 Test Acc: 0.527
Validation loss decreased (-0.486474 --> -0.527016).  Saving model ...
Epoch: 7 cost time: 7.4032204151153564
Epoch: 7, Steps: 10 | Train Loss: 0.330 Vali Loss: 1.150 Vali Acc: 0.527 Test Loss: 1.150 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.897946834564209
Epoch: 8, Steps: 10 | Train Loss: 0.209 Vali Loss: 1.072 Vali Acc: 0.541 Test Loss: 1.072 Test Acc: 0.541
Validation loss decreased (-0.527016 --> -0.540530).  Saving model ...
Epoch: 9 cost time: 7.648127794265747
Epoch: 9, Steps: 10 | Train Loss: 0.121 Vali Loss: 1.133 Vali Acc: 0.527 Test Loss: 1.133 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 7.797220706939697
Epoch: 10, Steps: 10 | Train Loss: 0.074 Vali Loss: 1.066 Vali Acc: 0.514 Test Loss: 1.066 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 7.724499225616455
Epoch: 11, Steps: 10 | Train Loss: 0.042 Vali Loss: 1.106 Vali Acc: 0.554 Test Loss: 1.106 Test Acc: 0.554
Validation loss decreased (-0.540530 --> -0.554043).  Saving model ...
Epoch: 12 cost time: 7.719946384429932
Epoch: 12, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.107 Vali Acc: 0.541 Test Loss: 1.107 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 7.900381326675415
Epoch: 13, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.109 Vali Acc: 0.568 Test Loss: 1.109 Test Acc: 0.568
Validation loss decreased (-0.554043 --> -0.567556).  Saving model ...
Epoch: 14 cost time: 8.160521030426025
Epoch: 14, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.110 Vali Acc: 0.554 Test Loss: 1.110 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 7.65825629234314
Epoch: 15, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.117 Vali Acc: 0.581 Test Loss: 1.117 Test Acc: 0.581
Validation loss decreased (-0.567556 --> -0.581070).  Saving model ...
Epoch: 16 cost time: 7.94653844833374
Epoch: 16, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.127 Vali Acc: 0.581 Test Loss: 1.127 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 8.010246515274048
Epoch: 17, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.127 Vali Acc: 0.595 Test Loss: 1.127 Test Acc: 0.595
Validation loss decreased (-0.581070 --> -0.594583).  Saving model ...
Epoch: 18 cost time: 7.744196891784668
Epoch: 18, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.127 Vali Acc: 0.581 Test Loss: 1.127 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 7.494680643081665
Epoch: 19, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.125 Vali Acc: 0.595 Test Loss: 1.125 Test Acc: 0.595
Validation loss decreased (-0.594583 --> -0.594583).  Saving model ...
Epoch: 20 cost time: 7.772115707397461
Epoch: 20, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.123 Vali Acc: 0.581 Test Loss: 1.123 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 8.252462387084961
Epoch: 21, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.162 Vali Acc: 0.554 Test Loss: 1.162 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 7.563642263412476
Epoch: 22, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.182 Vali Acc: 0.568 Test Loss: 1.182 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 7.778449058532715
Epoch: 23, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.190 Vali Acc: 0.581 Test Loss: 1.190 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 8.07268214225769
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.192 Vali Acc: 0.568 Test Loss: 1.192 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 7.8127806186676025
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.198 Vali Acc: 0.581 Test Loss: 1.198 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 7.561583042144775
Epoch: 26, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.197 Vali Acc: 0.568 Test Loss: 1.197 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 7.840017080307007
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.206 Vali Acc: 0.568 Test Loss: 1.206 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 8.14445972442627
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.216 Vali Acc: 0.554 Test Loss: 1.216 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 7.8503196239471436
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.222 Vali Acc: 0.554 Test Loss: 1.222 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm32_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 2118660
model size : 8.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm32_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 10.053629398345947
Epoch: 1, Steps: 10 | Train Loss: 1.432 Vali Loss: 1.428 Vali Acc: 0.189 Test Loss: 1.428 Test Acc: 0.189
Validation loss decreased (inf --> -0.189175).  Saving model ...
Epoch: 2 cost time: 8.057444334030151
Epoch: 2, Steps: 10 | Train Loss: 1.297 Vali Loss: 1.297 Vali Acc: 0.432 Test Loss: 1.297 Test Acc: 0.432
Validation loss decreased (-0.189175 --> -0.432419).  Saving model ...
Epoch: 3 cost time: 8.18310260772705
Epoch: 3, Steps: 10 | Train Loss: 1.100 Vali Loss: 1.294 Vali Acc: 0.432 Test Loss: 1.294 Test Acc: 0.432
Validation loss decreased (-0.432419 --> -0.432419).  Saving model ...
Epoch: 4 cost time: 8.463789701461792
Epoch: 4, Steps: 10 | Train Loss: 0.855 Vali Loss: 1.179 Vali Acc: 0.541 Test Loss: 1.179 Test Acc: 0.541
Validation loss decreased (-0.432419 --> -0.540529).  Saving model ...
Epoch: 5 cost time: 8.62441372871399
Epoch: 5, Steps: 10 | Train Loss: 0.686 Vali Loss: 1.134 Vali Acc: 0.541 Test Loss: 1.134 Test Acc: 0.541
Validation loss decreased (-0.540529 --> -0.540529).  Saving model ...
Epoch: 6 cost time: 8.161033391952515
Epoch: 6, Steps: 10 | Train Loss: 0.483 Vali Loss: 1.080 Vali Acc: 0.554 Test Loss: 1.080 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554043).  Saving model ...
Epoch: 7 cost time: 7.514106512069702
Epoch: 7, Steps: 10 | Train Loss: 0.362 Vali Loss: 1.025 Vali Acc: 0.554 Test Loss: 1.025 Test Acc: 0.554
Validation loss decreased (-0.554043 --> -0.554044).  Saving model ...
Epoch: 8 cost time: 8.251412868499756
Epoch: 8, Steps: 10 | Train Loss: 0.247 Vali Loss: 0.973 Vali Acc: 0.608 Test Loss: 0.973 Test Acc: 0.608
Validation loss decreased (-0.554044 --> -0.608098).  Saving model ...
Epoch: 9 cost time: 7.938055515289307
Epoch: 9, Steps: 10 | Train Loss: 0.162 Vali Loss: 0.959 Vali Acc: 0.581 Test Loss: 0.959 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 7.6587207317352295
Epoch: 10, Steps: 10 | Train Loss: 0.089 Vali Loss: 1.000 Vali Acc: 0.581 Test Loss: 1.000 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 7.197703838348389
Epoch: 11, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.986 Vali Acc: 0.581 Test Loss: 0.986 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 7.661755323410034
Epoch: 12, Steps: 10 | Train Loss: 0.043 Vali Loss: 1.090 Vali Acc: 0.568 Test Loss: 1.090 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 7.510143756866455
Epoch: 13, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.954 Vali Acc: 0.622 Test Loss: 0.954 Test Acc: 0.622
Validation loss decreased (-0.608098 --> -0.621612).  Saving model ...
Epoch: 14 cost time: 7.141717433929443
Epoch: 14, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.015 Vali Acc: 0.622 Test Loss: 1.015 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 7.888409376144409
Epoch: 15, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.071 Vali Acc: 0.649 Test Loss: 1.071 Test Acc: 0.649
Validation loss decreased (-0.621612 --> -0.648638).  Saving model ...
Epoch: 16 cost time: 7.81374454498291
Epoch: 16, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.025 Vali Acc: 0.635 Test Loss: 1.025 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 7.390341281890869
Epoch: 17, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.042 Vali Acc: 0.649 Test Loss: 1.042 Test Acc: 0.649
Validation loss decreased (-0.648638 --> -0.648638).  Saving model ...
Epoch: 18 cost time: 7.259593725204468
Epoch: 18, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.031 Vali Acc: 0.635 Test Loss: 1.031 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 8.037755012512207
Epoch: 19, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.039 Vali Acc: 0.635 Test Loss: 1.039 Test Acc: 0.635
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 7.374812602996826
Epoch: 20, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.036 Vali Acc: 0.622 Test Loss: 1.036 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 7.942721366882324
Epoch: 21, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.991 Vali Acc: 0.662 Test Loss: 0.991 Test Acc: 0.662
Validation loss decreased (-0.648638 --> -0.662152).  Saving model ...
Epoch: 22 cost time: 7.764041423797607
Epoch: 22, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.060 Vali Acc: 0.622 Test Loss: 1.060 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 7.453711986541748
Epoch: 23, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.124 Vali Acc: 0.649 Test Loss: 1.124 Test Acc: 0.649
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 7.7399821281433105
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.071 Vali Acc: 0.635 Test Loss: 1.071 Test Acc: 0.635
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 7.745334625244141
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.061 Vali Acc: 0.635 Test Loss: 1.061 Test Acc: 0.635
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 8.415752172470093
Epoch: 26, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.130 Vali Acc: 0.649 Test Loss: 1.130 Test Acc: 0.649
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 7.787394046783447
Epoch: 27, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.155 Vali Acc: 0.622 Test Loss: 1.155 Test Acc: 0.622
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 7.985496997833252
Epoch: 28, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.272 Vali Acc: 0.608 Test Loss: 1.272 Test Acc: 0.608
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 8.069504737854004
Epoch: 29, Steps: 10 | Train Loss: 0.044 Vali Loss: 1.440 Vali Acc: 0.568 Test Loss: 1.440 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 8.7089102268219
Epoch: 30, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.502 Vali Acc: 0.486 Test Loss: 1.502 Test Acc: 0.486
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm32_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6621621621621622
model parameter : 7083972
model size : 27.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm32_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.4264209270477295
Epoch: 1, Steps: 10 | Train Loss: 1.397 Vali Loss: 1.403 Vali Acc: 0.297 Test Loss: 1.403 Test Acc: 0.297
Validation loss decreased (inf --> -0.297283).  Saving model ...
Epoch: 2 cost time: 3.653916597366333
Epoch: 2, Steps: 10 | Train Loss: 1.276 Vali Loss: 1.400 Vali Acc: 0.243 Test Loss: 1.400 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.7596938610076904
Epoch: 3, Steps: 10 | Train Loss: 1.088 Vali Loss: 1.305 Vali Acc: 0.351 Test Loss: 1.305 Test Acc: 0.351
Validation loss decreased (-0.297283 --> -0.351338).  Saving model ...
Epoch: 4 cost time: 3.7477316856384277
Epoch: 4, Steps: 10 | Train Loss: 0.887 Vali Loss: 1.239 Vali Acc: 0.473 Test Loss: 1.239 Test Acc: 0.473
Validation loss decreased (-0.351338 --> -0.472961).  Saving model ...
Epoch: 5 cost time: 4.221812009811401
Epoch: 5, Steps: 10 | Train Loss: 0.677 Vali Loss: 1.233 Vali Acc: 0.473 Test Loss: 1.233 Test Acc: 0.473
Validation loss decreased (-0.472961 --> -0.472961).  Saving model ...
Epoch: 6 cost time: 4.03937292098999
Epoch: 6, Steps: 10 | Train Loss: 0.512 Vali Loss: 1.121 Vali Acc: 0.527 Test Loss: 1.121 Test Acc: 0.527
Validation loss decreased (-0.472961 --> -0.527016).  Saving model ...
Epoch: 7 cost time: 3.629930257797241
Epoch: 7, Steps: 10 | Train Loss: 0.328 Vali Loss: 1.141 Vali Acc: 0.514 Test Loss: 1.141 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.73713755607605
Epoch: 8, Steps: 10 | Train Loss: 0.210 Vali Loss: 1.064 Vali Acc: 0.541 Test Loss: 1.064 Test Acc: 0.541
Validation loss decreased (-0.527016 --> -0.540530).  Saving model ...
Epoch: 9 cost time: 3.8518154621124268
Epoch: 9, Steps: 10 | Train Loss: 0.117 Vali Loss: 1.093 Vali Acc: 0.514 Test Loss: 1.093 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.5063469409942627
Epoch: 10, Steps: 10 | Train Loss: 0.068 Vali Loss: 1.098 Vali Acc: 0.581 Test Loss: 1.098 Test Acc: 0.581
Validation loss decreased (-0.540530 --> -0.581070).  Saving model ...
Epoch: 11 cost time: 4.341573715209961
Epoch: 11, Steps: 10 | Train Loss: 0.049 Vali Loss: 1.081 Vali Acc: 0.541 Test Loss: 1.081 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.9564154148101807
Epoch: 12, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.086 Vali Acc: 0.541 Test Loss: 1.086 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.286913156509399
Epoch: 13, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.120 Vali Acc: 0.581 Test Loss: 1.120 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.079665422439575
Epoch: 14, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.103 Vali Acc: 0.554 Test Loss: 1.103 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.8149921894073486
Epoch: 15, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.136 Vali Acc: 0.568 Test Loss: 1.136 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 4.580128908157349
Epoch: 16, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.171 Vali Acc: 0.568 Test Loss: 1.171 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 4.3147687911987305
Epoch: 17, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.172 Vali Acc: 0.554 Test Loss: 1.172 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 4.224063873291016
Epoch: 18, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.184 Vali Acc: 0.554 Test Loss: 1.184 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 4.145311594009399
Epoch: 19, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.172 Vali Acc: 0.554 Test Loss: 1.172 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 4.288909196853638
Epoch: 20, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.173 Vali Acc: 0.568 Test Loss: 1.173 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm32_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 2118660
model size : 8.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm32_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 6.511469125747681
Epoch: 1, Steps: 10 | Train Loss: 1.431 Vali Loss: 1.425 Vali Acc: 0.189 Test Loss: 1.425 Test Acc: 0.189
Validation loss decreased (inf --> -0.189175).  Saving model ...
Epoch: 2 cost time: 5.2081825733184814
Epoch: 2, Steps: 10 | Train Loss: 1.315 Vali Loss: 1.302 Vali Acc: 0.419 Test Loss: 1.302 Test Acc: 0.419
Validation loss decreased (-0.189175 --> -0.418906).  Saving model ...
Epoch: 3 cost time: 5.386872291564941
Epoch: 3, Steps: 10 | Train Loss: 1.156 Vali Loss: 1.306 Vali Acc: 0.419 Test Loss: 1.306 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.919257164001465
Epoch: 4, Steps: 10 | Train Loss: 0.940 Vali Loss: 1.199 Vali Acc: 0.527 Test Loss: 1.199 Test Acc: 0.527
Validation loss decreased (-0.418906 --> -0.527015).  Saving model ...
Epoch: 5 cost time: 5.009820938110352
Epoch: 5, Steps: 10 | Train Loss: 0.775 Vali Loss: 1.153 Vali Acc: 0.541 Test Loss: 1.153 Test Acc: 0.541
Validation loss decreased (-0.527015 --> -0.540529).  Saving model ...
Epoch: 6 cost time: 5.183780670166016
Epoch: 6, Steps: 10 | Train Loss: 0.590 Vali Loss: 1.111 Vali Acc: 0.541 Test Loss: 1.111 Test Acc: 0.541
Validation loss decreased (-0.540529 --> -0.540529).  Saving model ...
Epoch: 7 cost time: 5.1919965744018555
Epoch: 7, Steps: 10 | Train Loss: 0.463 Vali Loss: 1.042 Vali Acc: 0.595 Test Loss: 1.042 Test Acc: 0.595
Validation loss decreased (-0.540529 --> -0.594584).  Saving model ...
Epoch: 8 cost time: 4.77738356590271
Epoch: 8, Steps: 10 | Train Loss: 0.304 Vali Loss: 0.992 Vali Acc: 0.568 Test Loss: 0.992 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.434476375579834
Epoch: 9, Steps: 10 | Train Loss: 0.195 Vali Loss: 0.966 Vali Acc: 0.622 Test Loss: 0.966 Test Acc: 0.622
Validation loss decreased (-0.594584 --> -0.621612).  Saving model ...
Epoch: 10 cost time: 4.581473112106323
Epoch: 10, Steps: 10 | Train Loss: 0.112 Vali Loss: 0.909 Vali Acc: 0.635 Test Loss: 0.909 Test Acc: 0.635
Validation loss decreased (-0.621612 --> -0.635126).  Saving model ...
Epoch: 11 cost time: 4.575924873352051
Epoch: 11, Steps: 10 | Train Loss: 0.065 Vali Loss: 1.004 Vali Acc: 0.635 Test Loss: 1.004 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.663915634155273
Epoch: 12, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.951 Vali Acc: 0.649 Test Loss: 0.951 Test Acc: 0.649
Validation loss decreased (-0.635126 --> -0.648639).  Saving model ...
Epoch: 13 cost time: 4.788162708282471
Epoch: 13, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.992 Vali Acc: 0.622 Test Loss: 0.992 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.667163848876953
Epoch: 14, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.010 Vali Acc: 0.635 Test Loss: 1.010 Test Acc: 0.635
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.622316360473633
Epoch: 15, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.972 Vali Acc: 0.649 Test Loss: 0.972 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 5.207610607147217
Epoch: 16, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.016 Vali Acc: 0.662 Test Loss: 1.016 Test Acc: 0.662
Validation loss decreased (-0.648639 --> -0.662152).  Saving model ...
Epoch: 17 cost time: 4.885885238647461
Epoch: 17, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.015 Vali Acc: 0.662 Test Loss: 1.015 Test Acc: 0.662
Validation loss decreased (-0.662152 --> -0.662152).  Saving model ...
Epoch: 18 cost time: 4.610580205917358
Epoch: 18, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.047 Vali Acc: 0.676 Test Loss: 1.047 Test Acc: 0.676
Validation loss decreased (-0.662152 --> -0.675665).  Saving model ...
Epoch: 19 cost time: 4.352962493896484
Epoch: 19, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.047 Vali Acc: 0.662 Test Loss: 1.047 Test Acc: 0.662
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 5.063794374465942
Epoch: 20, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.048 Vali Acc: 0.662 Test Loss: 1.048 Test Acc: 0.662
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 4.692528963088989
Epoch: 21, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.130 Vali Acc: 0.676 Test Loss: 1.130 Test Acc: 0.676
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 4.797956466674805
Epoch: 22, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.221 Vali Acc: 0.595 Test Loss: 1.221 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 4.6720335483551025
Epoch: 23, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.172 Vali Acc: 0.662 Test Loss: 1.172 Test Acc: 0.662
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 4.76367449760437
Epoch: 24, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.117 Vali Acc: 0.649 Test Loss: 1.117 Test Acc: 0.649
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 4.761179685592651
Epoch: 25, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.134 Vali Acc: 0.676 Test Loss: 1.134 Test Acc: 0.676
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 4.709430694580078
Epoch: 26, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.179 Vali Acc: 0.662 Test Loss: 1.179 Test Acc: 0.662
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 4.751266717910767
Epoch: 27, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.161 Vali Acc: 0.676 Test Loss: 1.161 Test Acc: 0.676
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 4.658618927001953
Epoch: 28, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.165 Vali Acc: 0.676 Test Loss: 1.165 Test Acc: 0.676
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm32_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6756756756756757
model parameter : 7083972
model size : 27.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm32_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.248311996459961
Epoch: 1, Steps: 10 | Train Loss: 1.399 Vali Loss: 1.397 Vali Acc: 0.284 Test Loss: 1.397 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 2.148139715194702
Epoch: 2, Steps: 10 | Train Loss: 1.286 Vali Loss: 1.397 Vali Acc: 0.297 Test Loss: 1.397 Test Acc: 0.297
Validation loss decreased (-0.283770 --> -0.297283).  Saving model ...
Epoch: 3 cost time: 2.1700730323791504
Epoch: 3, Steps: 10 | Train Loss: 1.140 Vali Loss: 1.307 Vali Acc: 0.432 Test Loss: 1.307 Test Acc: 0.432
Validation loss decreased (-0.297283 --> -0.432419).  Saving model ...
Epoch: 4 cost time: 2.2169687747955322
Epoch: 4, Steps: 10 | Train Loss: 0.974 Vali Loss: 1.221 Vali Acc: 0.541 Test Loss: 1.221 Test Acc: 0.541
Validation loss decreased (-0.432419 --> -0.540528).  Saving model ...
Epoch: 5 cost time: 2.235011577606201
Epoch: 5, Steps: 10 | Train Loss: 0.796 Vali Loss: 1.245 Vali Acc: 0.500 Test Loss: 1.245 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.216041326522827
Epoch: 6, Steps: 10 | Train Loss: 0.624 Vali Loss: 1.111 Vali Acc: 0.554 Test Loss: 1.111 Test Acc: 0.554
Validation loss decreased (-0.540528 --> -0.554043).  Saving model ...
Epoch: 7 cost time: 2.3336496353149414
Epoch: 7, Steps: 10 | Train Loss: 0.479 Vali Loss: 1.136 Vali Acc: 0.595 Test Loss: 1.136 Test Acc: 0.595
Validation loss decreased (-0.554043 --> -0.594583).  Saving model ...
Epoch: 8 cost time: 2.337388038635254
Epoch: 8, Steps: 10 | Train Loss: 0.324 Vali Loss: 1.035 Vali Acc: 0.541 Test Loss: 1.035 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.3085973262786865
Epoch: 9, Steps: 10 | Train Loss: 0.211 Vali Loss: 1.047 Vali Acc: 0.608 Test Loss: 1.047 Test Acc: 0.608
Validation loss decreased (-0.594583 --> -0.608098).  Saving model ...
Epoch: 10 cost time: 2.300204277038574
Epoch: 10, Steps: 10 | Train Loss: 0.130 Vali Loss: 1.038 Vali Acc: 0.608 Test Loss: 1.038 Test Acc: 0.608
Validation loss decreased (-0.608098 --> -0.608098).  Saving model ...
Epoch: 11 cost time: 2.3108670711517334
Epoch: 11, Steps: 10 | Train Loss: 0.087 Vali Loss: 1.028 Vali Acc: 0.581 Test Loss: 1.028 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.568408489227295
Epoch: 12, Steps: 10 | Train Loss: 0.052 Vali Loss: 1.058 Vali Acc: 0.581 Test Loss: 1.058 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.4512135982513428
Epoch: 13, Steps: 10 | Train Loss: 0.037 Vali Loss: 1.057 Vali Acc: 0.554 Test Loss: 1.057 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.685558557510376
Epoch: 14, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.011 Vali Acc: 0.554 Test Loss: 1.011 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.5737826824188232
Epoch: 15, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.062 Vali Acc: 0.554 Test Loss: 1.062 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.4941446781158447
Epoch: 16, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.065 Vali Acc: 0.568 Test Loss: 1.065 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.620171308517456
Epoch: 17, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.046 Vali Acc: 0.541 Test Loss: 1.046 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.5394566059112549
Epoch: 18, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.093 Vali Acc: 0.568 Test Loss: 1.093 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.5577411651611328
Epoch: 19, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.097 Vali Acc: 0.527 Test Loss: 1.097 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.352996349334717
Epoch: 20, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.099 Vali Acc: 0.554 Test Loss: 1.099 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm32_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 2118660
model size : 8.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm32_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 6.926578521728516
Epoch: 1, Steps: 10 | Train Loss: 1.440 Vali Loss: 1.424 Vali Acc: 0.311 Test Loss: 1.424 Test Acc: 0.311
Validation loss decreased (inf --> -0.310797).  Saving model ...
Epoch: 2 cost time: 5.54143762588501
Epoch: 2, Steps: 10 | Train Loss: 1.332 Vali Loss: 1.336 Vali Acc: 0.338 Test Loss: 1.336 Test Acc: 0.338
Validation loss decreased (-0.310797 --> -0.337824).  Saving model ...
Epoch: 3 cost time: 5.778212785720825
Epoch: 3, Steps: 10 | Train Loss: 1.110 Vali Loss: 1.275 Vali Acc: 0.378 Test Loss: 1.275 Test Acc: 0.378
Validation loss decreased (-0.337824 --> -0.378366).  Saving model ...
Epoch: 4 cost time: 5.535157918930054
Epoch: 4, Steps: 10 | Train Loss: 0.887 Vali Loss: 1.235 Vali Acc: 0.486 Test Loss: 1.235 Test Acc: 0.486
Validation loss decreased (-0.378366 --> -0.486474).  Saving model ...
Epoch: 5 cost time: 5.679359674453735
Epoch: 5, Steps: 10 | Train Loss: 0.643 Vali Loss: 1.187 Vali Acc: 0.486 Test Loss: 1.187 Test Acc: 0.486
Validation loss decreased (-0.486474 --> -0.486475).  Saving model ...
Epoch: 6 cost time: 5.300609111785889
Epoch: 6, Steps: 10 | Train Loss: 0.462 Vali Loss: 1.145 Vali Acc: 0.541 Test Loss: 1.145 Test Acc: 0.541
Validation loss decreased (-0.486475 --> -0.540529).  Saving model ...
Epoch: 7 cost time: 5.637972831726074
Epoch: 7, Steps: 10 | Train Loss: 0.293 Vali Loss: 1.151 Vali Acc: 0.527 Test Loss: 1.151 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.461303949356079
Epoch: 8, Steps: 10 | Train Loss: 0.184 Vali Loss: 1.087 Vali Acc: 0.568 Test Loss: 1.087 Test Acc: 0.568
Validation loss decreased (-0.540529 --> -0.567557).  Saving model ...
Epoch: 9 cost time: 5.518075704574585
Epoch: 9, Steps: 10 | Train Loss: 0.102 Vali Loss: 1.202 Vali Acc: 0.500 Test Loss: 1.202 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.456698656082153
Epoch: 10, Steps: 10 | Train Loss: 0.066 Vali Loss: 1.055 Vali Acc: 0.527 Test Loss: 1.055 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.856341361999512
Epoch: 11, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.108 Vali Acc: 0.608 Test Loss: 1.108 Test Acc: 0.608
Validation loss decreased (-0.567557 --> -0.608097).  Saving model ...
Epoch: 12 cost time: 4.997067451477051
Epoch: 12, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.105 Vali Acc: 0.554 Test Loss: 1.105 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.008775472640991
Epoch: 13, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.082 Vali Acc: 0.568 Test Loss: 1.082 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.970383644104004
Epoch: 14, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.108 Vali Acc: 0.595 Test Loss: 1.108 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.957628965377808
Epoch: 15, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.084 Vali Acc: 0.581 Test Loss: 1.084 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 4.878954172134399
Epoch: 16, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.090 Vali Acc: 0.581 Test Loss: 1.090 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 4.853792667388916
Epoch: 17, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.099 Vali Acc: 0.568 Test Loss: 1.099 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 5.196730852127075
Epoch: 18, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.095 Vali Acc: 0.568 Test Loss: 1.095 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 5.509831428527832
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.091 Vali Acc: 0.568 Test Loss: 1.091 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 5.7436888217926025
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.115 Vali Acc: 0.554 Test Loss: 1.115 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 5.325831413269043
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.132 Vali Acc: 0.541 Test Loss: 1.132 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm32_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 3568452
model size : 14.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm32_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.328033208847046
Epoch: 1, Steps: 10 | Train Loss: 1.499 Vali Loss: 1.400 Vali Acc: 0.243 Test Loss: 1.400 Test Acc: 0.243
Validation loss decreased (inf --> -0.243229).  Saving model ...
Epoch: 2 cost time: 2.7707836627960205
Epoch: 2, Steps: 10 | Train Loss: 1.376 Vali Loss: 1.367 Vali Acc: 0.365 Test Loss: 1.367 Test Acc: 0.365
Validation loss decreased (-0.243229 --> -0.364851).  Saving model ...
Epoch: 3 cost time: 2.6530566215515137
Epoch: 3, Steps: 10 | Train Loss: 1.182 Vali Loss: 1.268 Vali Acc: 0.514 Test Loss: 1.268 Test Acc: 0.514
Validation loss decreased (-0.364851 --> -0.513501).  Saving model ...
Epoch: 4 cost time: 2.733325719833374
Epoch: 4, Steps: 10 | Train Loss: 0.942 Vali Loss: 1.182 Vali Acc: 0.568 Test Loss: 1.182 Test Acc: 0.568
Validation loss decreased (-0.513501 --> -0.567556).  Saving model ...
Epoch: 5 cost time: 2.9650347232818604
Epoch: 5, Steps: 10 | Train Loss: 0.717 Vali Loss: 1.107 Vali Acc: 0.568 Test Loss: 1.107 Test Acc: 0.568
Validation loss decreased (-0.567556 --> -0.567556).  Saving model ...
Epoch: 6 cost time: 2.7239933013916016
Epoch: 6, Steps: 10 | Train Loss: 0.529 Vali Loss: 1.030 Vali Acc: 0.608 Test Loss: 1.030 Test Acc: 0.608
Validation loss decreased (-0.567556 --> -0.608098).  Saving model ...
Epoch: 7 cost time: 2.7161083221435547
Epoch: 7, Steps: 10 | Train Loss: 0.342 Vali Loss: 1.027 Vali Acc: 0.541 Test Loss: 1.027 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.7922143936157227
Epoch: 8, Steps: 10 | Train Loss: 0.204 Vali Loss: 0.918 Vali Acc: 0.622 Test Loss: 0.918 Test Acc: 0.622
Validation loss decreased (-0.608098 --> -0.621612).  Saving model ...
Epoch: 9 cost time: 2.74501895904541
Epoch: 9, Steps: 10 | Train Loss: 0.124 Vali Loss: 0.947 Vali Acc: 0.568 Test Loss: 0.947 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.9113330841064453
Epoch: 10, Steps: 10 | Train Loss: 0.072 Vali Loss: 0.958 Vali Acc: 0.595 Test Loss: 0.958 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.9021451473236084
Epoch: 11, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.944 Vali Acc: 0.622 Test Loss: 0.944 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.9968457221984863
Epoch: 12, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.938 Vali Acc: 0.595 Test Loss: 0.938 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.2238080501556396
Epoch: 13, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.950 Vali Acc: 0.608 Test Loss: 0.950 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.3744773864746094
Epoch: 14, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.953 Vali Acc: 0.649 Test Loss: 0.953 Test Acc: 0.649
Validation loss decreased (-0.621612 --> -0.648639).  Saving model ...
Epoch: 15 cost time: 2.5058741569519043
Epoch: 15, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.963 Vali Acc: 0.676 Test Loss: 0.963 Test Acc: 0.676
Validation loss decreased (-0.648639 --> -0.675666).  Saving model ...
Epoch: 16 cost time: 2.3700873851776123
Epoch: 16, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.971 Vali Acc: 0.689 Test Loss: 0.971 Test Acc: 0.689
Validation loss decreased (-0.675666 --> -0.689179).  Saving model ...
Epoch: 17 cost time: 2.5586016178131104
Epoch: 17, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.994 Vali Acc: 0.662 Test Loss: 0.994 Test Acc: 0.662
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.563962936401367
Epoch: 18, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.969 Vali Acc: 0.676 Test Loss: 0.969 Test Acc: 0.676
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.506880044937134
Epoch: 19, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.965 Vali Acc: 0.703 Test Loss: 0.965 Test Acc: 0.703
Validation loss decreased (-0.689179 --> -0.702693).  Saving model ...
Epoch: 20 cost time: 2.538270950317383
Epoch: 20, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.985 Vali Acc: 0.689 Test Loss: 0.985 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.4129891395568848
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.000 Vali Acc: 0.676 Test Loss: 1.000 Test Acc: 0.676
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.541376829147339
Epoch: 22, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.014 Vali Acc: 0.689 Test Loss: 1.014 Test Acc: 0.689
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.4030168056488037
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.011 Vali Acc: 0.689 Test Loss: 1.011 Test Acc: 0.689
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.4794421195983887
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.032 Vali Acc: 0.689 Test Loss: 1.032 Test Acc: 0.689
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.297240972518921
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.035 Vali Acc: 0.689 Test Loss: 1.035 Test Acc: 0.689
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 3.0994629859924316
Epoch: 26, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.045 Vali Acc: 0.689 Test Loss: 1.045 Test Acc: 0.689
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.8810579776763916
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.039 Vali Acc: 0.689 Test Loss: 1.039 Test Acc: 0.689
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.8515918254852295
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.058 Vali Acc: 0.689 Test Loss: 1.058 Test Acc: 0.689
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.7878165245056152
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.065 Vali Acc: 0.676 Test Loss: 1.065 Test Acc: 0.676
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm32_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.7027027027027027
model parameter : 1085700
model size : 4.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm32_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.454798936843872
Epoch: 1, Steps: 10 | Train Loss: 1.445 Vali Loss: 1.425 Vali Acc: 0.297 Test Loss: 1.425 Test Acc: 0.297
Validation loss decreased (inf --> -0.297283).  Saving model ...
Epoch: 2 cost time: 3.9049928188323975
Epoch: 2, Steps: 10 | Train Loss: 1.332 Vali Loss: 1.336 Vali Acc: 0.311 Test Loss: 1.336 Test Acc: 0.311
Validation loss decreased (-0.297283 --> -0.310797).  Saving model ...
Epoch: 3 cost time: 4.162681579589844
Epoch: 3, Steps: 10 | Train Loss: 1.112 Vali Loss: 1.275 Vali Acc: 0.419 Test Loss: 1.275 Test Acc: 0.419
Validation loss decreased (-0.310797 --> -0.418906).  Saving model ...
Epoch: 4 cost time: 4.080334186553955
Epoch: 4, Steps: 10 | Train Loss: 0.892 Vali Loss: 1.234 Vali Acc: 0.500 Test Loss: 1.234 Test Acc: 0.500
Validation loss decreased (-0.418906 --> -0.499988).  Saving model ...
Epoch: 5 cost time: 4.072529554367065
Epoch: 5, Steps: 10 | Train Loss: 0.647 Vali Loss: 1.183 Vali Acc: 0.514 Test Loss: 1.183 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513502).  Saving model ...
Epoch: 6 cost time: 4.307294130325317
Epoch: 6, Steps: 10 | Train Loss: 0.467 Vali Loss: 1.134 Vali Acc: 0.527 Test Loss: 1.134 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527016).  Saving model ...
Epoch: 7 cost time: 4.095376014709473
Epoch: 7, Steps: 10 | Train Loss: 0.294 Vali Loss: 1.124 Vali Acc: 0.541 Test Loss: 1.124 Test Acc: 0.541
Validation loss decreased (-0.527016 --> -0.540529).  Saving model ...
Epoch: 8 cost time: 4.044084787368774
Epoch: 8, Steps: 10 | Train Loss: 0.179 Vali Loss: 1.063 Vali Acc: 0.541 Test Loss: 1.063 Test Acc: 0.541
Validation loss decreased (-0.540529 --> -0.540530).  Saving model ...
Epoch: 9 cost time: 4.243880033493042
Epoch: 9, Steps: 10 | Train Loss: 0.103 Vali Loss: 1.218 Vali Acc: 0.486 Test Loss: 1.218 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.9942588806152344
Epoch: 10, Steps: 10 | Train Loss: 0.064 Vali Loss: 0.991 Vali Acc: 0.608 Test Loss: 0.991 Test Acc: 0.608
Validation loss decreased (-0.540530 --> -0.608098).  Saving model ...
Epoch: 11 cost time: 3.488520622253418
Epoch: 11, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.003 Vali Acc: 0.608 Test Loss: 1.003 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.7751352787017822
Epoch: 12, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.065 Vali Acc: 0.595 Test Loss: 1.065 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.99338436126709
Epoch: 13, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.053 Vali Acc: 0.581 Test Loss: 1.053 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.9651906490325928
Epoch: 14, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.075 Vali Acc: 0.554 Test Loss: 1.075 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.519906520843506
Epoch: 15, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.073 Vali Acc: 0.568 Test Loss: 1.073 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 4.017397403717041
Epoch: 16, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.093 Vali Acc: 0.581 Test Loss: 1.093 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.6900486946105957
Epoch: 17, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.091 Vali Acc: 0.581 Test Loss: 1.091 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 4.113730192184448
Epoch: 18, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.080 Vali Acc: 0.581 Test Loss: 1.080 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 4.192060470581055
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.077 Vali Acc: 0.568 Test Loss: 1.077 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 4.044443130493164
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.099 Vali Acc: 0.581 Test Loss: 1.099 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm32_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 3568452
model size : 14.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm32_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.779258966445923
Epoch: 1, Steps: 10 | Train Loss: 1.491 Vali Loss: 1.401 Vali Acc: 0.243 Test Loss: 1.401 Test Acc: 0.243
Validation loss decreased (inf --> -0.243229).  Saving model ...
Epoch: 2 cost time: 2.327802896499634
Epoch: 2, Steps: 10 | Train Loss: 1.373 Vali Loss: 1.366 Vali Acc: 0.365 Test Loss: 1.366 Test Acc: 0.365
Validation loss decreased (-0.243229 --> -0.364851).  Saving model ...
Epoch: 3 cost time: 2.457519769668579
Epoch: 3, Steps: 10 | Train Loss: 1.175 Vali Loss: 1.265 Vali Acc: 0.486 Test Loss: 1.265 Test Acc: 0.486
Validation loss decreased (-0.364851 --> -0.486474).  Saving model ...
Epoch: 4 cost time: 2.4522039890289307
Epoch: 4, Steps: 10 | Train Loss: 0.932 Vali Loss: 1.177 Vali Acc: 0.581 Test Loss: 1.177 Test Acc: 0.581
Validation loss decreased (-0.486474 --> -0.581069).  Saving model ...
Epoch: 5 cost time: 2.723254680633545
Epoch: 5, Steps: 10 | Train Loss: 0.705 Vali Loss: 1.100 Vali Acc: 0.581 Test Loss: 1.100 Test Acc: 0.581
Validation loss decreased (-0.581069 --> -0.581070).  Saving model ...
Epoch: 6 cost time: 2.3904545307159424
Epoch: 6, Steps: 10 | Train Loss: 0.517 Vali Loss: 1.025 Vali Acc: 0.649 Test Loss: 1.025 Test Acc: 0.649
Validation loss decreased (-0.581070 --> -0.648638).  Saving model ...
Epoch: 7 cost time: 2.393842935562134
Epoch: 7, Steps: 10 | Train Loss: 0.330 Vali Loss: 1.024 Vali Acc: 0.554 Test Loss: 1.024 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.3874995708465576
Epoch: 8, Steps: 10 | Train Loss: 0.195 Vali Loss: 0.914 Vali Acc: 0.608 Test Loss: 0.914 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.3458237648010254
Epoch: 9, Steps: 10 | Train Loss: 0.115 Vali Loss: 0.954 Vali Acc: 0.622 Test Loss: 0.954 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.1542282104492188
Epoch: 10, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.940 Vali Acc: 0.662 Test Loss: 0.940 Test Acc: 0.662
Validation loss decreased (-0.648638 --> -0.662153).  Saving model ...
Epoch: 11 cost time: 2.3690812587738037
Epoch: 11, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.940 Vali Acc: 0.608 Test Loss: 0.940 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.5634188652038574
Epoch: 12, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.893 Vali Acc: 0.608 Test Loss: 0.893 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.3323352336883545
Epoch: 13, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.000 Vali Acc: 0.622 Test Loss: 1.000 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.419499635696411
Epoch: 14, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.980 Vali Acc: 0.635 Test Loss: 0.980 Test Acc: 0.635
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.3237226009368896
Epoch: 15, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.980 Vali Acc: 0.635 Test Loss: 0.980 Test Acc: 0.635
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.234174966812134
Epoch: 16, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.008 Vali Acc: 0.622 Test Loss: 1.008 Test Acc: 0.622
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.533555269241333
Epoch: 17, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.042 Vali Acc: 0.622 Test Loss: 1.042 Test Acc: 0.622
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.4987974166870117
Epoch: 18, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.016 Vali Acc: 0.662 Test Loss: 1.016 Test Acc: 0.662
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.6169815063476562
Epoch: 19, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.015 Vali Acc: 0.662 Test Loss: 1.015 Test Acc: 0.662
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.562535524368286
Epoch: 20, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.045 Vali Acc: 0.662 Test Loss: 1.045 Test Acc: 0.662
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm32_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6621621621621622
model parameter : 1085700
model size : 4.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm32_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.9718666076660156
Epoch: 1, Steps: 10 | Train Loss: 1.440 Vali Loss: 1.429 Vali Acc: 0.311 Test Loss: 1.429 Test Acc: 0.311
Validation loss decreased (inf --> -0.310797).  Saving model ...
Epoch: 2 cost time: 2.429111957550049
Epoch: 2, Steps: 10 | Train Loss: 1.350 Vali Loss: 1.342 Vali Acc: 0.324 Test Loss: 1.342 Test Acc: 0.324
Validation loss decreased (-0.310797 --> -0.324311).  Saving model ...
Epoch: 3 cost time: 2.666926383972168
Epoch: 3, Steps: 10 | Train Loss: 1.170 Vali Loss: 1.277 Vali Acc: 0.392 Test Loss: 1.277 Test Acc: 0.392
Validation loss decreased (-0.324311 --> -0.391879).  Saving model ...
Epoch: 4 cost time: 2.7376317977905273
Epoch: 4, Steps: 10 | Train Loss: 0.978 Vali Loss: 1.240 Vali Acc: 0.500 Test Loss: 1.240 Test Acc: 0.500
Validation loss decreased (-0.391879 --> -0.499988).  Saving model ...
Epoch: 5 cost time: 2.854828119277954
Epoch: 5, Steps: 10 | Train Loss: 0.774 Vali Loss: 1.173 Vali Acc: 0.486 Test Loss: 1.173 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.0171024799346924
Epoch: 6, Steps: 10 | Train Loss: 0.613 Vali Loss: 1.129 Vali Acc: 0.486 Test Loss: 1.129 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.819289445877075
Epoch: 7, Steps: 10 | Train Loss: 0.459 Vali Loss: 1.071 Vali Acc: 0.514 Test Loss: 1.071 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513503).  Saving model ...
Epoch: 8 cost time: 2.7526347637176514
Epoch: 8, Steps: 10 | Train Loss: 0.334 Vali Loss: 1.054 Vali Acc: 0.541 Test Loss: 1.054 Test Acc: 0.541
Validation loss decreased (-0.513503 --> -0.540530).  Saving model ...
Epoch: 9 cost time: 2.752814292907715
Epoch: 9, Steps: 10 | Train Loss: 0.219 Vali Loss: 1.037 Vali Acc: 0.527 Test Loss: 1.037 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.830920696258545
Epoch: 10, Steps: 10 | Train Loss: 0.141 Vali Loss: 1.004 Vali Acc: 0.541 Test Loss: 1.004 Test Acc: 0.541
Validation loss decreased (-0.540530 --> -0.540531).  Saving model ...
Epoch: 11 cost time: 2.9202895164489746
Epoch: 11, Steps: 10 | Train Loss: 0.084 Vali Loss: 0.960 Vali Acc: 0.554 Test Loss: 0.960 Test Acc: 0.554
Validation loss decreased (-0.540531 --> -0.554044).  Saving model ...
Epoch: 12 cost time: 3.073300361633301
Epoch: 12, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.941 Vali Acc: 0.568 Test Loss: 0.941 Test Acc: 0.568
Validation loss decreased (-0.554044 --> -0.567558).  Saving model ...
Epoch: 13 cost time: 3.0196778774261475
Epoch: 13, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.943 Vali Acc: 0.568 Test Loss: 0.943 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.104875087738037
Epoch: 14, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.982 Vali Acc: 0.554 Test Loss: 0.982 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.4290850162506104
Epoch: 15, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.923 Vali Acc: 0.608 Test Loss: 0.923 Test Acc: 0.608
Validation loss decreased (-0.567558 --> -0.608099).  Saving model ...
Epoch: 16 cost time: 3.0031278133392334
Epoch: 16, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.009 Vali Acc: 0.568 Test Loss: 1.009 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.01993727684021
Epoch: 17, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.006 Vali Acc: 0.581 Test Loss: 1.006 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.9549567699432373
Epoch: 18, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.009 Vali Acc: 0.595 Test Loss: 1.009 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.950033187866211
Epoch: 19, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.995 Vali Acc: 0.608 Test Loss: 0.995 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.2141642570495605
Epoch: 20, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.013 Vali Acc: 0.608 Test Loss: 1.013 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.158707618713379
Epoch: 21, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.034 Vali Acc: 0.608 Test Loss: 1.034 Test Acc: 0.608
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.959318161010742
Epoch: 22, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.032 Vali Acc: 0.622 Test Loss: 1.032 Test Acc: 0.622
Validation loss decreased (-0.608099 --> -0.621611).  Saving model ...
Epoch: 23 cost time: 3.072442054748535
Epoch: 23, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.041 Vali Acc: 0.608 Test Loss: 1.041 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.936652421951294
Epoch: 24, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.058 Vali Acc: 0.595 Test Loss: 1.058 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.9896373748779297
Epoch: 25, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.064 Vali Acc: 0.595 Test Loss: 1.064 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.1329710483551025
Epoch: 26, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.034 Vali Acc: 0.608 Test Loss: 1.034 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 3.0076794624328613
Epoch: 27, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.080 Vali Acc: 0.608 Test Loss: 1.080 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 3.1148078441619873
Epoch: 28, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.097 Vali Acc: 0.622 Test Loss: 1.097 Test Acc: 0.622
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 3.339841604232788
Epoch: 29, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.092 Vali Acc: 0.608 Test Loss: 1.092 Test Acc: 0.608
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 3.1436800956726074
Epoch: 30, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.090 Vali Acc: 0.608 Test Loss: 1.090 Test Acc: 0.608
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm32_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 3568452
model size : 14.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm32_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.186114549636841
Epoch: 1, Steps: 10 | Train Loss: 1.491 Vali Loss: 1.392 Vali Acc: 0.284 Test Loss: 1.392 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 1.4692497253417969
Epoch: 2, Steps: 10 | Train Loss: 1.394 Vali Loss: 1.356 Vali Acc: 0.324 Test Loss: 1.356 Test Acc: 0.324
Validation loss decreased (-0.283770 --> -0.324311).  Saving model ...
Epoch: 3 cost time: 1.4985973834991455
Epoch: 3, Steps: 10 | Train Loss: 1.203 Vali Loss: 1.254 Vali Acc: 0.541 Test Loss: 1.254 Test Acc: 0.541
Validation loss decreased (-0.324311 --> -0.540528).  Saving model ...
Epoch: 4 cost time: 1.561131238937378
Epoch: 4, Steps: 10 | Train Loss: 1.015 Vali Loss: 1.170 Vali Acc: 0.595 Test Loss: 1.170 Test Acc: 0.595
Validation loss decreased (-0.540528 --> -0.594583).  Saving model ...
Epoch: 5 cost time: 1.161466121673584
Epoch: 5, Steps: 10 | Train Loss: 0.816 Vali Loss: 1.109 Vali Acc: 0.608 Test Loss: 1.109 Test Acc: 0.608
Validation loss decreased (-0.594583 --> -0.608097).  Saving model ...
Epoch: 6 cost time: 1.795161485671997
Epoch: 6, Steps: 10 | Train Loss: 0.646 Vali Loss: 1.042 Vali Acc: 0.581 Test Loss: 1.042 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.623054027557373
Epoch: 7, Steps: 10 | Train Loss: 0.453 Vali Loss: 1.029 Vali Acc: 0.635 Test Loss: 1.029 Test Acc: 0.635
Validation loss decreased (-0.608097 --> -0.635125).  Saving model ...
Epoch: 8 cost time: 1.6523411273956299
Epoch: 8, Steps: 10 | Train Loss: 0.316 Vali Loss: 0.940 Vali Acc: 0.622 Test Loss: 0.940 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.638237476348877
Epoch: 9, Steps: 10 | Train Loss: 0.213 Vali Loss: 0.953 Vali Acc: 0.595 Test Loss: 0.953 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.564918041229248
Epoch: 10, Steps: 10 | Train Loss: 0.132 Vali Loss: 0.889 Vali Acc: 0.635 Test Loss: 0.889 Test Acc: 0.635
Validation loss decreased (-0.635125 --> -0.635126).  Saving model ...
Epoch: 11 cost time: 1.5258073806762695
Epoch: 11, Steps: 10 | Train Loss: 0.074 Vali Loss: 0.922 Vali Acc: 0.635 Test Loss: 0.922 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8200998306274414
Epoch: 12, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.915 Vali Acc: 0.635 Test Loss: 0.915 Test Acc: 0.635
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.6367788314819336
Epoch: 13, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.922 Vali Acc: 0.622 Test Loss: 0.922 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.7357432842254639
Epoch: 14, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.950 Vali Acc: 0.635 Test Loss: 0.950 Test Acc: 0.635
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.7557833194732666
Epoch: 15, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.953 Vali Acc: 0.622 Test Loss: 0.953 Test Acc: 0.622
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.816082239151001
Epoch: 16, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.966 Vali Acc: 0.635 Test Loss: 0.966 Test Acc: 0.635
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.7850720882415771
Epoch: 17, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.006 Vali Acc: 0.622 Test Loss: 1.006 Test Acc: 0.622
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.974494218826294
Epoch: 18, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.998 Vali Acc: 0.622 Test Loss: 0.998 Test Acc: 0.622
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.8605101108551025
Epoch: 19, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.988 Vali Acc: 0.635 Test Loss: 0.988 Test Acc: 0.635
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.77431058883667
Epoch: 20, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.026 Vali Acc: 0.635 Test Loss: 1.026 Test Acc: 0.635
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm32_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6351351351351351
model parameter : 1085700
model size : 4.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm32_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.237520694732666
Epoch: 1, Steps: 10 | Train Loss: 1.418 Vali Loss: 1.362 Vali Acc: 0.311 Test Loss: 1.362 Test Acc: 0.311
Validation loss decreased (inf --> -0.310797).  Saving model ...
Epoch: 2 cost time: 3.6881351470947266
Epoch: 2, Steps: 10 | Train Loss: 1.277 Vali Loss: 1.330 Vali Acc: 0.419 Test Loss: 1.330 Test Acc: 0.419
Validation loss decreased (-0.310797 --> -0.418906).  Saving model ...
Epoch: 3 cost time: 3.6931848526000977
Epoch: 3, Steps: 10 | Train Loss: 1.123 Vali Loss: 1.250 Vali Acc: 0.432 Test Loss: 1.250 Test Acc: 0.432
Validation loss decreased (-0.418906 --> -0.432420).  Saving model ...
Epoch: 4 cost time: 3.927908182144165
Epoch: 4, Steps: 10 | Train Loss: 0.902 Vali Loss: 1.208 Vali Acc: 0.473 Test Loss: 1.208 Test Acc: 0.473
Validation loss decreased (-0.432420 --> -0.472961).  Saving model ...
Epoch: 5 cost time: 3.8769378662109375
Epoch: 5, Steps: 10 | Train Loss: 0.697 Vali Loss: 1.144 Vali Acc: 0.500 Test Loss: 1.144 Test Acc: 0.500
Validation loss decreased (-0.472961 --> -0.499989).  Saving model ...
Epoch: 6 cost time: 3.7532870769500732
Epoch: 6, Steps: 10 | Train Loss: 0.535 Vali Loss: 1.159 Vali Acc: 0.500 Test Loss: 1.159 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.705275774002075
Epoch: 7, Steps: 10 | Train Loss: 0.381 Vali Loss: 1.057 Vali Acc: 0.514 Test Loss: 1.057 Test Acc: 0.514
Validation loss decreased (-0.499989 --> -0.513503).  Saving model ...
Epoch: 8 cost time: 3.986392021179199
Epoch: 8, Steps: 10 | Train Loss: 0.249 Vali Loss: 1.071 Vali Acc: 0.514 Test Loss: 1.071 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.896022319793701
Epoch: 9, Steps: 10 | Train Loss: 0.160 Vali Loss: 1.085 Vali Acc: 0.486 Test Loss: 1.085 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.9055893421173096
Epoch: 10, Steps: 10 | Train Loss: 0.089 Vali Loss: 1.018 Vali Acc: 0.527 Test Loss: 1.018 Test Acc: 0.527
Validation loss decreased (-0.513503 --> -0.527017).  Saving model ...
Epoch: 11 cost time: 3.9355971813201904
Epoch: 11, Steps: 10 | Train Loss: 0.054 Vali Loss: 1.035 Vali Acc: 0.541 Test Loss: 1.035 Test Acc: 0.541
Validation loss decreased (-0.527017 --> -0.540530).  Saving model ...
Epoch: 12 cost time: 3.67610764503479
Epoch: 12, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.150 Vali Acc: 0.568 Test Loss: 1.150 Test Acc: 0.568
Validation loss decreased (-0.540530 --> -0.567556).  Saving model ...
Epoch: 13 cost time: 3.59907603263855
Epoch: 13, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.078 Vali Acc: 0.527 Test Loss: 1.078 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.6002395153045654
Epoch: 14, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.132 Vali Acc: 0.541 Test Loss: 1.132 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.5533623695373535
Epoch: 15, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.153 Vali Acc: 0.568 Test Loss: 1.153 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.553685188293457
Epoch: 16, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.107 Vali Acc: 0.595 Test Loss: 1.107 Test Acc: 0.595
Validation loss decreased (-0.567556 --> -0.594584).  Saving model ...
Epoch: 17 cost time: 3.3596458435058594
Epoch: 17, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.124 Vali Acc: 0.554 Test Loss: 1.124 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.5239570140838623
Epoch: 18, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.163 Vali Acc: 0.568 Test Loss: 1.163 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.409548282623291
Epoch: 19, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.148 Vali Acc: 0.568 Test Loss: 1.148 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.515010118484497
Epoch: 20, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.159 Vali Acc: 0.568 Test Loss: 1.159 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.5531063079833984
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.173 Vali Acc: 0.581 Test Loss: 1.173 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 3.5567164421081543
Epoch: 22, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.185 Vali Acc: 0.595 Test Loss: 1.185 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 3.8873417377471924
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.198 Vali Acc: 0.595 Test Loss: 1.198 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 3.8900814056396484
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.202 Vali Acc: 0.568 Test Loss: 1.202 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 3.662896156311035
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.219 Vali Acc: 0.554 Test Loss: 1.219 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 4.002350807189941
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.246 Vali Acc: 0.581 Test Loss: 1.246 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm32_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 1810692
model size : 7.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm32_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.8155548572540283
Epoch: 1, Steps: 10 | Train Loss: 1.415 Vali Loss: 1.412 Vali Acc: 0.270 Test Loss: 1.412 Test Acc: 0.270
Validation loss decreased (inf --> -0.270256).  Saving model ...
Epoch: 2 cost time: 2.128908157348633
Epoch: 2, Steps: 10 | Train Loss: 1.312 Vali Loss: 1.357 Vali Acc: 0.297 Test Loss: 1.357 Test Acc: 0.297
Validation loss decreased (-0.270256 --> -0.297284).  Saving model ...
Epoch: 3 cost time: 2.277116060256958
Epoch: 3, Steps: 10 | Train Loss: 1.121 Vali Loss: 1.290 Vali Acc: 0.446 Test Loss: 1.290 Test Acc: 0.446
Validation loss decreased (-0.297284 --> -0.445933).  Saving model ...
Epoch: 4 cost time: 2.283191680908203
Epoch: 4, Steps: 10 | Train Loss: 0.903 Vali Loss: 1.205 Vali Acc: 0.446 Test Loss: 1.205 Test Acc: 0.446
Validation loss decreased (-0.445933 --> -0.445934).  Saving model ...
Epoch: 5 cost time: 2.228975296020508
Epoch: 5, Steps: 10 | Train Loss: 0.758 Vali Loss: 1.145 Vali Acc: 0.527 Test Loss: 1.145 Test Acc: 0.527
Validation loss decreased (-0.445934 --> -0.527016).  Saving model ...
Epoch: 6 cost time: 2.2947113513946533
Epoch: 6, Steps: 10 | Train Loss: 0.539 Vali Loss: 1.068 Vali Acc: 0.568 Test Loss: 1.068 Test Acc: 0.568
Validation loss decreased (-0.527016 --> -0.567557).  Saving model ...
Epoch: 7 cost time: 2.2720210552215576
Epoch: 7, Steps: 10 | Train Loss: 0.386 Vali Loss: 1.001 Vali Acc: 0.608 Test Loss: 1.001 Test Acc: 0.608
Validation loss decreased (-0.567557 --> -0.608098).  Saving model ...
Epoch: 8 cost time: 2.1202051639556885
Epoch: 8, Steps: 10 | Train Loss: 0.252 Vali Loss: 0.995 Vali Acc: 0.608 Test Loss: 0.995 Test Acc: 0.608
Validation loss decreased (-0.608098 --> -0.608098).  Saving model ...
Epoch: 9 cost time: 2.236937999725342
Epoch: 9, Steps: 10 | Train Loss: 0.160 Vali Loss: 0.911 Vali Acc: 0.608 Test Loss: 0.911 Test Acc: 0.608
Validation loss decreased (-0.608098 --> -0.608099).  Saving model ...
Epoch: 10 cost time: 2.282656669616699
Epoch: 10, Steps: 10 | Train Loss: 0.096 Vali Loss: 0.964 Vali Acc: 0.622 Test Loss: 0.964 Test Acc: 0.622
Validation loss decreased (-0.608099 --> -0.621612).  Saving model ...
Epoch: 11 cost time: 2.31886625289917
Epoch: 11, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.884 Vali Acc: 0.649 Test Loss: 0.884 Test Acc: 0.649
Validation loss decreased (-0.621612 --> -0.648640).  Saving model ...
Epoch: 12 cost time: 2.3200509548187256
Epoch: 12, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.908 Vali Acc: 0.622 Test Loss: 0.908 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.282984495162964
Epoch: 13, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.963 Vali Acc: 0.649 Test Loss: 0.963 Test Acc: 0.649
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.4776291847229004
Epoch: 14, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.885 Vali Acc: 0.662 Test Loss: 0.885 Test Acc: 0.662
Validation loss decreased (-0.648640 --> -0.662153).  Saving model ...
Epoch: 15 cost time: 2.287760019302368
Epoch: 15, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.893 Vali Acc: 0.676 Test Loss: 0.893 Test Acc: 0.676
Validation loss decreased (-0.662153 --> -0.675667).  Saving model ...
Epoch: 16 cost time: 2.335848569869995
Epoch: 16, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.925 Vali Acc: 0.676 Test Loss: 0.925 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.973634958267212
Epoch: 17, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.906 Vali Acc: 0.662 Test Loss: 0.906 Test Acc: 0.662
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.064979076385498
Epoch: 18, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.925 Vali Acc: 0.635 Test Loss: 0.925 Test Acc: 0.635
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.1656713485717773
Epoch: 19, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.932 Vali Acc: 0.635 Test Loss: 0.932 Test Acc: 0.635
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.023712396621704
Epoch: 20, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.936 Vali Acc: 0.635 Test Loss: 0.936 Test Acc: 0.635
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.070422410964966
Epoch: 21, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.936 Vali Acc: 0.649 Test Loss: 0.936 Test Acc: 0.649
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.8639655113220215
Epoch: 22, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.956 Vali Acc: 0.649 Test Loss: 0.956 Test Acc: 0.649
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.091276168823242
Epoch: 23, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.967 Vali Acc: 0.622 Test Loss: 0.967 Test Acc: 0.622
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.8274469375610352
Epoch: 24, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.956 Vali Acc: 0.635 Test Loss: 0.956 Test Acc: 0.635
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.1056416034698486
Epoch: 25, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.969 Vali Acc: 0.649 Test Loss: 0.969 Test Acc: 0.649
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm32_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6756756756756757
model parameter : 569220
model size : 2.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm32_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.395299673080444
Epoch: 1, Steps: 10 | Train Loss: 1.420 Vali Loss: 1.361 Vali Acc: 0.324 Test Loss: 1.361 Test Acc: 0.324
Validation loss decreased (inf --> -0.324311).  Saving model ...
Epoch: 2 cost time: 2.8200886249542236
Epoch: 2, Steps: 10 | Train Loss: 1.280 Vali Loss: 1.329 Vali Acc: 0.432 Test Loss: 1.329 Test Acc: 0.432
Validation loss decreased (-0.324311 --> -0.432419).  Saving model ...
Epoch: 3 cost time: 2.7537789344787598
Epoch: 3, Steps: 10 | Train Loss: 1.127 Vali Loss: 1.247 Vali Acc: 0.486 Test Loss: 1.247 Test Acc: 0.486
Validation loss decreased (-0.432419 --> -0.486474).  Saving model ...
Epoch: 4 cost time: 2.9250824451446533
Epoch: 4, Steps: 10 | Train Loss: 0.908 Vali Loss: 1.207 Vali Acc: 0.486 Test Loss: 1.207 Test Acc: 0.486
Validation loss decreased (-0.486474 --> -0.486474).  Saving model ...
Epoch: 5 cost time: 2.8453879356384277
Epoch: 5, Steps: 10 | Train Loss: 0.700 Vali Loss: 1.140 Vali Acc: 0.541 Test Loss: 1.140 Test Acc: 0.541
Validation loss decreased (-0.486474 --> -0.540529).  Saving model ...
Epoch: 6 cost time: 2.6510090827941895
Epoch: 6, Steps: 10 | Train Loss: 0.541 Vali Loss: 1.147 Vali Acc: 0.514 Test Loss: 1.147 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.877542734146118
Epoch: 7, Steps: 10 | Train Loss: 0.405 Vali Loss: 1.053 Vali Acc: 0.541 Test Loss: 1.053 Test Acc: 0.541
Validation loss decreased (-0.540529 --> -0.540530).  Saving model ...
Epoch: 8 cost time: 2.8419747352600098
Epoch: 8, Steps: 10 | Train Loss: 0.259 Vali Loss: 1.071 Vali Acc: 0.541 Test Loss: 1.071 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.7191874980926514
Epoch: 9, Steps: 10 | Train Loss: 0.175 Vali Loss: 1.060 Vali Acc: 0.527 Test Loss: 1.060 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.048487424850464
Epoch: 10, Steps: 10 | Train Loss: 0.100 Vali Loss: 1.025 Vali Acc: 0.554 Test Loss: 1.025 Test Acc: 0.554
Validation loss decreased (-0.540530 --> -0.554044).  Saving model ...
Epoch: 11 cost time: 2.8117966651916504
Epoch: 11, Steps: 10 | Train Loss: 0.064 Vali Loss: 1.005 Vali Acc: 0.554 Test Loss: 1.005 Test Acc: 0.554
Validation loss decreased (-0.554044 --> -0.554044).  Saving model ...
Epoch: 12 cost time: 2.8005123138427734
Epoch: 12, Steps: 10 | Train Loss: 0.037 Vali Loss: 1.089 Vali Acc: 0.622 Test Loss: 1.089 Test Acc: 0.622
Validation loss decreased (-0.554044 --> -0.621611).  Saving model ...
Epoch: 13 cost time: 2.9880709648132324
Epoch: 13, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.031 Vali Acc: 0.595 Test Loss: 1.031 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.8759520053863525
Epoch: 14, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.071 Vali Acc: 0.622 Test Loss: 1.071 Test Acc: 0.622
Validation loss decreased (-0.621611 --> -0.621611).  Saving model ...
Epoch: 15 cost time: 2.733273983001709
Epoch: 15, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.066 Vali Acc: 0.595 Test Loss: 1.066 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.909090995788574
Epoch: 16, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.058 Vali Acc: 0.635 Test Loss: 1.058 Test Acc: 0.635
Validation loss decreased (-0.621611 --> -0.635125).  Saving model ...
Epoch: 17 cost time: 2.7360105514526367
Epoch: 17, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.084 Vali Acc: 0.635 Test Loss: 1.084 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.741520404815674
Epoch: 18, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.055 Vali Acc: 0.595 Test Loss: 1.055 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.9273335933685303
Epoch: 19, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.090 Vali Acc: 0.608 Test Loss: 1.090 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.583073854446411
Epoch: 20, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.118 Vali Acc: 0.595 Test Loss: 1.118 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.526134729385376
Epoch: 21, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.105 Vali Acc: 0.635 Test Loss: 1.105 Test Acc: 0.635
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.530444622039795
Epoch: 22, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.124 Vali Acc: 0.622 Test Loss: 1.124 Test Acc: 0.622
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.4121923446655273
Epoch: 23, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.114 Vali Acc: 0.622 Test Loss: 1.114 Test Acc: 0.622
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.5170726776123047
Epoch: 24, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.078 Vali Acc: 0.649 Test Loss: 1.078 Test Acc: 0.649
Validation loss decreased (-0.635125 --> -0.648638).  Saving model ...
Epoch: 25 cost time: 2.3763065338134766
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.110 Vali Acc: 0.622 Test Loss: 1.110 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.290398359298706
Epoch: 26, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.192 Vali Acc: 0.608 Test Loss: 1.192 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.4140689373016357
Epoch: 27, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.152 Vali Acc: 0.595 Test Loss: 1.152 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.428473711013794
Epoch: 28, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.162 Vali Acc: 0.595 Test Loss: 1.162 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.2942943572998047
Epoch: 29, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.414 Vali Acc: 0.554 Test Loss: 1.414 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.5146324634552
Epoch: 30, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.095 Vali Acc: 0.608 Test Loss: 1.095 Test Acc: 0.608
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm32_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6486486486486487
model parameter : 1810692
model size : 7.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm32_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.926729202270508
Epoch: 1, Steps: 10 | Train Loss: 1.418 Vali Loss: 1.412 Vali Acc: 0.270 Test Loss: 1.412 Test Acc: 0.270
Validation loss decreased (inf --> -0.270256).  Saving model ...
Epoch: 2 cost time: 1.581026315689087
Epoch: 2, Steps: 10 | Train Loss: 1.310 Vali Loss: 1.356 Vali Acc: 0.297 Test Loss: 1.356 Test Acc: 0.297
Validation loss decreased (-0.270256 --> -0.297284).  Saving model ...
Epoch: 3 cost time: 1.6101560592651367
Epoch: 3, Steps: 10 | Train Loss: 1.124 Vali Loss: 1.286 Vali Acc: 0.459 Test Loss: 1.286 Test Acc: 0.459
Validation loss decreased (-0.297284 --> -0.459447).  Saving model ...
Epoch: 4 cost time: 1.6268510818481445
Epoch: 4, Steps: 10 | Train Loss: 0.902 Vali Loss: 1.204 Vali Acc: 0.446 Test Loss: 1.204 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5086123943328857
Epoch: 5, Steps: 10 | Train Loss: 0.756 Vali Loss: 1.142 Vali Acc: 0.541 Test Loss: 1.142 Test Acc: 0.541
Validation loss decreased (-0.459447 --> -0.540529).  Saving model ...
Epoch: 6 cost time: 1.591529130935669
Epoch: 6, Steps: 10 | Train Loss: 0.539 Vali Loss: 1.067 Vali Acc: 0.554 Test Loss: 1.067 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554043).  Saving model ...
Epoch: 7 cost time: 1.7332031726837158
Epoch: 7, Steps: 10 | Train Loss: 0.384 Vali Loss: 1.000 Vali Acc: 0.581 Test Loss: 1.000 Test Acc: 0.581
Validation loss decreased (-0.554043 --> -0.581071).  Saving model ...
Epoch: 8 cost time: 1.5933527946472168
Epoch: 8, Steps: 10 | Train Loss: 0.250 Vali Loss: 0.994 Vali Acc: 0.595 Test Loss: 0.994 Test Acc: 0.595
Validation loss decreased (-0.581071 --> -0.594585).  Saving model ...
Epoch: 9 cost time: 1.5152277946472168
Epoch: 9, Steps: 10 | Train Loss: 0.156 Vali Loss: 0.916 Vali Acc: 0.622 Test Loss: 0.916 Test Acc: 0.622
Validation loss decreased (-0.594585 --> -0.621612).  Saving model ...
Epoch: 10 cost time: 1.670792579650879
Epoch: 10, Steps: 10 | Train Loss: 0.089 Vali Loss: 0.952 Vali Acc: 0.635 Test Loss: 0.952 Test Acc: 0.635
Validation loss decreased (-0.621612 --> -0.635126).  Saving model ...
Epoch: 11 cost time: 1.730072259902954
Epoch: 11, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.877 Vali Acc: 0.622 Test Loss: 0.877 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.7135026454925537
Epoch: 12, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.892 Vali Acc: 0.635 Test Loss: 0.892 Test Acc: 0.635
Validation loss decreased (-0.635126 --> -0.635126).  Saving model ...
Epoch: 13 cost time: 1.5457909107208252
Epoch: 13, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.940 Vali Acc: 0.622 Test Loss: 0.940 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6456630229949951
Epoch: 14, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.881 Vali Acc: 0.608 Test Loss: 0.881 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.6735360622406006
Epoch: 15, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.876 Vali Acc: 0.608 Test Loss: 0.876 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.682704210281372
Epoch: 16, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.905 Vali Acc: 0.622 Test Loss: 0.905 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.5906577110290527
Epoch: 17, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.895 Vali Acc: 0.622 Test Loss: 0.895 Test Acc: 0.622
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.6371443271636963
Epoch: 18, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.922 Vali Acc: 0.649 Test Loss: 0.922 Test Acc: 0.649
Validation loss decreased (-0.635126 --> -0.648639).  Saving model ...
Epoch: 19 cost time: 1.6130564212799072
Epoch: 19, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.927 Vali Acc: 0.622 Test Loss: 0.927 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.6277310848236084
Epoch: 20, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.924 Vali Acc: 0.649 Test Loss: 0.924 Test Acc: 0.649
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.6364448070526123
Epoch: 21, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.922 Vali Acc: 0.649 Test Loss: 0.922 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.6386442184448242
Epoch: 22, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.941 Vali Acc: 0.649 Test Loss: 0.941 Test Acc: 0.649
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.6028378009796143
Epoch: 23, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.957 Vali Acc: 0.635 Test Loss: 0.957 Test Acc: 0.635
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.5949347019195557
Epoch: 24, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.946 Vali Acc: 0.635 Test Loss: 0.946 Test Acc: 0.635
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.6491777896881104
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.962 Vali Acc: 0.635 Test Loss: 0.962 Test Acc: 0.635
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.5319795608520508
Epoch: 26, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.982 Vali Acc: 0.622 Test Loss: 0.982 Test Acc: 0.622
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.4395272731781006
Epoch: 27, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.001 Vali Acc: 0.649 Test Loss: 1.001 Test Acc: 0.649
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.3824682235717773
Epoch: 28, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.987 Vali Acc: 0.635 Test Loss: 0.987 Test Acc: 0.635
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm32_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6486486486486487
model parameter : 569220
model size : 2.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm32_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.2139790058135986
Epoch: 1, Steps: 10 | Train Loss: 1.418 Vali Loss: 1.373 Vali Acc: 0.297 Test Loss: 1.373 Test Acc: 0.297
Validation loss decreased (inf --> -0.297284).  Saving model ...
Epoch: 2 cost time: 1.8449554443359375
Epoch: 2, Steps: 10 | Train Loss: 1.287 Vali Loss: 1.342 Vali Acc: 0.378 Test Loss: 1.342 Test Acc: 0.378
Validation loss decreased (-0.297284 --> -0.378365).  Saving model ...
Epoch: 3 cost time: 1.8560004234313965
Epoch: 3, Steps: 10 | Train Loss: 1.153 Vali Loss: 1.261 Vali Acc: 0.432 Test Loss: 1.261 Test Acc: 0.432
Validation loss decreased (-0.378365 --> -0.432420).  Saving model ...
Epoch: 4 cost time: 2.051784038543701
Epoch: 4, Steps: 10 | Train Loss: 0.951 Vali Loss: 1.223 Vali Acc: 0.459 Test Loss: 1.223 Test Acc: 0.459
Validation loss decreased (-0.432420 --> -0.459447).  Saving model ...
Epoch: 5 cost time: 1.9073352813720703
Epoch: 5, Steps: 10 | Train Loss: 0.757 Vali Loss: 1.161 Vali Acc: 0.500 Test Loss: 1.161 Test Acc: 0.500
Validation loss decreased (-0.459447 --> -0.499988).  Saving model ...
Epoch: 6 cost time: 1.5272445678710938
Epoch: 6, Steps: 10 | Train Loss: 0.613 Vali Loss: 1.168 Vali Acc: 0.514 Test Loss: 1.168 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513502).  Saving model ...
Epoch: 7 cost time: 2.124337911605835
Epoch: 7, Steps: 10 | Train Loss: 0.474 Vali Loss: 1.076 Vali Acc: 0.527 Test Loss: 1.076 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527016).  Saving model ...
Epoch: 8 cost time: 2.1715052127838135
Epoch: 8, Steps: 10 | Train Loss: 0.336 Vali Loss: 1.079 Vali Acc: 0.500 Test Loss: 1.079 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.064910888671875
Epoch: 9, Steps: 10 | Train Loss: 0.232 Vali Loss: 1.090 Vali Acc: 0.527 Test Loss: 1.090 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.1831047534942627
Epoch: 10, Steps: 10 | Train Loss: 0.141 Vali Loss: 0.983 Vali Acc: 0.568 Test Loss: 0.983 Test Acc: 0.568
Validation loss decreased (-0.527016 --> -0.567558).  Saving model ...
Epoch: 11 cost time: 2.2228426933288574
Epoch: 11, Steps: 10 | Train Loss: 0.091 Vali Loss: 1.066 Vali Acc: 0.581 Test Loss: 1.066 Test Acc: 0.581
Validation loss decreased (-0.567558 --> -0.581070).  Saving model ...
Epoch: 12 cost time: 2.0677173137664795
Epoch: 12, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.997 Vali Acc: 0.581 Test Loss: 0.997 Test Acc: 0.581
Validation loss decreased (-0.581070 --> -0.581071).  Saving model ...
Epoch: 13 cost time: 2.0390379428863525
Epoch: 13, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.976 Vali Acc: 0.608 Test Loss: 0.976 Test Acc: 0.608
Validation loss decreased (-0.581071 --> -0.608098).  Saving model ...
Epoch: 14 cost time: 2.021801471710205
Epoch: 14, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.022 Vali Acc: 0.595 Test Loss: 1.022 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.177431344985962
Epoch: 15, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.997 Vali Acc: 0.595 Test Loss: 0.997 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.9701855182647705
Epoch: 16, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.003 Vali Acc: 0.581 Test Loss: 1.003 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.1206393241882324
Epoch: 17, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.046 Vali Acc: 0.595 Test Loss: 1.046 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.1468541622161865
Epoch: 18, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.032 Vali Acc: 0.595 Test Loss: 1.032 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.1083791255950928
Epoch: 19, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.018 Vali Acc: 0.595 Test Loss: 1.018 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.1829967498779297
Epoch: 20, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.050 Vali Acc: 0.608 Test Loss: 1.050 Test Acc: 0.608
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.0778417587280273
Epoch: 21, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.059 Vali Acc: 0.595 Test Loss: 1.059 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.180286169052124
Epoch: 22, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.056 Vali Acc: 0.608 Test Loss: 1.056 Test Acc: 0.608
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.0476653575897217
Epoch: 23, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.086 Vali Acc: 0.622 Test Loss: 1.086 Test Acc: 0.622
Validation loss decreased (-0.608098 --> -0.621611).  Saving model ...
Epoch: 24 cost time: 2.1600606441497803
Epoch: 24, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.077 Vali Acc: 0.608 Test Loss: 1.077 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.169238805770874
Epoch: 25, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.089 Vali Acc: 0.608 Test Loss: 1.089 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.1112260818481445
Epoch: 26, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.102 Vali Acc: 0.581 Test Loss: 1.102 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.1010608673095703
Epoch: 27, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.108 Vali Acc: 0.581 Test Loss: 1.108 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.0097296237945557
Epoch: 28, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.117 Vali Acc: 0.595 Test Loss: 1.117 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.17332124710083
Epoch: 29, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.124 Vali Acc: 0.608 Test Loss: 1.124 Test Acc: 0.608
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.9511692523956299
Epoch: 30, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.129 Vali Acc: 0.608 Test Loss: 1.129 Test Acc: 0.608
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm32_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 1810692
model size : 7.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm32_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.6750166416168213
Epoch: 1, Steps: 10 | Train Loss: 1.416 Vali Loss: 1.411 Vali Acc: 0.257 Test Loss: 1.411 Test Acc: 0.257
Validation loss decreased (inf --> -0.256743).  Saving model ...
Epoch: 2 cost time: 1.0046968460083008
Epoch: 2, Steps: 10 | Train Loss: 1.312 Vali Loss: 1.343 Vali Acc: 0.284 Test Loss: 1.343 Test Acc: 0.284
Validation loss decreased (-0.256743 --> -0.283770).  Saving model ...
Epoch: 3 cost time: 0.9014976024627686
Epoch: 3, Steps: 10 | Train Loss: 1.143 Vali Loss: 1.284 Vali Acc: 0.446 Test Loss: 1.284 Test Acc: 0.446
Validation loss decreased (-0.283770 --> -0.445933).  Saving model ...
Epoch: 4 cost time: 0.9495832920074463
Epoch: 4, Steps: 10 | Train Loss: 0.934 Vali Loss: 1.198 Vali Acc: 0.486 Test Loss: 1.198 Test Acc: 0.486
Validation loss decreased (-0.445933 --> -0.486475).  Saving model ...
Epoch: 5 cost time: 0.9124927520751953
Epoch: 5, Steps: 10 | Train Loss: 0.815 Vali Loss: 1.161 Vali Acc: 0.500 Test Loss: 1.161 Test Acc: 0.500
Validation loss decreased (-0.486475 --> -0.499988).  Saving model ...
Epoch: 6 cost time: 1.0110104084014893
Epoch: 6, Steps: 10 | Train Loss: 0.609 Vali Loss: 1.074 Vali Acc: 0.608 Test Loss: 1.074 Test Acc: 0.608
Validation loss decreased (-0.499988 --> -0.608097).  Saving model ...
Epoch: 7 cost time: 0.995192289352417
Epoch: 7, Steps: 10 | Train Loss: 0.466 Vali Loss: 1.010 Vali Acc: 0.608 Test Loss: 1.010 Test Acc: 0.608
Validation loss decreased (-0.608097 --> -0.608098).  Saving model ...
Epoch: 8 cost time: 1.0868127346038818
Epoch: 8, Steps: 10 | Train Loss: 0.328 Vali Loss: 1.011 Vali Acc: 0.595 Test Loss: 1.011 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3051750659942627
Epoch: 9, Steps: 10 | Train Loss: 0.234 Vali Loss: 0.947 Vali Acc: 0.608 Test Loss: 0.947 Test Acc: 0.608
Validation loss decreased (-0.608098 --> -0.608099).  Saving model ...
Epoch: 10 cost time: 0.926192045211792
Epoch: 10, Steps: 10 | Train Loss: 0.149 Vali Loss: 0.947 Vali Acc: 0.622 Test Loss: 0.947 Test Acc: 0.622
Validation loss decreased (-0.608099 --> -0.621612).  Saving model ...
Epoch: 11 cost time: 1.3195805549621582
Epoch: 11, Steps: 10 | Train Loss: 0.096 Vali Loss: 0.897 Vali Acc: 0.622 Test Loss: 0.897 Test Acc: 0.622
Validation loss decreased (-0.621612 --> -0.621613).  Saving model ...
Epoch: 12 cost time: 1.4078214168548584
Epoch: 12, Steps: 10 | Train Loss: 0.064 Vali Loss: 0.913 Vali Acc: 0.622 Test Loss: 0.913 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4173002243041992
Epoch: 13, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.908 Vali Acc: 0.622 Test Loss: 0.908 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.4530327320098877
Epoch: 14, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.904 Vali Acc: 0.608 Test Loss: 0.904 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.5065128803253174
Epoch: 15, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.913 Vali Acc: 0.568 Test Loss: 0.913 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.404099464416504
Epoch: 16, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.930 Vali Acc: 0.568 Test Loss: 0.930 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.2544519901275635
Epoch: 17, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.930 Vali Acc: 0.581 Test Loss: 0.930 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.4449963569641113
Epoch: 18, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.959 Vali Acc: 0.595 Test Loss: 0.959 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.4604592323303223
Epoch: 19, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.946 Vali Acc: 0.581 Test Loss: 0.946 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.5075757503509521
Epoch: 20, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.937 Vali Acc: 0.595 Test Loss: 0.937 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.343860149383545
Epoch: 21, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.932 Vali Acc: 0.581 Test Loss: 0.932 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm32_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 569220
model size : 2.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm16_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 6.112830877304077
Epoch: 1, Steps: 10 | Train Loss: 1.405 Vali Loss: 1.329 Vali Acc: 0.338 Test Loss: 1.329 Test Acc: 0.338
Validation loss decreased (inf --> -0.337825).  Saving model ...
Epoch: 2 cost time: 4.721296072006226
Epoch: 2, Steps: 10 | Train Loss: 1.310 Vali Loss: 1.349 Vali Acc: 0.297 Test Loss: 1.349 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.577153921127319
Epoch: 3, Steps: 10 | Train Loss: 1.231 Vali Loss: 1.328 Vali Acc: 0.338 Test Loss: 1.328 Test Acc: 0.338
Validation loss decreased (-0.337825 --> -0.337825).  Saving model ...
Epoch: 4 cost time: 4.872576713562012
Epoch: 4, Steps: 10 | Train Loss: 1.112 Vali Loss: 1.258 Vali Acc: 0.473 Test Loss: 1.258 Test Acc: 0.473
Validation loss decreased (-0.337825 --> -0.472960).  Saving model ...
Epoch: 5 cost time: 4.705135822296143
Epoch: 5, Steps: 10 | Train Loss: 0.969 Vali Loss: 1.228 Vali Acc: 0.473 Test Loss: 1.228 Test Acc: 0.473
Validation loss decreased (-0.472960 --> -0.472961).  Saving model ...
Epoch: 6 cost time: 4.537645578384399
Epoch: 6, Steps: 10 | Train Loss: 0.825 Vali Loss: 1.189 Vali Acc: 0.527 Test Loss: 1.189 Test Acc: 0.527
Validation loss decreased (-0.472961 --> -0.527015).  Saving model ...
Epoch: 7 cost time: 4.625149250030518
Epoch: 7, Steps: 10 | Train Loss: 0.692 Vali Loss: 1.146 Vali Acc: 0.554 Test Loss: 1.146 Test Acc: 0.554
Validation loss decreased (-0.527015 --> -0.554043).  Saving model ...
Epoch: 8 cost time: 4.001428127288818
Epoch: 8, Steps: 10 | Train Loss: 0.600 Vali Loss: 1.200 Vali Acc: 0.500 Test Loss: 1.200 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.008272171020508
Epoch: 9, Steps: 10 | Train Loss: 0.471 Vali Loss: 1.124 Vali Acc: 0.514 Test Loss: 1.124 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.03303861618042
Epoch: 10, Steps: 10 | Train Loss: 0.364 Vali Loss: 1.144 Vali Acc: 0.527 Test Loss: 1.144 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.7577829360961914
Epoch: 11, Steps: 10 | Train Loss: 0.283 Vali Loss: 1.079 Vali Acc: 0.541 Test Loss: 1.079 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.018109083175659
Epoch: 12, Steps: 10 | Train Loss: 0.205 Vali Loss: 1.114 Vali Acc: 0.527 Test Loss: 1.114 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.480175256729126
Epoch: 13, Steps: 10 | Train Loss: 0.139 Vali Loss: 1.097 Vali Acc: 0.514 Test Loss: 1.097 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.983489513397217
Epoch: 14, Steps: 10 | Train Loss: 0.097 Vali Loss: 1.120 Vali Acc: 0.527 Test Loss: 1.120 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.912101984024048
Epoch: 15, Steps: 10 | Train Loss: 0.077 Vali Loss: 1.119 Vali Acc: 0.554 Test Loss: 1.119 Test Acc: 0.554
Validation loss decreased (-0.554043 --> -0.554043).  Saving model ...
Epoch: 16 cost time: 3.9021692276000977
Epoch: 16, Steps: 10 | Train Loss: 0.052 Vali Loss: 1.111 Vali Acc: 0.514 Test Loss: 1.111 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.8706531524658203
Epoch: 17, Steps: 10 | Train Loss: 0.043 Vali Loss: 1.149 Vali Acc: 0.514 Test Loss: 1.149 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.8778436183929443
Epoch: 18, Steps: 10 | Train Loss: 0.042 Vali Loss: 1.157 Vali Acc: 0.541 Test Loss: 1.157 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 4.466427564620972
Epoch: 19, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.054 Vali Acc: 0.554 Test Loss: 1.054 Test Acc: 0.554
Validation loss decreased (-0.554043 --> -0.554044).  Saving model ...
Epoch: 20 cost time: 4.3550074100494385
Epoch: 20, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.127 Vali Acc: 0.554 Test Loss: 1.127 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 4.585094928741455
Epoch: 21, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.185 Vali Acc: 0.514 Test Loss: 1.185 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 4.4088404178619385
Epoch: 22, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.157 Vali Acc: 0.527 Test Loss: 1.157 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 4.394415378570557
Epoch: 23, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.154 Vali Acc: 0.514 Test Loss: 1.154 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 4.46323037147522
Epoch: 24, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.170 Vali Acc: 0.486 Test Loss: 1.170 Test Acc: 0.486
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 4.318227052688599
Epoch: 25, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.190 Vali Acc: 0.486 Test Loss: 1.190 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 4.559677362442017
Epoch: 26, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.208 Vali Acc: 0.500 Test Loss: 1.208 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 4.436884641647339
Epoch: 27, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.199 Vali Acc: 0.514 Test Loss: 1.199 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 4.496025323867798
Epoch: 28, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.189 Vali Acc: 0.527 Test Loss: 1.189 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 4.48917293548584
Epoch: 29, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.206 Vali Acc: 0.514 Test Loss: 1.206 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm16_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 1784804
model size : 7.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm16_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.030841827392578
Epoch: 1, Steps: 10 | Train Loss: 1.413 Vali Loss: 1.427 Vali Acc: 0.297 Test Loss: 1.427 Test Acc: 0.297
Validation loss decreased (inf --> -0.297283).  Saving model ...
Epoch: 2 cost time: 2.4469497203826904
Epoch: 2, Steps: 10 | Train Loss: 1.350 Vali Loss: 1.424 Vali Acc: 0.324 Test Loss: 1.424 Test Acc: 0.324
Validation loss decreased (-0.297283 --> -0.324310).  Saving model ...
Epoch: 3 cost time: 2.098215103149414
Epoch: 3, Steps: 10 | Train Loss: 1.243 Vali Loss: 1.374 Vali Acc: 0.338 Test Loss: 1.374 Test Acc: 0.338
Validation loss decreased (-0.324310 --> -0.337824).  Saving model ...
Epoch: 4 cost time: 2.0970070362091064
Epoch: 4, Steps: 10 | Train Loss: 1.134 Vali Loss: 1.327 Vali Acc: 0.473 Test Loss: 1.327 Test Acc: 0.473
Validation loss decreased (-0.337824 --> -0.472960).  Saving model ...
Epoch: 5 cost time: 2.141989231109619
Epoch: 5, Steps: 10 | Train Loss: 0.990 Vali Loss: 1.304 Vali Acc: 0.459 Test Loss: 1.304 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.9868121147155762
Epoch: 6, Steps: 10 | Train Loss: 0.861 Vali Loss: 1.251 Vali Acc: 0.514 Test Loss: 1.251 Test Acc: 0.514
Validation loss decreased (-0.472960 --> -0.513501).  Saving model ...
Epoch: 7 cost time: 2.106851816177368
Epoch: 7, Steps: 10 | Train Loss: 0.712 Vali Loss: 1.219 Vali Acc: 0.473 Test Loss: 1.219 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.0478246212005615
Epoch: 8, Steps: 10 | Train Loss: 0.588 Vali Loss: 1.182 Vali Acc: 0.500 Test Loss: 1.182 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.1123921871185303
Epoch: 9, Steps: 10 | Train Loss: 0.476 Vali Loss: 1.168 Vali Acc: 0.486 Test Loss: 1.168 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.0673317909240723
Epoch: 10, Steps: 10 | Train Loss: 0.367 Vali Loss: 1.169 Vali Acc: 0.473 Test Loss: 1.169 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.034449338912964
Epoch: 11, Steps: 10 | Train Loss: 0.278 Vali Loss: 1.142 Vali Acc: 0.473 Test Loss: 1.142 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.137000560760498
Epoch: 12, Steps: 10 | Train Loss: 0.209 Vali Loss: 1.197 Vali Acc: 0.500 Test Loss: 1.197 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.2555103302001953
Epoch: 13, Steps: 10 | Train Loss: 0.150 Vali Loss: 1.163 Vali Acc: 0.473 Test Loss: 1.163 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.263758897781372
Epoch: 14, Steps: 10 | Train Loss: 0.110 Vali Loss: 1.204 Vali Acc: 0.500 Test Loss: 1.204 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.3374757766723633
Epoch: 15, Steps: 10 | Train Loss: 0.080 Vali Loss: 1.195 Vali Acc: 0.514 Test Loss: 1.195 Test Acc: 0.514
Validation loss decreased (-0.513501 --> -0.513502).  Saving model ...
Epoch: 16 cost time: 2.1792328357696533
Epoch: 16, Steps: 10 | Train Loss: 0.055 Vali Loss: 1.267 Vali Acc: 0.500 Test Loss: 1.267 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.165966510772705
Epoch: 17, Steps: 10 | Train Loss: 0.049 Vali Loss: 1.257 Vali Acc: 0.486 Test Loss: 1.257 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.6448254585266113
Epoch: 18, Steps: 10 | Train Loss: 0.042 Vali Loss: 1.240 Vali Acc: 0.473 Test Loss: 1.240 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.4009804725646973
Epoch: 19, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.303 Vali Acc: 0.473 Test Loss: 1.303 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.499821662902832
Epoch: 20, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.336 Vali Acc: 0.500 Test Loss: 1.336 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.9783263206481934
Epoch: 21, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.378 Vali Acc: 0.500 Test Loss: 1.378 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.629624605178833
Epoch: 22, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.413 Vali Acc: 0.486 Test Loss: 1.413 Test Acc: 0.486
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.484980583190918
Epoch: 23, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.390 Vali Acc: 0.473 Test Loss: 1.390 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.5747907161712646
Epoch: 24, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.456 Vali Acc: 0.473 Test Loss: 1.456 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.645379066467285
Epoch: 25, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.453 Vali Acc: 0.500 Test Loss: 1.453 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm16_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5135135135135135
model parameter : 543236
model size : 2.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm16_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.194280385971069
Epoch: 1, Steps: 10 | Train Loss: 1.402 Vali Loss: 1.331 Vali Acc: 0.351 Test Loss: 1.331 Test Acc: 0.351
Validation loss decreased (inf --> -0.351338).  Saving model ...
Epoch: 2 cost time: 3.683729410171509
Epoch: 2, Steps: 10 | Train Loss: 1.313 Vali Loss: 1.352 Vali Acc: 0.297 Test Loss: 1.352 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.7395665645599365
Epoch: 3, Steps: 10 | Train Loss: 1.244 Vali Loss: 1.335 Vali Acc: 0.351 Test Loss: 1.335 Test Acc: 0.351
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.820761203765869
Epoch: 4, Steps: 10 | Train Loss: 1.135 Vali Loss: 1.267 Vali Acc: 0.459 Test Loss: 1.267 Test Acc: 0.459
Validation loss decreased (-0.351338 --> -0.459447).  Saving model ...
Epoch: 5 cost time: 3.689923048019409
Epoch: 5, Steps: 10 | Train Loss: 1.003 Vali Loss: 1.236 Vali Acc: 0.500 Test Loss: 1.236 Test Acc: 0.500
Validation loss decreased (-0.459447 --> -0.499988).  Saving model ...
Epoch: 6 cost time: 3.546898126602173
Epoch: 6, Steps: 10 | Train Loss: 0.870 Vali Loss: 1.198 Vali Acc: 0.541 Test Loss: 1.198 Test Acc: 0.541
Validation loss decreased (-0.499988 --> -0.540529).  Saving model ...
Epoch: 7 cost time: 3.750539541244507
Epoch: 7, Steps: 10 | Train Loss: 0.743 Vali Loss: 1.158 Vali Acc: 0.527 Test Loss: 1.158 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.5061028003692627
Epoch: 8, Steps: 10 | Train Loss: 0.645 Vali Loss: 1.205 Vali Acc: 0.486 Test Loss: 1.205 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.930821180343628
Epoch: 9, Steps: 10 | Train Loss: 0.512 Vali Loss: 1.114 Vali Acc: 0.595 Test Loss: 1.114 Test Acc: 0.595
Validation loss decreased (-0.540529 --> -0.594583).  Saving model ...
Epoch: 10 cost time: 3.333843469619751
Epoch: 10, Steps: 10 | Train Loss: 0.397 Vali Loss: 1.129 Vali Acc: 0.527 Test Loss: 1.129 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.099973201751709
Epoch: 11, Steps: 10 | Train Loss: 0.306 Vali Loss: 1.076 Vali Acc: 0.568 Test Loss: 1.076 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.1513657569885254
Epoch: 12, Steps: 10 | Train Loss: 0.223 Vali Loss: 1.111 Vali Acc: 0.541 Test Loss: 1.111 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.237741708755493
Epoch: 13, Steps: 10 | Train Loss: 0.158 Vali Loss: 1.090 Vali Acc: 0.541 Test Loss: 1.090 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.0619990825653076
Epoch: 14, Steps: 10 | Train Loss: 0.113 Vali Loss: 1.100 Vali Acc: 0.527 Test Loss: 1.100 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.9820408821105957
Epoch: 15, Steps: 10 | Train Loss: 0.079 Vali Loss: 1.102 Vali Acc: 0.568 Test Loss: 1.102 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.819610834121704
Epoch: 16, Steps: 10 | Train Loss: 0.055 Vali Loss: 1.121 Vali Acc: 0.554 Test Loss: 1.121 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.5318996906280518
Epoch: 17, Steps: 10 | Train Loss: 0.053 Vali Loss: 1.173 Vali Acc: 0.527 Test Loss: 1.173 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.5932209491729736
Epoch: 18, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.158 Vali Acc: 0.527 Test Loss: 1.158 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.887866497039795
Epoch: 19, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.123 Vali Acc: 0.527 Test Loss: 1.123 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm16_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 1784804
model size : 7.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm16_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.430223226547241
Epoch: 1, Steps: 10 | Train Loss: 1.418 Vali Loss: 1.429 Vali Acc: 0.270 Test Loss: 1.429 Test Acc: 0.270
Validation loss decreased (inf --> -0.270256).  Saving model ...
Epoch: 2 cost time: 1.7974069118499756
Epoch: 2, Steps: 10 | Train Loss: 1.354 Vali Loss: 1.427 Vali Acc: 0.324 Test Loss: 1.427 Test Acc: 0.324
Validation loss decreased (-0.270256 --> -0.324310).  Saving model ...
Epoch: 3 cost time: 1.938507080078125
Epoch: 3, Steps: 10 | Train Loss: 1.251 Vali Loss: 1.379 Vali Acc: 0.365 Test Loss: 1.379 Test Acc: 0.365
Validation loss decreased (-0.324310 --> -0.364851).  Saving model ...
Epoch: 4 cost time: 1.8618247509002686
Epoch: 4, Steps: 10 | Train Loss: 1.149 Vali Loss: 1.332 Vali Acc: 0.432 Test Loss: 1.332 Test Acc: 0.432
Validation loss decreased (-0.364851 --> -0.432419).  Saving model ...
Epoch: 5 cost time: 1.8869876861572266
Epoch: 5, Steps: 10 | Train Loss: 1.009 Vali Loss: 1.310 Vali Acc: 0.432 Test Loss: 1.310 Test Acc: 0.432
Validation loss decreased (-0.432419 --> -0.432419).  Saving model ...
Epoch: 6 cost time: 1.984365701675415
Epoch: 6, Steps: 10 | Train Loss: 0.886 Vali Loss: 1.255 Vali Acc: 0.527 Test Loss: 1.255 Test Acc: 0.527
Validation loss decreased (-0.432419 --> -0.527014).  Saving model ...
Epoch: 7 cost time: 1.8825526237487793
Epoch: 7, Steps: 10 | Train Loss: 0.740 Vali Loss: 1.217 Vali Acc: 0.500 Test Loss: 1.217 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8597636222839355
Epoch: 8, Steps: 10 | Train Loss: 0.613 Vali Loss: 1.176 Vali Acc: 0.500 Test Loss: 1.176 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.9352221488952637
Epoch: 9, Steps: 10 | Train Loss: 0.504 Vali Loss: 1.151 Vali Acc: 0.514 Test Loss: 1.151 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.02679181098938
Epoch: 10, Steps: 10 | Train Loss: 0.388 Vali Loss: 1.153 Vali Acc: 0.527 Test Loss: 1.153 Test Acc: 0.527
Validation loss decreased (-0.527014 --> -0.527015).  Saving model ...
Epoch: 11 cost time: 1.8104724884033203
Epoch: 11, Steps: 10 | Train Loss: 0.295 Vali Loss: 1.114 Vali Acc: 0.500 Test Loss: 1.114 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8717865943908691
Epoch: 12, Steps: 10 | Train Loss: 0.227 Vali Loss: 1.154 Vali Acc: 0.527 Test Loss: 1.154 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.8882472515106201
Epoch: 13, Steps: 10 | Train Loss: 0.163 Vali Loss: 1.125 Vali Acc: 0.554 Test Loss: 1.125 Test Acc: 0.554
Validation loss decreased (-0.527015 --> -0.554043).  Saving model ...
Epoch: 14 cost time: 1.7710797786712646
Epoch: 14, Steps: 10 | Train Loss: 0.118 Vali Loss: 1.174 Vali Acc: 0.541 Test Loss: 1.174 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.8852968215942383
Epoch: 15, Steps: 10 | Train Loss: 0.084 Vali Loss: 1.149 Vali Acc: 0.527 Test Loss: 1.149 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.8682560920715332
Epoch: 16, Steps: 10 | Train Loss: 0.061 Vali Loss: 1.213 Vali Acc: 0.459 Test Loss: 1.213 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.7751553058624268
Epoch: 17, Steps: 10 | Train Loss: 0.053 Vali Loss: 1.188 Vali Acc: 0.500 Test Loss: 1.188 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.8976449966430664
Epoch: 18, Steps: 10 | Train Loss: 0.043 Vali Loss: 1.173 Vali Acc: 0.527 Test Loss: 1.173 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.8546671867370605
Epoch: 19, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.218 Vali Acc: 0.486 Test Loss: 1.218 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.1552424430847168
Epoch: 20, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.207 Vali Acc: 0.500 Test Loss: 1.207 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.6230919361114502
Epoch: 21, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.215 Vali Acc: 0.500 Test Loss: 1.215 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.6719741821289062
Epoch: 22, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.216 Vali Acc: 0.486 Test Loss: 1.216 Test Acc: 0.486
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.6272008419036865
Epoch: 23, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.215 Vali Acc: 0.500 Test Loss: 1.215 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm16_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 543236
model size : 2.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm16_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.3835415840148926
Epoch: 1, Steps: 10 | Train Loss: 1.399 Vali Loss: 1.329 Vali Acc: 0.365 Test Loss: 1.329 Test Acc: 0.365
Validation loss decreased (inf --> -0.364852).  Saving model ...
Epoch: 2 cost time: 1.7431714534759521
Epoch: 2, Steps: 10 | Train Loss: 1.314 Vali Loss: 1.349 Vali Acc: 0.311 Test Loss: 1.349 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8900322914123535
Epoch: 3, Steps: 10 | Train Loss: 1.248 Vali Loss: 1.331 Vali Acc: 0.378 Test Loss: 1.331 Test Acc: 0.378
Validation loss decreased (-0.364852 --> -0.378365).  Saving model ...
Epoch: 4 cost time: 1.9077348709106445
Epoch: 4, Steps: 10 | Train Loss: 1.145 Vali Loss: 1.263 Vali Acc: 0.459 Test Loss: 1.263 Test Acc: 0.459
Validation loss decreased (-0.378365 --> -0.459447).  Saving model ...
Epoch: 5 cost time: 2.241509199142456
Epoch: 5, Steps: 10 | Train Loss: 1.021 Vali Loss: 1.231 Vali Acc: 0.473 Test Loss: 1.231 Test Acc: 0.473
Validation loss decreased (-0.459447 --> -0.472961).  Saving model ...
Epoch: 6 cost time: 2.100433111190796
Epoch: 6, Steps: 10 | Train Loss: 0.893 Vali Loss: 1.194 Vali Acc: 0.514 Test Loss: 1.194 Test Acc: 0.514
Validation loss decreased (-0.472961 --> -0.513502).  Saving model ...
Epoch: 7 cost time: 1.989405870437622
Epoch: 7, Steps: 10 | Train Loss: 0.775 Vali Loss: 1.152 Vali Acc: 0.554 Test Loss: 1.152 Test Acc: 0.554
Validation loss decreased (-0.513502 --> -0.554043).  Saving model ...
Epoch: 8 cost time: 2.142239809036255
Epoch: 8, Steps: 10 | Train Loss: 0.688 Vali Loss: 1.195 Vali Acc: 0.486 Test Loss: 1.195 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.1922173500061035
Epoch: 9, Steps: 10 | Train Loss: 0.560 Vali Loss: 1.103 Vali Acc: 0.568 Test Loss: 1.103 Test Acc: 0.568
Validation loss decreased (-0.554043 --> -0.567557).  Saving model ...
Epoch: 10 cost time: 2.173553943634033
Epoch: 10, Steps: 10 | Train Loss: 0.451 Vali Loss: 1.103 Vali Acc: 0.568 Test Loss: 1.103 Test Acc: 0.568
Validation loss decreased (-0.567557 --> -0.567557).  Saving model ...
Epoch: 11 cost time: 2.150869846343994
Epoch: 11, Steps: 10 | Train Loss: 0.369 Vali Loss: 1.054 Vali Acc: 0.568 Test Loss: 1.054 Test Acc: 0.568
Validation loss decreased (-0.567557 --> -0.567557).  Saving model ...
Epoch: 12 cost time: 2.0584981441497803
Epoch: 12, Steps: 10 | Train Loss: 0.279 Vali Loss: 1.070 Vali Acc: 0.541 Test Loss: 1.070 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.0689547061920166
Epoch: 13, Steps: 10 | Train Loss: 0.208 Vali Loss: 1.040 Vali Acc: 0.527 Test Loss: 1.040 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.3024728298187256
Epoch: 14, Steps: 10 | Train Loss: 0.151 Vali Loss: 1.044 Vali Acc: 0.541 Test Loss: 1.044 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.179617404937744
Epoch: 15, Steps: 10 | Train Loss: 0.105 Vali Loss: 1.046 Vali Acc: 0.581 Test Loss: 1.046 Test Acc: 0.581
Validation loss decreased (-0.567557 --> -0.581071).  Saving model ...
Epoch: 16 cost time: 2.2354490756988525
Epoch: 16, Steps: 10 | Train Loss: 0.080 Vali Loss: 1.040 Vali Acc: 0.541 Test Loss: 1.040 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.1413917541503906
Epoch: 17, Steps: 10 | Train Loss: 0.066 Vali Loss: 1.098 Vali Acc: 0.581 Test Loss: 1.098 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.1642959117889404
Epoch: 18, Steps: 10 | Train Loss: 0.054 Vali Loss: 1.072 Vali Acc: 0.541 Test Loss: 1.072 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.1672475337982178
Epoch: 19, Steps: 10 | Train Loss: 0.040 Vali Loss: 1.046 Vali Acc: 0.554 Test Loss: 1.046 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.153578519821167
Epoch: 20, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.084 Vali Acc: 0.541 Test Loss: 1.084 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.211379051208496
Epoch: 21, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.091 Vali Acc: 0.541 Test Loss: 1.091 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.146043300628662
Epoch: 22, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.086 Vali Acc: 0.595 Test Loss: 1.086 Test Acc: 0.595
Validation loss decreased (-0.581071 --> -0.594584).  Saving model ...
Epoch: 23 cost time: 2.2021589279174805
Epoch: 23, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.100 Vali Acc: 0.541 Test Loss: 1.100 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.2729666233062744
Epoch: 24, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.102 Vali Acc: 0.541 Test Loss: 1.102 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.2447807788848877
Epoch: 25, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.104 Vali Acc: 0.581 Test Loss: 1.104 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.946146011352539
Epoch: 26, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.126 Vali Acc: 0.568 Test Loss: 1.126 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.9182875156402588
Epoch: 27, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.134 Vali Acc: 0.568 Test Loss: 1.134 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.8537373542785645
Epoch: 28, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.141 Vali Acc: 0.554 Test Loss: 1.141 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 2.0268361568450928
Epoch: 29, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.146 Vali Acc: 0.568 Test Loss: 1.146 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.9429433345794678
Epoch: 30, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.136 Vali Acc: 0.595 Test Loss: 1.136 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm16_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 1784804
model size : 7.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm16_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.63507080078125
Epoch: 1, Steps: 10 | Train Loss: 1.420 Vali Loss: 1.433 Vali Acc: 0.297 Test Loss: 1.433 Test Acc: 0.297
Validation loss decreased (inf --> -0.297283).  Saving model ...
Epoch: 2 cost time: 1.2002894878387451
Epoch: 2, Steps: 10 | Train Loss: 1.359 Vali Loss: 1.432 Vali Acc: 0.311 Test Loss: 1.432 Test Acc: 0.311
Validation loss decreased (-0.297283 --> -0.310796).  Saving model ...
Epoch: 3 cost time: 1.2957713603973389
Epoch: 3, Steps: 10 | Train Loss: 1.258 Vali Loss: 1.385 Vali Acc: 0.324 Test Loss: 1.385 Test Acc: 0.324
Validation loss decreased (-0.310796 --> -0.324310).  Saving model ...
Epoch: 4 cost time: 1.2612781524658203
Epoch: 4, Steps: 10 | Train Loss: 1.161 Vali Loss: 1.339 Vali Acc: 0.473 Test Loss: 1.339 Test Acc: 0.473
Validation loss decreased (-0.324310 --> -0.472960).  Saving model ...
Epoch: 5 cost time: 1.3613603115081787
Epoch: 5, Steps: 10 | Train Loss: 1.027 Vali Loss: 1.314 Vali Acc: 0.405 Test Loss: 1.314 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3700432777404785
Epoch: 6, Steps: 10 | Train Loss: 0.913 Vali Loss: 1.263 Vali Acc: 0.514 Test Loss: 1.263 Test Acc: 0.514
Validation loss decreased (-0.472960 --> -0.513501).  Saving model ...
Epoch: 7 cost time: 1.3991005420684814
Epoch: 7, Steps: 10 | Train Loss: 0.766 Vali Loss: 1.222 Vali Acc: 0.459 Test Loss: 1.222 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3360028266906738
Epoch: 8, Steps: 10 | Train Loss: 0.648 Vali Loss: 1.183 Vali Acc: 0.500 Test Loss: 1.183 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.3482489585876465
Epoch: 9, Steps: 10 | Train Loss: 0.543 Vali Loss: 1.160 Vali Acc: 0.514 Test Loss: 1.160 Test Acc: 0.514
Validation loss decreased (-0.513501 --> -0.513502).  Saving model ...
Epoch: 10 cost time: 1.3712942600250244
Epoch: 10, Steps: 10 | Train Loss: 0.424 Vali Loss: 1.156 Vali Acc: 0.527 Test Loss: 1.156 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527015).  Saving model ...
Epoch: 11 cost time: 1.2426552772521973
Epoch: 11, Steps: 10 | Train Loss: 0.335 Vali Loss: 1.117 Vali Acc: 0.541 Test Loss: 1.117 Test Acc: 0.541
Validation loss decreased (-0.527015 --> -0.540529).  Saving model ...
Epoch: 12 cost time: 1.194399356842041
Epoch: 12, Steps: 10 | Train Loss: 0.275 Vali Loss: 1.151 Vali Acc: 0.500 Test Loss: 1.151 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2949507236480713
Epoch: 13, Steps: 10 | Train Loss: 0.205 Vali Loss: 1.113 Vali Acc: 0.554 Test Loss: 1.113 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554043).  Saving model ...
Epoch: 14 cost time: 1.2128407955169678
Epoch: 14, Steps: 10 | Train Loss: 0.162 Vali Loss: 1.166 Vali Acc: 0.514 Test Loss: 1.166 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2598352432250977
Epoch: 15, Steps: 10 | Train Loss: 0.111 Vali Loss: 1.128 Vali Acc: 0.527 Test Loss: 1.128 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.6106343269348145
Epoch: 16, Steps: 10 | Train Loss: 0.080 Vali Loss: 1.200 Vali Acc: 0.473 Test Loss: 1.200 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.5059878826141357
Epoch: 17, Steps: 10 | Train Loss: 0.071 Vali Loss: 1.154 Vali Acc: 0.527 Test Loss: 1.154 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.546534776687622
Epoch: 18, Steps: 10 | Train Loss: 0.056 Vali Loss: 1.155 Vali Acc: 0.514 Test Loss: 1.155 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.5693416595458984
Epoch: 19, Steps: 10 | Train Loss: 0.045 Vali Loss: 1.200 Vali Acc: 0.473 Test Loss: 1.200 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.471200942993164
Epoch: 20, Steps: 10 | Train Loss: 0.039 Vali Loss: 1.189 Vali Acc: 0.527 Test Loss: 1.189 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.5053977966308594
Epoch: 21, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.188 Vali Acc: 0.514 Test Loss: 1.188 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.4815683364868164
Epoch: 22, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.191 Vali Acc: 0.514 Test Loss: 1.191 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.618013620376587
Epoch: 23, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.205 Vali Acc: 0.514 Test Loss: 1.205 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm16_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 543236
model size : 2.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm16_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.410123586654663
Epoch: 1, Steps: 10 | Train Loss: 1.494 Vali Loss: 1.495 Vali Acc: 0.149 Test Loss: 1.495 Test Acc: 0.149
Validation loss decreased (inf --> -0.148634).  Saving model ...
Epoch: 2 cost time: 3.1586596965789795
Epoch: 2, Steps: 10 | Train Loss: 1.406 Vali Loss: 1.454 Vali Acc: 0.149 Test Loss: 1.454 Test Acc: 0.149
Validation loss decreased (-0.148634 --> -0.148634).  Saving model ...
Epoch: 3 cost time: 3.1527843475341797
Epoch: 3, Steps: 10 | Train Loss: 1.287 Vali Loss: 1.408 Vali Acc: 0.216 Test Loss: 1.408 Test Acc: 0.216
Validation loss decreased (-0.148634 --> -0.216202).  Saving model ...
Epoch: 4 cost time: 2.6717159748077393
Epoch: 4, Steps: 10 | Train Loss: 1.166 Vali Loss: 1.388 Vali Acc: 0.311 Test Loss: 1.388 Test Acc: 0.311
Validation loss decreased (-0.216202 --> -0.310797).  Saving model ...
Epoch: 5 cost time: 2.789860486984253
Epoch: 5, Steps: 10 | Train Loss: 1.021 Vali Loss: 1.336 Vali Acc: 0.365 Test Loss: 1.336 Test Acc: 0.365
Validation loss decreased (-0.310797 --> -0.364852).  Saving model ...
Epoch: 6 cost time: 3.0954511165618896
Epoch: 6, Steps: 10 | Train Loss: 0.864 Vali Loss: 1.286 Vali Acc: 0.419 Test Loss: 1.286 Test Acc: 0.419
Validation loss decreased (-0.364852 --> -0.418906).  Saving model ...
Epoch: 7 cost time: 2.8367085456848145
Epoch: 7, Steps: 10 | Train Loss: 0.718 Vali Loss: 1.288 Vali Acc: 0.392 Test Loss: 1.288 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.7679831981658936
Epoch: 8, Steps: 10 | Train Loss: 0.606 Vali Loss: 1.282 Vali Acc: 0.459 Test Loss: 1.282 Test Acc: 0.459
Validation loss decreased (-0.418906 --> -0.459447).  Saving model ...
Epoch: 9 cost time: 2.7903354167938232
Epoch: 9, Steps: 10 | Train Loss: 0.499 Vali Loss: 1.232 Vali Acc: 0.473 Test Loss: 1.232 Test Acc: 0.473
Validation loss decreased (-0.459447 --> -0.472961).  Saving model ...
Epoch: 10 cost time: 2.5647149085998535
Epoch: 10, Steps: 10 | Train Loss: 0.403 Vali Loss: 1.241 Vali Acc: 0.459 Test Loss: 1.241 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.7238056659698486
Epoch: 11, Steps: 10 | Train Loss: 0.303 Vali Loss: 1.170 Vali Acc: 0.527 Test Loss: 1.170 Test Acc: 0.527
Validation loss decreased (-0.472961 --> -0.527015).  Saving model ...
Epoch: 12 cost time: 2.824857234954834
Epoch: 12, Steps: 10 | Train Loss: 0.205 Vali Loss: 1.259 Vali Acc: 0.419 Test Loss: 1.259 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.8400254249572754
Epoch: 13, Steps: 10 | Train Loss: 0.154 Vali Loss: 1.205 Vali Acc: 0.514 Test Loss: 1.205 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.805917978286743
Epoch: 14, Steps: 10 | Train Loss: 0.114 Vali Loss: 1.244 Vali Acc: 0.405 Test Loss: 1.244 Test Acc: 0.405
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.162446975708008
Epoch: 15, Steps: 10 | Train Loss: 0.082 Vali Loss: 1.183 Vali Acc: 0.486 Test Loss: 1.183 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.861497402191162
Epoch: 16, Steps: 10 | Train Loss: 0.065 Vali Loss: 1.121 Vali Acc: 0.500 Test Loss: 1.121 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.160283088684082
Epoch: 17, Steps: 10 | Train Loss: 0.049 Vali Loss: 1.162 Vali Acc: 0.473 Test Loss: 1.162 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.095607280731201
Epoch: 18, Steps: 10 | Train Loss: 0.040 Vali Loss: 1.172 Vali Acc: 0.473 Test Loss: 1.172 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.173154592514038
Epoch: 19, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.223 Vali Acc: 0.500 Test Loss: 1.223 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 3.206725835800171
Epoch: 20, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.214 Vali Acc: 0.500 Test Loss: 1.214 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 3.1691524982452393
Epoch: 21, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.205 Vali Acc: 0.473 Test Loss: 1.205 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm16_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.527027027027027
model parameter : 905636
model size : 3.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm16_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.625657796859741
Epoch: 1, Steps: 10 | Train Loss: 1.463 Vali Loss: 1.410 Vali Acc: 0.216 Test Loss: 1.410 Test Acc: 0.216
Validation loss decreased (inf --> -0.216202).  Saving model ...
Epoch: 2 cost time: 1.766852855682373
Epoch: 2, Steps: 10 | Train Loss: 1.373 Vali Loss: 1.402 Vali Acc: 0.284 Test Loss: 1.402 Test Acc: 0.284
Validation loss decreased (-0.216202 --> -0.283770).  Saving model ...
Epoch: 3 cost time: 1.6821589469909668
Epoch: 3, Steps: 10 | Train Loss: 1.291 Vali Loss: 1.342 Vali Acc: 0.405 Test Loss: 1.342 Test Acc: 0.405
Validation loss decreased (-0.283770 --> -0.405392).  Saving model ...
Epoch: 4 cost time: 1.792086124420166
Epoch: 4, Steps: 10 | Train Loss: 1.159 Vali Loss: 1.315 Vali Acc: 0.338 Test Loss: 1.315 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7889482975006104
Epoch: 5, Steps: 10 | Train Loss: 1.016 Vali Loss: 1.251 Vali Acc: 0.419 Test Loss: 1.251 Test Acc: 0.419
Validation loss decreased (-0.405392 --> -0.418906).  Saving model ...
Epoch: 6 cost time: 1.9165689945220947
Epoch: 6, Steps: 10 | Train Loss: 0.900 Vali Loss: 1.224 Vali Acc: 0.473 Test Loss: 1.224 Test Acc: 0.473
Validation loss decreased (-0.418906 --> -0.472961).  Saving model ...
Epoch: 7 cost time: 1.8337321281433105
Epoch: 7, Steps: 10 | Train Loss: 0.749 Vali Loss: 1.177 Vali Acc: 0.500 Test Loss: 1.177 Test Acc: 0.500
Validation loss decreased (-0.472961 --> -0.499988).  Saving model ...
Epoch: 8 cost time: 1.8904376029968262
Epoch: 8, Steps: 10 | Train Loss: 0.623 Vali Loss: 1.152 Vali Acc: 0.486 Test Loss: 1.152 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8207406997680664
Epoch: 9, Steps: 10 | Train Loss: 0.500 Vali Loss: 1.106 Vali Acc: 0.541 Test Loss: 1.106 Test Acc: 0.541
Validation loss decreased (-0.499988 --> -0.540529).  Saving model ...
Epoch: 10 cost time: 1.8715598583221436
Epoch: 10, Steps: 10 | Train Loss: 0.386 Vali Loss: 1.103 Vali Acc: 0.554 Test Loss: 1.103 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554043).  Saving model ...
Epoch: 11 cost time: 1.8923888206481934
Epoch: 11, Steps: 10 | Train Loss: 0.299 Vali Loss: 1.070 Vali Acc: 0.541 Test Loss: 1.070 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8987517356872559
Epoch: 12, Steps: 10 | Train Loss: 0.210 Vali Loss: 1.068 Vali Acc: 0.568 Test Loss: 1.068 Test Acc: 0.568
Validation loss decreased (-0.554043 --> -0.567557).  Saving model ...
Epoch: 13 cost time: 1.8060402870178223
Epoch: 13, Steps: 10 | Train Loss: 0.154 Vali Loss: 1.072 Vali Acc: 0.595 Test Loss: 1.072 Test Acc: 0.595
Validation loss decreased (-0.567557 --> -0.594584).  Saving model ...
Epoch: 14 cost time: 1.8517694473266602
Epoch: 14, Steps: 10 | Train Loss: 0.103 Vali Loss: 1.065 Vali Acc: 0.554 Test Loss: 1.065 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.888625144958496
Epoch: 15, Steps: 10 | Train Loss: 0.083 Vali Loss: 1.073 Vali Acc: 0.554 Test Loss: 1.073 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.4380385875701904
Epoch: 16, Steps: 10 | Train Loss: 0.060 Vali Loss: 1.094 Vali Acc: 0.595 Test Loss: 1.094 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.6721386909484863
Epoch: 17, Steps: 10 | Train Loss: 0.050 Vali Loss: 1.082 Vali Acc: 0.568 Test Loss: 1.082 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.5720055103302002
Epoch: 18, Steps: 10 | Train Loss: 0.042 Vali Loss: 1.096 Vali Acc: 0.581 Test Loss: 1.096 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.5667178630828857
Epoch: 19, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.099 Vali Acc: 0.581 Test Loss: 1.099 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.8411235809326172
Epoch: 20, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.093 Vali Acc: 0.568 Test Loss: 1.093 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.6626801490783691
Epoch: 21, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.096 Vali Acc: 0.581 Test Loss: 1.096 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.7147455215454102
Epoch: 22, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.096 Vali Acc: 0.581 Test Loss: 1.096 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.7508606910705566
Epoch: 23, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.090 Vali Acc: 0.581 Test Loss: 1.090 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm16_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 284804
model size : 1.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm16_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.698289632797241
Epoch: 1, Steps: 10 | Train Loss: 1.493 Vali Loss: 1.491 Vali Acc: 0.162 Test Loss: 1.491 Test Acc: 0.162
Validation loss decreased (inf --> -0.162147).  Saving model ...
Epoch: 2 cost time: 2.1230530738830566
Epoch: 2, Steps: 10 | Train Loss: 1.410 Vali Loss: 1.449 Vali Acc: 0.162 Test Loss: 1.449 Test Acc: 0.162
Validation loss decreased (-0.162147 --> -0.162148).  Saving model ...
Epoch: 3 cost time: 2.0713579654693604
Epoch: 3, Steps: 10 | Train Loss: 1.303 Vali Loss: 1.401 Vali Acc: 0.243 Test Loss: 1.401 Test Acc: 0.243
Validation loss decreased (-0.162148 --> -0.243229).  Saving model ...
Epoch: 4 cost time: 2.3116207122802734
Epoch: 4, Steps: 10 | Train Loss: 1.187 Vali Loss: 1.380 Vali Acc: 0.297 Test Loss: 1.380 Test Acc: 0.297
Validation loss decreased (-0.243229 --> -0.297284).  Saving model ...
Epoch: 5 cost time: 2.300662040710449
Epoch: 5, Steps: 10 | Train Loss: 1.059 Vali Loss: 1.320 Vali Acc: 0.338 Test Loss: 1.320 Test Acc: 0.338
Validation loss decreased (-0.297284 --> -0.337825).  Saving model ...
Epoch: 6 cost time: 2.3211612701416016
Epoch: 6, Steps: 10 | Train Loss: 0.898 Vali Loss: 1.267 Vali Acc: 0.432 Test Loss: 1.267 Test Acc: 0.432
Validation loss decreased (-0.337825 --> -0.432420).  Saving model ...
Epoch: 7 cost time: 2.441502571105957
Epoch: 7, Steps: 10 | Train Loss: 0.767 Vali Loss: 1.270 Vali Acc: 0.446 Test Loss: 1.270 Test Acc: 0.446
Validation loss decreased (-0.432420 --> -0.445933).  Saving model ...
Epoch: 8 cost time: 2.377427101135254
Epoch: 8, Steps: 10 | Train Loss: 0.646 Vali Loss: 1.257 Vali Acc: 0.473 Test Loss: 1.257 Test Acc: 0.473
Validation loss decreased (-0.445933 --> -0.472960).  Saving model ...
Epoch: 9 cost time: 2.3696014881134033
Epoch: 9, Steps: 10 | Train Loss: 0.555 Vali Loss: 1.206 Vali Acc: 0.459 Test Loss: 1.206 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.262653112411499
Epoch: 10, Steps: 10 | Train Loss: 0.452 Vali Loss: 1.234 Vali Acc: 0.405 Test Loss: 1.234 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.5318007469177246
Epoch: 11, Steps: 10 | Train Loss: 0.361 Vali Loss: 1.164 Vali Acc: 0.500 Test Loss: 1.164 Test Acc: 0.500
Validation loss decreased (-0.472960 --> -0.499988).  Saving model ...
Epoch: 12 cost time: 2.571228504180908
Epoch: 12, Steps: 10 | Train Loss: 0.281 Vali Loss: 1.220 Vali Acc: 0.486 Test Loss: 1.220 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.435389995574951
Epoch: 13, Steps: 10 | Train Loss: 0.202 Vali Loss: 1.149 Vali Acc: 0.514 Test Loss: 1.149 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513502).  Saving model ...
Epoch: 14 cost time: 2.4609994888305664
Epoch: 14, Steps: 10 | Train Loss: 0.145 Vali Loss: 1.183 Vali Acc: 0.514 Test Loss: 1.183 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.467874050140381
Epoch: 15, Steps: 10 | Train Loss: 0.111 Vali Loss: 1.177 Vali Acc: 0.473 Test Loss: 1.177 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.480104923248291
Epoch: 16, Steps: 10 | Train Loss: 0.081 Vali Loss: 1.181 Vali Acc: 0.473 Test Loss: 1.181 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.8038489818573
Epoch: 17, Steps: 10 | Train Loss: 0.056 Vali Loss: 1.160 Vali Acc: 0.459 Test Loss: 1.160 Test Acc: 0.459
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.569993495941162
Epoch: 18, Steps: 10 | Train Loss: 0.054 Vali Loss: 1.174 Vali Acc: 0.541 Test Loss: 1.174 Test Acc: 0.541
Validation loss decreased (-0.513502 --> -0.540529).  Saving model ...
Epoch: 19 cost time: 2.4911210536956787
Epoch: 19, Steps: 10 | Train Loss: 0.046 Vali Loss: 1.206 Vali Acc: 0.541 Test Loss: 1.206 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.321127414703369
Epoch: 20, Steps: 10 | Train Loss: 0.039 Vali Loss: 1.208 Vali Acc: 0.527 Test Loss: 1.208 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.450002431869507
Epoch: 21, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.178 Vali Acc: 0.514 Test Loss: 1.178 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.3231019973754883
Epoch: 22, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.159 Vali Acc: 0.554 Test Loss: 1.159 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554042).  Saving model ...
Epoch: 23 cost time: 2.411679267883301
Epoch: 23, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.184 Vali Acc: 0.554 Test Loss: 1.184 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.549511432647705
Epoch: 24, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.218 Vali Acc: 0.500 Test Loss: 1.218 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.425109624862671
Epoch: 25, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.224 Vali Acc: 0.527 Test Loss: 1.224 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.339132070541382
Epoch: 26, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.234 Vali Acc: 0.527 Test Loss: 1.234 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.432302951812744
Epoch: 27, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.221 Vali Acc: 0.514 Test Loss: 1.221 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.2851064205169678
Epoch: 28, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.262 Vali Acc: 0.554 Test Loss: 1.262 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 2.1607229709625244
Epoch: 29, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.273 Vali Acc: 0.541 Test Loss: 1.273 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.9459254741668701
Epoch: 30, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.272 Vali Acc: 0.541 Test Loss: 1.272 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm16_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 905636
model size : 3.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm16_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.9318151473999023
Epoch: 1, Steps: 10 | Train Loss: 1.471 Vali Loss: 1.404 Vali Acc: 0.176 Test Loss: 1.404 Test Acc: 0.176
Validation loss decreased (inf --> -0.175662).  Saving model ...
Epoch: 2 cost time: 1.2710847854614258
Epoch: 2, Steps: 10 | Train Loss: 1.376 Vali Loss: 1.397 Vali Acc: 0.270 Test Loss: 1.397 Test Acc: 0.270
Validation loss decreased (-0.175662 --> -0.270256).  Saving model ...
Epoch: 3 cost time: 1.4493277072906494
Epoch: 3, Steps: 10 | Train Loss: 1.300 Vali Loss: 1.340 Vali Acc: 0.378 Test Loss: 1.340 Test Acc: 0.378
Validation loss decreased (-0.270256 --> -0.378365).  Saving model ...
Epoch: 4 cost time: 1.3183646202087402
Epoch: 4, Steps: 10 | Train Loss: 1.167 Vali Loss: 1.316 Vali Acc: 0.284 Test Loss: 1.316 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2933800220489502
Epoch: 5, Steps: 10 | Train Loss: 1.030 Vali Loss: 1.254 Vali Acc: 0.405 Test Loss: 1.254 Test Acc: 0.405
Validation loss decreased (-0.378365 --> -0.405393).  Saving model ...
Epoch: 6 cost time: 1.2536859512329102
Epoch: 6, Steps: 10 | Train Loss: 0.918 Vali Loss: 1.226 Vali Acc: 0.432 Test Loss: 1.226 Test Acc: 0.432
Validation loss decreased (-0.405393 --> -0.432420).  Saving model ...
Epoch: 7 cost time: 1.2699406147003174
Epoch: 7, Steps: 10 | Train Loss: 0.768 Vali Loss: 1.183 Vali Acc: 0.486 Test Loss: 1.183 Test Acc: 0.486
Validation loss decreased (-0.432420 --> -0.486475).  Saving model ...
Epoch: 8 cost time: 1.1498486995697021
Epoch: 8, Steps: 10 | Train Loss: 0.652 Vali Loss: 1.162 Vali Acc: 0.486 Test Loss: 1.162 Test Acc: 0.486
Validation loss decreased (-0.486475 --> -0.486475).  Saving model ...
Epoch: 9 cost time: 1.386120319366455
Epoch: 9, Steps: 10 | Train Loss: 0.516 Vali Loss: 1.113 Vali Acc: 0.500 Test Loss: 1.113 Test Acc: 0.500
Validation loss decreased (-0.486475 --> -0.499989).  Saving model ...
Epoch: 10 cost time: 1.5658986568450928
Epoch: 10, Steps: 10 | Train Loss: 0.409 Vali Loss: 1.113 Vali Acc: 0.514 Test Loss: 1.113 Test Acc: 0.514
Validation loss decreased (-0.499989 --> -0.513502).  Saving model ...
Epoch: 11 cost time: 1.466782569885254
Epoch: 11, Steps: 10 | Train Loss: 0.333 Vali Loss: 1.076 Vali Acc: 0.527 Test Loss: 1.076 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527016).  Saving model ...
Epoch: 12 cost time: 1.3911495208740234
Epoch: 12, Steps: 10 | Train Loss: 0.236 Vali Loss: 1.091 Vali Acc: 0.568 Test Loss: 1.091 Test Acc: 0.568
Validation loss decreased (-0.527016 --> -0.567557).  Saving model ...
Epoch: 13 cost time: 1.4106576442718506
Epoch: 13, Steps: 10 | Train Loss: 0.184 Vali Loss: 1.067 Vali Acc: 0.568 Test Loss: 1.067 Test Acc: 0.568
Validation loss decreased (-0.567557 --> -0.567557).  Saving model ...
Epoch: 14 cost time: 1.54970121383667
Epoch: 14, Steps: 10 | Train Loss: 0.124 Vali Loss: 1.058 Vali Acc: 0.581 Test Loss: 1.058 Test Acc: 0.581
Validation loss decreased (-0.567557 --> -0.581071).  Saving model ...
Epoch: 15 cost time: 1.460005760192871
Epoch: 15, Steps: 10 | Train Loss: 0.106 Vali Loss: 1.061 Vali Acc: 0.568 Test Loss: 1.061 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.528163194656372
Epoch: 16, Steps: 10 | Train Loss: 0.073 Vali Loss: 1.085 Vali Acc: 0.581 Test Loss: 1.085 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.6045567989349365
Epoch: 17, Steps: 10 | Train Loss: 0.057 Vali Loss: 1.070 Vali Acc: 0.581 Test Loss: 1.070 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.5319185256958008
Epoch: 18, Steps: 10 | Train Loss: 0.049 Vali Loss: 1.092 Vali Acc: 0.595 Test Loss: 1.092 Test Acc: 0.595
Validation loss decreased (-0.581071 --> -0.594584).  Saving model ...
Epoch: 19 cost time: 1.4774658679962158
Epoch: 19, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.108 Vali Acc: 0.608 Test Loss: 1.108 Test Acc: 0.608
Validation loss decreased (-0.594584 --> -0.608097).  Saving model ...
Epoch: 20 cost time: 1.3792822360992432
Epoch: 20, Steps: 10 | Train Loss: 0.045 Vali Loss: 1.096 Vali Acc: 0.581 Test Loss: 1.096 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.5355122089385986
Epoch: 21, Steps: 10 | Train Loss: 0.037 Vali Loss: 1.120 Vali Acc: 0.581 Test Loss: 1.120 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.4778540134429932
Epoch: 22, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.102 Vali Acc: 0.595 Test Loss: 1.102 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.4674639701843262
Epoch: 23, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.087 Vali Acc: 0.595 Test Loss: 1.087 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.4305481910705566
Epoch: 24, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.106 Vali Acc: 0.622 Test Loss: 1.106 Test Acc: 0.622
Validation loss decreased (-0.608097 --> -0.621611).  Saving model ...
Epoch: 25 cost time: 1.4852185249328613
Epoch: 25, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.121 Vali Acc: 0.608 Test Loss: 1.121 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.5259747505187988
Epoch: 26, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.112 Vali Acc: 0.608 Test Loss: 1.112 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.3403160572052002
Epoch: 27, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.139 Vali Acc: 0.622 Test Loss: 1.139 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.4926187992095947
Epoch: 28, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.136 Vali Acc: 0.622 Test Loss: 1.136 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.5221614837646484
Epoch: 29, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.141 Vali Acc: 0.608 Test Loss: 1.141 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.6457297801971436
Epoch: 30, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.136 Vali Acc: 0.608 Test Loss: 1.136 Test Acc: 0.608
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm16_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 284804
model size : 1.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm16_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.236685276031494
Epoch: 1, Steps: 10 | Train Loss: 1.497 Vali Loss: 1.484 Vali Acc: 0.149 Test Loss: 1.484 Test Acc: 0.149
Validation loss decreased (inf --> -0.148634).  Saving model ...
Epoch: 2 cost time: 1.9364700317382812
Epoch: 2, Steps: 10 | Train Loss: 1.421 Vali Loss: 1.444 Vali Acc: 0.149 Test Loss: 1.444 Test Acc: 0.149
Validation loss decreased (-0.148634 --> -0.148634).  Saving model ...
Epoch: 3 cost time: 1.7392451763153076
Epoch: 3, Steps: 10 | Train Loss: 1.315 Vali Loss: 1.403 Vali Acc: 0.189 Test Loss: 1.403 Test Acc: 0.189
Validation loss decreased (-0.148634 --> -0.189175).  Saving model ...
Epoch: 4 cost time: 1.3229632377624512
Epoch: 4, Steps: 10 | Train Loss: 1.214 Vali Loss: 1.385 Vali Acc: 0.297 Test Loss: 1.385 Test Acc: 0.297
Validation loss decreased (-0.189175 --> -0.297283).  Saving model ...
Epoch: 5 cost time: 1.4560461044311523
Epoch: 5, Steps: 10 | Train Loss: 1.082 Vali Loss: 1.328 Vali Acc: 0.378 Test Loss: 1.328 Test Acc: 0.378
Validation loss decreased (-0.297283 --> -0.378365).  Saving model ...
Epoch: 6 cost time: 1.503957986831665
Epoch: 6, Steps: 10 | Train Loss: 0.939 Vali Loss: 1.272 Vali Acc: 0.432 Test Loss: 1.272 Test Acc: 0.432
Validation loss decreased (-0.378365 --> -0.432420).  Saving model ...
Epoch: 7 cost time: 1.4639461040496826
Epoch: 7, Steps: 10 | Train Loss: 0.822 Vali Loss: 1.273 Vali Acc: 0.392 Test Loss: 1.273 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.51072096824646
Epoch: 8, Steps: 10 | Train Loss: 0.725 Vali Loss: 1.261 Vali Acc: 0.446 Test Loss: 1.261 Test Acc: 0.446
Validation loss decreased (-0.432420 --> -0.445933).  Saving model ...
Epoch: 9 cost time: 1.5317869186401367
Epoch: 9, Steps: 10 | Train Loss: 0.618 Vali Loss: 1.184 Vali Acc: 0.514 Test Loss: 1.184 Test Acc: 0.514
Validation loss decreased (-0.445933 --> -0.513502).  Saving model ...
Epoch: 10 cost time: 1.5396003723144531
Epoch: 10, Steps: 10 | Train Loss: 0.513 Vali Loss: 1.222 Vali Acc: 0.486 Test Loss: 1.222 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5735244750976562
Epoch: 11, Steps: 10 | Train Loss: 0.442 Vali Loss: 1.164 Vali Acc: 0.514 Test Loss: 1.164 Test Acc: 0.514
Validation loss decreased (-0.513502 --> -0.513502).  Saving model ...
Epoch: 12 cost time: 1.4773986339569092
Epoch: 12, Steps: 10 | Train Loss: 0.322 Vali Loss: 1.193 Vali Acc: 0.500 Test Loss: 1.193 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.836684226989746
Epoch: 13, Steps: 10 | Train Loss: 0.268 Vali Loss: 1.120 Vali Acc: 0.514 Test Loss: 1.120 Test Acc: 0.514
Validation loss decreased (-0.513502 --> -0.513502).  Saving model ...
Epoch: 14 cost time: 1.6465914249420166
Epoch: 14, Steps: 10 | Train Loss: 0.201 Vali Loss: 1.130 Vali Acc: 0.554 Test Loss: 1.130 Test Acc: 0.554
Validation loss decreased (-0.513502 --> -0.554043).  Saving model ...
Epoch: 15 cost time: 1.613696575164795
Epoch: 15, Steps: 10 | Train Loss: 0.146 Vali Loss: 1.095 Vali Acc: 0.527 Test Loss: 1.095 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.397986888885498
Epoch: 16, Steps: 10 | Train Loss: 0.109 Vali Loss: 1.095 Vali Acc: 0.514 Test Loss: 1.095 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.752434253692627
Epoch: 17, Steps: 10 | Train Loss: 0.091 Vali Loss: 1.086 Vali Acc: 0.527 Test Loss: 1.086 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.6756348609924316
Epoch: 18, Steps: 10 | Train Loss: 0.072 Vali Loss: 1.091 Vali Acc: 0.541 Test Loss: 1.091 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.7156903743743896
Epoch: 19, Steps: 10 | Train Loss: 0.061 Vali Loss: 1.132 Vali Acc: 0.541 Test Loss: 1.132 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.8444709777832031
Epoch: 20, Steps: 10 | Train Loss: 0.043 Vali Loss: 1.108 Vali Acc: 0.568 Test Loss: 1.108 Test Acc: 0.568
Validation loss decreased (-0.554043 --> -0.567556).  Saving model ...
Epoch: 21 cost time: 1.8375732898712158
Epoch: 21, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.141 Vali Acc: 0.568 Test Loss: 1.141 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.6338698863983154
Epoch: 22, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.100 Vali Acc: 0.554 Test Loss: 1.100 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.7674579620361328
Epoch: 23, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.129 Vali Acc: 0.554 Test Loss: 1.129 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.6547267436981201
Epoch: 24, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.154 Vali Acc: 0.541 Test Loss: 1.154 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.8911540508270264
Epoch: 25, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.145 Vali Acc: 0.541 Test Loss: 1.145 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.7695856094360352
Epoch: 26, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.149 Vali Acc: 0.554 Test Loss: 1.149 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.8433940410614014
Epoch: 27, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.219 Vali Acc: 0.554 Test Loss: 1.219 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.8778266906738281
Epoch: 28, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.171 Vali Acc: 0.541 Test Loss: 1.171 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.8399333953857422
Epoch: 29, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.176 Vali Acc: 0.527 Test Loss: 1.176 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.816009283065796
Epoch: 30, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.194 Vali Acc: 0.541 Test Loss: 1.194 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm16_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 905636
model size : 3.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm16_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.728174924850464
Epoch: 1, Steps: 10 | Train Loss: 1.458 Vali Loss: 1.405 Vali Acc: 0.203 Test Loss: 1.405 Test Acc: 0.203
Validation loss decreased (inf --> -0.202689).  Saving model ...
Epoch: 2 cost time: 1.1029446125030518
Epoch: 2, Steps: 10 | Train Loss: 1.371 Vali Loss: 1.399 Vali Acc: 0.257 Test Loss: 1.399 Test Acc: 0.257
Validation loss decreased (-0.202689 --> -0.256743).  Saving model ...
Epoch: 3 cost time: 1.2299127578735352
Epoch: 3, Steps: 10 | Train Loss: 1.304 Vali Loss: 1.339 Vali Acc: 0.365 Test Loss: 1.339 Test Acc: 0.365
Validation loss decreased (-0.256743 --> -0.364851).  Saving model ...
Epoch: 4 cost time: 1.2105801105499268
Epoch: 4, Steps: 10 | Train Loss: 1.193 Vali Loss: 1.308 Vali Acc: 0.378 Test Loss: 1.308 Test Acc: 0.378
Validation loss decreased (-0.364851 --> -0.378365).  Saving model ...
Epoch: 5 cost time: 1.2175488471984863
Epoch: 5, Steps: 10 | Train Loss: 1.061 Vali Loss: 1.245 Vali Acc: 0.419 Test Loss: 1.245 Test Acc: 0.419
Validation loss decreased (-0.378365 --> -0.418906).  Saving model ...
Epoch: 6 cost time: 0.9187109470367432
Epoch: 6, Steps: 10 | Train Loss: 0.952 Vali Loss: 1.224 Vali Acc: 0.473 Test Loss: 1.224 Test Acc: 0.473
Validation loss decreased (-0.418906 --> -0.472961).  Saving model ...
Epoch: 7 cost time: 1.0676941871643066
Epoch: 7, Steps: 10 | Train Loss: 0.829 Vali Loss: 1.165 Vali Acc: 0.500 Test Loss: 1.165 Test Acc: 0.500
Validation loss decreased (-0.472961 --> -0.499988).  Saving model ...
Epoch: 8 cost time: 1.000321388244629
Epoch: 8, Steps: 10 | Train Loss: 0.712 Vali Loss: 1.136 Vali Acc: 0.459 Test Loss: 1.136 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9709529876708984
Epoch: 9, Steps: 10 | Train Loss: 0.589 Vali Loss: 1.089 Vali Acc: 0.541 Test Loss: 1.089 Test Acc: 0.541
Validation loss decreased (-0.499988 --> -0.540530).  Saving model ...
Epoch: 10 cost time: 0.9466719627380371
Epoch: 10, Steps: 10 | Train Loss: 0.478 Vali Loss: 1.086 Vali Acc: 0.554 Test Loss: 1.086 Test Acc: 0.554
Validation loss decreased (-0.540530 --> -0.554043).  Saving model ...
Epoch: 11 cost time: 1.2181222438812256
Epoch: 11, Steps: 10 | Train Loss: 0.401 Vali Loss: 1.041 Vali Acc: 0.486 Test Loss: 1.041 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.075345516204834
Epoch: 12, Steps: 10 | Train Loss: 0.307 Vali Loss: 1.046 Vali Acc: 0.554 Test Loss: 1.046 Test Acc: 0.554
Validation loss decreased (-0.554043 --> -0.554044).  Saving model ...
Epoch: 13 cost time: 1.1761350631713867
Epoch: 13, Steps: 10 | Train Loss: 0.247 Vali Loss: 1.042 Vali Acc: 0.554 Test Loss: 1.042 Test Acc: 0.554
Validation loss decreased (-0.554044 --> -0.554044).  Saving model ...
Epoch: 14 cost time: 0.770301103591919
Epoch: 14, Steps: 10 | Train Loss: 0.172 Vali Loss: 1.000 Vali Acc: 0.541 Test Loss: 1.000 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1031310558319092
Epoch: 15, Steps: 10 | Train Loss: 0.146 Vali Loss: 1.037 Vali Acc: 0.568 Test Loss: 1.037 Test Acc: 0.568
Validation loss decreased (-0.554044 --> -0.567557).  Saving model ...
Epoch: 16 cost time: 1.1053872108459473
Epoch: 16, Steps: 10 | Train Loss: 0.106 Vali Loss: 1.028 Vali Acc: 0.595 Test Loss: 1.028 Test Acc: 0.595
Validation loss decreased (-0.567557 --> -0.594584).  Saving model ...
Epoch: 17 cost time: 1.0019493103027344
Epoch: 17, Steps: 10 | Train Loss: 0.084 Vali Loss: 1.001 Vali Acc: 0.568 Test Loss: 1.001 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9092459678649902
Epoch: 18, Steps: 10 | Train Loss: 0.074 Vali Loss: 1.012 Vali Acc: 0.568 Test Loss: 1.012 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.9833354949951172
Epoch: 19, Steps: 10 | Train Loss: 0.055 Vali Loss: 1.043 Vali Acc: 0.595 Test Loss: 1.043 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.0790276527404785
Epoch: 20, Steps: 10 | Train Loss: 0.050 Vali Loss: 1.019 Vali Acc: 0.568 Test Loss: 1.019 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.0661675930023193
Epoch: 21, Steps: 10 | Train Loss: 0.042 Vali Loss: 1.027 Vali Acc: 0.581 Test Loss: 1.027 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.9472591876983643
Epoch: 22, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.033 Vali Acc: 0.595 Test Loss: 1.033 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.1003496646881104
Epoch: 23, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.016 Vali Acc: 0.581 Test Loss: 1.016 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.0230190753936768
Epoch: 24, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.030 Vali Acc: 0.595 Test Loss: 1.030 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.0197441577911377
Epoch: 25, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.051 Vali Acc: 0.595 Test Loss: 1.051 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.0411739349365234
Epoch: 26, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.044 Vali Acc: 0.595 Test Loss: 1.044 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm16_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 284804
model size : 1.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm16_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.8463454246520996
Epoch: 1, Steps: 10 | Train Loss: 1.473 Vali Loss: 1.421 Vali Acc: 0.284 Test Loss: 1.421 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 2.464472770690918
Epoch: 2, Steps: 10 | Train Loss: 1.367 Vali Loss: 1.363 Vali Acc: 0.270 Test Loss: 1.363 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.3273799419403076
Epoch: 3, Steps: 10 | Train Loss: 1.285 Vali Loss: 1.308 Vali Acc: 0.378 Test Loss: 1.308 Test Acc: 0.378
Validation loss decreased (-0.283770 --> -0.378365).  Saving model ...
Epoch: 4 cost time: 2.4342498779296875
Epoch: 4, Steps: 10 | Train Loss: 1.171 Vali Loss: 1.279 Vali Acc: 0.392 Test Loss: 1.279 Test Acc: 0.392
Validation loss decreased (-0.378365 --> -0.391879).  Saving model ...
Epoch: 5 cost time: 2.480644941329956
Epoch: 5, Steps: 10 | Train Loss: 1.024 Vali Loss: 1.238 Vali Acc: 0.527 Test Loss: 1.238 Test Acc: 0.527
Validation loss decreased (-0.391879 --> -0.527015).  Saving model ...
Epoch: 6 cost time: 2.4460673332214355
Epoch: 6, Steps: 10 | Train Loss: 0.915 Vali Loss: 1.169 Vali Acc: 0.541 Test Loss: 1.169 Test Acc: 0.541
Validation loss decreased (-0.527015 --> -0.540529).  Saving model ...
Epoch: 7 cost time: 2.4501137733459473
Epoch: 7, Steps: 10 | Train Loss: 0.765 Vali Loss: 1.152 Vali Acc: 0.541 Test Loss: 1.152 Test Acc: 0.541
Validation loss decreased (-0.540529 --> -0.540529).  Saving model ...
Epoch: 8 cost time: 2.518740653991699
Epoch: 8, Steps: 10 | Train Loss: 0.625 Vali Loss: 1.087 Vali Acc: 0.554 Test Loss: 1.087 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554043).  Saving model ...
Epoch: 9 cost time: 2.5196352005004883
Epoch: 9, Steps: 10 | Train Loss: 0.516 Vali Loss: 1.079 Vali Acc: 0.608 Test Loss: 1.079 Test Acc: 0.608
Validation loss decreased (-0.554043 --> -0.608097).  Saving model ...
Epoch: 10 cost time: 2.5243778228759766
Epoch: 10, Steps: 10 | Train Loss: 0.395 Vali Loss: 1.008 Vali Acc: 0.568 Test Loss: 1.008 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.538925886154175
Epoch: 11, Steps: 10 | Train Loss: 0.296 Vali Loss: 0.974 Vali Acc: 0.622 Test Loss: 0.974 Test Acc: 0.622
Validation loss decreased (-0.608097 --> -0.621612).  Saving model ...
Epoch: 12 cost time: 2.480855703353882
Epoch: 12, Steps: 10 | Train Loss: 0.228 Vali Loss: 0.971 Vali Acc: 0.649 Test Loss: 0.971 Test Acc: 0.649
Validation loss decreased (-0.621612 --> -0.648639).  Saving model ...
Epoch: 13 cost time: 2.467531442642212
Epoch: 13, Steps: 10 | Train Loss: 0.150 Vali Loss: 0.932 Vali Acc: 0.676 Test Loss: 0.932 Test Acc: 0.676
Validation loss decreased (-0.648639 --> -0.675666).  Saving model ...
Epoch: 14 cost time: 2.4536361694335938
Epoch: 14, Steps: 10 | Train Loss: 0.109 Vali Loss: 0.931 Vali Acc: 0.676 Test Loss: 0.931 Test Acc: 0.676
Validation loss decreased (-0.675666 --> -0.675666).  Saving model ...
Epoch: 15 cost time: 2.500922918319702
Epoch: 15, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.924 Vali Acc: 0.635 Test Loss: 0.924 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.537379026412964
Epoch: 16, Steps: 10 | Train Loss: 0.064 Vali Loss: 0.960 Vali Acc: 0.622 Test Loss: 0.960 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.4728012084960938
Epoch: 17, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.941 Vali Acc: 0.595 Test Loss: 0.941 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.5098891258239746
Epoch: 18, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.997 Vali Acc: 0.608 Test Loss: 0.997 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.458466053009033
Epoch: 19, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.971 Vali Acc: 0.635 Test Loss: 0.971 Test Acc: 0.635
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.4768900871276855
Epoch: 20, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.995 Vali Acc: 0.595 Test Loss: 0.995 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.1919283866882324
Epoch: 21, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.007 Vali Acc: 0.568 Test Loss: 1.007 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.1405715942382812
Epoch: 22, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.995 Vali Acc: 0.581 Test Loss: 0.995 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.126539707183838
Epoch: 23, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.992 Vali Acc: 0.554 Test Loss: 0.992 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.195441961288452
Epoch: 24, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.953 Vali Acc: 0.595 Test Loss: 0.953 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm16_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6756756756756757
model parameter : 466052
model size : 2.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm16_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.7491161823272705
Epoch: 1, Steps: 10 | Train Loss: 1.466 Vali Loss: 1.506 Vali Acc: 0.149 Test Loss: 1.506 Test Acc: 0.149
Validation loss decreased (inf --> -0.148634).  Saving model ...
Epoch: 2 cost time: 1.4139924049377441
Epoch: 2, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.436 Vali Acc: 0.176 Test Loss: 1.436 Test Acc: 0.176
Validation loss decreased (-0.148634 --> -0.175661).  Saving model ...
Epoch: 3 cost time: 1.3088548183441162
Epoch: 3, Steps: 10 | Train Loss: 1.299 Vali Loss: 1.398 Vali Acc: 0.203 Test Loss: 1.398 Test Acc: 0.203
Validation loss decreased (-0.175661 --> -0.202689).  Saving model ...
Epoch: 4 cost time: 1.2804524898529053
Epoch: 4, Steps: 10 | Train Loss: 1.192 Vali Loss: 1.388 Vali Acc: 0.284 Test Loss: 1.388 Test Acc: 0.284
Validation loss decreased (-0.202689 --> -0.283770).  Saving model ...
Epoch: 5 cost time: 1.3260929584503174
Epoch: 5, Steps: 10 | Train Loss: 1.045 Vali Loss: 1.332 Vali Acc: 0.351 Test Loss: 1.332 Test Acc: 0.351
Validation loss decreased (-0.283770 --> -0.351338).  Saving model ...
Epoch: 6 cost time: 1.5459375381469727
Epoch: 6, Steps: 10 | Train Loss: 0.942 Vali Loss: 1.282 Vali Acc: 0.432 Test Loss: 1.282 Test Acc: 0.432
Validation loss decreased (-0.351338 --> -0.432420).  Saving model ...
Epoch: 7 cost time: 1.50526762008667
Epoch: 7, Steps: 10 | Train Loss: 0.809 Vali Loss: 1.267 Vali Acc: 0.486 Test Loss: 1.267 Test Acc: 0.486
Validation loss decreased (-0.432420 --> -0.486474).  Saving model ...
Epoch: 8 cost time: 1.5860042572021484
Epoch: 8, Steps: 10 | Train Loss: 0.683 Vali Loss: 1.231 Vali Acc: 0.500 Test Loss: 1.231 Test Acc: 0.500
Validation loss decreased (-0.486474 --> -0.499988).  Saving model ...
Epoch: 9 cost time: 1.4633533954620361
Epoch: 9, Steps: 10 | Train Loss: 0.591 Vali Loss: 1.214 Vali Acc: 0.473 Test Loss: 1.214 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.457559585571289
Epoch: 10, Steps: 10 | Train Loss: 0.466 Vali Loss: 1.194 Vali Acc: 0.514 Test Loss: 1.194 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513502).  Saving model ...
Epoch: 11 cost time: 1.4690542221069336
Epoch: 11, Steps: 10 | Train Loss: 0.377 Vali Loss: 1.183 Vali Acc: 0.500 Test Loss: 1.183 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4611032009124756
Epoch: 12, Steps: 10 | Train Loss: 0.295 Vali Loss: 1.152 Vali Acc: 0.541 Test Loss: 1.152 Test Acc: 0.541
Validation loss decreased (-0.513502 --> -0.540529).  Saving model ...
Epoch: 13 cost time: 1.6390588283538818
Epoch: 13, Steps: 10 | Train Loss: 0.222 Vali Loss: 1.156 Vali Acc: 0.514 Test Loss: 1.156 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.496178388595581
Epoch: 14, Steps: 10 | Train Loss: 0.158 Vali Loss: 1.145 Vali Acc: 0.500 Test Loss: 1.145 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.5777320861816406
Epoch: 15, Steps: 10 | Train Loss: 0.123 Vali Loss: 1.119 Vali Acc: 0.541 Test Loss: 1.119 Test Acc: 0.541
Validation loss decreased (-0.540529 --> -0.540529).  Saving model ...
Epoch: 16 cost time: 1.5155184268951416
Epoch: 16, Steps: 10 | Train Loss: 0.093 Vali Loss: 1.129 Vali Acc: 0.581 Test Loss: 1.129 Test Acc: 0.581
Validation loss decreased (-0.540529 --> -0.581070).  Saving model ...
Epoch: 17 cost time: 1.4762825965881348
Epoch: 17, Steps: 10 | Train Loss: 0.071 Vali Loss: 1.112 Vali Acc: 0.568 Test Loss: 1.112 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.5557022094726562
Epoch: 18, Steps: 10 | Train Loss: 0.056 Vali Loss: 1.108 Vali Acc: 0.554 Test Loss: 1.108 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.597024917602539
Epoch: 19, Steps: 10 | Train Loss: 0.048 Vali Loss: 1.125 Vali Acc: 0.554 Test Loss: 1.125 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.5476818084716797
Epoch: 20, Steps: 10 | Train Loss: 0.040 Vali Loss: 1.101 Vali Acc: 0.554 Test Loss: 1.101 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.474576473236084
Epoch: 21, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.104 Vali Acc: 0.568 Test Loss: 1.104 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.5554847717285156
Epoch: 22, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.129 Vali Acc: 0.568 Test Loss: 1.129 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.573136806488037
Epoch: 23, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.121 Vali Acc: 0.581 Test Loss: 1.121 Test Acc: 0.581
Validation loss decreased (-0.581070 --> -0.581070).  Saving model ...
Epoch: 24 cost time: 1.40134596824646
Epoch: 24, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.121 Vali Acc: 0.581 Test Loss: 1.121 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.6132471561431885
Epoch: 25, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.118 Vali Acc: 0.581 Test Loss: 1.118 Test Acc: 0.581
Validation loss decreased (-0.581070 --> -0.581070).  Saving model ...
Epoch: 26 cost time: 1.5199971199035645
Epoch: 26, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.121 Vali Acc: 0.581 Test Loss: 1.121 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.5156662464141846
Epoch: 27, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.129 Vali Acc: 0.581 Test Loss: 1.129 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.680013656616211
Epoch: 28, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.129 Vali Acc: 0.581 Test Loss: 1.129 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.5351133346557617
Epoch: 29, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.126 Vali Acc: 0.568 Test Loss: 1.126 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.5320866107940674
Epoch: 30, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.130 Vali Acc: 0.568 Test Loss: 1.130 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm16_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 155588
model size : 0.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm16_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.1183698177337646
Epoch: 1, Steps: 10 | Train Loss: 1.473 Vali Loss: 1.422 Vali Acc: 0.284 Test Loss: 1.422 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 1.731618881225586
Epoch: 2, Steps: 10 | Train Loss: 1.365 Vali Loss: 1.363 Vali Acc: 0.284 Test Loss: 1.363 Test Acc: 0.284
Validation loss decreased (-0.283770 --> -0.283770).  Saving model ...
Epoch: 3 cost time: 1.5670454502105713
Epoch: 3, Steps: 10 | Train Loss: 1.283 Vali Loss: 1.307 Vali Acc: 0.365 Test Loss: 1.307 Test Acc: 0.365
Validation loss decreased (-0.283770 --> -0.364852).  Saving model ...
Epoch: 4 cost time: 1.7695889472961426
Epoch: 4, Steps: 10 | Train Loss: 1.168 Vali Loss: 1.277 Vali Acc: 0.378 Test Loss: 1.277 Test Acc: 0.378
Validation loss decreased (-0.364852 --> -0.378366).  Saving model ...
Epoch: 5 cost time: 1.677427053451538
Epoch: 5, Steps: 10 | Train Loss: 1.019 Vali Loss: 1.237 Vali Acc: 0.514 Test Loss: 1.237 Test Acc: 0.514
Validation loss decreased (-0.378366 --> -0.513501).  Saving model ...
Epoch: 6 cost time: 1.4926824569702148
Epoch: 6, Steps: 10 | Train Loss: 0.911 Vali Loss: 1.167 Vali Acc: 0.541 Test Loss: 1.167 Test Acc: 0.541
Validation loss decreased (-0.513501 --> -0.540529).  Saving model ...
Epoch: 7 cost time: 1.7344505786895752
Epoch: 7, Steps: 10 | Train Loss: 0.762 Vali Loss: 1.150 Vali Acc: 0.527 Test Loss: 1.150 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7047545909881592
Epoch: 8, Steps: 10 | Train Loss: 0.618 Vali Loss: 1.083 Vali Acc: 0.595 Test Loss: 1.083 Test Acc: 0.595
Validation loss decreased (-0.540529 --> -0.594584).  Saving model ...
Epoch: 9 cost time: 1.7055418491363525
Epoch: 9, Steps: 10 | Train Loss: 0.507 Vali Loss: 1.070 Vali Acc: 0.595 Test Loss: 1.070 Test Acc: 0.595
Validation loss decreased (-0.594584 --> -0.594584).  Saving model ...
Epoch: 10 cost time: 1.6327519416809082
Epoch: 10, Steps: 10 | Train Loss: 0.398 Vali Loss: 0.993 Vali Acc: 0.622 Test Loss: 0.993 Test Acc: 0.622
Validation loss decreased (-0.594584 --> -0.621612).  Saving model ...
Epoch: 11 cost time: 1.7348527908325195
Epoch: 11, Steps: 10 | Train Loss: 0.284 Vali Loss: 0.967 Vali Acc: 0.649 Test Loss: 0.967 Test Acc: 0.649
Validation loss decreased (-0.621612 --> -0.648639).  Saving model ...
Epoch: 12 cost time: 1.6310629844665527
Epoch: 12, Steps: 10 | Train Loss: 0.216 Vali Loss: 0.954 Vali Acc: 0.662 Test Loss: 0.954 Test Acc: 0.662
Validation loss decreased (-0.648639 --> -0.662153).  Saving model ...
Epoch: 13 cost time: 1.3598520755767822
Epoch: 13, Steps: 10 | Train Loss: 0.143 Vali Loss: 0.933 Vali Acc: 0.635 Test Loss: 0.933 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.925187110900879
Epoch: 14, Steps: 10 | Train Loss: 0.110 Vali Loss: 0.922 Vali Acc: 0.676 Test Loss: 0.922 Test Acc: 0.676
Validation loss decreased (-0.662153 --> -0.675666).  Saving model ...
Epoch: 15 cost time: 1.9327142238616943
Epoch: 15, Steps: 10 | Train Loss: 0.074 Vali Loss: 0.903 Vali Acc: 0.676 Test Loss: 0.903 Test Acc: 0.676
Validation loss decreased (-0.675666 --> -0.675667).  Saving model ...
Epoch: 16 cost time: 1.9094939231872559
Epoch: 16, Steps: 10 | Train Loss: 0.065 Vali Loss: 0.969 Vali Acc: 0.581 Test Loss: 0.969 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.8823051452636719
Epoch: 17, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.931 Vali Acc: 0.595 Test Loss: 0.931 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.9514245986938477
Epoch: 18, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.980 Vali Acc: 0.595 Test Loss: 0.980 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.070129156112671
Epoch: 19, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.975 Vali Acc: 0.595 Test Loss: 0.975 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.9676918983459473
Epoch: 20, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.999 Vali Acc: 0.595 Test Loss: 0.999 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.9411261081695557
Epoch: 21, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.010 Vali Acc: 0.595 Test Loss: 1.010 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.0486257076263428
Epoch: 22, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.012 Vali Acc: 0.595 Test Loss: 1.012 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.916487455368042
Epoch: 23, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.992 Vali Acc: 0.595 Test Loss: 0.992 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.0148372650146484
Epoch: 24, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.951 Vali Acc: 0.635 Test Loss: 0.951 Test Acc: 0.635
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.015697479248047
Epoch: 25, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.984 Vali Acc: 0.595 Test Loss: 0.984 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm16_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6756756756756757
model parameter : 466052
model size : 2.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm16_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.597484827041626
Epoch: 1, Steps: 10 | Train Loss: 1.461 Vali Loss: 1.506 Vali Acc: 0.149 Test Loss: 1.506 Test Acc: 0.149
Validation loss decreased (inf --> -0.148634).  Saving model ...
Epoch: 2 cost time: 1.3276758193969727
Epoch: 2, Steps: 10 | Train Loss: 1.382 Vali Loss: 1.436 Vali Acc: 0.176 Test Loss: 1.436 Test Acc: 0.176
Validation loss decreased (-0.148634 --> -0.175661).  Saving model ...
Epoch: 3 cost time: 1.0948951244354248
Epoch: 3, Steps: 10 | Train Loss: 1.296 Vali Loss: 1.398 Vali Acc: 0.203 Test Loss: 1.398 Test Acc: 0.203
Validation loss decreased (-0.175661 --> -0.202689).  Saving model ...
Epoch: 4 cost time: 1.164243221282959
Epoch: 4, Steps: 10 | Train Loss: 1.187 Vali Loss: 1.390 Vali Acc: 0.284 Test Loss: 1.390 Test Acc: 0.284
Validation loss decreased (-0.202689 --> -0.283770).  Saving model ...
Epoch: 5 cost time: 1.1832404136657715
Epoch: 5, Steps: 10 | Train Loss: 1.044 Vali Loss: 1.333 Vali Acc: 0.365 Test Loss: 1.333 Test Acc: 0.365
Validation loss decreased (-0.283770 --> -0.364852).  Saving model ...
Epoch: 6 cost time: 1.1362183094024658
Epoch: 6, Steps: 10 | Train Loss: 0.942 Vali Loss: 1.283 Vali Acc: 0.419 Test Loss: 1.283 Test Acc: 0.419
Validation loss decreased (-0.364852 --> -0.418906).  Saving model ...
Epoch: 7 cost time: 1.1291062831878662
Epoch: 7, Steps: 10 | Train Loss: 0.808 Vali Loss: 1.271 Vali Acc: 0.473 Test Loss: 1.271 Test Acc: 0.473
Validation loss decreased (-0.418906 --> -0.472960).  Saving model ...
Epoch: 8 cost time: 1.5719561576843262
Epoch: 8, Steps: 10 | Train Loss: 0.682 Vali Loss: 1.235 Vali Acc: 0.473 Test Loss: 1.235 Test Acc: 0.473
Validation loss decreased (-0.472960 --> -0.472961).  Saving model ...
Epoch: 9 cost time: 1.1849474906921387
Epoch: 9, Steps: 10 | Train Loss: 0.593 Vali Loss: 1.221 Vali Acc: 0.459 Test Loss: 1.221 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2407994270324707
Epoch: 10, Steps: 10 | Train Loss: 0.469 Vali Loss: 1.197 Vali Acc: 0.514 Test Loss: 1.197 Test Acc: 0.514
Validation loss decreased (-0.472961 --> -0.513502).  Saving model ...
Epoch: 11 cost time: 1.2435963153839111
Epoch: 11, Steps: 10 | Train Loss: 0.382 Vali Loss: 1.187 Vali Acc: 0.500 Test Loss: 1.187 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2646420001983643
Epoch: 12, Steps: 10 | Train Loss: 0.296 Vali Loss: 1.160 Vali Acc: 0.541 Test Loss: 1.160 Test Acc: 0.541
Validation loss decreased (-0.513502 --> -0.540529).  Saving model ...
Epoch: 13 cost time: 1.2846052646636963
Epoch: 13, Steps: 10 | Train Loss: 0.224 Vali Loss: 1.165 Vali Acc: 0.473 Test Loss: 1.165 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2424750328063965
Epoch: 14, Steps: 10 | Train Loss: 0.159 Vali Loss: 1.161 Vali Acc: 0.486 Test Loss: 1.161 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.2282891273498535
Epoch: 15, Steps: 10 | Train Loss: 0.126 Vali Loss: 1.140 Vali Acc: 0.486 Test Loss: 1.140 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.1775760650634766
Epoch: 16, Steps: 10 | Train Loss: 0.096 Vali Loss: 1.148 Vali Acc: 0.500 Test Loss: 1.148 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.2921741008758545
Epoch: 17, Steps: 10 | Train Loss: 0.072 Vali Loss: 1.134 Vali Acc: 0.514 Test Loss: 1.134 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.2577683925628662
Epoch: 18, Steps: 10 | Train Loss: 0.062 Vali Loss: 1.129 Vali Acc: 0.500 Test Loss: 1.129 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.2597386837005615
Epoch: 19, Steps: 10 | Train Loss: 0.048 Vali Loss: 1.150 Vali Acc: 0.514 Test Loss: 1.150 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.3162171840667725
Epoch: 20, Steps: 10 | Train Loss: 0.040 Vali Loss: 1.124 Vali Acc: 0.541 Test Loss: 1.124 Test Acc: 0.541
Validation loss decreased (-0.540529 --> -0.540529).  Saving model ...
Epoch: 21 cost time: 1.243607759475708
Epoch: 21, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.118 Vali Acc: 0.554 Test Loss: 1.118 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554043).  Saving model ...
Epoch: 22 cost time: 1.2861804962158203
Epoch: 22, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.143 Vali Acc: 0.527 Test Loss: 1.143 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.126783847808838
Epoch: 23, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.139 Vali Acc: 0.541 Test Loss: 1.139 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.1661674976348877
Epoch: 24, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.139 Vali Acc: 0.541 Test Loss: 1.139 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.2695388793945312
Epoch: 25, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.140 Vali Acc: 0.541 Test Loss: 1.140 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.8302891254425049
Epoch: 26, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.144 Vali Acc: 0.541 Test Loss: 1.144 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.3742432594299316
Epoch: 27, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.145 Vali Acc: 0.527 Test Loss: 1.145 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.463104009628296
Epoch: 28, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.149 Vali Acc: 0.527 Test Loss: 1.149 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.4098865985870361
Epoch: 29, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.159 Vali Acc: 0.541 Test Loss: 1.159 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.356635570526123
Epoch: 30, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.165 Vali Acc: 0.527 Test Loss: 1.165 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm16_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 155588
model size : 0.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm16_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.085543394088745
Epoch: 1, Steps: 10 | Train Loss: 1.469 Vali Loss: 1.429 Vali Acc: 0.284 Test Loss: 1.429 Test Acc: 0.284
Validation loss decreased (inf --> -0.283769).  Saving model ...
Epoch: 2 cost time: 1.6634113788604736
Epoch: 2, Steps: 10 | Train Loss: 1.370 Vali Loss: 1.372 Vali Acc: 0.270 Test Loss: 1.372 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5968787670135498
Epoch: 3, Steps: 10 | Train Loss: 1.301 Vali Loss: 1.316 Vali Acc: 0.365 Test Loss: 1.316 Test Acc: 0.365
Validation loss decreased (-0.283769 --> -0.364852).  Saving model ...
Epoch: 4 cost time: 1.6760673522949219
Epoch: 4, Steps: 10 | Train Loss: 1.203 Vali Loss: 1.285 Vali Acc: 0.405 Test Loss: 1.285 Test Acc: 0.405
Validation loss decreased (-0.364852 --> -0.405393).  Saving model ...
Epoch: 5 cost time: 1.807239294052124
Epoch: 5, Steps: 10 | Train Loss: 1.055 Vali Loss: 1.253 Vali Acc: 0.473 Test Loss: 1.253 Test Acc: 0.473
Validation loss decreased (-0.405393 --> -0.472960).  Saving model ...
Epoch: 6 cost time: 1.6830804347991943
Epoch: 6, Steps: 10 | Train Loss: 0.962 Vali Loss: 1.185 Vali Acc: 0.514 Test Loss: 1.185 Test Acc: 0.514
Validation loss decreased (-0.472960 --> -0.513502).  Saving model ...
Epoch: 7 cost time: 1.5908830165863037
Epoch: 7, Steps: 10 | Train Loss: 0.816 Vali Loss: 1.166 Vali Acc: 0.554 Test Loss: 1.166 Test Acc: 0.554
Validation loss decreased (-0.513502 --> -0.554042).  Saving model ...
Epoch: 8 cost time: 1.4905312061309814
Epoch: 8, Steps: 10 | Train Loss: 0.702 Vali Loss: 1.108 Vali Acc: 0.622 Test Loss: 1.108 Test Acc: 0.622
Validation loss decreased (-0.554042 --> -0.621611).  Saving model ...
Epoch: 9 cost time: 1.6011290550231934
Epoch: 9, Steps: 10 | Train Loss: 0.601 Vali Loss: 1.099 Vali Acc: 0.595 Test Loss: 1.099 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6385879516601562
Epoch: 10, Steps: 10 | Train Loss: 0.492 Vali Loss: 1.038 Vali Acc: 0.608 Test Loss: 1.038 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.7391128540039062
Epoch: 11, Steps: 10 | Train Loss: 0.386 Vali Loss: 1.011 Vali Acc: 0.622 Test Loss: 1.011 Test Acc: 0.622
Validation loss decreased (-0.621611 --> -0.621612).  Saving model ...
Epoch: 12 cost time: 1.6605560779571533
Epoch: 12, Steps: 10 | Train Loss: 0.335 Vali Loss: 1.008 Vali Acc: 0.581 Test Loss: 1.008 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6557188034057617
Epoch: 13, Steps: 10 | Train Loss: 0.243 Vali Loss: 0.969 Vali Acc: 0.595 Test Loss: 0.969 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.726151943206787
Epoch: 14, Steps: 10 | Train Loss: 0.185 Vali Loss: 0.963 Vali Acc: 0.608 Test Loss: 0.963 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.7548131942749023
Epoch: 15, Steps: 10 | Train Loss: 0.136 Vali Loss: 0.917 Vali Acc: 0.635 Test Loss: 0.917 Test Acc: 0.635
Validation loss decreased (-0.621612 --> -0.635126).  Saving model ...
Epoch: 16 cost time: 1.8154404163360596
Epoch: 16, Steps: 10 | Train Loss: 0.115 Vali Loss: 0.949 Vali Acc: 0.595 Test Loss: 0.949 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.6520423889160156
Epoch: 17, Steps: 10 | Train Loss: 0.081 Vali Loss: 0.909 Vali Acc: 0.676 Test Loss: 0.909 Test Acc: 0.676
Validation loss decreased (-0.635126 --> -0.675667).  Saving model ...
Epoch: 18 cost time: 1.6170761585235596
Epoch: 18, Steps: 10 | Train Loss: 0.068 Vali Loss: 0.951 Vali Acc: 0.608 Test Loss: 0.951 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.6687898635864258
Epoch: 19, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.942 Vali Acc: 0.622 Test Loss: 0.942 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.452615737915039
Epoch: 20, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.947 Vali Acc: 0.608 Test Loss: 0.947 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.702033519744873
Epoch: 21, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.961 Vali Acc: 0.635 Test Loss: 0.961 Test Acc: 0.635
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.4609119892120361
Epoch: 22, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.955 Vali Acc: 0.622 Test Loss: 0.955 Test Acc: 0.622
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.4249935150146484
Epoch: 23, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.959 Vali Acc: 0.635 Test Loss: 0.959 Test Acc: 0.635
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.4400432109832764
Epoch: 24, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.969 Vali Acc: 0.649 Test Loss: 0.969 Test Acc: 0.649
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.4959197044372559
Epoch: 25, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.992 Vali Acc: 0.635 Test Loss: 0.992 Test Acc: 0.635
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.5767126083374023
Epoch: 26, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.980 Vali Acc: 0.635 Test Loss: 0.980 Test Acc: 0.635
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.4012224674224854
Epoch: 27, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.006 Vali Acc: 0.622 Test Loss: 1.006 Test Acc: 0.622
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm16_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6756756756756757
model parameter : 466052
model size : 2.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm16_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.376539945602417
Epoch: 1, Steps: 10 | Train Loss: 1.451 Vali Loss: 1.512 Vali Acc: 0.135 Test Loss: 1.512 Test Acc: 0.135
Validation loss decreased (inf --> -0.135120).  Saving model ...
Epoch: 2 cost time: 0.9784088134765625
Epoch: 2, Steps: 10 | Train Loss: 1.393 Vali Loss: 1.442 Vali Acc: 0.162 Test Loss: 1.442 Test Acc: 0.162
Validation loss decreased (-0.135120 --> -0.162148).  Saving model ...
Epoch: 3 cost time: 0.8746602535247803
Epoch: 3, Steps: 10 | Train Loss: 1.307 Vali Loss: 1.401 Vali Acc: 0.230 Test Loss: 1.401 Test Acc: 0.230
Validation loss decreased (-0.162148 --> -0.229716).  Saving model ...
Epoch: 4 cost time: 0.8461596965789795
Epoch: 4, Steps: 10 | Train Loss: 1.202 Vali Loss: 1.393 Vali Acc: 0.284 Test Loss: 1.393 Test Acc: 0.284
Validation loss decreased (-0.229716 --> -0.283770).  Saving model ...
Epoch: 5 cost time: 1.0503475666046143
Epoch: 5, Steps: 10 | Train Loss: 1.064 Vali Loss: 1.337 Vali Acc: 0.351 Test Loss: 1.337 Test Acc: 0.351
Validation loss decreased (-0.283770 --> -0.351338).  Saving model ...
Epoch: 6 cost time: 1.0587191581726074
Epoch: 6, Steps: 10 | Train Loss: 0.967 Vali Loss: 1.279 Vali Acc: 0.432 Test Loss: 1.279 Test Acc: 0.432
Validation loss decreased (-0.351338 --> -0.432420).  Saving model ...
Epoch: 7 cost time: 1.0966558456420898
Epoch: 7, Steps: 10 | Train Loss: 0.856 Vali Loss: 1.262 Vali Acc: 0.486 Test Loss: 1.262 Test Acc: 0.486
Validation loss decreased (-0.432420 --> -0.486474).  Saving model ...
Epoch: 8 cost time: 1.0917658805847168
Epoch: 8, Steps: 10 | Train Loss: 0.733 Vali Loss: 1.223 Vali Acc: 0.486 Test Loss: 1.223 Test Acc: 0.486
Validation loss decreased (-0.486474 --> -0.486474).  Saving model ...
Epoch: 9 cost time: 0.9436197280883789
Epoch: 9, Steps: 10 | Train Loss: 0.651 Vali Loss: 1.211 Vali Acc: 0.486 Test Loss: 1.211 Test Acc: 0.486
Validation loss decreased (-0.486474 --> -0.486474).  Saving model ...
Epoch: 10 cost time: 1.015862226486206
Epoch: 10, Steps: 10 | Train Loss: 0.527 Vali Loss: 1.196 Vali Acc: 0.486 Test Loss: 1.196 Test Acc: 0.486
Validation loss decreased (-0.486474 --> -0.486475).  Saving model ...
Epoch: 11 cost time: 1.0479955673217773
Epoch: 11, Steps: 10 | Train Loss: 0.448 Vali Loss: 1.188 Vali Acc: 0.486 Test Loss: 1.188 Test Acc: 0.486
Validation loss decreased (-0.486475 --> -0.486475).  Saving model ...
Epoch: 12 cost time: 1.0890684127807617
Epoch: 12, Steps: 10 | Train Loss: 0.376 Vali Loss: 1.161 Vali Acc: 0.527 Test Loss: 1.161 Test Acc: 0.527
Validation loss decreased (-0.486475 --> -0.527015).  Saving model ...
Epoch: 13 cost time: 1.136366605758667
Epoch: 13, Steps: 10 | Train Loss: 0.297 Vali Loss: 1.142 Vali Acc: 0.541 Test Loss: 1.142 Test Acc: 0.541
Validation loss decreased (-0.527015 --> -0.540529).  Saving model ...
Epoch: 14 cost time: 1.119659185409546
Epoch: 14, Steps: 10 | Train Loss: 0.230 Vali Loss: 1.130 Vali Acc: 0.514 Test Loss: 1.130 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0537664890289307
Epoch: 15, Steps: 10 | Train Loss: 0.186 Vali Loss: 1.101 Vali Acc: 0.554 Test Loss: 1.101 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554043).  Saving model ...
Epoch: 16 cost time: 1.291182041168213
Epoch: 16, Steps: 10 | Train Loss: 0.143 Vali Loss: 1.114 Vali Acc: 0.514 Test Loss: 1.114 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.142176866531372
Epoch: 17, Steps: 10 | Train Loss: 0.108 Vali Loss: 1.082 Vali Acc: 0.554 Test Loss: 1.082 Test Acc: 0.554
Validation loss decreased (-0.554043 --> -0.554043).  Saving model ...
Epoch: 18 cost time: 1.2726774215698242
Epoch: 18, Steps: 10 | Train Loss: 0.084 Vali Loss: 1.095 Vali Acc: 0.541 Test Loss: 1.095 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2016794681549072
Epoch: 19, Steps: 10 | Train Loss: 0.069 Vali Loss: 1.100 Vali Acc: 0.541 Test Loss: 1.100 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.169503927230835
Epoch: 20, Steps: 10 | Train Loss: 0.060 Vali Loss: 1.073 Vali Acc: 0.554 Test Loss: 1.073 Test Acc: 0.554
Validation loss decreased (-0.554043 --> -0.554043).  Saving model ...
Epoch: 21 cost time: 1.1624016761779785
Epoch: 21, Steps: 10 | Train Loss: 0.049 Vali Loss: 1.080 Vali Acc: 0.527 Test Loss: 1.080 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.3078193664550781
Epoch: 22, Steps: 10 | Train Loss: 0.042 Vali Loss: 1.092 Vali Acc: 0.527 Test Loss: 1.092 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.159536361694336
Epoch: 23, Steps: 10 | Train Loss: 0.036 Vali Loss: 1.075 Vali Acc: 0.541 Test Loss: 1.075 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.1978645324707031
Epoch: 24, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.068 Vali Acc: 0.554 Test Loss: 1.068 Test Acc: 0.554
Validation loss decreased (-0.554043 --> -0.554043).  Saving model ...
Epoch: 25 cost time: 1.1678383350372314
Epoch: 25, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.065 Vali Acc: 0.554 Test Loss: 1.065 Test Acc: 0.554
Validation loss decreased (-0.554043 --> -0.554043).  Saving model ...
Epoch: 26 cost time: 1.1553289890289307
Epoch: 26, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.063 Vali Acc: 0.568 Test Loss: 1.063 Test Acc: 0.568
Validation loss decreased (-0.554043 --> -0.567557).  Saving model ...
Epoch: 27 cost time: 1.066518783569336
Epoch: 27, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.068 Vali Acc: 0.568 Test Loss: 1.068 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.1903138160705566
Epoch: 28, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.066 Vali Acc: 0.595 Test Loss: 1.066 Test Acc: 0.595
Validation loss decreased (-0.567557 --> -0.594584).  Saving model ...
Epoch: 29 cost time: 1.1806015968322754
Epoch: 29, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.066 Vali Acc: 0.568 Test Loss: 1.066 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.1774730682373047
Epoch: 30, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.072 Vali Acc: 0.581 Test Loss: 1.072 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm16_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 155588
model size : 0.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm8_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.916829824447632
Epoch: 1, Steps: 10 | Train Loss: 1.470 Vali Loss: 1.406 Vali Acc: 0.270 Test Loss: 1.406 Test Acc: 0.270
Validation loss decreased (inf --> -0.270256).  Saving model ...
Epoch: 2 cost time: 3.5843682289123535
Epoch: 2, Steps: 10 | Train Loss: 1.401 Vali Loss: 1.370 Vali Acc: 0.297 Test Loss: 1.370 Test Acc: 0.297
Validation loss decreased (-0.270256 --> -0.297284).  Saving model ...
Epoch: 3 cost time: 3.446610689163208
Epoch: 3, Steps: 10 | Train Loss: 1.321 Vali Loss: 1.347 Vali Acc: 0.338 Test Loss: 1.347 Test Acc: 0.338
Validation loss decreased (-0.297284 --> -0.337824).  Saving model ...
Epoch: 4 cost time: 3.3789424896240234
Epoch: 4, Steps: 10 | Train Loss: 1.261 Vali Loss: 1.326 Vali Acc: 0.378 Test Loss: 1.326 Test Acc: 0.378
Validation loss decreased (-0.337824 --> -0.378365).  Saving model ...
Epoch: 5 cost time: 3.449747085571289
Epoch: 5, Steps: 10 | Train Loss: 1.171 Vali Loss: 1.302 Vali Acc: 0.432 Test Loss: 1.302 Test Acc: 0.432
Validation loss decreased (-0.378365 --> -0.432419).  Saving model ...
Epoch: 6 cost time: 3.31425142288208
Epoch: 6, Steps: 10 | Train Loss: 1.061 Vali Loss: 1.268 Vali Acc: 0.446 Test Loss: 1.268 Test Acc: 0.446
Validation loss decreased (-0.432419 --> -0.445933).  Saving model ...
Epoch: 7 cost time: 3.316329002380371
Epoch: 7, Steps: 10 | Train Loss: 0.960 Vali Loss: 1.226 Vali Acc: 0.446 Test Loss: 1.226 Test Acc: 0.446
Validation loss decreased (-0.445933 --> -0.445934).  Saving model ...
Epoch: 8 cost time: 3.5227272510528564
Epoch: 8, Steps: 10 | Train Loss: 0.853 Vali Loss: 1.217 Vali Acc: 0.473 Test Loss: 1.217 Test Acc: 0.473
Validation loss decreased (-0.445934 --> -0.472961).  Saving model ...
Epoch: 9 cost time: 3.3786239624023438
Epoch: 9, Steps: 10 | Train Loss: 0.781 Vali Loss: 1.172 Vali Acc: 0.527 Test Loss: 1.172 Test Acc: 0.527
Validation loss decreased (-0.472961 --> -0.527015).  Saving model ...
Epoch: 10 cost time: 3.2938339710235596
Epoch: 10, Steps: 10 | Train Loss: 0.692 Vali Loss: 1.185 Vali Acc: 0.473 Test Loss: 1.185 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.926241874694824
Epoch: 11, Steps: 10 | Train Loss: 0.584 Vali Loss: 1.138 Vali Acc: 0.473 Test Loss: 1.138 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.639716148376465
Epoch: 12, Steps: 10 | Train Loss: 0.511 Vali Loss: 1.157 Vali Acc: 0.473 Test Loss: 1.157 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.630974054336548
Epoch: 13, Steps: 10 | Train Loss: 0.438 Vali Loss: 1.109 Vali Acc: 0.541 Test Loss: 1.109 Test Acc: 0.541
Validation loss decreased (-0.527015 --> -0.540529).  Saving model ...
Epoch: 14 cost time: 3.6293647289276123
Epoch: 14, Steps: 10 | Train Loss: 0.360 Vali Loss: 1.165 Vali Acc: 0.473 Test Loss: 1.165 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.584155559539795
Epoch: 15, Steps: 10 | Train Loss: 0.296 Vali Loss: 1.171 Vali Acc: 0.473 Test Loss: 1.171 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.537125587463379
Epoch: 16, Steps: 10 | Train Loss: 0.243 Vali Loss: 1.145 Vali Acc: 0.459 Test Loss: 1.145 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.6033143997192383
Epoch: 17, Steps: 10 | Train Loss: 0.201 Vali Loss: 1.192 Vali Acc: 0.432 Test Loss: 1.192 Test Acc: 0.432
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.5789854526519775
Epoch: 18, Steps: 10 | Train Loss: 0.177 Vali Loss: 1.157 Vali Acc: 0.527 Test Loss: 1.157 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.6677699089050293
Epoch: 19, Steps: 10 | Train Loss: 0.143 Vali Loss: 1.193 Vali Acc: 0.459 Test Loss: 1.193 Test Acc: 0.459
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.7281076908111572
Epoch: 20, Steps: 10 | Train Loss: 0.130 Vali Loss: 1.169 Vali Acc: 0.446 Test Loss: 1.169 Test Acc: 0.446
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.695915699005127
Epoch: 21, Steps: 10 | Train Loss: 0.136 Vali Loss: 1.174 Vali Acc: 0.473 Test Loss: 1.174 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 3.7606277465820312
Epoch: 22, Steps: 10 | Train Loss: 0.096 Vali Loss: 1.135 Vali Acc: 0.541 Test Loss: 1.135 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.693929672241211
Epoch: 23, Steps: 10 | Train Loss: 0.082 Vali Loss: 1.216 Vali Acc: 0.500 Test Loss: 1.216 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm8_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5405405405405406
model parameter : 892980
model size : 3.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm8_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.6551296710968018
Epoch: 1, Steps: 10 | Train Loss: 1.468 Vali Loss: 1.466 Vali Acc: 0.149 Test Loss: 1.466 Test Acc: 0.149
Validation loss decreased (inf --> -0.148634).  Saving model ...
Epoch: 2 cost time: 2.0967180728912354
Epoch: 2, Steps: 10 | Train Loss: 1.424 Vali Loss: 1.420 Vali Acc: 0.189 Test Loss: 1.420 Test Acc: 0.189
Validation loss decreased (-0.148634 --> -0.189175).  Saving model ...
Epoch: 3 cost time: 1.8311035633087158
Epoch: 3, Steps: 10 | Train Loss: 1.374 Vali Loss: 1.393 Vali Acc: 0.243 Test Loss: 1.393 Test Acc: 0.243
Validation loss decreased (-0.189175 --> -0.243229).  Saving model ...
Epoch: 4 cost time: 1.9125781059265137
Epoch: 4, Steps: 10 | Train Loss: 1.301 Vali Loss: 1.365 Vali Acc: 0.324 Test Loss: 1.365 Test Acc: 0.324
Validation loss decreased (-0.243229 --> -0.324311).  Saving model ...
Epoch: 5 cost time: 1.7373864650726318
Epoch: 5, Steps: 10 | Train Loss: 1.206 Vali Loss: 1.359 Vali Acc: 0.257 Test Loss: 1.359 Test Acc: 0.257
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7245991230010986
Epoch: 6, Steps: 10 | Train Loss: 1.123 Vali Loss: 1.321 Vali Acc: 0.311 Test Loss: 1.321 Test Acc: 0.311
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.8191454410552979
Epoch: 7, Steps: 10 | Train Loss: 1.060 Vali Loss: 1.329 Vali Acc: 0.311 Test Loss: 1.329 Test Acc: 0.311
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.8794643878936768
Epoch: 8, Steps: 10 | Train Loss: 0.975 Vali Loss: 1.277 Vali Acc: 0.405 Test Loss: 1.277 Test Acc: 0.405
Validation loss decreased (-0.324311 --> -0.405393).  Saving model ...
Epoch: 9 cost time: 1.8521695137023926
Epoch: 9, Steps: 10 | Train Loss: 0.875 Vali Loss: 1.285 Vali Acc: 0.351 Test Loss: 1.285 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.868692398071289
Epoch: 10, Steps: 10 | Train Loss: 0.790 Vali Loss: 1.273 Vali Acc: 0.351 Test Loss: 1.273 Test Acc: 0.351
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.8892946243286133
Epoch: 11, Steps: 10 | Train Loss: 0.707 Vali Loss: 1.237 Vali Acc: 0.459 Test Loss: 1.237 Test Acc: 0.459
Validation loss decreased (-0.405393 --> -0.459447).  Saving model ...
Epoch: 12 cost time: 1.783057689666748
Epoch: 12, Steps: 10 | Train Loss: 0.629 Vali Loss: 1.244 Vali Acc: 0.405 Test Loss: 1.244 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.815758466720581
Epoch: 13, Steps: 10 | Train Loss: 0.561 Vali Loss: 1.237 Vali Acc: 0.392 Test Loss: 1.237 Test Acc: 0.392
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.0495200157165527
Epoch: 14, Steps: 10 | Train Loss: 0.461 Vali Loss: 1.195 Vali Acc: 0.486 Test Loss: 1.195 Test Acc: 0.486
Validation loss decreased (-0.459447 --> -0.486475).  Saving model ...
Epoch: 15 cost time: 1.9162580966949463
Epoch: 15, Steps: 10 | Train Loss: 0.411 Vali Loss: 1.174 Vali Acc: 0.500 Test Loss: 1.174 Test Acc: 0.500
Validation loss decreased (-0.486475 --> -0.499988).  Saving model ...
Epoch: 16 cost time: 1.800114631652832
Epoch: 16, Steps: 10 | Train Loss: 0.344 Vali Loss: 1.200 Vali Acc: 0.446 Test Loss: 1.200 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.7895123958587646
Epoch: 17, Steps: 10 | Train Loss: 0.309 Vali Loss: 1.164 Vali Acc: 0.486 Test Loss: 1.164 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.0562222003936768
Epoch: 18, Steps: 10 | Train Loss: 0.247 Vali Loss: 1.161 Vali Acc: 0.514 Test Loss: 1.161 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513502).  Saving model ...
Epoch: 19 cost time: 2.1054093837738037
Epoch: 19, Steps: 10 | Train Loss: 0.202 Vali Loss: 1.166 Vali Acc: 0.459 Test Loss: 1.166 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.7633414268493652
Epoch: 20, Steps: 10 | Train Loss: 0.176 Vali Loss: 1.133 Vali Acc: 0.473 Test Loss: 1.133 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.7774951457977295
Epoch: 21, Steps: 10 | Train Loss: 0.150 Vali Loss: 1.150 Vali Acc: 0.459 Test Loss: 1.150 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.792917251586914
Epoch: 22, Steps: 10 | Train Loss: 0.126 Vali Loss: 1.123 Vali Acc: 0.446 Test Loss: 1.123 Test Acc: 0.446
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.032762050628662
Epoch: 23, Steps: 10 | Train Loss: 0.107 Vali Loss: 1.116 Vali Acc: 0.473 Test Loss: 1.116 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.096144199371338
Epoch: 24, Steps: 10 | Train Loss: 0.086 Vali Loss: 1.127 Vali Acc: 0.473 Test Loss: 1.127 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.104372501373291
Epoch: 25, Steps: 10 | Train Loss: 0.087 Vali Loss: 1.133 Vali Acc: 0.473 Test Loss: 1.133 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.145556688308716
Epoch: 26, Steps: 10 | Train Loss: 0.065 Vali Loss: 1.125 Vali Acc: 0.486 Test Loss: 1.125 Test Acc: 0.486
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.090193271636963
Epoch: 27, Steps: 10 | Train Loss: 0.060 Vali Loss: 1.121 Vali Acc: 0.500 Test Loss: 1.121 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.1371638774871826
Epoch: 28, Steps: 10 | Train Loss: 0.058 Vali Loss: 1.109 Vali Acc: 0.500 Test Loss: 1.109 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm8_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5135135135135135
model parameter : 272004
model size : 1.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm8_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.986530303955078
Epoch: 1, Steps: 10 | Train Loss: 1.468 Vali Loss: 1.407 Vali Acc: 0.257 Test Loss: 1.407 Test Acc: 0.257
Validation loss decreased (inf --> -0.256743).  Saving model ...
Epoch: 2 cost time: 2.5463922023773193
Epoch: 2, Steps: 10 | Train Loss: 1.398 Vali Loss: 1.368 Vali Acc: 0.311 Test Loss: 1.368 Test Acc: 0.311
Validation loss decreased (-0.256743 --> -0.310797).  Saving model ...
Epoch: 3 cost time: 2.597074031829834
Epoch: 3, Steps: 10 | Train Loss: 1.316 Vali Loss: 1.342 Vali Acc: 0.324 Test Loss: 1.342 Test Acc: 0.324
Validation loss decreased (-0.310797 --> -0.324311).  Saving model ...
Epoch: 4 cost time: 2.5412235260009766
Epoch: 4, Steps: 10 | Train Loss: 1.253 Vali Loss: 1.320 Vali Acc: 0.432 Test Loss: 1.320 Test Acc: 0.432
Validation loss decreased (-0.324311 --> -0.432419).  Saving model ...
Epoch: 5 cost time: 2.6766769886016846
Epoch: 5, Steps: 10 | Train Loss: 1.161 Vali Loss: 1.301 Vali Acc: 0.446 Test Loss: 1.301 Test Acc: 0.446
Validation loss decreased (-0.432419 --> -0.445933).  Saving model ...
Epoch: 6 cost time: 2.136169672012329
Epoch: 6, Steps: 10 | Train Loss: 1.051 Vali Loss: 1.260 Vali Acc: 0.459 Test Loss: 1.260 Test Acc: 0.459
Validation loss decreased (-0.445933 --> -0.459447).  Saving model ...
Epoch: 7 cost time: 2.357130527496338
Epoch: 7, Steps: 10 | Train Loss: 0.944 Vali Loss: 1.217 Vali Acc: 0.486 Test Loss: 1.217 Test Acc: 0.486
Validation loss decreased (-0.459447 --> -0.486474).  Saving model ...
Epoch: 8 cost time: 2.286571741104126
Epoch: 8, Steps: 10 | Train Loss: 0.842 Vali Loss: 1.207 Vali Acc: 0.486 Test Loss: 1.207 Test Acc: 0.486
Validation loss decreased (-0.486474 --> -0.486474).  Saving model ...
Epoch: 9 cost time: 2.1672492027282715
Epoch: 9, Steps: 10 | Train Loss: 0.768 Vali Loss: 1.167 Vali Acc: 0.514 Test Loss: 1.167 Test Acc: 0.514
Validation loss decreased (-0.486474 --> -0.513502).  Saving model ...
Epoch: 10 cost time: 2.2912659645080566
Epoch: 10, Steps: 10 | Train Loss: 0.673 Vali Loss: 1.175 Vali Acc: 0.473 Test Loss: 1.175 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.1603844165802
Epoch: 11, Steps: 10 | Train Loss: 0.579 Vali Loss: 1.131 Vali Acc: 0.473 Test Loss: 1.131 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.7306761741638184
Epoch: 12, Steps: 10 | Train Loss: 0.503 Vali Loss: 1.140 Vali Acc: 0.500 Test Loss: 1.140 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.2688205242156982
Epoch: 13, Steps: 10 | Train Loss: 0.414 Vali Loss: 1.087 Vali Acc: 0.500 Test Loss: 1.087 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.222590923309326
Epoch: 14, Steps: 10 | Train Loss: 0.358 Vali Loss: 1.106 Vali Acc: 0.514 Test Loss: 1.106 Test Acc: 0.514
Validation loss decreased (-0.513502 --> -0.513502).  Saving model ...
Epoch: 15 cost time: 2.3768181800842285
Epoch: 15, Steps: 10 | Train Loss: 0.280 Vali Loss: 1.111 Vali Acc: 0.459 Test Loss: 1.111 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.2877275943756104
Epoch: 16, Steps: 10 | Train Loss: 0.232 Vali Loss: 1.166 Vali Acc: 0.514 Test Loss: 1.166 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.347616195678711
Epoch: 17, Steps: 10 | Train Loss: 0.177 Vali Loss: 1.148 Vali Acc: 0.541 Test Loss: 1.148 Test Acc: 0.541
Validation loss decreased (-0.513502 --> -0.540529).  Saving model ...
Epoch: 18 cost time: 1.9634616374969482
Epoch: 18, Steps: 10 | Train Loss: 0.156 Vali Loss: 1.162 Vali Acc: 0.473 Test Loss: 1.162 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.9592561721801758
Epoch: 19, Steps: 10 | Train Loss: 0.121 Vali Loss: 1.172 Vali Acc: 0.486 Test Loss: 1.172 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.392704725265503
Epoch: 20, Steps: 10 | Train Loss: 0.109 Vali Loss: 1.227 Vali Acc: 0.514 Test Loss: 1.227 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.2762463092803955
Epoch: 21, Steps: 10 | Train Loss: 0.082 Vali Loss: 1.183 Vali Acc: 0.500 Test Loss: 1.183 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.271787166595459
Epoch: 22, Steps: 10 | Train Loss: 0.067 Vali Loss: 1.166 Vali Acc: 0.527 Test Loss: 1.166 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.235851287841797
Epoch: 23, Steps: 10 | Train Loss: 0.061 Vali Loss: 1.229 Vali Acc: 0.514 Test Loss: 1.229 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.1132092475891113
Epoch: 24, Steps: 10 | Train Loss: 0.065 Vali Loss: 1.153 Vali Acc: 0.541 Test Loss: 1.153 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.7495784759521484
Epoch: 25, Steps: 10 | Train Loss: 0.056 Vali Loss: 1.248 Vali Acc: 0.527 Test Loss: 1.248 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.6554274559020996
Epoch: 26, Steps: 10 | Train Loss: 0.046 Vali Loss: 1.232 Vali Acc: 0.473 Test Loss: 1.232 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.5815680027008057
Epoch: 27, Steps: 10 | Train Loss: 0.041 Vali Loss: 1.225 Vali Acc: 0.514 Test Loss: 1.225 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm8_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5405405405405406
model parameter : 892980
model size : 3.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm8_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.537531852722168
Epoch: 1, Steps: 10 | Train Loss: 1.469 Vali Loss: 1.465 Vali Acc: 0.176 Test Loss: 1.465 Test Acc: 0.176
Validation loss decreased (inf --> -0.175661).  Saving model ...
Epoch: 2 cost time: 1.5495116710662842
Epoch: 2, Steps: 10 | Train Loss: 1.423 Vali Loss: 1.417 Vali Acc: 0.230 Test Loss: 1.417 Test Acc: 0.230
Validation loss decreased (-0.175661 --> -0.229716).  Saving model ...
Epoch: 3 cost time: 1.5744013786315918
Epoch: 3, Steps: 10 | Train Loss: 1.378 Vali Loss: 1.388 Vali Acc: 0.284 Test Loss: 1.388 Test Acc: 0.284
Validation loss decreased (-0.229716 --> -0.283770).  Saving model ...
Epoch: 4 cost time: 1.484246015548706
Epoch: 4, Steps: 10 | Train Loss: 1.300 Vali Loss: 1.359 Vali Acc: 0.324 Test Loss: 1.359 Test Acc: 0.324
Validation loss decreased (-0.283770 --> -0.324311).  Saving model ...
Epoch: 5 cost time: 1.5854380130767822
Epoch: 5, Steps: 10 | Train Loss: 1.204 Vali Loss: 1.352 Vali Acc: 0.284 Test Loss: 1.352 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7040174007415771
Epoch: 6, Steps: 10 | Train Loss: 1.126 Vali Loss: 1.316 Vali Acc: 0.297 Test Loss: 1.316 Test Acc: 0.297
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.571258783340454
Epoch: 7, Steps: 10 | Train Loss: 1.059 Vali Loss: 1.324 Vali Acc: 0.338 Test Loss: 1.324 Test Acc: 0.338
Validation loss decreased (-0.324311 --> -0.337825).  Saving model ...
Epoch: 8 cost time: 1.5292038917541504
Epoch: 8, Steps: 10 | Train Loss: 0.971 Vali Loss: 1.267 Vali Acc: 0.405 Test Loss: 1.267 Test Acc: 0.405
Validation loss decreased (-0.337825 --> -0.405393).  Saving model ...
Epoch: 9 cost time: 1.7186365127563477
Epoch: 9, Steps: 10 | Train Loss: 0.889 Vali Loss: 1.275 Vali Acc: 0.365 Test Loss: 1.275 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.689009189605713
Epoch: 10, Steps: 10 | Train Loss: 0.785 Vali Loss: 1.261 Vali Acc: 0.392 Test Loss: 1.261 Test Acc: 0.392
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.6296045780181885
Epoch: 11, Steps: 10 | Train Loss: 0.710 Vali Loss: 1.233 Vali Acc: 0.432 Test Loss: 1.233 Test Acc: 0.432
Validation loss decreased (-0.405393 --> -0.432420).  Saving model ...
Epoch: 12 cost time: 1.5341804027557373
Epoch: 12, Steps: 10 | Train Loss: 0.611 Vali Loss: 1.246 Vali Acc: 0.419 Test Loss: 1.246 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.651475191116333
Epoch: 13, Steps: 10 | Train Loss: 0.568 Vali Loss: 1.241 Vali Acc: 0.419 Test Loss: 1.241 Test Acc: 0.419
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.606776475906372
Epoch: 14, Steps: 10 | Train Loss: 0.444 Vali Loss: 1.187 Vali Acc: 0.486 Test Loss: 1.187 Test Acc: 0.486
Validation loss decreased (-0.432420 --> -0.486475).  Saving model ...
Epoch: 15 cost time: 1.6568291187286377
Epoch: 15, Steps: 10 | Train Loss: 0.404 Vali Loss: 1.188 Vali Acc: 0.500 Test Loss: 1.188 Test Acc: 0.500
Validation loss decreased (-0.486475 --> -0.499988).  Saving model ...
Epoch: 16 cost time: 1.5830535888671875
Epoch: 16, Steps: 10 | Train Loss: 0.332 Vali Loss: 1.242 Vali Acc: 0.405 Test Loss: 1.242 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.5808601379394531
Epoch: 17, Steps: 10 | Train Loss: 0.291 Vali Loss: 1.209 Vali Acc: 0.459 Test Loss: 1.209 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.513115644454956
Epoch: 18, Steps: 10 | Train Loss: 0.222 Vali Loss: 1.195 Vali Acc: 0.514 Test Loss: 1.195 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513502).  Saving model ...
Epoch: 19 cost time: 1.576146125793457
Epoch: 19, Steps: 10 | Train Loss: 0.204 Vali Loss: 1.211 Vali Acc: 0.432 Test Loss: 1.211 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.7202577590942383
Epoch: 20, Steps: 10 | Train Loss: 0.171 Vali Loss: 1.177 Vali Acc: 0.446 Test Loss: 1.177 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.6540915966033936
Epoch: 21, Steps: 10 | Train Loss: 0.153 Vali Loss: 1.245 Vali Acc: 0.459 Test Loss: 1.245 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.5839240550994873
Epoch: 22, Steps: 10 | Train Loss: 0.136 Vali Loss: 1.236 Vali Acc: 0.446 Test Loss: 1.236 Test Acc: 0.446
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.5359416007995605
Epoch: 23, Steps: 10 | Train Loss: 0.116 Vali Loss: 1.212 Vali Acc: 0.500 Test Loss: 1.212 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.6410999298095703
Epoch: 24, Steps: 10 | Train Loss: 0.084 Vali Loss: 1.223 Vali Acc: 0.514 Test Loss: 1.223 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.648524284362793
Epoch: 25, Steps: 10 | Train Loss: 0.085 Vali Loss: 1.231 Vali Acc: 0.486 Test Loss: 1.231 Test Acc: 0.486
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.5673017501831055
Epoch: 26, Steps: 10 | Train Loss: 0.064 Vali Loss: 1.215 Vali Acc: 0.514 Test Loss: 1.215 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.5740385055541992
Epoch: 27, Steps: 10 | Train Loss: 0.058 Vali Loss: 1.210 Vali Acc: 0.500 Test Loss: 1.210 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.671677827835083
Epoch: 28, Steps: 10 | Train Loss: 0.069 Vali Loss: 1.198 Vali Acc: 0.500 Test Loss: 1.198 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm8_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5135135135135135
model parameter : 272004
model size : 1.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm8_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.58544921875
Epoch: 1, Steps: 10 | Train Loss: 1.473 Vali Loss: 1.400 Vali Acc: 0.270 Test Loss: 1.400 Test Acc: 0.270
Validation loss decreased (inf --> -0.270256).  Saving model ...
Epoch: 2 cost time: 1.7852246761322021
Epoch: 2, Steps: 10 | Train Loss: 1.408 Vali Loss: 1.366 Vali Acc: 0.284 Test Loss: 1.366 Test Acc: 0.284
Validation loss decreased (-0.270256 --> -0.283770).  Saving model ...
Epoch: 3 cost time: 1.913248062133789
Epoch: 3, Steps: 10 | Train Loss: 1.346 Vali Loss: 1.350 Vali Acc: 0.297 Test Loss: 1.350 Test Acc: 0.297
Validation loss decreased (-0.283770 --> -0.297284).  Saving model ...
Epoch: 4 cost time: 1.937253713607788
Epoch: 4, Steps: 10 | Train Loss: 1.297 Vali Loss: 1.331 Vali Acc: 0.365 Test Loss: 1.331 Test Acc: 0.365
Validation loss decreased (-0.297284 --> -0.364852).  Saving model ...
Epoch: 5 cost time: 1.9348723888397217
Epoch: 5, Steps: 10 | Train Loss: 1.234 Vali Loss: 1.308 Vali Acc: 0.392 Test Loss: 1.308 Test Acc: 0.392
Validation loss decreased (-0.364852 --> -0.391879).  Saving model ...
Epoch: 6 cost time: 1.9988033771514893
Epoch: 6, Steps: 10 | Train Loss: 1.132 Vali Loss: 1.278 Vali Acc: 0.432 Test Loss: 1.278 Test Acc: 0.432
Validation loss decreased (-0.391879 --> -0.432420).  Saving model ...
Epoch: 7 cost time: 1.986462116241455
Epoch: 7, Steps: 10 | Train Loss: 1.043 Vali Loss: 1.237 Vali Acc: 0.473 Test Loss: 1.237 Test Acc: 0.473
Validation loss decreased (-0.432420 --> -0.472961).  Saving model ...
Epoch: 8 cost time: 1.928121566772461
Epoch: 8, Steps: 10 | Train Loss: 0.961 Vali Loss: 1.224 Vali Acc: 0.486 Test Loss: 1.224 Test Acc: 0.486
Validation loss decreased (-0.472961 --> -0.486474).  Saving model ...
Epoch: 9 cost time: 2.040329694747925
Epoch: 9, Steps: 10 | Train Loss: 0.902 Vali Loss: 1.202 Vali Acc: 0.459 Test Loss: 1.202 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.8254945278167725
Epoch: 10, Steps: 10 | Train Loss: 0.800 Vali Loss: 1.211 Vali Acc: 0.473 Test Loss: 1.211 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.9656574726104736
Epoch: 11, Steps: 10 | Train Loss: 0.713 Vali Loss: 1.142 Vali Acc: 0.527 Test Loss: 1.142 Test Acc: 0.527
Validation loss decreased (-0.486474 --> -0.527016).  Saving model ...
Epoch: 12 cost time: 2.031162977218628
Epoch: 12, Steps: 10 | Train Loss: 0.637 Vali Loss: 1.157 Vali Acc: 0.500 Test Loss: 1.157 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.9907212257385254
Epoch: 13, Steps: 10 | Train Loss: 0.541 Vali Loss: 1.081 Vali Acc: 0.554 Test Loss: 1.081 Test Acc: 0.554
Validation loss decreased (-0.527016 --> -0.554043).  Saving model ...
Epoch: 14 cost time: 1.916247844696045
Epoch: 14, Steps: 10 | Train Loss: 0.457 Vali Loss: 1.099 Vali Acc: 0.514 Test Loss: 1.099 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.0462148189544678
Epoch: 15, Steps: 10 | Train Loss: 0.399 Vali Loss: 1.087 Vali Acc: 0.541 Test Loss: 1.087 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.080260992050171
Epoch: 16, Steps: 10 | Train Loss: 0.348 Vali Loss: 1.107 Vali Acc: 0.514 Test Loss: 1.107 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.8035845756530762
Epoch: 17, Steps: 10 | Train Loss: 0.289 Vali Loss: 1.081 Vali Acc: 0.554 Test Loss: 1.081 Test Acc: 0.554
Validation loss decreased (-0.554043 --> -0.554043).  Saving model ...
Epoch: 18 cost time: 1.1326985359191895
Epoch: 18, Steps: 10 | Train Loss: 0.274 Vali Loss: 1.071 Vali Acc: 0.541 Test Loss: 1.071 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.633347988128662
Epoch: 19, Steps: 10 | Train Loss: 0.242 Vali Loss: 1.241 Vali Acc: 0.500 Test Loss: 1.241 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.6345939636230469
Epoch: 20, Steps: 10 | Train Loss: 0.190 Vali Loss: 1.115 Vali Acc: 0.554 Test Loss: 1.115 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.713470220565796
Epoch: 21, Steps: 10 | Train Loss: 0.177 Vali Loss: 1.213 Vali Acc: 0.486 Test Loss: 1.213 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.8159592151641846
Epoch: 22, Steps: 10 | Train Loss: 0.141 Vali Loss: 1.212 Vali Acc: 0.514 Test Loss: 1.212 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.9273617267608643
Epoch: 23, Steps: 10 | Train Loss: 0.134 Vali Loss: 1.196 Vali Acc: 0.500 Test Loss: 1.196 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.0103423595428467
Epoch: 24, Steps: 10 | Train Loss: 0.121 Vali Loss: 1.214 Vali Acc: 0.514 Test Loss: 1.214 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.9573628902435303
Epoch: 25, Steps: 10 | Train Loss: 0.112 Vali Loss: 1.254 Vali Acc: 0.514 Test Loss: 1.254 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.007140874862671
Epoch: 26, Steps: 10 | Train Loss: 0.097 Vali Loss: 1.242 Vali Acc: 0.500 Test Loss: 1.242 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.872084379196167
Epoch: 27, Steps: 10 | Train Loss: 0.082 Vali Loss: 1.275 Vali Acc: 0.500 Test Loss: 1.275 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm8_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 892980
model size : 3.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm8_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.739629030227661
Epoch: 1, Steps: 10 | Train Loss: 1.468 Vali Loss: 1.468 Vali Acc: 0.149 Test Loss: 1.468 Test Acc: 0.149
Validation loss decreased (inf --> -0.148634).  Saving model ...
Epoch: 2 cost time: 1.30525803565979
Epoch: 2, Steps: 10 | Train Loss: 1.426 Vali Loss: 1.423 Vali Acc: 0.176 Test Loss: 1.423 Test Acc: 0.176
Validation loss decreased (-0.148634 --> -0.175661).  Saving model ...
Epoch: 3 cost time: 1.204000473022461
Epoch: 3, Steps: 10 | Train Loss: 1.382 Vali Loss: 1.395 Vali Acc: 0.230 Test Loss: 1.395 Test Acc: 0.230
Validation loss decreased (-0.175661 --> -0.229716).  Saving model ...
Epoch: 4 cost time: 1.2413876056671143
Epoch: 4, Steps: 10 | Train Loss: 1.320 Vali Loss: 1.366 Vali Acc: 0.257 Test Loss: 1.366 Test Acc: 0.257
Validation loss decreased (-0.229716 --> -0.256743).  Saving model ...
Epoch: 5 cost time: 1.3519668579101562
Epoch: 5, Steps: 10 | Train Loss: 1.232 Vali Loss: 1.357 Vali Acc: 0.243 Test Loss: 1.357 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3481063842773438
Epoch: 6, Steps: 10 | Train Loss: 1.160 Vali Loss: 1.319 Vali Acc: 0.297 Test Loss: 1.319 Test Acc: 0.297
Validation loss decreased (-0.256743 --> -0.297284).  Saving model ...
Epoch: 7 cost time: 1.3634238243103027
Epoch: 7, Steps: 10 | Train Loss: 1.101 Vali Loss: 1.325 Vali Acc: 0.338 Test Loss: 1.325 Test Acc: 0.338
Validation loss decreased (-0.297284 --> -0.337825).  Saving model ...
Epoch: 8 cost time: 1.3239936828613281
Epoch: 8, Steps: 10 | Train Loss: 1.015 Vali Loss: 1.270 Vali Acc: 0.392 Test Loss: 1.270 Test Acc: 0.392
Validation loss decreased (-0.337825 --> -0.391879).  Saving model ...
Epoch: 9 cost time: 1.3157727718353271
Epoch: 9, Steps: 10 | Train Loss: 0.941 Vali Loss: 1.276 Vali Acc: 0.392 Test Loss: 1.276 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.371204137802124
Epoch: 10, Steps: 10 | Train Loss: 0.852 Vali Loss: 1.265 Vali Acc: 0.405 Test Loss: 1.265 Test Acc: 0.405
Validation loss decreased (-0.391879 --> -0.405393).  Saving model ...
Epoch: 11 cost time: 1.3071343898773193
Epoch: 11, Steps: 10 | Train Loss: 0.780 Vali Loss: 1.233 Vali Acc: 0.432 Test Loss: 1.233 Test Acc: 0.432
Validation loss decreased (-0.405393 --> -0.432420).  Saving model ...
Epoch: 12 cost time: 1.2595360279083252
Epoch: 12, Steps: 10 | Train Loss: 0.704 Vali Loss: 1.243 Vali Acc: 0.432 Test Loss: 1.243 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.455998182296753
Epoch: 13, Steps: 10 | Train Loss: 0.642 Vali Loss: 1.250 Vali Acc: 0.432 Test Loss: 1.250 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.5628604888916016
Epoch: 14, Steps: 10 | Train Loss: 0.546 Vali Loss: 1.195 Vali Acc: 0.500 Test Loss: 1.195 Test Acc: 0.500
Validation loss decreased (-0.432420 --> -0.499988).  Saving model ...
Epoch: 15 cost time: 1.3989593982696533
Epoch: 15, Steps: 10 | Train Loss: 0.492 Vali Loss: 1.186 Vali Acc: 0.514 Test Loss: 1.186 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513502).  Saving model ...
Epoch: 16 cost time: 1.3613643646240234
Epoch: 16, Steps: 10 | Train Loss: 0.416 Vali Loss: 1.206 Vali Acc: 0.514 Test Loss: 1.206 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3539402484893799
Epoch: 17, Steps: 10 | Train Loss: 0.360 Vali Loss: 1.173 Vali Acc: 0.514 Test Loss: 1.173 Test Acc: 0.514
Validation loss decreased (-0.513502 --> -0.513502).  Saving model ...
Epoch: 18 cost time: 1.3463850021362305
Epoch: 18, Steps: 10 | Train Loss: 0.283 Vali Loss: 1.165 Vali Acc: 0.541 Test Loss: 1.165 Test Acc: 0.541
Validation loss decreased (-0.513502 --> -0.540529).  Saving model ...
Epoch: 19 cost time: 1.306792974472046
Epoch: 19, Steps: 10 | Train Loss: 0.257 Vali Loss: 1.167 Vali Acc: 0.500 Test Loss: 1.167 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.3422982692718506
Epoch: 20, Steps: 10 | Train Loss: 0.219 Vali Loss: 1.139 Vali Acc: 0.527 Test Loss: 1.139 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.3441874980926514
Epoch: 21, Steps: 10 | Train Loss: 0.182 Vali Loss: 1.164 Vali Acc: 0.554 Test Loss: 1.164 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554042).  Saving model ...
Epoch: 22 cost time: 1.3389835357666016
Epoch: 22, Steps: 10 | Train Loss: 0.155 Vali Loss: 1.129 Vali Acc: 0.554 Test Loss: 1.129 Test Acc: 0.554
Validation loss decreased (-0.554042 --> -0.554043).  Saving model ...
Epoch: 23 cost time: 1.5551960468292236
Epoch: 23, Steps: 10 | Train Loss: 0.132 Vali Loss: 1.138 Vali Acc: 0.581 Test Loss: 1.138 Test Acc: 0.581
Validation loss decreased (-0.554043 --> -0.581070).  Saving model ...
Epoch: 24 cost time: 1.3440823554992676
Epoch: 24, Steps: 10 | Train Loss: 0.105 Vali Loss: 1.162 Vali Acc: 0.595 Test Loss: 1.162 Test Acc: 0.595
Validation loss decreased (-0.581070 --> -0.594583).  Saving model ...
Epoch: 25 cost time: 1.3342781066894531
Epoch: 25, Steps: 10 | Train Loss: 0.108 Vali Loss: 1.161 Vali Acc: 0.581 Test Loss: 1.161 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.4160041809082031
Epoch: 26, Steps: 10 | Train Loss: 0.084 Vali Loss: 1.162 Vali Acc: 0.568 Test Loss: 1.162 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.3693861961364746
Epoch: 27, Steps: 10 | Train Loss: 0.076 Vali Loss: 1.169 Vali Acc: 0.581 Test Loss: 1.169 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.3040356636047363
Epoch: 28, Steps: 10 | Train Loss: 0.069 Vali Loss: 1.163 Vali Acc: 0.568 Test Loss: 1.163 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.3766391277313232
Epoch: 29, Steps: 10 | Train Loss: 0.064 Vali Loss: 1.172 Vali Acc: 0.568 Test Loss: 1.172 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.4162929058074951
Epoch: 30, Steps: 10 | Train Loss: 0.062 Vali Loss: 1.175 Vali Acc: 0.568 Test Loss: 1.175 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm8_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 272004
model size : 1.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm8_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.403899431228638
Epoch: 1, Steps: 10 | Train Loss: 1.409 Vali Loss: 1.375 Vali Acc: 0.311 Test Loss: 1.375 Test Acc: 0.311
Validation loss decreased (inf --> -0.310797).  Saving model ...
Epoch: 2 cost time: 2.743194580078125
Epoch: 2, Steps: 10 | Train Loss: 1.372 Vali Loss: 1.383 Vali Acc: 0.243 Test Loss: 1.383 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.6959400177001953
Epoch: 3, Steps: 10 | Train Loss: 1.318 Vali Loss: 1.393 Vali Acc: 0.216 Test Loss: 1.393 Test Acc: 0.216
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.8912582397460938
Epoch: 4, Steps: 10 | Train Loss: 1.242 Vali Loss: 1.377 Vali Acc: 0.257 Test Loss: 1.377 Test Acc: 0.257
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.65490460395813
Epoch: 5, Steps: 10 | Train Loss: 1.185 Vali Loss: 1.335 Vali Acc: 0.365 Test Loss: 1.335 Test Acc: 0.365
Validation loss decreased (-0.310797 --> -0.364852).  Saving model ...
Epoch: 6 cost time: 2.6467275619506836
Epoch: 6, Steps: 10 | Train Loss: 1.118 Vali Loss: 1.308 Vali Acc: 0.365 Test Loss: 1.308 Test Acc: 0.365
Validation loss decreased (-0.364852 --> -0.364852).  Saving model ...
Epoch: 7 cost time: 2.7248237133026123
Epoch: 7, Steps: 10 | Train Loss: 1.029 Vali Loss: 1.278 Vali Acc: 0.419 Test Loss: 1.278 Test Acc: 0.419
Validation loss decreased (-0.364852 --> -0.418906).  Saving model ...
Epoch: 8 cost time: 2.6470987796783447
Epoch: 8, Steps: 10 | Train Loss: 0.938 Vali Loss: 1.271 Vali Acc: 0.405 Test Loss: 1.271 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.6205878257751465
Epoch: 9, Steps: 10 | Train Loss: 0.861 Vali Loss: 1.249 Vali Acc: 0.392 Test Loss: 1.249 Test Acc: 0.392
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.5479893684387207
Epoch: 10, Steps: 10 | Train Loss: 0.777 Vali Loss: 1.233 Vali Acc: 0.419 Test Loss: 1.233 Test Acc: 0.419
Validation loss decreased (-0.418906 --> -0.418907).  Saving model ...
Epoch: 11 cost time: 2.6708927154541016
Epoch: 11, Steps: 10 | Train Loss: 0.702 Vali Loss: 1.240 Vali Acc: 0.419 Test Loss: 1.240 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.6621131896972656
Epoch: 12, Steps: 10 | Train Loss: 0.600 Vali Loss: 1.200 Vali Acc: 0.432 Test Loss: 1.200 Test Acc: 0.432
Validation loss decreased (-0.418907 --> -0.432420).  Saving model ...
Epoch: 13 cost time: 2.6874160766601562
Epoch: 13, Steps: 10 | Train Loss: 0.537 Vali Loss: 1.192 Vali Acc: 0.419 Test Loss: 1.192 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.7114768028259277
Epoch: 14, Steps: 10 | Train Loss: 0.479 Vali Loss: 1.195 Vali Acc: 0.419 Test Loss: 1.195 Test Acc: 0.419
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.741929531097412
Epoch: 15, Steps: 10 | Train Loss: 0.391 Vali Loss: 1.162 Vali Acc: 0.432 Test Loss: 1.162 Test Acc: 0.432
Validation loss decreased (-0.432420 --> -0.432421).  Saving model ...
Epoch: 16 cost time: 2.8010501861572266
Epoch: 16, Steps: 10 | Train Loss: 0.321 Vali Loss: 1.140 Vali Acc: 0.473 Test Loss: 1.140 Test Acc: 0.473
Validation loss decreased (-0.432421 --> -0.472962).  Saving model ...
Epoch: 17 cost time: 2.7881312370300293
Epoch: 17, Steps: 10 | Train Loss: 0.268 Vali Loss: 1.138 Vali Acc: 0.473 Test Loss: 1.138 Test Acc: 0.473
Validation loss decreased (-0.472962 --> -0.472962).  Saving model ...
Epoch: 18 cost time: 2.7282052040100098
Epoch: 18, Steps: 10 | Train Loss: 0.232 Vali Loss: 1.131 Vali Acc: 0.473 Test Loss: 1.131 Test Acc: 0.473
Validation loss decreased (-0.472962 --> -0.472962).  Saving model ...
Epoch: 19 cost time: 2.807947874069214
Epoch: 19, Steps: 10 | Train Loss: 0.200 Vali Loss: 1.140 Vali Acc: 0.500 Test Loss: 1.140 Test Acc: 0.500
Validation loss decreased (-0.472962 --> -0.499989).  Saving model ...
Epoch: 20 cost time: 2.7357728481292725
Epoch: 20, Steps: 10 | Train Loss: 0.177 Vali Loss: 1.142 Vali Acc: 0.486 Test Loss: 1.142 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.8177783489227295
Epoch: 21, Steps: 10 | Train Loss: 0.141 Vali Loss: 1.109 Vali Acc: 0.486 Test Loss: 1.109 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.5843467712402344
Epoch: 22, Steps: 10 | Train Loss: 0.121 Vali Loss: 1.117 Vali Acc: 0.473 Test Loss: 1.117 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.5352232456207275
Epoch: 23, Steps: 10 | Train Loss: 0.103 Vali Loss: 1.123 Vali Acc: 0.514 Test Loss: 1.123 Test Acc: 0.514
Validation loss decreased (-0.499989 --> -0.513502).  Saving model ...
Epoch: 24 cost time: 2.487393617630005
Epoch: 24, Steps: 10 | Train Loss: 0.097 Vali Loss: 1.117 Vali Acc: 0.459 Test Loss: 1.117 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.3747386932373047
Epoch: 25, Steps: 10 | Train Loss: 0.078 Vali Loss: 1.110 Vali Acc: 0.486 Test Loss: 1.110 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.498614549636841
Epoch: 26, Steps: 10 | Train Loss: 0.070 Vali Loss: 1.114 Vali Acc: 0.514 Test Loss: 1.114 Test Acc: 0.514
Validation loss decreased (-0.513502 --> -0.513502).  Saving model ...
Epoch: 27 cost time: 2.478281259536743
Epoch: 27, Steps: 10 | Train Loss: 0.061 Vali Loss: 1.126 Vali Acc: 0.486 Test Loss: 1.126 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.549567699432373
Epoch: 28, Steps: 10 | Train Loss: 0.052 Vali Loss: 1.108 Vali Acc: 0.473 Test Loss: 1.108 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.5525333881378174
Epoch: 29, Steps: 10 | Train Loss: 0.058 Vali Loss: 1.168 Vali Acc: 0.486 Test Loss: 1.168 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.589522361755371
Epoch: 30, Steps: 10 | Train Loss: 0.046 Vali Loss: 1.100 Vali Acc: 0.514 Test Loss: 1.100 Test Acc: 0.514
Validation loss decreased (-0.513502 --> -0.513503).  Saving model ...
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm8_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5135135135135135
model parameter : 453108
model size : 1.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm8_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.9402496814727783
Epoch: 1, Steps: 10 | Train Loss: 1.401 Vali Loss: 1.375 Vali Acc: 0.324 Test Loss: 1.375 Test Acc: 0.324
Validation loss decreased (inf --> -0.324311).  Saving model ...
Epoch: 2 cost time: 1.538048267364502
Epoch: 2, Steps: 10 | Train Loss: 1.347 Vali Loss: 1.348 Vali Acc: 0.365 Test Loss: 1.348 Test Acc: 0.365
Validation loss decreased (-0.324311 --> -0.364851).  Saving model ...
Epoch: 3 cost time: 1.5142507553100586
Epoch: 3, Steps: 10 | Train Loss: 1.299 Vali Loss: 1.333 Vali Acc: 0.392 Test Loss: 1.333 Test Acc: 0.392
Validation loss decreased (-0.364851 --> -0.391879).  Saving model ...
Epoch: 4 cost time: 1.5461876392364502
Epoch: 4, Steps: 10 | Train Loss: 1.256 Vali Loss: 1.304 Vali Acc: 0.405 Test Loss: 1.304 Test Acc: 0.405
Validation loss decreased (-0.391879 --> -0.405392).  Saving model ...
Epoch: 5 cost time: 1.4042329788208008
Epoch: 5, Steps: 10 | Train Loss: 1.184 Vali Loss: 1.289 Vali Acc: 0.432 Test Loss: 1.289 Test Acc: 0.432
Validation loss decreased (-0.405392 --> -0.432420).  Saving model ...
Epoch: 6 cost time: 1.5589756965637207
Epoch: 6, Steps: 10 | Train Loss: 1.107 Vali Loss: 1.276 Vali Acc: 0.459 Test Loss: 1.276 Test Acc: 0.459
Validation loss decreased (-0.432420 --> -0.459447).  Saving model ...
Epoch: 7 cost time: 1.702268123626709
Epoch: 7, Steps: 10 | Train Loss: 1.031 Vali Loss: 1.247 Vali Acc: 0.459 Test Loss: 1.247 Test Acc: 0.459
Validation loss decreased (-0.459447 --> -0.459447).  Saving model ...
Epoch: 8 cost time: 1.1002469062805176
Epoch: 8, Steps: 10 | Train Loss: 0.927 Vali Loss: 1.218 Vali Acc: 0.486 Test Loss: 1.218 Test Acc: 0.486
Validation loss decreased (-0.459447 --> -0.486474).  Saving model ...
Epoch: 9 cost time: 1.658252477645874
Epoch: 9, Steps: 10 | Train Loss: 0.870 Vali Loss: 1.227 Vali Acc: 0.486 Test Loss: 1.227 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6919701099395752
Epoch: 10, Steps: 10 | Train Loss: 0.761 Vali Loss: 1.200 Vali Acc: 0.500 Test Loss: 1.200 Test Acc: 0.500
Validation loss decreased (-0.486474 --> -0.499988).  Saving model ...
Epoch: 11 cost time: 1.6770293712615967
Epoch: 11, Steps: 10 | Train Loss: 0.695 Vali Loss: 1.194 Vali Acc: 0.486 Test Loss: 1.194 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8166313171386719
Epoch: 12, Steps: 10 | Train Loss: 0.600 Vali Loss: 1.179 Vali Acc: 0.500 Test Loss: 1.179 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 13 cost time: 1.7810947895050049
Epoch: 13, Steps: 10 | Train Loss: 0.547 Vali Loss: 1.174 Vali Acc: 0.514 Test Loss: 1.174 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513502).  Saving model ...
Epoch: 14 cost time: 1.7506108283996582
Epoch: 14, Steps: 10 | Train Loss: 0.452 Vali Loss: 1.164 Vali Acc: 0.500 Test Loss: 1.164 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.7525346279144287
Epoch: 15, Steps: 10 | Train Loss: 0.402 Vali Loss: 1.160 Vali Acc: 0.500 Test Loss: 1.160 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.663550615310669
Epoch: 16, Steps: 10 | Train Loss: 0.346 Vali Loss: 1.175 Vali Acc: 0.514 Test Loss: 1.175 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.7552893161773682
Epoch: 17, Steps: 10 | Train Loss: 0.301 Vali Loss: 1.169 Vali Acc: 0.514 Test Loss: 1.169 Test Acc: 0.514
Validation loss decreased (-0.513502 --> -0.513502).  Saving model ...
Epoch: 18 cost time: 1.7561988830566406
Epoch: 18, Steps: 10 | Train Loss: 0.236 Vali Loss: 1.152 Vali Acc: 0.486 Test Loss: 1.152 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.7602262496948242
Epoch: 19, Steps: 10 | Train Loss: 0.204 Vali Loss: 1.172 Vali Acc: 0.486 Test Loss: 1.172 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.807767391204834
Epoch: 20, Steps: 10 | Train Loss: 0.167 Vali Loss: 1.164 Vali Acc: 0.500 Test Loss: 1.164 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.7384138107299805
Epoch: 21, Steps: 10 | Train Loss: 0.142 Vali Loss: 1.203 Vali Acc: 0.500 Test Loss: 1.203 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.7423508167266846
Epoch: 22, Steps: 10 | Train Loss: 0.123 Vali Loss: 1.167 Vali Acc: 0.486 Test Loss: 1.167 Test Acc: 0.486
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.7535789012908936
Epoch: 23, Steps: 10 | Train Loss: 0.108 Vali Loss: 1.165 Vali Acc: 0.514 Test Loss: 1.165 Test Acc: 0.514
Validation loss decreased (-0.513502 --> -0.513502).  Saving model ...
Epoch: 24 cost time: 1.7770054340362549
Epoch: 24, Steps: 10 | Train Loss: 0.095 Vali Loss: 1.208 Vali Acc: 0.446 Test Loss: 1.208 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.8413207530975342
Epoch: 25, Steps: 10 | Train Loss: 0.086 Vali Loss: 1.199 Vali Acc: 0.473 Test Loss: 1.199 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.739513874053955
Epoch: 26, Steps: 10 | Train Loss: 0.070 Vali Loss: 1.185 Vali Acc: 0.514 Test Loss: 1.185 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.7524003982543945
Epoch: 27, Steps: 10 | Train Loss: 0.067 Vali Loss: 1.212 Vali Acc: 0.500 Test Loss: 1.212 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.7470202445983887
Epoch: 28, Steps: 10 | Train Loss: 0.055 Vali Loss: 1.233 Vali Acc: 0.514 Test Loss: 1.233 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.758011817932129
Epoch: 29, Steps: 10 | Train Loss: 0.048 Vali Loss: 1.255 Vali Acc: 0.514 Test Loss: 1.255 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.8010039329528809
Epoch: 30, Steps: 10 | Train Loss: 0.049 Vali Loss: 1.240 Vali Acc: 0.500 Test Loss: 1.240 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm8_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5135135135135135
model parameter : 142596
model size : 0.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm8_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.25522518157959
Epoch: 1, Steps: 10 | Train Loss: 1.412 Vali Loss: 1.376 Vali Acc: 0.297 Test Loss: 1.376 Test Acc: 0.297
Validation loss decreased (inf --> -0.297284).  Saving model ...
Epoch: 2 cost time: 2.031827211380005
Epoch: 2, Steps: 10 | Train Loss: 1.375 Vali Loss: 1.385 Vali Acc: 0.243 Test Loss: 1.385 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9962718486785889
Epoch: 3, Steps: 10 | Train Loss: 1.320 Vali Loss: 1.395 Vali Acc: 0.257 Test Loss: 1.395 Test Acc: 0.257
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.030609369277954
Epoch: 4, Steps: 10 | Train Loss: 1.241 Vali Loss: 1.377 Vali Acc: 0.257 Test Loss: 1.377 Test Acc: 0.257
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.0339951515197754
Epoch: 5, Steps: 10 | Train Loss: 1.182 Vali Loss: 1.335 Vali Acc: 0.378 Test Loss: 1.335 Test Acc: 0.378
Validation loss decreased (-0.297284 --> -0.378365).  Saving model ...
Epoch: 6 cost time: 1.9852573871612549
Epoch: 6, Steps: 10 | Train Loss: 1.114 Vali Loss: 1.310 Vali Acc: 0.378 Test Loss: 1.310 Test Acc: 0.378
Validation loss decreased (-0.378365 --> -0.378365).  Saving model ...
Epoch: 7 cost time: 2.0454089641571045
Epoch: 7, Steps: 10 | Train Loss: 1.025 Vali Loss: 1.276 Vali Acc: 0.419 Test Loss: 1.276 Test Acc: 0.419
Validation loss decreased (-0.378365 --> -0.418906).  Saving model ...
Epoch: 8 cost time: 1.9993960857391357
Epoch: 8, Steps: 10 | Train Loss: 0.929 Vali Loss: 1.268 Vali Acc: 0.405 Test Loss: 1.268 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.959216594696045
Epoch: 9, Steps: 10 | Train Loss: 0.853 Vali Loss: 1.253 Vali Acc: 0.392 Test Loss: 1.253 Test Acc: 0.392
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.030825138092041
Epoch: 10, Steps: 10 | Train Loss: 0.767 Vali Loss: 1.225 Vali Acc: 0.392 Test Loss: 1.225 Test Acc: 0.392
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.106301784515381
Epoch: 11, Steps: 10 | Train Loss: 0.692 Vali Loss: 1.245 Vali Acc: 0.446 Test Loss: 1.245 Test Acc: 0.446
Validation loss decreased (-0.418906 --> -0.445934).  Saving model ...
Epoch: 12 cost time: 2.0554697513580322
Epoch: 12, Steps: 10 | Train Loss: 0.587 Vali Loss: 1.188 Vali Acc: 0.419 Test Loss: 1.188 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.0005922317504883
Epoch: 13, Steps: 10 | Train Loss: 0.538 Vali Loss: 1.190 Vali Acc: 0.432 Test Loss: 1.190 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.1100223064422607
Epoch: 14, Steps: 10 | Train Loss: 0.453 Vali Loss: 1.184 Vali Acc: 0.459 Test Loss: 1.184 Test Acc: 0.459
Validation loss decreased (-0.445934 --> -0.459448).  Saving model ...
Epoch: 15 cost time: 2.0155508518218994
Epoch: 15, Steps: 10 | Train Loss: 0.362 Vali Loss: 1.138 Vali Acc: 0.419 Test Loss: 1.138 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.18851637840271
Epoch: 16, Steps: 10 | Train Loss: 0.304 Vali Loss: 1.145 Vali Acc: 0.459 Test Loss: 1.145 Test Acc: 0.459
Validation loss decreased (-0.459448 --> -0.459448).  Saving model ...
Epoch: 17 cost time: 2.0727076530456543
Epoch: 17, Steps: 10 | Train Loss: 0.256 Vali Loss: 1.157 Vali Acc: 0.432 Test Loss: 1.157 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.107853889465332
Epoch: 18, Steps: 10 | Train Loss: 0.216 Vali Loss: 1.129 Vali Acc: 0.446 Test Loss: 1.129 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.9583077430725098
Epoch: 19, Steps: 10 | Train Loss: 0.188 Vali Loss: 1.128 Vali Acc: 0.459 Test Loss: 1.128 Test Acc: 0.459
Validation loss decreased (-0.459448 --> -0.459448).  Saving model ...
Epoch: 20 cost time: 1.9059746265411377
Epoch: 20, Steps: 10 | Train Loss: 0.153 Vali Loss: 1.162 Vali Acc: 0.473 Test Loss: 1.162 Test Acc: 0.473
Validation loss decreased (-0.459448 --> -0.472961).  Saving model ...
Epoch: 21 cost time: 1.87125825881958
Epoch: 21, Steps: 10 | Train Loss: 0.131 Vali Loss: 1.121 Vali Acc: 0.459 Test Loss: 1.121 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.824718952178955
Epoch: 22, Steps: 10 | Train Loss: 0.108 Vali Loss: 1.174 Vali Acc: 0.446 Test Loss: 1.174 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.851318597793579
Epoch: 23, Steps: 10 | Train Loss: 0.104 Vali Loss: 1.146 Vali Acc: 0.514 Test Loss: 1.146 Test Acc: 0.514
Validation loss decreased (-0.472961 --> -0.513502).  Saving model ...
Epoch: 24 cost time: 1.849877119064331
Epoch: 24, Steps: 10 | Train Loss: 0.087 Vali Loss: 1.143 Vali Acc: 0.500 Test Loss: 1.143 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.8151757717132568
Epoch: 25, Steps: 10 | Train Loss: 0.072 Vali Loss: 1.144 Vali Acc: 0.459 Test Loss: 1.144 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.8656861782073975
Epoch: 26, Steps: 10 | Train Loss: 0.062 Vali Loss: 1.141 Vali Acc: 0.527 Test Loss: 1.141 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527016).  Saving model ...
Epoch: 27 cost time: 1.8773307800292969
Epoch: 27, Steps: 10 | Train Loss: 0.057 Vali Loss: 1.144 Vali Acc: 0.500 Test Loss: 1.144 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.8340888023376465
Epoch: 28, Steps: 10 | Train Loss: 0.048 Vali Loss: 1.123 Vali Acc: 0.514 Test Loss: 1.123 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.8916659355163574
Epoch: 29, Steps: 10 | Train Loss: 0.043 Vali Loss: 1.151 Vali Acc: 0.514 Test Loss: 1.151 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.812434196472168
Epoch: 30, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.153 Vali Acc: 0.527 Test Loss: 1.153 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm8_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.527027027027027
model parameter : 453108
model size : 1.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm8_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.62674880027771
Epoch: 1, Steps: 10 | Train Loss: 1.404 Vali Loss: 1.385 Vali Acc: 0.284 Test Loss: 1.385 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 1.2251715660095215
Epoch: 2, Steps: 10 | Train Loss: 1.353 Vali Loss: 1.358 Vali Acc: 0.365 Test Loss: 1.358 Test Acc: 0.365
Validation loss decreased (-0.283770 --> -0.364851).  Saving model ...
Epoch: 3 cost time: 1.245452880859375
Epoch: 3, Steps: 10 | Train Loss: 1.300 Vali Loss: 1.344 Vali Acc: 0.378 Test Loss: 1.344 Test Acc: 0.378
Validation loss decreased (-0.364851 --> -0.378365).  Saving model ...
Epoch: 4 cost time: 1.1842873096466064
Epoch: 4, Steps: 10 | Train Loss: 1.255 Vali Loss: 1.314 Vali Acc: 0.405 Test Loss: 1.314 Test Acc: 0.405
Validation loss decreased (-0.378365 --> -0.405392).  Saving model ...
Epoch: 5 cost time: 1.2435235977172852
Epoch: 5, Steps: 10 | Train Loss: 1.189 Vali Loss: 1.300 Vali Acc: 0.446 Test Loss: 1.300 Test Acc: 0.446
Validation loss decreased (-0.405392 --> -0.445933).  Saving model ...
Epoch: 6 cost time: 1.193716287612915
Epoch: 6, Steps: 10 | Train Loss: 1.104 Vali Loss: 1.288 Vali Acc: 0.446 Test Loss: 1.288 Test Acc: 0.446
Validation loss decreased (-0.445933 --> -0.445933).  Saving model ...
Epoch: 7 cost time: 1.2679293155670166
Epoch: 7, Steps: 10 | Train Loss: 1.036 Vali Loss: 1.264 Vali Acc: 0.446 Test Loss: 1.264 Test Acc: 0.446
Validation loss decreased (-0.445933 --> -0.445933).  Saving model ...
Epoch: 8 cost time: 1.2904176712036133
Epoch: 8, Steps: 10 | Train Loss: 0.928 Vali Loss: 1.235 Vali Acc: 0.486 Test Loss: 1.235 Test Acc: 0.486
Validation loss decreased (-0.445933 --> -0.486474).  Saving model ...
Epoch: 9 cost time: 1.441863775253296
Epoch: 9, Steps: 10 | Train Loss: 0.869 Vali Loss: 1.247 Vali Acc: 0.446 Test Loss: 1.247 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3954932689666748
Epoch: 10, Steps: 10 | Train Loss: 0.761 Vali Loss: 1.222 Vali Acc: 0.405 Test Loss: 1.222 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.325702428817749
Epoch: 11, Steps: 10 | Train Loss: 0.699 Vali Loss: 1.229 Vali Acc: 0.459 Test Loss: 1.229 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.3819911479949951
Epoch: 12, Steps: 10 | Train Loss: 0.602 Vali Loss: 1.212 Vali Acc: 0.486 Test Loss: 1.212 Test Acc: 0.486
Validation loss decreased (-0.486474 --> -0.486474).  Saving model ...
Epoch: 13 cost time: 1.4727392196655273
Epoch: 13, Steps: 10 | Train Loss: 0.551 Vali Loss: 1.217 Vali Acc: 0.514 Test Loss: 1.217 Test Acc: 0.514
Validation loss decreased (-0.486474 --> -0.513501).  Saving model ...
Epoch: 14 cost time: 1.3452370166778564
Epoch: 14, Steps: 10 | Train Loss: 0.452 Vali Loss: 1.194 Vali Acc: 0.486 Test Loss: 1.194 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.384751319885254
Epoch: 15, Steps: 10 | Train Loss: 0.396 Vali Loss: 1.202 Vali Acc: 0.500 Test Loss: 1.202 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.3327476978302002
Epoch: 16, Steps: 10 | Train Loss: 0.333 Vali Loss: 1.225 Vali Acc: 0.486 Test Loss: 1.225 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.3916637897491455
Epoch: 17, Steps: 10 | Train Loss: 0.288 Vali Loss: 1.209 Vali Acc: 0.514 Test Loss: 1.209 Test Acc: 0.514
Validation loss decreased (-0.513501 --> -0.513501).  Saving model ...
Epoch: 18 cost time: 1.3133494853973389
Epoch: 18, Steps: 10 | Train Loss: 0.225 Vali Loss: 1.232 Vali Acc: 0.473 Test Loss: 1.232 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.3684239387512207
Epoch: 19, Steps: 10 | Train Loss: 0.193 Vali Loss: 1.269 Vali Acc: 0.486 Test Loss: 1.269 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.498878002166748
Epoch: 20, Steps: 10 | Train Loss: 0.159 Vali Loss: 1.234 Vali Acc: 0.514 Test Loss: 1.234 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.4561340808868408
Epoch: 21, Steps: 10 | Train Loss: 0.139 Vali Loss: 1.274 Vali Acc: 0.541 Test Loss: 1.274 Test Acc: 0.541
Validation loss decreased (-0.513501 --> -0.540528).  Saving model ...
Epoch: 22 cost time: 1.4090602397918701
Epoch: 22, Steps: 10 | Train Loss: 0.120 Vali Loss: 1.261 Vali Acc: 0.527 Test Loss: 1.261 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.380115032196045
Epoch: 23, Steps: 10 | Train Loss: 0.104 Vali Loss: 1.299 Vali Acc: 0.446 Test Loss: 1.299 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.345738410949707
Epoch: 24, Steps: 10 | Train Loss: 0.090 Vali Loss: 1.367 Vali Acc: 0.500 Test Loss: 1.367 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.3357622623443604
Epoch: 25, Steps: 10 | Train Loss: 0.081 Vali Loss: 1.366 Vali Acc: 0.486 Test Loss: 1.366 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.3727755546569824
Epoch: 26, Steps: 10 | Train Loss: 0.070 Vali Loss: 1.359 Vali Acc: 0.446 Test Loss: 1.359 Test Acc: 0.446
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.4617676734924316
Epoch: 27, Steps: 10 | Train Loss: 0.062 Vali Loss: 1.368 Vali Acc: 0.486 Test Loss: 1.368 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.436589002609253
Epoch: 28, Steps: 10 | Train Loss: 0.053 Vali Loss: 1.368 Vali Acc: 0.500 Test Loss: 1.368 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.3500010967254639
Epoch: 29, Steps: 10 | Train Loss: 0.048 Vali Loss: 1.401 Vali Acc: 0.473 Test Loss: 1.401 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.4301648139953613
Epoch: 30, Steps: 10 | Train Loss: 0.048 Vali Loss: 1.413 Vali Acc: 0.446 Test Loss: 1.413 Test Acc: 0.446
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm8_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5405405405405406
model parameter : 142596
model size : 0.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm8_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.030128002166748
Epoch: 1, Steps: 10 | Train Loss: 1.414 Vali Loss: 1.378 Vali Acc: 0.297 Test Loss: 1.378 Test Acc: 0.297
Validation loss decreased (inf --> -0.297284).  Saving model ...
Epoch: 2 cost time: 1.5998930931091309
Epoch: 2, Steps: 10 | Train Loss: 1.376 Vali Loss: 1.386 Vali Acc: 0.270 Test Loss: 1.386 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6368002891540527
Epoch: 3, Steps: 10 | Train Loss: 1.330 Vali Loss: 1.396 Vali Acc: 0.257 Test Loss: 1.396 Test Acc: 0.257
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.5163404941558838
Epoch: 4, Steps: 10 | Train Loss: 1.263 Vali Loss: 1.376 Vali Acc: 0.257 Test Loss: 1.376 Test Acc: 0.257
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.5825531482696533
Epoch: 5, Steps: 10 | Train Loss: 1.210 Vali Loss: 1.334 Vali Acc: 0.378 Test Loss: 1.334 Test Acc: 0.378
Validation loss decreased (-0.297284 --> -0.378365).  Saving model ...
Epoch: 6 cost time: 1.547666311264038
Epoch: 6, Steps: 10 | Train Loss: 1.157 Vali Loss: 1.311 Vali Acc: 0.392 Test Loss: 1.311 Test Acc: 0.392
Validation loss decreased (-0.378365 --> -0.391879).  Saving model ...
Epoch: 7 cost time: 1.6000373363494873
Epoch: 7, Steps: 10 | Train Loss: 1.077 Vali Loss: 1.277 Vali Acc: 0.419 Test Loss: 1.277 Test Acc: 0.419
Validation loss decreased (-0.391879 --> -0.418906).  Saving model ...
Epoch: 8 cost time: 1.6135673522949219
Epoch: 8, Steps: 10 | Train Loss: 1.000 Vali Loss: 1.266 Vali Acc: 0.392 Test Loss: 1.266 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6106200218200684
Epoch: 9, Steps: 10 | Train Loss: 0.939 Vali Loss: 1.247 Vali Acc: 0.405 Test Loss: 1.247 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.5408909320831299
Epoch: 10, Steps: 10 | Train Loss: 0.874 Vali Loss: 1.220 Vali Acc: 0.432 Test Loss: 1.220 Test Acc: 0.432
Validation loss decreased (-0.418906 --> -0.432420).  Saving model ...
Epoch: 11 cost time: 1.544635534286499
Epoch: 11, Steps: 10 | Train Loss: 0.813 Vali Loss: 1.230 Vali Acc: 0.446 Test Loss: 1.230 Test Acc: 0.446
Validation loss decreased (-0.432420 --> -0.445934).  Saving model ...
Epoch: 12 cost time: 1.5253198146820068
Epoch: 12, Steps: 10 | Train Loss: 0.714 Vali Loss: 1.181 Vali Acc: 0.446 Test Loss: 1.181 Test Acc: 0.446
Validation loss decreased (-0.445934 --> -0.445934).  Saving model ...
Epoch: 13 cost time: 1.5957629680633545
Epoch: 13, Steps: 10 | Train Loss: 0.658 Vali Loss: 1.163 Vali Acc: 0.459 Test Loss: 1.163 Test Acc: 0.459
Validation loss decreased (-0.445934 --> -0.459448).  Saving model ...
Epoch: 14 cost time: 1.5416979789733887
Epoch: 14, Steps: 10 | Train Loss: 0.597 Vali Loss: 1.168 Vali Acc: 0.459 Test Loss: 1.168 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.634805679321289
Epoch: 15, Steps: 10 | Train Loss: 0.510 Vali Loss: 1.141 Vali Acc: 0.446 Test Loss: 1.141 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.5819215774536133
Epoch: 16, Steps: 10 | Train Loss: 0.439 Vali Loss: 1.122 Vali Acc: 0.459 Test Loss: 1.122 Test Acc: 0.459
Validation loss decreased (-0.459448 --> -0.459448).  Saving model ...
Epoch: 17 cost time: 1.5873737335205078
Epoch: 17, Steps: 10 | Train Loss: 0.391 Vali Loss: 1.137 Vali Acc: 0.459 Test Loss: 1.137 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.5578036308288574
Epoch: 18, Steps: 10 | Train Loss: 0.346 Vali Loss: 1.098 Vali Acc: 0.486 Test Loss: 1.098 Test Acc: 0.486
Validation loss decreased (-0.459448 --> -0.486476).  Saving model ...
Epoch: 19 cost time: 1.5515062808990479
Epoch: 19, Steps: 10 | Train Loss: 0.305 Vali Loss: 1.112 Vali Acc: 0.486 Test Loss: 1.112 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.6463594436645508
Epoch: 20, Steps: 10 | Train Loss: 0.252 Vali Loss: 1.126 Vali Acc: 0.473 Test Loss: 1.126 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.6374962329864502
Epoch: 21, Steps: 10 | Train Loss: 0.225 Vali Loss: 1.064 Vali Acc: 0.500 Test Loss: 1.064 Test Acc: 0.500
Validation loss decreased (-0.486476 --> -0.499989).  Saving model ...
Epoch: 22 cost time: 0.917978048324585
Epoch: 22, Steps: 10 | Train Loss: 0.183 Vali Loss: 1.122 Vali Acc: 0.459 Test Loss: 1.122 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.4094793796539307
Epoch: 23, Steps: 10 | Train Loss: 0.164 Vali Loss: 1.092 Vali Acc: 0.527 Test Loss: 1.092 Test Acc: 0.527
Validation loss decreased (-0.499989 --> -0.527016).  Saving model ...
Epoch: 24 cost time: 1.4972081184387207
Epoch: 24, Steps: 10 | Train Loss: 0.146 Vali Loss: 1.087 Vali Acc: 0.514 Test Loss: 1.087 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.36319899559021
Epoch: 25, Steps: 10 | Train Loss: 0.133 Vali Loss: 1.084 Vali Acc: 0.527 Test Loss: 1.084 Test Acc: 0.527
Validation loss decreased (-0.527016 --> -0.527016).  Saving model ...
Epoch: 26 cost time: 1.4619004726409912
Epoch: 26, Steps: 10 | Train Loss: 0.124 Vali Loss: 1.071 Vali Acc: 0.514 Test Loss: 1.071 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.330535888671875
Epoch: 27, Steps: 10 | Train Loss: 0.102 Vali Loss: 1.111 Vali Acc: 0.527 Test Loss: 1.111 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.2913944721221924
Epoch: 28, Steps: 10 | Train Loss: 0.086 Vali Loss: 1.126 Vali Acc: 0.486 Test Loss: 1.126 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.3679983615875244
Epoch: 29, Steps: 10 | Train Loss: 0.082 Vali Loss: 1.133 Vali Acc: 0.473 Test Loss: 1.133 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.3114194869995117
Epoch: 30, Steps: 10 | Train Loss: 0.071 Vali Loss: 1.105 Vali Acc: 0.541 Test Loss: 1.105 Test Acc: 0.541
Validation loss decreased (-0.527016 --> -0.540529).  Saving model ...
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm8_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5405405405405406
model parameter : 453108
model size : 1.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm8_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.5477824211120605
Epoch: 1, Steps: 10 | Train Loss: 1.414 Vali Loss: 1.377 Vali Acc: 0.324 Test Loss: 1.377 Test Acc: 0.324
Validation loss decreased (inf --> -0.324311).  Saving model ...
Epoch: 2 cost time: 1.2694525718688965
Epoch: 2, Steps: 10 | Train Loss: 1.362 Vali Loss: 1.350 Vali Acc: 0.419 Test Loss: 1.350 Test Acc: 0.419
Validation loss decreased (-0.324311 --> -0.418905).  Saving model ...
Epoch: 3 cost time: 1.1940171718597412
Epoch: 3, Steps: 10 | Train Loss: 1.318 Vali Loss: 1.334 Vali Acc: 0.365 Test Loss: 1.334 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1652216911315918
Epoch: 4, Steps: 10 | Train Loss: 1.272 Vali Loss: 1.304 Vali Acc: 0.405 Test Loss: 1.304 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.0608174800872803
Epoch: 5, Steps: 10 | Train Loss: 1.214 Vali Loss: 1.286 Vali Acc: 0.459 Test Loss: 1.286 Test Acc: 0.459
Validation loss decreased (-0.418905 --> -0.459447).  Saving model ...
Epoch: 6 cost time: 1.177248477935791
Epoch: 6, Steps: 10 | Train Loss: 1.138 Vali Loss: 1.271 Vali Acc: 0.486 Test Loss: 1.271 Test Acc: 0.486
Validation loss decreased (-0.459447 --> -0.486474).  Saving model ...
Epoch: 7 cost time: 1.1720199584960938
Epoch: 7, Steps: 10 | Train Loss: 1.074 Vali Loss: 1.239 Vali Acc: 0.473 Test Loss: 1.239 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3138325214385986
Epoch: 8, Steps: 10 | Train Loss: 0.972 Vali Loss: 1.205 Vali Acc: 0.473 Test Loss: 1.205 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.261319875717163
Epoch: 9, Steps: 10 | Train Loss: 0.927 Vali Loss: 1.205 Vali Acc: 0.486 Test Loss: 1.205 Test Acc: 0.486
Validation loss decreased (-0.486474 --> -0.486474).  Saving model ...
Epoch: 10 cost time: 1.2270407676696777
Epoch: 10, Steps: 10 | Train Loss: 0.823 Vali Loss: 1.175 Vali Acc: 0.473 Test Loss: 1.175 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1622388362884521
Epoch: 11, Steps: 10 | Train Loss: 0.769 Vali Loss: 1.172 Vali Acc: 0.486 Test Loss: 1.172 Test Acc: 0.486
Validation loss decreased (-0.486474 --> -0.486475).  Saving model ...
Epoch: 12 cost time: 1.3041255474090576
Epoch: 12, Steps: 10 | Train Loss: 0.678 Vali Loss: 1.135 Vali Acc: 0.500 Test Loss: 1.135 Test Acc: 0.500
Validation loss decreased (-0.486475 --> -0.499989).  Saving model ...
Epoch: 13 cost time: 1.027160882949829
Epoch: 13, Steps: 10 | Train Loss: 0.630 Vali Loss: 1.128 Vali Acc: 0.500 Test Loss: 1.128 Test Acc: 0.500
Validation loss decreased (-0.499989 --> -0.499989).  Saving model ...
Epoch: 14 cost time: 1.455681324005127
Epoch: 14, Steps: 10 | Train Loss: 0.547 Vali Loss: 1.109 Vali Acc: 0.514 Test Loss: 1.109 Test Acc: 0.514
Validation loss decreased (-0.499989 --> -0.513502).  Saving model ...
Epoch: 15 cost time: 1.2907218933105469
Epoch: 15, Steps: 10 | Train Loss: 0.475 Vali Loss: 1.104 Vali Acc: 0.459 Test Loss: 1.104 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.317171573638916
Epoch: 16, Steps: 10 | Train Loss: 0.411 Vali Loss: 1.107 Vali Acc: 0.500 Test Loss: 1.107 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.1668767929077148
Epoch: 17, Steps: 10 | Train Loss: 0.373 Vali Loss: 1.081 Vali Acc: 0.554 Test Loss: 1.081 Test Acc: 0.554
Validation loss decreased (-0.513502 --> -0.554043).  Saving model ...
Epoch: 18 cost time: 1.2986009120941162
Epoch: 18, Steps: 10 | Train Loss: 0.307 Vali Loss: 1.089 Vali Acc: 0.500 Test Loss: 1.089 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.3522346019744873
Epoch: 19, Steps: 10 | Train Loss: 0.259 Vali Loss: 1.107 Vali Acc: 0.500 Test Loss: 1.107 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.3223848342895508
Epoch: 20, Steps: 10 | Train Loss: 0.220 Vali Loss: 1.080 Vali Acc: 0.514 Test Loss: 1.080 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.260500431060791
Epoch: 21, Steps: 10 | Train Loss: 0.193 Vali Loss: 1.109 Vali Acc: 0.514 Test Loss: 1.109 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.308774709701538
Epoch: 22, Steps: 10 | Train Loss: 0.166 Vali Loss: 1.086 Vali Acc: 0.514 Test Loss: 1.086 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.29422926902771
Epoch: 23, Steps: 10 | Train Loss: 0.150 Vali Loss: 1.096 Vali Acc: 0.500 Test Loss: 1.096 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.3531301021575928
Epoch: 24, Steps: 10 | Train Loss: 0.125 Vali Loss: 1.132 Vali Acc: 0.541 Test Loss: 1.132 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.3035242557525635
Epoch: 25, Steps: 10 | Train Loss: 0.116 Vali Loss: 1.104 Vali Acc: 0.541 Test Loss: 1.104 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.2007875442504883
Epoch: 26, Steps: 10 | Train Loss: 0.095 Vali Loss: 1.105 Vali Acc: 0.541 Test Loss: 1.105 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.2977850437164307
Epoch: 27, Steps: 10 | Train Loss: 0.093 Vali Loss: 1.122 Vali Acc: 0.527 Test Loss: 1.122 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm8_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 142596
model size : 0.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm8_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.8997914791107178
Epoch: 1, Steps: 10 | Train Loss: 1.460 Vali Loss: 1.596 Vali Acc: 0.135 Test Loss: 1.596 Test Acc: 0.135
Validation loss decreased (inf --> -0.135119).  Saving model ...
Epoch: 2 cost time: 2.3577070236206055
Epoch: 2, Steps: 10 | Train Loss: 1.424 Vali Loss: 1.515 Vali Acc: 0.203 Test Loss: 1.515 Test Acc: 0.203
Validation loss decreased (-0.135119 --> -0.202688).  Saving model ...
Epoch: 3 cost time: 2.227458953857422
Epoch: 3, Steps: 10 | Train Loss: 1.349 Vali Loss: 1.470 Vali Acc: 0.162 Test Loss: 1.470 Test Acc: 0.162
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.3220224380493164
Epoch: 4, Steps: 10 | Train Loss: 1.306 Vali Loss: 1.445 Vali Acc: 0.230 Test Loss: 1.445 Test Acc: 0.230
Validation loss decreased (-0.202688 --> -0.229715).  Saving model ...
Epoch: 5 cost time: 2.267190933227539
Epoch: 5, Steps: 10 | Train Loss: 1.224 Vali Loss: 1.438 Vali Acc: 0.243 Test Loss: 1.438 Test Acc: 0.243
Validation loss decreased (-0.229715 --> -0.243229).  Saving model ...
Epoch: 6 cost time: 2.2792911529541016
Epoch: 6, Steps: 10 | Train Loss: 1.154 Vali Loss: 1.416 Vali Acc: 0.284 Test Loss: 1.416 Test Acc: 0.284
Validation loss decreased (-0.243229 --> -0.283770).  Saving model ...
Epoch: 7 cost time: 2.502868413925171
Epoch: 7, Steps: 10 | Train Loss: 1.078 Vali Loss: 1.380 Vali Acc: 0.311 Test Loss: 1.380 Test Acc: 0.311
Validation loss decreased (-0.283770 --> -0.310797).  Saving model ...
Epoch: 8 cost time: 2.2131714820861816
Epoch: 8, Steps: 10 | Train Loss: 1.015 Vali Loss: 1.367 Vali Acc: 0.351 Test Loss: 1.367 Test Acc: 0.351
Validation loss decreased (-0.310797 --> -0.351338).  Saving model ...
Epoch: 9 cost time: 2.333496570587158
Epoch: 9, Steps: 10 | Train Loss: 0.919 Vali Loss: 1.334 Vali Acc: 0.432 Test Loss: 1.334 Test Acc: 0.432
Validation loss decreased (-0.351338 --> -0.432419).  Saving model ...
Epoch: 10 cost time: 2.4360551834106445
Epoch: 10, Steps: 10 | Train Loss: 0.848 Vali Loss: 1.314 Vali Acc: 0.405 Test Loss: 1.314 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.3469552993774414
Epoch: 11, Steps: 10 | Train Loss: 0.743 Vali Loss: 1.281 Vali Acc: 0.405 Test Loss: 1.281 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.311159133911133
Epoch: 12, Steps: 10 | Train Loss: 0.664 Vali Loss: 1.251 Vali Acc: 0.446 Test Loss: 1.251 Test Acc: 0.446
Validation loss decreased (-0.432419 --> -0.445933).  Saving model ...
Epoch: 13 cost time: 2.3521673679351807
Epoch: 13, Steps: 10 | Train Loss: 0.579 Vali Loss: 1.229 Vali Acc: 0.446 Test Loss: 1.229 Test Acc: 0.446
Validation loss decreased (-0.445933 --> -0.445934).  Saving model ...
Epoch: 14 cost time: 2.322856903076172
Epoch: 14, Steps: 10 | Train Loss: 0.507 Vali Loss: 1.206 Vali Acc: 0.432 Test Loss: 1.206 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.464792251586914
Epoch: 15, Steps: 10 | Train Loss: 0.432 Vali Loss: 1.175 Vali Acc: 0.473 Test Loss: 1.175 Test Acc: 0.473
Validation loss decreased (-0.445934 --> -0.472961).  Saving model ...
Epoch: 16 cost time: 2.40482759475708
Epoch: 16, Steps: 10 | Train Loss: 0.403 Vali Loss: 1.168 Vali Acc: 0.514 Test Loss: 1.168 Test Acc: 0.514
Validation loss decreased (-0.472961 --> -0.513502).  Saving model ...
Epoch: 17 cost time: 2.3904972076416016
Epoch: 17, Steps: 10 | Train Loss: 0.326 Vali Loss: 1.194 Vali Acc: 0.500 Test Loss: 1.194 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.4213016033172607
Epoch: 18, Steps: 10 | Train Loss: 0.272 Vali Loss: 1.191 Vali Acc: 0.500 Test Loss: 1.191 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.3548882007598877
Epoch: 19, Steps: 10 | Train Loss: 0.239 Vali Loss: 1.153 Vali Acc: 0.473 Test Loss: 1.153 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.3900749683380127
Epoch: 20, Steps: 10 | Train Loss: 0.214 Vali Loss: 1.162 Vali Acc: 0.486 Test Loss: 1.162 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.3833701610565186
Epoch: 21, Steps: 10 | Train Loss: 0.174 Vali Loss: 1.174 Vali Acc: 0.486 Test Loss: 1.174 Test Acc: 0.486
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.288503885269165
Epoch: 22, Steps: 10 | Train Loss: 0.150 Vali Loss: 1.157 Vali Acc: 0.486 Test Loss: 1.157 Test Acc: 0.486
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.313886880874634
Epoch: 23, Steps: 10 | Train Loss: 0.130 Vali Loss: 1.175 Vali Acc: 0.514 Test Loss: 1.175 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.3203670978546143
Epoch: 24, Steps: 10 | Train Loss: 0.114 Vali Loss: 1.184 Vali Acc: 0.500 Test Loss: 1.184 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.2447400093078613
Epoch: 25, Steps: 10 | Train Loss: 0.109 Vali Loss: 1.213 Vali Acc: 0.514 Test Loss: 1.213 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.4277687072753906
Epoch: 26, Steps: 10 | Train Loss: 0.096 Vali Loss: 1.207 Vali Acc: 0.527 Test Loss: 1.207 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527015).  Saving model ...
Epoch: 27 cost time: 2.233112096786499
Epoch: 27, Steps: 10 | Train Loss: 0.072 Vali Loss: 1.178 Vali Acc: 0.514 Test Loss: 1.178 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.3767549991607666
Epoch: 28, Steps: 10 | Train Loss: 0.062 Vali Loss: 1.135 Vali Acc: 0.541 Test Loss: 1.135 Test Acc: 0.541
Validation loss decreased (-0.527015 --> -0.540529).  Saving model ...
Epoch: 29 cost time: 2.4186649322509766
Epoch: 29, Steps: 10 | Train Loss: 0.074 Vali Loss: 1.169 Vali Acc: 0.527 Test Loss: 1.169 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.394850015640259
Epoch: 30, Steps: 10 | Train Loss: 0.054 Vali Loss: 1.180 Vali Acc: 0.500 Test Loss: 1.180 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm8_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5405405405405406
model parameter : 233172
model size : 1.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm8_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.8654446601867676
Epoch: 1, Steps: 10 | Train Loss: 1.410 Vali Loss: 1.360 Vali Acc: 0.378 Test Loss: 1.360 Test Acc: 0.378
Validation loss decreased (inf --> -0.378365).  Saving model ...
Epoch: 2 cost time: 1.3334970474243164
Epoch: 2, Steps: 10 | Train Loss: 1.377 Vali Loss: 1.358 Vali Acc: 0.378 Test Loss: 1.358 Test Acc: 0.378
Validation loss decreased (-0.378365 --> -0.378365).  Saving model ...
Epoch: 3 cost time: 1.493901014328003
Epoch: 3, Steps: 10 | Train Loss: 1.311 Vali Loss: 1.349 Vali Acc: 0.378 Test Loss: 1.349 Test Acc: 0.378
Validation loss decreased (-0.378365 --> -0.378365).  Saving model ...
Epoch: 4 cost time: 1.474083423614502
Epoch: 4, Steps: 10 | Train Loss: 1.255 Vali Loss: 1.331 Vali Acc: 0.405 Test Loss: 1.331 Test Acc: 0.405
Validation loss decreased (-0.378365 --> -0.405392).  Saving model ...
Epoch: 5 cost time: 1.6213650703430176
Epoch: 5, Steps: 10 | Train Loss: 1.182 Vali Loss: 1.303 Vali Acc: 0.432 Test Loss: 1.303 Test Acc: 0.432
Validation loss decreased (-0.405392 --> -0.432419).  Saving model ...
Epoch: 6 cost time: 1.4938080310821533
Epoch: 6, Steps: 10 | Train Loss: 1.158 Vali Loss: 1.288 Vali Acc: 0.446 Test Loss: 1.288 Test Acc: 0.446
Validation loss decreased (-0.432419 --> -0.445933).  Saving model ...
Epoch: 7 cost time: 1.4287278652191162
Epoch: 7, Steps: 10 | Train Loss: 1.037 Vali Loss: 1.247 Vali Acc: 0.446 Test Loss: 1.247 Test Acc: 0.446
Validation loss decreased (-0.445933 --> -0.445933).  Saving model ...
Epoch: 8 cost time: 1.41066575050354
Epoch: 8, Steps: 10 | Train Loss: 0.971 Vali Loss: 1.231 Vali Acc: 0.432 Test Loss: 1.231 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5162055492401123
Epoch: 9, Steps: 10 | Train Loss: 0.890 Vali Loss: 1.201 Vali Acc: 0.459 Test Loss: 1.201 Test Acc: 0.459
Validation loss decreased (-0.445933 --> -0.459447).  Saving model ...
Epoch: 10 cost time: 0.802710771560669
Epoch: 10, Steps: 10 | Train Loss: 0.815 Vali Loss: 1.191 Vali Acc: 0.541 Test Loss: 1.191 Test Acc: 0.541
Validation loss decreased (-0.459447 --> -0.540529).  Saving model ...
Epoch: 11 cost time: 1.2737329006195068
Epoch: 11, Steps: 10 | Train Loss: 0.742 Vali Loss: 1.167 Vali Acc: 0.473 Test Loss: 1.167 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4114866256713867
Epoch: 12, Steps: 10 | Train Loss: 0.694 Vali Loss: 1.138 Vali Acc: 0.568 Test Loss: 1.138 Test Acc: 0.568
Validation loss decreased (-0.540529 --> -0.567556).  Saving model ...
Epoch: 13 cost time: 1.408158302307129
Epoch: 13, Steps: 10 | Train Loss: 0.616 Vali Loss: 1.129 Vali Acc: 0.554 Test Loss: 1.129 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.388314962387085
Epoch: 14, Steps: 10 | Train Loss: 0.529 Vali Loss: 1.137 Vali Acc: 0.527 Test Loss: 1.137 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.4174211025238037
Epoch: 15, Steps: 10 | Train Loss: 0.471 Vali Loss: 1.070 Vali Acc: 0.568 Test Loss: 1.070 Test Acc: 0.568
Validation loss decreased (-0.567556 --> -0.567557).  Saving model ...
Epoch: 16 cost time: 1.5495200157165527
Epoch: 16, Steps: 10 | Train Loss: 0.398 Vali Loss: 1.043 Vali Acc: 0.595 Test Loss: 1.043 Test Acc: 0.595
Validation loss decreased (-0.567557 --> -0.594584).  Saving model ...
Epoch: 17 cost time: 1.430940866470337
Epoch: 17, Steps: 10 | Train Loss: 0.357 Vali Loss: 1.070 Vali Acc: 0.568 Test Loss: 1.070 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.4795639514923096
Epoch: 18, Steps: 10 | Train Loss: 0.290 Vali Loss: 1.030 Vali Acc: 0.581 Test Loss: 1.030 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.3442089557647705
Epoch: 19, Steps: 10 | Train Loss: 0.271 Vali Loss: 0.999 Vali Acc: 0.622 Test Loss: 0.999 Test Acc: 0.622
Validation loss decreased (-0.594584 --> -0.621612).  Saving model ...
Epoch: 20 cost time: 1.4599318504333496
Epoch: 20, Steps: 10 | Train Loss: 0.217 Vali Loss: 1.039 Vali Acc: 0.608 Test Loss: 1.039 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.42146635055542
Epoch: 21, Steps: 10 | Train Loss: 0.200 Vali Loss: 0.998 Vali Acc: 0.608 Test Loss: 0.998 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.4941468238830566
Epoch: 22, Steps: 10 | Train Loss: 0.162 Vali Loss: 0.969 Vali Acc: 0.635 Test Loss: 0.969 Test Acc: 0.635
Validation loss decreased (-0.621612 --> -0.635125).  Saving model ...
Epoch: 23 cost time: 1.4393060207366943
Epoch: 23, Steps: 10 | Train Loss: 0.140 Vali Loss: 1.005 Vali Acc: 0.568 Test Loss: 1.005 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.5421969890594482
Epoch: 24, Steps: 10 | Train Loss: 0.117 Vali Loss: 1.002 Vali Acc: 0.568 Test Loss: 1.002 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.60160231590271
Epoch: 25, Steps: 10 | Train Loss: 0.107 Vali Loss: 0.991 Vali Acc: 0.568 Test Loss: 0.991 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.6052300930023193
Epoch: 26, Steps: 10 | Train Loss: 0.088 Vali Loss: 1.004 Vali Acc: 0.568 Test Loss: 1.004 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.64947509765625
Epoch: 27, Steps: 10 | Train Loss: 0.085 Vali Loss: 0.982 Vali Acc: 0.608 Test Loss: 0.982 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.579864501953125
Epoch: 28, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.985 Vali Acc: 0.595 Test Loss: 0.985 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.5384626388549805
Epoch: 29, Steps: 10 | Train Loss: 0.072 Vali Loss: 0.984 Vali Acc: 0.595 Test Loss: 0.984 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.5096204280853271
Epoch: 30, Steps: 10 | Train Loss: 0.062 Vali Loss: 0.984 Vali Acc: 0.608 Test Loss: 0.984 Test Acc: 0.608
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm8_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6351351351351351
model parameter : 77892
model size : 0.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm8_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.4125571250915527
Epoch: 1, Steps: 10 | Train Loss: 1.462 Vali Loss: 1.596 Vali Acc: 0.149 Test Loss: 1.596 Test Acc: 0.149
Validation loss decreased (inf --> -0.148633).  Saving model ...
Epoch: 2 cost time: 1.9745075702667236
Epoch: 2, Steps: 10 | Train Loss: 1.421 Vali Loss: 1.514 Vali Acc: 0.203 Test Loss: 1.514 Test Acc: 0.203
Validation loss decreased (-0.148633 --> -0.202688).  Saving model ...
Epoch: 3 cost time: 1.9773375988006592
Epoch: 3, Steps: 10 | Train Loss: 1.351 Vali Loss: 1.470 Vali Acc: 0.176 Test Loss: 1.470 Test Acc: 0.176
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9832336902618408
Epoch: 4, Steps: 10 | Train Loss: 1.306 Vali Loss: 1.446 Vali Acc: 0.216 Test Loss: 1.446 Test Acc: 0.216
Validation loss decreased (-0.202688 --> -0.216202).  Saving model ...
Epoch: 5 cost time: 2.0869221687316895
Epoch: 5, Steps: 10 | Train Loss: 1.223 Vali Loss: 1.438 Vali Acc: 0.270 Test Loss: 1.438 Test Acc: 0.270
Validation loss decreased (-0.216202 --> -0.270256).  Saving model ...
Epoch: 6 cost time: 1.9574038982391357
Epoch: 6, Steps: 10 | Train Loss: 1.158 Vali Loss: 1.415 Vali Acc: 0.297 Test Loss: 1.415 Test Acc: 0.297
Validation loss decreased (-0.270256 --> -0.297283).  Saving model ...
Epoch: 7 cost time: 1.8426053524017334
Epoch: 7, Steps: 10 | Train Loss: 1.084 Vali Loss: 1.381 Vali Acc: 0.311 Test Loss: 1.381 Test Acc: 0.311
Validation loss decreased (-0.297283 --> -0.310797).  Saving model ...
Epoch: 8 cost time: 1.9314725399017334
Epoch: 8, Steps: 10 | Train Loss: 1.032 Vali Loss: 1.368 Vali Acc: 0.365 Test Loss: 1.368 Test Acc: 0.365
Validation loss decreased (-0.310797 --> -0.364851).  Saving model ...
Epoch: 9 cost time: 1.9837119579315186
Epoch: 9, Steps: 10 | Train Loss: 0.935 Vali Loss: 1.337 Vali Acc: 0.405 Test Loss: 1.337 Test Acc: 0.405
Validation loss decreased (-0.364851 --> -0.405392).  Saving model ...
Epoch: 10 cost time: 2.0296318531036377
Epoch: 10, Steps: 10 | Train Loss: 0.861 Vali Loss: 1.317 Vali Acc: 0.432 Test Loss: 1.317 Test Acc: 0.432
Validation loss decreased (-0.405392 --> -0.432419).  Saving model ...
Epoch: 11 cost time: 1.9734959602355957
Epoch: 11, Steps: 10 | Train Loss: 0.762 Vali Loss: 1.273 Vali Acc: 0.392 Test Loss: 1.273 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.040217161178589
Epoch: 12, Steps: 10 | Train Loss: 0.682 Vali Loss: 1.253 Vali Acc: 0.432 Test Loss: 1.253 Test Acc: 0.432
Validation loss decreased (-0.432419 --> -0.432420).  Saving model ...
Epoch: 13 cost time: 2.008920907974243
Epoch: 13, Steps: 10 | Train Loss: 0.598 Vali Loss: 1.242 Vali Acc: 0.419 Test Loss: 1.242 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.0143518447875977
Epoch: 14, Steps: 10 | Train Loss: 0.540 Vali Loss: 1.222 Vali Acc: 0.405 Test Loss: 1.222 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.1771364212036133
Epoch: 15, Steps: 10 | Train Loss: 0.434 Vali Loss: 1.197 Vali Acc: 0.486 Test Loss: 1.197 Test Acc: 0.486
Validation loss decreased (-0.432420 --> -0.486475).  Saving model ...
Epoch: 16 cost time: 1.9198787212371826
Epoch: 16, Steps: 10 | Train Loss: 0.393 Vali Loss: 1.187 Vali Acc: 0.486 Test Loss: 1.187 Test Acc: 0.486
Validation loss decreased (-0.486475 --> -0.486475).  Saving model ...
Epoch: 17 cost time: 1.917531967163086
Epoch: 17, Steps: 10 | Train Loss: 0.324 Vali Loss: 1.214 Vali Acc: 0.473 Test Loss: 1.214 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.9301869869232178
Epoch: 18, Steps: 10 | Train Loss: 0.288 Vali Loss: 1.173 Vali Acc: 0.527 Test Loss: 1.173 Test Acc: 0.527
Validation loss decreased (-0.486475 --> -0.527015).  Saving model ...
Epoch: 19 cost time: 1.973586082458496
Epoch: 19, Steps: 10 | Train Loss: 0.236 Vali Loss: 1.164 Vali Acc: 0.500 Test Loss: 1.164 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.8202638626098633
Epoch: 20, Steps: 10 | Train Loss: 0.207 Vali Loss: 1.169 Vali Acc: 0.486 Test Loss: 1.169 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.847421646118164
Epoch: 21, Steps: 10 | Train Loss: 0.166 Vali Loss: 1.172 Vali Acc: 0.527 Test Loss: 1.172 Test Acc: 0.527
Validation loss decreased (-0.527015 --> -0.527015).  Saving model ...
Epoch: 22 cost time: 1.8612329959869385
Epoch: 22, Steps: 10 | Train Loss: 0.143 Vali Loss: 1.181 Vali Acc: 0.541 Test Loss: 1.181 Test Acc: 0.541
Validation loss decreased (-0.527015 --> -0.540529).  Saving model ...
Epoch: 23 cost time: 1.8973512649536133
Epoch: 23, Steps: 10 | Train Loss: 0.124 Vali Loss: 1.195 Vali Acc: 0.541 Test Loss: 1.195 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.9189937114715576
Epoch: 24, Steps: 10 | Train Loss: 0.106 Vali Loss: 1.163 Vali Acc: 0.527 Test Loss: 1.163 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.8826208114624023
Epoch: 25, Steps: 10 | Train Loss: 0.090 Vali Loss: 1.156 Vali Acc: 0.554 Test Loss: 1.156 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554042).  Saving model ...
Epoch: 26 cost time: 2.0120933055877686
Epoch: 26, Steps: 10 | Train Loss: 0.084 Vali Loss: 1.144 Vali Acc: 0.541 Test Loss: 1.144 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.9891893863677979
Epoch: 27, Steps: 10 | Train Loss: 0.072 Vali Loss: 1.170 Vali Acc: 0.541 Test Loss: 1.170 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.921485424041748
Epoch: 28, Steps: 10 | Train Loss: 0.058 Vali Loss: 1.154 Vali Acc: 0.541 Test Loss: 1.154 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.9356870651245117
Epoch: 29, Steps: 10 | Train Loss: 0.065 Vali Loss: 1.132 Vali Acc: 0.595 Test Loss: 1.132 Test Acc: 0.595
Validation loss decreased (-0.554042 --> -0.594583).  Saving model ...
Epoch: 30 cost time: 1.9000678062438965
Epoch: 30, Steps: 10 | Train Loss: 0.049 Vali Loss: 1.182 Vali Acc: 0.527 Test Loss: 1.182 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm8_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 233172
model size : 1.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm8_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.786524772644043
Epoch: 1, Steps: 10 | Train Loss: 1.412 Vali Loss: 1.357 Vali Acc: 0.378 Test Loss: 1.357 Test Acc: 0.378
Validation loss decreased (inf --> -0.378365).  Saving model ...
Epoch: 2 cost time: 1.2324864864349365
Epoch: 2, Steps: 10 | Train Loss: 1.381 Vali Loss: 1.355 Vali Acc: 0.392 Test Loss: 1.355 Test Acc: 0.392
Validation loss decreased (-0.378365 --> -0.391878).  Saving model ...
Epoch: 3 cost time: 1.2407865524291992
Epoch: 3, Steps: 10 | Train Loss: 1.315 Vali Loss: 1.347 Vali Acc: 0.392 Test Loss: 1.347 Test Acc: 0.392
Validation loss decreased (-0.391878 --> -0.391878).  Saving model ...
Epoch: 4 cost time: 1.3014180660247803
Epoch: 4, Steps: 10 | Train Loss: 1.259 Vali Loss: 1.330 Vali Acc: 0.392 Test Loss: 1.330 Test Acc: 0.392
Validation loss decreased (-0.391878 --> -0.391879).  Saving model ...
Epoch: 5 cost time: 1.3675816059112549
Epoch: 5, Steps: 10 | Train Loss: 1.177 Vali Loss: 1.304 Vali Acc: 0.446 Test Loss: 1.304 Test Acc: 0.446
Validation loss decreased (-0.391879 --> -0.445933).  Saving model ...
Epoch: 6 cost time: 0.8617444038391113
Epoch: 6, Steps: 10 | Train Loss: 1.156 Vali Loss: 1.290 Vali Acc: 0.419 Test Loss: 1.290 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2442069053649902
Epoch: 7, Steps: 10 | Train Loss: 1.031 Vali Loss: 1.251 Vali Acc: 0.432 Test Loss: 1.251 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2380599975585938
Epoch: 8, Steps: 10 | Train Loss: 0.961 Vali Loss: 1.238 Vali Acc: 0.446 Test Loss: 1.238 Test Acc: 0.446
Validation loss decreased (-0.445933 --> -0.445934).  Saving model ...
Epoch: 9 cost time: 1.2871432304382324
Epoch: 9, Steps: 10 | Train Loss: 0.879 Vali Loss: 1.212 Vali Acc: 0.473 Test Loss: 1.212 Test Acc: 0.473
Validation loss decreased (-0.445934 --> -0.472961).  Saving model ...
Epoch: 10 cost time: 1.2122547626495361
Epoch: 10, Steps: 10 | Train Loss: 0.813 Vali Loss: 1.196 Vali Acc: 0.514 Test Loss: 1.196 Test Acc: 0.514
Validation loss decreased (-0.472961 --> -0.513502).  Saving model ...
Epoch: 11 cost time: 1.196683645248413
Epoch: 11, Steps: 10 | Train Loss: 0.729 Vali Loss: 1.173 Vali Acc: 0.473 Test Loss: 1.173 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2664673328399658
Epoch: 12, Steps: 10 | Train Loss: 0.673 Vali Loss: 1.156 Vali Acc: 0.541 Test Loss: 1.156 Test Acc: 0.541
Validation loss decreased (-0.513502 --> -0.540529).  Saving model ...
Epoch: 13 cost time: 1.2363035678863525
Epoch: 13, Steps: 10 | Train Loss: 0.601 Vali Loss: 1.138 Vali Acc: 0.541 Test Loss: 1.138 Test Acc: 0.541
Validation loss decreased (-0.540529 --> -0.540529).  Saving model ...
Epoch: 14 cost time: 1.1849243640899658
Epoch: 14, Steps: 10 | Train Loss: 0.510 Vali Loss: 1.150 Vali Acc: 0.514 Test Loss: 1.150 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1041293144226074
Epoch: 15, Steps: 10 | Train Loss: 0.454 Vali Loss: 1.079 Vali Acc: 0.554 Test Loss: 1.079 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554043).  Saving model ...
Epoch: 16 cost time: 1.2554614543914795
Epoch: 16, Steps: 10 | Train Loss: 0.378 Vali Loss: 1.055 Vali Acc: 0.581 Test Loss: 1.055 Test Acc: 0.581
Validation loss decreased (-0.554043 --> -0.581071).  Saving model ...
Epoch: 17 cost time: 1.25185227394104
Epoch: 17, Steps: 10 | Train Loss: 0.330 Vali Loss: 1.063 Vali Acc: 0.541 Test Loss: 1.063 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1579387187957764
Epoch: 18, Steps: 10 | Train Loss: 0.273 Vali Loss: 1.033 Vali Acc: 0.568 Test Loss: 1.033 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.2087106704711914
Epoch: 19, Steps: 10 | Train Loss: 0.255 Vali Loss: 0.993 Vali Acc: 0.595 Test Loss: 0.993 Test Acc: 0.595
Validation loss decreased (-0.581071 --> -0.594585).  Saving model ...
Epoch: 20 cost time: 1.197535753250122
Epoch: 20, Steps: 10 | Train Loss: 0.202 Vali Loss: 1.028 Vali Acc: 0.541 Test Loss: 1.028 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.1357123851776123
Epoch: 21, Steps: 10 | Train Loss: 0.181 Vali Loss: 1.017 Vali Acc: 0.568 Test Loss: 1.017 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.2864956855773926
Epoch: 22, Steps: 10 | Train Loss: 0.154 Vali Loss: 0.974 Vali Acc: 0.635 Test Loss: 0.974 Test Acc: 0.635
Validation loss decreased (-0.594585 --> -0.635125).  Saving model ...
Epoch: 23 cost time: 1.1981661319732666
Epoch: 23, Steps: 10 | Train Loss: 0.130 Vali Loss: 1.014 Vali Acc: 0.554 Test Loss: 1.014 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.246690034866333
Epoch: 24, Steps: 10 | Train Loss: 0.111 Vali Loss: 1.018 Vali Acc: 0.527 Test Loss: 1.018 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.2519149780273438
Epoch: 25, Steps: 10 | Train Loss: 0.097 Vali Loss: 1.000 Vali Acc: 0.568 Test Loss: 1.000 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.2680480480194092
Epoch: 26, Steps: 10 | Train Loss: 0.087 Vali Loss: 0.982 Vali Acc: 0.608 Test Loss: 0.982 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.2252953052520752
Epoch: 27, Steps: 10 | Train Loss: 0.080 Vali Loss: 0.974 Vali Acc: 0.581 Test Loss: 0.974 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.2011528015136719
Epoch: 28, Steps: 10 | Train Loss: 0.076 Vali Loss: 0.950 Vali Acc: 0.622 Test Loss: 0.950 Test Acc: 0.622
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.0439081192016602
Epoch: 29, Steps: 10 | Train Loss: 0.074 Vali Loss: 0.929 Vali Acc: 0.635 Test Loss: 0.929 Test Acc: 0.635
Validation loss decreased (-0.635125 --> -0.635126).  Saving model ...
Epoch: 30 cost time: 1.124457836151123
Epoch: 30, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.963 Vali Acc: 0.581 Test Loss: 0.963 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm8_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6351351351351351
model parameter : 77892
model size : 0.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm8_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.7232553958892822
Epoch: 1, Steps: 10 | Train Loss: 1.464 Vali Loss: 1.596 Vali Acc: 0.135 Test Loss: 1.596 Test Acc: 0.135
Validation loss decreased (inf --> -0.135119).  Saving model ...
Epoch: 2 cost time: 1.481191635131836
Epoch: 2, Steps: 10 | Train Loss: 1.421 Vali Loss: 1.515 Vali Acc: 0.189 Test Loss: 1.515 Test Acc: 0.189
Validation loss decreased (-0.135119 --> -0.189174).  Saving model ...
Epoch: 3 cost time: 1.4745838642120361
Epoch: 3, Steps: 10 | Train Loss: 1.352 Vali Loss: 1.470 Vali Acc: 0.149 Test Loss: 1.470 Test Acc: 0.149
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4672739505767822
Epoch: 4, Steps: 10 | Train Loss: 1.313 Vali Loss: 1.445 Vali Acc: 0.176 Test Loss: 1.445 Test Acc: 0.176
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.556943655014038
Epoch: 5, Steps: 10 | Train Loss: 1.236 Vali Loss: 1.437 Vali Acc: 0.243 Test Loss: 1.437 Test Acc: 0.243
Validation loss decreased (-0.189174 --> -0.243229).  Saving model ...
Epoch: 6 cost time: 1.5070722103118896
Epoch: 6, Steps: 10 | Train Loss: 1.170 Vali Loss: 1.413 Vali Acc: 0.284 Test Loss: 1.413 Test Acc: 0.284
Validation loss decreased (-0.243229 --> -0.283770).  Saving model ...
Epoch: 7 cost time: 1.4654479026794434
Epoch: 7, Steps: 10 | Train Loss: 1.103 Vali Loss: 1.378 Vali Acc: 0.284 Test Loss: 1.378 Test Acc: 0.284
Validation loss decreased (-0.283770 --> -0.283770).  Saving model ...
Epoch: 8 cost time: 1.4358623027801514
Epoch: 8, Steps: 10 | Train Loss: 1.049 Vali Loss: 1.366 Vali Acc: 0.311 Test Loss: 1.366 Test Acc: 0.311
Validation loss decreased (-0.283770 --> -0.310797).  Saving model ...
Epoch: 9 cost time: 1.4754106998443604
Epoch: 9, Steps: 10 | Train Loss: 0.960 Vali Loss: 1.336 Vali Acc: 0.378 Test Loss: 1.336 Test Acc: 0.378
Validation loss decreased (-0.310797 --> -0.378365).  Saving model ...
Epoch: 10 cost time: 1.4673101902008057
Epoch: 10, Steps: 10 | Train Loss: 0.894 Vali Loss: 1.315 Vali Acc: 0.378 Test Loss: 1.315 Test Acc: 0.378
Validation loss decreased (-0.378365 --> -0.378365).  Saving model ...
Epoch: 11 cost time: 1.5143394470214844
Epoch: 11, Steps: 10 | Train Loss: 0.809 Vali Loss: 1.278 Vali Acc: 0.405 Test Loss: 1.278 Test Acc: 0.405
Validation loss decreased (-0.378365 --> -0.405393).  Saving model ...
Epoch: 12 cost time: 1.6311466693878174
Epoch: 12, Steps: 10 | Train Loss: 0.736 Vali Loss: 1.257 Vali Acc: 0.405 Test Loss: 1.257 Test Acc: 0.405
Validation loss decreased (-0.405393 --> -0.405393).  Saving model ...
Epoch: 13 cost time: 1.5430200099945068
Epoch: 13, Steps: 10 | Train Loss: 0.663 Vali Loss: 1.232 Vali Acc: 0.446 Test Loss: 1.232 Test Acc: 0.446
Validation loss decreased (-0.405393 --> -0.445934).  Saving model ...
Epoch: 14 cost time: 1.4613559246063232
Epoch: 14, Steps: 10 | Train Loss: 0.594 Vali Loss: 1.209 Vali Acc: 0.459 Test Loss: 1.209 Test Acc: 0.459
Validation loss decreased (-0.445934 --> -0.459447).  Saving model ...
Epoch: 15 cost time: 1.47184157371521
Epoch: 15, Steps: 10 | Train Loss: 0.514 Vali Loss: 1.178 Vali Acc: 0.500 Test Loss: 1.178 Test Acc: 0.500
Validation loss decreased (-0.459447 --> -0.499988).  Saving model ...
Epoch: 16 cost time: 1.5379328727722168
Epoch: 16, Steps: 10 | Train Loss: 0.471 Vali Loss: 1.155 Vali Acc: 0.514 Test Loss: 1.155 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513502).  Saving model ...
Epoch: 17 cost time: 1.4840779304504395
Epoch: 17, Steps: 10 | Train Loss: 0.410 Vali Loss: 1.188 Vali Acc: 0.486 Test Loss: 1.188 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.480186939239502
Epoch: 18, Steps: 10 | Train Loss: 0.362 Vali Loss: 1.135 Vali Acc: 0.527 Test Loss: 1.135 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527016).  Saving model ...
Epoch: 19 cost time: 1.554764986038208
Epoch: 19, Steps: 10 | Train Loss: 0.307 Vali Loss: 1.107 Vali Acc: 0.514 Test Loss: 1.107 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.5555973052978516
Epoch: 20, Steps: 10 | Train Loss: 0.275 Vali Loss: 1.115 Vali Acc: 0.527 Test Loss: 1.115 Test Acc: 0.527
Validation loss decreased (-0.527016 --> -0.527016).  Saving model ...
Epoch: 21 cost time: 1.459115982055664
Epoch: 21, Steps: 10 | Train Loss: 0.239 Vali Loss: 1.113 Vali Acc: 0.541 Test Loss: 1.113 Test Acc: 0.541
Validation loss decreased (-0.527016 --> -0.540529).  Saving model ...
Epoch: 22 cost time: 1.458167552947998
Epoch: 22, Steps: 10 | Train Loss: 0.200 Vali Loss: 1.107 Vali Acc: 0.514 Test Loss: 1.107 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.442509412765503
Epoch: 23, Steps: 10 | Train Loss: 0.173 Vali Loss: 1.115 Vali Acc: 0.514 Test Loss: 1.115 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.503770351409912
Epoch: 24, Steps: 10 | Train Loss: 0.150 Vali Loss: 1.093 Vali Acc: 0.527 Test Loss: 1.093 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.6323022842407227
Epoch: 25, Steps: 10 | Train Loss: 0.129 Vali Loss: 1.110 Vali Acc: 0.568 Test Loss: 1.110 Test Acc: 0.568
Validation loss decreased (-0.540529 --> -0.567556).  Saving model ...
Epoch: 26 cost time: 1.4767677783966064
Epoch: 26, Steps: 10 | Train Loss: 0.121 Vali Loss: 1.106 Vali Acc: 0.541 Test Loss: 1.106 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.450880527496338
Epoch: 27, Steps: 10 | Train Loss: 0.095 Vali Loss: 1.116 Vali Acc: 0.541 Test Loss: 1.116 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.5361547470092773
Epoch: 28, Steps: 10 | Train Loss: 0.092 Vali Loss: 1.108 Vali Acc: 0.541 Test Loss: 1.108 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.495603322982788
Epoch: 29, Steps: 10 | Train Loss: 0.082 Vali Loss: 1.107 Vali Acc: 0.554 Test Loss: 1.107 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.5310649871826172
Epoch: 30, Steps: 10 | Train Loss: 0.068 Vali Loss: 1.132 Vali Acc: 0.541 Test Loss: 1.132 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm8_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 233172
model size : 1.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm8_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.5276241302490234
Epoch: 1, Steps: 10 | Train Loss: 1.414 Vali Loss: 1.361 Vali Acc: 0.365 Test Loss: 1.361 Test Acc: 0.365
Validation loss decreased (inf --> -0.364851).  Saving model ...
Epoch: 2 cost time: 1.0834665298461914
Epoch: 2, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.358 Vali Acc: 0.405 Test Loss: 1.358 Test Acc: 0.405
Validation loss decreased (-0.364851 --> -0.405392).  Saving model ...
Epoch: 3 cost time: 1.0781171321868896
Epoch: 3, Steps: 10 | Train Loss: 1.317 Vali Loss: 1.349 Vali Acc: 0.405 Test Loss: 1.349 Test Acc: 0.405
Validation loss decreased (-0.405392 --> -0.405392).  Saving model ...
Epoch: 4 cost time: 1.1234924793243408
Epoch: 4, Steps: 10 | Train Loss: 1.273 Vali Loss: 1.330 Vali Acc: 0.405 Test Loss: 1.330 Test Acc: 0.405
Validation loss decreased (-0.405392 --> -0.405392).  Saving model ...
Epoch: 5 cost time: 1.064744234085083
Epoch: 5, Steps: 10 | Train Loss: 1.196 Vali Loss: 1.301 Vali Acc: 0.405 Test Loss: 1.301 Test Acc: 0.405
Validation loss decreased (-0.405392 --> -0.405392).  Saving model ...
Epoch: 6 cost time: 1.1259348392486572
Epoch: 6, Steps: 10 | Train Loss: 1.181 Vali Loss: 1.286 Vali Acc: 0.405 Test Loss: 1.286 Test Acc: 0.405
Validation loss decreased (-0.405392 --> -0.405393).  Saving model ...
Epoch: 7 cost time: 1.0513110160827637
Epoch: 7, Steps: 10 | Train Loss: 1.054 Vali Loss: 1.244 Vali Acc: 0.446 Test Loss: 1.244 Test Acc: 0.446
Validation loss decreased (-0.405393 --> -0.445934).  Saving model ...
Epoch: 8 cost time: 1.0571084022521973
Epoch: 8, Steps: 10 | Train Loss: 0.999 Vali Loss: 1.228 Vali Acc: 0.446 Test Loss: 1.228 Test Acc: 0.446
Validation loss decreased (-0.445934 --> -0.445934).  Saving model ...
Epoch: 9 cost time: 1.1456806659698486
Epoch: 9, Steps: 10 | Train Loss: 0.919 Vali Loss: 1.196 Vali Acc: 0.541 Test Loss: 1.196 Test Acc: 0.541
Validation loss decreased (-0.445934 --> -0.540529).  Saving model ...
Epoch: 10 cost time: 1.069411039352417
Epoch: 10, Steps: 10 | Train Loss: 0.850 Vali Loss: 1.181 Vali Acc: 0.568 Test Loss: 1.181 Test Acc: 0.568
Validation loss decreased (-0.540529 --> -0.567556).  Saving model ...
Epoch: 11 cost time: 1.1269497871398926
Epoch: 11, Steps: 10 | Train Loss: 0.786 Vali Loss: 1.156 Vali Acc: 0.527 Test Loss: 1.156 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0739681720733643
Epoch: 12, Steps: 10 | Train Loss: 0.732 Vali Loss: 1.127 Vali Acc: 0.595 Test Loss: 1.127 Test Acc: 0.595
Validation loss decreased (-0.567556 --> -0.594583).  Saving model ...
Epoch: 13 cost time: 1.0986239910125732
Epoch: 13, Steps: 10 | Train Loss: 0.654 Vali Loss: 1.110 Vali Acc: 0.554 Test Loss: 1.110 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0315155982971191
Epoch: 14, Steps: 10 | Train Loss: 0.576 Vali Loss: 1.110 Vali Acc: 0.554 Test Loss: 1.110 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.0422298908233643
Epoch: 15, Steps: 10 | Train Loss: 0.521 Vali Loss: 1.047 Vali Acc: 0.568 Test Loss: 1.047 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.0984408855438232
Epoch: 16, Steps: 10 | Train Loss: 0.456 Vali Loss: 1.024 Vali Acc: 0.622 Test Loss: 1.024 Test Acc: 0.622
Validation loss decreased (-0.594583 --> -0.621611).  Saving model ...
Epoch: 17 cost time: 1.0270090103149414
Epoch: 17, Steps: 10 | Train Loss: 0.407 Vali Loss: 1.035 Vali Acc: 0.581 Test Loss: 1.035 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9589638710021973
Epoch: 18, Steps: 10 | Train Loss: 0.342 Vali Loss: 0.998 Vali Acc: 0.608 Test Loss: 0.998 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.0760278701782227
Epoch: 19, Steps: 10 | Train Loss: 0.324 Vali Loss: 0.971 Vali Acc: 0.608 Test Loss: 0.971 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.0548057556152344
Epoch: 20, Steps: 10 | Train Loss: 0.268 Vali Loss: 0.996 Vali Acc: 0.581 Test Loss: 0.996 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.010632038116455
Epoch: 21, Steps: 10 | Train Loss: 0.236 Vali Loss: 0.951 Vali Acc: 0.608 Test Loss: 0.951 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.0477311611175537
Epoch: 22, Steps: 10 | Train Loss: 0.214 Vali Loss: 0.933 Vali Acc: 0.622 Test Loss: 0.933 Test Acc: 0.622
Validation loss decreased (-0.621611 --> -0.621612).  Saving model ...
Epoch: 23 cost time: 0.9394078254699707
Epoch: 23, Steps: 10 | Train Loss: 0.172 Vali Loss: 0.981 Vali Acc: 0.568 Test Loss: 0.981 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.056147575378418
Epoch: 24, Steps: 10 | Train Loss: 0.150 Vali Loss: 0.957 Vali Acc: 0.581 Test Loss: 0.957 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.9244728088378906
Epoch: 25, Steps: 10 | Train Loss: 0.137 Vali Loss: 0.930 Vali Acc: 0.608 Test Loss: 0.930 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.0123848915100098
Epoch: 26, Steps: 10 | Train Loss: 0.121 Vali Loss: 0.951 Vali Acc: 0.595 Test Loss: 0.951 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.0027637481689453
Epoch: 27, Steps: 10 | Train Loss: 0.105 Vali Loss: 0.927 Vali Acc: 0.608 Test Loss: 0.927 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.9963324069976807
Epoch: 28, Steps: 10 | Train Loss: 0.101 Vali Loss: 0.940 Vali Acc: 0.595 Test Loss: 0.940 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.0023353099822998
Epoch: 29, Steps: 10 | Train Loss: 0.088 Vali Loss: 0.934 Vali Acc: 0.595 Test Loss: 0.934 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.0852110385894775
Epoch: 30, Steps: 10 | Train Loss: 0.075 Vali Loss: 0.930 Vali Acc: 0.595 Test Loss: 0.930 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el3_dm8_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 77892
model size : 0.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm128_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 23.049445152282715
Epoch: 1, Steps: 10 | Train Loss: 1.470 Vali Loss: 1.288 Vali Acc: 0.365 Test Loss: 1.288 Test Acc: 0.365
Validation loss decreased (inf --> -0.364852).  Saving model ...
Epoch: 2 cost time: 22.42674422264099
Epoch: 2, Steps: 10 | Train Loss: 1.090 Vali Loss: 1.321 Vali Acc: 0.419 Test Loss: 1.321 Test Acc: 0.419
Validation loss decreased (-0.364852 --> -0.418906).  Saving model ...
Epoch: 3 cost time: 23.289730310440063
Epoch: 3, Steps: 10 | Train Loss: 0.547 Vali Loss: 1.201 Vali Acc: 0.473 Test Loss: 1.201 Test Acc: 0.473
Validation loss decreased (-0.418906 --> -0.472961).  Saving model ...
Epoch: 4 cost time: 23.284162282943726
Epoch: 4, Steps: 10 | Train Loss: 0.257 Vali Loss: 1.180 Vali Acc: 0.514 Test Loss: 1.180 Test Acc: 0.514
Validation loss decreased (-0.472961 --> -0.513502).  Saving model ...
Epoch: 5 cost time: 23.291070699691772
Epoch: 5, Steps: 10 | Train Loss: 0.086 Vali Loss: 1.199 Vali Acc: 0.514 Test Loss: 1.199 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 23.361045122146606
Epoch: 6, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.107 Vali Acc: 0.581 Test Loss: 1.107 Test Acc: 0.581
Validation loss decreased (-0.513502 --> -0.581070).  Saving model ...
Epoch: 7 cost time: 22.967946529388428
Epoch: 7, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.246 Vali Acc: 0.541 Test Loss: 1.246 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 21.53568935394287
Epoch: 8, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.298 Vali Acc: 0.608 Test Loss: 1.298 Test Acc: 0.608
Validation loss decreased (-0.581070 --> -0.608095).  Saving model ...
Epoch: 9 cost time: 22.481420516967773
Epoch: 9, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.192 Vali Acc: 0.541 Test Loss: 1.192 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 22.1786630153656
Epoch: 10, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.197 Vali Acc: 0.568 Test Loss: 1.197 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 21.999233722686768
Epoch: 11, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.249 Vali Acc: 0.581 Test Loss: 1.249 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 22.800050973892212
Epoch: 12, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.255 Vali Acc: 0.581 Test Loss: 1.255 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 24.10396385192871
Epoch: 13, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.228 Vali Acc: 0.581 Test Loss: 1.228 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 23.804574966430664
Epoch: 14, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.227 Vali Acc: 0.581 Test Loss: 1.227 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 23.553322553634644
Epoch: 15, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.234 Vali Acc: 0.595 Test Loss: 1.234 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 23.423685550689697
Epoch: 16, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.238 Vali Acc: 0.581 Test Loss: 1.238 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 22.812013149261475
Epoch: 17, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.245 Vali Acc: 0.595 Test Loss: 1.245 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 24.155354022979736
Epoch: 18, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.253 Vali Acc: 0.595 Test Loss: 1.253 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm128_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 37700612
model size : 146.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm128_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 9.347308158874512
Epoch: 1, Steps: 10 | Train Loss: 1.447 Vali Loss: 1.387 Vali Acc: 0.216 Test Loss: 1.387 Test Acc: 0.216
Validation loss decreased (inf --> -0.216202).  Saving model ...
Epoch: 2 cost time: 7.96458625793457
Epoch: 2, Steps: 10 | Train Loss: 1.060 Vali Loss: 1.191 Vali Acc: 0.486 Test Loss: 1.191 Test Acc: 0.486
Validation loss decreased (-0.216202 --> -0.486475).  Saving model ...
Epoch: 3 cost time: 8.13961410522461
Epoch: 3, Steps: 10 | Train Loss: 0.540 Vali Loss: 1.165 Vali Acc: 0.500 Test Loss: 1.165 Test Acc: 0.500
Validation loss decreased (-0.486475 --> -0.499988).  Saving model ...
Epoch: 4 cost time: 8.041786432266235
Epoch: 4, Steps: 10 | Train Loss: 0.250 Vali Loss: 1.292 Vali Acc: 0.486 Test Loss: 1.292 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 8.112695455551147
Epoch: 5, Steps: 10 | Train Loss: 0.072 Vali Loss: 1.100 Vali Acc: 0.581 Test Loss: 1.100 Test Acc: 0.581
Validation loss decreased (-0.499988 --> -0.581070).  Saving model ...
Epoch: 6 cost time: 7.833218574523926
Epoch: 6, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.083 Vali Acc: 0.595 Test Loss: 1.083 Test Acc: 0.595
Validation loss decreased (-0.581070 --> -0.594584).  Saving model ...
Epoch: 7 cost time: 8.44906759262085
Epoch: 7, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.192 Vali Acc: 0.568 Test Loss: 1.192 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 8.840689182281494
Epoch: 8, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.387 Vali Acc: 0.527 Test Loss: 1.387 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 8.908951997756958
Epoch: 9, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.233 Vali Acc: 0.527 Test Loss: 1.233 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 8.80946946144104
Epoch: 10, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.195 Vali Acc: 0.581 Test Loss: 1.195 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 9.006369590759277
Epoch: 11, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.217 Vali Acc: 0.554 Test Loss: 1.217 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 8.968628644943237
Epoch: 12, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.258 Vali Acc: 0.541 Test Loss: 1.258 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 8.7452974319458
Epoch: 13, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.264 Vali Acc: 0.554 Test Loss: 1.264 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 8.61158561706543
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.265 Vali Acc: 0.541 Test Loss: 1.265 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 8.69236421585083
Epoch: 15, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.268 Vali Acc: 0.541 Test Loss: 1.268 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 8.66584587097168
Epoch: 16, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.268 Vali Acc: 0.554 Test Loss: 1.268 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm128_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 11222532
model size : 45.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm128_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 16.906933546066284
Epoch: 1, Steps: 10 | Train Loss: 1.470 Vali Loss: 1.288 Vali Acc: 0.392 Test Loss: 1.288 Test Acc: 0.392
Validation loss decreased (inf --> -0.391879).  Saving model ...
Epoch: 2 cost time: 16.718473434448242
Epoch: 2, Steps: 10 | Train Loss: 1.097 Vali Loss: 1.326 Vali Acc: 0.378 Test Loss: 1.326 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 16.731943607330322
Epoch: 3, Steps: 10 | Train Loss: 0.560 Vali Loss: 1.194 Vali Acc: 0.459 Test Loss: 1.194 Test Acc: 0.459
Validation loss decreased (-0.391879 --> -0.459448).  Saving model ...
Epoch: 4 cost time: 15.250877618789673
Epoch: 4, Steps: 10 | Train Loss: 0.269 Vali Loss: 1.104 Vali Acc: 0.527 Test Loss: 1.104 Test Acc: 0.527
Validation loss decreased (-0.459448 --> -0.527016).  Saving model ...
Epoch: 5 cost time: 15.148773431777954
Epoch: 5, Steps: 10 | Train Loss: 0.084 Vali Loss: 1.221 Vali Acc: 0.486 Test Loss: 1.221 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 15.038859367370605
Epoch: 6, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.159 Vali Acc: 0.554 Test Loss: 1.159 Test Acc: 0.554
Validation loss decreased (-0.527016 --> -0.554042).  Saving model ...
Epoch: 7 cost time: 15.549827814102173
Epoch: 7, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.283 Vali Acc: 0.527 Test Loss: 1.283 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 15.853252649307251
Epoch: 8, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.351 Vali Acc: 0.514 Test Loss: 1.351 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 16.804147243499756
Epoch: 9, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.305 Vali Acc: 0.541 Test Loss: 1.305 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 16.410234451293945
Epoch: 10, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.284 Vali Acc: 0.554 Test Loss: 1.284 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 16.661831855773926
Epoch: 11, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.319 Vali Acc: 0.554 Test Loss: 1.319 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 17.031654834747314
Epoch: 12, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.315 Vali Acc: 0.568 Test Loss: 1.315 Test Acc: 0.568
Validation loss decreased (-0.554042 --> -0.567554).  Saving model ...
Epoch: 13 cost time: 16.751533031463623
Epoch: 13, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.288 Vali Acc: 0.581 Test Loss: 1.288 Test Acc: 0.581
Validation loss decreased (-0.567554 --> -0.581068).  Saving model ...
Epoch: 14 cost time: 16.77178978919983
Epoch: 14, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.290 Vali Acc: 0.595 Test Loss: 1.290 Test Acc: 0.595
Validation loss decreased (-0.581068 --> -0.594582).  Saving model ...
Epoch: 15 cost time: 16.816004991531372
Epoch: 15, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.301 Vali Acc: 0.581 Test Loss: 1.301 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 15.868314027786255
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.289 Vali Acc: 0.581 Test Loss: 1.289 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 15.586605548858643
Epoch: 17, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.327 Vali Acc: 0.622 Test Loss: 1.327 Test Acc: 0.622
Validation loss decreased (-0.594582 --> -0.621608).  Saving model ...
Epoch: 18 cost time: 15.345637559890747
Epoch: 18, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.341 Vali Acc: 0.568 Test Loss: 1.341 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 15.645211696624756
Epoch: 19, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.428 Vali Acc: 0.581 Test Loss: 1.428 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 15.129462718963623
Epoch: 20, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.358 Vali Acc: 0.595 Test Loss: 1.358 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 16.32798409461975
Epoch: 21, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.327 Vali Acc: 0.608 Test Loss: 1.327 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 17.041149854660034
Epoch: 22, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.333 Vali Acc: 0.608 Test Loss: 1.333 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 17.147934675216675
Epoch: 23, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.359 Vali Acc: 0.595 Test Loss: 1.359 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 17.484297037124634
Epoch: 24, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.385 Vali Acc: 0.581 Test Loss: 1.385 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 17.351177215576172
Epoch: 25, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.380 Vali Acc: 0.581 Test Loss: 1.380 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 16.235045433044434
Epoch: 26, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.370 Vali Acc: 0.595 Test Loss: 1.370 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 16.888315200805664
Epoch: 27, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.379 Vali Acc: 0.595 Test Loss: 1.379 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm128_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 37700612
model size : 146.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm128_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 7.433210611343384
Epoch: 1, Steps: 10 | Train Loss: 1.444 Vali Loss: 1.388 Vali Acc: 0.216 Test Loss: 1.388 Test Acc: 0.216
Validation loss decreased (inf --> -0.216202).  Saving model ...
Epoch: 2 cost time: 6.491798639297485
Epoch: 2, Steps: 10 | Train Loss: 1.053 Vali Loss: 1.194 Vali Acc: 0.500 Test Loss: 1.194 Test Acc: 0.500
Validation loss decreased (-0.216202 --> -0.499988).  Saving model ...
Epoch: 3 cost time: 5.514764308929443
Epoch: 3, Steps: 10 | Train Loss: 0.533 Vali Loss: 1.159 Vali Acc: 0.486 Test Loss: 1.159 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.618057012557983
Epoch: 4, Steps: 10 | Train Loss: 0.248 Vali Loss: 1.305 Vali Acc: 0.446 Test Loss: 1.305 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.637492656707764
Epoch: 5, Steps: 10 | Train Loss: 0.071 Vali Loss: 1.058 Vali Acc: 0.595 Test Loss: 1.058 Test Acc: 0.595
Validation loss decreased (-0.499988 --> -0.594584).  Saving model ...
Epoch: 6 cost time: 5.977717638015747
Epoch: 6, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.097 Vali Acc: 0.568 Test Loss: 1.097 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.790586233139038
Epoch: 7, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.214 Vali Acc: 0.568 Test Loss: 1.214 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.412538766860962
Epoch: 8, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.321 Vali Acc: 0.541 Test Loss: 1.321 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.7348082065582275
Epoch: 9, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.179 Vali Acc: 0.554 Test Loss: 1.179 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 5.612314224243164
Epoch: 10, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.181 Vali Acc: 0.608 Test Loss: 1.181 Test Acc: 0.608
Validation loss decreased (-0.594584 --> -0.608096).  Saving model ...
Epoch: 11 cost time: 5.664085626602173
Epoch: 11, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.298 Vali Acc: 0.541 Test Loss: 1.298 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.858493328094482
Epoch: 12, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.404 Vali Acc: 0.514 Test Loss: 1.404 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.598150730133057
Epoch: 13, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.305 Vali Acc: 0.541 Test Loss: 1.305 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.913791656494141
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.268 Vali Acc: 0.541 Test Loss: 1.268 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 5.818886995315552
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.290 Vali Acc: 0.527 Test Loss: 1.290 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 5.987676382064819
Epoch: 16, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.269 Vali Acc: 0.527 Test Loss: 1.269 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 5.802860260009766
Epoch: 17, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.291 Vali Acc: 0.541 Test Loss: 1.291 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 5.824414491653442
Epoch: 18, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.291 Vali Acc: 0.554 Test Loss: 1.291 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 5.79494571685791
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.245 Vali Acc: 0.595 Test Loss: 1.245 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.9461405277252197
Epoch: 20, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.252 Vali Acc: 0.581 Test Loss: 1.252 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm128_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 11222532
model size : 45.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm128_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 8.333167552947998
Epoch: 1, Steps: 10 | Train Loss: 1.469 Vali Loss: 1.291 Vali Acc: 0.378 Test Loss: 1.291 Test Acc: 0.378
Validation loss decreased (inf --> -0.378365).  Saving model ...
Epoch: 2 cost time: 8.777513980865479
Epoch: 2, Steps: 10 | Train Loss: 1.174 Vali Loss: 1.307 Vali Acc: 0.405 Test Loss: 1.307 Test Acc: 0.405
Validation loss decreased (-0.378365 --> -0.405392).  Saving model ...
Epoch: 3 cost time: 9.52428412437439
Epoch: 3, Steps: 10 | Train Loss: 0.690 Vali Loss: 1.132 Vali Acc: 0.486 Test Loss: 1.132 Test Acc: 0.486
Validation loss decreased (-0.405392 --> -0.486475).  Saving model ...
Epoch: 4 cost time: 9.154390573501587
Epoch: 4, Steps: 10 | Train Loss: 0.413 Vali Loss: 1.031 Vali Acc: 0.486 Test Loss: 1.031 Test Acc: 0.486
Validation loss decreased (-0.486475 --> -0.486476).  Saving model ...
Epoch: 5 cost time: 9.235097408294678
Epoch: 5, Steps: 10 | Train Loss: 0.171 Vali Loss: 1.159 Vali Acc: 0.541 Test Loss: 1.159 Test Acc: 0.541
Validation loss decreased (-0.486476 --> -0.540529).  Saving model ...
Epoch: 6 cost time: 9.162092208862305
Epoch: 6, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.991 Vali Acc: 0.581 Test Loss: 0.991 Test Acc: 0.581
Validation loss decreased (-0.540529 --> -0.581071).  Saving model ...
Epoch: 7 cost time: 8.259331226348877
Epoch: 7, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.076 Vali Acc: 0.568 Test Loss: 1.076 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 7.799296140670776
Epoch: 8, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.058 Vali Acc: 0.581 Test Loss: 1.058 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 8.32554316520691
Epoch: 9, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.388 Vali Acc: 0.608 Test Loss: 1.388 Test Acc: 0.608
Validation loss decreased (-0.581071 --> -0.608094).  Saving model ...
Epoch: 10 cost time: 9.237964391708374
Epoch: 10, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.384 Vali Acc: 0.554 Test Loss: 1.384 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 9.441729068756104
Epoch: 11, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.315 Vali Acc: 0.635 Test Loss: 1.315 Test Acc: 0.635
Validation loss decreased (-0.608094 --> -0.635122).  Saving model ...
Epoch: 12 cost time: 9.405409336090088
Epoch: 12, Steps: 10 | Train Loss: 0.059 Vali Loss: 1.392 Vali Acc: 0.608 Test Loss: 1.392 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 9.527175426483154
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.160 Vali Acc: 0.595 Test Loss: 1.160 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 9.35529637336731
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.086 Vali Acc: 0.635 Test Loss: 1.086 Test Acc: 0.635
Validation loss decreased (-0.635122 --> -0.635124).  Saving model ...
Epoch: 15 cost time: 9.07764196395874
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.161 Vali Acc: 0.635 Test Loss: 1.161 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 8.375116348266602
Epoch: 16, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.220 Vali Acc: 0.608 Test Loss: 1.220 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 7.884864091873169
Epoch: 17, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.238 Vali Acc: 0.595 Test Loss: 1.238 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 8.150615930557251
Epoch: 18, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.209 Vali Acc: 0.608 Test Loss: 1.209 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 8.656901359558105
Epoch: 19, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.216 Vali Acc: 0.608 Test Loss: 1.216 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 9.465219020843506
Epoch: 20, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.205 Vali Acc: 0.622 Test Loss: 1.205 Test Acc: 0.622
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 9.668495893478394
Epoch: 21, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.229 Vali Acc: 0.608 Test Loss: 1.229 Test Acc: 0.608
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 9.400562763214111
Epoch: 22, Steps: 10 | Train Loss: 0.097 Vali Loss: 1.491 Vali Acc: 0.514 Test Loss: 1.491 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 9.15133786201477
Epoch: 23, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.327 Vali Acc: 0.622 Test Loss: 1.327 Test Acc: 0.622
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 9.663774967193604
Epoch: 24, Steps: 10 | Train Loss: 0.058 Vali Loss: 1.206 Vali Acc: 0.662 Test Loss: 1.206 Test Acc: 0.662
Validation loss decreased (-0.635124 --> -0.662150).  Saving model ...
Epoch: 25 cost time: 9.585374116897583
Epoch: 25, Steps: 10 | Train Loss: 0.071 Vali Loss: 1.402 Vali Acc: 0.568 Test Loss: 1.402 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 9.345678567886353
Epoch: 26, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.816 Vali Acc: 0.581 Test Loss: 1.816 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 9.262830972671509
Epoch: 27, Steps: 10 | Train Loss: 0.367 Vali Loss: 1.799 Vali Acc: 0.514 Test Loss: 1.799 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 9.803955078125
Epoch: 28, Steps: 10 | Train Loss: 0.117 Vali Loss: 1.992 Vali Acc: 0.527 Test Loss: 1.992 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 10.600904941558838
Epoch: 29, Steps: 10 | Train Loss: 0.115 Vali Loss: 2.671 Vali Acc: 0.514 Test Loss: 2.671 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 10.95462155342102
Epoch: 30, Steps: 10 | Train Loss: 0.808 Vali Loss: 2.369 Vali Acc: 0.568 Test Loss: 2.369 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm128_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6621621621621622
model parameter : 37700612
model size : 146.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm128_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.961235284805298
Epoch: 1, Steps: 10 | Train Loss: 1.443 Vali Loss: 1.374 Vali Acc: 0.297 Test Loss: 1.374 Test Acc: 0.297
Validation loss decreased (inf --> -0.297284).  Saving model ...
Epoch: 2 cost time: 4.396336317062378
Epoch: 2, Steps: 10 | Train Loss: 1.109 Vali Loss: 1.186 Vali Acc: 0.514 Test Loss: 1.186 Test Acc: 0.514
Validation loss decreased (-0.297284 --> -0.513502).  Saving model ...
Epoch: 3 cost time: 4.141140460968018
Epoch: 3, Steps: 10 | Train Loss: 0.650 Vali Loss: 1.165 Vali Acc: 0.459 Test Loss: 1.165 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.0319459438323975
Epoch: 4, Steps: 10 | Train Loss: 0.395 Vali Loss: 1.320 Vali Acc: 0.459 Test Loss: 1.320 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.4519898891448975
Epoch: 5, Steps: 10 | Train Loss: 0.149 Vali Loss: 1.036 Vali Acc: 0.541 Test Loss: 1.036 Test Acc: 0.541
Validation loss decreased (-0.513502 --> -0.540530).  Saving model ...
Epoch: 6 cost time: 3.704298496246338
Epoch: 6, Steps: 10 | Train Loss: 0.053 Vali Loss: 1.021 Vali Acc: 0.554 Test Loss: 1.021 Test Acc: 0.554
Validation loss decreased (-0.540530 --> -0.554044).  Saving model ...
Epoch: 7 cost time: 4.017306327819824
Epoch: 7, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.284 Vali Acc: 0.581 Test Loss: 1.284 Test Acc: 0.581
Validation loss decreased (-0.554044 --> -0.581068).  Saving model ...
Epoch: 8 cost time: 3.8172080516815186
Epoch: 8, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.128 Vali Acc: 0.581 Test Loss: 1.128 Test Acc: 0.581
Validation loss decreased (-0.581068 --> -0.581070).  Saving model ...
Epoch: 9 cost time: 3.8482632637023926
Epoch: 9, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.120 Vali Acc: 0.595 Test Loss: 1.120 Test Acc: 0.595
Validation loss decreased (-0.581070 --> -0.594583).  Saving model ...
Epoch: 10 cost time: 4.122630596160889
Epoch: 10, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.243 Vali Acc: 0.622 Test Loss: 1.243 Test Acc: 0.622
Validation loss decreased (-0.594583 --> -0.621609).  Saving model ...
Epoch: 11 cost time: 3.714063882827759
Epoch: 11, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.053 Vali Acc: 0.595 Test Loss: 1.053 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.722761869430542
Epoch: 12, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.273 Vali Acc: 0.581 Test Loss: 1.273 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.722463369369507
Epoch: 13, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.156 Vali Acc: 0.595 Test Loss: 1.156 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.355461359024048
Epoch: 14, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.187 Vali Acc: 0.581 Test Loss: 1.187 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 4.799706935882568
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.327 Vali Acc: 0.581 Test Loss: 1.327 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 4.174339294433594
Epoch: 16, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.377 Vali Acc: 0.595 Test Loss: 1.377 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 4.264749050140381
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.088 Vali Acc: 0.635 Test Loss: 1.088 Test Acc: 0.635
Validation loss decreased (-0.621609 --> -0.635124).  Saving model ...
Epoch: 18 cost time: 4.372616767883301
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.123 Vali Acc: 0.622 Test Loss: 1.123 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.141783714294434
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.182 Vali Acc: 0.635 Test Loss: 1.182 Test Acc: 0.635
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.340512037277222
Epoch: 20, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.188 Vali Acc: 0.635 Test Loss: 1.188 Test Acc: 0.635
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 4.365540266036987
Epoch: 21, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.186 Vali Acc: 0.622 Test Loss: 1.186 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 4.199488639831543
Epoch: 22, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.188 Vali Acc: 0.622 Test Loss: 1.188 Test Acc: 0.622
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 4.671814918518066
Epoch: 23, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.194 Vali Acc: 0.622 Test Loss: 1.194 Test Acc: 0.622
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 4.144880294799805
Epoch: 24, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.543 Vali Acc: 0.568 Test Loss: 1.543 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 4.444202184677124
Epoch: 25, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.350 Vali Acc: 0.635 Test Loss: 1.350 Test Acc: 0.635
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 3.9138553142547607
Epoch: 26, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.455 Vali Acc: 0.622 Test Loss: 1.455 Test Acc: 0.622
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 3.7130329608917236
Epoch: 27, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.865 Vali Acc: 0.568 Test Loss: 1.865 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm128_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6351351351351351
model parameter : 11222532
model size : 45.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm128_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 12.860336065292358
Epoch: 1, Steps: 10 | Train Loss: 1.406 Vali Loss: 1.410 Vali Acc: 0.311 Test Loss: 1.410 Test Acc: 0.311
Validation loss decreased (inf --> -0.310797).  Saving model ...
Epoch: 2 cost time: 13.0353524684906
Epoch: 2, Steps: 10 | Train Loss: 1.065 Vali Loss: 1.245 Vali Acc: 0.432 Test Loss: 1.245 Test Acc: 0.432
Validation loss decreased (-0.310797 --> -0.432420).  Saving model ...
Epoch: 3 cost time: 13.14648723602295
Epoch: 3, Steps: 10 | Train Loss: 0.584 Vali Loss: 1.102 Vali Acc: 0.568 Test Loss: 1.102 Test Acc: 0.568
Validation loss decreased (-0.432420 --> -0.567557).  Saving model ...
Epoch: 4 cost time: 12.893779277801514
Epoch: 4, Steps: 10 | Train Loss: 0.249 Vali Loss: 1.253 Vali Acc: 0.486 Test Loss: 1.253 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 12.984720468521118
Epoch: 5, Steps: 10 | Train Loss: 0.090 Vali Loss: 1.102 Vali Acc: 0.581 Test Loss: 1.102 Test Acc: 0.581
Validation loss decreased (-0.567557 --> -0.581070).  Saving model ...
Epoch: 6 cost time: 12.95894980430603
Epoch: 6, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.095 Vali Acc: 0.581 Test Loss: 1.095 Test Acc: 0.581
Validation loss decreased (-0.581070 --> -0.581070).  Saving model ...
Epoch: 7 cost time: 11.491055965423584
Epoch: 7, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.239 Vali Acc: 0.541 Test Loss: 1.239 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 11.519628524780273
Epoch: 8, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.286 Vali Acc: 0.595 Test Loss: 1.286 Test Acc: 0.595
Validation loss decreased (-0.581070 --> -0.594582).  Saving model ...
Epoch: 9 cost time: 11.496317386627197
Epoch: 9, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.230 Vali Acc: 0.622 Test Loss: 1.230 Test Acc: 0.622
Validation loss decreased (-0.594582 --> -0.621609).  Saving model ...
Epoch: 10 cost time: 13.519594669342041
Epoch: 10, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.270 Vali Acc: 0.568 Test Loss: 1.270 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 13.071026802062988
Epoch: 11, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.336 Vali Acc: 0.568 Test Loss: 1.336 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 13.270471572875977
Epoch: 12, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.322 Vali Acc: 0.568 Test Loss: 1.322 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 12.71822190284729
Epoch: 13, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.284 Vali Acc: 0.568 Test Loss: 1.284 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 11.740870714187622
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.285 Vali Acc: 0.568 Test Loss: 1.285 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 10.618961811065674
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.299 Vali Acc: 0.554 Test Loss: 1.299 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 10.360490560531616
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.303 Vali Acc: 0.554 Test Loss: 1.303 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 10.62296462059021
Epoch: 17, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.316 Vali Acc: 0.554 Test Loss: 1.316 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 11.695247650146484
Epoch: 18, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.312 Vali Acc: 0.554 Test Loss: 1.312 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 12.361449480056763
Epoch: 19, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.306 Vali Acc: 0.554 Test Loss: 1.306 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm128_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 18955780
model size : 74.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm128_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 6.193419933319092
Epoch: 1, Steps: 10 | Train Loss: 1.430 Vali Loss: 1.323 Vali Acc: 0.351 Test Loss: 1.323 Test Acc: 0.351
Validation loss decreased (inf --> -0.351338).  Saving model ...
Epoch: 2 cost time: 4.7665088176727295
Epoch: 2, Steps: 10 | Train Loss: 1.112 Vali Loss: 1.257 Vali Acc: 0.419 Test Loss: 1.257 Test Acc: 0.419
Validation loss decreased (-0.351338 --> -0.418906).  Saving model ...
Epoch: 3 cost time: 4.927941799163818
Epoch: 3, Steps: 10 | Train Loss: 0.647 Vali Loss: 1.136 Vali Acc: 0.500 Test Loss: 1.136 Test Acc: 0.500
Validation loss decreased (-0.418906 --> -0.499989).  Saving model ...
Epoch: 4 cost time: 4.281810998916626
Epoch: 4, Steps: 10 | Train Loss: 0.336 Vali Loss: 1.215 Vali Acc: 0.527 Test Loss: 1.215 Test Acc: 0.527
Validation loss decreased (-0.499989 --> -0.527015).  Saving model ...
Epoch: 5 cost time: 4.222158432006836
Epoch: 5, Steps: 10 | Train Loss: 0.144 Vali Loss: 1.046 Vali Acc: 0.541 Test Loss: 1.046 Test Acc: 0.541
Validation loss decreased (-0.527015 --> -0.540530).  Saving model ...
Epoch: 6 cost time: 4.226185083389282
Epoch: 6, Steps: 10 | Train Loss: 0.041 Vali Loss: 1.167 Vali Acc: 0.554 Test Loss: 1.167 Test Acc: 0.554
Validation loss decreased (-0.540530 --> -0.554042).  Saving model ...
Epoch: 7 cost time: 4.00976824760437
Epoch: 7, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.100 Vali Acc: 0.541 Test Loss: 1.100 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.441832065582275
Epoch: 8, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.213 Vali Acc: 0.581 Test Loss: 1.213 Test Acc: 0.581
Validation loss decreased (-0.554042 --> -0.581069).  Saving model ...
Epoch: 9 cost time: 4.333598852157593
Epoch: 9, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.148 Vali Acc: 0.595 Test Loss: 1.148 Test Acc: 0.595
Validation loss decreased (-0.581069 --> -0.594583).  Saving model ...
Epoch: 10 cost time: 4.095223665237427
Epoch: 10, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.205 Vali Acc: 0.568 Test Loss: 1.205 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.827171564102173
Epoch: 11, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.248 Vali Acc: 0.554 Test Loss: 1.248 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.958486318588257
Epoch: 12, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.235 Vali Acc: 0.554 Test Loss: 1.235 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.963446140289307
Epoch: 13, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.223 Vali Acc: 0.541 Test Loss: 1.223 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.936110973358154
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.233 Vali Acc: 0.554 Test Loss: 1.233 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.871128082275391
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.254 Vali Acc: 0.568 Test Loss: 1.254 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.830268144607544
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.263 Vali Acc: 0.568 Test Loss: 1.263 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 4.764524221420288
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.259 Vali Acc: 0.568 Test Loss: 1.259 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 4.874000787734985
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.264 Vali Acc: 0.568 Test Loss: 1.264 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 4.776278018951416
Epoch: 19, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.265 Vali Acc: 0.568 Test Loss: 1.265 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm128_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 5716484
model size : 24.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm128_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 9.078550338745117
Epoch: 1, Steps: 10 | Train Loss: 1.409 Vali Loss: 1.410 Vali Acc: 0.297 Test Loss: 1.410 Test Acc: 0.297
Validation loss decreased (inf --> -0.297283).  Saving model ...
Epoch: 2 cost time: 7.860839605331421
Epoch: 2, Steps: 10 | Train Loss: 1.076 Vali Loss: 1.259 Vali Acc: 0.392 Test Loss: 1.259 Test Acc: 0.392
Validation loss decreased (-0.297283 --> -0.391879).  Saving model ...
Epoch: 3 cost time: 7.700915098190308
Epoch: 3, Steps: 10 | Train Loss: 0.586 Vali Loss: 1.085 Vali Acc: 0.595 Test Loss: 1.085 Test Acc: 0.595
Validation loss decreased (-0.391879 --> -0.594584).  Saving model ...
Epoch: 4 cost time: 8.95175290107727
Epoch: 4, Steps: 10 | Train Loss: 0.243 Vali Loss: 1.199 Vali Acc: 0.500 Test Loss: 1.199 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 9.371396780014038
Epoch: 5, Steps: 10 | Train Loss: 0.095 Vali Loss: 1.077 Vali Acc: 0.514 Test Loss: 1.077 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 8.98960018157959
Epoch: 6, Steps: 10 | Train Loss: 0.043 Vali Loss: 1.080 Vali Acc: 0.595 Test Loss: 1.080 Test Acc: 0.595
Validation loss decreased (-0.594584 --> -0.594584).  Saving model ...
Epoch: 7 cost time: 8.7190842628479
Epoch: 7, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.454 Vali Acc: 0.514 Test Loss: 1.454 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 8.662419080734253
Epoch: 8, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.281 Vali Acc: 0.554 Test Loss: 1.281 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 8.791917324066162
Epoch: 9, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.253 Vali Acc: 0.541 Test Loss: 1.253 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 7.269776344299316
Epoch: 10, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.422 Vali Acc: 0.514 Test Loss: 1.422 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 7.528394460678101
Epoch: 11, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.379 Vali Acc: 0.527 Test Loss: 1.379 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 7.14075779914856
Epoch: 12, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.412 Vali Acc: 0.554 Test Loss: 1.412 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 6.75944709777832
Epoch: 13, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.371 Vali Acc: 0.514 Test Loss: 1.371 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 8.980844736099243
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.377 Vali Acc: 0.527 Test Loss: 1.377 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 9.567437171936035
Epoch: 15, Steps: 10 | Train Loss: 0.005 Vali Loss: 2.114 Vali Acc: 0.459 Test Loss: 2.114 Test Acc: 0.459
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 9.859005689620972
Epoch: 16, Steps: 10 | Train Loss: 0.052 Vali Loss: 1.634 Vali Acc: 0.514 Test Loss: 1.634 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm128_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 18955780
model size : 74.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm128_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.46137809753418
Epoch: 1, Steps: 10 | Train Loss: 1.430 Vali Loss: 1.320 Vali Acc: 0.311 Test Loss: 1.320 Test Acc: 0.311
Validation loss decreased (inf --> -0.310798).  Saving model ...
Epoch: 2 cost time: 3.7770395278930664
Epoch: 2, Steps: 10 | Train Loss: 1.115 Vali Loss: 1.246 Vali Acc: 0.432 Test Loss: 1.246 Test Acc: 0.432
Validation loss decreased (-0.310798 --> -0.432420).  Saving model ...
Epoch: 3 cost time: 3.8265769481658936
Epoch: 3, Steps: 10 | Train Loss: 0.652 Vali Loss: 1.117 Vali Acc: 0.541 Test Loss: 1.117 Test Acc: 0.541
Validation loss decreased (-0.432420 --> -0.540529).  Saving model ...
Epoch: 4 cost time: 4.169525623321533
Epoch: 4, Steps: 10 | Train Loss: 0.346 Vali Loss: 1.213 Vali Acc: 0.527 Test Loss: 1.213 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.2902324199676514
Epoch: 5, Steps: 10 | Train Loss: 0.151 Vali Loss: 1.035 Vali Acc: 0.514 Test Loss: 1.035 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.313199043273926
Epoch: 6, Steps: 10 | Train Loss: 0.055 Vali Loss: 1.223 Vali Acc: 0.541 Test Loss: 1.223 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.3453240394592285
Epoch: 7, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.051 Vali Acc: 0.581 Test Loss: 1.051 Test Acc: 0.581
Validation loss decreased (-0.540529 --> -0.581071).  Saving model ...
Epoch: 8 cost time: 3.3816943168640137
Epoch: 8, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.148 Vali Acc: 0.581 Test Loss: 1.148 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.100066661834717
Epoch: 9, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.053 Vali Acc: 0.649 Test Loss: 1.053 Test Acc: 0.649
Validation loss decreased (-0.581071 --> -0.648638).  Saving model ...
Epoch: 10 cost time: 3.3340935707092285
Epoch: 10, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.239 Vali Acc: 0.568 Test Loss: 1.239 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.573394298553467
Epoch: 11, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.206 Vali Acc: 0.581 Test Loss: 1.206 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.3748013973236084
Epoch: 12, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.172 Vali Acc: 0.622 Test Loss: 1.172 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.0242655277252197
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.165 Vali Acc: 0.554 Test Loss: 1.165 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.7567694187164307
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.187 Vali Acc: 0.581 Test Loss: 1.187 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.756417751312256
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.257 Vali Acc: 0.581 Test Loss: 1.257 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.6878623962402344
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.269 Vali Acc: 0.568 Test Loss: 1.269 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.7319555282592773
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.212 Vali Acc: 0.608 Test Loss: 1.212 Test Acc: 0.608
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 4.060870885848999
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.273 Vali Acc: 0.608 Test Loss: 1.273 Test Acc: 0.608
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.7105085849761963
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.339 Vali Acc: 0.581 Test Loss: 1.339 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm128_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6486486486486487
model parameter : 5716484
model size : 24.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm128_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 7.199002504348755
Epoch: 1, Steps: 10 | Train Loss: 1.411 Vali Loss: 1.406 Vali Acc: 0.297 Test Loss: 1.406 Test Acc: 0.297
Validation loss decreased (inf --> -0.297283).  Saving model ...
Epoch: 2 cost time: 6.146155834197998
Epoch: 2, Steps: 10 | Train Loss: 1.109 Vali Loss: 1.236 Vali Acc: 0.405 Test Loss: 1.236 Test Acc: 0.405
Validation loss decreased (-0.297283 --> -0.405393).  Saving model ...
Epoch: 3 cost time: 4.995365858078003
Epoch: 3, Steps: 10 | Train Loss: 0.679 Vali Loss: 1.091 Vali Acc: 0.554 Test Loss: 1.091 Test Acc: 0.554
Validation loss decreased (-0.405393 --> -0.554043).  Saving model ...
Epoch: 4 cost time: 5.058172941207886
Epoch: 4, Steps: 10 | Train Loss: 0.326 Vali Loss: 1.183 Vali Acc: 0.527 Test Loss: 1.183 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.106987476348877
Epoch: 5, Steps: 10 | Train Loss: 0.149 Vali Loss: 0.985 Vali Acc: 0.595 Test Loss: 0.985 Test Acc: 0.595
Validation loss decreased (-0.554043 --> -0.594585).  Saving model ...
Epoch: 6 cost time: 5.133427381515503
Epoch: 6, Steps: 10 | Train Loss: 0.050 Vali Loss: 1.008 Vali Acc: 0.595 Test Loss: 1.008 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.247275352478027
Epoch: 7, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.105 Vali Acc: 0.568 Test Loss: 1.105 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.34769606590271
Epoch: 8, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.088 Vali Acc: 0.608 Test Loss: 1.088 Test Acc: 0.608
Validation loss decreased (-0.594585 --> -0.608097).  Saving model ...
Epoch: 9 cost time: 6.122612714767456
Epoch: 9, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.139 Vali Acc: 0.608 Test Loss: 1.139 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.826347351074219
Epoch: 10, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.131 Vali Acc: 0.622 Test Loss: 1.131 Test Acc: 0.622
Validation loss decreased (-0.608097 --> -0.621610).  Saving model ...
Epoch: 11 cost time: 6.03165340423584
Epoch: 11, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.121 Vali Acc: 0.635 Test Loss: 1.121 Test Acc: 0.635
Validation loss decreased (-0.621610 --> -0.635124).  Saving model ...
Epoch: 12 cost time: 5.889173269271851
Epoch: 12, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.136 Vali Acc: 0.622 Test Loss: 1.136 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.8906683921813965
Epoch: 13, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.139 Vali Acc: 0.622 Test Loss: 1.139 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 6.219354152679443
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.146 Vali Acc: 0.622 Test Loss: 1.146 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.8531904220581055
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.143 Vali Acc: 0.635 Test Loss: 1.143 Test Acc: 0.635
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 5.878641366958618
Epoch: 16, Steps: 10 | Train Loss: 0.076 Vali Loss: 1.158 Vali Acc: 0.595 Test Loss: 1.158 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 5.6889448165893555
Epoch: 17, Steps: 10 | Train Loss: 0.273 Vali Loss: 1.164 Vali Acc: 0.595 Test Loss: 1.164 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 5.278826713562012
Epoch: 18, Steps: 10 | Train Loss: 0.010 Vali Loss: 2.332 Vali Acc: 0.459 Test Loss: 2.332 Test Acc: 0.459
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 5.360929250717163
Epoch: 19, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.409 Vali Acc: 0.554 Test Loss: 1.409 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 4.9086949825286865
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.737 Vali Acc: 0.568 Test Loss: 1.737 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 5.023759365081787
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.612 Vali Acc: 0.568 Test Loss: 1.612 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm128_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6351351351351351
model parameter : 18955780
model size : 74.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm128_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.9359652996063232
Epoch: 1, Steps: 10 | Train Loss: 1.429 Vali Loss: 1.325 Vali Acc: 0.311 Test Loss: 1.325 Test Acc: 0.311
Validation loss decreased (inf --> -0.310798).  Saving model ...
Epoch: 2 cost time: 2.7371861934661865
Epoch: 2, Steps: 10 | Train Loss: 1.137 Vali Loss: 1.245 Vali Acc: 0.419 Test Loss: 1.245 Test Acc: 0.419
Validation loss decreased (-0.310798 --> -0.418906).  Saving model ...
Epoch: 3 cost time: 2.9230380058288574
Epoch: 3, Steps: 10 | Train Loss: 0.702 Vali Loss: 1.127 Vali Acc: 0.541 Test Loss: 1.127 Test Acc: 0.541
Validation loss decreased (-0.418906 --> -0.540529).  Saving model ...
Epoch: 4 cost time: 2.7192957401275635
Epoch: 4, Steps: 10 | Train Loss: 0.388 Vali Loss: 1.166 Vali Acc: 0.541 Test Loss: 1.166 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.5826005935668945
Epoch: 5, Steps: 10 | Train Loss: 0.187 Vali Loss: 1.066 Vali Acc: 0.554 Test Loss: 1.066 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554043).  Saving model ...
Epoch: 6 cost time: 2.7712574005126953
Epoch: 6, Steps: 10 | Train Loss: 0.065 Vali Loss: 1.111 Vali Acc: 0.554 Test Loss: 1.111 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.377620220184326
Epoch: 7, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.150 Vali Acc: 0.581 Test Loss: 1.150 Test Acc: 0.581
Validation loss decreased (-0.554043 --> -0.581070).  Saving model ...
Epoch: 8 cost time: 2.267693519592285
Epoch: 8, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.111 Vali Acc: 0.608 Test Loss: 1.111 Test Acc: 0.608
Validation loss decreased (-0.581070 --> -0.608097).  Saving model ...
Epoch: 9 cost time: 2.39123272895813
Epoch: 9, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.136 Vali Acc: 0.595 Test Loss: 1.136 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.498408794403076
Epoch: 10, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.278 Vali Acc: 0.568 Test Loss: 1.278 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.521566152572632
Epoch: 11, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.181 Vali Acc: 0.595 Test Loss: 1.181 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.5456738471984863
Epoch: 12, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.180 Vali Acc: 0.595 Test Loss: 1.180 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.5234735012054443
Epoch: 13, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.215 Vali Acc: 0.608 Test Loss: 1.215 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.1482887268066406
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.223 Vali Acc: 0.608 Test Loss: 1.223 Test Acc: 0.608
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.258453130722046
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.226 Vali Acc: 0.608 Test Loss: 1.226 Test Acc: 0.608
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.335101366043091
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.224 Vali Acc: 0.608 Test Loss: 1.224 Test Acc: 0.608
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.492595672607422
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.228 Vali Acc: 0.608 Test Loss: 1.228 Test Acc: 0.608
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.2855923175811768
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.237 Vali Acc: 0.608 Test Loss: 1.237 Test Acc: 0.608
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm128_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 5716484
model size : 24.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm64_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 15.13243579864502
Epoch: 1, Steps: 10 | Train Loss: 1.438 Vali Loss: 1.386 Vali Acc: 0.297 Test Loss: 1.386 Test Acc: 0.297
Validation loss decreased (inf --> -0.297283).  Saving model ...
Epoch: 2 cost time: 13.920592308044434
Epoch: 2, Steps: 10 | Train Loss: 1.207 Vali Loss: 1.241 Vali Acc: 0.459 Test Loss: 1.241 Test Acc: 0.459
Validation loss decreased (-0.297283 --> -0.459447).  Saving model ...
Epoch: 3 cost time: 14.029338359832764
Epoch: 3, Steps: 10 | Train Loss: 0.866 Vali Loss: 1.140 Vali Acc: 0.541 Test Loss: 1.140 Test Acc: 0.541
Validation loss decreased (-0.459447 --> -0.540529).  Saving model ...
Epoch: 4 cost time: 13.819431781768799
Epoch: 4, Steps: 10 | Train Loss: 0.537 Vali Loss: 1.005 Vali Acc: 0.649 Test Loss: 1.005 Test Acc: 0.649
Validation loss decreased (-0.540529 --> -0.648639).  Saving model ...
Epoch: 5 cost time: 11.701386451721191
Epoch: 5, Steps: 10 | Train Loss: 0.319 Vali Loss: 0.950 Vali Acc: 0.622 Test Loss: 0.950 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 11.248167276382446
Epoch: 6, Steps: 10 | Train Loss: 0.149 Vali Loss: 1.040 Vali Acc: 0.541 Test Loss: 1.040 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 11.988231420516968
Epoch: 7, Steps: 10 | Train Loss: 0.060 Vali Loss: 1.074 Vali Acc: 0.622 Test Loss: 1.074 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 13.368411302566528
Epoch: 8, Steps: 10 | Train Loss: 0.036 Vali Loss: 1.263 Vali Acc: 0.568 Test Loss: 1.263 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 14.013410806655884
Epoch: 9, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.971 Vali Acc: 0.676 Test Loss: 0.971 Test Acc: 0.676
Validation loss decreased (-0.648639 --> -0.675666).  Saving model ...
Epoch: 10 cost time: 13.620111465454102
Epoch: 10, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.874 Vali Acc: 0.703 Test Loss: 0.874 Test Acc: 0.703
Validation loss decreased (-0.675666 --> -0.702694).  Saving model ...
Epoch: 11 cost time: 13.858785629272461
Epoch: 11, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.861 Vali Acc: 0.730 Test Loss: 0.861 Test Acc: 0.730
Validation loss decreased (-0.702694 --> -0.729721).  Saving model ...
Epoch: 12 cost time: 11.242094993591309
Epoch: 12, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.935 Vali Acc: 0.703 Test Loss: 0.935 Test Acc: 0.703
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 11.361862897872925
Epoch: 13, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.953 Vali Acc: 0.716 Test Loss: 0.953 Test Acc: 0.716
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 11.93367052078247
Epoch: 14, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.947 Vali Acc: 0.716 Test Loss: 0.947 Test Acc: 0.716
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 13.477930545806885
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.970 Vali Acc: 0.703 Test Loss: 0.970 Test Acc: 0.703
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 13.892921209335327
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.973 Vali Acc: 0.703 Test Loss: 0.973 Test Acc: 0.703
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 13.7886962890625
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.984 Vali Acc: 0.703 Test Loss: 0.984 Test Acc: 0.703
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 13.224376440048218
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.986 Vali Acc: 0.703 Test Loss: 0.986 Test Acc: 0.703
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 13.292196035385132
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.982 Vali Acc: 0.716 Test Loss: 0.982 Test Acc: 0.716
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 12.647720336914062
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.995 Vali Acc: 0.716 Test Loss: 0.995 Test Acc: 0.716
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 12.645960569381714
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.998 Vali Acc: 0.730 Test Loss: 0.998 Test Acc: 0.730
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm64_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.7297297297297297
model parameter : 18851844
model size : 73.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm64_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 7.275397777557373
Epoch: 1, Steps: 10 | Train Loss: 1.442 Vali Loss: 1.343 Vali Acc: 0.311 Test Loss: 1.343 Test Acc: 0.311
Validation loss decreased (inf --> -0.310797).  Saving model ...
Epoch: 2 cost time: 5.563371181488037
Epoch: 2, Steps: 10 | Train Loss: 1.219 Vali Loss: 1.246 Vali Acc: 0.473 Test Loss: 1.246 Test Acc: 0.473
Validation loss decreased (-0.310797 --> -0.472961).  Saving model ...
Epoch: 3 cost time: 5.6110029220581055
Epoch: 3, Steps: 10 | Train Loss: 0.866 Vali Loss: 1.098 Vali Acc: 0.622 Test Loss: 1.098 Test Acc: 0.622
Validation loss decreased (-0.472961 --> -0.621611).  Saving model ...
Epoch: 4 cost time: 5.5254926681518555
Epoch: 4, Steps: 10 | Train Loss: 0.537 Vali Loss: 1.096 Vali Acc: 0.541 Test Loss: 1.096 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.392191410064697
Epoch: 5, Steps: 10 | Train Loss: 0.317 Vali Loss: 0.996 Vali Acc: 0.649 Test Loss: 0.996 Test Acc: 0.649
Validation loss decreased (-0.621611 --> -0.648639).  Saving model ...
Epoch: 6 cost time: 5.393635988235474
Epoch: 6, Steps: 10 | Train Loss: 0.140 Vali Loss: 0.946 Vali Acc: 0.608 Test Loss: 0.946 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.406167984008789
Epoch: 7, Steps: 10 | Train Loss: 0.062 Vali Loss: 1.064 Vali Acc: 0.541 Test Loss: 1.064 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.407393932342529
Epoch: 8, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.887 Vali Acc: 0.635 Test Loss: 0.887 Test Acc: 0.635
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.7729880809783936
Epoch: 9, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.826 Vali Acc: 0.662 Test Loss: 0.826 Test Acc: 0.662
Validation loss decreased (-0.648639 --> -0.662154).  Saving model ...
Epoch: 10 cost time: 4.727134943008423
Epoch: 10, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.902 Vali Acc: 0.622 Test Loss: 0.902 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.719147205352783
Epoch: 11, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.868 Vali Acc: 0.635 Test Loss: 0.868 Test Acc: 0.635
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.686751842498779
Epoch: 12, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.906 Vali Acc: 0.649 Test Loss: 0.906 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.700367450714111
Epoch: 13, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.911 Vali Acc: 0.622 Test Loss: 0.911 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.529423713684082
Epoch: 14, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.878 Vali Acc: 0.635 Test Loss: 0.878 Test Acc: 0.635
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 5.34990930557251
Epoch: 15, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.902 Vali Acc: 0.662 Test Loss: 0.902 Test Acc: 0.662
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 5.547792673110962
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.015 Vali Acc: 0.635 Test Loss: 1.015 Test Acc: 0.635
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 5.611976385116577
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.917 Vali Acc: 0.622 Test Loss: 0.917 Test Acc: 0.622
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 5.451598167419434
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.904 Vali Acc: 0.649 Test Loss: 0.904 Test Acc: 0.649
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 5.545679092407227
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.054 Vali Acc: 0.622 Test Loss: 1.054 Test Acc: 0.622
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm64_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6621621621621622
model parameter : 5612292
model size : 22.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm64_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 11.759461879730225
Epoch: 1, Steps: 10 | Train Loss: 1.441 Vali Loss: 1.383 Vali Acc: 0.297 Test Loss: 1.383 Test Acc: 0.297
Validation loss decreased (inf --> -0.297283).  Saving model ...
Epoch: 2 cost time: 9.573540210723877
Epoch: 2, Steps: 10 | Train Loss: 1.213 Vali Loss: 1.249 Vali Acc: 0.446 Test Loss: 1.249 Test Acc: 0.446
Validation loss decreased (-0.297283 --> -0.445933).  Saving model ...
Epoch: 3 cost time: 9.219306707382202
Epoch: 3, Steps: 10 | Train Loss: 0.873 Vali Loss: 1.136 Vali Acc: 0.554 Test Loss: 1.136 Test Acc: 0.554
Validation loss decreased (-0.445933 --> -0.554043).  Saving model ...
Epoch: 4 cost time: 8.849182844161987
Epoch: 4, Steps: 10 | Train Loss: 0.551 Vali Loss: 1.040 Vali Acc: 0.622 Test Loss: 1.040 Test Acc: 0.622
Validation loss decreased (-0.554043 --> -0.621611).  Saving model ...
Epoch: 5 cost time: 8.84226131439209
Epoch: 5, Steps: 10 | Train Loss: 0.320 Vali Loss: 0.968 Vali Acc: 0.622 Test Loss: 0.968 Test Acc: 0.622
Validation loss decreased (-0.621611 --> -0.621612).  Saving model ...
Epoch: 6 cost time: 10.293110847473145
Epoch: 6, Steps: 10 | Train Loss: 0.157 Vali Loss: 0.904 Vali Acc: 0.676 Test Loss: 0.904 Test Acc: 0.676
Validation loss decreased (-0.621612 --> -0.675667).  Saving model ...
Epoch: 7 cost time: 10.654712915420532
Epoch: 7, Steps: 10 | Train Loss: 0.080 Vali Loss: 1.073 Vali Acc: 0.608 Test Loss: 1.073 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 9.615638256072998
Epoch: 8, Steps: 10 | Train Loss: 0.054 Vali Loss: 1.045 Vali Acc: 0.608 Test Loss: 1.045 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 9.801015138626099
Epoch: 9, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.045 Vali Acc: 0.608 Test Loss: 1.045 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 10.010302066802979
Epoch: 10, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.961 Vali Acc: 0.608 Test Loss: 0.961 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 9.912540674209595
Epoch: 11, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.194 Vali Acc: 0.595 Test Loss: 1.194 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 8.789685010910034
Epoch: 12, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.021 Vali Acc: 0.662 Test Loss: 1.021 Test Acc: 0.662
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 8.35004186630249
Epoch: 13, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.935 Vali Acc: 0.581 Test Loss: 0.935 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 8.321197032928467
Epoch: 14, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.099 Vali Acc: 0.676 Test Loss: 1.099 Test Acc: 0.676
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 8.408229351043701
Epoch: 15, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.303 Vali Acc: 0.608 Test Loss: 1.303 Test Acc: 0.608
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 9.836809635162354
Epoch: 16, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.167 Vali Acc: 0.608 Test Loss: 1.167 Test Acc: 0.608
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm64_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6756756756756757
model parameter : 18851844
model size : 73.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm64_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.204869270324707
Epoch: 1, Steps: 10 | Train Loss: 1.441 Vali Loss: 1.343 Vali Acc: 0.324 Test Loss: 1.343 Test Acc: 0.324
Validation loss decreased (inf --> -0.324311).  Saving model ...
Epoch: 2 cost time: 3.923140525817871
Epoch: 2, Steps: 10 | Train Loss: 1.213 Vali Loss: 1.251 Vali Acc: 0.486 Test Loss: 1.251 Test Acc: 0.486
Validation loss decreased (-0.324311 --> -0.486474).  Saving model ...
Epoch: 3 cost time: 3.8945202827453613
Epoch: 3, Steps: 10 | Train Loss: 0.861 Vali Loss: 1.101 Vali Acc: 0.581 Test Loss: 1.101 Test Acc: 0.581
Validation loss decreased (-0.486474 --> -0.581070).  Saving model ...
Epoch: 4 cost time: 3.828747272491455
Epoch: 4, Steps: 10 | Train Loss: 0.527 Vali Loss: 1.109 Vali Acc: 0.486 Test Loss: 1.109 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.739854574203491
Epoch: 5, Steps: 10 | Train Loss: 0.314 Vali Loss: 1.003 Vali Acc: 0.608 Test Loss: 1.003 Test Acc: 0.608
Validation loss decreased (-0.581070 --> -0.608098).  Saving model ...
Epoch: 6 cost time: 3.224241018295288
Epoch: 6, Steps: 10 | Train Loss: 0.138 Vali Loss: 0.976 Vali Acc: 0.595 Test Loss: 0.976 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.4225385189056396
Epoch: 7, Steps: 10 | Train Loss: 0.069 Vali Loss: 1.025 Vali Acc: 0.541 Test Loss: 1.025 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.346648931503296
Epoch: 8, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.912 Vali Acc: 0.581 Test Loss: 0.912 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.4150450229644775
Epoch: 9, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.852 Vali Acc: 0.662 Test Loss: 0.852 Test Acc: 0.662
Validation loss decreased (-0.608098 --> -0.662154).  Saving model ...
Epoch: 10 cost time: 3.329336643218994
Epoch: 10, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.959 Vali Acc: 0.595 Test Loss: 0.959 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.365262269973755
Epoch: 11, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.995 Vali Acc: 0.649 Test Loss: 0.995 Test Acc: 0.649
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.3718996047973633
Epoch: 12, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.909 Vali Acc: 0.649 Test Loss: 0.909 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.1613502502441406
Epoch: 13, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.880 Vali Acc: 0.676 Test Loss: 0.880 Test Acc: 0.676
Validation loss decreased (-0.662154 --> -0.675667).  Saving model ...
Epoch: 14 cost time: 3.9364724159240723
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.899 Vali Acc: 0.662 Test Loss: 0.899 Test Acc: 0.662
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.8615939617156982
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.924 Vali Acc: 0.649 Test Loss: 0.924 Test Acc: 0.649
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.831620693206787
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.929 Vali Acc: 0.649 Test Loss: 0.929 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.822784900665283
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.924 Vali Acc: 0.649 Test Loss: 0.924 Test Acc: 0.649
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.8108606338500977
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.910 Vali Acc: 0.662 Test Loss: 0.910 Test Acc: 0.662
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.8277218341827393
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.920 Vali Acc: 0.649 Test Loss: 0.920 Test Acc: 0.649
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.763362407684326
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.929 Vali Acc: 0.649 Test Loss: 0.929 Test Acc: 0.649
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.9299991130828857
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.939 Vali Acc: 0.622 Test Loss: 0.939 Test Acc: 0.622
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 3.931734800338745
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.886 Vali Acc: 0.689 Test Loss: 0.886 Test Acc: 0.689
Validation loss decreased (-0.675667 --> -0.689180).  Saving model ...
Epoch: 23 cost time: 3.927661895751953
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.901 Vali Acc: 0.689 Test Loss: 0.901 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.9547853469848633
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.929 Vali Acc: 0.676 Test Loss: 0.929 Test Acc: 0.676
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.341916561126709
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.940 Vali Acc: 0.676 Test Loss: 0.940 Test Acc: 0.676
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.425992727279663
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.913 Vali Acc: 0.689 Test Loss: 0.913 Test Acc: 0.689
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 3.2085442543029785
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.913 Vali Acc: 0.649 Test Loss: 0.913 Test Acc: 0.649
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 3.36173415184021
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.928 Vali Acc: 0.676 Test Loss: 0.928 Test Acc: 0.676
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 3.136026620864868
Epoch: 29, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.474 Vali Acc: 0.608 Test Loss: 1.474 Test Acc: 0.608
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 3.348499059677124
Epoch: 30, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.955 Vali Acc: 0.662 Test Loss: 0.955 Test Acc: 0.662
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm64_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6891891891891891
model parameter : 5612292
model size : 22.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm64_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 8.290217876434326
Epoch: 1, Steps: 10 | Train Loss: 1.436 Vali Loss: 1.382 Vali Acc: 0.284 Test Loss: 1.382 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 6.986621856689453
Epoch: 2, Steps: 10 | Train Loss: 1.244 Vali Loss: 1.250 Vali Acc: 0.486 Test Loss: 1.250 Test Acc: 0.486
Validation loss decreased (-0.283770 --> -0.486474).  Saving model ...
Epoch: 3 cost time: 6.8051769733428955
Epoch: 3, Steps: 10 | Train Loss: 0.956 Vali Loss: 1.124 Vali Acc: 0.608 Test Loss: 1.124 Test Acc: 0.608
Validation loss decreased (-0.486474 --> -0.608097).  Saving model ...
Epoch: 4 cost time: 7.037974834442139
Epoch: 4, Steps: 10 | Train Loss: 0.642 Vali Loss: 1.026 Vali Acc: 0.608 Test Loss: 1.026 Test Acc: 0.608
Validation loss decreased (-0.608097 --> -0.608098).  Saving model ...
Epoch: 5 cost time: 6.731997966766357
Epoch: 5, Steps: 10 | Train Loss: 0.415 Vali Loss: 0.925 Vali Acc: 0.649 Test Loss: 0.925 Test Acc: 0.649
Validation loss decreased (-0.608098 --> -0.648639).  Saving model ...
Epoch: 6 cost time: 6.4827728271484375
Epoch: 6, Steps: 10 | Train Loss: 0.222 Vali Loss: 0.934 Vali Acc: 0.608 Test Loss: 0.934 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.254173755645752
Epoch: 7, Steps: 10 | Train Loss: 0.107 Vali Loss: 1.085 Vali Acc: 0.608 Test Loss: 1.085 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.019347190856934
Epoch: 8, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.957 Vali Acc: 0.649 Test Loss: 0.957 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 6.293230772018433
Epoch: 9, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.894 Vali Acc: 0.622 Test Loss: 0.894 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 5.577129125595093
Epoch: 10, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.888 Vali Acc: 0.662 Test Loss: 0.888 Test Acc: 0.662
Validation loss decreased (-0.648639 --> -0.662153).  Saving model ...
Epoch: 11 cost time: 5.940481901168823
Epoch: 11, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.984 Vali Acc: 0.649 Test Loss: 0.984 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.956293821334839
Epoch: 12, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.972 Vali Acc: 0.622 Test Loss: 0.972 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.771702527999878
Epoch: 13, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.963 Vali Acc: 0.635 Test Loss: 0.963 Test Acc: 0.635
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 7.003477096557617
Epoch: 14, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.019 Vali Acc: 0.649 Test Loss: 1.019 Test Acc: 0.649
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 6.797428131103516
Epoch: 15, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.048 Vali Acc: 0.649 Test Loss: 1.048 Test Acc: 0.649
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 7.031508922576904
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.008 Vali Acc: 0.649 Test Loss: 1.008 Test Acc: 0.649
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 6.799451589584351
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.054 Vali Acc: 0.649 Test Loss: 1.054 Test Acc: 0.649
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 6.885730266571045
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.050 Vali Acc: 0.649 Test Loss: 1.050 Test Acc: 0.649
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 6.796923398971558
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.043 Vali Acc: 0.662 Test Loss: 1.043 Test Acc: 0.662
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 6.684767484664917
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.072 Vali Acc: 0.662 Test Loss: 1.072 Test Acc: 0.662
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm64_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6621621621621622
model parameter : 18851844
model size : 73.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm64_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.054133892059326
Epoch: 1, Steps: 10 | Train Loss: 1.445 Vali Loss: 1.353 Vali Acc: 0.324 Test Loss: 1.353 Test Acc: 0.324
Validation loss decreased (inf --> -0.324311).  Saving model ...
Epoch: 2 cost time: 2.524050712585449
Epoch: 2, Steps: 10 | Train Loss: 1.248 Vali Loss: 1.259 Vali Acc: 0.446 Test Loss: 1.259 Test Acc: 0.446
Validation loss decreased (-0.324311 --> -0.445933).  Saving model ...
Epoch: 3 cost time: 2.56008243560791
Epoch: 3, Steps: 10 | Train Loss: 0.956 Vali Loss: 1.116 Vali Acc: 0.541 Test Loss: 1.116 Test Acc: 0.541
Validation loss decreased (-0.445933 --> -0.540529).  Saving model ...
Epoch: 4 cost time: 2.7162482738494873
Epoch: 4, Steps: 10 | Train Loss: 0.640 Vali Loss: 1.099 Vali Acc: 0.486 Test Loss: 1.099 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.7097902297973633
Epoch: 5, Steps: 10 | Train Loss: 0.426 Vali Loss: 0.999 Vali Acc: 0.581 Test Loss: 0.999 Test Acc: 0.581
Validation loss decreased (-0.540529 --> -0.581071).  Saving model ...
Epoch: 6 cost time: 2.703810453414917
Epoch: 6, Steps: 10 | Train Loss: 0.228 Vali Loss: 0.964 Vali Acc: 0.581 Test Loss: 0.964 Test Acc: 0.581
Validation loss decreased (-0.581071 --> -0.581071).  Saving model ...
Epoch: 7 cost time: 3.0091161727905273
Epoch: 7, Steps: 10 | Train Loss: 0.121 Vali Loss: 1.037 Vali Acc: 0.554 Test Loss: 1.037 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.966973304748535
Epoch: 8, Steps: 10 | Train Loss: 0.073 Vali Loss: 0.922 Vali Acc: 0.608 Test Loss: 0.922 Test Acc: 0.608
Validation loss decreased (-0.581071 --> -0.608099).  Saving model ...
Epoch: 9 cost time: 3.045118570327759
Epoch: 9, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.901 Vali Acc: 0.635 Test Loss: 0.901 Test Acc: 0.635
Validation loss decreased (-0.608099 --> -0.635126).  Saving model ...
Epoch: 10 cost time: 3.1180245876312256
Epoch: 10, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.873 Vali Acc: 0.635 Test Loss: 0.873 Test Acc: 0.635
Validation loss decreased (-0.635126 --> -0.635126).  Saving model ...
Epoch: 11 cost time: 2.9951834678649902
Epoch: 11, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.846 Vali Acc: 0.635 Test Loss: 0.846 Test Acc: 0.635
Validation loss decreased (-0.635126 --> -0.635127).  Saving model ...
Epoch: 12 cost time: 3.0469677448272705
Epoch: 12, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.909 Vali Acc: 0.662 Test Loss: 0.909 Test Acc: 0.662
Validation loss decreased (-0.635127 --> -0.662153).  Saving model ...
Epoch: 13 cost time: 2.9626128673553467
Epoch: 13, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.841 Vali Acc: 0.595 Test Loss: 0.841 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.045928955078125
Epoch: 14, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.887 Vali Acc: 0.649 Test Loss: 0.887 Test Acc: 0.649
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.0746052265167236
Epoch: 15, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.911 Vali Acc: 0.662 Test Loss: 0.911 Test Acc: 0.662
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.2140591144561768
Epoch: 16, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.890 Vali Acc: 0.635 Test Loss: 0.890 Test Acc: 0.635
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.107956647872925
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.897 Vali Acc: 0.649 Test Loss: 0.897 Test Acc: 0.649
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.1297900676727295
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.893 Vali Acc: 0.649 Test Loss: 0.893 Test Acc: 0.649
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.1215097904205322
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.952 Vali Acc: 0.676 Test Loss: 0.952 Test Acc: 0.676
Validation loss decreased (-0.662153 --> -0.675666).  Saving model ...
Epoch: 20 cost time: 3.0621538162231445
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.904 Vali Acc: 0.662 Test Loss: 0.904 Test Acc: 0.662
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.458630323410034
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.891 Vali Acc: 0.622 Test Loss: 0.891 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.7809510231018066
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.921 Vali Acc: 0.635 Test Loss: 0.921 Test Acc: 0.635
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.668165683746338
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.974 Vali Acc: 0.649 Test Loss: 0.974 Test Acc: 0.649
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.708033561706543
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.967 Vali Acc: 0.662 Test Loss: 0.967 Test Acc: 0.662
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.7326250076293945
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.947 Vali Acc: 0.662 Test Loss: 0.947 Test Acc: 0.662
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.6928153038024902
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.945 Vali Acc: 0.649 Test Loss: 0.945 Test Acc: 0.649
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.7379181385040283
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.969 Vali Acc: 0.662 Test Loss: 0.969 Test Acc: 0.662
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.6779918670654297
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.002 Vali Acc: 0.649 Test Loss: 1.002 Test Acc: 0.649
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.7523281574249268
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.997 Vali Acc: 0.662 Test Loss: 0.997 Test Acc: 0.662
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm64_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6756756756756757
model parameter : 5612292
model size : 22.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm64_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 10.00326919555664
Epoch: 1, Steps: 10 | Train Loss: 1.390 Vali Loss: 1.349 Vali Acc: 0.392 Test Loss: 1.349 Test Acc: 0.392
Validation loss decreased (inf --> -0.391878).  Saving model ...
Epoch: 2 cost time: 8.354830265045166
Epoch: 2, Steps: 10 | Train Loss: 1.194 Vali Loss: 1.235 Vali Acc: 0.486 Test Loss: 1.235 Test Acc: 0.486
Validation loss decreased (-0.391878 --> -0.486474).  Saving model ...
Epoch: 3 cost time: 8.047971963882446
Epoch: 3, Steps: 10 | Train Loss: 0.857 Vali Loss: 1.152 Vali Acc: 0.500 Test Loss: 1.152 Test Acc: 0.500
Validation loss decreased (-0.486474 --> -0.499988).  Saving model ...
Epoch: 4 cost time: 8.293408870697021
Epoch: 4, Steps: 10 | Train Loss: 0.555 Vali Loss: 1.211 Vali Acc: 0.527 Test Loss: 1.211 Test Acc: 0.527
Validation loss decreased (-0.499988 --> -0.527015).  Saving model ...
Epoch: 5 cost time: 8.238035440444946
Epoch: 5, Steps: 10 | Train Loss: 0.346 Vali Loss: 1.085 Vali Acc: 0.541 Test Loss: 1.085 Test Acc: 0.541
Validation loss decreased (-0.527015 --> -0.540530).  Saving model ...
Epoch: 6 cost time: 7.327357292175293
Epoch: 6, Steps: 10 | Train Loss: 0.162 Vali Loss: 1.273 Vali Acc: 0.500 Test Loss: 1.273 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 7.026483058929443
Epoch: 7, Steps: 10 | Train Loss: 0.075 Vali Loss: 1.030 Vali Acc: 0.541 Test Loss: 1.030 Test Acc: 0.541
Validation loss decreased (-0.540530 --> -0.540530).  Saving model ...
Epoch: 8 cost time: 6.98293662071228
Epoch: 8, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.124 Vali Acc: 0.581 Test Loss: 1.124 Test Acc: 0.581
Validation loss decreased (-0.540530 --> -0.581070).  Saving model ...
Epoch: 9 cost time: 7.138688325881958
Epoch: 9, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.053 Vali Acc: 0.608 Test Loss: 1.053 Test Acc: 0.608
Validation loss decreased (-0.581070 --> -0.608098).  Saving model ...
Epoch: 10 cost time: 7.1541032791137695
Epoch: 10, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.079 Vali Acc: 0.608 Test Loss: 1.079 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.781874179840088
Epoch: 11, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.209 Vali Acc: 0.595 Test Loss: 1.209 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 8.053740978240967
Epoch: 12, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.045 Vali Acc: 0.635 Test Loss: 1.045 Test Acc: 0.635
Validation loss decreased (-0.608098 --> -0.635125).  Saving model ...
Epoch: 13 cost time: 8.034277439117432
Epoch: 13, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.043 Vali Acc: 0.595 Test Loss: 1.043 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 7.949643850326538
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.065 Vali Acc: 0.595 Test Loss: 1.065 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 7.989577054977417
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.081 Vali Acc: 0.622 Test Loss: 1.081 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 8.126227140426636
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.085 Vali Acc: 0.622 Test Loss: 1.085 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 7.98731541633606
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.079 Vali Acc: 0.608 Test Loss: 1.079 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 6.4005982875823975
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.070 Vali Acc: 0.608 Test Loss: 1.070 Test Acc: 0.608
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 6.842625617980957
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.072 Vali Acc: 0.622 Test Loss: 1.072 Test Acc: 0.622
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 6.518072843551636
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.071 Vali Acc: 0.622 Test Loss: 1.071 Test Acc: 0.622
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 6.85515832901001
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.070 Vali Acc: 0.635 Test Loss: 1.070 Test Acc: 0.635
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 6.644630670547485
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.079 Vali Acc: 0.649 Test Loss: 1.079 Test Acc: 0.649
Validation loss decreased (-0.635125 --> -0.648638).  Saving model ...
Epoch: 23 cost time: 7.791923999786377
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.089 Vali Acc: 0.649 Test Loss: 1.089 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 7.650958776473999
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.092 Vali Acc: 0.635 Test Loss: 1.092 Test Acc: 0.635
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 7.845520734786987
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.101 Vali Acc: 0.635 Test Loss: 1.101 Test Acc: 0.635
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 8.075387716293335
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.091 Vali Acc: 0.635 Test Loss: 1.091 Test Acc: 0.635
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 7.865514516830444
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.091 Vali Acc: 0.635 Test Loss: 1.091 Test Acc: 0.635
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 8.090339660644531
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.094 Vali Acc: 0.635 Test Loss: 1.094 Test Acc: 0.635
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 8.073647022247314
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.102 Vali Acc: 0.635 Test Loss: 1.102 Test Acc: 0.635
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 6.819746732711792
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.113 Vali Acc: 0.635 Test Loss: 1.113 Test Acc: 0.635
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm64_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6486486486486487
model parameter : 9478660
model size : 37.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm64_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.382893323898315
Epoch: 1, Steps: 10 | Train Loss: 1.455 Vali Loss: 1.400 Vali Acc: 0.297 Test Loss: 1.400 Test Acc: 0.297
Validation loss decreased (inf --> -0.297283).  Saving model ...
Epoch: 2 cost time: 3.0291008949279785
Epoch: 2, Steps: 10 | Train Loss: 1.244 Vali Loss: 1.365 Vali Acc: 0.365 Test Loss: 1.365 Test Acc: 0.365
Validation loss decreased (-0.297283 --> -0.364851).  Saving model ...
Epoch: 3 cost time: 3.146698236465454
Epoch: 3, Steps: 10 | Train Loss: 0.926 Vali Loss: 1.193 Vali Acc: 0.446 Test Loss: 1.193 Test Acc: 0.446
Validation loss decreased (-0.364851 --> -0.445934).  Saving model ...
Epoch: 4 cost time: 3.3428046703338623
Epoch: 4, Steps: 10 | Train Loss: 0.613 Vali Loss: 1.205 Vali Acc: 0.527 Test Loss: 1.205 Test Acc: 0.527
Validation loss decreased (-0.445934 --> -0.527015).  Saving model ...
Epoch: 5 cost time: 3.3041062355041504
Epoch: 5, Steps: 10 | Train Loss: 0.392 Vali Loss: 1.080 Vali Acc: 0.473 Test Loss: 1.080 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.351555585861206
Epoch: 6, Steps: 10 | Train Loss: 0.227 Vali Loss: 1.198 Vali Acc: 0.527 Test Loss: 1.198 Test Acc: 0.527
Validation loss decreased (-0.527015 --> -0.527015).  Saving model ...
Epoch: 7 cost time: 3.258291721343994
Epoch: 7, Steps: 10 | Train Loss: 0.104 Vali Loss: 1.051 Vali Acc: 0.554 Test Loss: 1.051 Test Acc: 0.554
Validation loss decreased (-0.527015 --> -0.554044).  Saving model ...
Epoch: 8 cost time: 3.3917481899261475
Epoch: 8, Steps: 10 | Train Loss: 0.048 Vali Loss: 1.060 Vali Acc: 0.568 Test Loss: 1.060 Test Acc: 0.568
Validation loss decreased (-0.554044 --> -0.567557).  Saving model ...
Epoch: 9 cost time: 3.4320149421691895
Epoch: 9, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.048 Vali Acc: 0.554 Test Loss: 1.048 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.444486379623413
Epoch: 10, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.121 Vali Acc: 0.541 Test Loss: 1.121 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.4666225910186768
Epoch: 11, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.115 Vali Acc: 0.541 Test Loss: 1.115 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.329629898071289
Epoch: 12, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.075 Vali Acc: 0.554 Test Loss: 1.075 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.3431990146636963
Epoch: 13, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.079 Vali Acc: 0.541 Test Loss: 1.079 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.483325958251953
Epoch: 14, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.088 Vali Acc: 0.554 Test Loss: 1.088 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.3349595069885254
Epoch: 15, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.087 Vali Acc: 0.568 Test Loss: 1.087 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.8776192665100098
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.081 Vali Acc: 0.568 Test Loss: 1.081 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.9377546310424805
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.081 Vali Acc: 0.581 Test Loss: 1.081 Test Acc: 0.581
Validation loss decreased (-0.567557 --> -0.581070).  Saving model ...
Epoch: 18 cost time: 2.9070663452148438
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.081 Vali Acc: 0.581 Test Loss: 1.081 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.982877016067505
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.091 Vali Acc: 0.595 Test Loss: 1.091 Test Acc: 0.595
Validation loss decreased (-0.581070 --> -0.594584).  Saving model ...
Epoch: 20 cost time: 2.5541207790374756
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.091 Vali Acc: 0.568 Test Loss: 1.091 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.8676726818084717
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.086 Vali Acc: 0.581 Test Loss: 1.086 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.926743268966675
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.095 Vali Acc: 0.581 Test Loss: 1.095 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.973696708679199
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.097 Vali Acc: 0.581 Test Loss: 1.097 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.7535572052001953
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.091 Vali Acc: 0.595 Test Loss: 1.091 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 3.3713788986206055
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.093 Vali Acc: 0.581 Test Loss: 1.093 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 3.455869674682617
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.093 Vali Acc: 0.581 Test Loss: 1.093 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 3.439211368560791
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.105 Vali Acc: 0.595 Test Loss: 1.105 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 3.4834609031677246
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.106 Vali Acc: 0.608 Test Loss: 1.106 Test Acc: 0.608
Validation loss decreased (-0.594584 --> -0.608097).  Saving model ...
Epoch: 29 cost time: 3.427807331085205
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.107 Vali Acc: 0.608 Test Loss: 1.107 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.3009235858917236
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.108 Vali Acc: 0.608 Test Loss: 1.108 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm64_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 2858756
model size : 12.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm64_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 6.51447606086731
Epoch: 1, Steps: 10 | Train Loss: 1.392 Vali Loss: 1.348 Vali Acc: 0.392 Test Loss: 1.348 Test Acc: 0.392
Validation loss decreased (inf --> -0.391878).  Saving model ...
Epoch: 2 cost time: 6.184492588043213
Epoch: 2, Steps: 10 | Train Loss: 1.193 Vali Loss: 1.239 Vali Acc: 0.432 Test Loss: 1.239 Test Acc: 0.432
Validation loss decreased (-0.391878 --> -0.432420).  Saving model ...
Epoch: 3 cost time: 5.479191064834595
Epoch: 3, Steps: 10 | Train Loss: 0.854 Vali Loss: 1.168 Vali Acc: 0.554 Test Loss: 1.168 Test Acc: 0.554
Validation loss decreased (-0.432420 --> -0.554042).  Saving model ...
Epoch: 4 cost time: 5.110437870025635
Epoch: 4, Steps: 10 | Train Loss: 0.561 Vali Loss: 1.181 Vali Acc: 0.541 Test Loss: 1.181 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.8540260791778564
Epoch: 5, Steps: 10 | Train Loss: 0.339 Vali Loss: 1.081 Vali Acc: 0.581 Test Loss: 1.081 Test Acc: 0.581
Validation loss decreased (-0.554042 --> -0.581070).  Saving model ...
Epoch: 6 cost time: 5.437727212905884
Epoch: 6, Steps: 10 | Train Loss: 0.152 Vali Loss: 1.166 Vali Acc: 0.554 Test Loss: 1.166 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.31641149520874
Epoch: 7, Steps: 10 | Train Loss: 0.066 Vali Loss: 1.045 Vali Acc: 0.595 Test Loss: 1.045 Test Acc: 0.595
Validation loss decreased (-0.581070 --> -0.594584).  Saving model ...
Epoch: 8 cost time: 4.527456521987915
Epoch: 8, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.986 Vali Acc: 0.608 Test Loss: 0.986 Test Acc: 0.608
Validation loss decreased (-0.594584 --> -0.608098).  Saving model ...
Epoch: 9 cost time: 5.386510372161865
Epoch: 9, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.082 Vali Acc: 0.635 Test Loss: 1.082 Test Acc: 0.635
Validation loss decreased (-0.608098 --> -0.635124).  Saving model ...
Epoch: 10 cost time: 5.451711416244507
Epoch: 10, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.043 Vali Acc: 0.595 Test Loss: 1.043 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.797351360321045
Epoch: 11, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.044 Vali Acc: 0.635 Test Loss: 1.044 Test Acc: 0.635
Validation loss decreased (-0.635124 --> -0.635125).  Saving model ...
Epoch: 12 cost time: 4.2326600551605225
Epoch: 12, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.039 Vali Acc: 0.622 Test Loss: 1.039 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.088709831237793
Epoch: 13, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.072 Vali Acc: 0.649 Test Loss: 1.072 Test Acc: 0.649
Validation loss decreased (-0.635125 --> -0.648638).  Saving model ...
Epoch: 14 cost time: 3.826838493347168
Epoch: 14, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.032 Vali Acc: 0.649 Test Loss: 1.032 Test Acc: 0.649
Validation loss decreased (-0.648638 --> -0.648638).  Saving model ...
Epoch: 15 cost time: 4.84917688369751
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.018 Vali Acc: 0.662 Test Loss: 1.018 Test Acc: 0.662
Validation loss decreased (-0.648638 --> -0.662152).  Saving model ...
Epoch: 16 cost time: 6.255439758300781
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.032 Vali Acc: 0.635 Test Loss: 1.032 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 6.152358770370483
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.041 Vali Acc: 0.662 Test Loss: 1.041 Test Acc: 0.662
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 6.3200905323028564
Epoch: 18, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.118 Vali Acc: 0.595 Test Loss: 1.118 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 6.348898649215698
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.142 Vali Acc: 0.622 Test Loss: 1.142 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 6.484004497528076
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.162 Vali Acc: 0.595 Test Loss: 1.162 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 6.357666730880737
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.029 Vali Acc: 0.662 Test Loss: 1.029 Test Acc: 0.662
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 6.229643821716309
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.044 Vali Acc: 0.649 Test Loss: 1.044 Test Acc: 0.649
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 6.585161209106445
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.099 Vali Acc: 0.662 Test Loss: 1.099 Test Acc: 0.662
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 6.123201370239258
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.130 Vali Acc: 0.649 Test Loss: 1.130 Test Acc: 0.649
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 6.2283034324646
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.129 Vali Acc: 0.649 Test Loss: 1.129 Test Acc: 0.649
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm64_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6621621621621622
model parameter : 9478660
model size : 37.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm64_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.130021572113037
Epoch: 1, Steps: 10 | Train Loss: 1.454 Vali Loss: 1.402 Vali Acc: 0.311 Test Loss: 1.402 Test Acc: 0.311
Validation loss decreased (inf --> -0.310797).  Saving model ...
Epoch: 2 cost time: 2.481370687484741
Epoch: 2, Steps: 10 | Train Loss: 1.243 Vali Loss: 1.367 Vali Acc: 0.392 Test Loss: 1.367 Test Acc: 0.392
Validation loss decreased (-0.310797 --> -0.391878).  Saving model ...
Epoch: 3 cost time: 2.496389150619507
Epoch: 3, Steps: 10 | Train Loss: 0.926 Vali Loss: 1.193 Vali Acc: 0.446 Test Loss: 1.193 Test Acc: 0.446
Validation loss decreased (-0.391878 --> -0.445934).  Saving model ...
Epoch: 4 cost time: 2.3590481281280518
Epoch: 4, Steps: 10 | Train Loss: 0.613 Vali Loss: 1.205 Vali Acc: 0.500 Test Loss: 1.205 Test Acc: 0.500
Validation loss decreased (-0.445934 --> -0.499988).  Saving model ...
Epoch: 5 cost time: 2.401174545288086
Epoch: 5, Steps: 10 | Train Loss: 0.394 Vali Loss: 1.073 Vali Acc: 0.527 Test Loss: 1.073 Test Acc: 0.527
Validation loss decreased (-0.499988 --> -0.527016).  Saving model ...
Epoch: 6 cost time: 2.447542190551758
Epoch: 6, Steps: 10 | Train Loss: 0.230 Vali Loss: 1.182 Vali Acc: 0.514 Test Loss: 1.182 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.27722430229187
Epoch: 7, Steps: 10 | Train Loss: 0.103 Vali Loss: 1.040 Vali Acc: 0.541 Test Loss: 1.040 Test Acc: 0.541
Validation loss decreased (-0.527016 --> -0.540530).  Saving model ...
Epoch: 8 cost time: 2.5635104179382324
Epoch: 8, Steps: 10 | Train Loss: 0.047 Vali Loss: 1.019 Vali Acc: 0.554 Test Loss: 1.019 Test Acc: 0.554
Validation loss decreased (-0.540530 --> -0.554044).  Saving model ...
Epoch: 9 cost time: 2.5764245986938477
Epoch: 9, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.027 Vali Acc: 0.541 Test Loss: 1.027 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.338329792022705
Epoch: 10, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.118 Vali Acc: 0.541 Test Loss: 1.118 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.4321014881134033
Epoch: 11, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.070 Vali Acc: 0.581 Test Loss: 1.070 Test Acc: 0.581
Validation loss decreased (-0.554044 --> -0.581070).  Saving model ...
Epoch: 12 cost time: 2.419738292694092
Epoch: 12, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.043 Vali Acc: 0.581 Test Loss: 1.043 Test Acc: 0.581
Validation loss decreased (-0.581070 --> -0.581071).  Saving model ...
Epoch: 13 cost time: 2.340867280960083
Epoch: 13, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.061 Vali Acc: 0.568 Test Loss: 1.061 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.803865432739258
Epoch: 14, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.073 Vali Acc: 0.554 Test Loss: 1.073 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.6787452697753906
Epoch: 15, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.068 Vali Acc: 0.581 Test Loss: 1.068 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.907209634780884
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.064 Vali Acc: 0.595 Test Loss: 1.064 Test Acc: 0.595
Validation loss decreased (-0.581071 --> -0.594584).  Saving model ...
Epoch: 17 cost time: 2.8058807849884033
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.063 Vali Acc: 0.595 Test Loss: 1.063 Test Acc: 0.595
Validation loss decreased (-0.594584 --> -0.594584).  Saving model ...
Epoch: 18 cost time: 2.759915590286255
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.031 Vali Acc: 0.581 Test Loss: 1.031 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.7814650535583496
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.160 Vali Acc: 0.581 Test Loss: 1.160 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.8971927165985107
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.075 Vali Acc: 0.581 Test Loss: 1.075 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.901963710784912
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.084 Vali Acc: 0.568 Test Loss: 1.084 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.837867021560669
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.138 Vali Acc: 0.608 Test Loss: 1.138 Test Acc: 0.608
Validation loss decreased (-0.594584 --> -0.608097).  Saving model ...
Epoch: 23 cost time: 2.7719805240631104
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.144 Vali Acc: 0.608 Test Loss: 1.144 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.7162094116210938
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.128 Vali Acc: 0.595 Test Loss: 1.128 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.052760124206543
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.138 Vali Acc: 0.595 Test Loss: 1.138 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.844766855239868
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.137 Vali Acc: 0.595 Test Loss: 1.137 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.8747549057006836
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.146 Vali Acc: 0.595 Test Loss: 1.146 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.814058780670166
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.146 Vali Acc: 0.595 Test Loss: 1.146 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 2.8419578075408936
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.147 Vali Acc: 0.581 Test Loss: 1.147 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 2.864885091781616
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.149 Vali Acc: 0.581 Test Loss: 1.149 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm64_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 2858756
model size : 12.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm64_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.583055019378662
Epoch: 1, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.347 Vali Acc: 0.365 Test Loss: 1.347 Test Acc: 0.365
Validation loss decreased (inf --> -0.364851).  Saving model ...
Epoch: 2 cost time: 3.9977540969848633
Epoch: 2, Steps: 10 | Train Loss: 1.233 Vali Loss: 1.236 Vali Acc: 0.486 Test Loss: 1.236 Test Acc: 0.486
Validation loss decreased (-0.364851 --> -0.486474).  Saving model ...
Epoch: 3 cost time: 3.183899164199829
Epoch: 3, Steps: 10 | Train Loss: 0.942 Vali Loss: 1.150 Vali Acc: 0.514 Test Loss: 1.150 Test Acc: 0.514
Validation loss decreased (-0.486474 --> -0.513502).  Saving model ...
Epoch: 4 cost time: 3.175414562225342
Epoch: 4, Steps: 10 | Train Loss: 0.668 Vali Loss: 1.149 Vali Acc: 0.541 Test Loss: 1.149 Test Acc: 0.541
Validation loss decreased (-0.513502 --> -0.540529).  Saving model ...
Epoch: 5 cost time: 3.5315628051757812
Epoch: 5, Steps: 10 | Train Loss: 0.467 Vali Loss: 1.026 Vali Acc: 0.581 Test Loss: 1.026 Test Acc: 0.581
Validation loss decreased (-0.540529 --> -0.581071).  Saving model ...
Epoch: 6 cost time: 3.1788504123687744
Epoch: 6, Steps: 10 | Train Loss: 0.268 Vali Loss: 1.175 Vali Acc: 0.541 Test Loss: 1.175 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.518221616744995
Epoch: 7, Steps: 10 | Train Loss: 0.148 Vali Loss: 0.940 Vali Acc: 0.568 Test Loss: 0.940 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.2801191806793213
Epoch: 8, Steps: 10 | Train Loss: 0.065 Vali Loss: 1.020 Vali Acc: 0.581 Test Loss: 1.020 Test Acc: 0.581
Validation loss decreased (-0.581071 --> -0.581071).  Saving model ...
Epoch: 9 cost time: 3.7147152423858643
Epoch: 9, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.916 Vali Acc: 0.622 Test Loss: 0.916 Test Acc: 0.622
Validation loss decreased (-0.581071 --> -0.621612).  Saving model ...
Epoch: 10 cost time: 3.331207513809204
Epoch: 10, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.999 Vali Acc: 0.622 Test Loss: 0.999 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.9666709899902344
Epoch: 11, Steps: 10 | Train Loss: 0.078 Vali Loss: 0.935 Vali Acc: 0.649 Test Loss: 0.935 Test Acc: 0.649
Validation loss decreased (-0.621612 --> -0.648639).  Saving model ...
Epoch: 12 cost time: 4.111207962036133
Epoch: 12, Steps: 10 | Train Loss: 0.065 Vali Loss: 0.936 Vali Acc: 0.635 Test Loss: 0.936 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.024142742156982
Epoch: 13, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.972 Vali Acc: 0.608 Test Loss: 0.972 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.0393452644348145
Epoch: 14, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.952 Vali Acc: 0.622 Test Loss: 0.952 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.03835391998291
Epoch: 15, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.040 Vali Acc: 0.608 Test Loss: 1.040 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.9932398796081543
Epoch: 16, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.944 Vali Acc: 0.635 Test Loss: 0.944 Test Acc: 0.635
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 4.118157863616943
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.947 Vali Acc: 0.622 Test Loss: 0.947 Test Acc: 0.622
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 4.114696741104126
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.976 Vali Acc: 0.622 Test Loss: 0.976 Test Acc: 0.622
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.9125592708587646
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.926 Vali Acc: 0.635 Test Loss: 0.926 Test Acc: 0.635
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 4.062151193618774
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.936 Vali Acc: 0.649 Test Loss: 0.936 Test Acc: 0.649
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 3.927401304244995
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.017 Vali Acc: 0.635 Test Loss: 1.017 Test Acc: 0.635
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm64_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6486486486486487
model parameter : 9478660
model size : 37.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm64_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.3949882984161377
Epoch: 1, Steps: 10 | Train Loss: 1.459 Vali Loss: 1.388 Vali Acc: 0.338 Test Loss: 1.388 Test Acc: 0.338
Validation loss decreased (inf --> -0.337824).  Saving model ...
Epoch: 2 cost time: 1.9314918518066406
Epoch: 2, Steps: 10 | Train Loss: 1.268 Vali Loss: 1.358 Vali Acc: 0.351 Test Loss: 1.358 Test Acc: 0.351
Validation loss decreased (-0.337824 --> -0.351338).  Saving model ...
Epoch: 3 cost time: 1.9758179187774658
Epoch: 3, Steps: 10 | Train Loss: 0.982 Vali Loss: 1.194 Vali Acc: 0.446 Test Loss: 1.194 Test Acc: 0.446
Validation loss decreased (-0.351338 --> -0.445934).  Saving model ...
Epoch: 4 cost time: 1.9190680980682373
Epoch: 4, Steps: 10 | Train Loss: 0.695 Vali Loss: 1.205 Vali Acc: 0.500 Test Loss: 1.205 Test Acc: 0.500
Validation loss decreased (-0.445934 --> -0.499988).  Saving model ...
Epoch: 5 cost time: 1.8882875442504883
Epoch: 5, Steps: 10 | Train Loss: 0.515 Vali Loss: 1.071 Vali Acc: 0.527 Test Loss: 1.071 Test Acc: 0.527
Validation loss decreased (-0.499988 --> -0.527016).  Saving model ...
Epoch: 6 cost time: 1.6982347965240479
Epoch: 6, Steps: 10 | Train Loss: 0.317 Vali Loss: 1.155 Vali Acc: 0.514 Test Loss: 1.155 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.727853775024414
Epoch: 7, Steps: 10 | Train Loss: 0.172 Vali Loss: 1.039 Vali Acc: 0.527 Test Loss: 1.039 Test Acc: 0.527
Validation loss decreased (-0.527016 --> -0.527017).  Saving model ...
Epoch: 8 cost time: 1.679152250289917
Epoch: 8, Steps: 10 | Train Loss: 0.083 Vali Loss: 1.022 Vali Acc: 0.581 Test Loss: 1.022 Test Acc: 0.581
Validation loss decreased (-0.527017 --> -0.581071).  Saving model ...
Epoch: 9 cost time: 1.6340131759643555
Epoch: 9, Steps: 10 | Train Loss: 0.036 Vali Loss: 1.081 Vali Acc: 0.554 Test Loss: 1.081 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7036113739013672
Epoch: 10, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.064 Vali Acc: 0.568 Test Loss: 1.064 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.612715482711792
Epoch: 11, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.085 Vali Acc: 0.554 Test Loss: 1.085 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.7047762870788574
Epoch: 12, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.070 Vali Acc: 0.581 Test Loss: 1.070 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.710345983505249
Epoch: 13, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.046 Vali Acc: 0.595 Test Loss: 1.046 Test Acc: 0.595
Validation loss decreased (-0.581071 --> -0.594584).  Saving model ...
Epoch: 14 cost time: 1.671621322631836
Epoch: 14, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.063 Vali Acc: 0.608 Test Loss: 1.063 Test Acc: 0.608
Validation loss decreased (-0.594584 --> -0.608097).  Saving model ...
Epoch: 15 cost time: 1.7804617881774902
Epoch: 15, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.082 Vali Acc: 0.595 Test Loss: 1.082 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.7224624156951904
Epoch: 16, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.081 Vali Acc: 0.608 Test Loss: 1.081 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.652219295501709
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.072 Vali Acc: 0.622 Test Loss: 1.072 Test Acc: 0.622
Validation loss decreased (-0.608097 --> -0.621611).  Saving model ...
Epoch: 18 cost time: 1.7940309047698975
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.071 Vali Acc: 0.622 Test Loss: 1.071 Test Acc: 0.622
Validation loss decreased (-0.621611 --> -0.621611).  Saving model ...
Epoch: 19 cost time: 1.7419981956481934
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.093 Vali Acc: 0.635 Test Loss: 1.093 Test Acc: 0.635
Validation loss decreased (-0.621611 --> -0.635124).  Saving model ...
Epoch: 20 cost time: 1.7099392414093018
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.092 Vali Acc: 0.608 Test Loss: 1.092 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.007570505142212
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.085 Vali Acc: 0.595 Test Loss: 1.085 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.9949562549591064
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.094 Vali Acc: 0.622 Test Loss: 1.094 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.0088183879852295
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.103 Vali Acc: 0.635 Test Loss: 1.103 Test Acc: 0.635
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.8909530639648438
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.097 Vali Acc: 0.622 Test Loss: 1.097 Test Acc: 0.622
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.9411661624908447
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.105 Vali Acc: 0.635 Test Loss: 1.105 Test Acc: 0.635
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.9496502876281738
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.111 Vali Acc: 0.635 Test Loss: 1.111 Test Acc: 0.635
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.917142391204834
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.127 Vali Acc: 0.622 Test Loss: 1.127 Test Acc: 0.622
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.022037982940674
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.124 Vali Acc: 0.635 Test Loss: 1.124 Test Acc: 0.635
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.052304744720459
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.123 Vali Acc: 0.635 Test Loss: 1.123 Test Acc: 0.635
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm64_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6351351351351351
model parameter : 2858756
model size : 12.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm64_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 6.560967206954956
Epoch: 1, Steps: 10 | Train Loss: 1.467 Vali Loss: 1.410 Vali Acc: 0.216 Test Loss: 1.410 Test Acc: 0.216
Validation loss decreased (inf --> -0.216202).  Saving model ...
Epoch: 2 cost time: 5.070952892303467
Epoch: 2, Steps: 10 | Train Loss: 1.258 Vali Loss: 1.262 Vali Acc: 0.378 Test Loss: 1.262 Test Acc: 0.378
Validation loss decreased (-0.216202 --> -0.378366).  Saving model ...
Epoch: 3 cost time: 5.1387152671813965
Epoch: 3, Steps: 10 | Train Loss: 0.954 Vali Loss: 1.289 Vali Acc: 0.392 Test Loss: 1.289 Test Acc: 0.392
Validation loss decreased (-0.378366 --> -0.391879).  Saving model ...
Epoch: 4 cost time: 5.16176700592041
Epoch: 4, Steps: 10 | Train Loss: 0.652 Vali Loss: 1.099 Vali Acc: 0.554 Test Loss: 1.099 Test Acc: 0.554
Validation loss decreased (-0.391879 --> -0.554043).  Saving model ...
Epoch: 5 cost time: 5.158216714859009
Epoch: 5, Steps: 10 | Train Loss: 0.390 Vali Loss: 1.093 Vali Acc: 0.500 Test Loss: 1.093 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.053585052490234
Epoch: 6, Steps: 10 | Train Loss: 0.219 Vali Loss: 1.026 Vali Acc: 0.527 Test Loss: 1.026 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.953494548797607
Epoch: 7, Steps: 10 | Train Loss: 0.105 Vali Loss: 1.075 Vali Acc: 0.500 Test Loss: 1.075 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.390107154846191
Epoch: 8, Steps: 10 | Train Loss: 0.048 Vali Loss: 1.253 Vali Acc: 0.500 Test Loss: 1.253 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.290904521942139
Epoch: 9, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.113 Vali Acc: 0.527 Test Loss: 1.113 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.784237861633301
Epoch: 10, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.113 Vali Acc: 0.527 Test Loss: 1.113 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.461966037750244
Epoch: 11, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.154 Vali Acc: 0.527 Test Loss: 1.154 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 4.673219203948975
Epoch: 12, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.123 Vali Acc: 0.554 Test Loss: 1.123 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 4.441016435623169
Epoch: 13, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.149 Vali Acc: 0.568 Test Loss: 1.149 Test Acc: 0.568
Validation loss decreased (-0.554043 --> -0.567556).  Saving model ...
Epoch: 14 cost time: 4.605221748352051
Epoch: 14, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.151 Vali Acc: 0.527 Test Loss: 1.151 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.481999635696411
Epoch: 15, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.135 Vali Acc: 0.568 Test Loss: 1.135 Test Acc: 0.568
Validation loss decreased (-0.567556 --> -0.567556).  Saving model ...
Epoch: 16 cost time: 5.256780385971069
Epoch: 16, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.144 Vali Acc: 0.554 Test Loss: 1.144 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.276443719863892
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.145 Vali Acc: 0.554 Test Loss: 1.145 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.797712326049805
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.155 Vali Acc: 0.554 Test Loss: 1.155 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 5.093205213546753
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.134 Vali Acc: 0.568 Test Loss: 1.134 Test Acc: 0.568
Validation loss decreased (-0.567556 --> -0.567556).  Saving model ...
Epoch: 20 cost time: 5.457986116409302
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.147 Vali Acc: 0.568 Test Loss: 1.147 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 5.600456953048706
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.169 Vali Acc: 0.554 Test Loss: 1.169 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 5.4507832527160645
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.169 Vali Acc: 0.568 Test Loss: 1.169 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 5.366166353225708
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.163 Vali Acc: 0.554 Test Loss: 1.163 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 5.268458366394043
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.167 Vali Acc: 0.541 Test Loss: 1.167 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 5.4712419509887695
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.164 Vali Acc: 0.568 Test Loss: 1.164 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 5.364105463027954
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.167 Vali Acc: 0.581 Test Loss: 1.167 Test Acc: 0.581
Validation loss decreased (-0.567556 --> -0.581069).  Saving model ...
Epoch: 27 cost time: 5.611457347869873
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.169 Vali Acc: 0.581 Test Loss: 1.169 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 5.470420837402344
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.173 Vali Acc: 0.581 Test Loss: 1.173 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 5.2552478313446045
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.168 Vali Acc: 0.595 Test Loss: 1.168 Test Acc: 0.595
Validation loss decreased (-0.581069 --> -0.594583).  Saving model ...
Epoch: 30 cost time: 4.807184934616089
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.169 Vali Acc: 0.595 Test Loss: 1.169 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm64_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 4792068
model size : 19.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm64_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.3361358642578125
Epoch: 1, Steps: 10 | Train Loss: 1.444 Vali Loss: 1.375 Vali Acc: 0.284 Test Loss: 1.375 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 2.180255889892578
Epoch: 2, Steps: 10 | Train Loss: 1.263 Vali Loss: 1.247 Vali Acc: 0.446 Test Loss: 1.247 Test Acc: 0.446
Validation loss decreased (-0.283770 --> -0.445933).  Saving model ...
Epoch: 3 cost time: 2.095374584197998
Epoch: 3, Steps: 10 | Train Loss: 0.943 Vali Loss: 1.206 Vali Acc: 0.500 Test Loss: 1.206 Test Acc: 0.500
Validation loss decreased (-0.445933 --> -0.499988).  Saving model ...
Epoch: 4 cost time: 2.081275463104248
Epoch: 4, Steps: 10 | Train Loss: 0.655 Vali Loss: 1.056 Vali Acc: 0.608 Test Loss: 1.056 Test Acc: 0.608
Validation loss decreased (-0.499988 --> -0.608098).  Saving model ...
Epoch: 5 cost time: 2.1246306896209717
Epoch: 5, Steps: 10 | Train Loss: 0.418 Vali Loss: 1.048 Vali Acc: 0.568 Test Loss: 1.048 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.2774932384490967
Epoch: 6, Steps: 10 | Train Loss: 0.247 Vali Loss: 1.101 Vali Acc: 0.541 Test Loss: 1.101 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.08042311668396
Epoch: 7, Steps: 10 | Train Loss: 0.129 Vali Loss: 0.980 Vali Acc: 0.554 Test Loss: 0.980 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.397475004196167
Epoch: 8, Steps: 10 | Train Loss: 0.058 Vali Loss: 1.109 Vali Acc: 0.541 Test Loss: 1.109 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.4842746257781982
Epoch: 9, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.008 Vali Acc: 0.622 Test Loss: 1.008 Test Acc: 0.622
Validation loss decreased (-0.608098 --> -0.621612).  Saving model ...
Epoch: 10 cost time: 2.499655246734619
Epoch: 10, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.062 Vali Acc: 0.595 Test Loss: 1.062 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.4372386932373047
Epoch: 11, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.022 Vali Acc: 0.649 Test Loss: 1.022 Test Acc: 0.649
Validation loss decreased (-0.621612 --> -0.648638).  Saving model ...
Epoch: 12 cost time: 2.3706183433532715
Epoch: 12, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.051 Vali Acc: 0.649 Test Loss: 1.051 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.4539754390716553
Epoch: 13, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.059 Vali Acc: 0.635 Test Loss: 1.059 Test Acc: 0.635
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.3771514892578125
Epoch: 14, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.043 Vali Acc: 0.649 Test Loss: 1.043 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.2746050357818604
Epoch: 15, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.053 Vali Acc: 0.662 Test Loss: 1.053 Test Acc: 0.662
Validation loss decreased (-0.648638 --> -0.662152).  Saving model ...
Epoch: 16 cost time: 2.435823917388916
Epoch: 16, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.068 Vali Acc: 0.662 Test Loss: 1.068 Test Acc: 0.662
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.4025919437408447
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.072 Vali Acc: 0.662 Test Loss: 1.072 Test Acc: 0.662
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.5442211627960205
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.068 Vali Acc: 0.662 Test Loss: 1.068 Test Acc: 0.662
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.455441474914551
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.077 Vali Acc: 0.662 Test Loss: 1.077 Test Acc: 0.662
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.5492231845855713
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.081 Vali Acc: 0.662 Test Loss: 1.081 Test Acc: 0.662
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.5351781845092773
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.094 Vali Acc: 0.662 Test Loss: 1.094 Test Acc: 0.662
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.4202210903167725
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.097 Vali Acc: 0.662 Test Loss: 1.097 Test Acc: 0.662
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.4136288166046143
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.100 Vali Acc: 0.662 Test Loss: 1.100 Test Acc: 0.662
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.472809076309204
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.104 Vali Acc: 0.662 Test Loss: 1.104 Test Acc: 0.662
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.4429378509521484
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.108 Vali Acc: 0.662 Test Loss: 1.108 Test Acc: 0.662
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm64_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6621621621621622
model parameter : 1481988
model size : 6.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm64_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.600564002990723
Epoch: 1, Steps: 10 | Train Loss: 1.466 Vali Loss: 1.408 Vali Acc: 0.216 Test Loss: 1.408 Test Acc: 0.216
Validation loss decreased (inf --> -0.216202).  Saving model ...
Epoch: 2 cost time: 3.5329530239105225
Epoch: 2, Steps: 10 | Train Loss: 1.259 Vali Loss: 1.264 Vali Acc: 0.365 Test Loss: 1.264 Test Acc: 0.365
Validation loss decreased (-0.216202 --> -0.364852).  Saving model ...
Epoch: 3 cost time: 3.509779930114746
Epoch: 3, Steps: 10 | Train Loss: 0.962 Vali Loss: 1.288 Vali Acc: 0.405 Test Loss: 1.288 Test Acc: 0.405
Validation loss decreased (-0.364852 --> -0.405393).  Saving model ...
Epoch: 4 cost time: 3.4991772174835205
Epoch: 4, Steps: 10 | Train Loss: 0.663 Vali Loss: 1.088 Vali Acc: 0.500 Test Loss: 1.088 Test Acc: 0.500
Validation loss decreased (-0.405393 --> -0.499989).  Saving model ...
Epoch: 5 cost time: 3.533695697784424
Epoch: 5, Steps: 10 | Train Loss: 0.400 Vali Loss: 1.093 Vali Acc: 0.554 Test Loss: 1.093 Test Acc: 0.554
Validation loss decreased (-0.499989 --> -0.554043).  Saving model ...
Epoch: 6 cost time: 3.366145133972168
Epoch: 6, Steps: 10 | Train Loss: 0.222 Vali Loss: 1.006 Vali Acc: 0.527 Test Loss: 1.006 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.5180623531341553
Epoch: 7, Steps: 10 | Train Loss: 0.111 Vali Loss: 1.041 Vali Acc: 0.500 Test Loss: 1.041 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.6452126502990723
Epoch: 8, Steps: 10 | Train Loss: 0.053 Vali Loss: 1.238 Vali Acc: 0.500 Test Loss: 1.238 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.3745744228363037
Epoch: 9, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.100 Vali Acc: 0.595 Test Loss: 1.100 Test Acc: 0.595
Validation loss decreased (-0.554043 --> -0.594584).  Saving model ...
Epoch: 10 cost time: 3.6443800926208496
Epoch: 10, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.073 Vali Acc: 0.581 Test Loss: 1.073 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.440642833709717
Epoch: 11, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.139 Vali Acc: 0.568 Test Loss: 1.139 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.7843685150146484
Epoch: 12, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.107 Vali Acc: 0.554 Test Loss: 1.107 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.7867305278778076
Epoch: 13, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.164 Vali Acc: 0.568 Test Loss: 1.164 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.015013217926025
Epoch: 14, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.151 Vali Acc: 0.554 Test Loss: 1.151 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.943136692047119
Epoch: 15, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.057 Vali Acc: 0.608 Test Loss: 1.057 Test Acc: 0.608
Validation loss decreased (-0.594584 --> -0.608098).  Saving model ...
Epoch: 16 cost time: 3.9446640014648438
Epoch: 16, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.072 Vali Acc: 0.581 Test Loss: 1.072 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.095859050750732
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.126 Vali Acc: 0.568 Test Loss: 1.126 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.8882761001586914
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.135 Vali Acc: 0.568 Test Loss: 1.135 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.8001818656921387
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.092 Vali Acc: 0.608 Test Loss: 1.092 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 4.007439851760864
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.157 Vali Acc: 0.595 Test Loss: 1.157 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.6544206142425537
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.158 Vali Acc: 0.581 Test Loss: 1.158 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.621903657913208
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.125 Vali Acc: 0.554 Test Loss: 1.125 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 3.9040441513061523
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.013 Vali Acc: 0.635 Test Loss: 1.013 Test Acc: 0.635
Validation loss decreased (-0.608098 --> -0.635125).  Saving model ...
Epoch: 24 cost time: 3.885261297225952
Epoch: 24, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.277 Vali Acc: 0.527 Test Loss: 1.277 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.7597246170043945
Epoch: 25, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.386 Vali Acc: 0.608 Test Loss: 1.386 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.9770641326904297
Epoch: 26, Steps: 10 | Train Loss: 0.048 Vali Loss: 1.598 Vali Acc: 0.541 Test Loss: 1.598 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.9319841861724854
Epoch: 27, Steps: 10 | Train Loss: 0.042 Vali Loss: 1.787 Vali Acc: 0.500 Test Loss: 1.787 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 4.02968955039978
Epoch: 28, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.463 Vali Acc: 0.541 Test Loss: 1.463 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 3.6579883098602295
Epoch: 29, Steps: 10 | Train Loss: 0.041 Vali Loss: 1.617 Vali Acc: 0.554 Test Loss: 1.617 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 3.4991378784179688
Epoch: 30, Steps: 10 | Train Loss: 0.045 Vali Loss: 1.598 Vali Acc: 0.554 Test Loss: 1.598 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm64_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6351351351351351
model parameter : 4792068
model size : 19.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm64_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.050544261932373
Epoch: 1, Steps: 10 | Train Loss: 1.446 Vali Loss: 1.372 Vali Acc: 0.324 Test Loss: 1.372 Test Acc: 0.324
Validation loss decreased (inf --> -0.324311).  Saving model ...
Epoch: 2 cost time: 1.6776819229125977
Epoch: 2, Steps: 10 | Train Loss: 1.265 Vali Loss: 1.245 Vali Acc: 0.473 Test Loss: 1.245 Test Acc: 0.473
Validation loss decreased (-0.324311 --> -0.472961).  Saving model ...
Epoch: 3 cost time: 1.6923444271087646
Epoch: 3, Steps: 10 | Train Loss: 0.953 Vali Loss: 1.206 Vali Acc: 0.500 Test Loss: 1.206 Test Acc: 0.500
Validation loss decreased (-0.472961 --> -0.499988).  Saving model ...
Epoch: 4 cost time: 1.6680347919464111
Epoch: 4, Steps: 10 | Train Loss: 0.664 Vali Loss: 1.054 Vali Acc: 0.568 Test Loss: 1.054 Test Acc: 0.568
Validation loss decreased (-0.499988 --> -0.567557).  Saving model ...
Epoch: 5 cost time: 1.6559703350067139
Epoch: 5, Steps: 10 | Train Loss: 0.424 Vali Loss: 1.051 Vali Acc: 0.541 Test Loss: 1.051 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5826282501220703
Epoch: 6, Steps: 10 | Train Loss: 0.251 Vali Loss: 1.102 Vali Acc: 0.541 Test Loss: 1.102 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.8385157585144043
Epoch: 7, Steps: 10 | Train Loss: 0.149 Vali Loss: 0.974 Vali Acc: 0.581 Test Loss: 0.974 Test Acc: 0.581
Validation loss decreased (-0.567557 --> -0.581071).  Saving model ...
Epoch: 8 cost time: 1.8214225769042969
Epoch: 8, Steps: 10 | Train Loss: 0.067 Vali Loss: 1.163 Vali Acc: 0.514 Test Loss: 1.163 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8271503448486328
Epoch: 9, Steps: 10 | Train Loss: 0.037 Vali Loss: 1.019 Vali Acc: 0.595 Test Loss: 1.019 Test Acc: 0.595
Validation loss decreased (-0.581071 --> -0.594584).  Saving model ...
Epoch: 10 cost time: 1.8067522048950195
Epoch: 10, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.030 Vali Acc: 0.622 Test Loss: 1.030 Test Acc: 0.622
Validation loss decreased (-0.594584 --> -0.621611).  Saving model ...
Epoch: 11 cost time: 1.829458236694336
Epoch: 11, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.009 Vali Acc: 0.622 Test Loss: 1.009 Test Acc: 0.622
Validation loss decreased (-0.621611 --> -0.621612).  Saving model ...
Epoch: 12 cost time: 2.0267324447631836
Epoch: 12, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.063 Vali Acc: 0.622 Test Loss: 1.063 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.841867446899414
Epoch: 13, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.040 Vali Acc: 0.635 Test Loss: 1.040 Test Acc: 0.635
Validation loss decreased (-0.621612 --> -0.635125).  Saving model ...
Epoch: 14 cost time: 1.814084768295288
Epoch: 14, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.020 Vali Acc: 0.635 Test Loss: 1.020 Test Acc: 0.635
Validation loss decreased (-0.635125 --> -0.635125).  Saving model ...
Epoch: 15 cost time: 1.7852225303649902
Epoch: 15, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.039 Vali Acc: 0.662 Test Loss: 1.039 Test Acc: 0.662
Validation loss decreased (-0.635125 --> -0.662152).  Saving model ...
Epoch: 16 cost time: 1.8349506855010986
Epoch: 16, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.059 Vali Acc: 0.649 Test Loss: 1.059 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.7725379467010498
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.041 Vali Acc: 0.662 Test Loss: 1.041 Test Acc: 0.662
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.927750587463379
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.092 Vali Acc: 0.649 Test Loss: 1.092 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.9398202896118164
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.132 Vali Acc: 0.635 Test Loss: 1.132 Test Acc: 0.635
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.877413034439087
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.091 Vali Acc: 0.608 Test Loss: 1.091 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.821951150894165
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.104 Vali Acc: 0.622 Test Loss: 1.104 Test Acc: 0.622
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.946556568145752
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.115 Vali Acc: 0.635 Test Loss: 1.115 Test Acc: 0.635
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.953786849975586
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.124 Vali Acc: 0.608 Test Loss: 1.124 Test Acc: 0.608
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.9416005611419678
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.130 Vali Acc: 0.635 Test Loss: 1.130 Test Acc: 0.635
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.9614031314849854
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.194 Vali Acc: 0.649 Test Loss: 1.194 Test Acc: 0.649
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm64_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6621621621621622
model parameter : 1481988
model size : 6.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm64_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.8619275093078613
Epoch: 1, Steps: 10 | Train Loss: 1.465 Vali Loss: 1.403 Vali Acc: 0.243 Test Loss: 1.403 Test Acc: 0.243
Validation loss decreased (inf --> -0.243229).  Saving model ...
Epoch: 2 cost time: 2.468665838241577
Epoch: 2, Steps: 10 | Train Loss: 1.273 Vali Loss: 1.260 Vali Acc: 0.392 Test Loss: 1.260 Test Acc: 0.392
Validation loss decreased (-0.243229 --> -0.391879).  Saving model ...
Epoch: 3 cost time: 2.3323256969451904
Epoch: 3, Steps: 10 | Train Loss: 1.004 Vali Loss: 1.283 Vali Acc: 0.405 Test Loss: 1.283 Test Acc: 0.405
Validation loss decreased (-0.391879 --> -0.405393).  Saving model ...
Epoch: 4 cost time: 2.2735273838043213
Epoch: 4, Steps: 10 | Train Loss: 0.727 Vali Loss: 1.092 Vali Acc: 0.500 Test Loss: 1.092 Test Acc: 0.500
Validation loss decreased (-0.405393 --> -0.499989).  Saving model ...
Epoch: 5 cost time: 2.4267516136169434
Epoch: 5, Steps: 10 | Train Loss: 0.476 Vali Loss: 1.093 Vali Acc: 0.541 Test Loss: 1.093 Test Acc: 0.541
Validation loss decreased (-0.499989 --> -0.540530).  Saving model ...
Epoch: 6 cost time: 2.2005295753479004
Epoch: 6, Steps: 10 | Train Loss: 0.294 Vali Loss: 1.021 Vali Acc: 0.554 Test Loss: 1.021 Test Acc: 0.554
Validation loss decreased (-0.540530 --> -0.554044).  Saving model ...
Epoch: 7 cost time: 2.110217332839966
Epoch: 7, Steps: 10 | Train Loss: 0.168 Vali Loss: 1.052 Vali Acc: 0.554 Test Loss: 1.052 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.3207499980926514
Epoch: 8, Steps: 10 | Train Loss: 0.086 Vali Loss: 1.293 Vali Acc: 0.473 Test Loss: 1.293 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.2686216831207275
Epoch: 9, Steps: 10 | Train Loss: 0.044 Vali Loss: 1.015 Vali Acc: 0.622 Test Loss: 1.015 Test Acc: 0.622
Validation loss decreased (-0.554044 --> -0.621611).  Saving model ...
Epoch: 10 cost time: 2.39650821685791
Epoch: 10, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.145 Vali Acc: 0.554 Test Loss: 1.145 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.354851245880127
Epoch: 11, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.061 Vali Acc: 0.568 Test Loss: 1.061 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.258662462234497
Epoch: 12, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.069 Vali Acc: 0.581 Test Loss: 1.069 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.533149242401123
Epoch: 13, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.101 Vali Acc: 0.581 Test Loss: 1.101 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.5545239448547363
Epoch: 14, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.103 Vali Acc: 0.581 Test Loss: 1.103 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.586364984512329
Epoch: 15, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.084 Vali Acc: 0.595 Test Loss: 1.084 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.572699785232544
Epoch: 16, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.108 Vali Acc: 0.554 Test Loss: 1.108 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.5954182147979736
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.114 Vali Acc: 0.608 Test Loss: 1.114 Test Acc: 0.608
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.510833978652954
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.116 Vali Acc: 0.608 Test Loss: 1.116 Test Acc: 0.608
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.5173346996307373
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.105 Vali Acc: 0.581 Test Loss: 1.105 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm64_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 4792068
model size : 19.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm64_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.753270149230957
Epoch: 1, Steps: 10 | Train Loss: 1.444 Vali Loss: 1.372 Vali Acc: 0.257 Test Loss: 1.372 Test Acc: 0.257
Validation loss decreased (inf --> -0.256743).  Saving model ...
Epoch: 2 cost time: 1.4443447589874268
Epoch: 2, Steps: 10 | Train Loss: 1.271 Vali Loss: 1.249 Vali Acc: 0.473 Test Loss: 1.249 Test Acc: 0.473
Validation loss decreased (-0.256743 --> -0.472960).  Saving model ...
Epoch: 3 cost time: 1.3728611469268799
Epoch: 3, Steps: 10 | Train Loss: 0.971 Vali Loss: 1.214 Vali Acc: 0.446 Test Loss: 1.214 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5325086116790771
Epoch: 4, Steps: 10 | Train Loss: 0.700 Vali Loss: 1.060 Vali Acc: 0.568 Test Loss: 1.060 Test Acc: 0.568
Validation loss decreased (-0.472960 --> -0.567557).  Saving model ...
Epoch: 5 cost time: 1.4691417217254639
Epoch: 5, Steps: 10 | Train Loss: 0.468 Vali Loss: 1.068 Vali Acc: 0.568 Test Loss: 1.068 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.4545719623565674
Epoch: 6, Steps: 10 | Train Loss: 0.296 Vali Loss: 1.136 Vali Acc: 0.514 Test Loss: 1.136 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.349294662475586
Epoch: 7, Steps: 10 | Train Loss: 0.166 Vali Loss: 0.973 Vali Acc: 0.554 Test Loss: 0.973 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.4493892192840576
Epoch: 8, Steps: 10 | Train Loss: 0.082 Vali Loss: 1.109 Vali Acc: 0.514 Test Loss: 1.109 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.267707109451294
Epoch: 9, Steps: 10 | Train Loss: 0.042 Vali Loss: 1.022 Vali Acc: 0.622 Test Loss: 1.022 Test Acc: 0.622
Validation loss decreased (-0.567557 --> -0.621611).  Saving model ...
Epoch: 10 cost time: 1.3946316242218018
Epoch: 10, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.053 Vali Acc: 0.595 Test Loss: 1.053 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3594822883605957
Epoch: 11, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.006 Vali Acc: 0.635 Test Loss: 1.006 Test Acc: 0.635
Validation loss decreased (-0.621611 --> -0.635125).  Saving model ...
Epoch: 12 cost time: 1.5871763229370117
Epoch: 12, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.065 Vali Acc: 0.581 Test Loss: 1.065 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4998650550842285
Epoch: 13, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.034 Vali Acc: 0.649 Test Loss: 1.034 Test Acc: 0.649
Validation loss decreased (-0.635125 --> -0.648638).  Saving model ...
Epoch: 14 cost time: 1.2542531490325928
Epoch: 14, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.011 Vali Acc: 0.649 Test Loss: 1.011 Test Acc: 0.649
Validation loss decreased (-0.648638 --> -0.648639).  Saving model ...
Epoch: 15 cost time: 1.3651752471923828
Epoch: 15, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.033 Vali Acc: 0.635 Test Loss: 1.033 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.3501784801483154
Epoch: 16, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.048 Vali Acc: 0.622 Test Loss: 1.048 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.353975534439087
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.038 Vali Acc: 0.635 Test Loss: 1.038 Test Acc: 0.635
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.3607072830200195
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.036 Vali Acc: 0.649 Test Loss: 1.036 Test Acc: 0.649
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.374394178390503
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.054 Vali Acc: 0.622 Test Loss: 1.054 Test Acc: 0.622
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.3738305568695068
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.047 Vali Acc: 0.649 Test Loss: 1.047 Test Acc: 0.649
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.3703818321228027
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.062 Vali Acc: 0.635 Test Loss: 1.062 Test Acc: 0.635
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.3331894874572754
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.071 Vali Acc: 0.608 Test Loss: 1.071 Test Acc: 0.608
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.2908754348754883
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.071 Vali Acc: 0.635 Test Loss: 1.071 Test Acc: 0.635
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.3591728210449219
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.070 Vali Acc: 0.649 Test Loss: 1.070 Test Acc: 0.649
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm64_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6486486486486487
model parameter : 1481988
model size : 6.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm32_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 8.780269622802734
Epoch: 1, Steps: 10 | Train Loss: 1.402 Vali Loss: 1.423 Vali Acc: 0.257 Test Loss: 1.423 Test Acc: 0.257
Validation loss decreased (inf --> -0.256743).  Saving model ...
Epoch: 2 cost time: 7.367485046386719
Epoch: 2, Steps: 10 | Train Loss: 1.271 Vali Loss: 1.357 Vali Acc: 0.324 Test Loss: 1.357 Test Acc: 0.324
Validation loss decreased (-0.256743 --> -0.324311).  Saving model ...
Epoch: 3 cost time: 7.2112767696380615
Epoch: 3, Steps: 10 | Train Loss: 1.066 Vali Loss: 1.275 Vali Acc: 0.378 Test Loss: 1.275 Test Acc: 0.378
Validation loss decreased (-0.324311 --> -0.378366).  Saving model ...
Epoch: 4 cost time: 7.3131256103515625
Epoch: 4, Steps: 10 | Train Loss: 0.838 Vali Loss: 1.191 Vali Acc: 0.419 Test Loss: 1.191 Test Acc: 0.419
Validation loss decreased (-0.378366 --> -0.418907).  Saving model ...
Epoch: 5 cost time: 7.483947277069092
Epoch: 5, Steps: 10 | Train Loss: 0.634 Vali Loss: 1.133 Vali Acc: 0.554 Test Loss: 1.133 Test Acc: 0.554
Validation loss decreased (-0.418907 --> -0.554043).  Saving model ...
Epoch: 6 cost time: 7.353910207748413
Epoch: 6, Steps: 10 | Train Loss: 0.463 Vali Loss: 1.059 Vali Acc: 0.595 Test Loss: 1.059 Test Acc: 0.595
Validation loss decreased (-0.554043 --> -0.594584).  Saving model ...
Epoch: 7 cost time: 7.257957458496094
Epoch: 7, Steps: 10 | Train Loss: 0.298 Vali Loss: 1.060 Vali Acc: 0.541 Test Loss: 1.060 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 7.408674478530884
Epoch: 8, Steps: 10 | Train Loss: 0.189 Vali Loss: 1.015 Vali Acc: 0.581 Test Loss: 1.015 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 7.411419630050659
Epoch: 9, Steps: 10 | Train Loss: 0.124 Vali Loss: 1.094 Vali Acc: 0.527 Test Loss: 1.094 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 7.5363850593566895
Epoch: 10, Steps: 10 | Train Loss: 0.067 Vali Loss: 0.980 Vali Acc: 0.568 Test Loss: 0.980 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 7.374302625656128
Epoch: 11, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.993 Vali Acc: 0.554 Test Loss: 0.993 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 6.553530216217041
Epoch: 12, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.066 Vali Acc: 0.514 Test Loss: 1.066 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 6.799893379211426
Epoch: 13, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.033 Vali Acc: 0.554 Test Loss: 1.033 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 6.752316951751709
Epoch: 14, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.051 Vali Acc: 0.541 Test Loss: 1.051 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 6.1713855266571045
Epoch: 15, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.085 Vali Acc: 0.541 Test Loss: 1.085 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 6.644073724746704
Epoch: 16, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.069 Vali Acc: 0.514 Test Loss: 1.069 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm32_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 4740100
model size : 18.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm32_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 5.755115509033203
Epoch: 1, Steps: 10 | Train Loss: 1.448 Vali Loss: 1.416 Vali Acc: 0.243 Test Loss: 1.416 Test Acc: 0.243
Validation loss decreased (inf --> -0.243229).  Saving model ...
Epoch: 2 cost time: 4.5637047290802
Epoch: 2, Steps: 10 | Train Loss: 1.327 Vali Loss: 1.362 Vali Acc: 0.270 Test Loss: 1.362 Test Acc: 0.270
Validation loss decreased (-0.243229 --> -0.270257).  Saving model ...
Epoch: 3 cost time: 4.373466491699219
Epoch: 3, Steps: 10 | Train Loss: 1.134 Vali Loss: 1.319 Vali Acc: 0.419 Test Loss: 1.319 Test Acc: 0.419
Validation loss decreased (-0.270257 --> -0.418906).  Saving model ...
Epoch: 4 cost time: 4.493711948394775
Epoch: 4, Steps: 10 | Train Loss: 0.901 Vali Loss: 1.252 Vali Acc: 0.473 Test Loss: 1.252 Test Acc: 0.473
Validation loss decreased (-0.418906 --> -0.472960).  Saving model ...
Epoch: 5 cost time: 4.27927827835083
Epoch: 5, Steps: 10 | Train Loss: 0.721 Vali Loss: 1.177 Vali Acc: 0.568 Test Loss: 1.177 Test Acc: 0.568
Validation loss decreased (-0.472960 --> -0.567556).  Saving model ...
Epoch: 6 cost time: 4.459365367889404
Epoch: 6, Steps: 10 | Train Loss: 0.536 Vali Loss: 1.152 Vali Acc: 0.514 Test Loss: 1.152 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.5279130935668945
Epoch: 7, Steps: 10 | Train Loss: 0.367 Vali Loss: 1.111 Vali Acc: 0.541 Test Loss: 1.111 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.402703285217285
Epoch: 8, Steps: 10 | Train Loss: 0.236 Vali Loss: 1.080 Vali Acc: 0.527 Test Loss: 1.080 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.5476157665252686
Epoch: 9, Steps: 10 | Train Loss: 0.137 Vali Loss: 1.082 Vali Acc: 0.581 Test Loss: 1.082 Test Acc: 0.581
Validation loss decreased (-0.567556 --> -0.581070).  Saving model ...
Epoch: 10 cost time: 4.395498275756836
Epoch: 10, Steps: 10 | Train Loss: 0.069 Vali Loss: 1.091 Vali Acc: 0.554 Test Loss: 1.091 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.4711079597473145
Epoch: 11, Steps: 10 | Train Loss: 0.039 Vali Loss: 1.106 Vali Acc: 0.554 Test Loss: 1.106 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.672947406768799
Epoch: 12, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.095 Vali Acc: 0.554 Test Loss: 1.095 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.520552396774292
Epoch: 13, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.161 Vali Acc: 0.554 Test Loss: 1.161 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.587694883346558
Epoch: 14, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.150 Vali Acc: 0.554 Test Loss: 1.150 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.530234098434448
Epoch: 15, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.131 Vali Acc: 0.568 Test Loss: 1.131 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.487786531448364
Epoch: 16, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.141 Vali Acc: 0.554 Test Loss: 1.141 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 4.163386583328247
Epoch: 17, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.160 Vali Acc: 0.568 Test Loss: 1.160 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 4.021401882171631
Epoch: 18, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.168 Vali Acc: 0.568 Test Loss: 1.168 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 4.046830892562866
Epoch: 19, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.167 Vali Acc: 0.568 Test Loss: 1.167 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm32_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 1429892
model size : 6.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm32_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 6.08653998374939
Epoch: 1, Steps: 10 | Train Loss: 1.402 Vali Loss: 1.422 Vali Acc: 0.257 Test Loss: 1.422 Test Acc: 0.257
Validation loss decreased (inf --> -0.256743).  Saving model ...
Epoch: 2 cost time: 4.86577033996582
Epoch: 2, Steps: 10 | Train Loss: 1.281 Vali Loss: 1.357 Vali Acc: 0.324 Test Loss: 1.357 Test Acc: 0.324
Validation loss decreased (-0.256743 --> -0.324311).  Saving model ...
Epoch: 3 cost time: 4.535151481628418
Epoch: 3, Steps: 10 | Train Loss: 1.090 Vali Loss: 1.279 Vali Acc: 0.365 Test Loss: 1.279 Test Acc: 0.365
Validation loss decreased (-0.324311 --> -0.364852).  Saving model ...
Epoch: 4 cost time: 5.640713930130005
Epoch: 4, Steps: 10 | Train Loss: 0.881 Vali Loss: 1.188 Vali Acc: 0.459 Test Loss: 1.188 Test Acc: 0.459
Validation loss decreased (-0.364852 --> -0.459448).  Saving model ...
Epoch: 5 cost time: 5.086099147796631
Epoch: 5, Steps: 10 | Train Loss: 0.676 Vali Loss: 1.122 Vali Acc: 0.541 Test Loss: 1.122 Test Acc: 0.541
Validation loss decreased (-0.459448 --> -0.540529).  Saving model ...
Epoch: 6 cost time: 5.516233444213867
Epoch: 6, Steps: 10 | Train Loss: 0.512 Vali Loss: 1.035 Vali Acc: 0.608 Test Loss: 1.035 Test Acc: 0.608
Validation loss decreased (-0.540529 --> -0.608098).  Saving model ...
Epoch: 7 cost time: 4.928635358810425
Epoch: 7, Steps: 10 | Train Loss: 0.341 Vali Loss: 1.029 Vali Acc: 0.595 Test Loss: 1.029 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.192909002304077
Epoch: 8, Steps: 10 | Train Loss: 0.236 Vali Loss: 0.953 Vali Acc: 0.595 Test Loss: 0.953 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.17935037612915
Epoch: 9, Steps: 10 | Train Loss: 0.158 Vali Loss: 1.016 Vali Acc: 0.595 Test Loss: 1.016 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.114042520523071
Epoch: 10, Steps: 10 | Train Loss: 0.092 Vali Loss: 0.913 Vali Acc: 0.595 Test Loss: 0.913 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.976751089096069
Epoch: 11, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.959 Vali Acc: 0.581 Test Loss: 0.959 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 5.2561328411102295
Epoch: 12, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.917 Vali Acc: 0.568 Test Loss: 0.917 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 5.136993169784546
Epoch: 13, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.916 Vali Acc: 0.595 Test Loss: 0.916 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 4.866293668746948
Epoch: 14, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.943 Vali Acc: 0.622 Test Loss: 0.943 Test Acc: 0.622
Validation loss decreased (-0.608098 --> -0.621612).  Saving model ...
Epoch: 15 cost time: 5.468566656112671
Epoch: 15, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.940 Vali Acc: 0.622 Test Loss: 0.940 Test Acc: 0.622
Validation loss decreased (-0.621612 --> -0.621612).  Saving model ...
Epoch: 16 cost time: 5.003413438796997
Epoch: 16, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.937 Vali Acc: 0.622 Test Loss: 0.937 Test Acc: 0.622
Validation loss decreased (-0.621612 --> -0.621612).  Saving model ...
Epoch: 17 cost time: 5.3757641315460205
Epoch: 17, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.954 Vali Acc: 0.635 Test Loss: 0.954 Test Acc: 0.635
Validation loss decreased (-0.621612 --> -0.635126).  Saving model ...
Epoch: 18 cost time: 4.418451547622681
Epoch: 18, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.921 Vali Acc: 0.635 Test Loss: 0.921 Test Acc: 0.635
Validation loss decreased (-0.635126 --> -0.635126).  Saving model ...
Epoch: 19 cost time: 4.682977199554443
Epoch: 19, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.927 Vali Acc: 0.622 Test Loss: 0.927 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.449177026748657
Epoch: 20, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.951 Vali Acc: 0.622 Test Loss: 0.951 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 4.739778995513916
Epoch: 21, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.934 Vali Acc: 0.622 Test Loss: 0.934 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 4.487910032272339
Epoch: 22, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.947 Vali Acc: 0.622 Test Loss: 0.947 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 4.705653667449951
Epoch: 23, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.960 Vali Acc: 0.622 Test Loss: 0.960 Test Acc: 0.622
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 4.544825553894043
Epoch: 24, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.960 Vali Acc: 0.622 Test Loss: 0.960 Test Acc: 0.622
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 4.622451305389404
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.976 Vali Acc: 0.608 Test Loss: 0.976 Test Acc: 0.608
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 3.2021024227142334
Epoch: 26, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.978 Vali Acc: 0.622 Test Loss: 0.978 Test Acc: 0.622
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 4.530781507492065
Epoch: 27, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.975 Vali Acc: 0.649 Test Loss: 0.975 Test Acc: 0.649
Validation loss decreased (-0.635126 --> -0.648639).  Saving model ...
Epoch: 28 cost time: 4.3959808349609375
Epoch: 28, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.969 Vali Acc: 0.622 Test Loss: 0.969 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 4.751368284225464
Epoch: 29, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.973 Vali Acc: 0.649 Test Loss: 0.973 Test Acc: 0.649
Validation loss decreased (-0.648639 --> -0.648639).  Saving model ...
Epoch: 30 cost time: 4.429355621337891
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.992 Vali Acc: 0.649 Test Loss: 0.992 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm32_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6486486486486487
model parameter : 4740100
model size : 18.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm32_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.794546604156494
Epoch: 1, Steps: 10 | Train Loss: 1.447 Vali Loss: 1.412 Vali Acc: 0.243 Test Loss: 1.412 Test Acc: 0.243
Validation loss decreased (inf --> -0.243229).  Saving model ...
Epoch: 2 cost time: 1.3427636623382568
Epoch: 2, Steps: 10 | Train Loss: 1.328 Vali Loss: 1.357 Vali Acc: 0.297 Test Loss: 1.357 Test Acc: 0.297
Validation loss decreased (-0.243229 --> -0.297284).  Saving model ...
Epoch: 3 cost time: 1.4139337539672852
Epoch: 3, Steps: 10 | Train Loss: 1.136 Vali Loss: 1.312 Vali Acc: 0.419 Test Loss: 1.312 Test Acc: 0.419
Validation loss decreased (-0.297284 --> -0.418906).  Saving model ...
Epoch: 4 cost time: 1.284175157546997
Epoch: 4, Steps: 10 | Train Loss: 0.904 Vali Loss: 1.241 Vali Acc: 0.514 Test Loss: 1.241 Test Acc: 0.514
Validation loss decreased (-0.418906 --> -0.513501).  Saving model ...
Epoch: 5 cost time: 1.189882755279541
Epoch: 5, Steps: 10 | Train Loss: 0.721 Vali Loss: 1.158 Vali Acc: 0.568 Test Loss: 1.158 Test Acc: 0.568
Validation loss decreased (-0.513501 --> -0.567556).  Saving model ...
Epoch: 6 cost time: 1.2170639038085938
Epoch: 6, Steps: 10 | Train Loss: 0.540 Vali Loss: 1.127 Vali Acc: 0.554 Test Loss: 1.127 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3549957275390625
Epoch: 7, Steps: 10 | Train Loss: 0.372 Vali Loss: 1.093 Vali Acc: 0.595 Test Loss: 1.093 Test Acc: 0.595
Validation loss decreased (-0.567556 --> -0.594584).  Saving model ...
Epoch: 8 cost time: 1.304539680480957
Epoch: 8, Steps: 10 | Train Loss: 0.241 Vali Loss: 1.040 Vali Acc: 0.595 Test Loss: 1.040 Test Acc: 0.595
Validation loss decreased (-0.594584 --> -0.594584).  Saving model ...
Epoch: 9 cost time: 1.2967567443847656
Epoch: 9, Steps: 10 | Train Loss: 0.142 Vali Loss: 1.059 Vali Acc: 0.608 Test Loss: 1.059 Test Acc: 0.608
Validation loss decreased (-0.594584 --> -0.608098).  Saving model ...
Epoch: 10 cost time: 1.3262078762054443
Epoch: 10, Steps: 10 | Train Loss: 0.079 Vali Loss: 1.026 Vali Acc: 0.622 Test Loss: 1.026 Test Acc: 0.622
Validation loss decreased (-0.608098 --> -0.621611).  Saving model ...
Epoch: 11 cost time: 1.221985101699829
Epoch: 11, Steps: 10 | Train Loss: 0.044 Vali Loss: 1.068 Vali Acc: 0.568 Test Loss: 1.068 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8942711353302002
Epoch: 12, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.015 Vali Acc: 0.608 Test Loss: 1.015 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.9219768047332764
Epoch: 13, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.061 Vali Acc: 0.595 Test Loss: 1.061 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.8958518505096436
Epoch: 14, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.061 Vali Acc: 0.608 Test Loss: 1.061 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.9109101295471191
Epoch: 15, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.036 Vali Acc: 0.635 Test Loss: 1.036 Test Acc: 0.635
Validation loss decreased (-0.621611 --> -0.635125).  Saving model ...
Epoch: 16 cost time: 2.0761570930480957
Epoch: 16, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.067 Vali Acc: 0.622 Test Loss: 1.067 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.9873058795928955
Epoch: 17, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.104 Vali Acc: 0.581 Test Loss: 1.104 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.9051353931427002
Epoch: 18, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.073 Vali Acc: 0.635 Test Loss: 1.073 Test Acc: 0.635
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.9042296409606934
Epoch: 19, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.071 Vali Acc: 0.622 Test Loss: 1.071 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.968503713607788
Epoch: 20, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.153 Vali Acc: 0.608 Test Loss: 1.153 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.9817562103271484
Epoch: 21, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.116 Vali Acc: 0.595 Test Loss: 1.116 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.041111469268799
Epoch: 22, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.113 Vali Acc: 0.635 Test Loss: 1.113 Test Acc: 0.635
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.5438785552978516
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.133 Vali Acc: 0.622 Test Loss: 1.133 Test Acc: 0.622
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.8482513427734375
Epoch: 24, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.124 Vali Acc: 0.608 Test Loss: 1.124 Test Acc: 0.608
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.7005319595336914
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.162 Vali Acc: 0.608 Test Loss: 1.162 Test Acc: 0.608
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm32_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6351351351351351
model parameter : 1429892
model size : 6.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm32_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.020617961883545
Epoch: 1, Steps: 10 | Train Loss: 1.401 Vali Loss: 1.422 Vali Acc: 0.243 Test Loss: 1.422 Test Acc: 0.243
Validation loss decreased (inf --> -0.243229).  Saving model ...
Epoch: 2 cost time: 2.4491920471191406
Epoch: 2, Steps: 10 | Train Loss: 1.286 Vali Loss: 1.358 Vali Acc: 0.351 Test Loss: 1.358 Test Acc: 0.351
Validation loss decreased (-0.243229 --> -0.351338).  Saving model ...
Epoch: 3 cost time: 2.5436906814575195
Epoch: 3, Steps: 10 | Train Loss: 1.104 Vali Loss: 1.281 Vali Acc: 0.392 Test Loss: 1.281 Test Acc: 0.392
Validation loss decreased (-0.351338 --> -0.391879).  Saving model ...
Epoch: 4 cost time: 2.642385959625244
Epoch: 4, Steps: 10 | Train Loss: 0.899 Vali Loss: 1.192 Vali Acc: 0.446 Test Loss: 1.192 Test Acc: 0.446
Validation loss decreased (-0.391879 --> -0.445934).  Saving model ...
Epoch: 5 cost time: 2.703594207763672
Epoch: 5, Steps: 10 | Train Loss: 0.707 Vali Loss: 1.128 Vali Acc: 0.527 Test Loss: 1.128 Test Acc: 0.527
Validation loss decreased (-0.445934 --> -0.527016).  Saving model ...
Epoch: 6 cost time: 2.714299440383911
Epoch: 6, Steps: 10 | Train Loss: 0.542 Vali Loss: 1.063 Vali Acc: 0.568 Test Loss: 1.063 Test Acc: 0.568
Validation loss decreased (-0.527016 --> -0.567557).  Saving model ...
Epoch: 7 cost time: 2.6662440299987793
Epoch: 7, Steps: 10 | Train Loss: 0.377 Vali Loss: 1.047 Vali Acc: 0.595 Test Loss: 1.047 Test Acc: 0.595
Validation loss decreased (-0.567557 --> -0.594584).  Saving model ...
Epoch: 8 cost time: 2.532928943634033
Epoch: 8, Steps: 10 | Train Loss: 0.255 Vali Loss: 0.977 Vali Acc: 0.595 Test Loss: 0.977 Test Acc: 0.595
Validation loss decreased (-0.594584 --> -0.594585).  Saving model ...
Epoch: 9 cost time: 2.231793165206909
Epoch: 9, Steps: 10 | Train Loss: 0.180 Vali Loss: 1.038 Vali Acc: 0.568 Test Loss: 1.038 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.0425379276275635
Epoch: 10, Steps: 10 | Train Loss: 0.104 Vali Loss: 0.911 Vali Acc: 0.608 Test Loss: 0.911 Test Acc: 0.608
Validation loss decreased (-0.594585 --> -0.608099).  Saving model ...
Epoch: 11 cost time: 2.0742037296295166
Epoch: 11, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.973 Vali Acc: 0.581 Test Loss: 0.973 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.325286865234375
Epoch: 12, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.939 Vali Acc: 0.622 Test Loss: 0.939 Test Acc: 0.622
Validation loss decreased (-0.608099 --> -0.621612).  Saving model ...
Epoch: 13 cost time: 2.1774532794952393
Epoch: 13, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.950 Vali Acc: 0.635 Test Loss: 0.950 Test Acc: 0.635
Validation loss decreased (-0.621612 --> -0.635126).  Saving model ...
Epoch: 14 cost time: 2.1384310722351074
Epoch: 14, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.969 Vali Acc: 0.622 Test Loss: 0.969 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.601809024810791
Epoch: 15, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.001 Vali Acc: 0.622 Test Loss: 1.001 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.568603992462158
Epoch: 16, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.988 Vali Acc: 0.622 Test Loss: 0.988 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.597954511642456
Epoch: 17, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.006 Vali Acc: 0.622 Test Loss: 1.006 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.6244611740112305
Epoch: 18, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.000 Vali Acc: 0.622 Test Loss: 1.000 Test Acc: 0.622
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.5377721786499023
Epoch: 19, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.004 Vali Acc: 0.622 Test Loss: 1.004 Test Acc: 0.622
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.5408694744110107
Epoch: 20, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.035 Vali Acc: 0.635 Test Loss: 1.035 Test Acc: 0.635
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.446467399597168
Epoch: 21, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.024 Vali Acc: 0.622 Test Loss: 1.024 Test Acc: 0.622
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.5077106952667236
Epoch: 22, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.037 Vali Acc: 0.635 Test Loss: 1.037 Test Acc: 0.635
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.5738365650177
Epoch: 23, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.054 Vali Acc: 0.635 Test Loss: 1.054 Test Acc: 0.635
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm32_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6351351351351351
model parameter : 4740100
model size : 18.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm32_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.466975450515747
Epoch: 1, Steps: 10 | Train Loss: 1.439 Vali Loss: 1.411 Vali Acc: 0.270 Test Loss: 1.411 Test Acc: 0.270
Validation loss decreased (inf --> -0.270256).  Saving model ...
Epoch: 2 cost time: 1.3075230121612549
Epoch: 2, Steps: 10 | Train Loss: 1.336 Vali Loss: 1.357 Vali Acc: 0.338 Test Loss: 1.357 Test Acc: 0.338
Validation loss decreased (-0.270256 --> -0.337824).  Saving model ...
Epoch: 3 cost time: 1.1739192008972168
Epoch: 3, Steps: 10 | Train Loss: 1.173 Vali Loss: 1.320 Vali Acc: 0.392 Test Loss: 1.320 Test Acc: 0.392
Validation loss decreased (-0.337824 --> -0.391879).  Saving model ...
Epoch: 4 cost time: 1.5578999519348145
Epoch: 4, Steps: 10 | Train Loss: 0.963 Vali Loss: 1.258 Vali Acc: 0.446 Test Loss: 1.258 Test Acc: 0.446
Validation loss decreased (-0.391879 --> -0.445933).  Saving model ...
Epoch: 5 cost time: 1.4300987720489502
Epoch: 5, Steps: 10 | Train Loss: 0.811 Vali Loss: 1.184 Vali Acc: 0.541 Test Loss: 1.184 Test Acc: 0.541
Validation loss decreased (-0.445933 --> -0.540529).  Saving model ...
Epoch: 6 cost time: 1.378523349761963
Epoch: 6, Steps: 10 | Train Loss: 0.642 Vali Loss: 1.144 Vali Acc: 0.514 Test Loss: 1.144 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4245185852050781
Epoch: 7, Steps: 10 | Train Loss: 0.473 Vali Loss: 1.103 Vali Acc: 0.568 Test Loss: 1.103 Test Acc: 0.568
Validation loss decreased (-0.540529 --> -0.567557).  Saving model ...
Epoch: 8 cost time: 1.4719197750091553
Epoch: 8, Steps: 10 | Train Loss: 0.350 Vali Loss: 1.069 Vali Acc: 0.568 Test Loss: 1.069 Test Acc: 0.568
Validation loss decreased (-0.567557 --> -0.567557).  Saving model ...
Epoch: 9 cost time: 1.4272799491882324
Epoch: 9, Steps: 10 | Train Loss: 0.237 Vali Loss: 1.095 Vali Acc: 0.595 Test Loss: 1.095 Test Acc: 0.595
Validation loss decreased (-0.567557 --> -0.594584).  Saving model ...
Epoch: 10 cost time: 1.499725103378296
Epoch: 10, Steps: 10 | Train Loss: 0.142 Vali Loss: 1.053 Vali Acc: 0.608 Test Loss: 1.053 Test Acc: 0.608
Validation loss decreased (-0.594584 --> -0.608098).  Saving model ...
Epoch: 11 cost time: 1.472940444946289
Epoch: 11, Steps: 10 | Train Loss: 0.091 Vali Loss: 1.067 Vali Acc: 0.554 Test Loss: 1.067 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4758634567260742
Epoch: 12, Steps: 10 | Train Loss: 0.055 Vali Loss: 1.071 Vali Acc: 0.635 Test Loss: 1.071 Test Acc: 0.635
Validation loss decreased (-0.608098 --> -0.635124).  Saving model ...
Epoch: 13 cost time: 1.5170392990112305
Epoch: 13, Steps: 10 | Train Loss: 0.039 Vali Loss: 1.022 Vali Acc: 0.649 Test Loss: 1.022 Test Acc: 0.649
Validation loss decreased (-0.635124 --> -0.648638).  Saving model ...
Epoch: 14 cost time: 1.5063493251800537
Epoch: 14, Steps: 10 | Train Loss: 0.048 Vali Loss: 1.091 Vali Acc: 0.608 Test Loss: 1.091 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4489915370941162
Epoch: 15, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.031 Vali Acc: 0.581 Test Loss: 1.031 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.4366514682769775
Epoch: 16, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.060 Vali Acc: 0.608 Test Loss: 1.060 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.4353790283203125
Epoch: 17, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.071 Vali Acc: 0.622 Test Loss: 1.071 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.2794053554534912
Epoch: 18, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.051 Vali Acc: 0.622 Test Loss: 1.051 Test Acc: 0.622
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.278226375579834
Epoch: 19, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.054 Vali Acc: 0.622 Test Loss: 1.054 Test Acc: 0.622
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.2832562923431396
Epoch: 20, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.086 Vali Acc: 0.595 Test Loss: 1.086 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.2011651992797852
Epoch: 21, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.059 Vali Acc: 0.649 Test Loss: 1.059 Test Acc: 0.649
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.053903341293335
Epoch: 22, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.103 Vali Acc: 0.622 Test Loss: 1.103 Test Acc: 0.622
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.308065414428711
Epoch: 23, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.115 Vali Acc: 0.622 Test Loss: 1.115 Test Acc: 0.622
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm32_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6486486486486487
model parameter : 1429892
model size : 6.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm32_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.887842893600464
Epoch: 1, Steps: 10 | Train Loss: 1.428 Vali Loss: 1.470 Vali Acc: 0.162 Test Loss: 1.470 Test Acc: 0.162
Validation loss decreased (inf --> -0.162147).  Saving model ...
Epoch: 2 cost time: 3.397970676422119
Epoch: 2, Steps: 10 | Train Loss: 1.349 Vali Loss: 1.383 Vali Acc: 0.338 Test Loss: 1.383 Test Acc: 0.338
Validation loss decreased (-0.162147 --> -0.337824).  Saving model ...
Epoch: 3 cost time: 3.468186616897583
Epoch: 3, Steps: 10 | Train Loss: 1.112 Vali Loss: 1.306 Vali Acc: 0.351 Test Loss: 1.306 Test Acc: 0.351
Validation loss decreased (-0.337824 --> -0.351338).  Saving model ...
Epoch: 4 cost time: 3.3096561431884766
Epoch: 4, Steps: 10 | Train Loss: 0.908 Vali Loss: 1.248 Vali Acc: 0.500 Test Loss: 1.248 Test Acc: 0.500
Validation loss decreased (-0.351338 --> -0.499988).  Saving model ...
Epoch: 5 cost time: 3.432084560394287
Epoch: 5, Steps: 10 | Train Loss: 0.685 Vali Loss: 1.171 Vali Acc: 0.486 Test Loss: 1.171 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.3340342044830322
Epoch: 6, Steps: 10 | Train Loss: 0.517 Vali Loss: 1.132 Vali Acc: 0.527 Test Loss: 1.132 Test Acc: 0.527
Validation loss decreased (-0.499988 --> -0.527016).  Saving model ...
Epoch: 7 cost time: 3.2199766635894775
Epoch: 7, Steps: 10 | Train Loss: 0.351 Vali Loss: 1.120 Vali Acc: 0.514 Test Loss: 1.120 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.918865919113159
Epoch: 8, Steps: 10 | Train Loss: 0.223 Vali Loss: 1.095 Vali Acc: 0.568 Test Loss: 1.095 Test Acc: 0.568
Validation loss decreased (-0.527016 --> -0.567557).  Saving model ...
Epoch: 9 cost time: 2.890322685241699
Epoch: 9, Steps: 10 | Train Loss: 0.130 Vali Loss: 1.068 Vali Acc: 0.608 Test Loss: 1.068 Test Acc: 0.608
Validation loss decreased (-0.567557 --> -0.608097).  Saving model ...
Epoch: 10 cost time: 2.6346235275268555
Epoch: 10, Steps: 10 | Train Loss: 0.073 Vali Loss: 1.078 Vali Acc: 0.554 Test Loss: 1.078 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.8197014331817627
Epoch: 11, Steps: 10 | Train Loss: 0.042 Vali Loss: 1.158 Vali Acc: 0.514 Test Loss: 1.158 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.0255813598632812
Epoch: 12, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.174 Vali Acc: 0.541 Test Loss: 1.174 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.4898245334625244
Epoch: 13, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.183 Vali Acc: 0.581 Test Loss: 1.183 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.22049617767334
Epoch: 14, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.152 Vali Acc: 0.595 Test Loss: 1.152 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.267975091934204
Epoch: 15, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.198 Vali Acc: 0.581 Test Loss: 1.198 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.390636682510376
Epoch: 16, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.209 Vali Acc: 0.581 Test Loss: 1.209 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.349043607711792
Epoch: 17, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.219 Vali Acc: 0.554 Test Loss: 1.219 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 3.2643446922302246
Epoch: 18, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.213 Vali Acc: 0.554 Test Loss: 1.213 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.4115002155303955
Epoch: 19, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.222 Vali Acc: 0.568 Test Loss: 1.222 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm32_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 2396420
model size : 9.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm32_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.975492000579834
Epoch: 1, Steps: 10 | Train Loss: 1.429 Vali Loss: 1.334 Vali Acc: 0.338 Test Loss: 1.334 Test Acc: 0.338
Validation loss decreased (inf --> -0.337824).  Saving model ...
Epoch: 2 cost time: 1.3742616176605225
Epoch: 2, Steps: 10 | Train Loss: 1.306 Vali Loss: 1.290 Vali Acc: 0.432 Test Loss: 1.290 Test Acc: 0.432
Validation loss decreased (-0.337824 --> -0.432420).  Saving model ...
Epoch: 3 cost time: 1.6035032272338867
Epoch: 3, Steps: 10 | Train Loss: 1.132 Vali Loss: 1.228 Vali Acc: 0.392 Test Loss: 1.228 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3844656944274902
Epoch: 4, Steps: 10 | Train Loss: 0.921 Vali Loss: 1.165 Vali Acc: 0.649 Test Loss: 1.165 Test Acc: 0.649
Validation loss decreased (-0.432420 --> -0.648637).  Saving model ...
Epoch: 5 cost time: 1.5688612461090088
Epoch: 5, Steps: 10 | Train Loss: 0.709 Vali Loss: 1.145 Vali Acc: 0.595 Test Loss: 1.145 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.330230474472046
Epoch: 6, Steps: 10 | Train Loss: 0.529 Vali Loss: 1.061 Vali Acc: 0.608 Test Loss: 1.061 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.6908612251281738
Epoch: 7, Steps: 10 | Train Loss: 0.384 Vali Loss: 1.040 Vali Acc: 0.581 Test Loss: 1.040 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.7822763919830322
Epoch: 8, Steps: 10 | Train Loss: 0.250 Vali Loss: 1.014 Vali Acc: 0.554 Test Loss: 1.014 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.6921615600585938
Epoch: 9, Steps: 10 | Train Loss: 0.155 Vali Loss: 1.018 Vali Acc: 0.554 Test Loss: 1.018 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.8179214000701904
Epoch: 10, Steps: 10 | Train Loss: 0.087 Vali Loss: 1.016 Vali Acc: 0.608 Test Loss: 1.016 Test Acc: 0.608
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.9207732677459717
Epoch: 11, Steps: 10 | Train Loss: 0.055 Vali Loss: 1.019 Vali Acc: 0.608 Test Loss: 1.019 Test Acc: 0.608
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.7056169509887695
Epoch: 12, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.964 Vali Acc: 0.581 Test Loss: 0.964 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.6973681449890137
Epoch: 13, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.044 Vali Acc: 0.622 Test Loss: 1.044 Test Acc: 0.622
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.733734369277954
Epoch: 14, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.006 Vali Acc: 0.595 Test Loss: 1.006 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm32_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6486486486486487
model parameter : 741252
model size : 3.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm32_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.574138641357422
Epoch: 1, Steps: 10 | Train Loss: 1.429 Vali Loss: 1.470 Vali Acc: 0.162 Test Loss: 1.470 Test Acc: 0.162
Validation loss decreased (inf --> -0.162147).  Saving model ...
Epoch: 2 cost time: 2.2818591594696045
Epoch: 2, Steps: 10 | Train Loss: 1.350 Vali Loss: 1.388 Vali Acc: 0.338 Test Loss: 1.388 Test Acc: 0.338
Validation loss decreased (-0.162147 --> -0.337824).  Saving model ...
Epoch: 3 cost time: 1.9183180332183838
Epoch: 3, Steps: 10 | Train Loss: 1.115 Vali Loss: 1.311 Vali Acc: 0.338 Test Loss: 1.311 Test Acc: 0.338
Validation loss decreased (-0.337824 --> -0.337825).  Saving model ...
Epoch: 4 cost time: 2.3060333728790283
Epoch: 4, Steps: 10 | Train Loss: 0.908 Vali Loss: 1.256 Vali Acc: 0.459 Test Loss: 1.256 Test Acc: 0.459
Validation loss decreased (-0.337825 --> -0.459447).  Saving model ...
Epoch: 5 cost time: 2.2418441772460938
Epoch: 5, Steps: 10 | Train Loss: 0.692 Vali Loss: 1.177 Vali Acc: 0.500 Test Loss: 1.177 Test Acc: 0.500
Validation loss decreased (-0.459447 --> -0.499988).  Saving model ...
Epoch: 6 cost time: 2.121163845062256
Epoch: 6, Steps: 10 | Train Loss: 0.515 Vali Loss: 1.131 Vali Acc: 0.541 Test Loss: 1.131 Test Acc: 0.541
Validation loss decreased (-0.499988 --> -0.540529).  Saving model ...
Epoch: 7 cost time: 2.578705072402954
Epoch: 7, Steps: 10 | Train Loss: 0.377 Vali Loss: 1.122 Vali Acc: 0.514 Test Loss: 1.122 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.452026844024658
Epoch: 8, Steps: 10 | Train Loss: 0.247 Vali Loss: 1.077 Vali Acc: 0.568 Test Loss: 1.077 Test Acc: 0.568
Validation loss decreased (-0.540529 --> -0.567557).  Saving model ...
Epoch: 9 cost time: 2.5892691612243652
Epoch: 9, Steps: 10 | Train Loss: 0.137 Vali Loss: 1.037 Vali Acc: 0.595 Test Loss: 1.037 Test Acc: 0.595
Validation loss decreased (-0.567557 --> -0.594584).  Saving model ...
Epoch: 10 cost time: 2.5976476669311523
Epoch: 10, Steps: 10 | Train Loss: 0.073 Vali Loss: 1.032 Vali Acc: 0.608 Test Loss: 1.032 Test Acc: 0.608
Validation loss decreased (-0.594584 --> -0.608098).  Saving model ...
Epoch: 11 cost time: 2.582501173019409
Epoch: 11, Steps: 10 | Train Loss: 0.061 Vali Loss: 1.089 Vali Acc: 0.595 Test Loss: 1.089 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.375444173812866
Epoch: 12, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.085 Vali Acc: 0.608 Test Loss: 1.085 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.6024274826049805
Epoch: 13, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.073 Vali Acc: 0.608 Test Loss: 1.073 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.37375807762146
Epoch: 14, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.108 Vali Acc: 0.554 Test Loss: 1.108 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.346303701400757
Epoch: 15, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.196 Vali Acc: 0.554 Test Loss: 1.196 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.329033613204956
Epoch: 16, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.139 Vali Acc: 0.581 Test Loss: 1.139 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.1219940185546875
Epoch: 17, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.148 Vali Acc: 0.581 Test Loss: 1.148 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.020368814468384
Epoch: 18, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.185 Vali Acc: 0.581 Test Loss: 1.185 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.001451253890991
Epoch: 19, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.193 Vali Acc: 0.581 Test Loss: 1.193 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.1714861392974854
Epoch: 20, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.180 Vali Acc: 0.595 Test Loss: 1.180 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm32_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 2396420
model size : 9.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm32_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.9051692485809326
Epoch: 1, Steps: 10 | Train Loss: 1.434 Vali Loss: 1.335 Vali Acc: 0.311 Test Loss: 1.335 Test Acc: 0.311
Validation loss decreased (inf --> -0.310797).  Saving model ...
Epoch: 2 cost time: 1.3816065788269043
Epoch: 2, Steps: 10 | Train Loss: 1.310 Vali Loss: 1.292 Vali Acc: 0.432 Test Loss: 1.292 Test Acc: 0.432
Validation loss decreased (-0.310797 --> -0.432420).  Saving model ...
Epoch: 3 cost time: 1.3656830787658691
Epoch: 3, Steps: 10 | Train Loss: 1.147 Vali Loss: 1.229 Vali Acc: 0.392 Test Loss: 1.229 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4107325077056885
Epoch: 4, Steps: 10 | Train Loss: 0.933 Vali Loss: 1.166 Vali Acc: 0.622 Test Loss: 1.166 Test Acc: 0.622
Validation loss decreased (-0.432420 --> -0.621610).  Saving model ...
Epoch: 5 cost time: 1.3908283710479736
Epoch: 5, Steps: 10 | Train Loss: 0.724 Vali Loss: 1.148 Vali Acc: 0.581 Test Loss: 1.148 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5534193515777588
Epoch: 6, Steps: 10 | Train Loss: 0.550 Vali Loss: 1.058 Vali Acc: 0.595 Test Loss: 1.058 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.428650140762329
Epoch: 7, Steps: 10 | Train Loss: 0.403 Vali Loss: 1.034 Vali Acc: 0.595 Test Loss: 1.034 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.3995022773742676
Epoch: 8, Steps: 10 | Train Loss: 0.269 Vali Loss: 0.995 Vali Acc: 0.568 Test Loss: 0.995 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.3432457447052002
Epoch: 9, Steps: 10 | Train Loss: 0.170 Vali Loss: 0.974 Vali Acc: 0.568 Test Loss: 0.974 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.8812055587768555
Epoch: 10, Steps: 10 | Train Loss: 0.100 Vali Loss: 1.002 Vali Acc: 0.595 Test Loss: 1.002 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.2093369960784912
Epoch: 11, Steps: 10 | Train Loss: 0.062 Vali Loss: 0.965 Vali Acc: 0.608 Test Loss: 0.965 Test Acc: 0.608
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.293363332748413
Epoch: 12, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.917 Vali Acc: 0.595 Test Loss: 0.917 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.2448811531066895
Epoch: 13, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.011 Vali Acc: 0.635 Test Loss: 1.011 Test Acc: 0.635
Validation loss decreased (-0.621610 --> -0.635125).  Saving model ...
Epoch: 14 cost time: 1.1011381149291992
Epoch: 14, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.945 Vali Acc: 0.608 Test Loss: 0.945 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1998071670532227
Epoch: 15, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.931 Vali Acc: 0.608 Test Loss: 0.931 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.257868766784668
Epoch: 16, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.958 Vali Acc: 0.622 Test Loss: 0.958 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.2025680541992188
Epoch: 17, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.957 Vali Acc: 0.622 Test Loss: 0.957 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.280869483947754
Epoch: 18, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.976 Vali Acc: 0.635 Test Loss: 0.976 Test Acc: 0.635
Validation loss decreased (-0.635125 --> -0.635125).  Saving model ...
Epoch: 19 cost time: 1.4340388774871826
Epoch: 19, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.982 Vali Acc: 0.622 Test Loss: 0.982 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.3807711601257324
Epoch: 20, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.000 Vali Acc: 0.635 Test Loss: 1.000 Test Acc: 0.635
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.3983032703399658
Epoch: 21, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.014 Vali Acc: 0.635 Test Loss: 1.014 Test Acc: 0.635
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.4062130451202393
Epoch: 22, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.977 Vali Acc: 0.649 Test Loss: 0.977 Test Acc: 0.649
Validation loss decreased (-0.635125 --> -0.648639).  Saving model ...
Epoch: 23 cost time: 1.4098701477050781
Epoch: 23, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.970 Vali Acc: 0.649 Test Loss: 0.970 Test Acc: 0.649
Validation loss decreased (-0.648639 --> -0.648639).  Saving model ...
Epoch: 24 cost time: 1.4062621593475342
Epoch: 24, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.042 Vali Acc: 0.608 Test Loss: 1.042 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.467775583267212
Epoch: 25, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.077 Vali Acc: 0.635 Test Loss: 1.077 Test Acc: 0.635
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.389829158782959
Epoch: 26, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.128 Vali Acc: 0.649 Test Loss: 1.128 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.417072057723999
Epoch: 27, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.066 Vali Acc: 0.622 Test Loss: 1.066 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.3863303661346436
Epoch: 28, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.082 Vali Acc: 0.608 Test Loss: 1.082 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.4149487018585205
Epoch: 29, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.108 Vali Acc: 0.608 Test Loss: 1.108 Test Acc: 0.608
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.4234330654144287
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.085 Vali Acc: 0.622 Test Loss: 1.085 Test Acc: 0.622
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm32_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6486486486486487
model parameter : 741252
model size : 3.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm32_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.9730260372161865
Epoch: 1, Steps: 10 | Train Loss: 1.429 Vali Loss: 1.472 Vali Acc: 0.122 Test Loss: 1.472 Test Acc: 0.122
Validation loss decreased (inf --> -0.121607).  Saving model ...
Epoch: 2 cost time: 1.751298427581787
Epoch: 2, Steps: 10 | Train Loss: 1.359 Vali Loss: 1.390 Vali Acc: 0.351 Test Loss: 1.390 Test Acc: 0.351
Validation loss decreased (-0.121607 --> -0.351337).  Saving model ...
Epoch: 3 cost time: 1.7479221820831299
Epoch: 3, Steps: 10 | Train Loss: 1.149 Vali Loss: 1.317 Vali Acc: 0.338 Test Loss: 1.317 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.792344570159912
Epoch: 4, Steps: 10 | Train Loss: 0.973 Vali Loss: 1.260 Vali Acc: 0.419 Test Loss: 1.260 Test Acc: 0.419
Validation loss decreased (-0.351337 --> -0.418906).  Saving model ...
Epoch: 5 cost time: 1.7640540599822998
Epoch: 5, Steps: 10 | Train Loss: 0.768 Vali Loss: 1.181 Vali Acc: 0.432 Test Loss: 1.181 Test Acc: 0.432
Validation loss decreased (-0.418906 --> -0.432421).  Saving model ...
Epoch: 6 cost time: 1.7595367431640625
Epoch: 6, Steps: 10 | Train Loss: 0.614 Vali Loss: 1.140 Vali Acc: 0.500 Test Loss: 1.140 Test Acc: 0.500
Validation loss decreased (-0.432421 --> -0.499989).  Saving model ...
Epoch: 7 cost time: 1.7424674034118652
Epoch: 7, Steps: 10 | Train Loss: 0.450 Vali Loss: 1.099 Vali Acc: 0.500 Test Loss: 1.099 Test Acc: 0.500
Validation loss decreased (-0.499989 --> -0.499989).  Saving model ...
Epoch: 8 cost time: 1.7858402729034424
Epoch: 8, Steps: 10 | Train Loss: 0.314 Vali Loss: 1.042 Vali Acc: 0.554 Test Loss: 1.042 Test Acc: 0.554
Validation loss decreased (-0.499989 --> -0.554044).  Saving model ...
Epoch: 9 cost time: 1.7912218570709229
Epoch: 9, Steps: 10 | Train Loss: 0.199 Vali Loss: 1.003 Vali Acc: 0.595 Test Loss: 1.003 Test Acc: 0.595
Validation loss decreased (-0.554044 --> -0.594585).  Saving model ...
Epoch: 10 cost time: 1.7791657447814941
Epoch: 10, Steps: 10 | Train Loss: 0.120 Vali Loss: 0.948 Vali Acc: 0.554 Test Loss: 0.948 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8147447109222412
Epoch: 11, Steps: 10 | Train Loss: 0.067 Vali Loss: 0.954 Vali Acc: 0.608 Test Loss: 0.954 Test Acc: 0.608
Validation loss decreased (-0.594585 --> -0.608099).  Saving model ...
Epoch: 12 cost time: 1.6135838031768799
Epoch: 12, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.967 Vali Acc: 0.595 Test Loss: 0.967 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3979027271270752
Epoch: 13, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.977 Vali Acc: 0.595 Test Loss: 0.977 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.6575138568878174
Epoch: 14, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.998 Vali Acc: 0.595 Test Loss: 0.998 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.3823201656341553
Epoch: 15, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.020 Vali Acc: 0.595 Test Loss: 1.020 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.5130956172943115
Epoch: 16, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.009 Vali Acc: 0.581 Test Loss: 1.009 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.5572535991668701
Epoch: 17, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.052 Vali Acc: 0.595 Test Loss: 1.052 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.6450059413909912
Epoch: 18, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.024 Vali Acc: 0.635 Test Loss: 1.024 Test Acc: 0.635
Validation loss decreased (-0.608099 --> -0.635125).  Saving model ...
Epoch: 19 cost time: 1.8179271221160889
Epoch: 19, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.047 Vali Acc: 0.608 Test Loss: 1.047 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.7746312618255615
Epoch: 20, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.072 Vali Acc: 0.595 Test Loss: 1.072 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.820354700088501
Epoch: 21, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.083 Vali Acc: 0.595 Test Loss: 1.083 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.8270237445831299
Epoch: 22, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.080 Vali Acc: 0.595 Test Loss: 1.080 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.809727430343628
Epoch: 23, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.127 Vali Acc: 0.608 Test Loss: 1.127 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.8180773258209229
Epoch: 24, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.141 Vali Acc: 0.608 Test Loss: 1.141 Test Acc: 0.608
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.751708984375
Epoch: 25, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.140 Vali Acc: 0.622 Test Loss: 1.140 Test Acc: 0.622
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.7759919166564941
Epoch: 26, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.138 Vali Acc: 0.608 Test Loss: 1.138 Test Acc: 0.608
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.7615509033203125
Epoch: 27, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.179 Vali Acc: 0.622 Test Loss: 1.179 Test Acc: 0.622
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.791905403137207
Epoch: 28, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.218 Vali Acc: 0.608 Test Loss: 1.218 Test Acc: 0.608
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm32_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6351351351351351
model parameter : 2396420
model size : 9.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm32_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.3432085514068604
Epoch: 1, Steps: 10 | Train Loss: 1.432 Vali Loss: 1.336 Vali Acc: 0.351 Test Loss: 1.336 Test Acc: 0.351
Validation loss decreased (inf --> -0.351338).  Saving model ...
Epoch: 2 cost time: 0.9611833095550537
Epoch: 2, Steps: 10 | Train Loss: 1.312 Vali Loss: 1.285 Vali Acc: 0.473 Test Loss: 1.285 Test Acc: 0.473
Validation loss decreased (-0.351338 --> -0.472960).  Saving model ...
Epoch: 3 cost time: 0.7635703086853027
Epoch: 3, Steps: 10 | Train Loss: 1.154 Vali Loss: 1.221 Vali Acc: 0.405 Test Loss: 1.221 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.086998462677002
Epoch: 4, Steps: 10 | Train Loss: 0.963 Vali Loss: 1.163 Vali Acc: 0.541 Test Loss: 1.163 Test Acc: 0.541
Validation loss decreased (-0.472960 --> -0.540529).  Saving model ...
Epoch: 5 cost time: 1.1665308475494385
Epoch: 5, Steps: 10 | Train Loss: 0.774 Vali Loss: 1.126 Vali Acc: 0.568 Test Loss: 1.126 Test Acc: 0.568
Validation loss decreased (-0.540529 --> -0.567556).  Saving model ...
Epoch: 6 cost time: 0.9848363399505615
Epoch: 6, Steps: 10 | Train Loss: 0.601 Vali Loss: 1.055 Vali Acc: 0.608 Test Loss: 1.055 Test Acc: 0.608
Validation loss decreased (-0.567556 --> -0.608098).  Saving model ...
Epoch: 7 cost time: 1.0088982582092285
Epoch: 7, Steps: 10 | Train Loss: 0.459 Vali Loss: 1.025 Vali Acc: 0.581 Test Loss: 1.025 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.054868459701538
Epoch: 8, Steps: 10 | Train Loss: 0.324 Vali Loss: 0.974 Vali Acc: 0.595 Test Loss: 0.974 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.015765905380249
Epoch: 9, Steps: 10 | Train Loss: 0.215 Vali Loss: 0.994 Vali Acc: 0.568 Test Loss: 0.994 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.9977424144744873
Epoch: 10, Steps: 10 | Train Loss: 0.134 Vali Loss: 0.999 Vali Acc: 0.622 Test Loss: 0.999 Test Acc: 0.622
Validation loss decreased (-0.608098 --> -0.621612).  Saving model ...
Epoch: 11 cost time: 1.0649211406707764
Epoch: 11, Steps: 10 | Train Loss: 0.093 Vali Loss: 0.922 Vali Acc: 0.608 Test Loss: 0.922 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1019408702850342
Epoch: 12, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.957 Vali Acc: 0.635 Test Loss: 0.957 Test Acc: 0.635
Validation loss decreased (-0.621612 --> -0.635126).  Saving model ...
Epoch: 13 cost time: 1.1289103031158447
Epoch: 13, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.951 Vali Acc: 0.608 Test Loss: 0.951 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1037800312042236
Epoch: 14, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.937 Vali Acc: 0.635 Test Loss: 0.937 Test Acc: 0.635
Validation loss decreased (-0.635126 --> -0.635126).  Saving model ...
Epoch: 15 cost time: 1.113466739654541
Epoch: 15, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.979 Vali Acc: 0.676 Test Loss: 0.979 Test Acc: 0.676
Validation loss decreased (-0.635126 --> -0.675666).  Saving model ...
Epoch: 16 cost time: 1.1382789611816406
Epoch: 16, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.956 Vali Acc: 0.649 Test Loss: 0.956 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1086831092834473
Epoch: 17, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.954 Vali Acc: 0.635 Test Loss: 0.954 Test Acc: 0.635
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9871635437011719
Epoch: 18, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.997 Vali Acc: 0.662 Test Loss: 0.997 Test Acc: 0.662
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.9832391738891602
Epoch: 19, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.987 Vali Acc: 0.676 Test Loss: 0.987 Test Acc: 0.676
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.965040922164917
Epoch: 20, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.985 Vali Acc: 0.662 Test Loss: 0.985 Test Acc: 0.662
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.996690034866333
Epoch: 21, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.991 Vali Acc: 0.676 Test Loss: 0.991 Test Acc: 0.676
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.9052720069885254
Epoch: 22, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.018 Vali Acc: 0.662 Test Loss: 1.018 Test Acc: 0.662
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.0014784336090088
Epoch: 23, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.019 Vali Acc: 0.662 Test Loss: 1.019 Test Acc: 0.662
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.029029369354248
Epoch: 24, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.035 Vali Acc: 0.662 Test Loss: 1.035 Test Acc: 0.662
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.0058505535125732
Epoch: 25, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.026 Vali Acc: 0.676 Test Loss: 1.026 Test Acc: 0.676
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm32_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6756756756756757
model parameter : 741252
model size : 3.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm32_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.653961181640625
Epoch: 1, Steps: 10 | Train Loss: 1.433 Vali Loss: 1.367 Vali Acc: 0.365 Test Loss: 1.367 Test Acc: 0.365
Validation loss decreased (inf --> -0.364851).  Saving model ...
Epoch: 2 cost time: 2.310276508331299
Epoch: 2, Steps: 10 | Train Loss: 1.343 Vali Loss: 1.303 Vali Acc: 0.473 Test Loss: 1.303 Test Acc: 0.473
Validation loss decreased (-0.364851 --> -0.472960).  Saving model ...
Epoch: 3 cost time: 2.25394868850708
Epoch: 3, Steps: 10 | Train Loss: 1.138 Vali Loss: 1.250 Vali Acc: 0.527 Test Loss: 1.250 Test Acc: 0.527
Validation loss decreased (-0.472960 --> -0.527015).  Saving model ...
Epoch: 4 cost time: 2.246500015258789
Epoch: 4, Steps: 10 | Train Loss: 0.939 Vali Loss: 1.180 Vali Acc: 0.581 Test Loss: 1.180 Test Acc: 0.581
Validation loss decreased (-0.527015 --> -0.581069).  Saving model ...
Epoch: 5 cost time: 2.2824676036834717
Epoch: 5, Steps: 10 | Train Loss: 0.741 Vali Loss: 1.113 Vali Acc: 0.581 Test Loss: 1.113 Test Acc: 0.581
Validation loss decreased (-0.581069 --> -0.581070).  Saving model ...
Epoch: 6 cost time: 2.2650256156921387
Epoch: 6, Steps: 10 | Train Loss: 0.563 Vali Loss: 1.100 Vali Acc: 0.568 Test Loss: 1.100 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7470839023590088
Epoch: 7, Steps: 10 | Train Loss: 0.437 Vali Loss: 1.064 Vali Acc: 0.568 Test Loss: 1.064 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.933767557144165
Epoch: 8, Steps: 10 | Train Loss: 0.287 Vali Loss: 1.027 Vali Acc: 0.581 Test Loss: 1.027 Test Acc: 0.581
Validation loss decreased (-0.581070 --> -0.581071).  Saving model ...
Epoch: 9 cost time: 1.9482839107513428
Epoch: 9, Steps: 10 | Train Loss: 0.194 Vali Loss: 1.041 Vali Acc: 0.581 Test Loss: 1.041 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.0380494594573975
Epoch: 10, Steps: 10 | Train Loss: 0.110 Vali Loss: 1.028 Vali Acc: 0.608 Test Loss: 1.028 Test Acc: 0.608
Validation loss decreased (-0.581071 --> -0.608098).  Saving model ...
Epoch: 11 cost time: 1.991264820098877
Epoch: 11, Steps: 10 | Train Loss: 0.070 Vali Loss: 1.061 Vali Acc: 0.554 Test Loss: 1.061 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.972848653793335
Epoch: 12, Steps: 10 | Train Loss: 0.036 Vali Loss: 1.106 Vali Acc: 0.581 Test Loss: 1.106 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.9625518321990967
Epoch: 13, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.078 Vali Acc: 0.554 Test Loss: 1.078 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.2986979484558105
Epoch: 14, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.081 Vali Acc: 0.541 Test Loss: 1.081 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.3394434452056885
Epoch: 15, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.121 Vali Acc: 0.622 Test Loss: 1.121 Test Acc: 0.622
Validation loss decreased (-0.608098 --> -0.621610).  Saving model ...
Epoch: 16 cost time: 2.3696036338806152
Epoch: 16, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.134 Vali Acc: 0.595 Test Loss: 1.134 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.286558151245117
Epoch: 17, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.146 Vali Acc: 0.595 Test Loss: 1.146 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.280994415283203
Epoch: 18, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.168 Vali Acc: 0.595 Test Loss: 1.168 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.262539863586426
Epoch: 19, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.201 Vali Acc: 0.595 Test Loss: 1.201 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.32205867767334
Epoch: 20, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.209 Vali Acc: 0.595 Test Loss: 1.209 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.300077199935913
Epoch: 21, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.215 Vali Acc: 0.581 Test Loss: 1.215 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.38618803024292
Epoch: 22, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.243 Vali Acc: 0.595 Test Loss: 1.243 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.208178758621216
Epoch: 23, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.258 Vali Acc: 0.595 Test Loss: 1.258 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.8272740840911865
Epoch: 24, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.268 Vali Acc: 0.595 Test Loss: 1.268 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.9347362518310547
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.265 Vali Acc: 0.595 Test Loss: 1.265 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm32_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 1224580
model size : 5.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm32_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.6483371257781982
Epoch: 1, Steps: 10 | Train Loss: 1.394 Vali Loss: 1.342 Vali Acc: 0.351 Test Loss: 1.342 Test Acc: 0.351
Validation loss decreased (inf --> -0.351338).  Saving model ...
Epoch: 2 cost time: 1.1992671489715576
Epoch: 2, Steps: 10 | Train Loss: 1.316 Vali Loss: 1.281 Vali Acc: 0.459 Test Loss: 1.281 Test Acc: 0.459
Validation loss decreased (-0.351338 --> -0.459447).  Saving model ...
Epoch: 3 cost time: 0.9126226902008057
Epoch: 3, Steps: 10 | Train Loss: 1.164 Vali Loss: 1.225 Vali Acc: 0.514 Test Loss: 1.225 Test Acc: 0.514
Validation loss decreased (-0.459447 --> -0.513501).  Saving model ...
Epoch: 4 cost time: 0.9524040222167969
Epoch: 4, Steps: 10 | Train Loss: 0.998 Vali Loss: 1.217 Vali Acc: 0.419 Test Loss: 1.217 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.92340087890625
Epoch: 5, Steps: 10 | Train Loss: 0.793 Vali Loss: 1.106 Vali Acc: 0.486 Test Loss: 1.106 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9165401458740234
Epoch: 6, Steps: 10 | Train Loss: 0.620 Vali Loss: 1.131 Vali Acc: 0.473 Test Loss: 1.131 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.8563508987426758
Epoch: 7, Steps: 10 | Train Loss: 0.456 Vali Loss: 1.060 Vali Acc: 0.554 Test Loss: 1.060 Test Acc: 0.554
Validation loss decreased (-0.513501 --> -0.554043).  Saving model ...
Epoch: 8 cost time: 0.9011693000793457
Epoch: 8, Steps: 10 | Train Loss: 0.322 Vali Loss: 1.079 Vali Acc: 0.527 Test Loss: 1.079 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9578251838684082
Epoch: 9, Steps: 10 | Train Loss: 0.212 Vali Loss: 1.043 Vali Acc: 0.541 Test Loss: 1.043 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9808855056762695
Epoch: 10, Steps: 10 | Train Loss: 0.133 Vali Loss: 1.113 Vali Acc: 0.554 Test Loss: 1.113 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.9248979091644287
Epoch: 11, Steps: 10 | Train Loss: 0.079 Vali Loss: 1.039 Vali Acc: 0.581 Test Loss: 1.039 Test Acc: 0.581
Validation loss decreased (-0.554043 --> -0.581071).  Saving model ...
Epoch: 12 cost time: 0.9026889801025391
Epoch: 12, Steps: 10 | Train Loss: 0.052 Vali Loss: 1.083 Vali Acc: 0.554 Test Loss: 1.083 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9937639236450195
Epoch: 13, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.061 Vali Acc: 0.595 Test Loss: 1.061 Test Acc: 0.595
Validation loss decreased (-0.581071 --> -0.594584).  Saving model ...
Epoch: 14 cost time: 0.8958053588867188
Epoch: 14, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.078 Vali Acc: 0.568 Test Loss: 1.078 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0074424743652344
Epoch: 15, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.117 Vali Acc: 0.568 Test Loss: 1.117 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.197235107421875
Epoch: 16, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.105 Vali Acc: 0.541 Test Loss: 1.105 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.5630443096160889
Epoch: 17, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.125 Vali Acc: 0.554 Test Loss: 1.125 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.5705947875976562
Epoch: 18, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.138 Vali Acc: 0.541 Test Loss: 1.138 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.4984731674194336
Epoch: 19, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.138 Vali Acc: 0.541 Test Loss: 1.138 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.554633378982544
Epoch: 20, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.152 Vali Acc: 0.554 Test Loss: 1.152 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.5208165645599365
Epoch: 21, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.154 Vali Acc: 0.568 Test Loss: 1.154 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.509155035018921
Epoch: 22, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.158 Vali Acc: 0.554 Test Loss: 1.158 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.534088373184204
Epoch: 23, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.164 Vali Acc: 0.541 Test Loss: 1.164 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm32_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 396932
model size : 2.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm32_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.3809854984283447
Epoch: 1, Steps: 10 | Train Loss: 1.432 Vali Loss: 1.369 Vali Acc: 0.365 Test Loss: 1.369 Test Acc: 0.365
Validation loss decreased (inf --> -0.364851).  Saving model ...
Epoch: 2 cost time: 1.9263050556182861
Epoch: 2, Steps: 10 | Train Loss: 1.347 Vali Loss: 1.302 Vali Acc: 0.432 Test Loss: 1.302 Test Acc: 0.432
Validation loss decreased (-0.364851 --> -0.432419).  Saving model ...
Epoch: 3 cost time: 1.9360573291778564
Epoch: 3, Steps: 10 | Train Loss: 1.150 Vali Loss: 1.247 Vali Acc: 0.500 Test Loss: 1.247 Test Acc: 0.500
Validation loss decreased (-0.432419 --> -0.499988).  Saving model ...
Epoch: 4 cost time: 2.071178436279297
Epoch: 4, Steps: 10 | Train Loss: 0.962 Vali Loss: 1.172 Vali Acc: 0.554 Test Loss: 1.172 Test Acc: 0.554
Validation loss decreased (-0.499988 --> -0.554042).  Saving model ...
Epoch: 5 cost time: 2.137625217437744
Epoch: 5, Steps: 10 | Train Loss: 0.767 Vali Loss: 1.094 Vali Acc: 0.608 Test Loss: 1.094 Test Acc: 0.608
Validation loss decreased (-0.554042 --> -0.608097).  Saving model ...
Epoch: 6 cost time: 2.0966527462005615
Epoch: 6, Steps: 10 | Train Loss: 0.595 Vali Loss: 1.081 Vali Acc: 0.568 Test Loss: 1.081 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.1469833850860596
Epoch: 7, Steps: 10 | Train Loss: 0.469 Vali Loss: 1.026 Vali Acc: 0.608 Test Loss: 1.026 Test Acc: 0.608
Validation loss decreased (-0.608097 --> -0.608098).  Saving model ...
Epoch: 8 cost time: 2.163952350616455
Epoch: 8, Steps: 10 | Train Loss: 0.321 Vali Loss: 1.000 Vali Acc: 0.608 Test Loss: 1.000 Test Acc: 0.608
Validation loss decreased (-0.608098 --> -0.608098).  Saving model ...
Epoch: 9 cost time: 2.0643112659454346
Epoch: 9, Steps: 10 | Train Loss: 0.219 Vali Loss: 1.003 Vali Acc: 0.568 Test Loss: 1.003 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.0920746326446533
Epoch: 10, Steps: 10 | Train Loss: 0.146 Vali Loss: 0.970 Vali Acc: 0.622 Test Loss: 0.970 Test Acc: 0.622
Validation loss decreased (-0.608098 --> -0.621612).  Saving model ...
Epoch: 11 cost time: 2.133755922317505
Epoch: 11, Steps: 10 | Train Loss: 0.093 Vali Loss: 1.034 Vali Acc: 0.635 Test Loss: 1.034 Test Acc: 0.635
Validation loss decreased (-0.621612 --> -0.635125).  Saving model ...
Epoch: 12 cost time: 2.0286717414855957
Epoch: 12, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.987 Vali Acc: 0.622 Test Loss: 0.987 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.0058186054229736
Epoch: 13, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.988 Vali Acc: 0.635 Test Loss: 0.988 Test Acc: 0.635
Validation loss decreased (-0.635125 --> -0.635125).  Saving model ...
Epoch: 14 cost time: 1.9958186149597168
Epoch: 14, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.992 Vali Acc: 0.635 Test Loss: 0.992 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.080791473388672
Epoch: 15, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.064 Vali Acc: 0.608 Test Loss: 1.064 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.0458810329437256
Epoch: 16, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.016 Vali Acc: 0.622 Test Loss: 1.016 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.101877212524414
Epoch: 17, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.034 Vali Acc: 0.635 Test Loss: 1.034 Test Acc: 0.635
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.114983558654785
Epoch: 18, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.047 Vali Acc: 0.635 Test Loss: 1.047 Test Acc: 0.635
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.137070894241333
Epoch: 19, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.075 Vali Acc: 0.635 Test Loss: 1.075 Test Acc: 0.635
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.113785982131958
Epoch: 20, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.070 Vali Acc: 0.635 Test Loss: 1.070 Test Acc: 0.635
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.0591797828674316
Epoch: 21, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.072 Vali Acc: 0.649 Test Loss: 1.072 Test Acc: 0.649
Validation loss decreased (-0.635125 --> -0.648638).  Saving model ...
Epoch: 22 cost time: 2.086317300796509
Epoch: 22, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.111 Vali Acc: 0.622 Test Loss: 1.111 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.1123528480529785
Epoch: 23, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.123 Vali Acc: 0.622 Test Loss: 1.123 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.215832471847534
Epoch: 24, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.134 Vali Acc: 0.622 Test Loss: 1.134 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.0240397453308105
Epoch: 25, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.167 Vali Acc: 0.635 Test Loss: 1.167 Test Acc: 0.635
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.9817819595336914
Epoch: 26, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.155 Vali Acc: 0.635 Test Loss: 1.155 Test Acc: 0.635
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.1118650436401367
Epoch: 27, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.148 Vali Acc: 0.622 Test Loss: 1.148 Test Acc: 0.622
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.05543851852417
Epoch: 28, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.158 Vali Acc: 0.622 Test Loss: 1.158 Test Acc: 0.622
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 2.1549620628356934
Epoch: 29, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.162 Vali Acc: 0.622 Test Loss: 1.162 Test Acc: 0.622
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.986830234527588
Epoch: 30, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.170 Vali Acc: 0.622 Test Loss: 1.170 Test Acc: 0.622
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm32_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6486486486486487
model parameter : 1224580
model size : 5.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm32_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.49876070022583
Epoch: 1, Steps: 10 | Train Loss: 1.392 Vali Loss: 1.340 Vali Acc: 0.311 Test Loss: 1.340 Test Acc: 0.311
Validation loss decreased (inf --> -0.310797).  Saving model ...
Epoch: 2 cost time: 1.2528319358825684
Epoch: 2, Steps: 10 | Train Loss: 1.313 Vali Loss: 1.279 Vali Acc: 0.459 Test Loss: 1.279 Test Acc: 0.459
Validation loss decreased (-0.310797 --> -0.459447).  Saving model ...
Epoch: 3 cost time: 1.254434585571289
Epoch: 3, Steps: 10 | Train Loss: 1.162 Vali Loss: 1.225 Vali Acc: 0.541 Test Loss: 1.225 Test Acc: 0.541
Validation loss decreased (-0.459447 --> -0.540528).  Saving model ...
Epoch: 4 cost time: 1.242971658706665
Epoch: 4, Steps: 10 | Train Loss: 1.000 Vali Loss: 1.222 Vali Acc: 0.419 Test Loss: 1.222 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.29075026512146
Epoch: 5, Steps: 10 | Train Loss: 0.794 Vali Loss: 1.111 Vali Acc: 0.486 Test Loss: 1.111 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.2372500896453857
Epoch: 6, Steps: 10 | Train Loss: 0.623 Vali Loss: 1.139 Vali Acc: 0.500 Test Loss: 1.139 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.2702205181121826
Epoch: 7, Steps: 10 | Train Loss: 0.458 Vali Loss: 1.066 Vali Acc: 0.541 Test Loss: 1.066 Test Acc: 0.541
Validation loss decreased (-0.540528 --> -0.540530).  Saving model ...
Epoch: 8 cost time: 1.2477898597717285
Epoch: 8, Steps: 10 | Train Loss: 0.323 Vali Loss: 1.089 Vali Acc: 0.568 Test Loss: 1.089 Test Acc: 0.568
Validation loss decreased (-0.540530 --> -0.567557).  Saving model ...
Epoch: 9 cost time: 1.2275619506835938
Epoch: 9, Steps: 10 | Train Loss: 0.213 Vali Loss: 1.046 Vali Acc: 0.554 Test Loss: 1.046 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2833561897277832
Epoch: 10, Steps: 10 | Train Loss: 0.129 Vali Loss: 1.165 Vali Acc: 0.541 Test Loss: 1.165 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.2670705318450928
Epoch: 11, Steps: 10 | Train Loss: 0.081 Vali Loss: 1.054 Vali Acc: 0.554 Test Loss: 1.054 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.1975758075714111
Epoch: 12, Steps: 10 | Train Loss: 0.051 Vali Loss: 1.119 Vali Acc: 0.568 Test Loss: 1.119 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.2661850452423096
Epoch: 13, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.083 Vali Acc: 0.568 Test Loss: 1.083 Test Acc: 0.568
Validation loss decreased (-0.567557 --> -0.567557).  Saving model ...
Epoch: 14 cost time: 1.191049337387085
Epoch: 14, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.104 Vali Acc: 0.541 Test Loss: 1.104 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2273409366607666
Epoch: 15, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.147 Vali Acc: 0.554 Test Loss: 1.147 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.217956304550171
Epoch: 16, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.133 Vali Acc: 0.541 Test Loss: 1.133 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.2224228382110596
Epoch: 17, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.145 Vali Acc: 0.541 Test Loss: 1.145 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.2601442337036133
Epoch: 18, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.164 Vali Acc: 0.568 Test Loss: 1.164 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.2236511707305908
Epoch: 19, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.163 Vali Acc: 0.554 Test Loss: 1.163 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.235748052597046
Epoch: 20, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.179 Vali Acc: 0.554 Test Loss: 1.179 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.2018024921417236
Epoch: 21, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.178 Vali Acc: 0.595 Test Loss: 1.178 Test Acc: 0.595
Validation loss decreased (-0.567557 --> -0.594583).  Saving model ...
Epoch: 22 cost time: 1.2731809616088867
Epoch: 22, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.198 Vali Acc: 0.568 Test Loss: 1.198 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.1862399578094482
Epoch: 23, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.214 Vali Acc: 0.568 Test Loss: 1.214 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.2246239185333252
Epoch: 24, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.227 Vali Acc: 0.568 Test Loss: 1.227 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.2442312240600586
Epoch: 25, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.232 Vali Acc: 0.568 Test Loss: 1.232 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.2294714450836182
Epoch: 26, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.231 Vali Acc: 0.581 Test Loss: 1.231 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.2226316928863525
Epoch: 27, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.236 Vali Acc: 0.581 Test Loss: 1.236 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.294783115386963
Epoch: 28, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.245 Vali Acc: 0.581 Test Loss: 1.245 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.2066571712493896
Epoch: 29, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.244 Vali Acc: 0.581 Test Loss: 1.244 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.2154357433319092
Epoch: 30, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.250 Vali Acc: 0.568 Test Loss: 1.250 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm32_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 396932
model size : 2.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm32_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.6818690299987793
Epoch: 1, Steps: 10 | Train Loss: 1.432 Vali Loss: 1.365 Vali Acc: 0.378 Test Loss: 1.365 Test Acc: 0.378
Validation loss decreased (inf --> -0.378365).  Saving model ...
Epoch: 2 cost time: 1.4422953128814697
Epoch: 2, Steps: 10 | Train Loss: 1.349 Vali Loss: 1.301 Vali Acc: 0.486 Test Loss: 1.301 Test Acc: 0.486
Validation loss decreased (-0.378365 --> -0.486473).  Saving model ...
Epoch: 3 cost time: 1.4185543060302734
Epoch: 3, Steps: 10 | Train Loss: 1.155 Vali Loss: 1.247 Vali Acc: 0.554 Test Loss: 1.247 Test Acc: 0.554
Validation loss decreased (-0.486473 --> -0.554042).  Saving model ...
Epoch: 4 cost time: 1.4918537139892578
Epoch: 4, Steps: 10 | Train Loss: 0.969 Vali Loss: 1.174 Vali Acc: 0.581 Test Loss: 1.174 Test Acc: 0.581
Validation loss decreased (-0.554042 --> -0.581069).  Saving model ...
Epoch: 5 cost time: 1.3392584323883057
Epoch: 5, Steps: 10 | Train Loss: 0.784 Vali Loss: 1.101 Vali Acc: 0.568 Test Loss: 1.101 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.4892430305480957
Epoch: 6, Steps: 10 | Train Loss: 0.617 Vali Loss: 1.081 Vali Acc: 0.581 Test Loss: 1.081 Test Acc: 0.581
Validation loss decreased (-0.581069 --> -0.581070).  Saving model ...
Epoch: 7 cost time: 1.4912843704223633
Epoch: 7, Steps: 10 | Train Loss: 0.499 Vali Loss: 1.033 Vali Acc: 0.568 Test Loss: 1.033 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.463325023651123
Epoch: 8, Steps: 10 | Train Loss: 0.344 Vali Loss: 1.006 Vali Acc: 0.595 Test Loss: 1.006 Test Acc: 0.595
Validation loss decreased (-0.581070 --> -0.594585).  Saving model ...
Epoch: 9 cost time: 1.5166230201721191
Epoch: 9, Steps: 10 | Train Loss: 0.246 Vali Loss: 0.988 Vali Acc: 0.595 Test Loss: 0.988 Test Acc: 0.595
Validation loss decreased (-0.594585 --> -0.594585).  Saving model ...
Epoch: 10 cost time: 1.3922853469848633
Epoch: 10, Steps: 10 | Train Loss: 0.152 Vali Loss: 0.948 Vali Acc: 0.608 Test Loss: 0.948 Test Acc: 0.608
Validation loss decreased (-0.594585 --> -0.608099).  Saving model ...
Epoch: 11 cost time: 1.4514243602752686
Epoch: 11, Steps: 10 | Train Loss: 0.100 Vali Loss: 1.026 Vali Acc: 0.649 Test Loss: 1.026 Test Acc: 0.649
Validation loss decreased (-0.608099 --> -0.648638).  Saving model ...
Epoch: 12 cost time: 1.4430537223815918
Epoch: 12, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.930 Vali Acc: 0.635 Test Loss: 0.930 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4196512699127197
Epoch: 13, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.935 Vali Acc: 0.635 Test Loss: 0.935 Test Acc: 0.635
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.4143126010894775
Epoch: 14, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.930 Vali Acc: 0.649 Test Loss: 0.930 Test Acc: 0.649
Validation loss decreased (-0.648638 --> -0.648639).  Saving model ...
Epoch: 15 cost time: 1.2579939365386963
Epoch: 15, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.962 Vali Acc: 0.649 Test Loss: 0.962 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.4618301391601562
Epoch: 16, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.960 Vali Acc: 0.649 Test Loss: 0.960 Test Acc: 0.649
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.4154610633850098
Epoch: 17, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.965 Vali Acc: 0.622 Test Loss: 0.965 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.4742138385772705
Epoch: 18, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.982 Vali Acc: 0.622 Test Loss: 0.982 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.4702754020690918
Epoch: 19, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.015 Vali Acc: 0.622 Test Loss: 1.015 Test Acc: 0.622
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.4581010341644287
Epoch: 20, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.013 Vali Acc: 0.608 Test Loss: 1.013 Test Acc: 0.608
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.3668391704559326
Epoch: 21, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.009 Vali Acc: 0.622 Test Loss: 1.009 Test Acc: 0.622
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.4675250053405762
Epoch: 22, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.065 Vali Acc: 0.649 Test Loss: 1.065 Test Acc: 0.649
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.5429785251617432
Epoch: 23, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.056 Vali Acc: 0.635 Test Loss: 1.056 Test Acc: 0.635
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.431138038635254
Epoch: 24, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.057 Vali Acc: 0.635 Test Loss: 1.057 Test Acc: 0.635
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm32_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6486486486486487
model parameter : 1224580
model size : 5.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm32_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.3023018836975098
Epoch: 1, Steps: 10 | Train Loss: 1.401 Vali Loss: 1.333 Vali Acc: 0.405 Test Loss: 1.333 Test Acc: 0.405
Validation loss decreased (inf --> -0.405392).  Saving model ...
Epoch: 2 cost time: 0.9786460399627686
Epoch: 2, Steps: 10 | Train Loss: 1.329 Vali Loss: 1.273 Vali Acc: 0.459 Test Loss: 1.273 Test Acc: 0.459
Validation loss decreased (-0.405392 --> -0.459447).  Saving model ...
Epoch: 3 cost time: 1.0615229606628418
Epoch: 3, Steps: 10 | Train Loss: 1.191 Vali Loss: 1.222 Vali Acc: 0.554 Test Loss: 1.222 Test Acc: 0.554
Validation loss decreased (-0.459447 --> -0.554042).  Saving model ...
Epoch: 4 cost time: 1.0907938480377197
Epoch: 4, Steps: 10 | Train Loss: 1.034 Vali Loss: 1.226 Vali Acc: 0.446 Test Loss: 1.226 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0121169090270996
Epoch: 5, Steps: 10 | Train Loss: 0.843 Vali Loss: 1.113 Vali Acc: 0.514 Test Loss: 1.113 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9210221767425537
Epoch: 6, Steps: 10 | Train Loss: 0.684 Vali Loss: 1.141 Vali Acc: 0.527 Test Loss: 1.141 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.091989517211914
Epoch: 7, Steps: 10 | Train Loss: 0.531 Vali Loss: 1.059 Vali Acc: 0.568 Test Loss: 1.059 Test Acc: 0.568
Validation loss decreased (-0.554042 --> -0.567557).  Saving model ...
Epoch: 8 cost time: 1.204761028289795
Epoch: 8, Steps: 10 | Train Loss: 0.396 Vali Loss: 1.040 Vali Acc: 0.581 Test Loss: 1.040 Test Acc: 0.581
Validation loss decreased (-0.567557 --> -0.581071).  Saving model ...
Epoch: 9 cost time: 1.1281797885894775
Epoch: 9, Steps: 10 | Train Loss: 0.282 Vali Loss: 0.993 Vali Acc: 0.554 Test Loss: 0.993 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1461012363433838
Epoch: 10, Steps: 10 | Train Loss: 0.185 Vali Loss: 1.078 Vali Acc: 0.554 Test Loss: 1.078 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0889203548431396
Epoch: 11, Steps: 10 | Train Loss: 0.130 Vali Loss: 1.005 Vali Acc: 0.568 Test Loss: 1.005 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.1102979183197021
Epoch: 12, Steps: 10 | Train Loss: 0.080 Vali Loss: 1.046 Vali Acc: 0.568 Test Loss: 1.046 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.1504545211791992
Epoch: 13, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.999 Vali Acc: 0.541 Test Loss: 0.999 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.0310921669006348
Epoch: 14, Steps: 10 | Train Loss: 0.036 Vali Loss: 1.036 Vali Acc: 0.568 Test Loss: 1.036 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.0379681587219238
Epoch: 15, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.034 Vali Acc: 0.568 Test Loss: 1.034 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.1255862712860107
Epoch: 16, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.012 Vali Acc: 0.527 Test Loss: 1.012 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.1005163192749023
Epoch: 17, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.061 Vali Acc: 0.568 Test Loss: 1.061 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.126258134841919
Epoch: 18, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.063 Vali Acc: 0.595 Test Loss: 1.063 Test Acc: 0.595
Validation loss decreased (-0.581071 --> -0.594584).  Saving model ...
Epoch: 19 cost time: 1.127946138381958
Epoch: 19, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.056 Vali Acc: 0.568 Test Loss: 1.056 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.2005925178527832
Epoch: 20, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.084 Vali Acc: 0.608 Test Loss: 1.084 Test Acc: 0.608
Validation loss decreased (-0.594584 --> -0.608097).  Saving model ...
Epoch: 21 cost time: 1.2377288341522217
Epoch: 21, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.080 Vali Acc: 0.608 Test Loss: 1.080 Test Acc: 0.608
Validation loss decreased (-0.608097 --> -0.608097).  Saving model ...
Epoch: 22 cost time: 1.0690391063690186
Epoch: 22, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.082 Vali Acc: 0.581 Test Loss: 1.082 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.100236177444458
Epoch: 23, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.080 Vali Acc: 0.595 Test Loss: 1.080 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.112574815750122
Epoch: 24, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.090 Vali Acc: 0.581 Test Loss: 1.090 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.1374404430389404
Epoch: 25, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.107 Vali Acc: 0.608 Test Loss: 1.107 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.132077693939209
Epoch: 26, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.098 Vali Acc: 0.622 Test Loss: 1.098 Test Acc: 0.622
Validation loss decreased (-0.608097 --> -0.621611).  Saving model ...
Epoch: 27 cost time: 1.2148082256317139
Epoch: 27, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.095 Vali Acc: 0.595 Test Loss: 1.095 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.1371634006500244
Epoch: 28, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.107 Vali Acc: 0.622 Test Loss: 1.107 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.1254734992980957
Epoch: 29, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.107 Vali Acc: 0.608 Test Loss: 1.107 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.9983289241790771
Epoch: 30, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.104 Vali Acc: 0.608 Test Loss: 1.104 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm32_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 396932
model size : 2.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm16_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 4.652451515197754
Epoch: 1, Steps: 10 | Train Loss: 1.465 Vali Loss: 1.386 Vali Acc: 0.311 Test Loss: 1.386 Test Acc: 0.311
Validation loss decreased (inf --> -0.310797).  Saving model ...
Epoch: 2 cost time: 3.227396249771118
Epoch: 2, Steps: 10 | Train Loss: 1.373 Vali Loss: 1.350 Vali Acc: 0.324 Test Loss: 1.350 Test Acc: 0.324
Validation loss decreased (-0.310797 --> -0.324311).  Saving model ...
Epoch: 3 cost time: 3.2080459594726562
Epoch: 3, Steps: 10 | Train Loss: 1.269 Vali Loss: 1.303 Vali Acc: 0.419 Test Loss: 1.303 Test Acc: 0.419
Validation loss decreased (-0.324311 --> -0.418906).  Saving model ...
Epoch: 4 cost time: 3.175849437713623
Epoch: 4, Steps: 10 | Train Loss: 1.154 Vali Loss: 1.278 Vali Acc: 0.486 Test Loss: 1.278 Test Acc: 0.486
Validation loss decreased (-0.418906 --> -0.486474).  Saving model ...
Epoch: 5 cost time: 3.289412260055542
Epoch: 5, Steps: 10 | Train Loss: 1.011 Vali Loss: 1.217 Vali Acc: 0.473 Test Loss: 1.217 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.4683749675750732
Epoch: 6, Steps: 10 | Train Loss: 0.931 Vali Loss: 1.194 Vali Acc: 0.527 Test Loss: 1.194 Test Acc: 0.527
Validation loss decreased (-0.486474 --> -0.527015).  Saving model ...
Epoch: 7 cost time: 3.3723325729370117
Epoch: 7, Steps: 10 | Train Loss: 0.766 Vali Loss: 1.188 Vali Acc: 0.500 Test Loss: 1.188 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.3442912101745605
Epoch: 8, Steps: 10 | Train Loss: 0.640 Vali Loss: 1.156 Vali Acc: 0.514 Test Loss: 1.156 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.3772380352020264
Epoch: 9, Steps: 10 | Train Loss: 0.503 Vali Loss: 1.122 Vali Acc: 0.514 Test Loss: 1.122 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.2964682579040527
Epoch: 10, Steps: 10 | Train Loss: 0.402 Vali Loss: 1.105 Vali Acc: 0.541 Test Loss: 1.105 Test Acc: 0.541
Validation loss decreased (-0.527015 --> -0.540529).  Saving model ...
Epoch: 11 cost time: 3.2194626331329346
Epoch: 11, Steps: 10 | Train Loss: 0.326 Vali Loss: 1.073 Vali Acc: 0.581 Test Loss: 1.073 Test Acc: 0.581
Validation loss decreased (-0.540529 --> -0.581070).  Saving model ...
Epoch: 12 cost time: 3.2841997146606445
Epoch: 12, Steps: 10 | Train Loss: 0.226 Vali Loss: 1.100 Vali Acc: 0.568 Test Loss: 1.100 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.3406708240509033
Epoch: 13, Steps: 10 | Train Loss: 0.157 Vali Loss: 1.082 Vali Acc: 0.608 Test Loss: 1.082 Test Acc: 0.608
Validation loss decreased (-0.581070 --> -0.608097).  Saving model ...
Epoch: 14 cost time: 3.3335866928100586
Epoch: 14, Steps: 10 | Train Loss: 0.114 Vali Loss: 1.035 Vali Acc: 0.622 Test Loss: 1.035 Test Acc: 0.622
Validation loss decreased (-0.608097 --> -0.621611).  Saving model ...
Epoch: 15 cost time: 3.3621296882629395
Epoch: 15, Steps: 10 | Train Loss: 0.089 Vali Loss: 1.039 Vali Acc: 0.608 Test Loss: 1.039 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.5105855464935303
Epoch: 16, Steps: 10 | Train Loss: 0.065 Vali Loss: 1.028 Vali Acc: 0.568 Test Loss: 1.028 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.268982172012329
Epoch: 17, Steps: 10 | Train Loss: 0.051 Vali Loss: 1.005 Vali Acc: 0.608 Test Loss: 1.005 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.278632640838623
Epoch: 18, Steps: 10 | Train Loss: 0.042 Vali Loss: 1.095 Vali Acc: 0.595 Test Loss: 1.095 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.5079293251037598
Epoch: 19, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.049 Vali Acc: 0.622 Test Loss: 1.049 Test Acc: 0.622
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.462315320968628
Epoch: 20, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.044 Vali Acc: 0.608 Test Loss: 1.044 Test Acc: 0.608
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.5150110721588135
Epoch: 21, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.037 Vali Acc: 0.649 Test Loss: 1.037 Test Acc: 0.649
Validation loss decreased (-0.621611 --> -0.648638).  Saving model ...
Epoch: 22 cost time: 3.3756678104400635
Epoch: 22, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.091 Vali Acc: 0.581 Test Loss: 1.091 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.6604254245758057
Epoch: 23, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.079 Vali Acc: 0.622 Test Loss: 1.079 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.4480152130126953
Epoch: 24, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.050 Vali Acc: 0.608 Test Loss: 1.050 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.5081634521484375
Epoch: 25, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.067 Vali Acc: 0.622 Test Loss: 1.067 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.478301525115967
Epoch: 26, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.089 Vali Acc: 0.608 Test Loss: 1.089 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 3.35973858833313
Epoch: 27, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.080 Vali Acc: 0.622 Test Loss: 1.080 Test Acc: 0.622
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 3.485896587371826
Epoch: 28, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.083 Vali Acc: 0.622 Test Loss: 1.083 Test Acc: 0.622
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 3.63063383102417
Epoch: 29, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.089 Vali Acc: 0.595 Test Loss: 1.089 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 3.5380349159240723
Epoch: 30, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.092 Vali Acc: 0.608 Test Loss: 1.092 Test Acc: 0.608
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm16_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6486486486486487
model parameter : 1198596
model size : 4.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm16_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.1919546127319336
Epoch: 1, Steps: 10 | Train Loss: 1.418 Vali Loss: 1.441 Vali Acc: 0.203 Test Loss: 1.441 Test Acc: 0.203
Validation loss decreased (inf --> -0.202688).  Saving model ...
Epoch: 2 cost time: 1.8245112895965576
Epoch: 2, Steps: 10 | Train Loss: 1.377 Vali Loss: 1.407 Vali Acc: 0.270 Test Loss: 1.407 Test Acc: 0.270
Validation loss decreased (-0.202688 --> -0.270256).  Saving model ...
Epoch: 3 cost time: 1.812605619430542
Epoch: 3, Steps: 10 | Train Loss: 1.277 Vali Loss: 1.369 Vali Acc: 0.324 Test Loss: 1.369 Test Acc: 0.324
Validation loss decreased (-0.270256 --> -0.324311).  Saving model ...
Epoch: 4 cost time: 1.7195708751678467
Epoch: 4, Steps: 10 | Train Loss: 1.169 Vali Loss: 1.309 Vali Acc: 0.446 Test Loss: 1.309 Test Acc: 0.446
Validation loss decreased (-0.324311 --> -0.445933).  Saving model ...
Epoch: 5 cost time: 1.770113468170166
Epoch: 5, Steps: 10 | Train Loss: 1.012 Vali Loss: 1.295 Vali Acc: 0.351 Test Loss: 1.295 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8204059600830078
Epoch: 6, Steps: 10 | Train Loss: 0.894 Vali Loss: 1.272 Vali Acc: 0.446 Test Loss: 1.272 Test Acc: 0.446
Validation loss decreased (-0.445933 --> -0.445933).  Saving model ...
Epoch: 7 cost time: 1.7514448165893555
Epoch: 7, Steps: 10 | Train Loss: 0.758 Vali Loss: 1.211 Vali Acc: 0.500 Test Loss: 1.211 Test Acc: 0.500
Validation loss decreased (-0.445933 --> -0.499988).  Saving model ...
Epoch: 8 cost time: 1.6681971549987793
Epoch: 8, Steps: 10 | Train Loss: 0.640 Vali Loss: 1.179 Vali Acc: 0.486 Test Loss: 1.179 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.757755994796753
Epoch: 9, Steps: 10 | Train Loss: 0.513 Vali Loss: 1.154 Vali Acc: 0.527 Test Loss: 1.154 Test Acc: 0.527
Validation loss decreased (-0.499988 --> -0.527015).  Saving model ...
Epoch: 10 cost time: 1.713205337524414
Epoch: 10, Steps: 10 | Train Loss: 0.393 Vali Loss: 1.144 Vali Acc: 0.500 Test Loss: 1.144 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6265039443969727
Epoch: 11, Steps: 10 | Train Loss: 0.306 Vali Loss: 1.099 Vali Acc: 0.568 Test Loss: 1.099 Test Acc: 0.568
Validation loss decreased (-0.527015 --> -0.567557).  Saving model ...
Epoch: 12 cost time: 1.6875278949737549
Epoch: 12, Steps: 10 | Train Loss: 0.213 Vali Loss: 1.116 Vali Acc: 0.514 Test Loss: 1.116 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6774823665618896
Epoch: 13, Steps: 10 | Train Loss: 0.155 Vali Loss: 1.092 Vali Acc: 0.568 Test Loss: 1.092 Test Acc: 0.568
Validation loss decreased (-0.567557 --> -0.567557).  Saving model ...
Epoch: 14 cost time: 1.7934651374816895
Epoch: 14, Steps: 10 | Train Loss: 0.108 Vali Loss: 1.109 Vali Acc: 0.541 Test Loss: 1.109 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.652174472808838
Epoch: 15, Steps: 10 | Train Loss: 0.083 Vali Loss: 1.092 Vali Acc: 0.554 Test Loss: 1.092 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.5528874397277832
Epoch: 16, Steps: 10 | Train Loss: 0.063 Vali Loss: 1.076 Vali Acc: 0.568 Test Loss: 1.076 Test Acc: 0.568
Validation loss decreased (-0.567557 --> -0.567557).  Saving model ...
Epoch: 17 cost time: 1.7141845226287842
Epoch: 17, Steps: 10 | Train Loss: 0.046 Vali Loss: 1.108 Vali Acc: 0.541 Test Loss: 1.108 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.6021394729614258
Epoch: 18, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.106 Vali Acc: 0.527 Test Loss: 1.106 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.5723958015441895
Epoch: 19, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.098 Vali Acc: 0.514 Test Loss: 1.098 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.6048765182495117
Epoch: 20, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.115 Vali Acc: 0.514 Test Loss: 1.115 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.5576891899108887
Epoch: 21, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.128 Vali Acc: 0.527 Test Loss: 1.128 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.69142484664917
Epoch: 22, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.122 Vali Acc: 0.514 Test Loss: 1.122 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.5265679359436035
Epoch: 23, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.191 Vali Acc: 0.514 Test Loss: 1.191 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.6516406536102295
Epoch: 24, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.162 Vali Acc: 0.554 Test Loss: 1.162 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.6470870971679688
Epoch: 25, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.148 Vali Acc: 0.527 Test Loss: 1.148 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.5709588527679443
Epoch: 26, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.175 Vali Acc: 0.527 Test Loss: 1.175 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm16_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 370884
model size : 1.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm16_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.7697789669036865
Epoch: 1, Steps: 10 | Train Loss: 1.464 Vali Loss: 1.383 Vali Acc: 0.297 Test Loss: 1.383 Test Acc: 0.297
Validation loss decreased (inf --> -0.297283).  Saving model ...
Epoch: 2 cost time: 2.6979477405548096
Epoch: 2, Steps: 10 | Train Loss: 1.377 Vali Loss: 1.347 Vali Acc: 0.324 Test Loss: 1.347 Test Acc: 0.324
Validation loss decreased (-0.297283 --> -0.324311).  Saving model ...
Epoch: 3 cost time: 2.42036509513855
Epoch: 3, Steps: 10 | Train Loss: 1.274 Vali Loss: 1.301 Vali Acc: 0.405 Test Loss: 1.301 Test Acc: 0.405
Validation loss decreased (-0.324311 --> -0.405392).  Saving model ...
Epoch: 4 cost time: 2.353985071182251
Epoch: 4, Steps: 10 | Train Loss: 1.171 Vali Loss: 1.276 Vali Acc: 0.459 Test Loss: 1.276 Test Acc: 0.459
Validation loss decreased (-0.405392 --> -0.459447).  Saving model ...
Epoch: 5 cost time: 2.3639018535614014
Epoch: 5, Steps: 10 | Train Loss: 1.033 Vali Loss: 1.214 Vali Acc: 0.527 Test Loss: 1.214 Test Acc: 0.527
Validation loss decreased (-0.459447 --> -0.527015).  Saving model ...
Epoch: 6 cost time: 2.5021309852600098
Epoch: 6, Steps: 10 | Train Loss: 0.965 Vali Loss: 1.183 Vali Acc: 0.541 Test Loss: 1.183 Test Acc: 0.541
Validation loss decreased (-0.527015 --> -0.540529).  Saving model ...
Epoch: 7 cost time: 2.3520400524139404
Epoch: 7, Steps: 10 | Train Loss: 0.806 Vali Loss: 1.177 Vali Acc: 0.554 Test Loss: 1.177 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554042).  Saving model ...
Epoch: 8 cost time: 2.3526618480682373
Epoch: 8, Steps: 10 | Train Loss: 0.689 Vali Loss: 1.132 Vali Acc: 0.581 Test Loss: 1.132 Test Acc: 0.581
Validation loss decreased (-0.554042 --> -0.581070).  Saving model ...
Epoch: 9 cost time: 2.3976755142211914
Epoch: 9, Steps: 10 | Train Loss: 0.551 Vali Loss: 1.077 Vali Acc: 0.541 Test Loss: 1.077 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.5671439170837402
Epoch: 10, Steps: 10 | Train Loss: 0.444 Vali Loss: 1.062 Vali Acc: 0.568 Test Loss: 1.062 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.4091994762420654
Epoch: 11, Steps: 10 | Train Loss: 0.360 Vali Loss: 1.023 Vali Acc: 0.595 Test Loss: 1.023 Test Acc: 0.595
Validation loss decreased (-0.581070 --> -0.594584).  Saving model ...
Epoch: 12 cost time: 2.3390913009643555
Epoch: 12, Steps: 10 | Train Loss: 0.289 Vali Loss: 1.027 Vali Acc: 0.554 Test Loss: 1.027 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.4280076026916504
Epoch: 13, Steps: 10 | Train Loss: 0.215 Vali Loss: 0.975 Vali Acc: 0.595 Test Loss: 0.975 Test Acc: 0.595
Validation loss decreased (-0.594584 --> -0.594585).  Saving model ...
Epoch: 14 cost time: 2.5683910846710205
Epoch: 14, Steps: 10 | Train Loss: 0.148 Vali Loss: 0.966 Vali Acc: 0.622 Test Loss: 0.966 Test Acc: 0.622
Validation loss decreased (-0.594585 --> -0.621612).  Saving model ...
Epoch: 15 cost time: 2.392976999282837
Epoch: 15, Steps: 10 | Train Loss: 0.107 Vali Loss: 0.928 Vali Acc: 0.622 Test Loss: 0.928 Test Acc: 0.622
Validation loss decreased (-0.621612 --> -0.621612).  Saving model ...
Epoch: 16 cost time: 2.428347587585449
Epoch: 16, Steps: 10 | Train Loss: 0.086 Vali Loss: 0.946 Vali Acc: 0.635 Test Loss: 0.946 Test Acc: 0.635
Validation loss decreased (-0.621612 --> -0.635126).  Saving model ...
Epoch: 17 cost time: 2.4444806575775146
Epoch: 17, Steps: 10 | Train Loss: 0.067 Vali Loss: 0.977 Vali Acc: 0.568 Test Loss: 0.977 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.501741886138916
Epoch: 18, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.959 Vali Acc: 0.608 Test Loss: 0.959 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.4587514400482178
Epoch: 19, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.955 Vali Acc: 0.622 Test Loss: 0.955 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.4594264030456543
Epoch: 20, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.957 Vali Acc: 0.554 Test Loss: 0.957 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.342994451522827
Epoch: 21, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.925 Vali Acc: 0.608 Test Loss: 0.925 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.5440821647644043
Epoch: 22, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.922 Vali Acc: 0.554 Test Loss: 0.922 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.5451455116271973
Epoch: 23, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.926 Vali Acc: 0.581 Test Loss: 0.926 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.539839267730713
Epoch: 24, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.877 Vali Acc: 0.662 Test Loss: 0.877 Test Acc: 0.662
Validation loss decreased (-0.635126 --> -0.662153).  Saving model ...
Epoch: 25 cost time: 2.673557996749878
Epoch: 25, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.901 Vali Acc: 0.595 Test Loss: 0.901 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.4666759967803955
Epoch: 26, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.910 Vali Acc: 0.581 Test Loss: 0.910 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.4659347534179688
Epoch: 27, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.892 Vali Acc: 0.568 Test Loss: 0.892 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.4870662689208984
Epoch: 28, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.906 Vali Acc: 0.608 Test Loss: 0.906 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.9661216735839844
Epoch: 29, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.926 Vali Acc: 0.554 Test Loss: 0.926 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.5042355060577393
Epoch: 30, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.954 Vali Acc: 0.568 Test Loss: 0.954 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm16_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6621621621621622
model parameter : 1198596
model size : 4.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm16_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.8513808250427246
Epoch: 1, Steps: 10 | Train Loss: 1.418 Vali Loss: 1.437 Vali Acc: 0.216 Test Loss: 1.437 Test Acc: 0.216
Validation loss decreased (inf --> -0.216202).  Saving model ...
Epoch: 2 cost time: 1.350132703781128
Epoch: 2, Steps: 10 | Train Loss: 1.379 Vali Loss: 1.401 Vali Acc: 0.284 Test Loss: 1.401 Test Acc: 0.284
Validation loss decreased (-0.216202 --> -0.283770).  Saving model ...
Epoch: 3 cost time: 1.3387236595153809
Epoch: 3, Steps: 10 | Train Loss: 1.279 Vali Loss: 1.364 Vali Acc: 0.311 Test Loss: 1.364 Test Acc: 0.311
Validation loss decreased (-0.283770 --> -0.310797).  Saving model ...
Epoch: 4 cost time: 1.3383915424346924
Epoch: 4, Steps: 10 | Train Loss: 1.179 Vali Loss: 1.301 Vali Acc: 0.459 Test Loss: 1.301 Test Acc: 0.459
Validation loss decreased (-0.310797 --> -0.459446).  Saving model ...
Epoch: 5 cost time: 1.499863862991333
Epoch: 5, Steps: 10 | Train Loss: 1.027 Vali Loss: 1.284 Vali Acc: 0.378 Test Loss: 1.284 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.4658849239349365
Epoch: 6, Steps: 10 | Train Loss: 0.907 Vali Loss: 1.261 Vali Acc: 0.473 Test Loss: 1.261 Test Acc: 0.473
Validation loss decreased (-0.459446 --> -0.472960).  Saving model ...
Epoch: 7 cost time: 1.4597227573394775
Epoch: 7, Steps: 10 | Train Loss: 0.776 Vali Loss: 1.197 Vali Acc: 0.527 Test Loss: 1.197 Test Acc: 0.527
Validation loss decreased (-0.472960 --> -0.527015).  Saving model ...
Epoch: 8 cost time: 1.4953725337982178
Epoch: 8, Steps: 10 | Train Loss: 0.660 Vali Loss: 1.160 Vali Acc: 0.500 Test Loss: 1.160 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4708776473999023
Epoch: 9, Steps: 10 | Train Loss: 0.542 Vali Loss: 1.131 Vali Acc: 0.541 Test Loss: 1.131 Test Acc: 0.541
Validation loss decreased (-0.527015 --> -0.540529).  Saving model ...
Epoch: 10 cost time: 1.489957332611084
Epoch: 10, Steps: 10 | Train Loss: 0.419 Vali Loss: 1.110 Vali Acc: 0.541 Test Loss: 1.110 Test Acc: 0.541
Validation loss decreased (-0.540529 --> -0.540529).  Saving model ...
Epoch: 11 cost time: 1.5157098770141602
Epoch: 11, Steps: 10 | Train Loss: 0.335 Vali Loss: 1.060 Vali Acc: 0.568 Test Loss: 1.060 Test Acc: 0.568
Validation loss decreased (-0.540529 --> -0.567557).  Saving model ...
Epoch: 12 cost time: 1.4564924240112305
Epoch: 12, Steps: 10 | Train Loss: 0.242 Vali Loss: 1.060 Vali Acc: 0.514 Test Loss: 1.060 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4438397884368896
Epoch: 13, Steps: 10 | Train Loss: 0.179 Vali Loss: 1.038 Vali Acc: 0.541 Test Loss: 1.038 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.518409013748169
Epoch: 14, Steps: 10 | Train Loss: 0.130 Vali Loss: 1.039 Vali Acc: 0.554 Test Loss: 1.039 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.5449509620666504
Epoch: 15, Steps: 10 | Train Loss: 0.096 Vali Loss: 1.034 Vali Acc: 0.568 Test Loss: 1.034 Test Acc: 0.568
Validation loss decreased (-0.567557 --> -0.567557).  Saving model ...
Epoch: 16 cost time: 1.4655373096466064
Epoch: 16, Steps: 10 | Train Loss: 0.075 Vali Loss: 1.007 Vali Acc: 0.595 Test Loss: 1.007 Test Acc: 0.595
Validation loss decreased (-0.567557 --> -0.594585).  Saving model ...
Epoch: 17 cost time: 1.5142977237701416
Epoch: 17, Steps: 10 | Train Loss: 0.053 Vali Loss: 1.037 Vali Acc: 0.554 Test Loss: 1.037 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.5051963329315186
Epoch: 18, Steps: 10 | Train Loss: 0.041 Vali Loss: 1.031 Vali Acc: 0.554 Test Loss: 1.031 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.4190185070037842
Epoch: 19, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.024 Vali Acc: 0.554 Test Loss: 1.024 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.4070286750793457
Epoch: 20, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.062 Vali Acc: 0.554 Test Loss: 1.062 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.4520487785339355
Epoch: 21, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.062 Vali Acc: 0.568 Test Loss: 1.062 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.548565149307251
Epoch: 22, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.045 Vali Acc: 0.554 Test Loss: 1.045 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.4461030960083008
Epoch: 23, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.084 Vali Acc: 0.581 Test Loss: 1.084 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.5726020336151123
Epoch: 24, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.083 Vali Acc: 0.568 Test Loss: 1.083 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.4703483581542969
Epoch: 25, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.076 Vali Acc: 0.554 Test Loss: 1.076 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.465536117553711
Epoch: 26, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.103 Vali Acc: 0.568 Test Loss: 1.103 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm16_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 370884
model size : 1.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm16_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.0079445838928223
Epoch: 1, Steps: 10 | Train Loss: 1.464 Vali Loss: 1.381 Vali Acc: 0.311 Test Loss: 1.381 Test Acc: 0.311
Validation loss decreased (inf --> -0.310797).  Saving model ...
Epoch: 2 cost time: 1.8218410015106201
Epoch: 2, Steps: 10 | Train Loss: 1.378 Vali Loss: 1.344 Vali Acc: 0.324 Test Loss: 1.344 Test Acc: 0.324
Validation loss decreased (-0.310797 --> -0.324311).  Saving model ...
Epoch: 3 cost time: 1.793651819229126
Epoch: 3, Steps: 10 | Train Loss: 1.284 Vali Loss: 1.299 Vali Acc: 0.405 Test Loss: 1.299 Test Acc: 0.405
Validation loss decreased (-0.324311 --> -0.405392).  Saving model ...
Epoch: 4 cost time: 1.8639905452728271
Epoch: 4, Steps: 10 | Train Loss: 1.184 Vali Loss: 1.275 Vali Acc: 0.459 Test Loss: 1.275 Test Acc: 0.459
Validation loss decreased (-0.405392 --> -0.459447).  Saving model ...
Epoch: 5 cost time: 1.7345945835113525
Epoch: 5, Steps: 10 | Train Loss: 1.059 Vali Loss: 1.213 Vali Acc: 0.527 Test Loss: 1.213 Test Acc: 0.527
Validation loss decreased (-0.459447 --> -0.527015).  Saving model ...
Epoch: 6 cost time: 1.7942931652069092
Epoch: 6, Steps: 10 | Train Loss: 0.994 Vali Loss: 1.179 Vali Acc: 0.554 Test Loss: 1.179 Test Acc: 0.554
Validation loss decreased (-0.527015 --> -0.554042).  Saving model ...
Epoch: 7 cost time: 1.752183198928833
Epoch: 7, Steps: 10 | Train Loss: 0.848 Vali Loss: 1.169 Vali Acc: 0.554 Test Loss: 1.169 Test Acc: 0.554
Validation loss decreased (-0.554042 --> -0.554042).  Saving model ...
Epoch: 8 cost time: 1.7547101974487305
Epoch: 8, Steps: 10 | Train Loss: 0.737 Vali Loss: 1.128 Vali Acc: 0.554 Test Loss: 1.128 Test Acc: 0.554
Validation loss decreased (-0.554042 --> -0.554043).  Saving model ...
Epoch: 9 cost time: 1.7450618743896484
Epoch: 9, Steps: 10 | Train Loss: 0.608 Vali Loss: 1.079 Vali Acc: 0.541 Test Loss: 1.079 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6247107982635498
Epoch: 10, Steps: 10 | Train Loss: 0.514 Vali Loss: 1.058 Vali Acc: 0.595 Test Loss: 1.058 Test Acc: 0.595
Validation loss decreased (-0.554043 --> -0.594584).  Saving model ...
Epoch: 11 cost time: 1.665450096130371
Epoch: 11, Steps: 10 | Train Loss: 0.428 Vali Loss: 1.018 Vali Acc: 0.595 Test Loss: 1.018 Test Acc: 0.595
Validation loss decreased (-0.594584 --> -0.594584).  Saving model ...
Epoch: 12 cost time: 1.811213731765747
Epoch: 12, Steps: 10 | Train Loss: 0.335 Vali Loss: 1.016 Vali Acc: 0.595 Test Loss: 1.016 Test Acc: 0.595
Validation loss decreased (-0.594584 --> -0.594584).  Saving model ...
Epoch: 13 cost time: 1.743208885192871
Epoch: 13, Steps: 10 | Train Loss: 0.252 Vali Loss: 0.936 Vali Acc: 0.608 Test Loss: 0.936 Test Acc: 0.608
Validation loss decreased (-0.594584 --> -0.608099).  Saving model ...
Epoch: 14 cost time: 1.7528266906738281
Epoch: 14, Steps: 10 | Train Loss: 0.194 Vali Loss: 0.940 Vali Acc: 0.649 Test Loss: 0.940 Test Acc: 0.649
Validation loss decreased (-0.608099 --> -0.648639).  Saving model ...
Epoch: 15 cost time: 1.7649567127227783
Epoch: 15, Steps: 10 | Train Loss: 0.152 Vali Loss: 0.856 Vali Acc: 0.635 Test Loss: 0.856 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.8617722988128662
Epoch: 16, Steps: 10 | Train Loss: 0.107 Vali Loss: 0.879 Vali Acc: 0.676 Test Loss: 0.879 Test Acc: 0.676
Validation loss decreased (-0.648639 --> -0.675667).  Saving model ...
Epoch: 17 cost time: 1.739687442779541
Epoch: 17, Steps: 10 | Train Loss: 0.074 Vali Loss: 0.815 Vali Acc: 0.649 Test Loss: 0.815 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.7570538520812988
Epoch: 18, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.833 Vali Acc: 0.676 Test Loss: 0.833 Test Acc: 0.676
Validation loss decreased (-0.675667 --> -0.675667).  Saving model ...
Epoch: 19 cost time: 1.799393653869629
Epoch: 19, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.840 Vali Acc: 0.689 Test Loss: 0.840 Test Acc: 0.689
Validation loss decreased (-0.675667 --> -0.689181).  Saving model ...
Epoch: 20 cost time: 1.8626916408538818
Epoch: 20, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.875 Vali Acc: 0.689 Test Loss: 0.875 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.8022065162658691
Epoch: 21, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.823 Vali Acc: 0.716 Test Loss: 0.823 Test Acc: 0.716
Validation loss decreased (-0.689181 --> -0.716208).  Saving model ...
Epoch: 22 cost time: 1.6891210079193115
Epoch: 22, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.843 Vali Acc: 0.703 Test Loss: 0.843 Test Acc: 0.703
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.7606604099273682
Epoch: 23, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.850 Vali Acc: 0.716 Test Loss: 0.850 Test Acc: 0.716
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.9320690631866455
Epoch: 24, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.826 Vali Acc: 0.676 Test Loss: 0.826 Test Acc: 0.676
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.731067180633545
Epoch: 25, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.852 Vali Acc: 0.689 Test Loss: 0.852 Test Acc: 0.689
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.7287659645080566
Epoch: 26, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.849 Vali Acc: 0.676 Test Loss: 0.849 Test Acc: 0.676
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.7538018226623535
Epoch: 27, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.845 Vali Acc: 0.676 Test Loss: 0.845 Test Acc: 0.676
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.8262639045715332
Epoch: 28, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.852 Vali Acc: 0.676 Test Loss: 0.852 Test Acc: 0.676
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.7632019519805908
Epoch: 29, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.868 Vali Acc: 0.676 Test Loss: 0.868 Test Acc: 0.676
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.698664903640747
Epoch: 30, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.916 Vali Acc: 0.676 Test Loss: 0.916 Test Acc: 0.676
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm16_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.7162162162162162
model parameter : 1198596
model size : 4.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm16_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.402763843536377
Epoch: 1, Steps: 10 | Train Loss: 1.414 Vali Loss: 1.439 Vali Acc: 0.216 Test Loss: 1.439 Test Acc: 0.216
Validation loss decreased (inf --> -0.216202).  Saving model ...
Epoch: 2 cost time: 0.8290987014770508
Epoch: 2, Steps: 10 | Train Loss: 1.376 Vali Loss: 1.404 Vali Acc: 0.243 Test Loss: 1.404 Test Acc: 0.243
Validation loss decreased (-0.216202 --> -0.243229).  Saving model ...
Epoch: 3 cost time: 1.0677375793457031
Epoch: 3, Steps: 10 | Train Loss: 1.283 Vali Loss: 1.367 Vali Acc: 0.284 Test Loss: 1.367 Test Acc: 0.284
Validation loss decreased (-0.243229 --> -0.283770).  Saving model ...
Epoch: 4 cost time: 1.0482046604156494
Epoch: 4, Steps: 10 | Train Loss: 1.183 Vali Loss: 1.306 Vali Acc: 0.432 Test Loss: 1.306 Test Acc: 0.432
Validation loss decreased (-0.283770 --> -0.432419).  Saving model ...
Epoch: 5 cost time: 1.047346830368042
Epoch: 5, Steps: 10 | Train Loss: 1.036 Vali Loss: 1.286 Vali Acc: 0.365 Test Loss: 1.286 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.074601173400879
Epoch: 6, Steps: 10 | Train Loss: 0.922 Vali Loss: 1.263 Vali Acc: 0.459 Test Loss: 1.263 Test Acc: 0.459
Validation loss decreased (-0.432419 --> -0.459447).  Saving model ...
Epoch: 7 cost time: 1.0480625629425049
Epoch: 7, Steps: 10 | Train Loss: 0.794 Vali Loss: 1.197 Vali Acc: 0.514 Test Loss: 1.197 Test Acc: 0.514
Validation loss decreased (-0.459447 --> -0.513502).  Saving model ...
Epoch: 8 cost time: 1.10001540184021
Epoch: 8, Steps: 10 | Train Loss: 0.681 Vali Loss: 1.159 Vali Acc: 0.541 Test Loss: 1.159 Test Acc: 0.541
Validation loss decreased (-0.513502 --> -0.540529).  Saving model ...
Epoch: 9 cost time: 1.009355068206787
Epoch: 9, Steps: 10 | Train Loss: 0.562 Vali Loss: 1.127 Vali Acc: 0.541 Test Loss: 1.127 Test Acc: 0.541
Validation loss decreased (-0.540529 --> -0.540529).  Saving model ...
Epoch: 10 cost time: 1.0688726902008057
Epoch: 10, Steps: 10 | Train Loss: 0.442 Vali Loss: 1.102 Vali Acc: 0.554 Test Loss: 1.102 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554043).  Saving model ...
Epoch: 11 cost time: 1.081427812576294
Epoch: 11, Steps: 10 | Train Loss: 0.360 Vali Loss: 1.051 Vali Acc: 0.568 Test Loss: 1.051 Test Acc: 0.568
Validation loss decreased (-0.554043 --> -0.567557).  Saving model ...
Epoch: 12 cost time: 1.0339477062225342
Epoch: 12, Steps: 10 | Train Loss: 0.265 Vali Loss: 1.049 Vali Acc: 0.568 Test Loss: 1.049 Test Acc: 0.568
Validation loss decreased (-0.567557 --> -0.567557).  Saving model ...
Epoch: 13 cost time: 1.0910699367523193
Epoch: 13, Steps: 10 | Train Loss: 0.199 Vali Loss: 1.021 Vali Acc: 0.568 Test Loss: 1.021 Test Acc: 0.568
Validation loss decreased (-0.567557 --> -0.567557).  Saving model ...
Epoch: 14 cost time: 1.0275745391845703
Epoch: 14, Steps: 10 | Train Loss: 0.151 Vali Loss: 1.015 Vali Acc: 0.568 Test Loss: 1.015 Test Acc: 0.568
Validation loss decreased (-0.567557 --> -0.567557).  Saving model ...
Epoch: 15 cost time: 1.033621072769165
Epoch: 15, Steps: 10 | Train Loss: 0.111 Vali Loss: 1.009 Vali Acc: 0.568 Test Loss: 1.009 Test Acc: 0.568
Validation loss decreased (-0.567557 --> -0.567557).  Saving model ...
Epoch: 16 cost time: 1.0182456970214844
Epoch: 16, Steps: 10 | Train Loss: 0.086 Vali Loss: 0.978 Vali Acc: 0.568 Test Loss: 0.978 Test Acc: 0.568
Validation loss decreased (-0.567557 --> -0.567558).  Saving model ...
Epoch: 17 cost time: 1.0964984893798828
Epoch: 17, Steps: 10 | Train Loss: 0.062 Vali Loss: 1.016 Vali Acc: 0.595 Test Loss: 1.016 Test Acc: 0.595
Validation loss decreased (-0.567558 --> -0.594584).  Saving model ...
Epoch: 18 cost time: 1.0503075122833252
Epoch: 18, Steps: 10 | Train Loss: 0.048 Vali Loss: 1.006 Vali Acc: 0.581 Test Loss: 1.006 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0564169883728027
Epoch: 19, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.992 Vali Acc: 0.581 Test Loss: 0.992 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.1384718418121338
Epoch: 20, Steps: 10 | Train Loss: 0.036 Vali Loss: 1.014 Vali Acc: 0.581 Test Loss: 1.014 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.044990062713623
Epoch: 21, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.019 Vali Acc: 0.568 Test Loss: 1.019 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.0015769004821777
Epoch: 22, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.012 Vali Acc: 0.568 Test Loss: 1.012 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.9916017055511475
Epoch: 23, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.053 Vali Acc: 0.581 Test Loss: 1.053 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.0183789730072021
Epoch: 24, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.037 Vali Acc: 0.568 Test Loss: 1.037 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.035118818283081
Epoch: 25, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.040 Vali Acc: 0.568 Test Loss: 1.040 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.9902820587158203
Epoch: 26, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.069 Vali Acc: 0.581 Test Loss: 1.069 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.0509681701660156
Epoch: 27, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.053 Vali Acc: 0.568 Test Loss: 1.053 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm16_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 370884
model size : 1.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm16_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.362186908721924
Epoch: 1, Steps: 10 | Train Loss: 1.456 Vali Loss: 1.420 Vali Acc: 0.203 Test Loss: 1.420 Test Acc: 0.203
Validation loss decreased (inf --> -0.202689).  Saving model ...
Epoch: 2 cost time: 1.9904863834381104
Epoch: 2, Steps: 10 | Train Loss: 1.399 Vali Loss: 1.381 Vali Acc: 0.311 Test Loss: 1.381 Test Acc: 0.311
Validation loss decreased (-0.202689 --> -0.310797).  Saving model ...
Epoch: 3 cost time: 1.9676263332366943
Epoch: 3, Steps: 10 | Train Loss: 1.295 Vali Loss: 1.350 Vali Acc: 0.311 Test Loss: 1.350 Test Acc: 0.311
Validation loss decreased (-0.310797 --> -0.310797).  Saving model ...
Epoch: 4 cost time: 1.989771842956543
Epoch: 4, Steps: 10 | Train Loss: 1.202 Vali Loss: 1.307 Vali Acc: 0.365 Test Loss: 1.307 Test Acc: 0.365
Validation loss decreased (-0.310797 --> -0.364852).  Saving model ...
Epoch: 5 cost time: 1.980745792388916
Epoch: 5, Steps: 10 | Train Loss: 1.057 Vali Loss: 1.252 Vali Acc: 0.473 Test Loss: 1.252 Test Acc: 0.473
Validation loss decreased (-0.364852 --> -0.472960).  Saving model ...
Epoch: 6 cost time: 1.978579044342041
Epoch: 6, Steps: 10 | Train Loss: 0.958 Vali Loss: 1.198 Vali Acc: 0.486 Test Loss: 1.198 Test Acc: 0.486
Validation loss decreased (-0.472960 --> -0.486475).  Saving model ...
Epoch: 7 cost time: 2.013873815536499
Epoch: 7, Steps: 10 | Train Loss: 0.815 Vali Loss: 1.195 Vali Acc: 0.486 Test Loss: 1.195 Test Acc: 0.486
Validation loss decreased (-0.486475 --> -0.486475).  Saving model ...
Epoch: 8 cost time: 2.170056104660034
Epoch: 8, Steps: 10 | Train Loss: 0.713 Vali Loss: 1.139 Vali Acc: 0.514 Test Loss: 1.139 Test Acc: 0.514
Validation loss decreased (-0.486475 --> -0.513502).  Saving model ...
Epoch: 9 cost time: 2.0241966247558594
Epoch: 9, Steps: 10 | Train Loss: 0.598 Vali Loss: 1.102 Vali Acc: 0.541 Test Loss: 1.102 Test Acc: 0.541
Validation loss decreased (-0.513502 --> -0.540530).  Saving model ...
Epoch: 10 cost time: 1.9993813037872314
Epoch: 10, Steps: 10 | Train Loss: 0.478 Vali Loss: 1.093 Vali Acc: 0.514 Test Loss: 1.093 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.0342397689819336
Epoch: 11, Steps: 10 | Train Loss: 0.386 Vali Loss: 1.067 Vali Acc: 0.541 Test Loss: 1.067 Test Acc: 0.541
Validation loss decreased (-0.540530 --> -0.540530).  Saving model ...
Epoch: 12 cost time: 2.0910086631774902
Epoch: 12, Steps: 10 | Train Loss: 0.303 Vali Loss: 1.067 Vali Acc: 0.527 Test Loss: 1.067 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.608900547027588
Epoch: 13, Steps: 10 | Train Loss: 0.217 Vali Loss: 1.056 Vali Acc: 0.554 Test Loss: 1.056 Test Acc: 0.554
Validation loss decreased (-0.540530 --> -0.554043).  Saving model ...
Epoch: 14 cost time: 2.0638442039489746
Epoch: 14, Steps: 10 | Train Loss: 0.178 Vali Loss: 1.072 Vali Acc: 0.514 Test Loss: 1.072 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.042510509490967
Epoch: 15, Steps: 10 | Train Loss: 0.119 Vali Loss: 1.043 Vali Acc: 0.541 Test Loss: 1.043 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.0416955947875977
Epoch: 16, Steps: 10 | Train Loss: 0.094 Vali Loss: 1.038 Vali Acc: 0.541 Test Loss: 1.038 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.1457905769348145
Epoch: 17, Steps: 10 | Train Loss: 0.071 Vali Loss: 1.038 Vali Acc: 0.541 Test Loss: 1.038 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.0803439617156982
Epoch: 18, Steps: 10 | Train Loss: 0.052 Vali Loss: 1.056 Vali Acc: 0.568 Test Loss: 1.056 Test Acc: 0.568
Validation loss decreased (-0.554043 --> -0.567557).  Saving model ...
Epoch: 19 cost time: 2.1198525428771973
Epoch: 19, Steps: 10 | Train Loss: 0.043 Vali Loss: 1.047 Vali Acc: 0.541 Test Loss: 1.047 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.1139719486236572
Epoch: 20, Steps: 10 | Train Loss: 0.040 Vali Loss: 1.039 Vali Acc: 0.554 Test Loss: 1.039 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.109804630279541
Epoch: 21, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.085 Vali Acc: 0.568 Test Loss: 1.085 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.134355068206787
Epoch: 22, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.060 Vali Acc: 0.581 Test Loss: 1.060 Test Acc: 0.581
Validation loss decreased (-0.567557 --> -0.581070).  Saving model ...
Epoch: 23 cost time: 2.1369636058807373
Epoch: 23, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.056 Vali Acc: 0.568 Test Loss: 1.056 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.140629291534424
Epoch: 24, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.068 Vali Acc: 0.581 Test Loss: 1.068 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.038621425628662
Epoch: 25, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.080 Vali Acc: 0.581 Test Loss: 1.080 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.0716614723205566
Epoch: 26, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.069 Vali Acc: 0.568 Test Loss: 1.069 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.0900423526763916
Epoch: 27, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.091 Vali Acc: 0.568 Test Loss: 1.091 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.043600082397461
Epoch: 28, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.125 Vali Acc: 0.568 Test Loss: 1.125 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 2.100220203399658
Epoch: 29, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.142 Vali Acc: 0.527 Test Loss: 1.142 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 2.2118079662323
Epoch: 30, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.129 Vali Acc: 0.527 Test Loss: 1.129 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm16_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 612484
model size : 2.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm16_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.6968438625335693
Epoch: 1, Steps: 10 | Train Loss: 1.435 Vali Loss: 1.433 Vali Acc: 0.243 Test Loss: 1.433 Test Acc: 0.243
Validation loss decreased (inf --> -0.243229).  Saving model ...
Epoch: 2 cost time: 1.3512134552001953
Epoch: 2, Steps: 10 | Train Loss: 1.334 Vali Loss: 1.389 Vali Acc: 0.270 Test Loss: 1.389 Test Acc: 0.270
Validation loss decreased (-0.243229 --> -0.270256).  Saving model ...
Epoch: 3 cost time: 1.2077007293701172
Epoch: 3, Steps: 10 | Train Loss: 1.262 Vali Loss: 1.362 Vali Acc: 0.270 Test Loss: 1.362 Test Acc: 0.270
Validation loss decreased (-0.270256 --> -0.270257).  Saving model ...
Epoch: 4 cost time: 1.2241907119750977
Epoch: 4, Steps: 10 | Train Loss: 1.166 Vali Loss: 1.346 Vali Acc: 0.311 Test Loss: 1.346 Test Acc: 0.311
Validation loss decreased (-0.270257 --> -0.310797).  Saving model ...
Epoch: 5 cost time: 1.2849647998809814
Epoch: 5, Steps: 10 | Train Loss: 1.047 Vali Loss: 1.280 Vali Acc: 0.419 Test Loss: 1.280 Test Acc: 0.419
Validation loss decreased (-0.310797 --> -0.418906).  Saving model ...
Epoch: 6 cost time: 1.2172424793243408
Epoch: 6, Steps: 10 | Train Loss: 0.908 Vali Loss: 1.274 Vali Acc: 0.392 Test Loss: 1.274 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2425291538238525
Epoch: 7, Steps: 10 | Train Loss: 0.794 Vali Loss: 1.215 Vali Acc: 0.500 Test Loss: 1.215 Test Acc: 0.500
Validation loss decreased (-0.418906 --> -0.499988).  Saving model ...
Epoch: 8 cost time: 1.5741913318634033
Epoch: 8, Steps: 10 | Train Loss: 0.686 Vali Loss: 1.213 Vali Acc: 0.486 Test Loss: 1.213 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.439729928970337
Epoch: 9, Steps: 10 | Train Loss: 0.570 Vali Loss: 1.168 Vali Acc: 0.473 Test Loss: 1.168 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.453577995300293
Epoch: 10, Steps: 10 | Train Loss: 0.457 Vali Loss: 1.148 Vali Acc: 0.527 Test Loss: 1.148 Test Acc: 0.527
Validation loss decreased (-0.499988 --> -0.527016).  Saving model ...
Epoch: 11 cost time: 1.4304752349853516
Epoch: 11, Steps: 10 | Train Loss: 0.366 Vali Loss: 1.147 Vali Acc: 0.500 Test Loss: 1.147 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.420691967010498
Epoch: 12, Steps: 10 | Train Loss: 0.282 Vali Loss: 1.132 Vali Acc: 0.459 Test Loss: 1.132 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.4215233325958252
Epoch: 13, Steps: 10 | Train Loss: 0.205 Vali Loss: 1.116 Vali Acc: 0.527 Test Loss: 1.116 Test Acc: 0.527
Validation loss decreased (-0.527016 --> -0.527016).  Saving model ...
Epoch: 14 cost time: 1.4099419116973877
Epoch: 14, Steps: 10 | Train Loss: 0.165 Vali Loss: 1.122 Vali Acc: 0.514 Test Loss: 1.122 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3562943935394287
Epoch: 15, Steps: 10 | Train Loss: 0.121 Vali Loss: 1.178 Vali Acc: 0.514 Test Loss: 1.178 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.4084007740020752
Epoch: 16, Steps: 10 | Train Loss: 0.088 Vali Loss: 1.158 Vali Acc: 0.514 Test Loss: 1.158 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.5222105979919434
Epoch: 17, Steps: 10 | Train Loss: 0.065 Vali Loss: 1.203 Vali Acc: 0.514 Test Loss: 1.203 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.3974759578704834
Epoch: 18, Steps: 10 | Train Loss: 0.054 Vali Loss: 1.200 Vali Acc: 0.527 Test Loss: 1.200 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.3814406394958496
Epoch: 19, Steps: 10 | Train Loss: 0.043 Vali Loss: 1.212 Vali Acc: 0.514 Test Loss: 1.212 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.4647254943847656
Epoch: 20, Steps: 10 | Train Loss: 0.037 Vali Loss: 1.222 Vali Acc: 0.527 Test Loss: 1.222 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.4331250190734863
Epoch: 21, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.236 Vali Acc: 0.514 Test Loss: 1.236 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.533853530883789
Epoch: 22, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.228 Vali Acc: 0.541 Test Loss: 1.228 Test Acc: 0.541
Validation loss decreased (-0.527016 --> -0.540528).  Saving model ...
Epoch: 23 cost time: 1.4135854244232178
Epoch: 23, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.253 Vali Acc: 0.527 Test Loss: 1.253 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.4303131103515625
Epoch: 24, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.273 Vali Acc: 0.541 Test Loss: 1.273 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.412898063659668
Epoch: 25, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.270 Vali Acc: 0.541 Test Loss: 1.270 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.4154894351959229
Epoch: 26, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.286 Vali Acc: 0.527 Test Loss: 1.286 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.402533769607544
Epoch: 27, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.310 Vali Acc: 0.541 Test Loss: 1.310 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.4281442165374756
Epoch: 28, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.308 Vali Acc: 0.527 Test Loss: 1.308 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.3472235202789307
Epoch: 29, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.322 Vali Acc: 0.541 Test Loss: 1.322 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.4679548740386963
Epoch: 30, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.357 Vali Acc: 0.527 Test Loss: 1.357 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm16_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5405405405405406
model parameter : 198596
model size : 1.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm16_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.4716405868530273
Epoch: 1, Steps: 10 | Train Loss: 1.452 Vali Loss: 1.423 Vali Acc: 0.203 Test Loss: 1.423 Test Acc: 0.203
Validation loss decreased (inf --> -0.202688).  Saving model ...
Epoch: 2 cost time: 1.8863396644592285
Epoch: 2, Steps: 10 | Train Loss: 1.399 Vali Loss: 1.384 Vali Acc: 0.324 Test Loss: 1.384 Test Acc: 0.324
Validation loss decreased (-0.202688 --> -0.324310).  Saving model ...
Epoch: 3 cost time: 1.9629089832305908
Epoch: 3, Steps: 10 | Train Loss: 1.300 Vali Loss: 1.353 Vali Acc: 0.311 Test Loss: 1.353 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8393957614898682
Epoch: 4, Steps: 10 | Train Loss: 1.209 Vali Loss: 1.311 Vali Acc: 0.365 Test Loss: 1.311 Test Acc: 0.365
Validation loss decreased (-0.324310 --> -0.364852).  Saving model ...
Epoch: 5 cost time: 1.8494157791137695
Epoch: 5, Steps: 10 | Train Loss: 1.067 Vali Loss: 1.257 Vali Acc: 0.459 Test Loss: 1.257 Test Acc: 0.459
Validation loss decreased (-0.364852 --> -0.459447).  Saving model ...
Epoch: 6 cost time: 1.9122397899627686
Epoch: 6, Steps: 10 | Train Loss: 0.972 Vali Loss: 1.202 Vali Acc: 0.486 Test Loss: 1.202 Test Acc: 0.486
Validation loss decreased (-0.459447 --> -0.486474).  Saving model ...
Epoch: 7 cost time: 1.877143383026123
Epoch: 7, Steps: 10 | Train Loss: 0.834 Vali Loss: 1.200 Vali Acc: 0.486 Test Loss: 1.200 Test Acc: 0.486
Validation loss decreased (-0.486474 --> -0.486474).  Saving model ...
Epoch: 8 cost time: 1.907642126083374
Epoch: 8, Steps: 10 | Train Loss: 0.740 Vali Loss: 1.141 Vali Acc: 0.500 Test Loss: 1.141 Test Acc: 0.500
Validation loss decreased (-0.486474 --> -0.499989).  Saving model ...
Epoch: 9 cost time: 1.853135347366333
Epoch: 9, Steps: 10 | Train Loss: 0.625 Vali Loss: 1.100 Vali Acc: 0.527 Test Loss: 1.100 Test Acc: 0.527
Validation loss decreased (-0.499989 --> -0.527016).  Saving model ...
Epoch: 10 cost time: 1.8660399913787842
Epoch: 10, Steps: 10 | Train Loss: 0.502 Vali Loss: 1.090 Vali Acc: 0.500 Test Loss: 1.090 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.968935251235962
Epoch: 11, Steps: 10 | Train Loss: 0.416 Vali Loss: 1.060 Vali Acc: 0.514 Test Loss: 1.060 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.8976318836212158
Epoch: 12, Steps: 10 | Train Loss: 0.322 Vali Loss: 1.050 Vali Acc: 0.514 Test Loss: 1.050 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.9012460708618164
Epoch: 13, Steps: 10 | Train Loss: 0.232 Vali Loss: 1.030 Vali Acc: 0.541 Test Loss: 1.030 Test Acc: 0.541
Validation loss decreased (-0.527016 --> -0.540530).  Saving model ...
Epoch: 14 cost time: 1.8810429573059082
Epoch: 14, Steps: 10 | Train Loss: 0.181 Vali Loss: 1.049 Vali Acc: 0.541 Test Loss: 1.049 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.958756446838379
Epoch: 15, Steps: 10 | Train Loss: 0.126 Vali Loss: 1.024 Vali Acc: 0.514 Test Loss: 1.024 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.9214146137237549
Epoch: 16, Steps: 10 | Train Loss: 0.095 Vali Loss: 1.018 Vali Acc: 0.527 Test Loss: 1.018 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.923539161682129
Epoch: 17, Steps: 10 | Train Loss: 0.072 Vali Loss: 1.001 Vali Acc: 0.527 Test Loss: 1.001 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.904965877532959
Epoch: 18, Steps: 10 | Train Loss: 0.054 Vali Loss: 1.027 Vali Acc: 0.568 Test Loss: 1.027 Test Acc: 0.568
Validation loss decreased (-0.540530 --> -0.567557).  Saving model ...
Epoch: 19 cost time: 1.9108946323394775
Epoch: 19, Steps: 10 | Train Loss: 0.044 Vali Loss: 1.025 Vali Acc: 0.554 Test Loss: 1.025 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.9603397846221924
Epoch: 20, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.024 Vali Acc: 0.541 Test Loss: 1.024 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.8626792430877686
Epoch: 21, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.060 Vali Acc: 0.541 Test Loss: 1.060 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.8836867809295654
Epoch: 22, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.029 Vali Acc: 0.568 Test Loss: 1.029 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.878328800201416
Epoch: 23, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.029 Vali Acc: 0.568 Test Loss: 1.029 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.8942298889160156
Epoch: 24, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.056 Vali Acc: 0.541 Test Loss: 1.056 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.9217395782470703
Epoch: 25, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.063 Vali Acc: 0.568 Test Loss: 1.063 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.5295426845550537
Epoch: 26, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.064 Vali Acc: 0.554 Test Loss: 1.064 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.8955199718475342
Epoch: 27, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.083 Vali Acc: 0.568 Test Loss: 1.083 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.8682246208190918
Epoch: 28, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.097 Vali Acc: 0.541 Test Loss: 1.097 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm16_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 612484
model size : 2.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm16_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.5765411853790283
Epoch: 1, Steps: 10 | Train Loss: 1.434 Vali Loss: 1.434 Vali Acc: 0.216 Test Loss: 1.434 Test Acc: 0.216
Validation loss decreased (inf --> -0.216202).  Saving model ...
Epoch: 2 cost time: 1.1285395622253418
Epoch: 2, Steps: 10 | Train Loss: 1.335 Vali Loss: 1.390 Vali Acc: 0.257 Test Loss: 1.390 Test Acc: 0.257
Validation loss decreased (-0.216202 --> -0.256743).  Saving model ...
Epoch: 3 cost time: 1.1631309986114502
Epoch: 3, Steps: 10 | Train Loss: 1.269 Vali Loss: 1.362 Vali Acc: 0.311 Test Loss: 1.362 Test Acc: 0.311
Validation loss decreased (-0.256743 --> -0.310797).  Saving model ...
Epoch: 4 cost time: 1.1760272979736328
Epoch: 4, Steps: 10 | Train Loss: 1.177 Vali Loss: 1.351 Vali Acc: 0.351 Test Loss: 1.351 Test Acc: 0.351
Validation loss decreased (-0.310797 --> -0.351338).  Saving model ...
Epoch: 5 cost time: 1.1155905723571777
Epoch: 5, Steps: 10 | Train Loss: 1.064 Vali Loss: 1.280 Vali Acc: 0.459 Test Loss: 1.280 Test Acc: 0.459
Validation loss decreased (-0.351338 --> -0.459447).  Saving model ...
Epoch: 6 cost time: 1.1229496002197266
Epoch: 6, Steps: 10 | Train Loss: 0.930 Vali Loss: 1.275 Vali Acc: 0.446 Test Loss: 1.275 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0784056186676025
Epoch: 7, Steps: 10 | Train Loss: 0.819 Vali Loss: 1.209 Vali Acc: 0.514 Test Loss: 1.209 Test Acc: 0.514
Validation loss decreased (-0.459447 --> -0.513501).  Saving model ...
Epoch: 8 cost time: 1.118762493133545
Epoch: 8, Steps: 10 | Train Loss: 0.715 Vali Loss: 1.206 Vali Acc: 0.459 Test Loss: 1.206 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0862095355987549
Epoch: 9, Steps: 10 | Train Loss: 0.602 Vali Loss: 1.154 Vali Acc: 0.500 Test Loss: 1.154 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.1331217288970947
Epoch: 10, Steps: 10 | Train Loss: 0.495 Vali Loss: 1.130 Vali Acc: 0.527 Test Loss: 1.130 Test Acc: 0.527
Validation loss decreased (-0.513501 --> -0.527016).  Saving model ...
Epoch: 11 cost time: 1.1438384056091309
Epoch: 11, Steps: 10 | Train Loss: 0.407 Vali Loss: 1.132 Vali Acc: 0.527 Test Loss: 1.132 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0952107906341553
Epoch: 12, Steps: 10 | Train Loss: 0.323 Vali Loss: 1.108 Vali Acc: 0.554 Test Loss: 1.108 Test Acc: 0.554
Validation loss decreased (-0.527016 --> -0.554043).  Saving model ...
Epoch: 13 cost time: 1.0744233131408691
Epoch: 13, Steps: 10 | Train Loss: 0.247 Vali Loss: 1.100 Vali Acc: 0.554 Test Loss: 1.100 Test Acc: 0.554
Validation loss decreased (-0.554043 --> -0.554043).  Saving model ...
Epoch: 14 cost time: 1.1616814136505127
Epoch: 14, Steps: 10 | Train Loss: 0.196 Vali Loss: 1.091 Vali Acc: 0.568 Test Loss: 1.091 Test Acc: 0.568
Validation loss decreased (-0.554043 --> -0.567557).  Saving model ...
Epoch: 15 cost time: 0.7556586265563965
Epoch: 15, Steps: 10 | Train Loss: 0.149 Vali Loss: 1.136 Vali Acc: 0.568 Test Loss: 1.136 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0648012161254883
Epoch: 16, Steps: 10 | Train Loss: 0.115 Vali Loss: 1.106 Vali Acc: 0.595 Test Loss: 1.106 Test Acc: 0.595
Validation loss decreased (-0.567557 --> -0.594584).  Saving model ...
Epoch: 17 cost time: 1.1339406967163086
Epoch: 17, Steps: 10 | Train Loss: 0.081 Vali Loss: 1.149 Vali Acc: 0.554 Test Loss: 1.149 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2708344459533691
Epoch: 18, Steps: 10 | Train Loss: 0.065 Vali Loss: 1.124 Vali Acc: 0.568 Test Loss: 1.124 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.2218644618988037
Epoch: 19, Steps: 10 | Train Loss: 0.054 Vali Loss: 1.136 Vali Acc: 0.554 Test Loss: 1.136 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.1200776100158691
Epoch: 20, Steps: 10 | Train Loss: 0.045 Vali Loss: 1.124 Vali Acc: 0.568 Test Loss: 1.124 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.150928258895874
Epoch: 21, Steps: 10 | Train Loss: 0.040 Vali Loss: 1.144 Vali Acc: 0.568 Test Loss: 1.144 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.1817924976348877
Epoch: 22, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.126 Vali Acc: 0.581 Test Loss: 1.126 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.142261028289795
Epoch: 23, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.155 Vali Acc: 0.581 Test Loss: 1.155 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.2812631130218506
Epoch: 24, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.168 Vali Acc: 0.595 Test Loss: 1.168 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.1277296543121338
Epoch: 25, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.152 Vali Acc: 0.595 Test Loss: 1.152 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.121196985244751
Epoch: 26, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.165 Vali Acc: 0.595 Test Loss: 1.165 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm16_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 198596
model size : 1.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm16_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.7860021591186523
Epoch: 1, Steps: 10 | Train Loss: 1.455 Vali Loss: 1.423 Vali Acc: 0.203 Test Loss: 1.423 Test Acc: 0.203
Validation loss decreased (inf --> -0.202688).  Saving model ...
Epoch: 2 cost time: 1.2830839157104492
Epoch: 2, Steps: 10 | Train Loss: 1.404 Vali Loss: 1.385 Vali Acc: 0.324 Test Loss: 1.385 Test Acc: 0.324
Validation loss decreased (-0.202688 --> -0.324310).  Saving model ...
Epoch: 3 cost time: 1.3025517463684082
Epoch: 3, Steps: 10 | Train Loss: 1.304 Vali Loss: 1.354 Vali Acc: 0.311 Test Loss: 1.354 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1354143619537354
Epoch: 4, Steps: 10 | Train Loss: 1.216 Vali Loss: 1.312 Vali Acc: 0.365 Test Loss: 1.312 Test Acc: 0.365
Validation loss decreased (-0.324310 --> -0.364852).  Saving model ...
Epoch: 5 cost time: 1.22825026512146
Epoch: 5, Steps: 10 | Train Loss: 1.075 Vali Loss: 1.257 Vali Acc: 0.459 Test Loss: 1.257 Test Acc: 0.459
Validation loss decreased (-0.364852 --> -0.459447).  Saving model ...
Epoch: 6 cost time: 0.8349087238311768
Epoch: 6, Steps: 10 | Train Loss: 0.984 Vali Loss: 1.202 Vali Acc: 0.500 Test Loss: 1.202 Test Acc: 0.500
Validation loss decreased (-0.459447 --> -0.499988).  Saving model ...
Epoch: 7 cost time: 1.3229875564575195
Epoch: 7, Steps: 10 | Train Loss: 0.848 Vali Loss: 1.200 Vali Acc: 0.486 Test Loss: 1.200 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2944719791412354
Epoch: 8, Steps: 10 | Train Loss: 0.759 Vali Loss: 1.140 Vali Acc: 0.527 Test Loss: 1.140 Test Acc: 0.527
Validation loss decreased (-0.499988 --> -0.527016).  Saving model ...
Epoch: 9 cost time: 1.3419878482818604
Epoch: 9, Steps: 10 | Train Loss: 0.648 Vali Loss: 1.096 Vali Acc: 0.554 Test Loss: 1.096 Test Acc: 0.554
Validation loss decreased (-0.527016 --> -0.554043).  Saving model ...
Epoch: 10 cost time: 1.345914363861084
Epoch: 10, Steps: 10 | Train Loss: 0.532 Vali Loss: 1.086 Vali Acc: 0.500 Test Loss: 1.086 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4401745796203613
Epoch: 11, Steps: 10 | Train Loss: 0.447 Vali Loss: 1.049 Vali Acc: 0.541 Test Loss: 1.049 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.415712594985962
Epoch: 12, Steps: 10 | Train Loss: 0.358 Vali Loss: 1.037 Vali Acc: 0.541 Test Loss: 1.037 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.3176848888397217
Epoch: 13, Steps: 10 | Train Loss: 0.270 Vali Loss: 1.013 Vali Acc: 0.514 Test Loss: 1.013 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.3567371368408203
Epoch: 14, Steps: 10 | Train Loss: 0.213 Vali Loss: 1.019 Vali Acc: 0.568 Test Loss: 1.019 Test Acc: 0.568
Validation loss decreased (-0.554043 --> -0.567557).  Saving model ...
Epoch: 15 cost time: 1.4412250518798828
Epoch: 15, Steps: 10 | Train Loss: 0.154 Vali Loss: 1.007 Vali Acc: 0.554 Test Loss: 1.007 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.458714246749878
Epoch: 16, Steps: 10 | Train Loss: 0.119 Vali Loss: 0.982 Vali Acc: 0.554 Test Loss: 0.982 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.4166574478149414
Epoch: 17, Steps: 10 | Train Loss: 0.091 Vali Loss: 0.969 Vali Acc: 0.554 Test Loss: 0.969 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.4664597511291504
Epoch: 18, Steps: 10 | Train Loss: 0.068 Vali Loss: 1.006 Vali Acc: 0.568 Test Loss: 1.006 Test Acc: 0.568
Validation loss decreased (-0.567557 --> -0.567558).  Saving model ...
Epoch: 19 cost time: 1.4760971069335938
Epoch: 19, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.972 Vali Acc: 0.554 Test Loss: 0.972 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.55568265914917
Epoch: 20, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.976 Vali Acc: 0.568 Test Loss: 0.976 Test Acc: 0.568
Validation loss decreased (-0.567558 --> -0.567558).  Saving model ...
Epoch: 21 cost time: 1.4820716381072998
Epoch: 21, Steps: 10 | Train Loss: 0.039 Vali Loss: 1.018 Vali Acc: 0.568 Test Loss: 1.018 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.489781141281128
Epoch: 22, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.973 Vali Acc: 0.595 Test Loss: 0.973 Test Acc: 0.595
Validation loss decreased (-0.567558 --> -0.594585).  Saving model ...
Epoch: 23 cost time: 1.3396625518798828
Epoch: 23, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.985 Vali Acc: 0.568 Test Loss: 0.985 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.4986515045166016
Epoch: 24, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.006 Vali Acc: 0.568 Test Loss: 1.006 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.4936189651489258
Epoch: 25, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.002 Vali Acc: 0.581 Test Loss: 1.002 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.4563753604888916
Epoch: 26, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.993 Vali Acc: 0.568 Test Loss: 0.993 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.3465394973754883
Epoch: 27, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.012 Vali Acc: 0.554 Test Loss: 1.012 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.356431245803833
Epoch: 28, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.027 Vali Acc: 0.568 Test Loss: 1.027 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.3931055068969727
Epoch: 29, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.029 Vali Acc: 0.554 Test Loss: 1.029 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.4222970008850098
Epoch: 30, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.023 Vali Acc: 0.581 Test Loss: 1.023 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm16_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 612484
model size : 2.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm16_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.2480316162109375
Epoch: 1, Steps: 10 | Train Loss: 1.434 Vali Loss: 1.427 Vali Acc: 0.243 Test Loss: 1.427 Test Acc: 0.243
Validation loss decreased (inf --> -0.243229).  Saving model ...
Epoch: 2 cost time: 1.02294921875
Epoch: 2, Steps: 10 | Train Loss: 1.335 Vali Loss: 1.384 Vali Acc: 0.257 Test Loss: 1.384 Test Acc: 0.257
Validation loss decreased (-0.243229 --> -0.256743).  Saving model ...
Epoch: 3 cost time: 1.0042955875396729
Epoch: 3, Steps: 10 | Train Loss: 1.273 Vali Loss: 1.356 Vali Acc: 0.338 Test Loss: 1.356 Test Acc: 0.338
Validation loss decreased (-0.256743 --> -0.337824).  Saving model ...
Epoch: 4 cost time: 1.0277941226959229
Epoch: 4, Steps: 10 | Train Loss: 1.179 Vali Loss: 1.343 Vali Acc: 0.351 Test Loss: 1.343 Test Acc: 0.351
Validation loss decreased (-0.337824 --> -0.351338).  Saving model ...
Epoch: 5 cost time: 1.011695384979248
Epoch: 5, Steps: 10 | Train Loss: 1.069 Vali Loss: 1.276 Vali Acc: 0.500 Test Loss: 1.276 Test Acc: 0.500
Validation loss decreased (-0.351338 --> -0.499987).  Saving model ...
Epoch: 6 cost time: 1.0187609195709229
Epoch: 6, Steps: 10 | Train Loss: 0.935 Vali Loss: 1.271 Vali Acc: 0.446 Test Loss: 1.271 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9863488674163818
Epoch: 7, Steps: 10 | Train Loss: 0.829 Vali Loss: 1.210 Vali Acc: 0.527 Test Loss: 1.210 Test Acc: 0.527
Validation loss decreased (-0.499987 --> -0.527015).  Saving model ...
Epoch: 8 cost time: 1.0076594352722168
Epoch: 8, Steps: 10 | Train Loss: 0.719 Vali Loss: 1.209 Vali Acc: 0.473 Test Loss: 1.209 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9782199859619141
Epoch: 9, Steps: 10 | Train Loss: 0.621 Vali Loss: 1.158 Vali Acc: 0.527 Test Loss: 1.158 Test Acc: 0.527
Validation loss decreased (-0.527015 --> -0.527015).  Saving model ...
Epoch: 10 cost time: 0.9824934005737305
Epoch: 10, Steps: 10 | Train Loss: 0.510 Vali Loss: 1.134 Vali Acc: 0.500 Test Loss: 1.134 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0194296836853027
Epoch: 11, Steps: 10 | Train Loss: 0.421 Vali Loss: 1.137 Vali Acc: 0.527 Test Loss: 1.137 Test Acc: 0.527
Validation loss decreased (-0.527015 --> -0.527016).  Saving model ...
Epoch: 12 cost time: 0.9974510669708252
Epoch: 12, Steps: 10 | Train Loss: 0.338 Vali Loss: 1.102 Vali Acc: 0.568 Test Loss: 1.102 Test Acc: 0.568
Validation loss decreased (-0.527016 --> -0.567557).  Saving model ...
Epoch: 13 cost time: 0.9358410835266113
Epoch: 13, Steps: 10 | Train Loss: 0.259 Vali Loss: 1.086 Vali Acc: 0.568 Test Loss: 1.086 Test Acc: 0.568
Validation loss decreased (-0.567557 --> -0.567557).  Saving model ...
Epoch: 14 cost time: 0.868891716003418
Epoch: 14, Steps: 10 | Train Loss: 0.205 Vali Loss: 1.068 Vali Acc: 0.595 Test Loss: 1.068 Test Acc: 0.595
Validation loss decreased (-0.567557 --> -0.594584).  Saving model ...
Epoch: 15 cost time: 0.8880453109741211
Epoch: 15, Steps: 10 | Train Loss: 0.160 Vali Loss: 1.102 Vali Acc: 0.581 Test Loss: 1.102 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8710932731628418
Epoch: 16, Steps: 10 | Train Loss: 0.118 Vali Loss: 1.075 Vali Acc: 0.581 Test Loss: 1.075 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9021477699279785
Epoch: 17, Steps: 10 | Train Loss: 0.088 Vali Loss: 1.100 Vali Acc: 0.595 Test Loss: 1.100 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.8877565860748291
Epoch: 18, Steps: 10 | Train Loss: 0.070 Vali Loss: 1.077 Vali Acc: 0.581 Test Loss: 1.077 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.9507403373718262
Epoch: 19, Steps: 10 | Train Loss: 0.058 Vali Loss: 1.107 Vali Acc: 0.595 Test Loss: 1.107 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.8911383152008057
Epoch: 20, Steps: 10 | Train Loss: 0.049 Vali Loss: 1.092 Vali Acc: 0.608 Test Loss: 1.092 Test Acc: 0.608
Validation loss decreased (-0.594584 --> -0.608097).  Saving model ...
Epoch: 21 cost time: 0.9340627193450928
Epoch: 21, Steps: 10 | Train Loss: 0.051 Vali Loss: 1.134 Vali Acc: 0.581 Test Loss: 1.134 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.924645185470581
Epoch: 22, Steps: 10 | Train Loss: 0.036 Vali Loss: 1.096 Vali Acc: 0.595 Test Loss: 1.096 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.9824295043945312
Epoch: 23, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.112 Vali Acc: 0.608 Test Loss: 1.112 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.0056750774383545
Epoch: 24, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.136 Vali Acc: 0.608 Test Loss: 1.136 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.9382956027984619
Epoch: 25, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.115 Vali Acc: 0.608 Test Loss: 1.115 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.917123556137085
Epoch: 26, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.121 Vali Acc: 0.608 Test Loss: 1.121 Test Acc: 0.608
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.9281048774719238
Epoch: 27, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.137 Vali Acc: 0.608 Test Loss: 1.137 Test Acc: 0.608
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.9579739570617676
Epoch: 28, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.140 Vali Acc: 0.608 Test Loss: 1.140 Test Acc: 0.608
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.9194886684417725
Epoch: 29, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.155 Vali Acc: 0.608 Test Loss: 1.155 Test Acc: 0.608
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.9195477962493896
Epoch: 30, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.166 Vali Acc: 0.608 Test Loss: 1.166 Test Acc: 0.608
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm16_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 198596
model size : 1.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm16_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.3729121685028076
Epoch: 1, Steps: 10 | Train Loss: 1.448 Vali Loss: 1.408 Vali Acc: 0.189 Test Loss: 1.408 Test Acc: 0.189
Validation loss decreased (inf --> -0.189175).  Saving model ...
Epoch: 2 cost time: 1.855642557144165
Epoch: 2, Steps: 10 | Train Loss: 1.400 Vali Loss: 1.386 Vali Acc: 0.243 Test Loss: 1.386 Test Acc: 0.243
Validation loss decreased (-0.189175 --> -0.243229).  Saving model ...
Epoch: 3 cost time: 1.9351553916931152
Epoch: 3, Steps: 10 | Train Loss: 1.300 Vali Loss: 1.346 Vali Acc: 0.284 Test Loss: 1.346 Test Acc: 0.284
Validation loss decreased (-0.243229 --> -0.283770).  Saving model ...
Epoch: 4 cost time: 1.8284966945648193
Epoch: 4, Steps: 10 | Train Loss: 1.170 Vali Loss: 1.264 Vali Acc: 0.459 Test Loss: 1.264 Test Acc: 0.459
Validation loss decreased (-0.283770 --> -0.459447).  Saving model ...
Epoch: 5 cost time: 1.880096435546875
Epoch: 5, Steps: 10 | Train Loss: 1.040 Vali Loss: 1.229 Vali Acc: 0.473 Test Loss: 1.229 Test Acc: 0.473
Validation loss decreased (-0.459447 --> -0.472961).  Saving model ...
Epoch: 6 cost time: 1.893371343612671
Epoch: 6, Steps: 10 | Train Loss: 0.886 Vali Loss: 1.181 Vali Acc: 0.500 Test Loss: 1.181 Test Acc: 0.500
Validation loss decreased (-0.472961 --> -0.499988).  Saving model ...
Epoch: 7 cost time: 1.8752105236053467
Epoch: 7, Steps: 10 | Train Loss: 0.756 Vali Loss: 1.108 Vali Acc: 0.608 Test Loss: 1.108 Test Acc: 0.608
Validation loss decreased (-0.499988 --> -0.608097).  Saving model ...
Epoch: 8 cost time: 1.8878591060638428
Epoch: 8, Steps: 10 | Train Loss: 0.657 Vali Loss: 1.073 Vali Acc: 0.608 Test Loss: 1.073 Test Acc: 0.608
Validation loss decreased (-0.608097 --> -0.608097).  Saving model ...
Epoch: 9 cost time: 1.819514513015747
Epoch: 9, Steps: 10 | Train Loss: 0.549 Vali Loss: 1.076 Vali Acc: 0.527 Test Loss: 1.076 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7482759952545166
Epoch: 10, Steps: 10 | Train Loss: 0.427 Vali Loss: 1.003 Vali Acc: 0.635 Test Loss: 1.003 Test Acc: 0.635
Validation loss decreased (-0.608097 --> -0.635125).  Saving model ...
Epoch: 11 cost time: 1.7857084274291992
Epoch: 11, Steps: 10 | Train Loss: 0.321 Vali Loss: 1.002 Vali Acc: 0.595 Test Loss: 1.002 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.7990634441375732
Epoch: 12, Steps: 10 | Train Loss: 0.249 Vali Loss: 0.937 Vali Acc: 0.676 Test Loss: 0.937 Test Acc: 0.676
Validation loss decreased (-0.635125 --> -0.675666).  Saving model ...
Epoch: 13 cost time: 1.8497767448425293
Epoch: 13, Steps: 10 | Train Loss: 0.190 Vali Loss: 0.922 Vali Acc: 0.662 Test Loss: 0.922 Test Acc: 0.662
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.8187620639801025
Epoch: 14, Steps: 10 | Train Loss: 0.130 Vali Loss: 0.941 Vali Acc: 0.608 Test Loss: 0.941 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.9006586074829102
Epoch: 15, Steps: 10 | Train Loss: 0.099 Vali Loss: 0.923 Vali Acc: 0.608 Test Loss: 0.923 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.829012393951416
Epoch: 16, Steps: 10 | Train Loss: 0.074 Vali Loss: 0.888 Vali Acc: 0.676 Test Loss: 0.888 Test Acc: 0.676
Validation loss decreased (-0.675666 --> -0.675667).  Saving model ...
Epoch: 17 cost time: 1.8188090324401855
Epoch: 17, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.862 Vali Acc: 0.689 Test Loss: 0.862 Test Acc: 0.689
Validation loss decreased (-0.675667 --> -0.689181).  Saving model ...
Epoch: 18 cost time: 1.8197791576385498
Epoch: 18, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.924 Vali Acc: 0.635 Test Loss: 0.924 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.8434150218963623
Epoch: 19, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.891 Vali Acc: 0.662 Test Loss: 0.891 Test Acc: 0.662
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.8013935089111328
Epoch: 20, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.870 Vali Acc: 0.649 Test Loss: 0.870 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.8121066093444824
Epoch: 21, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.887 Vali Acc: 0.662 Test Loss: 0.887 Test Acc: 0.662
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.783370018005371
Epoch: 22, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.912 Vali Acc: 0.649 Test Loss: 0.912 Test Acc: 0.649
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.8356361389160156
Epoch: 23, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.912 Vali Acc: 0.662 Test Loss: 0.912 Test Acc: 0.662
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.7956538200378418
Epoch: 24, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.916 Vali Acc: 0.662 Test Loss: 0.916 Test Acc: 0.662
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.3329782485961914
Epoch: 25, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.936 Vali Acc: 0.662 Test Loss: 0.936 Test Acc: 0.662
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.7972657680511475
Epoch: 26, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.948 Vali Acc: 0.662 Test Loss: 0.948 Test Acc: 0.662
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.716172218322754
Epoch: 27, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.939 Vali Acc: 0.662 Test Loss: 0.939 Test Acc: 0.662
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm16_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6891891891891891
model parameter : 319428
model size : 1.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm16_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.38037109375
Epoch: 1, Steps: 10 | Train Loss: 1.430 Vali Loss: 1.377 Vali Acc: 0.324 Test Loss: 1.377 Test Acc: 0.324
Validation loss decreased (inf --> -0.324311).  Saving model ...
Epoch: 2 cost time: 1.0872442722320557
Epoch: 2, Steps: 10 | Train Loss: 1.365 Vali Loss: 1.331 Vali Acc: 0.351 Test Loss: 1.331 Test Acc: 0.351
Validation loss decreased (-0.324311 --> -0.351338).  Saving model ...
Epoch: 3 cost time: 1.1289153099060059
Epoch: 3, Steps: 10 | Train Loss: 1.274 Vali Loss: 1.315 Vali Acc: 0.338 Test Loss: 1.315 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1704108715057373
Epoch: 4, Steps: 10 | Train Loss: 1.187 Vali Loss: 1.263 Vali Acc: 0.459 Test Loss: 1.263 Test Acc: 0.459
Validation loss decreased (-0.351338 --> -0.459447).  Saving model ...
Epoch: 5 cost time: 1.112321138381958
Epoch: 5, Steps: 10 | Train Loss: 1.067 Vali Loss: 1.217 Vali Acc: 0.473 Test Loss: 1.217 Test Acc: 0.473
Validation loss decreased (-0.459447 --> -0.472961).  Saving model ...
Epoch: 6 cost time: 1.129499912261963
Epoch: 6, Steps: 10 | Train Loss: 0.934 Vali Loss: 1.234 Vali Acc: 0.446 Test Loss: 1.234 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1111950874328613
Epoch: 7, Steps: 10 | Train Loss: 0.833 Vali Loss: 1.183 Vali Acc: 0.473 Test Loss: 1.183 Test Acc: 0.473
Validation loss decreased (-0.472961 --> -0.472961).  Saving model ...
Epoch: 8 cost time: 1.093919277191162
Epoch: 8, Steps: 10 | Train Loss: 0.717 Vali Loss: 1.159 Vali Acc: 0.473 Test Loss: 1.159 Test Acc: 0.473
Validation loss decreased (-0.472961 --> -0.472961).  Saving model ...
Epoch: 9 cost time: 1.1618263721466064
Epoch: 9, Steps: 10 | Train Loss: 0.620 Vali Loss: 1.186 Vali Acc: 0.459 Test Loss: 1.186 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1225545406341553
Epoch: 10, Steps: 10 | Train Loss: 0.521 Vali Loss: 1.146 Vali Acc: 0.514 Test Loss: 1.146 Test Acc: 0.514
Validation loss decreased (-0.472961 --> -0.513502).  Saving model ...
Epoch: 11 cost time: 1.1612510681152344
Epoch: 11, Steps: 10 | Train Loss: 0.433 Vali Loss: 1.159 Vali Acc: 0.459 Test Loss: 1.159 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2113687992095947
Epoch: 12, Steps: 10 | Train Loss: 0.340 Vali Loss: 1.166 Vali Acc: 0.473 Test Loss: 1.166 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.0395662784576416
Epoch: 13, Steps: 10 | Train Loss: 0.278 Vali Loss: 1.172 Vali Acc: 0.473 Test Loss: 1.172 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.1317713260650635
Epoch: 14, Steps: 10 | Train Loss: 0.211 Vali Loss: 1.173 Vali Acc: 0.473 Test Loss: 1.173 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.0718660354614258
Epoch: 15, Steps: 10 | Train Loss: 0.154 Vali Loss: 1.205 Vali Acc: 0.514 Test Loss: 1.205 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.20200514793396
Epoch: 16, Steps: 10 | Train Loss: 0.128 Vali Loss: 1.223 Vali Acc: 0.500 Test Loss: 1.223 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.1226482391357422
Epoch: 17, Steps: 10 | Train Loss: 0.089 Vali Loss: 1.225 Vali Acc: 0.486 Test Loss: 1.225 Test Acc: 0.486
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.1356151103973389
Epoch: 18, Steps: 10 | Train Loss: 0.078 Vali Loss: 1.228 Vali Acc: 0.486 Test Loss: 1.228 Test Acc: 0.486
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.1473522186279297
Epoch: 19, Steps: 10 | Train Loss: 0.062 Vali Loss: 1.256 Vali Acc: 0.486 Test Loss: 1.256 Test Acc: 0.486
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.125016450881958
Epoch: 20, Steps: 10 | Train Loss: 0.050 Vali Loss: 1.274 Vali Acc: 0.514 Test Loss: 1.274 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm16_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5135135135135135
model parameter : 112452
model size : 0.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm16_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.8246335983276367
Epoch: 1, Steps: 10 | Train Loss: 1.448 Vali Loss: 1.410 Vali Acc: 0.162 Test Loss: 1.410 Test Acc: 0.162
Validation loss decreased (inf --> -0.162148).  Saving model ...
Epoch: 2 cost time: 1.542633056640625
Epoch: 2, Steps: 10 | Train Loss: 1.400 Vali Loss: 1.388 Vali Acc: 0.243 Test Loss: 1.388 Test Acc: 0.243
Validation loss decreased (-0.162148 --> -0.243229).  Saving model ...
Epoch: 3 cost time: 1.5136497020721436
Epoch: 3, Steps: 10 | Train Loss: 1.305 Vali Loss: 1.349 Vali Acc: 0.284 Test Loss: 1.349 Test Acc: 0.284
Validation loss decreased (-0.243229 --> -0.283770).  Saving model ...
Epoch: 4 cost time: 1.5256931781768799
Epoch: 4, Steps: 10 | Train Loss: 1.180 Vali Loss: 1.269 Vali Acc: 0.459 Test Loss: 1.269 Test Acc: 0.459
Validation loss decreased (-0.283770 --> -0.459447).  Saving model ...
Epoch: 5 cost time: 1.5190284252166748
Epoch: 5, Steps: 10 | Train Loss: 1.054 Vali Loss: 1.236 Vali Acc: 0.459 Test Loss: 1.236 Test Acc: 0.459
Validation loss decreased (-0.459447 --> -0.459447).  Saving model ...
Epoch: 6 cost time: 1.5051605701446533
Epoch: 6, Steps: 10 | Train Loss: 0.907 Vali Loss: 1.189 Vali Acc: 0.500 Test Loss: 1.189 Test Acc: 0.500
Validation loss decreased (-0.459447 --> -0.499988).  Saving model ...
Epoch: 7 cost time: 1.4503998756408691
Epoch: 7, Steps: 10 | Train Loss: 0.779 Vali Loss: 1.118 Vali Acc: 0.608 Test Loss: 1.118 Test Acc: 0.608
Validation loss decreased (-0.499988 --> -0.608097).  Saving model ...
Epoch: 8 cost time: 1.4716527462005615
Epoch: 8, Steps: 10 | Train Loss: 0.687 Vali Loss: 1.082 Vali Acc: 0.608 Test Loss: 1.082 Test Acc: 0.608
Validation loss decreased (-0.608097 --> -0.608097).  Saving model ...
Epoch: 9 cost time: 0.9353039264678955
Epoch: 9, Steps: 10 | Train Loss: 0.584 Vali Loss: 1.087 Vali Acc: 0.541 Test Loss: 1.087 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4696142673492432
Epoch: 10, Steps: 10 | Train Loss: 0.459 Vali Loss: 1.010 Vali Acc: 0.622 Test Loss: 1.010 Test Acc: 0.622
Validation loss decreased (-0.608097 --> -0.621612).  Saving model ...
Epoch: 11 cost time: 1.6264011859893799
Epoch: 11, Steps: 10 | Train Loss: 0.354 Vali Loss: 1.003 Vali Acc: 0.595 Test Loss: 1.003 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5424275398254395
Epoch: 12, Steps: 10 | Train Loss: 0.282 Vali Loss: 0.936 Vali Acc: 0.649 Test Loss: 0.936 Test Acc: 0.649
Validation loss decreased (-0.621612 --> -0.648639).  Saving model ...
Epoch: 13 cost time: 1.5711028575897217
Epoch: 13, Steps: 10 | Train Loss: 0.217 Vali Loss: 0.910 Vali Acc: 0.689 Test Loss: 0.910 Test Acc: 0.689
Validation loss decreased (-0.648639 --> -0.689180).  Saving model ...
Epoch: 14 cost time: 1.5940992832183838
Epoch: 14, Steps: 10 | Train Loss: 0.149 Vali Loss: 0.916 Vali Acc: 0.622 Test Loss: 0.916 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.5714681148529053
Epoch: 15, Steps: 10 | Train Loss: 0.113 Vali Loss: 0.895 Vali Acc: 0.649 Test Loss: 0.895 Test Acc: 0.649
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.6118640899658203
Epoch: 16, Steps: 10 | Train Loss: 0.084 Vali Loss: 0.863 Vali Acc: 0.649 Test Loss: 0.863 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.5581767559051514
Epoch: 17, Steps: 10 | Train Loss: 0.069 Vali Loss: 0.843 Vali Acc: 0.635 Test Loss: 0.843 Test Acc: 0.635
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.5622270107269287
Epoch: 18, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.909 Vali Acc: 0.595 Test Loss: 0.909 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.6062910556793213
Epoch: 19, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.869 Vali Acc: 0.622 Test Loss: 0.869 Test Acc: 0.622
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.5778260231018066
Epoch: 20, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.865 Vali Acc: 0.649 Test Loss: 0.865 Test Acc: 0.649
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.52705717086792
Epoch: 21, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.861 Vali Acc: 0.662 Test Loss: 0.861 Test Acc: 0.662
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.578634262084961
Epoch: 22, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.886 Vali Acc: 0.635 Test Loss: 0.886 Test Acc: 0.635
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.5609848499298096
Epoch: 23, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.903 Vali Acc: 0.635 Test Loss: 0.903 Test Acc: 0.635
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm16_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6891891891891891
model parameter : 319428
model size : 1.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm16_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.4694628715515137
Epoch: 1, Steps: 10 | Train Loss: 1.423 Vali Loss: 1.378 Vali Acc: 0.297 Test Loss: 1.378 Test Acc: 0.297
Validation loss decreased (inf --> -0.297284).  Saving model ...
Epoch: 2 cost time: 1.0348162651062012
Epoch: 2, Steps: 10 | Train Loss: 1.372 Vali Loss: 1.332 Vali Acc: 0.351 Test Loss: 1.332 Test Acc: 0.351
Validation loss decreased (-0.297284 --> -0.351338).  Saving model ...
Epoch: 3 cost time: 1.1074271202087402
Epoch: 3, Steps: 10 | Train Loss: 1.276 Vali Loss: 1.314 Vali Acc: 0.351 Test Loss: 1.314 Test Acc: 0.351
Validation loss decreased (-0.351338 --> -0.351338).  Saving model ...
Epoch: 4 cost time: 1.0272774696350098
Epoch: 4, Steps: 10 | Train Loss: 1.196 Vali Loss: 1.261 Vali Acc: 0.459 Test Loss: 1.261 Test Acc: 0.459
Validation loss decreased (-0.351338 --> -0.459447).  Saving model ...
Epoch: 5 cost time: 1.041001796722412
Epoch: 5, Steps: 10 | Train Loss: 1.077 Vali Loss: 1.215 Vali Acc: 0.500 Test Loss: 1.215 Test Acc: 0.500
Validation loss decreased (-0.459447 --> -0.499988).  Saving model ...
Epoch: 6 cost time: 1.0303311347961426
Epoch: 6, Steps: 10 | Train Loss: 0.945 Vali Loss: 1.229 Vali Acc: 0.473 Test Loss: 1.229 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0424773693084717
Epoch: 7, Steps: 10 | Train Loss: 0.856 Vali Loss: 1.178 Vali Acc: 0.446 Test Loss: 1.178 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.0523715019226074
Epoch: 8, Steps: 10 | Train Loss: 0.743 Vali Loss: 1.150 Vali Acc: 0.514 Test Loss: 1.150 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513502).  Saving model ...
Epoch: 9 cost time: 1.0478200912475586
Epoch: 9, Steps: 10 | Train Loss: 0.646 Vali Loss: 1.173 Vali Acc: 0.554 Test Loss: 1.173 Test Acc: 0.554
Validation loss decreased (-0.513502 --> -0.554042).  Saving model ...
Epoch: 10 cost time: 1.0038278102874756
Epoch: 10, Steps: 10 | Train Loss: 0.548 Vali Loss: 1.131 Vali Acc: 0.541 Test Loss: 1.131 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0589072704315186
Epoch: 11, Steps: 10 | Train Loss: 0.466 Vali Loss: 1.146 Vali Acc: 0.514 Test Loss: 1.146 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.0473706722259521
Epoch: 12, Steps: 10 | Train Loss: 0.375 Vali Loss: 1.145 Vali Acc: 0.486 Test Loss: 1.145 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.0984549522399902
Epoch: 13, Steps: 10 | Train Loss: 0.313 Vali Loss: 1.146 Vali Acc: 0.514 Test Loss: 1.146 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.0563068389892578
Epoch: 14, Steps: 10 | Train Loss: 0.243 Vali Loss: 1.141 Vali Acc: 0.527 Test Loss: 1.141 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.0753819942474365
Epoch: 15, Steps: 10 | Train Loss: 0.176 Vali Loss: 1.181 Vali Acc: 0.514 Test Loss: 1.181 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.0938129425048828
Epoch: 16, Steps: 10 | Train Loss: 0.159 Vali Loss: 1.193 Vali Acc: 0.514 Test Loss: 1.193 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.0209548473358154
Epoch: 17, Steps: 10 | Train Loss: 0.118 Vali Loss: 1.191 Vali Acc: 0.500 Test Loss: 1.191 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.0066580772399902
Epoch: 18, Steps: 10 | Train Loss: 0.095 Vali Loss: 1.177 Vali Acc: 0.527 Test Loss: 1.177 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.0715255737304688
Epoch: 19, Steps: 10 | Train Loss: 0.076 Vali Loss: 1.233 Vali Acc: 0.541 Test Loss: 1.233 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm16_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 112452
model size : 0.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm16_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.364041805267334
Epoch: 1, Steps: 10 | Train Loss: 1.448 Vali Loss: 1.409 Vali Acc: 0.176 Test Loss: 1.409 Test Acc: 0.176
Validation loss decreased (inf --> -0.175662).  Saving model ...
Epoch: 2 cost time: 1.2254979610443115
Epoch: 2, Steps: 10 | Train Loss: 1.401 Vali Loss: 1.389 Vali Acc: 0.257 Test Loss: 1.389 Test Acc: 0.257
Validation loss decreased (-0.175662 --> -0.256743).  Saving model ...
Epoch: 3 cost time: 1.2952156066894531
Epoch: 3, Steps: 10 | Train Loss: 1.308 Vali Loss: 1.350 Vali Acc: 0.284 Test Loss: 1.350 Test Acc: 0.284
Validation loss decreased (-0.256743 --> -0.283770).  Saving model ...
Epoch: 4 cost time: 1.2390844821929932
Epoch: 4, Steps: 10 | Train Loss: 1.184 Vali Loss: 1.269 Vali Acc: 0.473 Test Loss: 1.269 Test Acc: 0.473
Validation loss decreased (-0.283770 --> -0.472960).  Saving model ...
Epoch: 5 cost time: 1.2555720806121826
Epoch: 5, Steps: 10 | Train Loss: 1.060 Vali Loss: 1.235 Vali Acc: 0.473 Test Loss: 1.235 Test Acc: 0.473
Validation loss decreased (-0.472960 --> -0.472961).  Saving model ...
Epoch: 6 cost time: 1.2403035163879395
Epoch: 6, Steps: 10 | Train Loss: 0.914 Vali Loss: 1.190 Vali Acc: 0.500 Test Loss: 1.190 Test Acc: 0.500
Validation loss decreased (-0.472961 --> -0.499988).  Saving model ...
Epoch: 7 cost time: 1.1949551105499268
Epoch: 7, Steps: 10 | Train Loss: 0.791 Vali Loss: 1.119 Vali Acc: 0.608 Test Loss: 1.119 Test Acc: 0.608
Validation loss decreased (-0.499988 --> -0.608097).  Saving model ...
Epoch: 8 cost time: 1.335838794708252
Epoch: 8, Steps: 10 | Train Loss: 0.695 Vali Loss: 1.084 Vali Acc: 0.608 Test Loss: 1.084 Test Acc: 0.608
Validation loss decreased (-0.608097 --> -0.608097).  Saving model ...
Epoch: 9 cost time: 1.2911632061004639
Epoch: 9, Steps: 10 | Train Loss: 0.596 Vali Loss: 1.086 Vali Acc: 0.554 Test Loss: 1.086 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.190312385559082
Epoch: 10, Steps: 10 | Train Loss: 0.475 Vali Loss: 1.012 Vali Acc: 0.608 Test Loss: 1.012 Test Acc: 0.608
Validation loss decreased (-0.608097 --> -0.608098).  Saving model ...
Epoch: 11 cost time: 1.3286247253417969
Epoch: 11, Steps: 10 | Train Loss: 0.367 Vali Loss: 1.004 Vali Acc: 0.595 Test Loss: 1.004 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3108961582183838
Epoch: 12, Steps: 10 | Train Loss: 0.294 Vali Loss: 0.940 Vali Acc: 0.662 Test Loss: 0.940 Test Acc: 0.662
Validation loss decreased (-0.608098 --> -0.662153).  Saving model ...
Epoch: 13 cost time: 1.2752115726470947
Epoch: 13, Steps: 10 | Train Loss: 0.229 Vali Loss: 0.911 Vali Acc: 0.676 Test Loss: 0.911 Test Acc: 0.676
Validation loss decreased (-0.662153 --> -0.675667).  Saving model ...
Epoch: 14 cost time: 1.346374273300171
Epoch: 14, Steps: 10 | Train Loss: 0.160 Vali Loss: 0.926 Vali Acc: 0.622 Test Loss: 0.926 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.282792329788208
Epoch: 15, Steps: 10 | Train Loss: 0.125 Vali Loss: 0.903 Vali Acc: 0.676 Test Loss: 0.903 Test Acc: 0.676
Validation loss decreased (-0.675667 --> -0.675667).  Saving model ...
Epoch: 16 cost time: 1.292323350906372
Epoch: 16, Steps: 10 | Train Loss: 0.094 Vali Loss: 0.868 Vali Acc: 0.662 Test Loss: 0.868 Test Acc: 0.662
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2490386962890625
Epoch: 17, Steps: 10 | Train Loss: 0.076 Vali Loss: 0.847 Vali Acc: 0.676 Test Loss: 0.847 Test Acc: 0.676
Validation loss decreased (-0.675667 --> -0.675667).  Saving model ...
Epoch: 18 cost time: 1.3097448348999023
Epoch: 18, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.916 Vali Acc: 0.622 Test Loss: 0.916 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2309207916259766
Epoch: 19, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.874 Vali Acc: 0.622 Test Loss: 0.874 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.2480876445770264
Epoch: 20, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.862 Vali Acc: 0.649 Test Loss: 0.862 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.3180592060089111
Epoch: 21, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.875 Vali Acc: 0.662 Test Loss: 0.875 Test Acc: 0.662
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.2411634922027588
Epoch: 22, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.888 Vali Acc: 0.595 Test Loss: 0.888 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.2115256786346436
Epoch: 23, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.904 Vali Acc: 0.595 Test Loss: 0.904 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.2331061363220215
Epoch: 24, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.908 Vali Acc: 0.568 Test Loss: 0.908 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.3145902156829834
Epoch: 25, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.913 Vali Acc: 0.581 Test Loss: 0.913 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.2876896858215332
Epoch: 26, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.900 Vali Acc: 0.608 Test Loss: 0.900 Test Acc: 0.608
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.3235127925872803
Epoch: 27, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.900 Vali Acc: 0.581 Test Loss: 0.900 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm16_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6756756756756757
model parameter : 319428
model size : 1.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm16_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.3211512565612793
Epoch: 1, Steps: 10 | Train Loss: 1.426 Vali Loss: 1.390 Vali Acc: 0.311 Test Loss: 1.390 Test Acc: 0.311
Validation loss decreased (inf --> -0.310797).  Saving model ...
Epoch: 2 cost time: 0.8860650062561035
Epoch: 2, Steps: 10 | Train Loss: 1.371 Vali Loss: 1.342 Vali Acc: 0.324 Test Loss: 1.342 Test Acc: 0.324
Validation loss decreased (-0.310797 --> -0.324311).  Saving model ...
Epoch: 3 cost time: 0.8856620788574219
Epoch: 3, Steps: 10 | Train Loss: 1.280 Vali Loss: 1.328 Vali Acc: 0.351 Test Loss: 1.328 Test Acc: 0.351
Validation loss decreased (-0.324311 --> -0.351338).  Saving model ...
Epoch: 4 cost time: 0.9537811279296875
Epoch: 4, Steps: 10 | Train Loss: 1.198 Vali Loss: 1.272 Vali Acc: 0.405 Test Loss: 1.272 Test Acc: 0.405
Validation loss decreased (-0.351338 --> -0.405393).  Saving model ...
Epoch: 5 cost time: 0.8809947967529297
Epoch: 5, Steps: 10 | Train Loss: 1.089 Vali Loss: 1.224 Vali Acc: 0.459 Test Loss: 1.224 Test Acc: 0.459
Validation loss decreased (-0.405393 --> -0.459447).  Saving model ...
Epoch: 6 cost time: 0.9155559539794922
Epoch: 6, Steps: 10 | Train Loss: 0.962 Vali Loss: 1.239 Vali Acc: 0.459 Test Loss: 1.239 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8833873271942139
Epoch: 7, Steps: 10 | Train Loss: 0.872 Vali Loss: 1.187 Vali Acc: 0.405 Test Loss: 1.187 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9051802158355713
Epoch: 8, Steps: 10 | Train Loss: 0.764 Vali Loss: 1.154 Vali Acc: 0.527 Test Loss: 1.154 Test Acc: 0.527
Validation loss decreased (-0.459447 --> -0.527015).  Saving model ...
Epoch: 9 cost time: 0.9214153289794922
Epoch: 9, Steps: 10 | Train Loss: 0.671 Vali Loss: 1.174 Vali Acc: 0.527 Test Loss: 1.174 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.928152322769165
Epoch: 10, Steps: 10 | Train Loss: 0.587 Vali Loss: 1.132 Vali Acc: 0.527 Test Loss: 1.132 Test Acc: 0.527
Validation loss decreased (-0.527015 --> -0.527016).  Saving model ...
Epoch: 11 cost time: 0.940455436706543
Epoch: 11, Steps: 10 | Train Loss: 0.501 Vali Loss: 1.146 Vali Acc: 0.486 Test Loss: 1.146 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9516100883483887
Epoch: 12, Steps: 10 | Train Loss: 0.411 Vali Loss: 1.142 Vali Acc: 0.541 Test Loss: 1.142 Test Acc: 0.541
Validation loss decreased (-0.527016 --> -0.540529).  Saving model ...
Epoch: 13 cost time: 1.0738718509674072
Epoch: 13, Steps: 10 | Train Loss: 0.361 Vali Loss: 1.141 Vali Acc: 0.514 Test Loss: 1.141 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9304656982421875
Epoch: 14, Steps: 10 | Train Loss: 0.284 Vali Loss: 1.125 Vali Acc: 0.554 Test Loss: 1.125 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554043).  Saving model ...
Epoch: 15 cost time: 0.9322965145111084
Epoch: 15, Steps: 10 | Train Loss: 0.218 Vali Loss: 1.173 Vali Acc: 0.500 Test Loss: 1.173 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8830099105834961
Epoch: 16, Steps: 10 | Train Loss: 0.186 Vali Loss: 1.167 Vali Acc: 0.514 Test Loss: 1.167 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.0046756267547607
Epoch: 17, Steps: 10 | Train Loss: 0.135 Vali Loss: 1.172 Vali Acc: 0.527 Test Loss: 1.172 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.8835899829864502
Epoch: 18, Steps: 10 | Train Loss: 0.114 Vali Loss: 1.164 Vali Acc: 0.527 Test Loss: 1.164 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.859931230545044
Epoch: 19, Steps: 10 | Train Loss: 0.092 Vali Loss: 1.215 Vali Acc: 0.527 Test Loss: 1.215 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.8858890533447266
Epoch: 20, Steps: 10 | Train Loss: 0.075 Vali Loss: 1.215 Vali Acc: 0.541 Test Loss: 1.215 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.9294049739837646
Epoch: 21, Steps: 10 | Train Loss: 0.067 Vali Loss: 1.213 Vali Acc: 0.527 Test Loss: 1.213 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.8549656867980957
Epoch: 22, Steps: 10 | Train Loss: 0.053 Vali Loss: 1.248 Vali Acc: 0.514 Test Loss: 1.248 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.8585593700408936
Epoch: 23, Steps: 10 | Train Loss: 0.046 Vali Loss: 1.243 Vali Acc: 0.541 Test Loss: 1.243 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.8865878582000732
Epoch: 24, Steps: 10 | Train Loss: 0.039 Vali Loss: 1.274 Vali Acc: 0.527 Test Loss: 1.274 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm16_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 112452
model size : 0.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm8_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.934051036834717
Epoch: 1, Steps: 10 | Train Loss: 1.401 Vali Loss: 1.451 Vali Acc: 0.122 Test Loss: 1.451 Test Acc: 0.122
Validation loss decreased (inf --> -0.121607).  Saving model ...
Epoch: 2 cost time: 2.47119140625
Epoch: 2, Steps: 10 | Train Loss: 1.379 Vali Loss: 1.424 Vali Acc: 0.203 Test Loss: 1.424 Test Acc: 0.203
Validation loss decreased (-0.121607 --> -0.202688).  Saving model ...
Epoch: 3 cost time: 2.495476007461548
Epoch: 3, Steps: 10 | Train Loss: 1.318 Vali Loss: 1.410 Vali Acc: 0.270 Test Loss: 1.410 Test Acc: 0.270
Validation loss decreased (-0.202688 --> -0.270256).  Saving model ...
Epoch: 4 cost time: 2.5453147888183594
Epoch: 4, Steps: 10 | Train Loss: 1.247 Vali Loss: 1.381 Vali Acc: 0.324 Test Loss: 1.381 Test Acc: 0.324
Validation loss decreased (-0.270256 --> -0.324311).  Saving model ...
Epoch: 5 cost time: 2.5968801975250244
Epoch: 5, Steps: 10 | Train Loss: 1.160 Vali Loss: 1.341 Vali Acc: 0.405 Test Loss: 1.341 Test Acc: 0.405
Validation loss decreased (-0.324311 --> -0.405392).  Saving model ...
Epoch: 6 cost time: 2.0380098819732666
Epoch: 6, Steps: 10 | Train Loss: 1.078 Vali Loss: 1.339 Vali Acc: 0.432 Test Loss: 1.339 Test Acc: 0.432
Validation loss decreased (-0.405392 --> -0.432419).  Saving model ...
Epoch: 7 cost time: 2.6239283084869385
Epoch: 7, Steps: 10 | Train Loss: 0.978 Vali Loss: 1.316 Vali Acc: 0.419 Test Loss: 1.316 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.472515106201172
Epoch: 8, Steps: 10 | Train Loss: 0.904 Vali Loss: 1.310 Vali Acc: 0.392 Test Loss: 1.310 Test Acc: 0.392
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.59085750579834
Epoch: 9, Steps: 10 | Train Loss: 0.786 Vali Loss: 1.273 Vali Acc: 0.432 Test Loss: 1.273 Test Acc: 0.432
Validation loss decreased (-0.432419 --> -0.432420).  Saving model ...
Epoch: 10 cost time: 2.6468703746795654
Epoch: 10, Steps: 10 | Train Loss: 0.702 Vali Loss: 1.269 Vali Acc: 0.378 Test Loss: 1.269 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.6287262439727783
Epoch: 11, Steps: 10 | Train Loss: 0.609 Vali Loss: 1.272 Vali Acc: 0.419 Test Loss: 1.272 Test Acc: 0.419
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.4438886642456055
Epoch: 12, Steps: 10 | Train Loss: 0.496 Vali Loss: 1.253 Vali Acc: 0.378 Test Loss: 1.253 Test Acc: 0.378
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.53413724899292
Epoch: 13, Steps: 10 | Train Loss: 0.431 Vali Loss: 1.231 Vali Acc: 0.432 Test Loss: 1.231 Test Acc: 0.432
Validation loss decreased (-0.432420 --> -0.432420).  Saving model ...
Epoch: 14 cost time: 2.431989908218384
Epoch: 14, Steps: 10 | Train Loss: 0.356 Vali Loss: 1.237 Vali Acc: 0.405 Test Loss: 1.237 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.507002830505371
Epoch: 15, Steps: 10 | Train Loss: 0.280 Vali Loss: 1.232 Vali Acc: 0.419 Test Loss: 1.232 Test Acc: 0.419
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.493868827819824
Epoch: 16, Steps: 10 | Train Loss: 0.219 Vali Loss: 1.201 Vali Acc: 0.446 Test Loss: 1.201 Test Acc: 0.446
Validation loss decreased (-0.432420 --> -0.445934).  Saving model ...
Epoch: 17 cost time: 2.4205052852630615
Epoch: 17, Steps: 10 | Train Loss: 0.181 Vali Loss: 1.208 Vali Acc: 0.473 Test Loss: 1.208 Test Acc: 0.473
Validation loss decreased (-0.445934 --> -0.472961).  Saving model ...
Epoch: 18 cost time: 2.3866028785705566
Epoch: 18, Steps: 10 | Train Loss: 0.150 Vali Loss: 1.224 Vali Acc: 0.459 Test Loss: 1.224 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.446340799331665
Epoch: 19, Steps: 10 | Train Loss: 0.121 Vali Loss: 1.269 Vali Acc: 0.459 Test Loss: 1.269 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.54085373878479
Epoch: 20, Steps: 10 | Train Loss: 0.093 Vali Loss: 1.264 Vali Acc: 0.432 Test Loss: 1.264 Test Acc: 0.432
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.7648992538452148
Epoch: 21, Steps: 10 | Train Loss: 0.094 Vali Loss: 1.222 Vali Acc: 0.446 Test Loss: 1.222 Test Acc: 0.446
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.684662103652954
Epoch: 22, Steps: 10 | Train Loss: 0.089 Vali Loss: 1.266 Vali Acc: 0.473 Test Loss: 1.266 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.6737773418426514
Epoch: 23, Steps: 10 | Train Loss: 0.078 Vali Loss: 1.319 Vali Acc: 0.459 Test Loss: 1.319 Test Acc: 0.459
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.71307110786438
Epoch: 24, Steps: 10 | Train Loss: 0.069 Vali Loss: 1.311 Vali Acc: 0.446 Test Loss: 1.311 Test Acc: 0.446
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.670243263244629
Epoch: 25, Steps: 10 | Train Loss: 0.051 Vali Loss: 1.304 Vali Acc: 0.446 Test Loss: 1.304 Test Acc: 0.446
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.6048574447631836
Epoch: 26, Steps: 10 | Train Loss: 0.042 Vali Loss: 1.287 Vali Acc: 0.446 Test Loss: 1.287 Test Acc: 0.446
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.609135866165161
Epoch: 27, Steps: 10 | Train Loss: 0.044 Vali Loss: 1.301 Vali Acc: 0.446 Test Loss: 1.301 Test Acc: 0.446
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm8_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.47297297297297297
model parameter : 599684
model size : 2.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm8_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.018709659576416
Epoch: 1, Steps: 10 | Train Loss: 1.428 Vali Loss: 1.457 Vali Acc: 0.243 Test Loss: 1.457 Test Acc: 0.243
Validation loss decreased (inf --> -0.243229).  Saving model ...
Epoch: 2 cost time: 1.545694351196289
Epoch: 2, Steps: 10 | Train Loss: 1.369 Vali Loss: 1.429 Vali Acc: 0.284 Test Loss: 1.429 Test Acc: 0.284
Validation loss decreased (-0.243229 --> -0.283769).  Saving model ...
Epoch: 3 cost time: 1.5772578716278076
Epoch: 3, Steps: 10 | Train Loss: 1.330 Vali Loss: 1.396 Vali Acc: 0.270 Test Loss: 1.396 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5464353561401367
Epoch: 4, Steps: 10 | Train Loss: 1.275 Vali Loss: 1.370 Vali Acc: 0.297 Test Loss: 1.370 Test Acc: 0.297
Validation loss decreased (-0.283769 --> -0.297284).  Saving model ...
Epoch: 5 cost time: 1.4799375534057617
Epoch: 5, Steps: 10 | Train Loss: 1.197 Vali Loss: 1.338 Vali Acc: 0.324 Test Loss: 1.338 Test Acc: 0.324
Validation loss decreased (-0.297284 --> -0.324311).  Saving model ...
Epoch: 6 cost time: 1.6102399826049805
Epoch: 6, Steps: 10 | Train Loss: 1.102 Vali Loss: 1.314 Vali Acc: 0.365 Test Loss: 1.314 Test Acc: 0.365
Validation loss decreased (-0.324311 --> -0.364852).  Saving model ...
Epoch: 7 cost time: 1.5887432098388672
Epoch: 7, Steps: 10 | Train Loss: 1.035 Vali Loss: 1.289 Vali Acc: 0.378 Test Loss: 1.289 Test Acc: 0.378
Validation loss decreased (-0.364852 --> -0.378365).  Saving model ...
Epoch: 8 cost time: 1.6028413772583008
Epoch: 8, Steps: 10 | Train Loss: 0.966 Vali Loss: 1.274 Vali Acc: 0.378 Test Loss: 1.274 Test Acc: 0.378
Validation loss decreased (-0.378365 --> -0.378366).  Saving model ...
Epoch: 9 cost time: 1.5479774475097656
Epoch: 9, Steps: 10 | Train Loss: 0.850 Vali Loss: 1.271 Vali Acc: 0.432 Test Loss: 1.271 Test Acc: 0.432
Validation loss decreased (-0.378366 --> -0.432420).  Saving model ...
Epoch: 10 cost time: 1.5120007991790771
Epoch: 10, Steps: 10 | Train Loss: 0.782 Vali Loss: 1.246 Vali Acc: 0.486 Test Loss: 1.246 Test Acc: 0.486
Validation loss decreased (-0.432420 --> -0.486474).  Saving model ...
Epoch: 11 cost time: 1.5027871131896973
Epoch: 11, Steps: 10 | Train Loss: 0.727 Vali Loss: 1.228 Vali Acc: 0.459 Test Loss: 1.228 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.522386074066162
Epoch: 12, Steps: 10 | Train Loss: 0.656 Vali Loss: 1.227 Vali Acc: 0.419 Test Loss: 1.227 Test Acc: 0.419
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.454101800918579
Epoch: 13, Steps: 10 | Train Loss: 0.588 Vali Loss: 1.236 Vali Acc: 0.459 Test Loss: 1.236 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.4492857456207275
Epoch: 14, Steps: 10 | Train Loss: 0.493 Vali Loss: 1.227 Vali Acc: 0.486 Test Loss: 1.227 Test Acc: 0.486
Validation loss decreased (-0.486474 --> -0.486474).  Saving model ...
Epoch: 15 cost time: 1.412757158279419
Epoch: 15, Steps: 10 | Train Loss: 0.445 Vali Loss: 1.226 Vali Acc: 0.473 Test Loss: 1.226 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.5304808616638184
Epoch: 16, Steps: 10 | Train Loss: 0.382 Vali Loss: 1.214 Vali Acc: 0.486 Test Loss: 1.214 Test Acc: 0.486
Validation loss decreased (-0.486474 --> -0.486474).  Saving model ...
Epoch: 17 cost time: 1.490910530090332
Epoch: 17, Steps: 10 | Train Loss: 0.332 Vali Loss: 1.203 Vali Acc: 0.500 Test Loss: 1.203 Test Acc: 0.500
Validation loss decreased (-0.486474 --> -0.499988).  Saving model ...
Epoch: 18 cost time: 1.5054152011871338
Epoch: 18, Steps: 10 | Train Loss: 0.274 Vali Loss: 1.227 Vali Acc: 0.486 Test Loss: 1.227 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.548820972442627
Epoch: 19, Steps: 10 | Train Loss: 0.245 Vali Loss: 1.238 Vali Acc: 0.446 Test Loss: 1.238 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.4518020153045654
Epoch: 20, Steps: 10 | Train Loss: 0.189 Vali Loss: 1.248 Vali Acc: 0.432 Test Loss: 1.248 Test Acc: 0.432
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.5102319717407227
Epoch: 21, Steps: 10 | Train Loss: 0.160 Vali Loss: 1.212 Vali Acc: 0.473 Test Loss: 1.212 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.4811079502105713
Epoch: 22, Steps: 10 | Train Loss: 0.143 Vali Loss: 1.222 Vali Acc: 0.486 Test Loss: 1.222 Test Acc: 0.486
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.590501070022583
Epoch: 23, Steps: 10 | Train Loss: 0.128 Vali Loss: 1.253 Vali Acc: 0.446 Test Loss: 1.253 Test Acc: 0.446
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.4788687229156494
Epoch: 24, Steps: 10 | Train Loss: 0.114 Vali Loss: 1.230 Vali Acc: 0.473 Test Loss: 1.230 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.5105624198913574
Epoch: 25, Steps: 10 | Train Loss: 0.094 Vali Loss: 1.196 Vali Acc: 0.527 Test Loss: 1.196 Test Acc: 0.527
Validation loss decreased (-0.499988 --> -0.527015).  Saving model ...
Epoch: 26 cost time: 1.4854223728179932
Epoch: 26, Steps: 10 | Train Loss: 0.083 Vali Loss: 1.203 Vali Acc: 0.500 Test Loss: 1.203 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.5342116355895996
Epoch: 27, Steps: 10 | Train Loss: 0.072 Vali Loss: 1.220 Vali Acc: 0.514 Test Loss: 1.220 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.4480750560760498
Epoch: 28, Steps: 10 | Train Loss: 0.067 Vali Loss: 1.260 Vali Acc: 0.459 Test Loss: 1.260 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.4439616203308105
Epoch: 29, Steps: 10 | Train Loss: 0.063 Vali Loss: 1.268 Vali Acc: 0.473 Test Loss: 1.268 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.4339196681976318
Epoch: 30, Steps: 10 | Train Loss: 0.053 Vali Loss: 1.285 Vali Acc: 0.459 Test Loss: 1.285 Test Acc: 0.459
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm8_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.527027027027027
model parameter : 185700
model size : 0.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm8_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.5466177463531494
Epoch: 1, Steps: 10 | Train Loss: 1.401 Vali Loss: 1.446 Vali Acc: 0.135 Test Loss: 1.446 Test Acc: 0.135
Validation loss decreased (inf --> -0.135121).  Saving model ...
Epoch: 2 cost time: 1.9033384323120117
Epoch: 2, Steps: 10 | Train Loss: 1.377 Vali Loss: 1.417 Vali Acc: 0.243 Test Loss: 1.417 Test Acc: 0.243
Validation loss decreased (-0.135121 --> -0.243229).  Saving model ...
Epoch: 3 cost time: 1.9093759059906006
Epoch: 3, Steps: 10 | Train Loss: 1.317 Vali Loss: 1.402 Vali Acc: 0.324 Test Loss: 1.402 Test Acc: 0.324
Validation loss decreased (-0.243229 --> -0.324310).  Saving model ...
Epoch: 4 cost time: 1.8477516174316406
Epoch: 4, Steps: 10 | Train Loss: 1.242 Vali Loss: 1.372 Vali Acc: 0.324 Test Loss: 1.372 Test Acc: 0.324
Validation loss decreased (-0.324310 --> -0.324311).  Saving model ...
Epoch: 5 cost time: 2.005610466003418
Epoch: 5, Steps: 10 | Train Loss: 1.156 Vali Loss: 1.332 Vali Acc: 0.392 Test Loss: 1.332 Test Acc: 0.392
Validation loss decreased (-0.324311 --> -0.391879).  Saving model ...
Epoch: 6 cost time: 1.8815977573394775
Epoch: 6, Steps: 10 | Train Loss: 1.066 Vali Loss: 1.328 Vali Acc: 0.392 Test Loss: 1.328 Test Acc: 0.392
Validation loss decreased (-0.391879 --> -0.391879).  Saving model ...
Epoch: 7 cost time: 1.8466904163360596
Epoch: 7, Steps: 10 | Train Loss: 0.970 Vali Loss: 1.306 Vali Acc: 0.432 Test Loss: 1.306 Test Acc: 0.432
Validation loss decreased (-0.391879 --> -0.432419).  Saving model ...
Epoch: 8 cost time: 1.851930856704712
Epoch: 8, Steps: 10 | Train Loss: 0.894 Vali Loss: 1.297 Vali Acc: 0.419 Test Loss: 1.297 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.924663782119751
Epoch: 9, Steps: 10 | Train Loss: 0.773 Vali Loss: 1.260 Vali Acc: 0.446 Test Loss: 1.260 Test Acc: 0.446
Validation loss decreased (-0.432419 --> -0.445933).  Saving model ...
Epoch: 10 cost time: 1.9249422550201416
Epoch: 10, Steps: 10 | Train Loss: 0.679 Vali Loss: 1.249 Vali Acc: 0.392 Test Loss: 1.249 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.868866205215454
Epoch: 11, Steps: 10 | Train Loss: 0.585 Vali Loss: 1.244 Vali Acc: 0.432 Test Loss: 1.244 Test Acc: 0.432
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.8948447704315186
Epoch: 12, Steps: 10 | Train Loss: 0.475 Vali Loss: 1.218 Vali Acc: 0.432 Test Loss: 1.218 Test Acc: 0.432
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.8761012554168701
Epoch: 13, Steps: 10 | Train Loss: 0.403 Vali Loss: 1.215 Vali Acc: 0.446 Test Loss: 1.215 Test Acc: 0.446
Validation loss decreased (-0.445933 --> -0.445934).  Saving model ...
Epoch: 14 cost time: 1.9189882278442383
Epoch: 14, Steps: 10 | Train Loss: 0.327 Vali Loss: 1.237 Vali Acc: 0.459 Test Loss: 1.237 Test Acc: 0.459
Validation loss decreased (-0.445934 --> -0.459447).  Saving model ...
Epoch: 15 cost time: 1.888221263885498
Epoch: 15, Steps: 10 | Train Loss: 0.252 Vali Loss: 1.230 Vali Acc: 0.432 Test Loss: 1.230 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.8460848331451416
Epoch: 16, Steps: 10 | Train Loss: 0.206 Vali Loss: 1.206 Vali Acc: 0.500 Test Loss: 1.206 Test Acc: 0.500
Validation loss decreased (-0.459447 --> -0.499988).  Saving model ...
Epoch: 17 cost time: 1.8195512294769287
Epoch: 17, Steps: 10 | Train Loss: 0.165 Vali Loss: 1.200 Vali Acc: 0.527 Test Loss: 1.200 Test Acc: 0.527
Validation loss decreased (-0.499988 --> -0.527015).  Saving model ...
Epoch: 18 cost time: 1.8317723274230957
Epoch: 18, Steps: 10 | Train Loss: 0.135 Vali Loss: 1.197 Vali Acc: 0.500 Test Loss: 1.197 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.840097188949585
Epoch: 19, Steps: 10 | Train Loss: 0.102 Vali Loss: 1.217 Vali Acc: 0.541 Test Loss: 1.217 Test Acc: 0.541
Validation loss decreased (-0.527015 --> -0.540528).  Saving model ...
Epoch: 20 cost time: 1.8175880908966064
Epoch: 20, Steps: 10 | Train Loss: 0.081 Vali Loss: 1.207 Vali Acc: 0.554 Test Loss: 1.207 Test Acc: 0.554
Validation loss decreased (-0.540528 --> -0.554042).  Saving model ...
Epoch: 21 cost time: 1.8213422298431396
Epoch: 21, Steps: 10 | Train Loss: 0.073 Vali Loss: 1.170 Vali Acc: 0.568 Test Loss: 1.170 Test Acc: 0.568
Validation loss decreased (-0.554042 --> -0.567556).  Saving model ...
Epoch: 22 cost time: 1.8804399967193604
Epoch: 22, Steps: 10 | Train Loss: 0.060 Vali Loss: 1.210 Vali Acc: 0.541 Test Loss: 1.210 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.9248359203338623
Epoch: 23, Steps: 10 | Train Loss: 0.056 Vali Loss: 1.256 Vali Acc: 0.581 Test Loss: 1.256 Test Acc: 0.581
Validation loss decreased (-0.567556 --> -0.581069).  Saving model ...
Epoch: 24 cost time: 1.9121670722961426
Epoch: 24, Steps: 10 | Train Loss: 0.049 Vali Loss: 1.234 Vali Acc: 0.568 Test Loss: 1.234 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.907273530960083
Epoch: 25, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.213 Vali Acc: 0.554 Test Loss: 1.213 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.866377592086792
Epoch: 26, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.244 Vali Acc: 0.541 Test Loss: 1.244 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.046887159347534
Epoch: 27, Steps: 10 | Train Loss: 0.042 Vali Loss: 1.291 Vali Acc: 0.527 Test Loss: 1.291 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.9016036987304688
Epoch: 28, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.230 Vali Acc: 0.541 Test Loss: 1.230 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.949660301208496
Epoch: 29, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.258 Vali Acc: 0.527 Test Loss: 1.258 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.9004130363464355
Epoch: 30, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.262 Vali Acc: 0.527 Test Loss: 1.262 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm8_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 599684
model size : 2.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm8_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.5269291400909424
Epoch: 1, Steps: 10 | Train Loss: 1.431 Vali Loss: 1.454 Vali Acc: 0.257 Test Loss: 1.454 Test Acc: 0.257
Validation loss decreased (inf --> -0.256742).  Saving model ...
Epoch: 2 cost time: 1.1759579181671143
Epoch: 2, Steps: 10 | Train Loss: 1.375 Vali Loss: 1.425 Vali Acc: 0.284 Test Loss: 1.425 Test Acc: 0.284
Validation loss decreased (-0.256742 --> -0.283770).  Saving model ...
Epoch: 3 cost time: 1.1429178714752197
Epoch: 3, Steps: 10 | Train Loss: 1.328 Vali Loss: 1.391 Vali Acc: 0.284 Test Loss: 1.391 Test Acc: 0.284
Validation loss decreased (-0.283770 --> -0.283770).  Saving model ...
Epoch: 4 cost time: 1.10451078414917
Epoch: 4, Steps: 10 | Train Loss: 1.276 Vali Loss: 1.366 Vali Acc: 0.324 Test Loss: 1.366 Test Acc: 0.324
Validation loss decreased (-0.283770 --> -0.324311).  Saving model ...
Epoch: 5 cost time: 1.1285250186920166
Epoch: 5, Steps: 10 | Train Loss: 1.194 Vali Loss: 1.336 Vali Acc: 0.351 Test Loss: 1.336 Test Acc: 0.351
Validation loss decreased (-0.324311 --> -0.351338).  Saving model ...
Epoch: 6 cost time: 1.1253905296325684
Epoch: 6, Steps: 10 | Train Loss: 1.099 Vali Loss: 1.316 Vali Acc: 0.392 Test Loss: 1.316 Test Acc: 0.392
Validation loss decreased (-0.351338 --> -0.391879).  Saving model ...
Epoch: 7 cost time: 1.15431547164917
Epoch: 7, Steps: 10 | Train Loss: 1.037 Vali Loss: 1.293 Vali Acc: 0.405 Test Loss: 1.293 Test Acc: 0.405
Validation loss decreased (-0.391879 --> -0.405392).  Saving model ...
Epoch: 8 cost time: 1.148005485534668
Epoch: 8, Steps: 10 | Train Loss: 0.965 Vali Loss: 1.278 Vali Acc: 0.378 Test Loss: 1.278 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1498298645019531
Epoch: 9, Steps: 10 | Train Loss: 0.851 Vali Loss: 1.271 Vali Acc: 0.432 Test Loss: 1.271 Test Acc: 0.432
Validation loss decreased (-0.405392 --> -0.432420).  Saving model ...
Epoch: 10 cost time: 1.1236662864685059
Epoch: 10, Steps: 10 | Train Loss: 0.793 Vali Loss: 1.255 Vali Acc: 0.486 Test Loss: 1.255 Test Acc: 0.486
Validation loss decreased (-0.432420 --> -0.486474).  Saving model ...
Epoch: 11 cost time: 1.0926883220672607
Epoch: 11, Steps: 10 | Train Loss: 0.717 Vali Loss: 1.246 Vali Acc: 0.473 Test Loss: 1.246 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1372358798980713
Epoch: 12, Steps: 10 | Train Loss: 0.646 Vali Loss: 1.240 Vali Acc: 0.459 Test Loss: 1.240 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1936161518096924
Epoch: 13, Steps: 10 | Train Loss: 0.587 Vali Loss: 1.251 Vali Acc: 0.459 Test Loss: 1.251 Test Acc: 0.459
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.1868877410888672
Epoch: 14, Steps: 10 | Train Loss: 0.493 Vali Loss: 1.245 Vali Acc: 0.459 Test Loss: 1.245 Test Acc: 0.459
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.1702373027801514
Epoch: 15, Steps: 10 | Train Loss: 0.437 Vali Loss: 1.249 Vali Acc: 0.486 Test Loss: 1.249 Test Acc: 0.486
Validation loss decreased (-0.486474 --> -0.486474).  Saving model ...
Epoch: 16 cost time: 1.0978751182556152
Epoch: 16, Steps: 10 | Train Loss: 0.371 Vali Loss: 1.235 Vali Acc: 0.486 Test Loss: 1.235 Test Acc: 0.486
Validation loss decreased (-0.486474 --> -0.486474).  Saving model ...
Epoch: 17 cost time: 0.6758432388305664
Epoch: 17, Steps: 10 | Train Loss: 0.310 Vali Loss: 1.234 Vali Acc: 0.486 Test Loss: 1.234 Test Acc: 0.486
Validation loss decreased (-0.486474 --> -0.486474).  Saving model ...
Epoch: 18 cost time: 1.094785451889038
Epoch: 18, Steps: 10 | Train Loss: 0.266 Vali Loss: 1.249 Vali Acc: 0.500 Test Loss: 1.249 Test Acc: 0.500
Validation loss decreased (-0.486474 --> -0.499988).  Saving model ...
Epoch: 19 cost time: 1.1519079208374023
Epoch: 19, Steps: 10 | Train Loss: 0.220 Vali Loss: 1.267 Vali Acc: 0.486 Test Loss: 1.267 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1364595890045166
Epoch: 20, Steps: 10 | Train Loss: 0.176 Vali Loss: 1.272 Vali Acc: 0.486 Test Loss: 1.272 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.1554346084594727
Epoch: 21, Steps: 10 | Train Loss: 0.171 Vali Loss: 1.261 Vali Acc: 0.486 Test Loss: 1.261 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.1662657260894775
Epoch: 22, Steps: 10 | Train Loss: 0.139 Vali Loss: 1.238 Vali Acc: 0.486 Test Loss: 1.238 Test Acc: 0.486
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.168393850326538
Epoch: 23, Steps: 10 | Train Loss: 0.135 Vali Loss: 1.241 Vali Acc: 0.514 Test Loss: 1.241 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513501).  Saving model ...
Epoch: 24 cost time: 1.100508451461792
Epoch: 24, Steps: 10 | Train Loss: 0.101 Vali Loss: 1.290 Vali Acc: 0.514 Test Loss: 1.290 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.150484561920166
Epoch: 25, Steps: 10 | Train Loss: 0.080 Vali Loss: 1.275 Vali Acc: 0.459 Test Loss: 1.275 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.1350007057189941
Epoch: 26, Steps: 10 | Train Loss: 0.086 Vali Loss: 1.267 Vali Acc: 0.500 Test Loss: 1.267 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.1467504501342773
Epoch: 27, Steps: 10 | Train Loss: 0.065 Vali Loss: 1.281 Vali Acc: 0.500 Test Loss: 1.281 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.1216790676116943
Epoch: 28, Steps: 10 | Train Loss: 0.055 Vali Loss: 1.307 Vali Acc: 0.500 Test Loss: 1.307 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.0828077793121338
Epoch: 29, Steps: 10 | Train Loss: 0.051 Vali Loss: 1.296 Vali Acc: 0.500 Test Loss: 1.296 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.1174309253692627
Epoch: 30, Steps: 10 | Train Loss: 0.066 Vali Loss: 1.278 Vali Acc: 0.527 Test Loss: 1.278 Test Acc: 0.527
Validation loss decreased (-0.513501 --> -0.527014).  Saving model ...
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm8_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.527027027027027
model parameter : 185700
model size : 0.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm8_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.839996814727783
Epoch: 1, Steps: 10 | Train Loss: 1.402 Vali Loss: 1.438 Vali Acc: 0.149 Test Loss: 1.438 Test Acc: 0.149
Validation loss decreased (inf --> -0.148634).  Saving model ...
Epoch: 2 cost time: 1.205517053604126
Epoch: 2, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.408 Vali Acc: 0.216 Test Loss: 1.408 Test Acc: 0.216
Validation loss decreased (-0.148634 --> -0.216202).  Saving model ...
Epoch: 3 cost time: 1.2273972034454346
Epoch: 3, Steps: 10 | Train Loss: 1.332 Vali Loss: 1.395 Vali Acc: 0.311 Test Loss: 1.395 Test Acc: 0.311
Validation loss decreased (-0.216202 --> -0.310797).  Saving model ...
Epoch: 4 cost time: 1.316648244857788
Epoch: 4, Steps: 10 | Train Loss: 1.276 Vali Loss: 1.367 Vali Acc: 0.365 Test Loss: 1.367 Test Acc: 0.365
Validation loss decreased (-0.310797 --> -0.364851).  Saving model ...
Epoch: 5 cost time: 1.3564674854278564
Epoch: 5, Steps: 10 | Train Loss: 1.207 Vali Loss: 1.320 Vali Acc: 0.419 Test Loss: 1.320 Test Acc: 0.419
Validation loss decreased (-0.364851 --> -0.418906).  Saving model ...
Epoch: 6 cost time: 1.3487083911895752
Epoch: 6, Steps: 10 | Train Loss: 1.134 Vali Loss: 1.311 Vali Acc: 0.446 Test Loss: 1.311 Test Acc: 0.446
Validation loss decreased (-0.418906 --> -0.445933).  Saving model ...
Epoch: 7 cost time: 1.3158767223358154
Epoch: 7, Steps: 10 | Train Loss: 1.048 Vali Loss: 1.288 Vali Acc: 0.459 Test Loss: 1.288 Test Acc: 0.459
Validation loss decreased (-0.445933 --> -0.459447).  Saving model ...
Epoch: 8 cost time: 1.293348789215088
Epoch: 8, Steps: 10 | Train Loss: 1.009 Vali Loss: 1.276 Vali Acc: 0.432 Test Loss: 1.276 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3681013584136963
Epoch: 9, Steps: 10 | Train Loss: 0.894 Vali Loss: 1.229 Vali Acc: 0.459 Test Loss: 1.229 Test Acc: 0.459
Validation loss decreased (-0.459447 --> -0.459447).  Saving model ...
Epoch: 10 cost time: 1.3842601776123047
Epoch: 10, Steps: 10 | Train Loss: 0.834 Vali Loss: 1.207 Vali Acc: 0.446 Test Loss: 1.207 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3080840110778809
Epoch: 11, Steps: 10 | Train Loss: 0.778 Vali Loss: 1.195 Vali Acc: 0.446 Test Loss: 1.195 Test Acc: 0.446
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.596118450164795
Epoch: 12, Steps: 10 | Train Loss: 0.691 Vali Loss: 1.183 Vali Acc: 0.486 Test Loss: 1.183 Test Acc: 0.486
Validation loss decreased (-0.459447 --> -0.486475).  Saving model ...
Epoch: 13 cost time: 1.4714281558990479
Epoch: 13, Steps: 10 | Train Loss: 0.629 Vali Loss: 1.170 Vali Acc: 0.459 Test Loss: 1.170 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4627504348754883
Epoch: 14, Steps: 10 | Train Loss: 0.566 Vali Loss: 1.183 Vali Acc: 0.527 Test Loss: 1.183 Test Acc: 0.527
Validation loss decreased (-0.486475 --> -0.527015).  Saving model ...
Epoch: 15 cost time: 1.5461328029632568
Epoch: 15, Steps: 10 | Train Loss: 0.510 Vali Loss: 1.146 Vali Acc: 0.514 Test Loss: 1.146 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.4759514331817627
Epoch: 16, Steps: 10 | Train Loss: 0.441 Vali Loss: 1.140 Vali Acc: 0.486 Test Loss: 1.140 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.7120897769927979
Epoch: 17, Steps: 10 | Train Loss: 0.385 Vali Loss: 1.145 Vali Acc: 0.486 Test Loss: 1.145 Test Acc: 0.486
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.5509214401245117
Epoch: 18, Steps: 10 | Train Loss: 0.328 Vali Loss: 1.133 Vali Acc: 0.500 Test Loss: 1.133 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.4798274040222168
Epoch: 19, Steps: 10 | Train Loss: 0.275 Vali Loss: 1.133 Vali Acc: 0.473 Test Loss: 1.133 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.6435105800628662
Epoch: 20, Steps: 10 | Train Loss: 0.252 Vali Loss: 1.106 Vali Acc: 0.500 Test Loss: 1.106 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.5394010543823242
Epoch: 21, Steps: 10 | Train Loss: 0.209 Vali Loss: 1.094 Vali Acc: 0.568 Test Loss: 1.094 Test Acc: 0.568
Validation loss decreased (-0.527015 --> -0.567557).  Saving model ...
Epoch: 22 cost time: 1.6540923118591309
Epoch: 22, Steps: 10 | Train Loss: 0.175 Vali Loss: 1.081 Vali Acc: 0.527 Test Loss: 1.081 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.5295805931091309
Epoch: 23, Steps: 10 | Train Loss: 0.160 Vali Loss: 1.140 Vali Acc: 0.568 Test Loss: 1.140 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.4871635437011719
Epoch: 24, Steps: 10 | Train Loss: 0.136 Vali Loss: 1.112 Vali Acc: 0.568 Test Loss: 1.112 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.5456411838531494
Epoch: 25, Steps: 10 | Train Loss: 0.113 Vali Loss: 1.080 Vali Acc: 0.568 Test Loss: 1.080 Test Acc: 0.568
Validation loss decreased (-0.567557 --> -0.567557).  Saving model ...
Epoch: 26 cost time: 1.5248262882232666
Epoch: 26, Steps: 10 | Train Loss: 0.104 Vali Loss: 1.107 Vali Acc: 0.554 Test Loss: 1.107 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.5896587371826172
Epoch: 27, Steps: 10 | Train Loss: 0.091 Vali Loss: 1.088 Vali Acc: 0.527 Test Loss: 1.088 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.4768095016479492
Epoch: 28, Steps: 10 | Train Loss: 0.072 Vali Loss: 1.106 Vali Acc: 0.514 Test Loss: 1.106 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.5380642414093018
Epoch: 29, Steps: 10 | Train Loss: 0.072 Vali Loss: 1.099 Vali Acc: 0.554 Test Loss: 1.099 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.5652666091918945
Epoch: 30, Steps: 10 | Train Loss: 0.057 Vali Loss: 1.104 Vali Acc: 0.527 Test Loss: 1.104 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm8_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 599684
model size : 2.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm8_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.3887293338775635
Epoch: 1, Steps: 10 | Train Loss: 1.428 Vali Loss: 1.454 Vali Acc: 0.243 Test Loss: 1.454 Test Acc: 0.243
Validation loss decreased (inf --> -0.243229).  Saving model ...
Epoch: 2 cost time: 1.1922707557678223
Epoch: 2, Steps: 10 | Train Loss: 1.378 Vali Loss: 1.429 Vali Acc: 0.270 Test Loss: 1.429 Test Acc: 0.270
Validation loss decreased (-0.243229 --> -0.270256).  Saving model ...
Epoch: 3 cost time: 1.0997583866119385
Epoch: 3, Steps: 10 | Train Loss: 1.341 Vali Loss: 1.398 Vali Acc: 0.270 Test Loss: 1.398 Test Acc: 0.270
Validation loss decreased (-0.270256 --> -0.270256).  Saving model ...
Epoch: 4 cost time: 1.168989658355713
Epoch: 4, Steps: 10 | Train Loss: 1.291 Vali Loss: 1.376 Vali Acc: 0.297 Test Loss: 1.376 Test Acc: 0.297
Validation loss decreased (-0.270256 --> -0.297284).  Saving model ...
Epoch: 5 cost time: 1.0934481620788574
Epoch: 5, Steps: 10 | Train Loss: 1.226 Vali Loss: 1.347 Vali Acc: 0.351 Test Loss: 1.347 Test Acc: 0.351
Validation loss decreased (-0.297284 --> -0.351338).  Saving model ...
Epoch: 6 cost time: 1.0782415866851807
Epoch: 6, Steps: 10 | Train Loss: 1.142 Vali Loss: 1.326 Vali Acc: 0.392 Test Loss: 1.326 Test Acc: 0.392
Validation loss decreased (-0.351338 --> -0.391879).  Saving model ...
Epoch: 7 cost time: 1.1251938343048096
Epoch: 7, Steps: 10 | Train Loss: 1.075 Vali Loss: 1.304 Vali Acc: 0.392 Test Loss: 1.304 Test Acc: 0.392
Validation loss decreased (-0.391879 --> -0.391879).  Saving model ...
Epoch: 8 cost time: 1.1777420043945312
Epoch: 8, Steps: 10 | Train Loss: 1.020 Vali Loss: 1.288 Vali Acc: 0.405 Test Loss: 1.288 Test Acc: 0.405
Validation loss decreased (-0.391879 --> -0.405393).  Saving model ...
Epoch: 9 cost time: 1.1291759014129639
Epoch: 9, Steps: 10 | Train Loss: 0.912 Vali Loss: 1.282 Vali Acc: 0.446 Test Loss: 1.282 Test Acc: 0.446
Validation loss decreased (-0.405393 --> -0.445933).  Saving model ...
Epoch: 10 cost time: 1.1479792594909668
Epoch: 10, Steps: 10 | Train Loss: 0.845 Vali Loss: 1.264 Vali Acc: 0.459 Test Loss: 1.264 Test Acc: 0.459
Validation loss decreased (-0.445933 --> -0.459447).  Saving model ...
Epoch: 11 cost time: 1.1124927997589111
Epoch: 11, Steps: 10 | Train Loss: 0.786 Vali Loss: 1.253 Vali Acc: 0.446 Test Loss: 1.253 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1259303092956543
Epoch: 12, Steps: 10 | Train Loss: 0.726 Vali Loss: 1.245 Vali Acc: 0.459 Test Loss: 1.245 Test Acc: 0.459
Validation loss decreased (-0.459447 --> -0.459447).  Saving model ...
Epoch: 13 cost time: 1.1609406471252441
Epoch: 13, Steps: 10 | Train Loss: 0.653 Vali Loss: 1.258 Vali Acc: 0.473 Test Loss: 1.258 Test Acc: 0.473
Validation loss decreased (-0.459447 --> -0.472960).  Saving model ...
Epoch: 14 cost time: 1.207355260848999
Epoch: 14, Steps: 10 | Train Loss: 0.579 Vali Loss: 1.259 Vali Acc: 0.459 Test Loss: 1.259 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1302392482757568
Epoch: 15, Steps: 10 | Train Loss: 0.519 Vali Loss: 1.256 Vali Acc: 0.473 Test Loss: 1.256 Test Acc: 0.473
Validation loss decreased (-0.472960 --> -0.472960).  Saving model ...
Epoch: 16 cost time: 1.1244118213653564
Epoch: 16, Steps: 10 | Train Loss: 0.466 Vali Loss: 1.254 Vali Acc: 0.459 Test Loss: 1.254 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.068009853363037
Epoch: 17, Steps: 10 | Train Loss: 0.397 Vali Loss: 1.246 Vali Acc: 0.459 Test Loss: 1.246 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.1769046783447266
Epoch: 18, Steps: 10 | Train Loss: 0.347 Vali Loss: 1.259 Vali Acc: 0.500 Test Loss: 1.259 Test Acc: 0.500
Validation loss decreased (-0.472960 --> -0.499987).  Saving model ...
Epoch: 19 cost time: 1.0976591110229492
Epoch: 19, Steps: 10 | Train Loss: 0.307 Vali Loss: 1.259 Vali Acc: 0.473 Test Loss: 1.259 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1983439922332764
Epoch: 20, Steps: 10 | Train Loss: 0.248 Vali Loss: 1.274 Vali Acc: 0.459 Test Loss: 1.274 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.1310884952545166
Epoch: 21, Steps: 10 | Train Loss: 0.217 Vali Loss: 1.258 Vali Acc: 0.500 Test Loss: 1.258 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499987).  Saving model ...
Epoch: 22 cost time: 1.1066546440124512
Epoch: 22, Steps: 10 | Train Loss: 0.194 Vali Loss: 1.242 Vali Acc: 0.514 Test Loss: 1.242 Test Acc: 0.514
Validation loss decreased (-0.499987 --> -0.513501).  Saving model ...
Epoch: 23 cost time: 1.052194356918335
Epoch: 23, Steps: 10 | Train Loss: 0.161 Vali Loss: 1.288 Vali Acc: 0.541 Test Loss: 1.288 Test Acc: 0.541
Validation loss decreased (-0.513501 --> -0.540528).  Saving model ...
Epoch: 24 cost time: 1.1080632209777832
Epoch: 24, Steps: 10 | Train Loss: 0.139 Vali Loss: 1.274 Vali Acc: 0.514 Test Loss: 1.274 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.1172618865966797
Epoch: 25, Steps: 10 | Train Loss: 0.114 Vali Loss: 1.278 Vali Acc: 0.514 Test Loss: 1.278 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.2179450988769531
Epoch: 26, Steps: 10 | Train Loss: 0.111 Vali Loss: 1.305 Vali Acc: 0.500 Test Loss: 1.305 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.0940136909484863
Epoch: 27, Steps: 10 | Train Loss: 0.089 Vali Loss: 1.311 Vali Acc: 0.527 Test Loss: 1.311 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.1016945838928223
Epoch: 28, Steps: 10 | Train Loss: 0.082 Vali Loss: 1.341 Vali Acc: 0.514 Test Loss: 1.341 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.0216012001037598
Epoch: 29, Steps: 10 | Train Loss: 0.075 Vali Loss: 1.333 Vali Acc: 0.527 Test Loss: 1.333 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.189547061920166
Epoch: 30, Steps: 10 | Train Loss: 0.063 Vali Loss: 1.352 Vali Acc: 0.514 Test Loss: 1.352 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm8_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5405405405405406
model parameter : 185700
model size : 0.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm8_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.425401210784912
Epoch: 1, Steps: 10 | Train Loss: 1.453 Vali Loss: 1.451 Vali Acc: 0.203 Test Loss: 1.451 Test Acc: 0.203
Validation loss decreased (inf --> -0.202688).  Saving model ...
Epoch: 2 cost time: 2.059799909591675
Epoch: 2, Steps: 10 | Train Loss: 1.379 Vali Loss: 1.409 Vali Acc: 0.243 Test Loss: 1.409 Test Acc: 0.243
Validation loss decreased (-0.202688 --> -0.243229).  Saving model ...
Epoch: 3 cost time: 1.95802903175354
Epoch: 3, Steps: 10 | Train Loss: 1.346 Vali Loss: 1.376 Vali Acc: 0.270 Test Loss: 1.376 Test Acc: 0.270
Validation loss decreased (-0.243229 --> -0.270257).  Saving model ...
Epoch: 4 cost time: 1.9004387855529785
Epoch: 4, Steps: 10 | Train Loss: 1.282 Vali Loss: 1.347 Vali Acc: 0.351 Test Loss: 1.347 Test Acc: 0.351
Validation loss decreased (-0.270257 --> -0.351338).  Saving model ...
Epoch: 5 cost time: 1.986581563949585
Epoch: 5, Steps: 10 | Train Loss: 1.214 Vali Loss: 1.321 Vali Acc: 0.432 Test Loss: 1.321 Test Acc: 0.432
Validation loss decreased (-0.351338 --> -0.432419).  Saving model ...
Epoch: 6 cost time: 2.003106117248535
Epoch: 6, Steps: 10 | Train Loss: 1.129 Vali Loss: 1.286 Vali Acc: 0.459 Test Loss: 1.286 Test Acc: 0.459
Validation loss decreased (-0.432419 --> -0.459447).  Saving model ...
Epoch: 7 cost time: 2.0086634159088135
Epoch: 7, Steps: 10 | Train Loss: 1.025 Vali Loss: 1.267 Vali Acc: 0.473 Test Loss: 1.267 Test Acc: 0.473
Validation loss decreased (-0.459447 --> -0.472960).  Saving model ...
Epoch: 8 cost time: 1.9541587829589844
Epoch: 8, Steps: 10 | Train Loss: 0.935 Vali Loss: 1.236 Vali Acc: 0.473 Test Loss: 1.236 Test Acc: 0.473
Validation loss decreased (-0.472960 --> -0.472961).  Saving model ...
Epoch: 9 cost time: 2.0175511837005615
Epoch: 9, Steps: 10 | Train Loss: 0.864 Vali Loss: 1.210 Vali Acc: 0.459 Test Loss: 1.210 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.9738054275512695
Epoch: 10, Steps: 10 | Train Loss: 0.769 Vali Loss: 1.196 Vali Acc: 0.514 Test Loss: 1.196 Test Acc: 0.514
Validation loss decreased (-0.472961 --> -0.513502).  Saving model ...
Epoch: 11 cost time: 2.0063979625701904
Epoch: 11, Steps: 10 | Train Loss: 0.693 Vali Loss: 1.191 Vali Acc: 0.514 Test Loss: 1.191 Test Acc: 0.514
Validation loss decreased (-0.513502 --> -0.513502).  Saving model ...
Epoch: 12 cost time: 2.000973701477051
Epoch: 12, Steps: 10 | Train Loss: 0.592 Vali Loss: 1.153 Vali Acc: 0.514 Test Loss: 1.153 Test Acc: 0.514
Validation loss decreased (-0.513502 --> -0.513502).  Saving model ...
Epoch: 13 cost time: 2.0207395553588867
Epoch: 13, Steps: 10 | Train Loss: 0.511 Vali Loss: 1.128 Vali Acc: 0.514 Test Loss: 1.128 Test Acc: 0.514
Validation loss decreased (-0.513502 --> -0.513502).  Saving model ...
Epoch: 14 cost time: 1.9614331722259521
Epoch: 14, Steps: 10 | Train Loss: 0.444 Vali Loss: 1.105 Vali Acc: 0.541 Test Loss: 1.105 Test Acc: 0.541
Validation loss decreased (-0.513502 --> -0.540529).  Saving model ...
Epoch: 15 cost time: 2.1879594326019287
Epoch: 15, Steps: 10 | Train Loss: 0.357 Vali Loss: 1.107 Vali Acc: 0.500 Test Loss: 1.107 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.0392115116119385
Epoch: 16, Steps: 10 | Train Loss: 0.305 Vali Loss: 1.086 Vali Acc: 0.500 Test Loss: 1.086 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.9050040245056152
Epoch: 17, Steps: 10 | Train Loss: 0.248 Vali Loss: 1.114 Vali Acc: 0.500 Test Loss: 1.114 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.982506513595581
Epoch: 18, Steps: 10 | Train Loss: 0.199 Vali Loss: 1.059 Vali Acc: 0.527 Test Loss: 1.059 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.0525851249694824
Epoch: 19, Steps: 10 | Train Loss: 0.162 Vali Loss: 1.073 Vali Acc: 0.527 Test Loss: 1.073 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.1253585815429688
Epoch: 20, Steps: 10 | Train Loss: 0.144 Vali Loss: 1.080 Vali Acc: 0.554 Test Loss: 1.080 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554043).  Saving model ...
Epoch: 21 cost time: 2.0564918518066406
Epoch: 21, Steps: 10 | Train Loss: 0.118 Vali Loss: 1.067 Vali Acc: 0.554 Test Loss: 1.067 Test Acc: 0.554
Validation loss decreased (-0.554043 --> -0.554043).  Saving model ...
Epoch: 22 cost time: 2.171980381011963
Epoch: 22, Steps: 10 | Train Loss: 0.098 Vali Loss: 1.119 Vali Acc: 0.527 Test Loss: 1.119 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.0631725788116455
Epoch: 23, Steps: 10 | Train Loss: 0.089 Vali Loss: 1.103 Vali Acc: 0.554 Test Loss: 1.103 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.0699877738952637
Epoch: 24, Steps: 10 | Train Loss: 0.083 Vali Loss: 1.098 Vali Acc: 0.568 Test Loss: 1.098 Test Acc: 0.568
Validation loss decreased (-0.554043 --> -0.567557).  Saving model ...
Epoch: 25 cost time: 2.032818555831909
Epoch: 25, Steps: 10 | Train Loss: 0.064 Vali Loss: 1.107 Vali Acc: 0.554 Test Loss: 1.107 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.0202219486236572
Epoch: 26, Steps: 10 | Train Loss: 0.067 Vali Loss: 1.074 Vali Acc: 0.622 Test Loss: 1.074 Test Acc: 0.622
Validation loss decreased (-0.567557 --> -0.621611).  Saving model ...
Epoch: 27 cost time: 1.8668131828308105
Epoch: 27, Steps: 10 | Train Loss: 0.061 Vali Loss: 1.107 Vali Acc: 0.568 Test Loss: 1.107 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.9268958568572998
Epoch: 28, Steps: 10 | Train Loss: 0.044 Vali Loss: 1.102 Vali Acc: 0.581 Test Loss: 1.102 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.9623475074768066
Epoch: 29, Steps: 10 | Train Loss: 0.044 Vali Loss: 1.113 Vali Acc: 0.608 Test Loss: 1.113 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.902250051498413
Epoch: 30, Steps: 10 | Train Loss: 0.036 Vali Loss: 1.111 Vali Acc: 0.581 Test Loss: 1.111 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm8_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 306436
model size : 1.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm8_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.844985008239746
Epoch: 1, Steps: 10 | Train Loss: 1.477 Vali Loss: 1.393 Vali Acc: 0.297 Test Loss: 1.393 Test Acc: 0.297
Validation loss decreased (inf --> -0.297283).  Saving model ...
Epoch: 2 cost time: 1.26883864402771
Epoch: 2, Steps: 10 | Train Loss: 1.423 Vali Loss: 1.379 Vali Acc: 0.284 Test Loss: 1.379 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3811469078063965
Epoch: 3, Steps: 10 | Train Loss: 1.396 Vali Loss: 1.359 Vali Acc: 0.351 Test Loss: 1.359 Test Acc: 0.351
Validation loss decreased (-0.297283 --> -0.351338).  Saving model ...
Epoch: 4 cost time: 1.2391154766082764
Epoch: 4, Steps: 10 | Train Loss: 1.305 Vali Loss: 1.350 Vali Acc: 0.338 Test Loss: 1.350 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2788431644439697
Epoch: 5, Steps: 10 | Train Loss: 1.243 Vali Loss: 1.308 Vali Acc: 0.405 Test Loss: 1.308 Test Acc: 0.405
Validation loss decreased (-0.351338 --> -0.405392).  Saving model ...
Epoch: 6 cost time: 1.2485682964324951
Epoch: 6, Steps: 10 | Train Loss: 1.186 Vali Loss: 1.278 Vali Acc: 0.405 Test Loss: 1.278 Test Acc: 0.405
Validation loss decreased (-0.405392 --> -0.405393).  Saving model ...
Epoch: 7 cost time: 1.2432334423065186
Epoch: 7, Steps: 10 | Train Loss: 1.083 Vali Loss: 1.247 Vali Acc: 0.432 Test Loss: 1.247 Test Acc: 0.432
Validation loss decreased (-0.405393 --> -0.432420).  Saving model ...
Epoch: 8 cost time: 1.213343858718872
Epoch: 8, Steps: 10 | Train Loss: 0.982 Vali Loss: 1.238 Vali Acc: 0.432 Test Loss: 1.238 Test Acc: 0.432
Validation loss decreased (-0.432420 --> -0.432420).  Saving model ...
Epoch: 9 cost time: 1.2341415882110596
Epoch: 9, Steps: 10 | Train Loss: 0.912 Vali Loss: 1.197 Vali Acc: 0.432 Test Loss: 1.197 Test Acc: 0.432
Validation loss decreased (-0.432420 --> -0.432420).  Saving model ...
Epoch: 10 cost time: 1.2587034702301025
Epoch: 10, Steps: 10 | Train Loss: 0.832 Vali Loss: 1.193 Vali Acc: 0.473 Test Loss: 1.193 Test Acc: 0.473
Validation loss decreased (-0.432420 --> -0.472961).  Saving model ...
Epoch: 11 cost time: 1.1580286026000977
Epoch: 11, Steps: 10 | Train Loss: 0.752 Vali Loss: 1.169 Vali Acc: 0.514 Test Loss: 1.169 Test Acc: 0.514
Validation loss decreased (-0.472961 --> -0.513502).  Saving model ...
Epoch: 12 cost time: 1.271897792816162
Epoch: 12, Steps: 10 | Train Loss: 0.655 Vali Loss: 1.141 Vali Acc: 0.514 Test Loss: 1.141 Test Acc: 0.514
Validation loss decreased (-0.513502 --> -0.513502).  Saving model ...
Epoch: 13 cost time: 1.3484818935394287
Epoch: 13, Steps: 10 | Train Loss: 0.568 Vali Loss: 1.102 Vali Acc: 0.486 Test Loss: 1.102 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1994822025299072
Epoch: 14, Steps: 10 | Train Loss: 0.495 Vali Loss: 1.111 Vali Acc: 0.527 Test Loss: 1.111 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527016).  Saving model ...
Epoch: 15 cost time: 1.2460894584655762
Epoch: 15, Steps: 10 | Train Loss: 0.452 Vali Loss: 1.118 Vali Acc: 0.527 Test Loss: 1.118 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2307617664337158
Epoch: 16, Steps: 10 | Train Loss: 0.362 Vali Loss: 1.073 Vali Acc: 0.554 Test Loss: 1.073 Test Acc: 0.554
Validation loss decreased (-0.527016 --> -0.554043).  Saving model ...
Epoch: 17 cost time: 1.2488512992858887
Epoch: 17, Steps: 10 | Train Loss: 0.312 Vali Loss: 1.061 Vali Acc: 0.541 Test Loss: 1.061 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.217991590499878
Epoch: 18, Steps: 10 | Train Loss: 0.257 Vali Loss: 1.083 Vali Acc: 0.568 Test Loss: 1.083 Test Acc: 0.568
Validation loss decreased (-0.554043 --> -0.567557).  Saving model ...
Epoch: 19 cost time: 1.2220282554626465
Epoch: 19, Steps: 10 | Train Loss: 0.211 Vali Loss: 1.063 Vali Acc: 0.554 Test Loss: 1.063 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.2586140632629395
Epoch: 20, Steps: 10 | Train Loss: 0.178 Vali Loss: 1.070 Vali Acc: 0.568 Test Loss: 1.070 Test Acc: 0.568
Validation loss decreased (-0.567557 --> -0.567557).  Saving model ...
Epoch: 21 cost time: 1.2651565074920654
Epoch: 21, Steps: 10 | Train Loss: 0.147 Vali Loss: 1.097 Vali Acc: 0.554 Test Loss: 1.097 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.296459436416626
Epoch: 22, Steps: 10 | Train Loss: 0.116 Vali Loss: 1.095 Vali Acc: 0.541 Test Loss: 1.095 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.2346735000610352
Epoch: 23, Steps: 10 | Train Loss: 0.112 Vali Loss: 1.059 Vali Acc: 0.568 Test Loss: 1.059 Test Acc: 0.568
Validation loss decreased (-0.567557 --> -0.567557).  Saving model ...
Epoch: 24 cost time: 1.3363332748413086
Epoch: 24, Steps: 10 | Train Loss: 0.103 Vali Loss: 1.043 Vali Acc: 0.568 Test Loss: 1.043 Test Acc: 0.568
Validation loss decreased (-0.567557 --> -0.567557).  Saving model ...
Epoch: 25 cost time: 1.3219194412231445
Epoch: 25, Steps: 10 | Train Loss: 0.085 Vali Loss: 1.086 Vali Acc: 0.581 Test Loss: 1.086 Test Acc: 0.581
Validation loss decreased (-0.567557 --> -0.581070).  Saving model ...
Epoch: 26 cost time: 1.2159538269042969
Epoch: 26, Steps: 10 | Train Loss: 0.074 Vali Loss: 1.103 Vali Acc: 0.554 Test Loss: 1.103 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.2401244640350342
Epoch: 27, Steps: 10 | Train Loss: 0.061 Vali Loss: 1.086 Vali Acc: 0.568 Test Loss: 1.086 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.2641115188598633
Epoch: 28, Steps: 10 | Train Loss: 0.051 Vali Loss: 1.078 Vali Acc: 0.608 Test Loss: 1.078 Test Acc: 0.608
Validation loss decreased (-0.581070 --> -0.608097).  Saving model ...
Epoch: 29 cost time: 1.3551585674285889
Epoch: 29, Steps: 10 | Train Loss: 0.047 Vali Loss: 1.102 Vali Acc: 0.608 Test Loss: 1.102 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.334263801574707
Epoch: 30, Steps: 10 | Train Loss: 0.044 Vali Loss: 1.145 Vali Acc: 0.635 Test Loss: 1.145 Test Acc: 0.635
Validation loss decreased (-0.608097 --> -0.635124).  Saving model ...
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm8_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6351351351351351
model parameter : 99428
model size : 0.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm8_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.0597708225250244
Epoch: 1, Steps: 10 | Train Loss: 1.451 Vali Loss: 1.451 Vali Acc: 0.203 Test Loss: 1.451 Test Acc: 0.203
Validation loss decreased (inf --> -0.202688).  Saving model ...
Epoch: 2 cost time: 1.6501870155334473
Epoch: 2, Steps: 10 | Train Loss: 1.381 Vali Loss: 1.409 Vali Acc: 0.257 Test Loss: 1.409 Test Acc: 0.257
Validation loss decreased (-0.202688 --> -0.256743).  Saving model ...
Epoch: 3 cost time: 1.6165180206298828
Epoch: 3, Steps: 10 | Train Loss: 1.342 Vali Loss: 1.377 Vali Acc: 0.297 Test Loss: 1.377 Test Acc: 0.297
Validation loss decreased (-0.256743 --> -0.297284).  Saving model ...
Epoch: 4 cost time: 1.6124012470245361
Epoch: 4, Steps: 10 | Train Loss: 1.281 Vali Loss: 1.348 Vali Acc: 0.365 Test Loss: 1.348 Test Acc: 0.365
Validation loss decreased (-0.297284 --> -0.364851).  Saving model ...
Epoch: 5 cost time: 1.654613733291626
Epoch: 5, Steps: 10 | Train Loss: 1.212 Vali Loss: 1.323 Vali Acc: 0.419 Test Loss: 1.323 Test Acc: 0.419
Validation loss decreased (-0.364851 --> -0.418906).  Saving model ...
Epoch: 6 cost time: 1.562215805053711
Epoch: 6, Steps: 10 | Train Loss: 1.126 Vali Loss: 1.291 Vali Acc: 0.473 Test Loss: 1.291 Test Acc: 0.473
Validation loss decreased (-0.418906 --> -0.472960).  Saving model ...
Epoch: 7 cost time: 1.594158411026001
Epoch: 7, Steps: 10 | Train Loss: 1.021 Vali Loss: 1.275 Vali Acc: 0.486 Test Loss: 1.275 Test Acc: 0.486
Validation loss decreased (-0.472960 --> -0.486474).  Saving model ...
Epoch: 8 cost time: 1.5575308799743652
Epoch: 8, Steps: 10 | Train Loss: 0.934 Vali Loss: 1.249 Vali Acc: 0.486 Test Loss: 1.249 Test Acc: 0.486
Validation loss decreased (-0.486474 --> -0.486474).  Saving model ...
Epoch: 9 cost time: 1.6348705291748047
Epoch: 9, Steps: 10 | Train Loss: 0.861 Vali Loss: 1.226 Vali Acc: 0.473 Test Loss: 1.226 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6596357822418213
Epoch: 10, Steps: 10 | Train Loss: 0.769 Vali Loss: 1.219 Vali Acc: 0.473 Test Loss: 1.219 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.637115478515625
Epoch: 11, Steps: 10 | Train Loss: 0.681 Vali Loss: 1.220 Vali Acc: 0.473 Test Loss: 1.220 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.648146390914917
Epoch: 12, Steps: 10 | Train Loss: 0.582 Vali Loss: 1.180 Vali Acc: 0.459 Test Loss: 1.180 Test Acc: 0.459
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.623159646987915
Epoch: 13, Steps: 10 | Train Loss: 0.503 Vali Loss: 1.166 Vali Acc: 0.486 Test Loss: 1.166 Test Acc: 0.486
Validation loss decreased (-0.486474 --> -0.486475).  Saving model ...
Epoch: 14 cost time: 1.6900708675384521
Epoch: 14, Steps: 10 | Train Loss: 0.426 Vali Loss: 1.159 Vali Acc: 0.432 Test Loss: 1.159 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.6122922897338867
Epoch: 15, Steps: 10 | Train Loss: 0.338 Vali Loss: 1.133 Vali Acc: 0.514 Test Loss: 1.133 Test Acc: 0.514
Validation loss decreased (-0.486475 --> -0.513502).  Saving model ...
Epoch: 16 cost time: 1.680776596069336
Epoch: 16, Steps: 10 | Train Loss: 0.281 Vali Loss: 1.129 Vali Acc: 0.500 Test Loss: 1.129 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.6600983142852783
Epoch: 17, Steps: 10 | Train Loss: 0.228 Vali Loss: 1.157 Vali Acc: 0.473 Test Loss: 1.157 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.692687749862671
Epoch: 18, Steps: 10 | Train Loss: 0.187 Vali Loss: 1.115 Vali Acc: 0.541 Test Loss: 1.115 Test Acc: 0.541
Validation loss decreased (-0.513502 --> -0.540529).  Saving model ...
Epoch: 19 cost time: 1.729482650756836
Epoch: 19, Steps: 10 | Train Loss: 0.151 Vali Loss: 1.143 Vali Acc: 0.527 Test Loss: 1.143 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.707956075668335
Epoch: 20, Steps: 10 | Train Loss: 0.128 Vali Loss: 1.146 Vali Acc: 0.554 Test Loss: 1.146 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554043).  Saving model ...
Epoch: 21 cost time: 1.6152536869049072
Epoch: 21, Steps: 10 | Train Loss: 0.110 Vali Loss: 1.143 Vali Acc: 0.541 Test Loss: 1.143 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.668924331665039
Epoch: 22, Steps: 10 | Train Loss: 0.093 Vali Loss: 1.181 Vali Acc: 0.500 Test Loss: 1.181 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.6527645587921143
Epoch: 23, Steps: 10 | Train Loss: 0.075 Vali Loss: 1.180 Vali Acc: 0.554 Test Loss: 1.180 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.6052289009094238
Epoch: 24, Steps: 10 | Train Loss: 0.076 Vali Loss: 1.178 Vali Acc: 0.554 Test Loss: 1.178 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.716521978378296
Epoch: 25, Steps: 10 | Train Loss: 0.057 Vali Loss: 1.190 Vali Acc: 0.541 Test Loss: 1.190 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.5135822296142578
Epoch: 26, Steps: 10 | Train Loss: 0.056 Vali Loss: 1.251 Vali Acc: 0.527 Test Loss: 1.251 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.5009160041809082
Epoch: 27, Steps: 10 | Train Loss: 0.046 Vali Loss: 1.233 Vali Acc: 0.541 Test Loss: 1.233 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.468729019165039
Epoch: 28, Steps: 10 | Train Loss: 0.037 Vali Loss: 1.215 Vali Acc: 0.568 Test Loss: 1.215 Test Acc: 0.568
Validation loss decreased (-0.554043 --> -0.567555).  Saving model ...
Epoch: 29 cost time: 1.4857070446014404
Epoch: 29, Steps: 10 | Train Loss: 0.036 Vali Loss: 1.235 Vali Acc: 0.541 Test Loss: 1.235 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.7244641780853271
Epoch: 30, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.236 Vali Acc: 0.527 Test Loss: 1.236 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm8_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 306436
model size : 1.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm8_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.5671305656433105
Epoch: 1, Steps: 10 | Train Loss: 1.480 Vali Loss: 1.394 Vali Acc: 0.284 Test Loss: 1.394 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 1.1385881900787354
Epoch: 2, Steps: 10 | Train Loss: 1.424 Vali Loss: 1.380 Vali Acc: 0.270 Test Loss: 1.380 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1281790733337402
Epoch: 3, Steps: 10 | Train Loss: 1.397 Vali Loss: 1.361 Vali Acc: 0.324 Test Loss: 1.361 Test Acc: 0.324
Validation loss decreased (-0.283770 --> -0.324311).  Saving model ...
Epoch: 4 cost time: 1.141303300857544
Epoch: 4, Steps: 10 | Train Loss: 1.304 Vali Loss: 1.352 Vali Acc: 0.311 Test Loss: 1.352 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1744861602783203
Epoch: 5, Steps: 10 | Train Loss: 1.245 Vali Loss: 1.310 Vali Acc: 0.392 Test Loss: 1.310 Test Acc: 0.392
Validation loss decreased (-0.324311 --> -0.391879).  Saving model ...
Epoch: 6 cost time: 1.0669238567352295
Epoch: 6, Steps: 10 | Train Loss: 1.188 Vali Loss: 1.280 Vali Acc: 0.446 Test Loss: 1.280 Test Acc: 0.446
Validation loss decreased (-0.391879 --> -0.445933).  Saving model ...
Epoch: 7 cost time: 1.1082673072814941
Epoch: 7, Steps: 10 | Train Loss: 1.084 Vali Loss: 1.250 Vali Acc: 0.419 Test Loss: 1.250 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0751597881317139
Epoch: 8, Steps: 10 | Train Loss: 0.983 Vali Loss: 1.244 Vali Acc: 0.419 Test Loss: 1.244 Test Acc: 0.419
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1103098392486572
Epoch: 9, Steps: 10 | Train Loss: 0.910 Vali Loss: 1.204 Vali Acc: 0.432 Test Loss: 1.204 Test Acc: 0.432
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.141420602798462
Epoch: 10, Steps: 10 | Train Loss: 0.826 Vali Loss: 1.203 Vali Acc: 0.459 Test Loss: 1.203 Test Acc: 0.459
Validation loss decreased (-0.445933 --> -0.459447).  Saving model ...
Epoch: 11 cost time: 1.104686975479126
Epoch: 11, Steps: 10 | Train Loss: 0.750 Vali Loss: 1.178 Vali Acc: 0.486 Test Loss: 1.178 Test Acc: 0.486
Validation loss decreased (-0.459447 --> -0.486475).  Saving model ...
Epoch: 12 cost time: 1.1071765422821045
Epoch: 12, Steps: 10 | Train Loss: 0.650 Vali Loss: 1.155 Vali Acc: 0.486 Test Loss: 1.155 Test Acc: 0.486
Validation loss decreased (-0.486475 --> -0.486475).  Saving model ...
Epoch: 13 cost time: 1.2457525730133057
Epoch: 13, Steps: 10 | Train Loss: 0.563 Vali Loss: 1.113 Vali Acc: 0.486 Test Loss: 1.113 Test Acc: 0.486
Validation loss decreased (-0.486475 --> -0.486475).  Saving model ...
Epoch: 14 cost time: 1.149244785308838
Epoch: 14, Steps: 10 | Train Loss: 0.486 Vali Loss: 1.126 Vali Acc: 0.486 Test Loss: 1.126 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1577723026275635
Epoch: 15, Steps: 10 | Train Loss: 0.439 Vali Loss: 1.135 Vali Acc: 0.527 Test Loss: 1.135 Test Acc: 0.527
Validation loss decreased (-0.486475 --> -0.527016).  Saving model ...
Epoch: 16 cost time: 1.2340195178985596
Epoch: 16, Steps: 10 | Train Loss: 0.349 Vali Loss: 1.089 Vali Acc: 0.554 Test Loss: 1.089 Test Acc: 0.554
Validation loss decreased (-0.527016 --> -0.554043).  Saving model ...
Epoch: 17 cost time: 1.1852333545684814
Epoch: 17, Steps: 10 | Train Loss: 0.300 Vali Loss: 1.081 Vali Acc: 0.568 Test Loss: 1.081 Test Acc: 0.568
Validation loss decreased (-0.554043 --> -0.567557).  Saving model ...
Epoch: 18 cost time: 1.1507720947265625
Epoch: 18, Steps: 10 | Train Loss: 0.250 Vali Loss: 1.110 Vali Acc: 0.568 Test Loss: 1.110 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.194244384765625
Epoch: 19, Steps: 10 | Train Loss: 0.202 Vali Loss: 1.082 Vali Acc: 0.581 Test Loss: 1.082 Test Acc: 0.581
Validation loss decreased (-0.567557 --> -0.581070).  Saving model ...
Epoch: 20 cost time: 1.181178331375122
Epoch: 20, Steps: 10 | Train Loss: 0.170 Vali Loss: 1.089 Vali Acc: 0.595 Test Loss: 1.089 Test Acc: 0.595
Validation loss decreased (-0.581070 --> -0.594584).  Saving model ...
Epoch: 21 cost time: 1.1361372470855713
Epoch: 21, Steps: 10 | Train Loss: 0.139 Vali Loss: 1.119 Vali Acc: 0.595 Test Loss: 1.119 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2938857078552246
Epoch: 22, Steps: 10 | Train Loss: 0.113 Vali Loss: 1.112 Vali Acc: 0.595 Test Loss: 1.112 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.1824417114257812
Epoch: 23, Steps: 10 | Train Loss: 0.101 Vali Loss: 1.089 Vali Acc: 0.608 Test Loss: 1.089 Test Acc: 0.608
Validation loss decreased (-0.594584 --> -0.608097).  Saving model ...
Epoch: 24 cost time: 1.1183710098266602
Epoch: 24, Steps: 10 | Train Loss: 0.093 Vali Loss: 1.090 Vali Acc: 0.622 Test Loss: 1.090 Test Acc: 0.622
Validation loss decreased (-0.608097 --> -0.621611).  Saving model ...
Epoch: 25 cost time: 1.2499160766601562
Epoch: 25, Steps: 10 | Train Loss: 0.078 Vali Loss: 1.138 Vali Acc: 0.622 Test Loss: 1.138 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.0889248847961426
Epoch: 26, Steps: 10 | Train Loss: 0.068 Vali Loss: 1.144 Vali Acc: 0.635 Test Loss: 1.144 Test Acc: 0.635
Validation loss decreased (-0.621611 --> -0.635124).  Saving model ...
Epoch: 27 cost time: 1.1654863357543945
Epoch: 27, Steps: 10 | Train Loss: 0.056 Vali Loss: 1.132 Vali Acc: 0.622 Test Loss: 1.132 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.1836981773376465
Epoch: 28, Steps: 10 | Train Loss: 0.051 Vali Loss: 1.133 Vali Acc: 0.581 Test Loss: 1.133 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.1981449127197266
Epoch: 29, Steps: 10 | Train Loss: 0.047 Vali Loss: 1.150 Vali Acc: 0.608 Test Loss: 1.150 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.1608781814575195
Epoch: 30, Steps: 10 | Train Loss: 0.043 Vali Loss: 1.203 Vali Acc: 0.635 Test Loss: 1.203 Test Acc: 0.635
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm8_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6351351351351351
model parameter : 99428
model size : 0.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm8_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.702368974685669
Epoch: 1, Steps: 10 | Train Loss: 1.456 Vali Loss: 1.447 Vali Acc: 0.230 Test Loss: 1.447 Test Acc: 0.230
Validation loss decreased (inf --> -0.229715).  Saving model ...
Epoch: 2 cost time: 1.2785468101501465
Epoch: 2, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.403 Vali Acc: 0.230 Test Loss: 1.403 Test Acc: 0.230
Validation loss decreased (-0.229715 --> -0.229716).  Saving model ...
Epoch: 3 cost time: 1.2691407203674316
Epoch: 3, Steps: 10 | Train Loss: 1.358 Vali Loss: 1.369 Vali Acc: 0.257 Test Loss: 1.369 Test Acc: 0.257
Validation loss decreased (-0.229716 --> -0.256743).  Saving model ...
Epoch: 4 cost time: 1.258599042892456
Epoch: 4, Steps: 10 | Train Loss: 1.295 Vali Loss: 1.341 Vali Acc: 0.297 Test Loss: 1.341 Test Acc: 0.297
Validation loss decreased (-0.256743 --> -0.297284).  Saving model ...
Epoch: 5 cost time: 1.2371971607208252
Epoch: 5, Steps: 10 | Train Loss: 1.250 Vali Loss: 1.322 Vali Acc: 0.351 Test Loss: 1.322 Test Acc: 0.351
Validation loss decreased (-0.297284 --> -0.351338).  Saving model ...
Epoch: 6 cost time: 1.2241051197052002
Epoch: 6, Steps: 10 | Train Loss: 1.163 Vali Loss: 1.291 Vali Acc: 0.446 Test Loss: 1.291 Test Acc: 0.446
Validation loss decreased (-0.351338 --> -0.445933).  Saving model ...
Epoch: 7 cost time: 1.2812001705169678
Epoch: 7, Steps: 10 | Train Loss: 1.075 Vali Loss: 1.271 Vali Acc: 0.473 Test Loss: 1.271 Test Acc: 0.473
Validation loss decreased (-0.445933 --> -0.472960).  Saving model ...
Epoch: 8 cost time: 1.1786291599273682
Epoch: 8, Steps: 10 | Train Loss: 1.008 Vali Loss: 1.237 Vali Acc: 0.500 Test Loss: 1.237 Test Acc: 0.500
Validation loss decreased (-0.472960 --> -0.499988).  Saving model ...
Epoch: 9 cost time: 1.2153985500335693
Epoch: 9, Steps: 10 | Train Loss: 0.952 Vali Loss: 1.210 Vali Acc: 0.554 Test Loss: 1.210 Test Acc: 0.554
Validation loss decreased (-0.499988 --> -0.554042).  Saving model ...
Epoch: 10 cost time: 1.3314208984375
Epoch: 10, Steps: 10 | Train Loss: 0.868 Vali Loss: 1.187 Vali Acc: 0.554 Test Loss: 1.187 Test Acc: 0.554
Validation loss decreased (-0.554042 --> -0.554042).  Saving model ...
Epoch: 11 cost time: 1.2314379215240479
Epoch: 11, Steps: 10 | Train Loss: 0.791 Vali Loss: 1.166 Vali Acc: 0.554 Test Loss: 1.166 Test Acc: 0.554
Validation loss decreased (-0.554042 --> -0.554042).  Saving model ...
Epoch: 12 cost time: 1.2278783321380615
Epoch: 12, Steps: 10 | Train Loss: 0.717 Vali Loss: 1.118 Vali Acc: 0.595 Test Loss: 1.118 Test Acc: 0.595
Validation loss decreased (-0.554042 --> -0.594583).  Saving model ...
Epoch: 13 cost time: 1.2843017578125
Epoch: 13, Steps: 10 | Train Loss: 0.639 Vali Loss: 1.108 Vali Acc: 0.581 Test Loss: 1.108 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.261545181274414
Epoch: 14, Steps: 10 | Train Loss: 0.592 Vali Loss: 1.087 Vali Acc: 0.595 Test Loss: 1.087 Test Acc: 0.595
Validation loss decreased (-0.594583 --> -0.594584).  Saving model ...
Epoch: 15 cost time: 1.2508642673492432
Epoch: 15, Steps: 10 | Train Loss: 0.481 Vali Loss: 1.080 Vali Acc: 0.568 Test Loss: 1.080 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2890493869781494
Epoch: 16, Steps: 10 | Train Loss: 0.436 Vali Loss: 1.051 Vali Acc: 0.554 Test Loss: 1.051 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.2114484310150146
Epoch: 17, Steps: 10 | Train Loss: 0.354 Vali Loss: 1.003 Vali Acc: 0.595 Test Loss: 1.003 Test Acc: 0.595
Validation loss decreased (-0.594584 --> -0.594585).  Saving model ...
Epoch: 18 cost time: 1.227198600769043
Epoch: 18, Steps: 10 | Train Loss: 0.314 Vali Loss: 0.968 Vali Acc: 0.568 Test Loss: 0.968 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1895654201507568
Epoch: 19, Steps: 10 | Train Loss: 0.272 Vali Loss: 0.989 Vali Acc: 0.581 Test Loss: 0.989 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9444863796234131
Epoch: 20, Steps: 10 | Train Loss: 0.201 Vali Loss: 0.965 Vali Acc: 0.595 Test Loss: 0.965 Test Acc: 0.595
Validation loss decreased (-0.594585 --> -0.594585).  Saving model ...
Epoch: 21 cost time: 1.1663987636566162
Epoch: 21, Steps: 10 | Train Loss: 0.173 Vali Loss: 0.948 Vali Acc: 0.608 Test Loss: 0.948 Test Acc: 0.608
Validation loss decreased (-0.594585 --> -0.608099).  Saving model ...
Epoch: 22 cost time: 1.200347900390625
Epoch: 22, Steps: 10 | Train Loss: 0.165 Vali Loss: 1.007 Vali Acc: 0.554 Test Loss: 1.007 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.149287223815918
Epoch: 23, Steps: 10 | Train Loss: 0.152 Vali Loss: 1.003 Vali Acc: 0.581 Test Loss: 1.003 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.2502036094665527
Epoch: 24, Steps: 10 | Train Loss: 0.124 Vali Loss: 0.958 Vali Acc: 0.622 Test Loss: 0.958 Test Acc: 0.622
Validation loss decreased (-0.608099 --> -0.621612).  Saving model ...
Epoch: 25 cost time: 1.173872470855713
Epoch: 25, Steps: 10 | Train Loss: 0.110 Vali Loss: 0.971 Vali Acc: 0.635 Test Loss: 0.971 Test Acc: 0.635
Validation loss decreased (-0.621612 --> -0.635125).  Saving model ...
Epoch: 26 cost time: 1.2150828838348389
Epoch: 26, Steps: 10 | Train Loss: 0.085 Vali Loss: 0.998 Vali Acc: 0.608 Test Loss: 0.998 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.1275677680969238
Epoch: 27, Steps: 10 | Train Loss: 0.087 Vali Loss: 1.030 Vali Acc: 0.595 Test Loss: 1.030 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.1490089893341064
Epoch: 28, Steps: 10 | Train Loss: 0.074 Vali Loss: 1.026 Vali Acc: 0.595 Test Loss: 1.026 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.1661744117736816
Epoch: 29, Steps: 10 | Train Loss: 0.064 Vali Loss: 1.017 Vali Acc: 0.622 Test Loss: 1.017 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.2101125717163086
Epoch: 30, Steps: 10 | Train Loss: 0.060 Vali Loss: 1.014 Vali Acc: 0.649 Test Loss: 1.014 Test Acc: 0.649
Validation loss decreased (-0.635125 --> -0.648639).  Saving model ...
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm8_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6486486486486487
model parameter : 306436
model size : 1.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm8_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.230180501937866
Epoch: 1, Steps: 10 | Train Loss: 1.478 Vali Loss: 1.387 Vali Acc: 0.284 Test Loss: 1.387 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 0.9536006450653076
Epoch: 2, Steps: 10 | Train Loss: 1.415 Vali Loss: 1.373 Vali Acc: 0.257 Test Loss: 1.373 Test Acc: 0.257
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9152944087982178
Epoch: 3, Steps: 10 | Train Loss: 1.394 Vali Loss: 1.355 Vali Acc: 0.311 Test Loss: 1.355 Test Acc: 0.311
Validation loss decreased (-0.283770 --> -0.310797).  Saving model ...
Epoch: 4 cost time: 0.9022481441497803
Epoch: 4, Steps: 10 | Train Loss: 1.314 Vali Loss: 1.345 Vali Acc: 0.351 Test Loss: 1.345 Test Acc: 0.351
Validation loss decreased (-0.310797 --> -0.351338).  Saving model ...
Epoch: 5 cost time: 0.928278923034668
Epoch: 5, Steps: 10 | Train Loss: 1.263 Vali Loss: 1.300 Vali Acc: 0.392 Test Loss: 1.300 Test Acc: 0.392
Validation loss decreased (-0.351338 --> -0.391879).  Saving model ...
Epoch: 6 cost time: 0.9004724025726318
Epoch: 6, Steps: 10 | Train Loss: 1.203 Vali Loss: 1.267 Vali Acc: 0.432 Test Loss: 1.267 Test Acc: 0.432
Validation loss decreased (-0.391879 --> -0.432420).  Saving model ...
Epoch: 7 cost time: 0.6879475116729736
Epoch: 7, Steps: 10 | Train Loss: 1.113 Vali Loss: 1.234 Vali Acc: 0.459 Test Loss: 1.234 Test Acc: 0.459
Validation loss decreased (-0.432420 --> -0.459447).  Saving model ...
Epoch: 8 cost time: 0.8687424659729004
Epoch: 8, Steps: 10 | Train Loss: 1.010 Vali Loss: 1.224 Vali Acc: 0.446 Test Loss: 1.224 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8908159732818604
Epoch: 9, Steps: 10 | Train Loss: 0.950 Vali Loss: 1.182 Vali Acc: 0.486 Test Loss: 1.182 Test Acc: 0.486
Validation loss decreased (-0.459447 --> -0.486475).  Saving model ...
Epoch: 10 cost time: 0.9247477054595947
Epoch: 10, Steps: 10 | Train Loss: 0.871 Vali Loss: 1.173 Vali Acc: 0.500 Test Loss: 1.173 Test Acc: 0.500
Validation loss decreased (-0.486475 --> -0.499988).  Saving model ...
Epoch: 11 cost time: 0.9382483959197998
Epoch: 11, Steps: 10 | Train Loss: 0.803 Vali Loss: 1.146 Vali Acc: 0.527 Test Loss: 1.146 Test Acc: 0.527
Validation loss decreased (-0.499988 --> -0.527016).  Saving model ...
Epoch: 12 cost time: 0.9344866275787354
Epoch: 12, Steps: 10 | Train Loss: 0.714 Vali Loss: 1.118 Vali Acc: 0.554 Test Loss: 1.118 Test Acc: 0.554
Validation loss decreased (-0.527016 --> -0.554043).  Saving model ...
Epoch: 13 cost time: 0.9384768009185791
Epoch: 13, Steps: 10 | Train Loss: 0.631 Vali Loss: 1.079 Vali Acc: 0.541 Test Loss: 1.079 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0051929950714111
Epoch: 14, Steps: 10 | Train Loss: 0.560 Vali Loss: 1.080 Vali Acc: 0.595 Test Loss: 1.080 Test Acc: 0.595
Validation loss decreased (-0.554043 --> -0.594584).  Saving model ...
Epoch: 15 cost time: 0.9130301475524902
Epoch: 15, Steps: 10 | Train Loss: 0.516 Vali Loss: 1.084 Vali Acc: 0.568 Test Loss: 1.084 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.921964168548584
Epoch: 16, Steps: 10 | Train Loss: 0.427 Vali Loss: 1.035 Vali Acc: 0.581 Test Loss: 1.035 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9251112937927246
Epoch: 17, Steps: 10 | Train Loss: 0.382 Vali Loss: 1.022 Vali Acc: 0.595 Test Loss: 1.022 Test Acc: 0.595
Validation loss decreased (-0.594584 --> -0.594584).  Saving model ...
Epoch: 18 cost time: 0.8961596488952637
Epoch: 18, Steps: 10 | Train Loss: 0.314 Vali Loss: 1.017 Vali Acc: 0.581 Test Loss: 1.017 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8936052322387695
Epoch: 19, Steps: 10 | Train Loss: 0.267 Vali Loss: 0.992 Vali Acc: 0.595 Test Loss: 0.992 Test Acc: 0.595
Validation loss decreased (-0.594584 --> -0.594585).  Saving model ...
Epoch: 20 cost time: 0.8751537799835205
Epoch: 20, Steps: 10 | Train Loss: 0.236 Vali Loss: 1.000 Vali Acc: 0.595 Test Loss: 1.000 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9093444347381592
Epoch: 21, Steps: 10 | Train Loss: 0.192 Vali Loss: 0.997 Vali Acc: 0.608 Test Loss: 0.997 Test Acc: 0.608
Validation loss decreased (-0.594585 --> -0.608098).  Saving model ...
Epoch: 22 cost time: 0.908064603805542
Epoch: 22, Steps: 10 | Train Loss: 0.154 Vali Loss: 0.992 Vali Acc: 0.595 Test Loss: 0.992 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9266695976257324
Epoch: 23, Steps: 10 | Train Loss: 0.142 Vali Loss: 0.984 Vali Acc: 0.622 Test Loss: 0.984 Test Acc: 0.622
Validation loss decreased (-0.608098 --> -0.621612).  Saving model ...
Epoch: 24 cost time: 0.8858795166015625
Epoch: 24, Steps: 10 | Train Loss: 0.127 Vali Loss: 0.976 Vali Acc: 0.622 Test Loss: 0.976 Test Acc: 0.622
Validation loss decreased (-0.621612 --> -0.621612).  Saving model ...
Epoch: 25 cost time: 0.8688876628875732
Epoch: 25, Steps: 10 | Train Loss: 0.112 Vali Loss: 1.009 Vali Acc: 0.608 Test Loss: 1.009 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9187531471252441
Epoch: 26, Steps: 10 | Train Loss: 0.094 Vali Loss: 1.001 Vali Acc: 0.622 Test Loss: 1.001 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.870903730392456
Epoch: 27, Steps: 10 | Train Loss: 0.081 Vali Loss: 0.999 Vali Acc: 0.635 Test Loss: 0.999 Test Acc: 0.635
Validation loss decreased (-0.621612 --> -0.635125).  Saving model ...
Epoch: 28 cost time: 0.915895938873291
Epoch: 28, Steps: 10 | Train Loss: 0.069 Vali Loss: 1.004 Vali Acc: 0.622 Test Loss: 1.004 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.9092404842376709
Epoch: 29, Steps: 10 | Train Loss: 0.066 Vali Loss: 1.020 Vali Acc: 0.608 Test Loss: 1.020 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.9285092353820801
Epoch: 30, Steps: 10 | Train Loss: 0.059 Vali Loss: 1.041 Vali Acc: 0.649 Test Loss: 1.041 Test Acc: 0.649
Validation loss decreased (-0.635125 --> -0.648638).  Saving model ...
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm8_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6486486486486487
model parameter : 99428
model size : 0.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm8_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.0867385864257812
Epoch: 1, Steps: 10 | Train Loss: 1.441 Vali Loss: 1.531 Vali Acc: 0.095 Test Loss: 1.531 Test Acc: 0.095
Validation loss decreased (inf --> -0.094579).  Saving model ...
Epoch: 2 cost time: 1.6783795356750488
Epoch: 2, Steps: 10 | Train Loss: 1.389 Vali Loss: 1.485 Vali Acc: 0.135 Test Loss: 1.485 Test Acc: 0.135
Validation loss decreased (-0.094579 --> -0.135120).  Saving model ...
Epoch: 3 cost time: 1.6380088329315186
Epoch: 3, Steps: 10 | Train Loss: 1.318 Vali Loss: 1.434 Vali Acc: 0.203 Test Loss: 1.434 Test Acc: 0.203
Validation loss decreased (-0.135120 --> -0.202688).  Saving model ...
Epoch: 4 cost time: 1.693657636642456
Epoch: 4, Steps: 10 | Train Loss: 1.288 Vali Loss: 1.394 Vali Acc: 0.270 Test Loss: 1.394 Test Acc: 0.270
Validation loss decreased (-0.202688 --> -0.270256).  Saving model ...
Epoch: 5 cost time: 1.577660083770752
Epoch: 5, Steps: 10 | Train Loss: 1.221 Vali Loss: 1.388 Vali Acc: 0.270 Test Loss: 1.388 Test Acc: 0.270
Validation loss decreased (-0.270256 --> -0.270256).  Saving model ...
Epoch: 6 cost time: 1.5186247825622559
Epoch: 6, Steps: 10 | Train Loss: 1.136 Vali Loss: 1.356 Vali Acc: 0.324 Test Loss: 1.356 Test Acc: 0.324
Validation loss decreased (-0.270256 --> -0.324311).  Saving model ...
Epoch: 7 cost time: 1.60725736618042
Epoch: 7, Steps: 10 | Train Loss: 1.068 Vali Loss: 1.330 Vali Acc: 0.351 Test Loss: 1.330 Test Acc: 0.351
Validation loss decreased (-0.324311 --> -0.351338).  Saving model ...
Epoch: 8 cost time: 1.5648136138916016
Epoch: 8, Steps: 10 | Train Loss: 0.991 Vali Loss: 1.304 Vali Acc: 0.392 Test Loss: 1.304 Test Acc: 0.392
Validation loss decreased (-0.351338 --> -0.391879).  Saving model ...
Epoch: 9 cost time: 1.645242691040039
Epoch: 9, Steps: 10 | Train Loss: 0.920 Vali Loss: 1.278 Vali Acc: 0.351 Test Loss: 1.278 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5852410793304443
Epoch: 10, Steps: 10 | Train Loss: 0.833 Vali Loss: 1.257 Vali Acc: 0.378 Test Loss: 1.257 Test Acc: 0.378
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.638148546218872
Epoch: 11, Steps: 10 | Train Loss: 0.765 Vali Loss: 1.253 Vali Acc: 0.419 Test Loss: 1.253 Test Acc: 0.419
Validation loss decreased (-0.391879 --> -0.418906).  Saving model ...
Epoch: 12 cost time: 1.6274447441101074
Epoch: 12, Steps: 10 | Train Loss: 0.681 Vali Loss: 1.210 Vali Acc: 0.459 Test Loss: 1.210 Test Acc: 0.459
Validation loss decreased (-0.418906 --> -0.459447).  Saving model ...
Epoch: 13 cost time: 1.607985258102417
Epoch: 13, Steps: 10 | Train Loss: 0.621 Vali Loss: 1.181 Vali Acc: 0.486 Test Loss: 1.181 Test Acc: 0.486
Validation loss decreased (-0.459447 --> -0.486475).  Saving model ...
Epoch: 14 cost time: 1.6567800045013428
Epoch: 14, Steps: 10 | Train Loss: 0.533 Vali Loss: 1.181 Vali Acc: 0.514 Test Loss: 1.181 Test Acc: 0.514
Validation loss decreased (-0.486475 --> -0.513502).  Saving model ...
Epoch: 15 cost time: 1.5596568584442139
Epoch: 15, Steps: 10 | Train Loss: 0.459 Vali Loss: 1.173 Vali Acc: 0.527 Test Loss: 1.173 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527015).  Saving model ...
Epoch: 16 cost time: 1.691612958908081
Epoch: 16, Steps: 10 | Train Loss: 0.402 Vali Loss: 1.114 Vali Acc: 0.541 Test Loss: 1.114 Test Acc: 0.541
Validation loss decreased (-0.527015 --> -0.540529).  Saving model ...
Epoch: 17 cost time: 1.706045389175415
Epoch: 17, Steps: 10 | Train Loss: 0.336 Vali Loss: 1.150 Vali Acc: 0.541 Test Loss: 1.150 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.7035627365112305
Epoch: 18, Steps: 10 | Train Loss: 0.285 Vali Loss: 1.107 Vali Acc: 0.581 Test Loss: 1.107 Test Acc: 0.581
Validation loss decreased (-0.540529 --> -0.581070).  Saving model ...
Epoch: 19 cost time: 1.6823699474334717
Epoch: 19, Steps: 10 | Train Loss: 0.239 Vali Loss: 1.105 Vali Acc: 0.568 Test Loss: 1.105 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.6750519275665283
Epoch: 20, Steps: 10 | Train Loss: 0.189 Vali Loss: 1.125 Vali Acc: 0.554 Test Loss: 1.125 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.6157243251800537
Epoch: 21, Steps: 10 | Train Loss: 0.170 Vali Loss: 1.095 Vali Acc: 0.568 Test Loss: 1.095 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.6161386966705322
Epoch: 22, Steps: 10 | Train Loss: 0.144 Vali Loss: 1.101 Vali Acc: 0.554 Test Loss: 1.101 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.7438952922821045
Epoch: 23, Steps: 10 | Train Loss: 0.135 Vali Loss: 1.115 Vali Acc: 0.527 Test Loss: 1.115 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.7432146072387695
Epoch: 24, Steps: 10 | Train Loss: 0.107 Vali Loss: 1.094 Vali Acc: 0.568 Test Loss: 1.094 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.6805050373077393
Epoch: 25, Steps: 10 | Train Loss: 0.096 Vali Loss: 1.117 Vali Acc: 0.514 Test Loss: 1.117 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.7202153205871582
Epoch: 26, Steps: 10 | Train Loss: 0.086 Vali Loss: 1.157 Vali Acc: 0.527 Test Loss: 1.157 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.6908626556396484
Epoch: 27, Steps: 10 | Train Loss: 0.073 Vali Loss: 1.135 Vali Acc: 0.541 Test Loss: 1.135 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.645195484161377
Epoch: 28, Steps: 10 | Train Loss: 0.064 Vali Loss: 1.117 Vali Acc: 0.581 Test Loss: 1.117 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm8_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 159812
model size : 0.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm8_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.680332899093628
Epoch: 1, Steps: 10 | Train Loss: 1.418 Vali Loss: 1.359 Vali Acc: 0.297 Test Loss: 1.359 Test Acc: 0.297
Validation loss decreased (inf --> -0.297284).  Saving model ...
Epoch: 2 cost time: 1.1623213291168213
Epoch: 2, Steps: 10 | Train Loss: 1.371 Vali Loss: 1.345 Vali Acc: 0.324 Test Loss: 1.345 Test Acc: 0.324
Validation loss decreased (-0.297284 --> -0.324311).  Saving model ...
Epoch: 3 cost time: 1.1513140201568604
Epoch: 3, Steps: 10 | Train Loss: 1.353 Vali Loss: 1.330 Vali Acc: 0.365 Test Loss: 1.330 Test Acc: 0.365
Validation loss decreased (-0.324311 --> -0.364852).  Saving model ...
Epoch: 4 cost time: 1.2653584480285645
Epoch: 4, Steps: 10 | Train Loss: 1.295 Vali Loss: 1.314 Vali Acc: 0.378 Test Loss: 1.314 Test Acc: 0.378
Validation loss decreased (-0.364852 --> -0.378365).  Saving model ...
Epoch: 5 cost time: 1.2274870872497559
Epoch: 5, Steps: 10 | Train Loss: 1.218 Vali Loss: 1.304 Vali Acc: 0.419 Test Loss: 1.304 Test Acc: 0.419
Validation loss decreased (-0.378365 --> -0.418906).  Saving model ...
Epoch: 6 cost time: 1.2293000221252441
Epoch: 6, Steps: 10 | Train Loss: 1.129 Vali Loss: 1.269 Vali Acc: 0.419 Test Loss: 1.269 Test Acc: 0.419
Validation loss decreased (-0.418906 --> -0.418906).  Saving model ...
Epoch: 7 cost time: 1.3461275100708008
Epoch: 7, Steps: 10 | Train Loss: 1.094 Vali Loss: 1.250 Vali Acc: 0.473 Test Loss: 1.250 Test Acc: 0.473
Validation loss decreased (-0.418906 --> -0.472960).  Saving model ...
Epoch: 8 cost time: 1.152616262435913
Epoch: 8, Steps: 10 | Train Loss: 1.013 Vali Loss: 1.232 Vali Acc: 0.446 Test Loss: 1.232 Test Acc: 0.446
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2311067581176758
Epoch: 9, Steps: 10 | Train Loss: 0.950 Vali Loss: 1.218 Vali Acc: 0.459 Test Loss: 1.218 Test Acc: 0.459
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.3833551406860352
Epoch: 10, Steps: 10 | Train Loss: 0.868 Vali Loss: 1.213 Vali Acc: 0.432 Test Loss: 1.213 Test Acc: 0.432
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.2142102718353271
Epoch: 11, Steps: 10 | Train Loss: 0.802 Vali Loss: 1.168 Vali Acc: 0.500 Test Loss: 1.168 Test Acc: 0.500
Validation loss decreased (-0.472960 --> -0.499988).  Saving model ...
Epoch: 12 cost time: 1.2621278762817383
Epoch: 12, Steps: 10 | Train Loss: 0.735 Vali Loss: 1.176 Vali Acc: 0.486 Test Loss: 1.176 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2870051860809326
Epoch: 13, Steps: 10 | Train Loss: 0.690 Vali Loss: 1.141 Vali Acc: 0.473 Test Loss: 1.141 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.2795023918151855
Epoch: 14, Steps: 10 | Train Loss: 0.613 Vali Loss: 1.150 Vali Acc: 0.500 Test Loss: 1.150 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499989).  Saving model ...
Epoch: 15 cost time: 1.1927447319030762
Epoch: 15, Steps: 10 | Train Loss: 0.542 Vali Loss: 1.146 Vali Acc: 0.514 Test Loss: 1.146 Test Acc: 0.514
Validation loss decreased (-0.499989 --> -0.513502).  Saving model ...
Epoch: 16 cost time: 1.177166223526001
Epoch: 16, Steps: 10 | Train Loss: 0.472 Vali Loss: 1.115 Vali Acc: 0.500 Test Loss: 1.115 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.185037612915039
Epoch: 17, Steps: 10 | Train Loss: 0.420 Vali Loss: 1.122 Vali Acc: 0.568 Test Loss: 1.122 Test Acc: 0.568
Validation loss decreased (-0.513502 --> -0.567556).  Saving model ...
Epoch: 18 cost time: 1.2176542282104492
Epoch: 18, Steps: 10 | Train Loss: 0.365 Vali Loss: 1.109 Vali Acc: 0.568 Test Loss: 1.109 Test Acc: 0.568
Validation loss decreased (-0.567556 --> -0.567556).  Saving model ...
Epoch: 19 cost time: 1.2285802364349365
Epoch: 19, Steps: 10 | Train Loss: 0.332 Vali Loss: 1.118 Vali Acc: 0.541 Test Loss: 1.118 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.161050796508789
Epoch: 20, Steps: 10 | Train Loss: 0.288 Vali Loss: 1.116 Vali Acc: 0.595 Test Loss: 1.116 Test Acc: 0.595
Validation loss decreased (-0.567556 --> -0.594583).  Saving model ...
Epoch: 21 cost time: 1.2027945518493652
Epoch: 21, Steps: 10 | Train Loss: 0.243 Vali Loss: 1.122 Vali Acc: 0.554 Test Loss: 1.122 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2532610893249512
Epoch: 22, Steps: 10 | Train Loss: 0.224 Vali Loss: 1.133 Vali Acc: 0.595 Test Loss: 1.133 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.214704990386963
Epoch: 23, Steps: 10 | Train Loss: 0.191 Vali Loss: 1.133 Vali Acc: 0.554 Test Loss: 1.133 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.2409014701843262
Epoch: 24, Steps: 10 | Train Loss: 0.156 Vali Loss: 1.124 Vali Acc: 0.541 Test Loss: 1.124 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.2158770561218262
Epoch: 25, Steps: 10 | Train Loss: 0.133 Vali Loss: 1.149 Vali Acc: 0.568 Test Loss: 1.149 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.1925663948059082
Epoch: 26, Steps: 10 | Train Loss: 0.125 Vali Loss: 1.180 Vali Acc: 0.541 Test Loss: 1.180 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.260258674621582
Epoch: 27, Steps: 10 | Train Loss: 0.113 Vali Loss: 1.152 Vali Acc: 0.514 Test Loss: 1.152 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.2336688041687012
Epoch: 28, Steps: 10 | Train Loss: 0.096 Vali Loss: 1.151 Vali Acc: 0.514 Test Loss: 1.151 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.189746379852295
Epoch: 29, Steps: 10 | Train Loss: 0.088 Vali Loss: 1.158 Vali Acc: 0.554 Test Loss: 1.158 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.2051308155059814
Epoch: 30, Steps: 10 | Train Loss: 0.080 Vali Loss: 1.154 Vali Acc: 0.527 Test Loss: 1.154 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm8_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 56292
model size : 0.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm8_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.771561622619629
Epoch: 1, Steps: 10 | Train Loss: 1.440 Vali Loss: 1.533 Vali Acc: 0.108 Test Loss: 1.533 Test Acc: 0.108
Validation loss decreased (inf --> -0.108093).  Saving model ...
Epoch: 2 cost time: 1.4413974285125732
Epoch: 2, Steps: 10 | Train Loss: 1.389 Vali Loss: 1.487 Vali Acc: 0.135 Test Loss: 1.487 Test Acc: 0.135
Validation loss decreased (-0.108093 --> -0.135120).  Saving model ...
Epoch: 3 cost time: 1.497788429260254
Epoch: 3, Steps: 10 | Train Loss: 1.320 Vali Loss: 1.437 Vali Acc: 0.216 Test Loss: 1.437 Test Acc: 0.216
Validation loss decreased (-0.135120 --> -0.216202).  Saving model ...
Epoch: 4 cost time: 1.511880874633789
Epoch: 4, Steps: 10 | Train Loss: 1.288 Vali Loss: 1.399 Vali Acc: 0.270 Test Loss: 1.399 Test Acc: 0.270
Validation loss decreased (-0.216202 --> -0.270256).  Saving model ...
Epoch: 5 cost time: 1.4952588081359863
Epoch: 5, Steps: 10 | Train Loss: 1.225 Vali Loss: 1.395 Vali Acc: 0.243 Test Loss: 1.395 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.4283547401428223
Epoch: 6, Steps: 10 | Train Loss: 1.135 Vali Loss: 1.363 Vali Acc: 0.324 Test Loss: 1.363 Test Acc: 0.324
Validation loss decreased (-0.270256 --> -0.324311).  Saving model ...
Epoch: 7 cost time: 1.4277267456054688
Epoch: 7, Steps: 10 | Train Loss: 1.074 Vali Loss: 1.338 Vali Acc: 0.338 Test Loss: 1.338 Test Acc: 0.338
Validation loss decreased (-0.324311 --> -0.337824).  Saving model ...
Epoch: 8 cost time: 1.4025218486785889
Epoch: 8, Steps: 10 | Train Loss: 0.997 Vali Loss: 1.313 Vali Acc: 0.378 Test Loss: 1.313 Test Acc: 0.378
Validation loss decreased (-0.337824 --> -0.378365).  Saving model ...
Epoch: 9 cost time: 1.5095560550689697
Epoch: 9, Steps: 10 | Train Loss: 0.925 Vali Loss: 1.286 Vali Acc: 0.324 Test Loss: 1.286 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4780502319335938
Epoch: 10, Steps: 10 | Train Loss: 0.835 Vali Loss: 1.264 Vali Acc: 0.378 Test Loss: 1.264 Test Acc: 0.378
Validation loss decreased (-0.378365 --> -0.378366).  Saving model ...
Epoch: 11 cost time: 1.3956267833709717
Epoch: 11, Steps: 10 | Train Loss: 0.778 Vali Loss: 1.264 Vali Acc: 0.446 Test Loss: 1.264 Test Acc: 0.446
Validation loss decreased (-0.378366 --> -0.445933).  Saving model ...
Epoch: 12 cost time: 1.4224779605865479
Epoch: 12, Steps: 10 | Train Loss: 0.682 Vali Loss: 1.216 Vali Acc: 0.486 Test Loss: 1.216 Test Acc: 0.486
Validation loss decreased (-0.445933 --> -0.486474).  Saving model ...
Epoch: 13 cost time: 0.8838160037994385
Epoch: 13, Steps: 10 | Train Loss: 0.631 Vali Loss: 1.191 Vali Acc: 0.486 Test Loss: 1.191 Test Acc: 0.486
Validation loss decreased (-0.486474 --> -0.486475).  Saving model ...
Epoch: 14 cost time: 1.3426156044006348
Epoch: 14, Steps: 10 | Train Loss: 0.541 Vali Loss: 1.189 Vali Acc: 0.514 Test Loss: 1.189 Test Acc: 0.514
Validation loss decreased (-0.486475 --> -0.513502).  Saving model ...
Epoch: 15 cost time: 1.3522732257843018
Epoch: 15, Steps: 10 | Train Loss: 0.471 Vali Loss: 1.183 Vali Acc: 0.527 Test Loss: 1.183 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527015).  Saving model ...
Epoch: 16 cost time: 1.3770837783813477
Epoch: 16, Steps: 10 | Train Loss: 0.413 Vali Loss: 1.130 Vali Acc: 0.568 Test Loss: 1.130 Test Acc: 0.568
Validation loss decreased (-0.527015 --> -0.567556).  Saving model ...
Epoch: 17 cost time: 1.352766513824463
Epoch: 17, Steps: 10 | Train Loss: 0.354 Vali Loss: 1.166 Vali Acc: 0.554 Test Loss: 1.166 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.3850324153900146
Epoch: 18, Steps: 10 | Train Loss: 0.300 Vali Loss: 1.119 Vali Acc: 0.568 Test Loss: 1.119 Test Acc: 0.568
Validation loss decreased (-0.567556 --> -0.567556).  Saving model ...
Epoch: 19 cost time: 1.3240265846252441
Epoch: 19, Steps: 10 | Train Loss: 0.258 Vali Loss: 1.103 Vali Acc: 0.608 Test Loss: 1.103 Test Acc: 0.608
Validation loss decreased (-0.567556 --> -0.608097).  Saving model ...
Epoch: 20 cost time: 1.4031002521514893
Epoch: 20, Steps: 10 | Train Loss: 0.199 Vali Loss: 1.115 Vali Acc: 0.595 Test Loss: 1.115 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.387704849243164
Epoch: 21, Steps: 10 | Train Loss: 0.187 Vali Loss: 1.069 Vali Acc: 0.581 Test Loss: 1.069 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.3689415454864502
Epoch: 22, Steps: 10 | Train Loss: 0.157 Vali Loss: 1.075 Vali Acc: 0.595 Test Loss: 1.075 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.4470515251159668
Epoch: 23, Steps: 10 | Train Loss: 0.131 Vali Loss: 1.102 Vali Acc: 0.581 Test Loss: 1.102 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.3524501323699951
Epoch: 24, Steps: 10 | Train Loss: 0.110 Vali Loss: 1.076 Vali Acc: 0.595 Test Loss: 1.076 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.336129903793335
Epoch: 25, Steps: 10 | Train Loss: 0.098 Vali Loss: 1.088 Vali Acc: 0.595 Test Loss: 1.088 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.3002839088439941
Epoch: 26, Steps: 10 | Train Loss: 0.089 Vali Loss: 1.105 Vali Acc: 0.568 Test Loss: 1.105 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.3257060050964355
Epoch: 27, Steps: 10 | Train Loss: 0.070 Vali Loss: 1.091 Vali Acc: 0.595 Test Loss: 1.091 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.431959867477417
Epoch: 28, Steps: 10 | Train Loss: 0.064 Vali Loss: 1.089 Vali Acc: 0.622 Test Loss: 1.089 Test Acc: 0.622
Validation loss decreased (-0.608097 --> -0.621611).  Saving model ...
Epoch: 29 cost time: 1.3764171600341797
Epoch: 29, Steps: 10 | Train Loss: 0.059 Vali Loss: 1.120 Vali Acc: 0.581 Test Loss: 1.120 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.3401122093200684
Epoch: 30, Steps: 10 | Train Loss: 0.059 Vali Loss: 1.111 Vali Acc: 0.622 Test Loss: 1.111 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm8_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 159812
model size : 0.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm8_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.4361965656280518
Epoch: 1, Steps: 10 | Train Loss: 1.416 Vali Loss: 1.360 Vali Acc: 0.297 Test Loss: 1.360 Test Acc: 0.297
Validation loss decreased (inf --> -0.297284).  Saving model ...
Epoch: 2 cost time: 0.9991991519927979
Epoch: 2, Steps: 10 | Train Loss: 1.377 Vali Loss: 1.347 Vali Acc: 0.324 Test Loss: 1.347 Test Acc: 0.324
Validation loss decreased (-0.297284 --> -0.324311).  Saving model ...
Epoch: 3 cost time: 1.06168532371521
Epoch: 3, Steps: 10 | Train Loss: 1.351 Vali Loss: 1.332 Vali Acc: 0.392 Test Loss: 1.332 Test Acc: 0.392
Validation loss decreased (-0.324311 --> -0.391879).  Saving model ...
Epoch: 4 cost time: 1.0359599590301514
Epoch: 4, Steps: 10 | Train Loss: 1.295 Vali Loss: 1.315 Vali Acc: 0.405 Test Loss: 1.315 Test Acc: 0.405
Validation loss decreased (-0.391879 --> -0.405392).  Saving model ...
Epoch: 5 cost time: 0.9793155193328857
Epoch: 5, Steps: 10 | Train Loss: 1.223 Vali Loss: 1.305 Vali Acc: 0.419 Test Loss: 1.305 Test Acc: 0.419
Validation loss decreased (-0.405392 --> -0.418906).  Saving model ...
Epoch: 6 cost time: 0.8962798118591309
Epoch: 6, Steps: 10 | Train Loss: 1.131 Vali Loss: 1.273 Vali Acc: 0.378 Test Loss: 1.273 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0227839946746826
Epoch: 7, Steps: 10 | Train Loss: 1.096 Vali Loss: 1.254 Vali Acc: 0.446 Test Loss: 1.254 Test Acc: 0.446
Validation loss decreased (-0.418906 --> -0.445933).  Saving model ...
Epoch: 8 cost time: 0.9910690784454346
Epoch: 8, Steps: 10 | Train Loss: 1.019 Vali Loss: 1.238 Vali Acc: 0.432 Test Loss: 1.238 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9812712669372559
Epoch: 9, Steps: 10 | Train Loss: 0.952 Vali Loss: 1.223 Vali Acc: 0.459 Test Loss: 1.223 Test Acc: 0.459
Validation loss decreased (-0.445933 --> -0.459447).  Saving model ...
Epoch: 10 cost time: 0.967191219329834
Epoch: 10, Steps: 10 | Train Loss: 0.875 Vali Loss: 1.219 Vali Acc: 0.419 Test Loss: 1.219 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0910308361053467
Epoch: 11, Steps: 10 | Train Loss: 0.818 Vali Loss: 1.172 Vali Acc: 0.500 Test Loss: 1.172 Test Acc: 0.500
Validation loss decreased (-0.459447 --> -0.499988).  Saving model ...
Epoch: 12 cost time: 1.0800187587738037
Epoch: 12, Steps: 10 | Train Loss: 0.747 Vali Loss: 1.181 Vali Acc: 0.459 Test Loss: 1.181 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9750840663909912
Epoch: 13, Steps: 10 | Train Loss: 0.697 Vali Loss: 1.150 Vali Acc: 0.500 Test Loss: 1.150 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 14 cost time: 0.970707893371582
Epoch: 14, Steps: 10 | Train Loss: 0.622 Vali Loss: 1.154 Vali Acc: 0.486 Test Loss: 1.154 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1386008262634277
Epoch: 15, Steps: 10 | Train Loss: 0.560 Vali Loss: 1.150 Vali Acc: 0.514 Test Loss: 1.150 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513502).  Saving model ...
Epoch: 16 cost time: 0.998866081237793
Epoch: 16, Steps: 10 | Train Loss: 0.485 Vali Loss: 1.118 Vali Acc: 0.527 Test Loss: 1.118 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527016).  Saving model ...
Epoch: 17 cost time: 0.9838652610778809
Epoch: 17, Steps: 10 | Train Loss: 0.442 Vali Loss: 1.120 Vali Acc: 0.581 Test Loss: 1.120 Test Acc: 0.581
Validation loss decreased (-0.527016 --> -0.581070).  Saving model ...
Epoch: 18 cost time: 1.006917953491211
Epoch: 18, Steps: 10 | Train Loss: 0.385 Vali Loss: 1.111 Vali Acc: 0.568 Test Loss: 1.111 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9583282470703125
Epoch: 19, Steps: 10 | Train Loss: 0.339 Vali Loss: 1.116 Vali Acc: 0.568 Test Loss: 1.116 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.014404296875
Epoch: 20, Steps: 10 | Train Loss: 0.310 Vali Loss: 1.110 Vali Acc: 0.581 Test Loss: 1.110 Test Acc: 0.581
Validation loss decreased (-0.581070 --> -0.581070).  Saving model ...
Epoch: 21 cost time: 1.0022070407867432
Epoch: 21, Steps: 10 | Train Loss: 0.253 Vali Loss: 1.124 Vali Acc: 0.568 Test Loss: 1.124 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.695000410079956
Epoch: 22, Steps: 10 | Train Loss: 0.236 Vali Loss: 1.123 Vali Acc: 0.595 Test Loss: 1.123 Test Acc: 0.595
Validation loss decreased (-0.581070 --> -0.594583).  Saving model ...
Epoch: 23 cost time: 1.0602891445159912
Epoch: 23, Steps: 10 | Train Loss: 0.205 Vali Loss: 1.137 Vali Acc: 0.581 Test Loss: 1.137 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.0434911251068115
Epoch: 24, Steps: 10 | Train Loss: 0.165 Vali Loss: 1.122 Vali Acc: 0.581 Test Loss: 1.122 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.0926401615142822
Epoch: 25, Steps: 10 | Train Loss: 0.150 Vali Loss: 1.138 Vali Acc: 0.568 Test Loss: 1.138 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.035079002380371
Epoch: 26, Steps: 10 | Train Loss: 0.136 Vali Loss: 1.165 Vali Acc: 0.541 Test Loss: 1.165 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.042314052581787
Epoch: 27, Steps: 10 | Train Loss: 0.118 Vali Loss: 1.145 Vali Acc: 0.568 Test Loss: 1.145 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.0239367485046387
Epoch: 28, Steps: 10 | Train Loss: 0.103 Vali Loss: 1.151 Vali Acc: 0.554 Test Loss: 1.151 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.0378711223602295
Epoch: 29, Steps: 10 | Train Loss: 0.101 Vali Loss: 1.163 Vali Acc: 0.541 Test Loss: 1.163 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.0275204181671143
Epoch: 30, Steps: 10 | Train Loss: 0.086 Vali Loss: 1.151 Vali Acc: 0.541 Test Loss: 1.151 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm8_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 56292
model size : 0.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm8_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.4917421340942383
Epoch: 1, Steps: 10 | Train Loss: 1.442 Vali Loss: 1.532 Vali Acc: 0.149 Test Loss: 1.532 Test Acc: 0.149
Validation loss decreased (inf --> -0.148633).  Saving model ...
Epoch: 2 cost time: 1.1417512893676758
Epoch: 2, Steps: 10 | Train Loss: 1.391 Vali Loss: 1.486 Vali Acc: 0.162 Test Loss: 1.486 Test Acc: 0.162
Validation loss decreased (-0.148633 --> -0.162147).  Saving model ...
Epoch: 3 cost time: 1.2420189380645752
Epoch: 3, Steps: 10 | Train Loss: 1.324 Vali Loss: 1.435 Vali Acc: 0.230 Test Loss: 1.435 Test Acc: 0.230
Validation loss decreased (-0.162147 --> -0.229715).  Saving model ...
Epoch: 4 cost time: 1.1984875202178955
Epoch: 4, Steps: 10 | Train Loss: 1.294 Vali Loss: 1.395 Vali Acc: 0.297 Test Loss: 1.395 Test Acc: 0.297
Validation loss decreased (-0.229715 --> -0.297283).  Saving model ...
Epoch: 5 cost time: 1.2401549816131592
Epoch: 5, Steps: 10 | Train Loss: 1.230 Vali Loss: 1.390 Vali Acc: 0.284 Test Loss: 1.390 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1653165817260742
Epoch: 6, Steps: 10 | Train Loss: 1.145 Vali Loss: 1.358 Vali Acc: 0.324 Test Loss: 1.358 Test Acc: 0.324
Validation loss decreased (-0.297283 --> -0.324311).  Saving model ...
Epoch: 7 cost time: 1.1453258991241455
Epoch: 7, Steps: 10 | Train Loss: 1.084 Vali Loss: 1.332 Vali Acc: 0.338 Test Loss: 1.332 Test Acc: 0.338
Validation loss decreased (-0.324311 --> -0.337825).  Saving model ...
Epoch: 8 cost time: 1.1498689651489258
Epoch: 8, Steps: 10 | Train Loss: 1.006 Vali Loss: 1.308 Vali Acc: 0.365 Test Loss: 1.308 Test Acc: 0.365
Validation loss decreased (-0.337825 --> -0.364852).  Saving model ...
Epoch: 9 cost time: 1.1423707008361816
Epoch: 9, Steps: 10 | Train Loss: 0.937 Vali Loss: 1.282 Vali Acc: 0.338 Test Loss: 1.282 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2019381523132324
Epoch: 10, Steps: 10 | Train Loss: 0.853 Vali Loss: 1.260 Vali Acc: 0.378 Test Loss: 1.260 Test Acc: 0.378
Validation loss decreased (-0.364852 --> -0.378366).  Saving model ...
Epoch: 11 cost time: 1.1456711292266846
Epoch: 11, Steps: 10 | Train Loss: 0.794 Vali Loss: 1.263 Vali Acc: 0.419 Test Loss: 1.263 Test Acc: 0.419
Validation loss decreased (-0.378366 --> -0.418906).  Saving model ...
Epoch: 12 cost time: 1.1962878704071045
Epoch: 12, Steps: 10 | Train Loss: 0.711 Vali Loss: 1.223 Vali Acc: 0.459 Test Loss: 1.223 Test Acc: 0.459
Validation loss decreased (-0.418906 --> -0.459447).  Saving model ...
Epoch: 13 cost time: 1.1598052978515625
Epoch: 13, Steps: 10 | Train Loss: 0.660 Vali Loss: 1.193 Vali Acc: 0.486 Test Loss: 1.193 Test Acc: 0.486
Validation loss decreased (-0.459447 --> -0.486475).  Saving model ...
Epoch: 14 cost time: 1.2096683979034424
Epoch: 14, Steps: 10 | Train Loss: 0.572 Vali Loss: 1.195 Vali Acc: 0.514 Test Loss: 1.195 Test Acc: 0.514
Validation loss decreased (-0.486475 --> -0.513502).  Saving model ...
Epoch: 15 cost time: 1.2844359874725342
Epoch: 15, Steps: 10 | Train Loss: 0.513 Vali Loss: 1.193 Vali Acc: 0.514 Test Loss: 1.193 Test Acc: 0.514
Validation loss decreased (-0.513502 --> -0.513502).  Saving model ...
Epoch: 16 cost time: 1.1385834217071533
Epoch: 16, Steps: 10 | Train Loss: 0.455 Vali Loss: 1.135 Vali Acc: 0.581 Test Loss: 1.135 Test Acc: 0.581
Validation loss decreased (-0.513502 --> -0.581070).  Saving model ...
Epoch: 17 cost time: 1.183971881866455
Epoch: 17, Steps: 10 | Train Loss: 0.399 Vali Loss: 1.173 Vali Acc: 0.541 Test Loss: 1.173 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2079229354858398
Epoch: 18, Steps: 10 | Train Loss: 0.341 Vali Loss: 1.125 Vali Acc: 0.541 Test Loss: 1.125 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.2346346378326416
Epoch: 19, Steps: 10 | Train Loss: 0.293 Vali Loss: 1.123 Vali Acc: 0.514 Test Loss: 1.123 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.2055609226226807
Epoch: 20, Steps: 10 | Train Loss: 0.236 Vali Loss: 1.136 Vali Acc: 0.541 Test Loss: 1.136 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.1745007038116455
Epoch: 21, Steps: 10 | Train Loss: 0.216 Vali Loss: 1.114 Vali Acc: 0.568 Test Loss: 1.114 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.1689884662628174
Epoch: 22, Steps: 10 | Train Loss: 0.184 Vali Loss: 1.113 Vali Acc: 0.541 Test Loss: 1.113 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.1573693752288818
Epoch: 23, Steps: 10 | Train Loss: 0.156 Vali Loss: 1.112 Vali Acc: 0.581 Test Loss: 1.112 Test Acc: 0.581
Validation loss decreased (-0.581070 --> -0.581070).  Saving model ...
Epoch: 24 cost time: 1.2372491359710693
Epoch: 24, Steps: 10 | Train Loss: 0.131 Vali Loss: 1.115 Vali Acc: 0.595 Test Loss: 1.115 Test Acc: 0.595
Validation loss decreased (-0.581070 --> -0.594583).  Saving model ...
Epoch: 25 cost time: 1.1377344131469727
Epoch: 25, Steps: 10 | Train Loss: 0.115 Vali Loss: 1.125 Vali Acc: 0.581 Test Loss: 1.125 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.2010691165924072
Epoch: 26, Steps: 10 | Train Loss: 0.099 Vali Loss: 1.126 Vali Acc: 0.554 Test Loss: 1.126 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.1775565147399902
Epoch: 27, Steps: 10 | Train Loss: 0.085 Vali Loss: 1.131 Vali Acc: 0.568 Test Loss: 1.131 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.2294812202453613
Epoch: 28, Steps: 10 | Train Loss: 0.081 Vali Loss: 1.137 Vali Acc: 0.581 Test Loss: 1.137 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.1478970050811768
Epoch: 29, Steps: 10 | Train Loss: 0.069 Vali Loss: 1.159 Vali Acc: 0.595 Test Loss: 1.159 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.2064313888549805
Epoch: 30, Steps: 10 | Train Loss: 0.063 Vali Loss: 1.154 Vali Acc: 0.581 Test Loss: 1.154 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm8_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 159812
model size : 0.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm8_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.198249101638794
Epoch: 1, Steps: 10 | Train Loss: 1.415 Vali Loss: 1.367 Vali Acc: 0.270 Test Loss: 1.367 Test Acc: 0.270
Validation loss decreased (inf --> -0.270257).  Saving model ...
Epoch: 2 cost time: 0.9804174900054932
Epoch: 2, Steps: 10 | Train Loss: 1.373 Vali Loss: 1.354 Vali Acc: 0.311 Test Loss: 1.354 Test Acc: 0.311
Validation loss decreased (-0.270257 --> -0.310797).  Saving model ...
Epoch: 3 cost time: 0.9226830005645752
Epoch: 3, Steps: 10 | Train Loss: 1.352 Vali Loss: 1.337 Vali Acc: 0.365 Test Loss: 1.337 Test Acc: 0.365
Validation loss decreased (-0.310797 --> -0.364851).  Saving model ...
Epoch: 4 cost time: 0.9511971473693848
Epoch: 4, Steps: 10 | Train Loss: 1.296 Vali Loss: 1.321 Vali Acc: 0.378 Test Loss: 1.321 Test Acc: 0.378
Validation loss decreased (-0.364851 --> -0.378365).  Saving model ...
Epoch: 5 cost time: 0.9474513530731201
Epoch: 5, Steps: 10 | Train Loss: 1.218 Vali Loss: 1.311 Vali Acc: 0.351 Test Loss: 1.311 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9089717864990234
Epoch: 6, Steps: 10 | Train Loss: 1.133 Vali Loss: 1.277 Vali Acc: 0.365 Test Loss: 1.277 Test Acc: 0.365
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.8391609191894531
Epoch: 7, Steps: 10 | Train Loss: 1.098 Vali Loss: 1.260 Vali Acc: 0.419 Test Loss: 1.260 Test Acc: 0.419
Validation loss decreased (-0.378365 --> -0.418906).  Saving model ...
Epoch: 8 cost time: 0.9307451248168945
Epoch: 8, Steps: 10 | Train Loss: 1.021 Vali Loss: 1.242 Vali Acc: 0.419 Test Loss: 1.242 Test Acc: 0.419
Validation loss decreased (-0.418906 --> -0.418907).  Saving model ...
Epoch: 9 cost time: 0.8757753372192383
Epoch: 9, Steps: 10 | Train Loss: 0.959 Vali Loss: 1.227 Vali Acc: 0.446 Test Loss: 1.227 Test Acc: 0.446
Validation loss decreased (-0.418907 --> -0.445934).  Saving model ...
Epoch: 10 cost time: 0.8929746150970459
Epoch: 10, Steps: 10 | Train Loss: 0.882 Vali Loss: 1.222 Vali Acc: 0.419 Test Loss: 1.222 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9596757888793945
Epoch: 11, Steps: 10 | Train Loss: 0.818 Vali Loss: 1.176 Vali Acc: 0.459 Test Loss: 1.176 Test Acc: 0.459
Validation loss decreased (-0.445934 --> -0.459448).  Saving model ...
Epoch: 12 cost time: 0.92716383934021
Epoch: 12, Steps: 10 | Train Loss: 0.758 Vali Loss: 1.182 Vali Acc: 0.459 Test Loss: 1.182 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9401845932006836
Epoch: 13, Steps: 10 | Train Loss: 0.707 Vali Loss: 1.150 Vali Acc: 0.527 Test Loss: 1.150 Test Acc: 0.527
Validation loss decreased (-0.459448 --> -0.527016).  Saving model ...
Epoch: 14 cost time: 0.9051835536956787
Epoch: 14, Steps: 10 | Train Loss: 0.635 Vali Loss: 1.154 Vali Acc: 0.514 Test Loss: 1.154 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9246208667755127
Epoch: 15, Steps: 10 | Train Loss: 0.571 Vali Loss: 1.147 Vali Acc: 0.554 Test Loss: 1.147 Test Acc: 0.554
Validation loss decreased (-0.527016 --> -0.554043).  Saving model ...
Epoch: 16 cost time: 0.9047462940216064
Epoch: 16, Steps: 10 | Train Loss: 0.501 Vali Loss: 1.113 Vali Acc: 0.541 Test Loss: 1.113 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8937599658966064
Epoch: 17, Steps: 10 | Train Loss: 0.457 Vali Loss: 1.113 Vali Acc: 0.554 Test Loss: 1.113 Test Acc: 0.554
Validation loss decreased (-0.554043 --> -0.554043).  Saving model ...
Epoch: 18 cost time: 0.9877068996429443
Epoch: 18, Steps: 10 | Train Loss: 0.398 Vali Loss: 1.105 Vali Acc: 0.568 Test Loss: 1.105 Test Acc: 0.568
Validation loss decreased (-0.554043 --> -0.567557).  Saving model ...
Epoch: 19 cost time: 0.934762716293335
Epoch: 19, Steps: 10 | Train Loss: 0.357 Vali Loss: 1.101 Vali Acc: 0.581 Test Loss: 1.101 Test Acc: 0.581
Validation loss decreased (-0.567557 --> -0.581070).  Saving model ...
Epoch: 20 cost time: 0.868767499923706
Epoch: 20, Steps: 10 | Train Loss: 0.318 Vali Loss: 1.095 Vali Acc: 0.581 Test Loss: 1.095 Test Acc: 0.581
Validation loss decreased (-0.581070 --> -0.581070).  Saving model ...
Epoch: 21 cost time: 0.9800460338592529
Epoch: 21, Steps: 10 | Train Loss: 0.274 Vali Loss: 1.097 Vali Acc: 0.568 Test Loss: 1.097 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.862274169921875
Epoch: 22, Steps: 10 | Train Loss: 0.248 Vali Loss: 1.102 Vali Acc: 0.595 Test Loss: 1.102 Test Acc: 0.595
Validation loss decreased (-0.581070 --> -0.594584).  Saving model ...
Epoch: 23 cost time: 0.8844869136810303
Epoch: 23, Steps: 10 | Train Loss: 0.209 Vali Loss: 1.111 Vali Acc: 0.554 Test Loss: 1.111 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9284257888793945
Epoch: 24, Steps: 10 | Train Loss: 0.180 Vali Loss: 1.098 Vali Acc: 0.595 Test Loss: 1.098 Test Acc: 0.595
Validation loss decreased (-0.594584 --> -0.594584).  Saving model ...
Epoch: 25 cost time: 0.9061133861541748
Epoch: 25, Steps: 10 | Train Loss: 0.153 Vali Loss: 1.117 Vali Acc: 0.541 Test Loss: 1.117 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9029419422149658
Epoch: 26, Steps: 10 | Train Loss: 0.141 Vali Loss: 1.140 Vali Acc: 0.527 Test Loss: 1.140 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.8672819137573242
Epoch: 27, Steps: 10 | Train Loss: 0.129 Vali Loss: 1.110 Vali Acc: 0.581 Test Loss: 1.110 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.9747235774993896
Epoch: 28, Steps: 10 | Train Loss: 0.109 Vali Loss: 1.134 Vali Acc: 0.541 Test Loss: 1.134 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.9176247119903564
Epoch: 29, Steps: 10 | Train Loss: 0.099 Vali Loss: 1.142 Vali Acc: 0.541 Test Loss: 1.142 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.9842262268066406
Epoch: 30, Steps: 10 | Train Loss: 0.088 Vali Loss: 1.121 Vali Acc: 0.554 Test Loss: 1.121 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_HandMovementDirection_TimesNet_UEA_ftM_sl400_ll0_pl0_el2_dm8_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 56292
model size : 0.38MB
