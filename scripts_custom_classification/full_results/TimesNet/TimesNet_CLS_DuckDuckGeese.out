Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm128_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 19.913498640060425
Epoch: 1, Steps: 4 | Train Loss: 1.689 Vali Loss: 1.605 Vali Acc: 0.200 Test Loss: 1.605 Test Acc: 0.200
Validation loss decreased (inf --> -0.199984).  Saving model ...
Epoch: 2 cost time: 17.702171564102173
Epoch: 2, Steps: 4 | Train Loss: 1.460 Vali Loss: 1.598 Vali Acc: 0.260 Test Loss: 1.598 Test Acc: 0.260
Validation loss decreased (-0.199984 --> -0.259984).  Saving model ...
Epoch: 3 cost time: 17.37887740135193
Epoch: 3, Steps: 4 | Train Loss: 1.114 Vali Loss: 1.558 Vali Acc: 0.340 Test Loss: 1.558 Test Acc: 0.340
Validation loss decreased (-0.259984 --> -0.339984).  Saving model ...
Epoch: 4 cost time: 15.678291082382202
Epoch: 4, Steps: 4 | Train Loss: 0.932 Vali Loss: 1.488 Vali Acc: 0.340 Test Loss: 1.488 Test Acc: 0.340
Validation loss decreased (-0.339984 --> -0.339985).  Saving model ...
Epoch: 5 cost time: 17.066580772399902
Epoch: 5, Steps: 4 | Train Loss: 0.738 Vali Loss: 1.359 Vali Acc: 0.380 Test Loss: 1.359 Test Acc: 0.380
Validation loss decreased (-0.339985 --> -0.379986).  Saving model ...
Epoch: 6 cost time: 18.001277208328247
Epoch: 6, Steps: 4 | Train Loss: 0.380 Vali Loss: 1.284 Vali Acc: 0.440 Test Loss: 1.284 Test Acc: 0.440
Validation loss decreased (-0.379986 --> -0.439987).  Saving model ...
Epoch: 7 cost time: 18.30890154838562
Epoch: 7, Steps: 4 | Train Loss: 0.410 Vali Loss: 1.268 Vali Acc: 0.480 Test Loss: 1.268 Test Acc: 0.480
Validation loss decreased (-0.439987 --> -0.479987).  Saving model ...
Epoch: 8 cost time: 18.728670358657837
Epoch: 8, Steps: 4 | Train Loss: 0.155 Vali Loss: 1.424 Vali Acc: 0.480 Test Loss: 1.424 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 17.870738983154297
Epoch: 9, Steps: 4 | Train Loss: 0.103 Vali Loss: 1.544 Vali Acc: 0.460 Test Loss: 1.544 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 18.301355600357056
Epoch: 10, Steps: 4 | Train Loss: 0.192 Vali Loss: 1.491 Vali Acc: 0.480 Test Loss: 1.491 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 18.290290355682373
Epoch: 11, Steps: 4 | Train Loss: 0.050 Vali Loss: 1.396 Vali Acc: 0.520 Test Loss: 1.396 Test Acc: 0.520
Validation loss decreased (-0.479987 --> -0.519986).  Saving model ...
Epoch: 12 cost time: 18.63434076309204
Epoch: 12, Steps: 4 | Train Loss: 0.053 Vali Loss: 1.748 Vali Acc: 0.500 Test Loss: 1.748 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 18.308584690093994
Epoch: 13, Steps: 4 | Train Loss: 0.207 Vali Loss: 2.162 Vali Acc: 0.460 Test Loss: 2.162 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 17.459598779678345
Epoch: 14, Steps: 4 | Train Loss: 0.064 Vali Loss: 1.950 Vali Acc: 0.480 Test Loss: 1.950 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 18.437352895736694
Epoch: 15, Steps: 4 | Train Loss: 0.013 Vali Loss: 1.719 Vali Acc: 0.540 Test Loss: 1.719 Test Acc: 0.540
Validation loss decreased (-0.519986 --> -0.539983).  Saving model ...
Epoch: 16 cost time: 18.572231769561768
Epoch: 16, Steps: 4 | Train Loss: 0.025 Vali Loss: 1.561 Vali Acc: 0.500 Test Loss: 1.561 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 18.69229245185852
Epoch: 17, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.496 Vali Acc: 0.500 Test Loss: 1.496 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 18.420878410339355
Epoch: 18, Steps: 4 | Train Loss: 0.006 Vali Loss: 1.700 Vali Acc: 0.520 Test Loss: 1.700 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 15.323468923568726
Epoch: 19, Steps: 4 | Train Loss: 0.004 Vali Loss: 2.065 Vali Acc: 0.520 Test Loss: 2.065 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 18.167054414749146
Epoch: 20, Steps: 4 | Train Loss: 0.004 Vali Loss: 2.150 Vali Acc: 0.540 Test Loss: 2.150 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 17.84668207168579
Epoch: 21, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.948 Vali Acc: 0.560 Test Loss: 1.948 Test Acc: 0.560
Validation loss decreased (-0.539983 --> -0.559981).  Saving model ...
Epoch: 22 cost time: 17.42657494544983
Epoch: 22, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.762 Vali Acc: 0.580 Test Loss: 1.762 Test Acc: 0.580
Validation loss decreased (-0.559981 --> -0.579982).  Saving model ...
Epoch: 23 cost time: 17.40841507911682
Epoch: 23, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.628 Vali Acc: 0.640 Test Loss: 1.628 Test Acc: 0.640
Validation loss decreased (-0.579982 --> -0.639984).  Saving model ...
Epoch: 24 cost time: 17.786714553833008
Epoch: 24, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.534 Vali Acc: 0.620 Test Loss: 1.534 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 17.82005262374878
Epoch: 25, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.541 Vali Acc: 0.600 Test Loss: 1.541 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 18.475826263427734
Epoch: 26, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.612 Vali Acc: 0.540 Test Loss: 1.612 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 18.0008704662323
Epoch: 27, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.753 Vali Acc: 0.560 Test Loss: 1.753 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 17.698044776916504
Epoch: 28, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.853 Vali Acc: 0.560 Test Loss: 1.853 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 16.07291007041931
Epoch: 29, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.893 Vali Acc: 0.540 Test Loss: 1.893 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 18.33584427833557
Epoch: 30, Steps: 4 | Train Loss: 0.000 Vali Loss: 1.859 Vali Acc: 0.540 Test Loss: 1.859 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm128_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.64
model parameter : 75672453
model size : 291.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm128_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 8.771894454956055
Epoch: 1, Steps: 4 | Train Loss: 1.764 Vali Loss: 1.597 Vali Acc: 0.260 Test Loss: 1.597 Test Acc: 0.260
Validation loss decreased (inf --> -0.259984).  Saving model ...
Epoch: 2 cost time: 7.33510684967041
Epoch: 2, Steps: 4 | Train Loss: 1.591 Vali Loss: 1.526 Vali Acc: 0.340 Test Loss: 1.526 Test Acc: 0.340
Validation loss decreased (-0.259984 --> -0.339985).  Saving model ...
Epoch: 3 cost time: 7.001126766204834
Epoch: 3, Steps: 4 | Train Loss: 1.575 Vali Loss: 1.431 Vali Acc: 0.440 Test Loss: 1.431 Test Acc: 0.440
Validation loss decreased (-0.339985 --> -0.439986).  Saving model ...
Epoch: 4 cost time: 7.263118505477905
Epoch: 4, Steps: 4 | Train Loss: 0.971 Vali Loss: 1.374 Vali Acc: 0.400 Test Loss: 1.374 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.992704153060913
Epoch: 5, Steps: 4 | Train Loss: 0.607 Vali Loss: 1.298 Vali Acc: 0.480 Test Loss: 1.298 Test Acc: 0.480
Validation loss decreased (-0.439986 --> -0.479987).  Saving model ...
Epoch: 6 cost time: 5.6527416706085205
Epoch: 6, Steps: 4 | Train Loss: 0.381 Vali Loss: 1.191 Vali Acc: 0.520 Test Loss: 1.191 Test Acc: 0.520
Validation loss decreased (-0.479987 --> -0.519988).  Saving model ...
Epoch: 7 cost time: 6.9366443157196045
Epoch: 7, Steps: 4 | Train Loss: 0.259 Vali Loss: 1.130 Vali Acc: 0.560 Test Loss: 1.130 Test Acc: 0.560
Validation loss decreased (-0.519988 --> -0.559989).  Saving model ...
Epoch: 8 cost time: 6.915765762329102
Epoch: 8, Steps: 4 | Train Loss: 0.182 Vali Loss: 1.228 Vali Acc: 0.520 Test Loss: 1.228 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 7.048689126968384
Epoch: 9, Steps: 4 | Train Loss: 0.179 Vali Loss: 1.348 Vali Acc: 0.520 Test Loss: 1.348 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.921799421310425
Epoch: 10, Steps: 4 | Train Loss: 0.116 Vali Loss: 1.186 Vali Acc: 0.580 Test Loss: 1.186 Test Acc: 0.580
Validation loss decreased (-0.559989 --> -0.579988).  Saving model ...
Epoch: 11 cost time: 7.133873462677002
Epoch: 11, Steps: 4 | Train Loss: 0.046 Vali Loss: 1.322 Vali Acc: 0.540 Test Loss: 1.322 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 7.02549147605896
Epoch: 12, Steps: 4 | Train Loss: 0.017 Vali Loss: 1.550 Vali Acc: 0.440 Test Loss: 1.550 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 7.0050671100616455
Epoch: 13, Steps: 4 | Train Loss: 0.018 Vali Loss: 1.651 Vali Acc: 0.500 Test Loss: 1.651 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 6.980561971664429
Epoch: 14, Steps: 4 | Train Loss: 0.009 Vali Loss: 1.565 Vali Acc: 0.500 Test Loss: 1.565 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 6.9745566844940186
Epoch: 15, Steps: 4 | Train Loss: 0.012 Vali Loss: 1.539 Vali Acc: 0.520 Test Loss: 1.539 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 7.155048131942749
Epoch: 16, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.620 Vali Acc: 0.520 Test Loss: 1.620 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 6.93478798866272
Epoch: 17, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.825 Vali Acc: 0.540 Test Loss: 1.825 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 7.124154329299927
Epoch: 18, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.649 Vali Acc: 0.500 Test Loss: 1.649 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 5.266289234161377
Epoch: 19, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.505 Vali Acc: 0.520 Test Loss: 1.505 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 6.198019742965698
Epoch: 20, Steps: 4 | Train Loss: 0.205 Vali Loss: 1.653 Vali Acc: 0.560 Test Loss: 1.653 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm128_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 22716293
model size : 89.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm128_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 14.684804677963257
Epoch: 1, Steps: 4 | Train Loss: 1.688 Vali Loss: 1.607 Vali Acc: 0.200 Test Loss: 1.607 Test Acc: 0.200
Validation loss decreased (inf --> -0.199984).  Saving model ...
Epoch: 2 cost time: 12.66120958328247
Epoch: 2, Steps: 4 | Train Loss: 1.458 Vali Loss: 1.602 Vali Acc: 0.260 Test Loss: 1.602 Test Acc: 0.260
Validation loss decreased (-0.199984 --> -0.259984).  Saving model ...
Epoch: 3 cost time: 13.292104721069336
Epoch: 3, Steps: 4 | Train Loss: 1.114 Vali Loss: 1.562 Vali Acc: 0.340 Test Loss: 1.562 Test Acc: 0.340
Validation loss decreased (-0.259984 --> -0.339984).  Saving model ...
Epoch: 4 cost time: 13.20540452003479
Epoch: 4, Steps: 4 | Train Loss: 0.926 Vali Loss: 1.491 Vali Acc: 0.360 Test Loss: 1.491 Test Acc: 0.360
Validation loss decreased (-0.339984 --> -0.359985).  Saving model ...
Epoch: 5 cost time: 12.820010900497437
Epoch: 5, Steps: 4 | Train Loss: 0.738 Vali Loss: 1.364 Vali Acc: 0.400 Test Loss: 1.364 Test Acc: 0.400
Validation loss decreased (-0.359985 --> -0.399986).  Saving model ...
Epoch: 6 cost time: 12.847978353500366
Epoch: 6, Steps: 4 | Train Loss: 0.379 Vali Loss: 1.286 Vali Acc: 0.480 Test Loss: 1.286 Test Acc: 0.480
Validation loss decreased (-0.399986 --> -0.479987).  Saving model ...
Epoch: 7 cost time: 12.812663078308105
Epoch: 7, Steps: 4 | Train Loss: 0.410 Vali Loss: 1.265 Vali Acc: 0.520 Test Loss: 1.265 Test Acc: 0.520
Validation loss decreased (-0.479987 --> -0.519987).  Saving model ...
Epoch: 8 cost time: 12.631048202514648
Epoch: 8, Steps: 4 | Train Loss: 0.154 Vali Loss: 1.420 Vali Acc: 0.480 Test Loss: 1.420 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 10.681841850280762
Epoch: 9, Steps: 4 | Train Loss: 0.103 Vali Loss: 1.518 Vali Acc: 0.440 Test Loss: 1.518 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 12.959870100021362
Epoch: 10, Steps: 4 | Train Loss: 0.193 Vali Loss: 1.446 Vali Acc: 0.460 Test Loss: 1.446 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 12.983378648757935
Epoch: 11, Steps: 4 | Train Loss: 0.051 Vali Loss: 1.318 Vali Acc: 0.520 Test Loss: 1.318 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 12.691792011260986
Epoch: 12, Steps: 4 | Train Loss: 0.050 Vali Loss: 1.678 Vali Acc: 0.540 Test Loss: 1.678 Test Acc: 0.540
Validation loss decreased (-0.519987 --> -0.539983).  Saving model ...
Epoch: 13 cost time: 12.981456756591797
Epoch: 13, Steps: 4 | Train Loss: 0.047 Vali Loss: 2.048 Vali Acc: 0.460 Test Loss: 2.048 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 13.013382196426392
Epoch: 14, Steps: 4 | Train Loss: 0.027 Vali Loss: 1.828 Vali Acc: 0.500 Test Loss: 1.828 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 13.23052167892456
Epoch: 15, Steps: 4 | Train Loss: 0.017 Vali Loss: 1.966 Vali Acc: 0.480 Test Loss: 1.966 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 13.04446005821228
Epoch: 16, Steps: 4 | Train Loss: 0.026 Vali Loss: 1.949 Vali Acc: 0.480 Test Loss: 1.949 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 13.023108720779419
Epoch: 17, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.030 Vali Acc: 0.500 Test Loss: 2.030 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 13.125328779220581
Epoch: 18, Steps: 4 | Train Loss: 0.007 Vali Loss: 2.200 Vali Acc: 0.460 Test Loss: 2.200 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 12.519867420196533
Epoch: 19, Steps: 4 | Train Loss: 0.004 Vali Loss: 2.364 Vali Acc: 0.460 Test Loss: 2.364 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 10.796491622924805
Epoch: 20, Steps: 4 | Train Loss: 0.003 Vali Loss: 2.221 Vali Acc: 0.500 Test Loss: 2.221 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 11.338077783584595
Epoch: 21, Steps: 4 | Train Loss: 0.002 Vali Loss: 2.130 Vali Acc: 0.500 Test Loss: 2.130 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 12.217615365982056
Epoch: 22, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.771 Vali Acc: 0.540 Test Loss: 1.771 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm128_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 75672453
model size : 291.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm128_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 6.660183906555176
Epoch: 1, Steps: 4 | Train Loss: 1.764 Vali Loss: 1.597 Vali Acc: 0.260 Test Loss: 1.597 Test Acc: 0.260
Validation loss decreased (inf --> -0.259984).  Saving model ...
Epoch: 2 cost time: 4.981167793273926
Epoch: 2, Steps: 4 | Train Loss: 1.591 Vali Loss: 1.528 Vali Acc: 0.340 Test Loss: 1.528 Test Acc: 0.340
Validation loss decreased (-0.259984 --> -0.339985).  Saving model ...
Epoch: 3 cost time: 4.905398368835449
Epoch: 3, Steps: 4 | Train Loss: 1.575 Vali Loss: 1.435 Vali Acc: 0.420 Test Loss: 1.435 Test Acc: 0.420
Validation loss decreased (-0.339985 --> -0.419986).  Saving model ...
Epoch: 4 cost time: 5.421195030212402
Epoch: 4, Steps: 4 | Train Loss: 0.971 Vali Loss: 1.384 Vali Acc: 0.380 Test Loss: 1.384 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.210275888442993
Epoch: 5, Steps: 4 | Train Loss: 0.607 Vali Loss: 1.311 Vali Acc: 0.460 Test Loss: 1.311 Test Acc: 0.460
Validation loss decreased (-0.419986 --> -0.459987).  Saving model ...
Epoch: 6 cost time: 5.233576536178589
Epoch: 6, Steps: 4 | Train Loss: 0.383 Vali Loss: 1.199 Vali Acc: 0.540 Test Loss: 1.199 Test Acc: 0.540
Validation loss decreased (-0.459987 --> -0.539988).  Saving model ...
Epoch: 7 cost time: 4.082232236862183
Epoch: 7, Steps: 4 | Train Loss: 0.261 Vali Loss: 1.132 Vali Acc: 0.580 Test Loss: 1.132 Test Acc: 0.580
Validation loss decreased (-0.539988 --> -0.579989).  Saving model ...
Epoch: 8 cost time: 5.395270347595215
Epoch: 8, Steps: 4 | Train Loss: 0.183 Vali Loss: 1.227 Vali Acc: 0.520 Test Loss: 1.227 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.143603563308716
Epoch: 9, Steps: 4 | Train Loss: 0.181 Vali Loss: 1.334 Vali Acc: 0.560 Test Loss: 1.334 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.328721523284912
Epoch: 10, Steps: 4 | Train Loss: 0.116 Vali Loss: 1.182 Vali Acc: 0.580 Test Loss: 1.182 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 5.533281087875366
Epoch: 11, Steps: 4 | Train Loss: 0.047 Vali Loss: 1.324 Vali Acc: 0.500 Test Loss: 1.324 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 5.609534978866577
Epoch: 12, Steps: 4 | Train Loss: 0.018 Vali Loss: 1.566 Vali Acc: 0.440 Test Loss: 1.566 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 5.61909818649292
Epoch: 13, Steps: 4 | Train Loss: 0.019 Vali Loss: 1.617 Vali Acc: 0.520 Test Loss: 1.617 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 5.7110278606414795
Epoch: 14, Steps: 4 | Train Loss: 0.008 Vali Loss: 1.520 Vali Acc: 0.520 Test Loss: 1.520 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 5.553445816040039
Epoch: 15, Steps: 4 | Train Loss: 0.012 Vali Loss: 1.474 Vali Acc: 0.560 Test Loss: 1.474 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 4.820257902145386
Epoch: 16, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.526 Vali Acc: 0.540 Test Loss: 1.526 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 5.81099009513855
Epoch: 17, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.717 Vali Acc: 0.540 Test Loss: 1.717 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm128_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 22716293
model size : 89.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm128_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 10.696835994720459
Epoch: 1, Steps: 4 | Train Loss: 1.688 Vali Loss: 1.602 Vali Acc: 0.200 Test Loss: 1.602 Test Acc: 0.200
Validation loss decreased (inf --> -0.199984).  Saving model ...
Epoch: 2 cost time: 8.988763332366943
Epoch: 2, Steps: 4 | Train Loss: 1.459 Vali Loss: 1.600 Vali Acc: 0.260 Test Loss: 1.600 Test Acc: 0.260
Validation loss decreased (-0.199984 --> -0.259984).  Saving model ...
Epoch: 3 cost time: 9.19541335105896
Epoch: 3, Steps: 4 | Train Loss: 1.123 Vali Loss: 1.566 Vali Acc: 0.320 Test Loss: 1.566 Test Acc: 0.320
Validation loss decreased (-0.259984 --> -0.319984).  Saving model ...
Epoch: 4 cost time: 8.80335807800293
Epoch: 4, Steps: 4 | Train Loss: 1.060 Vali Loss: 1.488 Vali Acc: 0.360 Test Loss: 1.488 Test Acc: 0.360
Validation loss decreased (-0.319984 --> -0.359985).  Saving model ...
Epoch: 5 cost time: 8.688711881637573
Epoch: 5, Steps: 4 | Train Loss: 0.737 Vali Loss: 1.341 Vali Acc: 0.380 Test Loss: 1.341 Test Acc: 0.380
Validation loss decreased (-0.359985 --> -0.379987).  Saving model ...
Epoch: 6 cost time: 9.207294702529907
Epoch: 6, Steps: 4 | Train Loss: 0.393 Vali Loss: 1.262 Vali Acc: 0.480 Test Loss: 1.262 Test Acc: 0.480
Validation loss decreased (-0.379987 --> -0.479987).  Saving model ...
Epoch: 7 cost time: 8.798688411712646
Epoch: 7, Steps: 4 | Train Loss: 0.429 Vali Loss: 1.215 Vali Acc: 0.500 Test Loss: 1.215 Test Acc: 0.500
Validation loss decreased (-0.479987 --> -0.499988).  Saving model ...
Epoch: 8 cost time: 8.661428451538086
Epoch: 8, Steps: 4 | Train Loss: 0.170 Vali Loss: 1.310 Vali Acc: 0.440 Test Loss: 1.310 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 9.18303894996643
Epoch: 9, Steps: 4 | Train Loss: 0.111 Vali Loss: 1.439 Vali Acc: 0.500 Test Loss: 1.439 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 8.756097555160522
Epoch: 10, Steps: 4 | Train Loss: 0.199 Vali Loss: 1.400 Vali Acc: 0.460 Test Loss: 1.400 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 9.077208518981934
Epoch: 11, Steps: 4 | Train Loss: 0.056 Vali Loss: 1.306 Vali Acc: 0.520 Test Loss: 1.306 Test Acc: 0.520
Validation loss decreased (-0.499988 --> -0.519987).  Saving model ...
Epoch: 12 cost time: 8.7707839012146
Epoch: 12, Steps: 4 | Train Loss: 0.048 Vali Loss: 1.501 Vali Acc: 0.420 Test Loss: 1.501 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.916231870651245
Epoch: 13, Steps: 4 | Train Loss: 0.049 Vali Loss: 1.620 Vali Acc: 0.440 Test Loss: 1.620 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 8.465205192565918
Epoch: 14, Steps: 4 | Train Loss: 0.024 Vali Loss: 1.441 Vali Acc: 0.440 Test Loss: 1.441 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 8.591256141662598
Epoch: 15, Steps: 4 | Train Loss: 0.019 Vali Loss: 1.712 Vali Acc: 0.460 Test Loss: 1.712 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 8.042921781539917
Epoch: 16, Steps: 4 | Train Loss: 0.031 Vali Loss: 1.787 Vali Acc: 0.480 Test Loss: 1.787 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 8.364320039749146
Epoch: 17, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.685 Vali Acc: 0.520 Test Loss: 1.685 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 8.0618155002594
Epoch: 18, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.659 Vali Acc: 0.500 Test Loss: 1.659 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 7.773310899734497
Epoch: 19, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.669 Vali Acc: 0.500 Test Loss: 1.669 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 8.092199563980103
Epoch: 20, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.738 Vali Acc: 0.520 Test Loss: 1.738 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 8.0979745388031
Epoch: 21, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.790 Vali Acc: 0.500 Test Loss: 1.790 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm128_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 75672453
model size : 291.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm128_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.161215305328369
Epoch: 1, Steps: 4 | Train Loss: 1.765 Vali Loss: 1.601 Vali Acc: 0.260 Test Loss: 1.601 Test Acc: 0.260
Validation loss decreased (inf --> -0.259984).  Saving model ...
Epoch: 2 cost time: 3.199754476547241
Epoch: 2, Steps: 4 | Train Loss: 1.591 Vali Loss: 1.532 Vali Acc: 0.340 Test Loss: 1.532 Test Acc: 0.340
Validation loss decreased (-0.259984 --> -0.339985).  Saving model ...
Epoch: 3 cost time: 3.9936156272888184
Epoch: 3, Steps: 4 | Train Loss: 1.586 Vali Loss: 1.440 Vali Acc: 0.400 Test Loss: 1.440 Test Acc: 0.400
Validation loss decreased (-0.339985 --> -0.399986).  Saving model ...
Epoch: 4 cost time: 3.6964359283447266
Epoch: 4, Steps: 4 | Train Loss: 0.986 Vali Loss: 1.386 Vali Acc: 0.380 Test Loss: 1.386 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.074337959289551
Epoch: 5, Steps: 4 | Train Loss: 0.625 Vali Loss: 1.306 Vali Acc: 0.440 Test Loss: 1.306 Test Acc: 0.440
Validation loss decreased (-0.399986 --> -0.439987).  Saving model ...
Epoch: 6 cost time: 3.872178077697754
Epoch: 6, Steps: 4 | Train Loss: 0.392 Vali Loss: 1.204 Vali Acc: 0.500 Test Loss: 1.204 Test Acc: 0.500
Validation loss decreased (-0.439987 --> -0.499988).  Saving model ...
Epoch: 7 cost time: 4.1530702114105225
Epoch: 7, Steps: 4 | Train Loss: 0.271 Vali Loss: 1.125 Vali Acc: 0.560 Test Loss: 1.125 Test Acc: 0.560
Validation loss decreased (-0.499988 --> -0.559989).  Saving model ...
Epoch: 8 cost time: 3.9842569828033447
Epoch: 8, Steps: 4 | Train Loss: 0.188 Vali Loss: 1.222 Vali Acc: 0.500 Test Loss: 1.222 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.0852696895599365
Epoch: 9, Steps: 4 | Train Loss: 0.196 Vali Loss: 1.323 Vali Acc: 0.560 Test Loss: 1.323 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.802481174468994
Epoch: 10, Steps: 4 | Train Loss: 0.124 Vali Loss: 1.182 Vali Acc: 0.560 Test Loss: 1.182 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.103126049041748
Epoch: 11, Steps: 4 | Train Loss: 0.053 Vali Loss: 1.306 Vali Acc: 0.500 Test Loss: 1.306 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.8649890422821045
Epoch: 12, Steps: 4 | Train Loss: 0.020 Vali Loss: 1.555 Vali Acc: 0.480 Test Loss: 1.555 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.587451934814453
Epoch: 13, Steps: 4 | Train Loss: 0.025 Vali Loss: 1.662 Vali Acc: 0.480 Test Loss: 1.662 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.112726926803589
Epoch: 14, Steps: 4 | Train Loss: 0.009 Vali Loss: 1.581 Vali Acc: 0.520 Test Loss: 1.581 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.5262436866760254
Epoch: 15, Steps: 4 | Train Loss: 0.014 Vali Loss: 1.552 Vali Acc: 0.520 Test Loss: 1.552 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 4.163317918777466
Epoch: 16, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.534 Vali Acc: 0.520 Test Loss: 1.534 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.809821128845215
Epoch: 17, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.707 Vali Acc: 0.520 Test Loss: 1.707 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm128_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 22716293
model size : 89.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm128_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 11.851418733596802
Epoch: 1, Steps: 4 | Train Loss: 1.783 Vali Loss: 1.592 Vali Acc: 0.240 Test Loss: 1.592 Test Acc: 0.240
Validation loss decreased (inf --> -0.239984).  Saving model ...
Epoch: 2 cost time: 10.226303339004517
Epoch: 2, Steps: 4 | Train Loss: 1.605 Vali Loss: 1.561 Vali Acc: 0.260 Test Loss: 1.561 Test Acc: 0.260
Validation loss decreased (-0.239984 --> -0.259984).  Saving model ...
Epoch: 3 cost time: 8.357001781463623
Epoch: 3, Steps: 4 | Train Loss: 1.314 Vali Loss: 1.472 Vali Acc: 0.360 Test Loss: 1.472 Test Acc: 0.360
Validation loss decreased (-0.259984 --> -0.359985).  Saving model ...
Epoch: 4 cost time: 10.090040445327759
Epoch: 4, Steps: 4 | Train Loss: 1.003 Vali Loss: 1.339 Vali Acc: 0.420 Test Loss: 1.339 Test Acc: 0.420
Validation loss decreased (-0.359985 --> -0.419987).  Saving model ...
Epoch: 5 cost time: 9.872073411941528
Epoch: 5, Steps: 4 | Train Loss: 0.702 Vali Loss: 1.307 Vali Acc: 0.500 Test Loss: 1.307 Test Acc: 0.500
Validation loss decreased (-0.419987 --> -0.499987).  Saving model ...
Epoch: 6 cost time: 9.98414659500122
Epoch: 6, Steps: 4 | Train Loss: 0.467 Vali Loss: 1.328 Vali Acc: 0.520 Test Loss: 1.328 Test Acc: 0.520
Validation loss decreased (-0.499987 --> -0.519987).  Saving model ...
Epoch: 7 cost time: 10.007187604904175
Epoch: 7, Steps: 4 | Train Loss: 0.335 Vali Loss: 1.398 Vali Acc: 0.520 Test Loss: 1.398 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 9.882805109024048
Epoch: 8, Steps: 4 | Train Loss: 0.208 Vali Loss: 1.296 Vali Acc: 0.540 Test Loss: 1.296 Test Acc: 0.540
Validation loss decreased (-0.519987 --> -0.539987).  Saving model ...
Epoch: 9 cost time: 10.046619892120361
Epoch: 9, Steps: 4 | Train Loss: 0.187 Vali Loss: 1.335 Vali Acc: 0.500 Test Loss: 1.335 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 9.988494157791138
Epoch: 10, Steps: 4 | Train Loss: 0.088 Vali Loss: 1.474 Vali Acc: 0.520 Test Loss: 1.474 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 8.896995544433594
Epoch: 11, Steps: 4 | Train Loss: 0.073 Vali Loss: 1.566 Vali Acc: 0.520 Test Loss: 1.566 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 9.890705823898315
Epoch: 12, Steps: 4 | Train Loss: 0.081 Vali Loss: 1.486 Vali Acc: 0.520 Test Loss: 1.486 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 9.802958488464355
Epoch: 13, Steps: 4 | Train Loss: 0.068 Vali Loss: 1.610 Vali Acc: 0.500 Test Loss: 1.610 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 9.409678220748901
Epoch: 14, Steps: 4 | Train Loss: 0.024 Vali Loss: 1.506 Vali Acc: 0.460 Test Loss: 1.506 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 9.455866575241089
Epoch: 15, Steps: 4 | Train Loss: 0.030 Vali Loss: 1.534 Vali Acc: 0.460 Test Loss: 1.534 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 9.724246978759766
Epoch: 16, Steps: 4 | Train Loss: 0.007 Vali Loss: 1.862 Vali Acc: 0.440 Test Loss: 1.862 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 9.725086450576782
Epoch: 17, Steps: 4 | Train Loss: 0.008 Vali Loss: 1.613 Vali Acc: 0.500 Test Loss: 1.613 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 9.014355659484863
Epoch: 18, Steps: 4 | Train Loss: 0.007 Vali Loss: 1.724 Vali Acc: 0.540 Test Loss: 1.724 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm128_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 38182789
model size : 148.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm128_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 5.902184247970581
Epoch: 1, Steps: 4 | Train Loss: 1.529 Vali Loss: 1.563 Vali Acc: 0.220 Test Loss: 1.563 Test Acc: 0.220
Validation loss decreased (inf --> -0.219984).  Saving model ...
Epoch: 2 cost time: 3.661332845687866
Epoch: 2, Steps: 4 | Train Loss: 1.588 Vali Loss: 1.521 Vali Acc: 0.240 Test Loss: 1.521 Test Acc: 0.240
Validation loss decreased (-0.219984 --> -0.239985).  Saving model ...
Epoch: 3 cost time: 4.126924991607666
Epoch: 3, Steps: 4 | Train Loss: 1.125 Vali Loss: 1.510 Vali Acc: 0.420 Test Loss: 1.510 Test Acc: 0.420
Validation loss decreased (-0.239985 --> -0.419985).  Saving model ...
Epoch: 4 cost time: 4.261501789093018
Epoch: 4, Steps: 4 | Train Loss: 1.054 Vali Loss: 1.489 Vali Acc: 0.380 Test Loss: 1.489 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.243210077285767
Epoch: 5, Steps: 4 | Train Loss: 0.744 Vali Loss: 1.351 Vali Acc: 0.520 Test Loss: 1.351 Test Acc: 0.520
Validation loss decreased (-0.419985 --> -0.519986).  Saving model ...
Epoch: 6 cost time: 4.002173185348511
Epoch: 6, Steps: 4 | Train Loss: 0.552 Vali Loss: 1.216 Vali Acc: 0.540 Test Loss: 1.216 Test Acc: 0.540
Validation loss decreased (-0.519986 --> -0.539988).  Saving model ...
Epoch: 7 cost time: 3.2383081912994385
Epoch: 7, Steps: 4 | Train Loss: 0.321 Vali Loss: 1.288 Vali Acc: 0.500 Test Loss: 1.288 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.233209133148193
Epoch: 8, Steps: 4 | Train Loss: 0.194 Vali Loss: 1.212 Vali Acc: 0.540 Test Loss: 1.212 Test Acc: 0.540
Validation loss decreased (-0.539988 --> -0.539988).  Saving model ...
Epoch: 9 cost time: 4.318675518035889
Epoch: 9, Steps: 4 | Train Loss: 0.173 Vali Loss: 1.152 Vali Acc: 0.620 Test Loss: 1.152 Test Acc: 0.620
Validation loss decreased (-0.539988 --> -0.619988).  Saving model ...
Epoch: 10 cost time: 3.9026143550872803
Epoch: 10, Steps: 4 | Train Loss: 0.094 Vali Loss: 1.428 Vali Acc: 0.520 Test Loss: 1.428 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.145282745361328
Epoch: 11, Steps: 4 | Train Loss: 0.092 Vali Loss: 1.482 Vali Acc: 0.540 Test Loss: 1.482 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.089533090591431
Epoch: 12, Steps: 4 | Train Loss: 0.054 Vali Loss: 1.285 Vali Acc: 0.600 Test Loss: 1.285 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.109848737716675
Epoch: 13, Steps: 4 | Train Loss: 0.037 Vali Loss: 1.320 Vali Acc: 0.580 Test Loss: 1.320 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.260181427001953
Epoch: 14, Steps: 4 | Train Loss: 0.020 Vali Loss: 1.498 Vali Acc: 0.500 Test Loss: 1.498 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.004472017288208
Epoch: 15, Steps: 4 | Train Loss: 0.012 Vali Loss: 1.372 Vali Acc: 0.580 Test Loss: 1.372 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.4266481399536133
Epoch: 16, Steps: 4 | Train Loss: 0.008 Vali Loss: 1.497 Vali Acc: 0.600 Test Loss: 1.497 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.7574589252471924
Epoch: 17, Steps: 4 | Train Loss: 0.012 Vali Loss: 1.441 Vali Acc: 0.560 Test Loss: 1.441 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 4.665502548217773
Epoch: 18, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.394 Vali Acc: 0.480 Test Loss: 1.394 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 4.475882291793823
Epoch: 19, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.625 Vali Acc: 0.500 Test Loss: 1.625 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm128_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.62
model parameter : 11704197
model size : 47.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm128_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 9.812160968780518
Epoch: 1, Steps: 4 | Train Loss: 1.784 Vali Loss: 1.593 Vali Acc: 0.240 Test Loss: 1.593 Test Acc: 0.240
Validation loss decreased (inf --> -0.239984).  Saving model ...
Epoch: 2 cost time: 7.999703407287598
Epoch: 2, Steps: 4 | Train Loss: 1.605 Vali Loss: 1.563 Vali Acc: 0.260 Test Loss: 1.563 Test Acc: 0.260
Validation loss decreased (-0.239984 --> -0.259984).  Saving model ...
Epoch: 3 cost time: 7.778605937957764
Epoch: 3, Steps: 4 | Train Loss: 1.333 Vali Loss: 1.475 Vali Acc: 0.360 Test Loss: 1.475 Test Acc: 0.360
Validation loss decreased (-0.259984 --> -0.359985).  Saving model ...
Epoch: 4 cost time: 8.35080599784851
Epoch: 4, Steps: 4 | Train Loss: 1.002 Vali Loss: 1.346 Vali Acc: 0.420 Test Loss: 1.346 Test Acc: 0.420
Validation loss decreased (-0.359985 --> -0.419987).  Saving model ...
Epoch: 5 cost time: 7.521512269973755
Epoch: 5, Steps: 4 | Train Loss: 0.702 Vali Loss: 1.313 Vali Acc: 0.500 Test Loss: 1.313 Test Acc: 0.500
Validation loss decreased (-0.419987 --> -0.499987).  Saving model ...
Epoch: 6 cost time: 8.202792882919312
Epoch: 6, Steps: 4 | Train Loss: 0.467 Vali Loss: 1.342 Vali Acc: 0.520 Test Loss: 1.342 Test Acc: 0.520
Validation loss decreased (-0.499987 --> -0.519987).  Saving model ...
Epoch: 7 cost time: 7.653076410293579
Epoch: 7, Steps: 4 | Train Loss: 0.334 Vali Loss: 1.416 Vali Acc: 0.500 Test Loss: 1.416 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 8.204419136047363
Epoch: 8, Steps: 4 | Train Loss: 0.208 Vali Loss: 1.318 Vali Acc: 0.520 Test Loss: 1.318 Test Acc: 0.520
Validation loss decreased (-0.519987 --> -0.519987).  Saving model ...
Epoch: 9 cost time: 7.556581974029541
Epoch: 9, Steps: 4 | Train Loss: 0.187 Vali Loss: 1.360 Vali Acc: 0.500 Test Loss: 1.360 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 8.242491006851196
Epoch: 10, Steps: 4 | Train Loss: 0.088 Vali Loss: 1.492 Vali Acc: 0.520 Test Loss: 1.492 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 7.589793920516968
Epoch: 11, Steps: 4 | Train Loss: 0.073 Vali Loss: 1.610 Vali Acc: 0.500 Test Loss: 1.610 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 8.33191442489624
Epoch: 12, Steps: 4 | Train Loss: 0.080 Vali Loss: 1.524 Vali Acc: 0.500 Test Loss: 1.524 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 7.4556872844696045
Epoch: 13, Steps: 4 | Train Loss: 0.084 Vali Loss: 1.626 Vali Acc: 0.480 Test Loss: 1.626 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 7.98634672164917
Epoch: 14, Steps: 4 | Train Loss: 0.024 Vali Loss: 1.481 Vali Acc: 0.440 Test Loss: 1.481 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 7.528360605239868
Epoch: 15, Steps: 4 | Train Loss: 0.029 Vali Loss: 1.454 Vali Acc: 0.480 Test Loss: 1.454 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 7.884549379348755
Epoch: 16, Steps: 4 | Train Loss: 0.008 Vali Loss: 1.821 Vali Acc: 0.460 Test Loss: 1.821 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 7.578166961669922
Epoch: 17, Steps: 4 | Train Loss: 0.009 Vali Loss: 1.542 Vali Acc: 0.520 Test Loss: 1.542 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 6.711968660354614
Epoch: 18, Steps: 4 | Train Loss: 0.007 Vali Loss: 1.655 Vali Acc: 0.520 Test Loss: 1.655 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm128_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 38182789
model size : 148.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm128_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 5.3187737464904785
Epoch: 1, Steps: 4 | Train Loss: 1.529 Vali Loss: 1.563 Vali Acc: 0.220 Test Loss: 1.563 Test Acc: 0.220
Validation loss decreased (inf --> -0.219984).  Saving model ...
Epoch: 2 cost time: 3.2666053771972656
Epoch: 2, Steps: 4 | Train Loss: 1.589 Vali Loss: 1.521 Vali Acc: 0.240 Test Loss: 1.521 Test Acc: 0.240
Validation loss decreased (-0.219984 --> -0.239985).  Saving model ...
Epoch: 3 cost time: 3.5752620697021484
Epoch: 3, Steps: 4 | Train Loss: 1.124 Vali Loss: 1.510 Vali Acc: 0.440 Test Loss: 1.510 Test Acc: 0.440
Validation loss decreased (-0.239985 --> -0.439985).  Saving model ...
Epoch: 4 cost time: 3.1837682723999023
Epoch: 4, Steps: 4 | Train Loss: 1.052 Vali Loss: 1.488 Vali Acc: 0.380 Test Loss: 1.488 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.367539882659912
Epoch: 5, Steps: 4 | Train Loss: 0.742 Vali Loss: 1.352 Vali Acc: 0.520 Test Loss: 1.352 Test Acc: 0.520
Validation loss decreased (-0.439985 --> -0.519986).  Saving model ...
Epoch: 6 cost time: 3.5255649089813232
Epoch: 6, Steps: 4 | Train Loss: 0.542 Vali Loss: 1.218 Vali Acc: 0.540 Test Loss: 1.218 Test Acc: 0.540
Validation loss decreased (-0.519986 --> -0.539988).  Saving model ...
Epoch: 7 cost time: 3.2946665287017822
Epoch: 7, Steps: 4 | Train Loss: 0.321 Vali Loss: 1.299 Vali Acc: 0.480 Test Loss: 1.299 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.4910194873809814
Epoch: 8, Steps: 4 | Train Loss: 0.192 Vali Loss: 1.213 Vali Acc: 0.500 Test Loss: 1.213 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.22689151763916
Epoch: 9, Steps: 4 | Train Loss: 0.175 Vali Loss: 1.158 Vali Acc: 0.620 Test Loss: 1.158 Test Acc: 0.620
Validation loss decreased (-0.539988 --> -0.619988).  Saving model ...
Epoch: 10 cost time: 3.3474905490875244
Epoch: 10, Steps: 4 | Train Loss: 0.094 Vali Loss: 1.439 Vali Acc: 0.520 Test Loss: 1.439 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.502488374710083
Epoch: 11, Steps: 4 | Train Loss: 0.096 Vali Loss: 1.490 Vali Acc: 0.540 Test Loss: 1.490 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.2334864139556885
Epoch: 12, Steps: 4 | Train Loss: 0.053 Vali Loss: 1.281 Vali Acc: 0.620 Test Loss: 1.281 Test Acc: 0.620
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.665262460708618
Epoch: 13, Steps: 4 | Train Loss: 0.028 Vali Loss: 1.302 Vali Acc: 0.540 Test Loss: 1.302 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.2549238204956055
Epoch: 14, Steps: 4 | Train Loss: 0.018 Vali Loss: 1.374 Vali Acc: 0.520 Test Loss: 1.374 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.6026721000671387
Epoch: 15, Steps: 4 | Train Loss: 0.010 Vali Loss: 1.436 Vali Acc: 0.540 Test Loss: 1.436 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.2174038887023926
Epoch: 16, Steps: 4 | Train Loss: 0.008 Vali Loss: 1.611 Vali Acc: 0.560 Test Loss: 1.611 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.423065185546875
Epoch: 17, Steps: 4 | Train Loss: 0.008 Vali Loss: 1.592 Vali Acc: 0.500 Test Loss: 1.592 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 3.3270840644836426
Epoch: 18, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.401 Vali Acc: 0.540 Test Loss: 1.401 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.4217352867126465
Epoch: 19, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.459 Vali Acc: 0.540 Test Loss: 1.459 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm128_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.62
model parameter : 11704197
model size : 47.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm128_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 6.66303277015686
Epoch: 1, Steps: 4 | Train Loss: 1.784 Vali Loss: 1.595 Vali Acc: 0.240 Test Loss: 1.595 Test Acc: 0.240
Validation loss decreased (inf --> -0.239984).  Saving model ...
Epoch: 2 cost time: 5.0892860889434814
Epoch: 2, Steps: 4 | Train Loss: 1.606 Vali Loss: 1.566 Vali Acc: 0.260 Test Loss: 1.566 Test Acc: 0.260
Validation loss decreased (-0.239984 --> -0.259984).  Saving model ...
Epoch: 3 cost time: 5.448432683944702
Epoch: 3, Steps: 4 | Train Loss: 1.336 Vali Loss: 1.480 Vali Acc: 0.380 Test Loss: 1.480 Test Acc: 0.380
Validation loss decreased (-0.259984 --> -0.379985).  Saving model ...
Epoch: 4 cost time: 5.30797266960144
Epoch: 4, Steps: 4 | Train Loss: 1.017 Vali Loss: 1.351 Vali Acc: 0.400 Test Loss: 1.351 Test Acc: 0.400
Validation loss decreased (-0.379985 --> -0.399986).  Saving model ...
Epoch: 5 cost time: 5.315311431884766
Epoch: 5, Steps: 4 | Train Loss: 0.719 Vali Loss: 1.310 Vali Acc: 0.480 Test Loss: 1.310 Test Acc: 0.480
Validation loss decreased (-0.399986 --> -0.479987).  Saving model ...
Epoch: 6 cost time: 4.803483963012695
Epoch: 6, Steps: 4 | Train Loss: 0.490 Vali Loss: 1.318 Vali Acc: 0.500 Test Loss: 1.318 Test Acc: 0.500
Validation loss decreased (-0.479987 --> -0.499987).  Saving model ...
Epoch: 7 cost time: 5.100651979446411
Epoch: 7, Steps: 4 | Train Loss: 0.330 Vali Loss: 1.371 Vali Acc: 0.460 Test Loss: 1.371 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.864665269851685
Epoch: 8, Steps: 4 | Train Loss: 0.215 Vali Loss: 1.278 Vali Acc: 0.520 Test Loss: 1.278 Test Acc: 0.520
Validation loss decreased (-0.499987 --> -0.519987).  Saving model ...
Epoch: 9 cost time: 4.979706525802612
Epoch: 9, Steps: 4 | Train Loss: 0.195 Vali Loss: 1.325 Vali Acc: 0.540 Test Loss: 1.325 Test Acc: 0.540
Validation loss decreased (-0.519987 --> -0.539987).  Saving model ...
Epoch: 10 cost time: 4.833271503448486
Epoch: 10, Steps: 4 | Train Loss: 0.090 Vali Loss: 1.442 Vali Acc: 0.520 Test Loss: 1.442 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.240612983703613
Epoch: 11, Steps: 4 | Train Loss: 0.090 Vali Loss: 1.589 Vali Acc: 0.500 Test Loss: 1.589 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.091578960418701
Epoch: 12, Steps: 4 | Train Loss: 0.094 Vali Loss: 1.460 Vali Acc: 0.500 Test Loss: 1.460 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.12469744682312
Epoch: 13, Steps: 4 | Train Loss: 0.033 Vali Loss: 1.648 Vali Acc: 0.440 Test Loss: 1.648 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.799516439437866
Epoch: 14, Steps: 4 | Train Loss: 0.020 Vali Loss: 1.425 Vali Acc: 0.420 Test Loss: 1.425 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.843679428100586
Epoch: 15, Steps: 4 | Train Loss: 0.019 Vali Loss: 1.499 Vali Acc: 0.540 Test Loss: 1.499 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.169832468032837
Epoch: 16, Steps: 4 | Train Loss: 0.032 Vali Loss: 1.754 Vali Acc: 0.500 Test Loss: 1.754 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.943615436553955
Epoch: 17, Steps: 4 | Train Loss: 0.016 Vali Loss: 1.913 Vali Acc: 0.480 Test Loss: 1.913 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 5.246232032775879
Epoch: 18, Steps: 4 | Train Loss: 0.010 Vali Loss: 2.351 Vali Acc: 0.480 Test Loss: 2.351 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 5.092285394668579
Epoch: 19, Steps: 4 | Train Loss: 0.010 Vali Loss: 2.457 Vali Acc: 0.500 Test Loss: 2.457 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm128_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 38182789
model size : 148.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm128_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.1752400398254395
Epoch: 1, Steps: 4 | Train Loss: 1.545 Vali Loss: 1.559 Vali Acc: 0.220 Test Loss: 1.559 Test Acc: 0.220
Validation loss decreased (inf --> -0.219984).  Saving model ...
Epoch: 2 cost time: 2.228080987930298
Epoch: 2, Steps: 4 | Train Loss: 1.594 Vali Loss: 1.518 Vali Acc: 0.240 Test Loss: 1.518 Test Acc: 0.240
Validation loss decreased (-0.219984 --> -0.239985).  Saving model ...
Epoch: 3 cost time: 2.280414581298828
Epoch: 3, Steps: 4 | Train Loss: 1.147 Vali Loss: 1.509 Vali Acc: 0.440 Test Loss: 1.509 Test Acc: 0.440
Validation loss decreased (-0.239985 --> -0.439985).  Saving model ...
Epoch: 4 cost time: 2.644723892211914
Epoch: 4, Steps: 4 | Train Loss: 1.060 Vali Loss: 1.486 Vali Acc: 0.380 Test Loss: 1.486 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.577199935913086
Epoch: 5, Steps: 4 | Train Loss: 0.744 Vali Loss: 1.348 Vali Acc: 0.500 Test Loss: 1.348 Test Acc: 0.500
Validation loss decreased (-0.439985 --> -0.499987).  Saving model ...
Epoch: 6 cost time: 2.5502052307128906
Epoch: 6, Steps: 4 | Train Loss: 0.543 Vali Loss: 1.214 Vali Acc: 0.520 Test Loss: 1.214 Test Acc: 0.520
Validation loss decreased (-0.499987 --> -0.519988).  Saving model ...
Epoch: 7 cost time: 2.563828468322754
Epoch: 7, Steps: 4 | Train Loss: 0.326 Vali Loss: 1.295 Vali Acc: 0.500 Test Loss: 1.295 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.7249159812927246
Epoch: 8, Steps: 4 | Train Loss: 0.198 Vali Loss: 1.186 Vali Acc: 0.460 Test Loss: 1.186 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.5296120643615723
Epoch: 9, Steps: 4 | Train Loss: 0.180 Vali Loss: 1.134 Vali Acc: 0.580 Test Loss: 1.134 Test Acc: 0.580
Validation loss decreased (-0.519988 --> -0.579989).  Saving model ...
Epoch: 10 cost time: 2.698801279067993
Epoch: 10, Steps: 4 | Train Loss: 0.100 Vali Loss: 1.446 Vali Acc: 0.520 Test Loss: 1.446 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.6242425441741943
Epoch: 11, Steps: 4 | Train Loss: 0.092 Vali Loss: 1.478 Vali Acc: 0.500 Test Loss: 1.478 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.715026617050171
Epoch: 12, Steps: 4 | Train Loss: 0.055 Vali Loss: 1.268 Vali Acc: 0.560 Test Loss: 1.268 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.5166802406311035
Epoch: 13, Steps: 4 | Train Loss: 0.028 Vali Loss: 1.298 Vali Acc: 0.540 Test Loss: 1.298 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.6505184173583984
Epoch: 14, Steps: 4 | Train Loss: 0.017 Vali Loss: 1.373 Vali Acc: 0.500 Test Loss: 1.373 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.7490277290344238
Epoch: 15, Steps: 4 | Train Loss: 0.010 Vali Loss: 1.486 Vali Acc: 0.500 Test Loss: 1.486 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.1813864707946777
Epoch: 16, Steps: 4 | Train Loss: 0.009 Vali Loss: 1.658 Vali Acc: 0.480 Test Loss: 1.658 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.245615243911743
Epoch: 17, Steps: 4 | Train Loss: 0.014 Vali Loss: 1.496 Vali Acc: 0.460 Test Loss: 1.496 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.8791542053222656
Epoch: 18, Steps: 4 | Train Loss: 0.007 Vali Loss: 1.418 Vali Acc: 0.460 Test Loss: 1.418 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.684934139251709
Epoch: 19, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.723 Vali Acc: 0.500 Test Loss: 1.723 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm128_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 11704197
model size : 47.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm64_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 13.585525274276733
Epoch: 1, Steps: 4 | Train Loss: 1.667 Vali Loss: 1.698 Vali Acc: 0.240 Test Loss: 1.698 Test Acc: 0.240
Validation loss decreased (inf --> -0.239983).  Saving model ...
Epoch: 2 cost time: 11.121508836746216
Epoch: 2, Steps: 4 | Train Loss: 1.574 Vali Loss: 1.674 Vali Acc: 0.320 Test Loss: 1.674 Test Acc: 0.320
Validation loss decreased (-0.239983 --> -0.319983).  Saving model ...
Epoch: 3 cost time: 10.576268672943115
Epoch: 3, Steps: 4 | Train Loss: 1.279 Vali Loss: 1.645 Vali Acc: 0.300 Test Loss: 1.645 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 11.973642110824585
Epoch: 4, Steps: 4 | Train Loss: 1.241 Vali Loss: 1.610 Vali Acc: 0.400 Test Loss: 1.610 Test Acc: 0.400
Validation loss decreased (-0.319983 --> -0.399984).  Saving model ...
Epoch: 5 cost time: 11.812784194946289
Epoch: 5, Steps: 4 | Train Loss: 0.957 Vali Loss: 1.548 Vali Acc: 0.400 Test Loss: 1.548 Test Acc: 0.400
Validation loss decreased (-0.399984 --> -0.399985).  Saving model ...
Epoch: 6 cost time: 11.903145551681519
Epoch: 6, Steps: 4 | Train Loss: 0.966 Vali Loss: 1.477 Vali Acc: 0.440 Test Loss: 1.477 Test Acc: 0.440
Validation loss decreased (-0.399985 --> -0.439985).  Saving model ...
Epoch: 7 cost time: 10.84940242767334
Epoch: 7, Steps: 4 | Train Loss: 0.671 Vali Loss: 1.384 Vali Acc: 0.460 Test Loss: 1.384 Test Acc: 0.460
Validation loss decreased (-0.439985 --> -0.459986).  Saving model ...
Epoch: 8 cost time: 11.22685432434082
Epoch: 8, Steps: 4 | Train Loss: 0.439 Vali Loss: 1.354 Vali Acc: 0.520 Test Loss: 1.354 Test Acc: 0.520
Validation loss decreased (-0.459986 --> -0.519986).  Saving model ...
Epoch: 9 cost time: 11.22249960899353
Epoch: 9, Steps: 4 | Train Loss: 0.289 Vali Loss: 1.119 Vali Acc: 0.600 Test Loss: 1.119 Test Acc: 0.600
Validation loss decreased (-0.519986 --> -0.599989).  Saving model ...
Epoch: 10 cost time: 11.621664047241211
Epoch: 10, Steps: 4 | Train Loss: 0.277 Vali Loss: 1.065 Vali Acc: 0.600 Test Loss: 1.065 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 11 cost time: 12.106072664260864
Epoch: 11, Steps: 4 | Train Loss: 0.145 Vali Loss: 1.266 Vali Acc: 0.520 Test Loss: 1.266 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 9.830913305282593
Epoch: 12, Steps: 4 | Train Loss: 0.159 Vali Loss: 1.179 Vali Acc: 0.580 Test Loss: 1.179 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 11.17865252494812
Epoch: 13, Steps: 4 | Train Loss: 0.182 Vali Loss: 1.132 Vali Acc: 0.580 Test Loss: 1.132 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 11.25926661491394
Epoch: 14, Steps: 4 | Train Loss: 0.046 Vali Loss: 1.170 Vali Acc: 0.520 Test Loss: 1.170 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 10.989123821258545
Epoch: 15, Steps: 4 | Train Loss: 0.051 Vali Loss: 1.386 Vali Acc: 0.560 Test Loss: 1.386 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 11.303950309753418
Epoch: 16, Steps: 4 | Train Loss: 0.073 Vali Loss: 1.365 Vali Acc: 0.560 Test Loss: 1.365 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 11.068720817565918
Epoch: 17, Steps: 4 | Train Loss: 0.019 Vali Loss: 1.382 Vali Acc: 0.460 Test Loss: 1.382 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 11.169652938842773
Epoch: 18, Steps: 4 | Train Loss: 0.018 Vali Loss: 1.574 Vali Acc: 0.520 Test Loss: 1.574 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 10.42814302444458
Epoch: 19, Steps: 4 | Train Loss: 0.012 Vali Loss: 1.670 Vali Acc: 0.480 Test Loss: 1.670 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 8.381491661071777
Epoch: 20, Steps: 4 | Train Loss: 0.014 Vali Loss: 1.628 Vali Acc: 0.460 Test Loss: 1.628 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm64_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 37839301
model size : 145.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm64_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 5.762734651565552
Epoch: 1, Steps: 4 | Train Loss: 1.577 Vali Loss: 1.654 Vali Acc: 0.160 Test Loss: 1.654 Test Acc: 0.160
Validation loss decreased (inf --> -0.159983).  Saving model ...
Epoch: 2 cost time: 3.9222471714019775
Epoch: 2, Steps: 4 | Train Loss: 1.530 Vali Loss: 1.639 Vali Acc: 0.280 Test Loss: 1.639 Test Acc: 0.280
Validation loss decreased (-0.159983 --> -0.279984).  Saving model ...
Epoch: 3 cost time: 4.6615283489227295
Epoch: 3, Steps: 4 | Train Loss: 1.333 Vali Loss: 1.628 Vali Acc: 0.300 Test Loss: 1.628 Test Acc: 0.300
Validation loss decreased (-0.279984 --> -0.299984).  Saving model ...
Epoch: 4 cost time: 5.06923246383667
Epoch: 4, Steps: 4 | Train Loss: 1.061 Vali Loss: 1.595 Vali Acc: 0.360 Test Loss: 1.595 Test Acc: 0.360
Validation loss decreased (-0.299984 --> -0.359984).  Saving model ...
Epoch: 5 cost time: 4.614815950393677
Epoch: 5, Steps: 4 | Train Loss: 0.951 Vali Loss: 1.559 Vali Acc: 0.380 Test Loss: 1.559 Test Acc: 0.380
Validation loss decreased (-0.359984 --> -0.379984).  Saving model ...
Epoch: 6 cost time: 5.131017446517944
Epoch: 6, Steps: 4 | Train Loss: 0.694 Vali Loss: 1.519 Vali Acc: 0.400 Test Loss: 1.519 Test Acc: 0.400
Validation loss decreased (-0.379984 --> -0.399985).  Saving model ...
Epoch: 7 cost time: 5.070795297622681
Epoch: 7, Steps: 4 | Train Loss: 0.577 Vali Loss: 1.353 Vali Acc: 0.460 Test Loss: 1.353 Test Acc: 0.460
Validation loss decreased (-0.399985 --> -0.459986).  Saving model ...
Epoch: 8 cost time: 4.89932656288147
Epoch: 8, Steps: 4 | Train Loss: 0.381 Vali Loss: 1.349 Vali Acc: 0.480 Test Loss: 1.349 Test Acc: 0.480
Validation loss decreased (-0.459986 --> -0.479987).  Saving model ...
Epoch: 9 cost time: 4.84254789352417
Epoch: 9, Steps: 4 | Train Loss: 0.268 Vali Loss: 1.377 Vali Acc: 0.560 Test Loss: 1.377 Test Acc: 0.560
Validation loss decreased (-0.479987 --> -0.559986).  Saving model ...
Epoch: 10 cost time: 5.241627216339111
Epoch: 10, Steps: 4 | Train Loss: 0.302 Vali Loss: 1.372 Vali Acc: 0.600 Test Loss: 1.372 Test Acc: 0.600
Validation loss decreased (-0.559986 --> -0.599986).  Saving model ...
Epoch: 11 cost time: 5.085875511169434
Epoch: 11, Steps: 4 | Train Loss: 0.179 Vali Loss: 1.345 Vali Acc: 0.520 Test Loss: 1.345 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.9266297817230225
Epoch: 12, Steps: 4 | Train Loss: 0.117 Vali Loss: 1.508 Vali Acc: 0.520 Test Loss: 1.508 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.871037483215332
Epoch: 13, Steps: 4 | Train Loss: 0.131 Vali Loss: 1.417 Vali Acc: 0.560 Test Loss: 1.417 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.336419105529785
Epoch: 14, Steps: 4 | Train Loss: 0.076 Vali Loss: 1.428 Vali Acc: 0.480 Test Loss: 1.428 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 4.627000093460083
Epoch: 15, Steps: 4 | Train Loss: 0.049 Vali Loss: 1.390 Vali Acc: 0.480 Test Loss: 1.390 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 4.733848810195923
Epoch: 16, Steps: 4 | Train Loss: 0.251 Vali Loss: 1.466 Vali Acc: 0.500 Test Loss: 1.466 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 4.793364524841309
Epoch: 17, Steps: 4 | Train Loss: 0.032 Vali Loss: 1.703 Vali Acc: 0.560 Test Loss: 1.703 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 4.828577280044556
Epoch: 18, Steps: 4 | Train Loss: 0.014 Vali Loss: 1.659 Vali Acc: 0.580 Test Loss: 1.659 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 4.358403921127319
Epoch: 19, Steps: 4 | Train Loss: 0.015 Vali Loss: 1.477 Vali Acc: 0.580 Test Loss: 1.477 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 5.092421531677246
Epoch: 20, Steps: 4 | Train Loss: 0.052 Vali Loss: 1.389 Vali Acc: 0.560 Test Loss: 1.389 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm64_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 11360197
model size : 44.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm64_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 10.32278299331665
Epoch: 1, Steps: 4 | Train Loss: 1.659 Vali Loss: 1.698 Vali Acc: 0.240 Test Loss: 1.698 Test Acc: 0.240
Validation loss decreased (inf --> -0.239983).  Saving model ...
Epoch: 2 cost time: 8.427906513214111
Epoch: 2, Steps: 4 | Train Loss: 1.573 Vali Loss: 1.675 Vali Acc: 0.320 Test Loss: 1.675 Test Acc: 0.320
Validation loss decreased (-0.239983 --> -0.319983).  Saving model ...
Epoch: 3 cost time: 7.897022247314453
Epoch: 3, Steps: 4 | Train Loss: 1.277 Vali Loss: 1.646 Vali Acc: 0.300 Test Loss: 1.646 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.591393232345581
Epoch: 4, Steps: 4 | Train Loss: 1.239 Vali Loss: 1.613 Vali Acc: 0.400 Test Loss: 1.613 Test Acc: 0.400
Validation loss decreased (-0.319983 --> -0.399984).  Saving model ...
Epoch: 5 cost time: 7.181253671646118
Epoch: 5, Steps: 4 | Train Loss: 0.955 Vali Loss: 1.553 Vali Acc: 0.380 Test Loss: 1.553 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 8.418070793151855
Epoch: 6, Steps: 4 | Train Loss: 0.963 Vali Loss: 1.485 Vali Acc: 0.440 Test Loss: 1.485 Test Acc: 0.440
Validation loss decreased (-0.399984 --> -0.439985).  Saving model ...
Epoch: 7 cost time: 8.17645812034607
Epoch: 7, Steps: 4 | Train Loss: 0.627 Vali Loss: 1.398 Vali Acc: 0.460 Test Loss: 1.398 Test Acc: 0.460
Validation loss decreased (-0.439985 --> -0.459986).  Saving model ...
Epoch: 8 cost time: 8.539243936538696
Epoch: 8, Steps: 4 | Train Loss: 0.437 Vali Loss: 1.371 Vali Acc: 0.520 Test Loss: 1.371 Test Acc: 0.520
Validation loss decreased (-0.459986 --> -0.519986).  Saving model ...
Epoch: 9 cost time: 8.160025358200073
Epoch: 9, Steps: 4 | Train Loss: 0.288 Vali Loss: 1.143 Vali Acc: 0.520 Test Loss: 1.143 Test Acc: 0.520
Validation loss decreased (-0.519986 --> -0.519989).  Saving model ...
Epoch: 10 cost time: 8.442041635513306
Epoch: 10, Steps: 4 | Train Loss: 0.274 Vali Loss: 1.087 Vali Acc: 0.560 Test Loss: 1.087 Test Acc: 0.560
Validation loss decreased (-0.519989 --> -0.559989).  Saving model ...
Epoch: 11 cost time: 7.8892662525177
Epoch: 11, Steps: 4 | Train Loss: 0.145 Vali Loss: 1.301 Vali Acc: 0.500 Test Loss: 1.301 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 7.730634450912476
Epoch: 12, Steps: 4 | Train Loss: 0.223 Vali Loss: 1.214 Vali Acc: 0.540 Test Loss: 1.214 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 8.27720832824707
Epoch: 13, Steps: 4 | Train Loss: 0.186 Vali Loss: 1.163 Vali Acc: 0.580 Test Loss: 1.163 Test Acc: 0.580
Validation loss decreased (-0.559989 --> -0.579988).  Saving model ...
Epoch: 14 cost time: 7.28225302696228
Epoch: 14, Steps: 4 | Train Loss: 0.058 Vali Loss: 1.231 Vali Acc: 0.540 Test Loss: 1.231 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 8.163095951080322
Epoch: 15, Steps: 4 | Train Loss: 0.048 Vali Loss: 1.465 Vali Acc: 0.560 Test Loss: 1.465 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 8.562596082687378
Epoch: 16, Steps: 4 | Train Loss: 0.078 Vali Loss: 1.491 Vali Acc: 0.520 Test Loss: 1.491 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 8.433289051055908
Epoch: 17, Steps: 4 | Train Loss: 0.031 Vali Loss: 1.417 Vali Acc: 0.520 Test Loss: 1.417 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 8.838715553283691
Epoch: 18, Steps: 4 | Train Loss: 0.016 Vali Loss: 1.523 Vali Acc: 0.500 Test Loss: 1.523 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 7.813668727874756
Epoch: 19, Steps: 4 | Train Loss: 0.015 Vali Loss: 1.490 Vali Acc: 0.460 Test Loss: 1.490 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 8.073230028152466
Epoch: 20, Steps: 4 | Train Loss: 0.018 Vali Loss: 1.513 Vali Acc: 0.520 Test Loss: 1.513 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 8.163028001785278
Epoch: 21, Steps: 4 | Train Loss: 0.026 Vali Loss: 1.592 Vali Acc: 0.520 Test Loss: 1.592 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 8.237124681472778
Epoch: 22, Steps: 4 | Train Loss: 0.011 Vali Loss: 1.849 Vali Acc: 0.500 Test Loss: 1.849 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 8.62825322151184
Epoch: 23, Steps: 4 | Train Loss: 0.006 Vali Loss: 1.866 Vali Acc: 0.540 Test Loss: 1.866 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm64_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 37839301
model size : 145.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm64_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 5.297870874404907
Epoch: 1, Steps: 4 | Train Loss: 1.577 Vali Loss: 1.660 Vali Acc: 0.140 Test Loss: 1.660 Test Acc: 0.140
Validation loss decreased (inf --> -0.139983).  Saving model ...
Epoch: 2 cost time: 3.837921380996704
Epoch: 2, Steps: 4 | Train Loss: 1.530 Vali Loss: 1.646 Vali Acc: 0.280 Test Loss: 1.646 Test Acc: 0.280
Validation loss decreased (-0.139983 --> -0.279984).  Saving model ...
Epoch: 3 cost time: 3.476494073867798
Epoch: 3, Steps: 4 | Train Loss: 1.333 Vali Loss: 1.636 Vali Acc: 0.280 Test Loss: 1.636 Test Acc: 0.280
Validation loss decreased (-0.279984 --> -0.279984).  Saving model ...
Epoch: 4 cost time: 3.7075436115264893
Epoch: 4, Steps: 4 | Train Loss: 1.062 Vali Loss: 1.603 Vali Acc: 0.340 Test Loss: 1.603 Test Acc: 0.340
Validation loss decreased (-0.279984 --> -0.339984).  Saving model ...
Epoch: 5 cost time: 3.646615505218506
Epoch: 5, Steps: 4 | Train Loss: 0.952 Vali Loss: 1.569 Vali Acc: 0.360 Test Loss: 1.569 Test Acc: 0.360
Validation loss decreased (-0.339984 --> -0.359984).  Saving model ...
Epoch: 6 cost time: 3.8121907711029053
Epoch: 6, Steps: 4 | Train Loss: 0.699 Vali Loss: 1.533 Vali Acc: 0.380 Test Loss: 1.533 Test Acc: 0.380
Validation loss decreased (-0.359984 --> -0.379985).  Saving model ...
Epoch: 7 cost time: 3.5844340324401855
Epoch: 7, Steps: 4 | Train Loss: 0.574 Vali Loss: 1.365 Vali Acc: 0.440 Test Loss: 1.365 Test Acc: 0.440
Validation loss decreased (-0.379985 --> -0.439986).  Saving model ...
Epoch: 8 cost time: 3.00942063331604
Epoch: 8, Steps: 4 | Train Loss: 0.385 Vali Loss: 1.359 Vali Acc: 0.460 Test Loss: 1.359 Test Acc: 0.460
Validation loss decreased (-0.439986 --> -0.459986).  Saving model ...
Epoch: 9 cost time: 3.2636804580688477
Epoch: 9, Steps: 4 | Train Loss: 0.269 Vali Loss: 1.385 Vali Acc: 0.540 Test Loss: 1.385 Test Acc: 0.540
Validation loss decreased (-0.459986 --> -0.539986).  Saving model ...
Epoch: 10 cost time: 4.118329286575317
Epoch: 10, Steps: 4 | Train Loss: 0.308 Vali Loss: 1.370 Vali Acc: 0.600 Test Loss: 1.370 Test Acc: 0.600
Validation loss decreased (-0.539986 --> -0.599986).  Saving model ...
Epoch: 11 cost time: 3.766728639602661
Epoch: 11, Steps: 4 | Train Loss: 0.176 Vali Loss: 1.325 Vali Acc: 0.540 Test Loss: 1.325 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.157435655593872
Epoch: 12, Steps: 4 | Train Loss: 0.117 Vali Loss: 1.492 Vali Acc: 0.500 Test Loss: 1.492 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.9832398891448975
Epoch: 13, Steps: 4 | Train Loss: 0.103 Vali Loss: 1.387 Vali Acc: 0.500 Test Loss: 1.387 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.764251947402954
Epoch: 14, Steps: 4 | Train Loss: 0.077 Vali Loss: 1.396 Vali Acc: 0.460 Test Loss: 1.396 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.7422749996185303
Epoch: 15, Steps: 4 | Train Loss: 0.049 Vali Loss: 1.364 Vali Acc: 0.480 Test Loss: 1.364 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 4.01906418800354
Epoch: 16, Steps: 4 | Train Loss: 0.045 Vali Loss: 1.493 Vali Acc: 0.500 Test Loss: 1.493 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.878291606903076
Epoch: 17, Steps: 4 | Train Loss: 0.034 Vali Loss: 1.813 Vali Acc: 0.420 Test Loss: 1.813 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.6677637100219727
Epoch: 18, Steps: 4 | Train Loss: 0.015 Vali Loss: 1.738 Vali Acc: 0.560 Test Loss: 1.738 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 4.008656024932861
Epoch: 19, Steps: 4 | Train Loss: 0.019 Vali Loss: 1.496 Vali Acc: 0.580 Test Loss: 1.496 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 4.027844190597534
Epoch: 20, Steps: 4 | Train Loss: 0.113 Vali Loss: 1.514 Vali Acc: 0.460 Test Loss: 1.514 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm64_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 11360197
model size : 44.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm64_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 7.576153516769409
Epoch: 1, Steps: 4 | Train Loss: 1.663 Vali Loss: 1.699 Vali Acc: 0.240 Test Loss: 1.699 Test Acc: 0.240
Validation loss decreased (inf --> -0.239983).  Saving model ...
Epoch: 2 cost time: 5.7007622718811035
Epoch: 2, Steps: 4 | Train Loss: 1.575 Vali Loss: 1.676 Vali Acc: 0.300 Test Loss: 1.676 Test Acc: 0.300
Validation loss decreased (-0.239983 --> -0.299983).  Saving model ...
Epoch: 3 cost time: 5.5862486362457275
Epoch: 3, Steps: 4 | Train Loss: 1.287 Vali Loss: 1.644 Vali Acc: 0.300 Test Loss: 1.644 Test Acc: 0.300
Validation loss decreased (-0.299983 --> -0.299984).  Saving model ...
Epoch: 4 cost time: 5.031578779220581
Epoch: 4, Steps: 4 | Train Loss: 1.248 Vali Loss: 1.608 Vali Acc: 0.400 Test Loss: 1.608 Test Acc: 0.400
Validation loss decreased (-0.299984 --> -0.399984).  Saving model ...
Epoch: 5 cost time: 4.887734651565552
Epoch: 5, Steps: 4 | Train Loss: 0.974 Vali Loss: 1.543 Vali Acc: 0.400 Test Loss: 1.543 Test Acc: 0.400
Validation loss decreased (-0.399984 --> -0.399985).  Saving model ...
Epoch: 6 cost time: 4.989474534988403
Epoch: 6, Steps: 4 | Train Loss: 0.989 Vali Loss: 1.468 Vali Acc: 0.440 Test Loss: 1.468 Test Acc: 0.440
Validation loss decreased (-0.399985 --> -0.439985).  Saving model ...
Epoch: 7 cost time: 5.555938243865967
Epoch: 7, Steps: 4 | Train Loss: 0.624 Vali Loss: 1.374 Vali Acc: 0.440 Test Loss: 1.374 Test Acc: 0.440
Validation loss decreased (-0.439985 --> -0.439986).  Saving model ...
Epoch: 8 cost time: 5.508404016494751
Epoch: 8, Steps: 4 | Train Loss: 0.457 Vali Loss: 1.330 Vali Acc: 0.520 Test Loss: 1.330 Test Acc: 0.520
Validation loss decreased (-0.439986 --> -0.519987).  Saving model ...
Epoch: 9 cost time: 5.506160736083984
Epoch: 9, Steps: 4 | Train Loss: 0.309 Vali Loss: 1.131 Vali Acc: 0.560 Test Loss: 1.131 Test Acc: 0.560
Validation loss decreased (-0.519987 --> -0.559989).  Saving model ...
Epoch: 10 cost time: 5.698059797286987
Epoch: 10, Steps: 4 | Train Loss: 0.279 Vali Loss: 1.125 Vali Acc: 0.500 Test Loss: 1.125 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.531543016433716
Epoch: 11, Steps: 4 | Train Loss: 0.157 Vali Loss: 1.292 Vali Acc: 0.520 Test Loss: 1.292 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.58996057510376
Epoch: 12, Steps: 4 | Train Loss: 0.156 Vali Loss: 1.099 Vali Acc: 0.540 Test Loss: 1.099 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.180567264556885
Epoch: 13, Steps: 4 | Train Loss: 0.206 Vali Loss: 1.224 Vali Acc: 0.600 Test Loss: 1.224 Test Acc: 0.600
Validation loss decreased (-0.559989 --> -0.599988).  Saving model ...
Epoch: 14 cost time: 5.458219528198242
Epoch: 14, Steps: 4 | Train Loss: 0.050 Vali Loss: 1.443 Vali Acc: 0.520 Test Loss: 1.443 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.632022857666016
Epoch: 15, Steps: 4 | Train Loss: 0.059 Vali Loss: 1.535 Vali Acc: 0.520 Test Loss: 1.535 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 5.730355739593506
Epoch: 16, Steps: 4 | Train Loss: 0.068 Vali Loss: 1.410 Vali Acc: 0.540 Test Loss: 1.410 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 5.5639328956604
Epoch: 17, Steps: 4 | Train Loss: 0.019 Vali Loss: 1.266 Vali Acc: 0.500 Test Loss: 1.266 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 5.39328932762146
Epoch: 18, Steps: 4 | Train Loss: 0.020 Vali Loss: 1.351 Vali Acc: 0.540 Test Loss: 1.351 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 5.247288465499878
Epoch: 19, Steps: 4 | Train Loss: 0.014 Vali Loss: 1.596 Vali Acc: 0.500 Test Loss: 1.596 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 5.276838779449463
Epoch: 20, Steps: 4 | Train Loss: 0.019 Vali Loss: 1.678 Vali Acc: 0.480 Test Loss: 1.678 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 4.991876125335693
Epoch: 21, Steps: 4 | Train Loss: 0.047 Vali Loss: 1.557 Vali Acc: 0.500 Test Loss: 1.557 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 4.674977540969849
Epoch: 22, Steps: 4 | Train Loss: 0.008 Vali Loss: 1.715 Vali Acc: 0.520 Test Loss: 1.715 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 4.080719232559204
Epoch: 23, Steps: 4 | Train Loss: 0.017 Vali Loss: 1.464 Vali Acc: 0.560 Test Loss: 1.464 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm64_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 37839301
model size : 145.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm64_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.9361915588378906
Epoch: 1, Steps: 4 | Train Loss: 1.580 Vali Loss: 1.661 Vali Acc: 0.160 Test Loss: 1.661 Test Acc: 0.160
Validation loss decreased (inf --> -0.159983).  Saving model ...
Epoch: 2 cost time: 2.7974116802215576
Epoch: 2, Steps: 4 | Train Loss: 1.532 Vali Loss: 1.647 Vali Acc: 0.280 Test Loss: 1.647 Test Acc: 0.280
Validation loss decreased (-0.159983 --> -0.279984).  Saving model ...
Epoch: 3 cost time: 2.5281922817230225
Epoch: 3, Steps: 4 | Train Loss: 1.339 Vali Loss: 1.637 Vali Acc: 0.280 Test Loss: 1.637 Test Acc: 0.280
Validation loss decreased (-0.279984 --> -0.279984).  Saving model ...
Epoch: 4 cost time: 2.424442768096924
Epoch: 4, Steps: 4 | Train Loss: 1.073 Vali Loss: 1.601 Vali Acc: 0.340 Test Loss: 1.601 Test Acc: 0.340
Validation loss decreased (-0.279984 --> -0.339984).  Saving model ...
Epoch: 5 cost time: 2.5561280250549316
Epoch: 5, Steps: 4 | Train Loss: 0.972 Vali Loss: 1.560 Vali Acc: 0.340 Test Loss: 1.560 Test Acc: 0.340
Validation loss decreased (-0.339984 --> -0.339984).  Saving model ...
Epoch: 6 cost time: 2.3928089141845703
Epoch: 6, Steps: 4 | Train Loss: 0.720 Vali Loss: 1.522 Vali Acc: 0.380 Test Loss: 1.522 Test Acc: 0.380
Validation loss decreased (-0.339984 --> -0.379985).  Saving model ...
Epoch: 7 cost time: 2.7177960872650146
Epoch: 7, Steps: 4 | Train Loss: 0.595 Vali Loss: 1.356 Vali Acc: 0.420 Test Loss: 1.356 Test Acc: 0.420
Validation loss decreased (-0.379985 --> -0.419986).  Saving model ...
Epoch: 8 cost time: 2.5695178508758545
Epoch: 8, Steps: 4 | Train Loss: 0.402 Vali Loss: 1.349 Vali Acc: 0.460 Test Loss: 1.349 Test Acc: 0.460
Validation loss decreased (-0.419986 --> -0.459987).  Saving model ...
Epoch: 9 cost time: 2.5202901363372803
Epoch: 9, Steps: 4 | Train Loss: 0.279 Vali Loss: 1.373 Vali Acc: 0.540 Test Loss: 1.373 Test Acc: 0.540
Validation loss decreased (-0.459987 --> -0.539986).  Saving model ...
Epoch: 10 cost time: 2.6632792949676514
Epoch: 10, Steps: 4 | Train Loss: 0.288 Vali Loss: 1.308 Vali Acc: 0.520 Test Loss: 1.308 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.6614859104156494
Epoch: 11, Steps: 4 | Train Loss: 0.190 Vali Loss: 1.297 Vali Acc: 0.500 Test Loss: 1.297 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.340601921081543
Epoch: 12, Steps: 4 | Train Loss: 0.133 Vali Loss: 1.500 Vali Acc: 0.500 Test Loss: 1.500 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.813314437866211
Epoch: 13, Steps: 4 | Train Loss: 0.173 Vali Loss: 1.336 Vali Acc: 0.480 Test Loss: 1.336 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.4076740741729736
Epoch: 14, Steps: 4 | Train Loss: 0.122 Vali Loss: 1.377 Vali Acc: 0.480 Test Loss: 1.377 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.7636020183563232
Epoch: 15, Steps: 4 | Train Loss: 0.068 Vali Loss: 1.345 Vali Acc: 0.500 Test Loss: 1.345 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.5879223346710205
Epoch: 16, Steps: 4 | Train Loss: 0.034 Vali Loss: 1.471 Vali Acc: 0.520 Test Loss: 1.471 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.7322614192962646
Epoch: 17, Steps: 4 | Train Loss: 0.030 Vali Loss: 1.660 Vali Acc: 0.520 Test Loss: 1.660 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.654623031616211
Epoch: 18, Steps: 4 | Train Loss: 0.018 Vali Loss: 1.568 Vali Acc: 0.520 Test Loss: 1.568 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.7214455604553223
Epoch: 19, Steps: 4 | Train Loss: 0.019 Vali Loss: 1.321 Vali Acc: 0.600 Test Loss: 1.321 Test Acc: 0.600
Validation loss decreased (-0.539986 --> -0.599987).  Saving model ...
Epoch: 20 cost time: 2.2948877811431885
Epoch: 20, Steps: 4 | Train Loss: 0.216 Vali Loss: 1.340 Vali Acc: 0.460 Test Loss: 1.340 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.807905673980713
Epoch: 21, Steps: 4 | Train Loss: 0.015 Vali Loss: 1.353 Vali Acc: 0.540 Test Loss: 1.353 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.50376296043396
Epoch: 22, Steps: 4 | Train Loss: 0.008 Vali Loss: 1.392 Vali Acc: 0.540 Test Loss: 1.392 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.614182472229004
Epoch: 23, Steps: 4 | Train Loss: 0.010 Vali Loss: 1.528 Vali Acc: 0.520 Test Loss: 1.528 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.4344427585601807
Epoch: 24, Steps: 4 | Train Loss: 0.006 Vali Loss: 1.789 Vali Acc: 0.480 Test Loss: 1.789 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.4542975425720215
Epoch: 25, Steps: 4 | Train Loss: 0.008 Vali Loss: 1.799 Vali Acc: 0.460 Test Loss: 1.799 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.543506145477295
Epoch: 26, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.773 Vali Acc: 0.520 Test Loss: 1.773 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.576242208480835
Epoch: 27, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.852 Vali Acc: 0.460 Test Loss: 1.852 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.33833909034729
Epoch: 28, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.881 Vali Acc: 0.460 Test Loss: 1.881 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.4601871967315674
Epoch: 29, Steps: 4 | Train Loss: 0.006 Vali Loss: 1.821 Vali Acc: 0.460 Test Loss: 1.821 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm64_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 11360197
model size : 44.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm64_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 7.67182183265686
Epoch: 1, Steps: 4 | Train Loss: 1.694 Vali Loss: 1.661 Vali Acc: 0.220 Test Loss: 1.661 Test Acc: 0.220
Validation loss decreased (inf --> -0.219983).  Saving model ...
Epoch: 2 cost time: 6.3183581829071045
Epoch: 2, Steps: 4 | Train Loss: 1.606 Vali Loss: 1.643 Vali Acc: 0.320 Test Loss: 1.643 Test Acc: 0.320
Validation loss decreased (-0.219983 --> -0.319984).  Saving model ...
Epoch: 3 cost time: 6.43780255317688
Epoch: 3, Steps: 4 | Train Loss: 1.365 Vali Loss: 1.653 Vali Acc: 0.280 Test Loss: 1.653 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.173226356506348
Epoch: 4, Steps: 4 | Train Loss: 1.100 Vali Loss: 1.670 Vali Acc: 0.320 Test Loss: 1.670 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.877228260040283
Epoch: 5, Steps: 4 | Train Loss: 1.058 Vali Loss: 1.641 Vali Acc: 0.420 Test Loss: 1.641 Test Acc: 0.420
Validation loss decreased (-0.319984 --> -0.419984).  Saving model ...
Epoch: 6 cost time: 6.251323461532593
Epoch: 6, Steps: 4 | Train Loss: 0.810 Vali Loss: 1.586 Vali Acc: 0.420 Test Loss: 1.586 Test Acc: 0.420
Validation loss decreased (-0.419984 --> -0.419984).  Saving model ...
Epoch: 7 cost time: 6.486246824264526
Epoch: 7, Steps: 4 | Train Loss: 0.556 Vali Loss: 1.448 Vali Acc: 0.520 Test Loss: 1.448 Test Acc: 0.520
Validation loss decreased (-0.419984 --> -0.519986).  Saving model ...
Epoch: 8 cost time: 5.879934310913086
Epoch: 8, Steps: 4 | Train Loss: 0.546 Vali Loss: 1.446 Vali Acc: 0.500 Test Loss: 1.446 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.041435480117798
Epoch: 9, Steps: 4 | Train Loss: 0.322 Vali Loss: 1.450 Vali Acc: 0.480 Test Loss: 1.450 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.408048868179321
Epoch: 10, Steps: 4 | Train Loss: 0.330 Vali Loss: 1.394 Vali Acc: 0.440 Test Loss: 1.394 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 5.287834405899048
Epoch: 11, Steps: 4 | Train Loss: 0.188 Vali Loss: 1.245 Vali Acc: 0.520 Test Loss: 1.245 Test Acc: 0.520
Validation loss decreased (-0.519986 --> -0.519988).  Saving model ...
Epoch: 12 cost time: 3.575028657913208
Epoch: 12, Steps: 4 | Train Loss: 0.125 Vali Loss: 1.237 Vali Acc: 0.560 Test Loss: 1.237 Test Acc: 0.560
Validation loss decreased (-0.519988 --> -0.559988).  Saving model ...
Epoch: 13 cost time: 4.778461694717407
Epoch: 13, Steps: 4 | Train Loss: 0.096 Vali Loss: 1.246 Vali Acc: 0.560 Test Loss: 1.246 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.283325672149658
Epoch: 14, Steps: 4 | Train Loss: 0.043 Vali Loss: 1.236 Vali Acc: 0.540 Test Loss: 1.236 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 6.541270017623901
Epoch: 15, Steps: 4 | Train Loss: 0.196 Vali Loss: 1.230 Vali Acc: 0.600 Test Loss: 1.230 Test Acc: 0.600
Validation loss decreased (-0.559988 --> -0.599988).  Saving model ...
Epoch: 16 cost time: 6.839619159698486
Epoch: 16, Steps: 4 | Train Loss: 0.044 Vali Loss: 1.204 Vali Acc: 0.580 Test Loss: 1.204 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 6.408504486083984
Epoch: 17, Steps: 4 | Train Loss: 0.029 Vali Loss: 1.247 Vali Acc: 0.600 Test Loss: 1.247 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 6.065767765045166
Epoch: 18, Steps: 4 | Train Loss: 0.016 Vali Loss: 1.215 Vali Acc: 0.620 Test Loss: 1.215 Test Acc: 0.620
Validation loss decreased (-0.599988 --> -0.619988).  Saving model ...
Epoch: 19 cost time: 6.712451219558716
Epoch: 19, Steps: 4 | Train Loss: 0.013 Vali Loss: 1.342 Vali Acc: 0.640 Test Loss: 1.342 Test Acc: 0.640
Validation loss decreased (-0.619988 --> -0.639987).  Saving model ...
Epoch: 20 cost time: 6.526589632034302
Epoch: 20, Steps: 4 | Train Loss: 0.013 Vali Loss: 1.488 Vali Acc: 0.540 Test Loss: 1.488 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 6.643695116043091
Epoch: 21, Steps: 4 | Train Loss: 0.007 Vali Loss: 1.390 Vali Acc: 0.500 Test Loss: 1.390 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 6.22031569480896
Epoch: 22, Steps: 4 | Train Loss: 0.006 Vali Loss: 1.314 Vali Acc: 0.520 Test Loss: 1.314 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 6.507186651229858
Epoch: 23, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.291 Vali Acc: 0.600 Test Loss: 1.291 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 6.847351312637329
Epoch: 24, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.284 Vali Acc: 0.620 Test Loss: 1.284 Test Acc: 0.620
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 6.4137420654296875
Epoch: 25, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.300 Vali Acc: 0.600 Test Loss: 1.300 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 6.451935052871704
Epoch: 26, Steps: 4 | Train Loss: 0.006 Vali Loss: 1.430 Vali Acc: 0.560 Test Loss: 1.430 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 6.340995788574219
Epoch: 27, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.839 Vali Acc: 0.520 Test Loss: 1.839 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 5.273041486740112
Epoch: 28, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.858 Vali Acc: 0.500 Test Loss: 1.858 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 6.676127910614014
Epoch: 29, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.700 Vali Acc: 0.500 Test Loss: 1.700 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm64_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.64
model parameter : 19092933
model size : 74.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm64_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.264742374420166
Epoch: 1, Steps: 4 | Train Loss: 1.556 Vali Loss: 1.638 Vali Acc: 0.200 Test Loss: 1.638 Test Acc: 0.200
Validation loss decreased (inf --> -0.199984).  Saving model ...
Epoch: 2 cost time: 3.16436505317688
Epoch: 2, Steps: 4 | Train Loss: 1.645 Vali Loss: 1.621 Vali Acc: 0.300 Test Loss: 1.621 Test Acc: 0.300
Validation loss decreased (-0.199984 --> -0.299984).  Saving model ...
Epoch: 3 cost time: 2.9244391918182373
Epoch: 3, Steps: 4 | Train Loss: 1.431 Vali Loss: 1.582 Vali Acc: 0.340 Test Loss: 1.582 Test Acc: 0.340
Validation loss decreased (-0.299984 --> -0.339984).  Saving model ...
Epoch: 4 cost time: 3.0541889667510986
Epoch: 4, Steps: 4 | Train Loss: 1.232 Vali Loss: 1.524 Vali Acc: 0.400 Test Loss: 1.524 Test Acc: 0.400
Validation loss decreased (-0.339984 --> -0.399985).  Saving model ...
Epoch: 5 cost time: 3.3782498836517334
Epoch: 5, Steps: 4 | Train Loss: 1.119 Vali Loss: 1.448 Vali Acc: 0.440 Test Loss: 1.448 Test Acc: 0.440
Validation loss decreased (-0.399985 --> -0.439986).  Saving model ...
Epoch: 6 cost time: 3.082308053970337
Epoch: 6, Steps: 4 | Train Loss: 0.789 Vali Loss: 1.383 Vali Acc: 0.440 Test Loss: 1.383 Test Acc: 0.440
Validation loss decreased (-0.439986 --> -0.439986).  Saving model ...
Epoch: 7 cost time: 3.048395872116089
Epoch: 7, Steps: 4 | Train Loss: 0.642 Vali Loss: 1.365 Vali Acc: 0.440 Test Loss: 1.365 Test Acc: 0.440
Validation loss decreased (-0.439986 --> -0.439986).  Saving model ...
Epoch: 8 cost time: 3.2250397205352783
Epoch: 8, Steps: 4 | Train Loss: 0.737 Vali Loss: 1.270 Vali Acc: 0.540 Test Loss: 1.270 Test Acc: 0.540
Validation loss decreased (-0.439986 --> -0.539987).  Saving model ...
Epoch: 9 cost time: 2.959446907043457
Epoch: 9, Steps: 4 | Train Loss: 0.324 Vali Loss: 1.269 Vali Acc: 0.500 Test Loss: 1.269 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.4185502529144287
Epoch: 10, Steps: 4 | Train Loss: 0.277 Vali Loss: 1.361 Vali Acc: 0.560 Test Loss: 1.361 Test Acc: 0.560
Validation loss decreased (-0.539987 --> -0.559986).  Saving model ...
Epoch: 11 cost time: 3.212249279022217
Epoch: 11, Steps: 4 | Train Loss: 0.188 Vali Loss: 1.241 Vali Acc: 0.580 Test Loss: 1.241 Test Acc: 0.580
Validation loss decreased (-0.559986 --> -0.579988).  Saving model ...
Epoch: 12 cost time: 2.987274646759033
Epoch: 12, Steps: 4 | Train Loss: 0.165 Vali Loss: 1.227 Vali Acc: 0.540 Test Loss: 1.227 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.0306003093719482
Epoch: 13, Steps: 4 | Train Loss: 0.100 Vali Loss: 1.104 Vali Acc: 0.480 Test Loss: 1.104 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.2454802989959717
Epoch: 14, Steps: 4 | Train Loss: 0.112 Vali Loss: 1.177 Vali Acc: 0.560 Test Loss: 1.177 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.1363658905029297
Epoch: 15, Steps: 4 | Train Loss: 0.041 Vali Loss: 1.225 Vali Acc: 0.480 Test Loss: 1.225 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.1049535274505615
Epoch: 16, Steps: 4 | Train Loss: 0.034 Vali Loss: 1.333 Vali Acc: 0.540 Test Loss: 1.333 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.2423644065856934
Epoch: 17, Steps: 4 | Train Loss: 0.024 Vali Loss: 1.253 Vali Acc: 0.480 Test Loss: 1.253 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.9968035221099854
Epoch: 18, Steps: 4 | Train Loss: 0.020 Vali Loss: 1.317 Vali Acc: 0.540 Test Loss: 1.317 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.961148977279663
Epoch: 19, Steps: 4 | Train Loss: 0.016 Vali Loss: 1.344 Vali Acc: 0.540 Test Loss: 1.344 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 3.1779847145080566
Epoch: 20, Steps: 4 | Train Loss: 0.011 Vali Loss: 1.246 Vali Acc: 0.560 Test Loss: 1.246 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.975055694580078
Epoch: 21, Steps: 4 | Train Loss: 0.011 Vali Loss: 1.445 Vali Acc: 0.600 Test Loss: 1.445 Test Acc: 0.600
Validation loss decreased (-0.579988 --> -0.599986).  Saving model ...
Epoch: 22 cost time: 3.1417782306671143
Epoch: 22, Steps: 4 | Train Loss: 0.007 Vali Loss: 1.786 Vali Acc: 0.540 Test Loss: 1.786 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.248720169067383
Epoch: 23, Steps: 4 | Train Loss: 0.007 Vali Loss: 1.834 Vali Acc: 0.520 Test Loss: 1.834 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.958226203918457
Epoch: 24, Steps: 4 | Train Loss: 0.006 Vali Loss: 1.633 Vali Acc: 0.520 Test Loss: 1.633 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.8302600383758545
Epoch: 25, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.483 Vali Acc: 0.560 Test Loss: 1.483 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.0603017807006836
Epoch: 26, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.439 Vali Acc: 0.560 Test Loss: 1.439 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.666226863861084
Epoch: 27, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.428 Vali Acc: 0.560 Test Loss: 1.428 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.9364795684814453
Epoch: 28, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.373 Vali Acc: 0.580 Test Loss: 1.373 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 3.082817316055298
Epoch: 29, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.324 Vali Acc: 0.600 Test Loss: 1.324 Test Acc: 0.600
Validation loss decreased (-0.599986 --> -0.599987).  Saving model ...
Epoch: 30 cost time: 2.930927276611328
Epoch: 30, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.400 Vali Acc: 0.560 Test Loss: 1.400 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm64_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 5853125
model size : 23.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm64_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 6.710590124130249
Epoch: 1, Steps: 4 | Train Loss: 1.696 Vali Loss: 1.662 Vali Acc: 0.220 Test Loss: 1.662 Test Acc: 0.220
Validation loss decreased (inf --> -0.219983).  Saving model ...
Epoch: 2 cost time: 5.040398836135864
Epoch: 2, Steps: 4 | Train Loss: 1.607 Vali Loss: 1.644 Vali Acc: 0.320 Test Loss: 1.644 Test Acc: 0.320
Validation loss decreased (-0.219983 --> -0.319984).  Saving model ...
Epoch: 3 cost time: 5.0340986251831055
Epoch: 3, Steps: 4 | Train Loss: 1.365 Vali Loss: 1.654 Vali Acc: 0.280 Test Loss: 1.654 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.072204828262329
Epoch: 4, Steps: 4 | Train Loss: 1.105 Vali Loss: 1.672 Vali Acc: 0.320 Test Loss: 1.672 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.094276189804077
Epoch: 5, Steps: 4 | Train Loss: 1.051 Vali Loss: 1.644 Vali Acc: 0.400 Test Loss: 1.644 Test Acc: 0.400
Validation loss decreased (-0.319984 --> -0.399984).  Saving model ...
Epoch: 6 cost time: 4.990817308425903
Epoch: 6, Steps: 4 | Train Loss: 0.815 Vali Loss: 1.593 Vali Acc: 0.420 Test Loss: 1.593 Test Acc: 0.420
Validation loss decreased (-0.399984 --> -0.419984).  Saving model ...
Epoch: 7 cost time: 4.406451940536499
Epoch: 7, Steps: 4 | Train Loss: 0.552 Vali Loss: 1.465 Vali Acc: 0.480 Test Loss: 1.465 Test Acc: 0.480
Validation loss decreased (-0.419984 --> -0.479985).  Saving model ...
Epoch: 8 cost time: 4.903771162033081
Epoch: 8, Steps: 4 | Train Loss: 0.550 Vali Loss: 1.448 Vali Acc: 0.480 Test Loss: 1.448 Test Acc: 0.480
Validation loss decreased (-0.479985 --> -0.479986).  Saving model ...
Epoch: 9 cost time: 5.001644849777222
Epoch: 9, Steps: 4 | Train Loss: 0.325 Vali Loss: 1.444 Vali Acc: 0.480 Test Loss: 1.444 Test Acc: 0.480
Validation loss decreased (-0.479986 --> -0.479986).  Saving model ...
Epoch: 10 cost time: 5.002488136291504
Epoch: 10, Steps: 4 | Train Loss: 0.332 Vali Loss: 1.394 Vali Acc: 0.440 Test Loss: 1.394 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.452988862991333
Epoch: 11, Steps: 4 | Train Loss: 0.189 Vali Loss: 1.252 Vali Acc: 0.500 Test Loss: 1.252 Test Acc: 0.500
Validation loss decreased (-0.479986 --> -0.499987).  Saving model ...
Epoch: 12 cost time: 5.1884543895721436
Epoch: 12, Steps: 4 | Train Loss: 0.126 Vali Loss: 1.245 Vali Acc: 0.520 Test Loss: 1.245 Test Acc: 0.520
Validation loss decreased (-0.499987 --> -0.519988).  Saving model ...
Epoch: 13 cost time: 4.869160890579224
Epoch: 13, Steps: 4 | Train Loss: 0.097 Vali Loss: 1.249 Vali Acc: 0.540 Test Loss: 1.249 Test Acc: 0.540
Validation loss decreased (-0.519988 --> -0.539988).  Saving model ...
Epoch: 14 cost time: 5.2711358070373535
Epoch: 14, Steps: 4 | Train Loss: 0.043 Vali Loss: 1.233 Vali Acc: 0.520 Test Loss: 1.233 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.426715135574341
Epoch: 15, Steps: 4 | Train Loss: 0.195 Vali Loss: 1.214 Vali Acc: 0.580 Test Loss: 1.214 Test Acc: 0.580
Validation loss decreased (-0.539988 --> -0.579988).  Saving model ...
Epoch: 16 cost time: 4.907436370849609
Epoch: 16, Steps: 4 | Train Loss: 0.045 Vali Loss: 1.205 Vali Acc: 0.560 Test Loss: 1.205 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.743887901306152
Epoch: 17, Steps: 4 | Train Loss: 0.031 Vali Loss: 1.244 Vali Acc: 0.600 Test Loss: 1.244 Test Acc: 0.600
Validation loss decreased (-0.579988 --> -0.599988).  Saving model ...
Epoch: 18 cost time: 4.966938257217407
Epoch: 18, Steps: 4 | Train Loss: 0.015 Vali Loss: 1.213 Vali Acc: 0.580 Test Loss: 1.213 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 5.1313393115997314
Epoch: 19, Steps: 4 | Train Loss: 0.013 Vali Loss: 1.348 Vali Acc: 0.620 Test Loss: 1.348 Test Acc: 0.620
Validation loss decreased (-0.599988 --> -0.619987).  Saving model ...
Epoch: 20 cost time: 4.942381143569946
Epoch: 20, Steps: 4 | Train Loss: 0.015 Vali Loss: 1.470 Vali Acc: 0.560 Test Loss: 1.470 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 4.595521926879883
Epoch: 21, Steps: 4 | Train Loss: 0.008 Vali Loss: 1.234 Vali Acc: 0.480 Test Loss: 1.234 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 4.991729497909546
Epoch: 22, Steps: 4 | Train Loss: 0.006 Vali Loss: 1.251 Vali Acc: 0.520 Test Loss: 1.251 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 5.455837249755859
Epoch: 23, Steps: 4 | Train Loss: 0.006 Vali Loss: 1.367 Vali Acc: 0.580 Test Loss: 1.367 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 5.130301237106323
Epoch: 24, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.509 Vali Acc: 0.580 Test Loss: 1.509 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 4.948962450027466
Epoch: 25, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.534 Vali Acc: 0.580 Test Loss: 1.534 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 5.352953672409058
Epoch: 26, Steps: 4 | Train Loss: 0.010 Vali Loss: 1.564 Vali Acc: 0.500 Test Loss: 1.564 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 5.091498374938965
Epoch: 27, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.824 Vali Acc: 0.520 Test Loss: 1.824 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 4.086206912994385
Epoch: 28, Steps: 4 | Train Loss: 0.011 Vali Loss: 1.633 Vali Acc: 0.520 Test Loss: 1.633 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 4.676096439361572
Epoch: 29, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.487 Vali Acc: 0.540 Test Loss: 1.487 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm64_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.62
model parameter : 19092933
model size : 74.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm64_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.399664878845215
Epoch: 1, Steps: 4 | Train Loss: 1.556 Vali Loss: 1.636 Vali Acc: 0.200 Test Loss: 1.636 Test Acc: 0.200
Validation loss decreased (inf --> -0.199984).  Saving model ...
Epoch: 2 cost time: 2.5377743244171143
Epoch: 2, Steps: 4 | Train Loss: 1.643 Vali Loss: 1.618 Vali Acc: 0.300 Test Loss: 1.618 Test Acc: 0.300
Validation loss decreased (-0.199984 --> -0.299984).  Saving model ...
Epoch: 3 cost time: 2.396868944168091
Epoch: 3, Steps: 4 | Train Loss: 1.430 Vali Loss: 1.581 Vali Acc: 0.340 Test Loss: 1.581 Test Acc: 0.340
Validation loss decreased (-0.299984 --> -0.339984).  Saving model ...
Epoch: 4 cost time: 2.5132434368133545
Epoch: 4, Steps: 4 | Train Loss: 1.236 Vali Loss: 1.525 Vali Acc: 0.400 Test Loss: 1.525 Test Acc: 0.400
Validation loss decreased (-0.339984 --> -0.399985).  Saving model ...
Epoch: 5 cost time: 2.387385368347168
Epoch: 5, Steps: 4 | Train Loss: 1.114 Vali Loss: 1.452 Vali Acc: 0.440 Test Loss: 1.452 Test Acc: 0.440
Validation loss decreased (-0.399985 --> -0.439985).  Saving model ...
Epoch: 6 cost time: 2.3617475032806396
Epoch: 6, Steps: 4 | Train Loss: 0.788 Vali Loss: 1.388 Vali Acc: 0.440 Test Loss: 1.388 Test Acc: 0.440
Validation loss decreased (-0.439985 --> -0.439986).  Saving model ...
Epoch: 7 cost time: 2.498382329940796
Epoch: 7, Steps: 4 | Train Loss: 0.640 Vali Loss: 1.369 Vali Acc: 0.440 Test Loss: 1.369 Test Acc: 0.440
Validation loss decreased (-0.439986 --> -0.439986).  Saving model ...
Epoch: 8 cost time: 2.7108395099639893
Epoch: 8, Steps: 4 | Train Loss: 0.735 Vali Loss: 1.275 Vali Acc: 0.520 Test Loss: 1.275 Test Acc: 0.520
Validation loss decreased (-0.439986 --> -0.519987).  Saving model ...
Epoch: 9 cost time: 2.626296281814575
Epoch: 9, Steps: 4 | Train Loss: 0.323 Vali Loss: 1.277 Vali Acc: 0.520 Test Loss: 1.277 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.5032169818878174
Epoch: 10, Steps: 4 | Train Loss: 0.277 Vali Loss: 1.377 Vali Acc: 0.540 Test Loss: 1.377 Test Acc: 0.540
Validation loss decreased (-0.519987 --> -0.539986).  Saving model ...
Epoch: 11 cost time: 2.41300368309021
Epoch: 11, Steps: 4 | Train Loss: 0.188 Vali Loss: 1.249 Vali Acc: 0.580 Test Loss: 1.249 Test Acc: 0.580
Validation loss decreased (-0.539986 --> -0.579988).  Saving model ...
Epoch: 12 cost time: 2.037736654281616
Epoch: 12, Steps: 4 | Train Loss: 0.165 Vali Loss: 1.234 Vali Acc: 0.540 Test Loss: 1.234 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.0938189029693604
Epoch: 13, Steps: 4 | Train Loss: 0.100 Vali Loss: 1.102 Vali Acc: 0.480 Test Loss: 1.102 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.2129218578338623
Epoch: 14, Steps: 4 | Train Loss: 0.111 Vali Loss: 1.169 Vali Acc: 0.540 Test Loss: 1.169 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.9927637577056885
Epoch: 15, Steps: 4 | Train Loss: 0.041 Vali Loss: 1.226 Vali Acc: 0.440 Test Loss: 1.226 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.9546828269958496
Epoch: 16, Steps: 4 | Train Loss: 0.034 Vali Loss: 1.327 Vali Acc: 0.560 Test Loss: 1.327 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.9368054866790771
Epoch: 17, Steps: 4 | Train Loss: 0.023 Vali Loss: 1.248 Vali Acc: 0.500 Test Loss: 1.248 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.449089765548706
Epoch: 18, Steps: 4 | Train Loss: 0.020 Vali Loss: 1.307 Vali Acc: 0.540 Test Loss: 1.307 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.560208559036255
Epoch: 19, Steps: 4 | Train Loss: 0.016 Vali Loss: 1.323 Vali Acc: 0.560 Test Loss: 1.323 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.6463522911071777
Epoch: 20, Steps: 4 | Train Loss: 0.009 Vali Loss: 1.225 Vali Acc: 0.540 Test Loss: 1.225 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.6613078117370605
Epoch: 21, Steps: 4 | Train Loss: 0.016 Vali Loss: 1.471 Vali Acc: 0.580 Test Loss: 1.471 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm64_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 5853125
model size : 23.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm64_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.953876733779907
Epoch: 1, Steps: 4 | Train Loss: 1.695 Vali Loss: 1.663 Vali Acc: 0.220 Test Loss: 1.663 Test Acc: 0.220
Validation loss decreased (inf --> -0.219983).  Saving model ...
Epoch: 2 cost time: 2.9956812858581543
Epoch: 2, Steps: 4 | Train Loss: 1.606 Vali Loss: 1.646 Vali Acc: 0.300 Test Loss: 1.646 Test Acc: 0.300
Validation loss decreased (-0.219983 --> -0.299984).  Saving model ...
Epoch: 3 cost time: 3.554656744003296
Epoch: 3, Steps: 4 | Train Loss: 1.368 Vali Loss: 1.657 Vali Acc: 0.280 Test Loss: 1.657 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.1434948444366455
Epoch: 4, Steps: 4 | Train Loss: 1.115 Vali Loss: 1.675 Vali Acc: 0.320 Test Loss: 1.675 Test Acc: 0.320
Validation loss decreased (-0.299984 --> -0.319983).  Saving model ...
Epoch: 5 cost time: 3.3554465770721436
Epoch: 5, Steps: 4 | Train Loss: 1.045 Vali Loss: 1.646 Vali Acc: 0.400 Test Loss: 1.646 Test Acc: 0.400
Validation loss decreased (-0.319983 --> -0.399984).  Saving model ...
Epoch: 6 cost time: 3.2155046463012695
Epoch: 6, Steps: 4 | Train Loss: 0.830 Vali Loss: 1.591 Vali Acc: 0.440 Test Loss: 1.591 Test Acc: 0.440
Validation loss decreased (-0.399984 --> -0.439984).  Saving model ...
Epoch: 7 cost time: 3.5989651679992676
Epoch: 7, Steps: 4 | Train Loss: 0.577 Vali Loss: 1.465 Vali Acc: 0.460 Test Loss: 1.465 Test Acc: 0.460
Validation loss decreased (-0.439984 --> -0.459985).  Saving model ...
Epoch: 8 cost time: 3.1489365100860596
Epoch: 8, Steps: 4 | Train Loss: 0.568 Vali Loss: 1.471 Vali Acc: 0.460 Test Loss: 1.471 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.2709696292877197
Epoch: 9, Steps: 4 | Train Loss: 0.381 Vali Loss: 1.456 Vali Acc: 0.460 Test Loss: 1.456 Test Acc: 0.460
Validation loss decreased (-0.459985 --> -0.459985).  Saving model ...
Epoch: 10 cost time: 2.6904289722442627
Epoch: 10, Steps: 4 | Train Loss: 0.329 Vali Loss: 1.384 Vali Acc: 0.440 Test Loss: 1.384 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.930584192276001
Epoch: 11, Steps: 4 | Train Loss: 0.207 Vali Loss: 1.284 Vali Acc: 0.480 Test Loss: 1.284 Test Acc: 0.480
Validation loss decreased (-0.459985 --> -0.479987).  Saving model ...
Epoch: 12 cost time: 2.9334654808044434
Epoch: 12, Steps: 4 | Train Loss: 0.133 Vali Loss: 1.306 Vali Acc: 0.480 Test Loss: 1.306 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.2120087146759033
Epoch: 13, Steps: 4 | Train Loss: 0.105 Vali Loss: 1.314 Vali Acc: 0.480 Test Loss: 1.314 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.0635159015655518
Epoch: 14, Steps: 4 | Train Loss: 0.049 Vali Loss: 1.237 Vali Acc: 0.500 Test Loss: 1.237 Test Acc: 0.500
Validation loss decreased (-0.479987 --> -0.499988).  Saving model ...
Epoch: 15 cost time: 3.1096928119659424
Epoch: 15, Steps: 4 | Train Loss: 0.148 Vali Loss: 1.338 Vali Acc: 0.580 Test Loss: 1.338 Test Acc: 0.580
Validation loss decreased (-0.499988 --> -0.579987).  Saving model ...
Epoch: 16 cost time: 2.956585168838501
Epoch: 16, Steps: 4 | Train Loss: 0.050 Vali Loss: 1.291 Vali Acc: 0.500 Test Loss: 1.291 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.8946378231048584
Epoch: 17, Steps: 4 | Train Loss: 0.064 Vali Loss: 1.353 Vali Acc: 0.500 Test Loss: 1.353 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.7254250049591064
Epoch: 18, Steps: 4 | Train Loss: 0.024 Vali Loss: 1.352 Vali Acc: 0.560 Test Loss: 1.352 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.9497194290161133
Epoch: 19, Steps: 4 | Train Loss: 0.018 Vali Loss: 1.418 Vali Acc: 0.540 Test Loss: 1.418 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.7294983863830566
Epoch: 20, Steps: 4 | Train Loss: 0.014 Vali Loss: 1.556 Vali Acc: 0.500 Test Loss: 1.556 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.7255725860595703
Epoch: 21, Steps: 4 | Train Loss: 0.009 Vali Loss: 1.526 Vali Acc: 0.460 Test Loss: 1.526 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.7982912063598633
Epoch: 22, Steps: 4 | Train Loss: 0.008 Vali Loss: 1.419 Vali Acc: 0.500 Test Loss: 1.419 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 3.0307414531707764
Epoch: 23, Steps: 4 | Train Loss: 0.006 Vali Loss: 1.323 Vali Acc: 0.540 Test Loss: 1.323 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.5979037284851074
Epoch: 24, Steps: 4 | Train Loss: 0.051 Vali Loss: 1.421 Vali Acc: 0.520 Test Loss: 1.421 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 3.552457094192505
Epoch: 25, Steps: 4 | Train Loss: 0.005 Vali Loss: 2.151 Vali Acc: 0.500 Test Loss: 2.151 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm64_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 19092933
model size : 74.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm64_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.5558688640594482
Epoch: 1, Steps: 4 | Train Loss: 1.556 Vali Loss: 1.648 Vali Acc: 0.200 Test Loss: 1.648 Test Acc: 0.200
Validation loss decreased (inf --> -0.199984).  Saving model ...
Epoch: 2 cost time: 1.9832251071929932
Epoch: 2, Steps: 4 | Train Loss: 1.644 Vali Loss: 1.631 Vali Acc: 0.300 Test Loss: 1.631 Test Acc: 0.300
Validation loss decreased (-0.199984 --> -0.299984).  Saving model ...
Epoch: 3 cost time: 1.9937562942504883
Epoch: 3, Steps: 4 | Train Loss: 1.435 Vali Loss: 1.595 Vali Acc: 0.340 Test Loss: 1.595 Test Acc: 0.340
Validation loss decreased (-0.299984 --> -0.339984).  Saving model ...
Epoch: 4 cost time: 1.9508233070373535
Epoch: 4, Steps: 4 | Train Loss: 1.242 Vali Loss: 1.539 Vali Acc: 0.400 Test Loss: 1.539 Test Acc: 0.400
Validation loss decreased (-0.339984 --> -0.399985).  Saving model ...
Epoch: 5 cost time: 1.9844844341278076
Epoch: 5, Steps: 4 | Train Loss: 1.119 Vali Loss: 1.465 Vali Acc: 0.420 Test Loss: 1.465 Test Acc: 0.420
Validation loss decreased (-0.399985 --> -0.419985).  Saving model ...
Epoch: 6 cost time: 2.199786424636841
Epoch: 6, Steps: 4 | Train Loss: 0.807 Vali Loss: 1.396 Vali Acc: 0.420 Test Loss: 1.396 Test Acc: 0.420
Validation loss decreased (-0.419985 --> -0.419986).  Saving model ...
Epoch: 7 cost time: 1.9265096187591553
Epoch: 7, Steps: 4 | Train Loss: 0.723 Vali Loss: 1.381 Vali Acc: 0.420 Test Loss: 1.381 Test Acc: 0.420
Validation loss decreased (-0.419986 --> -0.419986).  Saving model ...
Epoch: 8 cost time: 1.693577766418457
Epoch: 8, Steps: 4 | Train Loss: 0.759 Vali Loss: 1.285 Vali Acc: 0.520 Test Loss: 1.285 Test Acc: 0.520
Validation loss decreased (-0.419986 --> -0.519987).  Saving model ...
Epoch: 9 cost time: 2.1152572631835938
Epoch: 9, Steps: 4 | Train Loss: 0.343 Vali Loss: 1.284 Vali Acc: 0.500 Test Loss: 1.284 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.2131261825561523
Epoch: 10, Steps: 4 | Train Loss: 0.294 Vali Loss: 1.363 Vali Acc: 0.540 Test Loss: 1.363 Test Acc: 0.540
Validation loss decreased (-0.519987 --> -0.539986).  Saving model ...
Epoch: 11 cost time: 1.8129806518554688
Epoch: 11, Steps: 4 | Train Loss: 0.207 Vali Loss: 1.256 Vali Acc: 0.600 Test Loss: 1.256 Test Acc: 0.600
Validation loss decreased (-0.539986 --> -0.599987).  Saving model ...
Epoch: 12 cost time: 1.8458337783813477
Epoch: 12, Steps: 4 | Train Loss: 0.172 Vali Loss: 1.237 Vali Acc: 0.520 Test Loss: 1.237 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.9870853424072266
Epoch: 13, Steps: 4 | Train Loss: 0.108 Vali Loss: 1.107 Vali Acc: 0.480 Test Loss: 1.107 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.067988157272339
Epoch: 14, Steps: 4 | Train Loss: 0.125 Vali Loss: 1.171 Vali Acc: 0.560 Test Loss: 1.171 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.0726170539855957
Epoch: 15, Steps: 4 | Train Loss: 0.044 Vali Loss: 1.212 Vali Acc: 0.460 Test Loss: 1.212 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.031499147415161
Epoch: 16, Steps: 4 | Train Loss: 0.040 Vali Loss: 1.287 Vali Acc: 0.580 Test Loss: 1.287 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.986266851425171
Epoch: 17, Steps: 4 | Train Loss: 0.027 Vali Loss: 1.214 Vali Acc: 0.520 Test Loss: 1.214 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.1553547382354736
Epoch: 18, Steps: 4 | Train Loss: 0.026 Vali Loss: 1.385 Vali Acc: 0.540 Test Loss: 1.385 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.2438228130340576
Epoch: 19, Steps: 4 | Train Loss: 0.024 Vali Loss: 1.349 Vali Acc: 0.580 Test Loss: 1.349 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.08880877494812
Epoch: 20, Steps: 4 | Train Loss: 0.008 Vali Loss: 1.281 Vali Acc: 0.520 Test Loss: 1.281 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.9123210906982422
Epoch: 21, Steps: 4 | Train Loss: 0.020 Vali Loss: 1.400 Vali Acc: 0.500 Test Loss: 1.400 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm64_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 5853125
model size : 23.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm64_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 6.422196865081787
Epoch: 1, Steps: 4 | Train Loss: 1.697 Vali Loss: 1.659 Vali Acc: 0.200 Test Loss: 1.659 Test Acc: 0.200
Validation loss decreased (inf --> -0.199983).  Saving model ...
Epoch: 2 cost time: 4.1905927658081055
Epoch: 2, Steps: 4 | Train Loss: 1.500 Vali Loss: 1.639 Vali Acc: 0.220 Test Loss: 1.639 Test Acc: 0.220
Validation loss decreased (-0.199983 --> -0.219984).  Saving model ...
Epoch: 3 cost time: 4.697275638580322
Epoch: 3, Steps: 4 | Train Loss: 1.477 Vali Loss: 1.628 Vali Acc: 0.220 Test Loss: 1.628 Test Acc: 0.220
Validation loss decreased (-0.219984 --> -0.219984).  Saving model ...
Epoch: 4 cost time: 4.412976980209351
Epoch: 4, Steps: 4 | Train Loss: 1.209 Vali Loss: 1.579 Vali Acc: 0.260 Test Loss: 1.579 Test Acc: 0.260
Validation loss decreased (-0.219984 --> -0.259984).  Saving model ...
Epoch: 5 cost time: 4.4625701904296875
Epoch: 5, Steps: 4 | Train Loss: 0.954 Vali Loss: 1.497 Vali Acc: 0.320 Test Loss: 1.497 Test Acc: 0.320
Validation loss decreased (-0.259984 --> -0.319985).  Saving model ...
Epoch: 6 cost time: 4.679623126983643
Epoch: 6, Steps: 4 | Train Loss: 0.872 Vali Loss: 1.415 Vali Acc: 0.440 Test Loss: 1.415 Test Acc: 0.440
Validation loss decreased (-0.319985 --> -0.439986).  Saving model ...
Epoch: 7 cost time: 4.502913475036621
Epoch: 7, Steps: 4 | Train Loss: 0.570 Vali Loss: 1.336 Vali Acc: 0.480 Test Loss: 1.336 Test Acc: 0.480
Validation loss decreased (-0.439986 --> -0.479987).  Saving model ...
Epoch: 8 cost time: 4.946378231048584
Epoch: 8, Steps: 4 | Train Loss: 0.411 Vali Loss: 1.255 Vali Acc: 0.500 Test Loss: 1.255 Test Acc: 0.500
Validation loss decreased (-0.479987 --> -0.499987).  Saving model ...
Epoch: 9 cost time: 4.163986444473267
Epoch: 9, Steps: 4 | Train Loss: 0.493 Vali Loss: 1.200 Vali Acc: 0.500 Test Loss: 1.200 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499988).  Saving model ...
Epoch: 10 cost time: 4.2511820793151855
Epoch: 10, Steps: 4 | Train Loss: 0.241 Vali Loss: 1.227 Vali Acc: 0.540 Test Loss: 1.227 Test Acc: 0.540
Validation loss decreased (-0.499988 --> -0.539988).  Saving model ...
Epoch: 11 cost time: 2.9364819526672363
Epoch: 11, Steps: 4 | Train Loss: 0.186 Vali Loss: 1.225 Vali Acc: 0.500 Test Loss: 1.225 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.4187190532684326
Epoch: 12, Steps: 4 | Train Loss: 0.134 Vali Loss: 1.264 Vali Acc: 0.520 Test Loss: 1.264 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.273334264755249
Epoch: 13, Steps: 4 | Train Loss: 0.113 Vali Loss: 1.220 Vali Acc: 0.500 Test Loss: 1.220 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.52925181388855
Epoch: 14, Steps: 4 | Train Loss: 0.075 Vali Loss: 1.236 Vali Acc: 0.520 Test Loss: 1.236 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 4.2138495445251465
Epoch: 15, Steps: 4 | Train Loss: 0.057 Vali Loss: 1.321 Vali Acc: 0.520 Test Loss: 1.321 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 4.256223917007446
Epoch: 16, Steps: 4 | Train Loss: 0.034 Vali Loss: 1.413 Vali Acc: 0.500 Test Loss: 1.413 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 4.57137131690979
Epoch: 17, Steps: 4 | Train Loss: 0.031 Vali Loss: 1.447 Vali Acc: 0.600 Test Loss: 1.447 Test Acc: 0.600
Validation loss decreased (-0.539988 --> -0.599986).  Saving model ...
Epoch: 18 cost time: 4.30417537689209
Epoch: 18, Steps: 4 | Train Loss: 0.022 Vali Loss: 1.247 Vali Acc: 0.540 Test Loss: 1.247 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.396363258361816
Epoch: 19, Steps: 4 | Train Loss: 0.012 Vali Loss: 1.228 Vali Acc: 0.580 Test Loss: 1.228 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.514095783233643
Epoch: 20, Steps: 4 | Train Loss: 0.010 Vali Loss: 1.322 Vali Acc: 0.600 Test Loss: 1.322 Test Acc: 0.600
Validation loss decreased (-0.599986 --> -0.599987).  Saving model ...
Epoch: 21 cost time: 4.684696674346924
Epoch: 21, Steps: 4 | Train Loss: 0.008 Vali Loss: 1.413 Vali Acc: 0.540 Test Loss: 1.413 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.4049248695373535
Epoch: 22, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.443 Vali Acc: 0.540 Test Loss: 1.443 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 4.8165271282196045
Epoch: 23, Steps: 4 | Train Loss: 0.009 Vali Loss: 1.496 Vali Acc: 0.520 Test Loss: 1.496 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 4.812786102294922
Epoch: 24, Steps: 4 | Train Loss: 0.007 Vali Loss: 1.594 Vali Acc: 0.540 Test Loss: 1.594 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.9625627994537354
Epoch: 25, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.636 Vali Acc: 0.600 Test Loss: 1.636 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 4.637220621109009
Epoch: 26, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.607 Vali Acc: 0.600 Test Loss: 1.607 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 5.020105361938477
Epoch: 27, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.614 Vali Acc: 0.580 Test Loss: 1.614 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 4.645443916320801
Epoch: 28, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.621 Vali Acc: 0.600 Test Loss: 1.621 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 4.771919012069702
Epoch: 29, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.593 Vali Acc: 0.580 Test Loss: 1.593 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 4.8909993171691895
Epoch: 30, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.571 Vali Acc: 0.560 Test Loss: 1.571 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm64_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 9719749
model size : 38.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm64_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.884775400161743
Epoch: 1, Steps: 4 | Train Loss: 1.674 Vali Loss: 1.691 Vali Acc: 0.140 Test Loss: 1.691 Test Acc: 0.140
Validation loss decreased (inf --> -0.139983).  Saving model ...
Epoch: 2 cost time: 2.276228666305542
Epoch: 2, Steps: 4 | Train Loss: 1.672 Vali Loss: 1.667 Vali Acc: 0.180 Test Loss: 1.667 Test Acc: 0.180
Validation loss decreased (-0.139983 --> -0.179983).  Saving model ...
Epoch: 3 cost time: 2.2716763019561768
Epoch: 3, Steps: 4 | Train Loss: 1.600 Vali Loss: 1.650 Vali Acc: 0.220 Test Loss: 1.650 Test Acc: 0.220
Validation loss decreased (-0.179983 --> -0.219983).  Saving model ...
Epoch: 4 cost time: 2.2969882488250732
Epoch: 4, Steps: 4 | Train Loss: 1.221 Vali Loss: 1.585 Vali Acc: 0.300 Test Loss: 1.585 Test Acc: 0.300
Validation loss decreased (-0.219983 --> -0.299984).  Saving model ...
Epoch: 5 cost time: 2.423872470855713
Epoch: 5, Steps: 4 | Train Loss: 1.015 Vali Loss: 1.501 Vali Acc: 0.320 Test Loss: 1.501 Test Acc: 0.320
Validation loss decreased (-0.299984 --> -0.319985).  Saving model ...
Epoch: 6 cost time: 2.284816026687622
Epoch: 6, Steps: 4 | Train Loss: 0.911 Vali Loss: 1.425 Vali Acc: 0.360 Test Loss: 1.425 Test Acc: 0.360
Validation loss decreased (-0.319985 --> -0.359986).  Saving model ...
Epoch: 7 cost time: 2.2427611351013184
Epoch: 7, Steps: 4 | Train Loss: 0.591 Vali Loss: 1.349 Vali Acc: 0.380 Test Loss: 1.349 Test Acc: 0.380
Validation loss decreased (-0.359986 --> -0.379987).  Saving model ...
Epoch: 8 cost time: 2.361760377883911
Epoch: 8, Steps: 4 | Train Loss: 0.439 Vali Loss: 1.301 Vali Acc: 0.440 Test Loss: 1.301 Test Acc: 0.440
Validation loss decreased (-0.379987 --> -0.439987).  Saving model ...
Epoch: 9 cost time: 2.4469525814056396
Epoch: 9, Steps: 4 | Train Loss: 0.358 Vali Loss: 1.228 Vali Acc: 0.500 Test Loss: 1.228 Test Acc: 0.500
Validation loss decreased (-0.439987 --> -0.499988).  Saving model ...
Epoch: 10 cost time: 2.3581502437591553
Epoch: 10, Steps: 4 | Train Loss: 0.290 Vali Loss: 1.181 Vali Acc: 0.480 Test Loss: 1.181 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.5856266021728516
Epoch: 11, Steps: 4 | Train Loss: 0.284 Vali Loss: 1.153 Vali Acc: 0.520 Test Loss: 1.153 Test Acc: 0.520
Validation loss decreased (-0.499988 --> -0.519988).  Saving model ...
Epoch: 12 cost time: 2.1896018981933594
Epoch: 12, Steps: 4 | Train Loss: 0.511 Vali Loss: 1.239 Vali Acc: 0.480 Test Loss: 1.239 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.5461442470550537
Epoch: 13, Steps: 4 | Train Loss: 0.099 Vali Loss: 1.174 Vali Acc: 0.480 Test Loss: 1.174 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.54789662361145
Epoch: 14, Steps: 4 | Train Loss: 0.073 Vali Loss: 1.252 Vali Acc: 0.500 Test Loss: 1.252 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.5820679664611816
Epoch: 15, Steps: 4 | Train Loss: 0.054 Vali Loss: 1.260 Vali Acc: 0.560 Test Loss: 1.260 Test Acc: 0.560
Validation loss decreased (-0.519988 --> -0.559987).  Saving model ...
Epoch: 16 cost time: 2.316303014755249
Epoch: 16, Steps: 4 | Train Loss: 0.032 Vali Loss: 1.305 Vali Acc: 0.520 Test Loss: 1.305 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.3541135787963867
Epoch: 17, Steps: 4 | Train Loss: 0.027 Vali Loss: 1.235 Vali Acc: 0.500 Test Loss: 1.235 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.50492525100708
Epoch: 18, Steps: 4 | Train Loss: 0.030 Vali Loss: 1.300 Vali Acc: 0.500 Test Loss: 1.300 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.3677966594696045
Epoch: 19, Steps: 4 | Train Loss: 0.086 Vali Loss: 1.621 Vali Acc: 0.520 Test Loss: 1.621 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.431375026702881
Epoch: 20, Steps: 4 | Train Loss: 0.023 Vali Loss: 1.410 Vali Acc: 0.540 Test Loss: 1.410 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.1985697746276855
Epoch: 21, Steps: 4 | Train Loss: 0.011 Vali Loss: 1.366 Vali Acc: 0.480 Test Loss: 1.366 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.2940115928649902
Epoch: 22, Steps: 4 | Train Loss: 0.008 Vali Loss: 1.451 Vali Acc: 0.540 Test Loss: 1.451 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.5118656158447266
Epoch: 23, Steps: 4 | Train Loss: 0.006 Vali Loss: 1.544 Vali Acc: 0.560 Test Loss: 1.544 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.9168739318847656
Epoch: 24, Steps: 4 | Train Loss: 0.017 Vali Loss: 1.452 Vali Acc: 0.520 Test Loss: 1.452 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.138500928878784
Epoch: 25, Steps: 4 | Train Loss: 0.007 Vali Loss: 1.400 Vali Acc: 0.560 Test Loss: 1.400 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm64_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 3099589
model size : 13.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm64_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.9669036865234375
Epoch: 1, Steps: 4 | Train Loss: 1.697 Vali Loss: 1.659 Vali Acc: 0.200 Test Loss: 1.659 Test Acc: 0.200
Validation loss decreased (inf --> -0.199983).  Saving model ...
Epoch: 2 cost time: 3.290508508682251
Epoch: 2, Steps: 4 | Train Loss: 1.500 Vali Loss: 1.639 Vali Acc: 0.220 Test Loss: 1.639 Test Acc: 0.220
Validation loss decreased (-0.199983 --> -0.219984).  Saving model ...
Epoch: 3 cost time: 3.0461390018463135
Epoch: 3, Steps: 4 | Train Loss: 1.477 Vali Loss: 1.628 Vali Acc: 0.220 Test Loss: 1.628 Test Acc: 0.220
Validation loss decreased (-0.219984 --> -0.219984).  Saving model ...
Epoch: 4 cost time: 3.557485342025757
Epoch: 4, Steps: 4 | Train Loss: 1.209 Vali Loss: 1.581 Vali Acc: 0.240 Test Loss: 1.581 Test Acc: 0.240
Validation loss decreased (-0.219984 --> -0.239984).  Saving model ...
Epoch: 5 cost time: 3.0303845405578613
Epoch: 5, Steps: 4 | Train Loss: 0.954 Vali Loss: 1.501 Vali Acc: 0.320 Test Loss: 1.501 Test Acc: 0.320
Validation loss decreased (-0.239984 --> -0.319985).  Saving model ...
Epoch: 6 cost time: 3.59326171875
Epoch: 6, Steps: 4 | Train Loss: 0.871 Vali Loss: 1.422 Vali Acc: 0.420 Test Loss: 1.422 Test Acc: 0.420
Validation loss decreased (-0.319985 --> -0.419986).  Saving model ...
Epoch: 7 cost time: 3.5452497005462646
Epoch: 7, Steps: 4 | Train Loss: 0.571 Vali Loss: 1.343 Vali Acc: 0.480 Test Loss: 1.343 Test Acc: 0.480
Validation loss decreased (-0.419986 --> -0.479987).  Saving model ...
Epoch: 8 cost time: 3.667239189147949
Epoch: 8, Steps: 4 | Train Loss: 0.411 Vali Loss: 1.263 Vali Acc: 0.480 Test Loss: 1.263 Test Acc: 0.480
Validation loss decreased (-0.479987 --> -0.479987).  Saving model ...
Epoch: 9 cost time: 3.4595162868499756
Epoch: 9, Steps: 4 | Train Loss: 0.494 Vali Loss: 1.211 Vali Acc: 0.500 Test Loss: 1.211 Test Acc: 0.500
Validation loss decreased (-0.479987 --> -0.499988).  Saving model ...
Epoch: 10 cost time: 3.4812963008880615
Epoch: 10, Steps: 4 | Train Loss: 0.241 Vali Loss: 1.240 Vali Acc: 0.540 Test Loss: 1.240 Test Acc: 0.540
Validation loss decreased (-0.499988 --> -0.539988).  Saving model ...
Epoch: 11 cost time: 3.719378709793091
Epoch: 11, Steps: 4 | Train Loss: 0.189 Vali Loss: 1.240 Vali Acc: 0.500 Test Loss: 1.240 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.5664799213409424
Epoch: 12, Steps: 4 | Train Loss: 0.134 Vali Loss: 1.272 Vali Acc: 0.540 Test Loss: 1.272 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.571375846862793
Epoch: 13, Steps: 4 | Train Loss: 0.113 Vali Loss: 1.213 Vali Acc: 0.500 Test Loss: 1.213 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.3509624004364014
Epoch: 14, Steps: 4 | Train Loss: 0.073 Vali Loss: 1.232 Vali Acc: 0.560 Test Loss: 1.232 Test Acc: 0.560
Validation loss decreased (-0.539988 --> -0.559988).  Saving model ...
Epoch: 15 cost time: 3.7771084308624268
Epoch: 15, Steps: 4 | Train Loss: 0.059 Vali Loss: 1.340 Vali Acc: 0.520 Test Loss: 1.340 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.5545389652252197
Epoch: 16, Steps: 4 | Train Loss: 0.034 Vali Loss: 1.485 Vali Acc: 0.520 Test Loss: 1.485 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.671064853668213
Epoch: 17, Steps: 4 | Train Loss: 0.034 Vali Loss: 1.433 Vali Acc: 0.640 Test Loss: 1.433 Test Acc: 0.640
Validation loss decreased (-0.559988 --> -0.639986).  Saving model ...
Epoch: 18 cost time: 3.425278663635254
Epoch: 18, Steps: 4 | Train Loss: 0.022 Vali Loss: 1.191 Vali Acc: 0.540 Test Loss: 1.191 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.514822483062744
Epoch: 19, Steps: 4 | Train Loss: 0.012 Vali Loss: 1.207 Vali Acc: 0.580 Test Loss: 1.207 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.6735033988952637
Epoch: 20, Steps: 4 | Train Loss: 0.010 Vali Loss: 1.298 Vali Acc: 0.540 Test Loss: 1.298 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.521568775177002
Epoch: 21, Steps: 4 | Train Loss: 0.007 Vali Loss: 1.349 Vali Acc: 0.520 Test Loss: 1.349 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.695462226867676
Epoch: 22, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.351 Vali Acc: 0.500 Test Loss: 1.351 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.502117395401001
Epoch: 23, Steps: 4 | Train Loss: 0.007 Vali Loss: 1.374 Vali Acc: 0.520 Test Loss: 1.374 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 3.5780234336853027
Epoch: 24, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.375 Vali Acc: 0.580 Test Loss: 1.375 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.9343421459198
Epoch: 25, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.381 Vali Acc: 0.540 Test Loss: 1.381 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 3.0654265880584717
Epoch: 26, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.390 Vali Acc: 0.540 Test Loss: 1.390 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 3.4040374755859375
Epoch: 27, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.437 Vali Acc: 0.560 Test Loss: 1.437 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm64_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.64
model parameter : 9719749
model size : 38.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm64_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.631686210632324
Epoch: 1, Steps: 4 | Train Loss: 1.674 Vali Loss: 1.691 Vali Acc: 0.140 Test Loss: 1.691 Test Acc: 0.140
Validation loss decreased (inf --> -0.139983).  Saving model ...
Epoch: 2 cost time: 1.8580436706542969
Epoch: 2, Steps: 4 | Train Loss: 1.673 Vali Loss: 1.667 Vali Acc: 0.180 Test Loss: 1.667 Test Acc: 0.180
Validation loss decreased (-0.139983 --> -0.179983).  Saving model ...
Epoch: 3 cost time: 1.993790626525879
Epoch: 3, Steps: 4 | Train Loss: 1.600 Vali Loss: 1.651 Vali Acc: 0.220 Test Loss: 1.651 Test Acc: 0.220
Validation loss decreased (-0.179983 --> -0.219983).  Saving model ...
Epoch: 4 cost time: 1.822265863418579
Epoch: 4, Steps: 4 | Train Loss: 1.222 Vali Loss: 1.585 Vali Acc: 0.300 Test Loss: 1.585 Test Acc: 0.300
Validation loss decreased (-0.219983 --> -0.299984).  Saving model ...
Epoch: 5 cost time: 1.922072410583496
Epoch: 5, Steps: 4 | Train Loss: 1.015 Vali Loss: 1.501 Vali Acc: 0.320 Test Loss: 1.501 Test Acc: 0.320
Validation loss decreased (-0.299984 --> -0.319985).  Saving model ...
Epoch: 6 cost time: 1.6894075870513916
Epoch: 6, Steps: 4 | Train Loss: 0.910 Vali Loss: 1.426 Vali Acc: 0.360 Test Loss: 1.426 Test Acc: 0.360
Validation loss decreased (-0.319985 --> -0.359986).  Saving model ...
Epoch: 7 cost time: 1.948183298110962
Epoch: 7, Steps: 4 | Train Loss: 0.591 Vali Loss: 1.351 Vali Acc: 0.380 Test Loss: 1.351 Test Acc: 0.380
Validation loss decreased (-0.359986 --> -0.379986).  Saving model ...
Epoch: 8 cost time: 1.417759895324707
Epoch: 8, Steps: 4 | Train Loss: 0.438 Vali Loss: 1.307 Vali Acc: 0.440 Test Loss: 1.307 Test Acc: 0.440
Validation loss decreased (-0.379986 --> -0.439987).  Saving model ...
Epoch: 9 cost time: 1.4971435070037842
Epoch: 9, Steps: 4 | Train Loss: 0.358 Vali Loss: 1.234 Vali Acc: 0.500 Test Loss: 1.234 Test Acc: 0.500
Validation loss decreased (-0.439987 --> -0.499988).  Saving model ...
Epoch: 10 cost time: 1.7107317447662354
Epoch: 10, Steps: 4 | Train Loss: 0.291 Vali Loss: 1.179 Vali Acc: 0.480 Test Loss: 1.179 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8562164306640625
Epoch: 11, Steps: 4 | Train Loss: 0.283 Vali Loss: 1.149 Vali Acc: 0.540 Test Loss: 1.149 Test Acc: 0.540
Validation loss decreased (-0.499988 --> -0.539989).  Saving model ...
Epoch: 12 cost time: 1.7168583869934082
Epoch: 12, Steps: 4 | Train Loss: 0.509 Vali Loss: 1.225 Vali Acc: 0.520 Test Loss: 1.225 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5616071224212646
Epoch: 13, Steps: 4 | Train Loss: 0.100 Vali Loss: 1.149 Vali Acc: 0.500 Test Loss: 1.149 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.080784559249878
Epoch: 14, Steps: 4 | Train Loss: 0.074 Vali Loss: 1.225 Vali Acc: 0.540 Test Loss: 1.225 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.6495869159698486
Epoch: 15, Steps: 4 | Train Loss: 0.055 Vali Loss: 1.222 Vali Acc: 0.560 Test Loss: 1.222 Test Acc: 0.560
Validation loss decreased (-0.539989 --> -0.559988).  Saving model ...
Epoch: 16 cost time: 1.84743332862854
Epoch: 16, Steps: 4 | Train Loss: 0.032 Vali Loss: 1.259 Vali Acc: 0.540 Test Loss: 1.259 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.53702712059021
Epoch: 17, Steps: 4 | Train Loss: 0.027 Vali Loss: 1.189 Vali Acc: 0.520 Test Loss: 1.189 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.288184642791748
Epoch: 18, Steps: 4 | Train Loss: 0.030 Vali Loss: 1.250 Vali Acc: 0.520 Test Loss: 1.250 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.5942914485931396
Epoch: 19, Steps: 4 | Train Loss: 0.087 Vali Loss: 1.564 Vali Acc: 0.580 Test Loss: 1.564 Test Acc: 0.580
Validation loss decreased (-0.559988 --> -0.579984).  Saving model ...
Epoch: 20 cost time: 1.974654197692871
Epoch: 20, Steps: 4 | Train Loss: 0.023 Vali Loss: 1.349 Vali Acc: 0.580 Test Loss: 1.349 Test Acc: 0.580
Validation loss decreased (-0.579984 --> -0.579987).  Saving model ...
Epoch: 21 cost time: 1.8325788974761963
Epoch: 21, Steps: 4 | Train Loss: 0.011 Vali Loss: 1.317 Vali Acc: 0.520 Test Loss: 1.317 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.8903791904449463
Epoch: 22, Steps: 4 | Train Loss: 0.009 Vali Loss: 1.415 Vali Acc: 0.540 Test Loss: 1.415 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.6417663097381592
Epoch: 23, Steps: 4 | Train Loss: 0.006 Vali Loss: 1.530 Vali Acc: 0.560 Test Loss: 1.530 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.798827886581421
Epoch: 24, Steps: 4 | Train Loss: 0.019 Vali Loss: 1.430 Vali Acc: 0.540 Test Loss: 1.430 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.701225757598877
Epoch: 25, Steps: 4 | Train Loss: 0.007 Vali Loss: 1.360 Vali Acc: 0.560 Test Loss: 1.360 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.947849988937378
Epoch: 26, Steps: 4 | Train Loss: 0.008 Vali Loss: 1.403 Vali Acc: 0.500 Test Loss: 1.403 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.9946215152740479
Epoch: 27, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.551 Vali Acc: 0.540 Test Loss: 1.551 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.8474600315093994
Epoch: 28, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.526 Vali Acc: 0.540 Test Loss: 1.526 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.9991066455841064
Epoch: 29, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.481 Vali Acc: 0.540 Test Loss: 1.481 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.8753149509429932
Epoch: 30, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.452 Vali Acc: 0.540 Test Loss: 1.452 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm64_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 3099589
model size : 13.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm64_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.702768325805664
Epoch: 1, Steps: 4 | Train Loss: 1.697 Vali Loss: 1.657 Vali Acc: 0.200 Test Loss: 1.657 Test Acc: 0.200
Validation loss decreased (inf --> -0.199983).  Saving model ...
Epoch: 2 cost time: 2.376218795776367
Epoch: 2, Steps: 4 | Train Loss: 1.501 Vali Loss: 1.649 Vali Acc: 0.220 Test Loss: 1.649 Test Acc: 0.220
Validation loss decreased (-0.199983 --> -0.219984).  Saving model ...
Epoch: 3 cost time: 2.320465087890625
Epoch: 3, Steps: 4 | Train Loss: 1.481 Vali Loss: 1.641 Vali Acc: 0.200 Test Loss: 1.641 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.367414712905884
Epoch: 4, Steps: 4 | Train Loss: 1.219 Vali Loss: 1.595 Vali Acc: 0.240 Test Loss: 1.595 Test Acc: 0.240
Validation loss decreased (-0.219984 --> -0.239984).  Saving model ...
Epoch: 5 cost time: 2.3856568336486816
Epoch: 5, Steps: 4 | Train Loss: 0.968 Vali Loss: 1.506 Vali Acc: 0.300 Test Loss: 1.506 Test Acc: 0.300
Validation loss decreased (-0.239984 --> -0.299985).  Saving model ...
Epoch: 6 cost time: 2.2526841163635254
Epoch: 6, Steps: 4 | Train Loss: 0.882 Vali Loss: 1.426 Vali Acc: 0.400 Test Loss: 1.426 Test Acc: 0.400
Validation loss decreased (-0.299985 --> -0.399986).  Saving model ...
Epoch: 7 cost time: 2.363792657852173
Epoch: 7, Steps: 4 | Train Loss: 0.586 Vali Loss: 1.354 Vali Acc: 0.460 Test Loss: 1.354 Test Acc: 0.460
Validation loss decreased (-0.399986 --> -0.459986).  Saving model ...
Epoch: 8 cost time: 2.3530611991882324
Epoch: 8, Steps: 4 | Train Loss: 0.484 Vali Loss: 1.282 Vali Acc: 0.440 Test Loss: 1.282 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.4404220581054688
Epoch: 9, Steps: 4 | Train Loss: 0.507 Vali Loss: 1.218 Vali Acc: 0.480 Test Loss: 1.218 Test Acc: 0.480
Validation loss decreased (-0.459986 --> -0.479988).  Saving model ...
Epoch: 10 cost time: 2.260619878768921
Epoch: 10, Steps: 4 | Train Loss: 0.262 Vali Loss: 1.225 Vali Acc: 0.500 Test Loss: 1.225 Test Acc: 0.500
Validation loss decreased (-0.479988 --> -0.499988).  Saving model ...
Epoch: 11 cost time: 2.399832010269165
Epoch: 11, Steps: 4 | Train Loss: 0.204 Vali Loss: 1.224 Vali Acc: 0.500 Test Loss: 1.224 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 12 cost time: 1.9424560070037842
Epoch: 12, Steps: 4 | Train Loss: 0.142 Vali Loss: 1.274 Vali Acc: 0.520 Test Loss: 1.274 Test Acc: 0.520
Validation loss decreased (-0.499988 --> -0.519987).  Saving model ...
Epoch: 13 cost time: 2.077998638153076
Epoch: 13, Steps: 4 | Train Loss: 0.125 Vali Loss: 1.218 Vali Acc: 0.500 Test Loss: 1.218 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.021082878112793
Epoch: 14, Steps: 4 | Train Loss: 0.078 Vali Loss: 1.246 Vali Acc: 0.500 Test Loss: 1.246 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.2485568523406982
Epoch: 15, Steps: 4 | Train Loss: 0.067 Vali Loss: 1.379 Vali Acc: 0.480 Test Loss: 1.379 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.178919792175293
Epoch: 16, Steps: 4 | Train Loss: 0.042 Vali Loss: 1.474 Vali Acc: 0.500 Test Loss: 1.474 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.4280292987823486
Epoch: 17, Steps: 4 | Train Loss: 0.034 Vali Loss: 1.404 Vali Acc: 0.540 Test Loss: 1.404 Test Acc: 0.540
Validation loss decreased (-0.519987 --> -0.539986).  Saving model ...
Epoch: 18 cost time: 2.3568100929260254
Epoch: 18, Steps: 4 | Train Loss: 0.025 Vali Loss: 1.217 Vali Acc: 0.520 Test Loss: 1.217 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.4283337593078613
Epoch: 19, Steps: 4 | Train Loss: 0.016 Vali Loss: 1.339 Vali Acc: 0.520 Test Loss: 1.339 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.0356595516204834
Epoch: 20, Steps: 4 | Train Loss: 0.013 Vali Loss: 1.446 Vali Acc: 0.520 Test Loss: 1.446 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.3687455654144287
Epoch: 21, Steps: 4 | Train Loss: 0.008 Vali Loss: 1.452 Vali Acc: 0.500 Test Loss: 1.452 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.1359033584594727
Epoch: 22, Steps: 4 | Train Loss: 0.007 Vali Loss: 1.487 Vali Acc: 0.500 Test Loss: 1.487 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.535482168197632
Epoch: 23, Steps: 4 | Train Loss: 0.008 Vali Loss: 1.500 Vali Acc: 0.520 Test Loss: 1.500 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.273954391479492
Epoch: 24, Steps: 4 | Train Loss: 0.006 Vali Loss: 1.463 Vali Acc: 0.520 Test Loss: 1.463 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.3173751831054688
Epoch: 25, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.474 Vali Acc: 0.500 Test Loss: 1.474 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.070816993713379
Epoch: 26, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.499 Vali Acc: 0.500 Test Loss: 1.499 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.31809401512146
Epoch: 27, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.710 Vali Acc: 0.520 Test Loss: 1.710 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm64_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 9719749
model size : 38.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm64_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.7213990688323975
Epoch: 1, Steps: 4 | Train Loss: 1.672 Vali Loss: 1.690 Vali Acc: 0.140 Test Loss: 1.690 Test Acc: 0.140
Validation loss decreased (inf --> -0.139983).  Saving model ...
Epoch: 2 cost time: 1.3621277809143066
Epoch: 2, Steps: 4 | Train Loss: 1.673 Vali Loss: 1.667 Vali Acc: 0.180 Test Loss: 1.667 Test Acc: 0.180
Validation loss decreased (-0.139983 --> -0.179983).  Saving model ...
Epoch: 3 cost time: 1.3504009246826172
Epoch: 3, Steps: 4 | Train Loss: 1.602 Vali Loss: 1.652 Vali Acc: 0.220 Test Loss: 1.652 Test Acc: 0.220
Validation loss decreased (-0.179983 --> -0.219983).  Saving model ...
Epoch: 4 cost time: 1.1971831321716309
Epoch: 4, Steps: 4 | Train Loss: 1.229 Vali Loss: 1.587 Vali Acc: 0.300 Test Loss: 1.587 Test Acc: 0.300
Validation loss decreased (-0.219983 --> -0.299984).  Saving model ...
Epoch: 5 cost time: 1.3253307342529297
Epoch: 5, Steps: 4 | Train Loss: 1.027 Vali Loss: 1.503 Vali Acc: 0.340 Test Loss: 1.503 Test Acc: 0.340
Validation loss decreased (-0.299984 --> -0.339985).  Saving model ...
Epoch: 6 cost time: 1.1146271228790283
Epoch: 6, Steps: 4 | Train Loss: 0.926 Vali Loss: 1.427 Vali Acc: 0.360 Test Loss: 1.427 Test Acc: 0.360
Validation loss decreased (-0.339985 --> -0.359986).  Saving model ...
Epoch: 7 cost time: 1.141448974609375
Epoch: 7, Steps: 4 | Train Loss: 0.610 Vali Loss: 1.347 Vali Acc: 0.420 Test Loss: 1.347 Test Acc: 0.420
Validation loss decreased (-0.359986 --> -0.419987).  Saving model ...
Epoch: 8 cost time: 1.2401633262634277
Epoch: 8, Steps: 4 | Train Loss: 0.460 Vali Loss: 1.294 Vali Acc: 0.480 Test Loss: 1.294 Test Acc: 0.480
Validation loss decreased (-0.419987 --> -0.479987).  Saving model ...
Epoch: 9 cost time: 1.367988109588623
Epoch: 9, Steps: 4 | Train Loss: 0.377 Vali Loss: 1.222 Vali Acc: 0.460 Test Loss: 1.222 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5311329364776611
Epoch: 10, Steps: 4 | Train Loss: 0.306 Vali Loss: 1.179 Vali Acc: 0.460 Test Loss: 1.179 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.594463586807251
Epoch: 11, Steps: 4 | Train Loss: 0.289 Vali Loss: 1.134 Vali Acc: 0.500 Test Loss: 1.134 Test Acc: 0.500
Validation loss decreased (-0.479987 --> -0.499989).  Saving model ...
Epoch: 12 cost time: 1.5081591606140137
Epoch: 12, Steps: 4 | Train Loss: 0.512 Vali Loss: 1.205 Vali Acc: 0.520 Test Loss: 1.205 Test Acc: 0.520
Validation loss decreased (-0.499989 --> -0.519988).  Saving model ...
Epoch: 13 cost time: 1.5271623134613037
Epoch: 13, Steps: 4 | Train Loss: 0.105 Vali Loss: 1.131 Vali Acc: 0.500 Test Loss: 1.131 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.5037024021148682
Epoch: 14, Steps: 4 | Train Loss: 0.077 Vali Loss: 1.221 Vali Acc: 0.560 Test Loss: 1.221 Test Acc: 0.560
Validation loss decreased (-0.519988 --> -0.559988).  Saving model ...
Epoch: 15 cost time: 1.6111435890197754
Epoch: 15, Steps: 4 | Train Loss: 0.060 Vali Loss: 1.182 Vali Acc: 0.560 Test Loss: 1.182 Test Acc: 0.560
Validation loss decreased (-0.559988 --> -0.559988).  Saving model ...
Epoch: 16 cost time: 1.6748921871185303
Epoch: 16, Steps: 4 | Train Loss: 0.038 Vali Loss: 1.205 Vali Acc: 0.500 Test Loss: 1.205 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.5682127475738525
Epoch: 17, Steps: 4 | Train Loss: 0.035 Vali Loss: 1.158 Vali Acc: 0.520 Test Loss: 1.158 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.447615146636963
Epoch: 18, Steps: 4 | Train Loss: 0.033 Vali Loss: 1.220 Vali Acc: 0.560 Test Loss: 1.220 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.6350691318511963
Epoch: 19, Steps: 4 | Train Loss: 0.074 Vali Loss: 1.550 Vali Acc: 0.560 Test Loss: 1.550 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.5981144905090332
Epoch: 20, Steps: 4 | Train Loss: 0.023 Vali Loss: 1.336 Vali Acc: 0.540 Test Loss: 1.336 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.5706572532653809
Epoch: 21, Steps: 4 | Train Loss: 0.010 Vali Loss: 1.307 Vali Acc: 0.540 Test Loss: 1.307 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.5941228866577148
Epoch: 22, Steps: 4 | Train Loss: 0.010 Vali Loss: 1.355 Vali Acc: 0.540 Test Loss: 1.355 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.7040424346923828
Epoch: 23, Steps: 4 | Train Loss: 0.007 Vali Loss: 1.355 Vali Acc: 0.540 Test Loss: 1.355 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.5837628841400146
Epoch: 24, Steps: 4 | Train Loss: 0.008 Vali Loss: 1.307 Vali Acc: 0.520 Test Loss: 1.307 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.4447026252746582
Epoch: 25, Steps: 4 | Train Loss: 0.008 Vali Loss: 1.297 Vali Acc: 0.520 Test Loss: 1.297 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm64_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 3099589
model size : 13.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm32_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 7.19282603263855
Epoch: 1, Steps: 4 | Train Loss: 1.716 Vali Loss: 1.712 Vali Acc: 0.280 Test Loss: 1.712 Test Acc: 0.280
Validation loss decreased (inf --> -0.279983).  Saving model ...
Epoch: 2 cost time: 6.010847330093384
Epoch: 2, Steps: 4 | Train Loss: 1.625 Vali Loss: 1.693 Vali Acc: 0.300 Test Loss: 1.693 Test Acc: 0.300
Validation loss decreased (-0.279983 --> -0.299983).  Saving model ...
Epoch: 3 cost time: 6.424152374267578
Epoch: 3, Steps: 4 | Train Loss: 1.471 Vali Loss: 1.668 Vali Acc: 0.380 Test Loss: 1.668 Test Acc: 0.380
Validation loss decreased (-0.299983 --> -0.379983).  Saving model ...
Epoch: 4 cost time: 5.530232906341553
Epoch: 4, Steps: 4 | Train Loss: 1.337 Vali Loss: 1.662 Vali Acc: 0.380 Test Loss: 1.662 Test Acc: 0.380
Validation loss decreased (-0.379983 --> -0.379983).  Saving model ...
Epoch: 5 cost time: 6.309225559234619
Epoch: 5, Steps: 4 | Train Loss: 1.235 Vali Loss: 1.670 Vali Acc: 0.320 Test Loss: 1.670 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.717206716537476
Epoch: 6, Steps: 4 | Train Loss: 0.986 Vali Loss: 1.662 Vali Acc: 0.360 Test Loss: 1.662 Test Acc: 0.360
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.074102878570557
Epoch: 7, Steps: 4 | Train Loss: 0.993 Vali Loss: 1.616 Vali Acc: 0.380 Test Loss: 1.616 Test Acc: 0.380
Validation loss decreased (-0.379983 --> -0.379984).  Saving model ...
Epoch: 8 cost time: 6.0247743129730225
Epoch: 8, Steps: 4 | Train Loss: 0.646 Vali Loss: 1.541 Vali Acc: 0.460 Test Loss: 1.541 Test Acc: 0.460
Validation loss decreased (-0.379984 --> -0.459985).  Saving model ...
Epoch: 9 cost time: 6.248284816741943
Epoch: 9, Steps: 4 | Train Loss: 0.589 Vali Loss: 1.467 Vali Acc: 0.480 Test Loss: 1.467 Test Acc: 0.480
Validation loss decreased (-0.459985 --> -0.479985).  Saving model ...
Epoch: 10 cost time: 6.195307493209839
Epoch: 10, Steps: 4 | Train Loss: 0.715 Vali Loss: 1.445 Vali Acc: 0.520 Test Loss: 1.445 Test Acc: 0.520
Validation loss decreased (-0.479985 --> -0.519986).  Saving model ...
Epoch: 11 cost time: 5.876559257507324
Epoch: 11, Steps: 4 | Train Loss: 0.378 Vali Loss: 1.370 Vali Acc: 0.520 Test Loss: 1.370 Test Acc: 0.520
Validation loss decreased (-0.519986 --> -0.519986).  Saving model ...
Epoch: 12 cost time: 6.493621110916138
Epoch: 12, Steps: 4 | Train Loss: 0.274 Vali Loss: 1.362 Vali Acc: 0.500 Test Loss: 1.362 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.698540687561035
Epoch: 13, Steps: 4 | Train Loss: 0.242 Vali Loss: 1.354 Vali Acc: 0.500 Test Loss: 1.354 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 6.504411458969116
Epoch: 14, Steps: 4 | Train Loss: 0.191 Vali Loss: 1.425 Vali Acc: 0.500 Test Loss: 1.425 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.5904860496521
Epoch: 15, Steps: 4 | Train Loss: 0.128 Vali Loss: 1.376 Vali Acc: 0.440 Test Loss: 1.376 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 5.684614658355713
Epoch: 16, Steps: 4 | Train Loss: 0.116 Vali Loss: 1.401 Vali Acc: 0.520 Test Loss: 1.401 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 6.031972885131836
Epoch: 17, Steps: 4 | Train Loss: 0.082 Vali Loss: 1.383 Vali Acc: 0.580 Test Loss: 1.383 Test Acc: 0.580
Validation loss decreased (-0.519986 --> -0.579986).  Saving model ...
Epoch: 18 cost time: 5.232916355133057
Epoch: 18, Steps: 4 | Train Loss: 0.307 Vali Loss: 1.340 Vali Acc: 0.520 Test Loss: 1.340 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 5.156988620758057
Epoch: 19, Steps: 4 | Train Loss: 0.058 Vali Loss: 1.315 Vali Acc: 0.540 Test Loss: 1.315 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 5.321353435516357
Epoch: 20, Steps: 4 | Train Loss: 0.049 Vali Loss: 1.432 Vali Acc: 0.500 Test Loss: 1.432 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 5.0952277183532715
Epoch: 21, Steps: 4 | Train Loss: 0.036 Vali Loss: 1.503 Vali Acc: 0.520 Test Loss: 1.503 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 4.383099794387817
Epoch: 22, Steps: 4 | Train Loss: 0.032 Vali Loss: 1.465 Vali Acc: 0.540 Test Loss: 1.465 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 4.864819765090942
Epoch: 23, Steps: 4 | Train Loss: 0.022 Vali Loss: 1.456 Vali Acc: 0.520 Test Loss: 1.456 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 5.658309459686279
Epoch: 24, Steps: 4 | Train Loss: 0.019 Vali Loss: 1.535 Vali Acc: 0.540 Test Loss: 1.535 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 5.5281829833984375
Epoch: 25, Steps: 4 | Train Loss: 0.014 Vali Loss: 1.578 Vali Acc: 0.520 Test Loss: 1.578 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 6.0445396900177
Epoch: 26, Steps: 4 | Train Loss: 0.011 Vali Loss: 1.533 Vali Acc: 0.520 Test Loss: 1.533 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 5.5993592739105225
Epoch: 27, Steps: 4 | Train Loss: 0.011 Vali Loss: 1.470 Vali Acc: 0.500 Test Loss: 1.470 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm32_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 9548005
model size : 37.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm32_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.450176954269409
Epoch: 1, Steps: 4 | Train Loss: 1.646 Vali Loss: 1.603 Vali Acc: 0.160 Test Loss: 1.603 Test Acc: 0.160
Validation loss decreased (inf --> -0.159984).  Saving model ...
Epoch: 2 cost time: 3.070549964904785
Epoch: 2, Steps: 4 | Train Loss: 1.683 Vali Loss: 1.587 Vali Acc: 0.280 Test Loss: 1.587 Test Acc: 0.280
Validation loss decreased (-0.159984 --> -0.279984).  Saving model ...
Epoch: 3 cost time: 2.8382842540740967
Epoch: 3, Steps: 4 | Train Loss: 1.531 Vali Loss: 1.557 Vali Acc: 0.280 Test Loss: 1.557 Test Acc: 0.280
Validation loss decreased (-0.279984 --> -0.279984).  Saving model ...
Epoch: 4 cost time: 3.091576099395752
Epoch: 4, Steps: 4 | Train Loss: 1.466 Vali Loss: 1.514 Vali Acc: 0.340 Test Loss: 1.514 Test Acc: 0.340
Validation loss decreased (-0.279984 --> -0.339985).  Saving model ...
Epoch: 5 cost time: 3.4902560710906982
Epoch: 5, Steps: 4 | Train Loss: 1.134 Vali Loss: 1.466 Vali Acc: 0.360 Test Loss: 1.466 Test Acc: 0.360
Validation loss decreased (-0.339985 --> -0.359985).  Saving model ...
Epoch: 6 cost time: 2.70451021194458
Epoch: 6, Steps: 4 | Train Loss: 1.097 Vali Loss: 1.424 Vali Acc: 0.320 Test Loss: 1.424 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.0816075801849365
Epoch: 7, Steps: 4 | Train Loss: 1.030 Vali Loss: 1.389 Vali Acc: 0.400 Test Loss: 1.389 Test Acc: 0.400
Validation loss decreased (-0.359985 --> -0.399986).  Saving model ...
Epoch: 8 cost time: 3.153332233428955
Epoch: 8, Steps: 4 | Train Loss: 0.780 Vali Loss: 1.374 Vali Acc: 0.360 Test Loss: 1.374 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.522559404373169
Epoch: 9, Steps: 4 | Train Loss: 0.706 Vali Loss: 1.356 Vali Acc: 0.420 Test Loss: 1.356 Test Acc: 0.420
Validation loss decreased (-0.399986 --> -0.419986).  Saving model ...
Epoch: 10 cost time: 2.4459919929504395
Epoch: 10, Steps: 4 | Train Loss: 0.545 Vali Loss: 1.245 Vali Acc: 0.400 Test Loss: 1.245 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.405846357345581
Epoch: 11, Steps: 4 | Train Loss: 0.472 Vali Loss: 1.215 Vali Acc: 0.400 Test Loss: 1.215 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.8324646949768066
Epoch: 12, Steps: 4 | Train Loss: 0.357 Vali Loss: 1.208 Vali Acc: 0.420 Test Loss: 1.208 Test Acc: 0.420
Validation loss decreased (-0.419986 --> -0.419988).  Saving model ...
Epoch: 13 cost time: 2.9235665798187256
Epoch: 13, Steps: 4 | Train Loss: 0.268 Vali Loss: 1.175 Vali Acc: 0.520 Test Loss: 1.175 Test Acc: 0.520
Validation loss decreased (-0.419988 --> -0.519988).  Saving model ...
Epoch: 14 cost time: 2.8906002044677734
Epoch: 14, Steps: 4 | Train Loss: 0.193 Vali Loss: 1.089 Vali Acc: 0.520 Test Loss: 1.089 Test Acc: 0.520
Validation loss decreased (-0.519988 --> -0.519989).  Saving model ...
Epoch: 15 cost time: 2.9240469932556152
Epoch: 15, Steps: 4 | Train Loss: 0.194 Vali Loss: 1.148 Vali Acc: 0.540 Test Loss: 1.148 Test Acc: 0.540
Validation loss decreased (-0.519989 --> -0.539989).  Saving model ...
Epoch: 16 cost time: 2.872952461242676
Epoch: 16, Steps: 4 | Train Loss: 0.169 Vali Loss: 1.135 Vali Acc: 0.460 Test Loss: 1.135 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.053793430328369
Epoch: 17, Steps: 4 | Train Loss: 0.103 Vali Loss: 1.082 Vali Acc: 0.520 Test Loss: 1.082 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.084139108657837
Epoch: 18, Steps: 4 | Train Loss: 0.086 Vali Loss: 1.040 Vali Acc: 0.540 Test Loss: 1.040 Test Acc: 0.540
Validation loss decreased (-0.539989 --> -0.539990).  Saving model ...
Epoch: 19 cost time: 2.7134311199188232
Epoch: 19, Steps: 4 | Train Loss: 0.082 Vali Loss: 1.092 Vali Acc: 0.560 Test Loss: 1.092 Test Acc: 0.560
Validation loss decreased (-0.539990 --> -0.559989).  Saving model ...
Epoch: 20 cost time: 3.3602213859558105
Epoch: 20, Steps: 4 | Train Loss: 0.062 Vali Loss: 1.176 Vali Acc: 0.540 Test Loss: 1.176 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.875582695007324
Epoch: 21, Steps: 4 | Train Loss: 0.046 Vali Loss: 1.134 Vali Acc: 0.520 Test Loss: 1.134 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.849149703979492
Epoch: 22, Steps: 4 | Train Loss: 0.040 Vali Loss: 1.159 Vali Acc: 0.580 Test Loss: 1.159 Test Acc: 0.580
Validation loss decreased (-0.559989 --> -0.579988).  Saving model ...
Epoch: 23 cost time: 2.5481672286987305
Epoch: 23, Steps: 4 | Train Loss: 0.029 Vali Loss: 1.146 Vali Acc: 0.620 Test Loss: 1.146 Test Acc: 0.620
Validation loss decreased (-0.579988 --> -0.619989).  Saving model ...
Epoch: 24 cost time: 3.3567490577697754
Epoch: 24, Steps: 4 | Train Loss: 0.029 Vali Loss: 1.084 Vali Acc: 0.620 Test Loss: 1.084 Test Acc: 0.620
Validation loss decreased (-0.619989 --> -0.619989).  Saving model ...
Epoch: 25 cost time: 2.616462469100952
Epoch: 25, Steps: 4 | Train Loss: 0.032 Vali Loss: 1.051 Vali Acc: 0.620 Test Loss: 1.051 Test Acc: 0.620
Validation loss decreased (-0.619989 --> -0.619989).  Saving model ...
Epoch: 26 cost time: 2.399315595626831
Epoch: 26, Steps: 4 | Train Loss: 0.032 Vali Loss: 1.131 Vali Acc: 0.660 Test Loss: 1.131 Test Acc: 0.660
Validation loss decreased (-0.619989 --> -0.659989).  Saving model ...
Epoch: 27 cost time: 2.9231650829315186
Epoch: 27, Steps: 4 | Train Loss: 0.014 Vali Loss: 1.055 Vali Acc: 0.660 Test Loss: 1.055 Test Acc: 0.660
Validation loss decreased (-0.659989 --> -0.659989).  Saving model ...
Epoch: 28 cost time: 2.5499439239501953
Epoch: 28, Steps: 4 | Train Loss: 0.014 Vali Loss: 1.175 Vali Acc: 0.600 Test Loss: 1.175 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.326835870742798
Epoch: 29, Steps: 4 | Train Loss: 0.013 Vali Loss: 1.256 Vali Acc: 0.600 Test Loss: 1.256 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.915969133377075
Epoch: 30, Steps: 4 | Train Loss: 0.010 Vali Loss: 1.262 Vali Acc: 0.620 Test Loss: 1.262 Test Acc: 0.620
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm32_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.66
model parameter : 2927589
model size : 11.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm32_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 5.068944931030273
Epoch: 1, Steps: 4 | Train Loss: 1.714 Vali Loss: 1.714 Vali Acc: 0.280 Test Loss: 1.714 Test Acc: 0.280
Validation loss decreased (inf --> -0.279983).  Saving model ...
Epoch: 2 cost time: 3.295675277709961
Epoch: 2, Steps: 4 | Train Loss: 1.622 Vali Loss: 1.695 Vali Acc: 0.300 Test Loss: 1.695 Test Acc: 0.300
Validation loss decreased (-0.279983 --> -0.299983).  Saving model ...
Epoch: 3 cost time: 2.9865503311157227
Epoch: 3, Steps: 4 | Train Loss: 1.472 Vali Loss: 1.670 Vali Acc: 0.380 Test Loss: 1.670 Test Acc: 0.380
Validation loss decreased (-0.299983 --> -0.379983).  Saving model ...
Epoch: 4 cost time: 3.145944833755493
Epoch: 4, Steps: 4 | Train Loss: 1.326 Vali Loss: 1.663 Vali Acc: 0.380 Test Loss: 1.663 Test Acc: 0.380
Validation loss decreased (-0.379983 --> -0.379983).  Saving model ...
Epoch: 5 cost time: 3.0928738117218018
Epoch: 5, Steps: 4 | Train Loss: 1.241 Vali Loss: 1.670 Vali Acc: 0.320 Test Loss: 1.670 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.1856555938720703
Epoch: 6, Steps: 4 | Train Loss: 1.039 Vali Loss: 1.658 Vali Acc: 0.360 Test Loss: 1.658 Test Acc: 0.360
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.0645034313201904
Epoch: 7, Steps: 4 | Train Loss: 1.001 Vali Loss: 1.612 Vali Acc: 0.400 Test Loss: 1.612 Test Acc: 0.400
Validation loss decreased (-0.379983 --> -0.399984).  Saving model ...
Epoch: 8 cost time: 2.588005781173706
Epoch: 8, Steps: 4 | Train Loss: 0.656 Vali Loss: 1.536 Vali Acc: 0.460 Test Loss: 1.536 Test Acc: 0.460
Validation loss decreased (-0.399984 --> -0.459985).  Saving model ...
Epoch: 9 cost time: 2.6098713874816895
Epoch: 9, Steps: 4 | Train Loss: 0.594 Vali Loss: 1.458 Vali Acc: 0.480 Test Loss: 1.458 Test Acc: 0.480
Validation loss decreased (-0.459985 --> -0.479985).  Saving model ...
Epoch: 10 cost time: 3.4459524154663086
Epoch: 10, Steps: 4 | Train Loss: 0.726 Vali Loss: 1.429 Vali Acc: 0.520 Test Loss: 1.429 Test Acc: 0.520
Validation loss decreased (-0.479985 --> -0.519986).  Saving model ...
Epoch: 11 cost time: 3.3878564834594727
Epoch: 11, Steps: 4 | Train Loss: 0.381 Vali Loss: 1.346 Vali Acc: 0.520 Test Loss: 1.346 Test Acc: 0.520
Validation loss decreased (-0.519986 --> -0.519987).  Saving model ...
Epoch: 12 cost time: 3.3933401107788086
Epoch: 12, Steps: 4 | Train Loss: 0.276 Vali Loss: 1.347 Vali Acc: 0.480 Test Loss: 1.347 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.539254903793335
Epoch: 13, Steps: 4 | Train Loss: 0.243 Vali Loss: 1.341 Vali Acc: 0.500 Test Loss: 1.341 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.4813880920410156
Epoch: 14, Steps: 4 | Train Loss: 0.191 Vali Loss: 1.388 Vali Acc: 0.480 Test Loss: 1.388 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.1379377841949463
Epoch: 15, Steps: 4 | Train Loss: 0.126 Vali Loss: 1.395 Vali Acc: 0.480 Test Loss: 1.395 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.6394155025482178
Epoch: 16, Steps: 4 | Train Loss: 0.116 Vali Loss: 1.418 Vali Acc: 0.520 Test Loss: 1.418 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.479257583618164
Epoch: 17, Steps: 4 | Train Loss: 0.083 Vali Loss: 1.375 Vali Acc: 0.580 Test Loss: 1.375 Test Acc: 0.580
Validation loss decreased (-0.519987 --> -0.579986).  Saving model ...
Epoch: 18 cost time: 3.074721574783325
Epoch: 18, Steps: 4 | Train Loss: 0.297 Vali Loss: 1.310 Vali Acc: 0.540 Test Loss: 1.310 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.5691277980804443
Epoch: 19, Steps: 4 | Train Loss: 0.057 Vali Loss: 1.284 Vali Acc: 0.520 Test Loss: 1.284 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.4566547870635986
Epoch: 20, Steps: 4 | Train Loss: 0.048 Vali Loss: 1.381 Vali Acc: 0.520 Test Loss: 1.381 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.201817274093628
Epoch: 21, Steps: 4 | Train Loss: 0.034 Vali Loss: 1.461 Vali Acc: 0.500 Test Loss: 1.461 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.6382522583007812
Epoch: 22, Steps: 4 | Train Loss: 0.028 Vali Loss: 1.449 Vali Acc: 0.500 Test Loss: 1.449 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.616793394088745
Epoch: 23, Steps: 4 | Train Loss: 0.020 Vali Loss: 1.412 Vali Acc: 0.460 Test Loss: 1.412 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.7323975563049316
Epoch: 24, Steps: 4 | Train Loss: 0.021 Vali Loss: 1.459 Vali Acc: 0.500 Test Loss: 1.459 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 3.330977201461792
Epoch: 25, Steps: 4 | Train Loss: 0.017 Vali Loss: 1.498 Vali Acc: 0.540 Test Loss: 1.498 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 3.3130805492401123
Epoch: 26, Steps: 4 | Train Loss: 0.012 Vali Loss: 1.436 Vali Acc: 0.540 Test Loss: 1.436 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 3.6856372356414795
Epoch: 27, Steps: 4 | Train Loss: 0.011 Vali Loss: 1.360 Vali Acc: 0.540 Test Loss: 1.360 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm32_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 9548005
model size : 37.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm32_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.4278206825256348
Epoch: 1, Steps: 4 | Train Loss: 1.648 Vali Loss: 1.605 Vali Acc: 0.160 Test Loss: 1.605 Test Acc: 0.160
Validation loss decreased (inf --> -0.159984).  Saving model ...
Epoch: 2 cost time: 1.7763392925262451
Epoch: 2, Steps: 4 | Train Loss: 1.700 Vali Loss: 1.589 Vali Acc: 0.280 Test Loss: 1.589 Test Acc: 0.280
Validation loss decreased (-0.159984 --> -0.279984).  Saving model ...
Epoch: 3 cost time: 2.0713233947753906
Epoch: 3, Steps: 4 | Train Loss: 1.536 Vali Loss: 1.558 Vali Acc: 0.260 Test Loss: 1.558 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8726370334625244
Epoch: 4, Steps: 4 | Train Loss: 1.472 Vali Loss: 1.515 Vali Acc: 0.340 Test Loss: 1.515 Test Acc: 0.340
Validation loss decreased (-0.279984 --> -0.339985).  Saving model ...
Epoch: 5 cost time: 1.622725486755371
Epoch: 5, Steps: 4 | Train Loss: 1.134 Vali Loss: 1.465 Vali Acc: 0.360 Test Loss: 1.465 Test Acc: 0.360
Validation loss decreased (-0.339985 --> -0.359985).  Saving model ...
Epoch: 6 cost time: 1.7518067359924316
Epoch: 6, Steps: 4 | Train Loss: 1.106 Vali Loss: 1.422 Vali Acc: 0.340 Test Loss: 1.422 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.0299072265625
Epoch: 7, Steps: 4 | Train Loss: 1.037 Vali Loss: 1.381 Vali Acc: 0.400 Test Loss: 1.381 Test Acc: 0.400
Validation loss decreased (-0.359985 --> -0.399986).  Saving model ...
Epoch: 8 cost time: 1.9852893352508545
Epoch: 8, Steps: 4 | Train Loss: 0.806 Vali Loss: 1.359 Vali Acc: 0.380 Test Loss: 1.359 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.043614149093628
Epoch: 9, Steps: 4 | Train Loss: 0.714 Vali Loss: 1.329 Vali Acc: 0.420 Test Loss: 1.329 Test Acc: 0.420
Validation loss decreased (-0.399986 --> -0.419987).  Saving model ...
Epoch: 10 cost time: 1.83089280128479
Epoch: 10, Steps: 4 | Train Loss: 0.544 Vali Loss: 1.219 Vali Acc: 0.440 Test Loss: 1.219 Test Acc: 0.440
Validation loss decreased (-0.419987 --> -0.439988).  Saving model ...
Epoch: 11 cost time: 2.1684582233428955
Epoch: 11, Steps: 4 | Train Loss: 0.479 Vali Loss: 1.185 Vali Acc: 0.420 Test Loss: 1.185 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.9535636901855469
Epoch: 12, Steps: 4 | Train Loss: 0.362 Vali Loss: 1.164 Vali Acc: 0.440 Test Loss: 1.164 Test Acc: 0.440
Validation loss decreased (-0.439988 --> -0.439988).  Saving model ...
Epoch: 13 cost time: 2.0397958755493164
Epoch: 13, Steps: 4 | Train Loss: 0.267 Vali Loss: 1.127 Vali Acc: 0.540 Test Loss: 1.127 Test Acc: 0.540
Validation loss decreased (-0.439988 --> -0.539989).  Saving model ...
Epoch: 14 cost time: 1.8476753234863281
Epoch: 14, Steps: 4 | Train Loss: 0.196 Vali Loss: 1.036 Vali Acc: 0.560 Test Loss: 1.036 Test Acc: 0.560
Validation loss decreased (-0.539989 --> -0.559990).  Saving model ...
Epoch: 15 cost time: 1.8720462322235107
Epoch: 15, Steps: 4 | Train Loss: 0.186 Vali Loss: 1.115 Vali Acc: 0.560 Test Loss: 1.115 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.9415454864501953
Epoch: 16, Steps: 4 | Train Loss: 0.176 Vali Loss: 1.115 Vali Acc: 0.540 Test Loss: 1.115 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.1214966773986816
Epoch: 17, Steps: 4 | Train Loss: 0.111 Vali Loss: 1.115 Vali Acc: 0.480 Test Loss: 1.115 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.8663735389709473
Epoch: 18, Steps: 4 | Train Loss: 0.095 Vali Loss: 1.079 Vali Acc: 0.560 Test Loss: 1.079 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.1516153812408447
Epoch: 19, Steps: 4 | Train Loss: 0.082 Vali Loss: 1.126 Vali Acc: 0.480 Test Loss: 1.126 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.0536041259765625
Epoch: 20, Steps: 4 | Train Loss: 0.061 Vali Loss: 1.232 Vali Acc: 0.540 Test Loss: 1.232 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.230966806411743
Epoch: 21, Steps: 4 | Train Loss: 0.046 Vali Loss: 1.182 Vali Acc: 0.520 Test Loss: 1.182 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.971728801727295
Epoch: 22, Steps: 4 | Train Loss: 0.041 Vali Loss: 1.191 Vali Acc: 0.560 Test Loss: 1.191 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.0767436027526855
Epoch: 23, Steps: 4 | Train Loss: 0.027 Vali Loss: 1.183 Vali Acc: 0.600 Test Loss: 1.183 Test Acc: 0.600
Validation loss decreased (-0.559990 --> -0.599988).  Saving model ...
Epoch: 24 cost time: 2.262861728668213
Epoch: 24, Steps: 4 | Train Loss: 0.031 Vali Loss: 1.136 Vali Acc: 0.580 Test Loss: 1.136 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.0413248538970947
Epoch: 25, Steps: 4 | Train Loss: 0.033 Vali Loss: 1.075 Vali Acc: 0.600 Test Loss: 1.075 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599989).  Saving model ...
Epoch: 26 cost time: 2.13739013671875
Epoch: 26, Steps: 4 | Train Loss: 0.032 Vali Loss: 1.166 Vali Acc: 0.600 Test Loss: 1.166 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.988804578781128
Epoch: 27, Steps: 4 | Train Loss: 0.015 Vali Loss: 1.101 Vali Acc: 0.600 Test Loss: 1.101 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.2205810546875
Epoch: 28, Steps: 4 | Train Loss: 0.016 Vali Loss: 1.189 Vali Acc: 0.580 Test Loss: 1.189 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.084578514099121
Epoch: 29, Steps: 4 | Train Loss: 0.012 Vali Loss: 1.294 Vali Acc: 0.540 Test Loss: 1.294 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.187662363052368
Epoch: 30, Steps: 4 | Train Loss: 0.011 Vali Loss: 1.280 Vali Acc: 0.600 Test Loss: 1.280 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm32_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 2927589
model size : 11.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm32_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.6089305877685547
Epoch: 1, Steps: 4 | Train Loss: 1.714 Vali Loss: 1.714 Vali Acc: 0.280 Test Loss: 1.714 Test Acc: 0.280
Validation loss decreased (inf --> -0.279983).  Saving model ...
Epoch: 2 cost time: 2.3470845222473145
Epoch: 2, Steps: 4 | Train Loss: 1.624 Vali Loss: 1.695 Vali Acc: 0.300 Test Loss: 1.695 Test Acc: 0.300
Validation loss decreased (-0.279983 --> -0.299983).  Saving model ...
Epoch: 3 cost time: 2.285348653793335
Epoch: 3, Steps: 4 | Train Loss: 1.476 Vali Loss: 1.670 Vali Acc: 0.380 Test Loss: 1.670 Test Acc: 0.380
Validation loss decreased (-0.299983 --> -0.379983).  Saving model ...
Epoch: 4 cost time: 2.353419780731201
Epoch: 4, Steps: 4 | Train Loss: 1.345 Vali Loss: 1.664 Vali Acc: 0.360 Test Loss: 1.664 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.4194555282592773
Epoch: 5, Steps: 4 | Train Loss: 1.258 Vali Loss: 1.671 Vali Acc: 0.320 Test Loss: 1.671 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.4347176551818848
Epoch: 6, Steps: 4 | Train Loss: 1.053 Vali Loss: 1.659 Vali Acc: 0.380 Test Loss: 1.659 Test Acc: 0.380
Validation loss decreased (-0.379983 --> -0.379983).  Saving model ...
Epoch: 7 cost time: 2.2189788818359375
Epoch: 7, Steps: 4 | Train Loss: 1.031 Vali Loss: 1.612 Vali Acc: 0.380 Test Loss: 1.612 Test Acc: 0.380
Validation loss decreased (-0.379983 --> -0.379984).  Saving model ...
Epoch: 8 cost time: 2.3409101963043213
Epoch: 8, Steps: 4 | Train Loss: 0.682 Vali Loss: 1.537 Vali Acc: 0.460 Test Loss: 1.537 Test Acc: 0.460
Validation loss decreased (-0.379984 --> -0.459985).  Saving model ...
Epoch: 9 cost time: 2.3622775077819824
Epoch: 9, Steps: 4 | Train Loss: 0.629 Vali Loss: 1.453 Vali Acc: 0.460 Test Loss: 1.453 Test Acc: 0.460
Validation loss decreased (-0.459985 --> -0.459985).  Saving model ...
Epoch: 10 cost time: 2.299326181411743
Epoch: 10, Steps: 4 | Train Loss: 0.753 Vali Loss: 1.408 Vali Acc: 0.500 Test Loss: 1.408 Test Acc: 0.500
Validation loss decreased (-0.459985 --> -0.499986).  Saving model ...
Epoch: 11 cost time: 2.2320215702056885
Epoch: 11, Steps: 4 | Train Loss: 0.420 Vali Loss: 1.313 Vali Acc: 0.500 Test Loss: 1.313 Test Acc: 0.500
Validation loss decreased (-0.499986 --> -0.499987).  Saving model ...
Epoch: 12 cost time: 2.4089417457580566
Epoch: 12, Steps: 4 | Train Loss: 0.342 Vali Loss: 1.310 Vali Acc: 0.500 Test Loss: 1.310 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499987).  Saving model ...
Epoch: 13 cost time: 2.337311029434204
Epoch: 13, Steps: 4 | Train Loss: 0.276 Vali Loss: 1.272 Vali Acc: 0.520 Test Loss: 1.272 Test Acc: 0.520
Validation loss decreased (-0.499987 --> -0.519987).  Saving model ...
Epoch: 14 cost time: 2.314324140548706
Epoch: 14, Steps: 4 | Train Loss: 0.219 Vali Loss: 1.325 Vali Acc: 0.520 Test Loss: 1.325 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.4949703216552734
Epoch: 15, Steps: 4 | Train Loss: 0.148 Vali Loss: 1.369 Vali Acc: 0.540 Test Loss: 1.369 Test Acc: 0.540
Validation loss decreased (-0.519987 --> -0.539986).  Saving model ...
Epoch: 16 cost time: 2.3915016651153564
Epoch: 16, Steps: 4 | Train Loss: 0.131 Vali Loss: 1.360 Vali Acc: 0.520 Test Loss: 1.360 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.4569218158721924
Epoch: 17, Steps: 4 | Train Loss: 0.094 Vali Loss: 1.268 Vali Acc: 0.600 Test Loss: 1.268 Test Acc: 0.600
Validation loss decreased (-0.539986 --> -0.599987).  Saving model ...
Epoch: 18 cost time: 2.5562663078308105
Epoch: 18, Steps: 4 | Train Loss: 0.316 Vali Loss: 1.231 Vali Acc: 0.580 Test Loss: 1.231 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.5412330627441406
Epoch: 19, Steps: 4 | Train Loss: 0.067 Vali Loss: 1.251 Vali Acc: 0.560 Test Loss: 1.251 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.296198844909668
Epoch: 20, Steps: 4 | Train Loss: 0.051 Vali Loss: 1.298 Vali Acc: 0.600 Test Loss: 1.298 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.3485705852508545
Epoch: 21, Steps: 4 | Train Loss: 0.042 Vali Loss: 1.326 Vali Acc: 0.620 Test Loss: 1.326 Test Acc: 0.620
Validation loss decreased (-0.599987 --> -0.619987).  Saving model ...
Epoch: 22 cost time: 2.4343678951263428
Epoch: 22, Steps: 4 | Train Loss: 0.033 Vali Loss: 1.327 Vali Acc: 0.540 Test Loss: 1.327 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.8266026973724365
Epoch: 23, Steps: 4 | Train Loss: 0.032 Vali Loss: 1.371 Vali Acc: 0.560 Test Loss: 1.371 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.715639352798462
Epoch: 24, Steps: 4 | Train Loss: 0.025 Vali Loss: 1.488 Vali Acc: 0.580 Test Loss: 1.488 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.897005558013916
Epoch: 25, Steps: 4 | Train Loss: 0.018 Vali Loss: 1.406 Vali Acc: 0.560 Test Loss: 1.406 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.537780284881592
Epoch: 26, Steps: 4 | Train Loss: 0.012 Vali Loss: 1.306 Vali Acc: 0.600 Test Loss: 1.306 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.2891736030578613
Epoch: 27, Steps: 4 | Train Loss: 0.016 Vali Loss: 1.279 Vali Acc: 0.580 Test Loss: 1.279 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.7700698375701904
Epoch: 28, Steps: 4 | Train Loss: 0.012 Vali Loss: 1.362 Vali Acc: 0.520 Test Loss: 1.362 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 2.639511823654175
Epoch: 29, Steps: 4 | Train Loss: 0.010 Vali Loss: 1.510 Vali Acc: 0.560 Test Loss: 1.510 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 2.7002553939819336
Epoch: 30, Steps: 4 | Train Loss: 0.008 Vali Loss: 1.497 Vali Acc: 0.500 Test Loss: 1.497 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm32_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.62
model parameter : 9548005
model size : 37.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm32_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.010294198989868
Epoch: 1, Steps: 4 | Train Loss: 1.649 Vali Loss: 1.602 Vali Acc: 0.160 Test Loss: 1.602 Test Acc: 0.160
Validation loss decreased (inf --> -0.159984).  Saving model ...
Epoch: 2 cost time: 1.5639665126800537
Epoch: 2, Steps: 4 | Train Loss: 1.703 Vali Loss: 1.586 Vali Acc: 0.280 Test Loss: 1.586 Test Acc: 0.280
Validation loss decreased (-0.159984 --> -0.279984).  Saving model ...
Epoch: 3 cost time: 1.573664903640747
Epoch: 3, Steps: 4 | Train Loss: 1.540 Vali Loss: 1.556 Vali Acc: 0.280 Test Loss: 1.556 Test Acc: 0.280
Validation loss decreased (-0.279984 --> -0.279984).  Saving model ...
Epoch: 4 cost time: 1.5403051376342773
Epoch: 4, Steps: 4 | Train Loss: 1.514 Vali Loss: 1.512 Vali Acc: 0.340 Test Loss: 1.512 Test Acc: 0.340
Validation loss decreased (-0.279984 --> -0.339985).  Saving model ...
Epoch: 5 cost time: 1.7080349922180176
Epoch: 5, Steps: 4 | Train Loss: 1.190 Vali Loss: 1.464 Vali Acc: 0.380 Test Loss: 1.464 Test Acc: 0.380
Validation loss decreased (-0.339985 --> -0.379985).  Saving model ...
Epoch: 6 cost time: 1.6032328605651855
Epoch: 6, Steps: 4 | Train Loss: 1.117 Vali Loss: 1.421 Vali Acc: 0.380 Test Loss: 1.421 Test Acc: 0.380
Validation loss decreased (-0.379985 --> -0.379986).  Saving model ...
Epoch: 7 cost time: 1.5882561206817627
Epoch: 7, Steps: 4 | Train Loss: 1.057 Vali Loss: 1.379 Vali Acc: 0.420 Test Loss: 1.379 Test Acc: 0.420
Validation loss decreased (-0.379986 --> -0.419986).  Saving model ...
Epoch: 8 cost time: 1.6342618465423584
Epoch: 8, Steps: 4 | Train Loss: 0.827 Vali Loss: 1.353 Vali Acc: 0.400 Test Loss: 1.353 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4875800609588623
Epoch: 9, Steps: 4 | Train Loss: 0.737 Vali Loss: 1.322 Vali Acc: 0.420 Test Loss: 1.322 Test Acc: 0.420
Validation loss decreased (-0.419986 --> -0.419987).  Saving model ...
Epoch: 10 cost time: 1.4729139804840088
Epoch: 10, Steps: 4 | Train Loss: 0.576 Vali Loss: 1.210 Vali Acc: 0.460 Test Loss: 1.210 Test Acc: 0.460
Validation loss decreased (-0.419987 --> -0.459988).  Saving model ...
Epoch: 11 cost time: 1.6532328128814697
Epoch: 11, Steps: 4 | Train Loss: 0.502 Vali Loss: 1.171 Vali Acc: 0.480 Test Loss: 1.171 Test Acc: 0.480
Validation loss decreased (-0.459988 --> -0.479988).  Saving model ...
Epoch: 12 cost time: 1.6456844806671143
Epoch: 12, Steps: 4 | Train Loss: 0.389 Vali Loss: 1.153 Vali Acc: 0.460 Test Loss: 1.153 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4361281394958496
Epoch: 13, Steps: 4 | Train Loss: 0.287 Vali Loss: 1.132 Vali Acc: 0.540 Test Loss: 1.132 Test Acc: 0.540
Validation loss decreased (-0.479988 --> -0.539989).  Saving model ...
Epoch: 14 cost time: 1.5818829536437988
Epoch: 14, Steps: 4 | Train Loss: 0.221 Vali Loss: 1.034 Vali Acc: 0.560 Test Loss: 1.034 Test Acc: 0.560
Validation loss decreased (-0.539989 --> -0.559990).  Saving model ...
Epoch: 15 cost time: 1.348318099975586
Epoch: 15, Steps: 4 | Train Loss: 0.207 Vali Loss: 1.067 Vali Acc: 0.560 Test Loss: 1.067 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.5945162773132324
Epoch: 16, Steps: 4 | Train Loss: 0.181 Vali Loss: 1.072 Vali Acc: 0.540 Test Loss: 1.072 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.5742998123168945
Epoch: 17, Steps: 4 | Train Loss: 0.123 Vali Loss: 1.109 Vali Acc: 0.500 Test Loss: 1.109 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.37343430519104
Epoch: 18, Steps: 4 | Train Loss: 0.108 Vali Loss: 1.040 Vali Acc: 0.520 Test Loss: 1.040 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.321509599685669
Epoch: 19, Steps: 4 | Train Loss: 0.105 Vali Loss: 1.166 Vali Acc: 0.500 Test Loss: 1.166 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.4228546619415283
Epoch: 20, Steps: 4 | Train Loss: 0.064 Vali Loss: 1.194 Vali Acc: 0.540 Test Loss: 1.194 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.3582179546356201
Epoch: 21, Steps: 4 | Train Loss: 0.050 Vali Loss: 1.217 Vali Acc: 0.560 Test Loss: 1.217 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.3059942722320557
Epoch: 22, Steps: 4 | Train Loss: 0.053 Vali Loss: 1.136 Vali Acc: 0.540 Test Loss: 1.136 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.1708085536956787
Epoch: 23, Steps: 4 | Train Loss: 0.034 Vali Loss: 1.172 Vali Acc: 0.600 Test Loss: 1.172 Test Acc: 0.600
Validation loss decreased (-0.559990 --> -0.599988).  Saving model ...
Epoch: 24 cost time: 1.2432901859283447
Epoch: 24, Steps: 4 | Train Loss: 0.052 Vali Loss: 1.253 Vali Acc: 0.640 Test Loss: 1.253 Test Acc: 0.640
Validation loss decreased (-0.599988 --> -0.639987).  Saving model ...
Epoch: 25 cost time: 1.3840270042419434
Epoch: 25, Steps: 4 | Train Loss: 0.043 Vali Loss: 1.046 Vali Acc: 0.600 Test Loss: 1.046 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.4059362411499023
Epoch: 26, Steps: 4 | Train Loss: 0.046 Vali Loss: 1.025 Vali Acc: 0.580 Test Loss: 1.025 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.571052074432373
Epoch: 27, Steps: 4 | Train Loss: 0.025 Vali Loss: 1.167 Vali Acc: 0.620 Test Loss: 1.167 Test Acc: 0.620
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.3671033382415771
Epoch: 28, Steps: 4 | Train Loss: 0.018 Vali Loss: 1.139 Vali Acc: 0.580 Test Loss: 1.139 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.443857192993164
Epoch: 29, Steps: 4 | Train Loss: 0.016 Vali Loss: 1.215 Vali Acc: 0.580 Test Loss: 1.215 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.4536974430084229
Epoch: 30, Steps: 4 | Train Loss: 0.012 Vali Loss: 1.256 Vali Acc: 0.620 Test Loss: 1.256 Test Acc: 0.620
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm32_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.64
model parameter : 2927589
model size : 11.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm32_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.41583514213562
Epoch: 1, Steps: 4 | Train Loss: 1.677 Vali Loss: 1.649 Vali Acc: 0.240 Test Loss: 1.649 Test Acc: 0.240
Validation loss decreased (inf --> -0.239984).  Saving model ...
Epoch: 2 cost time: 2.88688063621521
Epoch: 2, Steps: 4 | Train Loss: 1.551 Vali Loss: 1.637 Vali Acc: 0.260 Test Loss: 1.637 Test Acc: 0.260
Validation loss decreased (-0.239984 --> -0.259984).  Saving model ...
Epoch: 3 cost time: 3.901433229446411
Epoch: 3, Steps: 4 | Train Loss: 1.542 Vali Loss: 1.626 Vali Acc: 0.300 Test Loss: 1.626 Test Acc: 0.300
Validation loss decreased (-0.259984 --> -0.299984).  Saving model ...
Epoch: 4 cost time: 3.482120990753174
Epoch: 4, Steps: 4 | Train Loss: 1.476 Vali Loss: 1.613 Vali Acc: 0.340 Test Loss: 1.613 Test Acc: 0.340
Validation loss decreased (-0.299984 --> -0.339984).  Saving model ...
Epoch: 5 cost time: 3.4054760932922363
Epoch: 5, Steps: 4 | Train Loss: 1.256 Vali Loss: 1.585 Vali Acc: 0.340 Test Loss: 1.585 Test Acc: 0.340
Validation loss decreased (-0.339984 --> -0.339984).  Saving model ...
Epoch: 6 cost time: 3.8016629219055176
Epoch: 6, Steps: 4 | Train Loss: 1.063 Vali Loss: 1.535 Vali Acc: 0.400 Test Loss: 1.535 Test Acc: 0.400
Validation loss decreased (-0.339984 --> -0.399985).  Saving model ...
Epoch: 7 cost time: 3.5220389366149902
Epoch: 7, Steps: 4 | Train Loss: 0.963 Vali Loss: 1.493 Vali Acc: 0.400 Test Loss: 1.493 Test Acc: 0.400
Validation loss decreased (-0.399985 --> -0.399985).  Saving model ...
Epoch: 8 cost time: 3.3519515991210938
Epoch: 8, Steps: 4 | Train Loss: 0.763 Vali Loss: 1.399 Vali Acc: 0.480 Test Loss: 1.399 Test Acc: 0.480
Validation loss decreased (-0.399985 --> -0.479986).  Saving model ...
Epoch: 9 cost time: 3.589566230773926
Epoch: 9, Steps: 4 | Train Loss: 0.637 Vali Loss: 1.306 Vali Acc: 0.460 Test Loss: 1.306 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.6859073638916016
Epoch: 10, Steps: 4 | Train Loss: 0.469 Vali Loss: 1.281 Vali Acc: 0.480 Test Loss: 1.281 Test Acc: 0.480
Validation loss decreased (-0.479986 --> -0.479987).  Saving model ...
Epoch: 11 cost time: 3.4397923946380615
Epoch: 11, Steps: 4 | Train Loss: 0.390 Vali Loss: 1.275 Vali Acc: 0.480 Test Loss: 1.275 Test Acc: 0.480
Validation loss decreased (-0.479987 --> -0.479987).  Saving model ...
Epoch: 12 cost time: 3.4580209255218506
Epoch: 12, Steps: 4 | Train Loss: 0.331 Vali Loss: 1.246 Vali Acc: 0.440 Test Loss: 1.246 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.8207156658172607
Epoch: 13, Steps: 4 | Train Loss: 0.261 Vali Loss: 1.164 Vali Acc: 0.440 Test Loss: 1.164 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.53872013092041
Epoch: 14, Steps: 4 | Train Loss: 0.189 Vali Loss: 1.183 Vali Acc: 0.460 Test Loss: 1.183 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.3368325233459473
Epoch: 15, Steps: 4 | Train Loss: 0.190 Vali Loss: 1.209 Vali Acc: 0.500 Test Loss: 1.209 Test Acc: 0.500
Validation loss decreased (-0.479987 --> -0.499988).  Saving model ...
Epoch: 16 cost time: 3.5681910514831543
Epoch: 16, Steps: 4 | Train Loss: 0.118 Vali Loss: 1.168 Vali Acc: 0.500 Test Loss: 1.168 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 17 cost time: 3.867412805557251
Epoch: 17, Steps: 4 | Train Loss: 0.106 Vali Loss: 1.193 Vali Acc: 0.540 Test Loss: 1.193 Test Acc: 0.540
Validation loss decreased (-0.499988 --> -0.539988).  Saving model ...
Epoch: 18 cost time: 3.3500280380249023
Epoch: 18, Steps: 4 | Train Loss: 0.091 Vali Loss: 1.313 Vali Acc: 0.520 Test Loss: 1.313 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.546379566192627
Epoch: 19, Steps: 4 | Train Loss: 0.095 Vali Loss: 1.208 Vali Acc: 0.580 Test Loss: 1.208 Test Acc: 0.580
Validation loss decreased (-0.539988 --> -0.579988).  Saving model ...
Epoch: 20 cost time: 3.046159029006958
Epoch: 20, Steps: 4 | Train Loss: 0.077 Vali Loss: 1.162 Vali Acc: 0.540 Test Loss: 1.162 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.782914876937866
Epoch: 21, Steps: 4 | Train Loss: 0.045 Vali Loss: 1.194 Vali Acc: 0.580 Test Loss: 1.194 Test Acc: 0.580
Validation loss decreased (-0.579988 --> -0.579988).  Saving model ...
Epoch: 22 cost time: 2.823594331741333
Epoch: 22, Steps: 4 | Train Loss: 0.041 Vali Loss: 1.250 Vali Acc: 0.560 Test Loss: 1.250 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.8762142658233643
Epoch: 23, Steps: 4 | Train Loss: 0.054 Vali Loss: 1.233 Vali Acc: 0.540 Test Loss: 1.233 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.44254207611084
Epoch: 24, Steps: 4 | Train Loss: 0.026 Vali Loss: 1.262 Vali Acc: 0.580 Test Loss: 1.262 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.431776523590088
Epoch: 25, Steps: 4 | Train Loss: 0.022 Vali Loss: 1.136 Vali Acc: 0.580 Test Loss: 1.136 Test Acc: 0.580
Validation loss decreased (-0.579988 --> -0.579989).  Saving model ...
Epoch: 26 cost time: 3.263300657272339
Epoch: 26, Steps: 4 | Train Loss: 0.014 Vali Loss: 1.106 Vali Acc: 0.560 Test Loss: 1.106 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.489790201187134
Epoch: 27, Steps: 4 | Train Loss: 0.017 Vali Loss: 1.130 Vali Acc: 0.640 Test Loss: 1.130 Test Acc: 0.640
Validation loss decreased (-0.579989 --> -0.639989).  Saving model ...
Epoch: 28 cost time: 3.0869438648223877
Epoch: 28, Steps: 4 | Train Loss: 0.027 Vali Loss: 1.148 Vali Acc: 0.620 Test Loss: 1.148 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.65569806098938
Epoch: 29, Steps: 4 | Train Loss: 0.015 Vali Loss: 1.170 Vali Acc: 0.560 Test Loss: 1.170 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.411555051803589
Epoch: 30, Steps: 4 | Train Loss: 0.014 Vali Loss: 1.303 Vali Acc: 0.540 Test Loss: 1.303 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm32_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.64
model parameter : 4860645
model size : 19.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm32_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.506291627883911
Epoch: 1, Steps: 4 | Train Loss: 1.781 Vali Loss: 1.708 Vali Acc: 0.060 Test Loss: 1.708 Test Acc: 0.060
Validation loss decreased (inf --> -0.059983).  Saving model ...
Epoch: 2 cost time: 1.793046236038208
Epoch: 2, Steps: 4 | Train Loss: 1.694 Vali Loss: 1.687 Vali Acc: 0.060 Test Loss: 1.687 Test Acc: 0.060
Validation loss decreased (-0.059983 --> -0.059983).  Saving model ...
Epoch: 3 cost time: 1.9548554420471191
Epoch: 3, Steps: 4 | Train Loss: 1.535 Vali Loss: 1.663 Vali Acc: 0.200 Test Loss: 1.663 Test Acc: 0.200
Validation loss decreased (-0.059983 --> -0.199983).  Saving model ...
Epoch: 4 cost time: 2.1854052543640137
Epoch: 4, Steps: 4 | Train Loss: 1.411 Vali Loss: 1.655 Vali Acc: 0.280 Test Loss: 1.655 Test Acc: 0.280
Validation loss decreased (-0.199983 --> -0.279983).  Saving model ...
Epoch: 5 cost time: 1.9201526641845703
Epoch: 5, Steps: 4 | Train Loss: 1.287 Vali Loss: 1.615 Vali Acc: 0.280 Test Loss: 1.615 Test Acc: 0.280
Validation loss decreased (-0.279983 --> -0.279984).  Saving model ...
Epoch: 6 cost time: 2.0767228603363037
Epoch: 6, Steps: 4 | Train Loss: 1.128 Vali Loss: 1.549 Vali Acc: 0.320 Test Loss: 1.549 Test Acc: 0.320
Validation loss decreased (-0.279984 --> -0.319985).  Saving model ...
Epoch: 7 cost time: 2.292076349258423
Epoch: 7, Steps: 4 | Train Loss: 0.955 Vali Loss: 1.473 Vali Acc: 0.360 Test Loss: 1.473 Test Acc: 0.360
Validation loss decreased (-0.319985 --> -0.359985).  Saving model ...
Epoch: 8 cost time: 2.2119781970977783
Epoch: 8, Steps: 4 | Train Loss: 0.841 Vali Loss: 1.388 Vali Acc: 0.440 Test Loss: 1.388 Test Acc: 0.440
Validation loss decreased (-0.359985 --> -0.439986).  Saving model ...
Epoch: 9 cost time: 2.1998701095581055
Epoch: 9, Steps: 4 | Train Loss: 0.611 Vali Loss: 1.327 Vali Acc: 0.460 Test Loss: 1.327 Test Acc: 0.460
Validation loss decreased (-0.439986 --> -0.459987).  Saving model ...
Epoch: 10 cost time: 2.194179058074951
Epoch: 10, Steps: 4 | Train Loss: 0.548 Vali Loss: 1.253 Vali Acc: 0.500 Test Loss: 1.253 Test Acc: 0.500
Validation loss decreased (-0.459987 --> -0.499987).  Saving model ...
Epoch: 11 cost time: 2.296550750732422
Epoch: 11, Steps: 4 | Train Loss: 0.425 Vali Loss: 1.244 Vali Acc: 0.460 Test Loss: 1.244 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.130587339401245
Epoch: 12, Steps: 4 | Train Loss: 0.456 Vali Loss: 1.193 Vali Acc: 0.460 Test Loss: 1.193 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.117645263671875
Epoch: 13, Steps: 4 | Train Loss: 0.350 Vali Loss: 1.227 Vali Acc: 0.520 Test Loss: 1.227 Test Acc: 0.520
Validation loss decreased (-0.499987 --> -0.519988).  Saving model ...
Epoch: 14 cost time: 2.215019941329956
Epoch: 14, Steps: 4 | Train Loss: 0.275 Vali Loss: 1.133 Vali Acc: 0.540 Test Loss: 1.133 Test Acc: 0.540
Validation loss decreased (-0.519988 --> -0.539989).  Saving model ...
Epoch: 15 cost time: 2.003950834274292
Epoch: 15, Steps: 4 | Train Loss: 0.342 Vali Loss: 1.140 Vali Acc: 0.580 Test Loss: 1.140 Test Acc: 0.580
Validation loss decreased (-0.539989 --> -0.579989).  Saving model ...
Epoch: 16 cost time: 1.637815237045288
Epoch: 16, Steps: 4 | Train Loss: 0.140 Vali Loss: 1.169 Vali Acc: 0.540 Test Loss: 1.169 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.160475254058838
Epoch: 17, Steps: 4 | Train Loss: 0.115 Vali Loss: 1.200 Vali Acc: 0.540 Test Loss: 1.200 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.8770976066589355
Epoch: 18, Steps: 4 | Train Loss: 0.100 Vali Loss: 1.144 Vali Acc: 0.520 Test Loss: 1.144 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.0628535747528076
Epoch: 19, Steps: 4 | Train Loss: 0.058 Vali Loss: 1.123 Vali Acc: 0.500 Test Loss: 1.123 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.068366765975952
Epoch: 20, Steps: 4 | Train Loss: 0.056 Vali Loss: 1.114 Vali Acc: 0.600 Test Loss: 1.114 Test Acc: 0.600
Validation loss decreased (-0.579989 --> -0.599989).  Saving model ...
Epoch: 21 cost time: 2.126554250717163
Epoch: 21, Steps: 4 | Train Loss: 0.047 Vali Loss: 1.101 Vali Acc: 0.580 Test Loss: 1.101 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.8748939037322998
Epoch: 22, Steps: 4 | Train Loss: 0.049 Vali Loss: 1.106 Vali Acc: 0.600 Test Loss: 1.106 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 23 cost time: 1.8883142471313477
Epoch: 23, Steps: 4 | Train Loss: 0.032 Vali Loss: 1.132 Vali Acc: 0.600 Test Loss: 1.132 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.8372585773468018
Epoch: 24, Steps: 4 | Train Loss: 0.046 Vali Loss: 1.110 Vali Acc: 0.600 Test Loss: 1.110 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.7889611721038818
Epoch: 25, Steps: 4 | Train Loss: 0.037 Vali Loss: 1.095 Vali Acc: 0.560 Test Loss: 1.095 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.8130950927734375
Epoch: 26, Steps: 4 | Train Loss: 0.017 Vali Loss: 1.189 Vali Acc: 0.480 Test Loss: 1.189 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.9413676261901855
Epoch: 27, Steps: 4 | Train Loss: 0.034 Vali Loss: 1.370 Vali Acc: 0.500 Test Loss: 1.370 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.070697546005249
Epoch: 28, Steps: 4 | Train Loss: 0.026 Vali Loss: 1.261 Vali Acc: 0.520 Test Loss: 1.261 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.7490503787994385
Epoch: 29, Steps: 4 | Train Loss: 0.020 Vali Loss: 1.281 Vali Acc: 0.520 Test Loss: 1.281 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 2.1238534450531006
Epoch: 30, Steps: 4 | Train Loss: 0.021 Vali Loss: 1.481 Vali Acc: 0.520 Test Loss: 1.481 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm32_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 1550309
model size : 6.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm32_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.85487699508667
Epoch: 1, Steps: 4 | Train Loss: 1.675 Vali Loss: 1.651 Vali Acc: 0.240 Test Loss: 1.651 Test Acc: 0.240
Validation loss decreased (inf --> -0.239983).  Saving model ...
Epoch: 2 cost time: 2.3537049293518066
Epoch: 2, Steps: 4 | Train Loss: 1.548 Vali Loss: 1.640 Vali Acc: 0.260 Test Loss: 1.640 Test Acc: 0.260
Validation loss decreased (-0.239983 --> -0.259984).  Saving model ...
Epoch: 3 cost time: 2.0304386615753174
Epoch: 3, Steps: 4 | Train Loss: 1.541 Vali Loss: 1.628 Vali Acc: 0.300 Test Loss: 1.628 Test Acc: 0.300
Validation loss decreased (-0.259984 --> -0.299984).  Saving model ...
Epoch: 4 cost time: 2.3265702724456787
Epoch: 4, Steps: 4 | Train Loss: 1.479 Vali Loss: 1.615 Vali Acc: 0.320 Test Loss: 1.615 Test Acc: 0.320
Validation loss decreased (-0.299984 --> -0.319984).  Saving model ...
Epoch: 5 cost time: 2.3436286449432373
Epoch: 5, Steps: 4 | Train Loss: 1.260 Vali Loss: 1.585 Vali Acc: 0.340 Test Loss: 1.585 Test Acc: 0.340
Validation loss decreased (-0.319984 --> -0.339984).  Saving model ...
Epoch: 6 cost time: 2.276998519897461
Epoch: 6, Steps: 4 | Train Loss: 1.072 Vali Loss: 1.532 Vali Acc: 0.400 Test Loss: 1.532 Test Acc: 0.400
Validation loss decreased (-0.339984 --> -0.399985).  Saving model ...
Epoch: 7 cost time: 2.4103541374206543
Epoch: 7, Steps: 4 | Train Loss: 0.972 Vali Loss: 1.485 Vali Acc: 0.380 Test Loss: 1.485 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.1694915294647217
Epoch: 8, Steps: 4 | Train Loss: 0.770 Vali Loss: 1.388 Vali Acc: 0.460 Test Loss: 1.388 Test Acc: 0.460
Validation loss decreased (-0.399985 --> -0.459986).  Saving model ...
Epoch: 9 cost time: 2.3118371963500977
Epoch: 9, Steps: 4 | Train Loss: 0.655 Vali Loss: 1.292 Vali Acc: 0.480 Test Loss: 1.292 Test Acc: 0.480
Validation loss decreased (-0.459986 --> -0.479987).  Saving model ...
Epoch: 10 cost time: 2.3875794410705566
Epoch: 10, Steps: 4 | Train Loss: 0.475 Vali Loss: 1.248 Vali Acc: 0.500 Test Loss: 1.248 Test Acc: 0.500
Validation loss decreased (-0.479987 --> -0.499988).  Saving model ...
Epoch: 11 cost time: 2.053549289703369
Epoch: 11, Steps: 4 | Train Loss: 0.396 Vali Loss: 1.245 Vali Acc: 0.480 Test Loss: 1.245 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.0631649494171143
Epoch: 12, Steps: 4 | Train Loss: 0.337 Vali Loss: 1.204 Vali Acc: 0.480 Test Loss: 1.204 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.2342185974121094
Epoch: 13, Steps: 4 | Train Loss: 0.267 Vali Loss: 1.121 Vali Acc: 0.460 Test Loss: 1.121 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.0769717693328857
Epoch: 14, Steps: 4 | Train Loss: 0.196 Vali Loss: 1.146 Vali Acc: 0.440 Test Loss: 1.146 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.5236833095550537
Epoch: 15, Steps: 4 | Train Loss: 0.153 Vali Loss: 1.163 Vali Acc: 0.500 Test Loss: 1.163 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 16 cost time: 2.220851182937622
Epoch: 16, Steps: 4 | Train Loss: 0.117 Vali Loss: 1.114 Vali Acc: 0.500 Test Loss: 1.114 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499989).  Saving model ...
Epoch: 17 cost time: 2.3588809967041016
Epoch: 17, Steps: 4 | Train Loss: 0.108 Vali Loss: 1.134 Vali Acc: 0.520 Test Loss: 1.134 Test Acc: 0.520
Validation loss decreased (-0.499989 --> -0.519989).  Saving model ...
Epoch: 18 cost time: 2.231919288635254
Epoch: 18, Steps: 4 | Train Loss: 0.099 Vali Loss: 1.308 Vali Acc: 0.500 Test Loss: 1.308 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.010671615600586
Epoch: 19, Steps: 4 | Train Loss: 0.106 Vali Loss: 1.141 Vali Acc: 0.520 Test Loss: 1.141 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.374279260635376
Epoch: 20, Steps: 4 | Train Loss: 0.074 Vali Loss: 1.079 Vali Acc: 0.500 Test Loss: 1.079 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.3079280853271484
Epoch: 21, Steps: 4 | Train Loss: 0.049 Vali Loss: 1.135 Vali Acc: 0.540 Test Loss: 1.135 Test Acc: 0.540
Validation loss decreased (-0.519989 --> -0.539989).  Saving model ...
Epoch: 22 cost time: 2.4202208518981934
Epoch: 22, Steps: 4 | Train Loss: 0.044 Vali Loss: 1.208 Vali Acc: 0.480 Test Loss: 1.208 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.1920201778411865
Epoch: 23, Steps: 4 | Train Loss: 0.047 Vali Loss: 1.168 Vali Acc: 0.520 Test Loss: 1.168 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.4510955810546875
Epoch: 24, Steps: 4 | Train Loss: 0.026 Vali Loss: 1.215 Vali Acc: 0.520 Test Loss: 1.215 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.3136789798736572
Epoch: 25, Steps: 4 | Train Loss: 0.022 Vali Loss: 1.058 Vali Acc: 0.560 Test Loss: 1.058 Test Acc: 0.560
Validation loss decreased (-0.539989 --> -0.559989).  Saving model ...
Epoch: 26 cost time: 2.324927568435669
Epoch: 26, Steps: 4 | Train Loss: 0.014 Vali Loss: 1.035 Vali Acc: 0.560 Test Loss: 1.035 Test Acc: 0.560
Validation loss decreased (-0.559989 --> -0.559990).  Saving model ...
Epoch: 27 cost time: 2.4387152194976807
Epoch: 27, Steps: 4 | Train Loss: 0.017 Vali Loss: 1.127 Vali Acc: 0.540 Test Loss: 1.127 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.139460563659668
Epoch: 28, Steps: 4 | Train Loss: 0.028 Vali Loss: 1.140 Vali Acc: 0.540 Test Loss: 1.140 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.3661954402923584
Epoch: 29, Steps: 4 | Train Loss: 0.019 Vali Loss: 1.155 Vali Acc: 0.520 Test Loss: 1.155 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.269571542739868
Epoch: 30, Steps: 4 | Train Loss: 0.014 Vali Loss: 1.436 Vali Acc: 0.520 Test Loss: 1.436 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm32_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 4860645
model size : 19.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm32_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.8988943099975586
Epoch: 1, Steps: 4 | Train Loss: 1.783 Vali Loss: 1.716 Vali Acc: 0.060 Test Loss: 1.716 Test Acc: 0.060
Validation loss decreased (inf --> -0.059983).  Saving model ...
Epoch: 2 cost time: 1.3409132957458496
Epoch: 2, Steps: 4 | Train Loss: 1.698 Vali Loss: 1.694 Vali Acc: 0.060 Test Loss: 1.694 Test Acc: 0.060
Validation loss decreased (-0.059983 --> -0.059983).  Saving model ...
Epoch: 3 cost time: 1.3010072708129883
Epoch: 3, Steps: 4 | Train Loss: 1.537 Vali Loss: 1.669 Vali Acc: 0.180 Test Loss: 1.669 Test Acc: 0.180
Validation loss decreased (-0.059983 --> -0.179983).  Saving model ...
Epoch: 4 cost time: 1.0355992317199707
Epoch: 4, Steps: 4 | Train Loss: 1.417 Vali Loss: 1.661 Vali Acc: 0.240 Test Loss: 1.661 Test Acc: 0.240
Validation loss decreased (-0.179983 --> -0.239983).  Saving model ...
Epoch: 5 cost time: 1.1402511596679688
Epoch: 5, Steps: 4 | Train Loss: 1.295 Vali Loss: 1.621 Vali Acc: 0.280 Test Loss: 1.621 Test Acc: 0.280
Validation loss decreased (-0.239983 --> -0.279984).  Saving model ...
Epoch: 6 cost time: 1.0211827754974365
Epoch: 6, Steps: 4 | Train Loss: 1.133 Vali Loss: 1.550 Vali Acc: 0.320 Test Loss: 1.550 Test Acc: 0.320
Validation loss decreased (-0.279984 --> -0.319985).  Saving model ...
Epoch: 7 cost time: 1.0724351406097412
Epoch: 7, Steps: 4 | Train Loss: 0.959 Vali Loss: 1.472 Vali Acc: 0.400 Test Loss: 1.472 Test Acc: 0.400
Validation loss decreased (-0.319985 --> -0.399985).  Saving model ...
Epoch: 8 cost time: 1.2825424671173096
Epoch: 8, Steps: 4 | Train Loss: 0.846 Vali Loss: 1.387 Vali Acc: 0.400 Test Loss: 1.387 Test Acc: 0.400
Validation loss decreased (-0.399985 --> -0.399986).  Saving model ...
Epoch: 9 cost time: 1.2161016464233398
Epoch: 9, Steps: 4 | Train Loss: 0.612 Vali Loss: 1.323 Vali Acc: 0.440 Test Loss: 1.323 Test Acc: 0.440
Validation loss decreased (-0.399986 --> -0.439987).  Saving model ...
Epoch: 10 cost time: 1.307328462600708
Epoch: 10, Steps: 4 | Train Loss: 0.553 Vali Loss: 1.245 Vali Acc: 0.480 Test Loss: 1.245 Test Acc: 0.480
Validation loss decreased (-0.439987 --> -0.479988).  Saving model ...
Epoch: 11 cost time: 1.2384777069091797
Epoch: 11, Steps: 4 | Train Loss: 0.438 Vali Loss: 1.219 Vali Acc: 0.460 Test Loss: 1.219 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2994897365570068
Epoch: 12, Steps: 4 | Train Loss: 0.460 Vali Loss: 1.169 Vali Acc: 0.500 Test Loss: 1.169 Test Acc: 0.500
Validation loss decreased (-0.479988 --> -0.499988).  Saving model ...
Epoch: 13 cost time: 1.2131097316741943
Epoch: 13, Steps: 4 | Train Loss: 0.352 Vali Loss: 1.214 Vali Acc: 0.520 Test Loss: 1.214 Test Acc: 0.520
Validation loss decreased (-0.499988 --> -0.519988).  Saving model ...
Epoch: 14 cost time: 1.3199515342712402
Epoch: 14, Steps: 4 | Train Loss: 0.273 Vali Loss: 1.114 Vali Acc: 0.520 Test Loss: 1.114 Test Acc: 0.520
Validation loss decreased (-0.519988 --> -0.519989).  Saving model ...
Epoch: 15 cost time: 1.191260814666748
Epoch: 15, Steps: 4 | Train Loss: 0.342 Vali Loss: 1.116 Vali Acc: 0.580 Test Loss: 1.116 Test Acc: 0.580
Validation loss decreased (-0.519989 --> -0.579989).  Saving model ...
Epoch: 16 cost time: 1.2727019786834717
Epoch: 16, Steps: 4 | Train Loss: 0.140 Vali Loss: 1.147 Vali Acc: 0.560 Test Loss: 1.147 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0978529453277588
Epoch: 17, Steps: 4 | Train Loss: 0.113 Vali Loss: 1.173 Vali Acc: 0.540 Test Loss: 1.173 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.3705987930297852
Epoch: 18, Steps: 4 | Train Loss: 0.100 Vali Loss: 1.108 Vali Acc: 0.520 Test Loss: 1.108 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.1298515796661377
Epoch: 19, Steps: 4 | Train Loss: 0.057 Vali Loss: 1.083 Vali Acc: 0.560 Test Loss: 1.083 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.369396448135376
Epoch: 20, Steps: 4 | Train Loss: 0.084 Vali Loss: 1.079 Vali Acc: 0.620 Test Loss: 1.079 Test Acc: 0.620
Validation loss decreased (-0.579989 --> -0.619989).  Saving model ...
Epoch: 21 cost time: 1.1082777976989746
Epoch: 21, Steps: 4 | Train Loss: 0.051 Vali Loss: 1.076 Vali Acc: 0.580 Test Loss: 1.076 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2761590480804443
Epoch: 22, Steps: 4 | Train Loss: 0.051 Vali Loss: 1.123 Vali Acc: 0.600 Test Loss: 1.123 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.115772008895874
Epoch: 23, Steps: 4 | Train Loss: 0.035 Vali Loss: 1.133 Vali Acc: 0.620 Test Loss: 1.133 Test Acc: 0.620
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.2594506740570068
Epoch: 24, Steps: 4 | Train Loss: 0.088 Vali Loss: 1.135 Vali Acc: 0.580 Test Loss: 1.135 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.068556547164917
Epoch: 25, Steps: 4 | Train Loss: 0.034 Vali Loss: 1.136 Vali Acc: 0.600 Test Loss: 1.136 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.2593464851379395
Epoch: 26, Steps: 4 | Train Loss: 0.017 Vali Loss: 1.123 Vali Acc: 0.560 Test Loss: 1.123 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.1133699417114258
Epoch: 27, Steps: 4 | Train Loss: 0.023 Vali Loss: 1.193 Vali Acc: 0.520 Test Loss: 1.193 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.1526763439178467
Epoch: 28, Steps: 4 | Train Loss: 0.018 Vali Loss: 1.136 Vali Acc: 0.560 Test Loss: 1.136 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.1776654720306396
Epoch: 29, Steps: 4 | Train Loss: 0.019 Vali Loss: 1.112 Vali Acc: 0.600 Test Loss: 1.112 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.276900053024292
Epoch: 30, Steps: 4 | Train Loss: 0.038 Vali Loss: 1.180 Vali Acc: 0.540 Test Loss: 1.180 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm32_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.62
model parameter : 1550309
model size : 6.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm32_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.9300596714019775
Epoch: 1, Steps: 4 | Train Loss: 1.676 Vali Loss: 1.651 Vali Acc: 0.240 Test Loss: 1.651 Test Acc: 0.240
Validation loss decreased (inf --> -0.239983).  Saving model ...
Epoch: 2 cost time: 1.4148602485656738
Epoch: 2, Steps: 4 | Train Loss: 1.548 Vali Loss: 1.640 Vali Acc: 0.260 Test Loss: 1.640 Test Acc: 0.260
Validation loss decreased (-0.239983 --> -0.259984).  Saving model ...
Epoch: 3 cost time: 1.5122830867767334
Epoch: 3, Steps: 4 | Train Loss: 1.533 Vali Loss: 1.629 Vali Acc: 0.300 Test Loss: 1.629 Test Acc: 0.300
Validation loss decreased (-0.259984 --> -0.299984).  Saving model ...
Epoch: 4 cost time: 1.4338057041168213
Epoch: 4, Steps: 4 | Train Loss: 1.484 Vali Loss: 1.616 Vali Acc: 0.320 Test Loss: 1.616 Test Acc: 0.320
Validation loss decreased (-0.299984 --> -0.319984).  Saving model ...
Epoch: 5 cost time: 1.5691921710968018
Epoch: 5, Steps: 4 | Train Loss: 1.265 Vali Loss: 1.586 Vali Acc: 0.340 Test Loss: 1.586 Test Acc: 0.340
Validation loss decreased (-0.319984 --> -0.339984).  Saving model ...
Epoch: 6 cost time: 1.47938871383667
Epoch: 6, Steps: 4 | Train Loss: 1.079 Vali Loss: 1.534 Vali Acc: 0.400 Test Loss: 1.534 Test Acc: 0.400
Validation loss decreased (-0.339984 --> -0.399985).  Saving model ...
Epoch: 7 cost time: 1.5096120834350586
Epoch: 7, Steps: 4 | Train Loss: 0.980 Vali Loss: 1.489 Vali Acc: 0.400 Test Loss: 1.489 Test Acc: 0.400
Validation loss decreased (-0.399985 --> -0.399985).  Saving model ...
Epoch: 8 cost time: 1.3683419227600098
Epoch: 8, Steps: 4 | Train Loss: 0.778 Vali Loss: 1.392 Vali Acc: 0.460 Test Loss: 1.392 Test Acc: 0.460
Validation loss decreased (-0.399985 --> -0.459986).  Saving model ...
Epoch: 9 cost time: 1.480400800704956
Epoch: 9, Steps: 4 | Train Loss: 0.661 Vali Loss: 1.299 Vali Acc: 0.500 Test Loss: 1.299 Test Acc: 0.500
Validation loss decreased (-0.459986 --> -0.499987).  Saving model ...
Epoch: 10 cost time: 1.5872316360473633
Epoch: 10, Steps: 4 | Train Loss: 0.504 Vali Loss: 1.263 Vali Acc: 0.520 Test Loss: 1.263 Test Acc: 0.520
Validation loss decreased (-0.499987 --> -0.519987).  Saving model ...
Epoch: 11 cost time: 1.3173270225524902
Epoch: 11, Steps: 4 | Train Loss: 0.413 Vali Loss: 1.256 Vali Acc: 0.480 Test Loss: 1.256 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.534548282623291
Epoch: 12, Steps: 4 | Train Loss: 0.353 Vali Loss: 1.217 Vali Acc: 0.480 Test Loss: 1.217 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.555283546447754
Epoch: 13, Steps: 4 | Train Loss: 0.277 Vali Loss: 1.116 Vali Acc: 0.440 Test Loss: 1.116 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.4681806564331055
Epoch: 14, Steps: 4 | Train Loss: 0.214 Vali Loss: 1.166 Vali Acc: 0.460 Test Loss: 1.166 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.4440386295318604
Epoch: 15, Steps: 4 | Train Loss: 0.150 Vali Loss: 1.167 Vali Acc: 0.520 Test Loss: 1.167 Test Acc: 0.520
Validation loss decreased (-0.519987 --> -0.519988).  Saving model ...
Epoch: 16 cost time: 1.5044903755187988
Epoch: 16, Steps: 4 | Train Loss: 0.126 Vali Loss: 1.107 Vali Acc: 0.480 Test Loss: 1.107 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.5628712177276611
Epoch: 17, Steps: 4 | Train Loss: 0.123 Vali Loss: 1.163 Vali Acc: 0.520 Test Loss: 1.163 Test Acc: 0.520
Validation loss decreased (-0.519988 --> -0.519988).  Saving model ...
Epoch: 18 cost time: 1.3824310302734375
Epoch: 18, Steps: 4 | Train Loss: 0.104 Vali Loss: 1.320 Vali Acc: 0.460 Test Loss: 1.320 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.5075201988220215
Epoch: 19, Steps: 4 | Train Loss: 0.108 Vali Loss: 1.196 Vali Acc: 0.520 Test Loss: 1.196 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.3987936973571777
Epoch: 20, Steps: 4 | Train Loss: 0.080 Vali Loss: 1.199 Vali Acc: 0.480 Test Loss: 1.199 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.4330275058746338
Epoch: 21, Steps: 4 | Train Loss: 0.048 Vali Loss: 1.246 Vali Acc: 0.460 Test Loss: 1.246 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.3226656913757324
Epoch: 22, Steps: 4 | Train Loss: 0.043 Vali Loss: 1.274 Vali Acc: 0.420 Test Loss: 1.274 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.3963043689727783
Epoch: 23, Steps: 4 | Train Loss: 0.047 Vali Loss: 1.216 Vali Acc: 0.460 Test Loss: 1.216 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.3449361324310303
Epoch: 24, Steps: 4 | Train Loss: 0.029 Vali Loss: 1.278 Vali Acc: 0.480 Test Loss: 1.278 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.4472711086273193
Epoch: 25, Steps: 4 | Train Loss: 0.021 Vali Loss: 1.192 Vali Acc: 0.460 Test Loss: 1.192 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.531078815460205
Epoch: 26, Steps: 4 | Train Loss: 0.022 Vali Loss: 1.325 Vali Acc: 0.500 Test Loss: 1.325 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.2613632678985596
Epoch: 27, Steps: 4 | Train Loss: 0.025 Vali Loss: 1.353 Vali Acc: 0.540 Test Loss: 1.353 Test Acc: 0.540
Validation loss decreased (-0.519988 --> -0.539986).  Saving model ...
Epoch: 28 cost time: 1.1828958988189697
Epoch: 28, Steps: 4 | Train Loss: 0.016 Vali Loss: 1.241 Vali Acc: 0.440 Test Loss: 1.241 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.198350429534912
Epoch: 29, Steps: 4 | Train Loss: 0.015 Vali Loss: 1.249 Vali Acc: 0.480 Test Loss: 1.249 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.2521896362304688
Epoch: 30, Steps: 4 | Train Loss: 0.020 Vali Loss: 1.331 Vali Acc: 0.500 Test Loss: 1.331 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm32_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 4860645
model size : 19.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm32_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.7559854984283447
Epoch: 1, Steps: 4 | Train Loss: 1.785 Vali Loss: 1.720 Vali Acc: 0.060 Test Loss: 1.720 Test Acc: 0.060
Validation loss decreased (inf --> -0.059983).  Saving model ...
Epoch: 2 cost time: 0.9249036312103271
Epoch: 2, Steps: 4 | Train Loss: 1.698 Vali Loss: 1.698 Vali Acc: 0.060 Test Loss: 1.698 Test Acc: 0.060
Validation loss decreased (-0.059983 --> -0.059983).  Saving model ...
Epoch: 3 cost time: 1.0109915733337402
Epoch: 3, Steps: 4 | Train Loss: 1.537 Vali Loss: 1.670 Vali Acc: 0.180 Test Loss: 1.670 Test Acc: 0.180
Validation loss decreased (-0.059983 --> -0.179983).  Saving model ...
Epoch: 4 cost time: 1.0704567432403564
Epoch: 4, Steps: 4 | Train Loss: 1.421 Vali Loss: 1.662 Vali Acc: 0.260 Test Loss: 1.662 Test Acc: 0.260
Validation loss decreased (-0.179983 --> -0.259983).  Saving model ...
Epoch: 5 cost time: 1.0163493156433105
Epoch: 5, Steps: 4 | Train Loss: 1.299 Vali Loss: 1.624 Vali Acc: 0.300 Test Loss: 1.624 Test Acc: 0.300
Validation loss decreased (-0.259983 --> -0.299984).  Saving model ...
Epoch: 6 cost time: 1.0400519371032715
Epoch: 6, Steps: 4 | Train Loss: 1.153 Vali Loss: 1.560 Vali Acc: 0.320 Test Loss: 1.560 Test Acc: 0.320
Validation loss decreased (-0.299984 --> -0.319984).  Saving model ...
Epoch: 7 cost time: 1.0554215908050537
Epoch: 7, Steps: 4 | Train Loss: 0.969 Vali Loss: 1.480 Vali Acc: 0.400 Test Loss: 1.480 Test Acc: 0.400
Validation loss decreased (-0.319984 --> -0.399985).  Saving model ...
Epoch: 8 cost time: 0.8587663173675537
Epoch: 8, Steps: 4 | Train Loss: 0.864 Vali Loss: 1.394 Vali Acc: 0.380 Test Loss: 1.394 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.121875524520874
Epoch: 9, Steps: 4 | Train Loss: 0.671 Vali Loss: 1.326 Vali Acc: 0.420 Test Loss: 1.326 Test Acc: 0.420
Validation loss decreased (-0.399985 --> -0.419987).  Saving model ...
Epoch: 10 cost time: 0.8954336643218994
Epoch: 10, Steps: 4 | Train Loss: 0.577 Vali Loss: 1.236 Vali Acc: 0.460 Test Loss: 1.236 Test Acc: 0.460
Validation loss decreased (-0.419987 --> -0.459988).  Saving model ...
Epoch: 11 cost time: 0.9735615253448486
Epoch: 11, Steps: 4 | Train Loss: 0.445 Vali Loss: 1.210 Vali Acc: 0.460 Test Loss: 1.210 Test Acc: 0.460
Validation loss decreased (-0.459988 --> -0.459988).  Saving model ...
Epoch: 12 cost time: 1.0719857215881348
Epoch: 12, Steps: 4 | Train Loss: 0.470 Vali Loss: 1.167 Vali Acc: 0.480 Test Loss: 1.167 Test Acc: 0.480
Validation loss decreased (-0.459988 --> -0.479988).  Saving model ...
Epoch: 13 cost time: 1.1490402221679688
Epoch: 13, Steps: 4 | Train Loss: 0.367 Vali Loss: 1.220 Vali Acc: 0.480 Test Loss: 1.220 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1557257175445557
Epoch: 14, Steps: 4 | Train Loss: 0.283 Vali Loss: 1.139 Vali Acc: 0.520 Test Loss: 1.139 Test Acc: 0.520
Validation loss decreased (-0.479988 --> -0.519989).  Saving model ...
Epoch: 15 cost time: 1.132429838180542
Epoch: 15, Steps: 4 | Train Loss: 0.358 Vali Loss: 1.142 Vali Acc: 0.520 Test Loss: 1.142 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9426429271697998
Epoch: 16, Steps: 4 | Train Loss: 0.148 Vali Loss: 1.172 Vali Acc: 0.500 Test Loss: 1.172 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.1182634830474854
Epoch: 17, Steps: 4 | Train Loss: 0.120 Vali Loss: 1.190 Vali Acc: 0.480 Test Loss: 1.190 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.0890467166900635
Epoch: 18, Steps: 4 | Train Loss: 0.106 Vali Loss: 1.123 Vali Acc: 0.460 Test Loss: 1.123 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.9428377151489258
Epoch: 19, Steps: 4 | Train Loss: 0.062 Vali Loss: 1.107 Vali Acc: 0.480 Test Loss: 1.107 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.151766061782837
Epoch: 20, Steps: 4 | Train Loss: 0.064 Vali Loss: 1.115 Vali Acc: 0.580 Test Loss: 1.115 Test Acc: 0.580
Validation loss decreased (-0.519989 --> -0.579989).  Saving model ...
Epoch: 21 cost time: 1.067991018295288
Epoch: 21, Steps: 4 | Train Loss: 0.052 Vali Loss: 1.130 Vali Acc: 0.520 Test Loss: 1.130 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2323377132415771
Epoch: 22, Steps: 4 | Train Loss: 0.054 Vali Loss: 1.145 Vali Acc: 0.600 Test Loss: 1.145 Test Acc: 0.600
Validation loss decreased (-0.579989 --> -0.599989).  Saving model ...
Epoch: 23 cost time: 1.0347881317138672
Epoch: 23, Steps: 4 | Train Loss: 0.037 Vali Loss: 1.169 Vali Acc: 0.500 Test Loss: 1.169 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.1018738746643066
Epoch: 24, Steps: 4 | Train Loss: 0.033 Vali Loss: 1.236 Vali Acc: 0.500 Test Loss: 1.236 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.1801300048828125
Epoch: 25, Steps: 4 | Train Loss: 0.030 Vali Loss: 1.258 Vali Acc: 0.460 Test Loss: 1.258 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.0657739639282227
Epoch: 26, Steps: 4 | Train Loss: 0.039 Vali Loss: 1.190 Vali Acc: 0.480 Test Loss: 1.190 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.9847259521484375
Epoch: 27, Steps: 4 | Train Loss: 0.023 Vali Loss: 1.222 Vali Acc: 0.520 Test Loss: 1.222 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.1285505294799805
Epoch: 28, Steps: 4 | Train Loss: 0.020 Vali Loss: 1.170 Vali Acc: 0.520 Test Loss: 1.170 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.891796350479126
Epoch: 29, Steps: 4 | Train Loss: 0.021 Vali Loss: 1.201 Vali Acc: 0.500 Test Loss: 1.201 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.0856943130493164
Epoch: 30, Steps: 4 | Train Loss: 0.037 Vali Loss: 1.372 Vali Acc: 0.500 Test Loss: 1.372 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm32_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 1550309
model size : 6.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm32_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.7532129287719727
Epoch: 1, Steps: 4 | Train Loss: 1.562 Vali Loss: 1.602 Vali Acc: 0.160 Test Loss: 1.602 Test Acc: 0.160
Validation loss decreased (inf --> -0.159984).  Saving model ...
Epoch: 2 cost time: 2.0405070781707764
Epoch: 2, Steps: 4 | Train Loss: 1.523 Vali Loss: 1.579 Vali Acc: 0.180 Test Loss: 1.579 Test Acc: 0.180
Validation loss decreased (-0.159984 --> -0.179984).  Saving model ...
Epoch: 3 cost time: 2.1967244148254395
Epoch: 3, Steps: 4 | Train Loss: 1.393 Vali Loss: 1.549 Vali Acc: 0.320 Test Loss: 1.549 Test Acc: 0.320
Validation loss decreased (-0.179984 --> -0.319985).  Saving model ...
Epoch: 4 cost time: 1.8569834232330322
Epoch: 4, Steps: 4 | Train Loss: 1.270 Vali Loss: 1.538 Vali Acc: 0.280 Test Loss: 1.538 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.2682933807373047
Epoch: 5, Steps: 4 | Train Loss: 1.214 Vali Loss: 1.535 Vali Acc: 0.280 Test Loss: 1.535 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.971301555633545
Epoch: 6, Steps: 4 | Train Loss: 1.036 Vali Loss: 1.478 Vali Acc: 0.340 Test Loss: 1.478 Test Acc: 0.340
Validation loss decreased (-0.319985 --> -0.339985).  Saving model ...
Epoch: 7 cost time: 1.693774700164795
Epoch: 7, Steps: 4 | Train Loss: 0.950 Vali Loss: 1.406 Vali Acc: 0.440 Test Loss: 1.406 Test Acc: 0.440
Validation loss decreased (-0.339985 --> -0.439986).  Saving model ...
Epoch: 8 cost time: 1.710946798324585
Epoch: 8, Steps: 4 | Train Loss: 0.913 Vali Loss: 1.358 Vali Acc: 0.400 Test Loss: 1.358 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6933681964874268
Epoch: 9, Steps: 4 | Train Loss: 0.674 Vali Loss: 1.333 Vali Acc: 0.360 Test Loss: 1.333 Test Acc: 0.360
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.9375219345092773
Epoch: 10, Steps: 4 | Train Loss: 0.528 Vali Loss: 1.264 Vali Acc: 0.520 Test Loss: 1.264 Test Acc: 0.520
Validation loss decreased (-0.439986 --> -0.519987).  Saving model ...
Epoch: 11 cost time: 1.8836565017700195
Epoch: 11, Steps: 4 | Train Loss: 0.445 Vali Loss: 1.170 Vali Acc: 0.540 Test Loss: 1.170 Test Acc: 0.540
Validation loss decreased (-0.519987 --> -0.539988).  Saving model ...
Epoch: 12 cost time: 1.9006688594818115
Epoch: 12, Steps: 4 | Train Loss: 0.284 Vali Loss: 1.115 Vali Acc: 0.500 Test Loss: 1.115 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.8350489139556885
Epoch: 13, Steps: 4 | Train Loss: 0.664 Vali Loss: 1.148 Vali Acc: 0.540 Test Loss: 1.148 Test Acc: 0.540
Validation loss decreased (-0.539988 --> -0.539989).  Saving model ...
Epoch: 14 cost time: 1.9012434482574463
Epoch: 14, Steps: 4 | Train Loss: 0.193 Vali Loss: 1.125 Vali Acc: 0.560 Test Loss: 1.125 Test Acc: 0.560
Validation loss decreased (-0.539989 --> -0.559989).  Saving model ...
Epoch: 15 cost time: 2.201970100402832
Epoch: 15, Steps: 4 | Train Loss: 0.131 Vali Loss: 1.090 Vali Acc: 0.540 Test Loss: 1.090 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.0808894634246826
Epoch: 16, Steps: 4 | Train Loss: 0.117 Vali Loss: 1.119 Vali Acc: 0.560 Test Loss: 1.119 Test Acc: 0.560
Validation loss decreased (-0.559989 --> -0.559989).  Saving model ...
Epoch: 17 cost time: 1.856010913848877
Epoch: 17, Steps: 4 | Train Loss: 0.090 Vali Loss: 1.153 Vali Acc: 0.500 Test Loss: 1.153 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.9013354778289795
Epoch: 18, Steps: 4 | Train Loss: 0.082 Vali Loss: 1.161 Vali Acc: 0.580 Test Loss: 1.161 Test Acc: 0.580
Validation loss decreased (-0.559989 --> -0.579988).  Saving model ...
Epoch: 19 cost time: 1.812570333480835
Epoch: 19, Steps: 4 | Train Loss: 0.071 Vali Loss: 1.152 Vali Acc: 0.580 Test Loss: 1.152 Test Acc: 0.580
Validation loss decreased (-0.579988 --> -0.579988).  Saving model ...
Epoch: 20 cost time: 2.151242733001709
Epoch: 20, Steps: 4 | Train Loss: 0.061 Vali Loss: 1.073 Vali Acc: 0.660 Test Loss: 1.073 Test Acc: 0.660
Validation loss decreased (-0.579988 --> -0.659989).  Saving model ...
Epoch: 21 cost time: 2.1339786052703857
Epoch: 21, Steps: 4 | Train Loss: 0.073 Vali Loss: 1.076 Vali Acc: 0.600 Test Loss: 1.076 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.2138113975524902
Epoch: 22, Steps: 4 | Train Loss: 0.036 Vali Loss: 1.121 Vali Acc: 0.680 Test Loss: 1.121 Test Acc: 0.680
Validation loss decreased (-0.659989 --> -0.679989).  Saving model ...
Epoch: 23 cost time: 2.225210189819336
Epoch: 23, Steps: 4 | Train Loss: 0.028 Vali Loss: 1.100 Vali Acc: 0.640 Test Loss: 1.100 Test Acc: 0.640
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.302729845046997
Epoch: 24, Steps: 4 | Train Loss: 0.020 Vali Loss: 1.111 Vali Acc: 0.580 Test Loss: 1.111 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.4158546924591064
Epoch: 25, Steps: 4 | Train Loss: 0.019 Vali Loss: 1.144 Vali Acc: 0.620 Test Loss: 1.144 Test Acc: 0.620
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.230111837387085
Epoch: 26, Steps: 4 | Train Loss: 0.015 Vali Loss: 1.197 Vali Acc: 0.600 Test Loss: 1.197 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.1762332916259766
Epoch: 27, Steps: 4 | Train Loss: 0.015 Vali Loss: 1.167 Vali Acc: 0.560 Test Loss: 1.167 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.9721970558166504
Epoch: 28, Steps: 4 | Train Loss: 0.014 Vali Loss: 1.174 Vali Acc: 0.600 Test Loss: 1.174 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 2.11875057220459
Epoch: 29, Steps: 4 | Train Loss: 0.036 Vali Loss: 1.193 Vali Acc: 0.620 Test Loss: 1.193 Test Acc: 0.620
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 2.156463146209717
Epoch: 30, Steps: 4 | Train Loss: 0.010 Vali Loss: 1.248 Vali Acc: 0.580 Test Loss: 1.248 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm32_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.68
model parameter : 2516965
model size : 10.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm32_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.7235963344573975
Epoch: 1, Steps: 4 | Train Loss: 1.710 Vali Loss: 1.706 Vali Acc: 0.240 Test Loss: 1.706 Test Acc: 0.240
Validation loss decreased (inf --> -0.239983).  Saving model ...
Epoch: 2 cost time: 1.2019903659820557
Epoch: 2, Steps: 4 | Train Loss: 1.589 Vali Loss: 1.670 Vali Acc: 0.200 Test Loss: 1.670 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3098065853118896
Epoch: 3, Steps: 4 | Train Loss: 1.585 Vali Loss: 1.633 Vali Acc: 0.200 Test Loss: 1.633 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1939499378204346
Epoch: 4, Steps: 4 | Train Loss: 1.458 Vali Loss: 1.594 Vali Acc: 0.280 Test Loss: 1.594 Test Acc: 0.280
Validation loss decreased (-0.239983 --> -0.279984).  Saving model ...
Epoch: 5 cost time: 1.1325204372406006
Epoch: 5, Steps: 4 | Train Loss: 1.319 Vali Loss: 1.547 Vali Acc: 0.260 Test Loss: 1.547 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2956204414367676
Epoch: 6, Steps: 4 | Train Loss: 1.063 Vali Loss: 1.490 Vali Acc: 0.320 Test Loss: 1.490 Test Acc: 0.320
Validation loss decreased (-0.279984 --> -0.319985).  Saving model ...
Epoch: 7 cost time: 1.1963493824005127
Epoch: 7, Steps: 4 | Train Loss: 1.194 Vali Loss: 1.424 Vali Acc: 0.320 Test Loss: 1.424 Test Acc: 0.320
Validation loss decreased (-0.319985 --> -0.319986).  Saving model ...
Epoch: 8 cost time: 1.072291374206543
Epoch: 8, Steps: 4 | Train Loss: 0.780 Vali Loss: 1.349 Vali Acc: 0.420 Test Loss: 1.349 Test Acc: 0.420
Validation loss decreased (-0.319986 --> -0.419987).  Saving model ...
Epoch: 9 cost time: 1.0475659370422363
Epoch: 9, Steps: 4 | Train Loss: 0.671 Vali Loss: 1.290 Vali Acc: 0.440 Test Loss: 1.290 Test Acc: 0.440
Validation loss decreased (-0.419987 --> -0.439987).  Saving model ...
Epoch: 10 cost time: 1.1027135848999023
Epoch: 10, Steps: 4 | Train Loss: 0.509 Vali Loss: 1.303 Vali Acc: 0.480 Test Loss: 1.303 Test Acc: 0.480
Validation loss decreased (-0.439987 --> -0.479987).  Saving model ...
Epoch: 11 cost time: 1.3553338050842285
Epoch: 11, Steps: 4 | Train Loss: 0.480 Vali Loss: 1.269 Vali Acc: 0.480 Test Loss: 1.269 Test Acc: 0.480
Validation loss decreased (-0.479987 --> -0.479987).  Saving model ...
Epoch: 12 cost time: 1.3617067337036133
Epoch: 12, Steps: 4 | Train Loss: 0.541 Vali Loss: 1.131 Vali Acc: 0.460 Test Loss: 1.131 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1501502990722656
Epoch: 13, Steps: 4 | Train Loss: 0.343 Vali Loss: 1.091 Vali Acc: 0.500 Test Loss: 1.091 Test Acc: 0.500
Validation loss decreased (-0.479987 --> -0.499989).  Saving model ...
Epoch: 14 cost time: 1.357280969619751
Epoch: 14, Steps: 4 | Train Loss: 0.295 Vali Loss: 1.191 Vali Acc: 0.500 Test Loss: 1.191 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4171605110168457
Epoch: 15, Steps: 4 | Train Loss: 0.276 Vali Loss: 1.109 Vali Acc: 0.520 Test Loss: 1.109 Test Acc: 0.520
Validation loss decreased (-0.499989 --> -0.519989).  Saving model ...
Epoch: 16 cost time: 1.248805046081543
Epoch: 16, Steps: 4 | Train Loss: 0.161 Vali Loss: 1.096 Vali Acc: 0.560 Test Loss: 1.096 Test Acc: 0.560
Validation loss decreased (-0.519989 --> -0.559989).  Saving model ...
Epoch: 17 cost time: 1.2753159999847412
Epoch: 17, Steps: 4 | Train Loss: 0.114 Vali Loss: 1.123 Vali Acc: 0.580 Test Loss: 1.123 Test Acc: 0.580
Validation loss decreased (-0.559989 --> -0.579989).  Saving model ...
Epoch: 18 cost time: 1.3445115089416504
Epoch: 18, Steps: 4 | Train Loss: 0.119 Vali Loss: 1.130 Vali Acc: 0.540 Test Loss: 1.130 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2051606178283691
Epoch: 19, Steps: 4 | Train Loss: 0.093 Vali Loss: 1.208 Vali Acc: 0.560 Test Loss: 1.208 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.2867999076843262
Epoch: 20, Steps: 4 | Train Loss: 0.071 Vali Loss: 1.109 Vali Acc: 0.520 Test Loss: 1.109 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.3042762279510498
Epoch: 21, Steps: 4 | Train Loss: 0.047 Vali Loss: 1.105 Vali Acc: 0.520 Test Loss: 1.105 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.3264057636260986
Epoch: 22, Steps: 4 | Train Loss: 0.037 Vali Loss: 1.151 Vali Acc: 0.600 Test Loss: 1.151 Test Acc: 0.600
Validation loss decreased (-0.579989 --> -0.599988).  Saving model ...
Epoch: 23 cost time: 1.1917786598205566
Epoch: 23, Steps: 4 | Train Loss: 0.034 Vali Loss: 1.138 Vali Acc: 0.620 Test Loss: 1.138 Test Acc: 0.620
Validation loss decreased (-0.599988 --> -0.619989).  Saving model ...
Epoch: 24 cost time: 1.0796124935150146
Epoch: 24, Steps: 4 | Train Loss: 0.029 Vali Loss: 1.174 Vali Acc: 0.560 Test Loss: 1.174 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.2342827320098877
Epoch: 25, Steps: 4 | Train Loss: 0.024 Vali Loss: 1.132 Vali Acc: 0.620 Test Loss: 1.132 Test Acc: 0.620
Validation loss decreased (-0.619989 --> -0.619989).  Saving model ...
Epoch: 26 cost time: 1.288224220275879
Epoch: 26, Steps: 4 | Train Loss: 0.018 Vali Loss: 1.193 Vali Acc: 0.600 Test Loss: 1.193 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.25398588180542
Epoch: 27, Steps: 4 | Train Loss: 0.017 Vali Loss: 1.142 Vali Acc: 0.620 Test Loss: 1.142 Test Acc: 0.620
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.3428089618682861
Epoch: 28, Steps: 4 | Train Loss: 0.020 Vali Loss: 1.108 Vali Acc: 0.580 Test Loss: 1.108 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.8979041576385498
Epoch: 29, Steps: 4 | Train Loss: 0.039 Vali Loss: 1.120 Vali Acc: 0.600 Test Loss: 1.120 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.2814810276031494
Epoch: 30, Steps: 4 | Train Loss: 0.013 Vali Loss: 1.332 Vali Acc: 0.560 Test Loss: 1.332 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm32_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.62
model parameter : 861669
model size : 3.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm32_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.245730400085449
Epoch: 1, Steps: 4 | Train Loss: 1.561 Vali Loss: 1.604 Vali Acc: 0.160 Test Loss: 1.604 Test Acc: 0.160
Validation loss decreased (inf --> -0.159984).  Saving model ...
Epoch: 2 cost time: 1.6884846687316895
Epoch: 2, Steps: 4 | Train Loss: 1.522 Vali Loss: 1.580 Vali Acc: 0.180 Test Loss: 1.580 Test Acc: 0.180
Validation loss decreased (-0.159984 --> -0.179984).  Saving model ...
Epoch: 3 cost time: 1.559377908706665
Epoch: 3, Steps: 4 | Train Loss: 1.393 Vali Loss: 1.550 Vali Acc: 0.320 Test Loss: 1.550 Test Acc: 0.320
Validation loss decreased (-0.179984 --> -0.319984).  Saving model ...
Epoch: 4 cost time: 1.7487046718597412
Epoch: 4, Steps: 4 | Train Loss: 1.270 Vali Loss: 1.539 Vali Acc: 0.280 Test Loss: 1.539 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6093432903289795
Epoch: 5, Steps: 4 | Train Loss: 1.215 Vali Loss: 1.535 Vali Acc: 0.280 Test Loss: 1.535 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.4045026302337646
Epoch: 6, Steps: 4 | Train Loss: 1.036 Vali Loss: 1.479 Vali Acc: 0.340 Test Loss: 1.479 Test Acc: 0.340
Validation loss decreased (-0.319984 --> -0.339985).  Saving model ...
Epoch: 7 cost time: 1.7743439674377441
Epoch: 7, Steps: 4 | Train Loss: 0.936 Vali Loss: 1.407 Vali Acc: 0.440 Test Loss: 1.407 Test Acc: 0.440
Validation loss decreased (-0.339985 --> -0.439986).  Saving model ...
Epoch: 8 cost time: 1.6573662757873535
Epoch: 8, Steps: 4 | Train Loss: 0.917 Vali Loss: 1.359 Vali Acc: 0.400 Test Loss: 1.359 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5833520889282227
Epoch: 9, Steps: 4 | Train Loss: 0.673 Vali Loss: 1.335 Vali Acc: 0.360 Test Loss: 1.335 Test Acc: 0.360
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.6937038898468018
Epoch: 10, Steps: 4 | Train Loss: 0.528 Vali Loss: 1.270 Vali Acc: 0.520 Test Loss: 1.270 Test Acc: 0.520
Validation loss decreased (-0.439986 --> -0.519987).  Saving model ...
Epoch: 11 cost time: 1.6874363422393799
Epoch: 11, Steps: 4 | Train Loss: 0.447 Vali Loss: 1.175 Vali Acc: 0.540 Test Loss: 1.175 Test Acc: 0.540
Validation loss decreased (-0.519987 --> -0.539988).  Saving model ...
Epoch: 12 cost time: 1.5236930847167969
Epoch: 12, Steps: 4 | Train Loss: 0.287 Vali Loss: 1.123 Vali Acc: 0.500 Test Loss: 1.123 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.714890956878662
Epoch: 13, Steps: 4 | Train Loss: 0.666 Vali Loss: 1.160 Vali Acc: 0.540 Test Loss: 1.160 Test Acc: 0.540
Validation loss decreased (-0.539988 --> -0.539988).  Saving model ...
Epoch: 14 cost time: 1.7230780124664307
Epoch: 14, Steps: 4 | Train Loss: 0.195 Vali Loss: 1.136 Vali Acc: 0.500 Test Loss: 1.136 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.9094176292419434
Epoch: 15, Steps: 4 | Train Loss: 0.132 Vali Loss: 1.097 Vali Acc: 0.560 Test Loss: 1.097 Test Acc: 0.560
Validation loss decreased (-0.539988 --> -0.559989).  Saving model ...
Epoch: 16 cost time: 1.8820130825042725
Epoch: 16, Steps: 4 | Train Loss: 0.116 Vali Loss: 1.133 Vali Acc: 0.560 Test Loss: 1.133 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.5335495471954346
Epoch: 17, Steps: 4 | Train Loss: 0.090 Vali Loss: 1.182 Vali Acc: 0.480 Test Loss: 1.182 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.7217202186584473
Epoch: 18, Steps: 4 | Train Loss: 0.082 Vali Loss: 1.206 Vali Acc: 0.580 Test Loss: 1.206 Test Acc: 0.580
Validation loss decreased (-0.559989 --> -0.579988).  Saving model ...
Epoch: 19 cost time: 1.7034497261047363
Epoch: 19, Steps: 4 | Train Loss: 0.072 Vali Loss: 1.201 Vali Acc: 0.520 Test Loss: 1.201 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.649977207183838
Epoch: 20, Steps: 4 | Train Loss: 0.061 Vali Loss: 1.130 Vali Acc: 0.600 Test Loss: 1.130 Test Acc: 0.600
Validation loss decreased (-0.579988 --> -0.599989).  Saving model ...
Epoch: 21 cost time: 1.7232081890106201
Epoch: 21, Steps: 4 | Train Loss: 0.074 Vali Loss: 1.130 Vali Acc: 0.560 Test Loss: 1.130 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.594221830368042
Epoch: 22, Steps: 4 | Train Loss: 0.035 Vali Loss: 1.184 Vali Acc: 0.660 Test Loss: 1.184 Test Acc: 0.660
Validation loss decreased (-0.599989 --> -0.659988).  Saving model ...
Epoch: 23 cost time: 1.6342401504516602
Epoch: 23, Steps: 4 | Train Loss: 0.029 Vali Loss: 1.160 Vali Acc: 0.600 Test Loss: 1.160 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.732128620147705
Epoch: 24, Steps: 4 | Train Loss: 0.021 Vali Loss: 1.172 Vali Acc: 0.560 Test Loss: 1.172 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.6147208213806152
Epoch: 25, Steps: 4 | Train Loss: 0.018 Vali Loss: 1.211 Vali Acc: 0.580 Test Loss: 1.211 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.7084498405456543
Epoch: 26, Steps: 4 | Train Loss: 0.015 Vali Loss: 1.259 Vali Acc: 0.580 Test Loss: 1.259 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.8836021423339844
Epoch: 27, Steps: 4 | Train Loss: 0.014 Vali Loss: 1.223 Vali Acc: 0.560 Test Loss: 1.223 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.7031450271606445
Epoch: 28, Steps: 4 | Train Loss: 0.013 Vali Loss: 1.238 Vali Acc: 0.580 Test Loss: 1.238 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.8117938041687012
Epoch: 29, Steps: 4 | Train Loss: 0.036 Vali Loss: 1.262 Vali Acc: 0.580 Test Loss: 1.262 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.8406076431274414
Epoch: 30, Steps: 4 | Train Loss: 0.010 Vali Loss: 1.331 Vali Acc: 0.560 Test Loss: 1.331 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm32_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.66
model parameter : 2516965
model size : 10.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm32_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.8015830516815186
Epoch: 1, Steps: 4 | Train Loss: 1.711 Vali Loss: 1.706 Vali Acc: 0.220 Test Loss: 1.706 Test Acc: 0.220
Validation loss decreased (inf --> -0.219983).  Saving model ...
Epoch: 2 cost time: 1.1782889366149902
Epoch: 2, Steps: 4 | Train Loss: 1.592 Vali Loss: 1.669 Vali Acc: 0.200 Test Loss: 1.669 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1747677326202393
Epoch: 3, Steps: 4 | Train Loss: 1.586 Vali Loss: 1.632 Vali Acc: 0.200 Test Loss: 1.632 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.271632432937622
Epoch: 4, Steps: 4 | Train Loss: 1.441 Vali Loss: 1.593 Vali Acc: 0.280 Test Loss: 1.593 Test Acc: 0.280
Validation loss decreased (-0.219983 --> -0.279984).  Saving model ...
Epoch: 5 cost time: 1.131995439529419
Epoch: 5, Steps: 4 | Train Loss: 1.322 Vali Loss: 1.546 Vali Acc: 0.280 Test Loss: 1.546 Test Acc: 0.280
Validation loss decreased (-0.279984 --> -0.279985).  Saving model ...
Epoch: 6 cost time: 1.2295098304748535
Epoch: 6, Steps: 4 | Train Loss: 1.065 Vali Loss: 1.489 Vali Acc: 0.340 Test Loss: 1.489 Test Acc: 0.340
Validation loss decreased (-0.279985 --> -0.339985).  Saving model ...
Epoch: 7 cost time: 1.277991771697998
Epoch: 7, Steps: 4 | Train Loss: 1.193 Vali Loss: 1.421 Vali Acc: 0.320 Test Loss: 1.421 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.206869125366211
Epoch: 8, Steps: 4 | Train Loss: 0.783 Vali Loss: 1.345 Vali Acc: 0.460 Test Loss: 1.345 Test Acc: 0.460
Validation loss decreased (-0.339985 --> -0.459987).  Saving model ...
Epoch: 9 cost time: 1.017928123474121
Epoch: 9, Steps: 4 | Train Loss: 0.673 Vali Loss: 1.286 Vali Acc: 0.460 Test Loss: 1.286 Test Acc: 0.460
Validation loss decreased (-0.459987 --> -0.459987).  Saving model ...
Epoch: 10 cost time: 1.0987648963928223
Epoch: 10, Steps: 4 | Train Loss: 0.509 Vali Loss: 1.298 Vali Acc: 0.480 Test Loss: 1.298 Test Acc: 0.480
Validation loss decreased (-0.459987 --> -0.479987).  Saving model ...
Epoch: 11 cost time: 1.1743247509002686
Epoch: 11, Steps: 4 | Train Loss: 0.481 Vali Loss: 1.265 Vali Acc: 0.480 Test Loss: 1.265 Test Acc: 0.480
Validation loss decreased (-0.479987 --> -0.479987).  Saving model ...
Epoch: 12 cost time: 1.1670451164245605
Epoch: 12, Steps: 4 | Train Loss: 0.547 Vali Loss: 1.123 Vali Acc: 0.460 Test Loss: 1.123 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1108636856079102
Epoch: 13, Steps: 4 | Train Loss: 0.347 Vali Loss: 1.083 Vali Acc: 0.520 Test Loss: 1.083 Test Acc: 0.520
Validation loss decreased (-0.479987 --> -0.519989).  Saving model ...
Epoch: 14 cost time: 1.227832555770874
Epoch: 14, Steps: 4 | Train Loss: 0.307 Vali Loss: 1.180 Vali Acc: 0.500 Test Loss: 1.180 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1637928485870361
Epoch: 15, Steps: 4 | Train Loss: 0.271 Vali Loss: 1.091 Vali Acc: 0.520 Test Loss: 1.091 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.1549665927886963
Epoch: 16, Steps: 4 | Train Loss: 0.162 Vali Loss: 1.079 Vali Acc: 0.560 Test Loss: 1.079 Test Acc: 0.560
Validation loss decreased (-0.519989 --> -0.559989).  Saving model ...
Epoch: 17 cost time: 1.1241543292999268
Epoch: 17, Steps: 4 | Train Loss: 0.144 Vali Loss: 1.094 Vali Acc: 0.560 Test Loss: 1.094 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.233489990234375
Epoch: 18, Steps: 4 | Train Loss: 0.128 Vali Loss: 1.104 Vali Acc: 0.560 Test Loss: 1.104 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.1653845310211182
Epoch: 19, Steps: 4 | Train Loss: 0.090 Vali Loss: 1.202 Vali Acc: 0.600 Test Loss: 1.202 Test Acc: 0.600
Validation loss decreased (-0.559989 --> -0.599988).  Saving model ...
Epoch: 20 cost time: 1.2679095268249512
Epoch: 20, Steps: 4 | Train Loss: 0.074 Vali Loss: 1.110 Vali Acc: 0.580 Test Loss: 1.110 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.3075523376464844
Epoch: 21, Steps: 4 | Train Loss: 0.049 Vali Loss: 1.088 Vali Acc: 0.580 Test Loss: 1.088 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.1963222026824951
Epoch: 22, Steps: 4 | Train Loss: 0.041 Vali Loss: 1.159 Vali Acc: 0.600 Test Loss: 1.159 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599988).  Saving model ...
Epoch: 23 cost time: 1.222771167755127
Epoch: 23, Steps: 4 | Train Loss: 0.036 Vali Loss: 1.145 Vali Acc: 0.620 Test Loss: 1.145 Test Acc: 0.620
Validation loss decreased (-0.599988 --> -0.619989).  Saving model ...
Epoch: 24 cost time: 1.2092735767364502
Epoch: 24, Steps: 4 | Train Loss: 0.030 Vali Loss: 1.131 Vali Acc: 0.560 Test Loss: 1.131 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.2246699333190918
Epoch: 25, Steps: 4 | Train Loss: 0.028 Vali Loss: 1.089 Vali Acc: 0.640 Test Loss: 1.089 Test Acc: 0.640
Validation loss decreased (-0.619989 --> -0.639989).  Saving model ...
Epoch: 26 cost time: 1.2025883197784424
Epoch: 26, Steps: 4 | Train Loss: 0.021 Vali Loss: 1.171 Vali Acc: 0.620 Test Loss: 1.171 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.075772762298584
Epoch: 27, Steps: 4 | Train Loss: 0.020 Vali Loss: 1.116 Vali Acc: 0.620 Test Loss: 1.116 Test Acc: 0.620
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.3046810626983643
Epoch: 28, Steps: 4 | Train Loss: 0.020 Vali Loss: 1.089 Vali Acc: 0.600 Test Loss: 1.089 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.2324302196502686
Epoch: 29, Steps: 4 | Train Loss: 0.039 Vali Loss: 1.081 Vali Acc: 0.620 Test Loss: 1.081 Test Acc: 0.620
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.2778770923614502
Epoch: 30, Steps: 4 | Train Loss: 0.012 Vali Loss: 1.217 Vali Acc: 0.560 Test Loss: 1.217 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm32_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.64
model parameter : 861669
model size : 3.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm32_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.305152177810669
Epoch: 1, Steps: 4 | Train Loss: 1.561 Vali Loss: 1.605 Vali Acc: 0.160 Test Loss: 1.605 Test Acc: 0.160
Validation loss decreased (inf --> -0.159984).  Saving model ...
Epoch: 2 cost time: 1.0564348697662354
Epoch: 2, Steps: 4 | Train Loss: 1.525 Vali Loss: 1.581 Vali Acc: 0.180 Test Loss: 1.581 Test Acc: 0.180
Validation loss decreased (-0.159984 --> -0.179984).  Saving model ...
Epoch: 3 cost time: 1.260633945465088
Epoch: 3, Steps: 4 | Train Loss: 1.394 Vali Loss: 1.550 Vali Acc: 0.320 Test Loss: 1.550 Test Acc: 0.320
Validation loss decreased (-0.179984 --> -0.319984).  Saving model ...
Epoch: 4 cost time: 1.1415460109710693
Epoch: 4, Steps: 4 | Train Loss: 1.272 Vali Loss: 1.539 Vali Acc: 0.280 Test Loss: 1.539 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2626383304595947
Epoch: 5, Steps: 4 | Train Loss: 1.216 Vali Loss: 1.535 Vali Acc: 0.280 Test Loss: 1.535 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.3757736682891846
Epoch: 6, Steps: 4 | Train Loss: 1.041 Vali Loss: 1.479 Vali Acc: 0.320 Test Loss: 1.479 Test Acc: 0.320
Validation loss decreased (-0.319984 --> -0.319985).  Saving model ...
Epoch: 7 cost time: 1.178267478942871
Epoch: 7, Steps: 4 | Train Loss: 0.947 Vali Loss: 1.408 Vali Acc: 0.440 Test Loss: 1.408 Test Acc: 0.440
Validation loss decreased (-0.319985 --> -0.439986).  Saving model ...
Epoch: 8 cost time: 1.3239176273345947
Epoch: 8, Steps: 4 | Train Loss: 0.921 Vali Loss: 1.359 Vali Acc: 0.420 Test Loss: 1.359 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3456907272338867
Epoch: 9, Steps: 4 | Train Loss: 0.732 Vali Loss: 1.332 Vali Acc: 0.400 Test Loss: 1.332 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.2424068450927734
Epoch: 10, Steps: 4 | Train Loss: 0.544 Vali Loss: 1.259 Vali Acc: 0.540 Test Loss: 1.259 Test Acc: 0.540
Validation loss decreased (-0.439986 --> -0.539987).  Saving model ...
Epoch: 11 cost time: 1.3841917514801025
Epoch: 11, Steps: 4 | Train Loss: 0.453 Vali Loss: 1.170 Vali Acc: 0.540 Test Loss: 1.170 Test Acc: 0.540
Validation loss decreased (-0.539987 --> -0.539988).  Saving model ...
Epoch: 12 cost time: 1.260298252105713
Epoch: 12, Steps: 4 | Train Loss: 0.296 Vali Loss: 1.121 Vali Acc: 0.480 Test Loss: 1.121 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.350053310394287
Epoch: 13, Steps: 4 | Train Loss: 0.662 Vali Loss: 1.142 Vali Acc: 0.520 Test Loss: 1.142 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.324509620666504
Epoch: 14, Steps: 4 | Train Loss: 0.203 Vali Loss: 1.120 Vali Acc: 0.500 Test Loss: 1.120 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.3843333721160889
Epoch: 15, Steps: 4 | Train Loss: 0.141 Vali Loss: 1.090 Vali Acc: 0.520 Test Loss: 1.090 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.1809251308441162
Epoch: 16, Steps: 4 | Train Loss: 0.127 Vali Loss: 1.116 Vali Acc: 0.560 Test Loss: 1.116 Test Acc: 0.560
Validation loss decreased (-0.539988 --> -0.559989).  Saving model ...
Epoch: 17 cost time: 1.3475983142852783
Epoch: 17, Steps: 4 | Train Loss: 0.098 Vali Loss: 1.145 Vali Acc: 0.480 Test Loss: 1.145 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.363008737564087
Epoch: 18, Steps: 4 | Train Loss: 0.090 Vali Loss: 1.159 Vali Acc: 0.580 Test Loss: 1.159 Test Acc: 0.580
Validation loss decreased (-0.559989 --> -0.579988).  Saving model ...
Epoch: 19 cost time: 1.177912950515747
Epoch: 19, Steps: 4 | Train Loss: 0.082 Vali Loss: 1.134 Vali Acc: 0.540 Test Loss: 1.134 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.3781733512878418
Epoch: 20, Steps: 4 | Train Loss: 0.065 Vali Loss: 1.031 Vali Acc: 0.600 Test Loss: 1.031 Test Acc: 0.600
Validation loss decreased (-0.579988 --> -0.599990).  Saving model ...
Epoch: 21 cost time: 1.1217551231384277
Epoch: 21, Steps: 4 | Train Loss: 0.083 Vali Loss: 1.058 Vali Acc: 0.600 Test Loss: 1.058 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0839667320251465
Epoch: 22, Steps: 4 | Train Loss: 0.039 Vali Loss: 1.161 Vali Acc: 0.620 Test Loss: 1.161 Test Acc: 0.620
Validation loss decreased (-0.599990 --> -0.619988).  Saving model ...
Epoch: 23 cost time: 1.3007290363311768
Epoch: 23, Steps: 4 | Train Loss: 0.030 Vali Loss: 1.119 Vali Acc: 0.620 Test Loss: 1.119 Test Acc: 0.620
Validation loss decreased (-0.619988 --> -0.619989).  Saving model ...
Epoch: 24 cost time: 1.1401793956756592
Epoch: 24, Steps: 4 | Train Loss: 0.024 Vali Loss: 1.113 Vali Acc: 0.620 Test Loss: 1.113 Test Acc: 0.620
Validation loss decreased (-0.619989 --> -0.619989).  Saving model ...
Epoch: 25 cost time: 1.3249971866607666
Epoch: 25, Steps: 4 | Train Loss: 0.019 Vali Loss: 1.151 Vali Acc: 0.580 Test Loss: 1.151 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.0917115211486816
Epoch: 26, Steps: 4 | Train Loss: 0.016 Vali Loss: 1.233 Vali Acc: 0.600 Test Loss: 1.233 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.2291107177734375
Epoch: 27, Steps: 4 | Train Loss: 0.014 Vali Loss: 1.216 Vali Acc: 0.540 Test Loss: 1.216 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.2475645542144775
Epoch: 28, Steps: 4 | Train Loss: 0.014 Vali Loss: 1.220 Vali Acc: 0.580 Test Loss: 1.220 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.2099907398223877
Epoch: 29, Steps: 4 | Train Loss: 0.041 Vali Loss: 1.221 Vali Acc: 0.600 Test Loss: 1.221 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.1614067554473877
Epoch: 30, Steps: 4 | Train Loss: 0.011 Vali Loss: 1.282 Vali Acc: 0.600 Test Loss: 1.282 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm32_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.62
model parameter : 2516965
model size : 10.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm32_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.1434435844421387
Epoch: 1, Steps: 4 | Train Loss: 1.709 Vali Loss: 1.705 Vali Acc: 0.220 Test Loss: 1.705 Test Acc: 0.220
Validation loss decreased (inf --> -0.219983).  Saving model ...
Epoch: 2 cost time: 0.7079098224639893
Epoch: 2, Steps: 4 | Train Loss: 1.592 Vali Loss: 1.668 Vali Acc: 0.200 Test Loss: 1.668 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8450682163238525
Epoch: 3, Steps: 4 | Train Loss: 1.582 Vali Loss: 1.630 Vali Acc: 0.200 Test Loss: 1.630 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8188340663909912
Epoch: 4, Steps: 4 | Train Loss: 1.449 Vali Loss: 1.589 Vali Acc: 0.280 Test Loss: 1.589 Test Acc: 0.280
Validation loss decreased (-0.219983 --> -0.279984).  Saving model ...
Epoch: 5 cost time: 0.7561948299407959
Epoch: 5, Steps: 4 | Train Loss: 1.325 Vali Loss: 1.540 Vali Acc: 0.280 Test Loss: 1.540 Test Acc: 0.280
Validation loss decreased (-0.279984 --> -0.279985).  Saving model ...
Epoch: 6 cost time: 0.7823152542114258
Epoch: 6, Steps: 4 | Train Loss: 1.075 Vali Loss: 1.482 Vali Acc: 0.320 Test Loss: 1.482 Test Acc: 0.320
Validation loss decreased (-0.279985 --> -0.319985).  Saving model ...
Epoch: 7 cost time: 1.0048718452453613
Epoch: 7, Steps: 4 | Train Loss: 1.199 Vali Loss: 1.414 Vali Acc: 0.340 Test Loss: 1.414 Test Acc: 0.340
Validation loss decreased (-0.319985 --> -0.339986).  Saving model ...
Epoch: 8 cost time: 0.92268967628479
Epoch: 8, Steps: 4 | Train Loss: 0.840 Vali Loss: 1.336 Vali Acc: 0.400 Test Loss: 1.336 Test Acc: 0.400
Validation loss decreased (-0.339986 --> -0.399987).  Saving model ...
Epoch: 9 cost time: 0.9755406379699707
Epoch: 9, Steps: 4 | Train Loss: 0.688 Vali Loss: 1.273 Vali Acc: 0.460 Test Loss: 1.273 Test Acc: 0.460
Validation loss decreased (-0.399987 --> -0.459987).  Saving model ...
Epoch: 10 cost time: 0.8963913917541504
Epoch: 10, Steps: 4 | Train Loss: 0.525 Vali Loss: 1.286 Vali Acc: 0.480 Test Loss: 1.286 Test Acc: 0.480
Validation loss decreased (-0.459987 --> -0.479987).  Saving model ...
Epoch: 11 cost time: 0.9873354434967041
Epoch: 11, Steps: 4 | Train Loss: 0.495 Vali Loss: 1.258 Vali Acc: 0.460 Test Loss: 1.258 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8196461200714111
Epoch: 12, Steps: 4 | Train Loss: 0.558 Vali Loss: 1.122 Vali Acc: 0.480 Test Loss: 1.122 Test Acc: 0.480
Validation loss decreased (-0.479987 --> -0.479989).  Saving model ...
Epoch: 13 cost time: 0.9731786251068115
Epoch: 13, Steps: 4 | Train Loss: 0.397 Vali Loss: 1.084 Vali Acc: 0.480 Test Loss: 1.084 Test Acc: 0.480
Validation loss decreased (-0.479989 --> -0.479989).  Saving model ...
Epoch: 14 cost time: 0.8228707313537598
Epoch: 14, Steps: 4 | Train Loss: 0.329 Vali Loss: 1.177 Vali Acc: 0.480 Test Loss: 1.177 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9958007335662842
Epoch: 15, Steps: 4 | Train Loss: 0.276 Vali Loss: 1.097 Vali Acc: 0.540 Test Loss: 1.097 Test Acc: 0.540
Validation loss decreased (-0.479989 --> -0.539989).  Saving model ...
Epoch: 16 cost time: 0.9419136047363281
Epoch: 16, Steps: 4 | Train Loss: 0.178 Vali Loss: 1.111 Vali Acc: 0.540 Test Loss: 1.111 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.799797773361206
Epoch: 17, Steps: 4 | Train Loss: 0.121 Vali Loss: 1.141 Vali Acc: 0.560 Test Loss: 1.141 Test Acc: 0.560
Validation loss decreased (-0.539989 --> -0.559989).  Saving model ...
Epoch: 18 cost time: 0.8525338172912598
Epoch: 18, Steps: 4 | Train Loss: 0.129 Vali Loss: 1.136 Vali Acc: 0.580 Test Loss: 1.136 Test Acc: 0.580
Validation loss decreased (-0.559989 --> -0.579989).  Saving model ...
Epoch: 19 cost time: 0.8650386333465576
Epoch: 19, Steps: 4 | Train Loss: 0.111 Vali Loss: 1.212 Vali Acc: 0.600 Test Loss: 1.212 Test Acc: 0.600
Validation loss decreased (-0.579989 --> -0.599988).  Saving model ...
Epoch: 20 cost time: 0.8494200706481934
Epoch: 20, Steps: 4 | Train Loss: 0.080 Vali Loss: 1.112 Vali Acc: 0.620 Test Loss: 1.112 Test Acc: 0.620
Validation loss decreased (-0.599988 --> -0.619989).  Saving model ...
Epoch: 21 cost time: 0.8795545101165771
Epoch: 21, Steps: 4 | Train Loss: 0.052 Vali Loss: 1.130 Vali Acc: 0.560 Test Loss: 1.130 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9646608829498291
Epoch: 22, Steps: 4 | Train Loss: 0.041 Vali Loss: 1.194 Vali Acc: 0.580 Test Loss: 1.194 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.0806002616882324
Epoch: 23, Steps: 4 | Train Loss: 0.033 Vali Loss: 1.141 Vali Acc: 0.540 Test Loss: 1.141 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.0295615196228027
Epoch: 24, Steps: 4 | Train Loss: 0.032 Vali Loss: 1.132 Vali Acc: 0.520 Test Loss: 1.132 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.9578640460968018
Epoch: 25, Steps: 4 | Train Loss: 0.025 Vali Loss: 1.147 Vali Acc: 0.600 Test Loss: 1.147 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.940601110458374
Epoch: 26, Steps: 4 | Train Loss: 0.022 Vali Loss: 1.131 Vali Acc: 0.600 Test Loss: 1.131 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.823573112487793
Epoch: 27, Steps: 4 | Train Loss: 0.016 Vali Loss: 1.114 Vali Acc: 0.600 Test Loss: 1.114 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.0122919082641602
Epoch: 28, Steps: 4 | Train Loss: 0.027 Vali Loss: 1.123 Vali Acc: 0.580 Test Loss: 1.123 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.8134233951568604
Epoch: 29, Steps: 4 | Train Loss: 0.040 Vali Loss: 1.141 Vali Acc: 0.600 Test Loss: 1.141 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.9732925891876221
Epoch: 30, Steps: 4 | Train Loss: 0.017 Vali Loss: 1.396 Vali Acc: 0.560 Test Loss: 1.396 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm32_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.62
model parameter : 861669
model size : 3.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm16_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.171224594116211
Epoch: 1, Steps: 4 | Train Loss: 1.665 Vali Loss: 1.641 Vali Acc: 0.220 Test Loss: 1.641 Test Acc: 0.220
Validation loss decreased (inf --> -0.219984).  Saving model ...
Epoch: 2 cost time: 2.286870002746582
Epoch: 2, Steps: 4 | Train Loss: 1.667 Vali Loss: 1.626 Vali Acc: 0.220 Test Loss: 1.626 Test Acc: 0.220
Validation loss decreased (-0.219984 --> -0.219984).  Saving model ...
Epoch: 3 cost time: 2.5059382915496826
Epoch: 3, Steps: 4 | Train Loss: 1.599 Vali Loss: 1.604 Vali Acc: 0.340 Test Loss: 1.604 Test Acc: 0.340
Validation loss decreased (-0.219984 --> -0.339984).  Saving model ...
Epoch: 4 cost time: 2.2270352840423584
Epoch: 4, Steps: 4 | Train Loss: 1.491 Vali Loss: 1.578 Vali Acc: 0.320 Test Loss: 1.578 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.3847696781158447
Epoch: 5, Steps: 4 | Train Loss: 1.441 Vali Loss: 1.550 Vali Acc: 0.380 Test Loss: 1.550 Test Acc: 0.380
Validation loss decreased (-0.339984 --> -0.379985).  Saving model ...
Epoch: 6 cost time: 2.495528221130371
Epoch: 6, Steps: 4 | Train Loss: 1.283 Vali Loss: 1.523 Vali Acc: 0.400 Test Loss: 1.523 Test Acc: 0.400
Validation loss decreased (-0.379985 --> -0.399985).  Saving model ...
Epoch: 7 cost time: 2.2947072982788086
Epoch: 7, Steps: 4 | Train Loss: 1.147 Vali Loss: 1.497 Vali Acc: 0.400 Test Loss: 1.497 Test Acc: 0.400
Validation loss decreased (-0.399985 --> -0.399985).  Saving model ...
Epoch: 8 cost time: 2.5854544639587402
Epoch: 8, Steps: 4 | Train Loss: 1.067 Vali Loss: 1.465 Vali Acc: 0.440 Test Loss: 1.465 Test Acc: 0.440
Validation loss decreased (-0.399985 --> -0.439985).  Saving model ...
Epoch: 9 cost time: 2.3357865810394287
Epoch: 9, Steps: 4 | Train Loss: 0.925 Vali Loss: 1.433 Vali Acc: 0.440 Test Loss: 1.433 Test Acc: 0.440
Validation loss decreased (-0.439985 --> -0.439986).  Saving model ...
Epoch: 10 cost time: 2.520707845687866
Epoch: 10, Steps: 4 | Train Loss: 0.809 Vali Loss: 1.387 Vali Acc: 0.440 Test Loss: 1.387 Test Acc: 0.440
Validation loss decreased (-0.439986 --> -0.439986).  Saving model ...
Epoch: 11 cost time: 1.8183445930480957
Epoch: 11, Steps: 4 | Train Loss: 0.748 Vali Loss: 1.340 Vali Acc: 0.460 Test Loss: 1.340 Test Acc: 0.460
Validation loss decreased (-0.439986 --> -0.459987).  Saving model ...
Epoch: 12 cost time: 2.2243494987487793
Epoch: 12, Steps: 4 | Train Loss: 0.673 Vali Loss: 1.299 Vali Acc: 0.440 Test Loss: 1.299 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.4094185829162598
Epoch: 13, Steps: 4 | Train Loss: 0.605 Vali Loss: 1.284 Vali Acc: 0.460 Test Loss: 1.284 Test Acc: 0.460
Validation loss decreased (-0.459987 --> -0.459987).  Saving model ...
Epoch: 14 cost time: 2.0625884532928467
Epoch: 14, Steps: 4 | Train Loss: 0.480 Vali Loss: 1.255 Vali Acc: 0.440 Test Loss: 1.255 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.4474713802337646
Epoch: 15, Steps: 4 | Train Loss: 0.632 Vali Loss: 1.214 Vali Acc: 0.480 Test Loss: 1.214 Test Acc: 0.480
Validation loss decreased (-0.459987 --> -0.479988).  Saving model ...
Epoch: 16 cost time: 1.8559091091156006
Epoch: 16, Steps: 4 | Train Loss: 0.348 Vali Loss: 1.171 Vali Acc: 0.460 Test Loss: 1.171 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.412928819656372
Epoch: 17, Steps: 4 | Train Loss: 0.310 Vali Loss: 1.209 Vali Acc: 0.480 Test Loss: 1.209 Test Acc: 0.480
Validation loss decreased (-0.479988 --> -0.479988).  Saving model ...
Epoch: 18 cost time: 2.5927441120147705
Epoch: 18, Steps: 4 | Train Loss: 0.266 Vali Loss: 1.202 Vali Acc: 0.500 Test Loss: 1.202 Test Acc: 0.500
Validation loss decreased (-0.479988 --> -0.499988).  Saving model ...
Epoch: 19 cost time: 2.3984804153442383
Epoch: 19, Steps: 4 | Train Loss: 0.209 Vali Loss: 1.169 Vali Acc: 0.520 Test Loss: 1.169 Test Acc: 0.520
Validation loss decreased (-0.499988 --> -0.519988).  Saving model ...
Epoch: 20 cost time: 2.4881370067596436
Epoch: 20, Steps: 4 | Train Loss: 0.208 Vali Loss: 1.160 Vali Acc: 0.520 Test Loss: 1.160 Test Acc: 0.520
Validation loss decreased (-0.519988 --> -0.519988).  Saving model ...
Epoch: 21 cost time: 2.6783287525177
Epoch: 21, Steps: 4 | Train Loss: 0.175 Vali Loss: 1.175 Vali Acc: 0.500 Test Loss: 1.175 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.3739328384399414
Epoch: 22, Steps: 4 | Train Loss: 0.175 Vali Loss: 1.170 Vali Acc: 0.520 Test Loss: 1.170 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.5788016319274902
Epoch: 23, Steps: 4 | Train Loss: 0.266 Vali Loss: 1.195 Vali Acc: 0.500 Test Loss: 1.195 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.4981346130371094
Epoch: 24, Steps: 4 | Train Loss: 0.232 Vali Loss: 1.138 Vali Acc: 0.520 Test Loss: 1.138 Test Acc: 0.520
Validation loss decreased (-0.519988 --> -0.519989).  Saving model ...
Epoch: 25 cost time: 2.5055692195892334
Epoch: 25, Steps: 4 | Train Loss: 0.118 Vali Loss: 1.288 Vali Acc: 0.520 Test Loss: 1.288 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.697267532348633
Epoch: 26, Steps: 4 | Train Loss: 0.151 Vali Loss: 1.297 Vali Acc: 0.480 Test Loss: 1.297 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.382934808731079
Epoch: 27, Steps: 4 | Train Loss: 0.085 Vali Loss: 1.236 Vali Acc: 0.600 Test Loss: 1.236 Test Acc: 0.600
Validation loss decreased (-0.519989 --> -0.599988).  Saving model ...
Epoch: 28 cost time: 2.4587066173553467
Epoch: 28, Steps: 4 | Train Loss: 0.080 Vali Loss: 1.199 Vali Acc: 0.560 Test Loss: 1.199 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.1885857582092285
Epoch: 29, Steps: 4 | Train Loss: 0.098 Vali Loss: 1.245 Vali Acc: 0.520 Test Loss: 1.245 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.7472939491271973
Epoch: 30, Steps: 4 | Train Loss: 0.049 Vali Loss: 1.248 Vali Acc: 0.520 Test Loss: 1.248 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm16_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 2431093
model size : 9.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm16_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.061432123184204
Epoch: 1, Steps: 4 | Train Loss: 1.658 Vali Loss: 1.670 Vali Acc: 0.140 Test Loss: 1.670 Test Acc: 0.140
Validation loss decreased (inf --> -0.139983).  Saving model ...
Epoch: 2 cost time: 1.4429945945739746
Epoch: 2, Steps: 4 | Train Loss: 1.663 Vali Loss: 1.656 Vali Acc: 0.200 Test Loss: 1.656 Test Acc: 0.200
Validation loss decreased (-0.139983 --> -0.199983).  Saving model ...
Epoch: 3 cost time: 1.4804832935333252
Epoch: 3, Steps: 4 | Train Loss: 1.601 Vali Loss: 1.638 Vali Acc: 0.220 Test Loss: 1.638 Test Acc: 0.220
Validation loss decreased (-0.199983 --> -0.219984).  Saving model ...
Epoch: 4 cost time: 1.3535444736480713
Epoch: 4, Steps: 4 | Train Loss: 1.515 Vali Loss: 1.621 Vali Acc: 0.240 Test Loss: 1.621 Test Acc: 0.240
Validation loss decreased (-0.219984 --> -0.239984).  Saving model ...
Epoch: 5 cost time: 1.3849952220916748
Epoch: 5, Steps: 4 | Train Loss: 1.496 Vali Loss: 1.609 Vali Acc: 0.240 Test Loss: 1.609 Test Acc: 0.240
Validation loss decreased (-0.239984 --> -0.239984).  Saving model ...
Epoch: 6 cost time: 1.471449613571167
Epoch: 6, Steps: 4 | Train Loss: 1.351 Vali Loss: 1.594 Vali Acc: 0.220 Test Loss: 1.594 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4155669212341309
Epoch: 7, Steps: 4 | Train Loss: 1.279 Vali Loss: 1.563 Vali Acc: 0.280 Test Loss: 1.563 Test Acc: 0.280
Validation loss decreased (-0.239984 --> -0.279984).  Saving model ...
Epoch: 8 cost time: 1.4320261478424072
Epoch: 8, Steps: 4 | Train Loss: 1.175 Vali Loss: 1.523 Vali Acc: 0.300 Test Loss: 1.523 Test Acc: 0.300
Validation loss decreased (-0.279984 --> -0.299985).  Saving model ...
Epoch: 9 cost time: 1.4298198223114014
Epoch: 9, Steps: 4 | Train Loss: 1.231 Vali Loss: 1.474 Vali Acc: 0.320 Test Loss: 1.474 Test Acc: 0.320
Validation loss decreased (-0.299985 --> -0.319985).  Saving model ...
Epoch: 10 cost time: 1.5942187309265137
Epoch: 10, Steps: 4 | Train Loss: 1.011 Vali Loss: 1.413 Vali Acc: 0.420 Test Loss: 1.413 Test Acc: 0.420
Validation loss decreased (-0.319985 --> -0.419986).  Saving model ...
Epoch: 11 cost time: 1.4225380420684814
Epoch: 11, Steps: 4 | Train Loss: 0.831 Vali Loss: 1.359 Vali Acc: 0.440 Test Loss: 1.359 Test Acc: 0.440
Validation loss decreased (-0.419986 --> -0.439986).  Saving model ...
Epoch: 12 cost time: 1.2738533020019531
Epoch: 12, Steps: 4 | Train Loss: 0.721 Vali Loss: 1.305 Vali Acc: 0.420 Test Loss: 1.305 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2204523086547852
Epoch: 13, Steps: 4 | Train Loss: 0.560 Vali Loss: 1.259 Vali Acc: 0.440 Test Loss: 1.259 Test Acc: 0.440
Validation loss decreased (-0.439986 --> -0.439987).  Saving model ...
Epoch: 14 cost time: 1.2600598335266113
Epoch: 14, Steps: 4 | Train Loss: 0.455 Vali Loss: 1.260 Vali Acc: 0.440 Test Loss: 1.260 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.5884649753570557
Epoch: 15, Steps: 4 | Train Loss: 0.453 Vali Loss: 1.198 Vali Acc: 0.500 Test Loss: 1.198 Test Acc: 0.500
Validation loss decreased (-0.439987 --> -0.499988).  Saving model ...
Epoch: 16 cost time: 1.3820338249206543
Epoch: 16, Steps: 4 | Train Loss: 0.327 Vali Loss: 1.211 Vali Acc: 0.500 Test Loss: 1.211 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.427579641342163
Epoch: 17, Steps: 4 | Train Loss: 0.493 Vali Loss: 1.223 Vali Acc: 0.500 Test Loss: 1.223 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.4286973476409912
Epoch: 18, Steps: 4 | Train Loss: 0.472 Vali Loss: 1.195 Vali Acc: 0.500 Test Loss: 1.195 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 19 cost time: 1.5050816535949707
Epoch: 19, Steps: 4 | Train Loss: 0.399 Vali Loss: 1.109 Vali Acc: 0.580 Test Loss: 1.109 Test Acc: 0.580
Validation loss decreased (-0.499988 --> -0.579989).  Saving model ...
Epoch: 20 cost time: 1.5501019954681396
Epoch: 20, Steps: 4 | Train Loss: 0.198 Vali Loss: 1.273 Vali Acc: 0.560 Test Loss: 1.273 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.5139853954315186
Epoch: 21, Steps: 4 | Train Loss: 0.145 Vali Loss: 1.272 Vali Acc: 0.560 Test Loss: 1.272 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.3852455615997314
Epoch: 22, Steps: 4 | Train Loss: 0.144 Vali Loss: 1.192 Vali Acc: 0.580 Test Loss: 1.192 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.5289502143859863
Epoch: 23, Steps: 4 | Train Loss: 0.135 Vali Loss: 1.335 Vali Acc: 0.520 Test Loss: 1.335 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.4045493602752686
Epoch: 24, Steps: 4 | Train Loss: 0.084 Vali Loss: 1.307 Vali Acc: 0.580 Test Loss: 1.307 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.3568952083587646
Epoch: 25, Steps: 4 | Train Loss: 0.065 Vali Loss: 1.342 Vali Acc: 0.620 Test Loss: 1.342 Test Acc: 0.620
Validation loss decreased (-0.579989 --> -0.619987).  Saving model ...
Epoch: 26 cost time: 1.3700768947601318
Epoch: 26, Steps: 4 | Train Loss: 0.058 Vali Loss: 1.293 Vali Acc: 0.620 Test Loss: 1.293 Test Acc: 0.620
Validation loss decreased (-0.619987 --> -0.619987).  Saving model ...
Epoch: 27 cost time: 1.5963215827941895
Epoch: 27, Steps: 4 | Train Loss: 0.048 Vali Loss: 1.430 Vali Acc: 0.580 Test Loss: 1.430 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.4660320281982422
Epoch: 28, Steps: 4 | Train Loss: 0.031 Vali Loss: 1.399 Vali Acc: 0.580 Test Loss: 1.399 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.4338188171386719
Epoch: 29, Steps: 4 | Train Loss: 0.033 Vali Loss: 1.436 Vali Acc: 0.600 Test Loss: 1.436 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.4498653411865234
Epoch: 30, Steps: 4 | Train Loss: 0.035 Vali Loss: 1.539 Vali Acc: 0.540 Test Loss: 1.539 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm16_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.62
model parameter : 775669
model size : 3.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm16_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.2408030033111572
Epoch: 1, Steps: 4 | Train Loss: 1.664 Vali Loss: 1.640 Vali Acc: 0.200 Test Loss: 1.640 Test Acc: 0.200
Validation loss decreased (inf --> -0.199984).  Saving model ...
Epoch: 2 cost time: 1.801600694656372
Epoch: 2, Steps: 4 | Train Loss: 1.666 Vali Loss: 1.626 Vali Acc: 0.220 Test Loss: 1.626 Test Acc: 0.220
Validation loss decreased (-0.199984 --> -0.219984).  Saving model ...
Epoch: 3 cost time: 1.9593405723571777
Epoch: 3, Steps: 4 | Train Loss: 1.600 Vali Loss: 1.604 Vali Acc: 0.340 Test Loss: 1.604 Test Acc: 0.340
Validation loss decreased (-0.219984 --> -0.339984).  Saving model ...
Epoch: 4 cost time: 2.2337446212768555
Epoch: 4, Steps: 4 | Train Loss: 1.494 Vali Loss: 1.578 Vali Acc: 0.340 Test Loss: 1.578 Test Acc: 0.340
Validation loss decreased (-0.339984 --> -0.339984).  Saving model ...
Epoch: 5 cost time: 1.7664680480957031
Epoch: 5, Steps: 4 | Train Loss: 1.446 Vali Loss: 1.550 Vali Acc: 0.400 Test Loss: 1.550 Test Acc: 0.400
Validation loss decreased (-0.339984 --> -0.399984).  Saving model ...
Epoch: 6 cost time: 1.8139936923980713
Epoch: 6, Steps: 4 | Train Loss: 1.294 Vali Loss: 1.524 Vali Acc: 0.400 Test Loss: 1.524 Test Acc: 0.400
Validation loss decreased (-0.399984 --> -0.399985).  Saving model ...
Epoch: 7 cost time: 2.01224946975708
Epoch: 7, Steps: 4 | Train Loss: 1.154 Vali Loss: 1.500 Vali Acc: 0.400 Test Loss: 1.500 Test Acc: 0.400
Validation loss decreased (-0.399985 --> -0.399985).  Saving model ...
Epoch: 8 cost time: 1.9368808269500732
Epoch: 8, Steps: 4 | Train Loss: 1.076 Vali Loss: 1.468 Vali Acc: 0.440 Test Loss: 1.468 Test Acc: 0.440
Validation loss decreased (-0.399985 --> -0.439985).  Saving model ...
Epoch: 9 cost time: 1.8632187843322754
Epoch: 9, Steps: 4 | Train Loss: 0.941 Vali Loss: 1.441 Vali Acc: 0.440 Test Loss: 1.441 Test Acc: 0.440
Validation loss decreased (-0.439985 --> -0.439986).  Saving model ...
Epoch: 10 cost time: 2.0002057552337646
Epoch: 10, Steps: 4 | Train Loss: 0.821 Vali Loss: 1.399 Vali Acc: 0.460 Test Loss: 1.399 Test Acc: 0.460
Validation loss decreased (-0.439986 --> -0.459986).  Saving model ...
Epoch: 11 cost time: 2.264625310897827
Epoch: 11, Steps: 4 | Train Loss: 0.764 Vali Loss: 1.351 Vali Acc: 0.480 Test Loss: 1.351 Test Acc: 0.480
Validation loss decreased (-0.459986 --> -0.479986).  Saving model ...
Epoch: 12 cost time: 1.856046438217163
Epoch: 12, Steps: 4 | Train Loss: 0.681 Vali Loss: 1.304 Vali Acc: 0.460 Test Loss: 1.304 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.919891595840454
Epoch: 13, Steps: 4 | Train Loss: 0.610 Vali Loss: 1.287 Vali Acc: 0.460 Test Loss: 1.287 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.9986846446990967
Epoch: 14, Steps: 4 | Train Loss: 0.499 Vali Loss: 1.257 Vali Acc: 0.440 Test Loss: 1.257 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.0550360679626465
Epoch: 15, Steps: 4 | Train Loss: 0.631 Vali Loss: 1.213 Vali Acc: 0.460 Test Loss: 1.213 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.692263126373291
Epoch: 16, Steps: 4 | Train Loss: 0.333 Vali Loss: 1.169 Vali Acc: 0.460 Test Loss: 1.169 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.7265009880065918
Epoch: 17, Steps: 4 | Train Loss: 0.316 Vali Loss: 1.232 Vali Acc: 0.500 Test Loss: 1.232 Test Acc: 0.500
Validation loss decreased (-0.479986 --> -0.499988).  Saving model ...
Epoch: 18 cost time: 1.9983744621276855
Epoch: 18, Steps: 4 | Train Loss: 0.267 Vali Loss: 1.223 Vali Acc: 0.500 Test Loss: 1.223 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 19 cost time: 1.766252040863037
Epoch: 19, Steps: 4 | Train Loss: 0.206 Vali Loss: 1.171 Vali Acc: 0.500 Test Loss: 1.171 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 20 cost time: 1.9067251682281494
Epoch: 20, Steps: 4 | Train Loss: 0.211 Vali Loss: 1.160 Vali Acc: 0.520 Test Loss: 1.160 Test Acc: 0.520
Validation loss decreased (-0.499988 --> -0.519988).  Saving model ...
Epoch: 21 cost time: 2.14079213142395
Epoch: 21, Steps: 4 | Train Loss: 0.177 Vali Loss: 1.184 Vali Acc: 0.500 Test Loss: 1.184 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.281050443649292
Epoch: 22, Steps: 4 | Train Loss: 0.176 Vali Loss: 1.169 Vali Acc: 0.520 Test Loss: 1.169 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.0066967010498047
Epoch: 23, Steps: 4 | Train Loss: 0.257 Vali Loss: 1.233 Vali Acc: 0.540 Test Loss: 1.233 Test Acc: 0.540
Validation loss decreased (-0.519988 --> -0.539988).  Saving model ...
Epoch: 24 cost time: 2.0549445152282715
Epoch: 24, Steps: 4 | Train Loss: 0.198 Vali Loss: 1.169 Vali Acc: 0.540 Test Loss: 1.169 Test Acc: 0.540
Validation loss decreased (-0.539988 --> -0.539988).  Saving model ...
Epoch: 25 cost time: 1.9701027870178223
Epoch: 25, Steps: 4 | Train Loss: 0.118 Vali Loss: 1.349 Vali Acc: 0.500 Test Loss: 1.349 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.0078680515289307
Epoch: 26, Steps: 4 | Train Loss: 0.169 Vali Loss: 1.366 Vali Acc: 0.440 Test Loss: 1.366 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.1439058780670166
Epoch: 27, Steps: 4 | Train Loss: 0.137 Vali Loss: 1.244 Vali Acc: 0.600 Test Loss: 1.244 Test Acc: 0.600
Validation loss decreased (-0.539988 --> -0.599988).  Saving model ...
Epoch: 28 cost time: 2.2521162033081055
Epoch: 28, Steps: 4 | Train Loss: 0.093 Vali Loss: 1.257 Vali Acc: 0.520 Test Loss: 1.257 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.0644609928131104
Epoch: 29, Steps: 4 | Train Loss: 0.113 Vali Loss: 1.278 Vali Acc: 0.480 Test Loss: 1.278 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.9904799461364746
Epoch: 30, Steps: 4 | Train Loss: 0.049 Vali Loss: 1.325 Vali Acc: 0.520 Test Loss: 1.325 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm16_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 2431093
model size : 9.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm16_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.7939538955688477
Epoch: 1, Steps: 4 | Train Loss: 1.662 Vali Loss: 1.661 Vali Acc: 0.140 Test Loss: 1.661 Test Acc: 0.140
Validation loss decreased (inf --> -0.139983).  Saving model ...
Epoch: 2 cost time: 1.203751802444458
Epoch: 2, Steps: 4 | Train Loss: 1.699 Vali Loss: 1.648 Vali Acc: 0.180 Test Loss: 1.648 Test Acc: 0.180
Validation loss decreased (-0.139983 --> -0.179984).  Saving model ...
Epoch: 3 cost time: 1.2151405811309814
Epoch: 3, Steps: 4 | Train Loss: 1.627 Vali Loss: 1.631 Vali Acc: 0.220 Test Loss: 1.631 Test Acc: 0.220
Validation loss decreased (-0.179984 --> -0.219984).  Saving model ...
Epoch: 4 cost time: 1.159137487411499
Epoch: 4, Steps: 4 | Train Loss: 1.519 Vali Loss: 1.615 Vali Acc: 0.220 Test Loss: 1.615 Test Acc: 0.220
Validation loss decreased (-0.219984 --> -0.219984).  Saving model ...
Epoch: 5 cost time: 1.1830363273620605
Epoch: 5, Steps: 4 | Train Loss: 1.499 Vali Loss: 1.605 Vali Acc: 0.240 Test Loss: 1.605 Test Acc: 0.240
Validation loss decreased (-0.219984 --> -0.239984).  Saving model ...
Epoch: 6 cost time: 1.1460158824920654
Epoch: 6, Steps: 4 | Train Loss: 1.347 Vali Loss: 1.590 Vali Acc: 0.220 Test Loss: 1.590 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.156090497970581
Epoch: 7, Steps: 4 | Train Loss: 1.283 Vali Loss: 1.560 Vali Acc: 0.320 Test Loss: 1.560 Test Acc: 0.320
Validation loss decreased (-0.239984 --> -0.319984).  Saving model ...
Epoch: 8 cost time: 1.3025805950164795
Epoch: 8, Steps: 4 | Train Loss: 1.189 Vali Loss: 1.522 Vali Acc: 0.340 Test Loss: 1.522 Test Acc: 0.340
Validation loss decreased (-0.319984 --> -0.339985).  Saving model ...
Epoch: 9 cost time: 1.2792668342590332
Epoch: 9, Steps: 4 | Train Loss: 1.230 Vali Loss: 1.472 Vali Acc: 0.360 Test Loss: 1.472 Test Acc: 0.360
Validation loss decreased (-0.339985 --> -0.359985).  Saving model ...
Epoch: 10 cost time: 1.3519387245178223
Epoch: 10, Steps: 4 | Train Loss: 1.009 Vali Loss: 1.409 Vali Acc: 0.380 Test Loss: 1.409 Test Acc: 0.380
Validation loss decreased (-0.359985 --> -0.379986).  Saving model ...
Epoch: 11 cost time: 1.173218011856079
Epoch: 11, Steps: 4 | Train Loss: 0.836 Vali Loss: 1.365 Vali Acc: 0.440 Test Loss: 1.365 Test Acc: 0.440
Validation loss decreased (-0.379986 --> -0.439986).  Saving model ...
Epoch: 12 cost time: 1.0845057964324951
Epoch: 12, Steps: 4 | Train Loss: 0.728 Vali Loss: 1.317 Vali Acc: 0.440 Test Loss: 1.317 Test Acc: 0.440
Validation loss decreased (-0.439986 --> -0.439987).  Saving model ...
Epoch: 13 cost time: 1.0640532970428467
Epoch: 13, Steps: 4 | Train Loss: 0.556 Vali Loss: 1.276 Vali Acc: 0.480 Test Loss: 1.276 Test Acc: 0.480
Validation loss decreased (-0.439987 --> -0.479987).  Saving model ...
Epoch: 14 cost time: 1.0828611850738525
Epoch: 14, Steps: 4 | Train Loss: 0.456 Vali Loss: 1.257 Vali Acc: 0.460 Test Loss: 1.257 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1064178943634033
Epoch: 15, Steps: 4 | Train Loss: 0.458 Vali Loss: 1.207 Vali Acc: 0.500 Test Loss: 1.207 Test Acc: 0.500
Validation loss decreased (-0.479987 --> -0.499988).  Saving model ...
Epoch: 16 cost time: 1.098499059677124
Epoch: 16, Steps: 4 | Train Loss: 0.328 Vali Loss: 1.244 Vali Acc: 0.480 Test Loss: 1.244 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1662592887878418
Epoch: 17, Steps: 4 | Train Loss: 0.485 Vali Loss: 1.261 Vali Acc: 0.520 Test Loss: 1.261 Test Acc: 0.520
Validation loss decreased (-0.499988 --> -0.519987).  Saving model ...
Epoch: 18 cost time: 1.088630199432373
Epoch: 18, Steps: 4 | Train Loss: 0.496 Vali Loss: 1.213 Vali Acc: 0.540 Test Loss: 1.213 Test Acc: 0.540
Validation loss decreased (-0.519987 --> -0.539988).  Saving model ...
Epoch: 19 cost time: 1.2080838680267334
Epoch: 19, Steps: 4 | Train Loss: 0.422 Vali Loss: 1.164 Vali Acc: 0.520 Test Loss: 1.164 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1700849533081055
Epoch: 20, Steps: 4 | Train Loss: 0.199 Vali Loss: 1.269 Vali Acc: 0.500 Test Loss: 1.269 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.22454833984375
Epoch: 21, Steps: 4 | Train Loss: 0.139 Vali Loss: 1.260 Vali Acc: 0.560 Test Loss: 1.260 Test Acc: 0.560
Validation loss decreased (-0.539988 --> -0.559987).  Saving model ...
Epoch: 22 cost time: 1.1868622303009033
Epoch: 22, Steps: 4 | Train Loss: 0.136 Vali Loss: 1.209 Vali Acc: 0.560 Test Loss: 1.209 Test Acc: 0.560
Validation loss decreased (-0.559987 --> -0.559988).  Saving model ...
Epoch: 23 cost time: 1.1797373294830322
Epoch: 23, Steps: 4 | Train Loss: 0.114 Vali Loss: 1.400 Vali Acc: 0.520 Test Loss: 1.400 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.2714359760284424
Epoch: 24, Steps: 4 | Train Loss: 0.074 Vali Loss: 1.420 Vali Acc: 0.540 Test Loss: 1.420 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.3077044486999512
Epoch: 25, Steps: 4 | Train Loss: 0.060 Vali Loss: 1.523 Vali Acc: 0.560 Test Loss: 1.523 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.2436246871948242
Epoch: 26, Steps: 4 | Train Loss: 0.049 Vali Loss: 1.491 Vali Acc: 0.540 Test Loss: 1.491 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.1849746704101562
Epoch: 27, Steps: 4 | Train Loss: 0.036 Vali Loss: 1.566 Vali Acc: 0.500 Test Loss: 1.566 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.2676928043365479
Epoch: 28, Steps: 4 | Train Loss: 0.034 Vali Loss: 1.585 Vali Acc: 0.580 Test Loss: 1.585 Test Acc: 0.580
Validation loss decreased (-0.559988 --> -0.579984).  Saving model ...
Epoch: 29 cost time: 1.2397987842559814
Epoch: 29, Steps: 4 | Train Loss: 0.022 Vali Loss: 1.607 Vali Acc: 0.500 Test Loss: 1.607 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.197847604751587
Epoch: 30, Steps: 4 | Train Loss: 0.030 Vali Loss: 1.564 Vali Acc: 0.520 Test Loss: 1.564 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm16_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 775669
model size : 3.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm16_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.372694730758667
Epoch: 1, Steps: 4 | Train Loss: 1.665 Vali Loss: 1.639 Vali Acc: 0.200 Test Loss: 1.639 Test Acc: 0.200
Validation loss decreased (inf --> -0.199984).  Saving model ...
Epoch: 2 cost time: 1.3701086044311523
Epoch: 2, Steps: 4 | Train Loss: 1.662 Vali Loss: 1.624 Vali Acc: 0.200 Test Loss: 1.624 Test Acc: 0.200
Validation loss decreased (-0.199984 --> -0.199984).  Saving model ...
Epoch: 3 cost time: 1.3909809589385986
Epoch: 3, Steps: 4 | Train Loss: 1.601 Vali Loss: 1.604 Vali Acc: 0.300 Test Loss: 1.604 Test Acc: 0.300
Validation loss decreased (-0.199984 --> -0.299984).  Saving model ...
Epoch: 4 cost time: 1.1958465576171875
Epoch: 4, Steps: 4 | Train Loss: 1.500 Vali Loss: 1.580 Vali Acc: 0.320 Test Loss: 1.580 Test Acc: 0.320
Validation loss decreased (-0.299984 --> -0.319984).  Saving model ...
Epoch: 5 cost time: 1.4439747333526611
Epoch: 5, Steps: 4 | Train Loss: 1.454 Vali Loss: 1.551 Vali Acc: 0.360 Test Loss: 1.551 Test Acc: 0.360
Validation loss decreased (-0.319984 --> -0.359984).  Saving model ...
Epoch: 6 cost time: 1.4626100063323975
Epoch: 6, Steps: 4 | Train Loss: 1.309 Vali Loss: 1.524 Vali Acc: 0.340 Test Loss: 1.524 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2915363311767578
Epoch: 7, Steps: 4 | Train Loss: 1.195 Vali Loss: 1.499 Vali Acc: 0.340 Test Loss: 1.499 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2386956214904785
Epoch: 8, Steps: 4 | Train Loss: 1.105 Vali Loss: 1.469 Vali Acc: 0.380 Test Loss: 1.469 Test Acc: 0.380
Validation loss decreased (-0.359984 --> -0.379985).  Saving model ...
Epoch: 9 cost time: 1.4176552295684814
Epoch: 9, Steps: 4 | Train Loss: 0.998 Vali Loss: 1.443 Vali Acc: 0.400 Test Loss: 1.443 Test Acc: 0.400
Validation loss decreased (-0.379985 --> -0.399986).  Saving model ...
Epoch: 10 cost time: 1.3640332221984863
Epoch: 10, Steps: 4 | Train Loss: 0.891 Vali Loss: 1.405 Vali Acc: 0.400 Test Loss: 1.405 Test Acc: 0.400
Validation loss decreased (-0.399986 --> -0.399986).  Saving model ...
Epoch: 11 cost time: 1.1057240962982178
Epoch: 11, Steps: 4 | Train Loss: 0.782 Vali Loss: 1.362 Vali Acc: 0.420 Test Loss: 1.362 Test Acc: 0.420
Validation loss decreased (-0.399986 --> -0.419986).  Saving model ...
Epoch: 12 cost time: 1.4283528327941895
Epoch: 12, Steps: 4 | Train Loss: 0.730 Vali Loss: 1.317 Vali Acc: 0.400 Test Loss: 1.317 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3645386695861816
Epoch: 13, Steps: 4 | Train Loss: 0.639 Vali Loss: 1.284 Vali Acc: 0.400 Test Loss: 1.284 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.307687759399414
Epoch: 14, Steps: 4 | Train Loss: 0.531 Vali Loss: 1.254 Vali Acc: 0.480 Test Loss: 1.254 Test Acc: 0.480
Validation loss decreased (-0.419986 --> -0.479987).  Saving model ...
Epoch: 15 cost time: 1.4294474124908447
Epoch: 15, Steps: 4 | Train Loss: 0.680 Vali Loss: 1.208 Vali Acc: 0.520 Test Loss: 1.208 Test Acc: 0.520
Validation loss decreased (-0.479987 --> -0.519988).  Saving model ...
Epoch: 16 cost time: 1.2502214908599854
Epoch: 16, Steps: 4 | Train Loss: 0.359 Vali Loss: 1.151 Vali Acc: 0.480 Test Loss: 1.151 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3982429504394531
Epoch: 17, Steps: 4 | Train Loss: 0.344 Vali Loss: 1.187 Vali Acc: 0.500 Test Loss: 1.187 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.4348695278167725
Epoch: 18, Steps: 4 | Train Loss: 0.284 Vali Loss: 1.169 Vali Acc: 0.500 Test Loss: 1.169 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.3950307369232178
Epoch: 19, Steps: 4 | Train Loss: 0.227 Vali Loss: 1.131 Vali Acc: 0.480 Test Loss: 1.131 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.2352254390716553
Epoch: 20, Steps: 4 | Train Loss: 0.222 Vali Loss: 1.126 Vali Acc: 0.540 Test Loss: 1.126 Test Acc: 0.540
Validation loss decreased (-0.519988 --> -0.539989).  Saving model ...
Epoch: 21 cost time: 1.3712959289550781
Epoch: 21, Steps: 4 | Train Loss: 0.192 Vali Loss: 1.136 Vali Acc: 0.520 Test Loss: 1.136 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2644097805023193
Epoch: 22, Steps: 4 | Train Loss: 0.178 Vali Loss: 1.114 Vali Acc: 0.540 Test Loss: 1.114 Test Acc: 0.540
Validation loss decreased (-0.539989 --> -0.539989).  Saving model ...
Epoch: 23 cost time: 1.3107578754425049
Epoch: 23, Steps: 4 | Train Loss: 0.265 Vali Loss: 1.161 Vali Acc: 0.560 Test Loss: 1.161 Test Acc: 0.560
Validation loss decreased (-0.539989 --> -0.559988).  Saving model ...
Epoch: 24 cost time: 1.3510675430297852
Epoch: 24, Steps: 4 | Train Loss: 0.170 Vali Loss: 1.107 Vali Acc: 0.560 Test Loss: 1.107 Test Acc: 0.560
Validation loss decreased (-0.559988 --> -0.559989).  Saving model ...
Epoch: 25 cost time: 1.2222614288330078
Epoch: 25, Steps: 4 | Train Loss: 0.126 Vali Loss: 1.264 Vali Acc: 0.520 Test Loss: 1.264 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.3311851024627686
Epoch: 26, Steps: 4 | Train Loss: 0.148 Vali Loss: 1.177 Vali Acc: 0.540 Test Loss: 1.177 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.4563512802124023
Epoch: 27, Steps: 4 | Train Loss: 0.117 Vali Loss: 1.113 Vali Acc: 0.560 Test Loss: 1.113 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.346374273300171
Epoch: 28, Steps: 4 | Train Loss: 0.079 Vali Loss: 1.229 Vali Acc: 0.480 Test Loss: 1.229 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.3335576057434082
Epoch: 29, Steps: 4 | Train Loss: 0.105 Vali Loss: 1.139 Vali Acc: 0.540 Test Loss: 1.139 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.431579351425171
Epoch: 30, Steps: 4 | Train Loss: 0.051 Vali Loss: 1.264 Vali Acc: 0.500 Test Loss: 1.264 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm16_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 2431093
model size : 9.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm16_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.4468185901641846
Epoch: 1, Steps: 4 | Train Loss: 1.659 Vali Loss: 1.675 Vali Acc: 0.160 Test Loss: 1.675 Test Acc: 0.160
Validation loss decreased (inf --> -0.159983).  Saving model ...
Epoch: 2 cost time: 1.0516765117645264
Epoch: 2, Steps: 4 | Train Loss: 1.691 Vali Loss: 1.662 Vali Acc: 0.220 Test Loss: 1.662 Test Acc: 0.220
Validation loss decreased (-0.159983 --> -0.219983).  Saving model ...
Epoch: 3 cost time: 0.8704204559326172
Epoch: 3, Steps: 4 | Train Loss: 1.617 Vali Loss: 1.646 Vali Acc: 0.200 Test Loss: 1.646 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.104703664779663
Epoch: 4, Steps: 4 | Train Loss: 1.521 Vali Loss: 1.632 Vali Acc: 0.220 Test Loss: 1.632 Test Acc: 0.220
Validation loss decreased (-0.219983 --> -0.219984).  Saving model ...
Epoch: 5 cost time: 0.9512548446655273
Epoch: 5, Steps: 4 | Train Loss: 1.500 Vali Loss: 1.623 Vali Acc: 0.260 Test Loss: 1.623 Test Acc: 0.260
Validation loss decreased (-0.219984 --> -0.259984).  Saving model ...
Epoch: 6 cost time: 1.0371911525726318
Epoch: 6, Steps: 4 | Train Loss: 1.351 Vali Loss: 1.607 Vali Acc: 0.240 Test Loss: 1.607 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0670857429504395
Epoch: 7, Steps: 4 | Train Loss: 1.303 Vali Loss: 1.568 Vali Acc: 0.300 Test Loss: 1.568 Test Acc: 0.300
Validation loss decreased (-0.259984 --> -0.299984).  Saving model ...
Epoch: 8 cost time: 1.0527734756469727
Epoch: 8, Steps: 4 | Train Loss: 1.204 Vali Loss: 1.537 Vali Acc: 0.320 Test Loss: 1.537 Test Acc: 0.320
Validation loss decreased (-0.299984 --> -0.319985).  Saving model ...
Epoch: 9 cost time: 1.0501370429992676
Epoch: 9, Steps: 4 | Train Loss: 1.243 Vali Loss: 1.489 Vali Acc: 0.340 Test Loss: 1.489 Test Acc: 0.340
Validation loss decreased (-0.319985 --> -0.339985).  Saving model ...
Epoch: 10 cost time: 0.9660806655883789
Epoch: 10, Steps: 4 | Train Loss: 1.049 Vali Loss: 1.425 Vali Acc: 0.420 Test Loss: 1.425 Test Acc: 0.420
Validation loss decreased (-0.339985 --> -0.419986).  Saving model ...
Epoch: 11 cost time: 0.9465367794036865
Epoch: 11, Steps: 4 | Train Loss: 0.852 Vali Loss: 1.364 Vali Acc: 0.420 Test Loss: 1.364 Test Acc: 0.420
Validation loss decreased (-0.419986 --> -0.419986).  Saving model ...
Epoch: 12 cost time: 1.0004570484161377
Epoch: 12, Steps: 4 | Train Loss: 0.748 Vali Loss: 1.310 Vali Acc: 0.380 Test Loss: 1.310 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9501588344573975
Epoch: 13, Steps: 4 | Train Loss: 0.591 Vali Loss: 1.273 Vali Acc: 0.460 Test Loss: 1.273 Test Acc: 0.460
Validation loss decreased (-0.419986 --> -0.459987).  Saving model ...
Epoch: 14 cost time: 1.0111751556396484
Epoch: 14, Steps: 4 | Train Loss: 0.474 Vali Loss: 1.260 Vali Acc: 0.440 Test Loss: 1.260 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.043555498123169
Epoch: 15, Steps: 4 | Train Loss: 0.515 Vali Loss: 1.203 Vali Acc: 0.480 Test Loss: 1.203 Test Acc: 0.480
Validation loss decreased (-0.459987 --> -0.479988).  Saving model ...
Epoch: 16 cost time: 0.9348454475402832
Epoch: 16, Steps: 4 | Train Loss: 0.356 Vali Loss: 1.191 Vali Acc: 0.520 Test Loss: 1.191 Test Acc: 0.520
Validation loss decreased (-0.479988 --> -0.519988).  Saving model ...
Epoch: 17 cost time: 1.0090672969818115
Epoch: 17, Steps: 4 | Train Loss: 0.592 Vali Loss: 1.201 Vali Acc: 0.500 Test Loss: 1.201 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8446321487426758
Epoch: 18, Steps: 4 | Train Loss: 0.536 Vali Loss: 1.171 Vali Acc: 0.560 Test Loss: 1.171 Test Acc: 0.560
Validation loss decreased (-0.519988 --> -0.559988).  Saving model ...
Epoch: 19 cost time: 0.9573390483856201
Epoch: 19, Steps: 4 | Train Loss: 0.369 Vali Loss: 1.117 Vali Acc: 0.580 Test Loss: 1.117 Test Acc: 0.580
Validation loss decreased (-0.559988 --> -0.579989).  Saving model ...
Epoch: 20 cost time: 0.9859545230865479
Epoch: 20, Steps: 4 | Train Loss: 0.253 Vali Loss: 1.187 Vali Acc: 0.520 Test Loss: 1.187 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9949390888214111
Epoch: 21, Steps: 4 | Train Loss: 0.165 Vali Loss: 1.170 Vali Acc: 0.560 Test Loss: 1.170 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.9436395168304443
Epoch: 22, Steps: 4 | Train Loss: 0.155 Vali Loss: 1.193 Vali Acc: 0.580 Test Loss: 1.193 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.9223618507385254
Epoch: 23, Steps: 4 | Train Loss: 0.142 Vali Loss: 1.201 Vali Acc: 0.580 Test Loss: 1.201 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.0760369300842285
Epoch: 24, Steps: 4 | Train Loss: 0.120 Vali Loss: 1.255 Vali Acc: 0.500 Test Loss: 1.255 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.8476383686065674
Epoch: 25, Steps: 4 | Train Loss: 0.093 Vali Loss: 1.336 Vali Acc: 0.520 Test Loss: 1.336 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.9307844638824463
Epoch: 26, Steps: 4 | Train Loss: 0.074 Vali Loss: 1.382 Vali Acc: 0.500 Test Loss: 1.382 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.8923051357269287
Epoch: 27, Steps: 4 | Train Loss: 0.062 Vali Loss: 1.496 Vali Acc: 0.500 Test Loss: 1.496 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.1791374683380127
Epoch: 28, Steps: 4 | Train Loss: 0.066 Vali Loss: 1.494 Vali Acc: 0.500 Test Loss: 1.494 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.0823092460632324
Epoch: 29, Steps: 4 | Train Loss: 0.060 Vali Loss: 1.508 Vali Acc: 0.460 Test Loss: 1.508 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm16_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 775669
model size : 3.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm16_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.537153720855713
Epoch: 1, Steps: 4 | Train Loss: 1.672 Vali Loss: 1.668 Vali Acc: 0.200 Test Loss: 1.668 Test Acc: 0.200
Validation loss decreased (inf --> -0.199983).  Saving model ...
Epoch: 2 cost time: 1.567167043685913
Epoch: 2, Steps: 4 | Train Loss: 1.652 Vali Loss: 1.656 Vali Acc: 0.220 Test Loss: 1.656 Test Acc: 0.220
Validation loss decreased (-0.199983 --> -0.219983).  Saving model ...
Epoch: 3 cost time: 1.5742170810699463
Epoch: 3, Steps: 4 | Train Loss: 1.517 Vali Loss: 1.640 Vali Acc: 0.240 Test Loss: 1.640 Test Acc: 0.240
Validation loss decreased (-0.219983 --> -0.239984).  Saving model ...
Epoch: 4 cost time: 1.5135295391082764
Epoch: 4, Steps: 4 | Train Loss: 1.413 Vali Loss: 1.618 Vali Acc: 0.320 Test Loss: 1.618 Test Acc: 0.320
Validation loss decreased (-0.239984 --> -0.319984).  Saving model ...
Epoch: 5 cost time: 1.5106778144836426
Epoch: 5, Steps: 4 | Train Loss: 1.312 Vali Loss: 1.582 Vali Acc: 0.340 Test Loss: 1.582 Test Acc: 0.340
Validation loss decreased (-0.319984 --> -0.339984).  Saving model ...
Epoch: 6 cost time: 1.616185188293457
Epoch: 6, Steps: 4 | Train Loss: 1.318 Vali Loss: 1.545 Vali Acc: 0.320 Test Loss: 1.545 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6479616165161133
Epoch: 7, Steps: 4 | Train Loss: 1.173 Vali Loss: 1.506 Vali Acc: 0.360 Test Loss: 1.506 Test Acc: 0.360
Validation loss decreased (-0.339984 --> -0.359985).  Saving model ...
Epoch: 8 cost time: 1.697969675064087
Epoch: 8, Steps: 4 | Train Loss: 1.149 Vali Loss: 1.463 Vali Acc: 0.360 Test Loss: 1.463 Test Acc: 0.360
Validation loss decreased (-0.359985 --> -0.359985).  Saving model ...
Epoch: 9 cost time: 1.859867811203003
Epoch: 9, Steps: 4 | Train Loss: 0.946 Vali Loss: 1.438 Vali Acc: 0.400 Test Loss: 1.438 Test Acc: 0.400
Validation loss decreased (-0.359985 --> -0.399986).  Saving model ...
Epoch: 10 cost time: 1.6465380191802979
Epoch: 10, Steps: 4 | Train Loss: 0.919 Vali Loss: 1.409 Vali Acc: 0.400 Test Loss: 1.409 Test Acc: 0.400
Validation loss decreased (-0.399986 --> -0.399986).  Saving model ...
Epoch: 11 cost time: 1.627176284790039
Epoch: 11, Steps: 4 | Train Loss: 0.794 Vali Loss: 1.387 Vali Acc: 0.440 Test Loss: 1.387 Test Acc: 0.440
Validation loss decreased (-0.399986 --> -0.439986).  Saving model ...
Epoch: 12 cost time: 1.885054111480713
Epoch: 12, Steps: 4 | Train Loss: 0.638 Vali Loss: 1.404 Vali Acc: 0.480 Test Loss: 1.404 Test Acc: 0.480
Validation loss decreased (-0.439986 --> -0.479986).  Saving model ...
Epoch: 13 cost time: 1.6341848373413086
Epoch: 13, Steps: 4 | Train Loss: 0.619 Vali Loss: 1.415 Vali Acc: 0.520 Test Loss: 1.415 Test Acc: 0.520
Validation loss decreased (-0.479986 --> -0.519986).  Saving model ...
Epoch: 14 cost time: 1.7326130867004395
Epoch: 14, Steps: 4 | Train Loss: 0.578 Vali Loss: 1.372 Vali Acc: 0.500 Test Loss: 1.372 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.5280654430389404
Epoch: 15, Steps: 4 | Train Loss: 0.598 Vali Loss: 1.323 Vali Acc: 0.480 Test Loss: 1.323 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.585761547088623
Epoch: 16, Steps: 4 | Train Loss: 0.394 Vali Loss: 1.352 Vali Acc: 0.460 Test Loss: 1.352 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.823699712753296
Epoch: 17, Steps: 4 | Train Loss: 0.263 Vali Loss: 1.265 Vali Acc: 0.460 Test Loss: 1.265 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.6246495246887207
Epoch: 18, Steps: 4 | Train Loss: 0.304 Vali Loss: 1.267 Vali Acc: 0.460 Test Loss: 1.267 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.8859584331512451
Epoch: 19, Steps: 4 | Train Loss: 0.371 Vali Loss: 1.344 Vali Acc: 0.440 Test Loss: 1.344 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.748589038848877
Epoch: 20, Steps: 4 | Train Loss: 0.175 Vali Loss: 1.291 Vali Acc: 0.500 Test Loss: 1.291 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.7725789546966553
Epoch: 21, Steps: 4 | Train Loss: 0.208 Vali Loss: 1.266 Vali Acc: 0.500 Test Loss: 1.266 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.6237962245941162
Epoch: 22, Steps: 4 | Train Loss: 0.148 Vali Loss: 1.298 Vali Acc: 0.460 Test Loss: 1.298 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.7702319622039795
Epoch: 23, Steps: 4 | Train Loss: 0.108 Vali Loss: 1.318 Vali Acc: 0.520 Test Loss: 1.318 Test Acc: 0.520
Validation loss decreased (-0.519986 --> -0.519987).  Saving model ...
Epoch: 24 cost time: 1.8668301105499268
Epoch: 24, Steps: 4 | Train Loss: 0.192 Vali Loss: 1.327 Vali Acc: 0.540 Test Loss: 1.327 Test Acc: 0.540
Validation loss decreased (-0.519987 --> -0.539987).  Saving model ...
Epoch: 25 cost time: 1.6497175693511963
Epoch: 25, Steps: 4 | Train Loss: 0.097 Vali Loss: 1.350 Vali Acc: 0.560 Test Loss: 1.350 Test Acc: 0.560
Validation loss decreased (-0.539987 --> -0.559987).  Saving model ...
Epoch: 26 cost time: 1.9261748790740967
Epoch: 26, Steps: 4 | Train Loss: 0.081 Vali Loss: 1.356 Vali Acc: 0.600 Test Loss: 1.356 Test Acc: 0.600
Validation loss decreased (-0.559987 --> -0.599986).  Saving model ...
Epoch: 27 cost time: 1.6980664730072021
Epoch: 27, Steps: 4 | Train Loss: 0.051 Vali Loss: 1.342 Vali Acc: 0.560 Test Loss: 1.342 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.7314276695251465
Epoch: 28, Steps: 4 | Train Loss: 0.061 Vali Loss: 1.341 Vali Acc: 0.580 Test Loss: 1.341 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.7849199771881104
Epoch: 29, Steps: 4 | Train Loss: 0.082 Vali Loss: 1.394 Vali Acc: 0.540 Test Loss: 1.394 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.7227208614349365
Epoch: 30, Steps: 4 | Train Loss: 0.058 Vali Loss: 1.425 Vali Acc: 0.540 Test Loss: 1.425 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm16_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 1258869
model size : 5.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm16_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.8486924171447754
Epoch: 1, Steps: 4 | Train Loss: 1.678 Vali Loss: 1.638 Vali Acc: 0.220 Test Loss: 1.638 Test Acc: 0.220
Validation loss decreased (inf --> -0.219984).  Saving model ...
Epoch: 2 cost time: 1.3234519958496094
Epoch: 2, Steps: 4 | Train Loss: 1.649 Vali Loss: 1.618 Vali Acc: 0.200 Test Loss: 1.618 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1429228782653809
Epoch: 3, Steps: 4 | Train Loss: 1.661 Vali Loss: 1.595 Vali Acc: 0.240 Test Loss: 1.595 Test Acc: 0.240
Validation loss decreased (-0.219984 --> -0.239984).  Saving model ...
Epoch: 4 cost time: 1.075660228729248
Epoch: 4, Steps: 4 | Train Loss: 1.495 Vali Loss: 1.574 Vali Acc: 0.260 Test Loss: 1.574 Test Acc: 0.260
Validation loss decreased (-0.239984 --> -0.259984).  Saving model ...
Epoch: 5 cost time: 1.2044472694396973
Epoch: 5, Steps: 4 | Train Loss: 1.470 Vali Loss: 1.550 Vali Acc: 0.300 Test Loss: 1.550 Test Acc: 0.300
Validation loss decreased (-0.259984 --> -0.299984).  Saving model ...
Epoch: 6 cost time: 1.2146379947662354
Epoch: 6, Steps: 4 | Train Loss: 1.380 Vali Loss: 1.524 Vali Acc: 0.280 Test Loss: 1.524 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2637042999267578
Epoch: 7, Steps: 4 | Train Loss: 1.148 Vali Loss: 1.511 Vali Acc: 0.400 Test Loss: 1.511 Test Acc: 0.400
Validation loss decreased (-0.299984 --> -0.399985).  Saving model ...
Epoch: 8 cost time: 1.2924606800079346
Epoch: 8, Steps: 4 | Train Loss: 1.064 Vali Loss: 1.497 Vali Acc: 0.380 Test Loss: 1.497 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2497608661651611
Epoch: 9, Steps: 4 | Train Loss: 1.023 Vali Loss: 1.470 Vali Acc: 0.400 Test Loss: 1.470 Test Acc: 0.400
Validation loss decreased (-0.399985 --> -0.399985).  Saving model ...
Epoch: 10 cost time: 1.0976624488830566
Epoch: 10, Steps: 4 | Train Loss: 0.859 Vali Loss: 1.456 Vali Acc: 0.400 Test Loss: 1.456 Test Acc: 0.400
Validation loss decreased (-0.399985 --> -0.399985).  Saving model ...
Epoch: 11 cost time: 1.2730767726898193
Epoch: 11, Steps: 4 | Train Loss: 0.740 Vali Loss: 1.413 Vali Acc: 0.340 Test Loss: 1.413 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1409871578216553
Epoch: 12, Steps: 4 | Train Loss: 0.782 Vali Loss: 1.370 Vali Acc: 0.400 Test Loss: 1.370 Test Acc: 0.400
Validation loss decreased (-0.399985 --> -0.399986).  Saving model ...
Epoch: 13 cost time: 1.2516393661499023
Epoch: 13, Steps: 4 | Train Loss: 0.591 Vali Loss: 1.337 Vali Acc: 0.380 Test Loss: 1.337 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.194819688796997
Epoch: 14, Steps: 4 | Train Loss: 0.699 Vali Loss: 1.317 Vali Acc: 0.460 Test Loss: 1.317 Test Acc: 0.460
Validation loss decreased (-0.399986 --> -0.459987).  Saving model ...
Epoch: 15 cost time: 1.2175531387329102
Epoch: 15, Steps: 4 | Train Loss: 0.391 Vali Loss: 1.231 Vali Acc: 0.460 Test Loss: 1.231 Test Acc: 0.460
Validation loss decreased (-0.459987 --> -0.459988).  Saving model ...
Epoch: 16 cost time: 1.152202844619751
Epoch: 16, Steps: 4 | Train Loss: 0.437 Vali Loss: 1.238 Vali Acc: 0.400 Test Loss: 1.238 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1525914669036865
Epoch: 17, Steps: 4 | Train Loss: 0.261 Vali Loss: 1.236 Vali Acc: 0.420 Test Loss: 1.236 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.2373073101043701
Epoch: 18, Steps: 4 | Train Loss: 0.223 Vali Loss: 1.247 Vali Acc: 0.460 Test Loss: 1.247 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.1828498840332031
Epoch: 19, Steps: 4 | Train Loss: 0.184 Vali Loss: 1.250 Vali Acc: 0.480 Test Loss: 1.250 Test Acc: 0.480
Validation loss decreased (-0.459988 --> -0.479988).  Saving model ...
Epoch: 20 cost time: 1.349482536315918
Epoch: 20, Steps: 4 | Train Loss: 0.161 Vali Loss: 1.323 Vali Acc: 0.460 Test Loss: 1.323 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.1814255714416504
Epoch: 21, Steps: 4 | Train Loss: 0.154 Vali Loss: 1.401 Vali Acc: 0.460 Test Loss: 1.401 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.1019165515899658
Epoch: 22, Steps: 4 | Train Loss: 0.233 Vali Loss: 1.451 Vali Acc: 0.500 Test Loss: 1.451 Test Acc: 0.500
Validation loss decreased (-0.479988 --> -0.499985).  Saving model ...
Epoch: 23 cost time: 1.0640974044799805
Epoch: 23, Steps: 4 | Train Loss: 0.132 Vali Loss: 1.405 Vali Acc: 0.540 Test Loss: 1.405 Test Acc: 0.540
Validation loss decreased (-0.499985 --> -0.539986).  Saving model ...
Epoch: 24 cost time: 1.0836060047149658
Epoch: 24, Steps: 4 | Train Loss: 0.104 Vali Loss: 1.488 Vali Acc: 0.520 Test Loss: 1.488 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0734097957611084
Epoch: 25, Steps: 4 | Train Loss: 0.281 Vali Loss: 1.487 Vali Acc: 0.500 Test Loss: 1.487 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.1591131687164307
Epoch: 26, Steps: 4 | Train Loss: 0.085 Vali Loss: 1.451 Vali Acc: 0.520 Test Loss: 1.451 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.2760889530181885
Epoch: 27, Steps: 4 | Train Loss: 0.074 Vali Loss: 1.591 Vali Acc: 0.460 Test Loss: 1.591 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.126396656036377
Epoch: 28, Steps: 4 | Train Loss: 0.216 Vali Loss: 1.765 Vali Acc: 0.440 Test Loss: 1.765 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.3237714767456055
Epoch: 29, Steps: 4 | Train Loss: 0.051 Vali Loss: 1.647 Vali Acc: 0.460 Test Loss: 1.647 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.2745018005371094
Epoch: 30, Steps: 4 | Train Loss: 0.157 Vali Loss: 1.612 Vali Acc: 0.480 Test Loss: 1.612 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm16_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 431093
model size : 1.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm16_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.0281524658203125
Epoch: 1, Steps: 4 | Train Loss: 1.672 Vali Loss: 1.669 Vali Acc: 0.200 Test Loss: 1.669 Test Acc: 0.200
Validation loss decreased (inf --> -0.199983).  Saving model ...
Epoch: 2 cost time: 1.4569778442382812
Epoch: 2, Steps: 4 | Train Loss: 1.651 Vali Loss: 1.656 Vali Acc: 0.220 Test Loss: 1.656 Test Acc: 0.220
Validation loss decreased (-0.199983 --> -0.219983).  Saving model ...
Epoch: 3 cost time: 1.521451711654663
Epoch: 3, Steps: 4 | Train Loss: 1.516 Vali Loss: 1.640 Vali Acc: 0.240 Test Loss: 1.640 Test Acc: 0.240
Validation loss decreased (-0.219983 --> -0.239984).  Saving model ...
Epoch: 4 cost time: 1.5159153938293457
Epoch: 4, Steps: 4 | Train Loss: 1.413 Vali Loss: 1.618 Vali Acc: 0.320 Test Loss: 1.618 Test Acc: 0.320
Validation loss decreased (-0.239984 --> -0.319984).  Saving model ...
Epoch: 5 cost time: 1.526702642440796
Epoch: 5, Steps: 4 | Train Loss: 1.312 Vali Loss: 1.582 Vali Acc: 0.340 Test Loss: 1.582 Test Acc: 0.340
Validation loss decreased (-0.319984 --> -0.339984).  Saving model ...
Epoch: 6 cost time: 1.603269338607788
Epoch: 6, Steps: 4 | Train Loss: 1.323 Vali Loss: 1.545 Vali Acc: 0.320 Test Loss: 1.545 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5885648727416992
Epoch: 7, Steps: 4 | Train Loss: 1.177 Vali Loss: 1.506 Vali Acc: 0.360 Test Loss: 1.506 Test Acc: 0.360
Validation loss decreased (-0.339984 --> -0.359985).  Saving model ...
Epoch: 8 cost time: 1.4798367023468018
Epoch: 8, Steps: 4 | Train Loss: 1.150 Vali Loss: 1.463 Vali Acc: 0.360 Test Loss: 1.463 Test Acc: 0.360
Validation loss decreased (-0.359985 --> -0.359985).  Saving model ...
Epoch: 9 cost time: 1.4405574798583984
Epoch: 9, Steps: 4 | Train Loss: 0.949 Vali Loss: 1.437 Vali Acc: 0.400 Test Loss: 1.437 Test Acc: 0.400
Validation loss decreased (-0.359985 --> -0.399986).  Saving model ...
Epoch: 10 cost time: 1.6237494945526123
Epoch: 10, Steps: 4 | Train Loss: 0.931 Vali Loss: 1.408 Vali Acc: 0.400 Test Loss: 1.408 Test Acc: 0.400
Validation loss decreased (-0.399986 --> -0.399986).  Saving model ...
Epoch: 11 cost time: 1.468221664428711
Epoch: 11, Steps: 4 | Train Loss: 0.796 Vali Loss: 1.385 Vali Acc: 0.460 Test Loss: 1.385 Test Acc: 0.460
Validation loss decreased (-0.399986 --> -0.459986).  Saving model ...
Epoch: 12 cost time: 1.3835852146148682
Epoch: 12, Steps: 4 | Train Loss: 0.641 Vali Loss: 1.399 Vali Acc: 0.480 Test Loss: 1.399 Test Acc: 0.480
Validation loss decreased (-0.459986 --> -0.479986).  Saving model ...
Epoch: 13 cost time: 1.5322988033294678
Epoch: 13, Steps: 4 | Train Loss: 0.619 Vali Loss: 1.411 Vali Acc: 0.520 Test Loss: 1.411 Test Acc: 0.520
Validation loss decreased (-0.479986 --> -0.519986).  Saving model ...
Epoch: 14 cost time: 1.508875846862793
Epoch: 14, Steps: 4 | Train Loss: 0.576 Vali Loss: 1.366 Vali Acc: 0.500 Test Loss: 1.366 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.6321895122528076
Epoch: 15, Steps: 4 | Train Loss: 0.597 Vali Loss: 1.328 Vali Acc: 0.460 Test Loss: 1.328 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.5444884300231934
Epoch: 16, Steps: 4 | Train Loss: 0.399 Vali Loss: 1.346 Vali Acc: 0.460 Test Loss: 1.346 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.3784897327423096
Epoch: 17, Steps: 4 | Train Loss: 0.268 Vali Loss: 1.243 Vali Acc: 0.460 Test Loss: 1.243 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.6523220539093018
Epoch: 18, Steps: 4 | Train Loss: 0.305 Vali Loss: 1.256 Vali Acc: 0.460 Test Loss: 1.256 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.3637237548828125
Epoch: 19, Steps: 4 | Train Loss: 0.392 Vali Loss: 1.353 Vali Acc: 0.440 Test Loss: 1.353 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.49591064453125
Epoch: 20, Steps: 4 | Train Loss: 0.183 Vali Loss: 1.289 Vali Acc: 0.500 Test Loss: 1.289 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.5052995681762695
Epoch: 21, Steps: 4 | Train Loss: 0.195 Vali Loss: 1.263 Vali Acc: 0.520 Test Loss: 1.263 Test Acc: 0.520
Validation loss decreased (-0.519986 --> -0.519987).  Saving model ...
Epoch: 22 cost time: 1.29030179977417
Epoch: 22, Steps: 4 | Train Loss: 0.150 Vali Loss: 1.311 Vali Acc: 0.460 Test Loss: 1.311 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.514540672302246
Epoch: 23, Steps: 4 | Train Loss: 0.110 Vali Loss: 1.323 Vali Acc: 0.500 Test Loss: 1.323 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.491598129272461
Epoch: 24, Steps: 4 | Train Loss: 0.203 Vali Loss: 1.315 Vali Acc: 0.620 Test Loss: 1.315 Test Acc: 0.620
Validation loss decreased (-0.519987 --> -0.619987).  Saving model ...
Epoch: 25 cost time: 1.5141899585723877
Epoch: 25, Steps: 4 | Train Loss: 0.084 Vali Loss: 1.362 Vali Acc: 0.620 Test Loss: 1.362 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.4706978797912598
Epoch: 26, Steps: 4 | Train Loss: 0.085 Vali Loss: 1.366 Vali Acc: 0.620 Test Loss: 1.366 Test Acc: 0.620
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.5841162204742432
Epoch: 27, Steps: 4 | Train Loss: 0.044 Vali Loss: 1.392 Vali Acc: 0.520 Test Loss: 1.392 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.3602395057678223
Epoch: 28, Steps: 4 | Train Loss: 0.051 Vali Loss: 1.355 Vali Acc: 0.560 Test Loss: 1.355 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.4831104278564453
Epoch: 29, Steps: 4 | Train Loss: 0.065 Vali Loss: 1.537 Vali Acc: 0.540 Test Loss: 1.537 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.5658609867095947
Epoch: 30, Steps: 4 | Train Loss: 0.060 Vali Loss: 1.478 Vali Acc: 0.560 Test Loss: 1.478 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm16_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.62
model parameter : 1258869
model size : 5.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm16_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.755852460861206
Epoch: 1, Steps: 4 | Train Loss: 1.677 Vali Loss: 1.636 Vali Acc: 0.220 Test Loss: 1.636 Test Acc: 0.220
Validation loss decreased (inf --> -0.219984).  Saving model ...
Epoch: 2 cost time: 1.0125017166137695
Epoch: 2, Steps: 4 | Train Loss: 1.651 Vali Loss: 1.616 Vali Acc: 0.200 Test Loss: 1.616 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0871376991271973
Epoch: 3, Steps: 4 | Train Loss: 1.658 Vali Loss: 1.592 Vali Acc: 0.240 Test Loss: 1.592 Test Acc: 0.240
Validation loss decreased (-0.219984 --> -0.239984).  Saving model ...
Epoch: 4 cost time: 1.2033848762512207
Epoch: 4, Steps: 4 | Train Loss: 1.498 Vali Loss: 1.570 Vali Acc: 0.280 Test Loss: 1.570 Test Acc: 0.280
Validation loss decreased (-0.239984 --> -0.279984).  Saving model ...
Epoch: 5 cost time: 1.10239839553833
Epoch: 5, Steps: 4 | Train Loss: 1.470 Vali Loss: 1.542 Vali Acc: 0.300 Test Loss: 1.542 Test Acc: 0.300
Validation loss decreased (-0.279984 --> -0.299985).  Saving model ...
Epoch: 6 cost time: 1.0109405517578125
Epoch: 6, Steps: 4 | Train Loss: 1.389 Vali Loss: 1.515 Vali Acc: 0.300 Test Loss: 1.515 Test Acc: 0.300
Validation loss decreased (-0.299985 --> -0.299985).  Saving model ...
Epoch: 7 cost time: 1.1124672889709473
Epoch: 7, Steps: 4 | Train Loss: 1.144 Vali Loss: 1.502 Vali Acc: 0.380 Test Loss: 1.502 Test Acc: 0.380
Validation loss decreased (-0.299985 --> -0.379985).  Saving model ...
Epoch: 8 cost time: 1.0785536766052246
Epoch: 8, Steps: 4 | Train Loss: 1.074 Vali Loss: 1.493 Vali Acc: 0.380 Test Loss: 1.493 Test Acc: 0.380
Validation loss decreased (-0.379985 --> -0.379985).  Saving model ...
Epoch: 9 cost time: 1.1528356075286865
Epoch: 9, Steps: 4 | Train Loss: 1.041 Vali Loss: 1.470 Vali Acc: 0.440 Test Loss: 1.470 Test Acc: 0.440
Validation loss decreased (-0.379985 --> -0.439985).  Saving model ...
Epoch: 10 cost time: 1.136453628540039
Epoch: 10, Steps: 4 | Train Loss: 0.874 Vali Loss: 1.459 Vali Acc: 0.420 Test Loss: 1.459 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0748341083526611
Epoch: 11, Steps: 4 | Train Loss: 0.747 Vali Loss: 1.405 Vali Acc: 0.360 Test Loss: 1.405 Test Acc: 0.360
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.2152132987976074
Epoch: 12, Steps: 4 | Train Loss: 0.809 Vali Loss: 1.326 Vali Acc: 0.460 Test Loss: 1.326 Test Acc: 0.460
Validation loss decreased (-0.439985 --> -0.459987).  Saving model ...
Epoch: 13 cost time: 1.2892169952392578
Epoch: 13, Steps: 4 | Train Loss: 0.600 Vali Loss: 1.286 Vali Acc: 0.440 Test Loss: 1.286 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0902690887451172
Epoch: 14, Steps: 4 | Train Loss: 0.720 Vali Loss: 1.265 Vali Acc: 0.480 Test Loss: 1.265 Test Acc: 0.480
Validation loss decreased (-0.459987 --> -0.479987).  Saving model ...
Epoch: 15 cost time: 1.1402153968811035
Epoch: 15, Steps: 4 | Train Loss: 0.423 Vali Loss: 1.195 Vali Acc: 0.460 Test Loss: 1.195 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1675002574920654
Epoch: 16, Steps: 4 | Train Loss: 0.450 Vali Loss: 1.188 Vali Acc: 0.460 Test Loss: 1.188 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.1214983463287354
Epoch: 17, Steps: 4 | Train Loss: 0.291 Vali Loss: 1.190 Vali Acc: 0.440 Test Loss: 1.190 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.2117226123809814
Epoch: 18, Steps: 4 | Train Loss: 0.256 Vali Loss: 1.197 Vali Acc: 0.500 Test Loss: 1.197 Test Acc: 0.500
Validation loss decreased (-0.479987 --> -0.499988).  Saving model ...
Epoch: 19 cost time: 1.1518709659576416
Epoch: 19, Steps: 4 | Train Loss: 0.198 Vali Loss: 1.187 Vali Acc: 0.500 Test Loss: 1.187 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 20 cost time: 1.118412733078003
Epoch: 20, Steps: 4 | Train Loss: 0.170 Vali Loss: 1.226 Vali Acc: 0.500 Test Loss: 1.226 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.1472322940826416
Epoch: 21, Steps: 4 | Train Loss: 0.158 Vali Loss: 1.287 Vali Acc: 0.460 Test Loss: 1.287 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.0851919651031494
Epoch: 22, Steps: 4 | Train Loss: 0.244 Vali Loss: 1.350 Vali Acc: 0.480 Test Loss: 1.350 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.1212449073791504
Epoch: 23, Steps: 4 | Train Loss: 0.140 Vali Loss: 1.317 Vali Acc: 0.480 Test Loss: 1.317 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.180107593536377
Epoch: 24, Steps: 4 | Train Loss: 0.094 Vali Loss: 1.381 Vali Acc: 0.500 Test Loss: 1.381 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.0443840026855469
Epoch: 25, Steps: 4 | Train Loss: 0.187 Vali Loss: 1.388 Vali Acc: 0.520 Test Loss: 1.388 Test Acc: 0.520
Validation loss decreased (-0.499988 --> -0.519986).  Saving model ...
Epoch: 26 cost time: 1.0010690689086914
Epoch: 26, Steps: 4 | Train Loss: 0.111 Vali Loss: 1.384 Vali Acc: 0.500 Test Loss: 1.384 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.0109410285949707
Epoch: 27, Steps: 4 | Train Loss: 0.061 Vali Loss: 1.604 Vali Acc: 0.480 Test Loss: 1.604 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.9497613906860352
Epoch: 28, Steps: 4 | Train Loss: 0.198 Vali Loss: 1.714 Vali Acc: 0.480 Test Loss: 1.714 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.1707689762115479
Epoch: 29, Steps: 4 | Train Loss: 0.044 Vali Loss: 1.483 Vali Acc: 0.480 Test Loss: 1.483 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.054347276687622
Epoch: 30, Steps: 4 | Train Loss: 0.067 Vali Loss: 1.576 Vali Acc: 0.500 Test Loss: 1.576 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm16_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 431093
model size : 1.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm16_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.6536197662353516
Epoch: 1, Steps: 4 | Train Loss: 1.673 Vali Loss: 1.667 Vali Acc: 0.220 Test Loss: 1.667 Test Acc: 0.220
Validation loss decreased (inf --> -0.219983).  Saving model ...
Epoch: 2 cost time: 1.2309386730194092
Epoch: 2, Steps: 4 | Train Loss: 1.652 Vali Loss: 1.655 Vali Acc: 0.220 Test Loss: 1.655 Test Acc: 0.220
Validation loss decreased (-0.219983 --> -0.219983).  Saving model ...
Epoch: 3 cost time: 1.2374658584594727
Epoch: 3, Steps: 4 | Train Loss: 1.510 Vali Loss: 1.639 Vali Acc: 0.240 Test Loss: 1.639 Test Acc: 0.240
Validation loss decreased (-0.219983 --> -0.239984).  Saving model ...
Epoch: 4 cost time: 1.0857112407684326
Epoch: 4, Steps: 4 | Train Loss: 1.420 Vali Loss: 1.617 Vali Acc: 0.320 Test Loss: 1.617 Test Acc: 0.320
Validation loss decreased (-0.239984 --> -0.319984).  Saving model ...
Epoch: 5 cost time: 1.2760837078094482
Epoch: 5, Steps: 4 | Train Loss: 1.319 Vali Loss: 1.582 Vali Acc: 0.340 Test Loss: 1.582 Test Acc: 0.340
Validation loss decreased (-0.319984 --> -0.339984).  Saving model ...
Epoch: 6 cost time: 1.1747164726257324
Epoch: 6, Steps: 4 | Train Loss: 1.331 Vali Loss: 1.545 Vali Acc: 0.320 Test Loss: 1.545 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1780731678009033
Epoch: 7, Steps: 4 | Train Loss: 1.191 Vali Loss: 1.508 Vali Acc: 0.360 Test Loss: 1.508 Test Acc: 0.360
Validation loss decreased (-0.339984 --> -0.359985).  Saving model ...
Epoch: 8 cost time: 1.0487964153289795
Epoch: 8, Steps: 4 | Train Loss: 1.162 Vali Loss: 1.467 Vali Acc: 0.360 Test Loss: 1.467 Test Acc: 0.360
Validation loss decreased (-0.359985 --> -0.359985).  Saving model ...
Epoch: 9 cost time: 1.1577863693237305
Epoch: 9, Steps: 4 | Train Loss: 1.020 Vali Loss: 1.443 Vali Acc: 0.380 Test Loss: 1.443 Test Acc: 0.380
Validation loss decreased (-0.359985 --> -0.379986).  Saving model ...
Epoch: 10 cost time: 1.3374764919281006
Epoch: 10, Steps: 4 | Train Loss: 0.951 Vali Loss: 1.415 Vali Acc: 0.320 Test Loss: 1.415 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0502071380615234
Epoch: 11, Steps: 4 | Train Loss: 0.810 Vali Loss: 1.386 Vali Acc: 0.400 Test Loss: 1.386 Test Acc: 0.400
Validation loss decreased (-0.379986 --> -0.399986).  Saving model ...
Epoch: 12 cost time: 1.2159218788146973
Epoch: 12, Steps: 4 | Train Loss: 0.664 Vali Loss: 1.402 Vali Acc: 0.420 Test Loss: 1.402 Test Acc: 0.420
Validation loss decreased (-0.399986 --> -0.419986).  Saving model ...
Epoch: 13 cost time: 1.111093521118164
Epoch: 13, Steps: 4 | Train Loss: 0.644 Vali Loss: 1.409 Vali Acc: 0.480 Test Loss: 1.409 Test Acc: 0.480
Validation loss decreased (-0.419986 --> -0.479986).  Saving model ...
Epoch: 14 cost time: 1.1506741046905518
Epoch: 14, Steps: 4 | Train Loss: 0.591 Vali Loss: 1.363 Vali Acc: 0.500 Test Loss: 1.363 Test Acc: 0.500
Validation loss decreased (-0.479986 --> -0.499986).  Saving model ...
Epoch: 15 cost time: 1.2418360710144043
Epoch: 15, Steps: 4 | Train Loss: 0.596 Vali Loss: 1.313 Vali Acc: 0.480 Test Loss: 1.313 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0908775329589844
Epoch: 16, Steps: 4 | Train Loss: 0.431 Vali Loss: 1.337 Vali Acc: 0.440 Test Loss: 1.337 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.2137188911437988
Epoch: 17, Steps: 4 | Train Loss: 0.279 Vali Loss: 1.199 Vali Acc: 0.460 Test Loss: 1.199 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.0420970916748047
Epoch: 18, Steps: 4 | Train Loss: 0.326 Vali Loss: 1.189 Vali Acc: 0.500 Test Loss: 1.189 Test Acc: 0.500
Validation loss decreased (-0.499986 --> -0.499988).  Saving model ...
Epoch: 19 cost time: 1.2888989448547363
Epoch: 19, Steps: 4 | Train Loss: 0.412 Vali Loss: 1.282 Vali Acc: 0.540 Test Loss: 1.282 Test Acc: 0.540
Validation loss decreased (-0.499988 --> -0.539987).  Saving model ...
Epoch: 20 cost time: 1.1161627769470215
Epoch: 20, Steps: 4 | Train Loss: 0.207 Vali Loss: 1.206 Vali Acc: 0.540 Test Loss: 1.206 Test Acc: 0.540
Validation loss decreased (-0.539987 --> -0.539988).  Saving model ...
Epoch: 21 cost time: 1.2203528881072998
Epoch: 21, Steps: 4 | Train Loss: 0.186 Vali Loss: 1.150 Vali Acc: 0.520 Test Loss: 1.150 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2662687301635742
Epoch: 22, Steps: 4 | Train Loss: 0.162 Vali Loss: 1.168 Vali Acc: 0.560 Test Loss: 1.168 Test Acc: 0.560
Validation loss decreased (-0.539988 --> -0.559988).  Saving model ...
Epoch: 23 cost time: 1.0865294933319092
Epoch: 23, Steps: 4 | Train Loss: 0.126 Vali Loss: 1.169 Vali Acc: 0.540 Test Loss: 1.169 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.2828540802001953
Epoch: 24, Steps: 4 | Train Loss: 0.221 Vali Loss: 1.188 Vali Acc: 0.580 Test Loss: 1.188 Test Acc: 0.580
Validation loss decreased (-0.559988 --> -0.579988).  Saving model ...
Epoch: 25 cost time: 1.1743955612182617
Epoch: 25, Steps: 4 | Train Loss: 0.117 Vali Loss: 1.198 Vali Acc: 0.540 Test Loss: 1.198 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.1389925479888916
Epoch: 26, Steps: 4 | Train Loss: 0.130 Vali Loss: 1.273 Vali Acc: 0.500 Test Loss: 1.273 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.0890469551086426
Epoch: 27, Steps: 4 | Train Loss: 0.077 Vali Loss: 1.274 Vali Acc: 0.520 Test Loss: 1.274 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.1624565124511719
Epoch: 28, Steps: 4 | Train Loss: 0.099 Vali Loss: 1.120 Vali Acc: 0.580 Test Loss: 1.120 Test Acc: 0.580
Validation loss decreased (-0.579988 --> -0.579989).  Saving model ...
Epoch: 29 cost time: 1.2531700134277344
Epoch: 29, Steps: 4 | Train Loss: 0.151 Vali Loss: 1.147 Vali Acc: 0.580 Test Loss: 1.147 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.1005165576934814
Epoch: 30, Steps: 4 | Train Loss: 0.061 Vali Loss: 1.242 Vali Acc: 0.620 Test Loss: 1.242 Test Acc: 0.620
Validation loss decreased (-0.579989 --> -0.619988).  Saving model ...
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm16_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.62
model parameter : 1258869
model size : 5.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm16_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.449087142944336
Epoch: 1, Steps: 4 | Train Loss: 1.715 Vali Loss: 1.622 Vali Acc: 0.200 Test Loss: 1.622 Test Acc: 0.200
Validation loss decreased (inf --> -0.199984).  Saving model ...
Epoch: 2 cost time: 0.8528683185577393
Epoch: 2, Steps: 4 | Train Loss: 1.654 Vali Loss: 1.601 Vali Acc: 0.220 Test Loss: 1.601 Test Acc: 0.220
Validation loss decreased (-0.199984 --> -0.219984).  Saving model ...
Epoch: 3 cost time: 0.9433498382568359
Epoch: 3, Steps: 4 | Train Loss: 1.672 Vali Loss: 1.576 Vali Acc: 0.240 Test Loss: 1.576 Test Acc: 0.240
Validation loss decreased (-0.219984 --> -0.239984).  Saving model ...
Epoch: 4 cost time: 0.9553928375244141
Epoch: 4, Steps: 4 | Train Loss: 1.509 Vali Loss: 1.553 Vali Acc: 0.280 Test Loss: 1.553 Test Acc: 0.280
Validation loss decreased (-0.239984 --> -0.279984).  Saving model ...
Epoch: 5 cost time: 1.0113356113433838
Epoch: 5, Steps: 4 | Train Loss: 1.478 Vali Loss: 1.527 Vali Acc: 0.280 Test Loss: 1.527 Test Acc: 0.280
Validation loss decreased (-0.279984 --> -0.279985).  Saving model ...
Epoch: 6 cost time: 0.9447894096374512
Epoch: 6, Steps: 4 | Train Loss: 1.371 Vali Loss: 1.500 Vali Acc: 0.300 Test Loss: 1.500 Test Acc: 0.300
Validation loss decreased (-0.279985 --> -0.299985).  Saving model ...
Epoch: 7 cost time: 0.852297306060791
Epoch: 7, Steps: 4 | Train Loss: 1.177 Vali Loss: 1.483 Vali Acc: 0.380 Test Loss: 1.483 Test Acc: 0.380
Validation loss decreased (-0.299985 --> -0.379985).  Saving model ...
Epoch: 8 cost time: 0.8644752502441406
Epoch: 8, Steps: 4 | Train Loss: 1.076 Vali Loss: 1.471 Vali Acc: 0.360 Test Loss: 1.471 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8717138767242432
Epoch: 9, Steps: 4 | Train Loss: 1.042 Vali Loss: 1.447 Vali Acc: 0.380 Test Loss: 1.447 Test Acc: 0.380
Validation loss decreased (-0.379985 --> -0.379986).  Saving model ...
Epoch: 10 cost time: 0.8750603199005127
Epoch: 10, Steps: 4 | Train Loss: 0.893 Vali Loss: 1.428 Vali Acc: 0.380 Test Loss: 1.428 Test Acc: 0.380
Validation loss decreased (-0.379986 --> -0.379986).  Saving model ...
Epoch: 11 cost time: 0.8525819778442383
Epoch: 11, Steps: 4 | Train Loss: 0.771 Vali Loss: 1.366 Vali Acc: 0.400 Test Loss: 1.366 Test Acc: 0.400
Validation loss decreased (-0.379986 --> -0.399986).  Saving model ...
Epoch: 12 cost time: 0.8205764293670654
Epoch: 12, Steps: 4 | Train Loss: 0.833 Vali Loss: 1.295 Vali Acc: 0.460 Test Loss: 1.295 Test Acc: 0.460
Validation loss decreased (-0.399986 --> -0.459987).  Saving model ...
Epoch: 13 cost time: 0.8884902000427246
Epoch: 13, Steps: 4 | Train Loss: 0.606 Vali Loss: 1.266 Vali Acc: 0.440 Test Loss: 1.266 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.010880470275879
Epoch: 14, Steps: 4 | Train Loss: 0.751 Vali Loss: 1.258 Vali Acc: 0.440 Test Loss: 1.258 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8888685703277588
Epoch: 15, Steps: 4 | Train Loss: 0.439 Vali Loss: 1.183 Vali Acc: 0.500 Test Loss: 1.183 Test Acc: 0.500
Validation loss decreased (-0.459987 --> -0.499988).  Saving model ...
Epoch: 16 cost time: 1.0411040782928467
Epoch: 16, Steps: 4 | Train Loss: 0.473 Vali Loss: 1.184 Vali Acc: 0.500 Test Loss: 1.184 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9899325370788574
Epoch: 17, Steps: 4 | Train Loss: 0.329 Vali Loss: 1.197 Vali Acc: 0.460 Test Loss: 1.197 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.962813138961792
Epoch: 18, Steps: 4 | Train Loss: 0.290 Vali Loss: 1.215 Vali Acc: 0.480 Test Loss: 1.215 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.0525269508361816
Epoch: 19, Steps: 4 | Train Loss: 0.241 Vali Loss: 1.170 Vali Acc: 0.500 Test Loss: 1.170 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 20 cost time: 0.935734748840332
Epoch: 20, Steps: 4 | Train Loss: 0.241 Vali Loss: 1.170 Vali Acc: 0.520 Test Loss: 1.170 Test Acc: 0.520
Validation loss decreased (-0.499988 --> -0.519988).  Saving model ...
Epoch: 21 cost time: 0.9685132503509521
Epoch: 21, Steps: 4 | Train Loss: 0.191 Vali Loss: 1.206 Vali Acc: 0.480 Test Loss: 1.206 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.03267240524292
Epoch: 22, Steps: 4 | Train Loss: 0.313 Vali Loss: 1.224 Vali Acc: 0.460 Test Loss: 1.224 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.1065104007720947
Epoch: 23, Steps: 4 | Train Loss: 0.178 Vali Loss: 1.254 Vali Acc: 0.500 Test Loss: 1.254 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.2042996883392334
Epoch: 24, Steps: 4 | Train Loss: 0.137 Vali Loss: 1.313 Vali Acc: 0.460 Test Loss: 1.313 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.259890079498291
Epoch: 25, Steps: 4 | Train Loss: 0.211 Vali Loss: 1.333 Vali Acc: 0.500 Test Loss: 1.333 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.082181453704834
Epoch: 26, Steps: 4 | Train Loss: 0.107 Vali Loss: 1.424 Vali Acc: 0.480 Test Loss: 1.424 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.1811671257019043
Epoch: 27, Steps: 4 | Train Loss: 0.220 Vali Loss: 1.390 Vali Acc: 0.520 Test Loss: 1.390 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.1593799591064453
Epoch: 28, Steps: 4 | Train Loss: 0.478 Vali Loss: 1.634 Vali Acc: 0.480 Test Loss: 1.634 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.196589708328247
Epoch: 29, Steps: 4 | Train Loss: 0.136 Vali Loss: 1.470 Vali Acc: 0.500 Test Loss: 1.470 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.2413387298583984
Epoch: 30, Steps: 4 | Train Loss: 0.106 Vali Loss: 1.481 Vali Acc: 0.480 Test Loss: 1.481 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm16_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 431093
model size : 1.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm16_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.2317044734954834
Epoch: 1, Steps: 4 | Train Loss: 1.688 Vali Loss: 1.660 Vali Acc: 0.180 Test Loss: 1.660 Test Acc: 0.180
Validation loss decreased (inf --> -0.179983).  Saving model ...
Epoch: 2 cost time: 1.6857342720031738
Epoch: 2, Steps: 4 | Train Loss: 1.627 Vali Loss: 1.638 Vali Acc: 0.180 Test Loss: 1.638 Test Acc: 0.180
Validation loss decreased (-0.179983 --> -0.179984).  Saving model ...
Epoch: 3 cost time: 1.6810212135314941
Epoch: 3, Steps: 4 | Train Loss: 1.626 Vali Loss: 1.615 Vali Acc: 0.180 Test Loss: 1.615 Test Acc: 0.180
Validation loss decreased (-0.179984 --> -0.179984).  Saving model ...
Epoch: 4 cost time: 1.5965685844421387
Epoch: 4, Steps: 4 | Train Loss: 1.482 Vali Loss: 1.601 Vali Acc: 0.260 Test Loss: 1.601 Test Acc: 0.260
Validation loss decreased (-0.179984 --> -0.259984).  Saving model ...
Epoch: 5 cost time: 1.7643799781799316
Epoch: 5, Steps: 4 | Train Loss: 1.407 Vali Loss: 1.588 Vali Acc: 0.280 Test Loss: 1.588 Test Acc: 0.280
Validation loss decreased (-0.259984 --> -0.279984).  Saving model ...
Epoch: 6 cost time: 1.5633823871612549
Epoch: 6, Steps: 4 | Train Loss: 1.259 Vali Loss: 1.575 Vali Acc: 0.320 Test Loss: 1.575 Test Acc: 0.320
Validation loss decreased (-0.279984 --> -0.319984).  Saving model ...
Epoch: 7 cost time: 1.5575861930847168
Epoch: 7, Steps: 4 | Train Loss: 1.273 Vali Loss: 1.554 Vali Acc: 0.360 Test Loss: 1.554 Test Acc: 0.360
Validation loss decreased (-0.319984 --> -0.359984).  Saving model ...
Epoch: 8 cost time: 1.813335657119751
Epoch: 8, Steps: 4 | Train Loss: 1.136 Vali Loss: 1.506 Vali Acc: 0.400 Test Loss: 1.506 Test Acc: 0.400
Validation loss decreased (-0.359984 --> -0.399985).  Saving model ...
Epoch: 9 cost time: 1.6157724857330322
Epoch: 9, Steps: 4 | Train Loss: 1.082 Vali Loss: 1.461 Vali Acc: 0.440 Test Loss: 1.461 Test Acc: 0.440
Validation loss decreased (-0.399985 --> -0.439985).  Saving model ...
Epoch: 10 cost time: 1.6174383163452148
Epoch: 10, Steps: 4 | Train Loss: 0.968 Vali Loss: 1.437 Vali Acc: 0.440 Test Loss: 1.437 Test Acc: 0.440
Validation loss decreased (-0.439985 --> -0.439986).  Saving model ...
Epoch: 11 cost time: 1.7608709335327148
Epoch: 11, Steps: 4 | Train Loss: 0.859 Vali Loss: 1.419 Vali Acc: 0.460 Test Loss: 1.419 Test Acc: 0.460
Validation loss decreased (-0.439986 --> -0.459986).  Saving model ...
Epoch: 12 cost time: 1.5197131633758545
Epoch: 12, Steps: 4 | Train Loss: 0.744 Vali Loss: 1.368 Vali Acc: 0.440 Test Loss: 1.368 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.615140676498413
Epoch: 13, Steps: 4 | Train Loss: 0.721 Vali Loss: 1.314 Vali Acc: 0.480 Test Loss: 1.314 Test Acc: 0.480
Validation loss decreased (-0.459986 --> -0.479987).  Saving model ...
Epoch: 14 cost time: 1.5401840209960938
Epoch: 14, Steps: 4 | Train Loss: 0.547 Vali Loss: 1.282 Vali Acc: 0.540 Test Loss: 1.282 Test Acc: 0.540
Validation loss decreased (-0.479987 --> -0.539987).  Saving model ...
Epoch: 15 cost time: 1.5233962535858154
Epoch: 15, Steps: 4 | Train Loss: 0.560 Vali Loss: 1.266 Vali Acc: 0.500 Test Loss: 1.266 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.4889600276947021
Epoch: 16, Steps: 4 | Train Loss: 0.495 Vali Loss: 1.207 Vali Acc: 0.520 Test Loss: 1.207 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.2834227085113525
Epoch: 17, Steps: 4 | Train Loss: 0.350 Vali Loss: 1.178 Vali Acc: 0.540 Test Loss: 1.178 Test Acc: 0.540
Validation loss decreased (-0.539987 --> -0.539988).  Saving model ...
Epoch: 18 cost time: 1.6285650730133057
Epoch: 18, Steps: 4 | Train Loss: 0.382 Vali Loss: 1.189 Vali Acc: 0.540 Test Loss: 1.189 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.6490051746368408
Epoch: 19, Steps: 4 | Train Loss: 0.271 Vali Loss: 1.211 Vali Acc: 0.520 Test Loss: 1.211 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.6862409114837646
Epoch: 20, Steps: 4 | Train Loss: 0.238 Vali Loss: 1.252 Vali Acc: 0.500 Test Loss: 1.252 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.827820062637329
Epoch: 21, Steps: 4 | Train Loss: 0.207 Vali Loss: 1.224 Vali Acc: 0.540 Test Loss: 1.224 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.7704713344573975
Epoch: 22, Steps: 4 | Train Loss: 0.175 Vali Loss: 1.211 Vali Acc: 0.520 Test Loss: 1.211 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.788787841796875
Epoch: 23, Steps: 4 | Train Loss: 0.203 Vali Loss: 1.286 Vali Acc: 0.540 Test Loss: 1.286 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.8096654415130615
Epoch: 24, Steps: 4 | Train Loss: 0.132 Vali Loss: 1.406 Vali Acc: 0.520 Test Loss: 1.406 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.7263588905334473
Epoch: 25, Steps: 4 | Train Loss: 0.157 Vali Loss: 1.287 Vali Acc: 0.540 Test Loss: 1.287 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.6389527320861816
Epoch: 26, Steps: 4 | Train Loss: 0.107 Vali Loss: 1.273 Vali Acc: 0.500 Test Loss: 1.273 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.681464672088623
Epoch: 27, Steps: 4 | Train Loss: 0.105 Vali Loss: 1.263 Vali Acc: 0.540 Test Loss: 1.263 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm16_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 672757
model size : 2.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm16_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.752265453338623
Epoch: 1, Steps: 4 | Train Loss: 1.642 Vali Loss: 1.602 Vali Acc: 0.140 Test Loss: 1.602 Test Acc: 0.140
Validation loss decreased (inf --> -0.139984).  Saving model ...
Epoch: 2 cost time: 1.100409746170044
Epoch: 2, Steps: 4 | Train Loss: 1.578 Vali Loss: 1.587 Vali Acc: 0.200 Test Loss: 1.587 Test Acc: 0.200
Validation loss decreased (-0.139984 --> -0.199984).  Saving model ...
Epoch: 3 cost time: 1.1617240905761719
Epoch: 3, Steps: 4 | Train Loss: 1.467 Vali Loss: 1.568 Vali Acc: 0.240 Test Loss: 1.568 Test Acc: 0.240
Validation loss decreased (-0.199984 --> -0.239984).  Saving model ...
Epoch: 4 cost time: 1.145188808441162
Epoch: 4, Steps: 4 | Train Loss: 1.453 Vali Loss: 1.548 Vali Acc: 0.260 Test Loss: 1.548 Test Acc: 0.260
Validation loss decreased (-0.239984 --> -0.259985).  Saving model ...
Epoch: 5 cost time: 1.0617702007293701
Epoch: 5, Steps: 4 | Train Loss: 1.243 Vali Loss: 1.531 Vali Acc: 0.300 Test Loss: 1.531 Test Acc: 0.300
Validation loss decreased (-0.259985 --> -0.299985).  Saving model ...
Epoch: 6 cost time: 1.0612027645111084
Epoch: 6, Steps: 4 | Train Loss: 1.289 Vali Loss: 1.515 Vali Acc: 0.280 Test Loss: 1.515 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1400301456451416
Epoch: 7, Steps: 4 | Train Loss: 1.237 Vali Loss: 1.497 Vali Acc: 0.280 Test Loss: 1.497 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.0735070705413818
Epoch: 8, Steps: 4 | Train Loss: 1.094 Vali Loss: 1.473 Vali Acc: 0.400 Test Loss: 1.473 Test Acc: 0.400
Validation loss decreased (-0.299985 --> -0.399985).  Saving model ...
Epoch: 9 cost time: 1.0963292121887207
Epoch: 9, Steps: 4 | Train Loss: 0.984 Vali Loss: 1.435 Vali Acc: 0.420 Test Loss: 1.435 Test Acc: 0.420
Validation loss decreased (-0.399985 --> -0.419986).  Saving model ...
Epoch: 10 cost time: 1.0280728340148926
Epoch: 10, Steps: 4 | Train Loss: 0.858 Vali Loss: 1.399 Vali Acc: 0.440 Test Loss: 1.399 Test Acc: 0.440
Validation loss decreased (-0.419986 --> -0.439986).  Saving model ...
Epoch: 11 cost time: 1.0555837154388428
Epoch: 11, Steps: 4 | Train Loss: 0.888 Vali Loss: 1.357 Vali Acc: 0.460 Test Loss: 1.357 Test Acc: 0.460
Validation loss decreased (-0.439986 --> -0.459986).  Saving model ...
Epoch: 12 cost time: 1.1553874015808105
Epoch: 12, Steps: 4 | Train Loss: 0.674 Vali Loss: 1.289 Vali Acc: 0.480 Test Loss: 1.289 Test Acc: 0.480
Validation loss decreased (-0.459986 --> -0.479987).  Saving model ...
Epoch: 13 cost time: 1.2157721519470215
Epoch: 13, Steps: 4 | Train Loss: 0.568 Vali Loss: 1.273 Vali Acc: 0.500 Test Loss: 1.273 Test Acc: 0.500
Validation loss decreased (-0.479987 --> -0.499987).  Saving model ...
Epoch: 14 cost time: 1.128600835800171
Epoch: 14, Steps: 4 | Train Loss: 0.516 Vali Loss: 1.258 Vali Acc: 0.520 Test Loss: 1.258 Test Acc: 0.520
Validation loss decreased (-0.499987 --> -0.519987).  Saving model ...
Epoch: 15 cost time: 1.2354755401611328
Epoch: 15, Steps: 4 | Train Loss: 0.468 Vali Loss: 1.205 Vali Acc: 0.540 Test Loss: 1.205 Test Acc: 0.540
Validation loss decreased (-0.519987 --> -0.539988).  Saving model ...
Epoch: 16 cost time: 1.1410901546478271
Epoch: 16, Steps: 4 | Train Loss: 0.605 Vali Loss: 1.208 Vali Acc: 0.520 Test Loss: 1.208 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1879515647888184
Epoch: 17, Steps: 4 | Train Loss: 0.410 Vali Loss: 1.167 Vali Acc: 0.500 Test Loss: 1.167 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.284578561782837
Epoch: 18, Steps: 4 | Train Loss: 0.246 Vali Loss: 1.140 Vali Acc: 0.520 Test Loss: 1.140 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.2592551708221436
Epoch: 19, Steps: 4 | Train Loss: 0.224 Vali Loss: 1.152 Vali Acc: 0.580 Test Loss: 1.152 Test Acc: 0.580
Validation loss decreased (-0.539988 --> -0.579988).  Saving model ...
Epoch: 20 cost time: 1.3124167919158936
Epoch: 20, Steps: 4 | Train Loss: 0.202 Vali Loss: 1.179 Vali Acc: 0.580 Test Loss: 1.179 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.1905100345611572
Epoch: 21, Steps: 4 | Train Loss: 0.161 Vali Loss: 1.149 Vali Acc: 0.560 Test Loss: 1.149 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.1574122905731201
Epoch: 22, Steps: 4 | Train Loss: 0.145 Vali Loss: 1.131 Vali Acc: 0.560 Test Loss: 1.131 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.2593514919281006
Epoch: 23, Steps: 4 | Train Loss: 0.125 Vali Loss: 1.146 Vali Acc: 0.560 Test Loss: 1.146 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.2640790939331055
Epoch: 24, Steps: 4 | Train Loss: 0.116 Vali Loss: 1.122 Vali Acc: 0.500 Test Loss: 1.122 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.2730841636657715
Epoch: 25, Steps: 4 | Train Loss: 0.119 Vali Loss: 1.114 Vali Acc: 0.540 Test Loss: 1.114 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.2174508571624756
Epoch: 26, Steps: 4 | Train Loss: 0.083 Vali Loss: 1.150 Vali Acc: 0.560 Test Loss: 1.150 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.406135082244873
Epoch: 27, Steps: 4 | Train Loss: 0.067 Vali Loss: 1.146 Vali Acc: 0.520 Test Loss: 1.146 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.2666761875152588
Epoch: 28, Steps: 4 | Train Loss: 0.064 Vali Loss: 1.143 Vali Acc: 0.520 Test Loss: 1.143 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.2734501361846924
Epoch: 29, Steps: 4 | Train Loss: 0.094 Vali Loss: 1.151 Vali Acc: 0.580 Test Loss: 1.151 Test Acc: 0.580
Validation loss decreased (-0.579988 --> -0.579988).  Saving model ...
Epoch: 30 cost time: 1.2468419075012207
Epoch: 30, Steps: 4 | Train Loss: 0.046 Vali Loss: 1.217 Vali Acc: 0.560 Test Loss: 1.217 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm16_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 258805
model size : 1.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm16_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.848259210586548
Epoch: 1, Steps: 4 | Train Loss: 1.698 Vali Loss: 1.660 Vali Acc: 0.180 Test Loss: 1.660 Test Acc: 0.180
Validation loss decreased (inf --> -0.179983).  Saving model ...
Epoch: 2 cost time: 1.343214511871338
Epoch: 2, Steps: 4 | Train Loss: 1.627 Vali Loss: 1.638 Vali Acc: 0.180 Test Loss: 1.638 Test Acc: 0.180
Validation loss decreased (-0.179983 --> -0.179984).  Saving model ...
Epoch: 3 cost time: 1.4343328475952148
Epoch: 3, Steps: 4 | Train Loss: 1.626 Vali Loss: 1.615 Vali Acc: 0.180 Test Loss: 1.615 Test Acc: 0.180
Validation loss decreased (-0.179984 --> -0.179984).  Saving model ...
Epoch: 4 cost time: 1.529616117477417
Epoch: 4, Steps: 4 | Train Loss: 1.484 Vali Loss: 1.601 Vali Acc: 0.260 Test Loss: 1.601 Test Acc: 0.260
Validation loss decreased (-0.179984 --> -0.259984).  Saving model ...
Epoch: 5 cost time: 1.3087012767791748
Epoch: 5, Steps: 4 | Train Loss: 1.410 Vali Loss: 1.586 Vali Acc: 0.280 Test Loss: 1.586 Test Acc: 0.280
Validation loss decreased (-0.259984 --> -0.279984).  Saving model ...
Epoch: 6 cost time: 1.4961144924163818
Epoch: 6, Steps: 4 | Train Loss: 1.260 Vali Loss: 1.573 Vali Acc: 0.320 Test Loss: 1.573 Test Acc: 0.320
Validation loss decreased (-0.279984 --> -0.319984).  Saving model ...
Epoch: 7 cost time: 1.4448487758636475
Epoch: 7, Steps: 4 | Train Loss: 1.273 Vali Loss: 1.552 Vali Acc: 0.360 Test Loss: 1.552 Test Acc: 0.360
Validation loss decreased (-0.319984 --> -0.359984).  Saving model ...
Epoch: 8 cost time: 1.5532691478729248
Epoch: 8, Steps: 4 | Train Loss: 1.141 Vali Loss: 1.506 Vali Acc: 0.400 Test Loss: 1.506 Test Acc: 0.400
Validation loss decreased (-0.359984 --> -0.399985).  Saving model ...
Epoch: 9 cost time: 1.3733515739440918
Epoch: 9, Steps: 4 | Train Loss: 1.086 Vali Loss: 1.461 Vali Acc: 0.440 Test Loss: 1.461 Test Acc: 0.440
Validation loss decreased (-0.399985 --> -0.439985).  Saving model ...
Epoch: 10 cost time: 1.4734437465667725
Epoch: 10, Steps: 4 | Train Loss: 0.971 Vali Loss: 1.438 Vali Acc: 0.440 Test Loss: 1.438 Test Acc: 0.440
Validation loss decreased (-0.439985 --> -0.439986).  Saving model ...
Epoch: 11 cost time: 1.4975173473358154
Epoch: 11, Steps: 4 | Train Loss: 0.862 Vali Loss: 1.419 Vali Acc: 0.440 Test Loss: 1.419 Test Acc: 0.440
Validation loss decreased (-0.439986 --> -0.439986).  Saving model ...
Epoch: 12 cost time: 1.4319591522216797
Epoch: 12, Steps: 4 | Train Loss: 0.745 Vali Loss: 1.368 Vali Acc: 0.460 Test Loss: 1.368 Test Acc: 0.460
Validation loss decreased (-0.439986 --> -0.459986).  Saving model ...
Epoch: 13 cost time: 1.603006362915039
Epoch: 13, Steps: 4 | Train Loss: 0.725 Vali Loss: 1.310 Vali Acc: 0.480 Test Loss: 1.310 Test Acc: 0.480
Validation loss decreased (-0.459986 --> -0.479987).  Saving model ...
Epoch: 14 cost time: 1.6829757690429688
Epoch: 14, Steps: 4 | Train Loss: 0.550 Vali Loss: 1.280 Vali Acc: 0.560 Test Loss: 1.280 Test Acc: 0.560
Validation loss decreased (-0.479987 --> -0.559987).  Saving model ...
Epoch: 15 cost time: 1.6245701313018799
Epoch: 15, Steps: 4 | Train Loss: 0.559 Vali Loss: 1.265 Vali Acc: 0.520 Test Loss: 1.265 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.5411365032196045
Epoch: 16, Steps: 4 | Train Loss: 0.492 Vali Loss: 1.206 Vali Acc: 0.540 Test Loss: 1.206 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.6582393646240234
Epoch: 17, Steps: 4 | Train Loss: 0.351 Vali Loss: 1.180 Vali Acc: 0.540 Test Loss: 1.180 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.422365665435791
Epoch: 18, Steps: 4 | Train Loss: 0.374 Vali Loss: 1.189 Vali Acc: 0.560 Test Loss: 1.189 Test Acc: 0.560
Validation loss decreased (-0.559987 --> -0.559988).  Saving model ...
Epoch: 19 cost time: 1.5884335041046143
Epoch: 19, Steps: 4 | Train Loss: 0.270 Vali Loss: 1.210 Vali Acc: 0.540 Test Loss: 1.210 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.5704762935638428
Epoch: 20, Steps: 4 | Train Loss: 0.237 Vali Loss: 1.233 Vali Acc: 0.540 Test Loss: 1.233 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.5358867645263672
Epoch: 21, Steps: 4 | Train Loss: 0.201 Vali Loss: 1.217 Vali Acc: 0.560 Test Loss: 1.217 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.4816949367523193
Epoch: 22, Steps: 4 | Train Loss: 0.170 Vali Loss: 1.220 Vali Acc: 0.520 Test Loss: 1.220 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.6462476253509521
Epoch: 23, Steps: 4 | Train Loss: 0.193 Vali Loss: 1.302 Vali Acc: 0.540 Test Loss: 1.302 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.4485976696014404
Epoch: 24, Steps: 4 | Train Loss: 0.130 Vali Loss: 1.388 Vali Acc: 0.500 Test Loss: 1.388 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.4116010665893555
Epoch: 25, Steps: 4 | Train Loss: 0.148 Vali Loss: 1.293 Vali Acc: 0.500 Test Loss: 1.293 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.592771291732788
Epoch: 26, Steps: 4 | Train Loss: 0.107 Vali Loss: 1.316 Vali Acc: 0.480 Test Loss: 1.316 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.6360552310943604
Epoch: 27, Steps: 4 | Train Loss: 0.100 Vali Loss: 1.292 Vali Acc: 0.560 Test Loss: 1.292 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.3387582302093506
Epoch: 28, Steps: 4 | Train Loss: 0.075 Vali Loss: 1.311 Vali Acc: 0.580 Test Loss: 1.311 Test Acc: 0.580
Validation loss decreased (-0.559988 --> -0.579987).  Saving model ...
Epoch: 29 cost time: 1.4723913669586182
Epoch: 29, Steps: 4 | Train Loss: 0.066 Vali Loss: 1.323 Vali Acc: 0.560 Test Loss: 1.323 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.3820481300354004
Epoch: 30, Steps: 4 | Train Loss: 0.075 Vali Loss: 1.328 Vali Acc: 0.540 Test Loss: 1.328 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm16_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 672757
model size : 2.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm16_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.503143787384033
Epoch: 1, Steps: 4 | Train Loss: 1.639 Vali Loss: 1.608 Vali Acc: 0.120 Test Loss: 1.608 Test Acc: 0.120
Validation loss decreased (inf --> -0.119984).  Saving model ...
Epoch: 2 cost time: 1.570997953414917
Epoch: 2, Steps: 4 | Train Loss: 1.578 Vali Loss: 1.592 Vali Acc: 0.180 Test Loss: 1.592 Test Acc: 0.180
Validation loss decreased (-0.119984 --> -0.179984).  Saving model ...
Epoch: 3 cost time: 1.6177690029144287
Epoch: 3, Steps: 4 | Train Loss: 1.471 Vali Loss: 1.570 Vali Acc: 0.240 Test Loss: 1.570 Test Acc: 0.240
Validation loss decreased (-0.179984 --> -0.239984).  Saving model ...
Epoch: 4 cost time: 1.7149534225463867
Epoch: 4, Steps: 4 | Train Loss: 1.453 Vali Loss: 1.548 Vali Acc: 0.260 Test Loss: 1.548 Test Acc: 0.260
Validation loss decreased (-0.239984 --> -0.259985).  Saving model ...
Epoch: 5 cost time: 1.5606093406677246
Epoch: 5, Steps: 4 | Train Loss: 1.236 Vali Loss: 1.530 Vali Acc: 0.300 Test Loss: 1.530 Test Acc: 0.300
Validation loss decreased (-0.259985 --> -0.299985).  Saving model ...
Epoch: 6 cost time: 1.6597552299499512
Epoch: 6, Steps: 4 | Train Loss: 1.288 Vali Loss: 1.513 Vali Acc: 0.280 Test Loss: 1.513 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5165467262268066
Epoch: 7, Steps: 4 | Train Loss: 1.236 Vali Loss: 1.493 Vali Acc: 0.300 Test Loss: 1.493 Test Acc: 0.300
Validation loss decreased (-0.299985 --> -0.299985).  Saving model ...
Epoch: 8 cost time: 1.6459705829620361
Epoch: 8, Steps: 4 | Train Loss: 1.096 Vali Loss: 1.467 Vali Acc: 0.380 Test Loss: 1.467 Test Acc: 0.380
Validation loss decreased (-0.299985 --> -0.379985).  Saving model ...
Epoch: 9 cost time: 1.6487669944763184
Epoch: 9, Steps: 4 | Train Loss: 0.983 Vali Loss: 1.429 Vali Acc: 0.400 Test Loss: 1.429 Test Acc: 0.400
Validation loss decreased (-0.379985 --> -0.399986).  Saving model ...
Epoch: 10 cost time: 1.7490253448486328
Epoch: 10, Steps: 4 | Train Loss: 0.854 Vali Loss: 1.393 Vali Acc: 0.440 Test Loss: 1.393 Test Acc: 0.440
Validation loss decreased (-0.399986 --> -0.439986).  Saving model ...
Epoch: 11 cost time: 1.6427762508392334
Epoch: 11, Steps: 4 | Train Loss: 0.888 Vali Loss: 1.349 Vali Acc: 0.440 Test Loss: 1.349 Test Acc: 0.440
Validation loss decreased (-0.439986 --> -0.439987).  Saving model ...
Epoch: 12 cost time: 1.615126609802246
Epoch: 12, Steps: 4 | Train Loss: 0.673 Vali Loss: 1.277 Vali Acc: 0.480 Test Loss: 1.277 Test Acc: 0.480
Validation loss decreased (-0.439987 --> -0.479987).  Saving model ...
Epoch: 13 cost time: 1.5351183414459229
Epoch: 13, Steps: 4 | Train Loss: 0.562 Vali Loss: 1.258 Vali Acc: 0.500 Test Loss: 1.258 Test Acc: 0.500
Validation loss decreased (-0.479987 --> -0.499987).  Saving model ...
Epoch: 14 cost time: 1.6067793369293213
Epoch: 14, Steps: 4 | Train Loss: 0.540 Vali Loss: 1.246 Vali Acc: 0.520 Test Loss: 1.246 Test Acc: 0.520
Validation loss decreased (-0.499987 --> -0.519988).  Saving model ...
Epoch: 15 cost time: 1.845167636871338
Epoch: 15, Steps: 4 | Train Loss: 0.469 Vali Loss: 1.191 Vali Acc: 0.520 Test Loss: 1.191 Test Acc: 0.520
Validation loss decreased (-0.519988 --> -0.519988).  Saving model ...
Epoch: 16 cost time: 1.5106561183929443
Epoch: 16, Steps: 4 | Train Loss: 0.619 Vali Loss: 1.194 Vali Acc: 0.520 Test Loss: 1.194 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.6998531818389893
Epoch: 17, Steps: 4 | Train Loss: 0.411 Vali Loss: 1.151 Vali Acc: 0.500 Test Loss: 1.151 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.543304204940796
Epoch: 18, Steps: 4 | Train Loss: 0.253 Vali Loss: 1.127 Vali Acc: 0.520 Test Loss: 1.127 Test Acc: 0.520
Validation loss decreased (-0.519988 --> -0.519989).  Saving model ...
Epoch: 19 cost time: 1.6108675003051758
Epoch: 19, Steps: 4 | Train Loss: 0.235 Vali Loss: 1.130 Vali Acc: 0.600 Test Loss: 1.130 Test Acc: 0.600
Validation loss decreased (-0.519989 --> -0.599989).  Saving model ...
Epoch: 20 cost time: 1.4976792335510254
Epoch: 20, Steps: 4 | Train Loss: 0.207 Vali Loss: 1.159 Vali Acc: 0.580 Test Loss: 1.159 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.6275973320007324
Epoch: 21, Steps: 4 | Train Loss: 0.165 Vali Loss: 1.132 Vali Acc: 0.580 Test Loss: 1.132 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.5846819877624512
Epoch: 22, Steps: 4 | Train Loss: 0.163 Vali Loss: 1.116 Vali Acc: 0.560 Test Loss: 1.116 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.7006616592407227
Epoch: 23, Steps: 4 | Train Loss: 0.129 Vali Loss: 1.131 Vali Acc: 0.560 Test Loss: 1.131 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.7012252807617188
Epoch: 24, Steps: 4 | Train Loss: 0.125 Vali Loss: 1.113 Vali Acc: 0.540 Test Loss: 1.113 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.6770310401916504
Epoch: 25, Steps: 4 | Train Loss: 0.153 Vali Loss: 1.108 Vali Acc: 0.580 Test Loss: 1.108 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.6682944297790527
Epoch: 26, Steps: 4 | Train Loss: 0.085 Vali Loss: 1.137 Vali Acc: 0.560 Test Loss: 1.137 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.6571125984191895
Epoch: 27, Steps: 4 | Train Loss: 0.072 Vali Loss: 1.141 Vali Acc: 0.500 Test Loss: 1.141 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.7693960666656494
Epoch: 28, Steps: 4 | Train Loss: 0.068 Vali Loss: 1.140 Vali Acc: 0.520 Test Loss: 1.140 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.5601396560668945
Epoch: 29, Steps: 4 | Train Loss: 0.105 Vali Loss: 1.140 Vali Acc: 0.560 Test Loss: 1.140 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm16_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 258805
model size : 1.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm16_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.5985381603240967
Epoch: 1, Steps: 4 | Train Loss: 1.688 Vali Loss: 1.664 Vali Acc: 0.180 Test Loss: 1.664 Test Acc: 0.180
Validation loss decreased (inf --> -0.179983).  Saving model ...
Epoch: 2 cost time: 1.7489955425262451
Epoch: 2, Steps: 4 | Train Loss: 1.626 Vali Loss: 1.641 Vali Acc: 0.180 Test Loss: 1.641 Test Acc: 0.180
Validation loss decreased (-0.179983 --> -0.179984).  Saving model ...
Epoch: 3 cost time: 1.839524269104004
Epoch: 3, Steps: 4 | Train Loss: 1.628 Vali Loss: 1.617 Vali Acc: 0.180 Test Loss: 1.617 Test Acc: 0.180
Validation loss decreased (-0.179984 --> -0.179984).  Saving model ...
Epoch: 4 cost time: 1.6274261474609375
Epoch: 4, Steps: 4 | Train Loss: 1.484 Vali Loss: 1.601 Vali Acc: 0.240 Test Loss: 1.601 Test Acc: 0.240
Validation loss decreased (-0.179984 --> -0.239984).  Saving model ...
Epoch: 5 cost time: 1.679429292678833
Epoch: 5, Steps: 4 | Train Loss: 1.409 Vali Loss: 1.584 Vali Acc: 0.280 Test Loss: 1.584 Test Acc: 0.280
Validation loss decreased (-0.239984 --> -0.279984).  Saving model ...
Epoch: 6 cost time: 1.7247107028961182
Epoch: 6, Steps: 4 | Train Loss: 1.262 Vali Loss: 1.569 Vali Acc: 0.360 Test Loss: 1.569 Test Acc: 0.360
Validation loss decreased (-0.279984 --> -0.359984).  Saving model ...
Epoch: 7 cost time: 1.5819544792175293
Epoch: 7, Steps: 4 | Train Loss: 1.277 Vali Loss: 1.548 Vali Acc: 0.380 Test Loss: 1.548 Test Acc: 0.380
Validation loss decreased (-0.359984 --> -0.379985).  Saving model ...
Epoch: 8 cost time: 1.6516525745391846
Epoch: 8, Steps: 4 | Train Loss: 1.146 Vali Loss: 1.502 Vali Acc: 0.380 Test Loss: 1.502 Test Acc: 0.380
Validation loss decreased (-0.379985 --> -0.379985).  Saving model ...
Epoch: 9 cost time: 1.608151912689209
Epoch: 9, Steps: 4 | Train Loss: 1.102 Vali Loss: 1.458 Vali Acc: 0.400 Test Loss: 1.458 Test Acc: 0.400
Validation loss decreased (-0.379985 --> -0.399985).  Saving model ...
Epoch: 10 cost time: 1.7310621738433838
Epoch: 10, Steps: 4 | Train Loss: 0.977 Vali Loss: 1.436 Vali Acc: 0.440 Test Loss: 1.436 Test Acc: 0.440
Validation loss decreased (-0.399985 --> -0.439986).  Saving model ...
Epoch: 11 cost time: 1.6983635425567627
Epoch: 11, Steps: 4 | Train Loss: 0.869 Vali Loss: 1.415 Vali Acc: 0.420 Test Loss: 1.415 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.662696123123169
Epoch: 12, Steps: 4 | Train Loss: 0.754 Vali Loss: 1.356 Vali Acc: 0.480 Test Loss: 1.356 Test Acc: 0.480
Validation loss decreased (-0.439986 --> -0.479986).  Saving model ...
Epoch: 13 cost time: 1.785914659500122
Epoch: 13, Steps: 4 | Train Loss: 0.737 Vali Loss: 1.290 Vali Acc: 0.480 Test Loss: 1.290 Test Acc: 0.480
Validation loss decreased (-0.479986 --> -0.479987).  Saving model ...
Epoch: 14 cost time: 1.7235329151153564
Epoch: 14, Steps: 4 | Train Loss: 0.559 Vali Loss: 1.259 Vali Acc: 0.520 Test Loss: 1.259 Test Acc: 0.520
Validation loss decreased (-0.479987 --> -0.519987).  Saving model ...
Epoch: 15 cost time: 1.7119123935699463
Epoch: 15, Steps: 4 | Train Loss: 0.567 Vali Loss: 1.246 Vali Acc: 0.500 Test Loss: 1.246 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.739255666732788
Epoch: 16, Steps: 4 | Train Loss: 0.497 Vali Loss: 1.192 Vali Acc: 0.500 Test Loss: 1.192 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.562366008758545
Epoch: 17, Steps: 4 | Train Loss: 0.365 Vali Loss: 1.159 Vali Acc: 0.520 Test Loss: 1.159 Test Acc: 0.520
Validation loss decreased (-0.519987 --> -0.519988).  Saving model ...
Epoch: 18 cost time: 1.7306032180786133
Epoch: 18, Steps: 4 | Train Loss: 0.387 Vali Loss: 1.167 Vali Acc: 0.520 Test Loss: 1.167 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.796769618988037
Epoch: 19, Steps: 4 | Train Loss: 0.276 Vali Loss: 1.190 Vali Acc: 0.500 Test Loss: 1.190 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.8888497352600098
Epoch: 20, Steps: 4 | Train Loss: 0.252 Vali Loss: 1.212 Vali Acc: 0.480 Test Loss: 1.212 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.6282463073730469
Epoch: 21, Steps: 4 | Train Loss: 0.213 Vali Loss: 1.180 Vali Acc: 0.560 Test Loss: 1.180 Test Acc: 0.560
Validation loss decreased (-0.519988 --> -0.559988).  Saving model ...
Epoch: 22 cost time: 1.8276684284210205
Epoch: 22, Steps: 4 | Train Loss: 0.178 Vali Loss: 1.184 Vali Acc: 0.520 Test Loss: 1.184 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.6814465522766113
Epoch: 23, Steps: 4 | Train Loss: 0.195 Vali Loss: 1.242 Vali Acc: 0.560 Test Loss: 1.242 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.7510864734649658
Epoch: 24, Steps: 4 | Train Loss: 0.138 Vali Loss: 1.315 Vali Acc: 0.580 Test Loss: 1.315 Test Acc: 0.580
Validation loss decreased (-0.559988 --> -0.579987).  Saving model ...
Epoch: 25 cost time: 1.8014113903045654
Epoch: 25, Steps: 4 | Train Loss: 0.160 Vali Loss: 1.228 Vali Acc: 0.580 Test Loss: 1.228 Test Acc: 0.580
Validation loss decreased (-0.579987 --> -0.579988).  Saving model ...
Epoch: 26 cost time: 1.7742681503295898
Epoch: 26, Steps: 4 | Train Loss: 0.109 Vali Loss: 1.254 Vali Acc: 0.520 Test Loss: 1.254 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.8242614269256592
Epoch: 27, Steps: 4 | Train Loss: 0.107 Vali Loss: 1.205 Vali Acc: 0.540 Test Loss: 1.205 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.7321581840515137
Epoch: 28, Steps: 4 | Train Loss: 0.075 Vali Loss: 1.235 Vali Acc: 0.520 Test Loss: 1.235 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.8953921794891357
Epoch: 29, Steps: 4 | Train Loss: 0.075 Vali Loss: 1.221 Vali Acc: 0.500 Test Loss: 1.221 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.8095970153808594
Epoch: 30, Steps: 4 | Train Loss: 0.076 Vali Loss: 1.206 Vali Acc: 0.540 Test Loss: 1.206 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm16_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 672757
model size : 2.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm16_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.2921996116638184
Epoch: 1, Steps: 4 | Train Loss: 1.641 Vali Loss: 1.609 Vali Acc: 0.140 Test Loss: 1.609 Test Acc: 0.140
Validation loss decreased (inf --> -0.139984).  Saving model ...
Epoch: 2 cost time: 1.3941056728363037
Epoch: 2, Steps: 4 | Train Loss: 1.575 Vali Loss: 1.591 Vali Acc: 0.180 Test Loss: 1.591 Test Acc: 0.180
Validation loss decreased (-0.139984 --> -0.179984).  Saving model ...
Epoch: 3 cost time: 1.407193899154663
Epoch: 3, Steps: 4 | Train Loss: 1.462 Vali Loss: 1.568 Vali Acc: 0.220 Test Loss: 1.568 Test Acc: 0.220
Validation loss decreased (-0.179984 --> -0.219984).  Saving model ...
Epoch: 4 cost time: 1.4197673797607422
Epoch: 4, Steps: 4 | Train Loss: 1.448 Vali Loss: 1.545 Vali Acc: 0.260 Test Loss: 1.545 Test Acc: 0.260
Validation loss decreased (-0.219984 --> -0.259985).  Saving model ...
Epoch: 5 cost time: 1.606152057647705
Epoch: 5, Steps: 4 | Train Loss: 1.234 Vali Loss: 1.524 Vali Acc: 0.280 Test Loss: 1.524 Test Acc: 0.280
Validation loss decreased (-0.259985 --> -0.279985).  Saving model ...
Epoch: 6 cost time: 1.316082239151001
Epoch: 6, Steps: 4 | Train Loss: 1.283 Vali Loss: 1.504 Vali Acc: 0.260 Test Loss: 1.504 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4655916690826416
Epoch: 7, Steps: 4 | Train Loss: 1.236 Vali Loss: 1.485 Vali Acc: 0.320 Test Loss: 1.485 Test Acc: 0.320
Validation loss decreased (-0.279985 --> -0.319985).  Saving model ...
Epoch: 8 cost time: 1.5928828716278076
Epoch: 8, Steps: 4 | Train Loss: 1.095 Vali Loss: 1.463 Vali Acc: 0.380 Test Loss: 1.463 Test Acc: 0.380
Validation loss decreased (-0.319985 --> -0.379985).  Saving model ...
Epoch: 9 cost time: 1.5539488792419434
Epoch: 9, Steps: 4 | Train Loss: 0.989 Vali Loss: 1.429 Vali Acc: 0.380 Test Loss: 1.429 Test Acc: 0.380
Validation loss decreased (-0.379985 --> -0.379986).  Saving model ...
Epoch: 10 cost time: 1.5901763439178467
Epoch: 10, Steps: 4 | Train Loss: 0.849 Vali Loss: 1.397 Vali Acc: 0.460 Test Loss: 1.397 Test Acc: 0.460
Validation loss decreased (-0.379986 --> -0.459986).  Saving model ...
Epoch: 11 cost time: 1.5140345096588135
Epoch: 11, Steps: 4 | Train Loss: 0.901 Vali Loss: 1.359 Vali Acc: 0.460 Test Loss: 1.359 Test Acc: 0.460
Validation loss decreased (-0.459986 --> -0.459986).  Saving model ...
Epoch: 12 cost time: 1.569643497467041
Epoch: 12, Steps: 4 | Train Loss: 0.677 Vali Loss: 1.283 Vali Acc: 0.480 Test Loss: 1.283 Test Acc: 0.480
Validation loss decreased (-0.459986 --> -0.479987).  Saving model ...
Epoch: 13 cost time: 1.5132293701171875
Epoch: 13, Steps: 4 | Train Loss: 0.602 Vali Loss: 1.264 Vali Acc: 0.500 Test Loss: 1.264 Test Acc: 0.500
Validation loss decreased (-0.479987 --> -0.499987).  Saving model ...
Epoch: 14 cost time: 1.4447360038757324
Epoch: 14, Steps: 4 | Train Loss: 0.558 Vali Loss: 1.263 Vali Acc: 0.480 Test Loss: 1.263 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4905478954315186
Epoch: 15, Steps: 4 | Train Loss: 0.478 Vali Loss: 1.206 Vali Acc: 0.520 Test Loss: 1.206 Test Acc: 0.520
Validation loss decreased (-0.499987 --> -0.519988).  Saving model ...
Epoch: 16 cost time: 1.420119047164917
Epoch: 16, Steps: 4 | Train Loss: 0.626 Vali Loss: 1.209 Vali Acc: 0.560 Test Loss: 1.209 Test Acc: 0.560
Validation loss decreased (-0.519988 --> -0.559988).  Saving model ...
Epoch: 17 cost time: 1.4053528308868408
Epoch: 17, Steps: 4 | Train Loss: 0.422 Vali Loss: 1.176 Vali Acc: 0.540 Test Loss: 1.176 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.3831074237823486
Epoch: 18, Steps: 4 | Train Loss: 0.260 Vali Loss: 1.140 Vali Acc: 0.540 Test Loss: 1.140 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.4602940082550049
Epoch: 19, Steps: 4 | Train Loss: 0.239 Vali Loss: 1.145 Vali Acc: 0.580 Test Loss: 1.145 Test Acc: 0.580
Validation loss decreased (-0.559988 --> -0.579989).  Saving model ...
Epoch: 20 cost time: 1.508819341659546
Epoch: 20, Steps: 4 | Train Loss: 0.212 Vali Loss: 1.180 Vali Acc: 0.520 Test Loss: 1.180 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.441899061203003
Epoch: 21, Steps: 4 | Train Loss: 0.171 Vali Loss: 1.161 Vali Acc: 0.560 Test Loss: 1.161 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.5058507919311523
Epoch: 22, Steps: 4 | Train Loss: 0.167 Vali Loss: 1.136 Vali Acc: 0.540 Test Loss: 1.136 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.4269416332244873
Epoch: 23, Steps: 4 | Train Loss: 0.131 Vali Loss: 1.157 Vali Acc: 0.600 Test Loss: 1.157 Test Acc: 0.600
Validation loss decreased (-0.579989 --> -0.599988).  Saving model ...
Epoch: 24 cost time: 1.4954664707183838
Epoch: 24, Steps: 4 | Train Loss: 0.136 Vali Loss: 1.141 Vali Acc: 0.540 Test Loss: 1.141 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.4476604461669922
Epoch: 25, Steps: 4 | Train Loss: 0.100 Vali Loss: 1.140 Vali Acc: 0.580 Test Loss: 1.140 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.4759681224822998
Epoch: 26, Steps: 4 | Train Loss: 0.089 Vali Loss: 1.172 Vali Acc: 0.600 Test Loss: 1.172 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.4599664211273193
Epoch: 27, Steps: 4 | Train Loss: 0.074 Vali Loss: 1.136 Vali Acc: 0.580 Test Loss: 1.136 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.346522569656372
Epoch: 28, Steps: 4 | Train Loss: 0.069 Vali Loss: 1.134 Vali Acc: 0.580 Test Loss: 1.134 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.427490472793579
Epoch: 29, Steps: 4 | Train Loss: 0.105 Vali Loss: 1.129 Vali Acc: 0.560 Test Loss: 1.129 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.469287633895874
Epoch: 30, Steps: 4 | Train Loss: 0.048 Vali Loss: 1.198 Vali Acc: 0.580 Test Loss: 1.198 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm16_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 258805
model size : 1.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm8_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 5.2355499267578125
Epoch: 1, Steps: 4 | Train Loss: 1.652 Vali Loss: 1.527 Vali Acc: 0.200 Test Loss: 1.527 Test Acc: 0.200
Validation loss decreased (inf --> -0.199985).  Saving model ...
Epoch: 2 cost time: 3.0829784870147705
Epoch: 2, Steps: 4 | Train Loss: 1.677 Vali Loss: 1.508 Vali Acc: 0.240 Test Loss: 1.508 Test Acc: 0.240
Validation loss decreased (-0.199985 --> -0.239985).  Saving model ...
Epoch: 3 cost time: 3.232408285140991
Epoch: 3, Steps: 4 | Train Loss: 1.653 Vali Loss: 1.481 Vali Acc: 0.260 Test Loss: 1.481 Test Acc: 0.260
Validation loss decreased (-0.239985 --> -0.259985).  Saving model ...
Epoch: 4 cost time: 3.0873780250549316
Epoch: 4, Steps: 4 | Train Loss: 1.616 Vali Loss: 1.463 Vali Acc: 0.380 Test Loss: 1.463 Test Acc: 0.380
Validation loss decreased (-0.259985 --> -0.379985).  Saving model ...
Epoch: 5 cost time: 3.10648512840271
Epoch: 5, Steps: 4 | Train Loss: 1.481 Vali Loss: 1.465 Vali Acc: 0.380 Test Loss: 1.465 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.1960294246673584
Epoch: 6, Steps: 4 | Train Loss: 1.375 Vali Loss: 1.448 Vali Acc: 0.420 Test Loss: 1.448 Test Acc: 0.420
Validation loss decreased (-0.379985 --> -0.419986).  Saving model ...
Epoch: 7 cost time: 3.006789445877075
Epoch: 7, Steps: 4 | Train Loss: 1.329 Vali Loss: 1.424 Vali Acc: 0.400 Test Loss: 1.424 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.001065492630005
Epoch: 8, Steps: 4 | Train Loss: 1.266 Vali Loss: 1.398 Vali Acc: 0.420 Test Loss: 1.398 Test Acc: 0.420
Validation loss decreased (-0.419986 --> -0.419986).  Saving model ...
Epoch: 9 cost time: 3.2866504192352295
Epoch: 9, Steps: 4 | Train Loss: 1.237 Vali Loss: 1.343 Vali Acc: 0.440 Test Loss: 1.343 Test Acc: 0.440
Validation loss decreased (-0.419986 --> -0.439987).  Saving model ...
Epoch: 10 cost time: 3.103181838989258
Epoch: 10, Steps: 4 | Train Loss: 1.008 Vali Loss: 1.326 Vali Acc: 0.420 Test Loss: 1.326 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.243635654449463
Epoch: 11, Steps: 4 | Train Loss: 0.994 Vali Loss: 1.245 Vali Acc: 0.460 Test Loss: 1.245 Test Acc: 0.460
Validation loss decreased (-0.439987 --> -0.459988).  Saving model ...
Epoch: 12 cost time: 3.352837562561035
Epoch: 12, Steps: 4 | Train Loss: 0.938 Vali Loss: 1.207 Vali Acc: 0.380 Test Loss: 1.207 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.490264892578125
Epoch: 13, Steps: 4 | Train Loss: 0.807 Vali Loss: 1.192 Vali Acc: 0.440 Test Loss: 1.192 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.3785393238067627
Epoch: 14, Steps: 4 | Train Loss: 0.752 Vali Loss: 1.167 Vali Acc: 0.440 Test Loss: 1.167 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.2213046550750732
Epoch: 15, Steps: 4 | Train Loss: 0.585 Vali Loss: 1.150 Vali Acc: 0.460 Test Loss: 1.150 Test Acc: 0.460
Validation loss decreased (-0.459988 --> -0.459988).  Saving model ...
Epoch: 16 cost time: 3.2885687351226807
Epoch: 16, Steps: 4 | Train Loss: 0.525 Vali Loss: 1.210 Vali Acc: 0.320 Test Loss: 1.210 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.1472580432891846
Epoch: 17, Steps: 4 | Train Loss: 0.459 Vali Loss: 1.146 Vali Acc: 0.440 Test Loss: 1.146 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.5775697231292725
Epoch: 18, Steps: 4 | Train Loss: 0.365 Vali Loss: 1.096 Vali Acc: 0.480 Test Loss: 1.096 Test Acc: 0.480
Validation loss decreased (-0.459988 --> -0.479989).  Saving model ...
Epoch: 19 cost time: 3.4088454246520996
Epoch: 19, Steps: 4 | Train Loss: 0.499 Vali Loss: 1.027 Vali Acc: 0.560 Test Loss: 1.027 Test Acc: 0.560
Validation loss decreased (-0.479989 --> -0.559990).  Saving model ...
Epoch: 20 cost time: 3.166914939880371
Epoch: 20, Steps: 4 | Train Loss: 0.324 Vali Loss: 1.019 Vali Acc: 0.560 Test Loss: 1.019 Test Acc: 0.560
Validation loss decreased (-0.559990 --> -0.559990).  Saving model ...
Epoch: 21 cost time: 3.1329100131988525
Epoch: 21, Steps: 4 | Train Loss: 0.312 Vali Loss: 1.125 Vali Acc: 0.480 Test Loss: 1.125 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.3299763202667236
Epoch: 22, Steps: 4 | Train Loss: 0.233 Vali Loss: 1.246 Vali Acc: 0.420 Test Loss: 1.246 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.2898616790771484
Epoch: 23, Steps: 4 | Train Loss: 0.297 Vali Loss: 1.141 Vali Acc: 0.540 Test Loss: 1.141 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.3711864948272705
Epoch: 24, Steps: 4 | Train Loss: 0.172 Vali Loss: 1.053 Vali Acc: 0.580 Test Loss: 1.053 Test Acc: 0.580
Validation loss decreased (-0.559990 --> -0.579989).  Saving model ...
Epoch: 25 cost time: 3.1775906085968018
Epoch: 25, Steps: 4 | Train Loss: 0.218 Vali Loss: 1.161 Vali Acc: 0.480 Test Loss: 1.161 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.189411163330078
Epoch: 26, Steps: 4 | Train Loss: 0.239 Vali Loss: 1.264 Vali Acc: 0.480 Test Loss: 1.264 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.177130937576294
Epoch: 27, Steps: 4 | Train Loss: 0.342 Vali Loss: 1.387 Vali Acc: 0.460 Test Loss: 1.387 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.2467617988586426
Epoch: 28, Steps: 4 | Train Loss: 0.210 Vali Loss: 1.331 Vali Acc: 0.520 Test Loss: 1.331 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 3.3578686714172363
Epoch: 29, Steps: 4 | Train Loss: 0.165 Vali Loss: 1.231 Vali Acc: 0.520 Test Loss: 1.231 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 3.409461498260498
Epoch: 30, Steps: 4 | Train Loss: 0.110 Vali Loss: 1.288 Vali Acc: 0.500 Test Loss: 1.288 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm8_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 1216317
model size : 4.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm8_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.158229351043701
Epoch: 1, Steps: 4 | Train Loss: 1.774 Vali Loss: 1.651 Vali Acc: 0.200 Test Loss: 1.651 Test Acc: 0.200
Validation loss decreased (inf --> -0.199983).  Saving model ...
Epoch: 2 cost time: 2.0688889026641846
Epoch: 2, Steps: 4 | Train Loss: 1.574 Vali Loss: 1.633 Vali Acc: 0.280 Test Loss: 1.633 Test Acc: 0.280
Validation loss decreased (-0.199983 --> -0.279984).  Saving model ...
Epoch: 3 cost time: 2.122515916824341
Epoch: 3, Steps: 4 | Train Loss: 1.639 Vali Loss: 1.622 Vali Acc: 0.280 Test Loss: 1.622 Test Acc: 0.280
Validation loss decreased (-0.279984 --> -0.279984).  Saving model ...
Epoch: 4 cost time: 2.030073642730713
Epoch: 4, Steps: 4 | Train Loss: 1.598 Vali Loss: 1.617 Vali Acc: 0.180 Test Loss: 1.617 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.166029691696167
Epoch: 5, Steps: 4 | Train Loss: 1.566 Vali Loss: 1.615 Vali Acc: 0.180 Test Loss: 1.615 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.1261444091796875
Epoch: 6, Steps: 4 | Train Loss: 1.517 Vali Loss: 1.602 Vali Acc: 0.200 Test Loss: 1.602 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.0983774662017822
Epoch: 7, Steps: 4 | Train Loss: 1.374 Vali Loss: 1.593 Vali Acc: 0.280 Test Loss: 1.593 Test Acc: 0.280
Validation loss decreased (-0.279984 --> -0.279984).  Saving model ...
Epoch: 8 cost time: 2.3400352001190186
Epoch: 8, Steps: 4 | Train Loss: 1.335 Vali Loss: 1.576 Vali Acc: 0.320 Test Loss: 1.576 Test Acc: 0.320
Validation loss decreased (-0.279984 --> -0.319984).  Saving model ...
Epoch: 9 cost time: 2.239534378051758
Epoch: 9, Steps: 4 | Train Loss: 1.273 Vali Loss: 1.552 Vali Acc: 0.320 Test Loss: 1.552 Test Acc: 0.320
Validation loss decreased (-0.319984 --> -0.319984).  Saving model ...
Epoch: 10 cost time: 2.2638471126556396
Epoch: 10, Steps: 4 | Train Loss: 1.086 Vali Loss: 1.521 Vali Acc: 0.260 Test Loss: 1.521 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.0701065063476562
Epoch: 11, Steps: 4 | Train Loss: 1.054 Vali Loss: 1.529 Vali Acc: 0.280 Test Loss: 1.529 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.1396701335906982
Epoch: 12, Steps: 4 | Train Loss: 1.024 Vali Loss: 1.516 Vali Acc: 0.300 Test Loss: 1.516 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.1276838779449463
Epoch: 13, Steps: 4 | Train Loss: 1.046 Vali Loss: 1.466 Vali Acc: 0.340 Test Loss: 1.466 Test Acc: 0.340
Validation loss decreased (-0.319984 --> -0.339985).  Saving model ...
Epoch: 14 cost time: 2.055955410003662
Epoch: 14, Steps: 4 | Train Loss: 0.850 Vali Loss: 1.458 Vali Acc: 0.340 Test Loss: 1.458 Test Acc: 0.340
Validation loss decreased (-0.339985 --> -0.339985).  Saving model ...
Epoch: 15 cost time: 1.9790606498718262
Epoch: 15, Steps: 4 | Train Loss: 0.724 Vali Loss: 1.486 Vali Acc: 0.260 Test Loss: 1.486 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.0738365650177
Epoch: 16, Steps: 4 | Train Loss: 0.731 Vali Loss: 1.496 Vali Acc: 0.320 Test Loss: 1.496 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.1703243255615234
Epoch: 17, Steps: 4 | Train Loss: 0.693 Vali Loss: 1.527 Vali Acc: 0.300 Test Loss: 1.527 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.2451303005218506
Epoch: 18, Steps: 4 | Train Loss: 0.559 Vali Loss: 1.527 Vali Acc: 0.340 Test Loss: 1.527 Test Acc: 0.340
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.115647792816162
Epoch: 19, Steps: 4 | Train Loss: 0.525 Vali Loss: 1.514 Vali Acc: 0.340 Test Loss: 1.514 Test Acc: 0.340
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.0736660957336426
Epoch: 20, Steps: 4 | Train Loss: 0.449 Vali Loss: 1.475 Vali Acc: 0.360 Test Loss: 1.475 Test Acc: 0.360
Validation loss decreased (-0.339985 --> -0.359985).  Saving model ...
Epoch: 21 cost time: 2.1560847759246826
Epoch: 21, Steps: 4 | Train Loss: 0.450 Vali Loss: 1.472 Vali Acc: 0.360 Test Loss: 1.472 Test Acc: 0.360
Validation loss decreased (-0.359985 --> -0.359985).  Saving model ...
Epoch: 22 cost time: 2.069286584854126
Epoch: 22, Steps: 4 | Train Loss: 0.307 Vali Loss: 1.526 Vali Acc: 0.400 Test Loss: 1.526 Test Acc: 0.400
Validation loss decreased (-0.359985 --> -0.399985).  Saving model ...
Epoch: 23 cost time: 1.9004628658294678
Epoch: 23, Steps: 4 | Train Loss: 0.307 Vali Loss: 1.512 Vali Acc: 0.400 Test Loss: 1.512 Test Acc: 0.400
Validation loss decreased (-0.399985 --> -0.399985).  Saving model ...
Epoch: 24 cost time: 2.051522970199585
Epoch: 24, Steps: 4 | Train Loss: 0.260 Vali Loss: 1.480 Vali Acc: 0.380 Test Loss: 1.480 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.0363097190856934
Epoch: 25, Steps: 4 | Train Loss: 0.521 Vali Loss: 1.527 Vali Acc: 0.400 Test Loss: 1.527 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.138751983642578
Epoch: 26, Steps: 4 | Train Loss: 0.210 Vali Loss: 1.466 Vali Acc: 0.420 Test Loss: 1.466 Test Acc: 0.420
Validation loss decreased (-0.399985 --> -0.419985).  Saving model ...
Epoch: 27 cost time: 2.0891239643096924
Epoch: 27, Steps: 4 | Train Loss: 0.173 Vali Loss: 1.480 Vali Acc: 0.440 Test Loss: 1.480 Test Acc: 0.440
Validation loss decreased (-0.419985 --> -0.439985).  Saving model ...
Epoch: 28 cost time: 2.0374341011047363
Epoch: 28, Steps: 4 | Train Loss: 0.227 Vali Loss: 1.490 Vali Acc: 0.400 Test Loss: 1.490 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.9458210468292236
Epoch: 29, Steps: 4 | Train Loss: 0.223 Vali Loss: 1.454 Vali Acc: 0.440 Test Loss: 1.454 Test Acc: 0.440
Validation loss decreased (-0.439985 --> -0.439985).  Saving model ...
Epoch: 30 cost time: 2.0029494762420654
Epoch: 30, Steps: 4 | Train Loss: 0.459 Vali Loss: 1.599 Vali Acc: 0.400 Test Loss: 1.599 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm8_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.44
model parameter : 388349
model size : 1.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm8_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.613294363021851
Epoch: 1, Steps: 4 | Train Loss: 1.655 Vali Loss: 1.535 Vali Acc: 0.200 Test Loss: 1.535 Test Acc: 0.200
Validation loss decreased (inf --> -0.199985).  Saving model ...
Epoch: 2 cost time: 2.3820626735687256
Epoch: 2, Steps: 4 | Train Loss: 1.681 Vali Loss: 1.513 Vali Acc: 0.200 Test Loss: 1.513 Test Acc: 0.200
Validation loss decreased (-0.199985 --> -0.199985).  Saving model ...
Epoch: 3 cost time: 2.4604249000549316
Epoch: 3, Steps: 4 | Train Loss: 1.651 Vali Loss: 1.483 Vali Acc: 0.260 Test Loss: 1.483 Test Acc: 0.260
Validation loss decreased (-0.199985 --> -0.259985).  Saving model ...
Epoch: 4 cost time: 2.3830599784851074
Epoch: 4, Steps: 4 | Train Loss: 1.589 Vali Loss: 1.461 Vali Acc: 0.340 Test Loss: 1.461 Test Acc: 0.340
Validation loss decreased (-0.259985 --> -0.339985).  Saving model ...
Epoch: 5 cost time: 2.506575107574463
Epoch: 5, Steps: 4 | Train Loss: 1.472 Vali Loss: 1.442 Vali Acc: 0.440 Test Loss: 1.442 Test Acc: 0.440
Validation loss decreased (-0.339985 --> -0.439986).  Saving model ...
Epoch: 6 cost time: 2.3464925289154053
Epoch: 6, Steps: 4 | Train Loss: 1.343 Vali Loss: 1.417 Vali Acc: 0.440 Test Loss: 1.417 Test Acc: 0.440
Validation loss decreased (-0.439986 --> -0.439986).  Saving model ...
Epoch: 7 cost time: 2.5386476516723633
Epoch: 7, Steps: 4 | Train Loss: 1.324 Vali Loss: 1.386 Vali Acc: 0.440 Test Loss: 1.386 Test Acc: 0.440
Validation loss decreased (-0.439986 --> -0.439986).  Saving model ...
Epoch: 8 cost time: 2.287501335144043
Epoch: 8, Steps: 4 | Train Loss: 1.268 Vali Loss: 1.360 Vali Acc: 0.420 Test Loss: 1.360 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.265963554382324
Epoch: 9, Steps: 4 | Train Loss: 1.259 Vali Loss: 1.325 Vali Acc: 0.400 Test Loss: 1.325 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.4861934185028076
Epoch: 10, Steps: 4 | Train Loss: 1.008 Vali Loss: 1.291 Vali Acc: 0.400 Test Loss: 1.291 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.5012784004211426
Epoch: 11, Steps: 4 | Train Loss: 1.006 Vali Loss: 1.253 Vali Acc: 0.400 Test Loss: 1.253 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.312755584716797
Epoch: 12, Steps: 4 | Train Loss: 0.955 Vali Loss: 1.223 Vali Acc: 0.400 Test Loss: 1.223 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.4032340049743652
Epoch: 13, Steps: 4 | Train Loss: 0.807 Vali Loss: 1.169 Vali Acc: 0.480 Test Loss: 1.169 Test Acc: 0.480
Validation loss decreased (-0.439986 --> -0.479988).  Saving model ...
Epoch: 14 cost time: 2.454198122024536
Epoch: 14, Steps: 4 | Train Loss: 0.699 Vali Loss: 1.181 Vali Acc: 0.400 Test Loss: 1.181 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.5227794647216797
Epoch: 15, Steps: 4 | Train Loss: 0.604 Vali Loss: 1.186 Vali Acc: 0.380 Test Loss: 1.186 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.4558606147766113
Epoch: 16, Steps: 4 | Train Loss: 0.704 Vali Loss: 1.204 Vali Acc: 0.380 Test Loss: 1.204 Test Acc: 0.380
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.4557745456695557
Epoch: 17, Steps: 4 | Train Loss: 0.462 Vali Loss: 1.197 Vali Acc: 0.400 Test Loss: 1.197 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.6368274688720703
Epoch: 18, Steps: 4 | Train Loss: 0.407 Vali Loss: 1.182 Vali Acc: 0.380 Test Loss: 1.182 Test Acc: 0.380
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.4943675994873047
Epoch: 19, Steps: 4 | Train Loss: 0.519 Vali Loss: 1.128 Vali Acc: 0.540 Test Loss: 1.128 Test Acc: 0.540
Validation loss decreased (-0.479988 --> -0.539989).  Saving model ...
Epoch: 20 cost time: 2.627592086791992
Epoch: 20, Steps: 4 | Train Loss: 0.454 Vali Loss: 1.127 Vali Acc: 0.520 Test Loss: 1.127 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.465810537338257
Epoch: 21, Steps: 4 | Train Loss: 0.363 Vali Loss: 1.121 Vali Acc: 0.460 Test Loss: 1.121 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.6936020851135254
Epoch: 22, Steps: 4 | Train Loss: 0.353 Vali Loss: 1.080 Vali Acc: 0.520 Test Loss: 1.080 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.473707675933838
Epoch: 23, Steps: 4 | Train Loss: 0.304 Vali Loss: 1.107 Vali Acc: 0.480 Test Loss: 1.107 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.541025400161743
Epoch: 24, Steps: 4 | Train Loss: 0.254 Vali Loss: 1.128 Vali Acc: 0.440 Test Loss: 1.128 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.524791955947876
Epoch: 25, Steps: 4 | Train Loss: 0.197 Vali Loss: 1.052 Vali Acc: 0.560 Test Loss: 1.052 Test Acc: 0.560
Validation loss decreased (-0.539989 --> -0.559989).  Saving model ...
Epoch: 26 cost time: 2.581502676010132
Epoch: 26, Steps: 4 | Train Loss: 0.221 Vali Loss: 1.162 Vali Acc: 0.500 Test Loss: 1.162 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.5345511436462402
Epoch: 27, Steps: 4 | Train Loss: 0.183 Vali Loss: 1.139 Vali Acc: 0.460 Test Loss: 1.139 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.5236918926239014
Epoch: 28, Steps: 4 | Train Loss: 0.292 Vali Loss: 1.243 Vali Acc: 0.500 Test Loss: 1.243 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.5403976440429688
Epoch: 29, Steps: 4 | Train Loss: 0.277 Vali Loss: 1.303 Vali Acc: 0.440 Test Loss: 1.303 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.4312808513641357
Epoch: 30, Steps: 4 | Train Loss: 0.122 Vali Loss: 1.261 Vali Acc: 0.440 Test Loss: 1.261 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm8_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 1216317
model size : 4.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm8_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.657928705215454
Epoch: 1, Steps: 4 | Train Loss: 1.771 Vali Loss: 1.661 Vali Acc: 0.200 Test Loss: 1.661 Test Acc: 0.200
Validation loss decreased (inf --> -0.199983).  Saving model ...
Epoch: 2 cost time: 2.0091030597686768
Epoch: 2, Steps: 4 | Train Loss: 1.574 Vali Loss: 1.647 Vali Acc: 0.240 Test Loss: 1.647 Test Acc: 0.240
Validation loss decreased (-0.199983 --> -0.239984).  Saving model ...
Epoch: 3 cost time: 1.8502812385559082
Epoch: 3, Steps: 4 | Train Loss: 1.640 Vali Loss: 1.641 Vali Acc: 0.240 Test Loss: 1.641 Test Acc: 0.240
Validation loss decreased (-0.239984 --> -0.239984).  Saving model ...
Epoch: 4 cost time: 1.8981282711029053
Epoch: 4, Steps: 4 | Train Loss: 1.600 Vali Loss: 1.632 Vali Acc: 0.220 Test Loss: 1.632 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.9138240814208984
Epoch: 5, Steps: 4 | Train Loss: 1.566 Vali Loss: 1.625 Vali Acc: 0.220 Test Loss: 1.625 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.8306846618652344
Epoch: 6, Steps: 4 | Train Loss: 1.507 Vali Loss: 1.610 Vali Acc: 0.200 Test Loss: 1.610 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.888206958770752
Epoch: 7, Steps: 4 | Train Loss: 1.376 Vali Loss: 1.605 Vali Acc: 0.280 Test Loss: 1.605 Test Acc: 0.280
Validation loss decreased (-0.239984 --> -0.279984).  Saving model ...
Epoch: 8 cost time: 1.9144787788391113
Epoch: 8, Steps: 4 | Train Loss: 1.275 Vali Loss: 1.595 Vali Acc: 0.320 Test Loss: 1.595 Test Acc: 0.320
Validation loss decreased (-0.279984 --> -0.319984).  Saving model ...
Epoch: 9 cost time: 1.9530246257781982
Epoch: 9, Steps: 4 | Train Loss: 1.274 Vali Loss: 1.568 Vali Acc: 0.320 Test Loss: 1.568 Test Acc: 0.320
Validation loss decreased (-0.319984 --> -0.319984).  Saving model ...
Epoch: 10 cost time: 1.9384551048278809
Epoch: 10, Steps: 4 | Train Loss: 1.103 Vali Loss: 1.533 Vali Acc: 0.280 Test Loss: 1.533 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.9344584941864014
Epoch: 11, Steps: 4 | Train Loss: 1.074 Vali Loss: 1.524 Vali Acc: 0.300 Test Loss: 1.524 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.8730711936950684
Epoch: 12, Steps: 4 | Train Loss: 1.015 Vali Loss: 1.506 Vali Acc: 0.280 Test Loss: 1.506 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.9914419651031494
Epoch: 13, Steps: 4 | Train Loss: 1.044 Vali Loss: 1.466 Vali Acc: 0.380 Test Loss: 1.466 Test Acc: 0.380
Validation loss decreased (-0.319984 --> -0.379985).  Saving model ...
Epoch: 14 cost time: 1.9111595153808594
Epoch: 14, Steps: 4 | Train Loss: 0.806 Vali Loss: 1.410 Vali Acc: 0.380 Test Loss: 1.410 Test Acc: 0.380
Validation loss decreased (-0.379985 --> -0.379986).  Saving model ...
Epoch: 15 cost time: 2.050544023513794
Epoch: 15, Steps: 4 | Train Loss: 0.756 Vali Loss: 1.386 Vali Acc: 0.320 Test Loss: 1.386 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.8219146728515625
Epoch: 16, Steps: 4 | Train Loss: 0.701 Vali Loss: 1.406 Vali Acc: 0.280 Test Loss: 1.406 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.8168985843658447
Epoch: 17, Steps: 4 | Train Loss: 0.685 Vali Loss: 1.390 Vali Acc: 0.340 Test Loss: 1.390 Test Acc: 0.340
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.016493797302246
Epoch: 18, Steps: 4 | Train Loss: 0.591 Vali Loss: 1.358 Vali Acc: 0.360 Test Loss: 1.358 Test Acc: 0.360
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.8408730030059814
Epoch: 19, Steps: 4 | Train Loss: 0.535 Vali Loss: 1.379 Vali Acc: 0.380 Test Loss: 1.379 Test Acc: 0.380
Validation loss decreased (-0.379986 --> -0.379986).  Saving model ...
Epoch: 20 cost time: 1.9326446056365967
Epoch: 20, Steps: 4 | Train Loss: 0.476 Vali Loss: 1.409 Vali Acc: 0.400 Test Loss: 1.409 Test Acc: 0.400
Validation loss decreased (-0.379986 --> -0.399986).  Saving model ...
Epoch: 21 cost time: 1.7813565731048584
Epoch: 21, Steps: 4 | Train Loss: 0.409 Vali Loss: 1.332 Vali Acc: 0.440 Test Loss: 1.332 Test Acc: 0.440
Validation loss decreased (-0.399986 --> -0.439987).  Saving model ...
Epoch: 22 cost time: 1.8313946723937988
Epoch: 22, Steps: 4 | Train Loss: 0.340 Vali Loss: 1.321 Vali Acc: 0.380 Test Loss: 1.321 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.91410231590271
Epoch: 23, Steps: 4 | Train Loss: 0.377 Vali Loss: 1.383 Vali Acc: 0.400 Test Loss: 1.383 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.7621831893920898
Epoch: 24, Steps: 4 | Train Loss: 0.311 Vali Loss: 1.235 Vali Acc: 0.420 Test Loss: 1.235 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.7991514205932617
Epoch: 25, Steps: 4 | Train Loss: 0.613 Vali Loss: 1.321 Vali Acc: 0.480 Test Loss: 1.321 Test Acc: 0.480
Validation loss decreased (-0.439987 --> -0.479987).  Saving model ...
Epoch: 26 cost time: 1.9422314167022705
Epoch: 26, Steps: 4 | Train Loss: 0.297 Vali Loss: 1.265 Vali Acc: 0.480 Test Loss: 1.265 Test Acc: 0.480
Validation loss decreased (-0.479987 --> -0.479987).  Saving model ...
Epoch: 27 cost time: 1.8576316833496094
Epoch: 27, Steps: 4 | Train Loss: 0.200 Vali Loss: 1.350 Vali Acc: 0.420 Test Loss: 1.350 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.7902517318725586
Epoch: 28, Steps: 4 | Train Loss: 0.317 Vali Loss: 1.319 Vali Acc: 0.420 Test Loss: 1.319 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.8349792957305908
Epoch: 29, Steps: 4 | Train Loss: 0.230 Vali Loss: 1.253 Vali Acc: 0.500 Test Loss: 1.253 Test Acc: 0.500
Validation loss decreased (-0.479987 --> -0.499987).  Saving model ...
Epoch: 30 cost time: 1.8870086669921875
Epoch: 30, Steps: 4 | Train Loss: 0.465 Vali Loss: 1.427 Vali Acc: 0.400 Test Loss: 1.427 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm8_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.5
model parameter : 388349
model size : 1.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm8_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.4792299270629883
Epoch: 1, Steps: 4 | Train Loss: 1.653 Vali Loss: 1.541 Vali Acc: 0.240 Test Loss: 1.541 Test Acc: 0.240
Validation loss decreased (inf --> -0.239985).  Saving model ...
Epoch: 2 cost time: 1.7256968021392822
Epoch: 2, Steps: 4 | Train Loss: 1.695 Vali Loss: 1.523 Vali Acc: 0.240 Test Loss: 1.523 Test Acc: 0.240
Validation loss decreased (-0.239985 --> -0.239985).  Saving model ...
Epoch: 3 cost time: 1.7305943965911865
Epoch: 3, Steps: 4 | Train Loss: 1.664 Vali Loss: 1.497 Vali Acc: 0.260 Test Loss: 1.497 Test Acc: 0.260
Validation loss decreased (-0.239985 --> -0.259985).  Saving model ...
Epoch: 4 cost time: 1.533019781112671
Epoch: 4, Steps: 4 | Train Loss: 1.601 Vali Loss: 1.467 Vali Acc: 0.380 Test Loss: 1.467 Test Acc: 0.380
Validation loss decreased (-0.259985 --> -0.379985).  Saving model ...
Epoch: 5 cost time: 1.5594151020050049
Epoch: 5, Steps: 4 | Train Loss: 1.456 Vali Loss: 1.450 Vali Acc: 0.400 Test Loss: 1.450 Test Acc: 0.400
Validation loss decreased (-0.379985 --> -0.399985).  Saving model ...
Epoch: 6 cost time: 1.6140167713165283
Epoch: 6, Steps: 4 | Train Loss: 1.356 Vali Loss: 1.432 Vali Acc: 0.400 Test Loss: 1.432 Test Acc: 0.400
Validation loss decreased (-0.399985 --> -0.399986).  Saving model ...
Epoch: 7 cost time: 1.7225909233093262
Epoch: 7, Steps: 4 | Train Loss: 1.377 Vali Loss: 1.409 Vali Acc: 0.400 Test Loss: 1.409 Test Acc: 0.400
Validation loss decreased (-0.399986 --> -0.399986).  Saving model ...
Epoch: 8 cost time: 1.5351624488830566
Epoch: 8, Steps: 4 | Train Loss: 1.282 Vali Loss: 1.384 Vali Acc: 0.440 Test Loss: 1.384 Test Acc: 0.440
Validation loss decreased (-0.399986 --> -0.439986).  Saving model ...
Epoch: 9 cost time: 1.626490592956543
Epoch: 9, Steps: 4 | Train Loss: 1.208 Vali Loss: 1.347 Vali Acc: 0.400 Test Loss: 1.347 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5828588008880615
Epoch: 10, Steps: 4 | Train Loss: 1.092 Vali Loss: 1.319 Vali Acc: 0.400 Test Loss: 1.319 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.4902002811431885
Epoch: 11, Steps: 4 | Train Loss: 1.043 Vali Loss: 1.265 Vali Acc: 0.400 Test Loss: 1.265 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.5213122367858887
Epoch: 12, Steps: 4 | Train Loss: 0.953 Vali Loss: 1.230 Vali Acc: 0.500 Test Loss: 1.230 Test Acc: 0.500
Validation loss decreased (-0.439986 --> -0.499988).  Saving model ...
Epoch: 13 cost time: 1.5554399490356445
Epoch: 13, Steps: 4 | Train Loss: 0.795 Vali Loss: 1.185 Vali Acc: 0.480 Test Loss: 1.185 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6259467601776123
Epoch: 14, Steps: 4 | Train Loss: 0.809 Vali Loss: 1.149 Vali Acc: 0.520 Test Loss: 1.149 Test Acc: 0.520
Validation loss decreased (-0.499988 --> -0.519989).  Saving model ...
Epoch: 15 cost time: 1.6525745391845703
Epoch: 15, Steps: 4 | Train Loss: 0.634 Vali Loss: 1.181 Vali Acc: 0.480 Test Loss: 1.181 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.5047130584716797
Epoch: 16, Steps: 4 | Train Loss: 0.638 Vali Loss: 1.164 Vali Acc: 0.440 Test Loss: 1.164 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.4359548091888428
Epoch: 17, Steps: 4 | Train Loss: 0.486 Vali Loss: 1.134 Vali Acc: 0.420 Test Loss: 1.134 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.578554630279541
Epoch: 18, Steps: 4 | Train Loss: 0.411 Vali Loss: 1.118 Vali Acc: 0.480 Test Loss: 1.118 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.539579153060913
Epoch: 19, Steps: 4 | Train Loss: 0.495 Vali Loss: 1.099 Vali Acc: 0.560 Test Loss: 1.099 Test Acc: 0.560
Validation loss decreased (-0.519989 --> -0.559989).  Saving model ...
Epoch: 20 cost time: 1.5980424880981445
Epoch: 20, Steps: 4 | Train Loss: 0.374 Vali Loss: 1.025 Vali Acc: 0.520 Test Loss: 1.025 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.569486379623413
Epoch: 21, Steps: 4 | Train Loss: 0.363 Vali Loss: 1.036 Vali Acc: 0.520 Test Loss: 1.036 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.594876766204834
Epoch: 22, Steps: 4 | Train Loss: 0.334 Vali Loss: 1.104 Vali Acc: 0.460 Test Loss: 1.104 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.2380397319793701
Epoch: 23, Steps: 4 | Train Loss: 0.333 Vali Loss: 1.108 Vali Acc: 0.460 Test Loss: 1.108 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.5891432762145996
Epoch: 24, Steps: 4 | Train Loss: 0.284 Vali Loss: 1.115 Vali Acc: 0.500 Test Loss: 1.115 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.698451280593872
Epoch: 25, Steps: 4 | Train Loss: 0.257 Vali Loss: 1.157 Vali Acc: 0.480 Test Loss: 1.157 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.8130357265472412
Epoch: 26, Steps: 4 | Train Loss: 0.304 Vali Loss: 1.245 Vali Acc: 0.500 Test Loss: 1.245 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.6593973636627197
Epoch: 27, Steps: 4 | Train Loss: 0.241 Vali Loss: 1.296 Vali Acc: 0.480 Test Loss: 1.296 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.668571949005127
Epoch: 28, Steps: 4 | Train Loss: 0.227 Vali Loss: 1.229 Vali Acc: 0.500 Test Loss: 1.229 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.5649070739746094
Epoch: 29, Steps: 4 | Train Loss: 0.210 Vali Loss: 1.278 Vali Acc: 0.480 Test Loss: 1.278 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm8_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 1216317
model size : 4.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm8_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.491154909133911
Epoch: 1, Steps: 4 | Train Loss: 1.758 Vali Loss: 1.661 Vali Acc: 0.180 Test Loss: 1.661 Test Acc: 0.180
Validation loss decreased (inf --> -0.179983).  Saving model ...
Epoch: 2 cost time: 1.5498967170715332
Epoch: 2, Steps: 4 | Train Loss: 1.568 Vali Loss: 1.645 Vali Acc: 0.180 Test Loss: 1.645 Test Acc: 0.180
Validation loss decreased (-0.179983 --> -0.179984).  Saving model ...
Epoch: 3 cost time: 1.3449878692626953
Epoch: 3, Steps: 4 | Train Loss: 1.650 Vali Loss: 1.628 Vali Acc: 0.240 Test Loss: 1.628 Test Acc: 0.240
Validation loss decreased (-0.179984 --> -0.239984).  Saving model ...
Epoch: 4 cost time: 1.4668538570404053
Epoch: 4, Steps: 4 | Train Loss: 1.594 Vali Loss: 1.613 Vali Acc: 0.340 Test Loss: 1.613 Test Acc: 0.340
Validation loss decreased (-0.239984 --> -0.339984).  Saving model ...
Epoch: 5 cost time: 1.3429977893829346
Epoch: 5, Steps: 4 | Train Loss: 1.567 Vali Loss: 1.602 Vali Acc: 0.300 Test Loss: 1.602 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.328075885772705
Epoch: 6, Steps: 4 | Train Loss: 1.534 Vali Loss: 1.586 Vali Acc: 0.280 Test Loss: 1.586 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.5207328796386719
Epoch: 7, Steps: 4 | Train Loss: 1.404 Vali Loss: 1.576 Vali Acc: 0.340 Test Loss: 1.576 Test Acc: 0.340
Validation loss decreased (-0.339984 --> -0.339984).  Saving model ...
Epoch: 8 cost time: 1.4025652408599854
Epoch: 8, Steps: 4 | Train Loss: 1.307 Vali Loss: 1.554 Vali Acc: 0.340 Test Loss: 1.554 Test Acc: 0.340
Validation loss decreased (-0.339984 --> -0.339984).  Saving model ...
Epoch: 9 cost time: 1.494934320449829
Epoch: 9, Steps: 4 | Train Loss: 1.309 Vali Loss: 1.526 Vali Acc: 0.340 Test Loss: 1.526 Test Acc: 0.340
Validation loss decreased (-0.339984 --> -0.339985).  Saving model ...
Epoch: 10 cost time: 1.4238340854644775
Epoch: 10, Steps: 4 | Train Loss: 1.085 Vali Loss: 1.459 Vali Acc: 0.360 Test Loss: 1.459 Test Acc: 0.360
Validation loss decreased (-0.339985 --> -0.359985).  Saving model ...
Epoch: 11 cost time: 1.3556058406829834
Epoch: 11, Steps: 4 | Train Loss: 1.122 Vali Loss: 1.425 Vali Acc: 0.380 Test Loss: 1.425 Test Acc: 0.380
Validation loss decreased (-0.359985 --> -0.379986).  Saving model ...
Epoch: 12 cost time: 1.2899153232574463
Epoch: 12, Steps: 4 | Train Loss: 1.084 Vali Loss: 1.384 Vali Acc: 0.400 Test Loss: 1.384 Test Acc: 0.400
Validation loss decreased (-0.379986 --> -0.399986).  Saving model ...
Epoch: 13 cost time: 1.4671411514282227
Epoch: 13, Steps: 4 | Train Loss: 0.991 Vali Loss: 1.330 Vali Acc: 0.380 Test Loss: 1.330 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4437603950500488
Epoch: 14, Steps: 4 | Train Loss: 0.884 Vali Loss: 1.280 Vali Acc: 0.400 Test Loss: 1.280 Test Acc: 0.400
Validation loss decreased (-0.399986 --> -0.399987).  Saving model ...
Epoch: 15 cost time: 1.5161316394805908
Epoch: 15, Steps: 4 | Train Loss: 0.840 Vali Loss: 1.250 Vali Acc: 0.440 Test Loss: 1.250 Test Acc: 0.440
Validation loss decreased (-0.399987 --> -0.439988).  Saving model ...
Epoch: 16 cost time: 1.4921650886535645
Epoch: 16, Steps: 4 | Train Loss: 0.783 Vali Loss: 1.212 Vali Acc: 0.440 Test Loss: 1.212 Test Acc: 0.440
Validation loss decreased (-0.439988 --> -0.439988).  Saving model ...
Epoch: 17 cost time: 1.5548686981201172
Epoch: 17, Steps: 4 | Train Loss: 0.700 Vali Loss: 1.198 Vali Acc: 0.400 Test Loss: 1.198 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.5615425109863281
Epoch: 18, Steps: 4 | Train Loss: 0.610 Vali Loss: 1.185 Vali Acc: 0.400 Test Loss: 1.185 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.436356544494629
Epoch: 19, Steps: 4 | Train Loss: 0.559 Vali Loss: 1.191 Vali Acc: 0.420 Test Loss: 1.191 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.5031225681304932
Epoch: 20, Steps: 4 | Train Loss: 0.493 Vali Loss: 1.194 Vali Acc: 0.440 Test Loss: 1.194 Test Acc: 0.440
Validation loss decreased (-0.439988 --> -0.439988).  Saving model ...
Epoch: 21 cost time: 1.3840043544769287
Epoch: 21, Steps: 4 | Train Loss: 0.493 Vali Loss: 1.233 Vali Acc: 0.480 Test Loss: 1.233 Test Acc: 0.480
Validation loss decreased (-0.439988 --> -0.479988).  Saving model ...
Epoch: 22 cost time: 1.3821265697479248
Epoch: 22, Steps: 4 | Train Loss: 0.394 Vali Loss: 1.181 Vali Acc: 0.540 Test Loss: 1.181 Test Acc: 0.540
Validation loss decreased (-0.479988 --> -0.539988).  Saving model ...
Epoch: 23 cost time: 1.3712472915649414
Epoch: 23, Steps: 4 | Train Loss: 0.385 Vali Loss: 1.174 Vali Acc: 0.500 Test Loss: 1.174 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.4064667224884033
Epoch: 24, Steps: 4 | Train Loss: 0.313 Vali Loss: 1.195 Vali Acc: 0.520 Test Loss: 1.195 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.343496561050415
Epoch: 25, Steps: 4 | Train Loss: 0.647 Vali Loss: 1.235 Vali Acc: 0.520 Test Loss: 1.235 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.4302341938018799
Epoch: 26, Steps: 4 | Train Loss: 0.263 Vali Loss: 1.248 Vali Acc: 0.480 Test Loss: 1.248 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.3257548809051514
Epoch: 27, Steps: 4 | Train Loss: 0.262 Vali Loss: 1.208 Vali Acc: 0.520 Test Loss: 1.208 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.398508071899414
Epoch: 28, Steps: 4 | Train Loss: 0.355 Vali Loss: 1.276 Vali Acc: 0.540 Test Loss: 1.276 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.3299281597137451
Epoch: 29, Steps: 4 | Train Loss: 0.259 Vali Loss: 1.292 Vali Acc: 0.480 Test Loss: 1.292 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.360212802886963
Epoch: 30, Steps: 4 | Train Loss: 0.449 Vali Loss: 1.352 Vali Acc: 0.480 Test Loss: 1.352 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm8_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 388349
model size : 1.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm8_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.216351509094238
Epoch: 1, Steps: 4 | Train Loss: 1.589 Vali Loss: 1.586 Vali Acc: 0.220 Test Loss: 1.586 Test Acc: 0.220
Validation loss decreased (inf --> -0.219984).  Saving model ...
Epoch: 2 cost time: 2.648019313812256
Epoch: 2, Steps: 4 | Train Loss: 1.588 Vali Loss: 1.578 Vali Acc: 0.260 Test Loss: 1.578 Test Acc: 0.260
Validation loss decreased (-0.219984 --> -0.259984).  Saving model ...
Epoch: 3 cost time: 2.4831724166870117
Epoch: 3, Steps: 4 | Train Loss: 1.505 Vali Loss: 1.564 Vali Acc: 0.280 Test Loss: 1.564 Test Acc: 0.280
Validation loss decreased (-0.259984 --> -0.279984).  Saving model ...
Epoch: 4 cost time: 2.4342308044433594
Epoch: 4, Steps: 4 | Train Loss: 1.406 Vali Loss: 1.544 Vali Acc: 0.280 Test Loss: 1.544 Test Acc: 0.280
Validation loss decreased (-0.279984 --> -0.279985).  Saving model ...
Epoch: 5 cost time: 2.562727451324463
Epoch: 5, Steps: 4 | Train Loss: 1.516 Vali Loss: 1.524 Vali Acc: 0.260 Test Loss: 1.524 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.555331230163574
Epoch: 6, Steps: 4 | Train Loss: 1.348 Vali Loss: 1.506 Vali Acc: 0.260 Test Loss: 1.506 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.410722017288208
Epoch: 7, Steps: 4 | Train Loss: 1.213 Vali Loss: 1.485 Vali Acc: 0.280 Test Loss: 1.485 Test Acc: 0.280
Validation loss decreased (-0.279985 --> -0.279985).  Saving model ...
Epoch: 8 cost time: 2.5214121341705322
Epoch: 8, Steps: 4 | Train Loss: 1.230 Vali Loss: 1.461 Vali Acc: 0.280 Test Loss: 1.461 Test Acc: 0.280
Validation loss decreased (-0.279985 --> -0.279985).  Saving model ...
Epoch: 9 cost time: 2.3709208965301514
Epoch: 9, Steps: 4 | Train Loss: 1.119 Vali Loss: 1.431 Vali Acc: 0.260 Test Loss: 1.431 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.3337340354919434
Epoch: 10, Steps: 4 | Train Loss: 1.044 Vali Loss: 1.407 Vali Acc: 0.340 Test Loss: 1.407 Test Acc: 0.340
Validation loss decreased (-0.279985 --> -0.339986).  Saving model ...
Epoch: 11 cost time: 2.5125019550323486
Epoch: 11, Steps: 4 | Train Loss: 1.074 Vali Loss: 1.393 Vali Acc: 0.300 Test Loss: 1.393 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.2940597534179688
Epoch: 12, Steps: 4 | Train Loss: 0.800 Vali Loss: 1.369 Vali Acc: 0.360 Test Loss: 1.369 Test Acc: 0.360
Validation loss decreased (-0.339986 --> -0.359986).  Saving model ...
Epoch: 13 cost time: 2.3767268657684326
Epoch: 13, Steps: 4 | Train Loss: 0.706 Vali Loss: 1.350 Vali Acc: 0.400 Test Loss: 1.350 Test Acc: 0.400
Validation loss decreased (-0.359986 --> -0.399987).  Saving model ...
Epoch: 14 cost time: 2.5491297245025635
Epoch: 14, Steps: 4 | Train Loss: 0.674 Vali Loss: 1.285 Vali Acc: 0.400 Test Loss: 1.285 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 15 cost time: 2.3295795917510986
Epoch: 15, Steps: 4 | Train Loss: 0.675 Vali Loss: 1.233 Vali Acc: 0.400 Test Loss: 1.233 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399988).  Saving model ...
Epoch: 16 cost time: 2.3589115142822266
Epoch: 16, Steps: 4 | Train Loss: 0.537 Vali Loss: 1.262 Vali Acc: 0.420 Test Loss: 1.262 Test Acc: 0.420
Validation loss decreased (-0.399988 --> -0.419987).  Saving model ...
Epoch: 17 cost time: 2.456995725631714
Epoch: 17, Steps: 4 | Train Loss: 0.502 Vali Loss: 1.249 Vali Acc: 0.440 Test Loss: 1.249 Test Acc: 0.440
Validation loss decreased (-0.419987 --> -0.439988).  Saving model ...
Epoch: 18 cost time: 2.2985503673553467
Epoch: 18, Steps: 4 | Train Loss: 0.460 Vali Loss: 1.232 Vali Acc: 0.400 Test Loss: 1.232 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.1399991512298584
Epoch: 19, Steps: 4 | Train Loss: 0.330 Vali Loss: 1.391 Vali Acc: 0.340 Test Loss: 1.391 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.1875033378601074
Epoch: 20, Steps: 4 | Train Loss: 0.309 Vali Loss: 1.276 Vali Acc: 0.400 Test Loss: 1.276 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.2022902965545654
Epoch: 21, Steps: 4 | Train Loss: 0.304 Vali Loss: 1.228 Vali Acc: 0.420 Test Loss: 1.228 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.3938333988189697
Epoch: 22, Steps: 4 | Train Loss: 0.242 Vali Loss: 1.373 Vali Acc: 0.440 Test Loss: 1.373 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.375946521759033
Epoch: 23, Steps: 4 | Train Loss: 0.277 Vali Loss: 1.297 Vali Acc: 0.460 Test Loss: 1.297 Test Acc: 0.460
Validation loss decreased (-0.439988 --> -0.459987).  Saving model ...
Epoch: 24 cost time: 2.419125556945801
Epoch: 24, Steps: 4 | Train Loss: 0.226 Vali Loss: 1.449 Vali Acc: 0.400 Test Loss: 1.449 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.4132351875305176
Epoch: 25, Steps: 4 | Train Loss: 0.400 Vali Loss: 1.279 Vali Acc: 0.460 Test Loss: 1.279 Test Acc: 0.460
Validation loss decreased (-0.459987 --> -0.459987).  Saving model ...
Epoch: 26 cost time: 2.3949387073516846
Epoch: 26, Steps: 4 | Train Loss: 0.131 Vali Loss: 1.300 Vali Acc: 0.460 Test Loss: 1.300 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.454376220703125
Epoch: 27, Steps: 4 | Train Loss: 0.163 Vali Loss: 1.254 Vali Acc: 0.480 Test Loss: 1.254 Test Acc: 0.480
Validation loss decreased (-0.459987 --> -0.479987).  Saving model ...
Epoch: 28 cost time: 2.588749885559082
Epoch: 28, Steps: 4 | Train Loss: 0.136 Vali Loss: 1.281 Vali Acc: 0.400 Test Loss: 1.281 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.571056365966797
Epoch: 29, Steps: 4 | Train Loss: 0.137 Vali Loss: 1.377 Vali Acc: 0.360 Test Loss: 1.377 Test Acc: 0.360
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.4534411430358887
Epoch: 30, Steps: 4 | Train Loss: 0.134 Vali Loss: 1.215 Vali Acc: 0.460 Test Loss: 1.215 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm8_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.48
model parameter : 629821
model size : 2.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm8_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.625389337539673
Epoch: 1, Steps: 4 | Train Loss: 1.676 Vali Loss: 1.711 Vali Acc: 0.220 Test Loss: 1.711 Test Acc: 0.220
Validation loss decreased (inf --> -0.219983).  Saving model ...
Epoch: 2 cost time: 1.74338960647583
Epoch: 2, Steps: 4 | Train Loss: 1.684 Vali Loss: 1.693 Vali Acc: 0.240 Test Loss: 1.693 Test Acc: 0.240
Validation loss decreased (-0.219983 --> -0.239983).  Saving model ...
Epoch: 3 cost time: 1.6854724884033203
Epoch: 3, Steps: 4 | Train Loss: 1.547 Vali Loss: 1.672 Vali Acc: 0.260 Test Loss: 1.672 Test Acc: 0.260
Validation loss decreased (-0.239983 --> -0.259983).  Saving model ...
Epoch: 4 cost time: 1.6439540386199951
Epoch: 4, Steps: 4 | Train Loss: 1.549 Vali Loss: 1.645 Vali Acc: 0.260 Test Loss: 1.645 Test Acc: 0.260
Validation loss decreased (-0.259983 --> -0.259984).  Saving model ...
Epoch: 5 cost time: 1.6229248046875
Epoch: 5, Steps: 4 | Train Loss: 1.624 Vali Loss: 1.617 Vali Acc: 0.300 Test Loss: 1.617 Test Acc: 0.300
Validation loss decreased (-0.259984 --> -0.299984).  Saving model ...
Epoch: 6 cost time: 1.7405295372009277
Epoch: 6, Steps: 4 | Train Loss: 1.452 Vali Loss: 1.588 Vali Acc: 0.340 Test Loss: 1.588 Test Acc: 0.340
Validation loss decreased (-0.299984 --> -0.339984).  Saving model ...
Epoch: 7 cost time: 1.622990608215332
Epoch: 7, Steps: 4 | Train Loss: 1.376 Vali Loss: 1.559 Vali Acc: 0.380 Test Loss: 1.559 Test Acc: 0.380
Validation loss decreased (-0.339984 --> -0.379984).  Saving model ...
Epoch: 8 cost time: 1.7279808521270752
Epoch: 8, Steps: 4 | Train Loss: 1.364 Vali Loss: 1.532 Vali Acc: 0.380 Test Loss: 1.532 Test Acc: 0.380
Validation loss decreased (-0.379984 --> -0.379985).  Saving model ...
Epoch: 9 cost time: 1.5957365036010742
Epoch: 9, Steps: 4 | Train Loss: 1.242 Vali Loss: 1.495 Vali Acc: 0.380 Test Loss: 1.495 Test Acc: 0.380
Validation loss decreased (-0.379985 --> -0.379985).  Saving model ...
Epoch: 10 cost time: 1.7879607677459717
Epoch: 10, Steps: 4 | Train Loss: 1.131 Vali Loss: 1.475 Vali Acc: 0.340 Test Loss: 1.475 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6733546257019043
Epoch: 11, Steps: 4 | Train Loss: 1.105 Vali Loss: 1.460 Vali Acc: 0.360 Test Loss: 1.460 Test Acc: 0.360
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.6256320476531982
Epoch: 12, Steps: 4 | Train Loss: 1.146 Vali Loss: 1.455 Vali Acc: 0.440 Test Loss: 1.455 Test Acc: 0.440
Validation loss decreased (-0.379985 --> -0.439985).  Saving model ...
Epoch: 13 cost time: 1.8056156635284424
Epoch: 13, Steps: 4 | Train Loss: 0.974 Vali Loss: 1.420 Vali Acc: 0.440 Test Loss: 1.420 Test Acc: 0.440
Validation loss decreased (-0.439985 --> -0.439986).  Saving model ...
Epoch: 14 cost time: 1.6483769416809082
Epoch: 14, Steps: 4 | Train Loss: 0.841 Vali Loss: 1.379 Vali Acc: 0.480 Test Loss: 1.379 Test Acc: 0.480
Validation loss decreased (-0.439986 --> -0.479986).  Saving model ...
Epoch: 15 cost time: 1.741523027420044
Epoch: 15, Steps: 4 | Train Loss: 0.783 Vali Loss: 1.364 Vali Acc: 0.480 Test Loss: 1.364 Test Acc: 0.480
Validation loss decreased (-0.479986 --> -0.479986).  Saving model ...
Epoch: 16 cost time: 1.8003060817718506
Epoch: 16, Steps: 4 | Train Loss: 0.593 Vali Loss: 1.325 Vali Acc: 0.460 Test Loss: 1.325 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.8833544254302979
Epoch: 17, Steps: 4 | Train Loss: 0.660 Vali Loss: 1.374 Vali Acc: 0.440 Test Loss: 1.374 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.7944726943969727
Epoch: 18, Steps: 4 | Train Loss: 0.566 Vali Loss: 1.371 Vali Acc: 0.440 Test Loss: 1.371 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.6996707916259766
Epoch: 19, Steps: 4 | Train Loss: 0.407 Vali Loss: 1.346 Vali Acc: 0.480 Test Loss: 1.346 Test Acc: 0.480
Validation loss decreased (-0.479986 --> -0.479987).  Saving model ...
Epoch: 20 cost time: 1.7811863422393799
Epoch: 20, Steps: 4 | Train Loss: 0.730 Vali Loss: 1.375 Vali Acc: 0.440 Test Loss: 1.375 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.8636634349822998
Epoch: 21, Steps: 4 | Train Loss: 0.358 Vali Loss: 1.424 Vali Acc: 0.500 Test Loss: 1.424 Test Acc: 0.500
Validation loss decreased (-0.479987 --> -0.499986).  Saving model ...
Epoch: 22 cost time: 1.7764573097229004
Epoch: 22, Steps: 4 | Train Loss: 0.301 Vali Loss: 1.369 Vali Acc: 0.400 Test Loss: 1.369 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.7496569156646729
Epoch: 23, Steps: 4 | Train Loss: 0.270 Vali Loss: 1.459 Vali Acc: 0.380 Test Loss: 1.459 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.7902042865753174
Epoch: 24, Steps: 4 | Train Loss: 0.318 Vali Loss: 1.432 Vali Acc: 0.480 Test Loss: 1.432 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.8087422847747803
Epoch: 25, Steps: 4 | Train Loss: 0.209 Vali Loss: 1.401 Vali Acc: 0.440 Test Loss: 1.401 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.7556660175323486
Epoch: 26, Steps: 4 | Train Loss: 0.223 Vali Loss: 1.506 Vali Acc: 0.420 Test Loss: 1.506 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.826918125152588
Epoch: 27, Steps: 4 | Train Loss: 0.202 Vali Loss: 1.513 Vali Acc: 0.440 Test Loss: 1.513 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.7141094207763672
Epoch: 28, Steps: 4 | Train Loss: 0.359 Vali Loss: 1.522 Vali Acc: 0.420 Test Loss: 1.522 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.7413322925567627
Epoch: 29, Steps: 4 | Train Loss: 0.223 Vali Loss: 1.698 Vali Acc: 0.400 Test Loss: 1.698 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.9912779331207275
Epoch: 30, Steps: 4 | Train Loss: 0.165 Vali Loss: 1.785 Vali Acc: 0.360 Test Loss: 1.785 Test Acc: 0.360
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm8_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.5
model parameter : 215805
model size : 1.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm8_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.7385103702545166
Epoch: 1, Steps: 4 | Train Loss: 1.592 Vali Loss: 1.579 Vali Acc: 0.240 Test Loss: 1.579 Test Acc: 0.240
Validation loss decreased (inf --> -0.239984).  Saving model ...
Epoch: 2 cost time: 1.6001687049865723
Epoch: 2, Steps: 4 | Train Loss: 1.610 Vali Loss: 1.571 Vali Acc: 0.280 Test Loss: 1.571 Test Acc: 0.280
Validation loss decreased (-0.239984 --> -0.279984).  Saving model ...
Epoch: 3 cost time: 1.7575123310089111
Epoch: 3, Steps: 4 | Train Loss: 1.500 Vali Loss: 1.556 Vali Acc: 0.280 Test Loss: 1.556 Test Acc: 0.280
Validation loss decreased (-0.279984 --> -0.279984).  Saving model ...
Epoch: 4 cost time: 1.5999984741210938
Epoch: 4, Steps: 4 | Train Loss: 1.416 Vali Loss: 1.536 Vali Acc: 0.300 Test Loss: 1.536 Test Acc: 0.300
Validation loss decreased (-0.279984 --> -0.299985).  Saving model ...
Epoch: 5 cost time: 1.695493221282959
Epoch: 5, Steps: 4 | Train Loss: 1.520 Vali Loss: 1.513 Vali Acc: 0.280 Test Loss: 1.513 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7299177646636963
Epoch: 6, Steps: 4 | Train Loss: 1.354 Vali Loss: 1.497 Vali Acc: 0.280 Test Loss: 1.497 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.7011761665344238
Epoch: 7, Steps: 4 | Train Loss: 1.224 Vali Loss: 1.480 Vali Acc: 0.240 Test Loss: 1.480 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.7288129329681396
Epoch: 8, Steps: 4 | Train Loss: 1.251 Vali Loss: 1.454 Vali Acc: 0.280 Test Loss: 1.454 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.6261835098266602
Epoch: 9, Steps: 4 | Train Loss: 1.130 Vali Loss: 1.417 Vali Acc: 0.300 Test Loss: 1.417 Test Acc: 0.300
Validation loss decreased (-0.299985 --> -0.299986).  Saving model ...
Epoch: 10 cost time: 1.5938174724578857
Epoch: 10, Steps: 4 | Train Loss: 1.058 Vali Loss: 1.387 Vali Acc: 0.260 Test Loss: 1.387 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6635677814483643
Epoch: 11, Steps: 4 | Train Loss: 1.088 Vali Loss: 1.364 Vali Acc: 0.340 Test Loss: 1.364 Test Acc: 0.340
Validation loss decreased (-0.299986 --> -0.339986).  Saving model ...
Epoch: 12 cost time: 1.5827741622924805
Epoch: 12, Steps: 4 | Train Loss: 0.820 Vali Loss: 1.332 Vali Acc: 0.400 Test Loss: 1.332 Test Acc: 0.400
Validation loss decreased (-0.339986 --> -0.399987).  Saving model ...
Epoch: 13 cost time: 1.8120038509368896
Epoch: 13, Steps: 4 | Train Loss: 0.775 Vali Loss: 1.284 Vali Acc: 0.420 Test Loss: 1.284 Test Acc: 0.420
Validation loss decreased (-0.399987 --> -0.419987).  Saving model ...
Epoch: 14 cost time: 1.5627174377441406
Epoch: 14, Steps: 4 | Train Loss: 0.686 Vali Loss: 1.226 Vali Acc: 0.460 Test Loss: 1.226 Test Acc: 0.460
Validation loss decreased (-0.419987 --> -0.459988).  Saving model ...
Epoch: 15 cost time: 1.746119499206543
Epoch: 15, Steps: 4 | Train Loss: 0.659 Vali Loss: 1.190 Vali Acc: 0.500 Test Loss: 1.190 Test Acc: 0.500
Validation loss decreased (-0.459988 --> -0.499988).  Saving model ...
Epoch: 16 cost time: 1.7038555145263672
Epoch: 16, Steps: 4 | Train Loss: 0.551 Vali Loss: 1.188 Vali Acc: 0.480 Test Loss: 1.188 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.5931904315948486
Epoch: 17, Steps: 4 | Train Loss: 0.539 Vali Loss: 1.147 Vali Acc: 0.440 Test Loss: 1.147 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.5720312595367432
Epoch: 18, Steps: 4 | Train Loss: 0.460 Vali Loss: 1.190 Vali Acc: 0.420 Test Loss: 1.190 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.6004679203033447
Epoch: 19, Steps: 4 | Train Loss: 0.342 Vali Loss: 1.183 Vali Acc: 0.440 Test Loss: 1.183 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.7726995944976807
Epoch: 20, Steps: 4 | Train Loss: 0.285 Vali Loss: 1.257 Vali Acc: 0.420 Test Loss: 1.257 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.767815113067627
Epoch: 21, Steps: 4 | Train Loss: 0.295 Vali Loss: 1.141 Vali Acc: 0.440 Test Loss: 1.141 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.799656867980957
Epoch: 22, Steps: 4 | Train Loss: 0.246 Vali Loss: 1.202 Vali Acc: 0.480 Test Loss: 1.202 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.6818971633911133
Epoch: 23, Steps: 4 | Train Loss: 0.245 Vali Loss: 1.281 Vali Acc: 0.420 Test Loss: 1.281 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.6788928508758545
Epoch: 24, Steps: 4 | Train Loss: 0.220 Vali Loss: 1.360 Vali Acc: 0.500 Test Loss: 1.360 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.6561338901519775
Epoch: 25, Steps: 4 | Train Loss: 0.485 Vali Loss: 1.256 Vali Acc: 0.480 Test Loss: 1.256 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm8_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.5
model parameter : 629821
model size : 2.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm8_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.127671718597412
Epoch: 1, Steps: 4 | Train Loss: 1.671 Vali Loss: 1.702 Vali Acc: 0.280 Test Loss: 1.702 Test Acc: 0.280
Validation loss decreased (inf --> -0.279983).  Saving model ...
Epoch: 2 cost time: 1.3458826541900635
Epoch: 2, Steps: 4 | Train Loss: 1.681 Vali Loss: 1.684 Vali Acc: 0.240 Test Loss: 1.684 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3236753940582275
Epoch: 3, Steps: 4 | Train Loss: 1.553 Vali Loss: 1.658 Vali Acc: 0.260 Test Loss: 1.658 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.3236351013183594
Epoch: 4, Steps: 4 | Train Loss: 1.550 Vali Loss: 1.633 Vali Acc: 0.280 Test Loss: 1.633 Test Acc: 0.280
Validation loss decreased (-0.279983 --> -0.279984).  Saving model ...
Epoch: 5 cost time: 1.2772178649902344
Epoch: 5, Steps: 4 | Train Loss: 1.636 Vali Loss: 1.608 Vali Acc: 0.300 Test Loss: 1.608 Test Acc: 0.300
Validation loss decreased (-0.279984 --> -0.299984).  Saving model ...
Epoch: 6 cost time: 1.294292688369751
Epoch: 6, Steps: 4 | Train Loss: 1.452 Vali Loss: 1.579 Vali Acc: 0.340 Test Loss: 1.579 Test Acc: 0.340
Validation loss decreased (-0.299984 --> -0.339984).  Saving model ...
Epoch: 7 cost time: 1.4235219955444336
Epoch: 7, Steps: 4 | Train Loss: 1.371 Vali Loss: 1.551 Vali Acc: 0.380 Test Loss: 1.551 Test Acc: 0.380
Validation loss decreased (-0.339984 --> -0.379984).  Saving model ...
Epoch: 8 cost time: 1.3803739547729492
Epoch: 8, Steps: 4 | Train Loss: 1.386 Vali Loss: 1.530 Vali Acc: 0.400 Test Loss: 1.530 Test Acc: 0.400
Validation loss decreased (-0.379984 --> -0.399985).  Saving model ...
Epoch: 9 cost time: 1.357330083847046
Epoch: 9, Steps: 4 | Train Loss: 1.249 Vali Loss: 1.516 Vali Acc: 0.380 Test Loss: 1.516 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2973380088806152
Epoch: 10, Steps: 4 | Train Loss: 1.152 Vali Loss: 1.486 Vali Acc: 0.360 Test Loss: 1.486 Test Acc: 0.360
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.3363158702850342
Epoch: 11, Steps: 4 | Train Loss: 1.120 Vali Loss: 1.468 Vali Acc: 0.400 Test Loss: 1.468 Test Acc: 0.400
Validation loss decreased (-0.399985 --> -0.399985).  Saving model ...
Epoch: 12 cost time: 1.34671950340271
Epoch: 12, Steps: 4 | Train Loss: 1.153 Vali Loss: 1.476 Vali Acc: 0.480 Test Loss: 1.476 Test Acc: 0.480
Validation loss decreased (-0.399985 --> -0.479985).  Saving model ...
Epoch: 13 cost time: 1.281505823135376
Epoch: 13, Steps: 4 | Train Loss: 0.993 Vali Loss: 1.414 Vali Acc: 0.420 Test Loss: 1.414 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3753938674926758
Epoch: 14, Steps: 4 | Train Loss: 0.891 Vali Loss: 1.406 Vali Acc: 0.420 Test Loss: 1.406 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.380502462387085
Epoch: 15, Steps: 4 | Train Loss: 0.800 Vali Loss: 1.364 Vali Acc: 0.440 Test Loss: 1.364 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.360727310180664
Epoch: 16, Steps: 4 | Train Loss: 0.616 Vali Loss: 1.324 Vali Acc: 0.400 Test Loss: 1.324 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.4070122241973877
Epoch: 17, Steps: 4 | Train Loss: 0.674 Vali Loss: 1.368 Vali Acc: 0.440 Test Loss: 1.368 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.3349862098693848
Epoch: 18, Steps: 4 | Train Loss: 0.630 Vali Loss: 1.307 Vali Acc: 0.460 Test Loss: 1.307 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.3708930015563965
Epoch: 19, Steps: 4 | Train Loss: 0.446 Vali Loss: 1.332 Vali Acc: 0.460 Test Loss: 1.332 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.3045907020568848
Epoch: 20, Steps: 4 | Train Loss: 0.775 Vali Loss: 1.443 Vali Acc: 0.400 Test Loss: 1.443 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.3148078918457031
Epoch: 21, Steps: 4 | Train Loss: 0.393 Vali Loss: 1.299 Vali Acc: 0.440 Test Loss: 1.299 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.3575499057769775
Epoch: 22, Steps: 4 | Train Loss: 0.332 Vali Loss: 1.337 Vali Acc: 0.440 Test Loss: 1.337 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm8_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.48
model parameter : 215805
model size : 1.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm8_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.7259316444396973
Epoch: 1, Steps: 4 | Train Loss: 1.592 Vali Loss: 1.584 Vali Acc: 0.240 Test Loss: 1.584 Test Acc: 0.240
Validation loss decreased (inf --> -0.239984).  Saving model ...
Epoch: 2 cost time: 1.501957654953003
Epoch: 2, Steps: 4 | Train Loss: 1.606 Vali Loss: 1.576 Vali Acc: 0.280 Test Loss: 1.576 Test Acc: 0.280
Validation loss decreased (-0.239984 --> -0.279984).  Saving model ...
Epoch: 3 cost time: 1.3793480396270752
Epoch: 3, Steps: 4 | Train Loss: 1.499 Vali Loss: 1.562 Vali Acc: 0.260 Test Loss: 1.562 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.468839406967163
Epoch: 4, Steps: 4 | Train Loss: 1.430 Vali Loss: 1.543 Vali Acc: 0.280 Test Loss: 1.543 Test Acc: 0.280
Validation loss decreased (-0.279984 --> -0.279985).  Saving model ...
Epoch: 5 cost time: 1.363088846206665
Epoch: 5, Steps: 4 | Train Loss: 1.524 Vali Loss: 1.530 Vali Acc: 0.240 Test Loss: 1.530 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.516545057296753
Epoch: 6, Steps: 4 | Train Loss: 1.356 Vali Loss: 1.513 Vali Acc: 0.280 Test Loss: 1.513 Test Acc: 0.280
Validation loss decreased (-0.279985 --> -0.279985).  Saving model ...
Epoch: 7 cost time: 1.5499458312988281
Epoch: 7, Steps: 4 | Train Loss: 1.236 Vali Loss: 1.493 Vali Acc: 0.260 Test Loss: 1.493 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3460416793823242
Epoch: 8, Steps: 4 | Train Loss: 1.262 Vali Loss: 1.463 Vali Acc: 0.300 Test Loss: 1.463 Test Acc: 0.300
Validation loss decreased (-0.279985 --> -0.299985).  Saving model ...
Epoch: 9 cost time: 1.4805452823638916
Epoch: 9, Steps: 4 | Train Loss: 1.136 Vali Loss: 1.410 Vali Acc: 0.280 Test Loss: 1.410 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.407407522201538
Epoch: 10, Steps: 4 | Train Loss: 1.078 Vali Loss: 1.391 Vali Acc: 0.280 Test Loss: 1.391 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.4195301532745361
Epoch: 11, Steps: 4 | Train Loss: 1.125 Vali Loss: 1.366 Vali Acc: 0.300 Test Loss: 1.366 Test Acc: 0.300
Validation loss decreased (-0.299985 --> -0.299986).  Saving model ...
Epoch: 12 cost time: 1.424590826034546
Epoch: 12, Steps: 4 | Train Loss: 0.917 Vali Loss: 1.339 Vali Acc: 0.360 Test Loss: 1.339 Test Acc: 0.360
Validation loss decreased (-0.299986 --> -0.359987).  Saving model ...
Epoch: 13 cost time: 1.4288043975830078
Epoch: 13, Steps: 4 | Train Loss: 0.821 Vali Loss: 1.298 Vali Acc: 0.360 Test Loss: 1.298 Test Acc: 0.360
Validation loss decreased (-0.359987 --> -0.359987).  Saving model ...
Epoch: 14 cost time: 1.456780195236206
Epoch: 14, Steps: 4 | Train Loss: 0.735 Vali Loss: 1.256 Vali Acc: 0.420 Test Loss: 1.256 Test Acc: 0.420
Validation loss decreased (-0.359987 --> -0.419987).  Saving model ...
Epoch: 15 cost time: 1.403235912322998
Epoch: 15, Steps: 4 | Train Loss: 0.715 Vali Loss: 1.246 Vali Acc: 0.360 Test Loss: 1.246 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2378549575805664
Epoch: 16, Steps: 4 | Train Loss: 0.635 Vali Loss: 1.247 Vali Acc: 0.420 Test Loss: 1.247 Test Acc: 0.420
Validation loss decreased (-0.419987 --> -0.419988).  Saving model ...
Epoch: 17 cost time: 1.3777146339416504
Epoch: 17, Steps: 4 | Train Loss: 0.651 Vali Loss: 1.187 Vali Acc: 0.500 Test Loss: 1.187 Test Acc: 0.500
Validation loss decreased (-0.419988 --> -0.499988).  Saving model ...
Epoch: 18 cost time: 1.3743577003479004
Epoch: 18, Steps: 4 | Train Loss: 0.550 Vali Loss: 1.204 Vali Acc: 0.500 Test Loss: 1.204 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.4228243827819824
Epoch: 19, Steps: 4 | Train Loss: 0.453 Vali Loss: 1.200 Vali Acc: 0.480 Test Loss: 1.200 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.5078768730163574
Epoch: 20, Steps: 4 | Train Loss: 0.396 Vali Loss: 1.206 Vali Acc: 0.480 Test Loss: 1.206 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.4974348545074463
Epoch: 21, Steps: 4 | Train Loss: 0.385 Vali Loss: 1.122 Vali Acc: 0.500 Test Loss: 1.122 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499989).  Saving model ...
Epoch: 22 cost time: 1.5169000625610352
Epoch: 22, Steps: 4 | Train Loss: 0.326 Vali Loss: 1.104 Vali Acc: 0.500 Test Loss: 1.104 Test Acc: 0.500
Validation loss decreased (-0.499989 --> -0.499989).  Saving model ...
Epoch: 23 cost time: 1.492891550064087
Epoch: 23, Steps: 4 | Train Loss: 0.262 Vali Loss: 1.062 Vali Acc: 0.480 Test Loss: 1.062 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.5323512554168701
Epoch: 24, Steps: 4 | Train Loss: 0.234 Vali Loss: 1.130 Vali Acc: 0.480 Test Loss: 1.130 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.4735760688781738
Epoch: 25, Steps: 4 | Train Loss: 0.286 Vali Loss: 1.142 Vali Acc: 0.460 Test Loss: 1.142 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.5210134983062744
Epoch: 26, Steps: 4 | Train Loss: 0.200 Vali Loss: 1.193 Vali Acc: 0.460 Test Loss: 1.193 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.4179754257202148
Epoch: 27, Steps: 4 | Train Loss: 0.187 Vali Loss: 1.223 Vali Acc: 0.540 Test Loss: 1.223 Test Acc: 0.540
Validation loss decreased (-0.499989 --> -0.539988).  Saving model ...
Epoch: 28 cost time: 1.4269351959228516
Epoch: 28, Steps: 4 | Train Loss: 0.148 Vali Loss: 1.253 Vali Acc: 0.480 Test Loss: 1.253 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.5135478973388672
Epoch: 29, Steps: 4 | Train Loss: 0.193 Vali Loss: 1.271 Vali Acc: 0.520 Test Loss: 1.271 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.469341516494751
Epoch: 30, Steps: 4 | Train Loss: 0.179 Vali Loss: 1.282 Vali Acc: 0.460 Test Loss: 1.282 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm8_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 629821
model size : 2.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm8_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.3607940673828125
Epoch: 1, Steps: 4 | Train Loss: 1.695 Vali Loss: 1.725 Vali Acc: 0.200 Test Loss: 1.725 Test Acc: 0.200
Validation loss decreased (inf --> -0.199983).  Saving model ...
Epoch: 2 cost time: 1.4830129146575928
Epoch: 2, Steps: 4 | Train Loss: 1.688 Vali Loss: 1.693 Vali Acc: 0.280 Test Loss: 1.693 Test Acc: 0.280
Validation loss decreased (-0.199983 --> -0.279983).  Saving model ...
Epoch: 3 cost time: 1.3996706008911133
Epoch: 3, Steps: 4 | Train Loss: 1.555 Vali Loss: 1.674 Vali Acc: 0.320 Test Loss: 1.674 Test Acc: 0.320
Validation loss decreased (-0.279983 --> -0.319983).  Saving model ...
Epoch: 4 cost time: 1.3824446201324463
Epoch: 4, Steps: 4 | Train Loss: 1.541 Vali Loss: 1.650 Vali Acc: 0.360 Test Loss: 1.650 Test Acc: 0.360
Validation loss decreased (-0.319983 --> -0.359983).  Saving model ...
Epoch: 5 cost time: 1.2843668460845947
Epoch: 5, Steps: 4 | Train Loss: 1.674 Vali Loss: 1.609 Vali Acc: 0.360 Test Loss: 1.609 Test Acc: 0.360
Validation loss decreased (-0.359983 --> -0.359984).  Saving model ...
Epoch: 6 cost time: 1.264976978302002
Epoch: 6, Steps: 4 | Train Loss: 1.504 Vali Loss: 1.594 Vali Acc: 0.380 Test Loss: 1.594 Test Acc: 0.380
Validation loss decreased (-0.359984 --> -0.379984).  Saving model ...
Epoch: 7 cost time: 1.4131505489349365
Epoch: 7, Steps: 4 | Train Loss: 1.419 Vali Loss: 1.569 Vali Acc: 0.400 Test Loss: 1.569 Test Acc: 0.400
Validation loss decreased (-0.379984 --> -0.399984).  Saving model ...
Epoch: 8 cost time: 1.4006974697113037
Epoch: 8, Steps: 4 | Train Loss: 1.366 Vali Loss: 1.556 Vali Acc: 0.380 Test Loss: 1.556 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3358678817749023
Epoch: 9, Steps: 4 | Train Loss: 1.283 Vali Loss: 1.542 Vali Acc: 0.400 Test Loss: 1.542 Test Acc: 0.400
Validation loss decreased (-0.399984 --> -0.399985).  Saving model ...
Epoch: 10 cost time: 1.2726337909698486
Epoch: 10, Steps: 4 | Train Loss: 1.169 Vali Loss: 1.520 Vali Acc: 0.420 Test Loss: 1.520 Test Acc: 0.420
Validation loss decreased (-0.399985 --> -0.419985).  Saving model ...
Epoch: 11 cost time: 1.215193271636963
Epoch: 11, Steps: 4 | Train Loss: 1.148 Vali Loss: 1.498 Vali Acc: 0.480 Test Loss: 1.498 Test Acc: 0.480
Validation loss decreased (-0.419985 --> -0.479985).  Saving model ...
Epoch: 12 cost time: 1.2739264965057373
Epoch: 12, Steps: 4 | Train Loss: 1.209 Vali Loss: 1.479 Vali Acc: 0.460 Test Loss: 1.479 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.386453628540039
Epoch: 13, Steps: 4 | Train Loss: 1.035 Vali Loss: 1.463 Vali Acc: 0.420 Test Loss: 1.463 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.367616891860962
Epoch: 14, Steps: 4 | Train Loss: 0.960 Vali Loss: 1.448 Vali Acc: 0.460 Test Loss: 1.448 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.3198060989379883
Epoch: 15, Steps: 4 | Train Loss: 0.860 Vali Loss: 1.422 Vali Acc: 0.480 Test Loss: 1.422 Test Acc: 0.480
Validation loss decreased (-0.479985 --> -0.479986).  Saving model ...
Epoch: 16 cost time: 1.275968313217163
Epoch: 16, Steps: 4 | Train Loss: 0.678 Vali Loss: 1.364 Vali Acc: 0.480 Test Loss: 1.364 Test Acc: 0.480
Validation loss decreased (-0.479986 --> -0.479986).  Saving model ...
Epoch: 17 cost time: 1.3685708045959473
Epoch: 17, Steps: 4 | Train Loss: 0.731 Vali Loss: 1.379 Vali Acc: 0.440 Test Loss: 1.379 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.3051917552947998
Epoch: 18, Steps: 4 | Train Loss: 0.585 Vali Loss: 1.337 Vali Acc: 0.440 Test Loss: 1.337 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.3205640316009521
Epoch: 19, Steps: 4 | Train Loss: 0.487 Vali Loss: 1.328 Vali Acc: 0.400 Test Loss: 1.328 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.3707704544067383
Epoch: 20, Steps: 4 | Train Loss: 0.846 Vali Loss: 1.417 Vali Acc: 0.400 Test Loss: 1.417 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.4588215351104736
Epoch: 21, Steps: 4 | Train Loss: 0.403 Vali Loss: 1.345 Vali Acc: 0.480 Test Loss: 1.345 Test Acc: 0.480
Validation loss decreased (-0.479986 --> -0.479987).  Saving model ...
Epoch: 22 cost time: 1.4362730979919434
Epoch: 22, Steps: 4 | Train Loss: 0.409 Vali Loss: 1.291 Vali Acc: 0.500 Test Loss: 1.291 Test Acc: 0.500
Validation loss decreased (-0.479987 --> -0.499987).  Saving model ...
Epoch: 23 cost time: 1.3610625267028809
Epoch: 23, Steps: 4 | Train Loss: 0.378 Vali Loss: 1.381 Vali Acc: 0.440 Test Loss: 1.381 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.363330364227295
Epoch: 24, Steps: 4 | Train Loss: 0.281 Vali Loss: 1.321 Vali Acc: 0.460 Test Loss: 1.321 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.2426469326019287
Epoch: 25, Steps: 4 | Train Loss: 0.285 Vali Loss: 1.321 Vali Acc: 0.440 Test Loss: 1.321 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.4288887977600098
Epoch: 26, Steps: 4 | Train Loss: 0.331 Vali Loss: 1.369 Vali Acc: 0.480 Test Loss: 1.369 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.2780678272247314
Epoch: 27, Steps: 4 | Train Loss: 0.252 Vali Loss: 1.317 Vali Acc: 0.480 Test Loss: 1.317 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.3610453605651855
Epoch: 28, Steps: 4 | Train Loss: 0.451 Vali Loss: 1.408 Vali Acc: 0.460 Test Loss: 1.408 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.3070428371429443
Epoch: 29, Steps: 4 | Train Loss: 0.322 Vali Loss: 1.447 Vali Acc: 0.420 Test Loss: 1.447 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.306535005569458
Epoch: 30, Steps: 4 | Train Loss: 0.180 Vali Loss: 1.410 Vali Acc: 0.420 Test Loss: 1.410 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm8_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.5
model parameter : 215805
model size : 1.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm8_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.1716718673706055
Epoch: 1, Steps: 4 | Train Loss: 1.771 Vali Loss: 1.540 Vali Acc: 0.260 Test Loss: 1.540 Test Acc: 0.260
Validation loss decreased (inf --> -0.259985).  Saving model ...
Epoch: 2 cost time: 2.3544504642486572
Epoch: 2, Steps: 4 | Train Loss: 1.623 Vali Loss: 1.537 Vali Acc: 0.300 Test Loss: 1.537 Test Acc: 0.300
Validation loss decreased (-0.259985 --> -0.299985).  Saving model ...
Epoch: 3 cost time: 2.1052935123443604
Epoch: 3, Steps: 4 | Train Loss: 1.601 Vali Loss: 1.533 Vali Acc: 0.300 Test Loss: 1.533 Test Acc: 0.300
Validation loss decreased (-0.299985 --> -0.299985).  Saving model ...
Epoch: 4 cost time: 2.335085868835449
Epoch: 4, Steps: 4 | Train Loss: 1.554 Vali Loss: 1.526 Vali Acc: 0.300 Test Loss: 1.526 Test Acc: 0.300
Validation loss decreased (-0.299985 --> -0.299985).  Saving model ...
Epoch: 5 cost time: 2.1482160091400146
Epoch: 5, Steps: 4 | Train Loss: 1.563 Vali Loss: 1.521 Vali Acc: 0.280 Test Loss: 1.521 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.154012441635132
Epoch: 6, Steps: 4 | Train Loss: 1.515 Vali Loss: 1.520 Vali Acc: 0.300 Test Loss: 1.520 Test Acc: 0.300
Validation loss decreased (-0.299985 --> -0.299985).  Saving model ...
Epoch: 7 cost time: 2.288287878036499
Epoch: 7, Steps: 4 | Train Loss: 1.383 Vali Loss: 1.518 Vali Acc: 0.300 Test Loss: 1.518 Test Acc: 0.300
Validation loss decreased (-0.299985 --> -0.299985).  Saving model ...
Epoch: 8 cost time: 2.158250093460083
Epoch: 8, Steps: 4 | Train Loss: 1.280 Vali Loss: 1.517 Vali Acc: 0.300 Test Loss: 1.517 Test Acc: 0.300
Validation loss decreased (-0.299985 --> -0.299985).  Saving model ...
Epoch: 9 cost time: 2.284477710723877
Epoch: 9, Steps: 4 | Train Loss: 1.288 Vali Loss: 1.527 Vali Acc: 0.280 Test Loss: 1.527 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.1716902256011963
Epoch: 10, Steps: 4 | Train Loss: 1.169 Vali Loss: 1.527 Vali Acc: 0.320 Test Loss: 1.527 Test Acc: 0.320
Validation loss decreased (-0.299985 --> -0.319985).  Saving model ...
Epoch: 11 cost time: 2.1488165855407715
Epoch: 11, Steps: 4 | Train Loss: 1.204 Vali Loss: 1.506 Vali Acc: 0.360 Test Loss: 1.506 Test Acc: 0.360
Validation loss decreased (-0.319985 --> -0.359985).  Saving model ...
Epoch: 12 cost time: 1.8934729099273682
Epoch: 12, Steps: 4 | Train Loss: 1.120 Vali Loss: 1.473 Vali Acc: 0.360 Test Loss: 1.473 Test Acc: 0.360
Validation loss decreased (-0.359985 --> -0.359985).  Saving model ...
Epoch: 13 cost time: 1.8930068016052246
Epoch: 13, Steps: 4 | Train Loss: 0.914 Vali Loss: 1.455 Vali Acc: 0.400 Test Loss: 1.455 Test Acc: 0.400
Validation loss decreased (-0.359985 --> -0.399985).  Saving model ...
Epoch: 14 cost time: 2.059645175933838
Epoch: 14, Steps: 4 | Train Loss: 1.054 Vali Loss: 1.439 Vali Acc: 0.380 Test Loss: 1.439 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.220579147338867
Epoch: 15, Steps: 4 | Train Loss: 0.888 Vali Loss: 1.394 Vali Acc: 0.360 Test Loss: 1.394 Test Acc: 0.360
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.064643144607544
Epoch: 16, Steps: 4 | Train Loss: 0.733 Vali Loss: 1.378 Vali Acc: 0.380 Test Loss: 1.378 Test Acc: 0.380
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.109009027481079
Epoch: 17, Steps: 4 | Train Loss: 0.647 Vali Loss: 1.397 Vali Acc: 0.400 Test Loss: 1.397 Test Acc: 0.400
Validation loss decreased (-0.399985 --> -0.399986).  Saving model ...
Epoch: 18 cost time: 2.1962716579437256
Epoch: 18, Steps: 4 | Train Loss: 0.626 Vali Loss: 1.357 Vali Acc: 0.400 Test Loss: 1.357 Test Acc: 0.400
Validation loss decreased (-0.399986 --> -0.399986).  Saving model ...
Epoch: 19 cost time: 2.0426151752471924
Epoch: 19, Steps: 4 | Train Loss: 0.543 Vali Loss: 1.328 Vali Acc: 0.380 Test Loss: 1.328 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.0833656787872314
Epoch: 20, Steps: 4 | Train Loss: 0.462 Vali Loss: 1.268 Vali Acc: 0.380 Test Loss: 1.268 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.1222193241119385
Epoch: 21, Steps: 4 | Train Loss: 0.466 Vali Loss: 1.371 Vali Acc: 0.480 Test Loss: 1.371 Test Acc: 0.480
Validation loss decreased (-0.399986 --> -0.479986).  Saving model ...
Epoch: 22 cost time: 2.0862131118774414
Epoch: 22, Steps: 4 | Train Loss: 0.444 Vali Loss: 1.386 Vali Acc: 0.400 Test Loss: 1.386 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.054408073425293
Epoch: 23, Steps: 4 | Train Loss: 0.289 Vali Loss: 1.407 Vali Acc: 0.480 Test Loss: 1.407 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.028764486312866
Epoch: 24, Steps: 4 | Train Loss: 0.300 Vali Loss: 1.429 Vali Acc: 0.500 Test Loss: 1.429 Test Acc: 0.500
Validation loss decreased (-0.479986 --> -0.499986).  Saving model ...
Epoch: 25 cost time: 2.19560170173645
Epoch: 25, Steps: 4 | Train Loss: 0.304 Vali Loss: 1.449 Vali Acc: 0.460 Test Loss: 1.449 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.0509848594665527
Epoch: 26, Steps: 4 | Train Loss: 0.469 Vali Loss: 1.368 Vali Acc: 0.440 Test Loss: 1.368 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.111335515975952
Epoch: 27, Steps: 4 | Train Loss: 0.223 Vali Loss: 1.369 Vali Acc: 0.460 Test Loss: 1.369 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.0091278553009033
Epoch: 28, Steps: 4 | Train Loss: 0.424 Vali Loss: 1.312 Vali Acc: 0.480 Test Loss: 1.312 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.0435304641723633
Epoch: 29, Steps: 4 | Train Loss: 0.235 Vali Loss: 1.700 Vali Acc: 0.460 Test Loss: 1.700 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.191650152206421
Epoch: 30, Steps: 4 | Train Loss: 0.201 Vali Loss: 1.535 Vali Acc: 0.440 Test Loss: 1.535 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm8_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.5
model parameter : 336573
model size : 1.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm8_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.5102574825286865
Epoch: 1, Steps: 4 | Train Loss: 1.665 Vali Loss: 1.611 Vali Acc: 0.260 Test Loss: 1.611 Test Acc: 0.260
Validation loss decreased (inf --> -0.259984).  Saving model ...
Epoch: 2 cost time: 1.512300968170166
Epoch: 2, Steps: 4 | Train Loss: 1.550 Vali Loss: 1.607 Vali Acc: 0.260 Test Loss: 1.607 Test Acc: 0.260
Validation loss decreased (-0.259984 --> -0.259984).  Saving model ...
Epoch: 3 cost time: 1.5124452114105225
Epoch: 3, Steps: 4 | Train Loss: 1.621 Vali Loss: 1.595 Vali Acc: 0.260 Test Loss: 1.595 Test Acc: 0.260
Validation loss decreased (-0.259984 --> -0.259984).  Saving model ...
Epoch: 4 cost time: 1.5678834915161133
Epoch: 4, Steps: 4 | Train Loss: 1.556 Vali Loss: 1.582 Vali Acc: 0.240 Test Loss: 1.582 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4664161205291748
Epoch: 5, Steps: 4 | Train Loss: 1.457 Vali Loss: 1.568 Vali Acc: 0.260 Test Loss: 1.568 Test Acc: 0.260
Validation loss decreased (-0.259984 --> -0.259984).  Saving model ...
Epoch: 6 cost time: 1.6736369132995605
Epoch: 6, Steps: 4 | Train Loss: 1.386 Vali Loss: 1.556 Vali Acc: 0.280 Test Loss: 1.556 Test Acc: 0.280
Validation loss decreased (-0.259984 --> -0.279984).  Saving model ...
Epoch: 7 cost time: 1.5163280963897705
Epoch: 7, Steps: 4 | Train Loss: 1.333 Vali Loss: 1.538 Vali Acc: 0.300 Test Loss: 1.538 Test Acc: 0.300
Validation loss decreased (-0.279984 --> -0.299985).  Saving model ...
Epoch: 8 cost time: 1.673649787902832
Epoch: 8, Steps: 4 | Train Loss: 1.357 Vali Loss: 1.520 Vali Acc: 0.360 Test Loss: 1.520 Test Acc: 0.360
Validation loss decreased (-0.299985 --> -0.359985).  Saving model ...
Epoch: 9 cost time: 1.557826042175293
Epoch: 9, Steps: 4 | Train Loss: 1.300 Vali Loss: 1.508 Vali Acc: 0.400 Test Loss: 1.508 Test Acc: 0.400
Validation loss decreased (-0.359985 --> -0.399985).  Saving model ...
Epoch: 10 cost time: 1.698404312133789
Epoch: 10, Steps: 4 | Train Loss: 1.181 Vali Loss: 1.493 Vali Acc: 0.400 Test Loss: 1.493 Test Acc: 0.400
Validation loss decreased (-0.399985 --> -0.399985).  Saving model ...
Epoch: 11 cost time: 1.5002355575561523
Epoch: 11, Steps: 4 | Train Loss: 1.029 Vali Loss: 1.480 Vali Acc: 0.420 Test Loss: 1.480 Test Acc: 0.420
Validation loss decreased (-0.399985 --> -0.419985).  Saving model ...
Epoch: 12 cost time: 1.5855984687805176
Epoch: 12, Steps: 4 | Train Loss: 0.936 Vali Loss: 1.479 Vali Acc: 0.460 Test Loss: 1.479 Test Acc: 0.460
Validation loss decreased (-0.419985 --> -0.459985).  Saving model ...
Epoch: 13 cost time: 1.55269455909729
Epoch: 13, Steps: 4 | Train Loss: 0.971 Vali Loss: 1.482 Vali Acc: 0.480 Test Loss: 1.482 Test Acc: 0.480
Validation loss decreased (-0.459985 --> -0.479985).  Saving model ...
Epoch: 14 cost time: 1.6020374298095703
Epoch: 14, Steps: 4 | Train Loss: 0.812 Vali Loss: 1.456 Vali Acc: 0.460 Test Loss: 1.456 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.5897338390350342
Epoch: 15, Steps: 4 | Train Loss: 0.803 Vali Loss: 1.428 Vali Acc: 0.460 Test Loss: 1.428 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.580723524093628
Epoch: 16, Steps: 4 | Train Loss: 0.756 Vali Loss: 1.410 Vali Acc: 0.400 Test Loss: 1.410 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.7436578273773193
Epoch: 17, Steps: 4 | Train Loss: 0.642 Vali Loss: 1.411 Vali Acc: 0.460 Test Loss: 1.411 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.5987682342529297
Epoch: 18, Steps: 4 | Train Loss: 0.519 Vali Loss: 1.376 Vali Acc: 0.480 Test Loss: 1.376 Test Acc: 0.480
Validation loss decreased (-0.479985 --> -0.479986).  Saving model ...
Epoch: 19 cost time: 1.6319434642791748
Epoch: 19, Steps: 4 | Train Loss: 0.523 Vali Loss: 1.362 Vali Acc: 0.440 Test Loss: 1.362 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.6945066452026367
Epoch: 20, Steps: 4 | Train Loss: 0.431 Vali Loss: 1.330 Vali Acc: 0.420 Test Loss: 1.330 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.5820515155792236
Epoch: 21, Steps: 4 | Train Loss: 0.538 Vali Loss: 1.317 Vali Acc: 0.480 Test Loss: 1.317 Test Acc: 0.480
Validation loss decreased (-0.479986 --> -0.479987).  Saving model ...
Epoch: 22 cost time: 1.5359182357788086
Epoch: 22, Steps: 4 | Train Loss: 0.332 Vali Loss: 1.312 Vali Acc: 0.480 Test Loss: 1.312 Test Acc: 0.480
Validation loss decreased (-0.479987 --> -0.479987).  Saving model ...
Epoch: 23 cost time: 1.690291166305542
Epoch: 23, Steps: 4 | Train Loss: 0.348 Vali Loss: 1.273 Vali Acc: 0.480 Test Loss: 1.273 Test Acc: 0.480
Validation loss decreased (-0.479987 --> -0.479987).  Saving model ...
Epoch: 24 cost time: 1.6306040287017822
Epoch: 24, Steps: 4 | Train Loss: 0.258 Vali Loss: 1.218 Vali Acc: 0.500 Test Loss: 1.218 Test Acc: 0.500
Validation loss decreased (-0.479987 --> -0.499988).  Saving model ...
Epoch: 25 cost time: 1.7157785892486572
Epoch: 25, Steps: 4 | Train Loss: 0.286 Vali Loss: 1.224 Vali Acc: 0.480 Test Loss: 1.224 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.5368645191192627
Epoch: 26, Steps: 4 | Train Loss: 0.217 Vali Loss: 1.324 Vali Acc: 0.500 Test Loss: 1.324 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.6908085346221924
Epoch: 27, Steps: 4 | Train Loss: 0.229 Vali Loss: 1.340 Vali Acc: 0.540 Test Loss: 1.340 Test Acc: 0.540
Validation loss decreased (-0.499988 --> -0.539987).  Saving model ...
Epoch: 28 cost time: 1.56998872756958
Epoch: 28, Steps: 4 | Train Loss: 0.171 Vali Loss: 1.237 Vali Acc: 0.520 Test Loss: 1.237 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.7123394012451172
Epoch: 29, Steps: 4 | Train Loss: 0.171 Vali Loss: 1.337 Vali Acc: 0.520 Test Loss: 1.337 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.6064503192901611
Epoch: 30, Steps: 4 | Train Loss: 0.159 Vali Loss: 1.355 Vali Acc: 0.460 Test Loss: 1.355 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm8_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 129533
model size : 0.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm8_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.7204208374023438
Epoch: 1, Steps: 4 | Train Loss: 1.767 Vali Loss: 1.535 Vali Acc: 0.240 Test Loss: 1.535 Test Acc: 0.240
Validation loss decreased (inf --> -0.239985).  Saving model ...
Epoch: 2 cost time: 1.514721155166626
Epoch: 2, Steps: 4 | Train Loss: 1.621 Vali Loss: 1.533 Vali Acc: 0.280 Test Loss: 1.533 Test Acc: 0.280
Validation loss decreased (-0.239985 --> -0.279985).  Saving model ...
Epoch: 3 cost time: 1.7332541942596436
Epoch: 3, Steps: 4 | Train Loss: 1.601 Vali Loss: 1.529 Vali Acc: 0.280 Test Loss: 1.529 Test Acc: 0.280
Validation loss decreased (-0.279985 --> -0.279985).  Saving model ...
Epoch: 4 cost time: 1.6480419635772705
Epoch: 4, Steps: 4 | Train Loss: 1.543 Vali Loss: 1.533 Vali Acc: 0.300 Test Loss: 1.533 Test Acc: 0.300
Validation loss decreased (-0.279985 --> -0.299985).  Saving model ...
Epoch: 5 cost time: 1.457054615020752
Epoch: 5, Steps: 4 | Train Loss: 1.558 Vali Loss: 1.529 Vali Acc: 0.280 Test Loss: 1.529 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.682676076889038
Epoch: 6, Steps: 4 | Train Loss: 1.513 Vali Loss: 1.527 Vali Acc: 0.280 Test Loss: 1.527 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.5208649635314941
Epoch: 7, Steps: 4 | Train Loss: 1.373 Vali Loss: 1.525 Vali Acc: 0.300 Test Loss: 1.525 Test Acc: 0.300
Validation loss decreased (-0.299985 --> -0.299985).  Saving model ...
Epoch: 8 cost time: 1.749894142150879
Epoch: 8, Steps: 4 | Train Loss: 1.282 Vali Loss: 1.524 Vali Acc: 0.280 Test Loss: 1.524 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.604154109954834
Epoch: 9, Steps: 4 | Train Loss: 1.282 Vali Loss: 1.532 Vali Acc: 0.300 Test Loss: 1.532 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.6255450248718262
Epoch: 10, Steps: 4 | Train Loss: 1.170 Vali Loss: 1.534 Vali Acc: 0.320 Test Loss: 1.534 Test Acc: 0.320
Validation loss decreased (-0.299985 --> -0.319985).  Saving model ...
Epoch: 11 cost time: 1.6764259338378906
Epoch: 11, Steps: 4 | Train Loss: 1.193 Vali Loss: 1.518 Vali Acc: 0.360 Test Loss: 1.518 Test Acc: 0.360
Validation loss decreased (-0.319985 --> -0.359985).  Saving model ...
Epoch: 12 cost time: 1.6400771141052246
Epoch: 12, Steps: 4 | Train Loss: 1.108 Vali Loss: 1.490 Vali Acc: 0.360 Test Loss: 1.490 Test Acc: 0.360
Validation loss decreased (-0.359985 --> -0.359985).  Saving model ...
Epoch: 13 cost time: 1.6327166557312012
Epoch: 13, Steps: 4 | Train Loss: 0.904 Vali Loss: 1.445 Vali Acc: 0.380 Test Loss: 1.445 Test Acc: 0.380
Validation loss decreased (-0.359985 --> -0.379986).  Saving model ...
Epoch: 14 cost time: 1.7429454326629639
Epoch: 14, Steps: 4 | Train Loss: 1.032 Vali Loss: 1.415 Vali Acc: 0.380 Test Loss: 1.415 Test Acc: 0.380
Validation loss decreased (-0.379986 --> -0.379986).  Saving model ...
Epoch: 15 cost time: 1.6578166484832764
Epoch: 15, Steps: 4 | Train Loss: 0.892 Vali Loss: 1.367 Vali Acc: 0.440 Test Loss: 1.367 Test Acc: 0.440
Validation loss decreased (-0.379986 --> -0.439986).  Saving model ...
Epoch: 16 cost time: 1.6061608791351318
Epoch: 16, Steps: 4 | Train Loss: 0.736 Vali Loss: 1.359 Vali Acc: 0.460 Test Loss: 1.359 Test Acc: 0.460
Validation loss decreased (-0.439986 --> -0.459986).  Saving model ...
Epoch: 17 cost time: 1.6839735507965088
Epoch: 17, Steps: 4 | Train Loss: 0.678 Vali Loss: 1.331 Vali Acc: 0.480 Test Loss: 1.331 Test Acc: 0.480
Validation loss decreased (-0.459986 --> -0.479987).  Saving model ...
Epoch: 18 cost time: 1.6246650218963623
Epoch: 18, Steps: 4 | Train Loss: 0.596 Vali Loss: 1.282 Vali Acc: 0.420 Test Loss: 1.282 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.641958475112915
Epoch: 19, Steps: 4 | Train Loss: 0.537 Vali Loss: 1.250 Vali Acc: 0.400 Test Loss: 1.250 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.7311646938323975
Epoch: 20, Steps: 4 | Train Loss: 0.523 Vali Loss: 1.210 Vali Acc: 0.460 Test Loss: 1.210 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.771270513534546
Epoch: 21, Steps: 4 | Train Loss: 0.448 Vali Loss: 1.187 Vali Acc: 0.460 Test Loss: 1.187 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.8369202613830566
Epoch: 22, Steps: 4 | Train Loss: 0.482 Vali Loss: 1.204 Vali Acc: 0.460 Test Loss: 1.204 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.878575325012207
Epoch: 23, Steps: 4 | Train Loss: 0.304 Vali Loss: 1.171 Vali Acc: 0.520 Test Loss: 1.171 Test Acc: 0.520
Validation loss decreased (-0.479987 --> -0.519988).  Saving model ...
Epoch: 24 cost time: 1.8153142929077148
Epoch: 24, Steps: 4 | Train Loss: 0.269 Vali Loss: 1.168 Vali Acc: 0.540 Test Loss: 1.168 Test Acc: 0.540
Validation loss decreased (-0.519988 --> -0.539988).  Saving model ...
Epoch: 25 cost time: 1.6992411613464355
Epoch: 25, Steps: 4 | Train Loss: 0.297 Vali Loss: 1.208 Vali Acc: 0.540 Test Loss: 1.208 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.8143842220306396
Epoch: 26, Steps: 4 | Train Loss: 0.400 Vali Loss: 1.213 Vali Acc: 0.540 Test Loss: 1.213 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.7589366436004639
Epoch: 27, Steps: 4 | Train Loss: 0.253 Vali Loss: 1.180 Vali Acc: 0.520 Test Loss: 1.180 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.7517409324645996
Epoch: 28, Steps: 4 | Train Loss: 0.207 Vali Loss: 1.197 Vali Acc: 0.520 Test Loss: 1.197 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.7017219066619873
Epoch: 29, Steps: 4 | Train Loss: 0.194 Vali Loss: 1.318 Vali Acc: 0.520 Test Loss: 1.318 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.7811217308044434
Epoch: 30, Steps: 4 | Train Loss: 0.253 Vali Loss: 1.193 Vali Acc: 0.540 Test Loss: 1.193 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm8_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 336573
model size : 1.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm8_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.44358491897583
Epoch: 1, Steps: 4 | Train Loss: 1.654 Vali Loss: 1.625 Vali Acc: 0.260 Test Loss: 1.625 Test Acc: 0.260
Validation loss decreased (inf --> -0.259984).  Saving model ...
Epoch: 2 cost time: 1.3779385089874268
Epoch: 2, Steps: 4 | Train Loss: 1.547 Vali Loss: 1.623 Vali Acc: 0.240 Test Loss: 1.623 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4573559761047363
Epoch: 3, Steps: 4 | Train Loss: 1.613 Vali Loss: 1.613 Vali Acc: 0.260 Test Loss: 1.613 Test Acc: 0.260
Validation loss decreased (-0.259984 --> -0.259984).  Saving model ...
Epoch: 4 cost time: 1.3009421825408936
Epoch: 4, Steps: 4 | Train Loss: 1.559 Vali Loss: 1.600 Vali Acc: 0.260 Test Loss: 1.600 Test Acc: 0.260
Validation loss decreased (-0.259984 --> -0.259984).  Saving model ...
Epoch: 5 cost time: 1.3956644535064697
Epoch: 5, Steps: 4 | Train Loss: 1.456 Vali Loss: 1.581 Vali Acc: 0.300 Test Loss: 1.581 Test Acc: 0.300
Validation loss decreased (-0.259984 --> -0.299984).  Saving model ...
Epoch: 6 cost time: 1.4343750476837158
Epoch: 6, Steps: 4 | Train Loss: 1.383 Vali Loss: 1.561 Vali Acc: 0.300 Test Loss: 1.561 Test Acc: 0.300
Validation loss decreased (-0.299984 --> -0.299984).  Saving model ...
Epoch: 7 cost time: 1.3361074924468994
Epoch: 7, Steps: 4 | Train Loss: 1.312 Vali Loss: 1.541 Vali Acc: 0.320 Test Loss: 1.541 Test Acc: 0.320
Validation loss decreased (-0.299984 --> -0.319985).  Saving model ...
Epoch: 8 cost time: 1.4918687343597412
Epoch: 8, Steps: 4 | Train Loss: 1.354 Vali Loss: 1.524 Vali Acc: 0.380 Test Loss: 1.524 Test Acc: 0.380
Validation loss decreased (-0.319985 --> -0.379985).  Saving model ...
Epoch: 9 cost time: 1.2481749057769775
Epoch: 9, Steps: 4 | Train Loss: 1.284 Vali Loss: 1.508 Vali Acc: 0.400 Test Loss: 1.508 Test Acc: 0.400
Validation loss decreased (-0.379985 --> -0.399985).  Saving model ...
Epoch: 10 cost time: 1.3966131210327148
Epoch: 10, Steps: 4 | Train Loss: 1.191 Vali Loss: 1.489 Vali Acc: 0.380 Test Loss: 1.489 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3453423976898193
Epoch: 11, Steps: 4 | Train Loss: 1.046 Vali Loss: 1.466 Vali Acc: 0.400 Test Loss: 1.466 Test Acc: 0.400
Validation loss decreased (-0.399985 --> -0.399985).  Saving model ...
Epoch: 12 cost time: 1.3755707740783691
Epoch: 12, Steps: 4 | Train Loss: 0.934 Vali Loss: 1.459 Vali Acc: 0.420 Test Loss: 1.459 Test Acc: 0.420
Validation loss decreased (-0.399985 --> -0.419985).  Saving model ...
Epoch: 13 cost time: 1.3387360572814941
Epoch: 13, Steps: 4 | Train Loss: 0.981 Vali Loss: 1.445 Vali Acc: 0.440 Test Loss: 1.445 Test Acc: 0.440
Validation loss decreased (-0.419985 --> -0.439986).  Saving model ...
Epoch: 14 cost time: 1.4405748844146729
Epoch: 14, Steps: 4 | Train Loss: 0.814 Vali Loss: 1.421 Vali Acc: 0.500 Test Loss: 1.421 Test Acc: 0.500
Validation loss decreased (-0.439986 --> -0.499986).  Saving model ...
Epoch: 15 cost time: 1.311784029006958
Epoch: 15, Steps: 4 | Train Loss: 0.803 Vali Loss: 1.398 Vali Acc: 0.460 Test Loss: 1.398 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.4681806564331055
Epoch: 16, Steps: 4 | Train Loss: 0.747 Vali Loss: 1.377 Vali Acc: 0.460 Test Loss: 1.377 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.2710323333740234
Epoch: 17, Steps: 4 | Train Loss: 0.643 Vali Loss: 1.365 Vali Acc: 0.460 Test Loss: 1.365 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.4662282466888428
Epoch: 18, Steps: 4 | Train Loss: 0.505 Vali Loss: 1.340 Vali Acc: 0.440 Test Loss: 1.340 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.4330363273620605
Epoch: 19, Steps: 4 | Train Loss: 0.505 Vali Loss: 1.330 Vali Acc: 0.480 Test Loss: 1.330 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.3481862545013428
Epoch: 20, Steps: 4 | Train Loss: 0.457 Vali Loss: 1.277 Vali Acc: 0.440 Test Loss: 1.277 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.4322142601013184
Epoch: 21, Steps: 4 | Train Loss: 0.556 Vali Loss: 1.256 Vali Acc: 0.500 Test Loss: 1.256 Test Acc: 0.500
Validation loss decreased (-0.499986 --> -0.499987).  Saving model ...
Epoch: 22 cost time: 1.381371021270752
Epoch: 22, Steps: 4 | Train Loss: 0.349 Vali Loss: 1.267 Vali Acc: 0.500 Test Loss: 1.267 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.32059907913208
Epoch: 23, Steps: 4 | Train Loss: 0.407 Vali Loss: 1.217 Vali Acc: 0.520 Test Loss: 1.217 Test Acc: 0.520
Validation loss decreased (-0.499987 --> -0.519988).  Saving model ...
Epoch: 24 cost time: 1.4376304149627686
Epoch: 24, Steps: 4 | Train Loss: 0.274 Vali Loss: 1.156 Vali Acc: 0.580 Test Loss: 1.156 Test Acc: 0.580
Validation loss decreased (-0.519988 --> -0.579988).  Saving model ...
Epoch: 25 cost time: 1.280775547027588
Epoch: 25, Steps: 4 | Train Loss: 0.255 Vali Loss: 1.172 Vali Acc: 0.540 Test Loss: 1.172 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.412104606628418
Epoch: 26, Steps: 4 | Train Loss: 0.218 Vali Loss: 1.273 Vali Acc: 0.540 Test Loss: 1.273 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.3541641235351562
Epoch: 27, Steps: 4 | Train Loss: 0.200 Vali Loss: 1.278 Vali Acc: 0.520 Test Loss: 1.278 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.3426153659820557
Epoch: 28, Steps: 4 | Train Loss: 0.148 Vali Loss: 1.196 Vali Acc: 0.540 Test Loss: 1.196 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.4226861000061035
Epoch: 29, Steps: 4 | Train Loss: 0.159 Vali Loss: 1.250 Vali Acc: 0.540 Test Loss: 1.250 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.3519647121429443
Epoch: 30, Steps: 4 | Train Loss: 0.168 Vali Loss: 1.292 Vali Acc: 0.540 Test Loss: 1.292 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm8_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 129533
model size : 0.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm8_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.3190126419067383
Epoch: 1, Steps: 4 | Train Loss: 1.779 Vali Loss: 1.541 Vali Acc: 0.300 Test Loss: 1.541 Test Acc: 0.300
Validation loss decreased (inf --> -0.299985).  Saving model ...
Epoch: 2 cost time: 1.3956334590911865
Epoch: 2, Steps: 4 | Train Loss: 1.627 Vali Loss: 1.538 Vali Acc: 0.300 Test Loss: 1.538 Test Acc: 0.300
Validation loss decreased (-0.299985 --> -0.299985).  Saving model ...
Epoch: 3 cost time: 1.497767448425293
Epoch: 3, Steps: 4 | Train Loss: 1.610 Vali Loss: 1.533 Vali Acc: 0.260 Test Loss: 1.533 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6975579261779785
Epoch: 4, Steps: 4 | Train Loss: 1.552 Vali Loss: 1.525 Vali Acc: 0.300 Test Loss: 1.525 Test Acc: 0.300
Validation loss decreased (-0.299985 --> -0.299985).  Saving model ...
Epoch: 5 cost time: 1.2614538669586182
Epoch: 5, Steps: 4 | Train Loss: 1.565 Vali Loss: 1.524 Vali Acc: 0.260 Test Loss: 1.524 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2970893383026123
Epoch: 6, Steps: 4 | Train Loss: 1.543 Vali Loss: 1.519 Vali Acc: 0.300 Test Loss: 1.519 Test Acc: 0.300
Validation loss decreased (-0.299985 --> -0.299985).  Saving model ...
Epoch: 7 cost time: 1.273123025894165
Epoch: 7, Steps: 4 | Train Loss: 1.395 Vali Loss: 1.520 Vali Acc: 0.300 Test Loss: 1.520 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2167932987213135
Epoch: 8, Steps: 4 | Train Loss: 1.306 Vali Loss: 1.525 Vali Acc: 0.300 Test Loss: 1.525 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.318296194076538
Epoch: 9, Steps: 4 | Train Loss: 1.322 Vali Loss: 1.528 Vali Acc: 0.320 Test Loss: 1.528 Test Acc: 0.320
Validation loss decreased (-0.299985 --> -0.319985).  Saving model ...
Epoch: 10 cost time: 1.2479090690612793
Epoch: 10, Steps: 4 | Train Loss: 1.199 Vali Loss: 1.528 Vali Acc: 0.320 Test Loss: 1.528 Test Acc: 0.320
Validation loss decreased (-0.319985 --> -0.319985).  Saving model ...
Epoch: 11 cost time: 1.4516057968139648
Epoch: 11, Steps: 4 | Train Loss: 1.214 Vali Loss: 1.510 Vali Acc: 0.300 Test Loss: 1.510 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2501347064971924
Epoch: 12, Steps: 4 | Train Loss: 1.134 Vali Loss: 1.484 Vali Acc: 0.300 Test Loss: 1.484 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.2276990413665771
Epoch: 13, Steps: 4 | Train Loss: 0.931 Vali Loss: 1.456 Vali Acc: 0.340 Test Loss: 1.456 Test Acc: 0.340
Validation loss decreased (-0.319985 --> -0.339985).  Saving model ...
Epoch: 14 cost time: 1.6720445156097412
Epoch: 14, Steps: 4 | Train Loss: 1.067 Vali Loss: 1.437 Vali Acc: 0.380 Test Loss: 1.437 Test Acc: 0.380
Validation loss decreased (-0.339985 --> -0.379986).  Saving model ...
Epoch: 15 cost time: 1.322859525680542
Epoch: 15, Steps: 4 | Train Loss: 0.965 Vali Loss: 1.378 Vali Acc: 0.380 Test Loss: 1.378 Test Acc: 0.380
Validation loss decreased (-0.379986 --> -0.379986).  Saving model ...
Epoch: 16 cost time: 1.29160737991333
Epoch: 16, Steps: 4 | Train Loss: 0.788 Vali Loss: 1.328 Vali Acc: 0.380 Test Loss: 1.328 Test Acc: 0.380
Validation loss decreased (-0.379986 --> -0.379987).  Saving model ...
Epoch: 17 cost time: 1.264070749282837
Epoch: 17, Steps: 4 | Train Loss: 0.730 Vali Loss: 1.301 Vali Acc: 0.460 Test Loss: 1.301 Test Acc: 0.460
Validation loss decreased (-0.379987 --> -0.459987).  Saving model ...
Epoch: 18 cost time: 1.25614595413208
Epoch: 18, Steps: 4 | Train Loss: 0.661 Vali Loss: 1.235 Vali Acc: 0.460 Test Loss: 1.235 Test Acc: 0.460
Validation loss decreased (-0.459987 --> -0.459988).  Saving model ...
Epoch: 19 cost time: 1.3052637577056885
Epoch: 19, Steps: 4 | Train Loss: 0.606 Vali Loss: 1.203 Vali Acc: 0.480 Test Loss: 1.203 Test Acc: 0.480
Validation loss decreased (-0.459988 --> -0.479988).  Saving model ...
Epoch: 20 cost time: 1.2929069995880127
Epoch: 20, Steps: 4 | Train Loss: 0.535 Vali Loss: 1.207 Vali Acc: 0.500 Test Loss: 1.207 Test Acc: 0.500
Validation loss decreased (-0.479988 --> -0.499988).  Saving model ...
Epoch: 21 cost time: 1.40275239944458
Epoch: 21, Steps: 4 | Train Loss: 0.514 Vali Loss: 1.181 Vali Acc: 0.460 Test Loss: 1.181 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2860543727874756
Epoch: 22, Steps: 4 | Train Loss: 0.486 Vali Loss: 1.194 Vali Acc: 0.440 Test Loss: 1.194 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.251124382019043
Epoch: 23, Steps: 4 | Train Loss: 0.358 Vali Loss: 1.159 Vali Acc: 0.480 Test Loss: 1.159 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.4617624282836914
Epoch: 24, Steps: 4 | Train Loss: 0.310 Vali Loss: 1.163 Vali Acc: 0.480 Test Loss: 1.163 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.216460943222046
Epoch: 25, Steps: 4 | Train Loss: 0.337 Vali Loss: 1.256 Vali Acc: 0.520 Test Loss: 1.256 Test Acc: 0.520
Validation loss decreased (-0.499988 --> -0.519987).  Saving model ...
Epoch: 26 cost time: 1.2415473461151123
Epoch: 26, Steps: 4 | Train Loss: 0.411 Vali Loss: 1.272 Vali Acc: 0.480 Test Loss: 1.272 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.3030421733856201
Epoch: 27, Steps: 4 | Train Loss: 0.292 Vali Loss: 1.282 Vali Acc: 0.400 Test Loss: 1.282 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.2801392078399658
Epoch: 28, Steps: 4 | Train Loss: 0.295 Vali Loss: 1.248 Vali Acc: 0.460 Test Loss: 1.248 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.2786777019500732
Epoch: 29, Steps: 4 | Train Loss: 0.217 Vali Loss: 1.241 Vali Acc: 0.460 Test Loss: 1.241 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.4372692108154297
Epoch: 30, Steps: 4 | Train Loss: 0.193 Vali Loss: 1.192 Vali Acc: 0.540 Test Loss: 1.192 Test Acc: 0.540
Validation loss decreased (-0.519987 --> -0.539988).  Saving model ...
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm8_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 336573
model size : 1.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm8_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.8223512172698975
Epoch: 1, Steps: 4 | Train Loss: 1.641 Vali Loss: 1.621 Vali Acc: 0.220 Test Loss: 1.621 Test Acc: 0.220
Validation loss decreased (inf --> -0.219984).  Saving model ...
Epoch: 2 cost time: 1.1655404567718506
Epoch: 2, Steps: 4 | Train Loss: 1.575 Vali Loss: 1.616 Vali Acc: 0.260 Test Loss: 1.616 Test Acc: 0.260
Validation loss decreased (-0.219984 --> -0.259984).  Saving model ...
Epoch: 3 cost time: 1.1540777683258057
Epoch: 3, Steps: 4 | Train Loss: 1.638 Vali Loss: 1.605 Vali Acc: 0.260 Test Loss: 1.605 Test Acc: 0.260
Validation loss decreased (-0.259984 --> -0.259984).  Saving model ...
Epoch: 4 cost time: 1.2029945850372314
Epoch: 4, Steps: 4 | Train Loss: 1.540 Vali Loss: 1.590 Vali Acc: 0.340 Test Loss: 1.590 Test Acc: 0.340
Validation loss decreased (-0.259984 --> -0.339984).  Saving model ...
Epoch: 5 cost time: 1.193697214126587
Epoch: 5, Steps: 4 | Train Loss: 1.446 Vali Loss: 1.572 Vali Acc: 0.340 Test Loss: 1.572 Test Acc: 0.340
Validation loss decreased (-0.339984 --> -0.339984).  Saving model ...
Epoch: 6 cost time: 1.312070369720459
Epoch: 6, Steps: 4 | Train Loss: 1.410 Vali Loss: 1.561 Vali Acc: 0.320 Test Loss: 1.561 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.181910753250122
Epoch: 7, Steps: 4 | Train Loss: 1.326 Vali Loss: 1.543 Vali Acc: 0.260 Test Loss: 1.543 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.3354318141937256
Epoch: 8, Steps: 4 | Train Loss: 1.388 Vali Loss: 1.524 Vali Acc: 0.300 Test Loss: 1.524 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.1325030326843262
Epoch: 9, Steps: 4 | Train Loss: 1.310 Vali Loss: 1.510 Vali Acc: 0.300 Test Loss: 1.510 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.0459191799163818
Epoch: 10, Steps: 4 | Train Loss: 1.197 Vali Loss: 1.502 Vali Acc: 0.320 Test Loss: 1.502 Test Acc: 0.320
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.1790173053741455
Epoch: 11, Steps: 4 | Train Loss: 1.084 Vali Loss: 1.483 Vali Acc: 0.380 Test Loss: 1.483 Test Acc: 0.380
Validation loss decreased (-0.339984 --> -0.379985).  Saving model ...
Epoch: 12 cost time: 1.1067194938659668
Epoch: 12, Steps: 4 | Train Loss: 0.971 Vali Loss: 1.457 Vali Acc: 0.440 Test Loss: 1.457 Test Acc: 0.440
Validation loss decreased (-0.379985 --> -0.439985).  Saving model ...
Epoch: 13 cost time: 1.2152280807495117
Epoch: 13, Steps: 4 | Train Loss: 1.067 Vali Loss: 1.443 Vali Acc: 0.440 Test Loss: 1.443 Test Acc: 0.440
Validation loss decreased (-0.439985 --> -0.439986).  Saving model ...
Epoch: 14 cost time: 1.196357011795044
Epoch: 14, Steps: 4 | Train Loss: 0.860 Vali Loss: 1.403 Vali Acc: 0.440 Test Loss: 1.403 Test Acc: 0.440
Validation loss decreased (-0.439986 --> -0.439986).  Saving model ...
Epoch: 15 cost time: 1.2190320491790771
Epoch: 15, Steps: 4 | Train Loss: 0.808 Vali Loss: 1.384 Vali Acc: 0.460 Test Loss: 1.384 Test Acc: 0.460
Validation loss decreased (-0.439986 --> -0.459986).  Saving model ...
Epoch: 16 cost time: 1.1577105522155762
Epoch: 16, Steps: 4 | Train Loss: 0.800 Vali Loss: 1.383 Vali Acc: 0.460 Test Loss: 1.383 Test Acc: 0.460
Validation loss decreased (-0.459986 --> -0.459986).  Saving model ...
Epoch: 17 cost time: 1.217247724533081
Epoch: 17, Steps: 4 | Train Loss: 0.683 Vali Loss: 1.347 Vali Acc: 0.460 Test Loss: 1.347 Test Acc: 0.460
Validation loss decreased (-0.459986 --> -0.459987).  Saving model ...
Epoch: 18 cost time: 1.246730089187622
Epoch: 18, Steps: 4 | Train Loss: 0.574 Vali Loss: 1.302 Vali Acc: 0.480 Test Loss: 1.302 Test Acc: 0.480
Validation loss decreased (-0.459987 --> -0.479987).  Saving model ...
Epoch: 19 cost time: 1.2490558624267578
Epoch: 19, Steps: 4 | Train Loss: 0.644 Vali Loss: 1.308 Vali Acc: 0.460 Test Loss: 1.308 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.3173604011535645
Epoch: 20, Steps: 4 | Train Loss: 0.502 Vali Loss: 1.236 Vali Acc: 0.500 Test Loss: 1.236 Test Acc: 0.500
Validation loss decreased (-0.479987 --> -0.499988).  Saving model ...
Epoch: 21 cost time: 1.1868150234222412
Epoch: 21, Steps: 4 | Train Loss: 0.588 Vali Loss: 1.205 Vali Acc: 0.500 Test Loss: 1.205 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 22 cost time: 1.246016263961792
Epoch: 22, Steps: 4 | Train Loss: 0.408 Vali Loss: 1.200 Vali Acc: 0.520 Test Loss: 1.200 Test Acc: 0.520
Validation loss decreased (-0.499988 --> -0.519988).  Saving model ...
Epoch: 23 cost time: 1.1940350532531738
Epoch: 23, Steps: 4 | Train Loss: 0.434 Vali Loss: 1.156 Vali Acc: 0.520 Test Loss: 1.156 Test Acc: 0.520
Validation loss decreased (-0.519988 --> -0.519988).  Saving model ...
Epoch: 24 cost time: 1.2279226779937744
Epoch: 24, Steps: 4 | Train Loss: 0.319 Vali Loss: 1.135 Vali Acc: 0.520 Test Loss: 1.135 Test Acc: 0.520
Validation loss decreased (-0.519988 --> -0.519989).  Saving model ...
Epoch: 25 cost time: 1.1285467147827148
Epoch: 25, Steps: 4 | Train Loss: 0.328 Vali Loss: 1.131 Vali Acc: 0.480 Test Loss: 1.131 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.2386102676391602
Epoch: 26, Steps: 4 | Train Loss: 0.282 Vali Loss: 1.166 Vali Acc: 0.520 Test Loss: 1.166 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.243567705154419
Epoch: 27, Steps: 4 | Train Loss: 0.255 Vali Loss: 1.231 Vali Acc: 0.480 Test Loss: 1.231 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.2215120792388916
Epoch: 28, Steps: 4 | Train Loss: 0.216 Vali Loss: 1.149 Vali Acc: 0.520 Test Loss: 1.149 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.212385892868042
Epoch: 29, Steps: 4 | Train Loss: 0.240 Vali Loss: 1.163 Vali Acc: 0.580 Test Loss: 1.163 Test Acc: 0.580
Validation loss decreased (-0.519989 --> -0.579988).  Saving model ...
Epoch: 30 cost time: 1.1777000427246094
Epoch: 30, Steps: 4 | Train Loss: 0.215 Vali Loss: 1.176 Vali Acc: 0.500 Test Loss: 1.176 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el4_dm8_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 129533
model size : 0.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm128_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 15.765836715698242
Epoch: 1, Steps: 4 | Train Loss: 1.705 Vali Loss: 1.565 Vali Acc: 0.360 Test Loss: 1.565 Test Acc: 0.360
Validation loss decreased (inf --> -0.359984).  Saving model ...
Epoch: 2 cost time: 14.091567993164062
Epoch: 2, Steps: 4 | Train Loss: 1.544 Vali Loss: 1.549 Vali Acc: 0.340 Test Loss: 1.549 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 14.172455787658691
Epoch: 3, Steps: 4 | Train Loss: 1.298 Vali Loss: 1.485 Vali Acc: 0.400 Test Loss: 1.485 Test Acc: 0.400
Validation loss decreased (-0.359984 --> -0.399985).  Saving model ...
Epoch: 4 cost time: 13.93030858039856
Epoch: 4, Steps: 4 | Train Loss: 0.987 Vali Loss: 1.398 Vali Acc: 0.440 Test Loss: 1.398 Test Acc: 0.440
Validation loss decreased (-0.399985 --> -0.439986).  Saving model ...
Epoch: 5 cost time: 14.810091257095337
Epoch: 5, Steps: 4 | Train Loss: 0.636 Vali Loss: 1.303 Vali Acc: 0.480 Test Loss: 1.303 Test Acc: 0.480
Validation loss decreased (-0.439986 --> -0.479987).  Saving model ...
Epoch: 6 cost time: 14.596993207931519
Epoch: 6, Steps: 4 | Train Loss: 0.458 Vali Loss: 1.403 Vali Acc: 0.460 Test Loss: 1.403 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 14.487799167633057
Epoch: 7, Steps: 4 | Train Loss: 0.472 Vali Loss: 1.334 Vali Acc: 0.560 Test Loss: 1.334 Test Acc: 0.560
Validation loss decreased (-0.479987 --> -0.559987).  Saving model ...
Epoch: 8 cost time: 14.69469165802002
Epoch: 8, Steps: 4 | Train Loss: 0.381 Vali Loss: 1.252 Vali Acc: 0.540 Test Loss: 1.252 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 13.06383752822876
Epoch: 9, Steps: 4 | Train Loss: 0.145 Vali Loss: 1.518 Vali Acc: 0.480 Test Loss: 1.518 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 13.922359228134155
Epoch: 10, Steps: 4 | Train Loss: 0.127 Vali Loss: 1.585 Vali Acc: 0.560 Test Loss: 1.585 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 13.964650630950928
Epoch: 11, Steps: 4 | Train Loss: 0.124 Vali Loss: 1.435 Vali Acc: 0.560 Test Loss: 1.435 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 13.422955751419067
Epoch: 12, Steps: 4 | Train Loss: 0.034 Vali Loss: 1.461 Vali Acc: 0.580 Test Loss: 1.461 Test Acc: 0.580
Validation loss decreased (-0.559987 --> -0.579985).  Saving model ...
Epoch: 13 cost time: 13.695225477218628
Epoch: 13, Steps: 4 | Train Loss: 0.065 Vali Loss: 1.438 Vali Acc: 0.580 Test Loss: 1.438 Test Acc: 0.580
Validation loss decreased (-0.579985 --> -0.579986).  Saving model ...
Epoch: 14 cost time: 13.88224458694458
Epoch: 14, Steps: 4 | Train Loss: 0.011 Vali Loss: 1.442 Vali Acc: 0.540 Test Loss: 1.442 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 13.812866926193237
Epoch: 15, Steps: 4 | Train Loss: 0.010 Vali Loss: 1.506 Vali Acc: 0.560 Test Loss: 1.506 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 13.59529161453247
Epoch: 16, Steps: 4 | Train Loss: 0.006 Vali Loss: 1.589 Vali Acc: 0.520 Test Loss: 1.589 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 13.857197761535645
Epoch: 17, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.815 Vali Acc: 0.520 Test Loss: 1.815 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 14.930152893066406
Epoch: 18, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.998 Vali Acc: 0.520 Test Loss: 1.998 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 14.5308096408844
Epoch: 19, Steps: 4 | Train Loss: 0.066 Vali Loss: 2.023 Vali Acc: 0.520 Test Loss: 2.023 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 14.601344347000122
Epoch: 20, Steps: 4 | Train Loss: 0.004 Vali Loss: 2.034 Vali Acc: 0.520 Test Loss: 2.034 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 14.956343173980713
Epoch: 21, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.999 Vali Acc: 0.500 Test Loss: 1.999 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 14.59715461730957
Epoch: 22, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.793 Vali Acc: 0.520 Test Loss: 1.793 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 13.916207551956177
Epoch: 23, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.653 Vali Acc: 0.500 Test Loss: 1.653 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm128_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 56926853
model size : 219.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm128_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 7.150622844696045
Epoch: 1, Steps: 4 | Train Loss: 1.628 Vali Loss: 1.607 Vali Acc: 0.280 Test Loss: 1.607 Test Acc: 0.280
Validation loss decreased (inf --> -0.279984).  Saving model ...
Epoch: 2 cost time: 5.540616750717163
Epoch: 2, Steps: 4 | Train Loss: 1.574 Vali Loss: 1.581 Vali Acc: 0.340 Test Loss: 1.581 Test Acc: 0.340
Validation loss decreased (-0.279984 --> -0.339984).  Saving model ...
Epoch: 3 cost time: 5.724972486495972
Epoch: 3, Steps: 4 | Train Loss: 1.336 Vali Loss: 1.462 Vali Acc: 0.380 Test Loss: 1.462 Test Acc: 0.380
Validation loss decreased (-0.339984 --> -0.379985).  Saving model ...
Epoch: 4 cost time: 5.851558446884155
Epoch: 4, Steps: 4 | Train Loss: 0.893 Vali Loss: 1.365 Vali Acc: 0.480 Test Loss: 1.365 Test Acc: 0.480
Validation loss decreased (-0.379985 --> -0.479986).  Saving model ...
Epoch: 5 cost time: 5.810676574707031
Epoch: 5, Steps: 4 | Train Loss: 0.672 Vali Loss: 1.363 Vali Acc: 0.440 Test Loss: 1.363 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.698091506958008
Epoch: 6, Steps: 4 | Train Loss: 0.702 Vali Loss: 1.194 Vali Acc: 0.540 Test Loss: 1.194 Test Acc: 0.540
Validation loss decreased (-0.479986 --> -0.539988).  Saving model ...
Epoch: 7 cost time: 5.5999181270599365
Epoch: 7, Steps: 4 | Train Loss: 0.266 Vali Loss: 1.129 Vali Acc: 0.520 Test Loss: 1.129 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.618255138397217
Epoch: 8, Steps: 4 | Train Loss: 0.172 Vali Loss: 1.166 Vali Acc: 0.540 Test Loss: 1.166 Test Acc: 0.540
Validation loss decreased (-0.539988 --> -0.539988).  Saving model ...
Epoch: 9 cost time: 5.720002174377441
Epoch: 9, Steps: 4 | Train Loss: 0.126 Vali Loss: 1.145 Vali Acc: 0.600 Test Loss: 1.145 Test Acc: 0.600
Validation loss decreased (-0.539988 --> -0.599989).  Saving model ...
Epoch: 10 cost time: 5.835098028182983
Epoch: 10, Steps: 4 | Train Loss: 0.072 Vali Loss: 1.179 Vali Acc: 0.560 Test Loss: 1.179 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.4246039390563965
Epoch: 11, Steps: 4 | Train Loss: 0.055 Vali Loss: 1.103 Vali Acc: 0.520 Test Loss: 1.103 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.135838508605957
Epoch: 12, Steps: 4 | Train Loss: 0.019 Vali Loss: 1.265 Vali Acc: 0.560 Test Loss: 1.265 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.55798864364624
Epoch: 13, Steps: 4 | Train Loss: 0.014 Vali Loss: 1.288 Vali Acc: 0.540 Test Loss: 1.288 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 5.677396535873413
Epoch: 14, Steps: 4 | Train Loss: 0.008 Vali Loss: 1.397 Vali Acc: 0.560 Test Loss: 1.397 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 5.369955778121948
Epoch: 15, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.552 Vali Acc: 0.540 Test Loss: 1.552 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 5.559375286102295
Epoch: 16, Steps: 4 | Train Loss: 0.006 Vali Loss: 1.391 Vali Acc: 0.500 Test Loss: 1.391 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 5.474457025527954
Epoch: 17, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.269 Vali Acc: 0.540 Test Loss: 1.269 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 5.659527540206909
Epoch: 18, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.637 Vali Acc: 0.520 Test Loss: 1.637 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 5.525953531265259
Epoch: 19, Steps: 4 | Train Loss: 0.292 Vali Loss: 1.825 Vali Acc: 0.520 Test Loss: 1.825 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm128_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 17209733
model size : 68.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm128_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 12.84067416191101
Epoch: 1, Steps: 4 | Train Loss: 1.705 Vali Loss: 1.567 Vali Acc: 0.360 Test Loss: 1.567 Test Acc: 0.360
Validation loss decreased (inf --> -0.359984).  Saving model ...
Epoch: 2 cost time: 10.277419328689575
Epoch: 2, Steps: 4 | Train Loss: 1.546 Vali Loss: 1.552 Vali Acc: 0.320 Test Loss: 1.552 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 10.190175771713257
Epoch: 3, Steps: 4 | Train Loss: 1.298 Vali Loss: 1.488 Vali Acc: 0.400 Test Loss: 1.488 Test Acc: 0.400
Validation loss decreased (-0.359984 --> -0.399985).  Saving model ...
Epoch: 4 cost time: 10.340468406677246
Epoch: 4, Steps: 4 | Train Loss: 0.986 Vali Loss: 1.403 Vali Acc: 0.440 Test Loss: 1.403 Test Acc: 0.440
Validation loss decreased (-0.399985 --> -0.439986).  Saving model ...
Epoch: 5 cost time: 10.321008443832397
Epoch: 5, Steps: 4 | Train Loss: 0.635 Vali Loss: 1.308 Vali Acc: 0.500 Test Loss: 1.308 Test Acc: 0.500
Validation loss decreased (-0.439986 --> -0.499987).  Saving model ...
Epoch: 6 cost time: 9.487934589385986
Epoch: 6, Steps: 4 | Train Loss: 0.459 Vali Loss: 1.410 Vali Acc: 0.440 Test Loss: 1.410 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 10.685700416564941
Epoch: 7, Steps: 4 | Train Loss: 0.469 Vali Loss: 1.339 Vali Acc: 0.540 Test Loss: 1.339 Test Acc: 0.540
Validation loss decreased (-0.499987 --> -0.539987).  Saving model ...
Epoch: 8 cost time: 10.558331489562988
Epoch: 8, Steps: 4 | Train Loss: 0.387 Vali Loss: 1.249 Vali Acc: 0.580 Test Loss: 1.249 Test Acc: 0.580
Validation loss decreased (-0.539987 --> -0.579988).  Saving model ...
Epoch: 9 cost time: 10.629455804824829
Epoch: 9, Steps: 4 | Train Loss: 0.145 Vali Loss: 1.521 Vali Acc: 0.500 Test Loss: 1.521 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 10.59034013748169
Epoch: 10, Steps: 4 | Train Loss: 0.119 Vali Loss: 1.623 Vali Acc: 0.540 Test Loss: 1.623 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 11.074101209640503
Epoch: 11, Steps: 4 | Train Loss: 0.107 Vali Loss: 1.405 Vali Acc: 0.560 Test Loss: 1.405 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 10.81241226196289
Epoch: 12, Steps: 4 | Train Loss: 0.036 Vali Loss: 1.370 Vali Acc: 0.600 Test Loss: 1.370 Test Acc: 0.600
Validation loss decreased (-0.579988 --> -0.599986).  Saving model ...
Epoch: 13 cost time: 11.016271829605103
Epoch: 13, Steps: 4 | Train Loss: 0.026 Vali Loss: 1.435 Vali Acc: 0.560 Test Loss: 1.435 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 10.855899572372437
Epoch: 14, Steps: 4 | Train Loss: 0.011 Vali Loss: 1.434 Vali Acc: 0.520 Test Loss: 1.434 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 11.048872232437134
Epoch: 15, Steps: 4 | Train Loss: 0.009 Vali Loss: 1.368 Vali Acc: 0.560 Test Loss: 1.368 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 10.858567476272583
Epoch: 16, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.371 Vali Acc: 0.580 Test Loss: 1.371 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 11.024626970291138
Epoch: 17, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.563 Vali Acc: 0.580 Test Loss: 1.563 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 11.165118217468262
Epoch: 18, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.686 Vali Acc: 0.580 Test Loss: 1.686 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 9.79257607460022
Epoch: 19, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.695 Vali Acc: 0.540 Test Loss: 1.695 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 10.924963474273682
Epoch: 20, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.719 Vali Acc: 0.540 Test Loss: 1.719 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 10.889381885528564
Epoch: 21, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.823 Vali Acc: 0.560 Test Loss: 1.823 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 10.895819187164307
Epoch: 22, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.790 Vali Acc: 0.580 Test Loss: 1.790 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm128_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 56926853
model size : 219.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm128_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 6.462084531784058
Epoch: 1, Steps: 4 | Train Loss: 1.628 Vali Loss: 1.607 Vali Acc: 0.280 Test Loss: 1.607 Test Acc: 0.280
Validation loss decreased (inf --> -0.279984).  Saving model ...
Epoch: 2 cost time: 4.71065616607666
Epoch: 2, Steps: 4 | Train Loss: 1.569 Vali Loss: 1.582 Vali Acc: 0.340 Test Loss: 1.582 Test Acc: 0.340
Validation loss decreased (-0.279984 --> -0.339984).  Saving model ...
Epoch: 3 cost time: 4.538491249084473
Epoch: 3, Steps: 4 | Train Loss: 1.334 Vali Loss: 1.466 Vali Acc: 0.380 Test Loss: 1.466 Test Acc: 0.380
Validation loss decreased (-0.339984 --> -0.379985).  Saving model ...
Epoch: 4 cost time: 4.769025087356567
Epoch: 4, Steps: 4 | Train Loss: 0.892 Vali Loss: 1.371 Vali Acc: 0.460 Test Loss: 1.371 Test Acc: 0.460
Validation loss decreased (-0.379985 --> -0.459986).  Saving model ...
Epoch: 5 cost time: 4.621949195861816
Epoch: 5, Steps: 4 | Train Loss: 0.672 Vali Loss: 1.373 Vali Acc: 0.440 Test Loss: 1.373 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.779817342758179
Epoch: 6, Steps: 4 | Train Loss: 0.698 Vali Loss: 1.203 Vali Acc: 0.520 Test Loss: 1.203 Test Acc: 0.520
Validation loss decreased (-0.459986 --> -0.519988).  Saving model ...
Epoch: 7 cost time: 4.596713542938232
Epoch: 7, Steps: 4 | Train Loss: 0.266 Vali Loss: 1.146 Vali Acc: 0.500 Test Loss: 1.146 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.593243360519409
Epoch: 8, Steps: 4 | Train Loss: 0.172 Vali Loss: 1.185 Vali Acc: 0.520 Test Loss: 1.185 Test Acc: 0.520
Validation loss decreased (-0.519988 --> -0.519988).  Saving model ...
Epoch: 9 cost time: 4.725336074829102
Epoch: 9, Steps: 4 | Train Loss: 0.126 Vali Loss: 1.171 Vali Acc: 0.560 Test Loss: 1.171 Test Acc: 0.560
Validation loss decreased (-0.519988 --> -0.559988).  Saving model ...
Epoch: 10 cost time: 4.5711822509765625
Epoch: 10, Steps: 4 | Train Loss: 0.073 Vali Loss: 1.197 Vali Acc: 0.540 Test Loss: 1.197 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.451819181442261
Epoch: 11, Steps: 4 | Train Loss: 0.054 Vali Loss: 1.122 Vali Acc: 0.500 Test Loss: 1.122 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.782171964645386
Epoch: 12, Steps: 4 | Train Loss: 0.018 Vali Loss: 1.288 Vali Acc: 0.560 Test Loss: 1.288 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.647005558013916
Epoch: 13, Steps: 4 | Train Loss: 0.015 Vali Loss: 1.264 Vali Acc: 0.520 Test Loss: 1.264 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.752197265625
Epoch: 14, Steps: 4 | Train Loss: 0.008 Vali Loss: 1.302 Vali Acc: 0.520 Test Loss: 1.302 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.703955411911011
Epoch: 15, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.488 Vali Acc: 0.560 Test Loss: 1.488 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.916259527206421
Epoch: 16, Steps: 4 | Train Loss: 0.006 Vali Loss: 1.391 Vali Acc: 0.540 Test Loss: 1.391 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 4.672255992889404
Epoch: 17, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.179 Vali Acc: 0.560 Test Loss: 1.179 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 4.796003580093384
Epoch: 18, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.632 Vali Acc: 0.480 Test Loss: 1.632 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 4.83501124382019
Epoch: 19, Steps: 4 | Train Loss: 0.682 Vali Loss: 1.796 Vali Acc: 0.500 Test Loss: 1.796 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm128_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 17209733
model size : 68.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm128_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 8.703795671463013
Epoch: 1, Steps: 4 | Train Loss: 1.706 Vali Loss: 1.568 Vali Acc: 0.360 Test Loss: 1.568 Test Acc: 0.360
Validation loss decreased (inf --> -0.359984).  Saving model ...
Epoch: 2 cost time: 7.174422979354858
Epoch: 2, Steps: 4 | Train Loss: 1.548 Vali Loss: 1.553 Vali Acc: 0.320 Test Loss: 1.553 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.064687013626099
Epoch: 3, Steps: 4 | Train Loss: 1.304 Vali Loss: 1.492 Vali Acc: 0.400 Test Loss: 1.492 Test Acc: 0.400
Validation loss decreased (-0.359984 --> -0.399985).  Saving model ...
Epoch: 4 cost time: 7.072190284729004
Epoch: 4, Steps: 4 | Train Loss: 0.996 Vali Loss: 1.404 Vali Acc: 0.400 Test Loss: 1.404 Test Acc: 0.400
Validation loss decreased (-0.399985 --> -0.399986).  Saving model ...
Epoch: 5 cost time: 7.0319085121154785
Epoch: 5, Steps: 4 | Train Loss: 0.654 Vali Loss: 1.311 Vali Acc: 0.480 Test Loss: 1.311 Test Acc: 0.480
Validation loss decreased (-0.399986 --> -0.479987).  Saving model ...
Epoch: 6 cost time: 7.110900402069092
Epoch: 6, Steps: 4 | Train Loss: 0.477 Vali Loss: 1.409 Vali Acc: 0.420 Test Loss: 1.409 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.605004787445068
Epoch: 7, Steps: 4 | Train Loss: 0.487 Vali Loss: 1.333 Vali Acc: 0.500 Test Loss: 1.333 Test Acc: 0.500
Validation loss decreased (-0.479987 --> -0.499987).  Saving model ...
Epoch: 8 cost time: 6.912325382232666
Epoch: 8, Steps: 4 | Train Loss: 0.405 Vali Loss: 1.240 Vali Acc: 0.540 Test Loss: 1.240 Test Acc: 0.540
Validation loss decreased (-0.499987 --> -0.539988).  Saving model ...
Epoch: 9 cost time: 6.884394645690918
Epoch: 9, Steps: 4 | Train Loss: 0.152 Vali Loss: 1.529 Vali Acc: 0.480 Test Loss: 1.529 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.933923006057739
Epoch: 10, Steps: 4 | Train Loss: 0.126 Vali Loss: 1.535 Vali Acc: 0.520 Test Loss: 1.535 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.9564735889434814
Epoch: 11, Steps: 4 | Train Loss: 0.108 Vali Loss: 1.371 Vali Acc: 0.520 Test Loss: 1.371 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 6.885990142822266
Epoch: 12, Steps: 4 | Train Loss: 0.039 Vali Loss: 1.471 Vali Acc: 0.600 Test Loss: 1.471 Test Acc: 0.600
Validation loss decreased (-0.539988 --> -0.599985).  Saving model ...
Epoch: 13 cost time: 6.904479742050171
Epoch: 13, Steps: 4 | Train Loss: 0.024 Vali Loss: 1.578 Vali Acc: 0.520 Test Loss: 1.578 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.892035722732544
Epoch: 14, Steps: 4 | Train Loss: 0.014 Vali Loss: 1.491 Vali Acc: 0.480 Test Loss: 1.491 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 6.905130863189697
Epoch: 15, Steps: 4 | Train Loss: 0.008 Vali Loss: 1.358 Vali Acc: 0.540 Test Loss: 1.358 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 6.669862270355225
Epoch: 16, Steps: 4 | Train Loss: 0.007 Vali Loss: 1.422 Vali Acc: 0.540 Test Loss: 1.422 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 6.694567441940308
Epoch: 17, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.683 Vali Acc: 0.540 Test Loss: 1.683 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 6.722776412963867
Epoch: 18, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.816 Vali Acc: 0.560 Test Loss: 1.816 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 6.170191764831543
Epoch: 19, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.766 Vali Acc: 0.560 Test Loss: 1.766 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 6.867726564407349
Epoch: 20, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.657 Vali Acc: 0.540 Test Loss: 1.657 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 6.89086389541626
Epoch: 21, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.667 Vali Acc: 0.540 Test Loss: 1.667 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 6.958132743835449
Epoch: 22, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.593 Vali Acc: 0.560 Test Loss: 1.593 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm128_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 56926853
model size : 219.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm128_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 5.0632569789886475
Epoch: 1, Steps: 4 | Train Loss: 1.626 Vali Loss: 1.609 Vali Acc: 0.280 Test Loss: 1.609 Test Acc: 0.280
Validation loss decreased (inf --> -0.279984).  Saving model ...
Epoch: 2 cost time: 3.2824156284332275
Epoch: 2, Steps: 4 | Train Loss: 1.570 Vali Loss: 1.585 Vali Acc: 0.340 Test Loss: 1.585 Test Acc: 0.340
Validation loss decreased (-0.279984 --> -0.339984).  Saving model ...
Epoch: 3 cost time: 3.281285047531128
Epoch: 3, Steps: 4 | Train Loss: 1.343 Vali Loss: 1.468 Vali Acc: 0.360 Test Loss: 1.468 Test Acc: 0.360
Validation loss decreased (-0.339984 --> -0.359985).  Saving model ...
Epoch: 4 cost time: 3.1473376750946045
Epoch: 4, Steps: 4 | Train Loss: 0.904 Vali Loss: 1.369 Vali Acc: 0.480 Test Loss: 1.369 Test Acc: 0.480
Validation loss decreased (-0.359985 --> -0.479986).  Saving model ...
Epoch: 5 cost time: 3.182070255279541
Epoch: 5, Steps: 4 | Train Loss: 0.676 Vali Loss: 1.362 Vali Acc: 0.440 Test Loss: 1.362 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.3162925243377686
Epoch: 6, Steps: 4 | Train Loss: 0.714 Vali Loss: 1.198 Vali Acc: 0.520 Test Loss: 1.198 Test Acc: 0.520
Validation loss decreased (-0.479986 --> -0.519988).  Saving model ...
Epoch: 7 cost time: 3.1929407119750977
Epoch: 7, Steps: 4 | Train Loss: 0.278 Vali Loss: 1.141 Vali Acc: 0.520 Test Loss: 1.141 Test Acc: 0.520
Validation loss decreased (-0.519988 --> -0.519989).  Saving model ...
Epoch: 8 cost time: 3.2385716438293457
Epoch: 8, Steps: 4 | Train Loss: 0.181 Vali Loss: 1.175 Vali Acc: 0.500 Test Loss: 1.175 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.468356132507324
Epoch: 9, Steps: 4 | Train Loss: 0.129 Vali Loss: 1.140 Vali Acc: 0.560 Test Loss: 1.140 Test Acc: 0.560
Validation loss decreased (-0.519989 --> -0.559989).  Saving model ...
Epoch: 10 cost time: 3.23334002494812
Epoch: 10, Steps: 4 | Train Loss: 0.081 Vali Loss: 1.197 Vali Acc: 0.560 Test Loss: 1.197 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.1650071144104004
Epoch: 11, Steps: 4 | Train Loss: 0.055 Vali Loss: 1.179 Vali Acc: 0.520 Test Loss: 1.179 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.186898946762085
Epoch: 12, Steps: 4 | Train Loss: 0.019 Vali Loss: 1.324 Vali Acc: 0.520 Test Loss: 1.324 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.0928261280059814
Epoch: 13, Steps: 4 | Train Loss: 0.015 Vali Loss: 1.243 Vali Acc: 0.520 Test Loss: 1.243 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.4465887546539307
Epoch: 14, Steps: 4 | Train Loss: 0.009 Vali Loss: 1.314 Vali Acc: 0.580 Test Loss: 1.314 Test Acc: 0.580
Validation loss decreased (-0.559989 --> -0.579987).  Saving model ...
Epoch: 15 cost time: 3.463008165359497
Epoch: 15, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.550 Vali Acc: 0.540 Test Loss: 1.550 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.2821991443634033
Epoch: 16, Steps: 4 | Train Loss: 0.009 Vali Loss: 1.314 Vali Acc: 0.580 Test Loss: 1.314 Test Acc: 0.580
Validation loss decreased (-0.579987 --> -0.579987).  Saving model ...
Epoch: 17 cost time: 3.402959108352661
Epoch: 17, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.311 Vali Acc: 0.520 Test Loss: 1.311 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.353961229324341
Epoch: 18, Steps: 4 | Train Loss: 0.007 Vali Loss: 1.641 Vali Acc: 0.560 Test Loss: 1.641 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.3499531745910645
Epoch: 19, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.701 Vali Acc: 0.560 Test Loss: 1.701 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.4640064239501953
Epoch: 20, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.625 Vali Acc: 0.540 Test Loss: 1.625 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.342806339263916
Epoch: 21, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.573 Vali Acc: 0.540 Test Loss: 1.573 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 3.3079936504364014
Epoch: 22, Steps: 4 | Train Loss: 0.554 Vali Loss: 1.590 Vali Acc: 0.520 Test Loss: 1.590 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 3.2561259269714355
Epoch: 23, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.787 Vali Acc: 0.460 Test Loss: 1.787 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 3.307323932647705
Epoch: 24, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.765 Vali Acc: 0.520 Test Loss: 1.765 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 3.3025150299072266
Epoch: 25, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.773 Vali Acc: 0.520 Test Loss: 1.773 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 3.2776482105255127
Epoch: 26, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.664 Vali Acc: 0.520 Test Loss: 1.664 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm128_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 17209733
model size : 68.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm128_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 9.933936357498169
Epoch: 1, Steps: 4 | Train Loss: 1.722 Vali Loss: 1.504 Vali Acc: 0.220 Test Loss: 1.504 Test Acc: 0.220
Validation loss decreased (inf --> -0.219985).  Saving model ...
Epoch: 2 cost time: 8.068878173828125
Epoch: 2, Steps: 4 | Train Loss: 1.435 Vali Loss: 1.466 Vali Acc: 0.340 Test Loss: 1.466 Test Acc: 0.340
Validation loss decreased (-0.219985 --> -0.339985).  Saving model ...
Epoch: 3 cost time: 7.977863311767578
Epoch: 3, Steps: 4 | Train Loss: 1.183 Vali Loss: 1.416 Vali Acc: 0.400 Test Loss: 1.416 Test Acc: 0.400
Validation loss decreased (-0.339985 --> -0.399986).  Saving model ...
Epoch: 4 cost time: 7.906622409820557
Epoch: 4, Steps: 4 | Train Loss: 1.014 Vali Loss: 1.363 Vali Acc: 0.420 Test Loss: 1.363 Test Acc: 0.420
Validation loss decreased (-0.399986 --> -0.419986).  Saving model ...
Epoch: 5 cost time: 7.952426433563232
Epoch: 5, Steps: 4 | Train Loss: 0.856 Vali Loss: 1.347 Vali Acc: 0.400 Test Loss: 1.347 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 8.021850824356079
Epoch: 6, Steps: 4 | Train Loss: 0.418 Vali Loss: 1.168 Vali Acc: 0.480 Test Loss: 1.168 Test Acc: 0.480
Validation loss decreased (-0.419986 --> -0.479988).  Saving model ...
Epoch: 7 cost time: 8.068095922470093
Epoch: 7, Steps: 4 | Train Loss: 0.294 Vali Loss: 1.189 Vali Acc: 0.480 Test Loss: 1.189 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 7.922910690307617
Epoch: 8, Steps: 4 | Train Loss: 0.200 Vali Loss: 1.142 Vali Acc: 0.500 Test Loss: 1.142 Test Acc: 0.500
Validation loss decreased (-0.479988 --> -0.499989).  Saving model ...
Epoch: 9 cost time: 7.894678592681885
Epoch: 9, Steps: 4 | Train Loss: 0.143 Vali Loss: 1.317 Vali Acc: 0.520 Test Loss: 1.317 Test Acc: 0.520
Validation loss decreased (-0.499989 --> -0.519987).  Saving model ...
Epoch: 10 cost time: 7.980566740036011
Epoch: 10, Steps: 4 | Train Loss: 0.145 Vali Loss: 1.280 Vali Acc: 0.480 Test Loss: 1.280 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 7.95945143699646
Epoch: 11, Steps: 4 | Train Loss: 0.211 Vali Loss: 1.425 Vali Acc: 0.460 Test Loss: 1.425 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 8.082603216171265
Epoch: 12, Steps: 4 | Train Loss: 0.040 Vali Loss: 1.322 Vali Acc: 0.480 Test Loss: 1.322 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 7.897956371307373
Epoch: 13, Steps: 4 | Train Loss: 0.041 Vali Loss: 1.683 Vali Acc: 0.440 Test Loss: 1.683 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 7.86690354347229
Epoch: 14, Steps: 4 | Train Loss: 0.024 Vali Loss: 1.344 Vali Acc: 0.480 Test Loss: 1.344 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 7.624533414840698
Epoch: 15, Steps: 4 | Train Loss: 0.008 Vali Loss: 1.350 Vali Acc: 0.500 Test Loss: 1.350 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 7.939409255981445
Epoch: 16, Steps: 4 | Train Loss: 0.007 Vali Loss: 1.543 Vali Acc: 0.500 Test Loss: 1.543 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 8.359890699386597
Epoch: 17, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.735 Vali Acc: 0.440 Test Loss: 1.735 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 7.779698133468628
Epoch: 18, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.797 Vali Acc: 0.460 Test Loss: 1.797 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 8.358864307403564
Epoch: 19, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.839 Vali Acc: 0.440 Test Loss: 1.839 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm128_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 28809605
model size : 112.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm128_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 5.612332105636597
Epoch: 1, Steps: 4 | Train Loss: 1.671 Vali Loss: 1.538 Vali Acc: 0.260 Test Loss: 1.538 Test Acc: 0.260
Validation loss decreased (inf --> -0.259985).  Saving model ...
Epoch: 2 cost time: 3.7094740867614746
Epoch: 2, Steps: 4 | Train Loss: 1.515 Vali Loss: 1.495 Vali Acc: 0.300 Test Loss: 1.495 Test Acc: 0.300
Validation loss decreased (-0.259985 --> -0.299985).  Saving model ...
Epoch: 3 cost time: 3.620927572250366
Epoch: 3, Steps: 4 | Train Loss: 1.389 Vali Loss: 1.491 Vali Acc: 0.360 Test Loss: 1.491 Test Acc: 0.360
Validation loss decreased (-0.299985 --> -0.359985).  Saving model ...
Epoch: 4 cost time: 3.611175537109375
Epoch: 4, Steps: 4 | Train Loss: 0.936 Vali Loss: 1.450 Vali Acc: 0.440 Test Loss: 1.450 Test Acc: 0.440
Validation loss decreased (-0.359985 --> -0.439986).  Saving model ...
Epoch: 5 cost time: 3.678617000579834
Epoch: 5, Steps: 4 | Train Loss: 0.672 Vali Loss: 1.379 Vali Acc: 0.460 Test Loss: 1.379 Test Acc: 0.460
Validation loss decreased (-0.439986 --> -0.459986).  Saving model ...
Epoch: 6 cost time: 3.567366123199463
Epoch: 6, Steps: 4 | Train Loss: 0.432 Vali Loss: 1.292 Vali Acc: 0.480 Test Loss: 1.292 Test Acc: 0.480
Validation loss decreased (-0.459986 --> -0.479987).  Saving model ...
Epoch: 7 cost time: 3.578418016433716
Epoch: 7, Steps: 4 | Train Loss: 0.312 Vali Loss: 1.228 Vali Acc: 0.540 Test Loss: 1.228 Test Acc: 0.540
Validation loss decreased (-0.479987 --> -0.539988).  Saving model ...
Epoch: 8 cost time: 3.564019203186035
Epoch: 8, Steps: 4 | Train Loss: 0.223 Vali Loss: 1.376 Vali Acc: 0.540 Test Loss: 1.376 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.78254771232605
Epoch: 9, Steps: 4 | Train Loss: 0.168 Vali Loss: 1.348 Vali Acc: 0.520 Test Loss: 1.348 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.6013715267181396
Epoch: 10, Steps: 4 | Train Loss: 0.120 Vali Loss: 1.220 Vali Acc: 0.520 Test Loss: 1.220 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.61993670463562
Epoch: 11, Steps: 4 | Train Loss: 0.058 Vali Loss: 1.409 Vali Acc: 0.560 Test Loss: 1.409 Test Acc: 0.560
Validation loss decreased (-0.539988 --> -0.559986).  Saving model ...
Epoch: 12 cost time: 3.789837598800659
Epoch: 12, Steps: 4 | Train Loss: 0.066 Vali Loss: 1.455 Vali Acc: 0.600 Test Loss: 1.455 Test Acc: 0.600
Validation loss decreased (-0.559986 --> -0.599985).  Saving model ...
Epoch: 13 cost time: 3.641385078430176
Epoch: 13, Steps: 4 | Train Loss: 0.067 Vali Loss: 1.374 Vali Acc: 0.580 Test Loss: 1.374 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.65461802482605
Epoch: 14, Steps: 4 | Train Loss: 0.013 Vali Loss: 1.701 Vali Acc: 0.520 Test Loss: 1.701 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.70005202293396
Epoch: 15, Steps: 4 | Train Loss: 0.048 Vali Loss: 1.656 Vali Acc: 0.540 Test Loss: 1.656 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.6632637977600098
Epoch: 16, Steps: 4 | Train Loss: 0.011 Vali Loss: 1.692 Vali Acc: 0.500 Test Loss: 1.692 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.7312703132629395
Epoch: 17, Steps: 4 | Train Loss: 0.020 Vali Loss: 1.612 Vali Acc: 0.540 Test Loss: 1.612 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.712883949279785
Epoch: 18, Steps: 4 | Train Loss: 0.105 Vali Loss: 1.738 Vali Acc: 0.460 Test Loss: 1.738 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.8756103515625
Epoch: 19, Steps: 4 | Train Loss: 0.025 Vali Loss: 1.384 Vali Acc: 0.480 Test Loss: 1.384 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.581915855407715
Epoch: 20, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.677 Vali Acc: 0.560 Test Loss: 1.677 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 3.3839635848999023
Epoch: 21, Steps: 4 | Train Loss: 0.017 Vali Loss: 1.611 Vali Acc: 0.540 Test Loss: 1.611 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 3.385960578918457
Epoch: 22, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.458 Vali Acc: 0.480 Test Loss: 1.458 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm128_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 8950661
model size : 36.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm128_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 8.197463035583496
Epoch: 1, Steps: 4 | Train Loss: 1.722 Vali Loss: 1.500 Vali Acc: 0.240 Test Loss: 1.500 Test Acc: 0.240
Validation loss decreased (inf --> -0.239985).  Saving model ...
Epoch: 2 cost time: 6.228312253952026
Epoch: 2, Steps: 4 | Train Loss: 1.434 Vali Loss: 1.463 Vali Acc: 0.360 Test Loss: 1.463 Test Acc: 0.360
Validation loss decreased (-0.239985 --> -0.359985).  Saving model ...
Epoch: 3 cost time: 6.265348196029663
Epoch: 3, Steps: 4 | Train Loss: 1.183 Vali Loss: 1.418 Vali Acc: 0.420 Test Loss: 1.418 Test Acc: 0.420
Validation loss decreased (-0.359985 --> -0.419986).  Saving model ...
Epoch: 4 cost time: 6.146649360656738
Epoch: 4, Steps: 4 | Train Loss: 1.013 Vali Loss: 1.367 Vali Acc: 0.400 Test Loss: 1.367 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.137791156768799
Epoch: 5, Steps: 4 | Train Loss: 0.857 Vali Loss: 1.353 Vali Acc: 0.400 Test Loss: 1.353 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.130263090133667
Epoch: 6, Steps: 4 | Train Loss: 0.419 Vali Loss: 1.179 Vali Acc: 0.480 Test Loss: 1.179 Test Acc: 0.480
Validation loss decreased (-0.419986 --> -0.479988).  Saving model ...
Epoch: 7 cost time: 6.11456036567688
Epoch: 7, Steps: 4 | Train Loss: 0.293 Vali Loss: 1.201 Vali Acc: 0.500 Test Loss: 1.201 Test Acc: 0.500
Validation loss decreased (-0.479988 --> -0.499988).  Saving model ...
Epoch: 8 cost time: 6.128016471862793
Epoch: 8, Steps: 4 | Train Loss: 0.200 Vali Loss: 1.149 Vali Acc: 0.500 Test Loss: 1.149 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499989).  Saving model ...
Epoch: 9 cost time: 5.960036516189575
Epoch: 9, Steps: 4 | Train Loss: 0.143 Vali Loss: 1.314 Vali Acc: 0.540 Test Loss: 1.314 Test Acc: 0.540
Validation loss decreased (-0.499989 --> -0.539987).  Saving model ...
Epoch: 10 cost time: 5.8756067752838135
Epoch: 10, Steps: 4 | Train Loss: 0.145 Vali Loss: 1.285 Vali Acc: 0.480 Test Loss: 1.285 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.896427392959595
Epoch: 11, Steps: 4 | Train Loss: 0.211 Vali Loss: 1.432 Vali Acc: 0.440 Test Loss: 1.432 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.872344493865967
Epoch: 12, Steps: 4 | Train Loss: 0.040 Vali Loss: 1.312 Vali Acc: 0.520 Test Loss: 1.312 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.818282842636108
Epoch: 13, Steps: 4 | Train Loss: 0.041 Vali Loss: 1.669 Vali Acc: 0.460 Test Loss: 1.669 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 5.73798680305481
Epoch: 14, Steps: 4 | Train Loss: 0.024 Vali Loss: 1.321 Vali Acc: 0.480 Test Loss: 1.321 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 5.648507356643677
Epoch: 15, Steps: 4 | Train Loss: 0.008 Vali Loss: 1.334 Vali Acc: 0.500 Test Loss: 1.334 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 6.050989151000977
Epoch: 16, Steps: 4 | Train Loss: 0.007 Vali Loss: 1.539 Vali Acc: 0.520 Test Loss: 1.539 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 6.058549165725708
Epoch: 17, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.728 Vali Acc: 0.440 Test Loss: 1.728 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 6.061227083206177
Epoch: 18, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.781 Vali Acc: 0.460 Test Loss: 1.781 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 6.054166078567505
Epoch: 19, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.815 Vali Acc: 0.440 Test Loss: 1.815 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm128_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 28809605
model size : 112.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm128_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.608302116394043
Epoch: 1, Steps: 4 | Train Loss: 1.671 Vali Loss: 1.539 Vali Acc: 0.240 Test Loss: 1.539 Test Acc: 0.240
Validation loss decreased (inf --> -0.239985).  Saving model ...
Epoch: 2 cost time: 2.809281349182129
Epoch: 2, Steps: 4 | Train Loss: 1.515 Vali Loss: 1.497 Vali Acc: 0.300 Test Loss: 1.497 Test Acc: 0.300
Validation loss decreased (-0.239985 --> -0.299985).  Saving model ...
Epoch: 3 cost time: 2.843428134918213
Epoch: 3, Steps: 4 | Train Loss: 1.390 Vali Loss: 1.495 Vali Acc: 0.360 Test Loss: 1.495 Test Acc: 0.360
Validation loss decreased (-0.299985 --> -0.359985).  Saving model ...
Epoch: 4 cost time: 2.9122352600097656
Epoch: 4, Steps: 4 | Train Loss: 0.936 Vali Loss: 1.454 Vali Acc: 0.440 Test Loss: 1.454 Test Acc: 0.440
Validation loss decreased (-0.359985 --> -0.439985).  Saving model ...
Epoch: 5 cost time: 3.030653476715088
Epoch: 5, Steps: 4 | Train Loss: 0.673 Vali Loss: 1.386 Vali Acc: 0.460 Test Loss: 1.386 Test Acc: 0.460
Validation loss decreased (-0.439985 --> -0.459986).  Saving model ...
Epoch: 6 cost time: 2.9663522243499756
Epoch: 6, Steps: 4 | Train Loss: 0.432 Vali Loss: 1.301 Vali Acc: 0.500 Test Loss: 1.301 Test Acc: 0.500
Validation loss decreased (-0.459986 --> -0.499987).  Saving model ...
Epoch: 7 cost time: 2.9759609699249268
Epoch: 7, Steps: 4 | Train Loss: 0.312 Vali Loss: 1.235 Vali Acc: 0.540 Test Loss: 1.235 Test Acc: 0.540
Validation loss decreased (-0.499987 --> -0.539988).  Saving model ...
Epoch: 8 cost time: 2.9746105670928955
Epoch: 8, Steps: 4 | Train Loss: 0.223 Vali Loss: 1.383 Vali Acc: 0.540 Test Loss: 1.383 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.9886093139648438
Epoch: 9, Steps: 4 | Train Loss: 0.168 Vali Loss: 1.362 Vali Acc: 0.500 Test Loss: 1.362 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.031609058380127
Epoch: 10, Steps: 4 | Train Loss: 0.120 Vali Loss: 1.232 Vali Acc: 0.540 Test Loss: 1.232 Test Acc: 0.540
Validation loss decreased (-0.539988 --> -0.539988).  Saving model ...
Epoch: 11 cost time: 2.901921272277832
Epoch: 11, Steps: 4 | Train Loss: 0.058 Vali Loss: 1.427 Vali Acc: 0.540 Test Loss: 1.427 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.967803955078125
Epoch: 12, Steps: 4 | Train Loss: 0.066 Vali Loss: 1.465 Vali Acc: 0.580 Test Loss: 1.465 Test Acc: 0.580
Validation loss decreased (-0.539988 --> -0.579985).  Saving model ...
Epoch: 13 cost time: 3.028989791870117
Epoch: 13, Steps: 4 | Train Loss: 0.067 Vali Loss: 1.390 Vali Acc: 0.540 Test Loss: 1.390 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.0411741733551025
Epoch: 14, Steps: 4 | Train Loss: 0.013 Vali Loss: 1.737 Vali Acc: 0.500 Test Loss: 1.737 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.9493982791900635
Epoch: 15, Steps: 4 | Train Loss: 0.048 Vali Loss: 1.678 Vali Acc: 0.540 Test Loss: 1.678 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.0051944255828857
Epoch: 16, Steps: 4 | Train Loss: 0.012 Vali Loss: 1.694 Vali Acc: 0.440 Test Loss: 1.694 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.8602590560913086
Epoch: 17, Steps: 4 | Train Loss: 0.018 Vali Loss: 1.562 Vali Acc: 0.520 Test Loss: 1.562 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.8684287071228027
Epoch: 18, Steps: 4 | Train Loss: 0.035 Vali Loss: 1.619 Vali Acc: 0.440 Test Loss: 1.619 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.845665693283081
Epoch: 19, Steps: 4 | Train Loss: 0.015 Vali Loss: 1.544 Vali Acc: 0.500 Test Loss: 1.544 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.968825340270996
Epoch: 20, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.915 Vali Acc: 0.500 Test Loss: 1.915 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.9836997985839844
Epoch: 21, Steps: 4 | Train Loss: 0.016 Vali Loss: 1.767 Vali Acc: 0.520 Test Loss: 1.767 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 3.033491849899292
Epoch: 22, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.569 Vali Acc: 0.460 Test Loss: 1.569 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm128_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 8950661
model size : 36.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm128_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 6.264551639556885
Epoch: 1, Steps: 4 | Train Loss: 1.723 Vali Loss: 1.502 Vali Acc: 0.240 Test Loss: 1.502 Test Acc: 0.240
Validation loss decreased (inf --> -0.239985).  Saving model ...
Epoch: 2 cost time: 4.306153059005737
Epoch: 2, Steps: 4 | Train Loss: 1.424 Vali Loss: 1.466 Vali Acc: 0.360 Test Loss: 1.466 Test Acc: 0.360
Validation loss decreased (-0.239985 --> -0.359985).  Saving model ...
Epoch: 3 cost time: 4.207275390625
Epoch: 3, Steps: 4 | Train Loss: 1.189 Vali Loss: 1.420 Vali Acc: 0.420 Test Loss: 1.420 Test Acc: 0.420
Validation loss decreased (-0.359985 --> -0.419986).  Saving model ...
Epoch: 4 cost time: 4.286172151565552
Epoch: 4, Steps: 4 | Train Loss: 1.021 Vali Loss: 1.371 Vali Acc: 0.380 Test Loss: 1.371 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.250427722930908
Epoch: 5, Steps: 4 | Train Loss: 0.864 Vali Loss: 1.359 Vali Acc: 0.400 Test Loss: 1.359 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.283283948898315
Epoch: 6, Steps: 4 | Train Loss: 0.452 Vali Loss: 1.180 Vali Acc: 0.480 Test Loss: 1.180 Test Acc: 0.480
Validation loss decreased (-0.419986 --> -0.479988).  Saving model ...
Epoch: 7 cost time: 4.215000629425049
Epoch: 7, Steps: 4 | Train Loss: 0.303 Vali Loss: 1.200 Vali Acc: 0.460 Test Loss: 1.200 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.430586099624634
Epoch: 8, Steps: 4 | Train Loss: 0.209 Vali Loss: 1.150 Vali Acc: 0.460 Test Loss: 1.150 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.358768939971924
Epoch: 9, Steps: 4 | Train Loss: 0.150 Vali Loss: 1.321 Vali Acc: 0.500 Test Loss: 1.321 Test Acc: 0.500
Validation loss decreased (-0.479988 --> -0.499987).  Saving model ...
Epoch: 10 cost time: 4.261997938156128
Epoch: 10, Steps: 4 | Train Loss: 0.152 Vali Loss: 1.328 Vali Acc: 0.460 Test Loss: 1.328 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.1753458976745605
Epoch: 11, Steps: 4 | Train Loss: 0.211 Vali Loss: 1.410 Vali Acc: 0.420 Test Loss: 1.410 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.623929262161255
Epoch: 12, Steps: 4 | Train Loss: 0.050 Vali Loss: 1.307 Vali Acc: 0.460 Test Loss: 1.307 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.729998350143433
Epoch: 13, Steps: 4 | Train Loss: 0.040 Vali Loss: 1.754 Vali Acc: 0.480 Test Loss: 1.754 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.888479948043823
Epoch: 14, Steps: 4 | Train Loss: 0.021 Vali Loss: 1.354 Vali Acc: 0.460 Test Loss: 1.354 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.9605467319488525
Epoch: 15, Steps: 4 | Train Loss: 0.011 Vali Loss: 1.381 Vali Acc: 0.520 Test Loss: 1.381 Test Acc: 0.520
Validation loss decreased (-0.499987 --> -0.519986).  Saving model ...
Epoch: 16 cost time: 4.837726354598999
Epoch: 16, Steps: 4 | Train Loss: 0.007 Vali Loss: 1.660 Vali Acc: 0.520 Test Loss: 1.660 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.6342854499816895
Epoch: 17, Steps: 4 | Train Loss: 0.008 Vali Loss: 1.662 Vali Acc: 0.500 Test Loss: 1.662 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.599607229232788
Epoch: 18, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.648 Vali Acc: 0.420 Test Loss: 1.648 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 4.645200729370117
Epoch: 19, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.783 Vali Acc: 0.420 Test Loss: 1.783 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 4.968154668807983
Epoch: 20, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.889 Vali Acc: 0.480 Test Loss: 1.889 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 4.880270719528198
Epoch: 21, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.932 Vali Acc: 0.500 Test Loss: 1.932 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 4.684911727905273
Epoch: 22, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.847 Vali Acc: 0.500 Test Loss: 1.847 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 4.631977796554565
Epoch: 23, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.810 Vali Acc: 0.520 Test Loss: 1.810 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 4.620898485183716
Epoch: 24, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.788 Vali Acc: 0.540 Test Loss: 1.788 Test Acc: 0.540
Validation loss decreased (-0.519986 --> -0.539982).  Saving model ...
Epoch: 25 cost time: 4.612949848175049
Epoch: 25, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.777 Vali Acc: 0.520 Test Loss: 1.777 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 4.80736231803894
Epoch: 26, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.797 Vali Acc: 0.500 Test Loss: 1.797 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 4.993806838989258
Epoch: 27, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.833 Vali Acc: 0.500 Test Loss: 1.833 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 4.800472736358643
Epoch: 28, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.852 Vali Acc: 0.500 Test Loss: 1.852 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 4.629765510559082
Epoch: 29, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.872 Vali Acc: 0.500 Test Loss: 1.872 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 4.552581310272217
Epoch: 30, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.872 Vali Acc: 0.500 Test Loss: 1.872 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm128_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 28809605
model size : 112.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm128_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.99031925201416
Epoch: 1, Steps: 4 | Train Loss: 1.657 Vali Loss: 1.534 Vali Acc: 0.240 Test Loss: 1.534 Test Acc: 0.240
Validation loss decreased (inf --> -0.239985).  Saving model ...
Epoch: 2 cost time: 2.517369270324707
Epoch: 2, Steps: 4 | Train Loss: 1.514 Vali Loss: 1.493 Vali Acc: 0.300 Test Loss: 1.493 Test Acc: 0.300
Validation loss decreased (-0.239985 --> -0.299985).  Saving model ...
Epoch: 3 cost time: 2.363236904144287
Epoch: 3, Steps: 4 | Train Loss: 1.385 Vali Loss: 1.492 Vali Acc: 0.360 Test Loss: 1.492 Test Acc: 0.360
Validation loss decreased (-0.299985 --> -0.359985).  Saving model ...
Epoch: 4 cost time: 2.5178744792938232
Epoch: 4, Steps: 4 | Train Loss: 1.045 Vali Loss: 1.453 Vali Acc: 0.460 Test Loss: 1.453 Test Acc: 0.460
Validation loss decreased (-0.359985 --> -0.459985).  Saving model ...
Epoch: 5 cost time: 2.3919997215270996
Epoch: 5, Steps: 4 | Train Loss: 0.686 Vali Loss: 1.377 Vali Acc: 0.440 Test Loss: 1.377 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.6580867767333984
Epoch: 6, Steps: 4 | Train Loss: 0.495 Vali Loss: 1.277 Vali Acc: 0.520 Test Loss: 1.277 Test Acc: 0.520
Validation loss decreased (-0.459985 --> -0.519987).  Saving model ...
Epoch: 7 cost time: 2.3628950119018555
Epoch: 7, Steps: 4 | Train Loss: 0.311 Vali Loss: 1.237 Vali Acc: 0.540 Test Loss: 1.237 Test Acc: 0.540
Validation loss decreased (-0.519987 --> -0.539988).  Saving model ...
Epoch: 8 cost time: 2.439100503921509
Epoch: 8, Steps: 4 | Train Loss: 0.219 Vali Loss: 1.355 Vali Acc: 0.560 Test Loss: 1.355 Test Acc: 0.560
Validation loss decreased (-0.539988 --> -0.559986).  Saving model ...
Epoch: 9 cost time: 2.352766752243042
Epoch: 9, Steps: 4 | Train Loss: 0.165 Vali Loss: 1.296 Vali Acc: 0.540 Test Loss: 1.296 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.4770216941833496
Epoch: 10, Steps: 4 | Train Loss: 0.131 Vali Loss: 1.242 Vali Acc: 0.520 Test Loss: 1.242 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.3528270721435547
Epoch: 11, Steps: 4 | Train Loss: 0.054 Vali Loss: 1.499 Vali Acc: 0.580 Test Loss: 1.499 Test Acc: 0.580
Validation loss decreased (-0.559986 --> -0.579985).  Saving model ...
Epoch: 12 cost time: 2.491021156311035
Epoch: 12, Steps: 4 | Train Loss: 0.087 Vali Loss: 1.420 Vali Acc: 0.580 Test Loss: 1.420 Test Acc: 0.580
Validation loss decreased (-0.579985 --> -0.579986).  Saving model ...
Epoch: 13 cost time: 2.427931308746338
Epoch: 13, Steps: 4 | Train Loss: 0.072 Vali Loss: 1.345 Vali Acc: 0.500 Test Loss: 1.345 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.5054967403411865
Epoch: 14, Steps: 4 | Train Loss: 0.017 Vali Loss: 1.714 Vali Acc: 0.480 Test Loss: 1.714 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.399624824523926
Epoch: 15, Steps: 4 | Train Loss: 0.038 Vali Loss: 1.605 Vali Acc: 0.460 Test Loss: 1.605 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.5225889682769775
Epoch: 16, Steps: 4 | Train Loss: 0.020 Vali Loss: 1.585 Vali Acc: 0.460 Test Loss: 1.585 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.5507869720458984
Epoch: 17, Steps: 4 | Train Loss: 0.006 Vali Loss: 1.629 Vali Acc: 0.460 Test Loss: 1.629 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.3386168479919434
Epoch: 18, Steps: 4 | Train Loss: 0.106 Vali Loss: 1.553 Vali Acc: 0.480 Test Loss: 1.553 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.2661776542663574
Epoch: 19, Steps: 4 | Train Loss: 0.017 Vali Loss: 1.476 Vali Acc: 0.520 Test Loss: 1.476 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.228980541229248
Epoch: 20, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.903 Vali Acc: 0.520 Test Loss: 1.903 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.38936185836792
Epoch: 21, Steps: 4 | Train Loss: 0.016 Vali Loss: 1.888 Vali Acc: 0.520 Test Loss: 1.888 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.3791580200195312
Epoch: 22, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.656 Vali Acc: 0.500 Test Loss: 1.656 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm128_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 8950661
model size : 36.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm64_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 11.827710628509521
Epoch: 1, Steps: 4 | Train Loss: 1.505 Vali Loss: 1.571 Vali Acc: 0.200 Test Loss: 1.571 Test Acc: 0.200
Validation loss decreased (inf --> -0.199984).  Saving model ...
Epoch: 2 cost time: 9.733608484268188
Epoch: 2, Steps: 4 | Train Loss: 1.471 Vali Loss: 1.549 Vali Acc: 0.260 Test Loss: 1.549 Test Acc: 0.260
Validation loss decreased (-0.199984 --> -0.259985).  Saving model ...
Epoch: 3 cost time: 9.763005256652832
Epoch: 3, Steps: 4 | Train Loss: 1.400 Vali Loss: 1.527 Vali Acc: 0.320 Test Loss: 1.527 Test Acc: 0.320
Validation loss decreased (-0.259985 --> -0.319985).  Saving model ...
Epoch: 4 cost time: 9.953439474105835
Epoch: 4, Steps: 4 | Train Loss: 1.185 Vali Loss: 1.468 Vali Acc: 0.440 Test Loss: 1.468 Test Acc: 0.440
Validation loss decreased (-0.319985 --> -0.439985).  Saving model ...
Epoch: 5 cost time: 10.044612169265747
Epoch: 5, Steps: 4 | Train Loss: 0.887 Vali Loss: 1.341 Vali Acc: 0.500 Test Loss: 1.341 Test Acc: 0.500
Validation loss decreased (-0.439985 --> -0.499987).  Saving model ...
Epoch: 6 cost time: 9.940028667449951
Epoch: 6, Steps: 4 | Train Loss: 0.833 Vali Loss: 1.254 Vali Acc: 0.540 Test Loss: 1.254 Test Acc: 0.540
Validation loss decreased (-0.499987 --> -0.539987).  Saving model ...
Epoch: 7 cost time: 9.732790231704712
Epoch: 7, Steps: 4 | Train Loss: 0.481 Vali Loss: 1.220 Vali Acc: 0.540 Test Loss: 1.220 Test Acc: 0.540
Validation loss decreased (-0.539987 --> -0.539988).  Saving model ...
Epoch: 8 cost time: 9.73499608039856
Epoch: 8, Steps: 4 | Train Loss: 0.403 Vali Loss: 1.213 Vali Acc: 0.500 Test Loss: 1.213 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 9.500437021255493
Epoch: 9, Steps: 4 | Train Loss: 0.322 Vali Loss: 1.149 Vali Acc: 0.520 Test Loss: 1.149 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 9.351385593414307
Epoch: 10, Steps: 4 | Train Loss: 0.282 Vali Loss: 1.171 Vali Acc: 0.560 Test Loss: 1.171 Test Acc: 0.560
Validation loss decreased (-0.539988 --> -0.559988).  Saving model ...
Epoch: 11 cost time: 9.077049493789673
Epoch: 11, Steps: 4 | Train Loss: 0.208 Vali Loss: 1.121 Vali Acc: 0.520 Test Loss: 1.121 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 9.13343858718872
Epoch: 12, Steps: 4 | Train Loss: 0.121 Vali Loss: 1.220 Vali Acc: 0.500 Test Loss: 1.220 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 9.38278317451477
Epoch: 13, Steps: 4 | Train Loss: 0.369 Vali Loss: 1.300 Vali Acc: 0.460 Test Loss: 1.300 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 8.74787187576294
Epoch: 14, Steps: 4 | Train Loss: 0.085 Vali Loss: 1.315 Vali Acc: 0.480 Test Loss: 1.315 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 9.302858114242554
Epoch: 15, Steps: 4 | Train Loss: 0.079 Vali Loss: 1.449 Vali Acc: 0.440 Test Loss: 1.449 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 9.535994529724121
Epoch: 16, Steps: 4 | Train Loss: 0.164 Vali Loss: 1.745 Vali Acc: 0.460 Test Loss: 1.745 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 9.373372316360474
Epoch: 17, Steps: 4 | Train Loss: 0.084 Vali Loss: 1.310 Vali Acc: 0.540 Test Loss: 1.310 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 9.436893224716187
Epoch: 18, Steps: 4 | Train Loss: 0.073 Vali Loss: 1.089 Vali Acc: 0.600 Test Loss: 1.089 Test Acc: 0.600
Validation loss decreased (-0.559988 --> -0.599989).  Saving model ...
Epoch: 19 cost time: 9.548314332962036
Epoch: 19, Steps: 4 | Train Loss: 0.039 Vali Loss: 1.118 Vali Acc: 0.600 Test Loss: 1.118 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 9.550102233886719
Epoch: 20, Steps: 4 | Train Loss: 0.103 Vali Loss: 1.286 Vali Acc: 0.600 Test Loss: 1.286 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 9.603888273239136
Epoch: 21, Steps: 4 | Train Loss: 0.021 Vali Loss: 1.311 Vali Acc: 0.560 Test Loss: 1.311 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 9.629589319229126
Epoch: 22, Steps: 4 | Train Loss: 0.010 Vali Loss: 1.442 Vali Acc: 0.460 Test Loss: 1.442 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 9.770792961120605
Epoch: 23, Steps: 4 | Train Loss: 0.015 Vali Loss: 1.435 Vali Acc: 0.500 Test Loss: 1.435 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 9.74632716178894
Epoch: 24, Steps: 4 | Train Loss: 0.006 Vali Loss: 1.364 Vali Acc: 0.620 Test Loss: 1.364 Test Acc: 0.620
Validation loss decreased (-0.599989 --> -0.619986).  Saving model ...
Epoch: 25 cost time: 9.668149709701538
Epoch: 25, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.403 Vali Acc: 0.580 Test Loss: 1.403 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 9.584625482559204
Epoch: 26, Steps: 4 | Train Loss: 0.006 Vali Loss: 1.442 Vali Acc: 0.620 Test Loss: 1.442 Test Acc: 0.620
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 9.701369047164917
Epoch: 27, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.485 Vali Acc: 0.600 Test Loss: 1.485 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 9.6532723903656
Epoch: 28, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.481 Vali Acc: 0.580 Test Loss: 1.481 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 9.573094844818115
Epoch: 29, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.446 Vali Acc: 0.560 Test Loss: 1.446 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 9.557483434677124
Epoch: 30, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.404 Vali Acc: 0.540 Test Loss: 1.404 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm64_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.62
model parameter : 28465733
model size : 109.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm64_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 5.93787145614624
Epoch: 1, Steps: 4 | Train Loss: 1.665 Vali Loss: 1.618 Vali Acc: 0.220 Test Loss: 1.618 Test Acc: 0.220
Validation loss decreased (inf --> -0.219984).  Saving model ...
Epoch: 2 cost time: 4.043062925338745
Epoch: 2, Steps: 4 | Train Loss: 1.551 Vali Loss: 1.575 Vali Acc: 0.240 Test Loss: 1.575 Test Acc: 0.240
Validation loss decreased (-0.219984 --> -0.239984).  Saving model ...
Epoch: 3 cost time: 4.076018571853638
Epoch: 3, Steps: 4 | Train Loss: 1.411 Vali Loss: 1.545 Vali Acc: 0.280 Test Loss: 1.545 Test Acc: 0.280
Validation loss decreased (-0.239984 --> -0.279985).  Saving model ...
Epoch: 4 cost time: 4.125744581222534
Epoch: 4, Steps: 4 | Train Loss: 1.174 Vali Loss: 1.449 Vali Acc: 0.440 Test Loss: 1.449 Test Acc: 0.440
Validation loss decreased (-0.279985 --> -0.439986).  Saving model ...
Epoch: 5 cost time: 4.403281927108765
Epoch: 5, Steps: 4 | Train Loss: 1.128 Vali Loss: 1.371 Vali Acc: 0.500 Test Loss: 1.371 Test Acc: 0.500
Validation loss decreased (-0.439986 --> -0.499986).  Saving model ...
Epoch: 6 cost time: 4.100270748138428
Epoch: 6, Steps: 4 | Train Loss: 0.756 Vali Loss: 1.322 Vali Acc: 0.480 Test Loss: 1.322 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.034621715545654
Epoch: 7, Steps: 4 | Train Loss: 0.555 Vali Loss: 1.326 Vali Acc: 0.480 Test Loss: 1.326 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.030582904815674
Epoch: 8, Steps: 4 | Train Loss: 0.389 Vali Loss: 1.251 Vali Acc: 0.500 Test Loss: 1.251 Test Acc: 0.500
Validation loss decreased (-0.499986 --> -0.499987).  Saving model ...
Epoch: 9 cost time: 4.027178525924683
Epoch: 9, Steps: 4 | Train Loss: 0.268 Vali Loss: 1.158 Vali Acc: 0.520 Test Loss: 1.158 Test Acc: 0.520
Validation loss decreased (-0.499987 --> -0.519988).  Saving model ...
Epoch: 10 cost time: 4.073194265365601
Epoch: 10, Steps: 4 | Train Loss: 0.195 Vali Loss: 1.122 Vali Acc: 0.520 Test Loss: 1.122 Test Acc: 0.520
Validation loss decreased (-0.519988 --> -0.519989).  Saving model ...
Epoch: 11 cost time: 4.165257692337036
Epoch: 11, Steps: 4 | Train Loss: 0.471 Vali Loss: 1.166 Vali Acc: 0.540 Test Loss: 1.166 Test Acc: 0.540
Validation loss decreased (-0.519989 --> -0.539988).  Saving model ...
Epoch: 12 cost time: 4.104334831237793
Epoch: 12, Steps: 4 | Train Loss: 0.107 Vali Loss: 1.199 Vali Acc: 0.520 Test Loss: 1.199 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.9917221069335938
Epoch: 13, Steps: 4 | Train Loss: 0.084 Vali Loss: 1.161 Vali Acc: 0.560 Test Loss: 1.161 Test Acc: 0.560
Validation loss decreased (-0.539988 --> -0.559988).  Saving model ...
Epoch: 14 cost time: 4.158164978027344
Epoch: 14, Steps: 4 | Train Loss: 0.064 Vali Loss: 1.118 Vali Acc: 0.560 Test Loss: 1.118 Test Acc: 0.560
Validation loss decreased (-0.559988 --> -0.559989).  Saving model ...
Epoch: 15 cost time: 4.066475868225098
Epoch: 15, Steps: 4 | Train Loss: 0.036 Vali Loss: 1.199 Vali Acc: 0.580 Test Loss: 1.199 Test Acc: 0.580
Validation loss decreased (-0.559989 --> -0.579988).  Saving model ...
Epoch: 16 cost time: 4.215295314788818
Epoch: 16, Steps: 4 | Train Loss: 0.034 Vali Loss: 1.324 Vali Acc: 0.480 Test Loss: 1.324 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.2911696434021
Epoch: 17, Steps: 4 | Train Loss: 0.033 Vali Loss: 1.355 Vali Acc: 0.500 Test Loss: 1.355 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.250755548477173
Epoch: 18, Steps: 4 | Train Loss: 0.025 Vali Loss: 1.209 Vali Acc: 0.540 Test Loss: 1.209 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 4.173101902008057
Epoch: 19, Steps: 4 | Train Loss: 0.026 Vali Loss: 1.329 Vali Acc: 0.500 Test Loss: 1.329 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 4.162318468093872
Epoch: 20, Steps: 4 | Train Loss: 0.010 Vali Loss: 1.866 Vali Acc: 0.520 Test Loss: 1.866 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 4.157427549362183
Epoch: 21, Steps: 4 | Train Loss: 0.016 Vali Loss: 1.701 Vali Acc: 0.560 Test Loss: 1.701 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 4.146868944168091
Epoch: 22, Steps: 4 | Train Loss: 0.010 Vali Loss: 1.582 Vali Acc: 0.540 Test Loss: 1.582 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 4.2249510288238525
Epoch: 23, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.634 Vali Acc: 0.580 Test Loss: 1.634 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 4.283133029937744
Epoch: 24, Steps: 4 | Train Loss: 0.007 Vali Loss: 1.437 Vali Acc: 0.600 Test Loss: 1.437 Test Acc: 0.600
Validation loss decreased (-0.579988 --> -0.599986).  Saving model ...
Epoch: 25 cost time: 4.015434980392456
Epoch: 25, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.365 Vali Acc: 0.580 Test Loss: 1.365 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 4.023617744445801
Epoch: 26, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.463 Vali Acc: 0.600 Test Loss: 1.463 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 4.2673499584198
Epoch: 27, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.636 Vali Acc: 0.600 Test Loss: 1.636 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.955709934234619
Epoch: 28, Steps: 4 | Train Loss: 0.451 Vali Loss: 1.671 Vali Acc: 0.560 Test Loss: 1.671 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 3.9181721210479736
Epoch: 29, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.812 Vali Acc: 0.480 Test Loss: 1.812 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 4.231612205505371
Epoch: 30, Steps: 4 | Train Loss: 0.009 Vali Loss: 1.739 Vali Acc: 0.520 Test Loss: 1.739 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm64_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 8606405
model size : 34.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm64_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 9.24798321723938
Epoch: 1, Steps: 4 | Train Loss: 1.505 Vali Loss: 1.569 Vali Acc: 0.220 Test Loss: 1.569 Test Acc: 0.220
Validation loss decreased (inf --> -0.219984).  Saving model ...
Epoch: 2 cost time: 6.920211553573608
Epoch: 2, Steps: 4 | Train Loss: 1.471 Vali Loss: 1.548 Vali Acc: 0.280 Test Loss: 1.548 Test Acc: 0.280
Validation loss decreased (-0.219984 --> -0.279985).  Saving model ...
Epoch: 3 cost time: 6.9968461990356445
Epoch: 3, Steps: 4 | Train Loss: 1.400 Vali Loss: 1.526 Vali Acc: 0.320 Test Loss: 1.526 Test Acc: 0.320
Validation loss decreased (-0.279985 --> -0.319985).  Saving model ...
Epoch: 4 cost time: 6.8950018882751465
Epoch: 4, Steps: 4 | Train Loss: 1.185 Vali Loss: 1.468 Vali Acc: 0.440 Test Loss: 1.468 Test Acc: 0.440
Validation loss decreased (-0.319985 --> -0.439985).  Saving model ...
Epoch: 5 cost time: 6.8612060546875
Epoch: 5, Steps: 4 | Train Loss: 0.887 Vali Loss: 1.343 Vali Acc: 0.500 Test Loss: 1.343 Test Acc: 0.500
Validation loss decreased (-0.439985 --> -0.499987).  Saving model ...
Epoch: 6 cost time: 7.258639812469482
Epoch: 6, Steps: 4 | Train Loss: 0.834 Vali Loss: 1.255 Vali Acc: 0.540 Test Loss: 1.255 Test Acc: 0.540
Validation loss decreased (-0.499987 --> -0.539987).  Saving model ...
Epoch: 7 cost time: 7.279835939407349
Epoch: 7, Steps: 4 | Train Loss: 0.481 Vali Loss: 1.222 Vali Acc: 0.540 Test Loss: 1.222 Test Acc: 0.540
Validation loss decreased (-0.539987 --> -0.539988).  Saving model ...
Epoch: 8 cost time: 7.365916967391968
Epoch: 8, Steps: 4 | Train Loss: 0.402 Vali Loss: 1.211 Vali Acc: 0.500 Test Loss: 1.211 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 7.234822034835815
Epoch: 9, Steps: 4 | Train Loss: 0.322 Vali Loss: 1.161 Vali Acc: 0.520 Test Loss: 1.161 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 7.141777515411377
Epoch: 10, Steps: 4 | Train Loss: 0.282 Vali Loss: 1.179 Vali Acc: 0.520 Test Loss: 1.179 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 6.883987665176392
Epoch: 11, Steps: 4 | Train Loss: 0.209 Vali Loss: 1.134 Vali Acc: 0.520 Test Loss: 1.134 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 7.066733121871948
Epoch: 12, Steps: 4 | Train Loss: 0.121 Vali Loss: 1.243 Vali Acc: 0.480 Test Loss: 1.243 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 7.17582893371582
Epoch: 13, Steps: 4 | Train Loss: 0.130 Vali Loss: 1.310 Vali Acc: 0.500 Test Loss: 1.310 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 7.037478685379028
Epoch: 14, Steps: 4 | Train Loss: 0.086 Vali Loss: 1.354 Vali Acc: 0.480 Test Loss: 1.354 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 6.97745943069458
Epoch: 15, Steps: 4 | Train Loss: 0.076 Vali Loss: 1.471 Vali Acc: 0.440 Test Loss: 1.471 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 7.194079637527466
Epoch: 16, Steps: 4 | Train Loss: 0.110 Vali Loss: 1.808 Vali Acc: 0.440 Test Loss: 1.808 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 7.130571126937866
Epoch: 17, Steps: 4 | Train Loss: 0.172 Vali Loss: 1.393 Vali Acc: 0.600 Test Loss: 1.393 Test Acc: 0.600
Validation loss decreased (-0.539988 --> -0.599986).  Saving model ...
Epoch: 18 cost time: 6.883268117904663
Epoch: 18, Steps: 4 | Train Loss: 0.080 Vali Loss: 1.226 Vali Acc: 0.600 Test Loss: 1.226 Test Acc: 0.600
Validation loss decreased (-0.599986 --> -0.599988).  Saving model ...
Epoch: 19 cost time: 7.0127668380737305
Epoch: 19, Steps: 4 | Train Loss: 0.050 Vali Loss: 1.183 Vali Acc: 0.580 Test Loss: 1.183 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 6.93306303024292
Epoch: 20, Steps: 4 | Train Loss: 0.108 Vali Loss: 1.346 Vali Acc: 0.600 Test Loss: 1.346 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 6.928587436676025
Epoch: 21, Steps: 4 | Train Loss: 0.019 Vali Loss: 1.365 Vali Acc: 0.520 Test Loss: 1.365 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 6.963967561721802
Epoch: 22, Steps: 4 | Train Loss: 0.013 Vali Loss: 1.481 Vali Acc: 0.480 Test Loss: 1.481 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 6.964133024215698
Epoch: 23, Steps: 4 | Train Loss: 0.017 Vali Loss: 1.426 Vali Acc: 0.580 Test Loss: 1.426 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 6.924604654312134
Epoch: 24, Steps: 4 | Train Loss: 0.006 Vali Loss: 1.488 Vali Acc: 0.520 Test Loss: 1.488 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 6.907013893127441
Epoch: 25, Steps: 4 | Train Loss: 0.006 Vali Loss: 1.576 Vali Acc: 0.580 Test Loss: 1.576 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 6.677057981491089
Epoch: 26, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.670 Vali Acc: 0.580 Test Loss: 1.670 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 6.672742128372192
Epoch: 27, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.643 Vali Acc: 0.580 Test Loss: 1.643 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 7.309118747711182
Epoch: 28, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.571 Vali Acc: 0.540 Test Loss: 1.571 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm64_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 28465733
model size : 109.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm64_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 5.270981073379517
Epoch: 1, Steps: 4 | Train Loss: 1.665 Vali Loss: 1.613 Vali Acc: 0.220 Test Loss: 1.613 Test Acc: 0.220
Validation loss decreased (inf --> -0.219984).  Saving model ...
Epoch: 2 cost time: 3.096292495727539
Epoch: 2, Steps: 4 | Train Loss: 1.551 Vali Loss: 1.570 Vali Acc: 0.240 Test Loss: 1.570 Test Acc: 0.240
Validation loss decreased (-0.219984 --> -0.239984).  Saving model ...
Epoch: 3 cost time: 3.4297821521759033
Epoch: 3, Steps: 4 | Train Loss: 1.411 Vali Loss: 1.541 Vali Acc: 0.280 Test Loss: 1.541 Test Acc: 0.280
Validation loss decreased (-0.239984 --> -0.279985).  Saving model ...
Epoch: 4 cost time: 3.3866372108459473
Epoch: 4, Steps: 4 | Train Loss: 1.174 Vali Loss: 1.446 Vali Acc: 0.440 Test Loss: 1.446 Test Acc: 0.440
Validation loss decreased (-0.279985 --> -0.439986).  Saving model ...
Epoch: 5 cost time: 3.370267868041992
Epoch: 5, Steps: 4 | Train Loss: 1.129 Vali Loss: 1.370 Vali Acc: 0.500 Test Loss: 1.370 Test Acc: 0.500
Validation loss decreased (-0.439986 --> -0.499986).  Saving model ...
Epoch: 6 cost time: 3.3944051265716553
Epoch: 6, Steps: 4 | Train Loss: 0.757 Vali Loss: 1.325 Vali Acc: 0.460 Test Loss: 1.325 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.6026620864868164
Epoch: 7, Steps: 4 | Train Loss: 0.555 Vali Loss: 1.334 Vali Acc: 0.460 Test Loss: 1.334 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.511887311935425
Epoch: 8, Steps: 4 | Train Loss: 0.390 Vali Loss: 1.259 Vali Acc: 0.500 Test Loss: 1.259 Test Acc: 0.500
Validation loss decreased (-0.499986 --> -0.499987).  Saving model ...
Epoch: 9 cost time: 3.3828065395355225
Epoch: 9, Steps: 4 | Train Loss: 0.269 Vali Loss: 1.164 Vali Acc: 0.520 Test Loss: 1.164 Test Acc: 0.520
Validation loss decreased (-0.499987 --> -0.519988).  Saving model ...
Epoch: 10 cost time: 3.3876302242279053
Epoch: 10, Steps: 4 | Train Loss: 0.196 Vali Loss: 1.118 Vali Acc: 0.560 Test Loss: 1.118 Test Acc: 0.560
Validation loss decreased (-0.519988 --> -0.559989).  Saving model ...
Epoch: 11 cost time: 3.502842664718628
Epoch: 11, Steps: 4 | Train Loss: 0.473 Vali Loss: 1.167 Vali Acc: 0.580 Test Loss: 1.167 Test Acc: 0.580
Validation loss decreased (-0.559989 --> -0.579988).  Saving model ...
Epoch: 12 cost time: 3.583195447921753
Epoch: 12, Steps: 4 | Train Loss: 0.108 Vali Loss: 1.197 Vali Acc: 0.520 Test Loss: 1.197 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.406424045562744
Epoch: 13, Steps: 4 | Train Loss: 0.084 Vali Loss: 1.141 Vali Acc: 0.580 Test Loss: 1.141 Test Acc: 0.580
Validation loss decreased (-0.579988 --> -0.579989).  Saving model ...
Epoch: 14 cost time: 3.5371274948120117
Epoch: 14, Steps: 4 | Train Loss: 0.066 Vali Loss: 1.079 Vali Acc: 0.560 Test Loss: 1.079 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.4361069202423096
Epoch: 15, Steps: 4 | Train Loss: 0.036 Vali Loss: 1.143 Vali Acc: 0.580 Test Loss: 1.143 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.514939785003662
Epoch: 16, Steps: 4 | Train Loss: 0.034 Vali Loss: 1.257 Vali Acc: 0.500 Test Loss: 1.257 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.5815508365631104
Epoch: 17, Steps: 4 | Train Loss: 0.033 Vali Loss: 1.326 Vali Acc: 0.500 Test Loss: 1.326 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.3290975093841553
Epoch: 18, Steps: 4 | Train Loss: 0.024 Vali Loss: 1.176 Vali Acc: 0.540 Test Loss: 1.176 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.3755991458892822
Epoch: 19, Steps: 4 | Train Loss: 0.026 Vali Loss: 1.227 Vali Acc: 0.520 Test Loss: 1.227 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.4282007217407227
Epoch: 20, Steps: 4 | Train Loss: 0.010 Vali Loss: 1.807 Vali Acc: 0.500 Test Loss: 1.807 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.6874921321868896
Epoch: 21, Steps: 4 | Train Loss: 0.017 Vali Loss: 1.556 Vali Acc: 0.560 Test Loss: 1.556 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 3.3451693058013916
Epoch: 22, Steps: 4 | Train Loss: 0.010 Vali Loss: 1.478 Vali Acc: 0.580 Test Loss: 1.478 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.3980624675750732
Epoch: 23, Steps: 4 | Train Loss: 0.006 Vali Loss: 1.531 Vali Acc: 0.560 Test Loss: 1.531 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm64_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 8606405
model size : 34.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm64_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 6.925025463104248
Epoch: 1, Steps: 4 | Train Loss: 1.505 Vali Loss: 1.570 Vali Acc: 0.220 Test Loss: 1.570 Test Acc: 0.220
Validation loss decreased (inf --> -0.219984).  Saving model ...
Epoch: 2 cost time: 5.134063243865967
Epoch: 2, Steps: 4 | Train Loss: 1.473 Vali Loss: 1.549 Vali Acc: 0.280 Test Loss: 1.549 Test Acc: 0.280
Validation loss decreased (-0.219984 --> -0.279985).  Saving model ...
Epoch: 3 cost time: 5.004912853240967
Epoch: 3, Steps: 4 | Train Loss: 1.405 Vali Loss: 1.526 Vali Acc: 0.320 Test Loss: 1.526 Test Acc: 0.320
Validation loss decreased (-0.279985 --> -0.319985).  Saving model ...
Epoch: 4 cost time: 4.9022743701934814
Epoch: 4, Steps: 4 | Train Loss: 1.194 Vali Loss: 1.467 Vali Acc: 0.420 Test Loss: 1.467 Test Acc: 0.420
Validation loss decreased (-0.319985 --> -0.419985).  Saving model ...
Epoch: 5 cost time: 4.6129679679870605
Epoch: 5, Steps: 4 | Train Loss: 0.911 Vali Loss: 1.341 Vali Acc: 0.500 Test Loss: 1.341 Test Acc: 0.500
Validation loss decreased (-0.419985 --> -0.499987).  Saving model ...
Epoch: 6 cost time: 4.690530776977539
Epoch: 6, Steps: 4 | Train Loss: 0.845 Vali Loss: 1.248 Vali Acc: 0.520 Test Loss: 1.248 Test Acc: 0.520
Validation loss decreased (-0.499987 --> -0.519988).  Saving model ...
Epoch: 7 cost time: 4.323856830596924
Epoch: 7, Steps: 4 | Train Loss: 0.498 Vali Loss: 1.205 Vali Acc: 0.540 Test Loss: 1.205 Test Acc: 0.540
Validation loss decreased (-0.519988 --> -0.539988).  Saving model ...
Epoch: 8 cost time: 4.507351636886597
Epoch: 8, Steps: 4 | Train Loss: 0.437 Vali Loss: 1.192 Vali Acc: 0.520 Test Loss: 1.192 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.6609413623809814
Epoch: 9, Steps: 4 | Train Loss: 0.332 Vali Loss: 1.116 Vali Acc: 0.500 Test Loss: 1.116 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.636805772781372
Epoch: 10, Steps: 4 | Train Loss: 0.286 Vali Loss: 1.125 Vali Acc: 0.560 Test Loss: 1.125 Test Acc: 0.560
Validation loss decreased (-0.539988 --> -0.559989).  Saving model ...
Epoch: 11 cost time: 4.741316318511963
Epoch: 11, Steps: 4 | Train Loss: 0.211 Vali Loss: 1.055 Vali Acc: 0.620 Test Loss: 1.055 Test Acc: 0.620
Validation loss decreased (-0.559989 --> -0.619989).  Saving model ...
Epoch: 12 cost time: 4.8128502368927
Epoch: 12, Steps: 4 | Train Loss: 0.132 Vali Loss: 1.148 Vali Acc: 0.560 Test Loss: 1.148 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.7864203453063965
Epoch: 13, Steps: 4 | Train Loss: 0.147 Vali Loss: 1.187 Vali Acc: 0.540 Test Loss: 1.187 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.731689453125
Epoch: 14, Steps: 4 | Train Loss: 0.105 Vali Loss: 1.120 Vali Acc: 0.600 Test Loss: 1.120 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.629230499267578
Epoch: 15, Steps: 4 | Train Loss: 0.080 Vali Loss: 1.349 Vali Acc: 0.520 Test Loss: 1.349 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 4.7024359703063965
Epoch: 16, Steps: 4 | Train Loss: 0.079 Vali Loss: 1.514 Vali Acc: 0.460 Test Loss: 1.514 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 4.881924867630005
Epoch: 17, Steps: 4 | Train Loss: 0.060 Vali Loss: 1.190 Vali Acc: 0.620 Test Loss: 1.190 Test Acc: 0.620
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 4.953824281692505
Epoch: 18, Steps: 4 | Train Loss: 0.080 Vali Loss: 1.188 Vali Acc: 0.600 Test Loss: 1.188 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 4.883996486663818
Epoch: 19, Steps: 4 | Train Loss: 0.031 Vali Loss: 1.191 Vali Acc: 0.540 Test Loss: 1.191 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 4.5182507038116455
Epoch: 20, Steps: 4 | Train Loss: 0.052 Vali Loss: 1.266 Vali Acc: 0.600 Test Loss: 1.266 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 4.58874249458313
Epoch: 21, Steps: 4 | Train Loss: 0.014 Vali Loss: 1.220 Vali Acc: 0.520 Test Loss: 1.220 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm64_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.62
model parameter : 28465733
model size : 109.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm64_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.282053470611572
Epoch: 1, Steps: 4 | Train Loss: 1.667 Vali Loss: 1.617 Vali Acc: 0.220 Test Loss: 1.617 Test Acc: 0.220
Validation loss decreased (inf --> -0.219984).  Saving model ...
Epoch: 2 cost time: 2.4615890979766846
Epoch: 2, Steps: 4 | Train Loss: 1.553 Vali Loss: 1.574 Vali Acc: 0.220 Test Loss: 1.574 Test Acc: 0.220
Validation loss decreased (-0.219984 --> -0.219984).  Saving model ...
Epoch: 3 cost time: 2.479834794998169
Epoch: 3, Steps: 4 | Train Loss: 1.415 Vali Loss: 1.546 Vali Acc: 0.260 Test Loss: 1.546 Test Acc: 0.260
Validation loss decreased (-0.219984 --> -0.259985).  Saving model ...
Epoch: 4 cost time: 2.5478885173797607
Epoch: 4, Steps: 4 | Train Loss: 1.256 Vali Loss: 1.450 Vali Acc: 0.440 Test Loss: 1.450 Test Acc: 0.440
Validation loss decreased (-0.259985 --> -0.439986).  Saving model ...
Epoch: 5 cost time: 2.566779136657715
Epoch: 5, Steps: 4 | Train Loss: 1.145 Vali Loss: 1.373 Vali Acc: 0.520 Test Loss: 1.373 Test Acc: 0.520
Validation loss decreased (-0.439986 --> -0.519986).  Saving model ...
Epoch: 6 cost time: 2.4255216121673584
Epoch: 6, Steps: 4 | Train Loss: 0.784 Vali Loss: 1.317 Vali Acc: 0.500 Test Loss: 1.317 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.4798991680145264
Epoch: 7, Steps: 4 | Train Loss: 0.579 Vali Loss: 1.306 Vali Acc: 0.480 Test Loss: 1.306 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.4924283027648926
Epoch: 8, Steps: 4 | Train Loss: 0.414 Vali Loss: 1.227 Vali Acc: 0.500 Test Loss: 1.227 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.4213149547576904
Epoch: 9, Steps: 4 | Train Loss: 0.287 Vali Loss: 1.139 Vali Acc: 0.540 Test Loss: 1.139 Test Acc: 0.540
Validation loss decreased (-0.519986 --> -0.539989).  Saving model ...
Epoch: 10 cost time: 2.4089910984039307
Epoch: 10, Steps: 4 | Train Loss: 0.221 Vali Loss: 1.115 Vali Acc: 0.560 Test Loss: 1.115 Test Acc: 0.560
Validation loss decreased (-0.539989 --> -0.559989).  Saving model ...
Epoch: 11 cost time: 2.4804067611694336
Epoch: 11, Steps: 4 | Train Loss: 0.502 Vali Loss: 1.135 Vali Acc: 0.600 Test Loss: 1.135 Test Acc: 0.600
Validation loss decreased (-0.559989 --> -0.599989).  Saving model ...
Epoch: 12 cost time: 2.559330940246582
Epoch: 12, Steps: 4 | Train Loss: 0.120 Vali Loss: 1.175 Vali Acc: 0.540 Test Loss: 1.175 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.592487335205078
Epoch: 13, Steps: 4 | Train Loss: 0.088 Vali Loss: 1.143 Vali Acc: 0.560 Test Loss: 1.143 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.5392329692840576
Epoch: 14, Steps: 4 | Train Loss: 0.085 Vali Loss: 1.119 Vali Acc: 0.560 Test Loss: 1.119 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.56642746925354
Epoch: 15, Steps: 4 | Train Loss: 0.040 Vali Loss: 1.177 Vali Acc: 0.540 Test Loss: 1.177 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.7541592121124268
Epoch: 16, Steps: 4 | Train Loss: 0.035 Vali Loss: 1.230 Vali Acc: 0.520 Test Loss: 1.230 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.6753761768341064
Epoch: 17, Steps: 4 | Train Loss: 0.032 Vali Loss: 1.175 Vali Acc: 0.540 Test Loss: 1.175 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.7266151905059814
Epoch: 18, Steps: 4 | Train Loss: 0.022 Vali Loss: 1.078 Vali Acc: 0.560 Test Loss: 1.078 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.558607578277588
Epoch: 19, Steps: 4 | Train Loss: 0.028 Vali Loss: 1.189 Vali Acc: 0.540 Test Loss: 1.189 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.49100661277771
Epoch: 20, Steps: 4 | Train Loss: 0.009 Vali Loss: 1.764 Vali Acc: 0.520 Test Loss: 1.764 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.63330078125
Epoch: 21, Steps: 4 | Train Loss: 0.022 Vali Loss: 1.331 Vali Acc: 0.560 Test Loss: 1.331 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm64_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 8606405
model size : 34.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm64_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 7.7902374267578125
Epoch: 1, Steps: 4 | Train Loss: 1.666 Vali Loss: 1.670 Vali Acc: 0.220 Test Loss: 1.670 Test Acc: 0.220
Validation loss decreased (inf --> -0.219983).  Saving model ...
Epoch: 2 cost time: 5.862475872039795
Epoch: 2, Steps: 4 | Train Loss: 1.648 Vali Loss: 1.628 Vali Acc: 0.360 Test Loss: 1.628 Test Acc: 0.360
Validation loss decreased (-0.219983 --> -0.359984).  Saving model ...
Epoch: 3 cost time: 5.922236919403076
Epoch: 3, Steps: 4 | Train Loss: 1.396 Vali Loss: 1.597 Vali Acc: 0.340 Test Loss: 1.597 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.923201084136963
Epoch: 4, Steps: 4 | Train Loss: 1.146 Vali Loss: 1.588 Vali Acc: 0.380 Test Loss: 1.588 Test Acc: 0.380
Validation loss decreased (-0.359984 --> -0.379984).  Saving model ...
Epoch: 5 cost time: 5.76479434967041
Epoch: 5, Steps: 4 | Train Loss: 1.137 Vali Loss: 1.561 Vali Acc: 0.360 Test Loss: 1.561 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.7690675258636475
Epoch: 6, Steps: 4 | Train Loss: 0.878 Vali Loss: 1.460 Vali Acc: 0.440 Test Loss: 1.460 Test Acc: 0.440
Validation loss decreased (-0.379984 --> -0.439985).  Saving model ...
Epoch: 7 cost time: 5.742534875869751
Epoch: 7, Steps: 4 | Train Loss: 0.656 Vali Loss: 1.389 Vali Acc: 0.560 Test Loss: 1.389 Test Acc: 0.560
Validation loss decreased (-0.439985 --> -0.559986).  Saving model ...
Epoch: 8 cost time: 5.63249397277832
Epoch: 8, Steps: 4 | Train Loss: 0.469 Vali Loss: 1.412 Vali Acc: 0.540 Test Loss: 1.412 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.741182327270508
Epoch: 9, Steps: 4 | Train Loss: 0.315 Vali Loss: 1.410 Vali Acc: 0.540 Test Loss: 1.410 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.868525743484497
Epoch: 10, Steps: 4 | Train Loss: 0.287 Vali Loss: 1.287 Vali Acc: 0.540 Test Loss: 1.287 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 5.615421772003174
Epoch: 11, Steps: 4 | Train Loss: 0.217 Vali Loss: 1.238 Vali Acc: 0.500 Test Loss: 1.238 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 5.654528617858887
Epoch: 12, Steps: 4 | Train Loss: 0.130 Vali Loss: 1.275 Vali Acc: 0.540 Test Loss: 1.275 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 5.3973777294158936
Epoch: 13, Steps: 4 | Train Loss: 0.121 Vali Loss: 1.168 Vali Acc: 0.460 Test Loss: 1.168 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 5.341191530227661
Epoch: 14, Steps: 4 | Train Loss: 0.093 Vali Loss: 1.176 Vali Acc: 0.480 Test Loss: 1.176 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 5.4897496700286865
Epoch: 15, Steps: 4 | Train Loss: 0.043 Vali Loss: 1.200 Vali Acc: 0.520 Test Loss: 1.200 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 5.428516864776611
Epoch: 16, Steps: 4 | Train Loss: 0.037 Vali Loss: 1.223 Vali Acc: 0.540 Test Loss: 1.223 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 5.28105616569519
Epoch: 17, Steps: 4 | Train Loss: 0.034 Vali Loss: 1.394 Vali Acc: 0.500 Test Loss: 1.394 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm64_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 14405957
model size : 56.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm64_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.276482820510864
Epoch: 1, Steps: 4 | Train Loss: 1.711 Vali Loss: 1.646 Vali Acc: 0.260 Test Loss: 1.646 Test Acc: 0.260
Validation loss decreased (inf --> -0.259984).  Saving model ...
Epoch: 2 cost time: 2.756671905517578
Epoch: 2, Steps: 4 | Train Loss: 1.584 Vali Loss: 1.607 Vali Acc: 0.320 Test Loss: 1.607 Test Acc: 0.320
Validation loss decreased (-0.259984 --> -0.319984).  Saving model ...
Epoch: 3 cost time: 2.7276251316070557
Epoch: 3, Steps: 4 | Train Loss: 1.400 Vali Loss: 1.561 Vali Acc: 0.380 Test Loss: 1.561 Test Acc: 0.380
Validation loss decreased (-0.319984 --> -0.379984).  Saving model ...
Epoch: 4 cost time: 2.5687711238861084
Epoch: 4, Steps: 4 | Train Loss: 1.247 Vali Loss: 1.516 Vali Acc: 0.460 Test Loss: 1.516 Test Acc: 0.460
Validation loss decreased (-0.379984 --> -0.459985).  Saving model ...
Epoch: 5 cost time: 2.6199545860290527
Epoch: 5, Steps: 4 | Train Loss: 1.058 Vali Loss: 1.438 Vali Acc: 0.480 Test Loss: 1.438 Test Acc: 0.480
Validation loss decreased (-0.459985 --> -0.479986).  Saving model ...
Epoch: 6 cost time: 2.6686785221099854
Epoch: 6, Steps: 4 | Train Loss: 0.852 Vali Loss: 1.359 Vali Acc: 0.440 Test Loss: 1.359 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.5592503547668457
Epoch: 7, Steps: 4 | Train Loss: 0.641 Vali Loss: 1.287 Vali Acc: 0.440 Test Loss: 1.287 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.5782663822174072
Epoch: 8, Steps: 4 | Train Loss: 0.527 Vali Loss: 1.271 Vali Acc: 0.440 Test Loss: 1.271 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.606275796890259
Epoch: 9, Steps: 4 | Train Loss: 0.333 Vali Loss: 1.263 Vali Acc: 0.480 Test Loss: 1.263 Test Acc: 0.480
Validation loss decreased (-0.479986 --> -0.479987).  Saving model ...
Epoch: 10 cost time: 2.7766335010528564
Epoch: 10, Steps: 4 | Train Loss: 0.398 Vali Loss: 1.272 Vali Acc: 0.500 Test Loss: 1.272 Test Acc: 0.500
Validation loss decreased (-0.479987 --> -0.499987).  Saving model ...
Epoch: 11 cost time: 2.778247594833374
Epoch: 11, Steps: 4 | Train Loss: 0.434 Vali Loss: 1.143 Vali Acc: 0.560 Test Loss: 1.143 Test Acc: 0.560
Validation loss decreased (-0.499987 --> -0.559989).  Saving model ...
Epoch: 12 cost time: 2.708137035369873
Epoch: 12, Steps: 4 | Train Loss: 0.197 Vali Loss: 1.092 Vali Acc: 0.520 Test Loss: 1.092 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.7409095764160156
Epoch: 13, Steps: 4 | Train Loss: 0.094 Vali Loss: 1.416 Vali Acc: 0.520 Test Loss: 1.416 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.78263258934021
Epoch: 14, Steps: 4 | Train Loss: 0.117 Vali Loss: 1.340 Vali Acc: 0.540 Test Loss: 1.340 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.742645740509033
Epoch: 15, Steps: 4 | Train Loss: 0.061 Vali Loss: 1.127 Vali Acc: 0.560 Test Loss: 1.127 Test Acc: 0.560
Validation loss decreased (-0.559989 --> -0.559989).  Saving model ...
Epoch: 16 cost time: 2.8435802459716797
Epoch: 16, Steps: 4 | Train Loss: 0.044 Vali Loss: 1.150 Vali Acc: 0.540 Test Loss: 1.150 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.7496588230133057
Epoch: 17, Steps: 4 | Train Loss: 0.029 Vali Loss: 1.115 Vali Acc: 0.580 Test Loss: 1.115 Test Acc: 0.580
Validation loss decreased (-0.559989 --> -0.579989).  Saving model ...
Epoch: 18 cost time: 2.7383761405944824
Epoch: 18, Steps: 4 | Train Loss: 0.018 Vali Loss: 1.071 Vali Acc: 0.540 Test Loss: 1.071 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.805415153503418
Epoch: 19, Steps: 4 | Train Loss: 0.014 Vali Loss: 1.221 Vali Acc: 0.600 Test Loss: 1.221 Test Acc: 0.600
Validation loss decreased (-0.579989 --> -0.599988).  Saving model ...
Epoch: 20 cost time: 2.7556393146514893
Epoch: 20, Steps: 4 | Train Loss: 0.010 Vali Loss: 1.351 Vali Acc: 0.600 Test Loss: 1.351 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.7053511142730713
Epoch: 21, Steps: 4 | Train Loss: 0.029 Vali Loss: 1.368 Vali Acc: 0.600 Test Loss: 1.368 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.8786683082580566
Epoch: 22, Steps: 4 | Train Loss: 0.015 Vali Loss: 1.421 Vali Acc: 0.600 Test Loss: 1.421 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.7875421047210693
Epoch: 23, Steps: 4 | Train Loss: 0.008 Vali Loss: 1.764 Vali Acc: 0.600 Test Loss: 1.764 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.7622032165527344
Epoch: 24, Steps: 4 | Train Loss: 0.016 Vali Loss: 1.368 Vali Acc: 0.580 Test Loss: 1.368 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.68772292137146
Epoch: 25, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.186 Vali Acc: 0.580 Test Loss: 1.186 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.560302734375
Epoch: 26, Steps: 4 | Train Loss: 0.011 Vali Loss: 1.315 Vali Acc: 0.580 Test Loss: 1.315 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.7177791595458984
Epoch: 27, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.641 Vali Acc: 0.560 Test Loss: 1.641 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.832631826400757
Epoch: 28, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.688 Vali Acc: 0.560 Test Loss: 1.688 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.731708288192749
Epoch: 29, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.553 Vali Acc: 0.600 Test Loss: 1.553 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm64_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 4476101
model size : 18.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm64_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 6.170227527618408
Epoch: 1, Steps: 4 | Train Loss: 1.666 Vali Loss: 1.668 Vali Acc: 0.220 Test Loss: 1.668 Test Acc: 0.220
Validation loss decreased (inf --> -0.219983).  Saving model ...
Epoch: 2 cost time: 4.2703282833099365
Epoch: 2, Steps: 4 | Train Loss: 1.648 Vali Loss: 1.626 Vali Acc: 0.360 Test Loss: 1.626 Test Acc: 0.360
Validation loss decreased (-0.219983 --> -0.359984).  Saving model ...
Epoch: 3 cost time: 4.336364984512329
Epoch: 3, Steps: 4 | Train Loss: 1.396 Vali Loss: 1.597 Vali Acc: 0.340 Test Loss: 1.597 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.225971460342407
Epoch: 4, Steps: 4 | Train Loss: 1.146 Vali Loss: 1.591 Vali Acc: 0.380 Test Loss: 1.591 Test Acc: 0.380
Validation loss decreased (-0.359984 --> -0.379984).  Saving model ...
Epoch: 5 cost time: 4.209101438522339
Epoch: 5, Steps: 4 | Train Loss: 1.137 Vali Loss: 1.568 Vali Acc: 0.380 Test Loss: 1.568 Test Acc: 0.380
Validation loss decreased (-0.379984 --> -0.379984).  Saving model ...
Epoch: 6 cost time: 4.161243438720703
Epoch: 6, Steps: 4 | Train Loss: 0.879 Vali Loss: 1.469 Vali Acc: 0.420 Test Loss: 1.469 Test Acc: 0.420
Validation loss decreased (-0.379984 --> -0.419985).  Saving model ...
Epoch: 7 cost time: 4.095176458358765
Epoch: 7, Steps: 4 | Train Loss: 0.656 Vali Loss: 1.401 Vali Acc: 0.520 Test Loss: 1.401 Test Acc: 0.520
Validation loss decreased (-0.419985 --> -0.519986).  Saving model ...
Epoch: 8 cost time: 4.074315786361694
Epoch: 8, Steps: 4 | Train Loss: 0.469 Vali Loss: 1.427 Vali Acc: 0.520 Test Loss: 1.427 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.130110502243042
Epoch: 9, Steps: 4 | Train Loss: 0.317 Vali Loss: 1.428 Vali Acc: 0.520 Test Loss: 1.428 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.189140796661377
Epoch: 10, Steps: 4 | Train Loss: 0.286 Vali Loss: 1.303 Vali Acc: 0.520 Test Loss: 1.303 Test Acc: 0.520
Validation loss decreased (-0.519986 --> -0.519987).  Saving model ...
Epoch: 11 cost time: 4.1212568283081055
Epoch: 11, Steps: 4 | Train Loss: 0.218 Vali Loss: 1.251 Vali Acc: 0.480 Test Loss: 1.251 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.160096883773804
Epoch: 12, Steps: 4 | Train Loss: 0.130 Vali Loss: 1.285 Vali Acc: 0.520 Test Loss: 1.285 Test Acc: 0.520
Validation loss decreased (-0.519987 --> -0.519987).  Saving model ...
Epoch: 13 cost time: 4.175312757492065
Epoch: 13, Steps: 4 | Train Loss: 0.121 Vali Loss: 1.176 Vali Acc: 0.480 Test Loss: 1.176 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.214027404785156
Epoch: 14, Steps: 4 | Train Loss: 0.093 Vali Loss: 1.189 Vali Acc: 0.480 Test Loss: 1.189 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.135207176208496
Epoch: 15, Steps: 4 | Train Loss: 0.046 Vali Loss: 1.220 Vali Acc: 0.520 Test Loss: 1.220 Test Acc: 0.520
Validation loss decreased (-0.519987 --> -0.519988).  Saving model ...
Epoch: 16 cost time: 4.155277252197266
Epoch: 16, Steps: 4 | Train Loss: 0.038 Vali Loss: 1.252 Vali Acc: 0.500 Test Loss: 1.252 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.202364206314087
Epoch: 17, Steps: 4 | Train Loss: 0.037 Vali Loss: 1.414 Vali Acc: 0.460 Test Loss: 1.414 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.128258228302002
Epoch: 18, Steps: 4 | Train Loss: 0.035 Vali Loss: 1.375 Vali Acc: 0.500 Test Loss: 1.375 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 4.064101457595825
Epoch: 19, Steps: 4 | Train Loss: 0.019 Vali Loss: 1.513 Vali Acc: 0.540 Test Loss: 1.513 Test Acc: 0.540
Validation loss decreased (-0.519988 --> -0.539985).  Saving model ...
Epoch: 20 cost time: 4.0709147453308105
Epoch: 20, Steps: 4 | Train Loss: 0.029 Vali Loss: 1.522 Vali Acc: 0.540 Test Loss: 1.522 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 4.1440019607543945
Epoch: 21, Steps: 4 | Train Loss: 0.010 Vali Loss: 1.499 Vali Acc: 0.560 Test Loss: 1.499 Test Acc: 0.560
Validation loss decreased (-0.539985 --> -0.559985).  Saving model ...
Epoch: 22 cost time: 4.371602296829224
Epoch: 22, Steps: 4 | Train Loss: 0.042 Vali Loss: 1.523 Vali Acc: 0.580 Test Loss: 1.523 Test Acc: 0.580
Validation loss decreased (-0.559985 --> -0.579985).  Saving model ...
Epoch: 23 cost time: 4.112616777420044
Epoch: 23, Steps: 4 | Train Loss: 0.007 Vali Loss: 1.573 Vali Acc: 0.540 Test Loss: 1.573 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 4.164417505264282
Epoch: 24, Steps: 4 | Train Loss: 0.008 Vali Loss: 1.375 Vali Acc: 0.520 Test Loss: 1.375 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 4.176291465759277
Epoch: 25, Steps: 4 | Train Loss: 0.006 Vali Loss: 1.338 Vali Acc: 0.560 Test Loss: 1.338 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 4.200217962265015
Epoch: 26, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.382 Vali Acc: 0.620 Test Loss: 1.382 Test Acc: 0.620
Validation loss decreased (-0.579985 --> -0.619986).  Saving model ...
Epoch: 27 cost time: 4.145146369934082
Epoch: 27, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.352 Vali Acc: 0.640 Test Loss: 1.352 Test Acc: 0.640
Validation loss decreased (-0.619986 --> -0.639986).  Saving model ...
Epoch: 28 cost time: 4.182608127593994
Epoch: 28, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.324 Vali Acc: 0.600 Test Loss: 1.324 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 4.242326259613037
Epoch: 29, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.357 Vali Acc: 0.620 Test Loss: 1.357 Test Acc: 0.620
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.9015989303588867
Epoch: 30, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.318 Vali Acc: 0.640 Test Loss: 1.318 Test Acc: 0.640
Validation loss decreased (-0.639986 --> -0.639987).  Saving model ...
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm64_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.64
model parameter : 14405957
model size : 56.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm64_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.023339509963989
Epoch: 1, Steps: 4 | Train Loss: 1.710 Vali Loss: 1.645 Vali Acc: 0.260 Test Loss: 1.645 Test Acc: 0.260
Validation loss decreased (inf --> -0.259984).  Saving model ...
Epoch: 2 cost time: 2.27694034576416
Epoch: 2, Steps: 4 | Train Loss: 1.583 Vali Loss: 1.607 Vali Acc: 0.320 Test Loss: 1.607 Test Acc: 0.320
Validation loss decreased (-0.259984 --> -0.319984).  Saving model ...
Epoch: 3 cost time: 2.3706135749816895
Epoch: 3, Steps: 4 | Train Loss: 1.400 Vali Loss: 1.562 Vali Acc: 0.360 Test Loss: 1.562 Test Acc: 0.360
Validation loss decreased (-0.319984 --> -0.359984).  Saving model ...
Epoch: 4 cost time: 2.31567120552063
Epoch: 4, Steps: 4 | Train Loss: 1.258 Vali Loss: 1.519 Vali Acc: 0.440 Test Loss: 1.519 Test Acc: 0.440
Validation loss decreased (-0.359984 --> -0.439985).  Saving model ...
Epoch: 5 cost time: 2.2911834716796875
Epoch: 5, Steps: 4 | Train Loss: 1.056 Vali Loss: 1.442 Vali Acc: 0.440 Test Loss: 1.442 Test Acc: 0.440
Validation loss decreased (-0.439985 --> -0.439986).  Saving model ...
Epoch: 6 cost time: 2.323357343673706
Epoch: 6, Steps: 4 | Train Loss: 0.856 Vali Loss: 1.361 Vali Acc: 0.420 Test Loss: 1.361 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.262312889099121
Epoch: 7, Steps: 4 | Train Loss: 0.636 Vali Loss: 1.287 Vali Acc: 0.460 Test Loss: 1.287 Test Acc: 0.460
Validation loss decreased (-0.439986 --> -0.459987).  Saving model ...
Epoch: 8 cost time: 2.1888792514801025
Epoch: 8, Steps: 4 | Train Loss: 0.525 Vali Loss: 1.275 Vali Acc: 0.460 Test Loss: 1.275 Test Acc: 0.460
Validation loss decreased (-0.459987 --> -0.459987).  Saving model ...
Epoch: 9 cost time: 2.3135833740234375
Epoch: 9, Steps: 4 | Train Loss: 0.329 Vali Loss: 1.271 Vali Acc: 0.460 Test Loss: 1.271 Test Acc: 0.460
Validation loss decreased (-0.459987 --> -0.459987).  Saving model ...
Epoch: 10 cost time: 2.240391254425049
Epoch: 10, Steps: 4 | Train Loss: 0.372 Vali Loss: 1.269 Vali Acc: 0.540 Test Loss: 1.269 Test Acc: 0.540
Validation loss decreased (-0.459987 --> -0.539987).  Saving model ...
Epoch: 11 cost time: 2.2007927894592285
Epoch: 11, Steps: 4 | Train Loss: 0.421 Vali Loss: 1.116 Vali Acc: 0.560 Test Loss: 1.116 Test Acc: 0.560
Validation loss decreased (-0.539987 --> -0.559989).  Saving model ...
Epoch: 12 cost time: 2.2289514541625977
Epoch: 12, Steps: 4 | Train Loss: 0.201 Vali Loss: 1.064 Vali Acc: 0.520 Test Loss: 1.064 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.30615496635437
Epoch: 13, Steps: 4 | Train Loss: 0.090 Vali Loss: 1.415 Vali Acc: 0.500 Test Loss: 1.415 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.337071180343628
Epoch: 14, Steps: 4 | Train Loss: 0.116 Vali Loss: 1.321 Vali Acc: 0.560 Test Loss: 1.321 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.416785955429077
Epoch: 15, Steps: 4 | Train Loss: 0.060 Vali Loss: 1.086 Vali Acc: 0.580 Test Loss: 1.086 Test Acc: 0.580
Validation loss decreased (-0.559989 --> -0.579989).  Saving model ...
Epoch: 16 cost time: 2.4697389602661133
Epoch: 16, Steps: 4 | Train Loss: 0.044 Vali Loss: 1.105 Vali Acc: 0.580 Test Loss: 1.105 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.35453200340271
Epoch: 17, Steps: 4 | Train Loss: 0.027 Vali Loss: 1.073 Vali Acc: 0.580 Test Loss: 1.073 Test Acc: 0.580
Validation loss decreased (-0.579989 --> -0.579989).  Saving model ...
Epoch: 18 cost time: 2.290559768676758
Epoch: 18, Steps: 4 | Train Loss: 0.017 Vali Loss: 1.046 Vali Acc: 0.600 Test Loss: 1.046 Test Acc: 0.600
Validation loss decreased (-0.579989 --> -0.599990).  Saving model ...
Epoch: 19 cost time: 2.559772253036499
Epoch: 19, Steps: 4 | Train Loss: 0.013 Vali Loss: 1.191 Vali Acc: 0.600 Test Loss: 1.191 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.3777952194213867
Epoch: 20, Steps: 4 | Train Loss: 0.010 Vali Loss: 1.302 Vali Acc: 0.600 Test Loss: 1.302 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.4565253257751465
Epoch: 21, Steps: 4 | Train Loss: 0.015 Vali Loss: 1.222 Vali Acc: 0.600 Test Loss: 1.222 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.3578004837036133
Epoch: 22, Steps: 4 | Train Loss: 0.014 Vali Loss: 1.299 Vali Acc: 0.600 Test Loss: 1.299 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.351907968521118
Epoch: 23, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.681 Vali Acc: 0.580 Test Loss: 1.681 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.38871431350708
Epoch: 24, Steps: 4 | Train Loss: 0.015 Vali Loss: 1.371 Vali Acc: 0.600 Test Loss: 1.371 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.2989280223846436
Epoch: 25, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.263 Vali Acc: 0.560 Test Loss: 1.263 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.414417028427124
Epoch: 26, Steps: 4 | Train Loss: 0.010 Vali Loss: 1.446 Vali Acc: 0.560 Test Loss: 1.446 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.3285253047943115
Epoch: 27, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.755 Vali Acc: 0.540 Test Loss: 1.755 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.3857805728912354
Epoch: 28, Steps: 4 | Train Loss: 0.007 Vali Loss: 1.660 Vali Acc: 0.560 Test Loss: 1.660 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm64_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 4476101
model size : 18.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm64_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 5.075763702392578
Epoch: 1, Steps: 4 | Train Loss: 1.663 Vali Loss: 1.669 Vali Acc: 0.220 Test Loss: 1.669 Test Acc: 0.220
Validation loss decreased (inf --> -0.219983).  Saving model ...
Epoch: 2 cost time: 3.3393423557281494
Epoch: 2, Steps: 4 | Train Loss: 1.649 Vali Loss: 1.627 Vali Acc: 0.340 Test Loss: 1.627 Test Acc: 0.340
Validation loss decreased (-0.219983 --> -0.339984).  Saving model ...
Epoch: 3 cost time: 3.0751798152923584
Epoch: 3, Steps: 4 | Train Loss: 1.400 Vali Loss: 1.599 Vali Acc: 0.340 Test Loss: 1.599 Test Acc: 0.340
Validation loss decreased (-0.339984 --> -0.339984).  Saving model ...
Epoch: 4 cost time: 3.006281614303589
Epoch: 4, Steps: 4 | Train Loss: 1.155 Vali Loss: 1.593 Vali Acc: 0.380 Test Loss: 1.593 Test Acc: 0.380
Validation loss decreased (-0.339984 --> -0.379984).  Saving model ...
Epoch: 5 cost time: 3.0527689456939697
Epoch: 5, Steps: 4 | Train Loss: 1.147 Vali Loss: 1.570 Vali Acc: 0.360 Test Loss: 1.570 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.1567556858062744
Epoch: 6, Steps: 4 | Train Loss: 0.925 Vali Loss: 1.473 Vali Acc: 0.380 Test Loss: 1.473 Test Acc: 0.380
Validation loss decreased (-0.379984 --> -0.379985).  Saving model ...
Epoch: 7 cost time: 3.1820361614227295
Epoch: 7, Steps: 4 | Train Loss: 0.682 Vali Loss: 1.410 Vali Acc: 0.480 Test Loss: 1.410 Test Acc: 0.480
Validation loss decreased (-0.379985 --> -0.479986).  Saving model ...
Epoch: 8 cost time: 3.0658555030822754
Epoch: 8, Steps: 4 | Train Loss: 0.494 Vali Loss: 1.433 Vali Acc: 0.480 Test Loss: 1.433 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.1642539501190186
Epoch: 9, Steps: 4 | Train Loss: 0.334 Vali Loss: 1.436 Vali Acc: 0.480 Test Loss: 1.436 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.9778761863708496
Epoch: 10, Steps: 4 | Train Loss: 0.306 Vali Loss: 1.339 Vali Acc: 0.460 Test Loss: 1.339 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.0876476764678955
Epoch: 11, Steps: 4 | Train Loss: 0.231 Vali Loss: 1.272 Vali Acc: 0.480 Test Loss: 1.272 Test Acc: 0.480
Validation loss decreased (-0.479986 --> -0.479987).  Saving model ...
Epoch: 12 cost time: 3.214277744293213
Epoch: 12, Steps: 4 | Train Loss: 0.136 Vali Loss: 1.306 Vali Acc: 0.520 Test Loss: 1.306 Test Acc: 0.520
Validation loss decreased (-0.479987 --> -0.519987).  Saving model ...
Epoch: 13 cost time: 3.1884658336639404
Epoch: 13, Steps: 4 | Train Loss: 0.130 Vali Loss: 1.215 Vali Acc: 0.500 Test Loss: 1.215 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.883923292160034
Epoch: 14, Steps: 4 | Train Loss: 0.088 Vali Loss: 1.207 Vali Acc: 0.480 Test Loss: 1.207 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.0228967666625977
Epoch: 15, Steps: 4 | Train Loss: 0.046 Vali Loss: 1.287 Vali Acc: 0.540 Test Loss: 1.287 Test Acc: 0.540
Validation loss decreased (-0.519987 --> -0.539987).  Saving model ...
Epoch: 16 cost time: 3.0801210403442383
Epoch: 16, Steps: 4 | Train Loss: 0.044 Vali Loss: 1.301 Vali Acc: 0.500 Test Loss: 1.301 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.0074055194854736
Epoch: 17, Steps: 4 | Train Loss: 0.041 Vali Loss: 1.410 Vali Acc: 0.540 Test Loss: 1.410 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.844634532928467
Epoch: 18, Steps: 4 | Train Loss: 0.029 Vali Loss: 1.364 Vali Acc: 0.500 Test Loss: 1.364 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.0055007934570312
Epoch: 19, Steps: 4 | Train Loss: 0.015 Vali Loss: 1.421 Vali Acc: 0.500 Test Loss: 1.421 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.124056577682495
Epoch: 20, Steps: 4 | Train Loss: 0.016 Vali Loss: 1.434 Vali Acc: 0.540 Test Loss: 1.434 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.9829139709472656
Epoch: 21, Steps: 4 | Train Loss: 0.009 Vali Loss: 1.460 Vali Acc: 0.560 Test Loss: 1.460 Test Acc: 0.560
Validation loss decreased (-0.539987 --> -0.559985).  Saving model ...
Epoch: 22 cost time: 2.9571924209594727
Epoch: 22, Steps: 4 | Train Loss: 0.595 Vali Loss: 1.615 Vali Acc: 0.520 Test Loss: 1.615 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.7988717555999756
Epoch: 23, Steps: 4 | Train Loss: 0.008 Vali Loss: 2.133 Vali Acc: 0.480 Test Loss: 2.133 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.8558950424194336
Epoch: 24, Steps: 4 | Train Loss: 0.011 Vali Loss: 1.806 Vali Acc: 0.500 Test Loss: 1.806 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.0607404708862305
Epoch: 25, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.585 Vali Acc: 0.480 Test Loss: 1.585 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.9883873462677
Epoch: 26, Steps: 4 | Train Loss: 0.007 Vali Loss: 1.517 Vali Acc: 0.440 Test Loss: 1.517 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 3.0346992015838623
Epoch: 27, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.605 Vali Acc: 0.500 Test Loss: 1.605 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.928351879119873
Epoch: 28, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.741 Vali Acc: 0.520 Test Loss: 1.741 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 2.9353089332580566
Epoch: 29, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.826 Vali Acc: 0.500 Test Loss: 1.826 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 2.9567630290985107
Epoch: 30, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.716 Vali Acc: 0.520 Test Loss: 1.716 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm64_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 14405957
model size : 56.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm64_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.6216917037963867
Epoch: 1, Steps: 4 | Train Loss: 1.710 Vali Loss: 1.650 Vali Acc: 0.240 Test Loss: 1.650 Test Acc: 0.240
Validation loss decreased (inf --> -0.239984).  Saving model ...
Epoch: 2 cost time: 1.7863094806671143
Epoch: 2, Steps: 4 | Train Loss: 1.585 Vali Loss: 1.611 Vali Acc: 0.320 Test Loss: 1.611 Test Acc: 0.320
Validation loss decreased (-0.239984 --> -0.319984).  Saving model ...
Epoch: 3 cost time: 1.7657253742218018
Epoch: 3, Steps: 4 | Train Loss: 1.408 Vali Loss: 1.566 Vali Acc: 0.380 Test Loss: 1.566 Test Acc: 0.380
Validation loss decreased (-0.319984 --> -0.379984).  Saving model ...
Epoch: 4 cost time: 1.846184253692627
Epoch: 4, Steps: 4 | Train Loss: 1.278 Vali Loss: 1.523 Vali Acc: 0.420 Test Loss: 1.523 Test Acc: 0.420
Validation loss decreased (-0.379984 --> -0.419985).  Saving model ...
Epoch: 5 cost time: 1.7765491008758545
Epoch: 5, Steps: 4 | Train Loss: 1.070 Vali Loss: 1.443 Vali Acc: 0.420 Test Loss: 1.443 Test Acc: 0.420
Validation loss decreased (-0.419985 --> -0.419986).  Saving model ...
Epoch: 6 cost time: 1.8465087413787842
Epoch: 6, Steps: 4 | Train Loss: 0.893 Vali Loss: 1.358 Vali Acc: 0.400 Test Loss: 1.358 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7948360443115234
Epoch: 7, Steps: 4 | Train Loss: 0.670 Vali Loss: 1.279 Vali Acc: 0.460 Test Loss: 1.279 Test Acc: 0.460
Validation loss decreased (-0.419986 --> -0.459987).  Saving model ...
Epoch: 8 cost time: 1.807495355606079
Epoch: 8, Steps: 4 | Train Loss: 0.545 Vali Loss: 1.258 Vali Acc: 0.460 Test Loss: 1.258 Test Acc: 0.460
Validation loss decreased (-0.459987 --> -0.459987).  Saving model ...
Epoch: 9 cost time: 2.0122768878936768
Epoch: 9, Steps: 4 | Train Loss: 0.355 Vali Loss: 1.269 Vali Acc: 0.460 Test Loss: 1.269 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.8960838317871094
Epoch: 10, Steps: 4 | Train Loss: 0.363 Vali Loss: 1.255 Vali Acc: 0.540 Test Loss: 1.255 Test Acc: 0.540
Validation loss decreased (-0.459987 --> -0.539987).  Saving model ...
Epoch: 11 cost time: 1.9167675971984863
Epoch: 11, Steps: 4 | Train Loss: 0.419 Vali Loss: 1.105 Vali Acc: 0.580 Test Loss: 1.105 Test Acc: 0.580
Validation loss decreased (-0.539987 --> -0.579989).  Saving model ...
Epoch: 12 cost time: 1.8506619930267334
Epoch: 12, Steps: 4 | Train Loss: 0.215 Vali Loss: 1.088 Vali Acc: 0.560 Test Loss: 1.088 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.799576997756958
Epoch: 13, Steps: 4 | Train Loss: 0.089 Vali Loss: 1.330 Vali Acc: 0.520 Test Loss: 1.330 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.8948063850402832
Epoch: 14, Steps: 4 | Train Loss: 0.098 Vali Loss: 1.201 Vali Acc: 0.580 Test Loss: 1.201 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.8308088779449463
Epoch: 15, Steps: 4 | Train Loss: 0.057 Vali Loss: 1.094 Vali Acc: 0.560 Test Loss: 1.094 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.8401615619659424
Epoch: 16, Steps: 4 | Train Loss: 0.039 Vali Loss: 1.052 Vali Acc: 0.580 Test Loss: 1.052 Test Acc: 0.580
Validation loss decreased (-0.579989 --> -0.579989).  Saving model ...
Epoch: 17 cost time: 1.875614881515503
Epoch: 17, Steps: 4 | Train Loss: 0.032 Vali Loss: 1.228 Vali Acc: 0.600 Test Loss: 1.228 Test Acc: 0.600
Validation loss decreased (-0.579989 --> -0.599988).  Saving model ...
Epoch: 18 cost time: 1.984199047088623
Epoch: 18, Steps: 4 | Train Loss: 0.031 Vali Loss: 1.215 Vali Acc: 0.580 Test Loss: 1.215 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.910996437072754
Epoch: 19, Steps: 4 | Train Loss: 0.023 Vali Loss: 1.168 Vali Acc: 0.540 Test Loss: 1.168 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.8055214881896973
Epoch: 20, Steps: 4 | Train Loss: 0.009 Vali Loss: 1.438 Vali Acc: 0.600 Test Loss: 1.438 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.8482749462127686
Epoch: 21, Steps: 4 | Train Loss: 0.033 Vali Loss: 1.410 Vali Acc: 0.580 Test Loss: 1.410 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.8679656982421875
Epoch: 22, Steps: 4 | Train Loss: 0.020 Vali Loss: 1.335 Vali Acc: 0.580 Test Loss: 1.335 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.811706781387329
Epoch: 23, Steps: 4 | Train Loss: 0.007 Vali Loss: 1.610 Vali Acc: 0.560 Test Loss: 1.610 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.9161169528961182
Epoch: 24, Steps: 4 | Train Loss: 0.014 Vali Loss: 1.448 Vali Acc: 0.540 Test Loss: 1.448 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.9291608333587646
Epoch: 25, Steps: 4 | Train Loss: 0.006 Vali Loss: 1.300 Vali Acc: 0.520 Test Loss: 1.300 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.8820445537567139
Epoch: 26, Steps: 4 | Train Loss: 0.007 Vali Loss: 1.416 Vali Acc: 0.540 Test Loss: 1.416 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.8499267101287842
Epoch: 27, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.672 Vali Acc: 0.540 Test Loss: 1.672 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm64_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 4476101
model size : 18.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm64_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 5.75750732421875
Epoch: 1, Steps: 4 | Train Loss: 1.605 Vali Loss: 1.536 Vali Acc: 0.240 Test Loss: 1.536 Test Acc: 0.240
Validation loss decreased (inf --> -0.239985).  Saving model ...
Epoch: 2 cost time: 3.849032402038574
Epoch: 2, Steps: 4 | Train Loss: 1.604 Vali Loss: 1.530 Vali Acc: 0.220 Test Loss: 1.530 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.916140556335449
Epoch: 3, Steps: 4 | Train Loss: 1.396 Vali Loss: 1.523 Vali Acc: 0.280 Test Loss: 1.523 Test Acc: 0.280
Validation loss decreased (-0.239985 --> -0.279985).  Saving model ...
Epoch: 4 cost time: 3.9525749683380127
Epoch: 4, Steps: 4 | Train Loss: 1.143 Vali Loss: 1.475 Vali Acc: 0.380 Test Loss: 1.475 Test Acc: 0.380
Validation loss decreased (-0.279985 --> -0.379985).  Saving model ...
Epoch: 5 cost time: 4.111510753631592
Epoch: 5, Steps: 4 | Train Loss: 1.127 Vali Loss: 1.375 Vali Acc: 0.460 Test Loss: 1.375 Test Acc: 0.460
Validation loss decreased (-0.379985 --> -0.459986).  Saving model ...
Epoch: 6 cost time: 4.02566123008728
Epoch: 6, Steps: 4 | Train Loss: 0.741 Vali Loss: 1.250 Vali Acc: 0.460 Test Loss: 1.250 Test Acc: 0.460
Validation loss decreased (-0.459986 --> -0.459988).  Saving model ...
Epoch: 7 cost time: 3.995242118835449
Epoch: 7, Steps: 4 | Train Loss: 0.525 Vali Loss: 1.194 Vali Acc: 0.400 Test Loss: 1.194 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.9753825664520264
Epoch: 8, Steps: 4 | Train Loss: 0.507 Vali Loss: 1.154 Vali Acc: 0.480 Test Loss: 1.154 Test Acc: 0.480
Validation loss decreased (-0.459988 --> -0.479988).  Saving model ...
Epoch: 9 cost time: 3.9336328506469727
Epoch: 9, Steps: 4 | Train Loss: 0.332 Vali Loss: 1.111 Vali Acc: 0.540 Test Loss: 1.111 Test Acc: 0.540
Validation loss decreased (-0.479988 --> -0.539989).  Saving model ...
Epoch: 10 cost time: 4.0235090255737305
Epoch: 10, Steps: 4 | Train Loss: 0.325 Vali Loss: 1.067 Vali Acc: 0.560 Test Loss: 1.067 Test Acc: 0.560
Validation loss decreased (-0.539989 --> -0.559989).  Saving model ...
Epoch: 11 cost time: 3.87978458404541
Epoch: 11, Steps: 4 | Train Loss: 0.375 Vali Loss: 1.092 Vali Acc: 0.500 Test Loss: 1.092 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.8262524604797363
Epoch: 12, Steps: 4 | Train Loss: 0.151 Vali Loss: 1.115 Vali Acc: 0.480 Test Loss: 1.115 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.9010331630706787
Epoch: 13, Steps: 4 | Train Loss: 0.086 Vali Loss: 1.274 Vali Acc: 0.500 Test Loss: 1.274 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.878481864929199
Epoch: 14, Steps: 4 | Train Loss: 0.119 Vali Loss: 1.231 Vali Acc: 0.520 Test Loss: 1.231 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.94533109664917
Epoch: 15, Steps: 4 | Train Loss: 0.070 Vali Loss: 1.138 Vali Acc: 0.560 Test Loss: 1.138 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.9926531314849854
Epoch: 16, Steps: 4 | Train Loss: 0.048 Vali Loss: 1.282 Vali Acc: 0.600 Test Loss: 1.282 Test Acc: 0.600
Validation loss decreased (-0.559989 --> -0.599987).  Saving model ...
Epoch: 17 cost time: 4.027620553970337
Epoch: 17, Steps: 4 | Train Loss: 0.093 Vali Loss: 1.338 Vali Acc: 0.560 Test Loss: 1.338 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.070383548736572
Epoch: 18, Steps: 4 | Train Loss: 0.035 Vali Loss: 1.182 Vali Acc: 0.540 Test Loss: 1.182 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 4.132530927658081
Epoch: 19, Steps: 4 | Train Loss: 0.015 Vali Loss: 1.259 Vali Acc: 0.580 Test Loss: 1.259 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 4.024209260940552
Epoch: 20, Steps: 4 | Train Loss: 0.015 Vali Loss: 1.221 Vali Acc: 0.580 Test Loss: 1.221 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.9919254779815674
Epoch: 21, Steps: 4 | Train Loss: 0.012 Vali Loss: 1.262 Vali Acc: 0.620 Test Loss: 1.262 Test Acc: 0.620
Validation loss decreased (-0.599987 --> -0.619987).  Saving model ...
Epoch: 22 cost time: 4.031161069869995
Epoch: 22, Steps: 4 | Train Loss: 0.008 Vali Loss: 1.353 Vali Acc: 0.640 Test Loss: 1.353 Test Acc: 0.640
Validation loss decreased (-0.619987 --> -0.639986).  Saving model ...
Epoch: 23 cost time: 3.906546115875244
Epoch: 23, Steps: 4 | Train Loss: 0.007 Vali Loss: 1.383 Vali Acc: 0.620 Test Loss: 1.383 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 4.082500696182251
Epoch: 24, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.400 Vali Acc: 0.600 Test Loss: 1.400 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.999079942703247
Epoch: 25, Steps: 4 | Train Loss: 0.007 Vali Loss: 1.401 Vali Acc: 0.600 Test Loss: 1.401 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.8857614994049072
Epoch: 26, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.436 Vali Acc: 0.600 Test Loss: 1.436 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 3.8766977787017822
Epoch: 27, Steps: 4 | Train Loss: 0.054 Vali Loss: 1.530 Vali Acc: 0.580 Test Loss: 1.530 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 4.19240665435791
Epoch: 28, Steps: 4 | Train Loss: 0.007 Vali Loss: 1.363 Vali Acc: 0.580 Test Loss: 1.363 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 4.094216346740723
Epoch: 29, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.309 Vali Acc: 0.600 Test Loss: 1.309 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 4.192403078079224
Epoch: 30, Steps: 4 | Train Loss: 0.006 Vali Loss: 1.350 Vali Acc: 0.560 Test Loss: 1.350 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm64_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.64
model parameter : 7376069
model size : 29.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm64_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.006382465362549
Epoch: 1, Steps: 4 | Train Loss: 1.646 Vali Loss: 1.717 Vali Acc: 0.120 Test Loss: 1.717 Test Acc: 0.120
Validation loss decreased (inf --> -0.119983).  Saving model ...
Epoch: 2 cost time: 2.1551308631896973
Epoch: 2, Steps: 4 | Train Loss: 1.503 Vali Loss: 1.669 Vali Acc: 0.180 Test Loss: 1.669 Test Acc: 0.180
Validation loss decreased (-0.119983 --> -0.179983).  Saving model ...
Epoch: 3 cost time: 2.165325403213501
Epoch: 3, Steps: 4 | Train Loss: 1.547 Vali Loss: 1.600 Vali Acc: 0.260 Test Loss: 1.600 Test Acc: 0.260
Validation loss decreased (-0.179983 --> -0.259984).  Saving model ...
Epoch: 4 cost time: 2.136174440383911
Epoch: 4, Steps: 4 | Train Loss: 1.164 Vali Loss: 1.527 Vali Acc: 0.380 Test Loss: 1.527 Test Acc: 0.380
Validation loss decreased (-0.259984 --> -0.379985).  Saving model ...
Epoch: 5 cost time: 2.133488893508911
Epoch: 5, Steps: 4 | Train Loss: 1.045 Vali Loss: 1.431 Vali Acc: 0.480 Test Loss: 1.431 Test Acc: 0.480
Validation loss decreased (-0.379985 --> -0.479986).  Saving model ...
Epoch: 6 cost time: 2.105595111846924
Epoch: 6, Steps: 4 | Train Loss: 0.817 Vali Loss: 1.364 Vali Acc: 0.480 Test Loss: 1.364 Test Acc: 0.480
Validation loss decreased (-0.479986 --> -0.479986).  Saving model ...
Epoch: 7 cost time: 2.1690781116485596
Epoch: 7, Steps: 4 | Train Loss: 0.544 Vali Loss: 1.259 Vali Acc: 0.520 Test Loss: 1.259 Test Acc: 0.520
Validation loss decreased (-0.479986 --> -0.519987).  Saving model ...
Epoch: 8 cost time: 2.1969902515411377
Epoch: 8, Steps: 4 | Train Loss: 0.409 Vali Loss: 1.181 Vali Acc: 0.540 Test Loss: 1.181 Test Acc: 0.540
Validation loss decreased (-0.519987 --> -0.539988).  Saving model ...
Epoch: 9 cost time: 2.1523523330688477
Epoch: 9, Steps: 4 | Train Loss: 0.337 Vali Loss: 1.241 Vali Acc: 0.540 Test Loss: 1.241 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.1227641105651855
Epoch: 10, Steps: 4 | Train Loss: 0.246 Vali Loss: 1.166 Vali Acc: 0.580 Test Loss: 1.166 Test Acc: 0.580
Validation loss decreased (-0.539988 --> -0.579988).  Saving model ...
Epoch: 11 cost time: 2.1296796798706055
Epoch: 11, Steps: 4 | Train Loss: 0.415 Vali Loss: 1.170 Vali Acc: 0.560 Test Loss: 1.170 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.1602134704589844
Epoch: 12, Steps: 4 | Train Loss: 0.137 Vali Loss: 1.189 Vali Acc: 0.580 Test Loss: 1.189 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.1207473278045654
Epoch: 13, Steps: 4 | Train Loss: 0.094 Vali Loss: 1.176 Vali Acc: 0.560 Test Loss: 1.176 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.168604612350464
Epoch: 14, Steps: 4 | Train Loss: 0.087 Vali Loss: 1.110 Vali Acc: 0.580 Test Loss: 1.110 Test Acc: 0.580
Validation loss decreased (-0.579988 --> -0.579989).  Saving model ...
Epoch: 15 cost time: 2.1324026584625244
Epoch: 15, Steps: 4 | Train Loss: 0.051 Vali Loss: 1.173 Vali Acc: 0.560 Test Loss: 1.173 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.188354969024658
Epoch: 16, Steps: 4 | Train Loss: 0.036 Vali Loss: 1.152 Vali Acc: 0.560 Test Loss: 1.152 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.12130069732666
Epoch: 17, Steps: 4 | Train Loss: 0.044 Vali Loss: 1.132 Vali Acc: 0.540 Test Loss: 1.132 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.07930064201355
Epoch: 18, Steps: 4 | Train Loss: 0.029 Vali Loss: 1.152 Vali Acc: 0.560 Test Loss: 1.152 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.1078872680664062
Epoch: 19, Steps: 4 | Train Loss: 0.015 Vali Loss: 1.241 Vali Acc: 0.520 Test Loss: 1.241 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.1251039505004883
Epoch: 20, Steps: 4 | Train Loss: 0.035 Vali Loss: 1.253 Vali Acc: 0.580 Test Loss: 1.253 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.1836326122283936
Epoch: 21, Steps: 4 | Train Loss: 0.011 Vali Loss: 1.204 Vali Acc: 0.580 Test Loss: 1.204 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.1449813842773438
Epoch: 22, Steps: 4 | Train Loss: 0.015 Vali Loss: 1.216 Vali Acc: 0.580 Test Loss: 1.216 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.218224287033081
Epoch: 23, Steps: 4 | Train Loss: 0.011 Vali Loss: 1.255 Vali Acc: 0.560 Test Loss: 1.255 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.1095633506774902
Epoch: 24, Steps: 4 | Train Loss: 0.007 Vali Loss: 1.347 Vali Acc: 0.580 Test Loss: 1.347 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm64_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 2410949
model size : 10.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm64_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 5.102178335189819
Epoch: 1, Steps: 4 | Train Loss: 1.605 Vali Loss: 1.536 Vali Acc: 0.240 Test Loss: 1.536 Test Acc: 0.240
Validation loss decreased (inf --> -0.239985).  Saving model ...
Epoch: 2 cost time: 3.023679494857788
Epoch: 2, Steps: 4 | Train Loss: 1.607 Vali Loss: 1.530 Vali Acc: 0.220 Test Loss: 1.530 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.95487642288208
Epoch: 3, Steps: 4 | Train Loss: 1.396 Vali Loss: 1.522 Vali Acc: 0.280 Test Loss: 1.522 Test Acc: 0.280
Validation loss decreased (-0.239985 --> -0.279985).  Saving model ...
Epoch: 4 cost time: 2.9699935913085938
Epoch: 4, Steps: 4 | Train Loss: 1.142 Vali Loss: 1.473 Vali Acc: 0.380 Test Loss: 1.473 Test Acc: 0.380
Validation loss decreased (-0.279985 --> -0.379985).  Saving model ...
Epoch: 5 cost time: 2.968550205230713
Epoch: 5, Steps: 4 | Train Loss: 1.131 Vali Loss: 1.373 Vali Acc: 0.460 Test Loss: 1.373 Test Acc: 0.460
Validation loss decreased (-0.379985 --> -0.459986).  Saving model ...
Epoch: 6 cost time: 3.0693063735961914
Epoch: 6, Steps: 4 | Train Loss: 0.740 Vali Loss: 1.247 Vali Acc: 0.460 Test Loss: 1.247 Test Acc: 0.460
Validation loss decreased (-0.459986 --> -0.459988).  Saving model ...
Epoch: 7 cost time: 3.158799886703491
Epoch: 7, Steps: 4 | Train Loss: 0.540 Vali Loss: 1.189 Vali Acc: 0.420 Test Loss: 1.189 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.080453395843506
Epoch: 8, Steps: 4 | Train Loss: 0.508 Vali Loss: 1.143 Vali Acc: 0.520 Test Loss: 1.143 Test Acc: 0.520
Validation loss decreased (-0.459988 --> -0.519989).  Saving model ...
Epoch: 9 cost time: 3.178861379623413
Epoch: 9, Steps: 4 | Train Loss: 0.331 Vali Loss: 1.097 Vali Acc: 0.560 Test Loss: 1.097 Test Acc: 0.560
Validation loss decreased (-0.519989 --> -0.559989).  Saving model ...
Epoch: 10 cost time: 3.215859889984131
Epoch: 10, Steps: 4 | Train Loss: 0.325 Vali Loss: 1.068 Vali Acc: 0.560 Test Loss: 1.068 Test Acc: 0.560
Validation loss decreased (-0.559989 --> -0.559989).  Saving model ...
Epoch: 11 cost time: 3.2081005573272705
Epoch: 11, Steps: 4 | Train Loss: 0.376 Vali Loss: 1.086 Vali Acc: 0.500 Test Loss: 1.086 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.1721248626708984
Epoch: 12, Steps: 4 | Train Loss: 0.151 Vali Loss: 1.108 Vali Acc: 0.480 Test Loss: 1.108 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.0869319438934326
Epoch: 13, Steps: 4 | Train Loss: 0.086 Vali Loss: 1.262 Vali Acc: 0.500 Test Loss: 1.262 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.0646817684173584
Epoch: 14, Steps: 4 | Train Loss: 0.119 Vali Loss: 1.215 Vali Acc: 0.520 Test Loss: 1.215 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.098620891571045
Epoch: 15, Steps: 4 | Train Loss: 0.070 Vali Loss: 1.120 Vali Acc: 0.560 Test Loss: 1.120 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.007952928543091
Epoch: 16, Steps: 4 | Train Loss: 0.048 Vali Loss: 1.265 Vali Acc: 0.600 Test Loss: 1.265 Test Acc: 0.600
Validation loss decreased (-0.559989 --> -0.599987).  Saving model ...
Epoch: 17 cost time: 3.1354148387908936
Epoch: 17, Steps: 4 | Train Loss: 0.093 Vali Loss: 1.319 Vali Acc: 0.580 Test Loss: 1.319 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.009722948074341
Epoch: 18, Steps: 4 | Train Loss: 0.035 Vali Loss: 1.194 Vali Acc: 0.540 Test Loss: 1.194 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.9789154529571533
Epoch: 19, Steps: 4 | Train Loss: 0.016 Vali Loss: 1.321 Vali Acc: 0.540 Test Loss: 1.321 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.0521388053894043
Epoch: 20, Steps: 4 | Train Loss: 0.015 Vali Loss: 1.296 Vali Acc: 0.560 Test Loss: 1.296 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.0817742347717285
Epoch: 21, Steps: 4 | Train Loss: 0.012 Vali Loss: 1.334 Vali Acc: 0.580 Test Loss: 1.334 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 3.0566670894622803
Epoch: 22, Steps: 4 | Train Loss: 0.008 Vali Loss: 1.424 Vali Acc: 0.580 Test Loss: 1.424 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 3.1130616664886475
Epoch: 23, Steps: 4 | Train Loss: 0.007 Vali Loss: 1.457 Vali Acc: 0.580 Test Loss: 1.457 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 3.1602468490600586
Epoch: 24, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.477 Vali Acc: 0.560 Test Loss: 1.477 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 3.129714012145996
Epoch: 25, Steps: 4 | Train Loss: 0.007 Vali Loss: 1.485 Vali Acc: 0.560 Test Loss: 1.485 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 3.075200319290161
Epoch: 26, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.531 Vali Acc: 0.560 Test Loss: 1.531 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm64_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 7376069
model size : 29.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm64_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.580772638320923
Epoch: 1, Steps: 4 | Train Loss: 1.646 Vali Loss: 1.716 Vali Acc: 0.120 Test Loss: 1.716 Test Acc: 0.120
Validation loss decreased (inf --> -0.119983).  Saving model ...
Epoch: 2 cost time: 1.7684440612792969
Epoch: 2, Steps: 4 | Train Loss: 1.502 Vali Loss: 1.668 Vali Acc: 0.180 Test Loss: 1.668 Test Acc: 0.180
Validation loss decreased (-0.119983 --> -0.179983).  Saving model ...
Epoch: 3 cost time: 1.7323684692382812
Epoch: 3, Steps: 4 | Train Loss: 1.547 Vali Loss: 1.600 Vali Acc: 0.260 Test Loss: 1.600 Test Acc: 0.260
Validation loss decreased (-0.179983 --> -0.259984).  Saving model ...
Epoch: 4 cost time: 1.747314691543579
Epoch: 4, Steps: 4 | Train Loss: 1.163 Vali Loss: 1.527 Vali Acc: 0.380 Test Loss: 1.527 Test Acc: 0.380
Validation loss decreased (-0.259984 --> -0.379985).  Saving model ...
Epoch: 5 cost time: 1.647756814956665
Epoch: 5, Steps: 4 | Train Loss: 1.045 Vali Loss: 1.433 Vali Acc: 0.480 Test Loss: 1.433 Test Acc: 0.480
Validation loss decreased (-0.379985 --> -0.479986).  Saving model ...
Epoch: 6 cost time: 1.584319829940796
Epoch: 6, Steps: 4 | Train Loss: 0.817 Vali Loss: 1.367 Vali Acc: 0.500 Test Loss: 1.367 Test Acc: 0.500
Validation loss decreased (-0.479986 --> -0.499986).  Saving model ...
Epoch: 7 cost time: 1.745901107788086
Epoch: 7, Steps: 4 | Train Loss: 0.543 Vali Loss: 1.263 Vali Acc: 0.520 Test Loss: 1.263 Test Acc: 0.520
Validation loss decreased (-0.499986 --> -0.519987).  Saving model ...
Epoch: 8 cost time: 1.740224838256836
Epoch: 8, Steps: 4 | Train Loss: 0.405 Vali Loss: 1.182 Vali Acc: 0.540 Test Loss: 1.182 Test Acc: 0.540
Validation loss decreased (-0.519987 --> -0.539988).  Saving model ...
Epoch: 9 cost time: 1.7743563652038574
Epoch: 9, Steps: 4 | Train Loss: 0.337 Vali Loss: 1.236 Vali Acc: 0.540 Test Loss: 1.236 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.767848014831543
Epoch: 10, Steps: 4 | Train Loss: 0.246 Vali Loss: 1.161 Vali Acc: 0.580 Test Loss: 1.161 Test Acc: 0.580
Validation loss decreased (-0.539988 --> -0.579988).  Saving model ...
Epoch: 11 cost time: 1.805506944656372
Epoch: 11, Steps: 4 | Train Loss: 0.416 Vali Loss: 1.167 Vali Acc: 0.540 Test Loss: 1.167 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.7245800495147705
Epoch: 12, Steps: 4 | Train Loss: 0.136 Vali Loss: 1.189 Vali Acc: 0.580 Test Loss: 1.189 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.7544677257537842
Epoch: 13, Steps: 4 | Train Loss: 0.097 Vali Loss: 1.181 Vali Acc: 0.560 Test Loss: 1.181 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.715475082397461
Epoch: 14, Steps: 4 | Train Loss: 0.084 Vali Loss: 1.109 Vali Acc: 0.580 Test Loss: 1.109 Test Acc: 0.580
Validation loss decreased (-0.579988 --> -0.579989).  Saving model ...
Epoch: 15 cost time: 1.8058407306671143
Epoch: 15, Steps: 4 | Train Loss: 0.051 Vali Loss: 1.168 Vali Acc: 0.540 Test Loss: 1.168 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.764495849609375
Epoch: 16, Steps: 4 | Train Loss: 0.033 Vali Loss: 1.179 Vali Acc: 0.540 Test Loss: 1.179 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.884889841079712
Epoch: 17, Steps: 4 | Train Loss: 0.048 Vali Loss: 1.169 Vali Acc: 0.560 Test Loss: 1.169 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.7946531772613525
Epoch: 18, Steps: 4 | Train Loss: 0.034 Vali Loss: 1.188 Vali Acc: 0.560 Test Loss: 1.188 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.8674376010894775
Epoch: 19, Steps: 4 | Train Loss: 0.016 Vali Loss: 1.264 Vali Acc: 0.520 Test Loss: 1.264 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.707075834274292
Epoch: 20, Steps: 4 | Train Loss: 0.031 Vali Loss: 1.286 Vali Acc: 0.580 Test Loss: 1.286 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.724473476409912
Epoch: 21, Steps: 4 | Train Loss: 0.016 Vali Loss: 1.191 Vali Acc: 0.580 Test Loss: 1.191 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.7399499416351318
Epoch: 22, Steps: 4 | Train Loss: 0.013 Vali Loss: 1.231 Vali Acc: 0.540 Test Loss: 1.231 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.7995164394378662
Epoch: 23, Steps: 4 | Train Loss: 0.009 Vali Loss: 1.274 Vali Acc: 0.560 Test Loss: 1.274 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.730351448059082
Epoch: 24, Steps: 4 | Train Loss: 0.007 Vali Loss: 1.279 Vali Acc: 0.600 Test Loss: 1.279 Test Acc: 0.600
Validation loss decreased (-0.579989 --> -0.599987).  Saving model ...
Epoch: 25 cost time: 1.7394757270812988
Epoch: 25, Steps: 4 | Train Loss: 0.009 Vali Loss: 1.233 Vali Acc: 0.620 Test Loss: 1.233 Test Acc: 0.620
Validation loss decreased (-0.599987 --> -0.619988).  Saving model ...
Epoch: 26 cost time: 1.7181506156921387
Epoch: 26, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.239 Vali Acc: 0.580 Test Loss: 1.239 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.746037483215332
Epoch: 27, Steps: 4 | Train Loss: 0.006 Vali Loss: 1.263 Vali Acc: 0.560 Test Loss: 1.263 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.7598967552185059
Epoch: 28, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.296 Vali Acc: 0.600 Test Loss: 1.296 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.7944793701171875
Epoch: 29, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.307 Vali Acc: 0.560 Test Loss: 1.307 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.708310842514038
Epoch: 30, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.297 Vali Acc: 0.560 Test Loss: 1.297 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm64_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.62
model parameter : 2410949
model size : 10.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm64_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.085169315338135
Epoch: 1, Steps: 4 | Train Loss: 1.605 Vali Loss: 1.542 Vali Acc: 0.240 Test Loss: 1.542 Test Acc: 0.240
Validation loss decreased (inf --> -0.239985).  Saving model ...
Epoch: 2 cost time: 2.3043107986450195
Epoch: 2, Steps: 4 | Train Loss: 1.607 Vali Loss: 1.535 Vali Acc: 0.220 Test Loss: 1.535 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.361450433731079
Epoch: 3, Steps: 4 | Train Loss: 1.397 Vali Loss: 1.527 Vali Acc: 0.280 Test Loss: 1.527 Test Acc: 0.280
Validation loss decreased (-0.239985 --> -0.279985).  Saving model ...
Epoch: 4 cost time: 2.4101204872131348
Epoch: 4, Steps: 4 | Train Loss: 1.145 Vali Loss: 1.478 Vali Acc: 0.380 Test Loss: 1.478 Test Acc: 0.380
Validation loss decreased (-0.279985 --> -0.379985).  Saving model ...
Epoch: 5 cost time: 2.3866565227508545
Epoch: 5, Steps: 4 | Train Loss: 1.138 Vali Loss: 1.377 Vali Acc: 0.440 Test Loss: 1.377 Test Acc: 0.440
Validation loss decreased (-0.379985 --> -0.439986).  Saving model ...
Epoch: 6 cost time: 2.6434690952301025
Epoch: 6, Steps: 4 | Train Loss: 0.750 Vali Loss: 1.251 Vali Acc: 0.460 Test Loss: 1.251 Test Acc: 0.460
Validation loss decreased (-0.439986 --> -0.459987).  Saving model ...
Epoch: 7 cost time: 2.7203376293182373
Epoch: 7, Steps: 4 | Train Loss: 0.551 Vali Loss: 1.191 Vali Acc: 0.420 Test Loss: 1.191 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.715163230895996
Epoch: 8, Steps: 4 | Train Loss: 0.528 Vali Loss: 1.144 Vali Acc: 0.500 Test Loss: 1.144 Test Acc: 0.500
Validation loss decreased (-0.459987 --> -0.499989).  Saving model ...
Epoch: 9 cost time: 2.7259089946746826
Epoch: 9, Steps: 4 | Train Loss: 0.345 Vali Loss: 1.100 Vali Acc: 0.560 Test Loss: 1.100 Test Acc: 0.560
Validation loss decreased (-0.499989 --> -0.559989).  Saving model ...
Epoch: 10 cost time: 2.6711463928222656
Epoch: 10, Steps: 4 | Train Loss: 0.337 Vali Loss: 1.039 Vali Acc: 0.520 Test Loss: 1.039 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.6333084106445312
Epoch: 11, Steps: 4 | Train Loss: 0.378 Vali Loss: 1.052 Vali Acc: 0.500 Test Loss: 1.052 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.6980295181274414
Epoch: 12, Steps: 4 | Train Loss: 0.166 Vali Loss: 1.073 Vali Acc: 0.520 Test Loss: 1.073 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.6010870933532715
Epoch: 13, Steps: 4 | Train Loss: 0.092 Vali Loss: 1.192 Vali Acc: 0.500 Test Loss: 1.192 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.6315953731536865
Epoch: 14, Steps: 4 | Train Loss: 0.119 Vali Loss: 1.160 Vali Acc: 0.480 Test Loss: 1.160 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.6740055084228516
Epoch: 15, Steps: 4 | Train Loss: 0.078 Vali Loss: 1.094 Vali Acc: 0.520 Test Loss: 1.094 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.6647794246673584
Epoch: 16, Steps: 4 | Train Loss: 0.049 Vali Loss: 1.207 Vali Acc: 0.580 Test Loss: 1.207 Test Acc: 0.580
Validation loss decreased (-0.559989 --> -0.579988).  Saving model ...
Epoch: 17 cost time: 2.673569917678833
Epoch: 17, Steps: 4 | Train Loss: 0.069 Vali Loss: 1.162 Vali Acc: 0.580 Test Loss: 1.162 Test Acc: 0.580
Validation loss decreased (-0.579988 --> -0.579988).  Saving model ...
Epoch: 18 cost time: 2.888349771499634
Epoch: 18, Steps: 4 | Train Loss: 0.044 Vali Loss: 1.112 Vali Acc: 0.600 Test Loss: 1.112 Test Acc: 0.600
Validation loss decreased (-0.579988 --> -0.599989).  Saving model ...
Epoch: 19 cost time: 2.7053980827331543
Epoch: 19, Steps: 4 | Train Loss: 0.018 Vali Loss: 1.341 Vali Acc: 0.560 Test Loss: 1.341 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.641918659210205
Epoch: 20, Steps: 4 | Train Loss: 0.021 Vali Loss: 1.258 Vali Acc: 0.580 Test Loss: 1.258 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.5821826457977295
Epoch: 21, Steps: 4 | Train Loss: 0.014 Vali Loss: 1.320 Vali Acc: 0.560 Test Loss: 1.320 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.3310670852661133
Epoch: 22, Steps: 4 | Train Loss: 0.009 Vali Loss: 1.440 Vali Acc: 0.560 Test Loss: 1.440 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.6518654823303223
Epoch: 23, Steps: 4 | Train Loss: 0.008 Vali Loss: 1.433 Vali Acc: 0.580 Test Loss: 1.433 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.7040646076202393
Epoch: 24, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.394 Vali Acc: 0.580 Test Loss: 1.394 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.6589057445526123
Epoch: 25, Steps: 4 | Train Loss: 0.007 Vali Loss: 1.399 Vali Acc: 0.580 Test Loss: 1.399 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.707759380340576
Epoch: 26, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.493 Vali Acc: 0.540 Test Loss: 1.493 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.733224868774414
Epoch: 27, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.533 Vali Acc: 0.540 Test Loss: 1.533 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.6545238494873047
Epoch: 28, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.470 Vali Acc: 0.560 Test Loss: 1.470 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm64_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 7376069
model size : 29.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm64_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.287276029586792
Epoch: 1, Steps: 4 | Train Loss: 1.646 Vali Loss: 1.716 Vali Acc: 0.120 Test Loss: 1.716 Test Acc: 0.120
Validation loss decreased (inf --> -0.119983).  Saving model ...
Epoch: 2 cost time: 1.7273411750793457
Epoch: 2, Steps: 4 | Train Loss: 1.502 Vali Loss: 1.668 Vali Acc: 0.180 Test Loss: 1.668 Test Acc: 0.180
Validation loss decreased (-0.119983 --> -0.179983).  Saving model ...
Epoch: 3 cost time: 1.7034850120544434
Epoch: 3, Steps: 4 | Train Loss: 1.548 Vali Loss: 1.599 Vali Acc: 0.260 Test Loss: 1.599 Test Acc: 0.260
Validation loss decreased (-0.179983 --> -0.259984).  Saving model ...
Epoch: 4 cost time: 1.6666996479034424
Epoch: 4, Steps: 4 | Train Loss: 1.170 Vali Loss: 1.526 Vali Acc: 0.380 Test Loss: 1.526 Test Acc: 0.380
Validation loss decreased (-0.259984 --> -0.379985).  Saving model ...
Epoch: 5 cost time: 1.6470019817352295
Epoch: 5, Steps: 4 | Train Loss: 1.050 Vali Loss: 1.431 Vali Acc: 0.480 Test Loss: 1.431 Test Acc: 0.480
Validation loss decreased (-0.379985 --> -0.479986).  Saving model ...
Epoch: 6 cost time: 1.7163372039794922
Epoch: 6, Steps: 4 | Train Loss: 0.822 Vali Loss: 1.364 Vali Acc: 0.500 Test Loss: 1.364 Test Acc: 0.500
Validation loss decreased (-0.479986 --> -0.499986).  Saving model ...
Epoch: 7 cost time: 1.7863099575042725
Epoch: 7, Steps: 4 | Train Loss: 0.553 Vali Loss: 1.260 Vali Acc: 0.540 Test Loss: 1.260 Test Acc: 0.540
Validation loss decreased (-0.499986 --> -0.539987).  Saving model ...
Epoch: 8 cost time: 1.69437575340271
Epoch: 8, Steps: 4 | Train Loss: 0.412 Vali Loss: 1.178 Vali Acc: 0.540 Test Loss: 1.178 Test Acc: 0.540
Validation loss decreased (-0.539987 --> -0.539988).  Saving model ...
Epoch: 9 cost time: 1.7139737606048584
Epoch: 9, Steps: 4 | Train Loss: 0.345 Vali Loss: 1.227 Vali Acc: 0.540 Test Loss: 1.227 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6897225379943848
Epoch: 10, Steps: 4 | Train Loss: 0.251 Vali Loss: 1.156 Vali Acc: 0.580 Test Loss: 1.156 Test Acc: 0.580
Validation loss decreased (-0.539988 --> -0.579988).  Saving model ...
Epoch: 11 cost time: 1.8300292491912842
Epoch: 11, Steps: 4 | Train Loss: 0.388 Vali Loss: 1.158 Vali Acc: 0.540 Test Loss: 1.158 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.6550946235656738
Epoch: 12, Steps: 4 | Train Loss: 0.140 Vali Loss: 1.180 Vali Acc: 0.540 Test Loss: 1.180 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.8202402591705322
Epoch: 13, Steps: 4 | Train Loss: 0.112 Vali Loss: 1.188 Vali Acc: 0.580 Test Loss: 1.188 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.6888706684112549
Epoch: 14, Steps: 4 | Train Loss: 0.089 Vali Loss: 1.112 Vali Acc: 0.580 Test Loss: 1.112 Test Acc: 0.580
Validation loss decreased (-0.579988 --> -0.579989).  Saving model ...
Epoch: 15 cost time: 1.712134838104248
Epoch: 15, Steps: 4 | Train Loss: 0.056 Vali Loss: 1.151 Vali Acc: 0.520 Test Loss: 1.151 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.781200647354126
Epoch: 16, Steps: 4 | Train Loss: 0.036 Vali Loss: 1.178 Vali Acc: 0.540 Test Loss: 1.178 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.7576100826263428
Epoch: 17, Steps: 4 | Train Loss: 0.043 Vali Loss: 1.158 Vali Acc: 0.560 Test Loss: 1.158 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.778191089630127
Epoch: 18, Steps: 4 | Train Loss: 0.036 Vali Loss: 1.142 Vali Acc: 0.540 Test Loss: 1.142 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.716749906539917
Epoch: 19, Steps: 4 | Train Loss: 0.020 Vali Loss: 1.125 Vali Acc: 0.580 Test Loss: 1.125 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.7407386302947998
Epoch: 20, Steps: 4 | Train Loss: 0.020 Vali Loss: 1.209 Vali Acc: 0.560 Test Loss: 1.209 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.7171440124511719
Epoch: 21, Steps: 4 | Train Loss: 0.016 Vali Loss: 1.205 Vali Acc: 0.540 Test Loss: 1.205 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.7132349014282227
Epoch: 22, Steps: 4 | Train Loss: 0.012 Vali Loss: 1.228 Vali Acc: 0.500 Test Loss: 1.228 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.7161142826080322
Epoch: 23, Steps: 4 | Train Loss: 0.009 Vali Loss: 1.279 Vali Acc: 0.520 Test Loss: 1.279 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.6806676387786865
Epoch: 24, Steps: 4 | Train Loss: 0.006 Vali Loss: 1.329 Vali Acc: 0.580 Test Loss: 1.329 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm64_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 2410949
model size : 10.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm32_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 7.898909568786621
Epoch: 1, Steps: 4 | Train Loss: 1.545 Vali Loss: 1.519 Vali Acc: 0.380 Test Loss: 1.519 Test Acc: 0.380
Validation loss decreased (inf --> -0.379985).  Saving model ...
Epoch: 2 cost time: 6.07311487197876
Epoch: 2, Steps: 4 | Train Loss: 1.492 Vali Loss: 1.509 Vali Acc: 0.340 Test Loss: 1.509 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.19754958152771
Epoch: 3, Steps: 4 | Train Loss: 1.453 Vali Loss: 1.505 Vali Acc: 0.340 Test Loss: 1.505 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.04267430305481
Epoch: 4, Steps: 4 | Train Loss: 1.326 Vali Loss: 1.457 Vali Acc: 0.380 Test Loss: 1.457 Test Acc: 0.380
Validation loss decreased (-0.379985 --> -0.379985).  Saving model ...
Epoch: 5 cost time: 5.914941072463989
Epoch: 5, Steps: 4 | Train Loss: 1.172 Vali Loss: 1.416 Vali Acc: 0.480 Test Loss: 1.416 Test Acc: 0.480
Validation loss decreased (-0.379985 --> -0.479986).  Saving model ...
Epoch: 6 cost time: 5.785706996917725
Epoch: 6, Steps: 4 | Train Loss: 0.967 Vali Loss: 1.358 Vali Acc: 0.480 Test Loss: 1.358 Test Acc: 0.480
Validation loss decreased (-0.479986 --> -0.479986).  Saving model ...
Epoch: 7 cost time: 6.006108045578003
Epoch: 7, Steps: 4 | Train Loss: 0.908 Vali Loss: 1.274 Vali Acc: 0.520 Test Loss: 1.274 Test Acc: 0.520
Validation loss decreased (-0.479986 --> -0.519987).  Saving model ...
Epoch: 8 cost time: 5.657371282577515
Epoch: 8, Steps: 4 | Train Loss: 0.674 Vali Loss: 1.176 Vali Acc: 0.480 Test Loss: 1.176 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.022149324417114
Epoch: 9, Steps: 4 | Train Loss: 0.629 Vali Loss: 1.120 Vali Acc: 0.500 Test Loss: 1.120 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.054785966873169
Epoch: 10, Steps: 4 | Train Loss: 0.487 Vali Loss: 1.046 Vali Acc: 0.560 Test Loss: 1.046 Test Acc: 0.560
Validation loss decreased (-0.519987 --> -0.559990).  Saving model ...
Epoch: 11 cost time: 5.727984428405762
Epoch: 11, Steps: 4 | Train Loss: 0.343 Vali Loss: 0.997 Vali Acc: 0.560 Test Loss: 0.997 Test Acc: 0.560
Validation loss decreased (-0.559990 --> -0.559990).  Saving model ...
Epoch: 12 cost time: 5.942919731140137
Epoch: 12, Steps: 4 | Train Loss: 0.538 Vali Loss: 1.022 Vali Acc: 0.540 Test Loss: 1.022 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.9466023445129395
Epoch: 13, Steps: 4 | Train Loss: 0.426 Vali Loss: 0.994 Vali Acc: 0.600 Test Loss: 0.994 Test Acc: 0.600
Validation loss decreased (-0.559990 --> -0.599990).  Saving model ...
Epoch: 14 cost time: 5.819520711898804
Epoch: 14, Steps: 4 | Train Loss: 0.176 Vali Loss: 1.069 Vali Acc: 0.540 Test Loss: 1.069 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.553455829620361
Epoch: 15, Steps: 4 | Train Loss: 0.158 Vali Loss: 1.125 Vali Acc: 0.560 Test Loss: 1.125 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 5.753426551818848
Epoch: 16, Steps: 4 | Train Loss: 0.140 Vali Loss: 1.045 Vali Acc: 0.580 Test Loss: 1.045 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 5.515552759170532
Epoch: 17, Steps: 4 | Train Loss: 0.103 Vali Loss: 1.088 Vali Acc: 0.580 Test Loss: 1.088 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 5.712261438369751
Epoch: 18, Steps: 4 | Train Loss: 0.099 Vali Loss: 1.077 Vali Acc: 0.560 Test Loss: 1.077 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 6.035808563232422
Epoch: 19, Steps: 4 | Train Loss: 0.082 Vali Loss: 1.231 Vali Acc: 0.560 Test Loss: 1.231 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 5.8572282791137695
Epoch: 20, Steps: 4 | Train Loss: 0.111 Vali Loss: 1.153 Vali Acc: 0.600 Test Loss: 1.153 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 5.482107877731323
Epoch: 21, Steps: 4 | Train Loss: 0.177 Vali Loss: 1.035 Vali Acc: 0.520 Test Loss: 1.035 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 4.921235799789429
Epoch: 22, Steps: 4 | Train Loss: 0.052 Vali Loss: 1.176 Vali Acc: 0.580 Test Loss: 1.176 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 5.626304388046265
Epoch: 23, Steps: 4 | Train Loss: 0.043 Vali Loss: 1.278 Vali Acc: 0.540 Test Loss: 1.278 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm32_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 7204133
model size : 28.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm32_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 5.649190425872803
Epoch: 1, Steps: 4 | Train Loss: 1.720 Vali Loss: 1.668 Vali Acc: 0.280 Test Loss: 1.668 Test Acc: 0.280
Validation loss decreased (inf --> -0.279983).  Saving model ...
Epoch: 2 cost time: 3.2590904235839844
Epoch: 2, Steps: 4 | Train Loss: 1.563 Vali Loss: 1.650 Vali Acc: 0.260 Test Loss: 1.650 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.5781443119049072
Epoch: 3, Steps: 4 | Train Loss: 1.487 Vali Loss: 1.640 Vali Acc: 0.300 Test Loss: 1.640 Test Acc: 0.300
Validation loss decreased (-0.279983 --> -0.299984).  Saving model ...
Epoch: 4 cost time: 3.317966938018799
Epoch: 4, Steps: 4 | Train Loss: 1.403 Vali Loss: 1.603 Vali Acc: 0.340 Test Loss: 1.603 Test Acc: 0.340
Validation loss decreased (-0.299984 --> -0.339984).  Saving model ...
Epoch: 5 cost time: 3.483311414718628
Epoch: 5, Steps: 4 | Train Loss: 1.214 Vali Loss: 1.557 Vali Acc: 0.380 Test Loss: 1.557 Test Acc: 0.380
Validation loss decreased (-0.339984 --> -0.379984).  Saving model ...
Epoch: 6 cost time: 3.4737231731414795
Epoch: 6, Steps: 4 | Train Loss: 1.030 Vali Loss: 1.500 Vali Acc: 0.400 Test Loss: 1.500 Test Acc: 0.400
Validation loss decreased (-0.379984 --> -0.399985).  Saving model ...
Epoch: 7 cost time: 3.4993062019348145
Epoch: 7, Steps: 4 | Train Loss: 0.943 Vali Loss: 1.437 Vali Acc: 0.420 Test Loss: 1.437 Test Acc: 0.420
Validation loss decreased (-0.399985 --> -0.419986).  Saving model ...
Epoch: 8 cost time: 3.1704301834106445
Epoch: 8, Steps: 4 | Train Loss: 0.819 Vali Loss: 1.415 Vali Acc: 0.440 Test Loss: 1.415 Test Acc: 0.440
Validation loss decreased (-0.419986 --> -0.439986).  Saving model ...
Epoch: 9 cost time: 3.3613357543945312
Epoch: 9, Steps: 4 | Train Loss: 0.612 Vali Loss: 1.330 Vali Acc: 0.460 Test Loss: 1.330 Test Acc: 0.460
Validation loss decreased (-0.439986 --> -0.459987).  Saving model ...
Epoch: 10 cost time: 3.2965199947357178
Epoch: 10, Steps: 4 | Train Loss: 0.477 Vali Loss: 1.283 Vali Acc: 0.480 Test Loss: 1.283 Test Acc: 0.480
Validation loss decreased (-0.459987 --> -0.479987).  Saving model ...
Epoch: 11 cost time: 3.324488878250122
Epoch: 11, Steps: 4 | Train Loss: 0.439 Vali Loss: 1.274 Vali Acc: 0.540 Test Loss: 1.274 Test Acc: 0.540
Validation loss decreased (-0.479987 --> -0.539987).  Saving model ...
Epoch: 12 cost time: 3.3859336376190186
Epoch: 12, Steps: 4 | Train Loss: 0.292 Vali Loss: 1.221 Vali Acc: 0.520 Test Loss: 1.221 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.4523754119873047
Epoch: 13, Steps: 4 | Train Loss: 0.314 Vali Loss: 1.176 Vali Acc: 0.520 Test Loss: 1.176 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.2067973613739014
Epoch: 14, Steps: 4 | Train Loss: 0.198 Vali Loss: 1.220 Vali Acc: 0.560 Test Loss: 1.220 Test Acc: 0.560
Validation loss decreased (-0.539987 --> -0.559988).  Saving model ...
Epoch: 15 cost time: 3.372270345687866
Epoch: 15, Steps: 4 | Train Loss: 0.184 Vali Loss: 1.204 Vali Acc: 0.560 Test Loss: 1.204 Test Acc: 0.560
Validation loss decreased (-0.559988 --> -0.559988).  Saving model ...
Epoch: 16 cost time: 3.578984260559082
Epoch: 16, Steps: 4 | Train Loss: 0.116 Vali Loss: 1.131 Vali Acc: 0.540 Test Loss: 1.131 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.631019353866577
Epoch: 17, Steps: 4 | Train Loss: 0.250 Vali Loss: 1.208 Vali Acc: 0.600 Test Loss: 1.208 Test Acc: 0.600
Validation loss decreased (-0.559988 --> -0.599988).  Saving model ...
Epoch: 18 cost time: 3.497532367706299
Epoch: 18, Steps: 4 | Train Loss: 0.092 Vali Loss: 1.176 Vali Acc: 0.580 Test Loss: 1.176 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.5400052070617676
Epoch: 19, Steps: 4 | Train Loss: 0.076 Vali Loss: 1.121 Vali Acc: 0.580 Test Loss: 1.121 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.1444661617279053
Epoch: 20, Steps: 4 | Train Loss: 0.148 Vali Loss: 1.160 Vali Acc: 0.600 Test Loss: 1.160 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599988).  Saving model ...
Epoch: 21 cost time: 3.4466912746429443
Epoch: 21, Steps: 4 | Train Loss: 0.098 Vali Loss: 1.166 Vali Acc: 0.600 Test Loss: 1.166 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.757293939590454
Epoch: 22, Steps: 4 | Train Loss: 0.051 Vali Loss: 1.220 Vali Acc: 0.640 Test Loss: 1.220 Test Acc: 0.640
Validation loss decreased (-0.599988 --> -0.639988).  Saving model ...
Epoch: 23 cost time: 3.1098949909210205
Epoch: 23, Steps: 4 | Train Loss: 0.032 Vali Loss: 1.268 Vali Acc: 0.600 Test Loss: 1.268 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.844067335128784
Epoch: 24, Steps: 4 | Train Loss: 0.033 Vali Loss: 1.169 Vali Acc: 0.620 Test Loss: 1.169 Test Acc: 0.620
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.3389768600463867
Epoch: 25, Steps: 4 | Train Loss: 0.026 Vali Loss: 1.129 Vali Acc: 0.640 Test Loss: 1.129 Test Acc: 0.640
Validation loss decreased (-0.639988 --> -0.639989).  Saving model ...
Epoch: 26 cost time: 3.3491737842559814
Epoch: 26, Steps: 4 | Train Loss: 0.026 Vali Loss: 1.213 Vali Acc: 0.620 Test Loss: 1.213 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.5271551609039307
Epoch: 27, Steps: 4 | Train Loss: 0.012 Vali Loss: 1.386 Vali Acc: 0.540 Test Loss: 1.386 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.217790126800537
Epoch: 28, Steps: 4 | Train Loss: 0.015 Vali Loss: 1.338 Vali Acc: 0.560 Test Loss: 1.338 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.792726516723633
Epoch: 29, Steps: 4 | Train Loss: 0.010 Vali Loss: 1.208 Vali Acc: 0.620 Test Loss: 1.208 Test Acc: 0.620
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 3.779425859451294
Epoch: 30, Steps: 4 | Train Loss: 0.010 Vali Loss: 1.160 Vali Acc: 0.540 Test Loss: 1.160 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm32_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.64
model parameter : 2238821
model size : 9.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm32_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 5.800289869308472
Epoch: 1, Steps: 4 | Train Loss: 1.546 Vali Loss: 1.517 Vali Acc: 0.380 Test Loss: 1.517 Test Acc: 0.380
Validation loss decreased (inf --> -0.379985).  Saving model ...
Epoch: 2 cost time: 3.384866237640381
Epoch: 2, Steps: 4 | Train Loss: 1.492 Vali Loss: 1.509 Vali Acc: 0.360 Test Loss: 1.509 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.923231601715088
Epoch: 3, Steps: 4 | Train Loss: 1.455 Vali Loss: 1.505 Vali Acc: 0.320 Test Loss: 1.505 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.8040175437927246
Epoch: 4, Steps: 4 | Train Loss: 1.324 Vali Loss: 1.457 Vali Acc: 0.380 Test Loss: 1.457 Test Acc: 0.380
Validation loss decreased (-0.379985 --> -0.379985).  Saving model ...
Epoch: 5 cost time: 3.9024317264556885
Epoch: 5, Steps: 4 | Train Loss: 1.174 Vali Loss: 1.414 Vali Acc: 0.500 Test Loss: 1.414 Test Acc: 0.500
Validation loss decreased (-0.379985 --> -0.499986).  Saving model ...
Epoch: 6 cost time: 3.8466105461120605
Epoch: 6, Steps: 4 | Train Loss: 0.972 Vali Loss: 1.355 Vali Acc: 0.500 Test Loss: 1.355 Test Acc: 0.500
Validation loss decreased (-0.499986 --> -0.499986).  Saving model ...
Epoch: 7 cost time: 3.6974005699157715
Epoch: 7, Steps: 4 | Train Loss: 0.910 Vali Loss: 1.270 Vali Acc: 0.540 Test Loss: 1.270 Test Acc: 0.540
Validation loss decreased (-0.499986 --> -0.539987).  Saving model ...
Epoch: 8 cost time: 3.716536521911621
Epoch: 8, Steps: 4 | Train Loss: 0.678 Vali Loss: 1.171 Vali Acc: 0.500 Test Loss: 1.171 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.6942574977874756
Epoch: 9, Steps: 4 | Train Loss: 0.629 Vali Loss: 1.116 Vali Acc: 0.500 Test Loss: 1.116 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.632171154022217
Epoch: 10, Steps: 4 | Train Loss: 0.489 Vali Loss: 1.039 Vali Acc: 0.500 Test Loss: 1.039 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.7427432537078857
Epoch: 11, Steps: 4 | Train Loss: 0.344 Vali Loss: 0.985 Vali Acc: 0.560 Test Loss: 0.985 Test Acc: 0.560
Validation loss decreased (-0.539987 --> -0.559990).  Saving model ...
Epoch: 12 cost time: 3.8728268146514893
Epoch: 12, Steps: 4 | Train Loss: 0.517 Vali Loss: 1.004 Vali Acc: 0.540 Test Loss: 1.004 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.7762463092803955
Epoch: 13, Steps: 4 | Train Loss: 0.428 Vali Loss: 0.968 Vali Acc: 0.580 Test Loss: 0.968 Test Acc: 0.580
Validation loss decreased (-0.559990 --> -0.579990).  Saving model ...
Epoch: 14 cost time: 3.778261184692383
Epoch: 14, Steps: 4 | Train Loss: 0.204 Vali Loss: 1.045 Vali Acc: 0.540 Test Loss: 1.045 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.822575807571411
Epoch: 15, Steps: 4 | Train Loss: 0.157 Vali Loss: 1.083 Vali Acc: 0.540 Test Loss: 1.083 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.7947936058044434
Epoch: 16, Steps: 4 | Train Loss: 0.139 Vali Loss: 0.963 Vali Acc: 0.620 Test Loss: 0.963 Test Acc: 0.620
Validation loss decreased (-0.579990 --> -0.619990).  Saving model ...
Epoch: 17 cost time: 3.795785903930664
Epoch: 17, Steps: 4 | Train Loss: 0.096 Vali Loss: 1.016 Vali Acc: 0.600 Test Loss: 1.016 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.703758716583252
Epoch: 18, Steps: 4 | Train Loss: 0.099 Vali Loss: 1.006 Vali Acc: 0.600 Test Loss: 1.006 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.739609479904175
Epoch: 19, Steps: 4 | Train Loss: 0.081 Vali Loss: 1.133 Vali Acc: 0.560 Test Loss: 1.133 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.0214736461639404
Epoch: 20, Steps: 4 | Train Loss: 0.095 Vali Loss: 1.090 Vali Acc: 0.640 Test Loss: 1.090 Test Acc: 0.640
Validation loss decreased (-0.619990 --> -0.639989).  Saving model ...
Epoch: 21 cost time: 3.080207586288452
Epoch: 21, Steps: 4 | Train Loss: 0.138 Vali Loss: 0.974 Vali Acc: 0.580 Test Loss: 0.974 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.582414388656616
Epoch: 22, Steps: 4 | Train Loss: 0.044 Vali Loss: 1.048 Vali Acc: 0.640 Test Loss: 1.048 Test Acc: 0.640
Validation loss decreased (-0.639989 --> -0.639990).  Saving model ...
Epoch: 23 cost time: 3.6479499340057373
Epoch: 23, Steps: 4 | Train Loss: 0.029 Vali Loss: 1.084 Vali Acc: 0.580 Test Loss: 1.084 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.448859214782715
Epoch: 24, Steps: 4 | Train Loss: 0.035 Vali Loss: 1.209 Vali Acc: 0.560 Test Loss: 1.209 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.637798309326172
Epoch: 25, Steps: 4 | Train Loss: 0.019 Vali Loss: 1.035 Vali Acc: 0.580 Test Loss: 1.035 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.6291379928588867
Epoch: 26, Steps: 4 | Train Loss: 0.018 Vali Loss: 1.058 Vali Acc: 0.600 Test Loss: 1.058 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 3.5654842853546143
Epoch: 27, Steps: 4 | Train Loss: 0.018 Vali Loss: 1.155 Vali Acc: 0.580 Test Loss: 1.155 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 3.6523492336273193
Epoch: 28, Steps: 4 | Train Loss: 0.014 Vali Loss: 1.140 Vali Acc: 0.560 Test Loss: 1.140 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 3.621042013168335
Epoch: 29, Steps: 4 | Train Loss: 0.008 Vali Loss: 1.171 Vali Acc: 0.580 Test Loss: 1.171 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 3.371072292327881
Epoch: 30, Steps: 4 | Train Loss: 0.008 Vali Loss: 1.223 Vali Acc: 0.580 Test Loss: 1.223 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm32_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.64
model parameter : 7204133
model size : 28.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm32_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.05974817276001
Epoch: 1, Steps: 4 | Train Loss: 1.720 Vali Loss: 1.669 Vali Acc: 0.280 Test Loss: 1.669 Test Acc: 0.280
Validation loss decreased (inf --> -0.279983).  Saving model ...
Epoch: 2 cost time: 2.1682283878326416
Epoch: 2, Steps: 4 | Train Loss: 1.561 Vali Loss: 1.651 Vali Acc: 0.260 Test Loss: 1.651 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.2992920875549316
Epoch: 3, Steps: 4 | Train Loss: 1.493 Vali Loss: 1.640 Vali Acc: 0.280 Test Loss: 1.640 Test Acc: 0.280
Validation loss decreased (-0.279983 --> -0.279984).  Saving model ...
Epoch: 4 cost time: 2.2480051517486572
Epoch: 4, Steps: 4 | Train Loss: 1.406 Vali Loss: 1.604 Vali Acc: 0.340 Test Loss: 1.604 Test Acc: 0.340
Validation loss decreased (-0.279984 --> -0.339984).  Saving model ...
Epoch: 5 cost time: 2.3770363330841064
Epoch: 5, Steps: 4 | Train Loss: 1.219 Vali Loss: 1.558 Vali Acc: 0.380 Test Loss: 1.558 Test Acc: 0.380
Validation loss decreased (-0.339984 --> -0.379984).  Saving model ...
Epoch: 6 cost time: 2.2980897426605225
Epoch: 6, Steps: 4 | Train Loss: 1.035 Vali Loss: 1.498 Vali Acc: 0.400 Test Loss: 1.498 Test Acc: 0.400
Validation loss decreased (-0.379984 --> -0.399985).  Saving model ...
Epoch: 7 cost time: 2.3054661750793457
Epoch: 7, Steps: 4 | Train Loss: 0.950 Vali Loss: 1.432 Vali Acc: 0.400 Test Loss: 1.432 Test Acc: 0.400
Validation loss decreased (-0.399985 --> -0.399986).  Saving model ...
Epoch: 8 cost time: 2.375330924987793
Epoch: 8, Steps: 4 | Train Loss: 0.826 Vali Loss: 1.402 Vali Acc: 0.480 Test Loss: 1.402 Test Acc: 0.480
Validation loss decreased (-0.399986 --> -0.479986).  Saving model ...
Epoch: 9 cost time: 2.303659677505493
Epoch: 9, Steps: 4 | Train Loss: 0.609 Vali Loss: 1.310 Vali Acc: 0.460 Test Loss: 1.310 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.4286611080169678
Epoch: 10, Steps: 4 | Train Loss: 0.478 Vali Loss: 1.259 Vali Acc: 0.500 Test Loss: 1.259 Test Acc: 0.500
Validation loss decreased (-0.479986 --> -0.499987).  Saving model ...
Epoch: 11 cost time: 2.351323127746582
Epoch: 11, Steps: 4 | Train Loss: 0.435 Vali Loss: 1.248 Vali Acc: 0.540 Test Loss: 1.248 Test Acc: 0.540
Validation loss decreased (-0.499987 --> -0.539988).  Saving model ...
Epoch: 12 cost time: 2.1159751415252686
Epoch: 12, Steps: 4 | Train Loss: 0.293 Vali Loss: 1.185 Vali Acc: 0.560 Test Loss: 1.185 Test Acc: 0.560
Validation loss decreased (-0.539988 --> -0.559988).  Saving model ...
Epoch: 13 cost time: 2.2427618503570557
Epoch: 13, Steps: 4 | Train Loss: 0.314 Vali Loss: 1.131 Vali Acc: 0.540 Test Loss: 1.131 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.2434022426605225
Epoch: 14, Steps: 4 | Train Loss: 0.223 Vali Loss: 1.176 Vali Acc: 0.580 Test Loss: 1.176 Test Acc: 0.580
Validation loss decreased (-0.559988 --> -0.579988).  Saving model ...
Epoch: 15 cost time: 2.3372433185577393
Epoch: 15, Steps: 4 | Train Loss: 0.183 Vali Loss: 1.170 Vali Acc: 0.540 Test Loss: 1.170 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.2843708992004395
Epoch: 16, Steps: 4 | Train Loss: 0.119 Vali Loss: 1.091 Vali Acc: 0.540 Test Loss: 1.091 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.3031539916992188
Epoch: 17, Steps: 4 | Train Loss: 0.249 Vali Loss: 1.152 Vali Acc: 0.580 Test Loss: 1.152 Test Acc: 0.580
Validation loss decreased (-0.579988 --> -0.579988).  Saving model ...
Epoch: 18 cost time: 2.2433085441589355
Epoch: 18, Steps: 4 | Train Loss: 0.093 Vali Loss: 1.115 Vali Acc: 0.560 Test Loss: 1.115 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.197669744491577
Epoch: 19, Steps: 4 | Train Loss: 0.076 Vali Loss: 1.071 Vali Acc: 0.620 Test Loss: 1.071 Test Acc: 0.620
Validation loss decreased (-0.579988 --> -0.619989).  Saving model ...
Epoch: 20 cost time: 2.2689123153686523
Epoch: 20, Steps: 4 | Train Loss: 0.139 Vali Loss: 1.108 Vali Acc: 0.600 Test Loss: 1.108 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.260493516921997
Epoch: 21, Steps: 4 | Train Loss: 0.092 Vali Loss: 1.118 Vali Acc: 0.600 Test Loss: 1.118 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.2914156913757324
Epoch: 22, Steps: 4 | Train Loss: 0.051 Vali Loss: 1.178 Vali Acc: 0.600 Test Loss: 1.178 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.265139102935791
Epoch: 23, Steps: 4 | Train Loss: 0.033 Vali Loss: 1.231 Vali Acc: 0.560 Test Loss: 1.231 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.2255489826202393
Epoch: 24, Steps: 4 | Train Loss: 0.032 Vali Loss: 1.132 Vali Acc: 0.600 Test Loss: 1.132 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.229581117630005
Epoch: 25, Steps: 4 | Train Loss: 0.024 Vali Loss: 1.096 Vali Acc: 0.620 Test Loss: 1.096 Test Acc: 0.620
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.3014652729034424
Epoch: 26, Steps: 4 | Train Loss: 0.025 Vali Loss: 1.174 Vali Acc: 0.580 Test Loss: 1.174 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.201355457305908
Epoch: 27, Steps: 4 | Train Loss: 0.012 Vali Loss: 1.338 Vali Acc: 0.560 Test Loss: 1.338 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.218130111694336
Epoch: 28, Steps: 4 | Train Loss: 0.016 Vali Loss: 1.317 Vali Acc: 0.580 Test Loss: 1.317 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.231811046600342
Epoch: 29, Steps: 4 | Train Loss: 0.012 Vali Loss: 1.194 Vali Acc: 0.620 Test Loss: 1.194 Test Acc: 0.620
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm32_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.62
model parameter : 2238821
model size : 9.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm32_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.661323547363281
Epoch: 1, Steps: 4 | Train Loss: 1.546 Vali Loss: 1.519 Vali Acc: 0.380 Test Loss: 1.519 Test Acc: 0.380
Validation loss decreased (inf --> -0.379985).  Saving model ...
Epoch: 2 cost time: 2.898587703704834
Epoch: 2, Steps: 4 | Train Loss: 1.492 Vali Loss: 1.510 Vali Acc: 0.360 Test Loss: 1.510 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.771583318710327
Epoch: 3, Steps: 4 | Train Loss: 1.458 Vali Loss: 1.508 Vali Acc: 0.320 Test Loss: 1.508 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.7437222003936768
Epoch: 4, Steps: 4 | Train Loss: 1.329 Vali Loss: 1.462 Vali Acc: 0.380 Test Loss: 1.462 Test Acc: 0.380
Validation loss decreased (-0.379985 --> -0.379985).  Saving model ...
Epoch: 5 cost time: 2.851795196533203
Epoch: 5, Steps: 4 | Train Loss: 1.189 Vali Loss: 1.423 Vali Acc: 0.500 Test Loss: 1.423 Test Acc: 0.500
Validation loss decreased (-0.379985 --> -0.499986).  Saving model ...
Epoch: 6 cost time: 2.785187005996704
Epoch: 6, Steps: 4 | Train Loss: 0.986 Vali Loss: 1.366 Vali Acc: 0.480 Test Loss: 1.366 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.7171778678894043
Epoch: 7, Steps: 4 | Train Loss: 0.994 Vali Loss: 1.278 Vali Acc: 0.520 Test Loss: 1.278 Test Acc: 0.520
Validation loss decreased (-0.499986 --> -0.519987).  Saving model ...
Epoch: 8 cost time: 2.8453969955444336
Epoch: 8, Steps: 4 | Train Loss: 0.707 Vali Loss: 1.181 Vali Acc: 0.480 Test Loss: 1.181 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.782552480697632
Epoch: 9, Steps: 4 | Train Loss: 0.665 Vali Loss: 1.132 Vali Acc: 0.500 Test Loss: 1.132 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.7509608268737793
Epoch: 10, Steps: 4 | Train Loss: 0.519 Vali Loss: 1.064 Vali Acc: 0.540 Test Loss: 1.064 Test Acc: 0.540
Validation loss decreased (-0.519987 --> -0.539989).  Saving model ...
Epoch: 11 cost time: 2.894240140914917
Epoch: 11, Steps: 4 | Train Loss: 0.404 Vali Loss: 1.004 Vali Acc: 0.580 Test Loss: 1.004 Test Acc: 0.580
Validation loss decreased (-0.539989 --> -0.579990).  Saving model ...
Epoch: 12 cost time: 2.7808539867401123
Epoch: 12, Steps: 4 | Train Loss: 0.583 Vali Loss: 1.023 Vali Acc: 0.540 Test Loss: 1.023 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.584925413131714
Epoch: 13, Steps: 4 | Train Loss: 0.457 Vali Loss: 0.987 Vali Acc: 0.580 Test Loss: 0.987 Test Acc: 0.580
Validation loss decreased (-0.579990 --> -0.579990).  Saving model ...
Epoch: 14 cost time: 2.754549503326416
Epoch: 14, Steps: 4 | Train Loss: 0.250 Vali Loss: 1.052 Vali Acc: 0.560 Test Loss: 1.052 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.663973093032837
Epoch: 15, Steps: 4 | Train Loss: 0.175 Vali Loss: 1.113 Vali Acc: 0.560 Test Loss: 1.113 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.6848301887512207
Epoch: 16, Steps: 4 | Train Loss: 0.170 Vali Loss: 0.995 Vali Acc: 0.600 Test Loss: 0.995 Test Acc: 0.600
Validation loss decreased (-0.579990 --> -0.599990).  Saving model ...
Epoch: 17 cost time: 2.639557123184204
Epoch: 17, Steps: 4 | Train Loss: 0.118 Vali Loss: 1.016 Vali Acc: 0.540 Test Loss: 1.016 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.823059558868408
Epoch: 18, Steps: 4 | Train Loss: 0.102 Vali Loss: 1.043 Vali Acc: 0.560 Test Loss: 1.043 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.6869490146636963
Epoch: 19, Steps: 4 | Train Loss: 0.093 Vali Loss: 1.200 Vali Acc: 0.520 Test Loss: 1.200 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.662365436553955
Epoch: 20, Steps: 4 | Train Loss: 0.095 Vali Loss: 1.023 Vali Acc: 0.640 Test Loss: 1.023 Test Acc: 0.640
Validation loss decreased (-0.599990 --> -0.639990).  Saving model ...
Epoch: 21 cost time: 2.8423655033111572
Epoch: 21, Steps: 4 | Train Loss: 0.117 Vali Loss: 1.018 Vali Acc: 0.600 Test Loss: 1.018 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.780254364013672
Epoch: 22, Steps: 4 | Train Loss: 0.052 Vali Loss: 0.965 Vali Acc: 0.600 Test Loss: 0.965 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.5950849056243896
Epoch: 23, Steps: 4 | Train Loss: 0.030 Vali Loss: 1.096 Vali Acc: 0.580 Test Loss: 1.096 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.811661720275879
Epoch: 24, Steps: 4 | Train Loss: 0.032 Vali Loss: 1.065 Vali Acc: 0.600 Test Loss: 1.065 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.747188091278076
Epoch: 25, Steps: 4 | Train Loss: 0.016 Vali Loss: 0.972 Vali Acc: 0.560 Test Loss: 0.972 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.652945041656494
Epoch: 26, Steps: 4 | Train Loss: 0.025 Vali Loss: 1.049 Vali Acc: 0.600 Test Loss: 1.049 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.676283359527588
Epoch: 27, Steps: 4 | Train Loss: 0.017 Vali Loss: 1.249 Vali Acc: 0.600 Test Loss: 1.249 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.5208253860473633
Epoch: 28, Steps: 4 | Train Loss: 0.019 Vali Loss: 1.250 Vali Acc: 0.580 Test Loss: 1.250 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.329756259918213
Epoch: 29, Steps: 4 | Train Loss: 0.022 Vali Loss: 1.212 Vali Acc: 0.580 Test Loss: 1.212 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 2.3776464462280273
Epoch: 30, Steps: 4 | Train Loss: 0.029 Vali Loss: 1.058 Vali Acc: 0.540 Test Loss: 1.058 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm32_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.64
model parameter : 7204133
model size : 28.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm32_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.233888626098633
Epoch: 1, Steps: 4 | Train Loss: 1.704 Vali Loss: 1.672 Vali Acc: 0.280 Test Loss: 1.672 Test Acc: 0.280
Validation loss decreased (inf --> -0.279983).  Saving model ...
Epoch: 2 cost time: 1.6674137115478516
Epoch: 2, Steps: 4 | Train Loss: 1.561 Vali Loss: 1.654 Vali Acc: 0.280 Test Loss: 1.654 Test Acc: 0.280
Validation loss decreased (-0.279983 --> -0.279983).  Saving model ...
Epoch: 3 cost time: 1.6521308422088623
Epoch: 3, Steps: 4 | Train Loss: 1.504 Vali Loss: 1.642 Vali Acc: 0.280 Test Loss: 1.642 Test Acc: 0.280
Validation loss decreased (-0.279983 --> -0.279984).  Saving model ...
Epoch: 4 cost time: 1.6228904724121094
Epoch: 4, Steps: 4 | Train Loss: 1.406 Vali Loss: 1.605 Vali Acc: 0.340 Test Loss: 1.605 Test Acc: 0.340
Validation loss decreased (-0.279984 --> -0.339984).  Saving model ...
Epoch: 5 cost time: 1.631418228149414
Epoch: 5, Steps: 4 | Train Loss: 1.225 Vali Loss: 1.557 Vali Acc: 0.380 Test Loss: 1.557 Test Acc: 0.380
Validation loss decreased (-0.339984 --> -0.379984).  Saving model ...
Epoch: 6 cost time: 1.6335394382476807
Epoch: 6, Steps: 4 | Train Loss: 1.041 Vali Loss: 1.497 Vali Acc: 0.420 Test Loss: 1.497 Test Acc: 0.420
Validation loss decreased (-0.379984 --> -0.419985).  Saving model ...
Epoch: 7 cost time: 1.6173136234283447
Epoch: 7, Steps: 4 | Train Loss: 0.959 Vali Loss: 1.430 Vali Acc: 0.420 Test Loss: 1.430 Test Acc: 0.420
Validation loss decreased (-0.419985 --> -0.419986).  Saving model ...
Epoch: 8 cost time: 1.5545134544372559
Epoch: 8, Steps: 4 | Train Loss: 0.837 Vali Loss: 1.400 Vali Acc: 0.500 Test Loss: 1.400 Test Acc: 0.500
Validation loss decreased (-0.419986 --> -0.499986).  Saving model ...
Epoch: 9 cost time: 1.6190948486328125
Epoch: 9, Steps: 4 | Train Loss: 0.620 Vali Loss: 1.305 Vali Acc: 0.480 Test Loss: 1.305 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4890286922454834
Epoch: 10, Steps: 4 | Train Loss: 0.493 Vali Loss: 1.251 Vali Acc: 0.540 Test Loss: 1.251 Test Acc: 0.540
Validation loss decreased (-0.499986 --> -0.539987).  Saving model ...
Epoch: 11 cost time: 1.7025632858276367
Epoch: 11, Steps: 4 | Train Loss: 0.475 Vali Loss: 1.235 Vali Acc: 0.560 Test Loss: 1.235 Test Acc: 0.560
Validation loss decreased (-0.539987 --> -0.559988).  Saving model ...
Epoch: 12 cost time: 1.656156063079834
Epoch: 12, Steps: 4 | Train Loss: 0.314 Vali Loss: 1.185 Vali Acc: 0.580 Test Loss: 1.185 Test Acc: 0.580
Validation loss decreased (-0.559988 --> -0.579988).  Saving model ...
Epoch: 13 cost time: 1.6591894626617432
Epoch: 13, Steps: 4 | Train Loss: 0.340 Vali Loss: 1.135 Vali Acc: 0.540 Test Loss: 1.135 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.672318696975708
Epoch: 14, Steps: 4 | Train Loss: 0.226 Vali Loss: 1.160 Vali Acc: 0.580 Test Loss: 1.160 Test Acc: 0.580
Validation loss decreased (-0.579988 --> -0.579988).  Saving model ...
Epoch: 15 cost time: 1.6547062397003174
Epoch: 15, Steps: 4 | Train Loss: 0.197 Vali Loss: 1.125 Vali Acc: 0.560 Test Loss: 1.125 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.616586685180664
Epoch: 16, Steps: 4 | Train Loss: 0.140 Vali Loss: 1.086 Vali Acc: 0.560 Test Loss: 1.086 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.5890238285064697
Epoch: 17, Steps: 4 | Train Loss: 0.228 Vali Loss: 1.148 Vali Acc: 0.560 Test Loss: 1.148 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.609882116317749
Epoch: 18, Steps: 4 | Train Loss: 0.103 Vali Loss: 1.086 Vali Acc: 0.580 Test Loss: 1.086 Test Acc: 0.580
Validation loss decreased (-0.579988 --> -0.579989).  Saving model ...
Epoch: 19 cost time: 1.6416187286376953
Epoch: 19, Steps: 4 | Train Loss: 0.085 Vali Loss: 0.991 Vali Acc: 0.620 Test Loss: 0.991 Test Acc: 0.620
Validation loss decreased (-0.579989 --> -0.619990).  Saving model ...
Epoch: 20 cost time: 1.3379335403442383
Epoch: 20, Steps: 4 | Train Loss: 0.144 Vali Loss: 1.031 Vali Acc: 0.600 Test Loss: 1.031 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.667022943496704
Epoch: 21, Steps: 4 | Train Loss: 0.105 Vali Loss: 1.065 Vali Acc: 0.600 Test Loss: 1.065 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.6784234046936035
Epoch: 22, Steps: 4 | Train Loss: 0.049 Vali Loss: 1.096 Vali Acc: 0.660 Test Loss: 1.096 Test Acc: 0.660
Validation loss decreased (-0.619990 --> -0.659989).  Saving model ...
Epoch: 23 cost time: 1.6677727699279785
Epoch: 23, Steps: 4 | Train Loss: 0.050 Vali Loss: 1.101 Vali Acc: 0.600 Test Loss: 1.101 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.6278719902038574
Epoch: 24, Steps: 4 | Train Loss: 0.035 Vali Loss: 1.052 Vali Acc: 0.620 Test Loss: 1.052 Test Acc: 0.620
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.6619818210601807
Epoch: 25, Steps: 4 | Train Loss: 0.029 Vali Loss: 1.113 Vali Acc: 0.660 Test Loss: 1.113 Test Acc: 0.660
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.8187601566314697
Epoch: 26, Steps: 4 | Train Loss: 0.028 Vali Loss: 1.248 Vali Acc: 0.580 Test Loss: 1.248 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.6288013458251953
Epoch: 27, Steps: 4 | Train Loss: 0.016 Vali Loss: 1.309 Vali Acc: 0.560 Test Loss: 1.309 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.6991498470306396
Epoch: 28, Steps: 4 | Train Loss: 0.024 Vali Loss: 1.168 Vali Acc: 0.620 Test Loss: 1.168 Test Acc: 0.620
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.6470468044281006
Epoch: 29, Steps: 4 | Train Loss: 0.013 Vali Loss: 1.082 Vali Acc: 0.620 Test Loss: 1.082 Test Acc: 0.620
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.798401117324829
Epoch: 30, Steps: 4 | Train Loss: 0.013 Vali Loss: 1.050 Vali Acc: 0.620 Test Loss: 1.050 Test Acc: 0.620
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm32_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.66
model parameter : 2238821
model size : 9.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm32_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 5.803196430206299
Epoch: 1, Steps: 4 | Train Loss: 1.678 Vali Loss: 1.656 Vali Acc: 0.160 Test Loss: 1.656 Test Acc: 0.160
Validation loss decreased (inf --> -0.159983).  Saving model ...
Epoch: 2 cost time: 3.29831600189209
Epoch: 2, Steps: 4 | Train Loss: 1.648 Vali Loss: 1.619 Vali Acc: 0.240 Test Loss: 1.619 Test Acc: 0.240
Validation loss decreased (-0.159983 --> -0.239984).  Saving model ...
Epoch: 3 cost time: 3.771770715713501
Epoch: 3, Steps: 4 | Train Loss: 1.565 Vali Loss: 1.573 Vali Acc: 0.260 Test Loss: 1.573 Test Acc: 0.260
Validation loss decreased (-0.239984 --> -0.259984).  Saving model ...
Epoch: 4 cost time: 3.857584238052368
Epoch: 4, Steps: 4 | Train Loss: 1.337 Vali Loss: 1.520 Vali Acc: 0.320 Test Loss: 1.520 Test Acc: 0.320
Validation loss decreased (-0.259984 --> -0.319985).  Saving model ...
Epoch: 5 cost time: 3.7870664596557617
Epoch: 5, Steps: 4 | Train Loss: 1.262 Vali Loss: 1.469 Vali Acc: 0.380 Test Loss: 1.469 Test Acc: 0.380
Validation loss decreased (-0.319985 --> -0.379985).  Saving model ...
Epoch: 6 cost time: 3.6575264930725098
Epoch: 6, Steps: 4 | Train Loss: 1.092 Vali Loss: 1.439 Vali Acc: 0.400 Test Loss: 1.439 Test Acc: 0.400
Validation loss decreased (-0.379985 --> -0.399986).  Saving model ...
Epoch: 7 cost time: 3.7668874263763428
Epoch: 7, Steps: 4 | Train Loss: 0.993 Vali Loss: 1.380 Vali Acc: 0.440 Test Loss: 1.380 Test Acc: 0.440
Validation loss decreased (-0.399986 --> -0.439986).  Saving model ...
Epoch: 8 cost time: 3.6969549655914307
Epoch: 8, Steps: 4 | Train Loss: 0.896 Vali Loss: 1.303 Vali Acc: 0.480 Test Loss: 1.303 Test Acc: 0.480
Validation loss decreased (-0.439986 --> -0.479987).  Saving model ...
Epoch: 9 cost time: 3.8881278038024902
Epoch: 9, Steps: 4 | Train Loss: 0.585 Vali Loss: 1.212 Vali Acc: 0.500 Test Loss: 1.212 Test Acc: 0.500
Validation loss decreased (-0.479987 --> -0.499988).  Saving model ...
Epoch: 10 cost time: 3.641200065612793
Epoch: 10, Steps: 4 | Train Loss: 0.455 Vali Loss: 1.157 Vali Acc: 0.520 Test Loss: 1.157 Test Acc: 0.520
Validation loss decreased (-0.499988 --> -0.519988).  Saving model ...
Epoch: 11 cost time: 3.540675640106201
Epoch: 11, Steps: 4 | Train Loss: 0.401 Vali Loss: 1.140 Vali Acc: 0.520 Test Loss: 1.140 Test Acc: 0.520
Validation loss decreased (-0.519988 --> -0.519989).  Saving model ...
Epoch: 12 cost time: 3.5214147567749023
Epoch: 12, Steps: 4 | Train Loss: 0.505 Vali Loss: 1.114 Vali Acc: 0.520 Test Loss: 1.114 Test Acc: 0.520
Validation loss decreased (-0.519989 --> -0.519989).  Saving model ...
Epoch: 13 cost time: 3.7368218898773193
Epoch: 13, Steps: 4 | Train Loss: 0.247 Vali Loss: 1.065 Vali Acc: 0.560 Test Loss: 1.065 Test Acc: 0.560
Validation loss decreased (-0.519989 --> -0.559989).  Saving model ...
Epoch: 14 cost time: 3.6705098152160645
Epoch: 14, Steps: 4 | Train Loss: 0.374 Vali Loss: 1.095 Vali Acc: 0.520 Test Loss: 1.095 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.636317014694214
Epoch: 15, Steps: 4 | Train Loss: 0.170 Vali Loss: 1.174 Vali Acc: 0.520 Test Loss: 1.174 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.764995574951172
Epoch: 16, Steps: 4 | Train Loss: 0.157 Vali Loss: 1.080 Vali Acc: 0.560 Test Loss: 1.080 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.682347059249878
Epoch: 17, Steps: 4 | Train Loss: 0.110 Vali Loss: 1.055 Vali Acc: 0.560 Test Loss: 1.055 Test Acc: 0.560
Validation loss decreased (-0.559989 --> -0.559989).  Saving model ...
Epoch: 18 cost time: 3.5485823154449463
Epoch: 18, Steps: 4 | Train Loss: 0.080 Vali Loss: 1.116 Vali Acc: 0.540 Test Loss: 1.116 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.634195327758789
Epoch: 19, Steps: 4 | Train Loss: 0.185 Vali Loss: 1.084 Vali Acc: 0.540 Test Loss: 1.084 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.6419944763183594
Epoch: 20, Steps: 4 | Train Loss: 0.045 Vali Loss: 1.069 Vali Acc: 0.600 Test Loss: 1.069 Test Acc: 0.600
Validation loss decreased (-0.559989 --> -0.599989).  Saving model ...
Epoch: 21 cost time: 3.517970323562622
Epoch: 21, Steps: 4 | Train Loss: 0.055 Vali Loss: 1.124 Vali Acc: 0.620 Test Loss: 1.124 Test Acc: 0.620
Validation loss decreased (-0.599989 --> -0.619989).  Saving model ...
Epoch: 22 cost time: 3.3692758083343506
Epoch: 22, Steps: 4 | Train Loss: 0.045 Vali Loss: 1.041 Vali Acc: 0.600 Test Loss: 1.041 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.425370693206787
Epoch: 23, Steps: 4 | Train Loss: 0.043 Vali Loss: 1.075 Vali Acc: 0.620 Test Loss: 1.075 Test Acc: 0.620
Validation loss decreased (-0.619989 --> -0.619989).  Saving model ...
Epoch: 24 cost time: 3.5474307537078857
Epoch: 24, Steps: 4 | Train Loss: 0.033 Vali Loss: 1.268 Vali Acc: 0.520 Test Loss: 1.268 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.9050238132476807
Epoch: 25, Steps: 4 | Train Loss: 0.034 Vali Loss: 1.148 Vali Acc: 0.520 Test Loss: 1.148 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.411205530166626
Epoch: 26, Steps: 4 | Train Loss: 0.026 Vali Loss: 1.137 Vali Acc: 0.580 Test Loss: 1.137 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.3258087635040283
Epoch: 27, Steps: 4 | Train Loss: 0.017 Vali Loss: 1.279 Vali Acc: 0.600 Test Loss: 1.279 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 3.402515411376953
Epoch: 28, Steps: 4 | Train Loss: 0.016 Vali Loss: 1.286 Vali Acc: 0.540 Test Loss: 1.286 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 3.3688762187957764
Epoch: 29, Steps: 4 | Train Loss: 0.012 Vali Loss: 1.277 Vali Acc: 0.520 Test Loss: 1.277 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 3.626936197280884
Epoch: 30, Steps: 4 | Train Loss: 0.009 Vali Loss: 1.291 Vali Acc: 0.480 Test Loss: 1.291 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm32_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.62
model parameter : 3688613
model size : 14.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm32_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.117955446243286
Epoch: 1, Steps: 4 | Train Loss: 1.657 Vali Loss: 1.702 Vali Acc: 0.260 Test Loss: 1.702 Test Acc: 0.260
Validation loss decreased (inf --> -0.259983).  Saving model ...
Epoch: 2 cost time: 2.143174648284912
Epoch: 2, Steps: 4 | Train Loss: 1.696 Vali Loss: 1.657 Vali Acc: 0.280 Test Loss: 1.657 Test Acc: 0.280
Validation loss decreased (-0.259983 --> -0.279983).  Saving model ...
Epoch: 3 cost time: 2.165165901184082
Epoch: 3, Steps: 4 | Train Loss: 1.439 Vali Loss: 1.581 Vali Acc: 0.360 Test Loss: 1.581 Test Acc: 0.360
Validation loss decreased (-0.279983 --> -0.359984).  Saving model ...
Epoch: 4 cost time: 2.326235294342041
Epoch: 4, Steps: 4 | Train Loss: 1.390 Vali Loss: 1.525 Vali Acc: 0.380 Test Loss: 1.525 Test Acc: 0.380
Validation loss decreased (-0.359984 --> -0.379985).  Saving model ...
Epoch: 5 cost time: 2.1981775760650635
Epoch: 5, Steps: 4 | Train Loss: 1.209 Vali Loss: 1.483 Vali Acc: 0.420 Test Loss: 1.483 Test Acc: 0.420
Validation loss decreased (-0.379985 --> -0.419985).  Saving model ...
Epoch: 6 cost time: 2.2309865951538086
Epoch: 6, Steps: 4 | Train Loss: 1.006 Vali Loss: 1.423 Vali Acc: 0.420 Test Loss: 1.423 Test Acc: 0.420
Validation loss decreased (-0.419985 --> -0.419986).  Saving model ...
Epoch: 7 cost time: 2.147507667541504
Epoch: 7, Steps: 4 | Train Loss: 0.924 Vali Loss: 1.339 Vali Acc: 0.520 Test Loss: 1.339 Test Acc: 0.520
Validation loss decreased (-0.419986 --> -0.519987).  Saving model ...
Epoch: 8 cost time: 2.154284954071045
Epoch: 8, Steps: 4 | Train Loss: 0.676 Vali Loss: 1.251 Vali Acc: 0.540 Test Loss: 1.251 Test Acc: 0.540
Validation loss decreased (-0.519987 --> -0.539987).  Saving model ...
Epoch: 9 cost time: 2.1709671020507812
Epoch: 9, Steps: 4 | Train Loss: 0.687 Vali Loss: 1.228 Vali Acc: 0.480 Test Loss: 1.228 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.274686098098755
Epoch: 10, Steps: 4 | Train Loss: 0.589 Vali Loss: 1.233 Vali Acc: 0.460 Test Loss: 1.233 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.0886588096618652
Epoch: 11, Steps: 4 | Train Loss: 0.413 Vali Loss: 1.198 Vali Acc: 0.560 Test Loss: 1.198 Test Acc: 0.560
Validation loss decreased (-0.539987 --> -0.559988).  Saving model ...
Epoch: 12 cost time: 2.1456446647644043
Epoch: 12, Steps: 4 | Train Loss: 0.395 Vali Loss: 1.119 Vali Acc: 0.520 Test Loss: 1.119 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.192486524581909
Epoch: 13, Steps: 4 | Train Loss: 0.264 Vali Loss: 1.102 Vali Acc: 0.520 Test Loss: 1.102 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.191422700881958
Epoch: 14, Steps: 4 | Train Loss: 0.212 Vali Loss: 1.106 Vali Acc: 0.540 Test Loss: 1.106 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.2586464881896973
Epoch: 15, Steps: 4 | Train Loss: 0.224 Vali Loss: 1.124 Vali Acc: 0.520 Test Loss: 1.124 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.0953903198242188
Epoch: 16, Steps: 4 | Train Loss: 0.279 Vali Loss: 1.087 Vali Acc: 0.560 Test Loss: 1.087 Test Acc: 0.560
Validation loss decreased (-0.559988 --> -0.559989).  Saving model ...
Epoch: 17 cost time: 2.182847261428833
Epoch: 17, Steps: 4 | Train Loss: 0.105 Vali Loss: 1.241 Vali Acc: 0.560 Test Loss: 1.241 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.0542471408843994
Epoch: 18, Steps: 4 | Train Loss: 0.097 Vali Loss: 1.294 Vali Acc: 0.500 Test Loss: 1.294 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.165898561477661
Epoch: 19, Steps: 4 | Train Loss: 0.088 Vali Loss: 1.272 Vali Acc: 0.580 Test Loss: 1.272 Test Acc: 0.580
Validation loss decreased (-0.559989 --> -0.579987).  Saving model ...
Epoch: 20 cost time: 2.1498193740844727
Epoch: 20, Steps: 4 | Train Loss: 0.062 Vali Loss: 1.289 Vali Acc: 0.560 Test Loss: 1.289 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.181647539138794
Epoch: 21, Steps: 4 | Train Loss: 0.051 Vali Loss: 1.171 Vali Acc: 0.540 Test Loss: 1.171 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.1660122871398926
Epoch: 22, Steps: 4 | Train Loss: 0.046 Vali Loss: 1.183 Vali Acc: 0.540 Test Loss: 1.183 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.1937315464019775
Epoch: 23, Steps: 4 | Train Loss: 0.042 Vali Loss: 1.237 Vali Acc: 0.540 Test Loss: 1.237 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.0700790882110596
Epoch: 24, Steps: 4 | Train Loss: 0.027 Vali Loss: 1.171 Vali Acc: 0.520 Test Loss: 1.171 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.1011343002319336
Epoch: 25, Steps: 4 | Train Loss: 0.024 Vali Loss: 1.234 Vali Acc: 0.540 Test Loss: 1.234 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.0315916538238525
Epoch: 26, Steps: 4 | Train Loss: 0.018 Vali Loss: 1.279 Vali Acc: 0.540 Test Loss: 1.279 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.1386563777923584
Epoch: 27, Steps: 4 | Train Loss: 0.021 Vali Loss: 1.239 Vali Acc: 0.540 Test Loss: 1.239 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.7817814350128174
Epoch: 28, Steps: 4 | Train Loss: 0.014 Vali Loss: 1.189 Vali Acc: 0.560 Test Loss: 1.189 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.3005058765411377
Epoch: 29, Steps: 4 | Train Loss: 0.014 Vali Loss: 1.212 Vali Acc: 0.600 Test Loss: 1.212 Test Acc: 0.600
Validation loss decreased (-0.579987 --> -0.599988).  Saving model ...
Epoch: 30 cost time: 2.0395708084106445
Epoch: 30, Steps: 4 | Train Loss: 0.013 Vali Loss: 1.192 Vali Acc: 0.600 Test Loss: 1.192 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599988).  Saving model ...
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm32_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 1205861
model size : 5.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm32_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.466804265975952
Epoch: 1, Steps: 4 | Train Loss: 1.676 Vali Loss: 1.652 Vali Acc: 0.160 Test Loss: 1.652 Test Acc: 0.160
Validation loss decreased (inf --> -0.159983).  Saving model ...
Epoch: 2 cost time: 2.1103036403656006
Epoch: 2, Steps: 4 | Train Loss: 1.647 Vali Loss: 1.615 Vali Acc: 0.240 Test Loss: 1.615 Test Acc: 0.240
Validation loss decreased (-0.159983 --> -0.239984).  Saving model ...
Epoch: 3 cost time: 2.5309975147247314
Epoch: 3, Steps: 4 | Train Loss: 1.561 Vali Loss: 1.570 Vali Acc: 0.260 Test Loss: 1.570 Test Acc: 0.260
Validation loss decreased (-0.239984 --> -0.259984).  Saving model ...
Epoch: 4 cost time: 2.5807111263275146
Epoch: 4, Steps: 4 | Train Loss: 1.339 Vali Loss: 1.517 Vali Acc: 0.300 Test Loss: 1.517 Test Acc: 0.300
Validation loss decreased (-0.259984 --> -0.299985).  Saving model ...
Epoch: 5 cost time: 2.6434853076934814
Epoch: 5, Steps: 4 | Train Loss: 1.277 Vali Loss: 1.465 Vali Acc: 0.380 Test Loss: 1.465 Test Acc: 0.380
Validation loss decreased (-0.299985 --> -0.379985).  Saving model ...
Epoch: 6 cost time: 2.587961435317993
Epoch: 6, Steps: 4 | Train Loss: 1.097 Vali Loss: 1.433 Vali Acc: 0.420 Test Loss: 1.433 Test Acc: 0.420
Validation loss decreased (-0.379985 --> -0.419986).  Saving model ...
Epoch: 7 cost time: 2.5159108638763428
Epoch: 7, Steps: 4 | Train Loss: 0.998 Vali Loss: 1.370 Vali Acc: 0.460 Test Loss: 1.370 Test Acc: 0.460
Validation loss decreased (-0.419986 --> -0.459986).  Saving model ...
Epoch: 8 cost time: 2.513728380203247
Epoch: 8, Steps: 4 | Train Loss: 0.899 Vali Loss: 1.290 Vali Acc: 0.520 Test Loss: 1.290 Test Acc: 0.520
Validation loss decreased (-0.459986 --> -0.519987).  Saving model ...
Epoch: 9 cost time: 2.1636922359466553
Epoch: 9, Steps: 4 | Train Loss: 0.604 Vali Loss: 1.191 Vali Acc: 0.520 Test Loss: 1.191 Test Acc: 0.520
Validation loss decreased (-0.519987 --> -0.519988).  Saving model ...
Epoch: 10 cost time: 2.5894196033477783
Epoch: 10, Steps: 4 | Train Loss: 0.460 Vali Loss: 1.124 Vali Acc: 0.540 Test Loss: 1.124 Test Acc: 0.540
Validation loss decreased (-0.519988 --> -0.539989).  Saving model ...
Epoch: 11 cost time: 2.557856321334839
Epoch: 11, Steps: 4 | Train Loss: 0.399 Vali Loss: 1.098 Vali Acc: 0.540 Test Loss: 1.098 Test Acc: 0.540
Validation loss decreased (-0.539989 --> -0.539989).  Saving model ...
Epoch: 12 cost time: 2.651829719543457
Epoch: 12, Steps: 4 | Train Loss: 0.504 Vali Loss: 1.072 Vali Acc: 0.560 Test Loss: 1.072 Test Acc: 0.560
Validation loss decreased (-0.539989 --> -0.559989).  Saving model ...
Epoch: 13 cost time: 2.583045482635498
Epoch: 13, Steps: 4 | Train Loss: 0.246 Vali Loss: 1.028 Vali Acc: 0.600 Test Loss: 1.028 Test Acc: 0.600
Validation loss decreased (-0.559989 --> -0.599990).  Saving model ...
Epoch: 14 cost time: 2.548736572265625
Epoch: 14, Steps: 4 | Train Loss: 0.376 Vali Loss: 1.057 Vali Acc: 0.520 Test Loss: 1.057 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.537369966506958
Epoch: 15, Steps: 4 | Train Loss: 0.170 Vali Loss: 1.118 Vali Acc: 0.540 Test Loss: 1.118 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.2152957916259766
Epoch: 16, Steps: 4 | Train Loss: 0.254 Vali Loss: 1.031 Vali Acc: 0.620 Test Loss: 1.031 Test Acc: 0.620
Validation loss decreased (-0.599990 --> -0.619990).  Saving model ...
Epoch: 17 cost time: 2.706479549407959
Epoch: 17, Steps: 4 | Train Loss: 0.126 Vali Loss: 1.053 Vali Acc: 0.560 Test Loss: 1.053 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.6527459621429443
Epoch: 18, Steps: 4 | Train Loss: 0.081 Vali Loss: 1.090 Vali Acc: 0.580 Test Loss: 1.090 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.633279323577881
Epoch: 19, Steps: 4 | Train Loss: 0.187 Vali Loss: 1.029 Vali Acc: 0.600 Test Loss: 1.029 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.587538719177246
Epoch: 20, Steps: 4 | Train Loss: 0.043 Vali Loss: 1.008 Vali Acc: 0.660 Test Loss: 1.008 Test Acc: 0.660
Validation loss decreased (-0.619990 --> -0.659990).  Saving model ...
Epoch: 21 cost time: 2.5179355144500732
Epoch: 21, Steps: 4 | Train Loss: 0.054 Vali Loss: 1.056 Vali Acc: 0.640 Test Loss: 1.056 Test Acc: 0.640
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.4487040042877197
Epoch: 22, Steps: 4 | Train Loss: 0.045 Vali Loss: 1.001 Vali Acc: 0.660 Test Loss: 1.001 Test Acc: 0.660
Validation loss decreased (-0.659990 --> -0.659990).  Saving model ...
Epoch: 23 cost time: 2.500950574874878
Epoch: 23, Steps: 4 | Train Loss: 0.043 Vali Loss: 1.018 Vali Acc: 0.640 Test Loss: 1.018 Test Acc: 0.640
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.6533620357513428
Epoch: 24, Steps: 4 | Train Loss: 0.034 Vali Loss: 1.200 Vali Acc: 0.580 Test Loss: 1.200 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.639861583709717
Epoch: 25, Steps: 4 | Train Loss: 0.039 Vali Loss: 1.090 Vali Acc: 0.540 Test Loss: 1.090 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.6235151290893555
Epoch: 26, Steps: 4 | Train Loss: 0.029 Vali Loss: 1.110 Vali Acc: 0.600 Test Loss: 1.110 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.5206124782562256
Epoch: 27, Steps: 4 | Train Loss: 0.018 Vali Loss: 1.234 Vali Acc: 0.580 Test Loss: 1.234 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.567065715789795
Epoch: 28, Steps: 4 | Train Loss: 0.017 Vali Loss: 1.210 Vali Acc: 0.560 Test Loss: 1.210 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 2.5005741119384766
Epoch: 29, Steps: 4 | Train Loss: 0.014 Vali Loss: 1.202 Vali Acc: 0.520 Test Loss: 1.202 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 2.620922327041626
Epoch: 30, Steps: 4 | Train Loss: 0.010 Vali Loss: 1.217 Vali Acc: 0.500 Test Loss: 1.217 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm32_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.66
model parameter : 3688613
model size : 14.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm32_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.669541120529175
Epoch: 1, Steps: 4 | Train Loss: 1.657 Vali Loss: 1.703 Vali Acc: 0.260 Test Loss: 1.703 Test Acc: 0.260
Validation loss decreased (inf --> -0.259983).  Saving model ...
Epoch: 2 cost time: 1.6400647163391113
Epoch: 2, Steps: 4 | Train Loss: 1.691 Vali Loss: 1.657 Vali Acc: 0.280 Test Loss: 1.657 Test Acc: 0.280
Validation loss decreased (-0.259983 --> -0.279983).  Saving model ...
Epoch: 3 cost time: 1.6245050430297852
Epoch: 3, Steps: 4 | Train Loss: 1.443 Vali Loss: 1.581 Vali Acc: 0.340 Test Loss: 1.581 Test Acc: 0.340
Validation loss decreased (-0.279983 --> -0.339984).  Saving model ...
Epoch: 4 cost time: 1.6296226978302002
Epoch: 4, Steps: 4 | Train Loss: 1.394 Vali Loss: 1.520 Vali Acc: 0.380 Test Loss: 1.520 Test Acc: 0.380
Validation loss decreased (-0.339984 --> -0.379985).  Saving model ...
Epoch: 5 cost time: 1.6325421333312988
Epoch: 5, Steps: 4 | Train Loss: 1.212 Vali Loss: 1.475 Vali Acc: 0.420 Test Loss: 1.475 Test Acc: 0.420
Validation loss decreased (-0.379985 --> -0.419985).  Saving model ...
Epoch: 6 cost time: 1.6614081859588623
Epoch: 6, Steps: 4 | Train Loss: 1.008 Vali Loss: 1.413 Vali Acc: 0.420 Test Loss: 1.413 Test Acc: 0.420
Validation loss decreased (-0.419985 --> -0.419986).  Saving model ...
Epoch: 7 cost time: 1.587934970855713
Epoch: 7, Steps: 4 | Train Loss: 0.927 Vali Loss: 1.326 Vali Acc: 0.500 Test Loss: 1.326 Test Acc: 0.500
Validation loss decreased (-0.419986 --> -0.499987).  Saving model ...
Epoch: 8 cost time: 1.642759084701538
Epoch: 8, Steps: 4 | Train Loss: 0.682 Vali Loss: 1.233 Vali Acc: 0.540 Test Loss: 1.233 Test Acc: 0.540
Validation loss decreased (-0.499987 --> -0.539988).  Saving model ...
Epoch: 9 cost time: 1.5382399559020996
Epoch: 9, Steps: 4 | Train Loss: 0.687 Vali Loss: 1.208 Vali Acc: 0.500 Test Loss: 1.208 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6558337211608887
Epoch: 10, Steps: 4 | Train Loss: 0.589 Vali Loss: 1.208 Vali Acc: 0.480 Test Loss: 1.208 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.6491961479187012
Epoch: 11, Steps: 4 | Train Loss: 0.410 Vali Loss: 1.158 Vali Acc: 0.520 Test Loss: 1.158 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.6702914237976074
Epoch: 12, Steps: 4 | Train Loss: 0.395 Vali Loss: 1.073 Vali Acc: 0.520 Test Loss: 1.073 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.5918993949890137
Epoch: 13, Steps: 4 | Train Loss: 0.264 Vali Loss: 1.056 Vali Acc: 0.540 Test Loss: 1.056 Test Acc: 0.540
Validation loss decreased (-0.539988 --> -0.539989).  Saving model ...
Epoch: 14 cost time: 1.6485247611999512
Epoch: 14, Steps: 4 | Train Loss: 0.214 Vali Loss: 1.059 Vali Acc: 0.520 Test Loss: 1.059 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.6472642421722412
Epoch: 15, Steps: 4 | Train Loss: 0.230 Vali Loss: 1.065 Vali Acc: 0.540 Test Loss: 1.065 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.786346435546875
Epoch: 16, Steps: 4 | Train Loss: 0.155 Vali Loss: 1.027 Vali Acc: 0.580 Test Loss: 1.027 Test Acc: 0.580
Validation loss decreased (-0.539989 --> -0.579990).  Saving model ...
Epoch: 17 cost time: 1.615210771560669
Epoch: 17, Steps: 4 | Train Loss: 0.120 Vali Loss: 1.111 Vali Acc: 0.540 Test Loss: 1.111 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.6662342548370361
Epoch: 18, Steps: 4 | Train Loss: 0.091 Vali Loss: 1.095 Vali Acc: 0.540 Test Loss: 1.095 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.6534323692321777
Epoch: 19, Steps: 4 | Train Loss: 0.098 Vali Loss: 1.118 Vali Acc: 0.560 Test Loss: 1.118 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.595226526260376
Epoch: 20, Steps: 4 | Train Loss: 0.135 Vali Loss: 1.255 Vali Acc: 0.540 Test Loss: 1.255 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.6508159637451172
Epoch: 21, Steps: 4 | Train Loss: 0.057 Vali Loss: 1.212 Vali Acc: 0.560 Test Loss: 1.212 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.6962287425994873
Epoch: 22, Steps: 4 | Train Loss: 0.052 Vali Loss: 1.161 Vali Acc: 0.540 Test Loss: 1.161 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.676504135131836
Epoch: 23, Steps: 4 | Train Loss: 0.043 Vali Loss: 1.127 Vali Acc: 0.580 Test Loss: 1.127 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.7276296615600586
Epoch: 24, Steps: 4 | Train Loss: 0.028 Vali Loss: 1.066 Vali Acc: 0.600 Test Loss: 1.066 Test Acc: 0.600
Validation loss decreased (-0.579990 --> -0.599989).  Saving model ...
Epoch: 25 cost time: 1.7947640419006348
Epoch: 25, Steps: 4 | Train Loss: 0.027 Vali Loss: 1.128 Vali Acc: 0.600 Test Loss: 1.128 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.5711684226989746
Epoch: 26, Steps: 4 | Train Loss: 0.019 Vali Loss: 1.178 Vali Acc: 0.540 Test Loss: 1.178 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.8014025688171387
Epoch: 27, Steps: 4 | Train Loss: 0.018 Vali Loss: 1.158 Vali Acc: 0.560 Test Loss: 1.158 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.7019295692443848
Epoch: 28, Steps: 4 | Train Loss: 0.015 Vali Loss: 1.101 Vali Acc: 0.580 Test Loss: 1.101 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.7337274551391602
Epoch: 29, Steps: 4 | Train Loss: 0.014 Vali Loss: 1.121 Vali Acc: 0.620 Test Loss: 1.121 Test Acc: 0.620
Validation loss decreased (-0.599989 --> -0.619989).  Saving model ...
Epoch: 30 cost time: 1.6979243755340576
Epoch: 30, Steps: 4 | Train Loss: 0.012 Vali Loss: 1.123 Vali Acc: 0.660 Test Loss: 1.123 Test Acc: 0.660
Validation loss decreased (-0.619989 --> -0.659989).  Saving model ...
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm32_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.66
model parameter : 1205861
model size : 5.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm32_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.9342596530914307
Epoch: 1, Steps: 4 | Train Loss: 1.677 Vali Loss: 1.657 Vali Acc: 0.160 Test Loss: 1.657 Test Acc: 0.160
Validation loss decreased (inf --> -0.159983).  Saving model ...
Epoch: 2 cost time: 1.985982894897461
Epoch: 2, Steps: 4 | Train Loss: 1.646 Vali Loss: 1.620 Vali Acc: 0.240 Test Loss: 1.620 Test Acc: 0.240
Validation loss decreased (-0.159983 --> -0.239984).  Saving model ...
Epoch: 3 cost time: 1.986158847808838
Epoch: 3, Steps: 4 | Train Loss: 1.563 Vali Loss: 1.573 Vali Acc: 0.260 Test Loss: 1.573 Test Acc: 0.260
Validation loss decreased (-0.239984 --> -0.259984).  Saving model ...
Epoch: 4 cost time: 1.976940631866455
Epoch: 4, Steps: 4 | Train Loss: 1.343 Vali Loss: 1.518 Vali Acc: 0.300 Test Loss: 1.518 Test Acc: 0.300
Validation loss decreased (-0.259984 --> -0.299985).  Saving model ...
Epoch: 5 cost time: 1.942232608795166
Epoch: 5, Steps: 4 | Train Loss: 1.285 Vali Loss: 1.467 Vali Acc: 0.360 Test Loss: 1.467 Test Acc: 0.360
Validation loss decreased (-0.299985 --> -0.359985).  Saving model ...
Epoch: 6 cost time: 1.9044537544250488
Epoch: 6, Steps: 4 | Train Loss: 1.110 Vali Loss: 1.436 Vali Acc: 0.400 Test Loss: 1.436 Test Acc: 0.400
Validation loss decreased (-0.359985 --> -0.399986).  Saving model ...
Epoch: 7 cost time: 2.0150370597839355
Epoch: 7, Steps: 4 | Train Loss: 1.013 Vali Loss: 1.373 Vali Acc: 0.440 Test Loss: 1.373 Test Acc: 0.440
Validation loss decreased (-0.399986 --> -0.439986).  Saving model ...
Epoch: 8 cost time: 1.702519416809082
Epoch: 8, Steps: 4 | Train Loss: 0.912 Vali Loss: 1.294 Vali Acc: 0.480 Test Loss: 1.294 Test Acc: 0.480
Validation loss decreased (-0.439986 --> -0.479987).  Saving model ...
Epoch: 9 cost time: 1.7158982753753662
Epoch: 9, Steps: 4 | Train Loss: 0.626 Vali Loss: 1.189 Vali Acc: 0.560 Test Loss: 1.189 Test Acc: 0.560
Validation loss decreased (-0.479987 --> -0.559988).  Saving model ...
Epoch: 10 cost time: 1.816967487335205
Epoch: 10, Steps: 4 | Train Loss: 0.482 Vali Loss: 1.120 Vali Acc: 0.540 Test Loss: 1.120 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.965052604675293
Epoch: 11, Steps: 4 | Train Loss: 0.423 Vali Loss: 1.105 Vali Acc: 0.560 Test Loss: 1.105 Test Acc: 0.560
Validation loss decreased (-0.559988 --> -0.559989).  Saving model ...
Epoch: 12 cost time: 1.8913705348968506
Epoch: 12, Steps: 4 | Train Loss: 0.525 Vali Loss: 1.046 Vali Acc: 0.600 Test Loss: 1.046 Test Acc: 0.600
Validation loss decreased (-0.559989 --> -0.599990).  Saving model ...
Epoch: 13 cost time: 1.805480718612671
Epoch: 13, Steps: 4 | Train Loss: 0.264 Vali Loss: 1.035 Vali Acc: 0.640 Test Loss: 1.035 Test Acc: 0.640
Validation loss decreased (-0.599990 --> -0.639990).  Saving model ...
Epoch: 14 cost time: 1.9636354446411133
Epoch: 14, Steps: 4 | Train Loss: 0.393 Vali Loss: 1.059 Vali Acc: 0.580 Test Loss: 1.059 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.8755004405975342
Epoch: 15, Steps: 4 | Train Loss: 0.189 Vali Loss: 1.042 Vali Acc: 0.580 Test Loss: 1.042 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.0277020931243896
Epoch: 16, Steps: 4 | Train Loss: 0.169 Vali Loss: 1.040 Vali Acc: 0.580 Test Loss: 1.040 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.9329288005828857
Epoch: 17, Steps: 4 | Train Loss: 0.120 Vali Loss: 1.082 Vali Acc: 0.560 Test Loss: 1.082 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.8720324039459229
Epoch: 18, Steps: 4 | Train Loss: 0.095 Vali Loss: 1.104 Vali Acc: 0.540 Test Loss: 1.104 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.911834478378296
Epoch: 19, Steps: 4 | Train Loss: 0.202 Vali Loss: 1.053 Vali Acc: 0.560 Test Loss: 1.053 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.0068626403808594
Epoch: 20, Steps: 4 | Train Loss: 0.087 Vali Loss: 1.100 Vali Acc: 0.600 Test Loss: 1.100 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.9553589820861816
Epoch: 21, Steps: 4 | Train Loss: 0.067 Vali Loss: 1.161 Vali Acc: 0.560 Test Loss: 1.161 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.8434040546417236
Epoch: 22, Steps: 4 | Train Loss: 0.060 Vali Loss: 1.143 Vali Acc: 0.600 Test Loss: 1.143 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.7865979671478271
Epoch: 23, Steps: 4 | Train Loss: 0.070 Vali Loss: 1.159 Vali Acc: 0.560 Test Loss: 1.159 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm32_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.64
model parameter : 3688613
model size : 14.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm32_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.1326518058776855
Epoch: 1, Steps: 4 | Train Loss: 1.656 Vali Loss: 1.706 Vali Acc: 0.260 Test Loss: 1.706 Test Acc: 0.260
Validation loss decreased (inf --> -0.259983).  Saving model ...
Epoch: 2 cost time: 1.2992339134216309
Epoch: 2, Steps: 4 | Train Loss: 1.690 Vali Loss: 1.660 Vali Acc: 0.280 Test Loss: 1.660 Test Acc: 0.280
Validation loss decreased (-0.259983 --> -0.279983).  Saving model ...
Epoch: 3 cost time: 1.4117777347564697
Epoch: 3, Steps: 4 | Train Loss: 1.442 Vali Loss: 1.585 Vali Acc: 0.340 Test Loss: 1.585 Test Acc: 0.340
Validation loss decreased (-0.279983 --> -0.339984).  Saving model ...
Epoch: 4 cost time: 1.4050514698028564
Epoch: 4, Steps: 4 | Train Loss: 1.396 Vali Loss: 1.528 Vali Acc: 0.340 Test Loss: 1.528 Test Acc: 0.340
Validation loss decreased (-0.339984 --> -0.339985).  Saving model ...
Epoch: 5 cost time: 1.2603638172149658
Epoch: 5, Steps: 4 | Train Loss: 1.214 Vali Loss: 1.486 Vali Acc: 0.420 Test Loss: 1.486 Test Acc: 0.420
Validation loss decreased (-0.339985 --> -0.419985).  Saving model ...
Epoch: 6 cost time: 1.3425910472869873
Epoch: 6, Steps: 4 | Train Loss: 1.013 Vali Loss: 1.426 Vali Acc: 0.420 Test Loss: 1.426 Test Acc: 0.420
Validation loss decreased (-0.419985 --> -0.419986).  Saving model ...
Epoch: 7 cost time: 1.4111716747283936
Epoch: 7, Steps: 4 | Train Loss: 0.933 Vali Loss: 1.338 Vali Acc: 0.520 Test Loss: 1.338 Test Acc: 0.520
Validation loss decreased (-0.419986 --> -0.519987).  Saving model ...
Epoch: 8 cost time: 1.4080801010131836
Epoch: 8, Steps: 4 | Train Loss: 0.689 Vali Loss: 1.243 Vali Acc: 0.540 Test Loss: 1.243 Test Acc: 0.540
Validation loss decreased (-0.519987 --> -0.539988).  Saving model ...
Epoch: 9 cost time: 1.329683542251587
Epoch: 9, Steps: 4 | Train Loss: 0.702 Vali Loss: 1.215 Vali Acc: 0.480 Test Loss: 1.215 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2877254486083984
Epoch: 10, Steps: 4 | Train Loss: 0.605 Vali Loss: 1.212 Vali Acc: 0.480 Test Loss: 1.212 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.2149028778076172
Epoch: 11, Steps: 4 | Train Loss: 0.428 Vali Loss: 1.163 Vali Acc: 0.500 Test Loss: 1.163 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.314012050628662
Epoch: 12, Steps: 4 | Train Loss: 0.415 Vali Loss: 1.075 Vali Acc: 0.520 Test Loss: 1.075 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.3331990242004395
Epoch: 13, Steps: 4 | Train Loss: 0.283 Vali Loss: 1.061 Vali Acc: 0.500 Test Loss: 1.061 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.3284366130828857
Epoch: 14, Steps: 4 | Train Loss: 0.228 Vali Loss: 1.082 Vali Acc: 0.540 Test Loss: 1.082 Test Acc: 0.540
Validation loss decreased (-0.539988 --> -0.539989).  Saving model ...
Epoch: 15 cost time: 1.3132789134979248
Epoch: 15, Steps: 4 | Train Loss: 0.223 Vali Loss: 1.082 Vali Acc: 0.540 Test Loss: 1.082 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.452354907989502
Epoch: 16, Steps: 4 | Train Loss: 0.175 Vali Loss: 1.056 Vali Acc: 0.580 Test Loss: 1.056 Test Acc: 0.580
Validation loss decreased (-0.539989 --> -0.579989).  Saving model ...
Epoch: 17 cost time: 1.437272548675537
Epoch: 17, Steps: 4 | Train Loss: 0.136 Vali Loss: 1.136 Vali Acc: 0.520 Test Loss: 1.136 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.340648889541626
Epoch: 18, Steps: 4 | Train Loss: 0.105 Vali Loss: 1.116 Vali Acc: 0.540 Test Loss: 1.116 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.402275562286377
Epoch: 19, Steps: 4 | Train Loss: 0.094 Vali Loss: 1.177 Vali Acc: 0.540 Test Loss: 1.177 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.481520414352417
Epoch: 20, Steps: 4 | Train Loss: 0.067 Vali Loss: 1.310 Vali Acc: 0.560 Test Loss: 1.310 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.4055900573730469
Epoch: 21, Steps: 4 | Train Loss: 0.061 Vali Loss: 1.124 Vali Acc: 0.580 Test Loss: 1.124 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.410904884338379
Epoch: 22, Steps: 4 | Train Loss: 0.059 Vali Loss: 1.110 Vali Acc: 0.560 Test Loss: 1.110 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.4336671829223633
Epoch: 23, Steps: 4 | Train Loss: 0.048 Vali Loss: 1.172 Vali Acc: 0.540 Test Loss: 1.172 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.4465582370758057
Epoch: 24, Steps: 4 | Train Loss: 0.031 Vali Loss: 1.125 Vali Acc: 0.600 Test Loss: 1.125 Test Acc: 0.600
Validation loss decreased (-0.579989 --> -0.599989).  Saving model ...
Epoch: 25 cost time: 1.3417377471923828
Epoch: 25, Steps: 4 | Train Loss: 0.032 Vali Loss: 1.174 Vali Acc: 0.560 Test Loss: 1.174 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.3516426086425781
Epoch: 26, Steps: 4 | Train Loss: 0.021 Vali Loss: 1.213 Vali Acc: 0.560 Test Loss: 1.213 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.3393943309783936
Epoch: 27, Steps: 4 | Train Loss: 0.020 Vali Loss: 1.168 Vali Acc: 0.600 Test Loss: 1.168 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.418773889541626
Epoch: 28, Steps: 4 | Train Loss: 0.018 Vali Loss: 1.093 Vali Acc: 0.560 Test Loss: 1.093 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.447420358657837
Epoch: 29, Steps: 4 | Train Loss: 0.015 Vali Loss: 1.103 Vali Acc: 0.580 Test Loss: 1.103 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.417574405670166
Epoch: 30, Steps: 4 | Train Loss: 0.013 Vali Loss: 1.144 Vali Acc: 0.620 Test Loss: 1.144 Test Acc: 0.620
Validation loss decreased (-0.599989 --> -0.619989).  Saving model ...
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm32_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.62
model parameter : 1205861
model size : 5.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm32_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.335812091827393
Epoch: 1, Steps: 4 | Train Loss: 1.706 Vali Loss: 1.600 Vali Acc: 0.180 Test Loss: 1.600 Test Acc: 0.180
Validation loss decreased (inf --> -0.179984).  Saving model ...
Epoch: 2 cost time: 2.499436855316162
Epoch: 2, Steps: 4 | Train Loss: 1.703 Vali Loss: 1.574 Vali Acc: 0.120 Test Loss: 1.574 Test Acc: 0.120
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.5286948680877686
Epoch: 3, Steps: 4 | Train Loss: 1.533 Vali Loss: 1.550 Vali Acc: 0.280 Test Loss: 1.550 Test Acc: 0.280
Validation loss decreased (-0.179984 --> -0.279984).  Saving model ...
Epoch: 4 cost time: 2.3606488704681396
Epoch: 4, Steps: 4 | Train Loss: 1.395 Vali Loss: 1.528 Vali Acc: 0.300 Test Loss: 1.528 Test Acc: 0.300
Validation loss decreased (-0.279984 --> -0.299985).  Saving model ...
Epoch: 5 cost time: 2.475292205810547
Epoch: 5, Steps: 4 | Train Loss: 1.293 Vali Loss: 1.503 Vali Acc: 0.340 Test Loss: 1.503 Test Acc: 0.340
Validation loss decreased (-0.299985 --> -0.339985).  Saving model ...
Epoch: 6 cost time: 2.3323779106140137
Epoch: 6, Steps: 4 | Train Loss: 1.101 Vali Loss: 1.464 Vali Acc: 0.400 Test Loss: 1.464 Test Acc: 0.400
Validation loss decreased (-0.339985 --> -0.399985).  Saving model ...
Epoch: 7 cost time: 2.428743839263916
Epoch: 7, Steps: 4 | Train Loss: 1.011 Vali Loss: 1.389 Vali Acc: 0.400 Test Loss: 1.389 Test Acc: 0.400
Validation loss decreased (-0.399985 --> -0.399986).  Saving model ...
Epoch: 8 cost time: 2.5666494369506836
Epoch: 8, Steps: 4 | Train Loss: 1.092 Vali Loss: 1.350 Vali Acc: 0.500 Test Loss: 1.350 Test Acc: 0.500
Validation loss decreased (-0.399986 --> -0.499986).  Saving model ...
Epoch: 9 cost time: 2.3457319736480713
Epoch: 9, Steps: 4 | Train Loss: 0.762 Vali Loss: 1.294 Vali Acc: 0.460 Test Loss: 1.294 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.441624641418457
Epoch: 10, Steps: 4 | Train Loss: 0.670 Vali Loss: 1.234 Vali Acc: 0.480 Test Loss: 1.234 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.1833553314208984
Epoch: 11, Steps: 4 | Train Loss: 0.497 Vali Loss: 1.180 Vali Acc: 0.580 Test Loss: 1.180 Test Acc: 0.580
Validation loss decreased (-0.499986 --> -0.579988).  Saving model ...
Epoch: 12 cost time: 2.0434365272521973
Epoch: 12, Steps: 4 | Train Loss: 0.360 Vali Loss: 1.128 Vali Acc: 0.480 Test Loss: 1.128 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.103976249694824
Epoch: 13, Steps: 4 | Train Loss: 0.291 Vali Loss: 1.124 Vali Acc: 0.500 Test Loss: 1.124 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.5618984699249268
Epoch: 14, Steps: 4 | Train Loss: 0.254 Vali Loss: 1.106 Vali Acc: 0.500 Test Loss: 1.106 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.479611396789551
Epoch: 15, Steps: 4 | Train Loss: 0.200 Vali Loss: 1.104 Vali Acc: 0.560 Test Loss: 1.104 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.4381823539733887
Epoch: 16, Steps: 4 | Train Loss: 0.203 Vali Loss: 1.157 Vali Acc: 0.500 Test Loss: 1.157 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.405719757080078
Epoch: 17, Steps: 4 | Train Loss: 0.135 Vali Loss: 1.085 Vali Acc: 0.460 Test Loss: 1.085 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.5557987689971924
Epoch: 18, Steps: 4 | Train Loss: 0.098 Vali Loss: 1.126 Vali Acc: 0.440 Test Loss: 1.126 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.444575548171997
Epoch: 19, Steps: 4 | Train Loss: 0.086 Vali Loss: 1.218 Vali Acc: 0.520 Test Loss: 1.218 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.47967791557312
Epoch: 20, Steps: 4 | Train Loss: 0.070 Vali Loss: 1.247 Vali Acc: 0.520 Test Loss: 1.247 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.486036777496338
Epoch: 21, Steps: 4 | Train Loss: 0.070 Vali Loss: 1.222 Vali Acc: 0.480 Test Loss: 1.222 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm32_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 1930853
model size : 8.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm32_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.7743122577667236
Epoch: 1, Steps: 4 | Train Loss: 1.591 Vali Loss: 1.601 Vali Acc: 0.240 Test Loss: 1.601 Test Acc: 0.240
Validation loss decreased (inf --> -0.239984).  Saving model ...
Epoch: 2 cost time: 1.6949553489685059
Epoch: 2, Steps: 4 | Train Loss: 1.721 Vali Loss: 1.584 Vali Acc: 0.300 Test Loss: 1.584 Test Acc: 0.300
Validation loss decreased (-0.239984 --> -0.299984).  Saving model ...
Epoch: 3 cost time: 1.6217470169067383
Epoch: 3, Steps: 4 | Train Loss: 1.469 Vali Loss: 1.579 Vali Acc: 0.360 Test Loss: 1.579 Test Acc: 0.360
Validation loss decreased (-0.299984 --> -0.359984).  Saving model ...
Epoch: 4 cost time: 1.59816575050354
Epoch: 4, Steps: 4 | Train Loss: 1.389 Vali Loss: 1.605 Vali Acc: 0.360 Test Loss: 1.605 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6464684009552002
Epoch: 5, Steps: 4 | Train Loss: 1.296 Vali Loss: 1.604 Vali Acc: 0.340 Test Loss: 1.604 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.4329249858856201
Epoch: 6, Steps: 4 | Train Loss: 1.055 Vali Loss: 1.559 Vali Acc: 0.400 Test Loss: 1.559 Test Acc: 0.400
Validation loss decreased (-0.359984 --> -0.399984).  Saving model ...
Epoch: 7 cost time: 1.7625136375427246
Epoch: 7, Steps: 4 | Train Loss: 0.959 Vali Loss: 1.488 Vali Acc: 0.420 Test Loss: 1.488 Test Acc: 0.420
Validation loss decreased (-0.399984 --> -0.419985).  Saving model ...
Epoch: 8 cost time: 1.7078416347503662
Epoch: 8, Steps: 4 | Train Loss: 0.807 Vali Loss: 1.399 Vali Acc: 0.420 Test Loss: 1.399 Test Acc: 0.420
Validation loss decreased (-0.419985 --> -0.419986).  Saving model ...
Epoch: 9 cost time: 1.6724255084991455
Epoch: 9, Steps: 4 | Train Loss: 0.722 Vali Loss: 1.336 Vali Acc: 0.400 Test Loss: 1.336 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.767549753189087
Epoch: 10, Steps: 4 | Train Loss: 0.638 Vali Loss: 1.277 Vali Acc: 0.420 Test Loss: 1.277 Test Acc: 0.420
Validation loss decreased (-0.419986 --> -0.419987).  Saving model ...
Epoch: 11 cost time: 1.581007957458496
Epoch: 11, Steps: 4 | Train Loss: 0.487 Vali Loss: 1.253 Vali Acc: 0.420 Test Loss: 1.253 Test Acc: 0.420
Validation loss decreased (-0.419987 --> -0.419987).  Saving model ...
Epoch: 12 cost time: 1.5823111534118652
Epoch: 12, Steps: 4 | Train Loss: 0.335 Vali Loss: 1.279 Vali Acc: 0.540 Test Loss: 1.279 Test Acc: 0.540
Validation loss decreased (-0.419987 --> -0.539987).  Saving model ...
Epoch: 13 cost time: 1.647190809249878
Epoch: 13, Steps: 4 | Train Loss: 0.294 Vali Loss: 1.289 Vali Acc: 0.520 Test Loss: 1.289 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6079933643341064
Epoch: 14, Steps: 4 | Train Loss: 0.269 Vali Loss: 1.280 Vali Acc: 0.480 Test Loss: 1.280 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.6429240703582764
Epoch: 15, Steps: 4 | Train Loss: 0.192 Vali Loss: 1.216 Vali Acc: 0.500 Test Loss: 1.216 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.6143295764923096
Epoch: 16, Steps: 4 | Train Loss: 0.222 Vali Loss: 1.161 Vali Acc: 0.480 Test Loss: 1.161 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.6363492012023926
Epoch: 17, Steps: 4 | Train Loss: 0.136 Vali Loss: 1.196 Vali Acc: 0.520 Test Loss: 1.196 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.4269065856933594
Epoch: 18, Steps: 4 | Train Loss: 0.165 Vali Loss: 1.119 Vali Acc: 0.540 Test Loss: 1.119 Test Acc: 0.540
Validation loss decreased (-0.539987 --> -0.539989).  Saving model ...
Epoch: 19 cost time: 1.614281415939331
Epoch: 19, Steps: 4 | Train Loss: 0.094 Vali Loss: 1.187 Vali Acc: 0.520 Test Loss: 1.187 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.7288932800292969
Epoch: 20, Steps: 4 | Train Loss: 0.102 Vali Loss: 1.162 Vali Acc: 0.520 Test Loss: 1.162 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.7354798316955566
Epoch: 21, Steps: 4 | Train Loss: 0.087 Vali Loss: 1.096 Vali Acc: 0.480 Test Loss: 1.096 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.6658360958099365
Epoch: 22, Steps: 4 | Train Loss: 0.059 Vali Loss: 1.200 Vali Acc: 0.520 Test Loss: 1.200 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.6190519332885742
Epoch: 23, Steps: 4 | Train Loss: 0.044 Vali Loss: 1.182 Vali Acc: 0.580 Test Loss: 1.182 Test Acc: 0.580
Validation loss decreased (-0.539989 --> -0.579988).  Saving model ...
Epoch: 24 cost time: 1.3113007545471191
Epoch: 24, Steps: 4 | Train Loss: 0.030 Vali Loss: 1.178 Vali Acc: 0.580 Test Loss: 1.178 Test Acc: 0.580
Validation loss decreased (-0.579988 --> -0.579988).  Saving model ...
Epoch: 25 cost time: 1.5137138366699219
Epoch: 25, Steps: 4 | Train Loss: 0.028 Vali Loss: 1.253 Vali Acc: 0.540 Test Loss: 1.253 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.63102126121521
Epoch: 26, Steps: 4 | Train Loss: 0.027 Vali Loss: 1.224 Vali Acc: 0.560 Test Loss: 1.224 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.6640443801879883
Epoch: 27, Steps: 4 | Train Loss: 0.023 Vali Loss: 1.220 Vali Acc: 0.580 Test Loss: 1.220 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.7362604141235352
Epoch: 28, Steps: 4 | Train Loss: 0.021 Vali Loss: 1.280 Vali Acc: 0.580 Test Loss: 1.280 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.7968568801879883
Epoch: 29, Steps: 4 | Train Loss: 0.020 Vali Loss: 1.197 Vali Acc: 0.560 Test Loss: 1.197 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.694427490234375
Epoch: 30, Steps: 4 | Train Loss: 0.017 Vali Loss: 1.252 Vali Acc: 0.540 Test Loss: 1.252 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm32_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 689381
model size : 3.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm32_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.146258354187012
Epoch: 1, Steps: 4 | Train Loss: 1.704 Vali Loss: 1.597 Vali Acc: 0.180 Test Loss: 1.597 Test Acc: 0.180
Validation loss decreased (inf --> -0.179984).  Saving model ...
Epoch: 2 cost time: 2.1804375648498535
Epoch: 2, Steps: 4 | Train Loss: 1.704 Vali Loss: 1.572 Vali Acc: 0.140 Test Loss: 1.572 Test Acc: 0.140
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.2313287258148193
Epoch: 3, Steps: 4 | Train Loss: 1.539 Vali Loss: 1.548 Vali Acc: 0.280 Test Loss: 1.548 Test Acc: 0.280
Validation loss decreased (-0.179984 --> -0.279985).  Saving model ...
Epoch: 4 cost time: 2.1261565685272217
Epoch: 4, Steps: 4 | Train Loss: 1.403 Vali Loss: 1.526 Vali Acc: 0.300 Test Loss: 1.526 Test Acc: 0.300
Validation loss decreased (-0.279985 --> -0.299985).  Saving model ...
Epoch: 5 cost time: 2.130510091781616
Epoch: 5, Steps: 4 | Train Loss: 1.296 Vali Loss: 1.500 Vali Acc: 0.340 Test Loss: 1.500 Test Acc: 0.340
Validation loss decreased (-0.299985 --> -0.339985).  Saving model ...
Epoch: 6 cost time: 2.096362352371216
Epoch: 6, Steps: 4 | Train Loss: 1.105 Vali Loss: 1.460 Vali Acc: 0.440 Test Loss: 1.460 Test Acc: 0.440
Validation loss decreased (-0.339985 --> -0.439985).  Saving model ...
Epoch: 7 cost time: 2.1406333446502686
Epoch: 7, Steps: 4 | Train Loss: 1.012 Vali Loss: 1.383 Vali Acc: 0.420 Test Loss: 1.383 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.0895004272460938
Epoch: 8, Steps: 4 | Train Loss: 1.099 Vali Loss: 1.344 Vali Acc: 0.500 Test Loss: 1.344 Test Acc: 0.500
Validation loss decreased (-0.439985 --> -0.499987).  Saving model ...
Epoch: 9 cost time: 2.1229870319366455
Epoch: 9, Steps: 4 | Train Loss: 0.767 Vali Loss: 1.288 Vali Acc: 0.460 Test Loss: 1.288 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.1011745929718018
Epoch: 10, Steps: 4 | Train Loss: 0.671 Vali Loss: 1.227 Vali Acc: 0.500 Test Loss: 1.227 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499988).  Saving model ...
Epoch: 11 cost time: 2.0299086570739746
Epoch: 11, Steps: 4 | Train Loss: 0.500 Vali Loss: 1.173 Vali Acc: 0.580 Test Loss: 1.173 Test Acc: 0.580
Validation loss decreased (-0.499988 --> -0.579988).  Saving model ...
Epoch: 12 cost time: 2.0326836109161377
Epoch: 12, Steps: 4 | Train Loss: 0.372 Vali Loss: 1.120 Vali Acc: 0.520 Test Loss: 1.120 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.0860018730163574
Epoch: 13, Steps: 4 | Train Loss: 0.295 Vali Loss: 1.110 Vali Acc: 0.520 Test Loss: 1.110 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.1106455326080322
Epoch: 14, Steps: 4 | Train Loss: 0.255 Vali Loss: 1.092 Vali Acc: 0.520 Test Loss: 1.092 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.0978076457977295
Epoch: 15, Steps: 4 | Train Loss: 0.200 Vali Loss: 1.089 Vali Acc: 0.540 Test Loss: 1.089 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.0068933963775635
Epoch: 16, Steps: 4 | Train Loss: 0.199 Vali Loss: 1.145 Vali Acc: 0.520 Test Loss: 1.145 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.0291996002197266
Epoch: 17, Steps: 4 | Train Loss: 0.136 Vali Loss: 1.071 Vali Acc: 0.500 Test Loss: 1.071 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.1447160243988037
Epoch: 18, Steps: 4 | Train Loss: 0.097 Vali Loss: 1.106 Vali Acc: 0.460 Test Loss: 1.106 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.2012295722961426
Epoch: 19, Steps: 4 | Train Loss: 0.087 Vali Loss: 1.189 Vali Acc: 0.540 Test Loss: 1.189 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.1991143226623535
Epoch: 20, Steps: 4 | Train Loss: 0.070 Vali Loss: 1.230 Vali Acc: 0.540 Test Loss: 1.230 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.005112886428833
Epoch: 21, Steps: 4 | Train Loss: 0.070 Vali Loss: 1.212 Vali Acc: 0.480 Test Loss: 1.212 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm32_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 1930853
model size : 8.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm32_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.432528018951416
Epoch: 1, Steps: 4 | Train Loss: 1.589 Vali Loss: 1.601 Vali Acc: 0.220 Test Loss: 1.601 Test Acc: 0.220
Validation loss decreased (inf --> -0.219984).  Saving model ...
Epoch: 2 cost time: 1.4629971981048584
Epoch: 2, Steps: 4 | Train Loss: 1.718 Vali Loss: 1.583 Vali Acc: 0.280 Test Loss: 1.583 Test Acc: 0.280
Validation loss decreased (-0.219984 --> -0.279984).  Saving model ...
Epoch: 3 cost time: 1.6236648559570312
Epoch: 3, Steps: 4 | Train Loss: 1.468 Vali Loss: 1.577 Vali Acc: 0.360 Test Loss: 1.577 Test Acc: 0.360
Validation loss decreased (-0.279984 --> -0.359984).  Saving model ...
Epoch: 4 cost time: 1.5352575778961182
Epoch: 4, Steps: 4 | Train Loss: 1.386 Vali Loss: 1.603 Vali Acc: 0.380 Test Loss: 1.603 Test Acc: 0.380
Validation loss decreased (-0.359984 --> -0.379984).  Saving model ...
Epoch: 5 cost time: 1.5692152976989746
Epoch: 5, Steps: 4 | Train Loss: 1.293 Vali Loss: 1.602 Vali Acc: 0.340 Test Loss: 1.602 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5407769680023193
Epoch: 6, Steps: 4 | Train Loss: 1.070 Vali Loss: 1.554 Vali Acc: 0.420 Test Loss: 1.554 Test Acc: 0.420
Validation loss decreased (-0.379984 --> -0.419984).  Saving model ...
Epoch: 7 cost time: 1.5899920463562012
Epoch: 7, Steps: 4 | Train Loss: 0.955 Vali Loss: 1.482 Vali Acc: 0.420 Test Loss: 1.482 Test Acc: 0.420
Validation loss decreased (-0.419984 --> -0.419985).  Saving model ...
Epoch: 8 cost time: 1.568579912185669
Epoch: 8, Steps: 4 | Train Loss: 0.805 Vali Loss: 1.392 Vali Acc: 0.420 Test Loss: 1.392 Test Acc: 0.420
Validation loss decreased (-0.419985 --> -0.419986).  Saving model ...
Epoch: 9 cost time: 1.5407354831695557
Epoch: 9, Steps: 4 | Train Loss: 0.721 Vali Loss: 1.329 Vali Acc: 0.400 Test Loss: 1.329 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6010336875915527
Epoch: 10, Steps: 4 | Train Loss: 0.634 Vali Loss: 1.269 Vali Acc: 0.420 Test Loss: 1.269 Test Acc: 0.420
Validation loss decreased (-0.419986 --> -0.419987).  Saving model ...
Epoch: 11 cost time: 1.3447332382202148
Epoch: 11, Steps: 4 | Train Loss: 0.470 Vali Loss: 1.241 Vali Acc: 0.440 Test Loss: 1.241 Test Acc: 0.440
Validation loss decreased (-0.419987 --> -0.439988).  Saving model ...
Epoch: 12 cost time: 1.3061442375183105
Epoch: 12, Steps: 4 | Train Loss: 0.335 Vali Loss: 1.265 Vali Acc: 0.540 Test Loss: 1.265 Test Acc: 0.540
Validation loss decreased (-0.439988 --> -0.539987).  Saving model ...
Epoch: 13 cost time: 1.4349267482757568
Epoch: 13, Steps: 4 | Train Loss: 0.298 Vali Loss: 1.277 Vali Acc: 0.540 Test Loss: 1.277 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.586045503616333
Epoch: 14, Steps: 4 | Train Loss: 0.266 Vali Loss: 1.267 Vali Acc: 0.500 Test Loss: 1.267 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.5087151527404785
Epoch: 15, Steps: 4 | Train Loss: 0.193 Vali Loss: 1.197 Vali Acc: 0.460 Test Loss: 1.197 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.5777053833007812
Epoch: 16, Steps: 4 | Train Loss: 0.195 Vali Loss: 1.145 Vali Acc: 0.520 Test Loss: 1.145 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.6604623794555664
Epoch: 17, Steps: 4 | Train Loss: 0.148 Vali Loss: 1.199 Vali Acc: 0.520 Test Loss: 1.199 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.5871639251708984
Epoch: 18, Steps: 4 | Train Loss: 0.161 Vali Loss: 1.099 Vali Acc: 0.540 Test Loss: 1.099 Test Acc: 0.540
Validation loss decreased (-0.539987 --> -0.539989).  Saving model ...
Epoch: 19 cost time: 1.4690754413604736
Epoch: 19, Steps: 4 | Train Loss: 0.094 Vali Loss: 1.127 Vali Acc: 0.520 Test Loss: 1.127 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.6038126945495605
Epoch: 20, Steps: 4 | Train Loss: 0.096 Vali Loss: 1.162 Vali Acc: 0.520 Test Loss: 1.162 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.5592284202575684
Epoch: 21, Steps: 4 | Train Loss: 0.083 Vali Loss: 1.083 Vali Acc: 0.480 Test Loss: 1.083 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.649402141571045
Epoch: 22, Steps: 4 | Train Loss: 0.064 Vali Loss: 1.165 Vali Acc: 0.540 Test Loss: 1.165 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.746537685394287
Epoch: 23, Steps: 4 | Train Loss: 0.043 Vali Loss: 1.176 Vali Acc: 0.540 Test Loss: 1.176 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.6525635719299316
Epoch: 24, Steps: 4 | Train Loss: 0.030 Vali Loss: 1.145 Vali Acc: 0.560 Test Loss: 1.145 Test Acc: 0.560
Validation loss decreased (-0.539989 --> -0.559989).  Saving model ...
Epoch: 25 cost time: 1.6934587955474854
Epoch: 25, Steps: 4 | Train Loss: 0.027 Vali Loss: 1.189 Vali Acc: 0.520 Test Loss: 1.189 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.6664700508117676
Epoch: 26, Steps: 4 | Train Loss: 0.026 Vali Loss: 1.175 Vali Acc: 0.560 Test Loss: 1.175 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.6439123153686523
Epoch: 27, Steps: 4 | Train Loss: 0.020 Vali Loss: 1.208 Vali Acc: 0.560 Test Loss: 1.208 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.8114194869995117
Epoch: 28, Steps: 4 | Train Loss: 0.020 Vali Loss: 1.238 Vali Acc: 0.580 Test Loss: 1.238 Test Acc: 0.580
Validation loss decreased (-0.559989 --> -0.579988).  Saving model ...
Epoch: 29 cost time: 1.5248332023620605
Epoch: 29, Steps: 4 | Train Loss: 0.016 Vali Loss: 1.192 Vali Acc: 0.560 Test Loss: 1.192 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.5272939205169678
Epoch: 30, Steps: 4 | Train Loss: 0.017 Vali Loss: 1.240 Vali Acc: 0.520 Test Loss: 1.240 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm32_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 689381
model size : 3.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm32_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.469994306564331
Epoch: 1, Steps: 4 | Train Loss: 1.706 Vali Loss: 1.597 Vali Acc: 0.180 Test Loss: 1.597 Test Acc: 0.180
Validation loss decreased (inf --> -0.179984).  Saving model ...
Epoch: 2 cost time: 1.6442928314208984
Epoch: 2, Steps: 4 | Train Loss: 1.695 Vali Loss: 1.572 Vali Acc: 0.140 Test Loss: 1.572 Test Acc: 0.140
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6142008304595947
Epoch: 3, Steps: 4 | Train Loss: 1.530 Vali Loss: 1.548 Vali Acc: 0.280 Test Loss: 1.548 Test Acc: 0.280
Validation loss decreased (-0.179984 --> -0.279985).  Saving model ...
Epoch: 4 cost time: 1.6037051677703857
Epoch: 4, Steps: 4 | Train Loss: 1.408 Vali Loss: 1.527 Vali Acc: 0.300 Test Loss: 1.527 Test Acc: 0.300
Validation loss decreased (-0.279985 --> -0.299985).  Saving model ...
Epoch: 5 cost time: 1.7202723026275635
Epoch: 5, Steps: 4 | Train Loss: 1.297 Vali Loss: 1.503 Vali Acc: 0.340 Test Loss: 1.503 Test Acc: 0.340
Validation loss decreased (-0.299985 --> -0.339985).  Saving model ...
Epoch: 6 cost time: 1.668926477432251
Epoch: 6, Steps: 4 | Train Loss: 1.109 Vali Loss: 1.463 Vali Acc: 0.420 Test Loss: 1.463 Test Acc: 0.420
Validation loss decreased (-0.339985 --> -0.419985).  Saving model ...
Epoch: 7 cost time: 1.6108670234680176
Epoch: 7, Steps: 4 | Train Loss: 1.006 Vali Loss: 1.386 Vali Acc: 0.420 Test Loss: 1.386 Test Acc: 0.420
Validation loss decreased (-0.419985 --> -0.419986).  Saving model ...
Epoch: 8 cost time: 1.660402774810791
Epoch: 8, Steps: 4 | Train Loss: 1.101 Vali Loss: 1.346 Vali Acc: 0.500 Test Loss: 1.346 Test Acc: 0.500
Validation loss decreased (-0.419986 --> -0.499987).  Saving model ...
Epoch: 9 cost time: 1.5772414207458496
Epoch: 9, Steps: 4 | Train Loss: 0.773 Vali Loss: 1.289 Vali Acc: 0.460 Test Loss: 1.289 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.650947093963623
Epoch: 10, Steps: 4 | Train Loss: 0.710 Vali Loss: 1.230 Vali Acc: 0.500 Test Loss: 1.230 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499988).  Saving model ...
Epoch: 11 cost time: 1.6187458038330078
Epoch: 11, Steps: 4 | Train Loss: 0.519 Vali Loss: 1.179 Vali Acc: 0.540 Test Loss: 1.179 Test Acc: 0.540
Validation loss decreased (-0.499988 --> -0.539988).  Saving model ...
Epoch: 12 cost time: 1.6888329982757568
Epoch: 12, Steps: 4 | Train Loss: 0.393 Vali Loss: 1.134 Vali Acc: 0.520 Test Loss: 1.134 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7331860065460205
Epoch: 13, Steps: 4 | Train Loss: 0.304 Vali Loss: 1.129 Vali Acc: 0.560 Test Loss: 1.129 Test Acc: 0.560
Validation loss decreased (-0.539988 --> -0.559989).  Saving model ...
Epoch: 14 cost time: 1.58333420753479
Epoch: 14, Steps: 4 | Train Loss: 0.262 Vali Loss: 1.103 Vali Acc: 0.580 Test Loss: 1.103 Test Acc: 0.580
Validation loss decreased (-0.559989 --> -0.579989).  Saving model ...
Epoch: 15 cost time: 1.6454460620880127
Epoch: 15, Steps: 4 | Train Loss: 0.209 Vali Loss: 1.092 Vali Acc: 0.580 Test Loss: 1.092 Test Acc: 0.580
Validation loss decreased (-0.579989 --> -0.579989).  Saving model ...
Epoch: 16 cost time: 1.5750792026519775
Epoch: 16, Steps: 4 | Train Loss: 0.196 Vali Loss: 1.148 Vali Acc: 0.560 Test Loss: 1.148 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.5790014266967773
Epoch: 17, Steps: 4 | Train Loss: 0.142 Vali Loss: 1.083 Vali Acc: 0.520 Test Loss: 1.083 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.587677001953125
Epoch: 18, Steps: 4 | Train Loss: 0.102 Vali Loss: 1.126 Vali Acc: 0.500 Test Loss: 1.126 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.5430030822753906
Epoch: 19, Steps: 4 | Train Loss: 0.093 Vali Loss: 1.209 Vali Acc: 0.560 Test Loss: 1.209 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.540478229522705
Epoch: 20, Steps: 4 | Train Loss: 0.075 Vali Loss: 1.232 Vali Acc: 0.560 Test Loss: 1.232 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.5738208293914795
Epoch: 21, Steps: 4 | Train Loss: 0.081 Vali Loss: 1.203 Vali Acc: 0.520 Test Loss: 1.203 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.5329241752624512
Epoch: 22, Steps: 4 | Train Loss: 0.044 Vali Loss: 1.241 Vali Acc: 0.480 Test Loss: 1.241 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.6185741424560547
Epoch: 23, Steps: 4 | Train Loss: 0.042 Vali Loss: 1.237 Vali Acc: 0.500 Test Loss: 1.237 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.4926769733428955
Epoch: 24, Steps: 4 | Train Loss: 0.070 Vali Loss: 1.165 Vali Acc: 0.460 Test Loss: 1.165 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.587385892868042
Epoch: 25, Steps: 4 | Train Loss: 0.030 Vali Loss: 1.214 Vali Acc: 0.540 Test Loss: 1.214 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm32_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 1930853
model size : 8.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm32_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.201289176940918
Epoch: 1, Steps: 4 | Train Loss: 1.593 Vali Loss: 1.601 Vali Acc: 0.220 Test Loss: 1.601 Test Acc: 0.220
Validation loss decreased (inf --> -0.219984).  Saving model ...
Epoch: 2 cost time: 1.3185617923736572
Epoch: 2, Steps: 4 | Train Loss: 1.721 Vali Loss: 1.584 Vali Acc: 0.260 Test Loss: 1.584 Test Acc: 0.260
Validation loss decreased (-0.219984 --> -0.259984).  Saving model ...
Epoch: 3 cost time: 1.294191837310791
Epoch: 3, Steps: 4 | Train Loss: 1.470 Vali Loss: 1.579 Vali Acc: 0.360 Test Loss: 1.579 Test Acc: 0.360
Validation loss decreased (-0.259984 --> -0.359984).  Saving model ...
Epoch: 4 cost time: 1.2779009342193604
Epoch: 4, Steps: 4 | Train Loss: 1.388 Vali Loss: 1.607 Vali Acc: 0.380 Test Loss: 1.607 Test Acc: 0.380
Validation loss decreased (-0.359984 --> -0.379984).  Saving model ...
Epoch: 5 cost time: 1.2829515933990479
Epoch: 5, Steps: 4 | Train Loss: 1.296 Vali Loss: 1.608 Vali Acc: 0.340 Test Loss: 1.608 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2907021045684814
Epoch: 6, Steps: 4 | Train Loss: 1.083 Vali Loss: 1.561 Vali Acc: 0.440 Test Loss: 1.561 Test Acc: 0.440
Validation loss decreased (-0.379984 --> -0.439984).  Saving model ...
Epoch: 7 cost time: 1.2415430545806885
Epoch: 7, Steps: 4 | Train Loss: 0.961 Vali Loss: 1.489 Vali Acc: 0.440 Test Loss: 1.489 Test Acc: 0.440
Validation loss decreased (-0.439984 --> -0.439985).  Saving model ...
Epoch: 8 cost time: 1.235931634902954
Epoch: 8, Steps: 4 | Train Loss: 0.816 Vali Loss: 1.400 Vali Acc: 0.440 Test Loss: 1.400 Test Acc: 0.440
Validation loss decreased (-0.439985 --> -0.439986).  Saving model ...
Epoch: 9 cost time: 1.2528586387634277
Epoch: 9, Steps: 4 | Train Loss: 0.730 Vali Loss: 1.338 Vali Acc: 0.440 Test Loss: 1.338 Test Acc: 0.440
Validation loss decreased (-0.439986 --> -0.439987).  Saving model ...
Epoch: 10 cost time: 1.314049482345581
Epoch: 10, Steps: 4 | Train Loss: 0.637 Vali Loss: 1.275 Vali Acc: 0.480 Test Loss: 1.275 Test Acc: 0.480
Validation loss decreased (-0.439987 --> -0.479987).  Saving model ...
Epoch: 11 cost time: 1.3527162075042725
Epoch: 11, Steps: 4 | Train Loss: 0.493 Vali Loss: 1.242 Vali Acc: 0.480 Test Loss: 1.242 Test Acc: 0.480
Validation loss decreased (-0.479987 --> -0.479988).  Saving model ...
Epoch: 12 cost time: 1.3019764423370361
Epoch: 12, Steps: 4 | Train Loss: 0.350 Vali Loss: 1.255 Vali Acc: 0.540 Test Loss: 1.255 Test Acc: 0.540
Validation loss decreased (-0.479988 --> -0.539987).  Saving model ...
Epoch: 13 cost time: 1.359245777130127
Epoch: 13, Steps: 4 | Train Loss: 0.318 Vali Loss: 1.264 Vali Acc: 0.540 Test Loss: 1.264 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.358870267868042
Epoch: 14, Steps: 4 | Train Loss: 0.284 Vali Loss: 1.249 Vali Acc: 0.500 Test Loss: 1.249 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.3103082180023193
Epoch: 15, Steps: 4 | Train Loss: 0.203 Vali Loss: 1.189 Vali Acc: 0.460 Test Loss: 1.189 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.381410837173462
Epoch: 16, Steps: 4 | Train Loss: 0.196 Vali Loss: 1.150 Vali Acc: 0.520 Test Loss: 1.150 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.3169581890106201
Epoch: 17, Steps: 4 | Train Loss: 0.174 Vali Loss: 1.202 Vali Acc: 0.520 Test Loss: 1.202 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.3391506671905518
Epoch: 18, Steps: 4 | Train Loss: 0.174 Vali Loss: 1.109 Vali Acc: 0.560 Test Loss: 1.109 Test Acc: 0.560
Validation loss decreased (-0.539987 --> -0.559989).  Saving model ...
Epoch: 19 cost time: 1.2759993076324463
Epoch: 19, Steps: 4 | Train Loss: 0.103 Vali Loss: 1.109 Vali Acc: 0.520 Test Loss: 1.109 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.2591207027435303
Epoch: 20, Steps: 4 | Train Loss: 0.101 Vali Loss: 1.143 Vali Acc: 0.500 Test Loss: 1.143 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.2882347106933594
Epoch: 21, Steps: 4 | Train Loss: 0.085 Vali Loss: 1.074 Vali Acc: 0.440 Test Loss: 1.074 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.3443512916564941
Epoch: 22, Steps: 4 | Train Loss: 0.063 Vali Loss: 1.129 Vali Acc: 0.560 Test Loss: 1.129 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.3405132293701172
Epoch: 23, Steps: 4 | Train Loss: 0.046 Vali Loss: 1.138 Vali Acc: 0.560 Test Loss: 1.138 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.389944076538086
Epoch: 24, Steps: 4 | Train Loss: 0.034 Vali Loss: 1.114 Vali Acc: 0.500 Test Loss: 1.114 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.2678422927856445
Epoch: 25, Steps: 4 | Train Loss: 0.027 Vali Loss: 1.165 Vali Acc: 0.560 Test Loss: 1.165 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.4103648662567139
Epoch: 26, Steps: 4 | Train Loss: 0.038 Vali Loss: 1.146 Vali Acc: 0.600 Test Loss: 1.146 Test Acc: 0.600
Validation loss decreased (-0.559989 --> -0.599989).  Saving model ...
Epoch: 27 cost time: 1.3349368572235107
Epoch: 27, Steps: 4 | Train Loss: 0.018 Vali Loss: 1.189 Vali Acc: 0.540 Test Loss: 1.189 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.3542075157165527
Epoch: 28, Steps: 4 | Train Loss: 0.026 Vali Loss: 1.200 Vali Acc: 0.500 Test Loss: 1.200 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.3770346641540527
Epoch: 29, Steps: 4 | Train Loss: 0.017 Vali Loss: 1.199 Vali Acc: 0.520 Test Loss: 1.199 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.2977311611175537
Epoch: 30, Steps: 4 | Train Loss: 0.019 Vali Loss: 1.296 Vali Acc: 0.560 Test Loss: 1.296 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm32_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 689381
model size : 3.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm16_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 5.27477502822876
Epoch: 1, Steps: 4 | Train Loss: 1.798 Vali Loss: 1.663 Vali Acc: 0.220 Test Loss: 1.663 Test Acc: 0.220
Validation loss decreased (inf --> -0.219983).  Saving model ...
Epoch: 2 cost time: 3.267862558364868
Epoch: 2, Steps: 4 | Train Loss: 1.640 Vali Loss: 1.625 Vali Acc: 0.220 Test Loss: 1.625 Test Acc: 0.220
Validation loss decreased (-0.219983 --> -0.219984).  Saving model ...
Epoch: 3 cost time: 3.387849807739258
Epoch: 3, Steps: 4 | Train Loss: 1.640 Vali Loss: 1.580 Vali Acc: 0.380 Test Loss: 1.580 Test Acc: 0.380
Validation loss decreased (-0.219984 --> -0.379984).  Saving model ...
Epoch: 4 cost time: 3.4353742599487305
Epoch: 4, Steps: 4 | Train Loss: 1.511 Vali Loss: 1.546 Vali Acc: 0.340 Test Loss: 1.546 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.235692024230957
Epoch: 5, Steps: 4 | Train Loss: 1.390 Vali Loss: 1.529 Vali Acc: 0.340 Test Loss: 1.529 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.2130959033966064
Epoch: 6, Steps: 4 | Train Loss: 1.288 Vali Loss: 1.516 Vali Acc: 0.340 Test Loss: 1.516 Test Acc: 0.340
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.417492151260376
Epoch: 7, Steps: 4 | Train Loss: 1.213 Vali Loss: 1.502 Vali Acc: 0.320 Test Loss: 1.502 Test Acc: 0.320
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.3878555297851562
Epoch: 8, Steps: 4 | Train Loss: 1.160 Vali Loss: 1.486 Vali Acc: 0.380 Test Loss: 1.486 Test Acc: 0.380
Validation loss decreased (-0.379984 --> -0.379985).  Saving model ...
Epoch: 9 cost time: 3.278198480606079
Epoch: 9, Steps: 4 | Train Loss: 1.000 Vali Loss: 1.471 Vali Acc: 0.420 Test Loss: 1.471 Test Acc: 0.420
Validation loss decreased (-0.379985 --> -0.419985).  Saving model ...
Epoch: 10 cost time: 3.1892049312591553
Epoch: 10, Steps: 4 | Train Loss: 0.928 Vali Loss: 1.439 Vali Acc: 0.440 Test Loss: 1.439 Test Acc: 0.440
Validation loss decreased (-0.419985 --> -0.439986).  Saving model ...
Epoch: 11 cost time: 3.072005271911621
Epoch: 11, Steps: 4 | Train Loss: 0.922 Vali Loss: 1.409 Vali Acc: 0.400 Test Loss: 1.409 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.229158401489258
Epoch: 12, Steps: 4 | Train Loss: 0.750 Vali Loss: 1.370 Vali Acc: 0.420 Test Loss: 1.370 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.4022293090820312
Epoch: 13, Steps: 4 | Train Loss: 0.575 Vali Loss: 1.367 Vali Acc: 0.420 Test Loss: 1.367 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.2996532917022705
Epoch: 14, Steps: 4 | Train Loss: 0.713 Vali Loss: 1.369 Vali Acc: 0.400 Test Loss: 1.369 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.3481178283691406
Epoch: 15, Steps: 4 | Train Loss: 0.402 Vali Loss: 1.301 Vali Acc: 0.420 Test Loss: 1.301 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.043241024017334
Epoch: 16, Steps: 4 | Train Loss: 0.370 Vali Loss: 1.291 Vali Acc: 0.440 Test Loss: 1.291 Test Acc: 0.440
Validation loss decreased (-0.439986 --> -0.439987).  Saving model ...
Epoch: 17 cost time: 3.0891053676605225
Epoch: 17, Steps: 4 | Train Loss: 0.395 Vali Loss: 1.336 Vali Acc: 0.460 Test Loss: 1.336 Test Acc: 0.460
Validation loss decreased (-0.439987 --> -0.459987).  Saving model ...
Epoch: 18 cost time: 3.396829843521118
Epoch: 18, Steps: 4 | Train Loss: 0.270 Vali Loss: 1.344 Vali Acc: 0.400 Test Loss: 1.344 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.3471014499664307
Epoch: 19, Steps: 4 | Train Loss: 0.231 Vali Loss: 1.375 Vali Acc: 0.420 Test Loss: 1.375 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.3466854095458984
Epoch: 20, Steps: 4 | Train Loss: 0.198 Vali Loss: 1.423 Vali Acc: 0.460 Test Loss: 1.423 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.2174010276794434
Epoch: 21, Steps: 4 | Train Loss: 0.162 Vali Loss: 1.459 Vali Acc: 0.360 Test Loss: 1.459 Test Acc: 0.360
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.3263285160064697
Epoch: 22, Steps: 4 | Train Loss: 0.259 Vali Loss: 1.372 Vali Acc: 0.340 Test Loss: 1.372 Test Acc: 0.340
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.3447518348693848
Epoch: 23, Steps: 4 | Train Loss: 0.127 Vali Loss: 1.426 Vali Acc: 0.340 Test Loss: 1.426 Test Acc: 0.340
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 3.3217756748199463
Epoch: 24, Steps: 4 | Train Loss: 0.194 Vali Loss: 1.457 Vali Acc: 0.320 Test Loss: 1.457 Test Acc: 0.320
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 3.22920298576355
Epoch: 25, Steps: 4 | Train Loss: 0.168 Vali Loss: 1.529 Vali Acc: 0.320 Test Loss: 1.529 Test Acc: 0.320
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 3.276449680328369
Epoch: 26, Steps: 4 | Train Loss: 0.089 Vali Loss: 1.600 Vali Acc: 0.300 Test Loss: 1.600 Test Acc: 0.300
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 3.304563522338867
Epoch: 27, Steps: 4 | Train Loss: 0.059 Vali Loss: 1.648 Vali Acc: 0.280 Test Loss: 1.648 Test Acc: 0.280
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm16_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.46
model parameter : 1844885
model size : 7.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm16_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.358121871948242
Epoch: 1, Steps: 4 | Train Loss: 1.649 Vali Loss: 1.618 Vali Acc: 0.180 Test Loss: 1.618 Test Acc: 0.180
Validation loss decreased (inf --> -0.179984).  Saving model ...
Epoch: 2 cost time: 1.9992599487304688
Epoch: 2, Steps: 4 | Train Loss: 1.608 Vali Loss: 1.599 Vali Acc: 0.220 Test Loss: 1.599 Test Acc: 0.220
Validation loss decreased (-0.179984 --> -0.219984).  Saving model ...
Epoch: 3 cost time: 2.2363157272338867
Epoch: 3, Steps: 4 | Train Loss: 1.508 Vali Loss: 1.569 Vali Acc: 0.320 Test Loss: 1.569 Test Acc: 0.320
Validation loss decreased (-0.219984 --> -0.319984).  Saving model ...
Epoch: 4 cost time: 2.1516880989074707
Epoch: 4, Steps: 4 | Train Loss: 1.486 Vali Loss: 1.544 Vali Acc: 0.320 Test Loss: 1.544 Test Acc: 0.320
Validation loss decreased (-0.319984 --> -0.319985).  Saving model ...
Epoch: 5 cost time: 2.137941360473633
Epoch: 5, Steps: 4 | Train Loss: 1.380 Vali Loss: 1.516 Vali Acc: 0.340 Test Loss: 1.516 Test Acc: 0.340
Validation loss decreased (-0.319985 --> -0.339985).  Saving model ...
Epoch: 6 cost time: 2.161376476287842
Epoch: 6, Steps: 4 | Train Loss: 1.187 Vali Loss: 1.485 Vali Acc: 0.320 Test Loss: 1.485 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.1198971271514893
Epoch: 7, Steps: 4 | Train Loss: 1.109 Vali Loss: 1.449 Vali Acc: 0.340 Test Loss: 1.449 Test Acc: 0.340
Validation loss decreased (-0.339985 --> -0.339986).  Saving model ...
Epoch: 8 cost time: 2.001232862472534
Epoch: 8, Steps: 4 | Train Loss: 1.087 Vali Loss: 1.411 Vali Acc: 0.400 Test Loss: 1.411 Test Acc: 0.400
Validation loss decreased (-0.339986 --> -0.399986).  Saving model ...
Epoch: 9 cost time: 2.074549913406372
Epoch: 9, Steps: 4 | Train Loss: 0.847 Vali Loss: 1.374 Vali Acc: 0.420 Test Loss: 1.374 Test Acc: 0.420
Validation loss decreased (-0.399986 --> -0.419986).  Saving model ...
Epoch: 10 cost time: 2.1344103813171387
Epoch: 10, Steps: 4 | Train Loss: 0.962 Vali Loss: 1.306 Vali Acc: 0.460 Test Loss: 1.306 Test Acc: 0.460
Validation loss decreased (-0.419986 --> -0.459987).  Saving model ...
Epoch: 11 cost time: 2.127263307571411
Epoch: 11, Steps: 4 | Train Loss: 0.877 Vali Loss: 1.246 Vali Acc: 0.420 Test Loss: 1.246 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.1283059120178223
Epoch: 12, Steps: 4 | Train Loss: 0.627 Vali Loss: 1.203 Vali Acc: 0.460 Test Loss: 1.203 Test Acc: 0.460
Validation loss decreased (-0.459987 --> -0.459988).  Saving model ...
Epoch: 13 cost time: 2.133284568786621
Epoch: 13, Steps: 4 | Train Loss: 0.556 Vali Loss: 1.205 Vali Acc: 0.420 Test Loss: 1.205 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.0425100326538086
Epoch: 14, Steps: 4 | Train Loss: 0.442 Vali Loss: 1.178 Vali Acc: 0.460 Test Loss: 1.178 Test Acc: 0.460
Validation loss decreased (-0.459988 --> -0.459988).  Saving model ...
Epoch: 15 cost time: 2.0994672775268555
Epoch: 15, Steps: 4 | Train Loss: 0.402 Vali Loss: 1.158 Vali Acc: 0.480 Test Loss: 1.158 Test Acc: 0.480
Validation loss decreased (-0.459988 --> -0.479988).  Saving model ...
Epoch: 16 cost time: 2.2399983406066895
Epoch: 16, Steps: 4 | Train Loss: 0.289 Vali Loss: 1.170 Vali Acc: 0.500 Test Loss: 1.170 Test Acc: 0.500
Validation loss decreased (-0.479988 --> -0.499988).  Saving model ...
Epoch: 17 cost time: 2.1623220443725586
Epoch: 17, Steps: 4 | Train Loss: 0.250 Vali Loss: 1.204 Vali Acc: 0.540 Test Loss: 1.204 Test Acc: 0.540
Validation loss decreased (-0.499988 --> -0.539988).  Saving model ...
Epoch: 18 cost time: 2.1526389122009277
Epoch: 18, Steps: 4 | Train Loss: 0.214 Vali Loss: 1.213 Vali Acc: 0.560 Test Loss: 1.213 Test Acc: 0.560
Validation loss decreased (-0.539988 --> -0.559988).  Saving model ...
Epoch: 19 cost time: 2.0941483974456787
Epoch: 19, Steps: 4 | Train Loss: 0.182 Vali Loss: 1.211 Vali Acc: 0.560 Test Loss: 1.211 Test Acc: 0.560
Validation loss decreased (-0.559988 --> -0.559988).  Saving model ...
Epoch: 20 cost time: 2.132024049758911
Epoch: 20, Steps: 4 | Train Loss: 0.181 Vali Loss: 1.206 Vali Acc: 0.540 Test Loss: 1.206 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.1343891620635986
Epoch: 21, Steps: 4 | Train Loss: 0.108 Vali Loss: 1.174 Vali Acc: 0.460 Test Loss: 1.174 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.1698765754699707
Epoch: 22, Steps: 4 | Train Loss: 0.142 Vali Loss: 1.185 Vali Acc: 0.520 Test Loss: 1.185 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.232452869415283
Epoch: 23, Steps: 4 | Train Loss: 0.080 Vali Loss: 1.316 Vali Acc: 0.560 Test Loss: 1.316 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.1927273273468018
Epoch: 24, Steps: 4 | Train Loss: 0.092 Vali Loss: 1.359 Vali Acc: 0.540 Test Loss: 1.359 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.1942453384399414
Epoch: 25, Steps: 4 | Train Loss: 0.076 Vali Loss: 1.373 Vali Acc: 0.500 Test Loss: 1.373 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.1341681480407715
Epoch: 26, Steps: 4 | Train Loss: 0.054 Vali Loss: 1.367 Vali Acc: 0.540 Test Loss: 1.367 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.1660165786743164
Epoch: 27, Steps: 4 | Train Loss: 0.061 Vali Loss: 1.397 Vali Acc: 0.500 Test Loss: 1.397 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.123945951461792
Epoch: 28, Steps: 4 | Train Loss: 0.039 Vali Loss: 1.404 Vali Acc: 0.520 Test Loss: 1.404 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.208106756210327
Epoch: 29, Steps: 4 | Train Loss: 0.042 Vali Loss: 1.549 Vali Acc: 0.480 Test Loss: 1.549 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm16_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 603317
model size : 2.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm16_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.601351976394653
Epoch: 1, Steps: 4 | Train Loss: 1.800 Vali Loss: 1.664 Vali Acc: 0.220 Test Loss: 1.664 Test Acc: 0.220
Validation loss decreased (inf --> -0.219983).  Saving model ...
Epoch: 2 cost time: 2.5830609798431396
Epoch: 2, Steps: 4 | Train Loss: 1.640 Vali Loss: 1.627 Vali Acc: 0.220 Test Loss: 1.627 Test Acc: 0.220
Validation loss decreased (-0.219983 --> -0.219984).  Saving model ...
Epoch: 3 cost time: 2.6726138591766357
Epoch: 3, Steps: 4 | Train Loss: 1.640 Vali Loss: 1.582 Vali Acc: 0.380 Test Loss: 1.582 Test Acc: 0.380
Validation loss decreased (-0.219984 --> -0.379984).  Saving model ...
Epoch: 4 cost time: 2.6894400119781494
Epoch: 4, Steps: 4 | Train Loss: 1.520 Vali Loss: 1.548 Vali Acc: 0.340 Test Loss: 1.548 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.625648021697998
Epoch: 5, Steps: 4 | Train Loss: 1.392 Vali Loss: 1.531 Vali Acc: 0.340 Test Loss: 1.531 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.6282501220703125
Epoch: 6, Steps: 4 | Train Loss: 1.296 Vali Loss: 1.516 Vali Acc: 0.340 Test Loss: 1.516 Test Acc: 0.340
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.539522886276245
Epoch: 7, Steps: 4 | Train Loss: 1.209 Vali Loss: 1.498 Vali Acc: 0.340 Test Loss: 1.498 Test Acc: 0.340
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.5865025520324707
Epoch: 8, Steps: 4 | Train Loss: 1.155 Vali Loss: 1.478 Vali Acc: 0.380 Test Loss: 1.478 Test Acc: 0.380
Validation loss decreased (-0.379984 --> -0.379985).  Saving model ...
Epoch: 9 cost time: 2.68776535987854
Epoch: 9, Steps: 4 | Train Loss: 0.996 Vali Loss: 1.461 Vali Acc: 0.440 Test Loss: 1.461 Test Acc: 0.440
Validation loss decreased (-0.379985 --> -0.439985).  Saving model ...
Epoch: 10 cost time: 2.6358847618103027
Epoch: 10, Steps: 4 | Train Loss: 0.923 Vali Loss: 1.426 Vali Acc: 0.440 Test Loss: 1.426 Test Acc: 0.440
Validation loss decreased (-0.439985 --> -0.439986).  Saving model ...
Epoch: 11 cost time: 2.6367318630218506
Epoch: 11, Steps: 4 | Train Loss: 0.923 Vali Loss: 1.397 Vali Acc: 0.440 Test Loss: 1.397 Test Acc: 0.440
Validation loss decreased (-0.439986 --> -0.439986).  Saving model ...
Epoch: 12 cost time: 2.6996970176696777
Epoch: 12, Steps: 4 | Train Loss: 0.742 Vali Loss: 1.356 Vali Acc: 0.440 Test Loss: 1.356 Test Acc: 0.440
Validation loss decreased (-0.439986 --> -0.439986).  Saving model ...
Epoch: 13 cost time: 2.6477127075195312
Epoch: 13, Steps: 4 | Train Loss: 0.552 Vali Loss: 1.348 Vali Acc: 0.440 Test Loss: 1.348 Test Acc: 0.440
Validation loss decreased (-0.439986 --> -0.439987).  Saving model ...
Epoch: 14 cost time: 2.6835708618164062
Epoch: 14, Steps: 4 | Train Loss: 0.708 Vali Loss: 1.334 Vali Acc: 0.400 Test Loss: 1.334 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.337212085723877
Epoch: 15, Steps: 4 | Train Loss: 0.407 Vali Loss: 1.276 Vali Acc: 0.440 Test Loss: 1.276 Test Acc: 0.440
Validation loss decreased (-0.439987 --> -0.439987).  Saving model ...
Epoch: 16 cost time: 2.3855838775634766
Epoch: 16, Steps: 4 | Train Loss: 0.381 Vali Loss: 1.282 Vali Acc: 0.420 Test Loss: 1.282 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.329728126525879
Epoch: 17, Steps: 4 | Train Loss: 0.404 Vali Loss: 1.370 Vali Acc: 0.460 Test Loss: 1.370 Test Acc: 0.460
Validation loss decreased (-0.439987 --> -0.459986).  Saving model ...
Epoch: 18 cost time: 2.6954121589660645
Epoch: 18, Steps: 4 | Train Loss: 0.316 Vali Loss: 1.345 Vali Acc: 0.420 Test Loss: 1.345 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.532932758331299
Epoch: 19, Steps: 4 | Train Loss: 0.250 Vali Loss: 1.415 Vali Acc: 0.400 Test Loss: 1.415 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.8254942893981934
Epoch: 20, Steps: 4 | Train Loss: 0.198 Vali Loss: 1.429 Vali Acc: 0.400 Test Loss: 1.429 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.6544852256774902
Epoch: 21, Steps: 4 | Train Loss: 0.169 Vali Loss: 1.448 Vali Acc: 0.380 Test Loss: 1.448 Test Acc: 0.380
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.553853750228882
Epoch: 22, Steps: 4 | Train Loss: 0.252 Vali Loss: 1.361 Vali Acc: 0.360 Test Loss: 1.361 Test Acc: 0.360
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.583298683166504
Epoch: 23, Steps: 4 | Train Loss: 0.123 Vali Loss: 1.338 Vali Acc: 0.420 Test Loss: 1.338 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.5616846084594727
Epoch: 24, Steps: 4 | Train Loss: 0.195 Vali Loss: 1.413 Vali Acc: 0.360 Test Loss: 1.413 Test Acc: 0.360
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.601624011993408
Epoch: 25, Steps: 4 | Train Loss: 0.168 Vali Loss: 1.479 Vali Acc: 0.320 Test Loss: 1.479 Test Acc: 0.320
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.4518048763275146
Epoch: 26, Steps: 4 | Train Loss: 0.091 Vali Loss: 1.577 Vali Acc: 0.320 Test Loss: 1.577 Test Acc: 0.320
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.6049697399139404
Epoch: 27, Steps: 4 | Train Loss: 0.061 Vali Loss: 1.661 Vali Acc: 0.300 Test Loss: 1.661 Test Acc: 0.300
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm16_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.46
model parameter : 1844885
model size : 7.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm16_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.4443676471710205
Epoch: 1, Steps: 4 | Train Loss: 1.648 Vali Loss: 1.618 Vali Acc: 0.180 Test Loss: 1.618 Test Acc: 0.180
Validation loss decreased (inf --> -0.179984).  Saving model ...
Epoch: 2 cost time: 1.7453558444976807
Epoch: 2, Steps: 4 | Train Loss: 1.606 Vali Loss: 1.599 Vali Acc: 0.220 Test Loss: 1.599 Test Acc: 0.220
Validation loss decreased (-0.179984 --> -0.219984).  Saving model ...
Epoch: 3 cost time: 1.6230123043060303
Epoch: 3, Steps: 4 | Train Loss: 1.507 Vali Loss: 1.570 Vali Acc: 0.320 Test Loss: 1.570 Test Acc: 0.320
Validation loss decreased (-0.219984 --> -0.319984).  Saving model ...
Epoch: 4 cost time: 1.7844576835632324
Epoch: 4, Steps: 4 | Train Loss: 1.482 Vali Loss: 1.545 Vali Acc: 0.320 Test Loss: 1.545 Test Acc: 0.320
Validation loss decreased (-0.319984 --> -0.319985).  Saving model ...
Epoch: 5 cost time: 1.9293498992919922
Epoch: 5, Steps: 4 | Train Loss: 1.377 Vali Loss: 1.517 Vali Acc: 0.300 Test Loss: 1.517 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.645263433456421
Epoch: 6, Steps: 4 | Train Loss: 1.187 Vali Loss: 1.485 Vali Acc: 0.340 Test Loss: 1.485 Test Acc: 0.340
Validation loss decreased (-0.319985 --> -0.339985).  Saving model ...
Epoch: 7 cost time: 1.8239398002624512
Epoch: 7, Steps: 4 | Train Loss: 1.117 Vali Loss: 1.448 Vali Acc: 0.340 Test Loss: 1.448 Test Acc: 0.340
Validation loss decreased (-0.339985 --> -0.339986).  Saving model ...
Epoch: 8 cost time: 1.7329809665679932
Epoch: 8, Steps: 4 | Train Loss: 1.097 Vali Loss: 1.411 Vali Acc: 0.400 Test Loss: 1.411 Test Acc: 0.400
Validation loss decreased (-0.339986 --> -0.399986).  Saving model ...
Epoch: 9 cost time: 1.618577003479004
Epoch: 9, Steps: 4 | Train Loss: 0.852 Vali Loss: 1.374 Vali Acc: 0.420 Test Loss: 1.374 Test Acc: 0.420
Validation loss decreased (-0.399986 --> -0.419986).  Saving model ...
Epoch: 10 cost time: 1.794452428817749
Epoch: 10, Steps: 4 | Train Loss: 0.966 Vali Loss: 1.306 Vali Acc: 0.480 Test Loss: 1.306 Test Acc: 0.480
Validation loss decreased (-0.419986 --> -0.479987).  Saving model ...
Epoch: 11 cost time: 1.7268424034118652
Epoch: 11, Steps: 4 | Train Loss: 0.876 Vali Loss: 1.243 Vali Acc: 0.420 Test Loss: 1.243 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.7068049907684326
Epoch: 12, Steps: 4 | Train Loss: 0.633 Vali Loss: 1.195 Vali Acc: 0.460 Test Loss: 1.195 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.8551666736602783
Epoch: 13, Steps: 4 | Train Loss: 0.557 Vali Loss: 1.192 Vali Acc: 0.420 Test Loss: 1.192 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.8822684288024902
Epoch: 14, Steps: 4 | Train Loss: 0.457 Vali Loss: 1.156 Vali Acc: 0.500 Test Loss: 1.156 Test Acc: 0.500
Validation loss decreased (-0.479987 --> -0.499988).  Saving model ...
Epoch: 15 cost time: 1.9146478176116943
Epoch: 15, Steps: 4 | Train Loss: 0.405 Vali Loss: 1.134 Vali Acc: 0.500 Test Loss: 1.134 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499989).  Saving model ...
Epoch: 16 cost time: 1.8808190822601318
Epoch: 16, Steps: 4 | Train Loss: 0.317 Vali Loss: 1.143 Vali Acc: 0.520 Test Loss: 1.143 Test Acc: 0.520
Validation loss decreased (-0.499989 --> -0.519989).  Saving model ...
Epoch: 17 cost time: 1.7398145198822021
Epoch: 17, Steps: 4 | Train Loss: 0.248 Vali Loss: 1.163 Vali Acc: 0.480 Test Loss: 1.163 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.8887240886688232
Epoch: 18, Steps: 4 | Train Loss: 0.215 Vali Loss: 1.150 Vali Acc: 0.560 Test Loss: 1.150 Test Acc: 0.560
Validation loss decreased (-0.519989 --> -0.559989).  Saving model ...
Epoch: 19 cost time: 1.8460960388183594
Epoch: 19, Steps: 4 | Train Loss: 0.199 Vali Loss: 1.147 Vali Acc: 0.520 Test Loss: 1.147 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.7835781574249268
Epoch: 20, Steps: 4 | Train Loss: 0.173 Vali Loss: 1.149 Vali Acc: 0.540 Test Loss: 1.149 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.7503597736358643
Epoch: 21, Steps: 4 | Train Loss: 0.117 Vali Loss: 1.135 Vali Acc: 0.440 Test Loss: 1.135 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.9016435146331787
Epoch: 22, Steps: 4 | Train Loss: 0.137 Vali Loss: 1.143 Vali Acc: 0.480 Test Loss: 1.143 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.7842016220092773
Epoch: 23, Steps: 4 | Train Loss: 0.081 Vali Loss: 1.253 Vali Acc: 0.540 Test Loss: 1.253 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.9371833801269531
Epoch: 24, Steps: 4 | Train Loss: 0.092 Vali Loss: 1.307 Vali Acc: 0.500 Test Loss: 1.307 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.835303544998169
Epoch: 25, Steps: 4 | Train Loss: 0.076 Vali Loss: 1.330 Vali Acc: 0.500 Test Loss: 1.330 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.925276756286621
Epoch: 26, Steps: 4 | Train Loss: 0.060 Vali Loss: 1.334 Vali Acc: 0.540 Test Loss: 1.334 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.7285850048065186
Epoch: 27, Steps: 4 | Train Loss: 0.073 Vali Loss: 1.272 Vali Acc: 0.480 Test Loss: 1.272 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.6990501880645752
Epoch: 28, Steps: 4 | Train Loss: 0.058 Vali Loss: 1.382 Vali Acc: 0.540 Test Loss: 1.382 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm16_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 603317
model size : 2.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm16_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.843939781188965
Epoch: 1, Steps: 4 | Train Loss: 1.797 Vali Loss: 1.661 Vali Acc: 0.220 Test Loss: 1.661 Test Acc: 0.220
Validation loss decreased (inf --> -0.219983).  Saving model ...
Epoch: 2 cost time: 1.7423906326293945
Epoch: 2, Steps: 4 | Train Loss: 1.640 Vali Loss: 1.624 Vali Acc: 0.220 Test Loss: 1.624 Test Acc: 0.220
Validation loss decreased (-0.219983 --> -0.219984).  Saving model ...
Epoch: 3 cost time: 1.7400031089782715
Epoch: 3, Steps: 4 | Train Loss: 1.641 Vali Loss: 1.580 Vali Acc: 0.380 Test Loss: 1.580 Test Acc: 0.380
Validation loss decreased (-0.219984 --> -0.379984).  Saving model ...
Epoch: 4 cost time: 1.9029662609100342
Epoch: 4, Steps: 4 | Train Loss: 1.514 Vali Loss: 1.547 Vali Acc: 0.380 Test Loss: 1.547 Test Acc: 0.380
Validation loss decreased (-0.379984 --> -0.379985).  Saving model ...
Epoch: 5 cost time: 1.756612777709961
Epoch: 5, Steps: 4 | Train Loss: 1.397 Vali Loss: 1.529 Vali Acc: 0.340 Test Loss: 1.529 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7548251152038574
Epoch: 6, Steps: 4 | Train Loss: 1.302 Vali Loss: 1.513 Vali Acc: 0.320 Test Loss: 1.513 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.8166429996490479
Epoch: 7, Steps: 4 | Train Loss: 1.220 Vali Loss: 1.495 Vali Acc: 0.320 Test Loss: 1.495 Test Acc: 0.320
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.7115299701690674
Epoch: 8, Steps: 4 | Train Loss: 1.170 Vali Loss: 1.473 Vali Acc: 0.380 Test Loss: 1.473 Test Acc: 0.380
Validation loss decreased (-0.379985 --> -0.379985).  Saving model ...
Epoch: 9 cost time: 1.818397045135498
Epoch: 9, Steps: 4 | Train Loss: 1.017 Vali Loss: 1.455 Vali Acc: 0.440 Test Loss: 1.455 Test Acc: 0.440
Validation loss decreased (-0.379985 --> -0.439985).  Saving model ...
Epoch: 10 cost time: 1.7527673244476318
Epoch: 10, Steps: 4 | Train Loss: 0.943 Vali Loss: 1.420 Vali Acc: 0.440 Test Loss: 1.420 Test Acc: 0.440
Validation loss decreased (-0.439985 --> -0.439986).  Saving model ...
Epoch: 11 cost time: 1.7148449420928955
Epoch: 11, Steps: 4 | Train Loss: 0.950 Vali Loss: 1.389 Vali Acc: 0.400 Test Loss: 1.389 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.7379064559936523
Epoch: 12, Steps: 4 | Train Loss: 0.795 Vali Loss: 1.344 Vali Acc: 0.400 Test Loss: 1.344 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.5454480648040771
Epoch: 13, Steps: 4 | Train Loss: 0.631 Vali Loss: 1.323 Vali Acc: 0.420 Test Loss: 1.323 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.5233101844787598
Epoch: 14, Steps: 4 | Train Loss: 0.756 Vali Loss: 1.307 Vali Acc: 0.460 Test Loss: 1.307 Test Acc: 0.460
Validation loss decreased (-0.439986 --> -0.459987).  Saving model ...
Epoch: 15 cost time: 1.4678971767425537
Epoch: 15, Steps: 4 | Train Loss: 0.473 Vali Loss: 1.246 Vali Acc: 0.440 Test Loss: 1.246 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.8336894512176514
Epoch: 16, Steps: 4 | Train Loss: 0.425 Vali Loss: 1.241 Vali Acc: 0.460 Test Loss: 1.241 Test Acc: 0.460
Validation loss decreased (-0.459987 --> -0.459988).  Saving model ...
Epoch: 17 cost time: 1.789808750152588
Epoch: 17, Steps: 4 | Train Loss: 0.427 Vali Loss: 1.233 Vali Acc: 0.480 Test Loss: 1.233 Test Acc: 0.480
Validation loss decreased (-0.459988 --> -0.479988).  Saving model ...
Epoch: 18 cost time: 1.9052455425262451
Epoch: 18, Steps: 4 | Train Loss: 0.338 Vali Loss: 1.247 Vali Acc: 0.460 Test Loss: 1.247 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.8434252738952637
Epoch: 19, Steps: 4 | Train Loss: 0.259 Vali Loss: 1.282 Vali Acc: 0.480 Test Loss: 1.282 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.853834867477417
Epoch: 20, Steps: 4 | Train Loss: 0.266 Vali Loss: 1.272 Vali Acc: 0.480 Test Loss: 1.272 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.837477207183838
Epoch: 21, Steps: 4 | Train Loss: 0.183 Vali Loss: 1.316 Vali Acc: 0.400 Test Loss: 1.316 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.8501999378204346
Epoch: 22, Steps: 4 | Train Loss: 0.298 Vali Loss: 1.208 Vali Acc: 0.420 Test Loss: 1.208 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.858309030532837
Epoch: 23, Steps: 4 | Train Loss: 0.153 Vali Loss: 1.262 Vali Acc: 0.460 Test Loss: 1.262 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.7801110744476318
Epoch: 24, Steps: 4 | Train Loss: 0.198 Vali Loss: 1.256 Vali Acc: 0.340 Test Loss: 1.256 Test Acc: 0.340
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.7576801776885986
Epoch: 25, Steps: 4 | Train Loss: 0.180 Vali Loss: 1.258 Vali Acc: 0.380 Test Loss: 1.258 Test Acc: 0.380
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.9965379238128662
Epoch: 26, Steps: 4 | Train Loss: 0.126 Vali Loss: 1.291 Vali Acc: 0.480 Test Loss: 1.291 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.7886879444122314
Epoch: 27, Steps: 4 | Train Loss: 0.094 Vali Loss: 1.366 Vali Acc: 0.380 Test Loss: 1.366 Test Acc: 0.380
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm16_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.48
model parameter : 1844885
model size : 7.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm16_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.234112501144409
Epoch: 1, Steps: 4 | Train Loss: 1.649 Vali Loss: 1.611 Vali Acc: 0.180 Test Loss: 1.611 Test Acc: 0.180
Validation loss decreased (inf --> -0.179984).  Saving model ...
Epoch: 2 cost time: 1.2103612422943115
Epoch: 2, Steps: 4 | Train Loss: 1.607 Vali Loss: 1.592 Vali Acc: 0.240 Test Loss: 1.592 Test Acc: 0.240
Validation loss decreased (-0.179984 --> -0.239984).  Saving model ...
Epoch: 3 cost time: 1.2359397411346436
Epoch: 3, Steps: 4 | Train Loss: 1.504 Vali Loss: 1.562 Vali Acc: 0.340 Test Loss: 1.562 Test Acc: 0.340
Validation loss decreased (-0.239984 --> -0.339984).  Saving model ...
Epoch: 4 cost time: 1.1921613216400146
Epoch: 4, Steps: 4 | Train Loss: 1.485 Vali Loss: 1.537 Vali Acc: 0.340 Test Loss: 1.537 Test Acc: 0.340
Validation loss decreased (-0.339984 --> -0.339985).  Saving model ...
Epoch: 5 cost time: 1.2584247589111328
Epoch: 5, Steps: 4 | Train Loss: 1.363 Vali Loss: 1.509 Vali Acc: 0.360 Test Loss: 1.509 Test Acc: 0.360
Validation loss decreased (-0.339985 --> -0.359985).  Saving model ...
Epoch: 6 cost time: 1.232433557510376
Epoch: 6, Steps: 4 | Train Loss: 1.184 Vali Loss: 1.477 Vali Acc: 0.340 Test Loss: 1.477 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2466201782226562
Epoch: 7, Steps: 4 | Train Loss: 1.124 Vali Loss: 1.439 Vali Acc: 0.360 Test Loss: 1.439 Test Acc: 0.360
Validation loss decreased (-0.359985 --> -0.359986).  Saving model ...
Epoch: 8 cost time: 1.2364904880523682
Epoch: 8, Steps: 4 | Train Loss: 1.111 Vali Loss: 1.400 Vali Acc: 0.420 Test Loss: 1.400 Test Acc: 0.420
Validation loss decreased (-0.359986 --> -0.419986).  Saving model ...
Epoch: 9 cost time: 1.2249343395233154
Epoch: 9, Steps: 4 | Train Loss: 0.867 Vali Loss: 1.362 Vali Acc: 0.420 Test Loss: 1.362 Test Acc: 0.420
Validation loss decreased (-0.419986 --> -0.419986).  Saving model ...
Epoch: 10 cost time: 1.314920425415039
Epoch: 10, Steps: 4 | Train Loss: 0.970 Vali Loss: 1.298 Vali Acc: 0.480 Test Loss: 1.298 Test Acc: 0.480
Validation loss decreased (-0.419986 --> -0.479987).  Saving model ...
Epoch: 11 cost time: 1.3344554901123047
Epoch: 11, Steps: 4 | Train Loss: 0.897 Vali Loss: 1.236 Vali Acc: 0.420 Test Loss: 1.236 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2969636917114258
Epoch: 12, Steps: 4 | Train Loss: 0.649 Vali Loss: 1.191 Vali Acc: 0.440 Test Loss: 1.191 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.2772269248962402
Epoch: 13, Steps: 4 | Train Loss: 0.577 Vali Loss: 1.183 Vali Acc: 0.420 Test Loss: 1.183 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.3293828964233398
Epoch: 14, Steps: 4 | Train Loss: 0.470 Vali Loss: 1.137 Vali Acc: 0.460 Test Loss: 1.137 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.2721970081329346
Epoch: 15, Steps: 4 | Train Loss: 0.418 Vali Loss: 1.117 Vali Acc: 0.480 Test Loss: 1.117 Test Acc: 0.480
Validation loss decreased (-0.479987 --> -0.479989).  Saving model ...
Epoch: 16 cost time: 1.220574140548706
Epoch: 16, Steps: 4 | Train Loss: 0.335 Vali Loss: 1.133 Vali Acc: 0.540 Test Loss: 1.133 Test Acc: 0.540
Validation loss decreased (-0.479989 --> -0.539989).  Saving model ...
Epoch: 17 cost time: 1.1364967823028564
Epoch: 17, Steps: 4 | Train Loss: 0.266 Vali Loss: 1.136 Vali Acc: 0.500 Test Loss: 1.136 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2542741298675537
Epoch: 18, Steps: 4 | Train Loss: 0.231 Vali Loss: 1.082 Vali Acc: 0.560 Test Loss: 1.082 Test Acc: 0.560
Validation loss decreased (-0.539989 --> -0.559989).  Saving model ...
Epoch: 19 cost time: 1.2890515327453613
Epoch: 19, Steps: 4 | Train Loss: 0.199 Vali Loss: 1.077 Vali Acc: 0.540 Test Loss: 1.077 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.3687324523925781
Epoch: 20, Steps: 4 | Train Loss: 0.183 Vali Loss: 1.065 Vali Acc: 0.560 Test Loss: 1.065 Test Acc: 0.560
Validation loss decreased (-0.559989 --> -0.559989).  Saving model ...
Epoch: 21 cost time: 1.2301969528198242
Epoch: 21, Steps: 4 | Train Loss: 0.133 Vali Loss: 1.032 Vali Acc: 0.480 Test Loss: 1.032 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2612082958221436
Epoch: 22, Steps: 4 | Train Loss: 0.151 Vali Loss: 1.084 Vali Acc: 0.480 Test Loss: 1.084 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.2735998630523682
Epoch: 23, Steps: 4 | Train Loss: 0.102 Vali Loss: 1.166 Vali Acc: 0.520 Test Loss: 1.166 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.273256778717041
Epoch: 24, Steps: 4 | Train Loss: 0.106 Vali Loss: 1.090 Vali Acc: 0.500 Test Loss: 1.090 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.3628928661346436
Epoch: 25, Steps: 4 | Train Loss: 0.086 Vali Loss: 1.080 Vali Acc: 0.500 Test Loss: 1.080 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.327941656112671
Epoch: 26, Steps: 4 | Train Loss: 0.068 Vali Loss: 1.118 Vali Acc: 0.540 Test Loss: 1.118 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.2408239841461182
Epoch: 27, Steps: 4 | Train Loss: 0.077 Vali Loss: 1.145 Vali Acc: 0.580 Test Loss: 1.145 Test Acc: 0.580
Validation loss decreased (-0.559989 --> -0.579989).  Saving model ...
Epoch: 28 cost time: 1.1587152481079102
Epoch: 28, Steps: 4 | Train Loss: 0.056 Vali Loss: 1.121 Vali Acc: 0.520 Test Loss: 1.121 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.2685775756835938
Epoch: 29, Steps: 4 | Train Loss: 0.049 Vali Loss: 1.175 Vali Acc: 0.540 Test Loss: 1.175 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.3366177082061768
Epoch: 30, Steps: 4 | Train Loss: 0.039 Vali Loss: 1.211 Vali Acc: 0.540 Test Loss: 1.211 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm16_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 603317
model size : 2.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm16_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.0450403690338135
Epoch: 1, Steps: 4 | Train Loss: 1.788 Vali Loss: 1.743 Vali Acc: 0.120 Test Loss: 1.743 Test Acc: 0.120
Validation loss decreased (inf --> -0.119983).  Saving model ...
Epoch: 2 cost time: 2.1627166271209717
Epoch: 2, Steps: 4 | Train Loss: 1.716 Vali Loss: 1.705 Vali Acc: 0.180 Test Loss: 1.705 Test Acc: 0.180
Validation loss decreased (-0.119983 --> -0.179983).  Saving model ...
Epoch: 3 cost time: 2.0201048851013184
Epoch: 3, Steps: 4 | Train Loss: 1.551 Vali Loss: 1.656 Vali Acc: 0.220 Test Loss: 1.656 Test Acc: 0.220
Validation loss decreased (-0.179983 --> -0.219983).  Saving model ...
Epoch: 4 cost time: 2.1484124660491943
Epoch: 4, Steps: 4 | Train Loss: 1.533 Vali Loss: 1.607 Vali Acc: 0.220 Test Loss: 1.607 Test Acc: 0.220
Validation loss decreased (-0.219983 --> -0.219984).  Saving model ...
Epoch: 5 cost time: 2.088453531265259
Epoch: 5, Steps: 4 | Train Loss: 1.446 Vali Loss: 1.563 Vali Acc: 0.260 Test Loss: 1.563 Test Acc: 0.260
Validation loss decreased (-0.219984 --> -0.259984).  Saving model ...
Epoch: 6 cost time: 2.070126533508301
Epoch: 6, Steps: 4 | Train Loss: 1.279 Vali Loss: 1.524 Vali Acc: 0.360 Test Loss: 1.524 Test Acc: 0.360
Validation loss decreased (-0.259984 --> -0.359985).  Saving model ...
Epoch: 7 cost time: 2.1095595359802246
Epoch: 7, Steps: 4 | Train Loss: 1.133 Vali Loss: 1.474 Vali Acc: 0.360 Test Loss: 1.474 Test Acc: 0.360
Validation loss decreased (-0.359985 --> -0.359985).  Saving model ...
Epoch: 8 cost time: 2.0598084926605225
Epoch: 8, Steps: 4 | Train Loss: 1.129 Vali Loss: 1.427 Vali Acc: 0.380 Test Loss: 1.427 Test Acc: 0.380
Validation loss decreased (-0.359985 --> -0.379986).  Saving model ...
Epoch: 9 cost time: 2.0379977226257324
Epoch: 9, Steps: 4 | Train Loss: 0.998 Vali Loss: 1.389 Vali Acc: 0.380 Test Loss: 1.389 Test Acc: 0.380
Validation loss decreased (-0.379986 --> -0.379986).  Saving model ...
Epoch: 10 cost time: 2.044710874557495
Epoch: 10, Steps: 4 | Train Loss: 0.959 Vali Loss: 1.345 Vali Acc: 0.380 Test Loss: 1.345 Test Acc: 0.380
Validation loss decreased (-0.379986 --> -0.379987).  Saving model ...
Epoch: 11 cost time: 2.1779909133911133
Epoch: 11, Steps: 4 | Train Loss: 0.939 Vali Loss: 1.290 Vali Acc: 0.420 Test Loss: 1.290 Test Acc: 0.420
Validation loss decreased (-0.379987 --> -0.419987).  Saving model ...
Epoch: 12 cost time: 2.0109364986419678
Epoch: 12, Steps: 4 | Train Loss: 0.669 Vali Loss: 1.245 Vali Acc: 0.480 Test Loss: 1.245 Test Acc: 0.480
Validation loss decreased (-0.419987 --> -0.479988).  Saving model ...
Epoch: 13 cost time: 2.0626745223999023
Epoch: 13, Steps: 4 | Train Loss: 0.566 Vali Loss: 1.212 Vali Acc: 0.460 Test Loss: 1.212 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.9923591613769531
Epoch: 14, Steps: 4 | Train Loss: 0.552 Vali Loss: 1.216 Vali Acc: 0.540 Test Loss: 1.216 Test Acc: 0.540
Validation loss decreased (-0.479988 --> -0.539988).  Saving model ...
Epoch: 15 cost time: 2.073578357696533
Epoch: 15, Steps: 4 | Train Loss: 0.517 Vali Loss: 1.201 Vali Acc: 0.500 Test Loss: 1.201 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.0186498165130615
Epoch: 16, Steps: 4 | Train Loss: 0.390 Vali Loss: 1.184 Vali Acc: 0.500 Test Loss: 1.184 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.0600624084472656
Epoch: 17, Steps: 4 | Train Loss: 0.350 Vali Loss: 1.167 Vali Acc: 0.520 Test Loss: 1.167 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.8836140632629395
Epoch: 18, Steps: 4 | Train Loss: 0.268 Vali Loss: 1.116 Vali Acc: 0.520 Test Loss: 1.116 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.8813683986663818
Epoch: 19, Steps: 4 | Train Loss: 0.320 Vali Loss: 1.117 Vali Acc: 0.500 Test Loss: 1.117 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.1224474906921387
Epoch: 20, Steps: 4 | Train Loss: 0.188 Vali Loss: 1.203 Vali Acc: 0.520 Test Loss: 1.203 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.1070499420166016
Epoch: 21, Steps: 4 | Train Loss: 0.219 Vali Loss: 1.191 Vali Acc: 0.460 Test Loss: 1.191 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.147320032119751
Epoch: 22, Steps: 4 | Train Loss: 0.202 Vali Loss: 1.107 Vali Acc: 0.540 Test Loss: 1.107 Test Acc: 0.540
Validation loss decreased (-0.539988 --> -0.539989).  Saving model ...
Epoch: 23 cost time: 2.1330478191375732
Epoch: 23, Steps: 4 | Train Loss: 0.135 Vali Loss: 1.110 Vali Acc: 0.480 Test Loss: 1.110 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.125286102294922
Epoch: 24, Steps: 4 | Train Loss: 0.166 Vali Loss: 1.117 Vali Acc: 0.540 Test Loss: 1.117 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.2260348796844482
Epoch: 25, Steps: 4 | Train Loss: 0.101 Vali Loss: 1.162 Vali Acc: 0.560 Test Loss: 1.162 Test Acc: 0.560
Validation loss decreased (-0.539989 --> -0.559988).  Saving model ...
Epoch: 26 cost time: 2.175590991973877
Epoch: 26, Steps: 4 | Train Loss: 0.084 Vali Loss: 1.152 Vali Acc: 0.540 Test Loss: 1.152 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.1455187797546387
Epoch: 27, Steps: 4 | Train Loss: 0.082 Vali Loss: 1.189 Vali Acc: 0.500 Test Loss: 1.189 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.0850613117218018
Epoch: 28, Steps: 4 | Train Loss: 0.072 Vali Loss: 1.255 Vali Acc: 0.520 Test Loss: 1.255 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.1455395221710205
Epoch: 29, Steps: 4 | Train Loss: 0.288 Vali Loss: 1.221 Vali Acc: 0.540 Test Loss: 1.221 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.1238396167755127
Epoch: 30, Steps: 4 | Train Loss: 0.075 Vali Loss: 1.302 Vali Acc: 0.500 Test Loss: 1.302 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm16_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 965717
model size : 4.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm16_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.5339319705963135
Epoch: 1, Steps: 4 | Train Loss: 1.615 Vali Loss: 1.592 Vali Acc: 0.180 Test Loss: 1.592 Test Acc: 0.180
Validation loss decreased (inf --> -0.179984).  Saving model ...
Epoch: 2 cost time: 1.457543134689331
Epoch: 2, Steps: 4 | Train Loss: 1.628 Vali Loss: 1.584 Vali Acc: 0.280 Test Loss: 1.584 Test Acc: 0.280
Validation loss decreased (-0.179984 --> -0.279984).  Saving model ...
Epoch: 3 cost time: 1.341064214706421
Epoch: 3, Steps: 4 | Train Loss: 1.591 Vali Loss: 1.575 Vali Acc: 0.280 Test Loss: 1.575 Test Acc: 0.280
Validation loss decreased (-0.279984 --> -0.279984).  Saving model ...
Epoch: 4 cost time: 1.6766517162322998
Epoch: 4, Steps: 4 | Train Loss: 1.543 Vali Loss: 1.564 Vali Acc: 0.300 Test Loss: 1.564 Test Acc: 0.300
Validation loss decreased (-0.279984 --> -0.299984).  Saving model ...
Epoch: 5 cost time: 1.4967210292816162
Epoch: 5, Steps: 4 | Train Loss: 1.272 Vali Loss: 1.565 Vali Acc: 0.300 Test Loss: 1.565 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.473161220550537
Epoch: 6, Steps: 4 | Train Loss: 1.332 Vali Loss: 1.559 Vali Acc: 0.340 Test Loss: 1.559 Test Acc: 0.340
Validation loss decreased (-0.299984 --> -0.339984).  Saving model ...
Epoch: 7 cost time: 1.496319055557251
Epoch: 7, Steps: 4 | Train Loss: 1.304 Vali Loss: 1.562 Vali Acc: 0.360 Test Loss: 1.562 Test Acc: 0.360
Validation loss decreased (-0.339984 --> -0.359984).  Saving model ...
Epoch: 8 cost time: 1.4907610416412354
Epoch: 8, Steps: 4 | Train Loss: 1.133 Vali Loss: 1.544 Vali Acc: 0.340 Test Loss: 1.544 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.429135799407959
Epoch: 9, Steps: 4 | Train Loss: 1.006 Vali Loss: 1.519 Vali Acc: 0.380 Test Loss: 1.519 Test Acc: 0.380
Validation loss decreased (-0.359984 --> -0.379985).  Saving model ...
Epoch: 10 cost time: 1.5730912685394287
Epoch: 10, Steps: 4 | Train Loss: 1.031 Vali Loss: 1.481 Vali Acc: 0.400 Test Loss: 1.481 Test Acc: 0.400
Validation loss decreased (-0.379985 --> -0.399985).  Saving model ...
Epoch: 11 cost time: 1.563361644744873
Epoch: 11, Steps: 4 | Train Loss: 0.898 Vali Loss: 1.414 Vali Acc: 0.400 Test Loss: 1.414 Test Acc: 0.400
Validation loss decreased (-0.399985 --> -0.399986).  Saving model ...
Epoch: 12 cost time: 1.5509586334228516
Epoch: 12, Steps: 4 | Train Loss: 0.841 Vali Loss: 1.368 Vali Acc: 0.500 Test Loss: 1.368 Test Acc: 0.500
Validation loss decreased (-0.399986 --> -0.499986).  Saving model ...
Epoch: 13 cost time: 1.4876930713653564
Epoch: 13, Steps: 4 | Train Loss: 0.715 Vali Loss: 1.351 Vali Acc: 0.540 Test Loss: 1.351 Test Acc: 0.540
Validation loss decreased (-0.499986 --> -0.539986).  Saving model ...
Epoch: 14 cost time: 1.4582011699676514
Epoch: 14, Steps: 4 | Train Loss: 0.573 Vali Loss: 1.279 Vali Acc: 0.580 Test Loss: 1.279 Test Acc: 0.580
Validation loss decreased (-0.539986 --> -0.579987).  Saving model ...
Epoch: 15 cost time: 1.4147307872772217
Epoch: 15, Steps: 4 | Train Loss: 0.498 Vali Loss: 1.190 Vali Acc: 0.580 Test Loss: 1.190 Test Acc: 0.580
Validation loss decreased (-0.579987 --> -0.579988).  Saving model ...
Epoch: 16 cost time: 1.5259952545166016
Epoch: 16, Steps: 4 | Train Loss: 0.698 Vali Loss: 1.165 Vali Acc: 0.520 Test Loss: 1.165 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.5910453796386719
Epoch: 17, Steps: 4 | Train Loss: 0.354 Vali Loss: 1.208 Vali Acc: 0.520 Test Loss: 1.208 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.6010282039642334
Epoch: 18, Steps: 4 | Train Loss: 0.312 Vali Loss: 1.170 Vali Acc: 0.520 Test Loss: 1.170 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.4513146877288818
Epoch: 19, Steps: 4 | Train Loss: 0.375 Vali Loss: 1.112 Vali Acc: 0.500 Test Loss: 1.112 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.455721378326416
Epoch: 20, Steps: 4 | Train Loss: 0.227 Vali Loss: 1.192 Vali Acc: 0.440 Test Loss: 1.192 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.4555821418762207
Epoch: 21, Steps: 4 | Train Loss: 0.240 Vali Loss: 1.207 Vali Acc: 0.520 Test Loss: 1.207 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.482663631439209
Epoch: 22, Steps: 4 | Train Loss: 0.169 Vali Loss: 1.180 Vali Acc: 0.540 Test Loss: 1.180 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.4786746501922607
Epoch: 23, Steps: 4 | Train Loss: 0.211 Vali Loss: 1.159 Vali Acc: 0.540 Test Loss: 1.159 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.5414087772369385
Epoch: 24, Steps: 4 | Train Loss: 0.128 Vali Loss: 1.205 Vali Acc: 0.580 Test Loss: 1.205 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.4504165649414062
Epoch: 25, Steps: 4 | Train Loss: 0.127 Vali Loss: 1.131 Vali Acc: 0.580 Test Loss: 1.131 Test Acc: 0.580
Validation loss decreased (-0.579988 --> -0.579989).  Saving model ...
Epoch: 26 cost time: 1.465003252029419
Epoch: 26, Steps: 4 | Train Loss: 0.097 Vali Loss: 1.113 Vali Acc: 0.620 Test Loss: 1.113 Test Acc: 0.620
Validation loss decreased (-0.579989 --> -0.619989).  Saving model ...
Epoch: 27 cost time: 1.402761697769165
Epoch: 27, Steps: 4 | Train Loss: 0.081 Vali Loss: 1.119 Vali Acc: 0.540 Test Loss: 1.119 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.6421701908111572
Epoch: 28, Steps: 4 | Train Loss: 0.104 Vali Loss: 1.152 Vali Acc: 0.560 Test Loss: 1.152 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.598684549331665
Epoch: 29, Steps: 4 | Train Loss: 0.066 Vali Loss: 1.268 Vali Acc: 0.480 Test Loss: 1.268 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.481764554977417
Epoch: 30, Steps: 4 | Train Loss: 0.063 Vali Loss: 1.231 Vali Acc: 0.560 Test Loss: 1.231 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm16_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.62
model parameter : 344885
model size : 1.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm16_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.8623178005218506
Epoch: 1, Steps: 4 | Train Loss: 1.788 Vali Loss: 1.743 Vali Acc: 0.120 Test Loss: 1.743 Test Acc: 0.120
Validation loss decreased (inf --> -0.119983).  Saving model ...
Epoch: 2 cost time: 1.955437183380127
Epoch: 2, Steps: 4 | Train Loss: 1.716 Vali Loss: 1.705 Vali Acc: 0.180 Test Loss: 1.705 Test Acc: 0.180
Validation loss decreased (-0.119983 --> -0.179983).  Saving model ...
Epoch: 3 cost time: 1.9741566181182861
Epoch: 3, Steps: 4 | Train Loss: 1.551 Vali Loss: 1.656 Vali Acc: 0.220 Test Loss: 1.656 Test Acc: 0.220
Validation loss decreased (-0.179983 --> -0.219983).  Saving model ...
Epoch: 4 cost time: 1.964669942855835
Epoch: 4, Steps: 4 | Train Loss: 1.533 Vali Loss: 1.607 Vali Acc: 0.240 Test Loss: 1.607 Test Acc: 0.240
Validation loss decreased (-0.219983 --> -0.239984).  Saving model ...
Epoch: 5 cost time: 2.1121017932891846
Epoch: 5, Steps: 4 | Train Loss: 1.447 Vali Loss: 1.564 Vali Acc: 0.260 Test Loss: 1.564 Test Acc: 0.260
Validation loss decreased (-0.239984 --> -0.259984).  Saving model ...
Epoch: 6 cost time: 1.8351860046386719
Epoch: 6, Steps: 4 | Train Loss: 1.278 Vali Loss: 1.526 Vali Acc: 0.360 Test Loss: 1.526 Test Acc: 0.360
Validation loss decreased (-0.259984 --> -0.359985).  Saving model ...
Epoch: 7 cost time: 1.8974266052246094
Epoch: 7, Steps: 4 | Train Loss: 1.131 Vali Loss: 1.476 Vali Acc: 0.360 Test Loss: 1.476 Test Acc: 0.360
Validation loss decreased (-0.359985 --> -0.359985).  Saving model ...
Epoch: 8 cost time: 1.9808974266052246
Epoch: 8, Steps: 4 | Train Loss: 1.129 Vali Loss: 1.429 Vali Acc: 0.380 Test Loss: 1.429 Test Acc: 0.380
Validation loss decreased (-0.359985 --> -0.379986).  Saving model ...
Epoch: 9 cost time: 1.8964617252349854
Epoch: 9, Steps: 4 | Train Loss: 0.994 Vali Loss: 1.392 Vali Acc: 0.380 Test Loss: 1.392 Test Acc: 0.380
Validation loss decreased (-0.379986 --> -0.379986).  Saving model ...
Epoch: 10 cost time: 1.8810536861419678
Epoch: 10, Steps: 4 | Train Loss: 0.977 Vali Loss: 1.349 Vali Acc: 0.400 Test Loss: 1.349 Test Acc: 0.400
Validation loss decreased (-0.379986 --> -0.399987).  Saving model ...
Epoch: 11 cost time: 1.8969454765319824
Epoch: 11, Steps: 4 | Train Loss: 0.923 Vali Loss: 1.294 Vali Acc: 0.400 Test Loss: 1.294 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 12 cost time: 1.8537611961364746
Epoch: 12, Steps: 4 | Train Loss: 0.676 Vali Loss: 1.245 Vali Acc: 0.480 Test Loss: 1.245 Test Acc: 0.480
Validation loss decreased (-0.399987 --> -0.479988).  Saving model ...
Epoch: 13 cost time: 1.7496130466461182
Epoch: 13, Steps: 4 | Train Loss: 0.570 Vali Loss: 1.214 Vali Acc: 0.460 Test Loss: 1.214 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.8280508518218994
Epoch: 14, Steps: 4 | Train Loss: 0.557 Vali Loss: 1.217 Vali Acc: 0.520 Test Loss: 1.217 Test Acc: 0.520
Validation loss decreased (-0.479988 --> -0.519988).  Saving model ...
Epoch: 15 cost time: 1.7622320652008057
Epoch: 15, Steps: 4 | Train Loss: 0.519 Vali Loss: 1.200 Vali Acc: 0.480 Test Loss: 1.200 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.743269920349121
Epoch: 16, Steps: 4 | Train Loss: 0.394 Vali Loss: 1.180 Vali Acc: 0.500 Test Loss: 1.180 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.6838116645812988
Epoch: 17, Steps: 4 | Train Loss: 0.358 Vali Loss: 1.164 Vali Acc: 0.520 Test Loss: 1.164 Test Acc: 0.520
Validation loss decreased (-0.519988 --> -0.519988).  Saving model ...
Epoch: 18 cost time: 1.9067432880401611
Epoch: 18, Steps: 4 | Train Loss: 0.273 Vali Loss: 1.111 Vali Acc: 0.520 Test Loss: 1.111 Test Acc: 0.520
Validation loss decreased (-0.519988 --> -0.519989).  Saving model ...
Epoch: 19 cost time: 1.8692071437835693
Epoch: 19, Steps: 4 | Train Loss: 0.325 Vali Loss: 1.104 Vali Acc: 0.500 Test Loss: 1.104 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.8913822174072266
Epoch: 20, Steps: 4 | Train Loss: 0.194 Vali Loss: 1.189 Vali Acc: 0.520 Test Loss: 1.189 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.8189365863800049
Epoch: 21, Steps: 4 | Train Loss: 0.222 Vali Loss: 1.189 Vali Acc: 0.460 Test Loss: 1.189 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.880842924118042
Epoch: 22, Steps: 4 | Train Loss: 0.206 Vali Loss: 1.099 Vali Acc: 0.540 Test Loss: 1.099 Test Acc: 0.540
Validation loss decreased (-0.519989 --> -0.539989).  Saving model ...
Epoch: 23 cost time: 1.806150197982788
Epoch: 23, Steps: 4 | Train Loss: 0.138 Vali Loss: 1.085 Vali Acc: 0.540 Test Loss: 1.085 Test Acc: 0.540
Validation loss decreased (-0.539989 --> -0.539989).  Saving model ...
Epoch: 24 cost time: 1.915661096572876
Epoch: 24, Steps: 4 | Train Loss: 0.171 Vali Loss: 1.079 Vali Acc: 0.520 Test Loss: 1.079 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.8081436157226562
Epoch: 25, Steps: 4 | Train Loss: 0.101 Vali Loss: 1.151 Vali Acc: 0.580 Test Loss: 1.151 Test Acc: 0.580
Validation loss decreased (-0.539989 --> -0.579988).  Saving model ...
Epoch: 26 cost time: 1.8122162818908691
Epoch: 26, Steps: 4 | Train Loss: 0.087 Vali Loss: 1.130 Vali Acc: 0.520 Test Loss: 1.130 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.950070858001709
Epoch: 27, Steps: 4 | Train Loss: 0.083 Vali Loss: 1.145 Vali Acc: 0.500 Test Loss: 1.145 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.269299030303955
Epoch: 28, Steps: 4 | Train Loss: 0.069 Vali Loss: 1.213 Vali Acc: 0.520 Test Loss: 1.213 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.942807674407959
Epoch: 29, Steps: 4 | Train Loss: 0.054 Vali Loss: 1.163 Vali Acc: 0.500 Test Loss: 1.163 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.9204473495483398
Epoch: 30, Steps: 4 | Train Loss: 0.068 Vali Loss: 1.186 Vali Acc: 0.520 Test Loss: 1.186 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm16_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 965717
model size : 4.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm16_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.5694172382354736
Epoch: 1, Steps: 4 | Train Loss: 1.611 Vali Loss: 1.592 Vali Acc: 0.180 Test Loss: 1.592 Test Acc: 0.180
Validation loss decreased (inf --> -0.179984).  Saving model ...
Epoch: 2 cost time: 1.4266221523284912
Epoch: 2, Steps: 4 | Train Loss: 1.629 Vali Loss: 1.584 Vali Acc: 0.280 Test Loss: 1.584 Test Acc: 0.280
Validation loss decreased (-0.179984 --> -0.279984).  Saving model ...
Epoch: 3 cost time: 1.3626205921173096
Epoch: 3, Steps: 4 | Train Loss: 1.593 Vali Loss: 1.575 Vali Acc: 0.280 Test Loss: 1.575 Test Acc: 0.280
Validation loss decreased (-0.279984 --> -0.279984).  Saving model ...
Epoch: 4 cost time: 1.431687593460083
Epoch: 4, Steps: 4 | Train Loss: 1.544 Vali Loss: 1.565 Vali Acc: 0.280 Test Loss: 1.565 Test Acc: 0.280
Validation loss decreased (-0.279984 --> -0.279984).  Saving model ...
Epoch: 5 cost time: 1.4506523609161377
Epoch: 5, Steps: 4 | Train Loss: 1.272 Vali Loss: 1.565 Vali Acc: 0.320 Test Loss: 1.565 Test Acc: 0.320
Validation loss decreased (-0.279984 --> -0.319984).  Saving model ...
Epoch: 6 cost time: 1.5289428234100342
Epoch: 6, Steps: 4 | Train Loss: 1.334 Vali Loss: 1.560 Vali Acc: 0.340 Test Loss: 1.560 Test Acc: 0.340
Validation loss decreased (-0.319984 --> -0.339984).  Saving model ...
Epoch: 7 cost time: 1.6172845363616943
Epoch: 7, Steps: 4 | Train Loss: 1.303 Vali Loss: 1.563 Vali Acc: 0.340 Test Loss: 1.563 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4097580909729004
Epoch: 8, Steps: 4 | Train Loss: 1.129 Vali Loss: 1.546 Vali Acc: 0.340 Test Loss: 1.546 Test Acc: 0.340
Validation loss decreased (-0.339984 --> -0.339985).  Saving model ...
Epoch: 9 cost time: 1.4645001888275146
Epoch: 9, Steps: 4 | Train Loss: 1.010 Vali Loss: 1.521 Vali Acc: 0.380 Test Loss: 1.521 Test Acc: 0.380
Validation loss decreased (-0.339985 --> -0.379985).  Saving model ...
Epoch: 10 cost time: 1.465296745300293
Epoch: 10, Steps: 4 | Train Loss: 1.041 Vali Loss: 1.485 Vali Acc: 0.420 Test Loss: 1.485 Test Acc: 0.420
Validation loss decreased (-0.379985 --> -0.419985).  Saving model ...
Epoch: 11 cost time: 1.705657720565796
Epoch: 11, Steps: 4 | Train Loss: 0.896 Vali Loss: 1.417 Vali Acc: 0.440 Test Loss: 1.417 Test Acc: 0.440
Validation loss decreased (-0.419985 --> -0.439986).  Saving model ...
Epoch: 12 cost time: 1.541504144668579
Epoch: 12, Steps: 4 | Train Loss: 0.840 Vali Loss: 1.370 Vali Acc: 0.520 Test Loss: 1.370 Test Acc: 0.520
Validation loss decreased (-0.439986 --> -0.519986).  Saving model ...
Epoch: 13 cost time: 1.4488508701324463
Epoch: 13, Steps: 4 | Train Loss: 0.717 Vali Loss: 1.348 Vali Acc: 0.540 Test Loss: 1.348 Test Acc: 0.540
Validation loss decreased (-0.519986 --> -0.539987).  Saving model ...
Epoch: 14 cost time: 1.563490629196167
Epoch: 14, Steps: 4 | Train Loss: 0.580 Vali Loss: 1.277 Vali Acc: 0.620 Test Loss: 1.277 Test Acc: 0.620
Validation loss decreased (-0.539987 --> -0.619987).  Saving model ...
Epoch: 15 cost time: 1.4098377227783203
Epoch: 15, Steps: 4 | Train Loss: 0.506 Vali Loss: 1.187 Vali Acc: 0.560 Test Loss: 1.187 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.5541510581970215
Epoch: 16, Steps: 4 | Train Loss: 0.698 Vali Loss: 1.151 Vali Acc: 0.540 Test Loss: 1.151 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.5489611625671387
Epoch: 17, Steps: 4 | Train Loss: 0.375 Vali Loss: 1.189 Vali Acc: 0.560 Test Loss: 1.189 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.4070518016815186
Epoch: 18, Steps: 4 | Train Loss: 0.322 Vali Loss: 1.138 Vali Acc: 0.540 Test Loss: 1.138 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.4174330234527588
Epoch: 19, Steps: 4 | Train Loss: 0.381 Vali Loss: 1.090 Vali Acc: 0.540 Test Loss: 1.090 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.4961044788360596
Epoch: 20, Steps: 4 | Train Loss: 0.238 Vali Loss: 1.155 Vali Acc: 0.500 Test Loss: 1.155 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.4158577919006348
Epoch: 21, Steps: 4 | Train Loss: 0.250 Vali Loss: 1.165 Vali Acc: 0.580 Test Loss: 1.165 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.4360034465789795
Epoch: 22, Steps: 4 | Train Loss: 0.171 Vali Loss: 1.131 Vali Acc: 0.560 Test Loss: 1.131 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.4541161060333252
Epoch: 23, Steps: 4 | Train Loss: 0.212 Vali Loss: 1.094 Vali Acc: 0.540 Test Loss: 1.094 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.536463737487793
Epoch: 24, Steps: 4 | Train Loss: 0.124 Vali Loss: 1.161 Vali Acc: 0.580 Test Loss: 1.161 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm16_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.62
model parameter : 344885
model size : 1.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm16_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.530255079269409
Epoch: 1, Steps: 4 | Train Loss: 1.788 Vali Loss: 1.745 Vali Acc: 0.120 Test Loss: 1.745 Test Acc: 0.120
Validation loss decreased (inf --> -0.119983).  Saving model ...
Epoch: 2 cost time: 1.6114914417266846
Epoch: 2, Steps: 4 | Train Loss: 1.702 Vali Loss: 1.707 Vali Acc: 0.180 Test Loss: 1.707 Test Acc: 0.180
Validation loss decreased (-0.119983 --> -0.179983).  Saving model ...
Epoch: 3 cost time: 1.6612234115600586
Epoch: 3, Steps: 4 | Train Loss: 1.552 Vali Loss: 1.658 Vali Acc: 0.220 Test Loss: 1.658 Test Acc: 0.220
Validation loss decreased (-0.179983 --> -0.219983).  Saving model ...
Epoch: 4 cost time: 1.5397937297821045
Epoch: 4, Steps: 4 | Train Loss: 1.552 Vali Loss: 1.609 Vali Acc: 0.220 Test Loss: 1.609 Test Acc: 0.220
Validation loss decreased (-0.219983 --> -0.219984).  Saving model ...
Epoch: 5 cost time: 1.5284461975097656
Epoch: 5, Steps: 4 | Train Loss: 1.448 Vali Loss: 1.564 Vali Acc: 0.240 Test Loss: 1.564 Test Acc: 0.240
Validation loss decreased (-0.219984 --> -0.239984).  Saving model ...
Epoch: 6 cost time: 1.5557878017425537
Epoch: 6, Steps: 4 | Train Loss: 1.281 Vali Loss: 1.525 Vali Acc: 0.340 Test Loss: 1.525 Test Acc: 0.340
Validation loss decreased (-0.239984 --> -0.339985).  Saving model ...
Epoch: 7 cost time: 1.470280647277832
Epoch: 7, Steps: 4 | Train Loss: 1.139 Vali Loss: 1.474 Vali Acc: 0.360 Test Loss: 1.474 Test Acc: 0.360
Validation loss decreased (-0.339985 --> -0.359985).  Saving model ...
Epoch: 8 cost time: 1.552011251449585
Epoch: 8, Steps: 4 | Train Loss: 1.140 Vali Loss: 1.427 Vali Acc: 0.380 Test Loss: 1.427 Test Acc: 0.380
Validation loss decreased (-0.359985 --> -0.379986).  Saving model ...
Epoch: 9 cost time: 1.5269343852996826
Epoch: 9, Steps: 4 | Train Loss: 1.008 Vali Loss: 1.389 Vali Acc: 0.400 Test Loss: 1.389 Test Acc: 0.400
Validation loss decreased (-0.379986 --> -0.399986).  Saving model ...
Epoch: 10 cost time: 1.4959843158721924
Epoch: 10, Steps: 4 | Train Loss: 0.981 Vali Loss: 1.346 Vali Acc: 0.380 Test Loss: 1.346 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6112680435180664
Epoch: 11, Steps: 4 | Train Loss: 0.940 Vali Loss: 1.293 Vali Acc: 0.400 Test Loss: 1.293 Test Acc: 0.400
Validation loss decreased (-0.399986 --> -0.399987).  Saving model ...
Epoch: 12 cost time: 1.4523608684539795
Epoch: 12, Steps: 4 | Train Loss: 0.684 Vali Loss: 1.245 Vali Acc: 0.480 Test Loss: 1.245 Test Acc: 0.480
Validation loss decreased (-0.399987 --> -0.479988).  Saving model ...
Epoch: 13 cost time: 1.508359432220459
Epoch: 13, Steps: 4 | Train Loss: 0.578 Vali Loss: 1.209 Vali Acc: 0.440 Test Loss: 1.209 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.352698802947998
Epoch: 14, Steps: 4 | Train Loss: 0.572 Vali Loss: 1.211 Vali Acc: 0.480 Test Loss: 1.211 Test Acc: 0.480
Validation loss decreased (-0.479988 --> -0.479988).  Saving model ...
Epoch: 15 cost time: 1.4442877769470215
Epoch: 15, Steps: 4 | Train Loss: 0.520 Vali Loss: 1.198 Vali Acc: 0.480 Test Loss: 1.198 Test Acc: 0.480
Validation loss decreased (-0.479988 --> -0.479988).  Saving model ...
Epoch: 16 cost time: 1.3726162910461426
Epoch: 16, Steps: 4 | Train Loss: 0.399 Vali Loss: 1.181 Vali Acc: 0.480 Test Loss: 1.181 Test Acc: 0.480
Validation loss decreased (-0.479988 --> -0.479988).  Saving model ...
Epoch: 17 cost time: 1.4437692165374756
Epoch: 17, Steps: 4 | Train Loss: 0.354 Vali Loss: 1.158 Vali Acc: 0.500 Test Loss: 1.158 Test Acc: 0.500
Validation loss decreased (-0.479988 --> -0.499988).  Saving model ...
Epoch: 18 cost time: 1.509425401687622
Epoch: 18, Steps: 4 | Train Loss: 0.282 Vali Loss: 1.111 Vali Acc: 0.500 Test Loss: 1.111 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499989).  Saving model ...
Epoch: 19 cost time: 1.492997407913208
Epoch: 19, Steps: 4 | Train Loss: 0.324 Vali Loss: 1.118 Vali Acc: 0.520 Test Loss: 1.118 Test Acc: 0.520
Validation loss decreased (-0.499989 --> -0.519989).  Saving model ...
Epoch: 20 cost time: 1.4490134716033936
Epoch: 20, Steps: 4 | Train Loss: 0.201 Vali Loss: 1.191 Vali Acc: 0.480 Test Loss: 1.191 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.489574670791626
Epoch: 21, Steps: 4 | Train Loss: 0.231 Vali Loss: 1.176 Vali Acc: 0.460 Test Loss: 1.176 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.5658762454986572
Epoch: 22, Steps: 4 | Train Loss: 0.221 Vali Loss: 1.084 Vali Acc: 0.480 Test Loss: 1.084 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.5253801345825195
Epoch: 23, Steps: 4 | Train Loss: 0.139 Vali Loss: 1.090 Vali Acc: 0.460 Test Loss: 1.090 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.5676329135894775
Epoch: 24, Steps: 4 | Train Loss: 0.166 Vali Loss: 1.100 Vali Acc: 0.480 Test Loss: 1.100 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.407407283782959
Epoch: 25, Steps: 4 | Train Loss: 0.113 Vali Loss: 1.150 Vali Acc: 0.520 Test Loss: 1.150 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.5563926696777344
Epoch: 26, Steps: 4 | Train Loss: 0.094 Vali Loss: 1.162 Vali Acc: 0.480 Test Loss: 1.162 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.480957269668579
Epoch: 27, Steps: 4 | Train Loss: 0.107 Vali Loss: 1.145 Vali Acc: 0.540 Test Loss: 1.145 Test Acc: 0.540
Validation loss decreased (-0.519989 --> -0.539989).  Saving model ...
Epoch: 28 cost time: 1.5081734657287598
Epoch: 28, Steps: 4 | Train Loss: 0.099 Vali Loss: 1.249 Vali Acc: 0.540 Test Loss: 1.249 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.3556349277496338
Epoch: 29, Steps: 4 | Train Loss: 0.085 Vali Loss: 1.213 Vali Acc: 0.460 Test Loss: 1.213 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.5791354179382324
Epoch: 30, Steps: 4 | Train Loss: 0.101 Vali Loss: 1.222 Vali Acc: 0.500 Test Loss: 1.222 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm16_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 965717
model size : 4.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm16_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.3156824111938477
Epoch: 1, Steps: 4 | Train Loss: 1.628 Vali Loss: 1.594 Vali Acc: 0.180 Test Loss: 1.594 Test Acc: 0.180
Validation loss decreased (inf --> -0.179984).  Saving model ...
Epoch: 2 cost time: 1.2223927974700928
Epoch: 2, Steps: 4 | Train Loss: 1.608 Vali Loss: 1.585 Vali Acc: 0.280 Test Loss: 1.585 Test Acc: 0.280
Validation loss decreased (-0.179984 --> -0.279984).  Saving model ...
Epoch: 3 cost time: 1.2015039920806885
Epoch: 3, Steps: 4 | Train Loss: 1.590 Vali Loss: 1.576 Vali Acc: 0.280 Test Loss: 1.576 Test Acc: 0.280
Validation loss decreased (-0.279984 --> -0.279984).  Saving model ...
Epoch: 4 cost time: 1.2557904720306396
Epoch: 4, Steps: 4 | Train Loss: 1.544 Vali Loss: 1.566 Vali Acc: 0.300 Test Loss: 1.566 Test Acc: 0.300
Validation loss decreased (-0.279984 --> -0.299984).  Saving model ...
Epoch: 5 cost time: 1.1460270881652832
Epoch: 5, Steps: 4 | Train Loss: 1.273 Vali Loss: 1.566 Vali Acc: 0.300 Test Loss: 1.566 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.267432451248169
Epoch: 6, Steps: 4 | Train Loss: 1.339 Vali Loss: 1.560 Vali Acc: 0.300 Test Loss: 1.560 Test Acc: 0.300
Validation loss decreased (-0.299984 --> -0.299984).  Saving model ...
Epoch: 7 cost time: 1.2387127876281738
Epoch: 7, Steps: 4 | Train Loss: 1.299 Vali Loss: 1.564 Vali Acc: 0.340 Test Loss: 1.564 Test Acc: 0.340
Validation loss decreased (-0.299984 --> -0.339984).  Saving model ...
Epoch: 8 cost time: 1.2658133506774902
Epoch: 8, Steps: 4 | Train Loss: 1.139 Vali Loss: 1.545 Vali Acc: 0.360 Test Loss: 1.545 Test Acc: 0.360
Validation loss decreased (-0.339984 --> -0.359985).  Saving model ...
Epoch: 9 cost time: 1.2966251373291016
Epoch: 9, Steps: 4 | Train Loss: 1.024 Vali Loss: 1.520 Vali Acc: 0.380 Test Loss: 1.520 Test Acc: 0.380
Validation loss decreased (-0.359985 --> -0.379985).  Saving model ...
Epoch: 10 cost time: 1.071972370147705
Epoch: 10, Steps: 4 | Train Loss: 1.044 Vali Loss: 1.483 Vali Acc: 0.380 Test Loss: 1.483 Test Acc: 0.380
Validation loss decreased (-0.379985 --> -0.379985).  Saving model ...
Epoch: 11 cost time: 1.2056818008422852
Epoch: 11, Steps: 4 | Train Loss: 0.898 Vali Loss: 1.416 Vali Acc: 0.400 Test Loss: 1.416 Test Acc: 0.400
Validation loss decreased (-0.379985 --> -0.399986).  Saving model ...
Epoch: 12 cost time: 1.2764194011688232
Epoch: 12, Steps: 4 | Train Loss: 0.844 Vali Loss: 1.372 Vali Acc: 0.500 Test Loss: 1.372 Test Acc: 0.500
Validation loss decreased (-0.399986 --> -0.499986).  Saving model ...
Epoch: 13 cost time: 1.1891417503356934
Epoch: 13, Steps: 4 | Train Loss: 0.722 Vali Loss: 1.351 Vali Acc: 0.520 Test Loss: 1.351 Test Acc: 0.520
Validation loss decreased (-0.499986 --> -0.519986).  Saving model ...
Epoch: 14 cost time: 1.1994819641113281
Epoch: 14, Steps: 4 | Train Loss: 0.571 Vali Loss: 1.279 Vali Acc: 0.560 Test Loss: 1.279 Test Acc: 0.560
Validation loss decreased (-0.519986 --> -0.559987).  Saving model ...
Epoch: 15 cost time: 1.2373545169830322
Epoch: 15, Steps: 4 | Train Loss: 0.537 Vali Loss: 1.184 Vali Acc: 0.560 Test Loss: 1.184 Test Acc: 0.560
Validation loss decreased (-0.559987 --> -0.559988).  Saving model ...
Epoch: 16 cost time: 1.213796615600586
Epoch: 16, Steps: 4 | Train Loss: 0.720 Vali Loss: 1.148 Vali Acc: 0.500 Test Loss: 1.148 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2611560821533203
Epoch: 17, Steps: 4 | Train Loss: 0.397 Vali Loss: 1.181 Vali Acc: 0.520 Test Loss: 1.181 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.2130773067474365
Epoch: 18, Steps: 4 | Train Loss: 0.328 Vali Loss: 1.151 Vali Acc: 0.540 Test Loss: 1.151 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.1175124645233154
Epoch: 19, Steps: 4 | Train Loss: 0.394 Vali Loss: 1.107 Vali Acc: 0.480 Test Loss: 1.107 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.2446694374084473
Epoch: 20, Steps: 4 | Train Loss: 0.230 Vali Loss: 1.150 Vali Acc: 0.480 Test Loss: 1.150 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.308675765991211
Epoch: 21, Steps: 4 | Train Loss: 0.256 Vali Loss: 1.164 Vali Acc: 0.540 Test Loss: 1.164 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.2121825218200684
Epoch: 22, Steps: 4 | Train Loss: 0.175 Vali Loss: 1.129 Vali Acc: 0.560 Test Loss: 1.129 Test Acc: 0.560
Validation loss decreased (-0.559988 --> -0.559989).  Saving model ...
Epoch: 23 cost time: 1.179408073425293
Epoch: 23, Steps: 4 | Train Loss: 0.227 Vali Loss: 1.088 Vali Acc: 0.560 Test Loss: 1.088 Test Acc: 0.560
Validation loss decreased (-0.559989 --> -0.559989).  Saving model ...
Epoch: 24 cost time: 1.400062084197998
Epoch: 24, Steps: 4 | Train Loss: 0.129 Vali Loss: 1.191 Vali Acc: 0.540 Test Loss: 1.191 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.2470228672027588
Epoch: 25, Steps: 4 | Train Loss: 0.139 Vali Loss: 1.124 Vali Acc: 0.560 Test Loss: 1.124 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.2766106128692627
Epoch: 26, Steps: 4 | Train Loss: 0.105 Vali Loss: 1.081 Vali Acc: 0.540 Test Loss: 1.081 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.055530071258545
Epoch: 27, Steps: 4 | Train Loss: 0.089 Vali Loss: 1.065 Vali Acc: 0.600 Test Loss: 1.065 Test Acc: 0.600
Validation loss decreased (-0.559989 --> -0.599989).  Saving model ...
Epoch: 28 cost time: 1.2201907634735107
Epoch: 28, Steps: 4 | Train Loss: 0.096 Vali Loss: 1.116 Vali Acc: 0.580 Test Loss: 1.116 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.2293555736541748
Epoch: 29, Steps: 4 | Train Loss: 0.062 Vali Loss: 1.249 Vali Acc: 0.540 Test Loss: 1.249 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.277329444885254
Epoch: 30, Steps: 4 | Train Loss: 0.062 Vali Loss: 1.173 Vali Acc: 0.640 Test Loss: 1.173 Test Acc: 0.640
Validation loss decreased (-0.599989 --> -0.639988).  Saving model ...
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm16_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.64
model parameter : 344885
model size : 1.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm16_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.317262172698975
Epoch: 1, Steps: 4 | Train Loss: 1.790 Vali Loss: 1.692 Vali Acc: 0.180 Test Loss: 1.692 Test Acc: 0.180
Validation loss decreased (inf --> -0.179983).  Saving model ...
Epoch: 2 cost time: 1.9893748760223389
Epoch: 2, Steps: 4 | Train Loss: 1.659 Vali Loss: 1.664 Vali Acc: 0.220 Test Loss: 1.664 Test Acc: 0.220
Validation loss decreased (-0.179983 --> -0.219983).  Saving model ...
Epoch: 3 cost time: 2.0116777420043945
Epoch: 3, Steps: 4 | Train Loss: 1.503 Vali Loss: 1.633 Vali Acc: 0.240 Test Loss: 1.633 Test Acc: 0.240
Validation loss decreased (-0.219983 --> -0.239984).  Saving model ...
Epoch: 4 cost time: 2.0290980339050293
Epoch: 4, Steps: 4 | Train Loss: 1.596 Vali Loss: 1.608 Vali Acc: 0.340 Test Loss: 1.608 Test Acc: 0.340
Validation loss decreased (-0.239984 --> -0.339984).  Saving model ...
Epoch: 5 cost time: 2.1113104820251465
Epoch: 5, Steps: 4 | Train Loss: 1.343 Vali Loss: 1.583 Vali Acc: 0.340 Test Loss: 1.583 Test Acc: 0.340
Validation loss decreased (-0.339984 --> -0.339984).  Saving model ...
Epoch: 6 cost time: 1.9222867488861084
Epoch: 6, Steps: 4 | Train Loss: 1.287 Vali Loss: 1.548 Vali Acc: 0.340 Test Loss: 1.548 Test Acc: 0.340
Validation loss decreased (-0.339984 --> -0.339985).  Saving model ...
Epoch: 7 cost time: 1.9616806507110596
Epoch: 7, Steps: 4 | Train Loss: 1.135 Vali Loss: 1.518 Vali Acc: 0.380 Test Loss: 1.518 Test Acc: 0.380
Validation loss decreased (-0.339985 --> -0.379985).  Saving model ...
Epoch: 8 cost time: 2.12621808052063
Epoch: 8, Steps: 4 | Train Loss: 1.050 Vali Loss: 1.491 Vali Acc: 0.380 Test Loss: 1.491 Test Acc: 0.380
Validation loss decreased (-0.379985 --> -0.379985).  Saving model ...
Epoch: 9 cost time: 2.152627944946289
Epoch: 9, Steps: 4 | Train Loss: 0.955 Vali Loss: 1.473 Vali Acc: 0.360 Test Loss: 1.473 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.225160837173462
Epoch: 10, Steps: 4 | Train Loss: 1.075 Vali Loss: 1.444 Vali Acc: 0.380 Test Loss: 1.444 Test Acc: 0.380
Validation loss decreased (-0.379985 --> -0.379986).  Saving model ...
Epoch: 11 cost time: 2.1183433532714844
Epoch: 11, Steps: 4 | Train Loss: 1.030 Vali Loss: 1.388 Vali Acc: 0.400 Test Loss: 1.388 Test Acc: 0.400
Validation loss decreased (-0.379986 --> -0.399986).  Saving model ...
Epoch: 12 cost time: 2.139451265335083
Epoch: 12, Steps: 4 | Train Loss: 0.706 Vali Loss: 1.339 Vali Acc: 0.460 Test Loss: 1.339 Test Acc: 0.460
Validation loss decreased (-0.399986 --> -0.459987).  Saving model ...
Epoch: 13 cost time: 2.056941270828247
Epoch: 13, Steps: 4 | Train Loss: 0.730 Vali Loss: 1.336 Vali Acc: 0.460 Test Loss: 1.336 Test Acc: 0.460
Validation loss decreased (-0.459987 --> -0.459987).  Saving model ...
Epoch: 14 cost time: 2.1173696517944336
Epoch: 14, Steps: 4 | Train Loss: 0.703 Vali Loss: 1.315 Vali Acc: 0.460 Test Loss: 1.315 Test Acc: 0.460
Validation loss decreased (-0.459987 --> -0.459987).  Saving model ...
Epoch: 15 cost time: 2.13216495513916
Epoch: 15, Steps: 4 | Train Loss: 0.516 Vali Loss: 1.262 Vali Acc: 0.440 Test Loss: 1.262 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.980316400527954
Epoch: 16, Steps: 4 | Train Loss: 0.425 Vali Loss: 1.228 Vali Acc: 0.460 Test Loss: 1.228 Test Acc: 0.460
Validation loss decreased (-0.459987 --> -0.459988).  Saving model ...
Epoch: 17 cost time: 2.229616403579712
Epoch: 17, Steps: 4 | Train Loss: 0.358 Vali Loss: 1.258 Vali Acc: 0.480 Test Loss: 1.258 Test Acc: 0.480
Validation loss decreased (-0.459988 --> -0.479987).  Saving model ...
Epoch: 18 cost time: 2.214505195617676
Epoch: 18, Steps: 4 | Train Loss: 0.426 Vali Loss: 1.229 Vali Acc: 0.480 Test Loss: 1.229 Test Acc: 0.480
Validation loss decreased (-0.479987 --> -0.479988).  Saving model ...
Epoch: 19 cost time: 2.0437417030334473
Epoch: 19, Steps: 4 | Train Loss: 0.281 Vali Loss: 1.140 Vali Acc: 0.540 Test Loss: 1.140 Test Acc: 0.540
Validation loss decreased (-0.479988 --> -0.539989).  Saving model ...
Epoch: 20 cost time: 1.90010666847229
Epoch: 20, Steps: 4 | Train Loss: 0.217 Vali Loss: 1.145 Vali Acc: 0.500 Test Loss: 1.145 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.8225862979888916
Epoch: 21, Steps: 4 | Train Loss: 0.170 Vali Loss: 1.164 Vali Acc: 0.520 Test Loss: 1.164 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.897648572921753
Epoch: 22, Steps: 4 | Train Loss: 0.159 Vali Loss: 1.202 Vali Acc: 0.500 Test Loss: 1.202 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.8982958793640137
Epoch: 23, Steps: 4 | Train Loss: 0.146 Vali Loss: 1.226 Vali Acc: 0.520 Test Loss: 1.226 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.04425048828125
Epoch: 24, Steps: 4 | Train Loss: 0.140 Vali Loss: 1.302 Vali Acc: 0.560 Test Loss: 1.302 Test Acc: 0.560
Validation loss decreased (-0.539989 --> -0.559987).  Saving model ...
Epoch: 25 cost time: 1.8957462310791016
Epoch: 25, Steps: 4 | Train Loss: 0.112 Vali Loss: 1.399 Vali Acc: 0.520 Test Loss: 1.399 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.1306848526000977
Epoch: 26, Steps: 4 | Train Loss: 0.089 Vali Loss: 1.359 Vali Acc: 0.500 Test Loss: 1.359 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.9570469856262207
Epoch: 27, Steps: 4 | Train Loss: 0.097 Vali Loss: 1.328 Vali Acc: 0.480 Test Loss: 1.328 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.065390110015869
Epoch: 28, Steps: 4 | Train Loss: 0.093 Vali Loss: 1.316 Vali Acc: 0.500 Test Loss: 1.316 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.0239033699035645
Epoch: 29, Steps: 4 | Train Loss: 0.101 Vali Loss: 1.372 Vali Acc: 0.520 Test Loss: 1.372 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.056314468383789
Epoch: 30, Steps: 4 | Train Loss: 0.055 Vali Loss: 1.390 Vali Acc: 0.500 Test Loss: 1.390 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm16_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 526133
model size : 2.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm16_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.2232468128204346
Epoch: 1, Steps: 4 | Train Loss: 1.773 Vali Loss: 1.692 Vali Acc: 0.220 Test Loss: 1.692 Test Acc: 0.220
Validation loss decreased (inf --> -0.219983).  Saving model ...
Epoch: 2 cost time: 1.2835452556610107
Epoch: 2, Steps: 4 | Train Loss: 1.645 Vali Loss: 1.673 Vali Acc: 0.260 Test Loss: 1.673 Test Acc: 0.260
Validation loss decreased (-0.219983 --> -0.259983).  Saving model ...
Epoch: 3 cost time: 1.3999748229980469
Epoch: 3, Steps: 4 | Train Loss: 1.631 Vali Loss: 1.644 Vali Acc: 0.260 Test Loss: 1.644 Test Acc: 0.260
Validation loss decreased (-0.259983 --> -0.259984).  Saving model ...
Epoch: 4 cost time: 1.2771811485290527
Epoch: 4, Steps: 4 | Train Loss: 1.466 Vali Loss: 1.616 Vali Acc: 0.280 Test Loss: 1.616 Test Acc: 0.280
Validation loss decreased (-0.259984 --> -0.279984).  Saving model ...
Epoch: 5 cost time: 1.4346263408660889
Epoch: 5, Steps: 4 | Train Loss: 1.403 Vali Loss: 1.591 Vali Acc: 0.260 Test Loss: 1.591 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3785064220428467
Epoch: 6, Steps: 4 | Train Loss: 1.243 Vali Loss: 1.560 Vali Acc: 0.380 Test Loss: 1.560 Test Acc: 0.380
Validation loss decreased (-0.279984 --> -0.379984).  Saving model ...
Epoch: 7 cost time: 1.3263850212097168
Epoch: 7, Steps: 4 | Train Loss: 1.296 Vali Loss: 1.530 Vali Acc: 0.360 Test Loss: 1.530 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.371279001235962
Epoch: 8, Steps: 4 | Train Loss: 1.059 Vali Loss: 1.489 Vali Acc: 0.380 Test Loss: 1.489 Test Acc: 0.380
Validation loss decreased (-0.379984 --> -0.379985).  Saving model ...
Epoch: 9 cost time: 1.3353443145751953
Epoch: 9, Steps: 4 | Train Loss: 0.959 Vali Loss: 1.449 Vali Acc: 0.440 Test Loss: 1.449 Test Acc: 0.440
Validation loss decreased (-0.379985 --> -0.439986).  Saving model ...
Epoch: 10 cost time: 1.4336802959442139
Epoch: 10, Steps: 4 | Train Loss: 0.901 Vali Loss: 1.416 Vali Acc: 0.420 Test Loss: 1.416 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2832345962524414
Epoch: 11, Steps: 4 | Train Loss: 0.735 Vali Loss: 1.363 Vali Acc: 0.480 Test Loss: 1.363 Test Acc: 0.480
Validation loss decreased (-0.439986 --> -0.479986).  Saving model ...
Epoch: 12 cost time: 1.3637185096740723
Epoch: 12, Steps: 4 | Train Loss: 0.678 Vali Loss: 1.287 Vali Acc: 0.480 Test Loss: 1.287 Test Acc: 0.480
Validation loss decreased (-0.479986 --> -0.479987).  Saving model ...
Epoch: 13 cost time: 1.3189020156860352
Epoch: 13, Steps: 4 | Train Loss: 0.584 Vali Loss: 1.252 Vali Acc: 0.480 Test Loss: 1.252 Test Acc: 0.480
Validation loss decreased (-0.479987 --> -0.479987).  Saving model ...
Epoch: 14 cost time: 1.2186462879180908
Epoch: 14, Steps: 4 | Train Loss: 0.520 Vali Loss: 1.228 Vali Acc: 0.460 Test Loss: 1.228 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.341008186340332
Epoch: 15, Steps: 4 | Train Loss: 0.491 Vali Loss: 1.221 Vali Acc: 0.480 Test Loss: 1.221 Test Acc: 0.480
Validation loss decreased (-0.479987 --> -0.479988).  Saving model ...
Epoch: 16 cost time: 1.364130973815918
Epoch: 16, Steps: 4 | Train Loss: 0.537 Vali Loss: 1.197 Vali Acc: 0.500 Test Loss: 1.197 Test Acc: 0.500
Validation loss decreased (-0.479988 --> -0.499988).  Saving model ...
Epoch: 17 cost time: 1.3901190757751465
Epoch: 17, Steps: 4 | Train Loss: 0.306 Vali Loss: 1.171 Vali Acc: 0.460 Test Loss: 1.171 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.3368210792541504
Epoch: 18, Steps: 4 | Train Loss: 0.233 Vali Loss: 1.206 Vali Acc: 0.500 Test Loss: 1.206 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.4621706008911133
Epoch: 19, Steps: 4 | Train Loss: 0.262 Vali Loss: 1.253 Vali Acc: 0.480 Test Loss: 1.253 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.3998994827270508
Epoch: 20, Steps: 4 | Train Loss: 0.204 Vali Loss: 1.296 Vali Acc: 0.520 Test Loss: 1.296 Test Acc: 0.520
Validation loss decreased (-0.499988 --> -0.519987).  Saving model ...
Epoch: 21 cost time: 1.3017983436584473
Epoch: 21, Steps: 4 | Train Loss: 0.160 Vali Loss: 1.208 Vali Acc: 0.580 Test Loss: 1.208 Test Acc: 0.580
Validation loss decreased (-0.519987 --> -0.579988).  Saving model ...
Epoch: 22 cost time: 1.3537499904632568
Epoch: 22, Steps: 4 | Train Loss: 0.156 Vali Loss: 1.190 Vali Acc: 0.560 Test Loss: 1.190 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.4021577835083008
Epoch: 23, Steps: 4 | Train Loss: 0.162 Vali Loss: 1.299 Vali Acc: 0.540 Test Loss: 1.299 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.443000316619873
Epoch: 24, Steps: 4 | Train Loss: 0.157 Vali Loss: 1.388 Vali Acc: 0.520 Test Loss: 1.388 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.3625459671020508
Epoch: 25, Steps: 4 | Train Loss: 0.107 Vali Loss: 1.332 Vali Acc: 0.520 Test Loss: 1.332 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.4590797424316406
Epoch: 26, Steps: 4 | Train Loss: 0.104 Vali Loss: 1.324 Vali Acc: 0.560 Test Loss: 1.324 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.4549574851989746
Epoch: 27, Steps: 4 | Train Loss: 0.079 Vali Loss: 1.313 Vali Acc: 0.540 Test Loss: 1.313 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.4347646236419678
Epoch: 28, Steps: 4 | Train Loss: 0.064 Vali Loss: 1.367 Vali Acc: 0.540 Test Loss: 1.367 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.4801180362701416
Epoch: 29, Steps: 4 | Train Loss: 0.074 Vali Loss: 1.342 Vali Acc: 0.600 Test Loss: 1.342 Test Acc: 0.600
Validation loss decreased (-0.579988 --> -0.599987).  Saving model ...
Epoch: 30 cost time: 1.2914690971374512
Epoch: 30, Steps: 4 | Train Loss: 0.057 Vali Loss: 1.321 Vali Acc: 0.560 Test Loss: 1.321 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm16_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 215669
model size : 1.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm16_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.5006723403930664
Epoch: 1, Steps: 4 | Train Loss: 1.790 Vali Loss: 1.693 Vali Acc: 0.160 Test Loss: 1.693 Test Acc: 0.160
Validation loss decreased (inf --> -0.159983).  Saving model ...
Epoch: 2 cost time: 1.6461331844329834
Epoch: 2, Steps: 4 | Train Loss: 1.658 Vali Loss: 1.665 Vali Acc: 0.200 Test Loss: 1.665 Test Acc: 0.200
Validation loss decreased (-0.159983 --> -0.199983).  Saving model ...
Epoch: 3 cost time: 1.7461771965026855
Epoch: 3, Steps: 4 | Train Loss: 1.504 Vali Loss: 1.634 Vali Acc: 0.220 Test Loss: 1.634 Test Acc: 0.220
Validation loss decreased (-0.199983 --> -0.219984).  Saving model ...
Epoch: 4 cost time: 1.4265789985656738
Epoch: 4, Steps: 4 | Train Loss: 1.597 Vali Loss: 1.608 Vali Acc: 0.320 Test Loss: 1.608 Test Acc: 0.320
Validation loss decreased (-0.219984 --> -0.319984).  Saving model ...
Epoch: 5 cost time: 1.5445349216461182
Epoch: 5, Steps: 4 | Train Loss: 1.343 Vali Loss: 1.582 Vali Acc: 0.320 Test Loss: 1.582 Test Acc: 0.320
Validation loss decreased (-0.319984 --> -0.319984).  Saving model ...
Epoch: 6 cost time: 1.5419301986694336
Epoch: 6, Steps: 4 | Train Loss: 1.287 Vali Loss: 1.547 Vali Acc: 0.320 Test Loss: 1.547 Test Acc: 0.320
Validation loss decreased (-0.319984 --> -0.319985).  Saving model ...
Epoch: 7 cost time: 1.6106679439544678
Epoch: 7, Steps: 4 | Train Loss: 1.135 Vali Loss: 1.518 Vali Acc: 0.360 Test Loss: 1.518 Test Acc: 0.360
Validation loss decreased (-0.319985 --> -0.359985).  Saving model ...
Epoch: 8 cost time: 1.8874499797821045
Epoch: 8, Steps: 4 | Train Loss: 1.050 Vali Loss: 1.491 Vali Acc: 0.380 Test Loss: 1.491 Test Acc: 0.380
Validation loss decreased (-0.359985 --> -0.379985).  Saving model ...
Epoch: 9 cost time: 1.70882248878479
Epoch: 9, Steps: 4 | Train Loss: 0.954 Vali Loss: 1.473 Vali Acc: 0.360 Test Loss: 1.473 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.879659652709961
Epoch: 10, Steps: 4 | Train Loss: 1.079 Vali Loss: 1.444 Vali Acc: 0.380 Test Loss: 1.444 Test Acc: 0.380
Validation loss decreased (-0.379985 --> -0.379986).  Saving model ...
Epoch: 11 cost time: 1.7773139476776123
Epoch: 11, Steps: 4 | Train Loss: 1.032 Vali Loss: 1.388 Vali Acc: 0.400 Test Loss: 1.388 Test Acc: 0.400
Validation loss decreased (-0.379986 --> -0.399986).  Saving model ...
Epoch: 12 cost time: 1.7227966785430908
Epoch: 12, Steps: 4 | Train Loss: 0.710 Vali Loss: 1.338 Vali Acc: 0.460 Test Loss: 1.338 Test Acc: 0.460
Validation loss decreased (-0.399986 --> -0.459987).  Saving model ...
Epoch: 13 cost time: 1.7107114791870117
Epoch: 13, Steps: 4 | Train Loss: 0.731 Vali Loss: 1.329 Vali Acc: 0.440 Test Loss: 1.329 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.7968051433563232
Epoch: 14, Steps: 4 | Train Loss: 0.701 Vali Loss: 1.306 Vali Acc: 0.440 Test Loss: 1.306 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.7425501346588135
Epoch: 15, Steps: 4 | Train Loss: 0.520 Vali Loss: 1.254 Vali Acc: 0.460 Test Loss: 1.254 Test Acc: 0.460
Validation loss decreased (-0.459987 --> -0.459987).  Saving model ...
Epoch: 16 cost time: 1.6661500930786133
Epoch: 16, Steps: 4 | Train Loss: 0.426 Vali Loss: 1.223 Vali Acc: 0.460 Test Loss: 1.223 Test Acc: 0.460
Validation loss decreased (-0.459987 --> -0.459988).  Saving model ...
Epoch: 17 cost time: 1.8072535991668701
Epoch: 17, Steps: 4 | Train Loss: 0.358 Vali Loss: 1.257 Vali Acc: 0.480 Test Loss: 1.257 Test Acc: 0.480
Validation loss decreased (-0.459988 --> -0.479987).  Saving model ...
Epoch: 18 cost time: 1.838308572769165
Epoch: 18, Steps: 4 | Train Loss: 0.430 Vali Loss: 1.228 Vali Acc: 0.480 Test Loss: 1.228 Test Acc: 0.480
Validation loss decreased (-0.479987 --> -0.479988).  Saving model ...
Epoch: 19 cost time: 1.8037748336791992
Epoch: 19, Steps: 4 | Train Loss: 0.285 Vali Loss: 1.137 Vali Acc: 0.520 Test Loss: 1.137 Test Acc: 0.520
Validation loss decreased (-0.479988 --> -0.519989).  Saving model ...
Epoch: 20 cost time: 1.8342037200927734
Epoch: 20, Steps: 4 | Train Loss: 0.219 Vali Loss: 1.137 Vali Acc: 0.540 Test Loss: 1.137 Test Acc: 0.540
Validation loss decreased (-0.519989 --> -0.539989).  Saving model ...
Epoch: 21 cost time: 1.6741602420806885
Epoch: 21, Steps: 4 | Train Loss: 0.168 Vali Loss: 1.149 Vali Acc: 0.520 Test Loss: 1.149 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.739624261856079
Epoch: 22, Steps: 4 | Train Loss: 0.163 Vali Loss: 1.185 Vali Acc: 0.520 Test Loss: 1.185 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.7053921222686768
Epoch: 23, Steps: 4 | Train Loss: 0.147 Vali Loss: 1.205 Vali Acc: 0.520 Test Loss: 1.205 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.7006068229675293
Epoch: 24, Steps: 4 | Train Loss: 0.144 Vali Loss: 1.263 Vali Acc: 0.560 Test Loss: 1.263 Test Acc: 0.560
Validation loss decreased (-0.539989 --> -0.559987).  Saving model ...
Epoch: 25 cost time: 1.7684566974639893
Epoch: 25, Steps: 4 | Train Loss: 0.109 Vali Loss: 1.347 Vali Acc: 0.520 Test Loss: 1.347 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.7283265590667725
Epoch: 26, Steps: 4 | Train Loss: 0.089 Vali Loss: 1.314 Vali Acc: 0.540 Test Loss: 1.314 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.8385591506958008
Epoch: 27, Steps: 4 | Train Loss: 0.100 Vali Loss: 1.288 Vali Acc: 0.520 Test Loss: 1.288 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.8269932270050049
Epoch: 28, Steps: 4 | Train Loss: 0.105 Vali Loss: 1.260 Vali Acc: 0.520 Test Loss: 1.260 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.7226154804229736
Epoch: 29, Steps: 4 | Train Loss: 0.106 Vali Loss: 1.297 Vali Acc: 0.560 Test Loss: 1.297 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.6506383419036865
Epoch: 30, Steps: 4 | Train Loss: 0.056 Vali Loss: 1.320 Vali Acc: 0.540 Test Loss: 1.320 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm16_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 526133
model size : 2.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm16_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.3519177436828613
Epoch: 1, Steps: 4 | Train Loss: 1.770 Vali Loss: 1.693 Vali Acc: 0.220 Test Loss: 1.693 Test Acc: 0.220
Validation loss decreased (inf --> -0.219983).  Saving model ...
Epoch: 2 cost time: 1.4632890224456787
Epoch: 2, Steps: 4 | Train Loss: 1.649 Vali Loss: 1.673 Vali Acc: 0.260 Test Loss: 1.673 Test Acc: 0.260
Validation loss decreased (-0.219983 --> -0.259983).  Saving model ...
Epoch: 3 cost time: 1.400146722793579
Epoch: 3, Steps: 4 | Train Loss: 1.628 Vali Loss: 1.644 Vali Acc: 0.260 Test Loss: 1.644 Test Acc: 0.260
Validation loss decreased (-0.259983 --> -0.259984).  Saving model ...
Epoch: 4 cost time: 1.382737636566162
Epoch: 4, Steps: 4 | Train Loss: 1.467 Vali Loss: 1.617 Vali Acc: 0.260 Test Loss: 1.617 Test Acc: 0.260
Validation loss decreased (-0.259984 --> -0.259984).  Saving model ...
Epoch: 5 cost time: 1.4341976642608643
Epoch: 5, Steps: 4 | Train Loss: 1.395 Vali Loss: 1.594 Vali Acc: 0.260 Test Loss: 1.594 Test Acc: 0.260
Validation loss decreased (-0.259984 --> -0.259984).  Saving model ...
Epoch: 6 cost time: 1.3934998512268066
Epoch: 6, Steps: 4 | Train Loss: 1.220 Vali Loss: 1.564 Vali Acc: 0.360 Test Loss: 1.564 Test Acc: 0.360
Validation loss decreased (-0.259984 --> -0.359984).  Saving model ...
Epoch: 7 cost time: 1.4674484729766846
Epoch: 7, Steps: 4 | Train Loss: 1.288 Vali Loss: 1.525 Vali Acc: 0.360 Test Loss: 1.525 Test Acc: 0.360
Validation loss decreased (-0.359984 --> -0.359985).  Saving model ...
Epoch: 8 cost time: 1.4923763275146484
Epoch: 8, Steps: 4 | Train Loss: 1.053 Vali Loss: 1.480 Vali Acc: 0.380 Test Loss: 1.480 Test Acc: 0.380
Validation loss decreased (-0.359985 --> -0.379985).  Saving model ...
Epoch: 9 cost time: 1.6020207405090332
Epoch: 9, Steps: 4 | Train Loss: 0.954 Vali Loss: 1.434 Vali Acc: 0.440 Test Loss: 1.434 Test Acc: 0.440
Validation loss decreased (-0.379985 --> -0.439986).  Saving model ...
Epoch: 10 cost time: 1.2251396179199219
Epoch: 10, Steps: 4 | Train Loss: 0.894 Vali Loss: 1.390 Vali Acc: 0.460 Test Loss: 1.390 Test Acc: 0.460
Validation loss decreased (-0.439986 --> -0.459986).  Saving model ...
Epoch: 11 cost time: 1.4229750633239746
Epoch: 11, Steps: 4 | Train Loss: 0.723 Vali Loss: 1.332 Vali Acc: 0.480 Test Loss: 1.332 Test Acc: 0.480
Validation loss decreased (-0.459986 --> -0.479987).  Saving model ...
Epoch: 12 cost time: 1.4614369869232178
Epoch: 12, Steps: 4 | Train Loss: 0.678 Vali Loss: 1.263 Vali Acc: 0.480 Test Loss: 1.263 Test Acc: 0.480
Validation loss decreased (-0.479987 --> -0.479987).  Saving model ...
Epoch: 13 cost time: 1.435680627822876
Epoch: 13, Steps: 4 | Train Loss: 0.581 Vali Loss: 1.230 Vali Acc: 0.480 Test Loss: 1.230 Test Acc: 0.480
Validation loss decreased (-0.479987 --> -0.479988).  Saving model ...
Epoch: 14 cost time: 1.5432367324829102
Epoch: 14, Steps: 4 | Train Loss: 0.522 Vali Loss: 1.204 Vali Acc: 0.460 Test Loss: 1.204 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3834857940673828
Epoch: 15, Steps: 4 | Train Loss: 0.489 Vali Loss: 1.190 Vali Acc: 0.480 Test Loss: 1.190 Test Acc: 0.480
Validation loss decreased (-0.479988 --> -0.479988).  Saving model ...
Epoch: 16 cost time: 1.4398322105407715
Epoch: 16, Steps: 4 | Train Loss: 0.531 Vali Loss: 1.159 Vali Acc: 0.500 Test Loss: 1.159 Test Acc: 0.500
Validation loss decreased (-0.479988 --> -0.499988).  Saving model ...
Epoch: 17 cost time: 1.413212537765503
Epoch: 17, Steps: 4 | Train Loss: 0.304 Vali Loss: 1.132 Vali Acc: 0.500 Test Loss: 1.132 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499989).  Saving model ...
Epoch: 18 cost time: 1.4518883228302002
Epoch: 18, Steps: 4 | Train Loss: 0.234 Vali Loss: 1.167 Vali Acc: 0.540 Test Loss: 1.167 Test Acc: 0.540
Validation loss decreased (-0.499989 --> -0.539988).  Saving model ...
Epoch: 19 cost time: 1.4418959617614746
Epoch: 19, Steps: 4 | Train Loss: 0.241 Vali Loss: 1.206 Vali Acc: 0.500 Test Loss: 1.206 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.474043607711792
Epoch: 20, Steps: 4 | Train Loss: 0.200 Vali Loss: 1.278 Vali Acc: 0.500 Test Loss: 1.278 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.4120662212371826
Epoch: 21, Steps: 4 | Train Loss: 0.161 Vali Loss: 1.192 Vali Acc: 0.560 Test Loss: 1.192 Test Acc: 0.560
Validation loss decreased (-0.539988 --> -0.559988).  Saving model ...
Epoch: 22 cost time: 1.4480347633361816
Epoch: 22, Steps: 4 | Train Loss: 0.151 Vali Loss: 1.153 Vali Acc: 0.580 Test Loss: 1.153 Test Acc: 0.580
Validation loss decreased (-0.559988 --> -0.579988).  Saving model ...
Epoch: 23 cost time: 1.4138102531433105
Epoch: 23, Steps: 4 | Train Loss: 0.171 Vali Loss: 1.201 Vali Acc: 0.560 Test Loss: 1.201 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.4203884601593018
Epoch: 24, Steps: 4 | Train Loss: 0.155 Vali Loss: 1.291 Vali Acc: 0.540 Test Loss: 1.291 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.386225700378418
Epoch: 25, Steps: 4 | Train Loss: 0.111 Vali Loss: 1.217 Vali Acc: 0.580 Test Loss: 1.217 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.4598681926727295
Epoch: 26, Steps: 4 | Train Loss: 0.101 Vali Loss: 1.192 Vali Acc: 0.580 Test Loss: 1.192 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.439077377319336
Epoch: 27, Steps: 4 | Train Loss: 0.082 Vali Loss: 1.199 Vali Acc: 0.580 Test Loss: 1.199 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.4300265312194824
Epoch: 28, Steps: 4 | Train Loss: 0.063 Vali Loss: 1.304 Vali Acc: 0.540 Test Loss: 1.304 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.4440982341766357
Epoch: 29, Steps: 4 | Train Loss: 0.086 Vali Loss: 1.261 Vali Acc: 0.600 Test Loss: 1.261 Test Acc: 0.600
Validation loss decreased (-0.579988 --> -0.599987).  Saving model ...
Epoch: 30 cost time: 1.4188101291656494
Epoch: 30, Steps: 4 | Train Loss: 0.059 Vali Loss: 1.220 Vali Acc: 0.600 Test Loss: 1.220 Test Acc: 0.600
Validation loss decreased (-0.599987 --> -0.599988).  Saving model ...
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm16_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 215669
model size : 1.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm16_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.310753345489502
Epoch: 1, Steps: 4 | Train Loss: 1.790 Vali Loss: 1.689 Vali Acc: 0.180 Test Loss: 1.689 Test Acc: 0.180
Validation loss decreased (inf --> -0.179983).  Saving model ...
Epoch: 2 cost time: 1.50162935256958
Epoch: 2, Steps: 4 | Train Loss: 1.664 Vali Loss: 1.661 Vali Acc: 0.220 Test Loss: 1.661 Test Acc: 0.220
Validation loss decreased (-0.179983 --> -0.219983).  Saving model ...
Epoch: 3 cost time: 1.5798115730285645
Epoch: 3, Steps: 4 | Train Loss: 1.505 Vali Loss: 1.630 Vali Acc: 0.240 Test Loss: 1.630 Test Acc: 0.240
Validation loss decreased (-0.219983 --> -0.239984).  Saving model ...
Epoch: 4 cost time: 1.3338735103607178
Epoch: 4, Steps: 4 | Train Loss: 1.591 Vali Loss: 1.605 Vali Acc: 0.320 Test Loss: 1.605 Test Acc: 0.320
Validation loss decreased (-0.239984 --> -0.319984).  Saving model ...
Epoch: 5 cost time: 1.5541818141937256
Epoch: 5, Steps: 4 | Train Loss: 1.346 Vali Loss: 1.580 Vali Acc: 0.340 Test Loss: 1.580 Test Acc: 0.340
Validation loss decreased (-0.319984 --> -0.339984).  Saving model ...
Epoch: 6 cost time: 1.4280898571014404
Epoch: 6, Steps: 4 | Train Loss: 1.293 Vali Loss: 1.546 Vali Acc: 0.340 Test Loss: 1.546 Test Acc: 0.340
Validation loss decreased (-0.339984 --> -0.339985).  Saving model ...
Epoch: 7 cost time: 1.581857681274414
Epoch: 7, Steps: 4 | Train Loss: 1.139 Vali Loss: 1.518 Vali Acc: 0.380 Test Loss: 1.518 Test Acc: 0.380
Validation loss decreased (-0.339985 --> -0.379985).  Saving model ...
Epoch: 8 cost time: 1.494164228439331
Epoch: 8, Steps: 4 | Train Loss: 1.056 Vali Loss: 1.492 Vali Acc: 0.380 Test Loss: 1.492 Test Acc: 0.380
Validation loss decreased (-0.379985 --> -0.379985).  Saving model ...
Epoch: 9 cost time: 1.571589708328247
Epoch: 9, Steps: 4 | Train Loss: 0.962 Vali Loss: 1.476 Vali Acc: 0.360 Test Loss: 1.476 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.669055461883545
Epoch: 10, Steps: 4 | Train Loss: 1.092 Vali Loss: 1.449 Vali Acc: 0.360 Test Loss: 1.449 Test Acc: 0.360
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.6044859886169434
Epoch: 11, Steps: 4 | Train Loss: 1.050 Vali Loss: 1.395 Vali Acc: 0.380 Test Loss: 1.395 Test Acc: 0.380
Validation loss decreased (-0.379985 --> -0.379986).  Saving model ...
Epoch: 12 cost time: 1.452883243560791
Epoch: 12, Steps: 4 | Train Loss: 0.722 Vali Loss: 1.343 Vali Acc: 0.440 Test Loss: 1.343 Test Acc: 0.440
Validation loss decreased (-0.379986 --> -0.439987).  Saving model ...
Epoch: 13 cost time: 1.48930025100708
Epoch: 13, Steps: 4 | Train Loss: 0.747 Vali Loss: 1.328 Vali Acc: 0.440 Test Loss: 1.328 Test Acc: 0.440
Validation loss decreased (-0.439987 --> -0.439987).  Saving model ...
Epoch: 14 cost time: 1.4451370239257812
Epoch: 14, Steps: 4 | Train Loss: 0.721 Vali Loss: 1.305 Vali Acc: 0.420 Test Loss: 1.305 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.6821084022521973
Epoch: 15, Steps: 4 | Train Loss: 0.536 Vali Loss: 1.252 Vali Acc: 0.480 Test Loss: 1.252 Test Acc: 0.480
Validation loss decreased (-0.439987 --> -0.479987).  Saving model ...
Epoch: 16 cost time: 1.5859334468841553
Epoch: 16, Steps: 4 | Train Loss: 0.448 Vali Loss: 1.218 Vali Acc: 0.460 Test Loss: 1.218 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.678299903869629
Epoch: 17, Steps: 4 | Train Loss: 0.377 Vali Loss: 1.249 Vali Acc: 0.500 Test Loss: 1.249 Test Acc: 0.500
Validation loss decreased (-0.479987 --> -0.499988).  Saving model ...
Epoch: 18 cost time: 1.5951623916625977
Epoch: 18, Steps: 4 | Train Loss: 0.450 Vali Loss: 1.235 Vali Acc: 0.480 Test Loss: 1.235 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.5229699611663818
Epoch: 19, Steps: 4 | Train Loss: 0.298 Vali Loss: 1.144 Vali Acc: 0.520 Test Loss: 1.144 Test Acc: 0.520
Validation loss decreased (-0.499988 --> -0.519989).  Saving model ...
Epoch: 20 cost time: 1.498929738998413
Epoch: 20, Steps: 4 | Train Loss: 0.237 Vali Loss: 1.128 Vali Acc: 0.520 Test Loss: 1.128 Test Acc: 0.520
Validation loss decreased (-0.519989 --> -0.519989).  Saving model ...
Epoch: 21 cost time: 1.5041871070861816
Epoch: 21, Steps: 4 | Train Loss: 0.183 Vali Loss: 1.133 Vali Acc: 0.540 Test Loss: 1.133 Test Acc: 0.540
Validation loss decreased (-0.519989 --> -0.539989).  Saving model ...
Epoch: 22 cost time: 1.6205832958221436
Epoch: 22, Steps: 4 | Train Loss: 0.181 Vali Loss: 1.171 Vali Acc: 0.520 Test Loss: 1.171 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.405179500579834
Epoch: 23, Steps: 4 | Train Loss: 0.164 Vali Loss: 1.141 Vali Acc: 0.520 Test Loss: 1.141 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.4207026958465576
Epoch: 24, Steps: 4 | Train Loss: 0.168 Vali Loss: 1.183 Vali Acc: 0.520 Test Loss: 1.183 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.4437336921691895
Epoch: 25, Steps: 4 | Train Loss: 0.117 Vali Loss: 1.279 Vali Acc: 0.560 Test Loss: 1.279 Test Acc: 0.560
Validation loss decreased (-0.539989 --> -0.559987).  Saving model ...
Epoch: 26 cost time: 1.5054724216461182
Epoch: 26, Steps: 4 | Train Loss: 0.104 Vali Loss: 1.246 Vali Acc: 0.540 Test Loss: 1.246 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.4465694427490234
Epoch: 27, Steps: 4 | Train Loss: 0.114 Vali Loss: 1.212 Vali Acc: 0.560 Test Loss: 1.212 Test Acc: 0.560
Validation loss decreased (-0.559987 --> -0.559988).  Saving model ...
Epoch: 28 cost time: 1.3988697528839111
Epoch: 28, Steps: 4 | Train Loss: 0.104 Vali Loss: 1.202 Vali Acc: 0.520 Test Loss: 1.202 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.428508996963501
Epoch: 29, Steps: 4 | Train Loss: 0.107 Vali Loss: 1.211 Vali Acc: 0.560 Test Loss: 1.211 Test Acc: 0.560
Validation loss decreased (-0.559988 --> -0.559988).  Saving model ...
Epoch: 30 cost time: 1.5186116695404053
Epoch: 30, Steps: 4 | Train Loss: 0.057 Vali Loss: 1.281 Vali Acc: 0.600 Test Loss: 1.281 Test Acc: 0.600
Validation loss decreased (-0.559988 --> -0.599987).  Saving model ...
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm16_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 526133
model size : 2.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm16_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.1463844776153564
Epoch: 1, Steps: 4 | Train Loss: 1.774 Vali Loss: 1.697 Vali Acc: 0.220 Test Loss: 1.697 Test Acc: 0.220
Validation loss decreased (inf --> -0.219983).  Saving model ...
Epoch: 2 cost time: 1.2471439838409424
Epoch: 2, Steps: 4 | Train Loss: 1.651 Vali Loss: 1.677 Vali Acc: 0.240 Test Loss: 1.677 Test Acc: 0.240
Validation loss decreased (-0.219983 --> -0.239983).  Saving model ...
Epoch: 3 cost time: 1.2783288955688477
Epoch: 3, Steps: 4 | Train Loss: 1.637 Vali Loss: 1.648 Vali Acc: 0.260 Test Loss: 1.648 Test Acc: 0.260
Validation loss decreased (-0.239983 --> -0.259984).  Saving model ...
Epoch: 4 cost time: 1.284853219985962
Epoch: 4, Steps: 4 | Train Loss: 1.478 Vali Loss: 1.620 Vali Acc: 0.260 Test Loss: 1.620 Test Acc: 0.260
Validation loss decreased (-0.259984 --> -0.259984).  Saving model ...
Epoch: 5 cost time: 1.1733436584472656
Epoch: 5, Steps: 4 | Train Loss: 1.433 Vali Loss: 1.594 Vali Acc: 0.260 Test Loss: 1.594 Test Acc: 0.260
Validation loss decreased (-0.259984 --> -0.259984).  Saving model ...
Epoch: 6 cost time: 1.1701598167419434
Epoch: 6, Steps: 4 | Train Loss: 1.263 Vali Loss: 1.561 Vali Acc: 0.380 Test Loss: 1.561 Test Acc: 0.380
Validation loss decreased (-0.259984 --> -0.379984).  Saving model ...
Epoch: 7 cost time: 1.2231051921844482
Epoch: 7, Steps: 4 | Train Loss: 1.302 Vali Loss: 1.521 Vali Acc: 0.360 Test Loss: 1.521 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2557621002197266
Epoch: 8, Steps: 4 | Train Loss: 1.069 Vali Loss: 1.474 Vali Acc: 0.400 Test Loss: 1.474 Test Acc: 0.400
Validation loss decreased (-0.379984 --> -0.399985).  Saving model ...
Epoch: 9 cost time: 1.292799472808838
Epoch: 9, Steps: 4 | Train Loss: 0.965 Vali Loss: 1.426 Vali Acc: 0.400 Test Loss: 1.426 Test Acc: 0.400
Validation loss decreased (-0.399985 --> -0.399986).  Saving model ...
Epoch: 10 cost time: 1.2238061428070068
Epoch: 10, Steps: 4 | Train Loss: 0.911 Vali Loss: 1.381 Vali Acc: 0.460 Test Loss: 1.381 Test Acc: 0.460
Validation loss decreased (-0.399986 --> -0.459986).  Saving model ...
Epoch: 11 cost time: 1.2158644199371338
Epoch: 11, Steps: 4 | Train Loss: 0.724 Vali Loss: 1.327 Vali Acc: 0.460 Test Loss: 1.327 Test Acc: 0.460
Validation loss decreased (-0.459986 --> -0.459987).  Saving model ...
Epoch: 12 cost time: 1.3225617408752441
Epoch: 12, Steps: 4 | Train Loss: 0.693 Vali Loss: 1.260 Vali Acc: 0.460 Test Loss: 1.260 Test Acc: 0.460
Validation loss decreased (-0.459987 --> -0.459987).  Saving model ...
Epoch: 13 cost time: 1.161803960800171
Epoch: 13, Steps: 4 | Train Loss: 0.590 Vali Loss: 1.228 Vali Acc: 0.460 Test Loss: 1.228 Test Acc: 0.460
Validation loss decreased (-0.459987 --> -0.459988).  Saving model ...
Epoch: 14 cost time: 1.3496067523956299
Epoch: 14, Steps: 4 | Train Loss: 0.547 Vali Loss: 1.199 Vali Acc: 0.480 Test Loss: 1.199 Test Acc: 0.480
Validation loss decreased (-0.459988 --> -0.479988).  Saving model ...
Epoch: 15 cost time: 1.1875982284545898
Epoch: 15, Steps: 4 | Train Loss: 0.489 Vali Loss: 1.186 Vali Acc: 0.500 Test Loss: 1.186 Test Acc: 0.500
Validation loss decreased (-0.479988 --> -0.499988).  Saving model ...
Epoch: 16 cost time: 1.2341036796569824
Epoch: 16, Steps: 4 | Train Loss: 0.538 Vali Loss: 1.164 Vali Acc: 0.520 Test Loss: 1.164 Test Acc: 0.520
Validation loss decreased (-0.499988 --> -0.519988).  Saving model ...
Epoch: 17 cost time: 1.1968090534210205
Epoch: 17, Steps: 4 | Train Loss: 0.329 Vali Loss: 1.140 Vali Acc: 0.520 Test Loss: 1.140 Test Acc: 0.520
Validation loss decreased (-0.519988 --> -0.519989).  Saving model ...
Epoch: 18 cost time: 1.2776827812194824
Epoch: 18, Steps: 4 | Train Loss: 0.247 Vali Loss: 1.165 Vali Acc: 0.480 Test Loss: 1.165 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1664519309997559
Epoch: 19, Steps: 4 | Train Loss: 0.274 Vali Loss: 1.202 Vali Acc: 0.520 Test Loss: 1.202 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.1918950080871582
Epoch: 20, Steps: 4 | Train Loss: 0.213 Vali Loss: 1.245 Vali Acc: 0.560 Test Loss: 1.245 Test Acc: 0.560
Validation loss decreased (-0.519989 --> -0.559988).  Saving model ...
Epoch: 21 cost time: 1.1523113250732422
Epoch: 21, Steps: 4 | Train Loss: 0.171 Vali Loss: 1.150 Vali Acc: 0.600 Test Loss: 1.150 Test Acc: 0.600
Validation loss decreased (-0.559988 --> -0.599988).  Saving model ...
Epoch: 22 cost time: 1.1864256858825684
Epoch: 22, Steps: 4 | Train Loss: 0.156 Vali Loss: 1.110 Vali Acc: 0.600 Test Loss: 1.110 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599989).  Saving model ...
Epoch: 23 cost time: 1.2658178806304932
Epoch: 23, Steps: 4 | Train Loss: 0.162 Vali Loss: 1.189 Vali Acc: 0.600 Test Loss: 1.189 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.1505982875823975
Epoch: 24, Steps: 4 | Train Loss: 0.168 Vali Loss: 1.283 Vali Acc: 0.540 Test Loss: 1.283 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.2119369506835938
Epoch: 25, Steps: 4 | Train Loss: 0.119 Vali Loss: 1.199 Vali Acc: 0.580 Test Loss: 1.199 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.1791644096374512
Epoch: 26, Steps: 4 | Train Loss: 0.109 Vali Loss: 1.188 Vali Acc: 0.580 Test Loss: 1.188 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.2748310565948486
Epoch: 27, Steps: 4 | Train Loss: 0.099 Vali Loss: 1.160 Vali Acc: 0.560 Test Loss: 1.160 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.2382116317749023
Epoch: 28, Steps: 4 | Train Loss: 0.071 Vali Loss: 1.259 Vali Acc: 0.560 Test Loss: 1.259 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.1567332744598389
Epoch: 29, Steps: 4 | Train Loss: 0.096 Vali Loss: 1.224 Vali Acc: 0.600 Test Loss: 1.224 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.201094627380371
Epoch: 30, Steps: 4 | Train Loss: 0.068 Vali Loss: 1.167 Vali Acc: 0.660 Test Loss: 1.167 Test Acc: 0.660
Validation loss decreased (-0.599989 --> -0.659988).  Saving model ...
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm16_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.66
model parameter : 215669
model size : 1.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm8_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 5.099605083465576
Epoch: 1, Steps: 4 | Train Loss: 1.745 Vali Loss: 1.651 Vali Acc: 0.140 Test Loss: 1.651 Test Acc: 0.140
Validation loss decreased (inf --> -0.139983).  Saving model ...
Epoch: 2 cost time: 3.019090175628662
Epoch: 2, Steps: 4 | Train Loss: 1.635 Vali Loss: 1.650 Vali Acc: 0.180 Test Loss: 1.650 Test Acc: 0.180
Validation loss decreased (-0.139983 --> -0.179983).  Saving model ...
Epoch: 3 cost time: 3.027906656265259
Epoch: 3, Steps: 4 | Train Loss: 1.616 Vali Loss: 1.655 Vali Acc: 0.260 Test Loss: 1.655 Test Acc: 0.260
Validation loss decreased (-0.179983 --> -0.259983).  Saving model ...
Epoch: 4 cost time: 2.909186363220215
Epoch: 4, Steps: 4 | Train Loss: 1.526 Vali Loss: 1.665 Vali Acc: 0.220 Test Loss: 1.665 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.9969043731689453
Epoch: 5, Steps: 4 | Train Loss: 1.573 Vali Loss: 1.670 Vali Acc: 0.220 Test Loss: 1.670 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.0140767097473145
Epoch: 6, Steps: 4 | Train Loss: 1.594 Vali Loss: 1.669 Vali Acc: 0.220 Test Loss: 1.669 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.945119619369507
Epoch: 7, Steps: 4 | Train Loss: 1.457 Vali Loss: 1.666 Vali Acc: 0.260 Test Loss: 1.666 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.921442747116089
Epoch: 8, Steps: 4 | Train Loss: 1.334 Vali Loss: 1.669 Vali Acc: 0.280 Test Loss: 1.669 Test Acc: 0.280
Validation loss decreased (-0.259983 --> -0.279983).  Saving model ...
Epoch: 9 cost time: 2.9401490688323975
Epoch: 9, Steps: 4 | Train Loss: 1.300 Vali Loss: 1.665 Vali Acc: 0.320 Test Loss: 1.665 Test Acc: 0.320
Validation loss decreased (-0.279983 --> -0.319983).  Saving model ...
Epoch: 10 cost time: 2.9015755653381348
Epoch: 10, Steps: 4 | Train Loss: 1.217 Vali Loss: 1.646 Vali Acc: 0.280 Test Loss: 1.646 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.193276882171631
Epoch: 11, Steps: 4 | Train Loss: 1.006 Vali Loss: 1.626 Vali Acc: 0.320 Test Loss: 1.626 Test Acc: 0.320
Validation loss decreased (-0.319983 --> -0.319984).  Saving model ...
Epoch: 12 cost time: 2.9726357460021973
Epoch: 12, Steps: 4 | Train Loss: 0.924 Vali Loss: 1.615 Vali Acc: 0.320 Test Loss: 1.615 Test Acc: 0.320
Validation loss decreased (-0.319984 --> -0.319984).  Saving model ...
Epoch: 13 cost time: 2.966423511505127
Epoch: 13, Steps: 4 | Train Loss: 0.935 Vali Loss: 1.590 Vali Acc: 0.340 Test Loss: 1.590 Test Acc: 0.340
Validation loss decreased (-0.319984 --> -0.339984).  Saving model ...
Epoch: 14 cost time: 2.9562125205993652
Epoch: 14, Steps: 4 | Train Loss: 0.788 Vali Loss: 1.621 Vali Acc: 0.360 Test Loss: 1.621 Test Acc: 0.360
Validation loss decreased (-0.339984 --> -0.359984).  Saving model ...
Epoch: 15 cost time: 2.8132376670837402
Epoch: 15, Steps: 4 | Train Loss: 0.810 Vali Loss: 1.567 Vali Acc: 0.400 Test Loss: 1.567 Test Acc: 0.400
Validation loss decreased (-0.359984 --> -0.399984).  Saving model ...
Epoch: 16 cost time: 2.9459590911865234
Epoch: 16, Steps: 4 | Train Loss: 0.733 Vali Loss: 1.509 Vali Acc: 0.380 Test Loss: 1.509 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.988887310028076
Epoch: 17, Steps: 4 | Train Loss: 0.507 Vali Loss: 1.434 Vali Acc: 0.460 Test Loss: 1.434 Test Acc: 0.460
Validation loss decreased (-0.399984 --> -0.459986).  Saving model ...
Epoch: 18 cost time: 3.0174238681793213
Epoch: 18, Steps: 4 | Train Loss: 0.445 Vali Loss: 1.399 Vali Acc: 0.400 Test Loss: 1.399 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.967613697052002
Epoch: 19, Steps: 4 | Train Loss: 0.402 Vali Loss: 1.326 Vali Acc: 0.440 Test Loss: 1.326 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.9567983150482178
Epoch: 20, Steps: 4 | Train Loss: 0.382 Vali Loss: 1.418 Vali Acc: 0.440 Test Loss: 1.418 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.935410499572754
Epoch: 21, Steps: 4 | Train Loss: 0.347 Vali Loss: 1.433 Vali Acc: 0.420 Test Loss: 1.433 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.8918089866638184
Epoch: 22, Steps: 4 | Train Loss: 0.263 Vali Loss: 1.323 Vali Acc: 0.420 Test Loss: 1.323 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.0443434715270996
Epoch: 23, Steps: 4 | Train Loss: 0.334 Vali Loss: 1.345 Vali Acc: 0.420 Test Loss: 1.345 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.6979241371154785
Epoch: 24, Steps: 4 | Train Loss: 0.504 Vali Loss: 1.360 Vali Acc: 0.460 Test Loss: 1.360 Test Acc: 0.460
Validation loss decreased (-0.459986 --> -0.459986).  Saving model ...
Epoch: 25 cost time: 2.4712207317352295
Epoch: 25, Steps: 4 | Train Loss: 0.200 Vali Loss: 1.536 Vali Acc: 0.360 Test Loss: 1.536 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.534872531890869
Epoch: 26, Steps: 4 | Train Loss: 0.150 Vali Loss: 1.382 Vali Acc: 0.460 Test Loss: 1.382 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.039844512939453
Epoch: 27, Steps: 4 | Train Loss: 0.165 Vali Loss: 1.515 Vali Acc: 0.420 Test Loss: 1.515 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.8299107551574707
Epoch: 28, Steps: 4 | Train Loss: 0.140 Vali Loss: 1.303 Vali Acc: 0.420 Test Loss: 1.303 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 3.0071895122528076
Epoch: 29, Steps: 4 | Train Loss: 0.081 Vali Loss: 1.593 Vali Acc: 0.340 Test Loss: 1.593 Test Acc: 0.340
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.9174792766571045
Epoch: 30, Steps: 4 | Train Loss: 0.109 Vali Loss: 1.623 Vali Acc: 0.400 Test Loss: 1.623 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm8_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.46
model parameter : 923021
model size : 3.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm8_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.136804819107056
Epoch: 1, Steps: 4 | Train Loss: 1.722 Vali Loss: 1.765 Vali Acc: 0.260 Test Loss: 1.765 Test Acc: 0.260
Validation loss decreased (inf --> -0.259982).  Saving model ...
Epoch: 2 cost time: 2.0204710960388184
Epoch: 2, Steps: 4 | Train Loss: 1.611 Vali Loss: 1.753 Vali Acc: 0.260 Test Loss: 1.753 Test Acc: 0.260
Validation loss decreased (-0.259982 --> -0.259982).  Saving model ...
Epoch: 3 cost time: 1.8985927104949951
Epoch: 3, Steps: 4 | Train Loss: 1.636 Vali Loss: 1.737 Vali Acc: 0.260 Test Loss: 1.737 Test Acc: 0.260
Validation loss decreased (-0.259982 --> -0.259983).  Saving model ...
Epoch: 4 cost time: 1.9538187980651855
Epoch: 4, Steps: 4 | Train Loss: 1.611 Vali Loss: 1.718 Vali Acc: 0.300 Test Loss: 1.718 Test Acc: 0.300
Validation loss decreased (-0.259983 --> -0.299983).  Saving model ...
Epoch: 5 cost time: 1.94293212890625
Epoch: 5, Steps: 4 | Train Loss: 1.505 Vali Loss: 1.701 Vali Acc: 0.320 Test Loss: 1.701 Test Acc: 0.320
Validation loss decreased (-0.299983 --> -0.319983).  Saving model ...
Epoch: 6 cost time: 1.9423034191131592
Epoch: 6, Steps: 4 | Train Loss: 1.474 Vali Loss: 1.680 Vali Acc: 0.300 Test Loss: 1.680 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.9083514213562012
Epoch: 7, Steps: 4 | Train Loss: 1.342 Vali Loss: 1.656 Vali Acc: 0.340 Test Loss: 1.656 Test Acc: 0.340
Validation loss decreased (-0.319983 --> -0.339983).  Saving model ...
Epoch: 8 cost time: 1.8850975036621094
Epoch: 8, Steps: 4 | Train Loss: 1.284 Vali Loss: 1.628 Vali Acc: 0.340 Test Loss: 1.628 Test Acc: 0.340
Validation loss decreased (-0.339983 --> -0.339984).  Saving model ...
Epoch: 9 cost time: 1.8493115901947021
Epoch: 9, Steps: 4 | Train Loss: 1.199 Vali Loss: 1.593 Vali Acc: 0.360 Test Loss: 1.593 Test Acc: 0.360
Validation loss decreased (-0.339984 --> -0.359984).  Saving model ...
Epoch: 10 cost time: 2.0190460681915283
Epoch: 10, Steps: 4 | Train Loss: 1.117 Vali Loss: 1.557 Vali Acc: 0.420 Test Loss: 1.557 Test Acc: 0.420
Validation loss decreased (-0.359984 --> -0.419984).  Saving model ...
Epoch: 11 cost time: 1.9234368801116943
Epoch: 11, Steps: 4 | Train Loss: 1.094 Vali Loss: 1.534 Vali Acc: 0.440 Test Loss: 1.534 Test Acc: 0.440
Validation loss decreased (-0.419984 --> -0.439985).  Saving model ...
Epoch: 12 cost time: 1.9177641868591309
Epoch: 12, Steps: 4 | Train Loss: 0.858 Vali Loss: 1.498 Vali Acc: 0.400 Test Loss: 1.498 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.834498405456543
Epoch: 13, Steps: 4 | Train Loss: 0.815 Vali Loss: 1.451 Vali Acc: 0.420 Test Loss: 1.451 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.045199394226074
Epoch: 14, Steps: 4 | Train Loss: 0.733 Vali Loss: 1.442 Vali Acc: 0.420 Test Loss: 1.442 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.9799466133117676
Epoch: 15, Steps: 4 | Train Loss: 0.655 Vali Loss: 1.426 Vali Acc: 0.420 Test Loss: 1.426 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.997438669204712
Epoch: 16, Steps: 4 | Train Loss: 0.682 Vali Loss: 1.397 Vali Acc: 0.420 Test Loss: 1.397 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.9460420608520508
Epoch: 17, Steps: 4 | Train Loss: 0.478 Vali Loss: 1.380 Vali Acc: 0.420 Test Loss: 1.380 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.0105555057525635
Epoch: 18, Steps: 4 | Train Loss: 0.508 Vali Loss: 1.389 Vali Acc: 0.400 Test Loss: 1.389 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.970299243927002
Epoch: 19, Steps: 4 | Train Loss: 0.416 Vali Loss: 1.458 Vali Acc: 0.420 Test Loss: 1.458 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.0669381618499756
Epoch: 20, Steps: 4 | Train Loss: 0.435 Vali Loss: 1.382 Vali Acc: 0.460 Test Loss: 1.382 Test Acc: 0.460
Validation loss decreased (-0.439985 --> -0.459986).  Saving model ...
Epoch: 21 cost time: 1.9652917385101318
Epoch: 21, Steps: 4 | Train Loss: 0.408 Vali Loss: 1.520 Vali Acc: 0.420 Test Loss: 1.520 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.845000982284546
Epoch: 22, Steps: 4 | Train Loss: 0.308 Vali Loss: 1.343 Vali Acc: 0.440 Test Loss: 1.343 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.0124011039733887
Epoch: 23, Steps: 4 | Train Loss: 0.321 Vali Loss: 1.434 Vali Acc: 0.400 Test Loss: 1.434 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.102898359298706
Epoch: 24, Steps: 4 | Train Loss: 0.298 Vali Loss: 1.358 Vali Acc: 0.460 Test Loss: 1.358 Test Acc: 0.460
Validation loss decreased (-0.459986 --> -0.459986).  Saving model ...
Epoch: 25 cost time: 1.907677412033081
Epoch: 25, Steps: 4 | Train Loss: 0.285 Vali Loss: 1.439 Vali Acc: 0.440 Test Loss: 1.439 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.0237925052642822
Epoch: 26, Steps: 4 | Train Loss: 0.237 Vali Loss: 1.531 Vali Acc: 0.420 Test Loss: 1.531 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.0530896186828613
Epoch: 27, Steps: 4 | Train Loss: 0.230 Vali Loss: 1.486 Vali Acc: 0.440 Test Loss: 1.486 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.8531126976013184
Epoch: 28, Steps: 4 | Train Loss: 0.200 Vali Loss: 1.602 Vali Acc: 0.400 Test Loss: 1.602 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.9082691669464111
Epoch: 29, Steps: 4 | Train Loss: 0.146 Vali Loss: 1.497 Vali Acc: 0.440 Test Loss: 1.497 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.1763484477996826
Epoch: 30, Steps: 4 | Train Loss: 0.147 Vali Loss: 1.874 Vali Acc: 0.420 Test Loss: 1.874 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm8_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.46
model parameter : 302045
model size : 1.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm8_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.389580011367798
Epoch: 1, Steps: 4 | Train Loss: 1.745 Vali Loss: 1.648 Vali Acc: 0.140 Test Loss: 1.648 Test Acc: 0.140
Validation loss decreased (inf --> -0.139984).  Saving model ...
Epoch: 2 cost time: 2.37742280960083
Epoch: 2, Steps: 4 | Train Loss: 1.633 Vali Loss: 1.651 Vali Acc: 0.180 Test Loss: 1.651 Test Acc: 0.180
Validation loss decreased (-0.139984 --> -0.179983).  Saving model ...
Epoch: 3 cost time: 2.1183340549468994
Epoch: 3, Steps: 4 | Train Loss: 1.619 Vali Loss: 1.659 Vali Acc: 0.200 Test Loss: 1.659 Test Acc: 0.200
Validation loss decreased (-0.179983 --> -0.199983).  Saving model ...
Epoch: 4 cost time: 2.367156505584717
Epoch: 4, Steps: 4 | Train Loss: 1.525 Vali Loss: 1.676 Vali Acc: 0.200 Test Loss: 1.676 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.277674913406372
Epoch: 5, Steps: 4 | Train Loss: 1.571 Vali Loss: 1.687 Vali Acc: 0.220 Test Loss: 1.687 Test Acc: 0.220
Validation loss decreased (-0.199983 --> -0.219983).  Saving model ...
Epoch: 6 cost time: 2.2402350902557373
Epoch: 6, Steps: 4 | Train Loss: 1.593 Vali Loss: 1.682 Vali Acc: 0.220 Test Loss: 1.682 Test Acc: 0.220
Validation loss decreased (-0.219983 --> -0.219983).  Saving model ...
Epoch: 7 cost time: 2.318638563156128
Epoch: 7, Steps: 4 | Train Loss: 1.458 Vali Loss: 1.668 Vali Acc: 0.240 Test Loss: 1.668 Test Acc: 0.240
Validation loss decreased (-0.219983 --> -0.239983).  Saving model ...
Epoch: 8 cost time: 2.2703299522399902
Epoch: 8, Steps: 4 | Train Loss: 1.336 Vali Loss: 1.667 Vali Acc: 0.280 Test Loss: 1.667 Test Acc: 0.280
Validation loss decreased (-0.239983 --> -0.279983).  Saving model ...
Epoch: 9 cost time: 2.169342517852783
Epoch: 9, Steps: 4 | Train Loss: 1.304 Vali Loss: 1.656 Vali Acc: 0.280 Test Loss: 1.656 Test Acc: 0.280
Validation loss decreased (-0.279983 --> -0.279983).  Saving model ...
Epoch: 10 cost time: 2.2114994525909424
Epoch: 10, Steps: 4 | Train Loss: 1.202 Vali Loss: 1.628 Vali Acc: 0.300 Test Loss: 1.628 Test Acc: 0.300
Validation loss decreased (-0.279983 --> -0.299984).  Saving model ...
Epoch: 11 cost time: 2.268850088119507
Epoch: 11, Steps: 4 | Train Loss: 1.010 Vali Loss: 1.596 Vali Acc: 0.340 Test Loss: 1.596 Test Acc: 0.340
Validation loss decreased (-0.299984 --> -0.339984).  Saving model ...
Epoch: 12 cost time: 2.2549052238464355
Epoch: 12, Steps: 4 | Train Loss: 0.921 Vali Loss: 1.577 Vali Acc: 0.340 Test Loss: 1.577 Test Acc: 0.340
Validation loss decreased (-0.339984 --> -0.339984).  Saving model ...
Epoch: 13 cost time: 2.4532413482666016
Epoch: 13, Steps: 4 | Train Loss: 0.960 Vali Loss: 1.561 Vali Acc: 0.360 Test Loss: 1.561 Test Acc: 0.360
Validation loss decreased (-0.339984 --> -0.359984).  Saving model ...
Epoch: 14 cost time: 2.3147122859954834
Epoch: 14, Steps: 4 | Train Loss: 0.796 Vali Loss: 1.564 Vali Acc: 0.320 Test Loss: 1.564 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.072826623916626
Epoch: 15, Steps: 4 | Train Loss: 0.855 Vali Loss: 1.487 Vali Acc: 0.400 Test Loss: 1.487 Test Acc: 0.400
Validation loss decreased (-0.359984 --> -0.399985).  Saving model ...
Epoch: 16 cost time: 2.2200920581817627
Epoch: 16, Steps: 4 | Train Loss: 0.734 Vali Loss: 1.420 Vali Acc: 0.400 Test Loss: 1.420 Test Acc: 0.400
Validation loss decreased (-0.399985 --> -0.399986).  Saving model ...
Epoch: 17 cost time: 2.2922587394714355
Epoch: 17, Steps: 4 | Train Loss: 0.518 Vali Loss: 1.426 Vali Acc: 0.400 Test Loss: 1.426 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.2431623935699463
Epoch: 18, Steps: 4 | Train Loss: 0.456 Vali Loss: 1.368 Vali Acc: 0.380 Test Loss: 1.368 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.2220308780670166
Epoch: 19, Steps: 4 | Train Loss: 0.406 Vali Loss: 1.306 Vali Acc: 0.420 Test Loss: 1.306 Test Acc: 0.420
Validation loss decreased (-0.399986 --> -0.419987).  Saving model ...
Epoch: 20 cost time: 2.197096824645996
Epoch: 20, Steps: 4 | Train Loss: 0.402 Vali Loss: 1.387 Vali Acc: 0.420 Test Loss: 1.387 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.3518013954162598
Epoch: 21, Steps: 4 | Train Loss: 0.328 Vali Loss: 1.338 Vali Acc: 0.420 Test Loss: 1.338 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.254108428955078
Epoch: 22, Steps: 4 | Train Loss: 0.256 Vali Loss: 1.307 Vali Acc: 0.380 Test Loss: 1.307 Test Acc: 0.380
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.341210126876831
Epoch: 23, Steps: 4 | Train Loss: 0.427 Vali Loss: 1.280 Vali Acc: 0.380 Test Loss: 1.280 Test Acc: 0.380
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.2744789123535156
Epoch: 24, Steps: 4 | Train Loss: 0.469 Vali Loss: 1.267 Vali Acc: 0.480 Test Loss: 1.267 Test Acc: 0.480
Validation loss decreased (-0.419987 --> -0.479987).  Saving model ...
Epoch: 25 cost time: 2.185356855392456
Epoch: 25, Steps: 4 | Train Loss: 0.213 Vali Loss: 1.379 Vali Acc: 0.420 Test Loss: 1.379 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.2600107192993164
Epoch: 26, Steps: 4 | Train Loss: 0.165 Vali Loss: 1.322 Vali Acc: 0.460 Test Loss: 1.322 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.2741193771362305
Epoch: 27, Steps: 4 | Train Loss: 0.170 Vali Loss: 1.259 Vali Acc: 0.520 Test Loss: 1.259 Test Acc: 0.520
Validation loss decreased (-0.479987 --> -0.519987).  Saving model ...
Epoch: 28 cost time: 2.4793221950531006
Epoch: 28, Steps: 4 | Train Loss: 0.262 Vali Loss: 1.258 Vali Acc: 0.560 Test Loss: 1.258 Test Acc: 0.560
Validation loss decreased (-0.519987 --> -0.559987).  Saving model ...
Epoch: 29 cost time: 2.369703531265259
Epoch: 29, Steps: 4 | Train Loss: 0.105 Vali Loss: 1.320 Vali Acc: 0.540 Test Loss: 1.320 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.252483606338501
Epoch: 30, Steps: 4 | Train Loss: 0.202 Vali Loss: 1.349 Vali Acc: 0.480 Test Loss: 1.349 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm8_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 923021
model size : 3.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm8_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.7369577884674072
Epoch: 1, Steps: 4 | Train Loss: 1.720 Vali Loss: 1.761 Vali Acc: 0.260 Test Loss: 1.761 Test Acc: 0.260
Validation loss decreased (inf --> -0.259982).  Saving model ...
Epoch: 2 cost time: 1.5943689346313477
Epoch: 2, Steps: 4 | Train Loss: 1.615 Vali Loss: 1.749 Vali Acc: 0.260 Test Loss: 1.749 Test Acc: 0.260
Validation loss decreased (-0.259982 --> -0.259983).  Saving model ...
Epoch: 3 cost time: 1.4567592144012451
Epoch: 3, Steps: 4 | Train Loss: 1.652 Vali Loss: 1.732 Vali Acc: 0.280 Test Loss: 1.732 Test Acc: 0.280
Validation loss decreased (-0.259983 --> -0.279983).  Saving model ...
Epoch: 4 cost time: 1.6910357475280762
Epoch: 4, Steps: 4 | Train Loss: 1.619 Vali Loss: 1.715 Vali Acc: 0.320 Test Loss: 1.715 Test Acc: 0.320
Validation loss decreased (-0.279983 --> -0.319983).  Saving model ...
Epoch: 5 cost time: 1.6339921951293945
Epoch: 5, Steps: 4 | Train Loss: 1.505 Vali Loss: 1.696 Vali Acc: 0.320 Test Loss: 1.696 Test Acc: 0.320
Validation loss decreased (-0.319983 --> -0.319983).  Saving model ...
Epoch: 6 cost time: 1.6323235034942627
Epoch: 6, Steps: 4 | Train Loss: 1.472 Vali Loss: 1.673 Vali Acc: 0.340 Test Loss: 1.673 Test Acc: 0.340
Validation loss decreased (-0.319983 --> -0.339983).  Saving model ...
Epoch: 7 cost time: 1.7531530857086182
Epoch: 7, Steps: 4 | Train Loss: 1.339 Vali Loss: 1.647 Vali Acc: 0.380 Test Loss: 1.647 Test Acc: 0.380
Validation loss decreased (-0.339983 --> -0.379984).  Saving model ...
Epoch: 8 cost time: 1.5551397800445557
Epoch: 8, Steps: 4 | Train Loss: 1.280 Vali Loss: 1.626 Vali Acc: 0.380 Test Loss: 1.626 Test Acc: 0.380
Validation loss decreased (-0.379984 --> -0.379984).  Saving model ...
Epoch: 9 cost time: 1.5796089172363281
Epoch: 9, Steps: 4 | Train Loss: 1.200 Vali Loss: 1.587 Vali Acc: 0.380 Test Loss: 1.587 Test Acc: 0.380
Validation loss decreased (-0.379984 --> -0.379984).  Saving model ...
Epoch: 10 cost time: 1.5446751117706299
Epoch: 10, Steps: 4 | Train Loss: 1.112 Vali Loss: 1.541 Vali Acc: 0.440 Test Loss: 1.541 Test Acc: 0.440
Validation loss decreased (-0.379984 --> -0.439985).  Saving model ...
Epoch: 11 cost time: 1.6637969017028809
Epoch: 11, Steps: 4 | Train Loss: 1.079 Vali Loss: 1.515 Vali Acc: 0.460 Test Loss: 1.515 Test Acc: 0.460
Validation loss decreased (-0.439985 --> -0.459985).  Saving model ...
Epoch: 12 cost time: 1.6757793426513672
Epoch: 12, Steps: 4 | Train Loss: 0.859 Vali Loss: 1.475 Vali Acc: 0.440 Test Loss: 1.475 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5725793838500977
Epoch: 13, Steps: 4 | Train Loss: 0.795 Vali Loss: 1.419 Vali Acc: 0.420 Test Loss: 1.419 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.5469558238983154
Epoch: 14, Steps: 4 | Train Loss: 0.731 Vali Loss: 1.401 Vali Acc: 0.440 Test Loss: 1.401 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.5453729629516602
Epoch: 15, Steps: 4 | Train Loss: 0.606 Vali Loss: 1.376 Vali Acc: 0.480 Test Loss: 1.376 Test Acc: 0.480
Validation loss decreased (-0.459985 --> -0.479986).  Saving model ...
Epoch: 16 cost time: 1.5865421295166016
Epoch: 16, Steps: 4 | Train Loss: 0.698 Vali Loss: 1.376 Vali Acc: 0.440 Test Loss: 1.376 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3608007431030273
Epoch: 17, Steps: 4 | Train Loss: 0.478 Vali Loss: 1.332 Vali Acc: 0.440 Test Loss: 1.332 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.6483957767486572
Epoch: 18, Steps: 4 | Train Loss: 0.612 Vali Loss: 1.307 Vali Acc: 0.480 Test Loss: 1.307 Test Acc: 0.480
Validation loss decreased (-0.479986 --> -0.479987).  Saving model ...
Epoch: 19 cost time: 1.5526726245880127
Epoch: 19, Steps: 4 | Train Loss: 0.448 Vali Loss: 1.333 Vali Acc: 0.420 Test Loss: 1.333 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.5887119770050049
Epoch: 20, Steps: 4 | Train Loss: 0.422 Vali Loss: 1.367 Vali Acc: 0.420 Test Loss: 1.367 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.4588899612426758
Epoch: 21, Steps: 4 | Train Loss: 0.484 Vali Loss: 1.398 Vali Acc: 0.420 Test Loss: 1.398 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.5814270973205566
Epoch: 22, Steps: 4 | Train Loss: 0.308 Vali Loss: 1.316 Vali Acc: 0.460 Test Loss: 1.316 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.5766265392303467
Epoch: 23, Steps: 4 | Train Loss: 0.292 Vali Loss: 1.347 Vali Acc: 0.400 Test Loss: 1.347 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.1264152526855469
Epoch: 24, Steps: 4 | Train Loss: 0.280 Vali Loss: 1.304 Vali Acc: 0.420 Test Loss: 1.304 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.5793514251708984
Epoch: 25, Steps: 4 | Train Loss: 0.263 Vali Loss: 1.325 Vali Acc: 0.440 Test Loss: 1.325 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.6244935989379883
Epoch: 26, Steps: 4 | Train Loss: 0.270 Vali Loss: 1.587 Vali Acc: 0.360 Test Loss: 1.587 Test Acc: 0.360
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.6564581394195557
Epoch: 27, Steps: 4 | Train Loss: 0.239 Vali Loss: 1.390 Vali Acc: 0.400 Test Loss: 1.390 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.6152386665344238
Epoch: 28, Steps: 4 | Train Loss: 0.205 Vali Loss: 1.482 Vali Acc: 0.420 Test Loss: 1.482 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm8_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.48
model parameter : 302045
model size : 1.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm8_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.5421292781829834
Epoch: 1, Steps: 4 | Train Loss: 1.737 Vali Loss: 1.654 Vali Acc: 0.140 Test Loss: 1.654 Test Acc: 0.140
Validation loss decreased (inf --> -0.139983).  Saving model ...
Epoch: 2 cost time: 1.5381619930267334
Epoch: 2, Steps: 4 | Train Loss: 1.634 Vali Loss: 1.652 Vali Acc: 0.140 Test Loss: 1.652 Test Acc: 0.140
Validation loss decreased (-0.139983 --> -0.139983).  Saving model ...
Epoch: 3 cost time: 1.599696397781372
Epoch: 3, Steps: 4 | Train Loss: 1.612 Vali Loss: 1.657 Vali Acc: 0.220 Test Loss: 1.657 Test Acc: 0.220
Validation loss decreased (-0.139983 --> -0.219983).  Saving model ...
Epoch: 4 cost time: 1.5075781345367432
Epoch: 4, Steps: 4 | Train Loss: 1.517 Vali Loss: 1.670 Vali Acc: 0.200 Test Loss: 1.670 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5667221546173096
Epoch: 5, Steps: 4 | Train Loss: 1.577 Vali Loss: 1.684 Vali Acc: 0.200 Test Loss: 1.684 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.523594617843628
Epoch: 6, Steps: 4 | Train Loss: 1.609 Vali Loss: 1.677 Vali Acc: 0.240 Test Loss: 1.677 Test Acc: 0.240
Validation loss decreased (-0.219983 --> -0.239983).  Saving model ...
Epoch: 7 cost time: 1.5723626613616943
Epoch: 7, Steps: 4 | Train Loss: 1.469 Vali Loss: 1.673 Vali Acc: 0.260 Test Loss: 1.673 Test Acc: 0.260
Validation loss decreased (-0.239983 --> -0.259983).  Saving model ...
Epoch: 8 cost time: 1.4462263584136963
Epoch: 8, Steps: 4 | Train Loss: 1.346 Vali Loss: 1.676 Vali Acc: 0.240 Test Loss: 1.676 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5435009002685547
Epoch: 9, Steps: 4 | Train Loss: 1.325 Vali Loss: 1.657 Vali Acc: 0.300 Test Loss: 1.657 Test Acc: 0.300
Validation loss decreased (-0.259983 --> -0.299983).  Saving model ...
Epoch: 10 cost time: 1.6130218505859375
Epoch: 10, Steps: 4 | Train Loss: 1.205 Vali Loss: 1.639 Vali Acc: 0.300 Test Loss: 1.639 Test Acc: 0.300
Validation loss decreased (-0.299983 --> -0.299984).  Saving model ...
Epoch: 11 cost time: 1.5207765102386475
Epoch: 11, Steps: 4 | Train Loss: 1.029 Vali Loss: 1.613 Vali Acc: 0.320 Test Loss: 1.613 Test Acc: 0.320
Validation loss decreased (-0.299984 --> -0.319984).  Saving model ...
Epoch: 12 cost time: 1.6395189762115479
Epoch: 12, Steps: 4 | Train Loss: 0.983 Vali Loss: 1.591 Vali Acc: 0.320 Test Loss: 1.591 Test Acc: 0.320
Validation loss decreased (-0.319984 --> -0.319984).  Saving model ...
Epoch: 13 cost time: 1.5897736549377441
Epoch: 13, Steps: 4 | Train Loss: 1.026 Vali Loss: 1.577 Vali Acc: 0.340 Test Loss: 1.577 Test Acc: 0.340
Validation loss decreased (-0.319984 --> -0.339984).  Saving model ...
Epoch: 14 cost time: 1.5075702667236328
Epoch: 14, Steps: 4 | Train Loss: 0.833 Vali Loss: 1.595 Vali Acc: 0.360 Test Loss: 1.595 Test Acc: 0.360
Validation loss decreased (-0.339984 --> -0.359984).  Saving model ...
Epoch: 15 cost time: 1.4321649074554443
Epoch: 15, Steps: 4 | Train Loss: 0.897 Vali Loss: 1.543 Vali Acc: 0.360 Test Loss: 1.543 Test Acc: 0.360
Validation loss decreased (-0.359984 --> -0.359985).  Saving model ...
Epoch: 16 cost time: 1.5661120414733887
Epoch: 16, Steps: 4 | Train Loss: 0.762 Vali Loss: 1.468 Vali Acc: 0.360 Test Loss: 1.468 Test Acc: 0.360
Validation loss decreased (-0.359985 --> -0.359985).  Saving model ...
Epoch: 17 cost time: 1.4802627563476562
Epoch: 17, Steps: 4 | Train Loss: 0.575 Vali Loss: 1.410 Vali Acc: 0.400 Test Loss: 1.410 Test Acc: 0.400
Validation loss decreased (-0.359985 --> -0.399986).  Saving model ...
Epoch: 18 cost time: 1.5598809719085693
Epoch: 18, Steps: 4 | Train Loss: 0.487 Vali Loss: 1.363 Vali Acc: 0.380 Test Loss: 1.363 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.4738962650299072
Epoch: 19, Steps: 4 | Train Loss: 0.477 Vali Loss: 1.345 Vali Acc: 0.420 Test Loss: 1.345 Test Acc: 0.420
Validation loss decreased (-0.399986 --> -0.419987).  Saving model ...
Epoch: 20 cost time: 1.556356430053711
Epoch: 20, Steps: 4 | Train Loss: 0.474 Vali Loss: 1.385 Vali Acc: 0.400 Test Loss: 1.385 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.4892630577087402
Epoch: 21, Steps: 4 | Train Loss: 0.423 Vali Loss: 1.412 Vali Acc: 0.440 Test Loss: 1.412 Test Acc: 0.440
Validation loss decreased (-0.419987 --> -0.439986).  Saving model ...
Epoch: 22 cost time: 1.4153363704681396
Epoch: 22, Steps: 4 | Train Loss: 0.345 Vali Loss: 1.318 Vali Acc: 0.420 Test Loss: 1.318 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.609199047088623
Epoch: 23, Steps: 4 | Train Loss: 0.465 Vali Loss: 1.355 Vali Acc: 0.440 Test Loss: 1.355 Test Acc: 0.440
Validation loss decreased (-0.439986 --> -0.439986).  Saving model ...
Epoch: 24 cost time: 1.5037245750427246
Epoch: 24, Steps: 4 | Train Loss: 0.560 Vali Loss: 1.229 Vali Acc: 0.420 Test Loss: 1.229 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.5955252647399902
Epoch: 25, Steps: 4 | Train Loss: 0.263 Vali Loss: 1.412 Vali Acc: 0.400 Test Loss: 1.412 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.531385898590088
Epoch: 26, Steps: 4 | Train Loss: 0.283 Vali Loss: 1.332 Vali Acc: 0.480 Test Loss: 1.332 Test Acc: 0.480
Validation loss decreased (-0.439986 --> -0.479987).  Saving model ...
Epoch: 27 cost time: 1.6105096340179443
Epoch: 27, Steps: 4 | Train Loss: 0.203 Vali Loss: 1.260 Vali Acc: 0.480 Test Loss: 1.260 Test Acc: 0.480
Validation loss decreased (-0.479987 --> -0.479987).  Saving model ...
Epoch: 28 cost time: 1.5281875133514404
Epoch: 28, Steps: 4 | Train Loss: 0.221 Vali Loss: 1.276 Vali Acc: 0.460 Test Loss: 1.276 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.4482684135437012
Epoch: 29, Steps: 4 | Train Loss: 0.158 Vali Loss: 1.456 Vali Acc: 0.480 Test Loss: 1.456 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.5259747505187988
Epoch: 30, Steps: 4 | Train Loss: 0.182 Vali Loss: 1.276 Vali Acc: 0.560 Test Loss: 1.276 Test Acc: 0.560
Validation loss decreased (-0.479987 --> -0.559987).  Saving model ...
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm8_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 923021
model size : 3.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm8_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.2148549556732178
Epoch: 1, Steps: 4 | Train Loss: 1.725 Vali Loss: 1.770 Vali Acc: 0.240 Test Loss: 1.770 Test Acc: 0.240
Validation loss decreased (inf --> -0.239982).  Saving model ...
Epoch: 2 cost time: 1.5181586742401123
Epoch: 2, Steps: 4 | Train Loss: 1.607 Vali Loss: 1.758 Vali Acc: 0.240 Test Loss: 1.758 Test Acc: 0.240
Validation loss decreased (-0.239982 --> -0.239982).  Saving model ...
Epoch: 3 cost time: 1.4422602653503418
Epoch: 3, Steps: 4 | Train Loss: 1.652 Vali Loss: 1.742 Vali Acc: 0.300 Test Loss: 1.742 Test Acc: 0.300
Validation loss decreased (-0.239982 --> -0.299983).  Saving model ...
Epoch: 4 cost time: 1.4468724727630615
Epoch: 4, Steps: 4 | Train Loss: 1.608 Vali Loss: 1.719 Vali Acc: 0.300 Test Loss: 1.719 Test Acc: 0.300
Validation loss decreased (-0.299983 --> -0.299983).  Saving model ...
Epoch: 5 cost time: 1.4732863903045654
Epoch: 5, Steps: 4 | Train Loss: 1.509 Vali Loss: 1.699 Vali Acc: 0.360 Test Loss: 1.699 Test Acc: 0.360
Validation loss decreased (-0.299983 --> -0.359983).  Saving model ...
Epoch: 6 cost time: 1.5551366806030273
Epoch: 6, Steps: 4 | Train Loss: 1.482 Vali Loss: 1.677 Vali Acc: 0.300 Test Loss: 1.677 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4104652404785156
Epoch: 7, Steps: 4 | Train Loss: 1.357 Vali Loss: 1.649 Vali Acc: 0.340 Test Loss: 1.649 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.3808979988098145
Epoch: 8, Steps: 4 | Train Loss: 1.306 Vali Loss: 1.611 Vali Acc: 0.320 Test Loss: 1.611 Test Acc: 0.320
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.5360314846038818
Epoch: 9, Steps: 4 | Train Loss: 1.216 Vali Loss: 1.566 Vali Acc: 0.420 Test Loss: 1.566 Test Acc: 0.420
Validation loss decreased (-0.359983 --> -0.419984).  Saving model ...
Epoch: 10 cost time: 1.4212226867675781
Epoch: 10, Steps: 4 | Train Loss: 1.129 Vali Loss: 1.524 Vali Acc: 0.400 Test Loss: 1.524 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.506239891052246
Epoch: 11, Steps: 4 | Train Loss: 1.121 Vali Loss: 1.500 Vali Acc: 0.440 Test Loss: 1.500 Test Acc: 0.440
Validation loss decreased (-0.419984 --> -0.439985).  Saving model ...
Epoch: 12 cost time: 1.454953908920288
Epoch: 12, Steps: 4 | Train Loss: 0.906 Vali Loss: 1.452 Vali Acc: 0.420 Test Loss: 1.452 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4368796348571777
Epoch: 13, Steps: 4 | Train Loss: 0.829 Vali Loss: 1.398 Vali Acc: 0.460 Test Loss: 1.398 Test Acc: 0.460
Validation loss decreased (-0.439985 --> -0.459986).  Saving model ...
Epoch: 14 cost time: 1.4197254180908203
Epoch: 14, Steps: 4 | Train Loss: 0.744 Vali Loss: 1.367 Vali Acc: 0.380 Test Loss: 1.367 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4594786167144775
Epoch: 15, Steps: 4 | Train Loss: 0.649 Vali Loss: 1.345 Vali Acc: 0.420 Test Loss: 1.345 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.434999704360962
Epoch: 16, Steps: 4 | Train Loss: 0.746 Vali Loss: 1.325 Vali Acc: 0.420 Test Loss: 1.325 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.287370204925537
Epoch: 17, Steps: 4 | Train Loss: 0.506 Vali Loss: 1.307 Vali Acc: 0.480 Test Loss: 1.307 Test Acc: 0.480
Validation loss decreased (-0.459986 --> -0.479987).  Saving model ...
Epoch: 18 cost time: 1.4108355045318604
Epoch: 18, Steps: 4 | Train Loss: 0.553 Vali Loss: 1.306 Vali Acc: 0.500 Test Loss: 1.306 Test Acc: 0.500
Validation loss decreased (-0.479987 --> -0.499987).  Saving model ...
Epoch: 19 cost time: 1.4747240543365479
Epoch: 19, Steps: 4 | Train Loss: 0.443 Vali Loss: 1.364 Vali Acc: 0.400 Test Loss: 1.364 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.3406648635864258
Epoch: 20, Steps: 4 | Train Loss: 0.552 Vali Loss: 1.311 Vali Acc: 0.480 Test Loss: 1.311 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.3848021030426025
Epoch: 21, Steps: 4 | Train Loss: 0.570 Vali Loss: 1.422 Vali Acc: 0.440 Test Loss: 1.422 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.581597089767456
Epoch: 22, Steps: 4 | Train Loss: 0.375 Vali Loss: 1.298 Vali Acc: 0.480 Test Loss: 1.298 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.4285767078399658
Epoch: 23, Steps: 4 | Train Loss: 0.322 Vali Loss: 1.279 Vali Acc: 0.460 Test Loss: 1.279 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.4605317115783691
Epoch: 24, Steps: 4 | Train Loss: 0.308 Vali Loss: 1.333 Vali Acc: 0.440 Test Loss: 1.333 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.3947017192840576
Epoch: 25, Steps: 4 | Train Loss: 0.392 Vali Loss: 1.231 Vali Acc: 0.480 Test Loss: 1.231 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.4671261310577393
Epoch: 26, Steps: 4 | Train Loss: 0.367 Vali Loss: 1.394 Vali Acc: 0.440 Test Loss: 1.394 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.4316840171813965
Epoch: 27, Steps: 4 | Train Loss: 0.257 Vali Loss: 1.292 Vali Acc: 0.520 Test Loss: 1.292 Test Acc: 0.520
Validation loss decreased (-0.499987 --> -0.519987).  Saving model ...
Epoch: 28 cost time: 1.4158401489257812
Epoch: 28, Steps: 4 | Train Loss: 0.239 Vali Loss: 1.340 Vali Acc: 0.460 Test Loss: 1.340 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.3699531555175781
Epoch: 29, Steps: 4 | Train Loss: 0.189 Vali Loss: 1.344 Vali Acc: 0.480 Test Loss: 1.344 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.4091191291809082
Epoch: 30, Steps: 4 | Train Loss: 0.200 Vali Loss: 1.452 Vali Acc: 0.440 Test Loss: 1.452 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm8_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 302045
model size : 1.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm8_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.351672649383545
Epoch: 1, Steps: 4 | Train Loss: 1.650 Vali Loss: 1.850 Vali Acc: 0.140 Test Loss: 1.850 Test Acc: 0.140
Validation loss decreased (inf --> -0.139982).  Saving model ...
Epoch: 2 cost time: 2.0354809761047363
Epoch: 2, Steps: 4 | Train Loss: 1.559 Vali Loss: 1.827 Vali Acc: 0.220 Test Loss: 1.827 Test Acc: 0.220
Validation loss decreased (-0.139982 --> -0.219982).  Saving model ...
Epoch: 3 cost time: 2.0959465503692627
Epoch: 3, Steps: 4 | Train Loss: 1.564 Vali Loss: 1.793 Vali Acc: 0.200 Test Loss: 1.793 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.0321733951568604
Epoch: 4, Steps: 4 | Train Loss: 1.635 Vali Loss: 1.753 Vali Acc: 0.200 Test Loss: 1.753 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.0655627250671387
Epoch: 5, Steps: 4 | Train Loss: 1.406 Vali Loss: 1.713 Vali Acc: 0.280 Test Loss: 1.713 Test Acc: 0.280
Validation loss decreased (-0.219982 --> -0.279983).  Saving model ...
Epoch: 6 cost time: 2.115056037902832
Epoch: 6, Steps: 4 | Train Loss: 1.291 Vali Loss: 1.681 Vali Acc: 0.280 Test Loss: 1.681 Test Acc: 0.280
Validation loss decreased (-0.279983 --> -0.279983).  Saving model ...
Epoch: 7 cost time: 2.0821545124053955
Epoch: 7, Steps: 4 | Train Loss: 1.261 Vali Loss: 1.660 Vali Acc: 0.320 Test Loss: 1.660 Test Acc: 0.320
Validation loss decreased (-0.279983 --> -0.319983).  Saving model ...
Epoch: 8 cost time: 2.2368390560150146
Epoch: 8, Steps: 4 | Train Loss: 1.224 Vali Loss: 1.645 Vali Acc: 0.340 Test Loss: 1.645 Test Acc: 0.340
Validation loss decreased (-0.319983 --> -0.339984).  Saving model ...
Epoch: 9 cost time: 2.221832513809204
Epoch: 9, Steps: 4 | Train Loss: 1.168 Vali Loss: 1.620 Vali Acc: 0.360 Test Loss: 1.620 Test Acc: 0.360
Validation loss decreased (-0.339984 --> -0.359984).  Saving model ...
Epoch: 10 cost time: 2.100189208984375
Epoch: 10, Steps: 4 | Train Loss: 1.119 Vali Loss: 1.605 Vali Acc: 0.380 Test Loss: 1.605 Test Acc: 0.380
Validation loss decreased (-0.359984 --> -0.379984).  Saving model ...
Epoch: 11 cost time: 2.3693647384643555
Epoch: 11, Steps: 4 | Train Loss: 1.022 Vali Loss: 1.599 Vali Acc: 0.380 Test Loss: 1.599 Test Acc: 0.380
Validation loss decreased (-0.379984 --> -0.379984).  Saving model ...
Epoch: 12 cost time: 2.3431851863861084
Epoch: 12, Steps: 4 | Train Loss: 0.908 Vali Loss: 1.587 Vali Acc: 0.420 Test Loss: 1.587 Test Acc: 0.420
Validation loss decreased (-0.379984 --> -0.419984).  Saving model ...
Epoch: 13 cost time: 2.242957830429077
Epoch: 13, Steps: 4 | Train Loss: 0.850 Vali Loss: 1.593 Vali Acc: 0.420 Test Loss: 1.593 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.3739609718322754
Epoch: 14, Steps: 4 | Train Loss: 0.844 Vali Loss: 1.613 Vali Acc: 0.460 Test Loss: 1.613 Test Acc: 0.460
Validation loss decreased (-0.419984 --> -0.459984).  Saving model ...
Epoch: 15 cost time: 2.4374704360961914
Epoch: 15, Steps: 4 | Train Loss: 0.901 Vali Loss: 1.579 Vali Acc: 0.440 Test Loss: 1.579 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.4740118980407715
Epoch: 16, Steps: 4 | Train Loss: 0.584 Vali Loss: 1.545 Vali Acc: 0.420 Test Loss: 1.545 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.418255567550659
Epoch: 17, Steps: 4 | Train Loss: 0.564 Vali Loss: 1.577 Vali Acc: 0.460 Test Loss: 1.577 Test Acc: 0.460
Validation loss decreased (-0.459984 --> -0.459984).  Saving model ...
Epoch: 18 cost time: 2.3180439472198486
Epoch: 18, Steps: 4 | Train Loss: 0.471 Vali Loss: 1.602 Vali Acc: 0.460 Test Loss: 1.602 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.1126301288604736
Epoch: 19, Steps: 4 | Train Loss: 0.560 Vali Loss: 1.528 Vali Acc: 0.400 Test Loss: 1.528 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.36346697807312
Epoch: 20, Steps: 4 | Train Loss: 0.366 Vali Loss: 1.536 Vali Acc: 0.480 Test Loss: 1.536 Test Acc: 0.480
Validation loss decreased (-0.459984 --> -0.479985).  Saving model ...
Epoch: 21 cost time: 2.4519448280334473
Epoch: 21, Steps: 4 | Train Loss: 0.271 Vali Loss: 1.628 Vali Acc: 0.420 Test Loss: 1.628 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.402287006378174
Epoch: 22, Steps: 4 | Train Loss: 0.270 Vali Loss: 1.604 Vali Acc: 0.480 Test Loss: 1.604 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.4514317512512207
Epoch: 23, Steps: 4 | Train Loss: 0.210 Vali Loss: 1.638 Vali Acc: 0.460 Test Loss: 1.638 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.3717808723449707
Epoch: 24, Steps: 4 | Train Loss: 0.205 Vali Loss: 1.660 Vali Acc: 0.440 Test Loss: 1.660 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.2514946460723877
Epoch: 25, Steps: 4 | Train Loss: 0.295 Vali Loss: 1.636 Vali Acc: 0.460 Test Loss: 1.636 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.388190984725952
Epoch: 26, Steps: 4 | Train Loss: 0.245 Vali Loss: 1.537 Vali Acc: 0.460 Test Loss: 1.537 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.3876194953918457
Epoch: 27, Steps: 4 | Train Loss: 0.186 Vali Loss: 1.607 Vali Acc: 0.480 Test Loss: 1.607 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.484018564224243
Epoch: 28, Steps: 4 | Train Loss: 0.136 Vali Loss: 1.616 Vali Acc: 0.480 Test Loss: 1.616 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.513054609298706
Epoch: 29, Steps: 4 | Train Loss: 0.118 Vali Loss: 1.591 Vali Acc: 0.460 Test Loss: 1.591 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 2.458615303039551
Epoch: 30, Steps: 4 | Train Loss: 0.111 Vali Loss: 1.567 Vali Acc: 0.520 Test Loss: 1.567 Test Acc: 0.520
Validation loss decreased (-0.479985 --> -0.519984).  Saving model ...
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm8_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 483149
model size : 2.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm8_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.140833616256714
Epoch: 1, Steps: 4 | Train Loss: 1.717 Vali Loss: 1.706 Vali Acc: 0.200 Test Loss: 1.706 Test Acc: 0.200
Validation loss decreased (inf --> -0.199983).  Saving model ...
Epoch: 2 cost time: 1.8082661628723145
Epoch: 2, Steps: 4 | Train Loss: 1.576 Vali Loss: 1.704 Vali Acc: 0.240 Test Loss: 1.704 Test Acc: 0.240
Validation loss decreased (-0.199983 --> -0.239983).  Saving model ...
Epoch: 3 cost time: 1.8700952529907227
Epoch: 3, Steps: 4 | Train Loss: 1.587 Vali Loss: 1.695 Vali Acc: 0.240 Test Loss: 1.695 Test Acc: 0.240
Validation loss decreased (-0.239983 --> -0.239983).  Saving model ...
Epoch: 4 cost time: 1.7594363689422607
Epoch: 4, Steps: 4 | Train Loss: 1.542 Vali Loss: 1.684 Vali Acc: 0.240 Test Loss: 1.684 Test Acc: 0.240
Validation loss decreased (-0.239983 --> -0.239983).  Saving model ...
Epoch: 5 cost time: 1.7271246910095215
Epoch: 5, Steps: 4 | Train Loss: 1.485 Vali Loss: 1.667 Vali Acc: 0.220 Test Loss: 1.667 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.762925148010254
Epoch: 6, Steps: 4 | Train Loss: 1.518 Vali Loss: 1.640 Vali Acc: 0.240 Test Loss: 1.640 Test Acc: 0.240
Validation loss decreased (-0.239983 --> -0.239984).  Saving model ...
Epoch: 7 cost time: 1.8691661357879639
Epoch: 7, Steps: 4 | Train Loss: 1.394 Vali Loss: 1.605 Vali Acc: 0.260 Test Loss: 1.605 Test Acc: 0.260
Validation loss decreased (-0.239984 --> -0.259984).  Saving model ...
Epoch: 8 cost time: 1.8539481163024902
Epoch: 8, Steps: 4 | Train Loss: 1.300 Vali Loss: 1.571 Vali Acc: 0.260 Test Loss: 1.571 Test Acc: 0.260
Validation loss decreased (-0.259984 --> -0.259984).  Saving model ...
Epoch: 9 cost time: 1.6806118488311768
Epoch: 9, Steps: 4 | Train Loss: 1.240 Vali Loss: 1.532 Vali Acc: 0.240 Test Loss: 1.532 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.8361380100250244
Epoch: 10, Steps: 4 | Train Loss: 1.135 Vali Loss: 1.490 Vali Acc: 0.220 Test Loss: 1.490 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.7733216285705566
Epoch: 11, Steps: 4 | Train Loss: 1.038 Vali Loss: 1.442 Vali Acc: 0.280 Test Loss: 1.442 Test Acc: 0.280
Validation loss decreased (-0.259984 --> -0.279986).  Saving model ...
Epoch: 12 cost time: 1.8799901008605957
Epoch: 12, Steps: 4 | Train Loss: 0.982 Vali Loss: 1.411 Vali Acc: 0.320 Test Loss: 1.411 Test Acc: 0.320
Validation loss decreased (-0.279986 --> -0.319986).  Saving model ...
Epoch: 13 cost time: 1.840010643005371
Epoch: 13, Steps: 4 | Train Loss: 0.946 Vali Loss: 1.367 Vali Acc: 0.320 Test Loss: 1.367 Test Acc: 0.320
Validation loss decreased (-0.319986 --> -0.319986).  Saving model ...
Epoch: 14 cost time: 1.8041443824768066
Epoch: 14, Steps: 4 | Train Loss: 0.948 Vali Loss: 1.289 Vali Acc: 0.360 Test Loss: 1.289 Test Acc: 0.360
Validation loss decreased (-0.319986 --> -0.359987).  Saving model ...
Epoch: 15 cost time: 1.7925493717193604
Epoch: 15, Steps: 4 | Train Loss: 0.837 Vali Loss: 1.244 Vali Acc: 0.380 Test Loss: 1.244 Test Acc: 0.380
Validation loss decreased (-0.359987 --> -0.379988).  Saving model ...
Epoch: 16 cost time: 1.8503684997558594
Epoch: 16, Steps: 4 | Train Loss: 0.689 Vali Loss: 1.227 Vali Acc: 0.360 Test Loss: 1.227 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.890911340713501
Epoch: 17, Steps: 4 | Train Loss: 0.687 Vali Loss: 1.141 Vali Acc: 0.440 Test Loss: 1.141 Test Acc: 0.440
Validation loss decreased (-0.379988 --> -0.439989).  Saving model ...
Epoch: 18 cost time: 1.8071472644805908
Epoch: 18, Steps: 4 | Train Loss: 0.490 Vali Loss: 1.166 Vali Acc: 0.460 Test Loss: 1.166 Test Acc: 0.460
Validation loss decreased (-0.439989 --> -0.459988).  Saving model ...
Epoch: 19 cost time: 1.6514322757720947
Epoch: 19, Steps: 4 | Train Loss: 0.495 Vali Loss: 1.118 Vali Acc: 0.440 Test Loss: 1.118 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.8214654922485352
Epoch: 20, Steps: 4 | Train Loss: 0.578 Vali Loss: 1.036 Vali Acc: 0.500 Test Loss: 1.036 Test Acc: 0.500
Validation loss decreased (-0.459988 --> -0.499990).  Saving model ...
Epoch: 21 cost time: 1.8997979164123535
Epoch: 21, Steps: 4 | Train Loss: 0.354 Vali Loss: 1.083 Vali Acc: 0.460 Test Loss: 1.083 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.7292861938476562
Epoch: 22, Steps: 4 | Train Loss: 0.290 Vali Loss: 1.145 Vali Acc: 0.440 Test Loss: 1.145 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.7983946800231934
Epoch: 23, Steps: 4 | Train Loss: 0.298 Vali Loss: 1.112 Vali Acc: 0.520 Test Loss: 1.112 Test Acc: 0.520
Validation loss decreased (-0.499990 --> -0.519989).  Saving model ...
Epoch: 24 cost time: 1.7289085388183594
Epoch: 24, Steps: 4 | Train Loss: 0.391 Vali Loss: 1.205 Vali Acc: 0.440 Test Loss: 1.205 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.7959821224212646
Epoch: 25, Steps: 4 | Train Loss: 0.202 Vali Loss: 1.177 Vali Acc: 0.520 Test Loss: 1.177 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.739015817642212
Epoch: 26, Steps: 4 | Train Loss: 0.246 Vali Loss: 1.141 Vali Acc: 0.520 Test Loss: 1.141 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.8097343444824219
Epoch: 27, Steps: 4 | Train Loss: 0.191 Vali Loss: 1.264 Vali Acc: 0.480 Test Loss: 1.264 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.7290151119232178
Epoch: 28, Steps: 4 | Train Loss: 0.156 Vali Loss: 1.283 Vali Acc: 0.380 Test Loss: 1.283 Test Acc: 0.380
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.6779224872589111
Epoch: 29, Steps: 4 | Train Loss: 0.175 Vali Loss: 1.132 Vali Acc: 0.500 Test Loss: 1.132 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.7574055194854736
Epoch: 30, Steps: 4 | Train Loss: 0.153 Vali Loss: 1.720 Vali Acc: 0.400 Test Loss: 1.720 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm8_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 172637
model size : 0.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm8_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.313885927200317
Epoch: 1, Steps: 4 | Train Loss: 1.645 Vali Loss: 1.844 Vali Acc: 0.140 Test Loss: 1.844 Test Acc: 0.140
Validation loss decreased (inf --> -0.139982).  Saving model ...
Epoch: 2 cost time: 1.8738653659820557
Epoch: 2, Steps: 4 | Train Loss: 1.561 Vali Loss: 1.822 Vali Acc: 0.220 Test Loss: 1.822 Test Acc: 0.220
Validation loss decreased (-0.139982 --> -0.219982).  Saving model ...
Epoch: 3 cost time: 1.8057544231414795
Epoch: 3, Steps: 4 | Train Loss: 1.564 Vali Loss: 1.789 Vali Acc: 0.200 Test Loss: 1.789 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7812726497650146
Epoch: 4, Steps: 4 | Train Loss: 1.631 Vali Loss: 1.749 Vali Acc: 0.200 Test Loss: 1.749 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.9053566455841064
Epoch: 5, Steps: 4 | Train Loss: 1.416 Vali Loss: 1.708 Vali Acc: 0.280 Test Loss: 1.708 Test Acc: 0.280
Validation loss decreased (-0.219982 --> -0.279983).  Saving model ...
Epoch: 6 cost time: 1.899467945098877
Epoch: 6, Steps: 4 | Train Loss: 1.288 Vali Loss: 1.674 Vali Acc: 0.300 Test Loss: 1.674 Test Acc: 0.300
Validation loss decreased (-0.279983 --> -0.299983).  Saving model ...
Epoch: 7 cost time: 1.9368889331817627
Epoch: 7, Steps: 4 | Train Loss: 1.270 Vali Loss: 1.652 Vali Acc: 0.320 Test Loss: 1.652 Test Acc: 0.320
Validation loss decreased (-0.299983 --> -0.319983).  Saving model ...
Epoch: 8 cost time: 1.8809912204742432
Epoch: 8, Steps: 4 | Train Loss: 1.245 Vali Loss: 1.643 Vali Acc: 0.340 Test Loss: 1.643 Test Acc: 0.340
Validation loss decreased (-0.319983 --> -0.339984).  Saving model ...
Epoch: 9 cost time: 1.8307442665100098
Epoch: 9, Steps: 4 | Train Loss: 1.162 Vali Loss: 1.627 Vali Acc: 0.360 Test Loss: 1.627 Test Acc: 0.360
Validation loss decreased (-0.339984 --> -0.359984).  Saving model ...
Epoch: 10 cost time: 1.9235575199127197
Epoch: 10, Steps: 4 | Train Loss: 1.126 Vali Loss: 1.604 Vali Acc: 0.360 Test Loss: 1.604 Test Acc: 0.360
Validation loss decreased (-0.359984 --> -0.359984).  Saving model ...
Epoch: 11 cost time: 1.9052188396453857
Epoch: 11, Steps: 4 | Train Loss: 1.029 Vali Loss: 1.597 Vali Acc: 0.380 Test Loss: 1.597 Test Acc: 0.380
Validation loss decreased (-0.359984 --> -0.379984).  Saving model ...
Epoch: 12 cost time: 1.8368616104125977
Epoch: 12, Steps: 4 | Train Loss: 0.922 Vali Loss: 1.582 Vali Acc: 0.420 Test Loss: 1.582 Test Acc: 0.420
Validation loss decreased (-0.379984 --> -0.419984).  Saving model ...
Epoch: 13 cost time: 2.0087978839874268
Epoch: 13, Steps: 4 | Train Loss: 0.864 Vali Loss: 1.595 Vali Acc: 0.400 Test Loss: 1.595 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.7781407833099365
Epoch: 14, Steps: 4 | Train Loss: 0.853 Vali Loss: 1.603 Vali Acc: 0.420 Test Loss: 1.603 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.9812073707580566
Epoch: 15, Steps: 4 | Train Loss: 0.885 Vali Loss: 1.553 Vali Acc: 0.440 Test Loss: 1.553 Test Acc: 0.440
Validation loss decreased (-0.419984 --> -0.439984).  Saving model ...
Epoch: 16 cost time: 1.9023199081420898
Epoch: 16, Steps: 4 | Train Loss: 0.630 Vali Loss: 1.517 Vali Acc: 0.460 Test Loss: 1.517 Test Acc: 0.460
Validation loss decreased (-0.439984 --> -0.459985).  Saving model ...
Epoch: 17 cost time: 1.8908753395080566
Epoch: 17, Steps: 4 | Train Loss: 0.553 Vali Loss: 1.558 Vali Acc: 0.460 Test Loss: 1.558 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.7849671840667725
Epoch: 18, Steps: 4 | Train Loss: 0.498 Vali Loss: 1.536 Vali Acc: 0.500 Test Loss: 1.536 Test Acc: 0.500
Validation loss decreased (-0.459985 --> -0.499985).  Saving model ...
Epoch: 19 cost time: 1.8807344436645508
Epoch: 19, Steps: 4 | Train Loss: 0.556 Vali Loss: 1.429 Vali Acc: 0.420 Test Loss: 1.429 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.7891771793365479
Epoch: 20, Steps: 4 | Train Loss: 0.378 Vali Loss: 1.420 Vali Acc: 0.460 Test Loss: 1.420 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.898332118988037
Epoch: 21, Steps: 4 | Train Loss: 0.315 Vali Loss: 1.453 Vali Acc: 0.480 Test Loss: 1.453 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.1628854274749756
Epoch: 22, Steps: 4 | Train Loss: 0.303 Vali Loss: 1.490 Vali Acc: 0.460 Test Loss: 1.490 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.9068729877471924
Epoch: 23, Steps: 4 | Train Loss: 0.271 Vali Loss: 1.488 Vali Acc: 0.500 Test Loss: 1.488 Test Acc: 0.500
Validation loss decreased (-0.499985 --> -0.499985).  Saving model ...
Epoch: 24 cost time: 1.8596923351287842
Epoch: 24, Steps: 4 | Train Loss: 0.255 Vali Loss: 1.354 Vali Acc: 0.500 Test Loss: 1.354 Test Acc: 0.500
Validation loss decreased (-0.499985 --> -0.499986).  Saving model ...
Epoch: 25 cost time: 1.8671646118164062
Epoch: 25, Steps: 4 | Train Loss: 0.206 Vali Loss: 1.377 Vali Acc: 0.500 Test Loss: 1.377 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.8919804096221924
Epoch: 26, Steps: 4 | Train Loss: 0.165 Vali Loss: 1.357 Vali Acc: 0.480 Test Loss: 1.357 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.764331579208374
Epoch: 27, Steps: 4 | Train Loss: 0.219 Vali Loss: 1.353 Vali Acc: 0.480 Test Loss: 1.353 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.9043021202087402
Epoch: 28, Steps: 4 | Train Loss: 0.219 Vali Loss: 1.340 Vali Acc: 0.520 Test Loss: 1.340 Test Acc: 0.520
Validation loss decreased (-0.499986 --> -0.519987).  Saving model ...
Epoch: 29 cost time: 1.8752119541168213
Epoch: 29, Steps: 4 | Train Loss: 0.110 Vali Loss: 1.434 Vali Acc: 0.500 Test Loss: 1.434 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.9047904014587402
Epoch: 30, Steps: 4 | Train Loss: 0.221 Vali Loss: 1.525 Vali Acc: 0.500 Test Loss: 1.525 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm8_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 483149
model size : 2.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm8_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.783552408218384
Epoch: 1, Steps: 4 | Train Loss: 1.720 Vali Loss: 1.706 Vali Acc: 0.200 Test Loss: 1.706 Test Acc: 0.200
Validation loss decreased (inf --> -0.199983).  Saving model ...
Epoch: 2 cost time: 1.5579593181610107
Epoch: 2, Steps: 4 | Train Loss: 1.554 Vali Loss: 1.702 Vali Acc: 0.260 Test Loss: 1.702 Test Acc: 0.260
Validation loss decreased (-0.199983 --> -0.259983).  Saving model ...
Epoch: 3 cost time: 1.4486784934997559
Epoch: 3, Steps: 4 | Train Loss: 1.591 Vali Loss: 1.693 Vali Acc: 0.260 Test Loss: 1.693 Test Acc: 0.260
Validation loss decreased (-0.259983 --> -0.259983).  Saving model ...
Epoch: 4 cost time: 1.5837087631225586
Epoch: 4, Steps: 4 | Train Loss: 1.541 Vali Loss: 1.681 Vali Acc: 0.240 Test Loss: 1.681 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5127952098846436
Epoch: 5, Steps: 4 | Train Loss: 1.477 Vali Loss: 1.665 Vali Acc: 0.260 Test Loss: 1.665 Test Acc: 0.260
Validation loss decreased (-0.259983 --> -0.259983).  Saving model ...
Epoch: 6 cost time: 1.471336841583252
Epoch: 6, Steps: 4 | Train Loss: 1.516 Vali Loss: 1.643 Vali Acc: 0.280 Test Loss: 1.643 Test Acc: 0.280
Validation loss decreased (-0.259983 --> -0.279984).  Saving model ...
Epoch: 7 cost time: 1.584101915359497
Epoch: 7, Steps: 4 | Train Loss: 1.387 Vali Loss: 1.615 Vali Acc: 0.280 Test Loss: 1.615 Test Acc: 0.280
Validation loss decreased (-0.279984 --> -0.279984).  Saving model ...
Epoch: 8 cost time: 1.4674317836761475
Epoch: 8, Steps: 4 | Train Loss: 1.299 Vali Loss: 1.591 Vali Acc: 0.220 Test Loss: 1.591 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4495508670806885
Epoch: 9, Steps: 4 | Train Loss: 1.253 Vali Loss: 1.561 Vali Acc: 0.260 Test Loss: 1.561 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.4346883296966553
Epoch: 10, Steps: 4 | Train Loss: 1.130 Vali Loss: 1.522 Vali Acc: 0.300 Test Loss: 1.522 Test Acc: 0.300
Validation loss decreased (-0.279984 --> -0.299985).  Saving model ...
Epoch: 11 cost time: 1.579608678817749
Epoch: 11, Steps: 4 | Train Loss: 1.053 Vali Loss: 1.473 Vali Acc: 0.360 Test Loss: 1.473 Test Acc: 0.360
Validation loss decreased (-0.299985 --> -0.359985).  Saving model ...
Epoch: 12 cost time: 1.5462350845336914
Epoch: 12, Steps: 4 | Train Loss: 0.988 Vali Loss: 1.441 Vali Acc: 0.360 Test Loss: 1.441 Test Acc: 0.360
Validation loss decreased (-0.359985 --> -0.359986).  Saving model ...
Epoch: 13 cost time: 1.424849033355713
Epoch: 13, Steps: 4 | Train Loss: 0.936 Vali Loss: 1.402 Vali Acc: 0.340 Test Loss: 1.402 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.5847902297973633
Epoch: 14, Steps: 4 | Train Loss: 0.916 Vali Loss: 1.329 Vali Acc: 0.360 Test Loss: 1.329 Test Acc: 0.360
Validation loss decreased (-0.359986 --> -0.359987).  Saving model ...
Epoch: 15 cost time: 1.3541512489318848
Epoch: 15, Steps: 4 | Train Loss: 0.862 Vali Loss: 1.299 Vali Acc: 0.420 Test Loss: 1.299 Test Acc: 0.420
Validation loss decreased (-0.359987 --> -0.419987).  Saving model ...
Epoch: 16 cost time: 1.4200561046600342
Epoch: 16, Steps: 4 | Train Loss: 0.713 Vali Loss: 1.263 Vali Acc: 0.440 Test Loss: 1.263 Test Acc: 0.440
Validation loss decreased (-0.419987 --> -0.439987).  Saving model ...
Epoch: 17 cost time: 1.523867130279541
Epoch: 17, Steps: 4 | Train Loss: 0.712 Vali Loss: 1.209 Vali Acc: 0.440 Test Loss: 1.209 Test Acc: 0.440
Validation loss decreased (-0.439987 --> -0.439988).  Saving model ...
Epoch: 18 cost time: 1.6472809314727783
Epoch: 18, Steps: 4 | Train Loss: 0.509 Vali Loss: 1.291 Vali Acc: 0.440 Test Loss: 1.291 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.4566304683685303
Epoch: 19, Steps: 4 | Train Loss: 0.496 Vali Loss: 1.204 Vali Acc: 0.400 Test Loss: 1.204 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.4489479064941406
Epoch: 20, Steps: 4 | Train Loss: 0.581 Vali Loss: 1.163 Vali Acc: 0.400 Test Loss: 1.163 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.5759353637695312
Epoch: 21, Steps: 4 | Train Loss: 0.358 Vali Loss: 1.179 Vali Acc: 0.420 Test Loss: 1.179 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.5336265563964844
Epoch: 22, Steps: 4 | Train Loss: 0.296 Vali Loss: 1.251 Vali Acc: 0.360 Test Loss: 1.251 Test Acc: 0.360
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.5291705131530762
Epoch: 23, Steps: 4 | Train Loss: 0.314 Vali Loss: 1.170 Vali Acc: 0.420 Test Loss: 1.170 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.5447375774383545
Epoch: 24, Steps: 4 | Train Loss: 0.395 Vali Loss: 1.269 Vali Acc: 0.380 Test Loss: 1.269 Test Acc: 0.380
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.4974009990692139
Epoch: 25, Steps: 4 | Train Loss: 0.204 Vali Loss: 1.205 Vali Acc: 0.440 Test Loss: 1.205 Test Acc: 0.440
Validation loss decreased (-0.439988 --> -0.439988).  Saving model ...
Epoch: 26 cost time: 1.432152509689331
Epoch: 26, Steps: 4 | Train Loss: 0.225 Vali Loss: 1.249 Vali Acc: 0.480 Test Loss: 1.249 Test Acc: 0.480
Validation loss decreased (-0.439988 --> -0.479988).  Saving model ...
Epoch: 27 cost time: 1.478308916091919
Epoch: 27, Steps: 4 | Train Loss: 0.201 Vali Loss: 1.358 Vali Acc: 0.420 Test Loss: 1.358 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.4973821640014648
Epoch: 28, Steps: 4 | Train Loss: 0.192 Vali Loss: 1.423 Vali Acc: 0.420 Test Loss: 1.423 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.356022596359253
Epoch: 29, Steps: 4 | Train Loss: 0.192 Vali Loss: 1.633 Vali Acc: 0.360 Test Loss: 1.633 Test Acc: 0.360
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.410163164138794
Epoch: 30, Steps: 4 | Train Loss: 0.217 Vali Loss: 1.607 Vali Acc: 0.440 Test Loss: 1.607 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm8_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.48
model parameter : 172637
model size : 0.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm8_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.815601110458374
Epoch: 1, Steps: 4 | Train Loss: 1.639 Vali Loss: 1.853 Vali Acc: 0.160 Test Loss: 1.853 Test Acc: 0.160
Validation loss decreased (inf --> -0.159981).  Saving model ...
Epoch: 2 cost time: 1.4108896255493164
Epoch: 2, Steps: 4 | Train Loss: 1.562 Vali Loss: 1.830 Vali Acc: 0.240 Test Loss: 1.830 Test Acc: 0.240
Validation loss decreased (-0.159981 --> -0.239982).  Saving model ...
Epoch: 3 cost time: 1.468529462814331
Epoch: 3, Steps: 4 | Train Loss: 1.571 Vali Loss: 1.791 Vali Acc: 0.280 Test Loss: 1.791 Test Acc: 0.280
Validation loss decreased (-0.239982 --> -0.279982).  Saving model ...
Epoch: 4 cost time: 1.47711181640625
Epoch: 4, Steps: 4 | Train Loss: 1.645 Vali Loss: 1.747 Vali Acc: 0.260 Test Loss: 1.747 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3785412311553955
Epoch: 5, Steps: 4 | Train Loss: 1.439 Vali Loss: 1.705 Vali Acc: 0.260 Test Loss: 1.705 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.4068467617034912
Epoch: 6, Steps: 4 | Train Loss: 1.300 Vali Loss: 1.670 Vali Acc: 0.300 Test Loss: 1.670 Test Acc: 0.300
Validation loss decreased (-0.279982 --> -0.299983).  Saving model ...
Epoch: 7 cost time: 1.485276699066162
Epoch: 7, Steps: 4 | Train Loss: 1.280 Vali Loss: 1.653 Vali Acc: 0.340 Test Loss: 1.653 Test Acc: 0.340
Validation loss decreased (-0.299983 --> -0.339983).  Saving model ...
Epoch: 8 cost time: 1.5826630592346191
Epoch: 8, Steps: 4 | Train Loss: 1.266 Vali Loss: 1.652 Vali Acc: 0.340 Test Loss: 1.652 Test Acc: 0.340
Validation loss decreased (-0.339983 --> -0.339983).  Saving model ...
Epoch: 9 cost time: 1.4704458713531494
Epoch: 9, Steps: 4 | Train Loss: 1.186 Vali Loss: 1.634 Vali Acc: 0.380 Test Loss: 1.634 Test Acc: 0.380
Validation loss decreased (-0.339983 --> -0.379984).  Saving model ...
Epoch: 10 cost time: 1.5544745922088623
Epoch: 10, Steps: 4 | Train Loss: 1.147 Vali Loss: 1.609 Vali Acc: 0.380 Test Loss: 1.609 Test Acc: 0.380
Validation loss decreased (-0.379984 --> -0.379984).  Saving model ...
Epoch: 11 cost time: 1.481980800628662
Epoch: 11, Steps: 4 | Train Loss: 1.061 Vali Loss: 1.604 Vali Acc: 0.400 Test Loss: 1.604 Test Acc: 0.400
Validation loss decreased (-0.379984 --> -0.399984).  Saving model ...
Epoch: 12 cost time: 1.497769832611084
Epoch: 12, Steps: 4 | Train Loss: 0.980 Vali Loss: 1.582 Vali Acc: 0.420 Test Loss: 1.582 Test Acc: 0.420
Validation loss decreased (-0.399984 --> -0.419984).  Saving model ...
Epoch: 13 cost time: 1.3130736351013184
Epoch: 13, Steps: 4 | Train Loss: 0.913 Vali Loss: 1.593 Vali Acc: 0.440 Test Loss: 1.593 Test Acc: 0.440
Validation loss decreased (-0.419984 --> -0.439984).  Saving model ...
Epoch: 14 cost time: 1.4636552333831787
Epoch: 14, Steps: 4 | Train Loss: 0.877 Vali Loss: 1.619 Vali Acc: 0.400 Test Loss: 1.619 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.5447916984558105
Epoch: 15, Steps: 4 | Train Loss: 0.943 Vali Loss: 1.569 Vali Acc: 0.420 Test Loss: 1.569 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.4676246643066406
Epoch: 16, Steps: 4 | Train Loss: 0.675 Vali Loss: 1.520 Vali Acc: 0.380 Test Loss: 1.520 Test Acc: 0.380
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.5462932586669922
Epoch: 17, Steps: 4 | Train Loss: 0.624 Vali Loss: 1.560 Vali Acc: 0.420 Test Loss: 1.560 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.385319709777832
Epoch: 18, Steps: 4 | Train Loss: 0.533 Vali Loss: 1.513 Vali Acc: 0.460 Test Loss: 1.513 Test Acc: 0.460
Validation loss decreased (-0.439984 --> -0.459985).  Saving model ...
Epoch: 19 cost time: 1.435455083847046
Epoch: 19, Steps: 4 | Train Loss: 0.687 Vali Loss: 1.445 Vali Acc: 0.440 Test Loss: 1.445 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.2671349048614502
Epoch: 20, Steps: 4 | Train Loss: 0.421 Vali Loss: 1.391 Vali Acc: 0.480 Test Loss: 1.391 Test Acc: 0.480
Validation loss decreased (-0.459985 --> -0.479986).  Saving model ...
Epoch: 21 cost time: 1.5391950607299805
Epoch: 21, Steps: 4 | Train Loss: 0.385 Vali Loss: 1.409 Vali Acc: 0.500 Test Loss: 1.409 Test Acc: 0.500
Validation loss decreased (-0.479986 --> -0.499986).  Saving model ...
Epoch: 22 cost time: 1.395596981048584
Epoch: 22, Steps: 4 | Train Loss: 0.303 Vali Loss: 1.405 Vali Acc: 0.460 Test Loss: 1.405 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.5078730583190918
Epoch: 23, Steps: 4 | Train Loss: 0.300 Vali Loss: 1.352 Vali Acc: 0.520 Test Loss: 1.352 Test Acc: 0.520
Validation loss decreased (-0.499986 --> -0.519986).  Saving model ...
Epoch: 24 cost time: 1.4622008800506592
Epoch: 24, Steps: 4 | Train Loss: 0.288 Vali Loss: 1.320 Vali Acc: 0.540 Test Loss: 1.320 Test Acc: 0.540
Validation loss decreased (-0.519986 --> -0.539987).  Saving model ...
Epoch: 25 cost time: 1.3984313011169434
Epoch: 25, Steps: 4 | Train Loss: 0.272 Vali Loss: 1.268 Vali Acc: 0.500 Test Loss: 1.268 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.4867970943450928
Epoch: 26, Steps: 4 | Train Loss: 0.226 Vali Loss: 1.244 Vali Acc: 0.520 Test Loss: 1.244 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.2814087867736816
Epoch: 27, Steps: 4 | Train Loss: 0.271 Vali Loss: 1.255 Vali Acc: 0.520 Test Loss: 1.255 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.544358491897583
Epoch: 28, Steps: 4 | Train Loss: 0.160 Vali Loss: 1.283 Vali Acc: 0.600 Test Loss: 1.283 Test Acc: 0.600
Validation loss decreased (-0.539987 --> -0.599987).  Saving model ...
Epoch: 29 cost time: 1.5259511470794678
Epoch: 29, Steps: 4 | Train Loss: 0.174 Vali Loss: 1.254 Vali Acc: 0.560 Test Loss: 1.254 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.5106897354125977
Epoch: 30, Steps: 4 | Train Loss: 0.144 Vali Loss: 1.245 Vali Acc: 0.540 Test Loss: 1.245 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm8_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 483149
model size : 2.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm8_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.2927966117858887
Epoch: 1, Steps: 4 | Train Loss: 1.707 Vali Loss: 1.710 Vali Acc: 0.140 Test Loss: 1.710 Test Acc: 0.140
Validation loss decreased (inf --> -0.139983).  Saving model ...
Epoch: 2 cost time: 1.2597568035125732
Epoch: 2, Steps: 4 | Train Loss: 1.562 Vali Loss: 1.705 Vali Acc: 0.200 Test Loss: 1.705 Test Acc: 0.200
Validation loss decreased (-0.139983 --> -0.199983).  Saving model ...
Epoch: 3 cost time: 1.2829947471618652
Epoch: 3, Steps: 4 | Train Loss: 1.597 Vali Loss: 1.695 Vali Acc: 0.240 Test Loss: 1.695 Test Acc: 0.240
Validation loss decreased (-0.199983 --> -0.239983).  Saving model ...
Epoch: 4 cost time: 1.2925231456756592
Epoch: 4, Steps: 4 | Train Loss: 1.532 Vali Loss: 1.683 Vali Acc: 0.220 Test Loss: 1.683 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2821569442749023
Epoch: 5, Steps: 4 | Train Loss: 1.469 Vali Loss: 1.656 Vali Acc: 0.220 Test Loss: 1.656 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1999921798706055
Epoch: 6, Steps: 4 | Train Loss: 1.501 Vali Loss: 1.634 Vali Acc: 0.240 Test Loss: 1.634 Test Acc: 0.240
Validation loss decreased (-0.239983 --> -0.239984).  Saving model ...
Epoch: 7 cost time: 1.2744479179382324
Epoch: 7, Steps: 4 | Train Loss: 1.371 Vali Loss: 1.618 Vali Acc: 0.240 Test Loss: 1.618 Test Acc: 0.240
Validation loss decreased (-0.239984 --> -0.239984).  Saving model ...
Epoch: 8 cost time: 1.223863124847412
Epoch: 8, Steps: 4 | Train Loss: 1.298 Vali Loss: 1.594 Vali Acc: 0.240 Test Loss: 1.594 Test Acc: 0.240
Validation loss decreased (-0.239984 --> -0.239984).  Saving model ...
Epoch: 9 cost time: 1.2047443389892578
Epoch: 9, Steps: 4 | Train Loss: 1.251 Vali Loss: 1.554 Vali Acc: 0.300 Test Loss: 1.554 Test Acc: 0.300
Validation loss decreased (-0.239984 --> -0.299984).  Saving model ...
Epoch: 10 cost time: 1.2276997566223145
Epoch: 10, Steps: 4 | Train Loss: 1.121 Vali Loss: 1.510 Vali Acc: 0.260 Test Loss: 1.510 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2382707595825195
Epoch: 11, Steps: 4 | Train Loss: 1.027 Vali Loss: 1.465 Vali Acc: 0.340 Test Loss: 1.465 Test Acc: 0.340
Validation loss decreased (-0.299984 --> -0.339985).  Saving model ...
Epoch: 12 cost time: 1.2934651374816895
Epoch: 12, Steps: 4 | Train Loss: 0.971 Vali Loss: 1.429 Vali Acc: 0.320 Test Loss: 1.429 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1889796257019043
Epoch: 13, Steps: 4 | Train Loss: 0.968 Vali Loss: 1.383 Vali Acc: 0.400 Test Loss: 1.383 Test Acc: 0.400
Validation loss decreased (-0.339985 --> -0.399986).  Saving model ...
Epoch: 14 cost time: 1.3519237041473389
Epoch: 14, Steps: 4 | Train Loss: 0.913 Vali Loss: 1.317 Vali Acc: 0.340 Test Loss: 1.317 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3683702945709229
Epoch: 15, Steps: 4 | Train Loss: 0.878 Vali Loss: 1.277 Vali Acc: 0.380 Test Loss: 1.277 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.2785875797271729
Epoch: 16, Steps: 4 | Train Loss: 0.705 Vali Loss: 1.215 Vali Acc: 0.460 Test Loss: 1.215 Test Acc: 0.460
Validation loss decreased (-0.399986 --> -0.459988).  Saving model ...
Epoch: 17 cost time: 1.2666471004486084
Epoch: 17, Steps: 4 | Train Loss: 0.676 Vali Loss: 1.214 Vali Acc: 0.460 Test Loss: 1.214 Test Acc: 0.460
Validation loss decreased (-0.459988 --> -0.459988).  Saving model ...
Epoch: 18 cost time: 1.2191135883331299
Epoch: 18, Steps: 4 | Train Loss: 0.509 Vali Loss: 1.258 Vali Acc: 0.440 Test Loss: 1.258 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.3451306819915771
Epoch: 19, Steps: 4 | Train Loss: 0.511 Vali Loss: 1.218 Vali Acc: 0.420 Test Loss: 1.218 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.1720056533813477
Epoch: 20, Steps: 4 | Train Loss: 0.583 Vali Loss: 1.211 Vali Acc: 0.400 Test Loss: 1.211 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.242504596710205
Epoch: 21, Steps: 4 | Train Loss: 0.375 Vali Loss: 1.167 Vali Acc: 0.440 Test Loss: 1.167 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.1466317176818848
Epoch: 22, Steps: 4 | Train Loss: 0.290 Vali Loss: 1.283 Vali Acc: 0.400 Test Loss: 1.283 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.1371808052062988
Epoch: 23, Steps: 4 | Train Loss: 0.344 Vali Loss: 1.098 Vali Acc: 0.500 Test Loss: 1.098 Test Acc: 0.500
Validation loss decreased (-0.459988 --> -0.499989).  Saving model ...
Epoch: 24 cost time: 1.1738808155059814
Epoch: 24, Steps: 4 | Train Loss: 0.362 Vali Loss: 1.461 Vali Acc: 0.380 Test Loss: 1.461 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.321514368057251
Epoch: 25, Steps: 4 | Train Loss: 0.282 Vali Loss: 1.409 Vali Acc: 0.400 Test Loss: 1.409 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.2762060165405273
Epoch: 26, Steps: 4 | Train Loss: 0.278 Vali Loss: 1.182 Vali Acc: 0.440 Test Loss: 1.182 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.2642881870269775
Epoch: 27, Steps: 4 | Train Loss: 0.285 Vali Loss: 1.317 Vali Acc: 0.400 Test Loss: 1.317 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.4153656959533691
Epoch: 28, Steps: 4 | Train Loss: 0.197 Vali Loss: 1.517 Vali Acc: 0.360 Test Loss: 1.517 Test Acc: 0.360
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.301198959350586
Epoch: 29, Steps: 4 | Train Loss: 0.217 Vali Loss: 1.312 Vali Acc: 0.460 Test Loss: 1.312 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.384634256362915
Epoch: 30, Steps: 4 | Train Loss: 0.207 Vali Loss: 1.691 Vali Acc: 0.340 Test Loss: 1.691 Test Acc: 0.340
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm8_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.5
model parameter : 172637
model size : 0.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm8_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.790084600448608
Epoch: 1, Steps: 4 | Train Loss: 1.589 Vali Loss: 1.535 Vali Acc: 0.320 Test Loss: 1.535 Test Acc: 0.320
Validation loss decreased (inf --> -0.319985).  Saving model ...
Epoch: 2 cost time: 2.1111857891082764
Epoch: 2, Steps: 4 | Train Loss: 1.574 Vali Loss: 1.534 Vali Acc: 0.340 Test Loss: 1.534 Test Acc: 0.340
Validation loss decreased (-0.319985 --> -0.339985).  Saving model ...
Epoch: 3 cost time: 1.9447636604309082
Epoch: 3, Steps: 4 | Train Loss: 1.498 Vali Loss: 1.543 Vali Acc: 0.300 Test Loss: 1.543 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.051745653152466
Epoch: 4, Steps: 4 | Train Loss: 1.466 Vali Loss: 1.558 Vali Acc: 0.300 Test Loss: 1.558 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.150461196899414
Epoch: 5, Steps: 4 | Train Loss: 1.291 Vali Loss: 1.567 Vali Acc: 0.300 Test Loss: 1.567 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.1049811840057373
Epoch: 6, Steps: 4 | Train Loss: 1.377 Vali Loss: 1.567 Vali Acc: 0.300 Test Loss: 1.567 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.155510902404785
Epoch: 7, Steps: 4 | Train Loss: 1.240 Vali Loss: 1.561 Vali Acc: 0.320 Test Loss: 1.561 Test Acc: 0.320
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.2313780784606934
Epoch: 8, Steps: 4 | Train Loss: 1.152 Vali Loss: 1.539 Vali Acc: 0.360 Test Loss: 1.539 Test Acc: 0.360
Validation loss decreased (-0.339985 --> -0.359985).  Saving model ...
Epoch: 9 cost time: 2.1748218536376953
Epoch: 9, Steps: 4 | Train Loss: 1.185 Vali Loss: 1.513 Vali Acc: 0.340 Test Loss: 1.513 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.0780773162841797
Epoch: 10, Steps: 4 | Train Loss: 1.005 Vali Loss: 1.485 Vali Acc: 0.340 Test Loss: 1.485 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.0524537563323975
Epoch: 11, Steps: 4 | Train Loss: 0.984 Vali Loss: 1.447 Vali Acc: 0.380 Test Loss: 1.447 Test Acc: 0.380
Validation loss decreased (-0.359985 --> -0.379986).  Saving model ...
Epoch: 12 cost time: 2.1199142932891846
Epoch: 12, Steps: 4 | Train Loss: 0.918 Vali Loss: 1.417 Vali Acc: 0.380 Test Loss: 1.417 Test Acc: 0.380
Validation loss decreased (-0.379986 --> -0.379986).  Saving model ...
Epoch: 13 cost time: 2.1775858402252197
Epoch: 13, Steps: 4 | Train Loss: 0.971 Vali Loss: 1.376 Vali Acc: 0.420 Test Loss: 1.376 Test Acc: 0.420
Validation loss decreased (-0.379986 --> -0.419986).  Saving model ...
Epoch: 14 cost time: 2.1220433712005615
Epoch: 14, Steps: 4 | Train Loss: 0.871 Vali Loss: 1.320 Vali Acc: 0.420 Test Loss: 1.320 Test Acc: 0.420
Validation loss decreased (-0.419986 --> -0.419987).  Saving model ...
Epoch: 15 cost time: 2.1753149032592773
Epoch: 15, Steps: 4 | Train Loss: 0.599 Vali Loss: 1.302 Vali Acc: 0.440 Test Loss: 1.302 Test Acc: 0.440
Validation loss decreased (-0.419987 --> -0.439987).  Saving model ...
Epoch: 16 cost time: 2.1777102947235107
Epoch: 16, Steps: 4 | Train Loss: 0.665 Vali Loss: 1.281 Vali Acc: 0.460 Test Loss: 1.281 Test Acc: 0.460
Validation loss decreased (-0.439987 --> -0.459987).  Saving model ...
Epoch: 17 cost time: 2.1113195419311523
Epoch: 17, Steps: 4 | Train Loss: 0.667 Vali Loss: 1.284 Vali Acc: 0.440 Test Loss: 1.284 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.01692795753479
Epoch: 18, Steps: 4 | Train Loss: 0.485 Vali Loss: 1.234 Vali Acc: 0.440 Test Loss: 1.234 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.091154098510742
Epoch: 19, Steps: 4 | Train Loss: 0.414 Vali Loss: 1.192 Vali Acc: 0.460 Test Loss: 1.192 Test Acc: 0.460
Validation loss decreased (-0.459987 --> -0.459988).  Saving model ...
Epoch: 20 cost time: 2.1801538467407227
Epoch: 20, Steps: 4 | Train Loss: 0.434 Vali Loss: 1.120 Vali Acc: 0.520 Test Loss: 1.120 Test Acc: 0.520
Validation loss decreased (-0.459988 --> -0.519989).  Saving model ...
Epoch: 21 cost time: 2.0891880989074707
Epoch: 21, Steps: 4 | Train Loss: 0.335 Vali Loss: 1.143 Vali Acc: 0.540 Test Loss: 1.143 Test Acc: 0.540
Validation loss decreased (-0.519989 --> -0.539989).  Saving model ...
Epoch: 22 cost time: 2.150698661804199
Epoch: 22, Steps: 4 | Train Loss: 0.367 Vali Loss: 1.132 Vali Acc: 0.540 Test Loss: 1.132 Test Acc: 0.540
Validation loss decreased (-0.539989 --> -0.539989).  Saving model ...
Epoch: 23 cost time: 2.129746913909912
Epoch: 23, Steps: 4 | Train Loss: 0.254 Vali Loss: 1.131 Vali Acc: 0.500 Test Loss: 1.131 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.2269580364227295
Epoch: 24, Steps: 4 | Train Loss: 0.271 Vali Loss: 1.273 Vali Acc: 0.460 Test Loss: 1.273 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.2168238162994385
Epoch: 25, Steps: 4 | Train Loss: 0.294 Vali Loss: 1.153 Vali Acc: 0.520 Test Loss: 1.153 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.155461311340332
Epoch: 26, Steps: 4 | Train Loss: 0.217 Vali Loss: 1.065 Vali Acc: 0.540 Test Loss: 1.065 Test Acc: 0.540
Validation loss decreased (-0.539989 --> -0.539989).  Saving model ...
Epoch: 27 cost time: 2.1149492263793945
Epoch: 27, Steps: 4 | Train Loss: 0.180 Vali Loss: 1.241 Vali Acc: 0.520 Test Loss: 1.241 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.3055710792541504
Epoch: 28, Steps: 4 | Train Loss: 0.180 Vali Loss: 1.303 Vali Acc: 0.460 Test Loss: 1.303 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.1493422985076904
Epoch: 29, Steps: 4 | Train Loss: 0.193 Vali Loss: 1.147 Vali Acc: 0.520 Test Loss: 1.147 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.306652545928955
Epoch: 30, Steps: 4 | Train Loss: 0.164 Vali Loss: 1.053 Vali Acc: 0.540 Test Loss: 1.053 Test Acc: 0.540
Validation loss decreased (-0.539989 --> -0.539989).  Saving model ...
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm8_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 263213
model size : 1.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm8_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.122546195983887
Epoch: 1, Steps: 4 | Train Loss: 1.674 Vali Loss: 1.635 Vali Acc: 0.240 Test Loss: 1.635 Test Acc: 0.240
Validation loss decreased (inf --> -0.239984).  Saving model ...
Epoch: 2 cost time: 1.7729449272155762
Epoch: 2, Steps: 4 | Train Loss: 1.697 Vali Loss: 1.619 Vali Acc: 0.260 Test Loss: 1.619 Test Acc: 0.260
Validation loss decreased (-0.239984 --> -0.259984).  Saving model ...
Epoch: 3 cost time: 1.7916834354400635
Epoch: 3, Steps: 4 | Train Loss: 1.619 Vali Loss: 1.602 Vali Acc: 0.280 Test Loss: 1.602 Test Acc: 0.280
Validation loss decreased (-0.259984 --> -0.279984).  Saving model ...
Epoch: 4 cost time: 1.7201082706451416
Epoch: 4, Steps: 4 | Train Loss: 1.607 Vali Loss: 1.580 Vali Acc: 0.260 Test Loss: 1.580 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6760351657867432
Epoch: 5, Steps: 4 | Train Loss: 1.463 Vali Loss: 1.565 Vali Acc: 0.260 Test Loss: 1.565 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.873105525970459
Epoch: 6, Steps: 4 | Train Loss: 1.480 Vali Loss: 1.544 Vali Acc: 0.260 Test Loss: 1.544 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.725313663482666
Epoch: 7, Steps: 4 | Train Loss: 1.485 Vali Loss: 1.528 Vali Acc: 0.260 Test Loss: 1.528 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.6483256816864014
Epoch: 8, Steps: 4 | Train Loss: 1.281 Vali Loss: 1.501 Vali Acc: 0.260 Test Loss: 1.501 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.7052803039550781
Epoch: 9, Steps: 4 | Train Loss: 1.193 Vali Loss: 1.470 Vali Acc: 0.320 Test Loss: 1.470 Test Acc: 0.320
Validation loss decreased (-0.279984 --> -0.319985).  Saving model ...
Epoch: 10 cost time: 1.5882470607757568
Epoch: 10, Steps: 4 | Train Loss: 1.178 Vali Loss: 1.432 Vali Acc: 0.260 Test Loss: 1.432 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5652577877044678
Epoch: 11, Steps: 4 | Train Loss: 1.098 Vali Loss: 1.377 Vali Acc: 0.320 Test Loss: 1.377 Test Acc: 0.320
Validation loss decreased (-0.319985 --> -0.319986).  Saving model ...
Epoch: 12 cost time: 1.5105209350585938
Epoch: 12, Steps: 4 | Train Loss: 0.978 Vali Loss: 1.326 Vali Acc: 0.320 Test Loss: 1.326 Test Acc: 0.320
Validation loss decreased (-0.319986 --> -0.319987).  Saving model ...
Epoch: 13 cost time: 1.4973304271697998
Epoch: 13, Steps: 4 | Train Loss: 0.974 Vali Loss: 1.287 Vali Acc: 0.360 Test Loss: 1.287 Test Acc: 0.360
Validation loss decreased (-0.319987 --> -0.359987).  Saving model ...
Epoch: 14 cost time: 1.4657411575317383
Epoch: 14, Steps: 4 | Train Loss: 0.744 Vali Loss: 1.255 Vali Acc: 0.360 Test Loss: 1.255 Test Acc: 0.360
Validation loss decreased (-0.359987 --> -0.359987).  Saving model ...
Epoch: 15 cost time: 1.6031076908111572
Epoch: 15, Steps: 4 | Train Loss: 0.820 Vali Loss: 1.215 Vali Acc: 0.380 Test Loss: 1.215 Test Acc: 0.380
Validation loss decreased (-0.359987 --> -0.379988).  Saving model ...
Epoch: 16 cost time: 1.8521595001220703
Epoch: 16, Steps: 4 | Train Loss: 0.715 Vali Loss: 1.177 Vali Acc: 0.400 Test Loss: 1.177 Test Acc: 0.400
Validation loss decreased (-0.379988 --> -0.399988).  Saving model ...
Epoch: 17 cost time: 1.848677635192871
Epoch: 17, Steps: 4 | Train Loss: 0.623 Vali Loss: 1.167 Vali Acc: 0.420 Test Loss: 1.167 Test Acc: 0.420
Validation loss decreased (-0.399988 --> -0.419988).  Saving model ...
Epoch: 18 cost time: 1.8826980590820312
Epoch: 18, Steps: 4 | Train Loss: 0.601 Vali Loss: 1.163 Vali Acc: 0.460 Test Loss: 1.163 Test Acc: 0.460
Validation loss decreased (-0.419988 --> -0.459988).  Saving model ...
Epoch: 19 cost time: 1.9049153327941895
Epoch: 19, Steps: 4 | Train Loss: 0.426 Vali Loss: 1.150 Vali Acc: 0.440 Test Loss: 1.150 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.9337241649627686
Epoch: 20, Steps: 4 | Train Loss: 0.416 Vali Loss: 1.159 Vali Acc: 0.440 Test Loss: 1.159 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.8727748394012451
Epoch: 21, Steps: 4 | Train Loss: 0.403 Vali Loss: 1.152 Vali Acc: 0.440 Test Loss: 1.152 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.912198781967163
Epoch: 22, Steps: 4 | Train Loss: 0.431 Vali Loss: 1.152 Vali Acc: 0.440 Test Loss: 1.152 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.8452074527740479
Epoch: 23, Steps: 4 | Train Loss: 0.346 Vali Loss: 1.163 Vali Acc: 0.400 Test Loss: 1.163 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.8913872241973877
Epoch: 24, Steps: 4 | Train Loss: 0.320 Vali Loss: 1.162 Vali Acc: 0.400 Test Loss: 1.162 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.8305792808532715
Epoch: 25, Steps: 4 | Train Loss: 0.335 Vali Loss: 1.115 Vali Acc: 0.420 Test Loss: 1.115 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.7158880233764648
Epoch: 26, Steps: 4 | Train Loss: 0.239 Vali Loss: 1.190 Vali Acc: 0.440 Test Loss: 1.190 Test Acc: 0.440
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.615522861480713
Epoch: 27, Steps: 4 | Train Loss: 0.180 Vali Loss: 1.074 Vali Acc: 0.500 Test Loss: 1.074 Test Acc: 0.500
Validation loss decreased (-0.459988 --> -0.499989).  Saving model ...
Epoch: 28 cost time: 1.6728339195251465
Epoch: 28, Steps: 4 | Train Loss: 0.200 Vali Loss: 1.095 Vali Acc: 0.480 Test Loss: 1.095 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.8510973453521729
Epoch: 29, Steps: 4 | Train Loss: 0.212 Vali Loss: 1.177 Vali Acc: 0.500 Test Loss: 1.177 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.773057460784912
Epoch: 30, Steps: 4 | Train Loss: 0.168 Vali Loss: 1.142 Vali Acc: 0.480 Test Loss: 1.142 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm8_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.5
model parameter : 107933
model size : 0.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm8_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.335047483444214
Epoch: 1, Steps: 4 | Train Loss: 1.591 Vali Loss: 1.538 Vali Acc: 0.320 Test Loss: 1.538 Test Acc: 0.320
Validation loss decreased (inf --> -0.319985).  Saving model ...
Epoch: 2 cost time: 1.7922775745391846
Epoch: 2, Steps: 4 | Train Loss: 1.575 Vali Loss: 1.538 Vali Acc: 0.340 Test Loss: 1.538 Test Acc: 0.340
Validation loss decreased (-0.319985 --> -0.339985).  Saving model ...
Epoch: 3 cost time: 1.7374978065490723
Epoch: 3, Steps: 4 | Train Loss: 1.498 Vali Loss: 1.548 Vali Acc: 0.280 Test Loss: 1.548 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6131317615509033
Epoch: 4, Steps: 4 | Train Loss: 1.468 Vali Loss: 1.563 Vali Acc: 0.300 Test Loss: 1.563 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.580040454864502
Epoch: 5, Steps: 4 | Train Loss: 1.283 Vali Loss: 1.568 Vali Acc: 0.300 Test Loss: 1.568 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.6783852577209473
Epoch: 6, Steps: 4 | Train Loss: 1.378 Vali Loss: 1.568 Vali Acc: 0.300 Test Loss: 1.568 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.6482751369476318
Epoch: 7, Steps: 4 | Train Loss: 1.257 Vali Loss: 1.563 Vali Acc: 0.320 Test Loss: 1.563 Test Acc: 0.320
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.885676383972168
Epoch: 8, Steps: 4 | Train Loss: 1.150 Vali Loss: 1.540 Vali Acc: 0.340 Test Loss: 1.540 Test Acc: 0.340
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.6537210941314697
Epoch: 9, Steps: 4 | Train Loss: 1.193 Vali Loss: 1.512 Vali Acc: 0.320 Test Loss: 1.512 Test Acc: 0.320
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.6605663299560547
Epoch: 10, Steps: 4 | Train Loss: 1.008 Vali Loss: 1.478 Vali Acc: 0.340 Test Loss: 1.478 Test Acc: 0.340
Validation loss decreased (-0.339985 --> -0.339985).  Saving model ...
Epoch: 11 cost time: 1.621934175491333
Epoch: 11, Steps: 4 | Train Loss: 1.027 Vali Loss: 1.434 Vali Acc: 0.380 Test Loss: 1.434 Test Acc: 0.380
Validation loss decreased (-0.339985 --> -0.379986).  Saving model ...
Epoch: 12 cost time: 1.405393362045288
Epoch: 12, Steps: 4 | Train Loss: 0.915 Vali Loss: 1.402 Vali Acc: 0.380 Test Loss: 1.402 Test Acc: 0.380
Validation loss decreased (-0.379986 --> -0.379986).  Saving model ...
Epoch: 13 cost time: 1.5078282356262207
Epoch: 13, Steps: 4 | Train Loss: 0.962 Vali Loss: 1.362 Vali Acc: 0.460 Test Loss: 1.362 Test Acc: 0.460
Validation loss decreased (-0.379986 --> -0.459986).  Saving model ...
Epoch: 14 cost time: 1.742924451828003
Epoch: 14, Steps: 4 | Train Loss: 0.858 Vali Loss: 1.312 Vali Acc: 0.420 Test Loss: 1.312 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.5816097259521484
Epoch: 15, Steps: 4 | Train Loss: 0.590 Vali Loss: 1.288 Vali Acc: 0.460 Test Loss: 1.288 Test Acc: 0.460
Validation loss decreased (-0.459986 --> -0.459987).  Saving model ...
Epoch: 16 cost time: 1.5689325332641602
Epoch: 16, Steps: 4 | Train Loss: 0.645 Vali Loss: 1.261 Vali Acc: 0.460 Test Loss: 1.261 Test Acc: 0.460
Validation loss decreased (-0.459987 --> -0.459987).  Saving model ...
Epoch: 17 cost time: 1.7933919429779053
Epoch: 17, Steps: 4 | Train Loss: 0.639 Vali Loss: 1.260 Vali Acc: 0.440 Test Loss: 1.260 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.589961051940918
Epoch: 18, Steps: 4 | Train Loss: 0.471 Vali Loss: 1.208 Vali Acc: 0.440 Test Loss: 1.208 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.6414456367492676
Epoch: 19, Steps: 4 | Train Loss: 0.391 Vali Loss: 1.162 Vali Acc: 0.460 Test Loss: 1.162 Test Acc: 0.460
Validation loss decreased (-0.459987 --> -0.459988).  Saving model ...
Epoch: 20 cost time: 1.5068223476409912
Epoch: 20, Steps: 4 | Train Loss: 0.411 Vali Loss: 1.101 Vali Acc: 0.520 Test Loss: 1.101 Test Acc: 0.520
Validation loss decreased (-0.459988 --> -0.519989).  Saving model ...
Epoch: 21 cost time: 1.6843476295471191
Epoch: 21, Steps: 4 | Train Loss: 0.318 Vali Loss: 1.130 Vali Acc: 0.540 Test Loss: 1.130 Test Acc: 0.540
Validation loss decreased (-0.519989 --> -0.539989).  Saving model ...
Epoch: 22 cost time: 1.7639658451080322
Epoch: 22, Steps: 4 | Train Loss: 0.367 Vali Loss: 1.113 Vali Acc: 0.500 Test Loss: 1.113 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.6014883518218994
Epoch: 23, Steps: 4 | Train Loss: 0.260 Vali Loss: 1.097 Vali Acc: 0.480 Test Loss: 1.097 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.7711966037750244
Epoch: 24, Steps: 4 | Train Loss: 0.284 Vali Loss: 1.227 Vali Acc: 0.500 Test Loss: 1.227 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.7062935829162598
Epoch: 25, Steps: 4 | Train Loss: 0.307 Vali Loss: 1.211 Vali Acc: 0.520 Test Loss: 1.211 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.9289989471435547
Epoch: 26, Steps: 4 | Train Loss: 0.207 Vali Loss: 1.057 Vali Acc: 0.540 Test Loss: 1.057 Test Acc: 0.540
Validation loss decreased (-0.539989 --> -0.539989).  Saving model ...
Epoch: 27 cost time: 1.7346718311309814
Epoch: 27, Steps: 4 | Train Loss: 0.149 Vali Loss: 1.194 Vali Acc: 0.520 Test Loss: 1.194 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.6856420040130615
Epoch: 28, Steps: 4 | Train Loss: 0.171 Vali Loss: 1.262 Vali Acc: 0.480 Test Loss: 1.262 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.7091915607452393
Epoch: 29, Steps: 4 | Train Loss: 0.181 Vali Loss: 1.155 Vali Acc: 0.520 Test Loss: 1.155 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.4877676963806152
Epoch: 30, Steps: 4 | Train Loss: 0.151 Vali Loss: 1.151 Vali Acc: 0.560 Test Loss: 1.151 Test Acc: 0.560
Validation loss decreased (-0.539989 --> -0.559988).  Saving model ...
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm8_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 263213
model size : 1.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm8_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.7160046100616455
Epoch: 1, Steps: 4 | Train Loss: 1.681 Vali Loss: 1.627 Vali Acc: 0.220 Test Loss: 1.627 Test Acc: 0.220
Validation loss decreased (inf --> -0.219984).  Saving model ...
Epoch: 2 cost time: 1.5277612209320068
Epoch: 2, Steps: 4 | Train Loss: 1.703 Vali Loss: 1.614 Vali Acc: 0.220 Test Loss: 1.614 Test Acc: 0.220
Validation loss decreased (-0.219984 --> -0.219984).  Saving model ...
Epoch: 3 cost time: 1.3241746425628662
Epoch: 3, Steps: 4 | Train Loss: 1.620 Vali Loss: 1.597 Vali Acc: 0.260 Test Loss: 1.597 Test Acc: 0.260
Validation loss decreased (-0.219984 --> -0.259984).  Saving model ...
Epoch: 4 cost time: 1.502610445022583
Epoch: 4, Steps: 4 | Train Loss: 1.604 Vali Loss: 1.583 Vali Acc: 0.260 Test Loss: 1.583 Test Acc: 0.260
Validation loss decreased (-0.259984 --> -0.259984).  Saving model ...
Epoch: 5 cost time: 1.3483095169067383
Epoch: 5, Steps: 4 | Train Loss: 1.466 Vali Loss: 1.564 Vali Acc: 0.260 Test Loss: 1.564 Test Acc: 0.260
Validation loss decreased (-0.259984 --> -0.259984).  Saving model ...
Epoch: 6 cost time: 1.5001153945922852
Epoch: 6, Steps: 4 | Train Loss: 1.483 Vali Loss: 1.550 Vali Acc: 0.260 Test Loss: 1.550 Test Acc: 0.260
Validation loss decreased (-0.259984 --> -0.259984).  Saving model ...
Epoch: 7 cost time: 1.4401519298553467
Epoch: 7, Steps: 4 | Train Loss: 1.495 Vali Loss: 1.535 Vali Acc: 0.240 Test Loss: 1.535 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.248279094696045
Epoch: 8, Steps: 4 | Train Loss: 1.294 Vali Loss: 1.506 Vali Acc: 0.260 Test Loss: 1.506 Test Acc: 0.260
Validation loss decreased (-0.259984 --> -0.259985).  Saving model ...
Epoch: 9 cost time: 1.4274489879608154
Epoch: 9, Steps: 4 | Train Loss: 1.212 Vali Loss: 1.474 Vali Acc: 0.280 Test Loss: 1.474 Test Acc: 0.280
Validation loss decreased (-0.259985 --> -0.279985).  Saving model ...
Epoch: 10 cost time: 1.3867530822753906
Epoch: 10, Steps: 4 | Train Loss: 1.198 Vali Loss: 1.441 Vali Acc: 0.240 Test Loss: 1.441 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.557023286819458
Epoch: 11, Steps: 4 | Train Loss: 1.112 Vali Loss: 1.390 Vali Acc: 0.300 Test Loss: 1.390 Test Acc: 0.300
Validation loss decreased (-0.279985 --> -0.299986).  Saving model ...
Epoch: 12 cost time: 1.6596565246582031
Epoch: 12, Steps: 4 | Train Loss: 1.000 Vali Loss: 1.341 Vali Acc: 0.340 Test Loss: 1.341 Test Acc: 0.340
Validation loss decreased (-0.299986 --> -0.339987).  Saving model ...
Epoch: 13 cost time: 1.5232799053192139
Epoch: 13, Steps: 4 | Train Loss: 0.979 Vali Loss: 1.300 Vali Acc: 0.360 Test Loss: 1.300 Test Acc: 0.360
Validation loss decreased (-0.339987 --> -0.359987).  Saving model ...
Epoch: 14 cost time: 1.590578317642212
Epoch: 14, Steps: 4 | Train Loss: 0.762 Vali Loss: 1.269 Vali Acc: 0.340 Test Loss: 1.269 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.475691318511963
Epoch: 15, Steps: 4 | Train Loss: 0.836 Vali Loss: 1.226 Vali Acc: 0.380 Test Loss: 1.226 Test Acc: 0.380
Validation loss decreased (-0.359987 --> -0.379988).  Saving model ...
Epoch: 16 cost time: 1.3989570140838623
Epoch: 16, Steps: 4 | Train Loss: 0.729 Vali Loss: 1.188 Vali Acc: 0.400 Test Loss: 1.188 Test Acc: 0.400
Validation loss decreased (-0.379988 --> -0.399988).  Saving model ...
Epoch: 17 cost time: 1.535668134689331
Epoch: 17, Steps: 4 | Train Loss: 0.622 Vali Loss: 1.185 Vali Acc: 0.400 Test Loss: 1.185 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 18 cost time: 1.3357305526733398
Epoch: 18, Steps: 4 | Train Loss: 0.651 Vali Loss: 1.189 Vali Acc: 0.420 Test Loss: 1.189 Test Acc: 0.420
Validation loss decreased (-0.399988 --> -0.419988).  Saving model ...
Epoch: 19 cost time: 1.4203510284423828
Epoch: 19, Steps: 4 | Train Loss: 0.438 Vali Loss: 1.174 Vali Acc: 0.440 Test Loss: 1.174 Test Acc: 0.440
Validation loss decreased (-0.419988 --> -0.439988).  Saving model ...
Epoch: 20 cost time: 1.651221513748169
Epoch: 20, Steps: 4 | Train Loss: 0.425 Vali Loss: 1.189 Vali Acc: 0.420 Test Loss: 1.189 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.6251237392425537
Epoch: 21, Steps: 4 | Train Loss: 0.434 Vali Loss: 1.197 Vali Acc: 0.440 Test Loss: 1.197 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.6885416507720947
Epoch: 22, Steps: 4 | Train Loss: 0.417 Vali Loss: 1.198 Vali Acc: 0.400 Test Loss: 1.198 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.5912859439849854
Epoch: 23, Steps: 4 | Train Loss: 0.341 Vali Loss: 1.172 Vali Acc: 0.460 Test Loss: 1.172 Test Acc: 0.460
Validation loss decreased (-0.439988 --> -0.459988).  Saving model ...
Epoch: 24 cost time: 1.545011043548584
Epoch: 24, Steps: 4 | Train Loss: 0.325 Vali Loss: 1.145 Vali Acc: 0.440 Test Loss: 1.145 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.5459365844726562
Epoch: 25, Steps: 4 | Train Loss: 0.352 Vali Loss: 1.119 Vali Acc: 0.460 Test Loss: 1.119 Test Acc: 0.460
Validation loss decreased (-0.459988 --> -0.459989).  Saving model ...
Epoch: 26 cost time: 1.5263116359710693
Epoch: 26, Steps: 4 | Train Loss: 0.233 Vali Loss: 1.175 Vali Acc: 0.440 Test Loss: 1.175 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.4757850170135498
Epoch: 27, Steps: 4 | Train Loss: 0.181 Vali Loss: 1.107 Vali Acc: 0.480 Test Loss: 1.107 Test Acc: 0.480
Validation loss decreased (-0.459989 --> -0.479989).  Saving model ...
Epoch: 28 cost time: 1.3966784477233887
Epoch: 28, Steps: 4 | Train Loss: 0.189 Vali Loss: 1.148 Vali Acc: 0.480 Test Loss: 1.148 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.4564886093139648
Epoch: 29, Steps: 4 | Train Loss: 0.230 Vali Loss: 1.229 Vali Acc: 0.460 Test Loss: 1.229 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.4795546531677246
Epoch: 30, Steps: 4 | Train Loss: 0.197 Vali Loss: 1.124 Vali Acc: 0.480 Test Loss: 1.124 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm8_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.48
model parameter : 107933
model size : 0.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm8_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.730767011642456
Epoch: 1, Steps: 4 | Train Loss: 1.595 Vali Loss: 1.528 Vali Acc: 0.360 Test Loss: 1.528 Test Acc: 0.360
Validation loss decreased (inf --> -0.359985).  Saving model ...
Epoch: 2 cost time: 1.7063188552856445
Epoch: 2, Steps: 4 | Train Loss: 1.578 Vali Loss: 1.526 Vali Acc: 0.380 Test Loss: 1.526 Test Acc: 0.380
Validation loss decreased (-0.359985 --> -0.379985).  Saving model ...
Epoch: 3 cost time: 1.457646369934082
Epoch: 3, Steps: 4 | Train Loss: 1.507 Vali Loss: 1.534 Vali Acc: 0.300 Test Loss: 1.534 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4406332969665527
Epoch: 4, Steps: 4 | Train Loss: 1.478 Vali Loss: 1.547 Vali Acc: 0.300 Test Loss: 1.547 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.59375
Epoch: 5, Steps: 4 | Train Loss: 1.291 Vali Loss: 1.557 Vali Acc: 0.300 Test Loss: 1.557 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.5510847568511963
Epoch: 6, Steps: 4 | Train Loss: 1.383 Vali Loss: 1.560 Vali Acc: 0.280 Test Loss: 1.560 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.4595236778259277
Epoch: 7, Steps: 4 | Train Loss: 1.240 Vali Loss: 1.559 Vali Acc: 0.320 Test Loss: 1.559 Test Acc: 0.320
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.6604068279266357
Epoch: 8, Steps: 4 | Train Loss: 1.152 Vali Loss: 1.540 Vali Acc: 0.320 Test Loss: 1.540 Test Acc: 0.320
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.489140272140503
Epoch: 9, Steps: 4 | Train Loss: 1.194 Vali Loss: 1.513 Vali Acc: 0.340 Test Loss: 1.513 Test Acc: 0.340
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.384568214416504
Epoch: 10, Steps: 4 | Train Loss: 1.011 Vali Loss: 1.479 Vali Acc: 0.340 Test Loss: 1.479 Test Acc: 0.340
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.4255759716033936
Epoch: 11, Steps: 4 | Train Loss: 1.001 Vali Loss: 1.439 Vali Acc: 0.400 Test Loss: 1.439 Test Acc: 0.400
Validation loss decreased (-0.379985 --> -0.399986).  Saving model ...
Epoch: 12 cost time: 1.533581256866455
Epoch: 12, Steps: 4 | Train Loss: 0.911 Vali Loss: 1.411 Vali Acc: 0.420 Test Loss: 1.411 Test Acc: 0.420
Validation loss decreased (-0.399986 --> -0.419986).  Saving model ...
Epoch: 13 cost time: 1.3821489810943604
Epoch: 13, Steps: 4 | Train Loss: 0.963 Vali Loss: 1.374 Vali Acc: 0.400 Test Loss: 1.374 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4895455837249756
Epoch: 14, Steps: 4 | Train Loss: 0.863 Vali Loss: 1.315 Vali Acc: 0.380 Test Loss: 1.315 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.362818717956543
Epoch: 15, Steps: 4 | Train Loss: 0.604 Vali Loss: 1.292 Vali Acc: 0.440 Test Loss: 1.292 Test Acc: 0.440
Validation loss decreased (-0.419986 --> -0.439987).  Saving model ...
Epoch: 16 cost time: 1.4622197151184082
Epoch: 16, Steps: 4 | Train Loss: 0.650 Vali Loss: 1.266 Vali Acc: 0.480 Test Loss: 1.266 Test Acc: 0.480
Validation loss decreased (-0.439987 --> -0.479987).  Saving model ...
Epoch: 17 cost time: 1.5750882625579834
Epoch: 17, Steps: 4 | Train Loss: 0.640 Vali Loss: 1.260 Vali Acc: 0.480 Test Loss: 1.260 Test Acc: 0.480
Validation loss decreased (-0.479987 --> -0.479987).  Saving model ...
Epoch: 18 cost time: 1.4885451793670654
Epoch: 18, Steps: 4 | Train Loss: 0.504 Vali Loss: 1.212 Vali Acc: 0.460 Test Loss: 1.212 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.6325719356536865
Epoch: 19, Steps: 4 | Train Loss: 0.425 Vali Loss: 1.172 Vali Acc: 0.480 Test Loss: 1.172 Test Acc: 0.480
Validation loss decreased (-0.479987 --> -0.479988).  Saving model ...
Epoch: 20 cost time: 1.3610186576843262
Epoch: 20, Steps: 4 | Train Loss: 0.434 Vali Loss: 1.120 Vali Acc: 0.520 Test Loss: 1.120 Test Acc: 0.520
Validation loss decreased (-0.479988 --> -0.519989).  Saving model ...
Epoch: 21 cost time: 1.511014461517334
Epoch: 21, Steps: 4 | Train Loss: 0.353 Vali Loss: 1.129 Vali Acc: 0.540 Test Loss: 1.129 Test Acc: 0.540
Validation loss decreased (-0.519989 --> -0.539989).  Saving model ...
Epoch: 22 cost time: 1.5981411933898926
Epoch: 22, Steps: 4 | Train Loss: 0.342 Vali Loss: 1.103 Vali Acc: 0.520 Test Loss: 1.103 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.6588079929351807
Epoch: 23, Steps: 4 | Train Loss: 0.258 Vali Loss: 1.106 Vali Acc: 0.520 Test Loss: 1.106 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.527867078781128
Epoch: 24, Steps: 4 | Train Loss: 0.332 Vali Loss: 1.206 Vali Acc: 0.520 Test Loss: 1.206 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.4776654243469238
Epoch: 25, Steps: 4 | Train Loss: 0.299 Vali Loss: 1.099 Vali Acc: 0.560 Test Loss: 1.099 Test Acc: 0.560
Validation loss decreased (-0.539989 --> -0.559989).  Saving model ...
Epoch: 26 cost time: 1.5942423343658447
Epoch: 26, Steps: 4 | Train Loss: 0.226 Vali Loss: 1.046 Vali Acc: 0.560 Test Loss: 1.046 Test Acc: 0.560
Validation loss decreased (-0.559989 --> -0.559990).  Saving model ...
Epoch: 27 cost time: 1.5620756149291992
Epoch: 27, Steps: 4 | Train Loss: 0.210 Vali Loss: 1.224 Vali Acc: 0.500 Test Loss: 1.224 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.5773475170135498
Epoch: 28, Steps: 4 | Train Loss: 0.231 Vali Loss: 1.341 Vali Acc: 0.460 Test Loss: 1.341 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.5475294589996338
Epoch: 29, Steps: 4 | Train Loss: 0.253 Vali Loss: 1.218 Vali Acc: 0.480 Test Loss: 1.218 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.4922237396240234
Epoch: 30, Steps: 4 | Train Loss: 0.213 Vali Loss: 1.072 Vali Acc: 0.480 Test Loss: 1.072 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm8_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 263213
model size : 1.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm8_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.452943801879883
Epoch: 1, Steps: 4 | Train Loss: 1.696 Vali Loss: 1.637 Vali Acc: 0.240 Test Loss: 1.637 Test Acc: 0.240
Validation loss decreased (inf --> -0.239984).  Saving model ...
Epoch: 2 cost time: 1.5596985816955566
Epoch: 2, Steps: 4 | Train Loss: 1.705 Vali Loss: 1.625 Vali Acc: 0.220 Test Loss: 1.625 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6170353889465332
Epoch: 3, Steps: 4 | Train Loss: 1.615 Vali Loss: 1.608 Vali Acc: 0.240 Test Loss: 1.608 Test Acc: 0.240
Validation loss decreased (-0.239984 --> -0.239984).  Saving model ...
Epoch: 4 cost time: 1.5536017417907715
Epoch: 4, Steps: 4 | Train Loss: 1.622 Vali Loss: 1.595 Vali Acc: 0.280 Test Loss: 1.595 Test Acc: 0.280
Validation loss decreased (-0.239984 --> -0.279984).  Saving model ...
Epoch: 5 cost time: 1.4065744876861572
Epoch: 5, Steps: 4 | Train Loss: 1.491 Vali Loss: 1.577 Vali Acc: 0.260 Test Loss: 1.577 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.4094915390014648
Epoch: 6, Steps: 4 | Train Loss: 1.498 Vali Loss: 1.564 Vali Acc: 0.280 Test Loss: 1.564 Test Acc: 0.280
Validation loss decreased (-0.279984 --> -0.279984).  Saving model ...
Epoch: 7 cost time: 1.5004947185516357
Epoch: 7, Steps: 4 | Train Loss: 1.504 Vali Loss: 1.548 Vali Acc: 0.280 Test Loss: 1.548 Test Acc: 0.280
Validation loss decreased (-0.279984 --> -0.279985).  Saving model ...
Epoch: 8 cost time: 1.5440974235534668
Epoch: 8, Steps: 4 | Train Loss: 1.308 Vali Loss: 1.522 Vali Acc: 0.280 Test Loss: 1.522 Test Acc: 0.280
Validation loss decreased (-0.279985 --> -0.279985).  Saving model ...
Epoch: 9 cost time: 1.544461727142334
Epoch: 9, Steps: 4 | Train Loss: 1.214 Vali Loss: 1.490 Vali Acc: 0.300 Test Loss: 1.490 Test Acc: 0.300
Validation loss decreased (-0.279985 --> -0.299985).  Saving model ...
Epoch: 10 cost time: 1.455949068069458
Epoch: 10, Steps: 4 | Train Loss: 1.223 Vali Loss: 1.439 Vali Acc: 0.280 Test Loss: 1.439 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5151817798614502
Epoch: 11, Steps: 4 | Train Loss: 1.109 Vali Loss: 1.384 Vali Acc: 0.300 Test Loss: 1.384 Test Acc: 0.300
Validation loss decreased (-0.299985 --> -0.299986).  Saving model ...
Epoch: 12 cost time: 1.5495038032531738
Epoch: 12, Steps: 4 | Train Loss: 1.032 Vali Loss: 1.329 Vali Acc: 0.300 Test Loss: 1.329 Test Acc: 0.300
Validation loss decreased (-0.299986 --> -0.299987).  Saving model ...
Epoch: 13 cost time: 1.4075355529785156
Epoch: 13, Steps: 4 | Train Loss: 1.005 Vali Loss: 1.281 Vali Acc: 0.300 Test Loss: 1.281 Test Acc: 0.300
Validation loss decreased (-0.299987 --> -0.299987).  Saving model ...
Epoch: 14 cost time: 1.5081124305725098
Epoch: 14, Steps: 4 | Train Loss: 0.792 Vali Loss: 1.247 Vali Acc: 0.360 Test Loss: 1.247 Test Acc: 0.360
Validation loss decreased (-0.299987 --> -0.359988).  Saving model ...
Epoch: 15 cost time: 1.3938791751861572
Epoch: 15, Steps: 4 | Train Loss: 0.868 Vali Loss: 1.209 Vali Acc: 0.400 Test Loss: 1.209 Test Acc: 0.400
Validation loss decreased (-0.359988 --> -0.399988).  Saving model ...
Epoch: 16 cost time: 1.3651583194732666
Epoch: 16, Steps: 4 | Train Loss: 0.789 Vali Loss: 1.194 Vali Acc: 0.420 Test Loss: 1.194 Test Acc: 0.420
Validation loss decreased (-0.399988 --> -0.419988).  Saving model ...
Epoch: 17 cost time: 1.544130802154541
Epoch: 17, Steps: 4 | Train Loss: 0.683 Vali Loss: 1.195 Vali Acc: 0.360 Test Loss: 1.195 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.447519063949585
Epoch: 18, Steps: 4 | Train Loss: 0.704 Vali Loss: 1.205 Vali Acc: 0.440 Test Loss: 1.205 Test Acc: 0.440
Validation loss decreased (-0.419988 --> -0.439988).  Saving model ...
Epoch: 19 cost time: 1.5008857250213623
Epoch: 19, Steps: 4 | Train Loss: 0.473 Vali Loss: 1.188 Vali Acc: 0.460 Test Loss: 1.188 Test Acc: 0.460
Validation loss decreased (-0.439988 --> -0.459988).  Saving model ...
Epoch: 20 cost time: 1.3948657512664795
Epoch: 20, Steps: 4 | Train Loss: 0.505 Vali Loss: 1.157 Vali Acc: 0.480 Test Loss: 1.157 Test Acc: 0.480
Validation loss decreased (-0.459988 --> -0.479988).  Saving model ...
Epoch: 21 cost time: 1.3765428066253662
Epoch: 21, Steps: 4 | Train Loss: 0.519 Vali Loss: 1.172 Vali Acc: 0.440 Test Loss: 1.172 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.5045099258422852
Epoch: 22, Steps: 4 | Train Loss: 0.477 Vali Loss: 1.180 Vali Acc: 0.440 Test Loss: 1.180 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.5379524230957031
Epoch: 23, Steps: 4 | Train Loss: 0.378 Vali Loss: 1.153 Vali Acc: 0.440 Test Loss: 1.153 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.6142876148223877
Epoch: 24, Steps: 4 | Train Loss: 0.345 Vali Loss: 1.114 Vali Acc: 0.460 Test Loss: 1.114 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.4734466075897217
Epoch: 25, Steps: 4 | Train Loss: 0.422 Vali Loss: 1.120 Vali Acc: 0.400 Test Loss: 1.120 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.4339776039123535
Epoch: 26, Steps: 4 | Train Loss: 0.275 Vali Loss: 1.183 Vali Acc: 0.460 Test Loss: 1.183 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.4501352310180664
Epoch: 27, Steps: 4 | Train Loss: 0.236 Vali Loss: 1.150 Vali Acc: 0.440 Test Loss: 1.150 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.3818690776824951
Epoch: 28, Steps: 4 | Train Loss: 0.246 Vali Loss: 1.223 Vali Acc: 0.500 Test Loss: 1.223 Test Acc: 0.500
Validation loss decreased (-0.479988 --> -0.499988).  Saving model ...
Epoch: 29 cost time: 1.3826823234558105
Epoch: 29, Steps: 4 | Train Loss: 0.267 Vali Loss: 1.191 Vali Acc: 0.440 Test Loss: 1.191 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.5017871856689453
Epoch: 30, Steps: 4 | Train Loss: 0.249 Vali Loss: 1.150 Vali Acc: 0.400 Test Loss: 1.150 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el3_dm8_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.5
model parameter : 107933
model size : 0.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm128_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 14.947706699371338
Epoch: 1, Steps: 4 | Train Loss: 1.648 Vali Loss: 1.586 Vali Acc: 0.240 Test Loss: 1.586 Test Acc: 0.240
Validation loss decreased (inf --> -0.239984).  Saving model ...
Epoch: 2 cost time: 12.612678527832031
Epoch: 2, Steps: 4 | Train Loss: 1.621 Vali Loss: 1.507 Vali Acc: 0.320 Test Loss: 1.507 Test Acc: 0.320
Validation loss decreased (-0.239984 --> -0.319985).  Saving model ...
Epoch: 3 cost time: 12.054659843444824
Epoch: 3, Steps: 4 | Train Loss: 1.159 Vali Loss: 1.429 Vali Acc: 0.460 Test Loss: 1.429 Test Acc: 0.460
Validation loss decreased (-0.319985 --> -0.459986).  Saving model ...
Epoch: 4 cost time: 12.48696780204773
Epoch: 4, Steps: 4 | Train Loss: 0.915 Vali Loss: 1.392 Vali Acc: 0.420 Test Loss: 1.392 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 11.676074266433716
Epoch: 5, Steps: 4 | Train Loss: 0.603 Vali Loss: 1.225 Vali Acc: 0.560 Test Loss: 1.225 Test Acc: 0.560
Validation loss decreased (-0.459986 --> -0.559988).  Saving model ...
Epoch: 6 cost time: 11.078575849533081
Epoch: 6, Steps: 4 | Train Loss: 0.421 Vali Loss: 1.097 Vali Acc: 0.520 Test Loss: 1.097 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 11.962944746017456
Epoch: 7, Steps: 4 | Train Loss: 0.336 Vali Loss: 1.055 Vali Acc: 0.520 Test Loss: 1.055 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 11.243271112442017
Epoch: 8, Steps: 4 | Train Loss: 0.198 Vali Loss: 1.086 Vali Acc: 0.560 Test Loss: 1.086 Test Acc: 0.560
Validation loss decreased (-0.559988 --> -0.559989).  Saving model ...
Epoch: 9 cost time: 11.977459192276001
Epoch: 9, Steps: 4 | Train Loss: 0.208 Vali Loss: 1.217 Vali Acc: 0.520 Test Loss: 1.217 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 12.013639450073242
Epoch: 10, Steps: 4 | Train Loss: 0.198 Vali Loss: 1.237 Vali Acc: 0.560 Test Loss: 1.237 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 12.095107555389404
Epoch: 11, Steps: 4 | Train Loss: 0.052 Vali Loss: 1.320 Vali Acc: 0.560 Test Loss: 1.320 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 11.968050956726074
Epoch: 12, Steps: 4 | Train Loss: 0.035 Vali Loss: 1.433 Vali Acc: 0.580 Test Loss: 1.433 Test Acc: 0.580
Validation loss decreased (-0.559989 --> -0.579986).  Saving model ...
Epoch: 13 cost time: 12.038150072097778
Epoch: 13, Steps: 4 | Train Loss: 0.024 Vali Loss: 1.383 Vali Acc: 0.500 Test Loss: 1.383 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 11.826242208480835
Epoch: 14, Steps: 4 | Train Loss: 0.013 Vali Loss: 1.454 Vali Acc: 0.520 Test Loss: 1.454 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 12.09288763999939
Epoch: 15, Steps: 4 | Train Loss: 0.007 Vali Loss: 1.360 Vali Acc: 0.560 Test Loss: 1.360 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 11.89674973487854
Epoch: 16, Steps: 4 | Train Loss: 0.008 Vali Loss: 1.456 Vali Acc: 0.560 Test Loss: 1.456 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 11.704020500183105
Epoch: 17, Steps: 4 | Train Loss: 0.007 Vali Loss: 1.746 Vali Acc: 0.540 Test Loss: 1.746 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 11.66840934753418
Epoch: 18, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.680 Vali Acc: 0.540 Test Loss: 1.680 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 11.906760931015015
Epoch: 19, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.700 Vali Acc: 0.540 Test Loss: 1.700 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 12.16893196105957
Epoch: 20, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.769 Vali Acc: 0.560 Test Loss: 1.769 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 11.869982242584229
Epoch: 21, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.769 Vali Acc: 0.540 Test Loss: 1.769 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 12.155367851257324
Epoch: 22, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.684 Vali Acc: 0.540 Test Loss: 1.684 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm128_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 38181253
model size : 148.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm128_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 7.168211936950684
Epoch: 1, Steps: 4 | Train Loss: 1.593 Vali Loss: 1.628 Vali Acc: 0.180 Test Loss: 1.628 Test Acc: 0.180
Validation loss decreased (inf --> -0.179984).  Saving model ...
Epoch: 2 cost time: 4.676760196685791
Epoch: 2, Steps: 4 | Train Loss: 1.494 Vali Loss: 1.626 Vali Acc: 0.260 Test Loss: 1.626 Test Acc: 0.260
Validation loss decreased (-0.179984 --> -0.259984).  Saving model ...
Epoch: 3 cost time: 5.290403842926025
Epoch: 3, Steps: 4 | Train Loss: 1.211 Vali Loss: 1.603 Vali Acc: 0.380 Test Loss: 1.603 Test Acc: 0.380
Validation loss decreased (-0.259984 --> -0.379984).  Saving model ...
Epoch: 4 cost time: 5.257912874221802
Epoch: 4, Steps: 4 | Train Loss: 1.113 Vali Loss: 1.479 Vali Acc: 0.420 Test Loss: 1.479 Test Acc: 0.420
Validation loss decreased (-0.379984 --> -0.419985).  Saving model ...
Epoch: 5 cost time: 5.450234889984131
Epoch: 5, Steps: 4 | Train Loss: 0.938 Vali Loss: 1.437 Vali Acc: 0.520 Test Loss: 1.437 Test Acc: 0.520
Validation loss decreased (-0.419985 --> -0.519986).  Saving model ...
Epoch: 6 cost time: 5.108955144882202
Epoch: 6, Steps: 4 | Train Loss: 0.559 Vali Loss: 1.333 Vali Acc: 0.480 Test Loss: 1.333 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.380513906478882
Epoch: 7, Steps: 4 | Train Loss: 0.352 Vali Loss: 1.351 Vali Acc: 0.500 Test Loss: 1.351 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.43482780456543
Epoch: 8, Steps: 4 | Train Loss: 0.216 Vali Loss: 1.324 Vali Acc: 0.500 Test Loss: 1.324 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.4394965171813965
Epoch: 9, Steps: 4 | Train Loss: 0.148 Vali Loss: 1.216 Vali Acc: 0.560 Test Loss: 1.216 Test Acc: 0.560
Validation loss decreased (-0.519986 --> -0.559988).  Saving model ...
Epoch: 10 cost time: 5.192654371261597
Epoch: 10, Steps: 4 | Train Loss: 0.084 Vali Loss: 1.479 Vali Acc: 0.480 Test Loss: 1.479 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.358829975128174
Epoch: 11, Steps: 4 | Train Loss: 0.069 Vali Loss: 1.377 Vali Acc: 0.480 Test Loss: 1.377 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.126598596572876
Epoch: 12, Steps: 4 | Train Loss: 0.024 Vali Loss: 1.308 Vali Acc: 0.500 Test Loss: 1.308 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.482857704162598
Epoch: 13, Steps: 4 | Train Loss: 0.047 Vali Loss: 1.627 Vali Acc: 0.520 Test Loss: 1.627 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 5.153566360473633
Epoch: 14, Steps: 4 | Train Loss: 0.020 Vali Loss: 1.558 Vali Acc: 0.520 Test Loss: 1.558 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 5.416156530380249
Epoch: 15, Steps: 4 | Train Loss: 0.009 Vali Loss: 1.498 Vali Acc: 0.520 Test Loss: 1.498 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 5.28837776184082
Epoch: 16, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.551 Vali Acc: 0.560 Test Loss: 1.551 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 5.534994840621948
Epoch: 17, Steps: 4 | Train Loss: 0.006 Vali Loss: 1.498 Vali Acc: 0.520 Test Loss: 1.498 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 5.431822776794434
Epoch: 18, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.500 Vali Acc: 0.560 Test Loss: 1.500 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 4.7121663093566895
Epoch: 19, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.627 Vali Acc: 0.560 Test Loss: 1.627 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm128_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 11703173
model size : 47.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm128_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 11.473880052566528
Epoch: 1, Steps: 4 | Train Loss: 1.648 Vali Loss: 1.585 Vali Acc: 0.240 Test Loss: 1.585 Test Acc: 0.240
Validation loss decreased (inf --> -0.239984).  Saving model ...
Epoch: 2 cost time: 8.252297639846802
Epoch: 2, Steps: 4 | Train Loss: 1.620 Vali Loss: 1.506 Vali Acc: 0.320 Test Loss: 1.506 Test Acc: 0.320
Validation loss decreased (-0.239984 --> -0.319985).  Saving model ...
Epoch: 3 cost time: 8.16509461402893
Epoch: 3, Steps: 4 | Train Loss: 1.159 Vali Loss: 1.429 Vali Acc: 0.460 Test Loss: 1.429 Test Acc: 0.460
Validation loss decreased (-0.319985 --> -0.459986).  Saving model ...
Epoch: 4 cost time: 8.045568704605103
Epoch: 4, Steps: 4 | Train Loss: 0.919 Vali Loss: 1.392 Vali Acc: 0.420 Test Loss: 1.392 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 8.311046361923218
Epoch: 5, Steps: 4 | Train Loss: 0.602 Vali Loss: 1.227 Vali Acc: 0.560 Test Loss: 1.227 Test Acc: 0.560
Validation loss decreased (-0.459986 --> -0.559988).  Saving model ...
Epoch: 6 cost time: 8.549126863479614
Epoch: 6, Steps: 4 | Train Loss: 0.420 Vali Loss: 1.102 Vali Acc: 0.520 Test Loss: 1.102 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 8.349157333374023
Epoch: 7, Steps: 4 | Train Loss: 0.335 Vali Loss: 1.063 Vali Acc: 0.540 Test Loss: 1.063 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 7.811493158340454
Epoch: 8, Steps: 4 | Train Loss: 0.198 Vali Loss: 1.082 Vali Acc: 0.540 Test Loss: 1.082 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 8.189829349517822
Epoch: 9, Steps: 4 | Train Loss: 0.208 Vali Loss: 1.214 Vali Acc: 0.500 Test Loss: 1.214 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 8.383539915084839
Epoch: 10, Steps: 4 | Train Loss: 0.198 Vali Loss: 1.236 Vali Acc: 0.580 Test Loss: 1.236 Test Acc: 0.580
Validation loss decreased (-0.559988 --> -0.579988).  Saving model ...
Epoch: 11 cost time: 8.652108430862427
Epoch: 11, Steps: 4 | Train Loss: 0.052 Vali Loss: 1.324 Vali Acc: 0.580 Test Loss: 1.324 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 8.4048752784729
Epoch: 12, Steps: 4 | Train Loss: 0.036 Vali Loss: 1.420 Vali Acc: 0.560 Test Loss: 1.420 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 8.194207668304443
Epoch: 13, Steps: 4 | Train Loss: 0.022 Vali Loss: 1.305 Vali Acc: 0.520 Test Loss: 1.305 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 8.539615154266357
Epoch: 14, Steps: 4 | Train Loss: 0.011 Vali Loss: 1.331 Vali Acc: 0.600 Test Loss: 1.331 Test Acc: 0.600
Validation loss decreased (-0.579988 --> -0.599987).  Saving model ...
Epoch: 15 cost time: 8.621800661087036
Epoch: 15, Steps: 4 | Train Loss: 0.007 Vali Loss: 1.284 Vali Acc: 0.640 Test Loss: 1.284 Test Acc: 0.640
Validation loss decreased (-0.599987 --> -0.639987).  Saving model ...
Epoch: 16 cost time: 8.288472652435303
Epoch: 16, Steps: 4 | Train Loss: 0.007 Vali Loss: 1.345 Vali Acc: 0.640 Test Loss: 1.345 Test Acc: 0.640
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 7.915086269378662
Epoch: 17, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.620 Vali Acc: 0.580 Test Loss: 1.620 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 7.986574411392212
Epoch: 18, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.528 Vali Acc: 0.580 Test Loss: 1.528 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 8.241649389266968
Epoch: 19, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.508 Vali Acc: 0.600 Test Loss: 1.508 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 8.262506484985352
Epoch: 20, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.577 Vali Acc: 0.580 Test Loss: 1.577 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 7.925141096115112
Epoch: 21, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.603 Vali Acc: 0.580 Test Loss: 1.603 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 6.851607322692871
Epoch: 22, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.570 Vali Acc: 0.580 Test Loss: 1.570 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 7.595103740692139
Epoch: 23, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.541 Vali Acc: 0.580 Test Loss: 1.541 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 7.948009967803955
Epoch: 24, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.508 Vali Acc: 0.600 Test Loss: 1.508 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 8.039334297180176
Epoch: 25, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.492 Vali Acc: 0.600 Test Loss: 1.492 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm128_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.64
model parameter : 38181253
model size : 148.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm128_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 5.633116245269775
Epoch: 1, Steps: 4 | Train Loss: 1.593 Vali Loss: 1.625 Vali Acc: 0.180 Test Loss: 1.625 Test Acc: 0.180
Validation loss decreased (inf --> -0.179984).  Saving model ...
Epoch: 2 cost time: 3.4301986694335938
Epoch: 2, Steps: 4 | Train Loss: 1.494 Vali Loss: 1.625 Vali Acc: 0.260 Test Loss: 1.625 Test Acc: 0.260
Validation loss decreased (-0.179984 --> -0.259984).  Saving model ...
Epoch: 3 cost time: 3.6792995929718018
Epoch: 3, Steps: 4 | Train Loss: 1.211 Vali Loss: 1.604 Vali Acc: 0.360 Test Loss: 1.604 Test Acc: 0.360
Validation loss decreased (-0.259984 --> -0.359984).  Saving model ...
Epoch: 4 cost time: 3.6644415855407715
Epoch: 4, Steps: 4 | Train Loss: 1.110 Vali Loss: 1.480 Vali Acc: 0.420 Test Loss: 1.480 Test Acc: 0.420
Validation loss decreased (-0.359984 --> -0.419985).  Saving model ...
Epoch: 5 cost time: 4.046535491943359
Epoch: 5, Steps: 4 | Train Loss: 0.935 Vali Loss: 1.441 Vali Acc: 0.520 Test Loss: 1.441 Test Acc: 0.520
Validation loss decreased (-0.419985 --> -0.519986).  Saving model ...
Epoch: 6 cost time: 3.7770237922668457
Epoch: 6, Steps: 4 | Train Loss: 0.558 Vali Loss: 1.332 Vali Acc: 0.540 Test Loss: 1.332 Test Acc: 0.540
Validation loss decreased (-0.519986 --> -0.539987).  Saving model ...
Epoch: 7 cost time: 3.7000977993011475
Epoch: 7, Steps: 4 | Train Loss: 0.352 Vali Loss: 1.345 Vali Acc: 0.520 Test Loss: 1.345 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.8300278186798096
Epoch: 8, Steps: 4 | Train Loss: 0.216 Vali Loss: 1.323 Vali Acc: 0.520 Test Loss: 1.323 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.002462148666382
Epoch: 9, Steps: 4 | Train Loss: 0.148 Vali Loss: 1.209 Vali Acc: 0.560 Test Loss: 1.209 Test Acc: 0.560
Validation loss decreased (-0.539987 --> -0.559988).  Saving model ...
Epoch: 10 cost time: 4.052173852920532
Epoch: 10, Steps: 4 | Train Loss: 0.084 Vali Loss: 1.464 Vali Acc: 0.500 Test Loss: 1.464 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.8106939792633057
Epoch: 11, Steps: 4 | Train Loss: 0.069 Vali Loss: 1.357 Vali Acc: 0.480 Test Loss: 1.357 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.361781358718872
Epoch: 12, Steps: 4 | Train Loss: 0.024 Vali Loss: 1.289 Vali Acc: 0.500 Test Loss: 1.289 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.5388524532318115
Epoch: 13, Steps: 4 | Train Loss: 0.076 Vali Loss: 1.620 Vali Acc: 0.520 Test Loss: 1.620 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.087067365646362
Epoch: 14, Steps: 4 | Train Loss: 0.020 Vali Loss: 1.554 Vali Acc: 0.500 Test Loss: 1.554 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.905400037765503
Epoch: 15, Steps: 4 | Train Loss: 0.009 Vali Loss: 1.478 Vali Acc: 0.500 Test Loss: 1.478 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.050433397293091
Epoch: 16, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.541 Vali Acc: 0.540 Test Loss: 1.541 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.935744524002075
Epoch: 17, Steps: 4 | Train Loss: 0.006 Vali Loss: 1.488 Vali Acc: 0.520 Test Loss: 1.488 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 3.953972339630127
Epoch: 18, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.484 Vali Acc: 0.560 Test Loss: 1.484 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 4.27298378944397
Epoch: 19, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.602 Vali Acc: 0.540 Test Loss: 1.602 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm128_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 11703173
model size : 47.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm128_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 7.995980978012085
Epoch: 1, Steps: 4 | Train Loss: 1.654 Vali Loss: 1.585 Vali Acc: 0.240 Test Loss: 1.585 Test Acc: 0.240
Validation loss decreased (inf --> -0.239984).  Saving model ...
Epoch: 2 cost time: 6.152712106704712
Epoch: 2, Steps: 4 | Train Loss: 1.627 Vali Loss: 1.506 Vali Acc: 0.320 Test Loss: 1.506 Test Acc: 0.320
Validation loss decreased (-0.239984 --> -0.319985).  Saving model ...
Epoch: 3 cost time: 5.734910011291504
Epoch: 3, Steps: 4 | Train Loss: 1.165 Vali Loss: 1.429 Vali Acc: 0.440 Test Loss: 1.429 Test Acc: 0.440
Validation loss decreased (-0.319985 --> -0.439986).  Saving model ...
Epoch: 4 cost time: 5.82108473777771
Epoch: 4, Steps: 4 | Train Loss: 0.924 Vali Loss: 1.389 Vali Acc: 0.420 Test Loss: 1.389 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.448279857635498
Epoch: 5, Steps: 4 | Train Loss: 0.608 Vali Loss: 1.222 Vali Acc: 0.540 Test Loss: 1.222 Test Acc: 0.540
Validation loss decreased (-0.439986 --> -0.539988).  Saving model ...
Epoch: 6 cost time: 5.384972095489502
Epoch: 6, Steps: 4 | Train Loss: 0.426 Vali Loss: 1.100 Vali Acc: 0.520 Test Loss: 1.100 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.952577352523804
Epoch: 7, Steps: 4 | Train Loss: 0.346 Vali Loss: 1.059 Vali Acc: 0.520 Test Loss: 1.059 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.0441741943359375
Epoch: 8, Steps: 4 | Train Loss: 0.201 Vali Loss: 1.089 Vali Acc: 0.560 Test Loss: 1.089 Test Acc: 0.560
Validation loss decreased (-0.539988 --> -0.559989).  Saving model ...
Epoch: 9 cost time: 5.634685516357422
Epoch: 9, Steps: 4 | Train Loss: 0.196 Vali Loss: 1.192 Vali Acc: 0.520 Test Loss: 1.192 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.939420938491821
Epoch: 10, Steps: 4 | Train Loss: 0.198 Vali Loss: 1.271 Vali Acc: 0.560 Test Loss: 1.271 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.762037754058838
Epoch: 11, Steps: 4 | Train Loss: 0.056 Vali Loss: 1.336 Vali Acc: 0.560 Test Loss: 1.336 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 6.049661874771118
Epoch: 12, Steps: 4 | Train Loss: 0.041 Vali Loss: 1.356 Vali Acc: 0.560 Test Loss: 1.356 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 5.992618083953857
Epoch: 13, Steps: 4 | Train Loss: 0.023 Vali Loss: 1.206 Vali Acc: 0.560 Test Loss: 1.206 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 6.280330181121826
Epoch: 14, Steps: 4 | Train Loss: 0.013 Vali Loss: 1.288 Vali Acc: 0.540 Test Loss: 1.288 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 5.642061471939087
Epoch: 15, Steps: 4 | Train Loss: 0.009 Vali Loss: 1.313 Vali Acc: 0.600 Test Loss: 1.313 Test Acc: 0.600
Validation loss decreased (-0.559989 --> -0.599987).  Saving model ...
Epoch: 16 cost time: 5.962940692901611
Epoch: 16, Steps: 4 | Train Loss: 0.007 Vali Loss: 1.353 Vali Acc: 0.560 Test Loss: 1.353 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.9647767543792725
Epoch: 17, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.600 Vali Acc: 0.540 Test Loss: 1.600 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 6.034829378128052
Epoch: 18, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.595 Vali Acc: 0.540 Test Loss: 1.595 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 6.072432041168213
Epoch: 19, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.536 Vali Acc: 0.540 Test Loss: 1.536 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 6.268295526504517
Epoch: 20, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.500 Vali Acc: 0.560 Test Loss: 1.500 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 6.162154674530029
Epoch: 21, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.480 Vali Acc: 0.560 Test Loss: 1.480 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 6.229844570159912
Epoch: 22, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.489 Vali Acc: 0.560 Test Loss: 1.489 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 6.001435995101929
Epoch: 23, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.525 Vali Acc: 0.560 Test Loss: 1.525 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 5.912729024887085
Epoch: 24, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.541 Vali Acc: 0.540 Test Loss: 1.541 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 5.9890968799591064
Epoch: 25, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.554 Vali Acc: 0.540 Test Loss: 1.554 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm128_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 38181253
model size : 148.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm128_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.924124717712402
Epoch: 1, Steps: 4 | Train Loss: 1.595 Vali Loss: 1.626 Vali Acc: 0.160 Test Loss: 1.626 Test Acc: 0.160
Validation loss decreased (inf --> -0.159984).  Saving model ...
Epoch: 2 cost time: 2.6639797687530518
Epoch: 2, Steps: 4 | Train Loss: 1.495 Vali Loss: 1.626 Vali Acc: 0.260 Test Loss: 1.626 Test Acc: 0.260
Validation loss decreased (-0.159984 --> -0.259984).  Saving model ...
Epoch: 3 cost time: 2.54412579536438
Epoch: 3, Steps: 4 | Train Loss: 1.217 Vali Loss: 1.606 Vali Acc: 0.360 Test Loss: 1.606 Test Acc: 0.360
Validation loss decreased (-0.259984 --> -0.359984).  Saving model ...
Epoch: 4 cost time: 2.6460931301116943
Epoch: 4, Steps: 4 | Train Loss: 1.123 Vali Loss: 1.480 Vali Acc: 0.440 Test Loss: 1.480 Test Acc: 0.440
Validation loss decreased (-0.359984 --> -0.439985).  Saving model ...
Epoch: 5 cost time: 2.8605759143829346
Epoch: 5, Steps: 4 | Train Loss: 0.947 Vali Loss: 1.431 Vali Acc: 0.520 Test Loss: 1.431 Test Acc: 0.520
Validation loss decreased (-0.439985 --> -0.519986).  Saving model ...
Epoch: 6 cost time: 2.715352773666382
Epoch: 6, Steps: 4 | Train Loss: 0.559 Vali Loss: 1.321 Vali Acc: 0.560 Test Loss: 1.321 Test Acc: 0.560
Validation loss decreased (-0.519986 --> -0.559987).  Saving model ...
Epoch: 7 cost time: 2.804608106613159
Epoch: 7, Steps: 4 | Train Loss: 0.361 Vali Loss: 1.348 Vali Acc: 0.520 Test Loss: 1.348 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.7295002937316895
Epoch: 8, Steps: 4 | Train Loss: 0.223 Vali Loss: 1.326 Vali Acc: 0.480 Test Loss: 1.326 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.798180103302002
Epoch: 9, Steps: 4 | Train Loss: 0.154 Vali Loss: 1.201 Vali Acc: 0.540 Test Loss: 1.201 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.3721022605895996
Epoch: 10, Steps: 4 | Train Loss: 0.088 Vali Loss: 1.444 Vali Acc: 0.500 Test Loss: 1.444 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.35591197013855
Epoch: 11, Steps: 4 | Train Loss: 0.070 Vali Loss: 1.359 Vali Acc: 0.480 Test Loss: 1.359 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.413416862487793
Epoch: 12, Steps: 4 | Train Loss: 0.027 Vali Loss: 1.275 Vali Acc: 0.520 Test Loss: 1.275 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.7706804275512695
Epoch: 13, Steps: 4 | Train Loss: 0.018 Vali Loss: 1.512 Vali Acc: 0.540 Test Loss: 1.512 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.686281204223633
Epoch: 14, Steps: 4 | Train Loss: 0.019 Vali Loss: 1.387 Vali Acc: 0.540 Test Loss: 1.387 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.5099599361419678
Epoch: 15, Steps: 4 | Train Loss: 0.006 Vali Loss: 1.472 Vali Acc: 0.520 Test Loss: 1.472 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.5523014068603516
Epoch: 16, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.554 Vali Acc: 0.500 Test Loss: 1.554 Test Acc: 0.500
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm128_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 11703173
model size : 47.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm128_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 8.6085045337677
Epoch: 1, Steps: 4 | Train Loss: 1.701 Vali Loss: 1.628 Vali Acc: 0.180 Test Loss: 1.628 Test Acc: 0.180
Validation loss decreased (inf --> -0.179984).  Saving model ...
Epoch: 2 cost time: 6.2831947803497314
Epoch: 2, Steps: 4 | Train Loss: 1.689 Vali Loss: 1.586 Vali Acc: 0.200 Test Loss: 1.586 Test Acc: 0.200
Validation loss decreased (-0.179984 --> -0.199984).  Saving model ...
Epoch: 3 cost time: 6.7458415031433105
Epoch: 3, Steps: 4 | Train Loss: 1.309 Vali Loss: 1.572 Vali Acc: 0.320 Test Loss: 1.572 Test Acc: 0.320
Validation loss decreased (-0.199984 --> -0.319984).  Saving model ...
Epoch: 4 cost time: 6.602325439453125
Epoch: 4, Steps: 4 | Train Loss: 0.950 Vali Loss: 1.462 Vali Acc: 0.340 Test Loss: 1.462 Test Acc: 0.340
Validation loss decreased (-0.319984 --> -0.339985).  Saving model ...
Epoch: 5 cost time: 6.491657257080078
Epoch: 5, Steps: 4 | Train Loss: 0.700 Vali Loss: 1.515 Vali Acc: 0.400 Test Loss: 1.515 Test Acc: 0.400
Validation loss decreased (-0.339985 --> -0.399985).  Saving model ...
Epoch: 6 cost time: 6.560863494873047
Epoch: 6, Steps: 4 | Train Loss: 0.621 Vali Loss: 1.389 Vali Acc: 0.440 Test Loss: 1.389 Test Acc: 0.440
Validation loss decreased (-0.399985 --> -0.439986).  Saving model ...
Epoch: 7 cost time: 6.494786024093628
Epoch: 7, Steps: 4 | Train Loss: 0.594 Vali Loss: 1.295 Vali Acc: 0.460 Test Loss: 1.295 Test Acc: 0.460
Validation loss decreased (-0.439986 --> -0.459987).  Saving model ...
Epoch: 8 cost time: 6.620672225952148
Epoch: 8, Steps: 4 | Train Loss: 0.280 Vali Loss: 1.352 Vali Acc: 0.480 Test Loss: 1.352 Test Acc: 0.480
Validation loss decreased (-0.459987 --> -0.479986).  Saving model ...
Epoch: 9 cost time: 6.525250196456909
Epoch: 9, Steps: 4 | Train Loss: 0.143 Vali Loss: 1.317 Vali Acc: 0.500 Test Loss: 1.317 Test Acc: 0.500
Validation loss decreased (-0.479986 --> -0.499987).  Saving model ...
Epoch: 10 cost time: 5.832758665084839
Epoch: 10, Steps: 4 | Train Loss: 0.098 Vali Loss: 1.261 Vali Acc: 0.520 Test Loss: 1.261 Test Acc: 0.520
Validation loss decreased (-0.499987 --> -0.519987).  Saving model ...
Epoch: 11 cost time: 6.674323558807373
Epoch: 11, Steps: 4 | Train Loss: 0.061 Vali Loss: 1.354 Vali Acc: 0.500 Test Loss: 1.354 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.623050689697266
Epoch: 12, Steps: 4 | Train Loss: 0.041 Vali Loss: 1.449 Vali Acc: 0.500 Test Loss: 1.449 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.908444166183472
Epoch: 13, Steps: 4 | Train Loss: 0.020 Vali Loss: 1.396 Vali Acc: 0.520 Test Loss: 1.396 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 7.046371698379517
Epoch: 14, Steps: 4 | Train Loss: 0.016 Vali Loss: 1.355 Vali Acc: 0.560 Test Loss: 1.355 Test Acc: 0.560
Validation loss decreased (-0.519987 --> -0.559986).  Saving model ...
Epoch: 15 cost time: 6.71125054359436
Epoch: 15, Steps: 4 | Train Loss: 0.010 Vali Loss: 1.321 Vali Acc: 0.540 Test Loss: 1.321 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 6.765258073806763
Epoch: 16, Steps: 4 | Train Loss: 0.006 Vali Loss: 1.337 Vali Acc: 0.540 Test Loss: 1.337 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 7.191608905792236
Epoch: 17, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.477 Vali Acc: 0.560 Test Loss: 1.477 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 7.045994520187378
Epoch: 18, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.685 Vali Acc: 0.580 Test Loss: 1.685 Test Acc: 0.580
Validation loss decreased (-0.559986 --> -0.579983).  Saving model ...
Epoch: 19 cost time: 6.795562982559204
Epoch: 19, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.682 Vali Acc: 0.580 Test Loss: 1.682 Test Acc: 0.580
Validation loss decreased (-0.579983 --> -0.579983).  Saving model ...
Epoch: 20 cost time: 6.906142711639404
Epoch: 20, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.616 Vali Acc: 0.560 Test Loss: 1.616 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 7.176500558853149
Epoch: 21, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.545 Vali Acc: 0.540 Test Loss: 1.545 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 7.018905401229858
Epoch: 22, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.538 Vali Acc: 0.580 Test Loss: 1.538 Test Acc: 0.580
Validation loss decreased (-0.579983 --> -0.579985).  Saving model ...
Epoch: 23 cost time: 6.884038686752319
Epoch: 23, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.559 Vali Acc: 0.580 Test Loss: 1.559 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 6.970945835113525
Epoch: 24, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.596 Vali Acc: 0.580 Test Loss: 1.596 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 6.624887943267822
Epoch: 25, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.573 Vali Acc: 0.580 Test Loss: 1.573 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 7.171254634857178
Epoch: 26, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.553 Vali Acc: 0.580 Test Loss: 1.553 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 7.20783257484436
Epoch: 27, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.589 Vali Acc: 0.580 Test Loss: 1.589 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 7.472676992416382
Epoch: 28, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.619 Vali Acc: 0.580 Test Loss: 1.619 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 7.237745046615601
Epoch: 29, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.631 Vali Acc: 0.580 Test Loss: 1.631 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 7.006868124008179
Epoch: 30, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.629 Vali Acc: 0.580 Test Loss: 1.629 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm128_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 19436421
model size : 76.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm128_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 5.383776426315308
Epoch: 1, Steps: 4 | Train Loss: 1.672 Vali Loss: 1.620 Vali Acc: 0.280 Test Loss: 1.620 Test Acc: 0.280
Validation loss decreased (inf --> -0.279984).  Saving model ...
Epoch: 2 cost time: 3.3272006511688232
Epoch: 2, Steps: 4 | Train Loss: 1.615 Vali Loss: 1.617 Vali Acc: 0.260 Test Loss: 1.617 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.170985698699951
Epoch: 3, Steps: 4 | Train Loss: 1.466 Vali Loss: 1.646 Vali Acc: 0.300 Test Loss: 1.646 Test Acc: 0.300
Validation loss decreased (-0.279984 --> -0.299984).  Saving model ...
Epoch: 4 cost time: 3.204388380050659
Epoch: 4, Steps: 4 | Train Loss: 0.890 Vali Loss: 1.499 Vali Acc: 0.400 Test Loss: 1.499 Test Acc: 0.400
Validation loss decreased (-0.299984 --> -0.399985).  Saving model ...
Epoch: 5 cost time: 3.3945610523223877
Epoch: 5, Steps: 4 | Train Loss: 0.714 Vali Loss: 1.420 Vali Acc: 0.420 Test Loss: 1.420 Test Acc: 0.420
Validation loss decreased (-0.399985 --> -0.419986).  Saving model ...
Epoch: 6 cost time: 3.221324920654297
Epoch: 6, Steps: 4 | Train Loss: 0.595 Vali Loss: 1.366 Vali Acc: 0.520 Test Loss: 1.366 Test Acc: 0.520
Validation loss decreased (-0.419986 --> -0.519986).  Saving model ...
Epoch: 7 cost time: 3.4572062492370605
Epoch: 7, Steps: 4 | Train Loss: 0.314 Vali Loss: 1.318 Vali Acc: 0.480 Test Loss: 1.318 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.240569591522217
Epoch: 8, Steps: 4 | Train Loss: 0.193 Vali Loss: 1.279 Vali Acc: 0.540 Test Loss: 1.279 Test Acc: 0.540
Validation loss decreased (-0.519986 --> -0.539987).  Saving model ...
Epoch: 9 cost time: 3.264629364013672
Epoch: 9, Steps: 4 | Train Loss: 0.175 Vali Loss: 1.268 Vali Acc: 0.500 Test Loss: 1.268 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.3604846000671387
Epoch: 10, Steps: 4 | Train Loss: 0.105 Vali Loss: 1.270 Vali Acc: 0.480 Test Loss: 1.270 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.1632938385009766
Epoch: 11, Steps: 4 | Train Loss: 0.066 Vali Loss: 1.280 Vali Acc: 0.520 Test Loss: 1.280 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.28536319732666
Epoch: 12, Steps: 4 | Train Loss: 0.130 Vali Loss: 1.324 Vali Acc: 0.480 Test Loss: 1.324 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.971435070037842
Epoch: 13, Steps: 4 | Train Loss: 0.041 Vali Loss: 1.544 Vali Acc: 0.480 Test Loss: 1.544 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.14113187789917
Epoch: 14, Steps: 4 | Train Loss: 0.072 Vali Loss: 2.070 Vali Acc: 0.460 Test Loss: 2.070 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.2638888359069824
Epoch: 15, Steps: 4 | Train Loss: 0.059 Vali Loss: 1.601 Vali Acc: 0.500 Test Loss: 1.601 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.2724568843841553
Epoch: 16, Steps: 4 | Train Loss: 0.007 Vali Loss: 1.493 Vali Acc: 0.500 Test Loss: 1.493 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.134699583053589
Epoch: 17, Steps: 4 | Train Loss: 0.006 Vali Loss: 1.575 Vali Acc: 0.520 Test Loss: 1.575 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 3.364492893218994
Epoch: 18, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.706 Vali Acc: 0.540 Test Loss: 1.706 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm128_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 6197125
model size : 26.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm128_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 7.816476345062256
Epoch: 1, Steps: 4 | Train Loss: 1.701 Vali Loss: 1.626 Vali Acc: 0.180 Test Loss: 1.626 Test Acc: 0.180
Validation loss decreased (inf --> -0.179984).  Saving model ...
Epoch: 2 cost time: 5.301358699798584
Epoch: 2, Steps: 4 | Train Loss: 1.690 Vali Loss: 1.586 Vali Acc: 0.200 Test Loss: 1.586 Test Acc: 0.200
Validation loss decreased (-0.179984 --> -0.199984).  Saving model ...
Epoch: 3 cost time: 5.615124225616455
Epoch: 3, Steps: 4 | Train Loss: 1.309 Vali Loss: 1.571 Vali Acc: 0.300 Test Loss: 1.571 Test Acc: 0.300
Validation loss decreased (-0.199984 --> -0.299984).  Saving model ...
Epoch: 4 cost time: 5.411432266235352
Epoch: 4, Steps: 4 | Train Loss: 0.950 Vali Loss: 1.460 Vali Acc: 0.340 Test Loss: 1.460 Test Acc: 0.340
Validation loss decreased (-0.299984 --> -0.339985).  Saving model ...
Epoch: 5 cost time: 5.259220361709595
Epoch: 5, Steps: 4 | Train Loss: 0.699 Vali Loss: 1.514 Vali Acc: 0.400 Test Loss: 1.514 Test Acc: 0.400
Validation loss decreased (-0.339985 --> -0.399985).  Saving model ...
Epoch: 6 cost time: 5.317428350448608
Epoch: 6, Steps: 4 | Train Loss: 0.620 Vali Loss: 1.386 Vali Acc: 0.440 Test Loss: 1.386 Test Acc: 0.440
Validation loss decreased (-0.399985 --> -0.439986).  Saving model ...
Epoch: 7 cost time: 4.863035440444946
Epoch: 7, Steps: 4 | Train Loss: 0.598 Vali Loss: 1.287 Vali Acc: 0.500 Test Loss: 1.287 Test Acc: 0.500
Validation loss decreased (-0.439986 --> -0.499987).  Saving model ...
Epoch: 8 cost time: 5.293484926223755
Epoch: 8, Steps: 4 | Train Loss: 0.279 Vali Loss: 1.341 Vali Acc: 0.460 Test Loss: 1.341 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.314010381698608
Epoch: 9, Steps: 4 | Train Loss: 0.142 Vali Loss: 1.304 Vali Acc: 0.500 Test Loss: 1.304 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.28580641746521
Epoch: 10, Steps: 4 | Train Loss: 0.097 Vali Loss: 1.242 Vali Acc: 0.540 Test Loss: 1.242 Test Acc: 0.540
Validation loss decreased (-0.499987 --> -0.539988).  Saving model ...
Epoch: 11 cost time: 5.328946352005005
Epoch: 11, Steps: 4 | Train Loss: 0.060 Vali Loss: 1.338 Vali Acc: 0.500 Test Loss: 1.338 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.14406943321228
Epoch: 12, Steps: 4 | Train Loss: 0.042 Vali Loss: 1.427 Vali Acc: 0.520 Test Loss: 1.427 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.405054092407227
Epoch: 13, Steps: 4 | Train Loss: 0.020 Vali Loss: 1.351 Vali Acc: 0.500 Test Loss: 1.351 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.366149425506592
Epoch: 14, Steps: 4 | Train Loss: 0.015 Vali Loss: 1.299 Vali Acc: 0.580 Test Loss: 1.299 Test Acc: 0.580
Validation loss decreased (-0.539988 --> -0.579987).  Saving model ...
Epoch: 15 cost time: 5.285534143447876
Epoch: 15, Steps: 4 | Train Loss: 0.010 Vali Loss: 1.267 Vali Acc: 0.520 Test Loss: 1.267 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.264088869094849
Epoch: 16, Steps: 4 | Train Loss: 0.006 Vali Loss: 1.279 Vali Acc: 0.540 Test Loss: 1.279 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 5.392720460891724
Epoch: 17, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.402 Vali Acc: 0.560 Test Loss: 1.402 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 5.500975608825684
Epoch: 18, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.602 Vali Acc: 0.600 Test Loss: 1.602 Test Acc: 0.600
Validation loss decreased (-0.579987 --> -0.599984).  Saving model ...
Epoch: 19 cost time: 5.603286504745483
Epoch: 19, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.598 Vali Acc: 0.600 Test Loss: 1.598 Test Acc: 0.600
Validation loss decreased (-0.599984 --> -0.599984).  Saving model ...
Epoch: 20 cost time: 5.523818016052246
Epoch: 20, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.527 Vali Acc: 0.580 Test Loss: 1.527 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 5.529644250869751
Epoch: 21, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.477 Vali Acc: 0.560 Test Loss: 1.477 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 5.598194360733032
Epoch: 22, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.484 Vali Acc: 0.600 Test Loss: 1.484 Test Acc: 0.600
Validation loss decreased (-0.599984 --> -0.599985).  Saving model ...
Epoch: 23 cost time: 5.586540222167969
Epoch: 23, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.514 Vali Acc: 0.600 Test Loss: 1.514 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 5.588604688644409
Epoch: 24, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.554 Vali Acc: 0.600 Test Loss: 1.554 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 5.651845455169678
Epoch: 25, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.527 Vali Acc: 0.600 Test Loss: 1.527 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 5.633063554763794
Epoch: 26, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.504 Vali Acc: 0.600 Test Loss: 1.504 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 5.6152184009552
Epoch: 27, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.537 Vali Acc: 0.600 Test Loss: 1.537 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 5.571673154830933
Epoch: 28, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.565 Vali Acc: 0.600 Test Loss: 1.565 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 5.5497565269470215
Epoch: 29, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.572 Vali Acc: 0.600 Test Loss: 1.572 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 5.593457460403442
Epoch: 30, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.560 Vali Acc: 0.600 Test Loss: 1.560 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm128_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 19436421
model size : 76.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm128_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.520132780075073
Epoch: 1, Steps: 4 | Train Loss: 1.673 Vali Loss: 1.621 Vali Acc: 0.260 Test Loss: 1.621 Test Acc: 0.260
Validation loss decreased (inf --> -0.259984).  Saving model ...
Epoch: 2 cost time: 2.5000202655792236
Epoch: 2, Steps: 4 | Train Loss: 1.615 Vali Loss: 1.619 Vali Acc: 0.260 Test Loss: 1.619 Test Acc: 0.260
Validation loss decreased (-0.259984 --> -0.259984).  Saving model ...
Epoch: 3 cost time: 2.851497173309326
Epoch: 3, Steps: 4 | Train Loss: 1.466 Vali Loss: 1.648 Vali Acc: 0.300 Test Loss: 1.648 Test Acc: 0.300
Validation loss decreased (-0.259984 --> -0.299984).  Saving model ...
Epoch: 4 cost time: 2.7368524074554443
Epoch: 4, Steps: 4 | Train Loss: 0.890 Vali Loss: 1.500 Vali Acc: 0.420 Test Loss: 1.500 Test Acc: 0.420
Validation loss decreased (-0.299984 --> -0.419985).  Saving model ...
Epoch: 5 cost time: 2.848897695541382
Epoch: 5, Steps: 4 | Train Loss: 0.714 Vali Loss: 1.423 Vali Acc: 0.420 Test Loss: 1.423 Test Acc: 0.420
Validation loss decreased (-0.419985 --> -0.419986).  Saving model ...
Epoch: 6 cost time: 2.800830364227295
Epoch: 6, Steps: 4 | Train Loss: 0.595 Vali Loss: 1.370 Vali Acc: 0.520 Test Loss: 1.370 Test Acc: 0.520
Validation loss decreased (-0.419986 --> -0.519986).  Saving model ...
Epoch: 7 cost time: 2.7713801860809326
Epoch: 7, Steps: 4 | Train Loss: 0.314 Vali Loss: 1.325 Vali Acc: 0.480 Test Loss: 1.325 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.8743736743927
Epoch: 8, Steps: 4 | Train Loss: 0.193 Vali Loss: 1.289 Vali Acc: 0.560 Test Loss: 1.289 Test Acc: 0.560
Validation loss decreased (-0.519986 --> -0.559987).  Saving model ...
Epoch: 9 cost time: 2.7662434577941895
Epoch: 9, Steps: 4 | Train Loss: 0.175 Vali Loss: 1.268 Vali Acc: 0.520 Test Loss: 1.268 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.9761717319488525
Epoch: 10, Steps: 4 | Train Loss: 0.105 Vali Loss: 1.262 Vali Acc: 0.520 Test Loss: 1.262 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.717869520187378
Epoch: 11, Steps: 4 | Train Loss: 0.066 Vali Loss: 1.264 Vali Acc: 0.520 Test Loss: 1.264 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.8406574726104736
Epoch: 12, Steps: 4 | Train Loss: 0.130 Vali Loss: 1.301 Vali Acc: 0.500 Test Loss: 1.301 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.8010332584381104
Epoch: 13, Steps: 4 | Train Loss: 0.041 Vali Loss: 1.527 Vali Acc: 0.520 Test Loss: 1.527 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.667203187942505
Epoch: 14, Steps: 4 | Train Loss: 0.071 Vali Loss: 2.043 Vali Acc: 0.480 Test Loss: 2.043 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.50622296333313
Epoch: 15, Steps: 4 | Train Loss: 0.058 Vali Loss: 1.577 Vali Acc: 0.520 Test Loss: 1.577 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.4609076976776123
Epoch: 16, Steps: 4 | Train Loss: 0.007 Vali Loss: 1.490 Vali Acc: 0.500 Test Loss: 1.490 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.5873119831085205
Epoch: 17, Steps: 4 | Train Loss: 0.006 Vali Loss: 1.568 Vali Acc: 0.500 Test Loss: 1.568 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.6138248443603516
Epoch: 18, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.689 Vali Acc: 0.520 Test Loss: 1.689 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm128_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 6197125
model size : 26.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm128_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 5.666585445404053
Epoch: 1, Steps: 4 | Train Loss: 1.696 Vali Loss: 1.625 Vali Acc: 0.180 Test Loss: 1.625 Test Acc: 0.180
Validation loss decreased (inf --> -0.179984).  Saving model ...
Epoch: 2 cost time: 3.845140218734741
Epoch: 2, Steps: 4 | Train Loss: 1.689 Vali Loss: 1.586 Vali Acc: 0.200 Test Loss: 1.586 Test Acc: 0.200
Validation loss decreased (-0.179984 --> -0.199984).  Saving model ...
Epoch: 3 cost time: 4.016993284225464
Epoch: 3, Steps: 4 | Train Loss: 1.311 Vali Loss: 1.571 Vali Acc: 0.300 Test Loss: 1.571 Test Acc: 0.300
Validation loss decreased (-0.199984 --> -0.299984).  Saving model ...
Epoch: 4 cost time: 3.754021644592285
Epoch: 4, Steps: 4 | Train Loss: 0.955 Vali Loss: 1.461 Vali Acc: 0.340 Test Loss: 1.461 Test Acc: 0.340
Validation loss decreased (-0.299984 --> -0.339985).  Saving model ...
Epoch: 5 cost time: 3.793912172317505
Epoch: 5, Steps: 4 | Train Loss: 0.706 Vali Loss: 1.518 Vali Acc: 0.400 Test Loss: 1.518 Test Acc: 0.400
Validation loss decreased (-0.339985 --> -0.399985).  Saving model ...
Epoch: 6 cost time: 3.850306987762451
Epoch: 6, Steps: 4 | Train Loss: 0.627 Vali Loss: 1.386 Vali Acc: 0.440 Test Loss: 1.386 Test Acc: 0.440
Validation loss decreased (-0.399985 --> -0.439986).  Saving model ...
Epoch: 7 cost time: 3.7447006702423096
Epoch: 7, Steps: 4 | Train Loss: 0.614 Vali Loss: 1.286 Vali Acc: 0.480 Test Loss: 1.286 Test Acc: 0.480
Validation loss decreased (-0.439986 --> -0.479987).  Saving model ...
Epoch: 8 cost time: 3.9876279830932617
Epoch: 8, Steps: 4 | Train Loss: 0.289 Vali Loss: 1.345 Vali Acc: 0.460 Test Loss: 1.345 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.8137013912200928
Epoch: 9, Steps: 4 | Train Loss: 0.165 Vali Loss: 1.317 Vali Acc: 0.480 Test Loss: 1.317 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.8681747913360596
Epoch: 10, Steps: 4 | Train Loss: 0.099 Vali Loss: 1.259 Vali Acc: 0.520 Test Loss: 1.259 Test Acc: 0.520
Validation loss decreased (-0.479987 --> -0.519987).  Saving model ...
Epoch: 11 cost time: 3.8017616271972656
Epoch: 11, Steps: 4 | Train Loss: 0.072 Vali Loss: 1.290 Vali Acc: 0.480 Test Loss: 1.290 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.7609832286834717
Epoch: 12, Steps: 4 | Train Loss: 0.263 Vali Loss: 1.404 Vali Acc: 0.520 Test Loss: 1.404 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.7232046127319336
Epoch: 13, Steps: 4 | Train Loss: 0.024 Vali Loss: 1.518 Vali Acc: 0.540 Test Loss: 1.518 Test Acc: 0.540
Validation loss decreased (-0.519987 --> -0.539985).  Saving model ...
Epoch: 14 cost time: 3.400240659713745
Epoch: 14, Steps: 4 | Train Loss: 0.027 Vali Loss: 1.255 Vali Acc: 0.520 Test Loss: 1.255 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.7759807109832764
Epoch: 15, Steps: 4 | Train Loss: 0.014 Vali Loss: 1.369 Vali Acc: 0.460 Test Loss: 1.369 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.671312093734741
Epoch: 16, Steps: 4 | Train Loss: 0.014 Vali Loss: 1.442 Vali Acc: 0.560 Test Loss: 1.442 Test Acc: 0.560
Validation loss decreased (-0.539985 --> -0.559986).  Saving model ...
Epoch: 17 cost time: 3.7643799781799316
Epoch: 17, Steps: 4 | Train Loss: 0.007 Vali Loss: 1.543 Vali Acc: 0.540 Test Loss: 1.543 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.599503755569458
Epoch: 18, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.689 Vali Acc: 0.560 Test Loss: 1.689 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.5232439041137695
Epoch: 19, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.764 Vali Acc: 0.560 Test Loss: 1.764 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.5728232860565186
Epoch: 20, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.760 Vali Acc: 0.540 Test Loss: 1.760 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.5926880836486816
Epoch: 21, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.698 Vali Acc: 0.540 Test Loss: 1.698 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 3.6013028621673584
Epoch: 22, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.639 Vali Acc: 0.540 Test Loss: 1.639 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 3.6160659790039062
Epoch: 23, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.591 Vali Acc: 0.540 Test Loss: 1.591 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 3.540766716003418
Epoch: 24, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.582 Vali Acc: 0.540 Test Loss: 1.582 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 3.6071062088012695
Epoch: 25, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.534 Vali Acc: 0.540 Test Loss: 1.534 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 3.856382369995117
Epoch: 26, Steps: 4 | Train Loss: 0.001 Vali Loss: 1.504 Vali Acc: 0.560 Test Loss: 1.504 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm128_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 19436421
model size : 76.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm128_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.0722503662109375
Epoch: 1, Steps: 4 | Train Loss: 1.670 Vali Loss: 1.630 Vali Acc: 0.260 Test Loss: 1.630 Test Acc: 0.260
Validation loss decreased (inf --> -0.259984).  Saving model ...
Epoch: 2 cost time: 1.9718189239501953
Epoch: 2, Steps: 4 | Train Loss: 1.615 Vali Loss: 1.629 Vali Acc: 0.260 Test Loss: 1.629 Test Acc: 0.260
Validation loss decreased (-0.259984 --> -0.259984).  Saving model ...
Epoch: 3 cost time: 1.9774506092071533
Epoch: 3, Steps: 4 | Train Loss: 1.473 Vali Loss: 1.660 Vali Acc: 0.300 Test Loss: 1.660 Test Acc: 0.300
Validation loss decreased (-0.259984 --> -0.299983).  Saving model ...
Epoch: 4 cost time: 1.9970929622650146
Epoch: 4, Steps: 4 | Train Loss: 0.899 Vali Loss: 1.513 Vali Acc: 0.420 Test Loss: 1.513 Test Acc: 0.420
Validation loss decreased (-0.299983 --> -0.419985).  Saving model ...
Epoch: 5 cost time: 2.198638677597046
Epoch: 5, Steps: 4 | Train Loss: 0.725 Vali Loss: 1.434 Vali Acc: 0.420 Test Loss: 1.434 Test Acc: 0.420
Validation loss decreased (-0.419985 --> -0.419986).  Saving model ...
Epoch: 6 cost time: 2.1636385917663574
Epoch: 6, Steps: 4 | Train Loss: 0.601 Vali Loss: 1.381 Vali Acc: 0.520 Test Loss: 1.381 Test Acc: 0.520
Validation loss decreased (-0.419986 --> -0.519986).  Saving model ...
Epoch: 7 cost time: 2.2094874382019043
Epoch: 7, Steps: 4 | Train Loss: 0.324 Vali Loss: 1.334 Vali Acc: 0.480 Test Loss: 1.334 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.2898740768432617
Epoch: 8, Steps: 4 | Train Loss: 0.224 Vali Loss: 1.302 Vali Acc: 0.540 Test Loss: 1.302 Test Acc: 0.540
Validation loss decreased (-0.519986 --> -0.539987).  Saving model ...
Epoch: 9 cost time: 2.126116991043091
Epoch: 9, Steps: 4 | Train Loss: 0.175 Vali Loss: 1.324 Vali Acc: 0.560 Test Loss: 1.324 Test Acc: 0.560
Validation loss decreased (-0.539987 --> -0.559987).  Saving model ...
Epoch: 10 cost time: 2.253850221633911
Epoch: 10, Steps: 4 | Train Loss: 0.106 Vali Loss: 1.308 Vali Acc: 0.540 Test Loss: 1.308 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.132575750350952
Epoch: 11, Steps: 4 | Train Loss: 0.073 Vali Loss: 1.246 Vali Acc: 0.540 Test Loss: 1.246 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.293187141418457
Epoch: 12, Steps: 4 | Train Loss: 0.134 Vali Loss: 1.401 Vali Acc: 0.480 Test Loss: 1.401 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.2507643699645996
Epoch: 13, Steps: 4 | Train Loss: 0.044 Vali Loss: 1.464 Vali Acc: 0.520 Test Loss: 1.464 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.102663278579712
Epoch: 14, Steps: 4 | Train Loss: 0.078 Vali Loss: 1.842 Vali Acc: 0.500 Test Loss: 1.842 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.272700071334839
Epoch: 15, Steps: 4 | Train Loss: 0.057 Vali Loss: 1.418 Vali Acc: 0.540 Test Loss: 1.418 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.1885826587677
Epoch: 16, Steps: 4 | Train Loss: 0.010 Vali Loss: 1.401 Vali Acc: 0.520 Test Loss: 1.401 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.1435203552246094
Epoch: 17, Steps: 4 | Train Loss: 0.006 Vali Loss: 1.591 Vali Acc: 0.500 Test Loss: 1.591 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.249659299850464
Epoch: 18, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.715 Vali Acc: 0.500 Test Loss: 1.715 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.1620166301727295
Epoch: 19, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.667 Vali Acc: 0.520 Test Loss: 1.667 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm128_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 6197125
model size : 26.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm64_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 9.975551843643188
Epoch: 1, Steps: 4 | Train Loss: 1.677 Vali Loss: 1.580 Vali Acc: 0.300 Test Loss: 1.580 Test Acc: 0.300
Validation loss decreased (inf --> -0.299984).  Saving model ...
Epoch: 2 cost time: 7.928813457489014
Epoch: 2, Steps: 4 | Train Loss: 1.534 Vali Loss: 1.574 Vali Acc: 0.360 Test Loss: 1.574 Test Acc: 0.360
Validation loss decreased (-0.299984 --> -0.359984).  Saving model ...
Epoch: 3 cost time: 7.736740350723267
Epoch: 3, Steps: 4 | Train Loss: 1.405 Vali Loss: 1.599 Vali Acc: 0.420 Test Loss: 1.599 Test Acc: 0.420
Validation loss decreased (-0.359984 --> -0.419984).  Saving model ...
Epoch: 4 cost time: 7.134893178939819
Epoch: 4, Steps: 4 | Train Loss: 1.156 Vali Loss: 1.559 Vali Acc: 0.440 Test Loss: 1.559 Test Acc: 0.440
Validation loss decreased (-0.419984 --> -0.439984).  Saving model ...
Epoch: 5 cost time: 8.120830535888672
Epoch: 5, Steps: 4 | Train Loss: 0.986 Vali Loss: 1.475 Vali Acc: 0.480 Test Loss: 1.475 Test Acc: 0.480
Validation loss decreased (-0.439984 --> -0.479985).  Saving model ...
Epoch: 6 cost time: 8.391062259674072
Epoch: 6, Steps: 4 | Train Loss: 0.784 Vali Loss: 1.377 Vali Acc: 0.440 Test Loss: 1.377 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 7.971966505050659
Epoch: 7, Steps: 4 | Train Loss: 0.797 Vali Loss: 1.263 Vali Acc: 0.500 Test Loss: 1.263 Test Acc: 0.500
Validation loss decreased (-0.479985 --> -0.499987).  Saving model ...
Epoch: 8 cost time: 8.070529460906982
Epoch: 8, Steps: 4 | Train Loss: 0.435 Vali Loss: 1.211 Vali Acc: 0.500 Test Loss: 1.211 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499988).  Saving model ...
Epoch: 9 cost time: 7.7190399169921875
Epoch: 9, Steps: 4 | Train Loss: 0.449 Vali Loss: 1.169 Vali Acc: 0.540 Test Loss: 1.169 Test Acc: 0.540
Validation loss decreased (-0.499988 --> -0.539988).  Saving model ...
Epoch: 10 cost time: 7.457331895828247
Epoch: 10, Steps: 4 | Train Loss: 0.473 Vali Loss: 1.109 Vali Acc: 0.560 Test Loss: 1.109 Test Acc: 0.560
Validation loss decreased (-0.539988 --> -0.559989).  Saving model ...
Epoch: 11 cost time: 7.438474893569946
Epoch: 11, Steps: 4 | Train Loss: 0.193 Vali Loss: 1.102 Vali Acc: 0.580 Test Loss: 1.102 Test Acc: 0.580
Validation loss decreased (-0.559989 --> -0.579989).  Saving model ...
Epoch: 12 cost time: 7.735024929046631
Epoch: 12, Steps: 4 | Train Loss: 0.289 Vali Loss: 1.235 Vali Acc: 0.540 Test Loss: 1.235 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 7.480562448501587
Epoch: 13, Steps: 4 | Train Loss: 0.089 Vali Loss: 1.138 Vali Acc: 0.560 Test Loss: 1.138 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 7.696751356124878
Epoch: 14, Steps: 4 | Train Loss: 0.069 Vali Loss: 1.093 Vali Acc: 0.480 Test Loss: 1.093 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 7.559879541397095
Epoch: 15, Steps: 4 | Train Loss: 0.055 Vali Loss: 1.280 Vali Acc: 0.500 Test Loss: 1.280 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 7.320138454437256
Epoch: 16, Steps: 4 | Train Loss: 0.026 Vali Loss: 1.534 Vali Acc: 0.480 Test Loss: 1.534 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 7.6838672161102295
Epoch: 17, Steps: 4 | Train Loss: 0.035 Vali Loss: 1.354 Vali Acc: 0.560 Test Loss: 1.354 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 7.861554861068726
Epoch: 18, Steps: 4 | Train Loss: 0.022 Vali Loss: 1.361 Vali Acc: 0.560 Test Loss: 1.361 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 7.5353333950042725
Epoch: 19, Steps: 4 | Train Loss: 0.011 Vali Loss: 1.662 Vali Acc: 0.540 Test Loss: 1.662 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 7.687543869018555
Epoch: 20, Steps: 4 | Train Loss: 0.016 Vali Loss: 1.540 Vali Acc: 0.520 Test Loss: 1.540 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 7.7765960693359375
Epoch: 21, Steps: 4 | Train Loss: 0.010 Vali Loss: 1.666 Vali Acc: 0.520 Test Loss: 1.666 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm64_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 19092165
model size : 74.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm64_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 5.756299734115601
Epoch: 1, Steps: 4 | Train Loss: 1.696 Vali Loss: 1.657 Vali Acc: 0.300 Test Loss: 1.657 Test Acc: 0.300
Validation loss decreased (inf --> -0.299983).  Saving model ...
Epoch: 2 cost time: 3.959388494491577
Epoch: 2, Steps: 4 | Train Loss: 1.466 Vali Loss: 1.663 Vali Acc: 0.400 Test Loss: 1.663 Test Acc: 0.400
Validation loss decreased (-0.299983 --> -0.399983).  Saving model ...
Epoch: 3 cost time: 3.838913917541504
Epoch: 3, Steps: 4 | Train Loss: 1.397 Vali Loss: 1.635 Vali Acc: 0.360 Test Loss: 1.635 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.9871890544891357
Epoch: 4, Steps: 4 | Train Loss: 1.372 Vali Loss: 1.557 Vali Acc: 0.500 Test Loss: 1.557 Test Acc: 0.500
Validation loss decreased (-0.399983 --> -0.499984).  Saving model ...
Epoch: 5 cost time: 3.8964993953704834
Epoch: 5, Steps: 4 | Train Loss: 0.872 Vali Loss: 1.479 Vali Acc: 0.540 Test Loss: 1.479 Test Acc: 0.540
Validation loss decreased (-0.499984 --> -0.539985).  Saving model ...
Epoch: 6 cost time: 3.5963547229766846
Epoch: 6, Steps: 4 | Train Loss: 0.786 Vali Loss: 1.383 Vali Acc: 0.480 Test Loss: 1.383 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.969623565673828
Epoch: 7, Steps: 4 | Train Loss: 0.631 Vali Loss: 1.286 Vali Acc: 0.440 Test Loss: 1.286 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.802665948867798
Epoch: 8, Steps: 4 | Train Loss: 0.498 Vali Loss: 1.186 Vali Acc: 0.540 Test Loss: 1.186 Test Acc: 0.540
Validation loss decreased (-0.539985 --> -0.539988).  Saving model ...
Epoch: 9 cost time: 3.9374043941497803
Epoch: 9, Steps: 4 | Train Loss: 0.318 Vali Loss: 1.130 Vali Acc: 0.600 Test Loss: 1.130 Test Acc: 0.600
Validation loss decreased (-0.539988 --> -0.599989).  Saving model ...
Epoch: 10 cost time: 3.8074967861175537
Epoch: 10, Steps: 4 | Train Loss: 0.341 Vali Loss: 1.128 Vali Acc: 0.580 Test Loss: 1.128 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.7887485027313232
Epoch: 11, Steps: 4 | Train Loss: 0.205 Vali Loss: 1.169 Vali Acc: 0.520 Test Loss: 1.169 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.8850622177124023
Epoch: 12, Steps: 4 | Train Loss: 0.127 Vali Loss: 1.273 Vali Acc: 0.560 Test Loss: 1.273 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.634789228439331
Epoch: 13, Steps: 4 | Train Loss: 0.075 Vali Loss: 1.207 Vali Acc: 0.560 Test Loss: 1.207 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.8925631046295166
Epoch: 14, Steps: 4 | Train Loss: 0.111 Vali Loss: 1.174 Vali Acc: 0.640 Test Loss: 1.174 Test Acc: 0.640
Validation loss decreased (-0.599989 --> -0.639988).  Saving model ...
Epoch: 15 cost time: 3.931612491607666
Epoch: 15, Steps: 4 | Train Loss: 0.061 Vali Loss: 1.192 Vali Acc: 0.660 Test Loss: 1.192 Test Acc: 0.660
Validation loss decreased (-0.639988 --> -0.659988).  Saving model ...
Epoch: 16 cost time: 4.008396625518799
Epoch: 16, Steps: 4 | Train Loss: 0.032 Vali Loss: 1.112 Vali Acc: 0.600 Test Loss: 1.112 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.8272576332092285
Epoch: 17, Steps: 4 | Train Loss: 0.022 Vali Loss: 1.096 Vali Acc: 0.660 Test Loss: 1.096 Test Acc: 0.660
Validation loss decreased (-0.659988 --> -0.659989).  Saving model ...
Epoch: 18 cost time: 3.7909035682678223
Epoch: 18, Steps: 4 | Train Loss: 0.013 Vali Loss: 1.180 Vali Acc: 0.680 Test Loss: 1.180 Test Acc: 0.680
Validation loss decreased (-0.659989 --> -0.679988).  Saving model ...
Epoch: 19 cost time: 4.227593660354614
Epoch: 19, Steps: 4 | Train Loss: 0.014 Vali Loss: 1.137 Vali Acc: 0.640 Test Loss: 1.137 Test Acc: 0.640
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.016124248504639
Epoch: 20, Steps: 4 | Train Loss: 0.007 Vali Loss: 1.178 Vali Acc: 0.640 Test Loss: 1.178 Test Acc: 0.640
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 4.051694631576538
Epoch: 21, Steps: 4 | Train Loss: 0.018 Vali Loss: 1.220 Vali Acc: 0.640 Test Loss: 1.220 Test Acc: 0.640
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.8049557209014893
Epoch: 22, Steps: 4 | Train Loss: 0.008 Vali Loss: 1.342 Vali Acc: 0.640 Test Loss: 1.342 Test Acc: 0.640
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.9669840335845947
Epoch: 23, Steps: 4 | Train Loss: 0.014 Vali Loss: 1.358 Vali Acc: 0.620 Test Loss: 1.358 Test Acc: 0.620
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.9069437980651855
Epoch: 24, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.330 Vali Acc: 0.600 Test Loss: 1.330 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 3.938035488128662
Epoch: 25, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.354 Vali Acc: 0.560 Test Loss: 1.354 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 3.9405689239501953
Epoch: 26, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.400 Vali Acc: 0.560 Test Loss: 1.400 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 3.349884271621704
Epoch: 27, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.451 Vali Acc: 0.580 Test Loss: 1.451 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 3.3914742469787598
Epoch: 28, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.352 Vali Acc: 0.600 Test Loss: 1.352 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm64_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.68
model parameter : 5852613
model size : 23.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm64_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 8.432327270507812
Epoch: 1, Steps: 4 | Train Loss: 1.677 Vali Loss: 1.581 Vali Acc: 0.300 Test Loss: 1.581 Test Acc: 0.300
Validation loss decreased (inf --> -0.299984).  Saving model ...
Epoch: 2 cost time: 6.253843784332275
Epoch: 2, Steps: 4 | Train Loss: 1.534 Vali Loss: 1.575 Vali Acc: 0.360 Test Loss: 1.575 Test Acc: 0.360
Validation loss decreased (-0.299984 --> -0.359984).  Saving model ...
Epoch: 3 cost time: 6.3428404331207275
Epoch: 3, Steps: 4 | Train Loss: 1.405 Vali Loss: 1.601 Vali Acc: 0.420 Test Loss: 1.601 Test Acc: 0.420
Validation loss decreased (-0.359984 --> -0.419984).  Saving model ...
Epoch: 4 cost time: 6.6024041175842285
Epoch: 4, Steps: 4 | Train Loss: 1.152 Vali Loss: 1.562 Vali Acc: 0.440 Test Loss: 1.562 Test Acc: 0.440
Validation loss decreased (-0.419984 --> -0.439984).  Saving model ...
Epoch: 5 cost time: 6.225715637207031
Epoch: 5, Steps: 4 | Train Loss: 0.986 Vali Loss: 1.484 Vali Acc: 0.460 Test Loss: 1.484 Test Acc: 0.460
Validation loss decreased (-0.439984 --> -0.459985).  Saving model ...
Epoch: 6 cost time: 6.297426462173462
Epoch: 6, Steps: 4 | Train Loss: 0.785 Vali Loss: 1.392 Vali Acc: 0.440 Test Loss: 1.392 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.736708164215088
Epoch: 7, Steps: 4 | Train Loss: 0.797 Vali Loss: 1.281 Vali Acc: 0.500 Test Loss: 1.281 Test Acc: 0.500
Validation loss decreased (-0.459985 --> -0.499987).  Saving model ...
Epoch: 8 cost time: 5.6481101512908936
Epoch: 8, Steps: 4 | Train Loss: 0.435 Vali Loss: 1.218 Vali Acc: 0.500 Test Loss: 1.218 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499988).  Saving model ...
Epoch: 9 cost time: 6.012588024139404
Epoch: 9, Steps: 4 | Train Loss: 0.449 Vali Loss: 1.177 Vali Acc: 0.520 Test Loss: 1.177 Test Acc: 0.520
Validation loss decreased (-0.499988 --> -0.519988).  Saving model ...
Epoch: 10 cost time: 6.2914018630981445
Epoch: 10, Steps: 4 | Train Loss: 0.475 Vali Loss: 1.110 Vali Acc: 0.560 Test Loss: 1.110 Test Acc: 0.560
Validation loss decreased (-0.519988 --> -0.559989).  Saving model ...
Epoch: 11 cost time: 6.263056039810181
Epoch: 11, Steps: 4 | Train Loss: 0.192 Vali Loss: 1.103 Vali Acc: 0.580 Test Loss: 1.103 Test Acc: 0.580
Validation loss decreased (-0.559989 --> -0.579989).  Saving model ...
Epoch: 12 cost time: 6.306151628494263
Epoch: 12, Steps: 4 | Train Loss: 0.288 Vali Loss: 1.233 Vali Acc: 0.540 Test Loss: 1.233 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.105628728866577
Epoch: 13, Steps: 4 | Train Loss: 0.089 Vali Loss: 1.141 Vali Acc: 0.540 Test Loss: 1.141 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 6.0889058113098145
Epoch: 14, Steps: 4 | Train Loss: 0.063 Vali Loss: 1.078 Vali Acc: 0.540 Test Loss: 1.078 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 6.182268142700195
Epoch: 15, Steps: 4 | Train Loss: 0.055 Vali Loss: 1.210 Vali Acc: 0.460 Test Loss: 1.210 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 6.020703554153442
Epoch: 16, Steps: 4 | Train Loss: 0.030 Vali Loss: 1.452 Vali Acc: 0.480 Test Loss: 1.452 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 5.886557340621948
Epoch: 17, Steps: 4 | Train Loss: 0.036 Vali Loss: 1.286 Vali Acc: 0.500 Test Loss: 1.286 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 5.869444131851196
Epoch: 18, Steps: 4 | Train Loss: 0.024 Vali Loss: 1.317 Vali Acc: 0.560 Test Loss: 1.317 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 5.792369365692139
Epoch: 19, Steps: 4 | Train Loss: 0.008 Vali Loss: 1.621 Vali Acc: 0.540 Test Loss: 1.621 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 5.9493091106414795
Epoch: 20, Steps: 4 | Train Loss: 0.018 Vali Loss: 1.479 Vali Acc: 0.540 Test Loss: 1.479 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 5.852429628372192
Epoch: 21, Steps: 4 | Train Loss: 0.008 Vali Loss: 1.534 Vali Acc: 0.480 Test Loss: 1.534 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm64_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 19092165
model size : 74.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm64_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.980260848999023
Epoch: 1, Steps: 4 | Train Loss: 1.696 Vali Loss: 1.656 Vali Acc: 0.300 Test Loss: 1.656 Test Acc: 0.300
Validation loss decreased (inf --> -0.299983).  Saving model ...
Epoch: 2 cost time: 2.857358694076538
Epoch: 2, Steps: 4 | Train Loss: 1.466 Vali Loss: 1.663 Vali Acc: 0.400 Test Loss: 1.663 Test Acc: 0.400
Validation loss decreased (-0.299983 --> -0.399983).  Saving model ...
Epoch: 3 cost time: 2.9654619693756104
Epoch: 3, Steps: 4 | Train Loss: 1.399 Vali Loss: 1.636 Vali Acc: 0.360 Test Loss: 1.636 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.857081413269043
Epoch: 4, Steps: 4 | Train Loss: 1.372 Vali Loss: 1.559 Vali Acc: 0.500 Test Loss: 1.559 Test Acc: 0.500
Validation loss decreased (-0.399983 --> -0.499984).  Saving model ...
Epoch: 5 cost time: 3.01826810836792
Epoch: 5, Steps: 4 | Train Loss: 0.872 Vali Loss: 1.481 Vali Acc: 0.520 Test Loss: 1.481 Test Acc: 0.520
Validation loss decreased (-0.499984 --> -0.519985).  Saving model ...
Epoch: 6 cost time: 3.1107120513916016
Epoch: 6, Steps: 4 | Train Loss: 0.786 Vali Loss: 1.386 Vali Acc: 0.500 Test Loss: 1.386 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.9356751441955566
Epoch: 7, Steps: 4 | Train Loss: 0.644 Vali Loss: 1.288 Vali Acc: 0.460 Test Loss: 1.288 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.047053813934326
Epoch: 8, Steps: 4 | Train Loss: 0.504 Vali Loss: 1.185 Vali Acc: 0.560 Test Loss: 1.185 Test Acc: 0.560
Validation loss decreased (-0.519985 --> -0.559988).  Saving model ...
Epoch: 9 cost time: 2.9401161670684814
Epoch: 9, Steps: 4 | Train Loss: 0.319 Vali Loss: 1.124 Vali Acc: 0.640 Test Loss: 1.124 Test Acc: 0.640
Validation loss decreased (-0.559988 --> -0.639989).  Saving model ...
Epoch: 10 cost time: 2.649346351623535
Epoch: 10, Steps: 4 | Train Loss: 0.326 Vali Loss: 1.131 Vali Acc: 0.580 Test Loss: 1.131 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.780172109603882
Epoch: 11, Steps: 4 | Train Loss: 0.193 Vali Loss: 1.145 Vali Acc: 0.560 Test Loss: 1.145 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.811781644821167
Epoch: 12, Steps: 4 | Train Loss: 0.125 Vali Loss: 1.201 Vali Acc: 0.620 Test Loss: 1.201 Test Acc: 0.620
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.8167974948883057
Epoch: 13, Steps: 4 | Train Loss: 0.072 Vali Loss: 1.157 Vali Acc: 0.600 Test Loss: 1.157 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.989295482635498
Epoch: 14, Steps: 4 | Train Loss: 0.113 Vali Loss: 1.109 Vali Acc: 0.640 Test Loss: 1.109 Test Acc: 0.640
Validation loss decreased (-0.639989 --> -0.639989).  Saving model ...
Epoch: 15 cost time: 2.9099321365356445
Epoch: 15, Steps: 4 | Train Loss: 0.063 Vali Loss: 1.150 Vali Acc: 0.660 Test Loss: 1.150 Test Acc: 0.660
Validation loss decreased (-0.639989 --> -0.659988).  Saving model ...
Epoch: 16 cost time: 3.064213991165161
Epoch: 16, Steps: 4 | Train Loss: 0.035 Vali Loss: 1.119 Vali Acc: 0.640 Test Loss: 1.119 Test Acc: 0.640
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.9395809173583984
Epoch: 17, Steps: 4 | Train Loss: 0.024 Vali Loss: 1.086 Vali Acc: 0.660 Test Loss: 1.086 Test Acc: 0.660
Validation loss decreased (-0.659988 --> -0.659989).  Saving model ...
Epoch: 18 cost time: 3.0044891834259033
Epoch: 18, Steps: 4 | Train Loss: 0.015 Vali Loss: 1.149 Vali Acc: 0.640 Test Loss: 1.149 Test Acc: 0.640
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.288970708847046
Epoch: 19, Steps: 4 | Train Loss: 0.014 Vali Loss: 1.165 Vali Acc: 0.660 Test Loss: 1.165 Test Acc: 0.660
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.950387477874756
Epoch: 20, Steps: 4 | Train Loss: 0.007 Vali Loss: 1.170 Vali Acc: 0.620 Test Loss: 1.170 Test Acc: 0.620
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.1218347549438477
Epoch: 21, Steps: 4 | Train Loss: 0.020 Vali Loss: 1.197 Vali Acc: 0.620 Test Loss: 1.197 Test Acc: 0.620
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.0021932125091553
Epoch: 22, Steps: 4 | Train Loss: 0.008 Vali Loss: 1.326 Vali Acc: 0.620 Test Loss: 1.326 Test Acc: 0.620
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.6553993225097656
Epoch: 23, Steps: 4 | Train Loss: 0.017 Vali Loss: 1.210 Vali Acc: 0.640 Test Loss: 1.210 Test Acc: 0.640
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.51916241645813
Epoch: 24, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.213 Vali Acc: 0.520 Test Loss: 1.213 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.97525691986084
Epoch: 25, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.284 Vali Acc: 0.540 Test Loss: 1.284 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 3.054091691970825
Epoch: 26, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.335 Vali Acc: 0.540 Test Loss: 1.335 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.9591338634490967
Epoch: 27, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.344 Vali Acc: 0.560 Test Loss: 1.344 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm64_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.66
model parameter : 5852613
model size : 23.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm64_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 6.404892683029175
Epoch: 1, Steps: 4 | Train Loss: 1.676 Vali Loss: 1.581 Vali Acc: 0.300 Test Loss: 1.581 Test Acc: 0.300
Validation loss decreased (inf --> -0.299984).  Saving model ...
Epoch: 2 cost time: 3.9096274375915527
Epoch: 2, Steps: 4 | Train Loss: 1.532 Vali Loss: 1.575 Vali Acc: 0.360 Test Loss: 1.575 Test Acc: 0.360
Validation loss decreased (-0.299984 --> -0.359984).  Saving model ...
Epoch: 3 cost time: 4.278710842132568
Epoch: 3, Steps: 4 | Train Loss: 1.442 Vali Loss: 1.601 Vali Acc: 0.420 Test Loss: 1.601 Test Acc: 0.420
Validation loss decreased (-0.359984 --> -0.419984).  Saving model ...
Epoch: 4 cost time: 4.575073003768921
Epoch: 4, Steps: 4 | Train Loss: 1.173 Vali Loss: 1.561 Vali Acc: 0.440 Test Loss: 1.561 Test Acc: 0.440
Validation loss decreased (-0.419984 --> -0.439984).  Saving model ...
Epoch: 5 cost time: 3.991865396499634
Epoch: 5, Steps: 4 | Train Loss: 0.995 Vali Loss: 1.481 Vali Acc: 0.440 Test Loss: 1.481 Test Acc: 0.440
Validation loss decreased (-0.439984 --> -0.439985).  Saving model ...
Epoch: 6 cost time: 4.224752902984619
Epoch: 6, Steps: 4 | Train Loss: 0.796 Vali Loss: 1.387 Vali Acc: 0.440 Test Loss: 1.387 Test Acc: 0.440
Validation loss decreased (-0.439985 --> -0.439986).  Saving model ...
Epoch: 7 cost time: 4.2600998878479
Epoch: 7, Steps: 4 | Train Loss: 0.817 Vali Loss: 1.275 Vali Acc: 0.500 Test Loss: 1.275 Test Acc: 0.500
Validation loss decreased (-0.439986 --> -0.499987).  Saving model ...
Epoch: 8 cost time: 4.109396457672119
Epoch: 8, Steps: 4 | Train Loss: 0.448 Vali Loss: 1.222 Vali Acc: 0.480 Test Loss: 1.222 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.321213245391846
Epoch: 9, Steps: 4 | Train Loss: 0.453 Vali Loss: 1.186 Vali Acc: 0.520 Test Loss: 1.186 Test Acc: 0.520
Validation loss decreased (-0.499987 --> -0.519988).  Saving model ...
Epoch: 10 cost time: 4.2302281856536865
Epoch: 10, Steps: 4 | Train Loss: 0.493 Vali Loss: 1.136 Vali Acc: 0.520 Test Loss: 1.136 Test Acc: 0.520
Validation loss decreased (-0.519988 --> -0.519989).  Saving model ...
Epoch: 11 cost time: 4.08146071434021
Epoch: 11, Steps: 4 | Train Loss: 0.201 Vali Loss: 1.121 Vali Acc: 0.560 Test Loss: 1.121 Test Acc: 0.560
Validation loss decreased (-0.519989 --> -0.559989).  Saving model ...
Epoch: 12 cost time: 4.327643156051636
Epoch: 12, Steps: 4 | Train Loss: 0.304 Vali Loss: 1.260 Vali Acc: 0.520 Test Loss: 1.260 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.151622772216797
Epoch: 13, Steps: 4 | Train Loss: 0.108 Vali Loss: 1.143 Vali Acc: 0.540 Test Loss: 1.143 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.214054346084595
Epoch: 14, Steps: 4 | Train Loss: 0.065 Vali Loss: 1.140 Vali Acc: 0.460 Test Loss: 1.140 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.470195770263672
Epoch: 15, Steps: 4 | Train Loss: 0.061 Vali Loss: 1.319 Vali Acc: 0.480 Test Loss: 1.319 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 4.130748987197876
Epoch: 16, Steps: 4 | Train Loss: 0.034 Vali Loss: 1.496 Vali Acc: 0.500 Test Loss: 1.496 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 4.329082489013672
Epoch: 17, Steps: 4 | Train Loss: 0.033 Vali Loss: 1.259 Vali Acc: 0.520 Test Loss: 1.259 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 4.41965126991272
Epoch: 18, Steps: 4 | Train Loss: 0.023 Vali Loss: 1.265 Vali Acc: 0.540 Test Loss: 1.265 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 4.104538917541504
Epoch: 19, Steps: 4 | Train Loss: 0.014 Vali Loss: 1.487 Vali Acc: 0.500 Test Loss: 1.487 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 4.387576580047607
Epoch: 20, Steps: 4 | Train Loss: 0.014 Vali Loss: 1.381 Vali Acc: 0.480 Test Loss: 1.381 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 4.269774436950684
Epoch: 21, Steps: 4 | Train Loss: 0.012 Vali Loss: 1.527 Vali Acc: 0.480 Test Loss: 1.527 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm64_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 19092165
model size : 74.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm64_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.054854869842529
Epoch: 1, Steps: 4 | Train Loss: 1.694 Vali Loss: 1.652 Vali Acc: 0.300 Test Loss: 1.652 Test Acc: 0.300
Validation loss decreased (inf --> -0.299983).  Saving model ...
Epoch: 2 cost time: 1.859687328338623
Epoch: 2, Steps: 4 | Train Loss: 1.462 Vali Loss: 1.659 Vali Acc: 0.400 Test Loss: 1.659 Test Acc: 0.400
Validation loss decreased (-0.299983 --> -0.399983).  Saving model ...
Epoch: 3 cost time: 1.672609567642212
Epoch: 3, Steps: 4 | Train Loss: 1.403 Vali Loss: 1.632 Vali Acc: 0.360 Test Loss: 1.632 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8701794147491455
Epoch: 4, Steps: 4 | Train Loss: 1.374 Vali Loss: 1.555 Vali Acc: 0.500 Test Loss: 1.555 Test Acc: 0.500
Validation loss decreased (-0.399983 --> -0.499984).  Saving model ...
Epoch: 5 cost time: 1.936863899230957
Epoch: 5, Steps: 4 | Train Loss: 0.882 Vali Loss: 1.475 Vali Acc: 0.500 Test Loss: 1.475 Test Acc: 0.500
Validation loss decreased (-0.499984 --> -0.499985).  Saving model ...
Epoch: 6 cost time: 1.8575248718261719
Epoch: 6, Steps: 4 | Train Loss: 0.792 Vali Loss: 1.380 Vali Acc: 0.460 Test Loss: 1.380 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.12923526763916
Epoch: 7, Steps: 4 | Train Loss: 0.652 Vali Loss: 1.287 Vali Acc: 0.460 Test Loss: 1.287 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.0889852046966553
Epoch: 8, Steps: 4 | Train Loss: 0.521 Vali Loss: 1.190 Vali Acc: 0.540 Test Loss: 1.190 Test Acc: 0.540
Validation loss decreased (-0.499985 --> -0.539988).  Saving model ...
Epoch: 9 cost time: 2.079219341278076
Epoch: 9, Steps: 4 | Train Loss: 0.329 Vali Loss: 1.136 Vali Acc: 0.620 Test Loss: 1.136 Test Acc: 0.620
Validation loss decreased (-0.539988 --> -0.619989).  Saving model ...
Epoch: 10 cost time: 2.016153573989868
Epoch: 10, Steps: 4 | Train Loss: 0.339 Vali Loss: 1.120 Vali Acc: 0.580 Test Loss: 1.120 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.2888920307159424
Epoch: 11, Steps: 4 | Train Loss: 0.196 Vali Loss: 1.121 Vali Acc: 0.600 Test Loss: 1.121 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.9979896545410156
Epoch: 12, Steps: 4 | Train Loss: 0.152 Vali Loss: 1.205 Vali Acc: 0.580 Test Loss: 1.205 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.0245890617370605
Epoch: 13, Steps: 4 | Train Loss: 0.081 Vali Loss: 1.131 Vali Acc: 0.600 Test Loss: 1.131 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.0230069160461426
Epoch: 14, Steps: 4 | Train Loss: 0.116 Vali Loss: 1.117 Vali Acc: 0.620 Test Loss: 1.117 Test Acc: 0.620
Validation loss decreased (-0.619989 --> -0.619989).  Saving model ...
Epoch: 15 cost time: 1.9576170444488525
Epoch: 15, Steps: 4 | Train Loss: 0.067 Vali Loss: 1.153 Vali Acc: 0.640 Test Loss: 1.153 Test Acc: 0.640
Validation loss decreased (-0.619989 --> -0.639988).  Saving model ...
Epoch: 16 cost time: 2.069020986557007
Epoch: 16, Steps: 4 | Train Loss: 0.035 Vali Loss: 1.061 Vali Acc: 0.600 Test Loss: 1.061 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.116131544113159
Epoch: 17, Steps: 4 | Train Loss: 0.027 Vali Loss: 1.102 Vali Acc: 0.640 Test Loss: 1.102 Test Acc: 0.640
Validation loss decreased (-0.639988 --> -0.639989).  Saving model ...
Epoch: 18 cost time: 2.0050907135009766
Epoch: 18, Steps: 4 | Train Loss: 0.017 Vali Loss: 1.186 Vali Acc: 0.620 Test Loss: 1.186 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.0786807537078857
Epoch: 19, Steps: 4 | Train Loss: 0.017 Vali Loss: 1.120 Vali Acc: 0.580 Test Loss: 1.120 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.9802801609039307
Epoch: 20, Steps: 4 | Train Loss: 0.008 Vali Loss: 1.198 Vali Acc: 0.520 Test Loss: 1.198 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.951176643371582
Epoch: 21, Steps: 4 | Train Loss: 0.025 Vali Loss: 1.258 Vali Acc: 0.580 Test Loss: 1.258 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.067702531814575
Epoch: 22, Steps: 4 | Train Loss: 0.009 Vali Loss: 1.394 Vali Acc: 0.500 Test Loss: 1.394 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.074730396270752
Epoch: 23, Steps: 4 | Train Loss: 0.014 Vali Loss: 1.429 Vali Acc: 0.560 Test Loss: 1.429 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.0632922649383545
Epoch: 24, Steps: 4 | Train Loss: 0.007 Vali Loss: 1.354 Vali Acc: 0.520 Test Loss: 1.354 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.119007110595703
Epoch: 25, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.369 Vali Acc: 0.540 Test Loss: 1.369 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.1367435455322266
Epoch: 26, Steps: 4 | Train Loss: 0.006 Vali Loss: 1.427 Vali Acc: 0.540 Test Loss: 1.427 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.002873659133911
Epoch: 27, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.471 Vali Acc: 0.540 Test Loss: 1.471 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm64_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.64
model parameter : 5852613
model size : 23.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm64_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 6.647372007369995
Epoch: 1, Steps: 4 | Train Loss: 1.582 Vali Loss: 1.656 Vali Acc: 0.260 Test Loss: 1.656 Test Acc: 0.260
Validation loss decreased (inf --> -0.259983).  Saving model ...
Epoch: 2 cost time: 4.235121965408325
Epoch: 2, Steps: 4 | Train Loss: 1.494 Vali Loss: 1.626 Vali Acc: 0.300 Test Loss: 1.626 Test Acc: 0.300
Validation loss decreased (-0.259983 --> -0.299984).  Saving model ...
Epoch: 3 cost time: 4.112812280654907
Epoch: 3, Steps: 4 | Train Loss: 1.387 Vali Loss: 1.619 Vali Acc: 0.280 Test Loss: 1.619 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.458266019821167
Epoch: 4, Steps: 4 | Train Loss: 1.208 Vali Loss: 1.536 Vali Acc: 0.420 Test Loss: 1.536 Test Acc: 0.420
Validation loss decreased (-0.299984 --> -0.419985).  Saving model ...
Epoch: 5 cost time: 4.35374903678894
Epoch: 5, Steps: 4 | Train Loss: 1.074 Vali Loss: 1.450 Vali Acc: 0.480 Test Loss: 1.450 Test Acc: 0.480
Validation loss decreased (-0.419985 --> -0.479985).  Saving model ...
Epoch: 6 cost time: 4.800566673278809
Epoch: 6, Steps: 4 | Train Loss: 0.707 Vali Loss: 1.372 Vali Acc: 0.420 Test Loss: 1.372 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.56596302986145
Epoch: 7, Steps: 4 | Train Loss: 0.519 Vali Loss: 1.377 Vali Acc: 0.460 Test Loss: 1.377 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.639233589172363
Epoch: 8, Steps: 4 | Train Loss: 0.467 Vali Loss: 1.333 Vali Acc: 0.480 Test Loss: 1.333 Test Acc: 0.480
Validation loss decreased (-0.479985 --> -0.479987).  Saving model ...
Epoch: 9 cost time: 4.717993974685669
Epoch: 9, Steps: 4 | Train Loss: 0.338 Vali Loss: 1.260 Vali Acc: 0.460 Test Loss: 1.260 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.524531364440918
Epoch: 10, Steps: 4 | Train Loss: 0.377 Vali Loss: 1.270 Vali Acc: 0.500 Test Loss: 1.270 Test Acc: 0.500
Validation loss decreased (-0.479987 --> -0.499987).  Saving model ...
Epoch: 11 cost time: 4.622030258178711
Epoch: 11, Steps: 4 | Train Loss: 0.141 Vali Loss: 1.212 Vali Acc: 0.440 Test Loss: 1.212 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.21221661567688
Epoch: 12, Steps: 4 | Train Loss: 0.107 Vali Loss: 1.196 Vali Acc: 0.480 Test Loss: 1.196 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.085875511169434
Epoch: 13, Steps: 4 | Train Loss: 0.076 Vali Loss: 1.293 Vali Acc: 0.560 Test Loss: 1.293 Test Acc: 0.560
Validation loss decreased (-0.499987 --> -0.559987).  Saving model ...
Epoch: 14 cost time: 4.445264577865601
Epoch: 14, Steps: 4 | Train Loss: 0.067 Vali Loss: 1.302 Vali Acc: 0.500 Test Loss: 1.302 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.5709099769592285
Epoch: 15, Steps: 4 | Train Loss: 0.066 Vali Loss: 1.225 Vali Acc: 0.440 Test Loss: 1.225 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.41911768913269
Epoch: 16, Steps: 4 | Train Loss: 0.032 Vali Loss: 1.403 Vali Acc: 0.520 Test Loss: 1.403 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 4.880914926528931
Epoch: 17, Steps: 4 | Train Loss: 0.033 Vali Loss: 1.506 Vali Acc: 0.480 Test Loss: 1.506 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 5.186833381652832
Epoch: 18, Steps: 4 | Train Loss: 0.017 Vali Loss: 1.430 Vali Acc: 0.440 Test Loss: 1.430 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 4.9480366706848145
Epoch: 19, Steps: 4 | Train Loss: 0.016 Vali Loss: 1.422 Vali Acc: 0.480 Test Loss: 1.422 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 5.169080495834351
Epoch: 20, Steps: 4 | Train Loss: 0.009 Vali Loss: 1.530 Vali Acc: 0.460 Test Loss: 1.530 Test Acc: 0.460
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 4.9900641441345215
Epoch: 21, Steps: 4 | Train Loss: 0.014 Vali Loss: 1.532 Vali Acc: 0.500 Test Loss: 1.532 Test Acc: 0.500
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 4.958582878112793
Epoch: 22, Steps: 4 | Train Loss: 0.008 Vali Loss: 1.791 Vali Acc: 0.440 Test Loss: 1.791 Test Acc: 0.440
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 4.890556812286377
Epoch: 23, Steps: 4 | Train Loss: 0.008 Vali Loss: 1.733 Vali Acc: 0.520 Test Loss: 1.733 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm64_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 9718981
model size : 38.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm64_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 5.003421306610107
Epoch: 1, Steps: 4 | Train Loss: 1.681 Vali Loss: 1.711 Vali Acc: 0.260 Test Loss: 1.711 Test Acc: 0.260
Validation loss decreased (inf --> -0.259983).  Saving model ...
Epoch: 2 cost time: 2.6273443698883057
Epoch: 2, Steps: 4 | Train Loss: 1.550 Vali Loss: 1.660 Vali Acc: 0.300 Test Loss: 1.660 Test Acc: 0.300
Validation loss decreased (-0.259983 --> -0.299983).  Saving model ...
Epoch: 3 cost time: 2.803929328918457
Epoch: 3, Steps: 4 | Train Loss: 1.505 Vali Loss: 1.627 Vali Acc: 0.400 Test Loss: 1.627 Test Acc: 0.400
Validation loss decreased (-0.299983 --> -0.399984).  Saving model ...
Epoch: 4 cost time: 2.5638113021850586
Epoch: 4, Steps: 4 | Train Loss: 1.147 Vali Loss: 1.626 Vali Acc: 0.420 Test Loss: 1.626 Test Acc: 0.420
Validation loss decreased (-0.399984 --> -0.419984).  Saving model ...
Epoch: 5 cost time: 2.6810286045074463
Epoch: 5, Steps: 4 | Train Loss: 0.860 Vali Loss: 1.569 Vali Acc: 0.440 Test Loss: 1.569 Test Acc: 0.440
Validation loss decreased (-0.419984 --> -0.439984).  Saving model ...
Epoch: 6 cost time: 2.684091091156006
Epoch: 6, Steps: 4 | Train Loss: 0.786 Vali Loss: 1.489 Vali Acc: 0.500 Test Loss: 1.489 Test Acc: 0.500
Validation loss decreased (-0.439984 --> -0.499985).  Saving model ...
Epoch: 7 cost time: 2.682016372680664
Epoch: 7, Steps: 4 | Train Loss: 0.636 Vali Loss: 1.401 Vali Acc: 0.520 Test Loss: 1.401 Test Acc: 0.520
Validation loss decreased (-0.499985 --> -0.519986).  Saving model ...
Epoch: 8 cost time: 2.618199348449707
Epoch: 8, Steps: 4 | Train Loss: 0.469 Vali Loss: 1.302 Vali Acc: 0.540 Test Loss: 1.302 Test Acc: 0.540
Validation loss decreased (-0.519986 --> -0.539987).  Saving model ...
Epoch: 9 cost time: 2.7255520820617676
Epoch: 9, Steps: 4 | Train Loss: 0.416 Vali Loss: 1.216 Vali Acc: 0.540 Test Loss: 1.216 Test Acc: 0.540
Validation loss decreased (-0.539987 --> -0.539988).  Saving model ...
Epoch: 10 cost time: 2.827972650527954
Epoch: 10, Steps: 4 | Train Loss: 0.256 Vali Loss: 1.182 Vali Acc: 0.580 Test Loss: 1.182 Test Acc: 0.580
Validation loss decreased (-0.539988 --> -0.579988).  Saving model ...
Epoch: 11 cost time: 2.5168821811676025
Epoch: 11, Steps: 4 | Train Loss: 0.177 Vali Loss: 1.117 Vali Acc: 0.580 Test Loss: 1.117 Test Acc: 0.580
Validation loss decreased (-0.579988 --> -0.579989).  Saving model ...
Epoch: 12 cost time: 2.7385897636413574
Epoch: 12, Steps: 4 | Train Loss: 0.147 Vali Loss: 1.106 Vali Acc: 0.600 Test Loss: 1.106 Test Acc: 0.600
Validation loss decreased (-0.579989 --> -0.599989).  Saving model ...
Epoch: 13 cost time: 2.505735397338867
Epoch: 13, Steps: 4 | Train Loss: 0.102 Vali Loss: 1.224 Vali Acc: 0.520 Test Loss: 1.224 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.8179166316986084
Epoch: 14, Steps: 4 | Train Loss: 0.087 Vali Loss: 1.207 Vali Acc: 0.540 Test Loss: 1.207 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.7045745849609375
Epoch: 15, Steps: 4 | Train Loss: 0.139 Vali Loss: 1.251 Vali Acc: 0.600 Test Loss: 1.251 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.566455602645874
Epoch: 16, Steps: 4 | Train Loss: 0.036 Vali Loss: 1.435 Vali Acc: 0.600 Test Loss: 1.435 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.268129587173462
Epoch: 17, Steps: 4 | Train Loss: 0.048 Vali Loss: 1.313 Vali Acc: 0.580 Test Loss: 1.313 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.3797218799591064
Epoch: 18, Steps: 4 | Train Loss: 0.048 Vali Loss: 1.292 Vali Acc: 0.600 Test Loss: 1.292 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.5509982109069824
Epoch: 19, Steps: 4 | Train Loss: 0.018 Vali Loss: 1.282 Vali Acc: 0.600 Test Loss: 1.282 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.6177749633789062
Epoch: 20, Steps: 4 | Train Loss: 0.022 Vali Loss: 1.257 Vali Acc: 0.660 Test Loss: 1.257 Test Acc: 0.660
Validation loss decreased (-0.599989 --> -0.659987).  Saving model ...
Epoch: 21 cost time: 2.598310947418213
Epoch: 21, Steps: 4 | Train Loss: 0.008 Vali Loss: 1.249 Vali Acc: 0.520 Test Loss: 1.249 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.534520387649536
Epoch: 22, Steps: 4 | Train Loss: 0.017 Vali Loss: 1.253 Vali Acc: 0.560 Test Loss: 1.253 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.6044676303863525
Epoch: 23, Steps: 4 | Train Loss: 0.007 Vali Loss: 1.355 Vali Acc: 0.580 Test Loss: 1.355 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.584699869155884
Epoch: 24, Steps: 4 | Train Loss: 0.009 Vali Loss: 1.395 Vali Acc: 0.580 Test Loss: 1.395 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.754606008529663
Epoch: 25, Steps: 4 | Train Loss: 0.008 Vali Loss: 1.350 Vali Acc: 0.620 Test Loss: 1.350 Test Acc: 0.620
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.64877986907959
Epoch: 26, Steps: 4 | Train Loss: 0.006 Vali Loss: 1.286 Vali Acc: 0.620 Test Loss: 1.286 Test Acc: 0.620
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.7347571849823
Epoch: 27, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.277 Vali Acc: 0.620 Test Loss: 1.277 Test Acc: 0.620
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.2953081130981445
Epoch: 28, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.316 Vali Acc: 0.620 Test Loss: 1.316 Test Acc: 0.620
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.7155542373657227
Epoch: 29, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.342 Vali Acc: 0.620 Test Loss: 1.342 Test Acc: 0.620
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 2.8082265853881836
Epoch: 30, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.391 Vali Acc: 0.620 Test Loss: 1.391 Test Acc: 0.620
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm64_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.66
model parameter : 3099077
model size : 13.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm64_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 5.9639458656311035
Epoch: 1, Steps: 4 | Train Loss: 1.582 Vali Loss: 1.657 Vali Acc: 0.280 Test Loss: 1.657 Test Acc: 0.280
Validation loss decreased (inf --> -0.279983).  Saving model ...
Epoch: 2 cost time: 3.8073370456695557
Epoch: 2, Steps: 4 | Train Loss: 1.494 Vali Loss: 1.626 Vali Acc: 0.300 Test Loss: 1.626 Test Acc: 0.300
Validation loss decreased (-0.279983 --> -0.299984).  Saving model ...
Epoch: 3 cost time: 3.816312789916992
Epoch: 3, Steps: 4 | Train Loss: 1.387 Vali Loss: 1.620 Vali Acc: 0.280 Test Loss: 1.620 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.8793604373931885
Epoch: 4, Steps: 4 | Train Loss: 1.207 Vali Loss: 1.538 Vali Acc: 0.420 Test Loss: 1.538 Test Acc: 0.420
Validation loss decreased (-0.299984 --> -0.419985).  Saving model ...
Epoch: 5 cost time: 3.8964450359344482
Epoch: 5, Steps: 4 | Train Loss: 1.073 Vali Loss: 1.452 Vali Acc: 0.460 Test Loss: 1.452 Test Acc: 0.460
Validation loss decreased (-0.419985 --> -0.459985).  Saving model ...
Epoch: 6 cost time: 3.763152599334717
Epoch: 6, Steps: 4 | Train Loss: 0.702 Vali Loss: 1.365 Vali Acc: 0.420 Test Loss: 1.365 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.8511409759521484
Epoch: 7, Steps: 4 | Train Loss: 0.518 Vali Loss: 1.378 Vali Acc: 0.440 Test Loss: 1.378 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.4808130264282227
Epoch: 8, Steps: 4 | Train Loss: 0.466 Vali Loss: 1.337 Vali Acc: 0.480 Test Loss: 1.337 Test Acc: 0.480
Validation loss decreased (-0.459985 --> -0.479987).  Saving model ...
Epoch: 9 cost time: 3.884514808654785
Epoch: 9, Steps: 4 | Train Loss: 0.338 Vali Loss: 1.269 Vali Acc: 0.460 Test Loss: 1.269 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.8103713989257812
Epoch: 10, Steps: 4 | Train Loss: 0.376 Vali Loss: 1.285 Vali Acc: 0.500 Test Loss: 1.285 Test Acc: 0.500
Validation loss decreased (-0.479987 --> -0.499987).  Saving model ...
Epoch: 11 cost time: 3.9459476470947266
Epoch: 11, Steps: 4 | Train Loss: 0.145 Vali Loss: 1.232 Vali Acc: 0.480 Test Loss: 1.232 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.674264907836914
Epoch: 12, Steps: 4 | Train Loss: 0.106 Vali Loss: 1.221 Vali Acc: 0.460 Test Loss: 1.221 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.8843727111816406
Epoch: 13, Steps: 4 | Train Loss: 0.074 Vali Loss: 1.301 Vali Acc: 0.540 Test Loss: 1.301 Test Acc: 0.540
Validation loss decreased (-0.499987 --> -0.539987).  Saving model ...
Epoch: 14 cost time: 3.921262502670288
Epoch: 14, Steps: 4 | Train Loss: 0.065 Vali Loss: 1.333 Vali Acc: 0.500 Test Loss: 1.333 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.938894510269165
Epoch: 15, Steps: 4 | Train Loss: 0.056 Vali Loss: 1.251 Vali Acc: 0.460 Test Loss: 1.251 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.7240946292877197
Epoch: 16, Steps: 4 | Train Loss: 0.031 Vali Loss: 1.403 Vali Acc: 0.520 Test Loss: 1.403 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.6177926063537598
Epoch: 17, Steps: 4 | Train Loss: 0.040 Vali Loss: 1.520 Vali Acc: 0.500 Test Loss: 1.520 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 4.0020432472229
Epoch: 18, Steps: 4 | Train Loss: 0.019 Vali Loss: 1.508 Vali Acc: 0.500 Test Loss: 1.508 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.8545501232147217
Epoch: 19, Steps: 4 | Train Loss: 0.020 Vali Loss: 1.493 Vali Acc: 0.520 Test Loss: 1.493 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 4.121412992477417
Epoch: 20, Steps: 4 | Train Loss: 0.011 Vali Loss: 1.545 Vali Acc: 0.500 Test Loss: 1.545 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.866203546524048
Epoch: 21, Steps: 4 | Train Loss: 0.015 Vali Loss: 1.460 Vali Acc: 0.520 Test Loss: 1.460 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 4.129913806915283
Epoch: 22, Steps: 4 | Train Loss: 0.009 Vali Loss: 1.644 Vali Acc: 0.460 Test Loss: 1.644 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.8793795108795166
Epoch: 23, Steps: 4 | Train Loss: 0.008 Vali Loss: 1.638 Vali Acc: 0.540 Test Loss: 1.638 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm64_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 9718981
model size : 38.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm64_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.305490016937256
Epoch: 1, Steps: 4 | Train Loss: 1.682 Vali Loss: 1.714 Vali Acc: 0.260 Test Loss: 1.714 Test Acc: 0.260
Validation loss decreased (inf --> -0.259983).  Saving model ...
Epoch: 2 cost time: 2.214468002319336
Epoch: 2, Steps: 4 | Train Loss: 1.556 Vali Loss: 1.664 Vali Acc: 0.300 Test Loss: 1.664 Test Acc: 0.300
Validation loss decreased (-0.259983 --> -0.299983).  Saving model ...
Epoch: 3 cost time: 2.1105000972747803
Epoch: 3, Steps: 4 | Train Loss: 1.505 Vali Loss: 1.626 Vali Acc: 0.380 Test Loss: 1.626 Test Acc: 0.380
Validation loss decreased (-0.299983 --> -0.379984).  Saving model ...
Epoch: 4 cost time: 2.2578678131103516
Epoch: 4, Steps: 4 | Train Loss: 1.146 Vali Loss: 1.625 Vali Acc: 0.420 Test Loss: 1.625 Test Acc: 0.420
Validation loss decreased (-0.379984 --> -0.419984).  Saving model ...
Epoch: 5 cost time: 2.2259035110473633
Epoch: 5, Steps: 4 | Train Loss: 0.897 Vali Loss: 1.571 Vali Acc: 0.460 Test Loss: 1.571 Test Acc: 0.460
Validation loss decreased (-0.419984 --> -0.459984).  Saving model ...
Epoch: 6 cost time: 2.3177709579467773
Epoch: 6, Steps: 4 | Train Loss: 0.785 Vali Loss: 1.500 Vali Acc: 0.500 Test Loss: 1.500 Test Acc: 0.500
Validation loss decreased (-0.459984 --> -0.499985).  Saving model ...
Epoch: 7 cost time: 2.2372748851776123
Epoch: 7, Steps: 4 | Train Loss: 0.633 Vali Loss: 1.410 Vali Acc: 0.500 Test Loss: 1.410 Test Acc: 0.500
Validation loss decreased (-0.499985 --> -0.499986).  Saving model ...
Epoch: 8 cost time: 2.16937255859375
Epoch: 8, Steps: 4 | Train Loss: 0.469 Vali Loss: 1.303 Vali Acc: 0.540 Test Loss: 1.303 Test Acc: 0.540
Validation loss decreased (-0.499986 --> -0.539987).  Saving model ...
Epoch: 9 cost time: 2.3225886821746826
Epoch: 9, Steps: 4 | Train Loss: 0.415 Vali Loss: 1.216 Vali Acc: 0.520 Test Loss: 1.216 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.282684087753296
Epoch: 10, Steps: 4 | Train Loss: 0.255 Vali Loss: 1.188 Vali Acc: 0.540 Test Loss: 1.188 Test Acc: 0.540
Validation loss decreased (-0.539987 --> -0.539988).  Saving model ...
Epoch: 11 cost time: 2.0413427352905273
Epoch: 11, Steps: 4 | Train Loss: 0.176 Vali Loss: 1.120 Vali Acc: 0.580 Test Loss: 1.120 Test Acc: 0.580
Validation loss decreased (-0.539988 --> -0.579989).  Saving model ...
Epoch: 12 cost time: 2.515512704849243
Epoch: 12, Steps: 4 | Train Loss: 0.145 Vali Loss: 1.109 Vali Acc: 0.620 Test Loss: 1.109 Test Acc: 0.620
Validation loss decreased (-0.579989 --> -0.619989).  Saving model ...
Epoch: 13 cost time: 2.2015600204467773
Epoch: 13, Steps: 4 | Train Loss: 0.101 Vali Loss: 1.230 Vali Acc: 0.560 Test Loss: 1.230 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.1978085041046143
Epoch: 14, Steps: 4 | Train Loss: 0.088 Vali Loss: 1.214 Vali Acc: 0.540 Test Loss: 1.214 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.299010992050171
Epoch: 15, Steps: 4 | Train Loss: 0.141 Vali Loss: 1.276 Vali Acc: 0.600 Test Loss: 1.276 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.143671751022339
Epoch: 16, Steps: 4 | Train Loss: 0.036 Vali Loss: 1.483 Vali Acc: 0.580 Test Loss: 1.483 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.2483856678009033
Epoch: 17, Steps: 4 | Train Loss: 0.048 Vali Loss: 1.368 Vali Acc: 0.560 Test Loss: 1.368 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.24458646774292
Epoch: 18, Steps: 4 | Train Loss: 0.046 Vali Loss: 1.332 Vali Acc: 0.580 Test Loss: 1.332 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.238137722015381
Epoch: 19, Steps: 4 | Train Loss: 0.019 Vali Loss: 1.317 Vali Acc: 0.580 Test Loss: 1.317 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.2884297370910645
Epoch: 20, Steps: 4 | Train Loss: 0.021 Vali Loss: 1.283 Vali Acc: 0.640 Test Loss: 1.283 Test Acc: 0.640
Validation loss decreased (-0.619989 --> -0.639987).  Saving model ...
Epoch: 21 cost time: 2.3092896938323975
Epoch: 21, Steps: 4 | Train Loss: 0.010 Vali Loss: 1.252 Vali Acc: 0.540 Test Loss: 1.252 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.195783853530884
Epoch: 22, Steps: 4 | Train Loss: 0.018 Vali Loss: 1.236 Vali Acc: 0.580 Test Loss: 1.236 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.135267496109009
Epoch: 23, Steps: 4 | Train Loss: 0.006 Vali Loss: 1.330 Vali Acc: 0.540 Test Loss: 1.330 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.1862142086029053
Epoch: 24, Steps: 4 | Train Loss: 0.010 Vali Loss: 1.376 Vali Acc: 0.560 Test Loss: 1.376 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.1773300170898438
Epoch: 25, Steps: 4 | Train Loss: 0.008 Vali Loss: 1.352 Vali Acc: 0.600 Test Loss: 1.352 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.2521424293518066
Epoch: 26, Steps: 4 | Train Loss: 0.006 Vali Loss: 1.289 Vali Acc: 0.620 Test Loss: 1.289 Test Acc: 0.620
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.0802016258239746
Epoch: 27, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.272 Vali Acc: 0.640 Test Loss: 1.272 Test Acc: 0.640
Validation loss decreased (-0.639987 --> -0.639987).  Saving model ...
Epoch: 28 cost time: 2.2028939723968506
Epoch: 28, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.314 Vali Acc: 0.620 Test Loss: 1.314 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.1960864067077637
Epoch: 29, Steps: 4 | Train Loss: 0.021 Vali Loss: 1.322 Vali Acc: 0.600 Test Loss: 1.322 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.3218398094177246
Epoch: 30, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.527 Vali Acc: 0.580 Test Loss: 1.527 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm64_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.64
model parameter : 3099077
model size : 13.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm64_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 5.140575170516968
Epoch: 1, Steps: 4 | Train Loss: 1.579 Vali Loss: 1.652 Vali Acc: 0.280 Test Loss: 1.652 Test Acc: 0.280
Validation loss decreased (inf --> -0.279983).  Saving model ...
Epoch: 2 cost time: 2.4067492485046387
Epoch: 2, Steps: 4 | Train Loss: 1.495 Vali Loss: 1.619 Vali Acc: 0.300 Test Loss: 1.619 Test Acc: 0.300
Validation loss decreased (-0.279983 --> -0.299984).  Saving model ...
Epoch: 3 cost time: 2.821807622909546
Epoch: 3, Steps: 4 | Train Loss: 1.389 Vali Loss: 1.615 Vali Acc: 0.280 Test Loss: 1.615 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.777902126312256
Epoch: 4, Steps: 4 | Train Loss: 1.212 Vali Loss: 1.533 Vali Acc: 0.440 Test Loss: 1.533 Test Acc: 0.440
Validation loss decreased (-0.299984 --> -0.439985).  Saving model ...
Epoch: 5 cost time: 2.6020078659057617
Epoch: 5, Steps: 4 | Train Loss: 1.082 Vali Loss: 1.446 Vali Acc: 0.460 Test Loss: 1.446 Test Acc: 0.460
Validation loss decreased (-0.439985 --> -0.459986).  Saving model ...
Epoch: 6 cost time: 2.978654384613037
Epoch: 6, Steps: 4 | Train Loss: 0.706 Vali Loss: 1.358 Vali Acc: 0.400 Test Loss: 1.358 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.7690043449401855
Epoch: 7, Steps: 4 | Train Loss: 0.527 Vali Loss: 1.372 Vali Acc: 0.420 Test Loss: 1.372 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.98028826713562
Epoch: 8, Steps: 4 | Train Loss: 0.467 Vali Loss: 1.338 Vali Acc: 0.480 Test Loss: 1.338 Test Acc: 0.480
Validation loss decreased (-0.459986 --> -0.479987).  Saving model ...
Epoch: 9 cost time: 2.557609796524048
Epoch: 9, Steps: 4 | Train Loss: 0.352 Vali Loss: 1.277 Vali Acc: 0.480 Test Loss: 1.277 Test Acc: 0.480
Validation loss decreased (-0.479987 --> -0.479987).  Saving model ...
Epoch: 10 cost time: 2.8994009494781494
Epoch: 10, Steps: 4 | Train Loss: 0.381 Vali Loss: 1.304 Vali Acc: 0.480 Test Loss: 1.304 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.7642524242401123
Epoch: 11, Steps: 4 | Train Loss: 0.166 Vali Loss: 1.238 Vali Acc: 0.440 Test Loss: 1.238 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.698012590408325
Epoch: 12, Steps: 4 | Train Loss: 0.110 Vali Loss: 1.203 Vali Acc: 0.480 Test Loss: 1.203 Test Acc: 0.480
Validation loss decreased (-0.479987 --> -0.479988).  Saving model ...
Epoch: 13 cost time: 2.751957654953003
Epoch: 13, Steps: 4 | Train Loss: 0.086 Vali Loss: 1.286 Vali Acc: 0.540 Test Loss: 1.286 Test Acc: 0.540
Validation loss decreased (-0.479988 --> -0.539987).  Saving model ...
Epoch: 14 cost time: 2.734445095062256
Epoch: 14, Steps: 4 | Train Loss: 0.070 Vali Loss: 1.303 Vali Acc: 0.500 Test Loss: 1.303 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.9052515029907227
Epoch: 15, Steps: 4 | Train Loss: 0.066 Vali Loss: 1.253 Vali Acc: 0.500 Test Loss: 1.253 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.71354341506958
Epoch: 16, Steps: 4 | Train Loss: 0.034 Vali Loss: 1.365 Vali Acc: 0.480 Test Loss: 1.365 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.8777034282684326
Epoch: 17, Steps: 4 | Train Loss: 0.029 Vali Loss: 1.480 Vali Acc: 0.500 Test Loss: 1.480 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.9566690921783447
Epoch: 18, Steps: 4 | Train Loss: 0.017 Vali Loss: 1.388 Vali Acc: 0.500 Test Loss: 1.388 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.931626796722412
Epoch: 19, Steps: 4 | Train Loss: 0.016 Vali Loss: 1.325 Vali Acc: 0.540 Test Loss: 1.325 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.8321454524993896
Epoch: 20, Steps: 4 | Train Loss: 0.010 Vali Loss: 1.392 Vali Acc: 0.560 Test Loss: 1.392 Test Acc: 0.560
Validation loss decreased (-0.539987 --> -0.559986).  Saving model ...
Epoch: 21 cost time: 2.7683026790618896
Epoch: 21, Steps: 4 | Train Loss: 0.014 Vali Loss: 1.391 Vali Acc: 0.520 Test Loss: 1.391 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.8282370567321777
Epoch: 22, Steps: 4 | Train Loss: 0.008 Vali Loss: 1.643 Vali Acc: 0.440 Test Loss: 1.643 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.633150815963745
Epoch: 23, Steps: 4 | Train Loss: 0.009 Vali Loss: 1.476 Vali Acc: 0.500 Test Loss: 1.476 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.5055956840515137
Epoch: 24, Steps: 4 | Train Loss: 0.008 Vali Loss: 1.343 Vali Acc: 0.540 Test Loss: 1.343 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.7120420932769775
Epoch: 25, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.363 Vali Acc: 0.520 Test Loss: 1.363 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.6440439224243164
Epoch: 26, Steps: 4 | Train Loss: 0.009 Vali Loss: 1.413 Vali Acc: 0.580 Test Loss: 1.413 Test Acc: 0.580
Validation loss decreased (-0.559986 --> -0.579986).  Saving model ...
Epoch: 27 cost time: 2.5566744804382324
Epoch: 27, Steps: 4 | Train Loss: 0.007 Vali Loss: 1.525 Vali Acc: 0.560 Test Loss: 1.525 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.6851162910461426
Epoch: 28, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.469 Vali Acc: 0.520 Test Loss: 1.469 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.696197271347046
Epoch: 29, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.475 Vali Acc: 0.520 Test Loss: 1.475 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.548358201980591
Epoch: 30, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.504 Vali Acc: 0.520 Test Loss: 1.504 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm64_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 9718981
model size : 38.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm64_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.6980910301208496
Epoch: 1, Steps: 4 | Train Loss: 1.681 Vali Loss: 1.713 Vali Acc: 0.260 Test Loss: 1.713 Test Acc: 0.260
Validation loss decreased (inf --> -0.259983).  Saving model ...
Epoch: 2 cost time: 1.7771179676055908
Epoch: 2, Steps: 4 | Train Loss: 1.556 Vali Loss: 1.663 Vali Acc: 0.300 Test Loss: 1.663 Test Acc: 0.300
Validation loss decreased (-0.259983 --> -0.299983).  Saving model ...
Epoch: 3 cost time: 1.7046332359313965
Epoch: 3, Steps: 4 | Train Loss: 1.505 Vali Loss: 1.630 Vali Acc: 0.380 Test Loss: 1.630 Test Acc: 0.380
Validation loss decreased (-0.299983 --> -0.379984).  Saving model ...
Epoch: 4 cost time: 1.5008931159973145
Epoch: 4, Steps: 4 | Train Loss: 1.149 Vali Loss: 1.629 Vali Acc: 0.400 Test Loss: 1.629 Test Acc: 0.400
Validation loss decreased (-0.379984 --> -0.399984).  Saving model ...
Epoch: 5 cost time: 1.7129812240600586
Epoch: 5, Steps: 4 | Train Loss: 0.905 Vali Loss: 1.573 Vali Acc: 0.440 Test Loss: 1.573 Test Acc: 0.440
Validation loss decreased (-0.399984 --> -0.439984).  Saving model ...
Epoch: 6 cost time: 1.742619514465332
Epoch: 6, Steps: 4 | Train Loss: 0.791 Vali Loss: 1.501 Vali Acc: 0.480 Test Loss: 1.501 Test Acc: 0.480
Validation loss decreased (-0.439984 --> -0.479985).  Saving model ...
Epoch: 7 cost time: 1.645505428314209
Epoch: 7, Steps: 4 | Train Loss: 0.663 Vali Loss: 1.410 Vali Acc: 0.500 Test Loss: 1.410 Test Acc: 0.500
Validation loss decreased (-0.479985 --> -0.499986).  Saving model ...
Epoch: 8 cost time: 1.6491076946258545
Epoch: 8, Steps: 4 | Train Loss: 0.476 Vali Loss: 1.299 Vali Acc: 0.520 Test Loss: 1.299 Test Acc: 0.520
Validation loss decreased (-0.499986 --> -0.519987).  Saving model ...
Epoch: 9 cost time: 1.7350246906280518
Epoch: 9, Steps: 4 | Train Loss: 0.419 Vali Loss: 1.211 Vali Acc: 0.500 Test Loss: 1.211 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6405830383300781
Epoch: 10, Steps: 4 | Train Loss: 0.263 Vali Loss: 1.182 Vali Acc: 0.600 Test Loss: 1.182 Test Acc: 0.600
Validation loss decreased (-0.519987 --> -0.599988).  Saving model ...
Epoch: 11 cost time: 1.4483015537261963
Epoch: 11, Steps: 4 | Train Loss: 0.182 Vali Loss: 1.117 Vali Acc: 0.580 Test Loss: 1.117 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.7196602821350098
Epoch: 12, Steps: 4 | Train Loss: 0.156 Vali Loss: 1.106 Vali Acc: 0.620 Test Loss: 1.106 Test Acc: 0.620
Validation loss decreased (-0.599988 --> -0.619989).  Saving model ...
Epoch: 13 cost time: 1.5559673309326172
Epoch: 13, Steps: 4 | Train Loss: 0.108 Vali Loss: 1.196 Vali Acc: 0.540 Test Loss: 1.196 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6871111392974854
Epoch: 14, Steps: 4 | Train Loss: 0.086 Vali Loss: 1.180 Vali Acc: 0.580 Test Loss: 1.180 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.6307291984558105
Epoch: 15, Steps: 4 | Train Loss: 0.146 Vali Loss: 1.229 Vali Acc: 0.620 Test Loss: 1.229 Test Acc: 0.620
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.7428438663482666
Epoch: 16, Steps: 4 | Train Loss: 0.038 Vali Loss: 1.402 Vali Acc: 0.600 Test Loss: 1.402 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.5916852951049805
Epoch: 17, Steps: 4 | Train Loss: 0.047 Vali Loss: 1.283 Vali Acc: 0.560 Test Loss: 1.283 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.438481092453003
Epoch: 18, Steps: 4 | Train Loss: 0.054 Vali Loss: 1.267 Vali Acc: 0.580 Test Loss: 1.267 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.6422758102416992
Epoch: 19, Steps: 4 | Train Loss: 0.018 Vali Loss: 1.233 Vali Acc: 0.600 Test Loss: 1.233 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.7019596099853516
Epoch: 20, Steps: 4 | Train Loss: 0.020 Vali Loss: 1.196 Vali Acc: 0.660 Test Loss: 1.196 Test Acc: 0.660
Validation loss decreased (-0.619989 --> -0.659988).  Saving model ...
Epoch: 21 cost time: 1.678529977798462
Epoch: 21, Steps: 4 | Train Loss: 0.009 Vali Loss: 1.255 Vali Acc: 0.540 Test Loss: 1.255 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.6817939281463623
Epoch: 22, Steps: 4 | Train Loss: 0.017 Vali Loss: 1.256 Vali Acc: 0.560 Test Loss: 1.256 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.5681428909301758
Epoch: 23, Steps: 4 | Train Loss: 0.008 Vali Loss: 1.359 Vali Acc: 0.560 Test Loss: 1.359 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.5035877227783203
Epoch: 24, Steps: 4 | Train Loss: 0.011 Vali Loss: 1.343 Vali Acc: 0.560 Test Loss: 1.343 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.7035479545593262
Epoch: 25, Steps: 4 | Train Loss: 0.008 Vali Loss: 1.283 Vali Acc: 0.600 Test Loss: 1.283 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.5336904525756836
Epoch: 26, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.252 Vali Acc: 0.600 Test Loss: 1.252 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.7247090339660645
Epoch: 27, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.264 Vali Acc: 0.620 Test Loss: 1.264 Test Acc: 0.620
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.586747169494629
Epoch: 28, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.302 Vali Acc: 0.600 Test Loss: 1.302 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.480048418045044
Epoch: 29, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.340 Vali Acc: 0.580 Test Loss: 1.340 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.6600112915039062
Epoch: 30, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.409 Vali Acc: 0.600 Test Loss: 1.409 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm64_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.66
model parameter : 3099077
model size : 13.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm64_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 5.124898910522461
Epoch: 1, Steps: 4 | Train Loss: 1.576 Vali Loss: 1.597 Vali Acc: 0.240 Test Loss: 1.597 Test Acc: 0.240
Validation loss decreased (inf --> -0.239984).  Saving model ...
Epoch: 2 cost time: 3.472248077392578
Epoch: 2, Steps: 4 | Train Loss: 1.548 Vali Loss: 1.552 Vali Acc: 0.320 Test Loss: 1.552 Test Acc: 0.320
Validation loss decreased (-0.239984 --> -0.319984).  Saving model ...
Epoch: 3 cost time: 3.2104110717773438
Epoch: 3, Steps: 4 | Train Loss: 1.410 Vali Loss: 1.532 Vali Acc: 0.300 Test Loss: 1.532 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.00138258934021
Epoch: 4, Steps: 4 | Train Loss: 1.109 Vali Loss: 1.505 Vali Acc: 0.320 Test Loss: 1.505 Test Acc: 0.320
Validation loss decreased (-0.319984 --> -0.319985).  Saving model ...
Epoch: 5 cost time: 3.058037519454956
Epoch: 5, Steps: 4 | Train Loss: 0.904 Vali Loss: 1.435 Vali Acc: 0.420 Test Loss: 1.435 Test Acc: 0.420
Validation loss decreased (-0.319985 --> -0.419986).  Saving model ...
Epoch: 6 cost time: 3.6550872325897217
Epoch: 6, Steps: 4 | Train Loss: 0.695 Vali Loss: 1.379 Vali Acc: 0.380 Test Loss: 1.379 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.230823040008545
Epoch: 7, Steps: 4 | Train Loss: 0.675 Vali Loss: 1.298 Vali Acc: 0.460 Test Loss: 1.298 Test Acc: 0.460
Validation loss decreased (-0.419986 --> -0.459987).  Saving model ...
Epoch: 8 cost time: 3.2164154052734375
Epoch: 8, Steps: 4 | Train Loss: 0.559 Vali Loss: 1.245 Vali Acc: 0.520 Test Loss: 1.245 Test Acc: 0.520
Validation loss decreased (-0.459987 --> -0.519988).  Saving model ...
Epoch: 9 cost time: 3.4554858207702637
Epoch: 9, Steps: 4 | Train Loss: 0.352 Vali Loss: 1.238 Vali Acc: 0.480 Test Loss: 1.238 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.2857015132904053
Epoch: 10, Steps: 4 | Train Loss: 0.541 Vali Loss: 1.327 Vali Acc: 0.520 Test Loss: 1.327 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.902501344680786
Epoch: 11, Steps: 4 | Train Loss: 0.196 Vali Loss: 1.308 Vali Acc: 0.460 Test Loss: 1.308 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.9470415115356445
Epoch: 12, Steps: 4 | Train Loss: 0.125 Vali Loss: 1.322 Vali Acc: 0.560 Test Loss: 1.322 Test Acc: 0.560
Validation loss decreased (-0.519988 --> -0.559987).  Saving model ...
Epoch: 13 cost time: 2.907905340194702
Epoch: 13, Steps: 4 | Train Loss: 0.114 Vali Loss: 1.369 Vali Acc: 0.480 Test Loss: 1.369 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.291832685470581
Epoch: 14, Steps: 4 | Train Loss: 0.062 Vali Loss: 1.351 Vali Acc: 0.480 Test Loss: 1.351 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.5501110553741455
Epoch: 15, Steps: 4 | Train Loss: 0.051 Vali Loss: 1.397 Vali Acc: 0.520 Test Loss: 1.397 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.3610341548919678
Epoch: 16, Steps: 4 | Train Loss: 0.048 Vali Loss: 1.462 Vali Acc: 0.540 Test Loss: 1.462 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.4203240871429443
Epoch: 17, Steps: 4 | Train Loss: 0.152 Vali Loss: 1.415 Vali Acc: 0.540 Test Loss: 1.415 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.4798176288604736
Epoch: 18, Steps: 4 | Train Loss: 0.025 Vali Loss: 1.382 Vali Acc: 0.500 Test Loss: 1.382 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.4109930992126465
Epoch: 19, Steps: 4 | Train Loss: 0.016 Vali Loss: 1.637 Vali Acc: 0.500 Test Loss: 1.637 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.4348576068878174
Epoch: 20, Steps: 4 | Train Loss: 0.016 Vali Loss: 1.635 Vali Acc: 0.580 Test Loss: 1.635 Test Acc: 0.580
Validation loss decreased (-0.559987 --> -0.579984).  Saving model ...
Epoch: 21 cost time: 3.4775586128234863
Epoch: 21, Steps: 4 | Train Loss: 0.014 Vali Loss: 1.585 Vali Acc: 0.540 Test Loss: 1.585 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.5111796855926514
Epoch: 22, Steps: 4 | Train Loss: 0.012 Vali Loss: 1.654 Vali Acc: 0.540 Test Loss: 1.654 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.3944246768951416
Epoch: 23, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.551 Vali Acc: 0.520 Test Loss: 1.551 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.4590847492218018
Epoch: 24, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.544 Vali Acc: 0.500 Test Loss: 1.544 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.5734286308288574
Epoch: 25, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.588 Vali Acc: 0.560 Test Loss: 1.588 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 3.39023494720459
Epoch: 26, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.672 Vali Acc: 0.560 Test Loss: 1.672 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 3.470651626586914
Epoch: 27, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.751 Vali Acc: 0.520 Test Loss: 1.751 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 3.5508828163146973
Epoch: 28, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.761 Vali Acc: 0.520 Test Loss: 1.761 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 3.634274482727051
Epoch: 29, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.709 Vali Acc: 0.540 Test Loss: 1.709 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 3.508242130279541
Epoch: 30, Steps: 4 | Train Loss: 0.002 Vali Loss: 1.632 Vali Acc: 0.560 Test Loss: 1.632 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm64_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 5032389
model size : 20.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm64_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.912396192550659
Epoch: 1, Steps: 4 | Train Loss: 1.775 Vali Loss: 1.601 Vali Acc: 0.220 Test Loss: 1.601 Test Acc: 0.220
Validation loss decreased (inf --> -0.219984).  Saving model ...
Epoch: 2 cost time: 2.014864206314087
Epoch: 2, Steps: 4 | Train Loss: 1.722 Vali Loss: 1.582 Vali Acc: 0.300 Test Loss: 1.582 Test Acc: 0.300
Validation loss decreased (-0.219984 --> -0.299984).  Saving model ...
Epoch: 3 cost time: 1.9825403690338135
Epoch: 3, Steps: 4 | Train Loss: 1.463 Vali Loss: 1.584 Vali Acc: 0.300 Test Loss: 1.584 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9531610012054443
Epoch: 4, Steps: 4 | Train Loss: 1.262 Vali Loss: 1.540 Vali Acc: 0.280 Test Loss: 1.540 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.7010610103607178
Epoch: 5, Steps: 4 | Train Loss: 0.960 Vali Loss: 1.453 Vali Acc: 0.320 Test Loss: 1.453 Test Acc: 0.320
Validation loss decreased (-0.299984 --> -0.319985).  Saving model ...
Epoch: 6 cost time: 1.992539405822754
Epoch: 6, Steps: 4 | Train Loss: 0.770 Vali Loss: 1.353 Vali Acc: 0.340 Test Loss: 1.353 Test Acc: 0.340
Validation loss decreased (-0.319985 --> -0.339986).  Saving model ...
Epoch: 7 cost time: 1.990696907043457
Epoch: 7, Steps: 4 | Train Loss: 0.885 Vali Loss: 1.295 Vali Acc: 0.360 Test Loss: 1.295 Test Acc: 0.360
Validation loss decreased (-0.339986 --> -0.359987).  Saving model ...
Epoch: 8 cost time: 1.8420839309692383
Epoch: 8, Steps: 4 | Train Loss: 0.495 Vali Loss: 1.197 Vali Acc: 0.520 Test Loss: 1.197 Test Acc: 0.520
Validation loss decreased (-0.359987 --> -0.519988).  Saving model ...
Epoch: 9 cost time: 1.855095624923706
Epoch: 9, Steps: 4 | Train Loss: 0.406 Vali Loss: 1.144 Vali Acc: 0.540 Test Loss: 1.144 Test Acc: 0.540
Validation loss decreased (-0.519988 --> -0.539989).  Saving model ...
Epoch: 10 cost time: 2.006848096847534
Epoch: 10, Steps: 4 | Train Loss: 0.314 Vali Loss: 1.116 Vali Acc: 0.560 Test Loss: 1.116 Test Acc: 0.560
Validation loss decreased (-0.539989 --> -0.559989).  Saving model ...
Epoch: 11 cost time: 1.9839227199554443
Epoch: 11, Steps: 4 | Train Loss: 0.190 Vali Loss: 1.122 Vali Acc: 0.560 Test Loss: 1.122 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.9569945335388184
Epoch: 12, Steps: 4 | Train Loss: 0.157 Vali Loss: 1.112 Vali Acc: 0.560 Test Loss: 1.112 Test Acc: 0.560
Validation loss decreased (-0.559989 --> -0.559989).  Saving model ...
Epoch: 13 cost time: 2.049879312515259
Epoch: 13, Steps: 4 | Train Loss: 0.326 Vali Loss: 1.133 Vali Acc: 0.560 Test Loss: 1.133 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.0988571643829346
Epoch: 14, Steps: 4 | Train Loss: 0.071 Vali Loss: 1.123 Vali Acc: 0.540 Test Loss: 1.123 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.8883826732635498
Epoch: 15, Steps: 4 | Train Loss: 0.103 Vali Loss: 1.101 Vali Acc: 0.560 Test Loss: 1.101 Test Acc: 0.560
Validation loss decreased (-0.559989 --> -0.559989).  Saving model ...
Epoch: 16 cost time: 1.8104913234710693
Epoch: 16, Steps: 4 | Train Loss: 0.066 Vali Loss: 1.325 Vali Acc: 0.520 Test Loss: 1.325 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.0018439292907715
Epoch: 17, Steps: 4 | Train Loss: 0.063 Vali Loss: 1.342 Vali Acc: 0.480 Test Loss: 1.342 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.7584187984466553
Epoch: 18, Steps: 4 | Train Loss: 0.028 Vali Loss: 1.310 Vali Acc: 0.540 Test Loss: 1.310 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.9285228252410889
Epoch: 19, Steps: 4 | Train Loss: 0.027 Vali Loss: 1.230 Vali Acc: 0.500 Test Loss: 1.230 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.0311148166656494
Epoch: 20, Steps: 4 | Train Loss: 0.042 Vali Loss: 1.378 Vali Acc: 0.500 Test Loss: 1.378 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.9794471263885498
Epoch: 21, Steps: 4 | Train Loss: 0.015 Vali Loss: 1.306 Vali Acc: 0.520 Test Loss: 1.306 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.882112979888916
Epoch: 22, Steps: 4 | Train Loss: 0.018 Vali Loss: 1.229 Vali Acc: 0.520 Test Loss: 1.229 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.9129548072814941
Epoch: 23, Steps: 4 | Train Loss: 0.008 Vali Loss: 1.242 Vali Acc: 0.520 Test Loss: 1.242 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.8993680477142334
Epoch: 24, Steps: 4 | Train Loss: 0.046 Vali Loss: 1.242 Vali Acc: 0.560 Test Loss: 1.242 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.2053122520446777
Epoch: 25, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.221 Vali Acc: 0.640 Test Loss: 1.221 Test Acc: 0.640
Validation loss decreased (-0.559989 --> -0.639988).  Saving model ...
Epoch: 26 cost time: 2.078015089035034
Epoch: 26, Steps: 4 | Train Loss: 0.006 Vali Loss: 1.213 Vali Acc: 0.600 Test Loss: 1.213 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.0949013233184814
Epoch: 27, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.195 Vali Acc: 0.620 Test Loss: 1.195 Test Acc: 0.620
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.976905107498169
Epoch: 28, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.175 Vali Acc: 0.640 Test Loss: 1.175 Test Acc: 0.640
Validation loss decreased (-0.639988 --> -0.639988).  Saving model ...
Epoch: 29 cost time: 1.9881963729858398
Epoch: 29, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.168 Vali Acc: 0.640 Test Loss: 1.168 Test Acc: 0.640
Validation loss decreased (-0.639988 --> -0.639988).  Saving model ...
Epoch: 30 cost time: 1.8476579189300537
Epoch: 30, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.164 Vali Acc: 0.620 Test Loss: 1.164 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm64_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.64
model parameter : 1722309
model size : 7.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm64_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.877715110778809
Epoch: 1, Steps: 4 | Train Loss: 1.576 Vali Loss: 1.600 Vali Acc: 0.220 Test Loss: 1.600 Test Acc: 0.220
Validation loss decreased (inf --> -0.219984).  Saving model ...
Epoch: 2 cost time: 2.723996877670288
Epoch: 2, Steps: 4 | Train Loss: 1.548 Vali Loss: 1.555 Vali Acc: 0.300 Test Loss: 1.555 Test Acc: 0.300
Validation loss decreased (-0.219984 --> -0.299984).  Saving model ...
Epoch: 3 cost time: 2.584904670715332
Epoch: 3, Steps: 4 | Train Loss: 1.410 Vali Loss: 1.535 Vali Acc: 0.300 Test Loss: 1.535 Test Acc: 0.300
Validation loss decreased (-0.299984 --> -0.299985).  Saving model ...
Epoch: 4 cost time: 2.647345542907715
Epoch: 4, Steps: 4 | Train Loss: 1.115 Vali Loss: 1.507 Vali Acc: 0.320 Test Loss: 1.507 Test Acc: 0.320
Validation loss decreased (-0.299985 --> -0.319985).  Saving model ...
Epoch: 5 cost time: 2.4710164070129395
Epoch: 5, Steps: 4 | Train Loss: 0.905 Vali Loss: 1.437 Vali Acc: 0.420 Test Loss: 1.437 Test Acc: 0.420
Validation loss decreased (-0.319985 --> -0.419986).  Saving model ...
Epoch: 6 cost time: 2.771662950515747
Epoch: 6, Steps: 4 | Train Loss: 0.698 Vali Loss: 1.381 Vali Acc: 0.400 Test Loss: 1.381 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.573155403137207
Epoch: 7, Steps: 4 | Train Loss: 0.674 Vali Loss: 1.297 Vali Acc: 0.480 Test Loss: 1.297 Test Acc: 0.480
Validation loss decreased (-0.419986 --> -0.479987).  Saving model ...
Epoch: 8 cost time: 2.6212873458862305
Epoch: 8, Steps: 4 | Train Loss: 0.559 Vali Loss: 1.241 Vali Acc: 0.540 Test Loss: 1.241 Test Acc: 0.540
Validation loss decreased (-0.479987 --> -0.539988).  Saving model ...
Epoch: 9 cost time: 2.8056602478027344
Epoch: 9, Steps: 4 | Train Loss: 0.351 Vali Loss: 1.239 Vali Acc: 0.480 Test Loss: 1.239 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.7989766597747803
Epoch: 10, Steps: 4 | Train Loss: 0.538 Vali Loss: 1.325 Vali Acc: 0.520 Test Loss: 1.325 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.6518161296844482
Epoch: 11, Steps: 4 | Train Loss: 0.196 Vali Loss: 1.307 Vali Acc: 0.460 Test Loss: 1.307 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.5190463066101074
Epoch: 12, Steps: 4 | Train Loss: 0.129 Vali Loss: 1.327 Vali Acc: 0.560 Test Loss: 1.327 Test Acc: 0.560
Validation loss decreased (-0.539988 --> -0.559987).  Saving model ...
Epoch: 13 cost time: 2.7092747688293457
Epoch: 13, Steps: 4 | Train Loss: 0.114 Vali Loss: 1.383 Vali Acc: 0.500 Test Loss: 1.383 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.7952680587768555
Epoch: 14, Steps: 4 | Train Loss: 0.063 Vali Loss: 1.357 Vali Acc: 0.480 Test Loss: 1.357 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.792858600616455
Epoch: 15, Steps: 4 | Train Loss: 0.051 Vali Loss: 1.386 Vali Acc: 0.520 Test Loss: 1.386 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.772336959838867
Epoch: 16, Steps: 4 | Train Loss: 0.048 Vali Loss: 1.456 Vali Acc: 0.560 Test Loss: 1.456 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.7262840270996094
Epoch: 17, Steps: 4 | Train Loss: 0.151 Vali Loss: 1.421 Vali Acc: 0.520 Test Loss: 1.421 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.858927011489868
Epoch: 18, Steps: 4 | Train Loss: 0.026 Vali Loss: 1.395 Vali Acc: 0.500 Test Loss: 1.395 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.888723134994507
Epoch: 19, Steps: 4 | Train Loss: 0.016 Vali Loss: 1.643 Vali Acc: 0.500 Test Loss: 1.643 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.8651578426361084
Epoch: 20, Steps: 4 | Train Loss: 0.016 Vali Loss: 1.633 Vali Acc: 0.540 Test Loss: 1.633 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.70762300491333
Epoch: 21, Steps: 4 | Train Loss: 0.014 Vali Loss: 1.570 Vali Acc: 0.500 Test Loss: 1.570 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.9354591369628906
Epoch: 22, Steps: 4 | Train Loss: 0.012 Vali Loss: 1.644 Vali Acc: 0.520 Test Loss: 1.644 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm64_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 5032389
model size : 20.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm64_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.6264123916625977
Epoch: 1, Steps: 4 | Train Loss: 1.775 Vali Loss: 1.598 Vali Acc: 0.220 Test Loss: 1.598 Test Acc: 0.220
Validation loss decreased (inf --> -0.219984).  Saving model ...
Epoch: 2 cost time: 1.7153129577636719
Epoch: 2, Steps: 4 | Train Loss: 1.722 Vali Loss: 1.579 Vali Acc: 0.300 Test Loss: 1.579 Test Acc: 0.300
Validation loss decreased (-0.219984 --> -0.299984).  Saving model ...
Epoch: 3 cost time: 1.5838372707366943
Epoch: 3, Steps: 4 | Train Loss: 1.463 Vali Loss: 1.581 Vali Acc: 0.300 Test Loss: 1.581 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6625738143920898
Epoch: 4, Steps: 4 | Train Loss: 1.261 Vali Loss: 1.537 Vali Acc: 0.280 Test Loss: 1.537 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.6906661987304688
Epoch: 5, Steps: 4 | Train Loss: 0.960 Vali Loss: 1.451 Vali Acc: 0.320 Test Loss: 1.451 Test Acc: 0.320
Validation loss decreased (-0.299984 --> -0.319985).  Saving model ...
Epoch: 6 cost time: 1.6483683586120605
Epoch: 6, Steps: 4 | Train Loss: 0.768 Vali Loss: 1.353 Vali Acc: 0.340 Test Loss: 1.353 Test Acc: 0.340
Validation loss decreased (-0.319985 --> -0.339986).  Saving model ...
Epoch: 7 cost time: 1.6989097595214844
Epoch: 7, Steps: 4 | Train Loss: 0.883 Vali Loss: 1.298 Vali Acc: 0.360 Test Loss: 1.298 Test Acc: 0.360
Validation loss decreased (-0.339986 --> -0.359987).  Saving model ...
Epoch: 8 cost time: 1.5802738666534424
Epoch: 8, Steps: 4 | Train Loss: 0.497 Vali Loss: 1.201 Vali Acc: 0.520 Test Loss: 1.201 Test Acc: 0.520
Validation loss decreased (-0.359987 --> -0.519988).  Saving model ...
Epoch: 9 cost time: 1.769524335861206
Epoch: 9, Steps: 4 | Train Loss: 0.406 Vali Loss: 1.146 Vali Acc: 0.540 Test Loss: 1.146 Test Acc: 0.540
Validation loss decreased (-0.519988 --> -0.539989).  Saving model ...
Epoch: 10 cost time: 1.7354509830474854
Epoch: 10, Steps: 4 | Train Loss: 0.314 Vali Loss: 1.118 Vali Acc: 0.560 Test Loss: 1.118 Test Acc: 0.560
Validation loss decreased (-0.539989 --> -0.559989).  Saving model ...
Epoch: 11 cost time: 1.6381616592407227
Epoch: 11, Steps: 4 | Train Loss: 0.190 Vali Loss: 1.124 Vali Acc: 0.540 Test Loss: 1.124 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.693070411682129
Epoch: 12, Steps: 4 | Train Loss: 0.157 Vali Loss: 1.109 Vali Acc: 0.560 Test Loss: 1.109 Test Acc: 0.560
Validation loss decreased (-0.559989 --> -0.559989).  Saving model ...
Epoch: 13 cost time: 1.442209243774414
Epoch: 13, Steps: 4 | Train Loss: 0.324 Vali Loss: 1.141 Vali Acc: 0.540 Test Loss: 1.141 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6895272731781006
Epoch: 14, Steps: 4 | Train Loss: 0.071 Vali Loss: 1.136 Vali Acc: 0.540 Test Loss: 1.136 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.7831676006317139
Epoch: 15, Steps: 4 | Train Loss: 0.100 Vali Loss: 1.106 Vali Acc: 0.580 Test Loss: 1.106 Test Acc: 0.580
Validation loss decreased (-0.559989 --> -0.579989).  Saving model ...
Epoch: 16 cost time: 1.6628518104553223
Epoch: 16, Steps: 4 | Train Loss: 0.066 Vali Loss: 1.303 Vali Acc: 0.520 Test Loss: 1.303 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.6872527599334717
Epoch: 17, Steps: 4 | Train Loss: 0.062 Vali Loss: 1.315 Vali Acc: 0.480 Test Loss: 1.315 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.5087826251983643
Epoch: 18, Steps: 4 | Train Loss: 0.028 Vali Loss: 1.288 Vali Acc: 0.540 Test Loss: 1.288 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.7285332679748535
Epoch: 19, Steps: 4 | Train Loss: 0.027 Vali Loss: 1.216 Vali Acc: 0.520 Test Loss: 1.216 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.6536312103271484
Epoch: 20, Steps: 4 | Train Loss: 0.041 Vali Loss: 1.366 Vali Acc: 0.540 Test Loss: 1.366 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.877488613128662
Epoch: 21, Steps: 4 | Train Loss: 0.015 Vali Loss: 1.305 Vali Acc: 0.520 Test Loss: 1.305 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.6586759090423584
Epoch: 22, Steps: 4 | Train Loss: 0.018 Vali Loss: 1.234 Vali Acc: 0.520 Test Loss: 1.234 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.8032195568084717
Epoch: 23, Steps: 4 | Train Loss: 0.008 Vali Loss: 1.252 Vali Acc: 0.520 Test Loss: 1.252 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.6257739067077637
Epoch: 24, Steps: 4 | Train Loss: 0.158 Vali Loss: 1.273 Vali Acc: 0.560 Test Loss: 1.273 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.6541986465454102
Epoch: 25, Steps: 4 | Train Loss: 0.006 Vali Loss: 1.288 Vali Acc: 0.580 Test Loss: 1.288 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm64_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 1722309
model size : 7.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm64_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.9035909175872803
Epoch: 1, Steps: 4 | Train Loss: 1.576 Vali Loss: 1.599 Vali Acc: 0.180 Test Loss: 1.599 Test Acc: 0.180
Validation loss decreased (inf --> -0.179984).  Saving model ...
Epoch: 2 cost time: 1.864351749420166
Epoch: 2, Steps: 4 | Train Loss: 1.547 Vali Loss: 1.555 Vali Acc: 0.300 Test Loss: 1.555 Test Acc: 0.300
Validation loss decreased (-0.179984 --> -0.299984).  Saving model ...
Epoch: 3 cost time: 1.938603162765503
Epoch: 3, Steps: 4 | Train Loss: 1.411 Vali Loss: 1.535 Vali Acc: 0.320 Test Loss: 1.535 Test Acc: 0.320
Validation loss decreased (-0.299984 --> -0.319985).  Saving model ...
Epoch: 4 cost time: 2.0276169776916504
Epoch: 4, Steps: 4 | Train Loss: 1.120 Vali Loss: 1.508 Vali Acc: 0.340 Test Loss: 1.508 Test Acc: 0.340
Validation loss decreased (-0.319985 --> -0.339985).  Saving model ...
Epoch: 5 cost time: 2.1347529888153076
Epoch: 5, Steps: 4 | Train Loss: 0.908 Vali Loss: 1.439 Vali Acc: 0.420 Test Loss: 1.439 Test Acc: 0.420
Validation loss decreased (-0.339985 --> -0.419986).  Saving model ...
Epoch: 6 cost time: 1.9571073055267334
Epoch: 6, Steps: 4 | Train Loss: 0.713 Vali Loss: 1.381 Vali Acc: 0.380 Test Loss: 1.381 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.026801586151123
Epoch: 7, Steps: 4 | Train Loss: 0.672 Vali Loss: 1.292 Vali Acc: 0.480 Test Loss: 1.292 Test Acc: 0.480
Validation loss decreased (-0.419986 --> -0.479987).  Saving model ...
Epoch: 8 cost time: 1.8661394119262695
Epoch: 8, Steps: 4 | Train Loss: 0.587 Vali Loss: 1.238 Vali Acc: 0.540 Test Loss: 1.238 Test Acc: 0.540
Validation loss decreased (-0.479987 --> -0.539988).  Saving model ...
Epoch: 9 cost time: 1.9306859970092773
Epoch: 9, Steps: 4 | Train Loss: 0.359 Vali Loss: 1.233 Vali Acc: 0.520 Test Loss: 1.233 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.0082039833068848
Epoch: 10, Steps: 4 | Train Loss: 0.526 Vali Loss: 1.307 Vali Acc: 0.500 Test Loss: 1.307 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.1905336380004883
Epoch: 11, Steps: 4 | Train Loss: 0.205 Vali Loss: 1.280 Vali Acc: 0.500 Test Loss: 1.280 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.0103490352630615
Epoch: 12, Steps: 4 | Train Loss: 0.142 Vali Loss: 1.286 Vali Acc: 0.560 Test Loss: 1.286 Test Acc: 0.560
Validation loss decreased (-0.539988 --> -0.559987).  Saving model ...
Epoch: 13 cost time: 1.9277126789093018
Epoch: 13, Steps: 4 | Train Loss: 0.117 Vali Loss: 1.247 Vali Acc: 0.480 Test Loss: 1.247 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.039663553237915
Epoch: 14, Steps: 4 | Train Loss: 0.060 Vali Loss: 1.251 Vali Acc: 0.500 Test Loss: 1.251 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.9731056690216064
Epoch: 15, Steps: 4 | Train Loss: 0.054 Vali Loss: 1.294 Vali Acc: 0.560 Test Loss: 1.294 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.072772741317749
Epoch: 16, Steps: 4 | Train Loss: 0.045 Vali Loss: 1.309 Vali Acc: 0.580 Test Loss: 1.309 Test Acc: 0.580
Validation loss decreased (-0.559987 --> -0.579987).  Saving model ...
Epoch: 17 cost time: 2.118899345397949
Epoch: 17, Steps: 4 | Train Loss: 0.131 Vali Loss: 1.258 Vali Acc: 0.520 Test Loss: 1.258 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.9759206771850586
Epoch: 18, Steps: 4 | Train Loss: 0.026 Vali Loss: 1.271 Vali Acc: 0.520 Test Loss: 1.271 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.0651180744171143
Epoch: 19, Steps: 4 | Train Loss: 0.017 Vali Loss: 1.524 Vali Acc: 0.540 Test Loss: 1.524 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.982189655303955
Epoch: 20, Steps: 4 | Train Loss: 0.018 Vali Loss: 1.446 Vali Acc: 0.560 Test Loss: 1.446 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.8328359127044678
Epoch: 21, Steps: 4 | Train Loss: 0.019 Vali Loss: 1.364 Vali Acc: 0.560 Test Loss: 1.364 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.8040742874145508
Epoch: 22, Steps: 4 | Train Loss: 0.020 Vali Loss: 1.485 Vali Acc: 0.600 Test Loss: 1.485 Test Acc: 0.600
Validation loss decreased (-0.579987 --> -0.599985).  Saving model ...
Epoch: 23 cost time: 1.8156111240386963
Epoch: 23, Steps: 4 | Train Loss: 0.006 Vali Loss: 1.382 Vali Acc: 0.580 Test Loss: 1.382 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.8599541187286377
Epoch: 24, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.391 Vali Acc: 0.540 Test Loss: 1.391 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.943143606185913
Epoch: 25, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.447 Vali Acc: 0.560 Test Loss: 1.447 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.9447665214538574
Epoch: 26, Steps: 4 | Train Loss: 0.004 Vali Loss: 1.526 Vali Acc: 0.560 Test Loss: 1.526 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.9387798309326172
Epoch: 27, Steps: 4 | Train Loss: 0.008 Vali Loss: 1.645 Vali Acc: 0.540 Test Loss: 1.645 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.033440589904785
Epoch: 28, Steps: 4 | Train Loss: 0.005 Vali Loss: 1.815 Vali Acc: 0.520 Test Loss: 1.815 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.790675163269043
Epoch: 29, Steps: 4 | Train Loss: 0.007 Vali Loss: 1.612 Vali Acc: 0.520 Test Loss: 1.612 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.8574540615081787
Epoch: 30, Steps: 4 | Train Loss: 0.003 Vali Loss: 1.510 Vali Acc: 0.520 Test Loss: 1.510 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm64_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 5032389
model size : 20.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm64_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.2318994998931885
Epoch: 1, Steps: 4 | Train Loss: 1.773 Vali Loss: 1.598 Vali Acc: 0.200 Test Loss: 1.598 Test Acc: 0.200
Validation loss decreased (inf --> -0.199984).  Saving model ...
Epoch: 2 cost time: 1.3041303157806396
Epoch: 2, Steps: 4 | Train Loss: 1.723 Vali Loss: 1.580 Vali Acc: 0.300 Test Loss: 1.580 Test Acc: 0.300
Validation loss decreased (-0.199984 --> -0.299984).  Saving model ...
Epoch: 3 cost time: 1.4655635356903076
Epoch: 3, Steps: 4 | Train Loss: 1.463 Vali Loss: 1.583 Vali Acc: 0.280 Test Loss: 1.583 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3985302448272705
Epoch: 4, Steps: 4 | Train Loss: 1.256 Vali Loss: 1.539 Vali Acc: 0.260 Test Loss: 1.539 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.4156289100646973
Epoch: 5, Steps: 4 | Train Loss: 0.969 Vali Loss: 1.450 Vali Acc: 0.340 Test Loss: 1.450 Test Acc: 0.340
Validation loss decreased (-0.299984 --> -0.339986).  Saving model ...
Epoch: 6 cost time: 1.2816874980926514
Epoch: 6, Steps: 4 | Train Loss: 0.773 Vali Loss: 1.350 Vali Acc: 0.380 Test Loss: 1.350 Test Acc: 0.380
Validation loss decreased (-0.339986 --> -0.379986).  Saving model ...
Epoch: 7 cost time: 1.5023722648620605
Epoch: 7, Steps: 4 | Train Loss: 0.895 Vali Loss: 1.292 Vali Acc: 0.460 Test Loss: 1.292 Test Acc: 0.460
Validation loss decreased (-0.379986 --> -0.459987).  Saving model ...
Epoch: 8 cost time: 1.4920661449432373
Epoch: 8, Steps: 4 | Train Loss: 0.504 Vali Loss: 1.207 Vali Acc: 0.520 Test Loss: 1.207 Test Acc: 0.520
Validation loss decreased (-0.459987 --> -0.519988).  Saving model ...
Epoch: 9 cost time: 1.3587136268615723
Epoch: 9, Steps: 4 | Train Loss: 0.419 Vali Loss: 1.159 Vali Acc: 0.540 Test Loss: 1.159 Test Acc: 0.540
Validation loss decreased (-0.519988 --> -0.539988).  Saving model ...
Epoch: 10 cost time: 1.3794004917144775
Epoch: 10, Steps: 4 | Train Loss: 0.327 Vali Loss: 1.132 Vali Acc: 0.540 Test Loss: 1.132 Test Acc: 0.540
Validation loss decreased (-0.539988 --> -0.539989).  Saving model ...
Epoch: 11 cost time: 1.342747688293457
Epoch: 11, Steps: 4 | Train Loss: 0.200 Vali Loss: 1.135 Vali Acc: 0.520 Test Loss: 1.135 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4567899703979492
Epoch: 12, Steps: 4 | Train Loss: 0.162 Vali Loss: 1.135 Vali Acc: 0.540 Test Loss: 1.135 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.3533611297607422
Epoch: 13, Steps: 4 | Train Loss: 0.326 Vali Loss: 1.110 Vali Acc: 0.540 Test Loss: 1.110 Test Acc: 0.540
Validation loss decreased (-0.539989 --> -0.539989).  Saving model ...
Epoch: 14 cost time: 1.4094209671020508
Epoch: 14, Steps: 4 | Train Loss: 0.073 Vali Loss: 1.138 Vali Acc: 0.520 Test Loss: 1.138 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4205687046051025
Epoch: 15, Steps: 4 | Train Loss: 0.105 Vali Loss: 1.113 Vali Acc: 0.520 Test Loss: 1.113 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.3990826606750488
Epoch: 16, Steps: 4 | Train Loss: 0.075 Vali Loss: 1.277 Vali Acc: 0.480 Test Loss: 1.277 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.450657844543457
Epoch: 17, Steps: 4 | Train Loss: 0.071 Vali Loss: 1.211 Vali Acc: 0.480 Test Loss: 1.211 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.4619100093841553
Epoch: 18, Steps: 4 | Train Loss: 0.031 Vali Loss: 1.249 Vali Acc: 0.500 Test Loss: 1.249 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.3954493999481201
Epoch: 19, Steps: 4 | Train Loss: 0.027 Vali Loss: 1.214 Vali Acc: 0.460 Test Loss: 1.214 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.4474763870239258
Epoch: 20, Steps: 4 | Train Loss: 0.029 Vali Loss: 1.371 Vali Acc: 0.480 Test Loss: 1.371 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.4235475063323975
Epoch: 21, Steps: 4 | Train Loss: 0.017 Vali Loss: 1.359 Vali Acc: 0.480 Test Loss: 1.359 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.407165765762329
Epoch: 22, Steps: 4 | Train Loss: 0.017 Vali Loss: 1.250 Vali Acc: 0.520 Test Loss: 1.250 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.342339038848877
Epoch: 23, Steps: 4 | Train Loss: 0.007 Vali Loss: 1.232 Vali Acc: 0.520 Test Loss: 1.232 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm64_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 1722309
model size : 7.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm32_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 5.7530903816223145
Epoch: 1, Steps: 4 | Train Loss: 1.702 Vali Loss: 1.637 Vali Acc: 0.160 Test Loss: 1.637 Test Acc: 0.160
Validation loss decreased (inf --> -0.159984).  Saving model ...
Epoch: 2 cost time: 4.055713415145874
Epoch: 2, Steps: 4 | Train Loss: 1.721 Vali Loss: 1.638 Vali Acc: 0.260 Test Loss: 1.638 Test Acc: 0.260
Validation loss decreased (-0.159984 --> -0.259984).  Saving model ...
Epoch: 3 cost time: 4.15179705619812
Epoch: 3, Steps: 4 | Train Loss: 1.467 Vali Loss: 1.642 Vali Acc: 0.280 Test Loss: 1.642 Test Acc: 0.280
Validation loss decreased (-0.259984 --> -0.279984).  Saving model ...
Epoch: 4 cost time: 4.179231405258179
Epoch: 4, Steps: 4 | Train Loss: 1.494 Vali Loss: 1.649 Vali Acc: 0.320 Test Loss: 1.649 Test Acc: 0.320
Validation loss decreased (-0.279984 --> -0.319984).  Saving model ...
Epoch: 5 cost time: 3.9706945419311523
Epoch: 5, Steps: 4 | Train Loss: 1.226 Vali Loss: 1.625 Vali Acc: 0.340 Test Loss: 1.625 Test Acc: 0.340
Validation loss decreased (-0.319984 --> -0.339984).  Saving model ...
Epoch: 6 cost time: 4.008732557296753
Epoch: 6, Steps: 4 | Train Loss: 1.055 Vali Loss: 1.616 Vali Acc: 0.360 Test Loss: 1.616 Test Acc: 0.360
Validation loss decreased (-0.339984 --> -0.359984).  Saving model ...
Epoch: 7 cost time: 3.6729228496551514
Epoch: 7, Steps: 4 | Train Loss: 1.019 Vali Loss: 1.593 Vali Acc: 0.380 Test Loss: 1.593 Test Acc: 0.380
Validation loss decreased (-0.359984 --> -0.379984).  Saving model ...
Epoch: 8 cost time: 3.814774990081787
Epoch: 8, Steps: 4 | Train Loss: 0.849 Vali Loss: 1.546 Vali Acc: 0.420 Test Loss: 1.546 Test Acc: 0.420
Validation loss decreased (-0.379984 --> -0.419985).  Saving model ...
Epoch: 9 cost time: 3.900416612625122
Epoch: 9, Steps: 4 | Train Loss: 0.761 Vali Loss: 1.479 Vali Acc: 0.420 Test Loss: 1.479 Test Acc: 0.420
Validation loss decreased (-0.419985 --> -0.419985).  Saving model ...
Epoch: 10 cost time: 3.8378567695617676
Epoch: 10, Steps: 4 | Train Loss: 0.545 Vali Loss: 1.465 Vali Acc: 0.420 Test Loss: 1.465 Test Acc: 0.420
Validation loss decreased (-0.419985 --> -0.419985).  Saving model ...
Epoch: 11 cost time: 4.069814682006836
Epoch: 11, Steps: 4 | Train Loss: 0.373 Vali Loss: 1.471 Vali Acc: 0.420 Test Loss: 1.471 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.158742189407349
Epoch: 12, Steps: 4 | Train Loss: 0.322 Vali Loss: 1.466 Vali Acc: 0.420 Test Loss: 1.466 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.8081769943237305
Epoch: 13, Steps: 4 | Train Loss: 0.290 Vali Loss: 1.500 Vali Acc: 0.460 Test Loss: 1.500 Test Acc: 0.460
Validation loss decreased (-0.419985 --> -0.459985).  Saving model ...
Epoch: 14 cost time: 3.7633841037750244
Epoch: 14, Steps: 4 | Train Loss: 0.201 Vali Loss: 1.429 Vali Acc: 0.480 Test Loss: 1.429 Test Acc: 0.480
Validation loss decreased (-0.459985 --> -0.479986).  Saving model ...
Epoch: 15 cost time: 3.9362077713012695
Epoch: 15, Steps: 4 | Train Loss: 0.178 Vali Loss: 1.419 Vali Acc: 0.500 Test Loss: 1.419 Test Acc: 0.500
Validation loss decreased (-0.479986 --> -0.499986).  Saving model ...
Epoch: 16 cost time: 4.042443513870239
Epoch: 16, Steps: 4 | Train Loss: 0.097 Vali Loss: 1.473 Vali Acc: 0.560 Test Loss: 1.473 Test Acc: 0.560
Validation loss decreased (-0.499986 --> -0.559985).  Saving model ...
Epoch: 17 cost time: 3.917762279510498
Epoch: 17, Steps: 4 | Train Loss: 0.099 Vali Loss: 1.503 Vali Acc: 0.500 Test Loss: 1.503 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.0721800327301025
Epoch: 18, Steps: 4 | Train Loss: 0.064 Vali Loss: 1.550 Vali Acc: 0.540 Test Loss: 1.550 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.719487190246582
Epoch: 19, Steps: 4 | Train Loss: 0.048 Vali Loss: 1.551 Vali Acc: 0.540 Test Loss: 1.551 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.75036883354187
Epoch: 20, Steps: 4 | Train Loss: 0.044 Vali Loss: 1.597 Vali Acc: 0.560 Test Loss: 1.597 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.533733367919922
Epoch: 21, Steps: 4 | Train Loss: 0.034 Vali Loss: 1.554 Vali Acc: 0.520 Test Loss: 1.554 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 3.39571213722229
Epoch: 22, Steps: 4 | Train Loss: 0.036 Vali Loss: 1.586 Vali Acc: 0.580 Test Loss: 1.586 Test Acc: 0.580
Validation loss decreased (-0.559985 --> -0.579984).  Saving model ...
Epoch: 23 cost time: 3.1108357906341553
Epoch: 23, Steps: 4 | Train Loss: 0.028 Vali Loss: 1.594 Vali Acc: 0.560 Test Loss: 1.594 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.8616762161254883
Epoch: 24, Steps: 4 | Train Loss: 0.019 Vali Loss: 1.484 Vali Acc: 0.520 Test Loss: 1.484 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.631272077560425
Epoch: 25, Steps: 4 | Train Loss: 0.033 Vali Loss: 1.521 Vali Acc: 0.540 Test Loss: 1.521 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.4019877910614014
Epoch: 26, Steps: 4 | Train Loss: 0.016 Vali Loss: 1.582 Vali Acc: 0.560 Test Loss: 1.582 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 3.5716981887817383
Epoch: 27, Steps: 4 | Train Loss: 0.017 Vali Loss: 1.659 Vali Acc: 0.600 Test Loss: 1.659 Test Acc: 0.600
Validation loss decreased (-0.579984 --> -0.599983).  Saving model ...
Epoch: 28 cost time: 3.9808688163757324
Epoch: 28, Steps: 4 | Train Loss: 0.010 Vali Loss: 1.643 Vali Acc: 0.540 Test Loss: 1.643 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.9749743938446045
Epoch: 29, Steps: 4 | Train Loss: 0.013 Vali Loss: 1.608 Vali Acc: 0.540 Test Loss: 1.608 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.734877109527588
Epoch: 30, Steps: 4 | Train Loss: 0.007 Vali Loss: 1.624 Vali Acc: 0.600 Test Loss: 1.624 Test Acc: 0.600
Validation loss decreased (-0.599983 --> -0.599984).  Saving model ...
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm32_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 4860261
model size : 19.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm32_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.541040897369385
Epoch: 1, Steps: 4 | Train Loss: 1.581 Vali Loss: 1.589 Vali Acc: 0.200 Test Loss: 1.589 Test Acc: 0.200
Validation loss decreased (inf --> -0.199984).  Saving model ...
Epoch: 2 cost time: 2.8514811992645264
Epoch: 2, Steps: 4 | Train Loss: 1.670 Vali Loss: 1.564 Vali Acc: 0.160 Test Loss: 1.564 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.467200517654419
Epoch: 3, Steps: 4 | Train Loss: 1.471 Vali Loss: 1.523 Vali Acc: 0.300 Test Loss: 1.523 Test Acc: 0.300
Validation loss decreased (-0.199984 --> -0.299985).  Saving model ...
Epoch: 4 cost time: 2.6987998485565186
Epoch: 4, Steps: 4 | Train Loss: 1.355 Vali Loss: 1.464 Vali Acc: 0.360 Test Loss: 1.464 Test Acc: 0.360
Validation loss decreased (-0.299985 --> -0.359985).  Saving model ...
Epoch: 5 cost time: 2.529583215713501
Epoch: 5, Steps: 4 | Train Loss: 1.129 Vali Loss: 1.394 Vali Acc: 0.400 Test Loss: 1.394 Test Acc: 0.400
Validation loss decreased (-0.359985 --> -0.399986).  Saving model ...
Epoch: 6 cost time: 2.829238176345825
Epoch: 6, Steps: 4 | Train Loss: 1.051 Vali Loss: 1.329 Vali Acc: 0.420 Test Loss: 1.329 Test Acc: 0.420
Validation loss decreased (-0.399986 --> -0.419987).  Saving model ...
Epoch: 7 cost time: 2.6956467628479004
Epoch: 7, Steps: 4 | Train Loss: 0.873 Vali Loss: 1.279 Vali Acc: 0.480 Test Loss: 1.279 Test Acc: 0.480
Validation loss decreased (-0.419987 --> -0.479987).  Saving model ...
Epoch: 8 cost time: 2.54790997505188
Epoch: 8, Steps: 4 | Train Loss: 0.747 Vali Loss: 1.235 Vali Acc: 0.480 Test Loss: 1.235 Test Acc: 0.480
Validation loss decreased (-0.479987 --> -0.479988).  Saving model ...
Epoch: 9 cost time: 2.589627742767334
Epoch: 9, Steps: 4 | Train Loss: 0.660 Vali Loss: 1.210 Vali Acc: 0.460 Test Loss: 1.210 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.4285964965820312
Epoch: 10, Steps: 4 | Train Loss: 0.490 Vali Loss: 1.184 Vali Acc: 0.520 Test Loss: 1.184 Test Acc: 0.520
Validation loss decreased (-0.479988 --> -0.519988).  Saving model ...
Epoch: 11 cost time: 2.481628179550171
Epoch: 11, Steps: 4 | Train Loss: 0.398 Vali Loss: 1.192 Vali Acc: 0.480 Test Loss: 1.192 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.729093074798584
Epoch: 12, Steps: 4 | Train Loss: 0.334 Vali Loss: 1.204 Vali Acc: 0.480 Test Loss: 1.204 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.8618619441986084
Epoch: 13, Steps: 4 | Train Loss: 0.234 Vali Loss: 1.204 Vali Acc: 0.540 Test Loss: 1.204 Test Acc: 0.540
Validation loss decreased (-0.519988 --> -0.539988).  Saving model ...
Epoch: 14 cost time: 2.4343552589416504
Epoch: 14, Steps: 4 | Train Loss: 0.235 Vali Loss: 1.175 Vali Acc: 0.500 Test Loss: 1.175 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.6983377933502197
Epoch: 15, Steps: 4 | Train Loss: 0.160 Vali Loss: 1.202 Vali Acc: 0.560 Test Loss: 1.202 Test Acc: 0.560
Validation loss decreased (-0.539988 --> -0.559988).  Saving model ...
Epoch: 16 cost time: 2.8033790588378906
Epoch: 16, Steps: 4 | Train Loss: 0.159 Vali Loss: 1.232 Vali Acc: 0.560 Test Loss: 1.232 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.503080368041992
Epoch: 17, Steps: 4 | Train Loss: 0.111 Vali Loss: 1.206 Vali Acc: 0.560 Test Loss: 1.206 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.649097204208374
Epoch: 18, Steps: 4 | Train Loss: 0.095 Vali Loss: 1.298 Vali Acc: 0.500 Test Loss: 1.298 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.5486950874328613
Epoch: 19, Steps: 4 | Train Loss: 0.072 Vali Loss: 1.228 Vali Acc: 0.540 Test Loss: 1.228 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.5657718181610107
Epoch: 20, Steps: 4 | Train Loss: 0.058 Vali Loss: 1.232 Vali Acc: 0.500 Test Loss: 1.232 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.4186081886291504
Epoch: 21, Steps: 4 | Train Loss: 0.050 Vali Loss: 1.314 Vali Acc: 0.560 Test Loss: 1.314 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.7479476928710938
Epoch: 22, Steps: 4 | Train Loss: 0.046 Vali Loss: 1.281 Vali Acc: 0.580 Test Loss: 1.281 Test Acc: 0.580
Validation loss decreased (-0.559988 --> -0.579987).  Saving model ...
Epoch: 23 cost time: 2.6252713203430176
Epoch: 23, Steps: 4 | Train Loss: 0.031 Vali Loss: 1.301 Vali Acc: 0.560 Test Loss: 1.301 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.6320693492889404
Epoch: 24, Steps: 4 | Train Loss: 0.048 Vali Loss: 1.344 Vali Acc: 0.580 Test Loss: 1.344 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.4316723346710205
Epoch: 25, Steps: 4 | Train Loss: 0.020 Vali Loss: 1.300 Vali Acc: 0.540 Test Loss: 1.300 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.513934373855591
Epoch: 26, Steps: 4 | Train Loss: 0.021 Vali Loss: 1.353 Vali Acc: 0.560 Test Loss: 1.353 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.1707587242126465
Epoch: 27, Steps: 4 | Train Loss: 0.014 Vali Loss: 1.386 Vali Acc: 0.560 Test Loss: 1.386 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.650667905807495
Epoch: 28, Steps: 4 | Train Loss: 0.038 Vali Loss: 1.316 Vali Acc: 0.540 Test Loss: 1.316 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 2.294947862625122
Epoch: 29, Steps: 4 | Train Loss: 0.056 Vali Loss: 1.327 Vali Acc: 0.500 Test Loss: 1.327 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 2.395988702774048
Epoch: 30, Steps: 4 | Train Loss: 0.016 Vali Loss: 1.610 Vali Acc: 0.560 Test Loss: 1.610 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm32_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 1550053
model size : 6.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm32_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.792267560958862
Epoch: 1, Steps: 4 | Train Loss: 1.703 Vali Loss: 1.641 Vali Acc: 0.160 Test Loss: 1.641 Test Acc: 0.160
Validation loss decreased (inf --> -0.159984).  Saving model ...
Epoch: 2 cost time: 2.917965888977051
Epoch: 2, Steps: 4 | Train Loss: 1.721 Vali Loss: 1.642 Vali Acc: 0.260 Test Loss: 1.642 Test Acc: 0.260
Validation loss decreased (-0.159984 --> -0.259984).  Saving model ...
Epoch: 3 cost time: 2.9309744834899902
Epoch: 3, Steps: 4 | Train Loss: 1.470 Vali Loss: 1.645 Vali Acc: 0.280 Test Loss: 1.645 Test Acc: 0.280
Validation loss decreased (-0.259984 --> -0.279984).  Saving model ...
Epoch: 4 cost time: 2.83608078956604
Epoch: 4, Steps: 4 | Train Loss: 1.492 Vali Loss: 1.652 Vali Acc: 0.280 Test Loss: 1.652 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.7583425045013428
Epoch: 5, Steps: 4 | Train Loss: 1.228 Vali Loss: 1.627 Vali Acc: 0.320 Test Loss: 1.627 Test Acc: 0.320
Validation loss decreased (-0.279984 --> -0.319984).  Saving model ...
Epoch: 6 cost time: 2.485093832015991
Epoch: 6, Steps: 4 | Train Loss: 1.058 Vali Loss: 1.612 Vali Acc: 0.380 Test Loss: 1.612 Test Acc: 0.380
Validation loss decreased (-0.319984 --> -0.379984).  Saving model ...
Epoch: 7 cost time: 2.740617513656616
Epoch: 7, Steps: 4 | Train Loss: 1.011 Vali Loss: 1.585 Vali Acc: 0.380 Test Loss: 1.585 Test Acc: 0.380
Validation loss decreased (-0.379984 --> -0.379984).  Saving model ...
Epoch: 8 cost time: 2.9587090015411377
Epoch: 8, Steps: 4 | Train Loss: 0.861 Vali Loss: 1.532 Vali Acc: 0.420 Test Loss: 1.532 Test Acc: 0.420
Validation loss decreased (-0.379984 --> -0.419985).  Saving model ...
Epoch: 9 cost time: 2.716320753097534
Epoch: 9, Steps: 4 | Train Loss: 0.763 Vali Loss: 1.461 Vali Acc: 0.420 Test Loss: 1.461 Test Acc: 0.420
Validation loss decreased (-0.419985 --> -0.419985).  Saving model ...
Epoch: 10 cost time: 2.760462999343872
Epoch: 10, Steps: 4 | Train Loss: 0.546 Vali Loss: 1.441 Vali Acc: 0.440 Test Loss: 1.441 Test Acc: 0.440
Validation loss decreased (-0.419985 --> -0.439986).  Saving model ...
Epoch: 11 cost time: 2.633390426635742
Epoch: 11, Steps: 4 | Train Loss: 0.367 Vali Loss: 1.448 Vali Acc: 0.440 Test Loss: 1.448 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.6432998180389404
Epoch: 12, Steps: 4 | Train Loss: 0.324 Vali Loss: 1.432 Vali Acc: 0.460 Test Loss: 1.432 Test Acc: 0.460
Validation loss decreased (-0.439986 --> -0.459986).  Saving model ...
Epoch: 13 cost time: 2.4989752769470215
Epoch: 13, Steps: 4 | Train Loss: 0.328 Vali Loss: 1.482 Vali Acc: 0.480 Test Loss: 1.482 Test Acc: 0.480
Validation loss decreased (-0.459986 --> -0.479985).  Saving model ...
Epoch: 14 cost time: 2.540501117706299
Epoch: 14, Steps: 4 | Train Loss: 0.203 Vali Loss: 1.424 Vali Acc: 0.520 Test Loss: 1.424 Test Acc: 0.520
Validation loss decreased (-0.479985 --> -0.519986).  Saving model ...
Epoch: 15 cost time: 2.593323230743408
Epoch: 15, Steps: 4 | Train Loss: 0.168 Vali Loss: 1.431 Vali Acc: 0.500 Test Loss: 1.431 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.7532246112823486
Epoch: 16, Steps: 4 | Train Loss: 0.100 Vali Loss: 1.460 Vali Acc: 0.540 Test Loss: 1.460 Test Acc: 0.540
Validation loss decreased (-0.519986 --> -0.539985).  Saving model ...
Epoch: 17 cost time: 2.685959577560425
Epoch: 17, Steps: 4 | Train Loss: 0.101 Vali Loss: 1.472 Vali Acc: 0.520 Test Loss: 1.472 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.8672749996185303
Epoch: 18, Steps: 4 | Train Loss: 0.068 Vali Loss: 1.506 Vali Acc: 0.540 Test Loss: 1.506 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.7653422355651855
Epoch: 19, Steps: 4 | Train Loss: 0.051 Vali Loss: 1.524 Vali Acc: 0.580 Test Loss: 1.524 Test Acc: 0.580
Validation loss decreased (-0.539985 --> -0.579985).  Saving model ...
Epoch: 20 cost time: 2.6687610149383545
Epoch: 20, Steps: 4 | Train Loss: 0.047 Vali Loss: 1.603 Vali Acc: 0.580 Test Loss: 1.603 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.690769910812378
Epoch: 21, Steps: 4 | Train Loss: 0.039 Vali Loss: 1.508 Vali Acc: 0.520 Test Loss: 1.508 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.1634461879730225
Epoch: 22, Steps: 4 | Train Loss: 0.039 Vali Loss: 1.462 Vali Acc: 0.560 Test Loss: 1.462 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.627077579498291
Epoch: 23, Steps: 4 | Train Loss: 0.032 Vali Loss: 1.427 Vali Acc: 0.580 Test Loss: 1.427 Test Acc: 0.580
Validation loss decreased (-0.579985 --> -0.579986).  Saving model ...
Epoch: 24 cost time: 2.692902088165283
Epoch: 24, Steps: 4 | Train Loss: 0.022 Vali Loss: 1.326 Vali Acc: 0.500 Test Loss: 1.326 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.552722215652466
Epoch: 25, Steps: 4 | Train Loss: 0.037 Vali Loss: 1.382 Vali Acc: 0.580 Test Loss: 1.382 Test Acc: 0.580
Validation loss decreased (-0.579986 --> -0.579986).  Saving model ...
Epoch: 26 cost time: 2.511979579925537
Epoch: 26, Steps: 4 | Train Loss: 0.016 Vali Loss: 1.429 Vali Acc: 0.560 Test Loss: 1.429 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.7056493759155273
Epoch: 27, Steps: 4 | Train Loss: 0.016 Vali Loss: 1.532 Vali Acc: 0.620 Test Loss: 1.532 Test Acc: 0.620
Validation loss decreased (-0.579986 --> -0.619985).  Saving model ...
Epoch: 28 cost time: 2.749011754989624
Epoch: 28, Steps: 4 | Train Loss: 0.010 Vali Loss: 1.563 Vali Acc: 0.620 Test Loss: 1.563 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.729851484298706
Epoch: 29, Steps: 4 | Train Loss: 0.031 Vali Loss: 1.667 Vali Acc: 0.560 Test Loss: 1.667 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.685408592224121
Epoch: 30, Steps: 4 | Train Loss: 0.011 Vali Loss: 2.036 Vali Acc: 0.580 Test Loss: 2.036 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm32_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.62
model parameter : 4860261
model size : 19.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm32_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.797940731048584
Epoch: 1, Steps: 4 | Train Loss: 1.580 Vali Loss: 1.587 Vali Acc: 0.200 Test Loss: 1.587 Test Acc: 0.200
Validation loss decreased (inf --> -0.199984).  Saving model ...
Epoch: 2 cost time: 1.7490735054016113
Epoch: 2, Steps: 4 | Train Loss: 1.668 Vali Loss: 1.562 Vali Acc: 0.180 Test Loss: 1.562 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.625185489654541
Epoch: 3, Steps: 4 | Train Loss: 1.472 Vali Loss: 1.521 Vali Acc: 0.340 Test Loss: 1.521 Test Acc: 0.340
Validation loss decreased (-0.199984 --> -0.339985).  Saving model ...
Epoch: 4 cost time: 1.8265032768249512
Epoch: 4, Steps: 4 | Train Loss: 1.361 Vali Loss: 1.461 Vali Acc: 0.360 Test Loss: 1.461 Test Acc: 0.360
Validation loss decreased (-0.339985 --> -0.359985).  Saving model ...
Epoch: 5 cost time: 1.7399461269378662
Epoch: 5, Steps: 4 | Train Loss: 1.135 Vali Loss: 1.394 Vali Acc: 0.400 Test Loss: 1.394 Test Acc: 0.400
Validation loss decreased (-0.359985 --> -0.399986).  Saving model ...
Epoch: 6 cost time: 1.8440284729003906
Epoch: 6, Steps: 4 | Train Loss: 1.055 Vali Loss: 1.329 Vali Acc: 0.420 Test Loss: 1.329 Test Acc: 0.420
Validation loss decreased (-0.399986 --> -0.419987).  Saving model ...
Epoch: 7 cost time: 1.6750867366790771
Epoch: 7, Steps: 4 | Train Loss: 0.877 Vali Loss: 1.278 Vali Acc: 0.480 Test Loss: 1.278 Test Acc: 0.480
Validation loss decreased (-0.419987 --> -0.479987).  Saving model ...
Epoch: 8 cost time: 1.6970491409301758
Epoch: 8, Steps: 4 | Train Loss: 0.747 Vali Loss: 1.229 Vali Acc: 0.480 Test Loss: 1.229 Test Acc: 0.480
Validation loss decreased (-0.479987 --> -0.479988).  Saving model ...
Epoch: 9 cost time: 1.7643356323242188
Epoch: 9, Steps: 4 | Train Loss: 0.659 Vali Loss: 1.198 Vali Acc: 0.480 Test Loss: 1.198 Test Acc: 0.480
Validation loss decreased (-0.479988 --> -0.479988).  Saving model ...
Epoch: 10 cost time: 1.52305269241333
Epoch: 10, Steps: 4 | Train Loss: 0.491 Vali Loss: 1.169 Vali Acc: 0.540 Test Loss: 1.169 Test Acc: 0.540
Validation loss decreased (-0.479988 --> -0.539988).  Saving model ...
Epoch: 11 cost time: 1.5385191440582275
Epoch: 11, Steps: 4 | Train Loss: 0.401 Vali Loss: 1.173 Vali Acc: 0.480 Test Loss: 1.173 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.603118658065796
Epoch: 12, Steps: 4 | Train Loss: 0.334 Vali Loss: 1.177 Vali Acc: 0.500 Test Loss: 1.177 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.7433712482452393
Epoch: 13, Steps: 4 | Train Loss: 0.232 Vali Loss: 1.179 Vali Acc: 0.540 Test Loss: 1.179 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.7199270725250244
Epoch: 14, Steps: 4 | Train Loss: 0.208 Vali Loss: 1.157 Vali Acc: 0.480 Test Loss: 1.157 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.7770450115203857
Epoch: 15, Steps: 4 | Train Loss: 0.157 Vali Loss: 1.187 Vali Acc: 0.540 Test Loss: 1.187 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.7112400531768799
Epoch: 16, Steps: 4 | Train Loss: 0.163 Vali Loss: 1.227 Vali Acc: 0.580 Test Loss: 1.227 Test Acc: 0.580
Validation loss decreased (-0.539988 --> -0.579988).  Saving model ...
Epoch: 17 cost time: 1.650747537612915
Epoch: 17, Steps: 4 | Train Loss: 0.107 Vali Loss: 1.198 Vali Acc: 0.560 Test Loss: 1.198 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.6650893688201904
Epoch: 18, Steps: 4 | Train Loss: 0.092 Vali Loss: 1.294 Vali Acc: 0.480 Test Loss: 1.294 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.727515697479248
Epoch: 19, Steps: 4 | Train Loss: 0.071 Vali Loss: 1.202 Vali Acc: 0.540 Test Loss: 1.202 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.6001732349395752
Epoch: 20, Steps: 4 | Train Loss: 0.056 Vali Loss: 1.202 Vali Acc: 0.520 Test Loss: 1.202 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.771657943725586
Epoch: 21, Steps: 4 | Train Loss: 0.047 Vali Loss: 1.288 Vali Acc: 0.580 Test Loss: 1.288 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.6740801334381104
Epoch: 22, Steps: 4 | Train Loss: 0.039 Vali Loss: 1.261 Vali Acc: 0.600 Test Loss: 1.261 Test Acc: 0.600
Validation loss decreased (-0.579988 --> -0.599987).  Saving model ...
Epoch: 23 cost time: 1.7120866775512695
Epoch: 23, Steps: 4 | Train Loss: 0.027 Vali Loss: 1.253 Vali Acc: 0.500 Test Loss: 1.253 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.6463541984558105
Epoch: 24, Steps: 4 | Train Loss: 0.039 Vali Loss: 1.291 Vali Acc: 0.600 Test Loss: 1.291 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.679457187652588
Epoch: 25, Steps: 4 | Train Loss: 0.019 Vali Loss: 1.288 Vali Acc: 0.520 Test Loss: 1.288 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.6709067821502686
Epoch: 26, Steps: 4 | Train Loss: 0.020 Vali Loss: 1.330 Vali Acc: 0.580 Test Loss: 1.330 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.6416053771972656
Epoch: 27, Steps: 4 | Train Loss: 0.015 Vali Loss: 1.315 Vali Acc: 0.600 Test Loss: 1.315 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.6140525341033936
Epoch: 28, Steps: 4 | Train Loss: 0.025 Vali Loss: 1.265 Vali Acc: 0.540 Test Loss: 1.265 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.663738489151001
Epoch: 29, Steps: 4 | Train Loss: 0.044 Vali Loss: 1.338 Vali Acc: 0.560 Test Loss: 1.338 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.5713889598846436
Epoch: 30, Steps: 4 | Train Loss: 0.022 Vali Loss: 1.630 Vali Acc: 0.560 Test Loss: 1.630 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm32_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 1550053
model size : 6.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm32_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.592153787612915
Epoch: 1, Steps: 4 | Train Loss: 1.703 Vali Loss: 1.642 Vali Acc: 0.160 Test Loss: 1.642 Test Acc: 0.160
Validation loss decreased (inf --> -0.159984).  Saving model ...
Epoch: 2 cost time: 1.9459590911865234
Epoch: 2, Steps: 4 | Train Loss: 1.721 Vali Loss: 1.643 Vali Acc: 0.260 Test Loss: 1.643 Test Acc: 0.260
Validation loss decreased (-0.159984 --> -0.259984).  Saving model ...
Epoch: 3 cost time: 1.8361008167266846
Epoch: 3, Steps: 4 | Train Loss: 1.470 Vali Loss: 1.649 Vali Acc: 0.280 Test Loss: 1.649 Test Acc: 0.280
Validation loss decreased (-0.259984 --> -0.279984).  Saving model ...
Epoch: 4 cost time: 1.940258502960205
Epoch: 4, Steps: 4 | Train Loss: 1.496 Vali Loss: 1.658 Vali Acc: 0.280 Test Loss: 1.658 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.923480749130249
Epoch: 5, Steps: 4 | Train Loss: 1.236 Vali Loss: 1.634 Vali Acc: 0.320 Test Loss: 1.634 Test Acc: 0.320
Validation loss decreased (-0.279984 --> -0.319984).  Saving model ...
Epoch: 6 cost time: 1.9780843257904053
Epoch: 6, Steps: 4 | Train Loss: 1.069 Vali Loss: 1.619 Vali Acc: 0.380 Test Loss: 1.619 Test Acc: 0.380
Validation loss decreased (-0.319984 --> -0.379984).  Saving model ...
Epoch: 7 cost time: 1.8870584964752197
Epoch: 7, Steps: 4 | Train Loss: 1.028 Vali Loss: 1.588 Vali Acc: 0.380 Test Loss: 1.588 Test Acc: 0.380
Validation loss decreased (-0.379984 --> -0.379984).  Saving model ...
Epoch: 8 cost time: 2.0159854888916016
Epoch: 8, Steps: 4 | Train Loss: 0.883 Vali Loss: 1.531 Vali Acc: 0.420 Test Loss: 1.531 Test Acc: 0.420
Validation loss decreased (-0.379984 --> -0.419985).  Saving model ...
Epoch: 9 cost time: 2.157031297683716
Epoch: 9, Steps: 4 | Train Loss: 0.790 Vali Loss: 1.450 Vali Acc: 0.440 Test Loss: 1.450 Test Acc: 0.440
Validation loss decreased (-0.419985 --> -0.439985).  Saving model ...
Epoch: 10 cost time: 2.054596424102783
Epoch: 10, Steps: 4 | Train Loss: 0.614 Vali Loss: 1.413 Vali Acc: 0.460 Test Loss: 1.413 Test Acc: 0.460
Validation loss decreased (-0.439985 --> -0.459986).  Saving model ...
Epoch: 11 cost time: 1.9524245262145996
Epoch: 11, Steps: 4 | Train Loss: 0.388 Vali Loss: 1.398 Vali Acc: 0.480 Test Loss: 1.398 Test Acc: 0.480
Validation loss decreased (-0.459986 --> -0.479986).  Saving model ...
Epoch: 12 cost time: 2.0292303562164307
Epoch: 12, Steps: 4 | Train Loss: 0.342 Vali Loss: 1.380 Vali Acc: 0.500 Test Loss: 1.380 Test Acc: 0.500
Validation loss decreased (-0.479986 --> -0.499986).  Saving model ...
Epoch: 13 cost time: 2.1804087162017822
Epoch: 13, Steps: 4 | Train Loss: 0.329 Vali Loss: 1.428 Vali Acc: 0.520 Test Loss: 1.428 Test Acc: 0.520
Validation loss decreased (-0.499986 --> -0.519986).  Saving model ...
Epoch: 14 cost time: 1.9451191425323486
Epoch: 14, Steps: 4 | Train Loss: 0.215 Vali Loss: 1.374 Vali Acc: 0.520 Test Loss: 1.374 Test Acc: 0.520
Validation loss decreased (-0.519986 --> -0.519986).  Saving model ...
Epoch: 15 cost time: 1.9075448513031006
Epoch: 15, Steps: 4 | Train Loss: 0.178 Vali Loss: 1.382 Vali Acc: 0.480 Test Loss: 1.382 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.0919759273529053
Epoch: 16, Steps: 4 | Train Loss: 0.107 Vali Loss: 1.408 Vali Acc: 0.520 Test Loss: 1.408 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.0147130489349365
Epoch: 17, Steps: 4 | Train Loss: 0.109 Vali Loss: 1.468 Vali Acc: 0.520 Test Loss: 1.468 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.8117341995239258
Epoch: 18, Steps: 4 | Train Loss: 0.085 Vali Loss: 1.519 Vali Acc: 0.540 Test Loss: 1.519 Test Acc: 0.540
Validation loss decreased (-0.519986 --> -0.539985).  Saving model ...
Epoch: 19 cost time: 1.9127402305603027
Epoch: 19, Steps: 4 | Train Loss: 0.061 Vali Loss: 1.457 Vali Acc: 0.480 Test Loss: 1.457 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.868577480316162
Epoch: 20, Steps: 4 | Train Loss: 0.049 Vali Loss: 1.426 Vali Acc: 0.520 Test Loss: 1.426 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.899909496307373
Epoch: 21, Steps: 4 | Train Loss: 0.045 Vali Loss: 1.388 Vali Acc: 0.460 Test Loss: 1.388 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.7820513248443604
Epoch: 22, Steps: 4 | Train Loss: 0.042 Vali Loss: 1.588 Vali Acc: 0.520 Test Loss: 1.588 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.8657283782958984
Epoch: 23, Steps: 4 | Train Loss: 0.037 Vali Loss: 1.668 Vali Acc: 0.520 Test Loss: 1.668 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.8314363956451416
Epoch: 24, Steps: 4 | Train Loss: 0.030 Vali Loss: 1.472 Vali Acc: 0.460 Test Loss: 1.472 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.911254644393921
Epoch: 25, Steps: 4 | Train Loss: 0.044 Vali Loss: 1.429 Vali Acc: 0.520 Test Loss: 1.429 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.8734371662139893
Epoch: 26, Steps: 4 | Train Loss: 0.019 Vali Loss: 1.467 Vali Acc: 0.480 Test Loss: 1.467 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.7429258823394775
Epoch: 27, Steps: 4 | Train Loss: 0.020 Vali Loss: 1.434 Vali Acc: 0.480 Test Loss: 1.434 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.9681036472320557
Epoch: 28, Steps: 4 | Train Loss: 0.012 Vali Loss: 1.415 Vali Acc: 0.480 Test Loss: 1.415 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm32_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 4860261
model size : 19.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm32_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.3189284801483154
Epoch: 1, Steps: 4 | Train Loss: 1.583 Vali Loss: 1.596 Vali Acc: 0.200 Test Loss: 1.596 Test Acc: 0.200
Validation loss decreased (inf --> -0.199984).  Saving model ...
Epoch: 2 cost time: 1.270709753036499
Epoch: 2, Steps: 4 | Train Loss: 1.670 Vali Loss: 1.573 Vali Acc: 0.180 Test Loss: 1.573 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1598529815673828
Epoch: 3, Steps: 4 | Train Loss: 1.479 Vali Loss: 1.535 Vali Acc: 0.300 Test Loss: 1.535 Test Acc: 0.300
Validation loss decreased (-0.199984 --> -0.299985).  Saving model ...
Epoch: 4 cost time: 1.3781015872955322
Epoch: 4, Steps: 4 | Train Loss: 1.373 Vali Loss: 1.477 Vali Acc: 0.360 Test Loss: 1.477 Test Acc: 0.360
Validation loss decreased (-0.299985 --> -0.359985).  Saving model ...
Epoch: 5 cost time: 1.271754264831543
Epoch: 5, Steps: 4 | Train Loss: 1.132 Vali Loss: 1.413 Vali Acc: 0.400 Test Loss: 1.413 Test Acc: 0.400
Validation loss decreased (-0.359985 --> -0.399986).  Saving model ...
Epoch: 6 cost time: 1.3441369533538818
Epoch: 6, Steps: 4 | Train Loss: 1.064 Vali Loss: 1.350 Vali Acc: 0.420 Test Loss: 1.350 Test Acc: 0.420
Validation loss decreased (-0.399986 --> -0.419987).  Saving model ...
Epoch: 7 cost time: 1.3295774459838867
Epoch: 7, Steps: 4 | Train Loss: 0.891 Vali Loss: 1.296 Vali Acc: 0.480 Test Loss: 1.296 Test Acc: 0.480
Validation loss decreased (-0.419987 --> -0.479987).  Saving model ...
Epoch: 8 cost time: 1.314800500869751
Epoch: 8, Steps: 4 | Train Loss: 0.763 Vali Loss: 1.250 Vali Acc: 0.460 Test Loss: 1.250 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2702605724334717
Epoch: 9, Steps: 4 | Train Loss: 0.668 Vali Loss: 1.213 Vali Acc: 0.440 Test Loss: 1.213 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.4431302547454834
Epoch: 10, Steps: 4 | Train Loss: 0.502 Vali Loss: 1.181 Vali Acc: 0.540 Test Loss: 1.181 Test Acc: 0.540
Validation loss decreased (-0.479987 --> -0.539988).  Saving model ...
Epoch: 11 cost time: 1.2361457347869873
Epoch: 11, Steps: 4 | Train Loss: 0.420 Vali Loss: 1.177 Vali Acc: 0.500 Test Loss: 1.177 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.219322681427002
Epoch: 12, Steps: 4 | Train Loss: 0.382 Vali Loss: 1.171 Vali Acc: 0.500 Test Loss: 1.171 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.2965216636657715
Epoch: 13, Steps: 4 | Train Loss: 0.255 Vali Loss: 1.165 Vali Acc: 0.560 Test Loss: 1.165 Test Acc: 0.560
Validation loss decreased (-0.539988 --> -0.559988).  Saving model ...
Epoch: 14 cost time: 1.3779897689819336
Epoch: 14, Steps: 4 | Train Loss: 0.218 Vali Loss: 1.159 Vali Acc: 0.480 Test Loss: 1.159 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2434346675872803
Epoch: 15, Steps: 4 | Train Loss: 0.166 Vali Loss: 1.191 Vali Acc: 0.560 Test Loss: 1.191 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.3303320407867432
Epoch: 16, Steps: 4 | Train Loss: 0.172 Vali Loss: 1.217 Vali Acc: 0.560 Test Loss: 1.217 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.381007432937622
Epoch: 17, Steps: 4 | Train Loss: 0.110 Vali Loss: 1.184 Vali Acc: 0.520 Test Loss: 1.184 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.2435262203216553
Epoch: 18, Steps: 4 | Train Loss: 0.097 Vali Loss: 1.265 Vali Acc: 0.500 Test Loss: 1.265 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.2735092639923096
Epoch: 19, Steps: 4 | Train Loss: 0.074 Vali Loss: 1.153 Vali Acc: 0.520 Test Loss: 1.153 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.2933526039123535
Epoch: 20, Steps: 4 | Train Loss: 0.060 Vali Loss: 1.181 Vali Acc: 0.500 Test Loss: 1.181 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.3199100494384766
Epoch: 21, Steps: 4 | Train Loss: 0.050 Vali Loss: 1.258 Vali Acc: 0.560 Test Loss: 1.258 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.327434778213501
Epoch: 22, Steps: 4 | Train Loss: 0.036 Vali Loss: 1.240 Vali Acc: 0.560 Test Loss: 1.240 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.300177812576294
Epoch: 23, Steps: 4 | Train Loss: 0.029 Vali Loss: 1.243 Vali Acc: 0.540 Test Loss: 1.243 Test Acc: 0.540
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm32_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 1550053
model size : 6.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm32_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.9663166999816895
Epoch: 1, Steps: 4 | Train Loss: 1.627 Vali Loss: 1.652 Vali Acc: 0.200 Test Loss: 1.652 Test Acc: 0.200
Validation loss decreased (inf --> -0.199983).  Saving model ...
Epoch: 2 cost time: 2.781312942504883
Epoch: 2, Steps: 4 | Train Loss: 1.534 Vali Loss: 1.638 Vali Acc: 0.240 Test Loss: 1.638 Test Acc: 0.240
Validation loss decreased (-0.199983 --> -0.239984).  Saving model ...
Epoch: 3 cost time: 2.894500732421875
Epoch: 3, Steps: 4 | Train Loss: 1.434 Vali Loss: 1.617 Vali Acc: 0.260 Test Loss: 1.617 Test Acc: 0.260
Validation loss decreased (-0.239984 --> -0.259984).  Saving model ...
Epoch: 4 cost time: 2.7346339225769043
Epoch: 4, Steps: 4 | Train Loss: 1.335 Vali Loss: 1.590 Vali Acc: 0.320 Test Loss: 1.590 Test Acc: 0.320
Validation loss decreased (-0.259984 --> -0.319984).  Saving model ...
Epoch: 5 cost time: 2.841233253479004
Epoch: 5, Steps: 4 | Train Loss: 1.256 Vali Loss: 1.580 Vali Acc: 0.260 Test Loss: 1.580 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.6842544078826904
Epoch: 6, Steps: 4 | Train Loss: 1.134 Vali Loss: 1.568 Vali Acc: 0.320 Test Loss: 1.568 Test Acc: 0.320
Validation loss decreased (-0.319984 --> -0.319984).  Saving model ...
Epoch: 7 cost time: 2.9192240238189697
Epoch: 7, Steps: 4 | Train Loss: 0.986 Vali Loss: 1.551 Vali Acc: 0.320 Test Loss: 1.551 Test Acc: 0.320
Validation loss decreased (-0.319984 --> -0.319984).  Saving model ...
Epoch: 8 cost time: 2.7629127502441406
Epoch: 8, Steps: 4 | Train Loss: 0.817 Vali Loss: 1.540 Vali Acc: 0.400 Test Loss: 1.540 Test Acc: 0.400
Validation loss decreased (-0.319984 --> -0.399985).  Saving model ...
Epoch: 9 cost time: 2.8775205612182617
Epoch: 9, Steps: 4 | Train Loss: 0.811 Vali Loss: 1.495 Vali Acc: 0.380 Test Loss: 1.495 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.7621867656707764
Epoch: 10, Steps: 4 | Train Loss: 0.539 Vali Loss: 1.432 Vali Acc: 0.400 Test Loss: 1.432 Test Acc: 0.400
Validation loss decreased (-0.399985 --> -0.399986).  Saving model ...
Epoch: 11 cost time: 2.736795425415039
Epoch: 11, Steps: 4 | Train Loss: 0.456 Vali Loss: 1.376 Vali Acc: 0.440 Test Loss: 1.376 Test Acc: 0.440
Validation loss decreased (-0.399986 --> -0.439986).  Saving model ...
Epoch: 12 cost time: 2.617351770401001
Epoch: 12, Steps: 4 | Train Loss: 0.342 Vali Loss: 1.336 Vali Acc: 0.440 Test Loss: 1.336 Test Acc: 0.440
Validation loss decreased (-0.439986 --> -0.439987).  Saving model ...
Epoch: 13 cost time: 2.7563745975494385
Epoch: 13, Steps: 4 | Train Loss: 0.276 Vali Loss: 1.223 Vali Acc: 0.480 Test Loss: 1.223 Test Acc: 0.480
Validation loss decreased (-0.439987 --> -0.479988).  Saving model ...
Epoch: 14 cost time: 2.5836546421051025
Epoch: 14, Steps: 4 | Train Loss: 0.465 Vali Loss: 1.155 Vali Acc: 0.500 Test Loss: 1.155 Test Acc: 0.500
Validation loss decreased (-0.479988 --> -0.499988).  Saving model ...
Epoch: 15 cost time: 2.8770394325256348
Epoch: 15, Steps: 4 | Train Loss: 0.172 Vali Loss: 1.142 Vali Acc: 0.520 Test Loss: 1.142 Test Acc: 0.520
Validation loss decreased (-0.499988 --> -0.519989).  Saving model ...
Epoch: 16 cost time: 2.620478391647339
Epoch: 16, Steps: 4 | Train Loss: 0.225 Vali Loss: 1.171 Vali Acc: 0.520 Test Loss: 1.171 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.738574266433716
Epoch: 17, Steps: 4 | Train Loss: 0.203 Vali Loss: 1.373 Vali Acc: 0.480 Test Loss: 1.373 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.6701197624206543
Epoch: 18, Steps: 4 | Train Loss: 0.141 Vali Loss: 1.323 Vali Acc: 0.500 Test Loss: 1.323 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.751580238342285
Epoch: 19, Steps: 4 | Train Loss: 0.102 Vali Loss: 1.259 Vali Acc: 0.520 Test Loss: 1.259 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.8739073276519775
Epoch: 20, Steps: 4 | Train Loss: 0.061 Vali Loss: 1.266 Vali Acc: 0.540 Test Loss: 1.266 Test Acc: 0.540
Validation loss decreased (-0.519989 --> -0.539987).  Saving model ...
Epoch: 21 cost time: 2.741830825805664
Epoch: 21, Steps: 4 | Train Loss: 0.056 Vali Loss: 1.221 Vali Acc: 0.540 Test Loss: 1.221 Test Acc: 0.540
Validation loss decreased (-0.539987 --> -0.539988).  Saving model ...
Epoch: 22 cost time: 3.021181344985962
Epoch: 22, Steps: 4 | Train Loss: 0.042 Vali Loss: 1.231 Vali Acc: 0.500 Test Loss: 1.231 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.5217530727386475
Epoch: 23, Steps: 4 | Train Loss: 0.040 Vali Loss: 1.174 Vali Acc: 0.500 Test Loss: 1.174 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.899104356765747
Epoch: 24, Steps: 4 | Train Loss: 0.025 Vali Loss: 1.189 Vali Acc: 0.540 Test Loss: 1.189 Test Acc: 0.540
Validation loss decreased (-0.539988 --> -0.539988).  Saving model ...
Epoch: 25 cost time: 2.535672903060913
Epoch: 25, Steps: 4 | Train Loss: 0.020 Vali Loss: 1.129 Vali Acc: 0.560 Test Loss: 1.129 Test Acc: 0.560
Validation loss decreased (-0.539988 --> -0.559989).  Saving model ...
Epoch: 26 cost time: 2.6068496704101562
Epoch: 26, Steps: 4 | Train Loss: 0.021 Vali Loss: 1.128 Vali Acc: 0.580 Test Loss: 1.128 Test Acc: 0.580
Validation loss decreased (-0.559989 --> -0.579989).  Saving model ...
Epoch: 27 cost time: 2.773402452468872
Epoch: 27, Steps: 4 | Train Loss: 0.013 Vali Loss: 1.163 Vali Acc: 0.560 Test Loss: 1.163 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.945302724838257
Epoch: 28, Steps: 4 | Train Loss: 0.013 Vali Loss: 1.199 Vali Acc: 0.540 Test Loss: 1.199 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.719554901123047
Epoch: 29, Steps: 4 | Train Loss: 0.011 Vali Loss: 1.217 Vali Acc: 0.540 Test Loss: 1.217 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.7318239212036133
Epoch: 30, Steps: 4 | Train Loss: 0.012 Vali Loss: 1.156 Vali Acc: 0.540 Test Loss: 1.156 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm32_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 2516581
model size : 10.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm32_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.0077064037323
Epoch: 1, Steps: 4 | Train Loss: 1.655 Vali Loss: 1.653 Vali Acc: 0.220 Test Loss: 1.653 Test Acc: 0.220
Validation loss decreased (inf --> -0.219983).  Saving model ...
Epoch: 2 cost time: 1.8512790203094482
Epoch: 2, Steps: 4 | Train Loss: 1.649 Vali Loss: 1.628 Vali Acc: 0.220 Test Loss: 1.628 Test Acc: 0.220
Validation loss decreased (-0.219983 --> -0.219984).  Saving model ...
Epoch: 3 cost time: 1.6994247436523438
Epoch: 3, Steps: 4 | Train Loss: 1.470 Vali Loss: 1.588 Vali Acc: 0.320 Test Loss: 1.588 Test Acc: 0.320
Validation loss decreased (-0.219984 --> -0.319984).  Saving model ...
Epoch: 4 cost time: 1.7139544486999512
Epoch: 4, Steps: 4 | Train Loss: 1.329 Vali Loss: 1.544 Vali Acc: 0.340 Test Loss: 1.544 Test Acc: 0.340
Validation loss decreased (-0.319984 --> -0.339985).  Saving model ...
Epoch: 5 cost time: 1.8429336547851562
Epoch: 5, Steps: 4 | Train Loss: 1.170 Vali Loss: 1.498 Vali Acc: 0.340 Test Loss: 1.498 Test Acc: 0.340
Validation loss decreased (-0.339985 --> -0.339985).  Saving model ...
Epoch: 6 cost time: 1.9315690994262695
Epoch: 6, Steps: 4 | Train Loss: 1.042 Vali Loss: 1.458 Vali Acc: 0.380 Test Loss: 1.458 Test Acc: 0.380
Validation loss decreased (-0.339985 --> -0.379985).  Saving model ...
Epoch: 7 cost time: 1.7399988174438477
Epoch: 7, Steps: 4 | Train Loss: 0.883 Vali Loss: 1.399 Vali Acc: 0.420 Test Loss: 1.399 Test Acc: 0.420
Validation loss decreased (-0.379985 --> -0.419986).  Saving model ...
Epoch: 8 cost time: 1.9555437564849854
Epoch: 8, Steps: 4 | Train Loss: 0.695 Vali Loss: 1.342 Vali Acc: 0.520 Test Loss: 1.342 Test Acc: 0.520
Validation loss decreased (-0.419986 --> -0.519987).  Saving model ...
Epoch: 9 cost time: 1.7925689220428467
Epoch: 9, Steps: 4 | Train Loss: 0.760 Vali Loss: 1.299 Vali Acc: 0.520 Test Loss: 1.299 Test Acc: 0.520
Validation loss decreased (-0.519987 --> -0.519987).  Saving model ...
Epoch: 10 cost time: 1.6540088653564453
Epoch: 10, Steps: 4 | Train Loss: 0.447 Vali Loss: 1.253 Vali Acc: 0.520 Test Loss: 1.253 Test Acc: 0.520
Validation loss decreased (-0.519987 --> -0.519987).  Saving model ...
Epoch: 11 cost time: 1.7342708110809326
Epoch: 11, Steps: 4 | Train Loss: 0.396 Vali Loss: 1.181 Vali Acc: 0.540 Test Loss: 1.181 Test Acc: 0.540
Validation loss decreased (-0.519987 --> -0.539988).  Saving model ...
Epoch: 12 cost time: 1.610743522644043
Epoch: 12, Steps: 4 | Train Loss: 0.306 Vali Loss: 1.111 Vali Acc: 0.540 Test Loss: 1.111 Test Acc: 0.540
Validation loss decreased (-0.539988 --> -0.539989).  Saving model ...
Epoch: 13 cost time: 1.732483148574829
Epoch: 13, Steps: 4 | Train Loss: 0.312 Vali Loss: 1.091 Vali Acc: 0.500 Test Loss: 1.091 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6423909664154053
Epoch: 14, Steps: 4 | Train Loss: 0.247 Vali Loss: 1.103 Vali Acc: 0.520 Test Loss: 1.103 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.8013277053833008
Epoch: 15, Steps: 4 | Train Loss: 0.170 Vali Loss: 1.096 Vali Acc: 0.500 Test Loss: 1.096 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.7081241607666016
Epoch: 16, Steps: 4 | Train Loss: 0.132 Vali Loss: 1.110 Vali Acc: 0.500 Test Loss: 1.110 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.9898478984832764
Epoch: 17, Steps: 4 | Train Loss: 0.116 Vali Loss: 1.158 Vali Acc: 0.500 Test Loss: 1.158 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.751666784286499
Epoch: 18, Steps: 4 | Train Loss: 0.080 Vali Loss: 1.254 Vali Acc: 0.500 Test Loss: 1.254 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.7163188457489014
Epoch: 19, Steps: 4 | Train Loss: 0.066 Vali Loss: 1.363 Vali Acc: 0.540 Test Loss: 1.363 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.759549856185913
Epoch: 20, Steps: 4 | Train Loss: 0.058 Vali Loss: 1.288 Vali Acc: 0.560 Test Loss: 1.288 Test Acc: 0.560
Validation loss decreased (-0.539989 --> -0.559987).  Saving model ...
Epoch: 21 cost time: 1.7609963417053223
Epoch: 21, Steps: 4 | Train Loss: 0.038 Vali Loss: 1.231 Vali Acc: 0.540 Test Loss: 1.231 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.617577314376831
Epoch: 22, Steps: 4 | Train Loss: 0.034 Vali Loss: 1.340 Vali Acc: 0.560 Test Loss: 1.340 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.625093936920166
Epoch: 23, Steps: 4 | Train Loss: 0.037 Vali Loss: 1.327 Vali Acc: 0.480 Test Loss: 1.327 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.7354271411895752
Epoch: 24, Steps: 4 | Train Loss: 0.026 Vali Loss: 1.378 Vali Acc: 0.500 Test Loss: 1.378 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.7058050632476807
Epoch: 25, Steps: 4 | Train Loss: 0.019 Vali Loss: 1.379 Vali Acc: 0.520 Test Loss: 1.379 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.8230042457580566
Epoch: 26, Steps: 4 | Train Loss: 0.019 Vali Loss: 1.289 Vali Acc: 0.520 Test Loss: 1.289 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.7782065868377686
Epoch: 27, Steps: 4 | Train Loss: 0.026 Vali Loss: 1.352 Vali Acc: 0.540 Test Loss: 1.352 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.7309389114379883
Epoch: 28, Steps: 4 | Train Loss: 0.030 Vali Loss: 1.391 Vali Acc: 0.540 Test Loss: 1.391 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.6952824592590332
Epoch: 29, Steps: 4 | Train Loss: 0.015 Vali Loss: 1.302 Vali Acc: 0.540 Test Loss: 1.302 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.780191421508789
Epoch: 30, Steps: 4 | Train Loss: 0.016 Vali Loss: 1.406 Vali Acc: 0.580 Test Loss: 1.406 Test Acc: 0.580
Validation loss decreased (-0.559987 --> -0.579986).  Saving model ...
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm32_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 861413
model size : 3.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm32_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.200738906860352
Epoch: 1, Steps: 4 | Train Loss: 1.628 Vali Loss: 1.654 Vali Acc: 0.180 Test Loss: 1.654 Test Acc: 0.180
Validation loss decreased (inf --> -0.179983).  Saving model ...
Epoch: 2 cost time: 2.3098692893981934
Epoch: 2, Steps: 4 | Train Loss: 1.535 Vali Loss: 1.640 Vali Acc: 0.220 Test Loss: 1.640 Test Acc: 0.220
Validation loss decreased (-0.179983 --> -0.219984).  Saving model ...
Epoch: 3 cost time: 2.241320848464966
Epoch: 3, Steps: 4 | Train Loss: 1.434 Vali Loss: 1.619 Vali Acc: 0.240 Test Loss: 1.619 Test Acc: 0.240
Validation loss decreased (-0.219984 --> -0.239984).  Saving model ...
Epoch: 4 cost time: 2.148439407348633
Epoch: 4, Steps: 4 | Train Loss: 1.340 Vali Loss: 1.593 Vali Acc: 0.320 Test Loss: 1.593 Test Acc: 0.320
Validation loss decreased (-0.239984 --> -0.319984).  Saving model ...
Epoch: 5 cost time: 2.163302183151245
Epoch: 5, Steps: 4 | Train Loss: 1.261 Vali Loss: 1.581 Vali Acc: 0.240 Test Loss: 1.581 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.111820697784424
Epoch: 6, Steps: 4 | Train Loss: 1.141 Vali Loss: 1.566 Vali Acc: 0.320 Test Loss: 1.566 Test Acc: 0.320
Validation loss decreased (-0.319984 --> -0.319984).  Saving model ...
Epoch: 7 cost time: 2.1582906246185303
Epoch: 7, Steps: 4 | Train Loss: 0.988 Vali Loss: 1.547 Vali Acc: 0.320 Test Loss: 1.547 Test Acc: 0.320
Validation loss decreased (-0.319984 --> -0.319985).  Saving model ...
Epoch: 8 cost time: 2.313066244125366
Epoch: 8, Steps: 4 | Train Loss: 0.822 Vali Loss: 1.534 Vali Acc: 0.380 Test Loss: 1.534 Test Acc: 0.380
Validation loss decreased (-0.319985 --> -0.379985).  Saving model ...
Epoch: 9 cost time: 2.270033836364746
Epoch: 9, Steps: 4 | Train Loss: 0.817 Vali Loss: 1.482 Vali Acc: 0.360 Test Loss: 1.482 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.04555082321167
Epoch: 10, Steps: 4 | Train Loss: 0.544 Vali Loss: 1.412 Vali Acc: 0.360 Test Loss: 1.412 Test Acc: 0.360
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.9629249572753906
Epoch: 11, Steps: 4 | Train Loss: 0.459 Vali Loss: 1.352 Vali Acc: 0.400 Test Loss: 1.352 Test Acc: 0.400
Validation loss decreased (-0.379985 --> -0.399986).  Saving model ...
Epoch: 12 cost time: 2.003541946411133
Epoch: 12, Steps: 4 | Train Loss: 0.341 Vali Loss: 1.304 Vali Acc: 0.460 Test Loss: 1.304 Test Acc: 0.460
Validation loss decreased (-0.399986 --> -0.459987).  Saving model ...
Epoch: 13 cost time: 2.228022575378418
Epoch: 13, Steps: 4 | Train Loss: 0.273 Vali Loss: 1.189 Vali Acc: 0.480 Test Loss: 1.189 Test Acc: 0.480
Validation loss decreased (-0.459987 --> -0.479988).  Saving model ...
Epoch: 14 cost time: 2.0024566650390625
Epoch: 14, Steps: 4 | Train Loss: 0.464 Vali Loss: 1.127 Vali Acc: 0.520 Test Loss: 1.127 Test Acc: 0.520
Validation loss decreased (-0.479988 --> -0.519989).  Saving model ...
Epoch: 15 cost time: 1.9582774639129639
Epoch: 15, Steps: 4 | Train Loss: 0.173 Vali Loss: 1.111 Vali Acc: 0.520 Test Loss: 1.111 Test Acc: 0.520
Validation loss decreased (-0.519989 --> -0.519989).  Saving model ...
Epoch: 16 cost time: 2.1229405403137207
Epoch: 16, Steps: 4 | Train Loss: 0.223 Vali Loss: 1.140 Vali Acc: 0.520 Test Loss: 1.140 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.2757747173309326
Epoch: 17, Steps: 4 | Train Loss: 0.155 Vali Loss: 1.351 Vali Acc: 0.460 Test Loss: 1.351 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.0528764724731445
Epoch: 18, Steps: 4 | Train Loss: 0.139 Vali Loss: 1.300 Vali Acc: 0.520 Test Loss: 1.300 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.0378177165985107
Epoch: 19, Steps: 4 | Train Loss: 0.099 Vali Loss: 1.239 Vali Acc: 0.500 Test Loss: 1.239 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.203662395477295
Epoch: 20, Steps: 4 | Train Loss: 0.061 Vali Loss: 1.244 Vali Acc: 0.540 Test Loss: 1.244 Test Acc: 0.540
Validation loss decreased (-0.519989 --> -0.539988).  Saving model ...
Epoch: 21 cost time: 2.119901180267334
Epoch: 21, Steps: 4 | Train Loss: 0.056 Vali Loss: 1.193 Vali Acc: 0.540 Test Loss: 1.193 Test Acc: 0.540
Validation loss decreased (-0.539988 --> -0.539988).  Saving model ...
Epoch: 22 cost time: 2.257380723953247
Epoch: 22, Steps: 4 | Train Loss: 0.043 Vali Loss: 1.204 Vali Acc: 0.500 Test Loss: 1.204 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.2242841720581055
Epoch: 23, Steps: 4 | Train Loss: 0.039 Vali Loss: 1.151 Vali Acc: 0.500 Test Loss: 1.151 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.09342622756958
Epoch: 24, Steps: 4 | Train Loss: 0.024 Vali Loss: 1.167 Vali Acc: 0.580 Test Loss: 1.167 Test Acc: 0.580
Validation loss decreased (-0.539988 --> -0.579988).  Saving model ...
Epoch: 25 cost time: 2.177715301513672
Epoch: 25, Steps: 4 | Train Loss: 0.019 Vali Loss: 1.110 Vali Acc: 0.580 Test Loss: 1.110 Test Acc: 0.580
Validation loss decreased (-0.579988 --> -0.579989).  Saving model ...
Epoch: 26 cost time: 2.2668981552124023
Epoch: 26, Steps: 4 | Train Loss: 0.021 Vali Loss: 1.114 Vali Acc: 0.580 Test Loss: 1.114 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.367455005645752
Epoch: 27, Steps: 4 | Train Loss: 0.014 Vali Loss: 1.155 Vali Acc: 0.520 Test Loss: 1.155 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.1096692085266113
Epoch: 28, Steps: 4 | Train Loss: 0.013 Vali Loss: 1.202 Vali Acc: 0.540 Test Loss: 1.202 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.253818988800049
Epoch: 29, Steps: 4 | Train Loss: 0.011 Vali Loss: 1.219 Vali Acc: 0.520 Test Loss: 1.219 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.045145034790039
Epoch: 30, Steps: 4 | Train Loss: 0.012 Vali Loss: 1.150 Vali Acc: 0.540 Test Loss: 1.150 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm32_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 2516581
model size : 10.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm32_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.472791910171509
Epoch: 1, Steps: 4 | Train Loss: 1.655 Vali Loss: 1.651 Vali Acc: 0.220 Test Loss: 1.651 Test Acc: 0.220
Validation loss decreased (inf --> -0.219983).  Saving model ...
Epoch: 2 cost time: 1.5012037754058838
Epoch: 2, Steps: 4 | Train Loss: 1.650 Vali Loss: 1.626 Vali Acc: 0.220 Test Loss: 1.626 Test Acc: 0.220
Validation loss decreased (-0.219983 --> -0.219984).  Saving model ...
Epoch: 3 cost time: 1.4665257930755615
Epoch: 3, Steps: 4 | Train Loss: 1.470 Vali Loss: 1.586 Vali Acc: 0.320 Test Loss: 1.586 Test Acc: 0.320
Validation loss decreased (-0.219984 --> -0.319984).  Saving model ...
Epoch: 4 cost time: 1.473829746246338
Epoch: 4, Steps: 4 | Train Loss: 1.333 Vali Loss: 1.541 Vali Acc: 0.340 Test Loss: 1.541 Test Acc: 0.340
Validation loss decreased (-0.319984 --> -0.339985).  Saving model ...
Epoch: 5 cost time: 1.4569785594940186
Epoch: 5, Steps: 4 | Train Loss: 1.174 Vali Loss: 1.492 Vali Acc: 0.340 Test Loss: 1.492 Test Acc: 0.340
Validation loss decreased (-0.339985 --> -0.339985).  Saving model ...
Epoch: 6 cost time: 1.4244658946990967
Epoch: 6, Steps: 4 | Train Loss: 1.045 Vali Loss: 1.453 Vali Acc: 0.380 Test Loss: 1.453 Test Acc: 0.380
Validation loss decreased (-0.339985 --> -0.379985).  Saving model ...
Epoch: 7 cost time: 1.4253108501434326
Epoch: 7, Steps: 4 | Train Loss: 0.884 Vali Loss: 1.389 Vali Acc: 0.420 Test Loss: 1.389 Test Acc: 0.420
Validation loss decreased (-0.379985 --> -0.419986).  Saving model ...
Epoch: 8 cost time: 1.6242640018463135
Epoch: 8, Steps: 4 | Train Loss: 0.701 Vali Loss: 1.328 Vali Acc: 0.520 Test Loss: 1.328 Test Acc: 0.520
Validation loss decreased (-0.419986 --> -0.519987).  Saving model ...
Epoch: 9 cost time: 1.5540120601654053
Epoch: 9, Steps: 4 | Train Loss: 0.757 Vali Loss: 1.271 Vali Acc: 0.520 Test Loss: 1.271 Test Acc: 0.520
Validation loss decreased (-0.519987 --> -0.519987).  Saving model ...
Epoch: 10 cost time: 1.5424466133117676
Epoch: 10, Steps: 4 | Train Loss: 0.470 Vali Loss: 1.215 Vali Acc: 0.540 Test Loss: 1.215 Test Acc: 0.540
Validation loss decreased (-0.519987 --> -0.539988).  Saving model ...
Epoch: 11 cost time: 1.4726409912109375
Epoch: 11, Steps: 4 | Train Loss: 0.392 Vali Loss: 1.138 Vali Acc: 0.540 Test Loss: 1.138 Test Acc: 0.540
Validation loss decreased (-0.539988 --> -0.539989).  Saving model ...
Epoch: 12 cost time: 1.5783188343048096
Epoch: 12, Steps: 4 | Train Loss: 0.307 Vali Loss: 1.078 Vali Acc: 0.540 Test Loss: 1.078 Test Acc: 0.540
Validation loss decreased (-0.539989 --> -0.539989).  Saving model ...
Epoch: 13 cost time: 1.568345546722412
Epoch: 13, Steps: 4 | Train Loss: 0.318 Vali Loss: 1.058 Vali Acc: 0.500 Test Loss: 1.058 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.505502462387085
Epoch: 14, Steps: 4 | Train Loss: 0.247 Vali Loss: 1.059 Vali Acc: 0.520 Test Loss: 1.059 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.4660999774932861
Epoch: 15, Steps: 4 | Train Loss: 0.156 Vali Loss: 1.038 Vali Acc: 0.520 Test Loss: 1.038 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.5206913948059082
Epoch: 16, Steps: 4 | Train Loss: 0.128 Vali Loss: 1.042 Vali Acc: 0.500 Test Loss: 1.042 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.4413154125213623
Epoch: 17, Steps: 4 | Train Loss: 0.118 Vali Loss: 1.102 Vali Acc: 0.560 Test Loss: 1.102 Test Acc: 0.560
Validation loss decreased (-0.539989 --> -0.559989).  Saving model ...
Epoch: 18 cost time: 1.4474823474884033
Epoch: 18, Steps: 4 | Train Loss: 0.078 Vali Loss: 1.182 Vali Acc: 0.560 Test Loss: 1.182 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.427487850189209
Epoch: 19, Steps: 4 | Train Loss: 0.066 Vali Loss: 1.272 Vali Acc: 0.580 Test Loss: 1.272 Test Acc: 0.580
Validation loss decreased (-0.559989 --> -0.579987).  Saving model ...
Epoch: 20 cost time: 1.4731080532073975
Epoch: 20, Steps: 4 | Train Loss: 0.063 Vali Loss: 1.184 Vali Acc: 0.620 Test Loss: 1.184 Test Acc: 0.620
Validation loss decreased (-0.579987 --> -0.619988).  Saving model ...
Epoch: 21 cost time: 1.4878973960876465
Epoch: 21, Steps: 4 | Train Loss: 0.040 Vali Loss: 1.126 Vali Acc: 0.560 Test Loss: 1.126 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.4837024211883545
Epoch: 22, Steps: 4 | Train Loss: 0.038 Vali Loss: 1.247 Vali Acc: 0.600 Test Loss: 1.247 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.4942958354949951
Epoch: 23, Steps: 4 | Train Loss: 0.043 Vali Loss: 1.251 Vali Acc: 0.580 Test Loss: 1.251 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.247603178024292
Epoch: 24, Steps: 4 | Train Loss: 0.030 Vali Loss: 1.269 Vali Acc: 0.480 Test Loss: 1.269 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.475318193435669
Epoch: 25, Steps: 4 | Train Loss: 0.021 Vali Loss: 1.302 Vali Acc: 0.540 Test Loss: 1.302 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.515186071395874
Epoch: 26, Steps: 4 | Train Loss: 0.023 Vali Loss: 1.215 Vali Acc: 0.560 Test Loss: 1.215 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.4302566051483154
Epoch: 27, Steps: 4 | Train Loss: 0.027 Vali Loss: 1.178 Vali Acc: 0.560 Test Loss: 1.178 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.4275033473968506
Epoch: 28, Steps: 4 | Train Loss: 0.025 Vali Loss: 1.216 Vali Acc: 0.540 Test Loss: 1.216 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.399482250213623
Epoch: 29, Steps: 4 | Train Loss: 0.015 Vali Loss: 1.155 Vali Acc: 0.560 Test Loss: 1.155 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.5465118885040283
Epoch: 30, Steps: 4 | Train Loss: 0.015 Vali Loss: 1.259 Vali Acc: 0.580 Test Loss: 1.259 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm32_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.62
model parameter : 861413
model size : 3.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm32_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.3879358768463135
Epoch: 1, Steps: 4 | Train Loss: 1.640 Vali Loss: 1.657 Vali Acc: 0.180 Test Loss: 1.657 Test Acc: 0.180
Validation loss decreased (inf --> -0.179983).  Saving model ...
Epoch: 2 cost time: 1.5786018371582031
Epoch: 2, Steps: 4 | Train Loss: 1.549 Vali Loss: 1.643 Vali Acc: 0.220 Test Loss: 1.643 Test Acc: 0.220
Validation loss decreased (-0.179983 --> -0.219984).  Saving model ...
Epoch: 3 cost time: 1.4704105854034424
Epoch: 3, Steps: 4 | Train Loss: 1.460 Vali Loss: 1.622 Vali Acc: 0.240 Test Loss: 1.622 Test Acc: 0.240
Validation loss decreased (-0.219984 --> -0.239984).  Saving model ...
Epoch: 4 cost time: 1.3420264720916748
Epoch: 4, Steps: 4 | Train Loss: 1.343 Vali Loss: 1.596 Vali Acc: 0.300 Test Loss: 1.596 Test Acc: 0.300
Validation loss decreased (-0.239984 --> -0.299984).  Saving model ...
Epoch: 5 cost time: 1.4177682399749756
Epoch: 5, Steps: 4 | Train Loss: 1.276 Vali Loss: 1.584 Vali Acc: 0.240 Test Loss: 1.584 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6264715194702148
Epoch: 6, Steps: 4 | Train Loss: 1.145 Vali Loss: 1.570 Vali Acc: 0.320 Test Loss: 1.570 Test Acc: 0.320
Validation loss decreased (-0.299984 --> -0.319984).  Saving model ...
Epoch: 7 cost time: 1.5661678314208984
Epoch: 7, Steps: 4 | Train Loss: 0.992 Vali Loss: 1.550 Vali Acc: 0.300 Test Loss: 1.550 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.565920114517212
Epoch: 8, Steps: 4 | Train Loss: 0.829 Vali Loss: 1.535 Vali Acc: 0.380 Test Loss: 1.535 Test Acc: 0.380
Validation loss decreased (-0.319984 --> -0.379985).  Saving model ...
Epoch: 9 cost time: 1.6677849292755127
Epoch: 9, Steps: 4 | Train Loss: 0.826 Vali Loss: 1.484 Vali Acc: 0.360 Test Loss: 1.484 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6177375316619873
Epoch: 10, Steps: 4 | Train Loss: 0.551 Vali Loss: 1.415 Vali Acc: 0.380 Test Loss: 1.415 Test Acc: 0.380
Validation loss decreased (-0.379985 --> -0.379986).  Saving model ...
Epoch: 11 cost time: 1.6247668266296387
Epoch: 11, Steps: 4 | Train Loss: 0.468 Vali Loss: 1.357 Vali Acc: 0.380 Test Loss: 1.357 Test Acc: 0.380
Validation loss decreased (-0.379986 --> -0.379986).  Saving model ...
Epoch: 12 cost time: 1.4397616386413574
Epoch: 12, Steps: 4 | Train Loss: 0.363 Vali Loss: 1.308 Vali Acc: 0.420 Test Loss: 1.308 Test Acc: 0.420
Validation loss decreased (-0.379986 --> -0.419987).  Saving model ...
Epoch: 13 cost time: 1.5582506656646729
Epoch: 13, Steps: 4 | Train Loss: 0.288 Vali Loss: 1.199 Vali Acc: 0.480 Test Loss: 1.199 Test Acc: 0.480
Validation loss decreased (-0.419987 --> -0.479988).  Saving model ...
Epoch: 14 cost time: 1.5622234344482422
Epoch: 14, Steps: 4 | Train Loss: 0.460 Vali Loss: 1.122 Vali Acc: 0.540 Test Loss: 1.122 Test Acc: 0.540
Validation loss decreased (-0.479988 --> -0.539989).  Saving model ...
Epoch: 15 cost time: 1.4718525409698486
Epoch: 15, Steps: 4 | Train Loss: 0.182 Vali Loss: 1.103 Vali Acc: 0.500 Test Loss: 1.103 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.6105403900146484
Epoch: 16, Steps: 4 | Train Loss: 0.224 Vali Loss: 1.142 Vali Acc: 0.540 Test Loss: 1.142 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.6786434650421143
Epoch: 17, Steps: 4 | Train Loss: 0.144 Vali Loss: 1.336 Vali Acc: 0.480 Test Loss: 1.336 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.438446044921875
Epoch: 18, Steps: 4 | Train Loss: 0.142 Vali Loss: 1.278 Vali Acc: 0.440 Test Loss: 1.278 Test Acc: 0.440
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.595043659210205
Epoch: 19, Steps: 4 | Train Loss: 0.102 Vali Loss: 1.221 Vali Acc: 0.520 Test Loss: 1.221 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.6431376934051514
Epoch: 20, Steps: 4 | Train Loss: 0.062 Vali Loss: 1.282 Vali Acc: 0.520 Test Loss: 1.282 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.5091803073883057
Epoch: 21, Steps: 4 | Train Loss: 0.054 Vali Loss: 1.244 Vali Acc: 0.540 Test Loss: 1.244 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.5271148681640625
Epoch: 22, Steps: 4 | Train Loss: 0.044 Vali Loss: 1.252 Vali Acc: 0.480 Test Loss: 1.252 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.4754974842071533
Epoch: 23, Steps: 4 | Train Loss: 0.039 Vali Loss: 1.212 Vali Acc: 0.500 Test Loss: 1.212 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.5044422149658203
Epoch: 24, Steps: 4 | Train Loss: 0.024 Vali Loss: 1.255 Vali Acc: 0.520 Test Loss: 1.255 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm32_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 2516581
model size : 10.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm32_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.0422115325927734
Epoch: 1, Steps: 4 | Train Loss: 1.656 Vali Loss: 1.662 Vali Acc: 0.220 Test Loss: 1.662 Test Acc: 0.220
Validation loss decreased (inf --> -0.219983).  Saving model ...
Epoch: 2 cost time: 1.2370045185089111
Epoch: 2, Steps: 4 | Train Loss: 1.651 Vali Loss: 1.637 Vali Acc: 0.220 Test Loss: 1.637 Test Acc: 0.220
Validation loss decreased (-0.219983 --> -0.219984).  Saving model ...
Epoch: 3 cost time: 1.1336162090301514
Epoch: 3, Steps: 4 | Train Loss: 1.472 Vali Loss: 1.596 Vali Acc: 0.320 Test Loss: 1.596 Test Acc: 0.320
Validation loss decreased (-0.219984 --> -0.319984).  Saving model ...
Epoch: 4 cost time: 1.0253756046295166
Epoch: 4, Steps: 4 | Train Loss: 1.335 Vali Loss: 1.551 Vali Acc: 0.340 Test Loss: 1.551 Test Acc: 0.340
Validation loss decreased (-0.319984 --> -0.339984).  Saving model ...
Epoch: 5 cost time: 1.259624719619751
Epoch: 5, Steps: 4 | Train Loss: 1.178 Vali Loss: 1.503 Vali Acc: 0.340 Test Loss: 1.503 Test Acc: 0.340
Validation loss decreased (-0.339984 --> -0.339985).  Saving model ...
Epoch: 6 cost time: 1.1140918731689453
Epoch: 6, Steps: 4 | Train Loss: 1.048 Vali Loss: 1.457 Vali Acc: 0.360 Test Loss: 1.457 Test Acc: 0.360
Validation loss decreased (-0.339985 --> -0.359985).  Saving model ...
Epoch: 7 cost time: 1.2344050407409668
Epoch: 7, Steps: 4 | Train Loss: 0.890 Vali Loss: 1.391 Vali Acc: 0.440 Test Loss: 1.391 Test Acc: 0.440
Validation loss decreased (-0.359985 --> -0.439986).  Saving model ...
Epoch: 8 cost time: 1.116725206375122
Epoch: 8, Steps: 4 | Train Loss: 0.707 Vali Loss: 1.330 Vali Acc: 0.540 Test Loss: 1.330 Test Acc: 0.540
Validation loss decreased (-0.439986 --> -0.539987).  Saving model ...
Epoch: 9 cost time: 1.1874501705169678
Epoch: 9, Steps: 4 | Train Loss: 0.742 Vali Loss: 1.268 Vali Acc: 0.520 Test Loss: 1.268 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1154429912567139
Epoch: 10, Steps: 4 | Train Loss: 0.482 Vali Loss: 1.207 Vali Acc: 0.540 Test Loss: 1.207 Test Acc: 0.540
Validation loss decreased (-0.539987 --> -0.539988).  Saving model ...
Epoch: 11 cost time: 1.1698310375213623
Epoch: 11, Steps: 4 | Train Loss: 0.406 Vali Loss: 1.127 Vali Acc: 0.520 Test Loss: 1.127 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9932055473327637
Epoch: 12, Steps: 4 | Train Loss: 0.318 Vali Loss: 1.065 Vali Acc: 0.500 Test Loss: 1.065 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.2273316383361816
Epoch: 13, Steps: 4 | Train Loss: 0.322 Vali Loss: 1.031 Vali Acc: 0.520 Test Loss: 1.031 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.0959205627441406
Epoch: 14, Steps: 4 | Train Loss: 0.259 Vali Loss: 1.032 Vali Acc: 0.540 Test Loss: 1.032 Test Acc: 0.540
Validation loss decreased (-0.539988 --> -0.539990).  Saving model ...
Epoch: 15 cost time: 1.1323246955871582
Epoch: 15, Steps: 4 | Train Loss: 0.162 Vali Loss: 1.019 Vali Acc: 0.500 Test Loss: 1.019 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2131197452545166
Epoch: 16, Steps: 4 | Train Loss: 0.136 Vali Loss: 1.041 Vali Acc: 0.520 Test Loss: 1.041 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.1932406425476074
Epoch: 17, Steps: 4 | Train Loss: 0.122 Vali Loss: 1.094 Vali Acc: 0.520 Test Loss: 1.094 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.2319986820220947
Epoch: 18, Steps: 4 | Train Loss: 0.082 Vali Loss: 1.168 Vali Acc: 0.540 Test Loss: 1.168 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.1587855815887451
Epoch: 19, Steps: 4 | Train Loss: 0.068 Vali Loss: 1.226 Vali Acc: 0.580 Test Loss: 1.226 Test Acc: 0.580
Validation loss decreased (-0.539990 --> -0.579988).  Saving model ...
Epoch: 20 cost time: 1.1672313213348389
Epoch: 20, Steps: 4 | Train Loss: 0.064 Vali Loss: 1.144 Vali Acc: 0.580 Test Loss: 1.144 Test Acc: 0.580
Validation loss decreased (-0.579988 --> -0.579989).  Saving model ...
Epoch: 21 cost time: 1.2353544235229492
Epoch: 21, Steps: 4 | Train Loss: 0.043 Vali Loss: 1.131 Vali Acc: 0.540 Test Loss: 1.131 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.3451762199401855
Epoch: 22, Steps: 4 | Train Loss: 0.036 Vali Loss: 1.237 Vali Acc: 0.580 Test Loss: 1.237 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.2728607654571533
Epoch: 23, Steps: 4 | Train Loss: 0.074 Vali Loss: 1.197 Vali Acc: 0.540 Test Loss: 1.197 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.2267706394195557
Epoch: 24, Steps: 4 | Train Loss: 0.026 Vali Loss: 1.172 Vali Acc: 0.540 Test Loss: 1.172 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.1927976608276367
Epoch: 25, Steps: 4 | Train Loss: 0.024 Vali Loss: 1.108 Vali Acc: 0.500 Test Loss: 1.108 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.2359163761138916
Epoch: 26, Steps: 4 | Train Loss: 0.029 Vali Loss: 1.078 Vali Acc: 0.540 Test Loss: 1.078 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.1802241802215576
Epoch: 27, Steps: 4 | Train Loss: 0.027 Vali Loss: 1.200 Vali Acc: 0.560 Test Loss: 1.200 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.271916389465332
Epoch: 28, Steps: 4 | Train Loss: 0.039 Vali Loss: 1.170 Vali Acc: 0.560 Test Loss: 1.170 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.0555825233459473
Epoch: 29, Steps: 4 | Train Loss: 0.016 Vali Loss: 1.039 Vali Acc: 0.540 Test Loss: 1.039 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.2172675132751465
Epoch: 30, Steps: 4 | Train Loss: 0.018 Vali Loss: 1.156 Vali Acc: 0.560 Test Loss: 1.156 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm32_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 861413
model size : 3.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm32_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.6126632690429688
Epoch: 1, Steps: 4 | Train Loss: 1.595 Vali Loss: 1.582 Vali Acc: 0.280 Test Loss: 1.582 Test Acc: 0.280
Validation loss decreased (inf --> -0.279984).  Saving model ...
Epoch: 2 cost time: 1.7999794483184814
Epoch: 2, Steps: 4 | Train Loss: 1.577 Vali Loss: 1.563 Vali Acc: 0.320 Test Loss: 1.563 Test Acc: 0.320
Validation loss decreased (-0.279984 --> -0.319984).  Saving model ...
Epoch: 3 cost time: 1.7309057712554932
Epoch: 3, Steps: 4 | Train Loss: 1.572 Vali Loss: 1.525 Vali Acc: 0.320 Test Loss: 1.525 Test Acc: 0.320
Validation loss decreased (-0.319984 --> -0.319985).  Saving model ...
Epoch: 4 cost time: 1.9103202819824219
Epoch: 4, Steps: 4 | Train Loss: 1.355 Vali Loss: 1.492 Vali Acc: 0.400 Test Loss: 1.492 Test Acc: 0.400
Validation loss decreased (-0.319985 --> -0.399985).  Saving model ...
Epoch: 5 cost time: 1.7553558349609375
Epoch: 5, Steps: 4 | Train Loss: 1.211 Vali Loss: 1.444 Vali Acc: 0.480 Test Loss: 1.444 Test Acc: 0.480
Validation loss decreased (-0.399985 --> -0.479986).  Saving model ...
Epoch: 6 cost time: 1.8253166675567627
Epoch: 6, Steps: 4 | Train Loss: 1.202 Vali Loss: 1.406 Vali Acc: 0.460 Test Loss: 1.406 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7477681636810303
Epoch: 7, Steps: 4 | Train Loss: 1.046 Vali Loss: 1.379 Vali Acc: 0.460 Test Loss: 1.379 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.9001379013061523
Epoch: 8, Steps: 4 | Train Loss: 0.786 Vali Loss: 1.298 Vali Acc: 0.480 Test Loss: 1.298 Test Acc: 0.480
Validation loss decreased (-0.479986 --> -0.479987).  Saving model ...
Epoch: 9 cost time: 1.7804207801818848
Epoch: 9, Steps: 4 | Train Loss: 0.669 Vali Loss: 1.199 Vali Acc: 0.560 Test Loss: 1.199 Test Acc: 0.560
Validation loss decreased (-0.479987 --> -0.559988).  Saving model ...
Epoch: 10 cost time: 1.7992358207702637
Epoch: 10, Steps: 4 | Train Loss: 0.615 Vali Loss: 1.161 Vali Acc: 0.560 Test Loss: 1.161 Test Acc: 0.560
Validation loss decreased (-0.559988 --> -0.559988).  Saving model ...
Epoch: 11 cost time: 1.9677917957305908
Epoch: 11, Steps: 4 | Train Loss: 0.469 Vali Loss: 1.134 Vali Acc: 0.520 Test Loss: 1.134 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8715755939483643
Epoch: 12, Steps: 4 | Train Loss: 0.414 Vali Loss: 1.153 Vali Acc: 0.500 Test Loss: 1.153 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.9275472164154053
Epoch: 13, Steps: 4 | Train Loss: 0.295 Vali Loss: 1.110 Vali Acc: 0.520 Test Loss: 1.110 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.1210200786590576
Epoch: 14, Steps: 4 | Train Loss: 0.243 Vali Loss: 1.110 Vali Acc: 0.540 Test Loss: 1.110 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.9533777236938477
Epoch: 15, Steps: 4 | Train Loss: 0.182 Vali Loss: 1.166 Vali Acc: 0.520 Test Loss: 1.166 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.8913960456848145
Epoch: 16, Steps: 4 | Train Loss: 0.140 Vali Loss: 1.159 Vali Acc: 0.580 Test Loss: 1.159 Test Acc: 0.580
Validation loss decreased (-0.559988 --> -0.579988).  Saving model ...
Epoch: 17 cost time: 2.11232590675354
Epoch: 17, Steps: 4 | Train Loss: 0.282 Vali Loss: 1.128 Vali Acc: 0.560 Test Loss: 1.128 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.8624229431152344
Epoch: 18, Steps: 4 | Train Loss: 0.081 Vali Loss: 1.119 Vali Acc: 0.500 Test Loss: 1.119 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.9181599617004395
Epoch: 19, Steps: 4 | Train Loss: 0.078 Vali Loss: 1.146 Vali Acc: 0.480 Test Loss: 1.146 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.9664483070373535
Epoch: 20, Steps: 4 | Train Loss: 0.079 Vali Loss: 1.167 Vali Acc: 0.580 Test Loss: 1.167 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.9938457012176514
Epoch: 21, Steps: 4 | Train Loss: 0.048 Vali Loss: 1.180 Vali Acc: 0.560 Test Loss: 1.180 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.9448761940002441
Epoch: 22, Steps: 4 | Train Loss: 0.038 Vali Loss: 1.131 Vali Acc: 0.520 Test Loss: 1.131 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.8684723377227783
Epoch: 23, Steps: 4 | Train Loss: 0.033 Vali Loss: 1.198 Vali Acc: 0.560 Test Loss: 1.198 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.8762166500091553
Epoch: 24, Steps: 4 | Train Loss: 0.036 Vali Loss: 1.240 Vali Acc: 0.560 Test Loss: 1.240 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.884643793106079
Epoch: 25, Steps: 4 | Train Loss: 0.022 Vali Loss: 1.160 Vali Acc: 0.520 Test Loss: 1.160 Test Acc: 0.520
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.951521873474121
Epoch: 26, Steps: 4 | Train Loss: 0.024 Vali Loss: 1.231 Vali Acc: 0.560 Test Loss: 1.231 Test Acc: 0.560
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm32_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 1344741
model size : 5.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm32_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.6548855304718018
Epoch: 1, Steps: 4 | Train Loss: 1.701 Vali Loss: 1.627 Vali Acc: 0.180 Test Loss: 1.627 Test Acc: 0.180
Validation loss decreased (inf --> -0.179984).  Saving model ...
Epoch: 2 cost time: 1.3773322105407715
Epoch: 2, Steps: 4 | Train Loss: 1.708 Vali Loss: 1.620 Vali Acc: 0.220 Test Loss: 1.620 Test Acc: 0.220
Validation loss decreased (-0.179984 --> -0.219984).  Saving model ...
Epoch: 3 cost time: 1.298886775970459
Epoch: 3, Steps: 4 | Train Loss: 1.549 Vali Loss: 1.603 Vali Acc: 0.260 Test Loss: 1.603 Test Acc: 0.260
Validation loss decreased (-0.219984 --> -0.259984).  Saving model ...
Epoch: 4 cost time: 1.3409366607666016
Epoch: 4, Steps: 4 | Train Loss: 1.406 Vali Loss: 1.594 Vali Acc: 0.240 Test Loss: 1.594 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3074946403503418
Epoch: 5, Steps: 4 | Train Loss: 1.216 Vali Loss: 1.555 Vali Acc: 0.320 Test Loss: 1.555 Test Acc: 0.320
Validation loss decreased (-0.259984 --> -0.319984).  Saving model ...
Epoch: 6 cost time: 1.4252545833587646
Epoch: 6, Steps: 4 | Train Loss: 1.062 Vali Loss: 1.512 Vali Acc: 0.360 Test Loss: 1.512 Test Acc: 0.360
Validation loss decreased (-0.319984 --> -0.359985).  Saving model ...
Epoch: 7 cost time: 1.323591947555542
Epoch: 7, Steps: 4 | Train Loss: 0.961 Vali Loss: 1.444 Vali Acc: 0.360 Test Loss: 1.444 Test Acc: 0.360
Validation loss decreased (-0.359985 --> -0.359986).  Saving model ...
Epoch: 8 cost time: 1.2606544494628906
Epoch: 8, Steps: 4 | Train Loss: 0.966 Vali Loss: 1.373 Vali Acc: 0.380 Test Loss: 1.373 Test Acc: 0.380
Validation loss decreased (-0.359986 --> -0.379986).  Saving model ...
Epoch: 9 cost time: 1.3275728225708008
Epoch: 9, Steps: 4 | Train Loss: 0.628 Vali Loss: 1.299 Vali Acc: 0.420 Test Loss: 1.299 Test Acc: 0.420
Validation loss decreased (-0.379986 --> -0.419987).  Saving model ...
Epoch: 10 cost time: 1.3579621315002441
Epoch: 10, Steps: 4 | Train Loss: 0.646 Vali Loss: 1.249 Vali Acc: 0.440 Test Loss: 1.249 Test Acc: 0.440
Validation loss decreased (-0.419987 --> -0.439988).  Saving model ...
Epoch: 11 cost time: 1.3166437149047852
Epoch: 11, Steps: 4 | Train Loss: 0.506 Vali Loss: 1.266 Vali Acc: 0.420 Test Loss: 1.266 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.296565294265747
Epoch: 12, Steps: 4 | Train Loss: 0.410 Vali Loss: 1.294 Vali Acc: 0.400 Test Loss: 1.294 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.4134838581085205
Epoch: 13, Steps: 4 | Train Loss: 0.310 Vali Loss: 1.243 Vali Acc: 0.480 Test Loss: 1.243 Test Acc: 0.480
Validation loss decreased (-0.439988 --> -0.479988).  Saving model ...
Epoch: 14 cost time: 1.3582687377929688
Epoch: 14, Steps: 4 | Train Loss: 0.261 Vali Loss: 1.213 Vali Acc: 0.540 Test Loss: 1.213 Test Acc: 0.540
Validation loss decreased (-0.479988 --> -0.539988).  Saving model ...
Epoch: 15 cost time: 1.301058053970337
Epoch: 15, Steps: 4 | Train Loss: 0.244 Vali Loss: 1.132 Vali Acc: 0.540 Test Loss: 1.132 Test Acc: 0.540
Validation loss decreased (-0.539988 --> -0.539989).  Saving model ...
Epoch: 16 cost time: 1.4031016826629639
Epoch: 16, Steps: 4 | Train Loss: 0.191 Vali Loss: 1.169 Vali Acc: 0.520 Test Loss: 1.169 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.332707166671753
Epoch: 17, Steps: 4 | Train Loss: 0.127 Vali Loss: 1.272 Vali Acc: 0.540 Test Loss: 1.272 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.2717807292938232
Epoch: 18, Steps: 4 | Train Loss: 0.102 Vali Loss: 1.220 Vali Acc: 0.560 Test Loss: 1.220 Test Acc: 0.560
Validation loss decreased (-0.539989 --> -0.559988).  Saving model ...
Epoch: 19 cost time: 1.3859796524047852
Epoch: 19, Steps: 4 | Train Loss: 0.100 Vali Loss: 1.142 Vali Acc: 0.500 Test Loss: 1.142 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.3244364261627197
Epoch: 20, Steps: 4 | Train Loss: 0.064 Vali Loss: 1.198 Vali Acc: 0.500 Test Loss: 1.198 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.3825135231018066
Epoch: 21, Steps: 4 | Train Loss: 0.054 Vali Loss: 1.200 Vali Acc: 0.540 Test Loss: 1.200 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.360795259475708
Epoch: 22, Steps: 4 | Train Loss: 0.070 Vali Loss: 1.131 Vali Acc: 0.580 Test Loss: 1.131 Test Acc: 0.580
Validation loss decreased (-0.559988 --> -0.579989).  Saving model ...
Epoch: 23 cost time: 1.3870384693145752
Epoch: 23, Steps: 4 | Train Loss: 0.056 Vali Loss: 1.154 Vali Acc: 0.520 Test Loss: 1.154 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.2792439460754395
Epoch: 24, Steps: 4 | Train Loss: 0.035 Vali Loss: 1.268 Vali Acc: 0.520 Test Loss: 1.268 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.324918508529663
Epoch: 25, Steps: 4 | Train Loss: 0.037 Vali Loss: 1.321 Vali Acc: 0.500 Test Loss: 1.321 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.434321641921997
Epoch: 26, Steps: 4 | Train Loss: 0.039 Vali Loss: 1.265 Vali Acc: 0.560 Test Loss: 1.265 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.3898823261260986
Epoch: 27, Steps: 4 | Train Loss: 0.030 Vali Loss: 1.287 Vali Acc: 0.540 Test Loss: 1.287 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.433028221130371
Epoch: 28, Steps: 4 | Train Loss: 0.029 Vali Loss: 1.255 Vali Acc: 0.540 Test Loss: 1.255 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.3997437953948975
Epoch: 29, Steps: 4 | Train Loss: 0.020 Vali Loss: 1.311 Vali Acc: 0.520 Test Loss: 1.311 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.4061763286590576
Epoch: 30, Steps: 4 | Train Loss: 0.012 Vali Loss: 1.394 Vali Acc: 0.520 Test Loss: 1.394 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm32_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 517093
model size : 2.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm32_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.6202354431152344
Epoch: 1, Steps: 4 | Train Loss: 1.596 Vali Loss: 1.584 Vali Acc: 0.260 Test Loss: 1.584 Test Acc: 0.260
Validation loss decreased (inf --> -0.259984).  Saving model ...
Epoch: 2 cost time: 1.5076851844787598
Epoch: 2, Steps: 4 | Train Loss: 1.567 Vali Loss: 1.565 Vali Acc: 0.320 Test Loss: 1.565 Test Acc: 0.320
Validation loss decreased (-0.259984 --> -0.319984).  Saving model ...
Epoch: 3 cost time: 1.5782544612884521
Epoch: 3, Steps: 4 | Train Loss: 1.572 Vali Loss: 1.527 Vali Acc: 0.320 Test Loss: 1.527 Test Acc: 0.320
Validation loss decreased (-0.319984 --> -0.319985).  Saving model ...
Epoch: 4 cost time: 1.6680121421813965
Epoch: 4, Steps: 4 | Train Loss: 1.356 Vali Loss: 1.494 Vali Acc: 0.420 Test Loss: 1.494 Test Acc: 0.420
Validation loss decreased (-0.319985 --> -0.419985).  Saving model ...
Epoch: 5 cost time: 1.6811332702636719
Epoch: 5, Steps: 4 | Train Loss: 1.214 Vali Loss: 1.445 Vali Acc: 0.480 Test Loss: 1.445 Test Acc: 0.480
Validation loss decreased (-0.419985 --> -0.479986).  Saving model ...
Epoch: 6 cost time: 1.7166717052459717
Epoch: 6, Steps: 4 | Train Loss: 1.203 Vali Loss: 1.406 Vali Acc: 0.480 Test Loss: 1.406 Test Acc: 0.480
Validation loss decreased (-0.479986 --> -0.479986).  Saving model ...
Epoch: 7 cost time: 1.5943701267242432
Epoch: 7, Steps: 4 | Train Loss: 1.043 Vali Loss: 1.379 Vali Acc: 0.440 Test Loss: 1.379 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5974562168121338
Epoch: 8, Steps: 4 | Train Loss: 0.775 Vali Loss: 1.299 Vali Acc: 0.460 Test Loss: 1.299 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.6197292804718018
Epoch: 9, Steps: 4 | Train Loss: 0.659 Vali Loss: 1.199 Vali Acc: 0.560 Test Loss: 1.199 Test Acc: 0.560
Validation loss decreased (-0.479986 --> -0.559988).  Saving model ...
Epoch: 10 cost time: 1.5853981971740723
Epoch: 10, Steps: 4 | Train Loss: 0.614 Vali Loss: 1.162 Vali Acc: 0.540 Test Loss: 1.162 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.624225378036499
Epoch: 11, Steps: 4 | Train Loss: 0.468 Vali Loss: 1.133 Vali Acc: 0.520 Test Loss: 1.133 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.6503746509552002
Epoch: 12, Steps: 4 | Train Loss: 0.410 Vali Loss: 1.151 Vali Acc: 0.520 Test Loss: 1.151 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.6549344062805176
Epoch: 13, Steps: 4 | Train Loss: 0.302 Vali Loss: 1.106 Vali Acc: 0.520 Test Loss: 1.106 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.6659104824066162
Epoch: 14, Steps: 4 | Train Loss: 0.240 Vali Loss: 1.113 Vali Acc: 0.540 Test Loss: 1.113 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.6497385501861572
Epoch: 15, Steps: 4 | Train Loss: 0.178 Vali Loss: 1.173 Vali Acc: 0.520 Test Loss: 1.173 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.6903901100158691
Epoch: 16, Steps: 4 | Train Loss: 0.140 Vali Loss: 1.150 Vali Acc: 0.560 Test Loss: 1.150 Test Acc: 0.560
Validation loss decreased (-0.559988 --> -0.559989).  Saving model ...
Epoch: 17 cost time: 1.6698930263519287
Epoch: 17, Steps: 4 | Train Loss: 0.277 Vali Loss: 1.115 Vali Acc: 0.520 Test Loss: 1.115 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.4555306434631348
Epoch: 18, Steps: 4 | Train Loss: 0.080 Vali Loss: 1.104 Vali Acc: 0.520 Test Loss: 1.104 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.6257984638214111
Epoch: 19, Steps: 4 | Train Loss: 0.078 Vali Loss: 1.120 Vali Acc: 0.500 Test Loss: 1.120 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.506521224975586
Epoch: 20, Steps: 4 | Train Loss: 0.078 Vali Loss: 1.130 Vali Acc: 0.600 Test Loss: 1.130 Test Acc: 0.600
Validation loss decreased (-0.559989 --> -0.599989).  Saving model ...
Epoch: 21 cost time: 1.6987082958221436
Epoch: 21, Steps: 4 | Train Loss: 0.048 Vali Loss: 1.142 Vali Acc: 0.580 Test Loss: 1.142 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.600914478302002
Epoch: 22, Steps: 4 | Train Loss: 0.038 Vali Loss: 1.097 Vali Acc: 0.560 Test Loss: 1.097 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.6882619857788086
Epoch: 23, Steps: 4 | Train Loss: 0.034 Vali Loss: 1.164 Vali Acc: 0.600 Test Loss: 1.164 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.557805061340332
Epoch: 24, Steps: 4 | Train Loss: 0.040 Vali Loss: 1.211 Vali Acc: 0.600 Test Loss: 1.211 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.6816930770874023
Epoch: 25, Steps: 4 | Train Loss: 0.023 Vali Loss: 1.112 Vali Acc: 0.600 Test Loss: 1.112 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 26 cost time: 1.6836254596710205
Epoch: 26, Steps: 4 | Train Loss: 0.026 Vali Loss: 1.190 Vali Acc: 0.580 Test Loss: 1.190 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.4657773971557617
Epoch: 27, Steps: 4 | Train Loss: 0.016 Vali Loss: 1.328 Vali Acc: 0.580 Test Loss: 1.328 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.6988632678985596
Epoch: 28, Steps: 4 | Train Loss: 0.025 Vali Loss: 1.210 Vali Acc: 0.580 Test Loss: 1.210 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.6045162677764893
Epoch: 29, Steps: 4 | Train Loss: 0.014 Vali Loss: 1.197 Vali Acc: 0.560 Test Loss: 1.197 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.7256581783294678
Epoch: 30, Steps: 4 | Train Loss: 0.012 Vali Loss: 1.185 Vali Acc: 0.540 Test Loss: 1.185 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm32_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 1344741
model size : 5.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm32_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.1816272735595703
Epoch: 1, Steps: 4 | Train Loss: 1.704 Vali Loss: 1.637 Vali Acc: 0.180 Test Loss: 1.637 Test Acc: 0.180
Validation loss decreased (inf --> -0.179984).  Saving model ...
Epoch: 2 cost time: 1.2985196113586426
Epoch: 2, Steps: 4 | Train Loss: 1.707 Vali Loss: 1.630 Vali Acc: 0.220 Test Loss: 1.630 Test Acc: 0.220
Validation loss decreased (-0.179984 --> -0.219984).  Saving model ...
Epoch: 3 cost time: 1.204683542251587
Epoch: 3, Steps: 4 | Train Loss: 1.551 Vali Loss: 1.612 Vali Acc: 0.300 Test Loss: 1.612 Test Acc: 0.300
Validation loss decreased (-0.219984 --> -0.299984).  Saving model ...
Epoch: 4 cost time: 1.1984145641326904
Epoch: 4, Steps: 4 | Train Loss: 1.395 Vali Loss: 1.603 Vali Acc: 0.260 Test Loss: 1.603 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1012089252471924
Epoch: 5, Steps: 4 | Train Loss: 1.218 Vali Loss: 1.563 Vali Acc: 0.320 Test Loss: 1.563 Test Acc: 0.320
Validation loss decreased (-0.299984 --> -0.319984).  Saving model ...
Epoch: 6 cost time: 1.2014195919036865
Epoch: 6, Steps: 4 | Train Loss: 1.080 Vali Loss: 1.518 Vali Acc: 0.360 Test Loss: 1.518 Test Acc: 0.360
Validation loss decreased (-0.319984 --> -0.359985).  Saving model ...
Epoch: 7 cost time: 1.1104931831359863
Epoch: 7, Steps: 4 | Train Loss: 0.965 Vali Loss: 1.453 Vali Acc: 0.380 Test Loss: 1.453 Test Acc: 0.380
Validation loss decreased (-0.359985 --> -0.379985).  Saving model ...
Epoch: 8 cost time: 1.3583407402038574
Epoch: 8, Steps: 4 | Train Loss: 0.970 Vali Loss: 1.378 Vali Acc: 0.360 Test Loss: 1.378 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3021554946899414
Epoch: 9, Steps: 4 | Train Loss: 0.638 Vali Loss: 1.299 Vali Acc: 0.440 Test Loss: 1.299 Test Acc: 0.440
Validation loss decreased (-0.379985 --> -0.439987).  Saving model ...
Epoch: 10 cost time: 1.1953246593475342
Epoch: 10, Steps: 4 | Train Loss: 0.648 Vali Loss: 1.246 Vali Acc: 0.440 Test Loss: 1.246 Test Acc: 0.440
Validation loss decreased (-0.439987 --> -0.439988).  Saving model ...
Epoch: 11 cost time: 1.2649719715118408
Epoch: 11, Steps: 4 | Train Loss: 0.507 Vali Loss: 1.259 Vali Acc: 0.420 Test Loss: 1.259 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.195091724395752
Epoch: 12, Steps: 4 | Train Loss: 0.408 Vali Loss: 1.286 Vali Acc: 0.380 Test Loss: 1.286 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1464142799377441
Epoch: 13, Steps: 4 | Train Loss: 0.311 Vali Loss: 1.234 Vali Acc: 0.500 Test Loss: 1.234 Test Acc: 0.500
Validation loss decreased (-0.439988 --> -0.499988).  Saving model ...
Epoch: 14 cost time: 1.1981234550476074
Epoch: 14, Steps: 4 | Train Loss: 0.260 Vali Loss: 1.206 Vali Acc: 0.540 Test Loss: 1.206 Test Acc: 0.540
Validation loss decreased (-0.499988 --> -0.539988).  Saving model ...
Epoch: 15 cost time: 1.2475411891937256
Epoch: 15, Steps: 4 | Train Loss: 0.243 Vali Loss: 1.128 Vali Acc: 0.540 Test Loss: 1.128 Test Acc: 0.540
Validation loss decreased (-0.539988 --> -0.539989).  Saving model ...
Epoch: 16 cost time: 1.1072776317596436
Epoch: 16, Steps: 4 | Train Loss: 0.192 Vali Loss: 1.159 Vali Acc: 0.500 Test Loss: 1.159 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1706368923187256
Epoch: 17, Steps: 4 | Train Loss: 0.128 Vali Loss: 1.271 Vali Acc: 0.540 Test Loss: 1.271 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.2569372653961182
Epoch: 18, Steps: 4 | Train Loss: 0.108 Vali Loss: 1.226 Vali Acc: 0.560 Test Loss: 1.226 Test Acc: 0.560
Validation loss decreased (-0.539989 --> -0.559988).  Saving model ...
Epoch: 19 cost time: 1.1276662349700928
Epoch: 19, Steps: 4 | Train Loss: 0.101 Vali Loss: 1.122 Vali Acc: 0.500 Test Loss: 1.122 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.2156121730804443
Epoch: 20, Steps: 4 | Train Loss: 0.062 Vali Loss: 1.178 Vali Acc: 0.520 Test Loss: 1.178 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.288623332977295
Epoch: 21, Steps: 4 | Train Loss: 0.053 Vali Loss: 1.169 Vali Acc: 0.540 Test Loss: 1.169 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.1935677528381348
Epoch: 22, Steps: 4 | Train Loss: 0.076 Vali Loss: 1.104 Vali Acc: 0.560 Test Loss: 1.104 Test Acc: 0.560
Validation loss decreased (-0.559988 --> -0.559989).  Saving model ...
Epoch: 23 cost time: 1.2592146396636963
Epoch: 23, Steps: 4 | Train Loss: 0.063 Vali Loss: 1.110 Vali Acc: 0.560 Test Loss: 1.110 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.2547686100006104
Epoch: 24, Steps: 4 | Train Loss: 0.029 Vali Loss: 1.226 Vali Acc: 0.520 Test Loss: 1.226 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.2995893955230713
Epoch: 25, Steps: 4 | Train Loss: 0.038 Vali Loss: 1.267 Vali Acc: 0.500 Test Loss: 1.267 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.1797690391540527
Epoch: 26, Steps: 4 | Train Loss: 0.036 Vali Loss: 1.211 Vali Acc: 0.560 Test Loss: 1.211 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.1379647254943848
Epoch: 27, Steps: 4 | Train Loss: 0.028 Vali Loss: 1.236 Vali Acc: 0.520 Test Loss: 1.236 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.1767873764038086
Epoch: 28, Steps: 4 | Train Loss: 0.025 Vali Loss: 1.215 Vali Acc: 0.540 Test Loss: 1.215 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.0783319473266602
Epoch: 29, Steps: 4 | Train Loss: 0.019 Vali Loss: 1.273 Vali Acc: 0.540 Test Loss: 1.273 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.193098783493042
Epoch: 30, Steps: 4 | Train Loss: 0.012 Vali Loss: 1.384 Vali Acc: 0.540 Test Loss: 1.384 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm32_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 517093
model size : 2.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm32_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.2838025093078613
Epoch: 1, Steps: 4 | Train Loss: 1.596 Vali Loss: 1.581 Vali Acc: 0.260 Test Loss: 1.581 Test Acc: 0.260
Validation loss decreased (inf --> -0.259984).  Saving model ...
Epoch: 2 cost time: 1.2638559341430664
Epoch: 2, Steps: 4 | Train Loss: 1.566 Vali Loss: 1.563 Vali Acc: 0.300 Test Loss: 1.563 Test Acc: 0.300
Validation loss decreased (-0.259984 --> -0.299984).  Saving model ...
Epoch: 3 cost time: 1.1838412284851074
Epoch: 3, Steps: 4 | Train Loss: 1.572 Vali Loss: 1.525 Vali Acc: 0.320 Test Loss: 1.525 Test Acc: 0.320
Validation loss decreased (-0.299984 --> -0.319985).  Saving model ...
Epoch: 4 cost time: 1.2933464050292969
Epoch: 4, Steps: 4 | Train Loss: 1.356 Vali Loss: 1.492 Vali Acc: 0.440 Test Loss: 1.492 Test Acc: 0.440
Validation loss decreased (-0.319985 --> -0.439985).  Saving model ...
Epoch: 5 cost time: 1.2437713146209717
Epoch: 5, Steps: 4 | Train Loss: 1.216 Vali Loss: 1.443 Vali Acc: 0.520 Test Loss: 1.443 Test Acc: 0.520
Validation loss decreased (-0.439985 --> -0.519986).  Saving model ...
Epoch: 6 cost time: 1.2296619415283203
Epoch: 6, Steps: 4 | Train Loss: 1.207 Vali Loss: 1.405 Vali Acc: 0.500 Test Loss: 1.405 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.334357738494873
Epoch: 7, Steps: 4 | Train Loss: 1.047 Vali Loss: 1.377 Vali Acc: 0.440 Test Loss: 1.377 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.3317065238952637
Epoch: 8, Steps: 4 | Train Loss: 0.810 Vali Loss: 1.300 Vali Acc: 0.480 Test Loss: 1.300 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.3113980293273926
Epoch: 9, Steps: 4 | Train Loss: 0.692 Vali Loss: 1.201 Vali Acc: 0.560 Test Loss: 1.201 Test Acc: 0.560
Validation loss decreased (-0.519986 --> -0.559988).  Saving model ...
Epoch: 10 cost time: 1.2052397727966309
Epoch: 10, Steps: 4 | Train Loss: 0.623 Vali Loss: 1.163 Vali Acc: 0.560 Test Loss: 1.163 Test Acc: 0.560
Validation loss decreased (-0.559988 --> -0.559988).  Saving model ...
Epoch: 11 cost time: 1.3478901386260986
Epoch: 11, Steps: 4 | Train Loss: 0.480 Vali Loss: 1.135 Vali Acc: 0.500 Test Loss: 1.135 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.23112154006958
Epoch: 12, Steps: 4 | Train Loss: 0.426 Vali Loss: 1.149 Vali Acc: 0.520 Test Loss: 1.149 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.325117826461792
Epoch: 13, Steps: 4 | Train Loss: 0.314 Vali Loss: 1.096 Vali Acc: 0.520 Test Loss: 1.096 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.2725701332092285
Epoch: 14, Steps: 4 | Train Loss: 0.252 Vali Loss: 1.107 Vali Acc: 0.500 Test Loss: 1.107 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.2956085205078125
Epoch: 15, Steps: 4 | Train Loss: 0.187 Vali Loss: 1.162 Vali Acc: 0.480 Test Loss: 1.162 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.2264163494110107
Epoch: 16, Steps: 4 | Train Loss: 0.151 Vali Loss: 1.141 Vali Acc: 0.500 Test Loss: 1.141 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.2572307586669922
Epoch: 17, Steps: 4 | Train Loss: 0.323 Vali Loss: 1.123 Vali Acc: 0.500 Test Loss: 1.123 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.2502415180206299
Epoch: 18, Steps: 4 | Train Loss: 0.088 Vali Loss: 1.121 Vali Acc: 0.480 Test Loss: 1.121 Test Acc: 0.480
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.2746942043304443
Epoch: 19, Steps: 4 | Train Loss: 0.084 Vali Loss: 1.140 Vali Acc: 0.480 Test Loss: 1.140 Test Acc: 0.480
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.251173734664917
Epoch: 20, Steps: 4 | Train Loss: 0.087 Vali Loss: 1.143 Vali Acc: 0.520 Test Loss: 1.143 Test Acc: 0.520
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm32_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 1344741
model size : 5.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm32_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.9910547733306885
Epoch: 1, Steps: 4 | Train Loss: 1.704 Vali Loss: 1.642 Vali Acc: 0.180 Test Loss: 1.642 Test Acc: 0.180
Validation loss decreased (inf --> -0.179984).  Saving model ...
Epoch: 2 cost time: 1.1475284099578857
Epoch: 2, Steps: 4 | Train Loss: 1.706 Vali Loss: 1.635 Vali Acc: 0.240 Test Loss: 1.635 Test Acc: 0.240
Validation loss decreased (-0.179984 --> -0.239984).  Saving model ...
Epoch: 3 cost time: 1.1901729106903076
Epoch: 3, Steps: 4 | Train Loss: 1.553 Vali Loss: 1.617 Vali Acc: 0.300 Test Loss: 1.617 Test Acc: 0.300
Validation loss decreased (-0.239984 --> -0.299984).  Saving model ...
Epoch: 4 cost time: 1.1219711303710938
Epoch: 4, Steps: 4 | Train Loss: 1.384 Vali Loss: 1.608 Vali Acc: 0.260 Test Loss: 1.608 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.19724702835083
Epoch: 5, Steps: 4 | Train Loss: 1.221 Vali Loss: 1.569 Vali Acc: 0.320 Test Loss: 1.569 Test Acc: 0.320
Validation loss decreased (-0.299984 --> -0.319984).  Saving model ...
Epoch: 6 cost time: 1.1654088497161865
Epoch: 6, Steps: 4 | Train Loss: 1.079 Vali Loss: 1.526 Vali Acc: 0.360 Test Loss: 1.526 Test Acc: 0.360
Validation loss decreased (-0.319984 --> -0.359985).  Saving model ...
Epoch: 7 cost time: 1.1993203163146973
Epoch: 7, Steps: 4 | Train Loss: 0.968 Vali Loss: 1.457 Vali Acc: 0.380 Test Loss: 1.457 Test Acc: 0.380
Validation loss decreased (-0.359985 --> -0.379985).  Saving model ...
Epoch: 8 cost time: 1.235121488571167
Epoch: 8, Steps: 4 | Train Loss: 0.974 Vali Loss: 1.371 Vali Acc: 0.360 Test Loss: 1.371 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1768674850463867
Epoch: 9, Steps: 4 | Train Loss: 0.645 Vali Loss: 1.282 Vali Acc: 0.460 Test Loss: 1.282 Test Acc: 0.460
Validation loss decreased (-0.379985 --> -0.459987).  Saving model ...
Epoch: 10 cost time: 1.150514841079712
Epoch: 10, Steps: 4 | Train Loss: 0.650 Vali Loss: 1.221 Vali Acc: 0.440 Test Loss: 1.221 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1778819561004639
Epoch: 11, Steps: 4 | Train Loss: 0.508 Vali Loss: 1.231 Vali Acc: 0.420 Test Loss: 1.231 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1642053127288818
Epoch: 12, Steps: 4 | Train Loss: 0.442 Vali Loss: 1.254 Vali Acc: 0.440 Test Loss: 1.254 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.1721978187561035
Epoch: 13, Steps: 4 | Train Loss: 0.315 Vali Loss: 1.195 Vali Acc: 0.520 Test Loss: 1.195 Test Acc: 0.520
Validation loss decreased (-0.459987 --> -0.519988).  Saving model ...
Epoch: 14 cost time: 1.0147104263305664
Epoch: 14, Steps: 4 | Train Loss: 0.261 Vali Loss: 1.160 Vali Acc: 0.560 Test Loss: 1.160 Test Acc: 0.560
Validation loss decreased (-0.519988 --> -0.559988).  Saving model ...
Epoch: 15 cost time: 1.0801210403442383
Epoch: 15, Steps: 4 | Train Loss: 0.242 Vali Loss: 1.091 Vali Acc: 0.540 Test Loss: 1.091 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2016315460205078
Epoch: 16, Steps: 4 | Train Loss: 0.193 Vali Loss: 1.129 Vali Acc: 0.500 Test Loss: 1.129 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.1689269542694092
Epoch: 17, Steps: 4 | Train Loss: 0.140 Vali Loss: 1.206 Vali Acc: 0.540 Test Loss: 1.206 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.1697907447814941
Epoch: 18, Steps: 4 | Train Loss: 0.110 Vali Loss: 1.157 Vali Acc: 0.540 Test Loss: 1.157 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.1493244171142578
Epoch: 19, Steps: 4 | Train Loss: 0.104 Vali Loss: 1.158 Vali Acc: 0.520 Test Loss: 1.158 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.157475471496582
Epoch: 20, Steps: 4 | Train Loss: 0.065 Vali Loss: 1.157 Vali Acc: 0.540 Test Loss: 1.157 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.26344633102417
Epoch: 21, Steps: 4 | Train Loss: 0.062 Vali Loss: 1.146 Vali Acc: 0.520 Test Loss: 1.146 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.431687355041504
Epoch: 22, Steps: 4 | Train Loss: 0.077 Vali Loss: 1.088 Vali Acc: 0.600 Test Loss: 1.088 Test Acc: 0.600
Validation loss decreased (-0.559988 --> -0.599989).  Saving model ...
Epoch: 23 cost time: 1.15602707862854
Epoch: 23, Steps: 4 | Train Loss: 0.051 Vali Loss: 1.142 Vali Acc: 0.560 Test Loss: 1.142 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.2232353687286377
Epoch: 24, Steps: 4 | Train Loss: 0.049 Vali Loss: 1.249 Vali Acc: 0.560 Test Loss: 1.249 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.2003381252288818
Epoch: 25, Steps: 4 | Train Loss: 0.040 Vali Loss: 1.293 Vali Acc: 0.480 Test Loss: 1.293 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.190784215927124
Epoch: 26, Steps: 4 | Train Loss: 0.040 Vali Loss: 1.147 Vali Acc: 0.520 Test Loss: 1.147 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.1748466491699219
Epoch: 27, Steps: 4 | Train Loss: 0.029 Vali Loss: 1.223 Vali Acc: 0.560 Test Loss: 1.223 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.1760318279266357
Epoch: 28, Steps: 4 | Train Loss: 0.024 Vali Loss: 1.248 Vali Acc: 0.580 Test Loss: 1.248 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.1639444828033447
Epoch: 29, Steps: 4 | Train Loss: 0.017 Vali Loss: 1.269 Vali Acc: 0.560 Test Loss: 1.269 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.253187656402588
Epoch: 30, Steps: 4 | Train Loss: 0.012 Vali Loss: 1.275 Vali Acc: 0.540 Test Loss: 1.275 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm32_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 517093
model size : 2.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm16_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.4477949142456055
Epoch: 1, Steps: 4 | Train Loss: 1.700 Vali Loss: 1.605 Vali Acc: 0.220 Test Loss: 1.605 Test Acc: 0.220
Validation loss decreased (inf --> -0.219984).  Saving model ...
Epoch: 2 cost time: 2.4051778316497803
Epoch: 2, Steps: 4 | Train Loss: 1.627 Vali Loss: 1.588 Vali Acc: 0.240 Test Loss: 1.588 Test Acc: 0.240
Validation loss decreased (-0.219984 --> -0.239984).  Saving model ...
Epoch: 3 cost time: 2.3673126697540283
Epoch: 3, Steps: 4 | Train Loss: 1.568 Vali Loss: 1.571 Vali Acc: 0.340 Test Loss: 1.571 Test Acc: 0.340
Validation loss decreased (-0.239984 --> -0.339984).  Saving model ...
Epoch: 4 cost time: 2.376863479614258
Epoch: 4, Steps: 4 | Train Loss: 1.534 Vali Loss: 1.563 Vali Acc: 0.320 Test Loss: 1.563 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.2991037368774414
Epoch: 5, Steps: 4 | Train Loss: 1.532 Vali Loss: 1.553 Vali Acc: 0.320 Test Loss: 1.553 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.2983577251434326
Epoch: 6, Steps: 4 | Train Loss: 1.295 Vali Loss: 1.523 Vali Acc: 0.400 Test Loss: 1.523 Test Acc: 0.400
Validation loss decreased (-0.339984 --> -0.399985).  Saving model ...
Epoch: 7 cost time: 2.415614604949951
Epoch: 7, Steps: 4 | Train Loss: 1.296 Vali Loss: 1.489 Vali Acc: 0.500 Test Loss: 1.489 Test Acc: 0.500
Validation loss decreased (-0.399985 --> -0.499985).  Saving model ...
Epoch: 8 cost time: 2.400078058242798
Epoch: 8, Steps: 4 | Train Loss: 1.266 Vali Loss: 1.456 Vali Acc: 0.500 Test Loss: 1.456 Test Acc: 0.500
Validation loss decreased (-0.499985 --> -0.499985).  Saving model ...
Epoch: 9 cost time: 2.24151611328125
Epoch: 9, Steps: 4 | Train Loss: 1.015 Vali Loss: 1.419 Vali Acc: 0.480 Test Loss: 1.419 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.3437411785125732
Epoch: 10, Steps: 4 | Train Loss: 0.900 Vali Loss: 1.382 Vali Acc: 0.440 Test Loss: 1.382 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.3622138500213623
Epoch: 11, Steps: 4 | Train Loss: 0.753 Vali Loss: 1.324 Vali Acc: 0.500 Test Loss: 1.324 Test Acc: 0.500
Validation loss decreased (-0.499985 --> -0.499987).  Saving model ...
Epoch: 12 cost time: 2.290025472640991
Epoch: 12, Steps: 4 | Train Loss: 0.751 Vali Loss: 1.266 Vali Acc: 0.500 Test Loss: 1.266 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499987).  Saving model ...
Epoch: 13 cost time: 2.434705972671509
Epoch: 13, Steps: 4 | Train Loss: 0.632 Vali Loss: 1.200 Vali Acc: 0.520 Test Loss: 1.200 Test Acc: 0.520
Validation loss decreased (-0.499987 --> -0.519988).  Saving model ...
Epoch: 14 cost time: 2.350895881652832
Epoch: 14, Steps: 4 | Train Loss: 0.493 Vali Loss: 1.148 Vali Acc: 0.500 Test Loss: 1.148 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.2302465438842773
Epoch: 15, Steps: 4 | Train Loss: 0.396 Vali Loss: 1.147 Vali Acc: 0.500 Test Loss: 1.147 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.32551908493042
Epoch: 16, Steps: 4 | Train Loss: 0.377 Vali Loss: 1.174 Vali Acc: 0.540 Test Loss: 1.174 Test Acc: 0.540
Validation loss decreased (-0.519988 --> -0.539988).  Saving model ...
Epoch: 17 cost time: 2.412395715713501
Epoch: 17, Steps: 4 | Train Loss: 0.277 Vali Loss: 1.154 Vali Acc: 0.540 Test Loss: 1.154 Test Acc: 0.540
Validation loss decreased (-0.539988 --> -0.539988).  Saving model ...
Epoch: 18 cost time: 2.6104395389556885
Epoch: 18, Steps: 4 | Train Loss: 0.660 Vali Loss: 1.124 Vali Acc: 0.520 Test Loss: 1.124 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.3280675411224365
Epoch: 19, Steps: 4 | Train Loss: 0.239 Vali Loss: 1.166 Vali Acc: 0.520 Test Loss: 1.166 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.453744411468506
Epoch: 20, Steps: 4 | Train Loss: 0.173 Vali Loss: 1.267 Vali Acc: 0.560 Test Loss: 1.267 Test Acc: 0.560
Validation loss decreased (-0.539988 --> -0.559987).  Saving model ...
Epoch: 21 cost time: 2.1609761714935303
Epoch: 21, Steps: 4 | Train Loss: 0.182 Vali Loss: 1.162 Vali Acc: 0.520 Test Loss: 1.162 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.231422185897827
Epoch: 22, Steps: 4 | Train Loss: 0.192 Vali Loss: 1.104 Vali Acc: 0.520 Test Loss: 1.104 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.3283324241638184
Epoch: 23, Steps: 4 | Train Loss: 0.118 Vali Loss: 1.088 Vali Acc: 0.520 Test Loss: 1.088 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.268618106842041
Epoch: 24, Steps: 4 | Train Loss: 0.086 Vali Loss: 1.068 Vali Acc: 0.540 Test Loss: 1.068 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.272496461868286
Epoch: 25, Steps: 4 | Train Loss: 0.080 Vali Loss: 1.084 Vali Acc: 0.560 Test Loss: 1.084 Test Acc: 0.560
Validation loss decreased (-0.559987 --> -0.559989).  Saving model ...
Epoch: 26 cost time: 2.2497565746307373
Epoch: 26, Steps: 4 | Train Loss: 0.085 Vali Loss: 1.157 Vali Acc: 0.540 Test Loss: 1.157 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.3510501384735107
Epoch: 27, Steps: 4 | Train Loss: 0.058 Vali Loss: 1.122 Vali Acc: 0.540 Test Loss: 1.122 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.2176742553710938
Epoch: 28, Steps: 4 | Train Loss: 0.058 Vali Loss: 1.172 Vali Acc: 0.580 Test Loss: 1.172 Test Acc: 0.580
Validation loss decreased (-0.559989 --> -0.579988).  Saving model ...
Epoch: 29 cost time: 2.284052848815918
Epoch: 29, Steps: 4 | Train Loss: 0.055 Vali Loss: 1.142 Vali Acc: 0.580 Test Loss: 1.142 Test Acc: 0.580
Validation loss decreased (-0.579988 --> -0.579989).  Saving model ...
Epoch: 30 cost time: 2.3260436058044434
Epoch: 30, Steps: 4 | Train Loss: 0.046 Vali Loss: 1.066 Vali Acc: 0.560 Test Loss: 1.066 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm16_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 1258677
model size : 5.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm16_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.6180875301361084
Epoch: 1, Steps: 4 | Train Loss: 1.605 Vali Loss: 1.649 Vali Acc: 0.180 Test Loss: 1.649 Test Acc: 0.180
Validation loss decreased (inf --> -0.179984).  Saving model ...
Epoch: 2 cost time: 1.6942293643951416
Epoch: 2, Steps: 4 | Train Loss: 1.550 Vali Loss: 1.622 Vali Acc: 0.200 Test Loss: 1.622 Test Acc: 0.200
Validation loss decreased (-0.179984 --> -0.199984).  Saving model ...
Epoch: 3 cost time: 1.679694414138794
Epoch: 3, Steps: 4 | Train Loss: 1.523 Vali Loss: 1.591 Vali Acc: 0.220 Test Loss: 1.591 Test Acc: 0.220
Validation loss decreased (-0.199984 --> -0.219984).  Saving model ...
Epoch: 4 cost time: 1.7216296195983887
Epoch: 4, Steps: 4 | Train Loss: 1.469 Vali Loss: 1.553 Vali Acc: 0.200 Test Loss: 1.553 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6835534572601318
Epoch: 5, Steps: 4 | Train Loss: 1.332 Vali Loss: 1.517 Vali Acc: 0.300 Test Loss: 1.517 Test Acc: 0.300
Validation loss decreased (-0.219984 --> -0.299985).  Saving model ...
Epoch: 6 cost time: 1.7018136978149414
Epoch: 6, Steps: 4 | Train Loss: 1.281 Vali Loss: 1.485 Vali Acc: 0.360 Test Loss: 1.485 Test Acc: 0.360
Validation loss decreased (-0.299985 --> -0.359985).  Saving model ...
Epoch: 7 cost time: 1.6127641201019287
Epoch: 7, Steps: 4 | Train Loss: 1.238 Vali Loss: 1.445 Vali Acc: 0.360 Test Loss: 1.445 Test Acc: 0.360
Validation loss decreased (-0.359985 --> -0.359986).  Saving model ...
Epoch: 8 cost time: 1.684227705001831
Epoch: 8, Steps: 4 | Train Loss: 1.080 Vali Loss: 1.394 Vali Acc: 0.400 Test Loss: 1.394 Test Acc: 0.400
Validation loss decreased (-0.359986 --> -0.399986).  Saving model ...
Epoch: 9 cost time: 1.6218688488006592
Epoch: 9, Steps: 4 | Train Loss: 0.992 Vali Loss: 1.343 Vali Acc: 0.440 Test Loss: 1.343 Test Acc: 0.440
Validation loss decreased (-0.399986 --> -0.439987).  Saving model ...
Epoch: 10 cost time: 1.6999211311340332
Epoch: 10, Steps: 4 | Train Loss: 0.866 Vali Loss: 1.295 Vali Acc: 0.480 Test Loss: 1.295 Test Acc: 0.480
Validation loss decreased (-0.439987 --> -0.479987).  Saving model ...
Epoch: 11 cost time: 1.696028709411621
Epoch: 11, Steps: 4 | Train Loss: 0.684 Vali Loss: 1.261 Vali Acc: 0.480 Test Loss: 1.261 Test Acc: 0.480
Validation loss decreased (-0.479987 --> -0.479987).  Saving model ...
Epoch: 12 cost time: 1.6062901020050049
Epoch: 12, Steps: 4 | Train Loss: 0.607 Vali Loss: 1.232 Vali Acc: 0.500 Test Loss: 1.232 Test Acc: 0.500
Validation loss decreased (-0.479987 --> -0.499988).  Saving model ...
Epoch: 13 cost time: 1.633533239364624
Epoch: 13, Steps: 4 | Train Loss: 0.494 Vali Loss: 1.193 Vali Acc: 0.520 Test Loss: 1.193 Test Acc: 0.520
Validation loss decreased (-0.499988 --> -0.519988).  Saving model ...
Epoch: 14 cost time: 1.6764254570007324
Epoch: 14, Steps: 4 | Train Loss: 0.445 Vali Loss: 1.143 Vali Acc: 0.520 Test Loss: 1.143 Test Acc: 0.520
Validation loss decreased (-0.519988 --> -0.519989).  Saving model ...
Epoch: 15 cost time: 1.5999431610107422
Epoch: 15, Steps: 4 | Train Loss: 0.380 Vali Loss: 1.123 Vali Acc: 0.560 Test Loss: 1.123 Test Acc: 0.560
Validation loss decreased (-0.519989 --> -0.559989).  Saving model ...
Epoch: 16 cost time: 1.596358060836792
Epoch: 16, Steps: 4 | Train Loss: 0.642 Vali Loss: 1.136 Vali Acc: 0.500 Test Loss: 1.136 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.5684611797332764
Epoch: 17, Steps: 4 | Train Loss: 0.294 Vali Loss: 1.115 Vali Acc: 0.480 Test Loss: 1.115 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.6855828762054443
Epoch: 18, Steps: 4 | Train Loss: 0.227 Vali Loss: 1.093 Vali Acc: 0.520 Test Loss: 1.093 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.5277416706085205
Epoch: 19, Steps: 4 | Train Loss: 0.253 Vali Loss: 1.077 Vali Acc: 0.560 Test Loss: 1.077 Test Acc: 0.560
Validation loss decreased (-0.559989 --> -0.559989).  Saving model ...
Epoch: 20 cost time: 1.4821808338165283
Epoch: 20, Steps: 4 | Train Loss: 0.399 Vali Loss: 1.097 Vali Acc: 0.540 Test Loss: 1.097 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.5164587497711182
Epoch: 21, Steps: 4 | Train Loss: 0.153 Vali Loss: 1.112 Vali Acc: 0.500 Test Loss: 1.112 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.4864811897277832
Epoch: 22, Steps: 4 | Train Loss: 0.254 Vali Loss: 1.094 Vali Acc: 0.560 Test Loss: 1.094 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.6926476955413818
Epoch: 23, Steps: 4 | Train Loss: 0.142 Vali Loss: 1.113 Vali Acc: 0.560 Test Loss: 1.113 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.715590238571167
Epoch: 24, Steps: 4 | Train Loss: 0.132 Vali Loss: 1.127 Vali Acc: 0.540 Test Loss: 1.127 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.5466358661651611
Epoch: 25, Steps: 4 | Train Loss: 0.099 Vali Loss: 1.154 Vali Acc: 0.560 Test Loss: 1.154 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.6322665214538574
Epoch: 26, Steps: 4 | Train Loss: 0.091 Vali Loss: 1.150 Vali Acc: 0.520 Test Loss: 1.150 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.790468454360962
Epoch: 27, Steps: 4 | Train Loss: 0.093 Vali Loss: 1.162 Vali Acc: 0.540 Test Loss: 1.162 Test Acc: 0.540
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.6577305793762207
Epoch: 28, Steps: 4 | Train Loss: 0.076 Vali Loss: 1.134 Vali Acc: 0.560 Test Loss: 1.134 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.6676249504089355
Epoch: 29, Steps: 4 | Train Loss: 0.070 Vali Loss: 1.108 Vali Acc: 0.580 Test Loss: 1.108 Test Acc: 0.580
Validation loss decreased (-0.559989 --> -0.579989).  Saving model ...
Epoch: 30 cost time: 1.6958281993865967
Epoch: 30, Steps: 4 | Train Loss: 0.238 Vali Loss: 1.130 Vali Acc: 0.540 Test Loss: 1.130 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm16_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 430965
model size : 1.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm16_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.338040590286255
Epoch: 1, Steps: 4 | Train Loss: 1.700 Vali Loss: 1.605 Vali Acc: 0.220 Test Loss: 1.605 Test Acc: 0.220
Validation loss decreased (inf --> -0.219984).  Saving model ...
Epoch: 2 cost time: 2.326011896133423
Epoch: 2, Steps: 4 | Train Loss: 1.628 Vali Loss: 1.588 Vali Acc: 0.240 Test Loss: 1.588 Test Acc: 0.240
Validation loss decreased (-0.219984 --> -0.239984).  Saving model ...
Epoch: 3 cost time: 2.09372615814209
Epoch: 3, Steps: 4 | Train Loss: 1.567 Vali Loss: 1.571 Vali Acc: 0.340 Test Loss: 1.571 Test Acc: 0.340
Validation loss decreased (-0.239984 --> -0.339984).  Saving model ...
Epoch: 4 cost time: 2.2535767555236816
Epoch: 4, Steps: 4 | Train Loss: 1.533 Vali Loss: 1.562 Vali Acc: 0.320 Test Loss: 1.562 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.1620752811431885
Epoch: 5, Steps: 4 | Train Loss: 1.524 Vali Loss: 1.551 Vali Acc: 0.320 Test Loss: 1.551 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.226402521133423
Epoch: 6, Steps: 4 | Train Loss: 1.298 Vali Loss: 1.522 Vali Acc: 0.380 Test Loss: 1.522 Test Acc: 0.380
Validation loss decreased (-0.339984 --> -0.379985).  Saving model ...
Epoch: 7 cost time: 2.159137487411499
Epoch: 7, Steps: 4 | Train Loss: 1.299 Vali Loss: 1.488 Vali Acc: 0.520 Test Loss: 1.488 Test Acc: 0.520
Validation loss decreased (-0.379985 --> -0.519985).  Saving model ...
Epoch: 8 cost time: 2.1886074542999268
Epoch: 8, Steps: 4 | Train Loss: 1.280 Vali Loss: 1.456 Vali Acc: 0.520 Test Loss: 1.456 Test Acc: 0.520
Validation loss decreased (-0.519985 --> -0.519985).  Saving model ...
Epoch: 9 cost time: 2.159867525100708
Epoch: 9, Steps: 4 | Train Loss: 1.017 Vali Loss: 1.418 Vali Acc: 0.460 Test Loss: 1.418 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.1534531116485596
Epoch: 10, Steps: 4 | Train Loss: 0.903 Vali Loss: 1.380 Vali Acc: 0.440 Test Loss: 1.380 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.1057844161987305
Epoch: 11, Steps: 4 | Train Loss: 0.760 Vali Loss: 1.319 Vali Acc: 0.480 Test Loss: 1.319 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.1629157066345215
Epoch: 12, Steps: 4 | Train Loss: 0.768 Vali Loss: 1.257 Vali Acc: 0.500 Test Loss: 1.257 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.0686471462249756
Epoch: 13, Steps: 4 | Train Loss: 0.652 Vali Loss: 1.196 Vali Acc: 0.480 Test Loss: 1.196 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.09053635597229
Epoch: 14, Steps: 4 | Train Loss: 0.540 Vali Loss: 1.139 Vali Acc: 0.520 Test Loss: 1.139 Test Acc: 0.520
Validation loss decreased (-0.519985 --> -0.519989).  Saving model ...
Epoch: 15 cost time: 2.031048059463501
Epoch: 15, Steps: 4 | Train Loss: 0.404 Vali Loss: 1.132 Vali Acc: 0.520 Test Loss: 1.132 Test Acc: 0.520
Validation loss decreased (-0.519989 --> -0.519989).  Saving model ...
Epoch: 16 cost time: 2.1067681312561035
Epoch: 16, Steps: 4 | Train Loss: 0.390 Vali Loss: 1.159 Vali Acc: 0.560 Test Loss: 1.159 Test Acc: 0.560
Validation loss decreased (-0.519989 --> -0.559988).  Saving model ...
Epoch: 17 cost time: 2.131553888320923
Epoch: 17, Steps: 4 | Train Loss: 0.286 Vali Loss: 1.137 Vali Acc: 0.540 Test Loss: 1.137 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.1162874698638916
Epoch: 18, Steps: 4 | Train Loss: 0.430 Vali Loss: 1.093 Vali Acc: 0.540 Test Loss: 1.093 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.07448673248291
Epoch: 19, Steps: 4 | Train Loss: 0.238 Vali Loss: 1.126 Vali Acc: 0.540 Test Loss: 1.126 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.060305118560791
Epoch: 20, Steps: 4 | Train Loss: 0.172 Vali Loss: 1.216 Vali Acc: 0.600 Test Loss: 1.216 Test Acc: 0.600
Validation loss decreased (-0.559988 --> -0.599988).  Saving model ...
Epoch: 21 cost time: 2.0623393058776855
Epoch: 21, Steps: 4 | Train Loss: 0.177 Vali Loss: 1.100 Vali Acc: 0.580 Test Loss: 1.100 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.2262344360351562
Epoch: 22, Steps: 4 | Train Loss: 0.167 Vali Loss: 1.065 Vali Acc: 0.560 Test Loss: 1.065 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.164780378341675
Epoch: 23, Steps: 4 | Train Loss: 0.119 Vali Loss: 1.046 Vali Acc: 0.560 Test Loss: 1.046 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.162886142730713
Epoch: 24, Steps: 4 | Train Loss: 0.089 Vali Loss: 1.016 Vali Acc: 0.560 Test Loss: 1.016 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.030693769454956
Epoch: 25, Steps: 4 | Train Loss: 0.085 Vali Loss: 1.035 Vali Acc: 0.600 Test Loss: 1.035 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599990).  Saving model ...
Epoch: 26 cost time: 2.0655477046966553
Epoch: 26, Steps: 4 | Train Loss: 0.079 Vali Loss: 1.095 Vali Acc: 0.560 Test Loss: 1.095 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.117128849029541
Epoch: 27, Steps: 4 | Train Loss: 0.057 Vali Loss: 1.099 Vali Acc: 0.580 Test Loss: 1.099 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.114717960357666
Epoch: 28, Steps: 4 | Train Loss: 0.054 Vali Loss: 1.127 Vali Acc: 0.560 Test Loss: 1.127 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.1278254985809326
Epoch: 29, Steps: 4 | Train Loss: 0.062 Vali Loss: 1.072 Vali Acc: 0.580 Test Loss: 1.072 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.0781614780426025
Epoch: 30, Steps: 4 | Train Loss: 0.034 Vali Loss: 1.036 Vali Acc: 0.560 Test Loss: 1.036 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm16_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 1258677
model size : 5.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm16_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.603196859359741
Epoch: 1, Steps: 4 | Train Loss: 1.617 Vali Loss: 1.648 Vali Acc: 0.180 Test Loss: 1.648 Test Acc: 0.180
Validation loss decreased (inf --> -0.179984).  Saving model ...
Epoch: 2 cost time: 1.5668725967407227
Epoch: 2, Steps: 4 | Train Loss: 1.555 Vali Loss: 1.621 Vali Acc: 0.200 Test Loss: 1.621 Test Acc: 0.200
Validation loss decreased (-0.179984 --> -0.199984).  Saving model ...
Epoch: 3 cost time: 1.4217016696929932
Epoch: 3, Steps: 4 | Train Loss: 1.532 Vali Loss: 1.590 Vali Acc: 0.220 Test Loss: 1.590 Test Acc: 0.220
Validation loss decreased (-0.199984 --> -0.219984).  Saving model ...
Epoch: 4 cost time: 1.4250295162200928
Epoch: 4, Steps: 4 | Train Loss: 1.475 Vali Loss: 1.551 Vali Acc: 0.220 Test Loss: 1.551 Test Acc: 0.220
Validation loss decreased (-0.219984 --> -0.219984).  Saving model ...
Epoch: 5 cost time: 1.3937201499938965
Epoch: 5, Steps: 4 | Train Loss: 1.335 Vali Loss: 1.515 Vali Acc: 0.320 Test Loss: 1.515 Test Acc: 0.320
Validation loss decreased (-0.219984 --> -0.319985).  Saving model ...
Epoch: 6 cost time: 1.4369804859161377
Epoch: 6, Steps: 4 | Train Loss: 1.285 Vali Loss: 1.485 Vali Acc: 0.320 Test Loss: 1.485 Test Acc: 0.320
Validation loss decreased (-0.319985 --> -0.319985).  Saving model ...
Epoch: 7 cost time: 1.385932207107544
Epoch: 7, Steps: 4 | Train Loss: 1.239 Vali Loss: 1.446 Vali Acc: 0.380 Test Loss: 1.446 Test Acc: 0.380
Validation loss decreased (-0.319985 --> -0.379986).  Saving model ...
Epoch: 8 cost time: 1.5419046878814697
Epoch: 8, Steps: 4 | Train Loss: 1.075 Vali Loss: 1.397 Vali Acc: 0.400 Test Loss: 1.397 Test Acc: 0.400
Validation loss decreased (-0.379986 --> -0.399986).  Saving model ...
Epoch: 9 cost time: 1.6034936904907227
Epoch: 9, Steps: 4 | Train Loss: 1.000 Vali Loss: 1.345 Vali Acc: 0.440 Test Loss: 1.345 Test Acc: 0.440
Validation loss decreased (-0.399986 --> -0.439987).  Saving model ...
Epoch: 10 cost time: 1.5605700016021729
Epoch: 10, Steps: 4 | Train Loss: 0.864 Vali Loss: 1.295 Vali Acc: 0.480 Test Loss: 1.295 Test Acc: 0.480
Validation loss decreased (-0.439987 --> -0.479987).  Saving model ...
Epoch: 11 cost time: 1.4946627616882324
Epoch: 11, Steps: 4 | Train Loss: 0.694 Vali Loss: 1.260 Vali Acc: 0.460 Test Loss: 1.260 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.509303092956543
Epoch: 12, Steps: 4 | Train Loss: 0.612 Vali Loss: 1.228 Vali Acc: 0.480 Test Loss: 1.228 Test Acc: 0.480
Validation loss decreased (-0.479987 --> -0.479988).  Saving model ...
Epoch: 13 cost time: 1.5080585479736328
Epoch: 13, Steps: 4 | Train Loss: 0.505 Vali Loss: 1.188 Vali Acc: 0.540 Test Loss: 1.188 Test Acc: 0.540
Validation loss decreased (-0.479988 --> -0.539988).  Saving model ...
Epoch: 14 cost time: 1.4894633293151855
Epoch: 14, Steps: 4 | Train Loss: 0.451 Vali Loss: 1.137 Vali Acc: 0.520 Test Loss: 1.137 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.6034972667694092
Epoch: 15, Steps: 4 | Train Loss: 0.390 Vali Loss: 1.118 Vali Acc: 0.580 Test Loss: 1.118 Test Acc: 0.580
Validation loss decreased (-0.539988 --> -0.579989).  Saving model ...
Epoch: 16 cost time: 1.4419362545013428
Epoch: 16, Steps: 4 | Train Loss: 0.648 Vali Loss: 1.128 Vali Acc: 0.500 Test Loss: 1.128 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.512329339981079
Epoch: 17, Steps: 4 | Train Loss: 0.296 Vali Loss: 1.110 Vali Acc: 0.500 Test Loss: 1.110 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.4395294189453125
Epoch: 18, Steps: 4 | Train Loss: 0.241 Vali Loss: 1.094 Vali Acc: 0.500 Test Loss: 1.094 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.6137688159942627
Epoch: 19, Steps: 4 | Train Loss: 0.256 Vali Loss: 1.079 Vali Acc: 0.540 Test Loss: 1.079 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.4837305545806885
Epoch: 20, Steps: 4 | Train Loss: 0.407 Vali Loss: 1.105 Vali Acc: 0.560 Test Loss: 1.105 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.5298094749450684
Epoch: 21, Steps: 4 | Train Loss: 0.158 Vali Loss: 1.140 Vali Acc: 0.520 Test Loss: 1.140 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.578718662261963
Epoch: 22, Steps: 4 | Train Loss: 0.294 Vali Loss: 1.108 Vali Acc: 0.520 Test Loss: 1.108 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.538520336151123
Epoch: 23, Steps: 4 | Train Loss: 0.147 Vali Loss: 1.127 Vali Acc: 0.520 Test Loss: 1.127 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.453845739364624
Epoch: 24, Steps: 4 | Train Loss: 0.134 Vali Loss: 1.137 Vali Acc: 0.540 Test Loss: 1.137 Test Acc: 0.540
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.4199144840240479
Epoch: 25, Steps: 4 | Train Loss: 0.102 Vali Loss: 1.138 Vali Acc: 0.600 Test Loss: 1.138 Test Acc: 0.600
Validation loss decreased (-0.579989 --> -0.599989).  Saving model ...
Epoch: 26 cost time: 1.4708213806152344
Epoch: 26, Steps: 4 | Train Loss: 0.089 Vali Loss: 1.146 Vali Acc: 0.520 Test Loss: 1.146 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.5307655334472656
Epoch: 27, Steps: 4 | Train Loss: 0.095 Vali Loss: 1.161 Vali Acc: 0.540 Test Loss: 1.161 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.4822564125061035
Epoch: 28, Steps: 4 | Train Loss: 0.078 Vali Loss: 1.134 Vali Acc: 0.580 Test Loss: 1.134 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.363692045211792
Epoch: 29, Steps: 4 | Train Loss: 0.071 Vali Loss: 1.135 Vali Acc: 0.580 Test Loss: 1.135 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.4596083164215088
Epoch: 30, Steps: 4 | Train Loss: 0.236 Vali Loss: 1.168 Vali Acc: 0.560 Test Loss: 1.168 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm16_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 430965
model size : 1.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm16_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.351426362991333
Epoch: 1, Steps: 4 | Train Loss: 1.702 Vali Loss: 1.605 Vali Acc: 0.220 Test Loss: 1.605 Test Acc: 0.220
Validation loss decreased (inf --> -0.219984).  Saving model ...
Epoch: 2 cost time: 1.4182641506195068
Epoch: 2, Steps: 4 | Train Loss: 1.628 Vali Loss: 1.589 Vali Acc: 0.240 Test Loss: 1.589 Test Acc: 0.240
Validation loss decreased (-0.219984 --> -0.239984).  Saving model ...
Epoch: 3 cost time: 1.5731723308563232
Epoch: 3, Steps: 4 | Train Loss: 1.566 Vali Loss: 1.572 Vali Acc: 0.320 Test Loss: 1.572 Test Acc: 0.320
Validation loss decreased (-0.239984 --> -0.319984).  Saving model ...
Epoch: 4 cost time: 1.4818837642669678
Epoch: 4, Steps: 4 | Train Loss: 1.542 Vali Loss: 1.564 Vali Acc: 0.300 Test Loss: 1.564 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.539264440536499
Epoch: 5, Steps: 4 | Train Loss: 1.547 Vali Loss: 1.554 Vali Acc: 0.340 Test Loss: 1.554 Test Acc: 0.340
Validation loss decreased (-0.319984 --> -0.339984).  Saving model ...
Epoch: 6 cost time: 1.4153106212615967
Epoch: 6, Steps: 4 | Train Loss: 1.308 Vali Loss: 1.526 Vali Acc: 0.400 Test Loss: 1.526 Test Acc: 0.400
Validation loss decreased (-0.339984 --> -0.399985).  Saving model ...
Epoch: 7 cost time: 1.56976318359375
Epoch: 7, Steps: 4 | Train Loss: 1.314 Vali Loss: 1.491 Vali Acc: 0.480 Test Loss: 1.491 Test Acc: 0.480
Validation loss decreased (-0.399985 --> -0.479985).  Saving model ...
Epoch: 8 cost time: 1.355332612991333
Epoch: 8, Steps: 4 | Train Loss: 1.293 Vali Loss: 1.459 Vali Acc: 0.500 Test Loss: 1.459 Test Acc: 0.500
Validation loss decreased (-0.479985 --> -0.499985).  Saving model ...
Epoch: 9 cost time: 1.4723453521728516
Epoch: 9, Steps: 4 | Train Loss: 1.040 Vali Loss: 1.421 Vali Acc: 0.480 Test Loss: 1.421 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4470086097717285
Epoch: 10, Steps: 4 | Train Loss: 0.929 Vali Loss: 1.381 Vali Acc: 0.440 Test Loss: 1.381 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.5080475807189941
Epoch: 11, Steps: 4 | Train Loss: 0.783 Vali Loss: 1.317 Vali Acc: 0.520 Test Loss: 1.317 Test Acc: 0.520
Validation loss decreased (-0.499985 --> -0.519987).  Saving model ...
Epoch: 12 cost time: 1.3196496963500977
Epoch: 12, Steps: 4 | Train Loss: 0.780 Vali Loss: 1.250 Vali Acc: 0.540 Test Loss: 1.250 Test Acc: 0.540
Validation loss decreased (-0.519987 --> -0.539987).  Saving model ...
Epoch: 13 cost time: 1.287325382232666
Epoch: 13, Steps: 4 | Train Loss: 0.672 Vali Loss: 1.182 Vali Acc: 0.520 Test Loss: 1.182 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4841699600219727
Epoch: 14, Steps: 4 | Train Loss: 0.558 Vali Loss: 1.127 Vali Acc: 0.520 Test Loss: 1.127 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.4479622840881348
Epoch: 15, Steps: 4 | Train Loss: 0.423 Vali Loss: 1.119 Vali Acc: 0.540 Test Loss: 1.119 Test Acc: 0.540
Validation loss decreased (-0.539987 --> -0.539989).  Saving model ...
Epoch: 16 cost time: 1.5116629600524902
Epoch: 16, Steps: 4 | Train Loss: 0.406 Vali Loss: 1.121 Vali Acc: 0.540 Test Loss: 1.121 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.4605185985565186
Epoch: 17, Steps: 4 | Train Loss: 0.305 Vali Loss: 1.074 Vali Acc: 0.540 Test Loss: 1.074 Test Acc: 0.540
Validation loss decreased (-0.539989 --> -0.539989).  Saving model ...
Epoch: 18 cost time: 1.5396442413330078
Epoch: 18, Steps: 4 | Train Loss: 0.465 Vali Loss: 1.031 Vali Acc: 0.540 Test Loss: 1.031 Test Acc: 0.540
Validation loss decreased (-0.539989 --> -0.539990).  Saving model ...
Epoch: 19 cost time: 1.5086257457733154
Epoch: 19, Steps: 4 | Train Loss: 0.242 Vali Loss: 1.048 Vali Acc: 0.500 Test Loss: 1.048 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.553234577178955
Epoch: 20, Steps: 4 | Train Loss: 0.188 Vali Loss: 1.120 Vali Acc: 0.560 Test Loss: 1.120 Test Acc: 0.560
Validation loss decreased (-0.539990 --> -0.559989).  Saving model ...
Epoch: 21 cost time: 1.5118367671966553
Epoch: 21, Steps: 4 | Train Loss: 0.191 Vali Loss: 1.008 Vali Acc: 0.560 Test Loss: 1.008 Test Acc: 0.560
Validation loss decreased (-0.559989 --> -0.559990).  Saving model ...
Epoch: 22 cost time: 1.5377604961395264
Epoch: 22, Steps: 4 | Train Loss: 0.127 Vali Loss: 0.995 Vali Acc: 0.560 Test Loss: 0.995 Test Acc: 0.560
Validation loss decreased (-0.559990 --> -0.559990).  Saving model ...
Epoch: 23 cost time: 1.578636884689331
Epoch: 23, Steps: 4 | Train Loss: 0.127 Vali Loss: 0.980 Vali Acc: 0.540 Test Loss: 0.980 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.5155432224273682
Epoch: 24, Steps: 4 | Train Loss: 0.091 Vali Loss: 0.961 Vali Acc: 0.560 Test Loss: 0.961 Test Acc: 0.560
Validation loss decreased (-0.559990 --> -0.559990).  Saving model ...
Epoch: 25 cost time: 1.5345358848571777
Epoch: 25, Steps: 4 | Train Loss: 0.091 Vali Loss: 0.971 Vali Acc: 0.600 Test Loss: 0.971 Test Acc: 0.600
Validation loss decreased (-0.559990 --> -0.599990).  Saving model ...
Epoch: 26 cost time: 1.587531328201294
Epoch: 26, Steps: 4 | Train Loss: 0.084 Vali Loss: 0.999 Vali Acc: 0.640 Test Loss: 0.999 Test Acc: 0.640
Validation loss decreased (-0.599990 --> -0.639990).  Saving model ...
Epoch: 27 cost time: 1.4256963729858398
Epoch: 27, Steps: 4 | Train Loss: 0.068 Vali Loss: 0.994 Vali Acc: 0.580 Test Loss: 0.994 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.6241214275360107
Epoch: 28, Steps: 4 | Train Loss: 0.058 Vali Loss: 1.000 Vali Acc: 0.580 Test Loss: 1.000 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.5688745975494385
Epoch: 29, Steps: 4 | Train Loss: 0.051 Vali Loss: 0.982 Vali Acc: 0.600 Test Loss: 0.982 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.5344603061676025
Epoch: 30, Steps: 4 | Train Loss: 0.048 Vali Loss: 0.957 Vali Acc: 0.600 Test Loss: 0.957 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm16_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.64
model parameter : 1258677
model size : 5.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm16_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.0051209926605225
Epoch: 1, Steps: 4 | Train Loss: 1.612 Vali Loss: 1.653 Vali Acc: 0.200 Test Loss: 1.653 Test Acc: 0.200
Validation loss decreased (inf --> -0.199983).  Saving model ...
Epoch: 2 cost time: 1.147787094116211
Epoch: 2, Steps: 4 | Train Loss: 1.557 Vali Loss: 1.627 Vali Acc: 0.200 Test Loss: 1.627 Test Acc: 0.200
Validation loss decreased (-0.199983 --> -0.199984).  Saving model ...
Epoch: 3 cost time: 1.1659681797027588
Epoch: 3, Steps: 4 | Train Loss: 1.538 Vali Loss: 1.596 Vali Acc: 0.220 Test Loss: 1.596 Test Acc: 0.220
Validation loss decreased (-0.199984 --> -0.219984).  Saving model ...
Epoch: 4 cost time: 1.1739063262939453
Epoch: 4, Steps: 4 | Train Loss: 1.477 Vali Loss: 1.558 Vali Acc: 0.220 Test Loss: 1.558 Test Acc: 0.220
Validation loss decreased (-0.219984 --> -0.219984).  Saving model ...
Epoch: 5 cost time: 1.2090635299682617
Epoch: 5, Steps: 4 | Train Loss: 1.339 Vali Loss: 1.523 Vali Acc: 0.320 Test Loss: 1.523 Test Acc: 0.320
Validation loss decreased (-0.219984 --> -0.319985).  Saving model ...
Epoch: 6 cost time: 1.2755601406097412
Epoch: 6, Steps: 4 | Train Loss: 1.297 Vali Loss: 1.493 Vali Acc: 0.340 Test Loss: 1.493 Test Acc: 0.340
Validation loss decreased (-0.319985 --> -0.339985).  Saving model ...
Epoch: 7 cost time: 1.168699026107788
Epoch: 7, Steps: 4 | Train Loss: 1.245 Vali Loss: 1.454 Vali Acc: 0.360 Test Loss: 1.454 Test Acc: 0.360
Validation loss decreased (-0.339985 --> -0.359985).  Saving model ...
Epoch: 8 cost time: 1.244150161743164
Epoch: 8, Steps: 4 | Train Loss: 1.083 Vali Loss: 1.400 Vali Acc: 0.400 Test Loss: 1.400 Test Acc: 0.400
Validation loss decreased (-0.359985 --> -0.399986).  Saving model ...
Epoch: 9 cost time: 1.2591748237609863
Epoch: 9, Steps: 4 | Train Loss: 1.008 Vali Loss: 1.345 Vali Acc: 0.440 Test Loss: 1.345 Test Acc: 0.440
Validation loss decreased (-0.399986 --> -0.439987).  Saving model ...
Epoch: 10 cost time: 1.3084821701049805
Epoch: 10, Steps: 4 | Train Loss: 0.874 Vali Loss: 1.294 Vali Acc: 0.480 Test Loss: 1.294 Test Acc: 0.480
Validation loss decreased (-0.439987 --> -0.479987).  Saving model ...
Epoch: 11 cost time: 1.1852433681488037
Epoch: 11, Steps: 4 | Train Loss: 0.695 Vali Loss: 1.253 Vali Acc: 0.460 Test Loss: 1.253 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2224833965301514
Epoch: 12, Steps: 4 | Train Loss: 0.619 Vali Loss: 1.222 Vali Acc: 0.520 Test Loss: 1.222 Test Acc: 0.520
Validation loss decreased (-0.479987 --> -0.519988).  Saving model ...
Epoch: 13 cost time: 1.1641042232513428
Epoch: 13, Steps: 4 | Train Loss: 0.509 Vali Loss: 1.178 Vali Acc: 0.520 Test Loss: 1.178 Test Acc: 0.520
Validation loss decreased (-0.519988 --> -0.519988).  Saving model ...
Epoch: 14 cost time: 1.1888086795806885
Epoch: 14, Steps: 4 | Train Loss: 0.462 Vali Loss: 1.124 Vali Acc: 0.540 Test Loss: 1.124 Test Acc: 0.540
Validation loss decreased (-0.519988 --> -0.539989).  Saving model ...
Epoch: 15 cost time: 1.2036042213439941
Epoch: 15, Steps: 4 | Train Loss: 0.385 Vali Loss: 1.104 Vali Acc: 0.580 Test Loss: 1.104 Test Acc: 0.580
Validation loss decreased (-0.539989 --> -0.579989).  Saving model ...
Epoch: 16 cost time: 1.137120246887207
Epoch: 16, Steps: 4 | Train Loss: 0.656 Vali Loss: 1.109 Vali Acc: 0.520 Test Loss: 1.109 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2153825759887695
Epoch: 17, Steps: 4 | Train Loss: 0.310 Vali Loss: 1.079 Vali Acc: 0.520 Test Loss: 1.079 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.1856975555419922
Epoch: 18, Steps: 4 | Train Loss: 0.250 Vali Loss: 1.071 Vali Acc: 0.480 Test Loss: 1.071 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.2068469524383545
Epoch: 19, Steps: 4 | Train Loss: 0.268 Vali Loss: 1.056 Vali Acc: 0.580 Test Loss: 1.056 Test Acc: 0.580
Validation loss decreased (-0.579989 --> -0.579989).  Saving model ...
Epoch: 20 cost time: 1.1597669124603271
Epoch: 20, Steps: 4 | Train Loss: 0.426 Vali Loss: 1.068 Vali Acc: 0.580 Test Loss: 1.068 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.265221118927002
Epoch: 21, Steps: 4 | Train Loss: 0.163 Vali Loss: 1.119 Vali Acc: 0.540 Test Loss: 1.119 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.2773430347442627
Epoch: 22, Steps: 4 | Train Loss: 0.275 Vali Loss: 1.073 Vali Acc: 0.540 Test Loss: 1.073 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.1443657875061035
Epoch: 23, Steps: 4 | Train Loss: 0.172 Vali Loss: 1.099 Vali Acc: 0.540 Test Loss: 1.099 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.1979703903198242
Epoch: 24, Steps: 4 | Train Loss: 0.147 Vali Loss: 1.106 Vali Acc: 0.600 Test Loss: 1.106 Test Acc: 0.600
Validation loss decreased (-0.579989 --> -0.599989).  Saving model ...
Epoch: 25 cost time: 1.087977647781372
Epoch: 25, Steps: 4 | Train Loss: 0.120 Vali Loss: 1.095 Vali Acc: 0.540 Test Loss: 1.095 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.1651334762573242
Epoch: 26, Steps: 4 | Train Loss: 0.111 Vali Loss: 1.082 Vali Acc: 0.600 Test Loss: 1.082 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 27 cost time: 1.2694671154022217
Epoch: 27, Steps: 4 | Train Loss: 0.109 Vali Loss: 1.108 Vali Acc: 0.540 Test Loss: 1.108 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.323230504989624
Epoch: 28, Steps: 4 | Train Loss: 0.088 Vali Loss: 1.078 Vali Acc: 0.600 Test Loss: 1.078 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 29 cost time: 1.283336877822876
Epoch: 29, Steps: 4 | Train Loss: 0.128 Vali Loss: 1.069 Vali Acc: 0.580 Test Loss: 1.069 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.2562997341156006
Epoch: 30, Steps: 4 | Train Loss: 0.277 Vali Loss: 1.114 Vali Acc: 0.540 Test Loss: 1.114 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm16_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 430965
model size : 1.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm16_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.803256034851074
Epoch: 1, Steps: 4 | Train Loss: 1.837 Vali Loss: 1.656 Vali Acc: 0.180 Test Loss: 1.656 Test Acc: 0.180
Validation loss decreased (inf --> -0.179983).  Saving model ...
Epoch: 2 cost time: 1.6516985893249512
Epoch: 2, Steps: 4 | Train Loss: 1.714 Vali Loss: 1.633 Vali Acc: 0.220 Test Loss: 1.633 Test Acc: 0.220
Validation loss decreased (-0.179983 --> -0.219984).  Saving model ...
Epoch: 3 cost time: 1.7420287132263184
Epoch: 3, Steps: 4 | Train Loss: 1.590 Vali Loss: 1.597 Vali Acc: 0.300 Test Loss: 1.597 Test Acc: 0.300
Validation loss decreased (-0.219984 --> -0.299984).  Saving model ...
Epoch: 4 cost time: 1.8038594722747803
Epoch: 4, Steps: 4 | Train Loss: 1.551 Vali Loss: 1.566 Vali Acc: 0.340 Test Loss: 1.566 Test Acc: 0.340
Validation loss decreased (-0.299984 --> -0.339984).  Saving model ...
Epoch: 5 cost time: 1.5910754203796387
Epoch: 5, Steps: 4 | Train Loss: 1.477 Vali Loss: 1.547 Vali Acc: 0.380 Test Loss: 1.547 Test Acc: 0.380
Validation loss decreased (-0.339984 --> -0.379985).  Saving model ...
Epoch: 6 cost time: 1.7258539199829102
Epoch: 6, Steps: 4 | Train Loss: 1.327 Vali Loss: 1.529 Vali Acc: 0.360 Test Loss: 1.529 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.793602466583252
Epoch: 7, Steps: 4 | Train Loss: 1.330 Vali Loss: 1.496 Vali Acc: 0.360 Test Loss: 1.496 Test Acc: 0.360
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.6911444664001465
Epoch: 8, Steps: 4 | Train Loss: 1.127 Vali Loss: 1.447 Vali Acc: 0.380 Test Loss: 1.447 Test Acc: 0.380
Validation loss decreased (-0.379985 --> -0.379986).  Saving model ...
Epoch: 9 cost time: 1.8772287368774414
Epoch: 9, Steps: 4 | Train Loss: 1.011 Vali Loss: 1.401 Vali Acc: 0.420 Test Loss: 1.401 Test Acc: 0.420
Validation loss decreased (-0.379986 --> -0.419986).  Saving model ...
Epoch: 10 cost time: 1.6672675609588623
Epoch: 10, Steps: 4 | Train Loss: 1.014 Vali Loss: 1.351 Vali Acc: 0.480 Test Loss: 1.351 Test Acc: 0.480
Validation loss decreased (-0.419986 --> -0.479986).  Saving model ...
Epoch: 11 cost time: 1.8362462520599365
Epoch: 11, Steps: 4 | Train Loss: 0.776 Vali Loss: 1.285 Vali Acc: 0.500 Test Loss: 1.285 Test Acc: 0.500
Validation loss decreased (-0.479986 --> -0.499987).  Saving model ...
Epoch: 12 cost time: 1.849867582321167
Epoch: 12, Steps: 4 | Train Loss: 0.706 Vali Loss: 1.230 Vali Acc: 0.480 Test Loss: 1.230 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.9526951313018799
Epoch: 13, Steps: 4 | Train Loss: 0.652 Vali Loss: 1.180 Vali Acc: 0.520 Test Loss: 1.180 Test Acc: 0.520
Validation loss decreased (-0.499987 --> -0.519988).  Saving model ...
Epoch: 14 cost time: 1.6846647262573242
Epoch: 14, Steps: 4 | Train Loss: 0.872 Vali Loss: 1.140 Vali Acc: 0.500 Test Loss: 1.140 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.7034473419189453
Epoch: 15, Steps: 4 | Train Loss: 0.510 Vali Loss: 1.085 Vali Acc: 0.500 Test Loss: 1.085 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.7638542652130127
Epoch: 16, Steps: 4 | Train Loss: 0.603 Vali Loss: 1.091 Vali Acc: 0.500 Test Loss: 1.091 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.725419282913208
Epoch: 17, Steps: 4 | Train Loss: 0.359 Vali Loss: 1.118 Vali Acc: 0.520 Test Loss: 1.118 Test Acc: 0.520
Validation loss decreased (-0.519988 --> -0.519989).  Saving model ...
Epoch: 18 cost time: 1.8478710651397705
Epoch: 18, Steps: 4 | Train Loss: 0.471 Vali Loss: 1.091 Vali Acc: 0.500 Test Loss: 1.091 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.8192403316497803
Epoch: 19, Steps: 4 | Train Loss: 0.225 Vali Loss: 1.039 Vali Acc: 0.520 Test Loss: 1.039 Test Acc: 0.520
Validation loss decreased (-0.519989 --> -0.519990).  Saving model ...
Epoch: 20 cost time: 1.788154125213623
Epoch: 20, Steps: 4 | Train Loss: 0.246 Vali Loss: 1.035 Vali Acc: 0.560 Test Loss: 1.035 Test Acc: 0.560
Validation loss decreased (-0.519990 --> -0.559990).  Saving model ...
Epoch: 21 cost time: 1.9463911056518555
Epoch: 21, Steps: 4 | Train Loss: 0.194 Vali Loss: 1.148 Vali Acc: 0.500 Test Loss: 1.148 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.8342664241790771
Epoch: 22, Steps: 4 | Train Loss: 0.233 Vali Loss: 1.176 Vali Acc: 0.500 Test Loss: 1.176 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.904893159866333
Epoch: 23, Steps: 4 | Train Loss: 0.123 Vali Loss: 1.163 Vali Acc: 0.500 Test Loss: 1.163 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.0331122875213623
Epoch: 24, Steps: 4 | Train Loss: 0.112 Vali Loss: 1.141 Vali Acc: 0.520 Test Loss: 1.141 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.9248809814453125
Epoch: 25, Steps: 4 | Train Loss: 0.116 Vali Loss: 1.175 Vali Acc: 0.540 Test Loss: 1.175 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.9768726825714111
Epoch: 26, Steps: 4 | Train Loss: 0.098 Vali Loss: 1.234 Vali Acc: 0.480 Test Loss: 1.234 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.970189094543457
Epoch: 27, Steps: 4 | Train Loss: 0.110 Vali Loss: 1.246 Vali Acc: 0.500 Test Loss: 1.246 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.9693574905395508
Epoch: 28, Steps: 4 | Train Loss: 0.069 Vali Loss: 1.222 Vali Acc: 0.580 Test Loss: 1.222 Test Acc: 0.580
Validation loss decreased (-0.559990 --> -0.579988).  Saving model ...
Epoch: 29 cost time: 2.0106112957000732
Epoch: 29, Steps: 4 | Train Loss: 0.070 Vali Loss: 1.171 Vali Acc: 0.580 Test Loss: 1.171 Test Acc: 0.580
Validation loss decreased (-0.579988 --> -0.579988).  Saving model ...
Epoch: 30 cost time: 1.968029499053955
Epoch: 30, Steps: 4 | Train Loss: 0.087 Vali Loss: 1.138 Vali Acc: 0.540 Test Loss: 1.138 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm16_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 672565
model size : 2.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm16_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.0989203453063965
Epoch: 1, Steps: 4 | Train Loss: 1.611 Vali Loss: 1.553 Vali Acc: 0.220 Test Loss: 1.553 Test Acc: 0.220
Validation loss decreased (inf --> -0.219984).  Saving model ...
Epoch: 2 cost time: 1.2140090465545654
Epoch: 2, Steps: 4 | Train Loss: 1.605 Vali Loss: 1.543 Vali Acc: 0.240 Test Loss: 1.543 Test Acc: 0.240
Validation loss decreased (-0.219984 --> -0.239985).  Saving model ...
Epoch: 3 cost time: 1.1887645721435547
Epoch: 3, Steps: 4 | Train Loss: 1.489 Vali Loss: 1.528 Vali Acc: 0.260 Test Loss: 1.528 Test Acc: 0.260
Validation loss decreased (-0.239985 --> -0.259985).  Saving model ...
Epoch: 4 cost time: 1.2186591625213623
Epoch: 4, Steps: 4 | Train Loss: 1.392 Vali Loss: 1.507 Vali Acc: 0.280 Test Loss: 1.507 Test Acc: 0.280
Validation loss decreased (-0.259985 --> -0.279985).  Saving model ...
Epoch: 5 cost time: 1.1637248992919922
Epoch: 5, Steps: 4 | Train Loss: 1.361 Vali Loss: 1.484 Vali Acc: 0.280 Test Loss: 1.484 Test Acc: 0.280
Validation loss decreased (-0.279985 --> -0.279985).  Saving model ...
Epoch: 6 cost time: 1.246020793914795
Epoch: 6, Steps: 4 | Train Loss: 1.343 Vali Loss: 1.449 Vali Acc: 0.380 Test Loss: 1.449 Test Acc: 0.380
Validation loss decreased (-0.279985 --> -0.379986).  Saving model ...
Epoch: 7 cost time: 1.175830364227295
Epoch: 7, Steps: 4 | Train Loss: 1.176 Vali Loss: 1.410 Vali Acc: 0.400 Test Loss: 1.410 Test Acc: 0.400
Validation loss decreased (-0.379986 --> -0.399986).  Saving model ...
Epoch: 8 cost time: 1.1939423084259033
Epoch: 8, Steps: 4 | Train Loss: 1.041 Vali Loss: 1.366 Vali Acc: 0.380 Test Loss: 1.366 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1400907039642334
Epoch: 9, Steps: 4 | Train Loss: 0.967 Vali Loss: 1.339 Vali Acc: 0.400 Test Loss: 1.339 Test Acc: 0.400
Validation loss decreased (-0.399986 --> -0.399987).  Saving model ...
Epoch: 10 cost time: 1.1004836559295654
Epoch: 10, Steps: 4 | Train Loss: 0.941 Vali Loss: 1.297 Vali Acc: 0.400 Test Loss: 1.297 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 11 cost time: 1.2176108360290527
Epoch: 11, Steps: 4 | Train Loss: 0.862 Vali Loss: 1.250 Vali Acc: 0.440 Test Loss: 1.250 Test Acc: 0.440
Validation loss decreased (-0.399987 --> -0.439987).  Saving model ...
Epoch: 12 cost time: 1.1117510795593262
Epoch: 12, Steps: 4 | Train Loss: 0.671 Vali Loss: 1.215 Vali Acc: 0.420 Test Loss: 1.215 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0792930126190186
Epoch: 13, Steps: 4 | Train Loss: 0.668 Vali Loss: 1.161 Vali Acc: 0.460 Test Loss: 1.161 Test Acc: 0.460
Validation loss decreased (-0.439987 --> -0.459988).  Saving model ...
Epoch: 14 cost time: 1.210798978805542
Epoch: 14, Steps: 4 | Train Loss: 0.550 Vali Loss: 1.152 Vali Acc: 0.500 Test Loss: 1.152 Test Acc: 0.500
Validation loss decreased (-0.459988 --> -0.499988).  Saving model ...
Epoch: 15 cost time: 1.1795482635498047
Epoch: 15, Steps: 4 | Train Loss: 0.384 Vali Loss: 1.124 Vali Acc: 0.500 Test Loss: 1.124 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499989).  Saving model ...
Epoch: 16 cost time: 1.137366771697998
Epoch: 16, Steps: 4 | Train Loss: 0.402 Vali Loss: 1.110 Vali Acc: 0.520 Test Loss: 1.110 Test Acc: 0.520
Validation loss decreased (-0.499989 --> -0.519989).  Saving model ...
Epoch: 17 cost time: 1.1642029285430908
Epoch: 17, Steps: 4 | Train Loss: 0.539 Vali Loss: 1.148 Vali Acc: 0.480 Test Loss: 1.148 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1617612838745117
Epoch: 18, Steps: 4 | Train Loss: 0.351 Vali Loss: 1.095 Vali Acc: 0.460 Test Loss: 1.095 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.1488535404205322
Epoch: 19, Steps: 4 | Train Loss: 0.229 Vali Loss: 1.130 Vali Acc: 0.500 Test Loss: 1.130 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.071547269821167
Epoch: 20, Steps: 4 | Train Loss: 0.220 Vali Loss: 1.120 Vali Acc: 0.520 Test Loss: 1.120 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.0921332836151123
Epoch: 21, Steps: 4 | Train Loss: 0.201 Vali Loss: 1.182 Vali Acc: 0.540 Test Loss: 1.182 Test Acc: 0.540
Validation loss decreased (-0.519989 --> -0.539988).  Saving model ...
Epoch: 22 cost time: 1.2172222137451172
Epoch: 22, Steps: 4 | Train Loss: 0.191 Vali Loss: 1.114 Vali Acc: 0.500 Test Loss: 1.114 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.2120537757873535
Epoch: 23, Steps: 4 | Train Loss: 0.143 Vali Loss: 1.086 Vali Acc: 0.500 Test Loss: 1.086 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.1934452056884766
Epoch: 24, Steps: 4 | Train Loss: 0.159 Vali Loss: 1.099 Vali Acc: 0.480 Test Loss: 1.099 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.2747836112976074
Epoch: 25, Steps: 4 | Train Loss: 0.091 Vali Loss: 1.138 Vali Acc: 0.520 Test Loss: 1.138 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.2730846405029297
Epoch: 26, Steps: 4 | Train Loss: 0.099 Vali Loss: 1.169 Vali Acc: 0.560 Test Loss: 1.169 Test Acc: 0.560
Validation loss decreased (-0.539988 --> -0.559988).  Saving model ...
Epoch: 27 cost time: 1.1200900077819824
Epoch: 27, Steps: 4 | Train Loss: 0.176 Vali Loss: 1.178 Vali Acc: 0.560 Test Loss: 1.178 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.285973310470581
Epoch: 28, Steps: 4 | Train Loss: 0.079 Vali Loss: 1.191 Vali Acc: 0.580 Test Loss: 1.191 Test Acc: 0.580
Validation loss decreased (-0.559988 --> -0.579988).  Saving model ...
Epoch: 29 cost time: 1.1283063888549805
Epoch: 29, Steps: 4 | Train Loss: 0.065 Vali Loss: 1.310 Vali Acc: 0.500 Test Loss: 1.310 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.1717801094055176
Epoch: 30, Steps: 4 | Train Loss: 0.062 Vali Loss: 1.234 Vali Acc: 0.560 Test Loss: 1.234 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm16_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 258677
model size : 1.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm16_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.406838893890381
Epoch: 1, Steps: 4 | Train Loss: 1.838 Vali Loss: 1.656 Vali Acc: 0.180 Test Loss: 1.656 Test Acc: 0.180
Validation loss decreased (inf --> -0.179983).  Saving model ...
Epoch: 2 cost time: 1.413813591003418
Epoch: 2, Steps: 4 | Train Loss: 1.717 Vali Loss: 1.633 Vali Acc: 0.220 Test Loss: 1.633 Test Acc: 0.220
Validation loss decreased (-0.179983 --> -0.219984).  Saving model ...
Epoch: 3 cost time: 1.3559119701385498
Epoch: 3, Steps: 4 | Train Loss: 1.592 Vali Loss: 1.598 Vali Acc: 0.300 Test Loss: 1.598 Test Acc: 0.300
Validation loss decreased (-0.219984 --> -0.299984).  Saving model ...
Epoch: 4 cost time: 1.4787266254425049
Epoch: 4, Steps: 4 | Train Loss: 1.555 Vali Loss: 1.567 Vali Acc: 0.320 Test Loss: 1.567 Test Acc: 0.320
Validation loss decreased (-0.299984 --> -0.319984).  Saving model ...
Epoch: 5 cost time: 1.4869282245635986
Epoch: 5, Steps: 4 | Train Loss: 1.484 Vali Loss: 1.548 Vali Acc: 0.380 Test Loss: 1.548 Test Acc: 0.380
Validation loss decreased (-0.319984 --> -0.379985).  Saving model ...
Epoch: 6 cost time: 1.4352240562438965
Epoch: 6, Steps: 4 | Train Loss: 1.327 Vali Loss: 1.529 Vali Acc: 0.360 Test Loss: 1.529 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.492478609085083
Epoch: 7, Steps: 4 | Train Loss: 1.332 Vali Loss: 1.496 Vali Acc: 0.360 Test Loss: 1.496 Test Acc: 0.360
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.3932316303253174
Epoch: 8, Steps: 4 | Train Loss: 1.126 Vali Loss: 1.448 Vali Acc: 0.360 Test Loss: 1.448 Test Acc: 0.360
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.5485050678253174
Epoch: 9, Steps: 4 | Train Loss: 1.019 Vali Loss: 1.403 Vali Acc: 0.420 Test Loss: 1.403 Test Acc: 0.420
Validation loss decreased (-0.379985 --> -0.419986).  Saving model ...
Epoch: 10 cost time: 1.6046655178070068
Epoch: 10, Steps: 4 | Train Loss: 1.022 Vali Loss: 1.354 Vali Acc: 0.500 Test Loss: 1.354 Test Acc: 0.500
Validation loss decreased (-0.419986 --> -0.499986).  Saving model ...
Epoch: 11 cost time: 1.5733623504638672
Epoch: 11, Steps: 4 | Train Loss: 0.777 Vali Loss: 1.291 Vali Acc: 0.480 Test Loss: 1.291 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.568183183670044
Epoch: 12, Steps: 4 | Train Loss: 0.726 Vali Loss: 1.239 Vali Acc: 0.480 Test Loss: 1.239 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.579941987991333
Epoch: 13, Steps: 4 | Train Loss: 0.666 Vali Loss: 1.186 Vali Acc: 0.500 Test Loss: 1.186 Test Acc: 0.500
Validation loss decreased (-0.499986 --> -0.499988).  Saving model ...
Epoch: 14 cost time: 1.474977731704712
Epoch: 14, Steps: 4 | Train Loss: 0.886 Vali Loss: 1.140 Vali Acc: 0.500 Test Loss: 1.140 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499989).  Saving model ...
Epoch: 15 cost time: 1.4025638103485107
Epoch: 15, Steps: 4 | Train Loss: 0.513 Vali Loss: 1.089 Vali Acc: 0.480 Test Loss: 1.089 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.4561569690704346
Epoch: 16, Steps: 4 | Train Loss: 0.625 Vali Loss: 1.104 Vali Acc: 0.480 Test Loss: 1.104 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.4872524738311768
Epoch: 17, Steps: 4 | Train Loss: 0.363 Vali Loss: 1.120 Vali Acc: 0.500 Test Loss: 1.120 Test Acc: 0.500
Validation loss decreased (-0.499989 --> -0.499989).  Saving model ...
Epoch: 18 cost time: 1.4402034282684326
Epoch: 18, Steps: 4 | Train Loss: 0.460 Vali Loss: 1.079 Vali Acc: 0.500 Test Loss: 1.079 Test Acc: 0.500
Validation loss decreased (-0.499989 --> -0.499989).  Saving model ...
Epoch: 19 cost time: 1.4023616313934326
Epoch: 19, Steps: 4 | Train Loss: 0.229 Vali Loss: 1.043 Vali Acc: 0.520 Test Loss: 1.043 Test Acc: 0.520
Validation loss decreased (-0.499989 --> -0.519990).  Saving model ...
Epoch: 20 cost time: 1.4048147201538086
Epoch: 20, Steps: 4 | Train Loss: 0.236 Vali Loss: 1.040 Vali Acc: 0.560 Test Loss: 1.040 Test Acc: 0.560
Validation loss decreased (-0.519990 --> -0.559990).  Saving model ...
Epoch: 21 cost time: 1.5154924392700195
Epoch: 21, Steps: 4 | Train Loss: 0.193 Vali Loss: 1.133 Vali Acc: 0.520 Test Loss: 1.133 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.475243330001831
Epoch: 22, Steps: 4 | Train Loss: 0.241 Vali Loss: 1.158 Vali Acc: 0.480 Test Loss: 1.158 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.40041184425354
Epoch: 23, Steps: 4 | Train Loss: 0.123 Vali Loss: 1.109 Vali Acc: 0.540 Test Loss: 1.109 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.4055774211883545
Epoch: 24, Steps: 4 | Train Loss: 0.108 Vali Loss: 1.136 Vali Acc: 0.600 Test Loss: 1.136 Test Acc: 0.600
Validation loss decreased (-0.559990 --> -0.599989).  Saving model ...
Epoch: 25 cost time: 1.356919527053833
Epoch: 25, Steps: 4 | Train Loss: 0.106 Vali Loss: 1.161 Vali Acc: 0.500 Test Loss: 1.161 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.4464809894561768
Epoch: 26, Steps: 4 | Train Loss: 0.083 Vali Loss: 1.270 Vali Acc: 0.500 Test Loss: 1.270 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.4636170864105225
Epoch: 27, Steps: 4 | Train Loss: 0.111 Vali Loss: 1.286 Vali Acc: 0.520 Test Loss: 1.286 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.4001412391662598
Epoch: 28, Steps: 4 | Train Loss: 0.061 Vali Loss: 1.287 Vali Acc: 0.560 Test Loss: 1.287 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.4336483478546143
Epoch: 29, Steps: 4 | Train Loss: 0.055 Vali Loss: 1.245 Vali Acc: 0.580 Test Loss: 1.245 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.4096479415893555
Epoch: 30, Steps: 4 | Train Loss: 0.076 Vali Loss: 1.179 Vali Acc: 0.580 Test Loss: 1.179 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm16_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 672565
model size : 2.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm16_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.1966216564178467
Epoch: 1, Steps: 4 | Train Loss: 1.610 Vali Loss: 1.555 Vali Acc: 0.220 Test Loss: 1.555 Test Acc: 0.220
Validation loss decreased (inf --> -0.219984).  Saving model ...
Epoch: 2 cost time: 1.3239271640777588
Epoch: 2, Steps: 4 | Train Loss: 1.603 Vali Loss: 1.545 Vali Acc: 0.240 Test Loss: 1.545 Test Acc: 0.240
Validation loss decreased (-0.219984 --> -0.239985).  Saving model ...
Epoch: 3 cost time: 1.5737535953521729
Epoch: 3, Steps: 4 | Train Loss: 1.486 Vali Loss: 1.529 Vali Acc: 0.280 Test Loss: 1.529 Test Acc: 0.280
Validation loss decreased (-0.239985 --> -0.279985).  Saving model ...
Epoch: 4 cost time: 1.2224857807159424
Epoch: 4, Steps: 4 | Train Loss: 1.391 Vali Loss: 1.508 Vali Acc: 0.300 Test Loss: 1.508 Test Acc: 0.300
Validation loss decreased (-0.279985 --> -0.299985).  Saving model ...
Epoch: 5 cost time: 1.2640016078948975
Epoch: 5, Steps: 4 | Train Loss: 1.370 Vali Loss: 1.485 Vali Acc: 0.280 Test Loss: 1.485 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3314054012298584
Epoch: 6, Steps: 4 | Train Loss: 1.342 Vali Loss: 1.450 Vali Acc: 0.360 Test Loss: 1.450 Test Acc: 0.360
Validation loss decreased (-0.299985 --> -0.359985).  Saving model ...
Epoch: 7 cost time: 1.2456698417663574
Epoch: 7, Steps: 4 | Train Loss: 1.188 Vali Loss: 1.411 Vali Acc: 0.380 Test Loss: 1.411 Test Acc: 0.380
Validation loss decreased (-0.359985 --> -0.379986).  Saving model ...
Epoch: 8 cost time: 1.2182567119598389
Epoch: 8, Steps: 4 | Train Loss: 1.043 Vali Loss: 1.363 Vali Acc: 0.380 Test Loss: 1.363 Test Acc: 0.380
Validation loss decreased (-0.379986 --> -0.379986).  Saving model ...
Epoch: 9 cost time: 1.2032618522644043
Epoch: 9, Steps: 4 | Train Loss: 0.966 Vali Loss: 1.334 Vali Acc: 0.400 Test Loss: 1.334 Test Acc: 0.400
Validation loss decreased (-0.379986 --> -0.399987).  Saving model ...
Epoch: 10 cost time: 1.1746938228607178
Epoch: 10, Steps: 4 | Train Loss: 0.943 Vali Loss: 1.291 Vali Acc: 0.400 Test Loss: 1.291 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 11 cost time: 1.2849397659301758
Epoch: 11, Steps: 4 | Train Loss: 0.862 Vali Loss: 1.244 Vali Acc: 0.420 Test Loss: 1.244 Test Acc: 0.420
Validation loss decreased (-0.399987 --> -0.419988).  Saving model ...
Epoch: 12 cost time: 1.2917370796203613
Epoch: 12, Steps: 4 | Train Loss: 0.678 Vali Loss: 1.206 Vali Acc: 0.420 Test Loss: 1.206 Test Acc: 0.420
Validation loss decreased (-0.419988 --> -0.419988).  Saving model ...
Epoch: 13 cost time: 1.2995615005493164
Epoch: 13, Steps: 4 | Train Loss: 0.672 Vali Loss: 1.152 Vali Acc: 0.460 Test Loss: 1.152 Test Acc: 0.460
Validation loss decreased (-0.419988 --> -0.459988).  Saving model ...
Epoch: 14 cost time: 1.4196057319641113
Epoch: 14, Steps: 4 | Train Loss: 0.545 Vali Loss: 1.142 Vali Acc: 0.500 Test Loss: 1.142 Test Acc: 0.500
Validation loss decreased (-0.459988 --> -0.499989).  Saving model ...
Epoch: 15 cost time: 1.2870817184448242
Epoch: 15, Steps: 4 | Train Loss: 0.389 Vali Loss: 1.117 Vali Acc: 0.480 Test Loss: 1.117 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2978618144989014
Epoch: 16, Steps: 4 | Train Loss: 0.403 Vali Loss: 1.105 Vali Acc: 0.500 Test Loss: 1.105 Test Acc: 0.500
Validation loss decreased (-0.499989 --> -0.499989).  Saving model ...
Epoch: 17 cost time: 1.310697317123413
Epoch: 17, Steps: 4 | Train Loss: 0.547 Vali Loss: 1.135 Vali Acc: 0.480 Test Loss: 1.135 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2544798851013184
Epoch: 18, Steps: 4 | Train Loss: 0.357 Vali Loss: 1.076 Vali Acc: 0.500 Test Loss: 1.076 Test Acc: 0.500
Validation loss decreased (-0.499989 --> -0.499989).  Saving model ...
Epoch: 19 cost time: 1.4492175579071045
Epoch: 19, Steps: 4 | Train Loss: 0.233 Vali Loss: 1.110 Vali Acc: 0.500 Test Loss: 1.110 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.2462272644042969
Epoch: 20, Steps: 4 | Train Loss: 0.225 Vali Loss: 1.095 Vali Acc: 0.500 Test Loss: 1.095 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.2915890216827393
Epoch: 21, Steps: 4 | Train Loss: 0.199 Vali Loss: 1.133 Vali Acc: 0.540 Test Loss: 1.133 Test Acc: 0.540
Validation loss decreased (-0.499989 --> -0.539989).  Saving model ...
Epoch: 22 cost time: 1.2733261585235596
Epoch: 22, Steps: 4 | Train Loss: 0.193 Vali Loss: 1.065 Vali Acc: 0.520 Test Loss: 1.065 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.2152965068817139
Epoch: 23, Steps: 4 | Train Loss: 0.144 Vali Loss: 1.038 Vali Acc: 0.540 Test Loss: 1.038 Test Acc: 0.540
Validation loss decreased (-0.539989 --> -0.539990).  Saving model ...
Epoch: 24 cost time: 1.3217573165893555
Epoch: 24, Steps: 4 | Train Loss: 0.162 Vali Loss: 1.042 Vali Acc: 0.520 Test Loss: 1.042 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.2195048332214355
Epoch: 25, Steps: 4 | Train Loss: 0.092 Vali Loss: 1.073 Vali Acc: 0.540 Test Loss: 1.073 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.228156328201294
Epoch: 26, Steps: 4 | Train Loss: 0.100 Vali Loss: 1.095 Vali Acc: 0.580 Test Loss: 1.095 Test Acc: 0.580
Validation loss decreased (-0.539990 --> -0.579989).  Saving model ...
Epoch: 27 cost time: 1.345519781112671
Epoch: 27, Steps: 4 | Train Loss: 0.186 Vali Loss: 1.103 Vali Acc: 0.580 Test Loss: 1.103 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.3393425941467285
Epoch: 28, Steps: 4 | Train Loss: 0.080 Vali Loss: 1.115 Vali Acc: 0.600 Test Loss: 1.115 Test Acc: 0.600
Validation loss decreased (-0.579989 --> -0.599989).  Saving model ...
Epoch: 29 cost time: 1.3332290649414062
Epoch: 29, Steps: 4 | Train Loss: 0.066 Vali Loss: 1.211 Vali Acc: 0.560 Test Loss: 1.211 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.281073808670044
Epoch: 30, Steps: 4 | Train Loss: 0.064 Vali Loss: 1.148 Vali Acc: 0.540 Test Loss: 1.148 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm16_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 258677
model size : 1.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm16_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.5450937747955322
Epoch: 1, Steps: 4 | Train Loss: 1.833 Vali Loss: 1.656 Vali Acc: 0.180 Test Loss: 1.656 Test Acc: 0.180
Validation loss decreased (inf --> -0.179983).  Saving model ...
Epoch: 2 cost time: 1.4820027351379395
Epoch: 2, Steps: 4 | Train Loss: 1.721 Vali Loss: 1.634 Vali Acc: 0.220 Test Loss: 1.634 Test Acc: 0.220
Validation loss decreased (-0.179983 --> -0.219984).  Saving model ...
Epoch: 3 cost time: 1.3953142166137695
Epoch: 3, Steps: 4 | Train Loss: 1.591 Vali Loss: 1.599 Vali Acc: 0.300 Test Loss: 1.599 Test Acc: 0.300
Validation loss decreased (-0.219984 --> -0.299984).  Saving model ...
Epoch: 4 cost time: 1.4526503086090088
Epoch: 4, Steps: 4 | Train Loss: 1.550 Vali Loss: 1.569 Vali Acc: 0.320 Test Loss: 1.569 Test Acc: 0.320
Validation loss decreased (-0.299984 --> -0.319984).  Saving model ...
Epoch: 5 cost time: 1.4550344944000244
Epoch: 5, Steps: 4 | Train Loss: 1.492 Vali Loss: 1.550 Vali Acc: 0.380 Test Loss: 1.550 Test Acc: 0.380
Validation loss decreased (-0.319984 --> -0.379985).  Saving model ...
Epoch: 6 cost time: 1.3747098445892334
Epoch: 6, Steps: 4 | Train Loss: 1.331 Vali Loss: 1.530 Vali Acc: 0.340 Test Loss: 1.530 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4774248600006104
Epoch: 7, Steps: 4 | Train Loss: 1.338 Vali Loss: 1.496 Vali Acc: 0.360 Test Loss: 1.496 Test Acc: 0.360
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.4355781078338623
Epoch: 8, Steps: 4 | Train Loss: 1.138 Vali Loss: 1.449 Vali Acc: 0.380 Test Loss: 1.449 Test Acc: 0.380
Validation loss decreased (-0.379985 --> -0.379986).  Saving model ...
Epoch: 9 cost time: 1.4342708587646484
Epoch: 9, Steps: 4 | Train Loss: 1.035 Vali Loss: 1.405 Vali Acc: 0.420 Test Loss: 1.405 Test Acc: 0.420
Validation loss decreased (-0.379986 --> -0.419986).  Saving model ...
Epoch: 10 cost time: 1.434279203414917
Epoch: 10, Steps: 4 | Train Loss: 1.039 Vali Loss: 1.357 Vali Acc: 0.500 Test Loss: 1.357 Test Acc: 0.500
Validation loss decreased (-0.419986 --> -0.499986).  Saving model ...
Epoch: 11 cost time: 1.2848856449127197
Epoch: 11, Steps: 4 | Train Loss: 0.797 Vali Loss: 1.296 Vali Acc: 0.500 Test Loss: 1.296 Test Acc: 0.500
Validation loss decreased (-0.499986 --> -0.499987).  Saving model ...
Epoch: 12 cost time: 1.5069925785064697
Epoch: 12, Steps: 4 | Train Loss: 0.736 Vali Loss: 1.243 Vali Acc: 0.480 Test Loss: 1.243 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4645259380340576
Epoch: 13, Steps: 4 | Train Loss: 0.696 Vali Loss: 1.191 Vali Acc: 0.540 Test Loss: 1.191 Test Acc: 0.540
Validation loss decreased (-0.499987 --> -0.539988).  Saving model ...
Epoch: 14 cost time: 1.63161301612854
Epoch: 14, Steps: 4 | Train Loss: 0.893 Vali Loss: 1.152 Vali Acc: 0.520 Test Loss: 1.152 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4131622314453125
Epoch: 15, Steps: 4 | Train Loss: 0.544 Vali Loss: 1.101 Vali Acc: 0.500 Test Loss: 1.101 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.6115002632141113
Epoch: 16, Steps: 4 | Train Loss: 0.655 Vali Loss: 1.110 Vali Acc: 0.480 Test Loss: 1.110 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.4679217338562012
Epoch: 17, Steps: 4 | Train Loss: 0.376 Vali Loss: 1.130 Vali Acc: 0.480 Test Loss: 1.130 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.5026934146881104
Epoch: 18, Steps: 4 | Train Loss: 0.487 Vali Loss: 1.089 Vali Acc: 0.500 Test Loss: 1.089 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.4810118675231934
Epoch: 19, Steps: 4 | Train Loss: 0.245 Vali Loss: 1.034 Vali Acc: 0.520 Test Loss: 1.034 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.5698468685150146
Epoch: 20, Steps: 4 | Train Loss: 0.251 Vali Loss: 1.016 Vali Acc: 0.540 Test Loss: 1.016 Test Acc: 0.540
Validation loss decreased (-0.539988 --> -0.539990).  Saving model ...
Epoch: 21 cost time: 1.4647245407104492
Epoch: 21, Steps: 4 | Train Loss: 0.228 Vali Loss: 1.078 Vali Acc: 0.480 Test Loss: 1.078 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.5239357948303223
Epoch: 22, Steps: 4 | Train Loss: 0.232 Vali Loss: 1.085 Vali Acc: 0.460 Test Loss: 1.085 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.3723981380462646
Epoch: 23, Steps: 4 | Train Loss: 0.126 Vali Loss: 1.091 Vali Acc: 0.480 Test Loss: 1.091 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.5001792907714844
Epoch: 24, Steps: 4 | Train Loss: 0.121 Vali Loss: 1.034 Vali Acc: 0.580 Test Loss: 1.034 Test Acc: 0.580
Validation loss decreased (-0.539990 --> -0.579990).  Saving model ...
Epoch: 25 cost time: 1.3868465423583984
Epoch: 25, Steps: 4 | Train Loss: 0.127 Vali Loss: 1.041 Vali Acc: 0.540 Test Loss: 1.041 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.5095362663269043
Epoch: 26, Steps: 4 | Train Loss: 0.105 Vali Loss: 1.173 Vali Acc: 0.480 Test Loss: 1.173 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.5506882667541504
Epoch: 27, Steps: 4 | Train Loss: 0.105 Vali Loss: 1.141 Vali Acc: 0.460 Test Loss: 1.141 Test Acc: 0.460
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.4390180110931396
Epoch: 28, Steps: 4 | Train Loss: 0.066 Vali Loss: 1.088 Vali Acc: 0.520 Test Loss: 1.088 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.4490070343017578
Epoch: 29, Steps: 4 | Train Loss: 0.062 Vali Loss: 1.067 Vali Acc: 0.520 Test Loss: 1.067 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.5308148860931396
Epoch: 30, Steps: 4 | Train Loss: 0.072 Vali Loss: 1.039 Vali Acc: 0.500 Test Loss: 1.039 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm16_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 672565
model size : 2.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm16_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.5450847148895264
Epoch: 1, Steps: 4 | Train Loss: 1.609 Vali Loss: 1.552 Vali Acc: 0.200 Test Loss: 1.552 Test Acc: 0.200
Validation loss decreased (inf --> -0.199984).  Saving model ...
Epoch: 2 cost time: 1.2154393196105957
Epoch: 2, Steps: 4 | Train Loss: 1.599 Vali Loss: 1.541 Vali Acc: 0.260 Test Loss: 1.541 Test Acc: 0.260
Validation loss decreased (-0.199984 --> -0.259985).  Saving model ...
Epoch: 3 cost time: 1.3006951808929443
Epoch: 3, Steps: 4 | Train Loss: 1.482 Vali Loss: 1.525 Vali Acc: 0.300 Test Loss: 1.525 Test Acc: 0.300
Validation loss decreased (-0.259985 --> -0.299985).  Saving model ...
Epoch: 4 cost time: 1.3505187034606934
Epoch: 4, Steps: 4 | Train Loss: 1.387 Vali Loss: 1.503 Vali Acc: 0.320 Test Loss: 1.503 Test Acc: 0.320
Validation loss decreased (-0.299985 --> -0.319985).  Saving model ...
Epoch: 5 cost time: 1.4052212238311768
Epoch: 5, Steps: 4 | Train Loss: 1.370 Vali Loss: 1.480 Vali Acc: 0.320 Test Loss: 1.480 Test Acc: 0.320
Validation loss decreased (-0.319985 --> -0.319985).  Saving model ...
Epoch: 6 cost time: 1.3374958038330078
Epoch: 6, Steps: 4 | Train Loss: 1.343 Vali Loss: 1.445 Vali Acc: 0.360 Test Loss: 1.445 Test Acc: 0.360
Validation loss decreased (-0.319985 --> -0.359986).  Saving model ...
Epoch: 7 cost time: 1.120584487915039
Epoch: 7, Steps: 4 | Train Loss: 1.187 Vali Loss: 1.406 Vali Acc: 0.400 Test Loss: 1.406 Test Acc: 0.400
Validation loss decreased (-0.359986 --> -0.399986).  Saving model ...
Epoch: 8 cost time: 1.3013887405395508
Epoch: 8, Steps: 4 | Train Loss: 1.042 Vali Loss: 1.362 Vali Acc: 0.380 Test Loss: 1.362 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2961184978485107
Epoch: 9, Steps: 4 | Train Loss: 0.965 Vali Loss: 1.334 Vali Acc: 0.400 Test Loss: 1.334 Test Acc: 0.400
Validation loss decreased (-0.399986 --> -0.399987).  Saving model ...
Epoch: 10 cost time: 1.3819694519042969
Epoch: 10, Steps: 4 | Train Loss: 0.942 Vali Loss: 1.292 Vali Acc: 0.400 Test Loss: 1.292 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 11 cost time: 1.1571428775787354
Epoch: 11, Steps: 4 | Train Loss: 0.870 Vali Loss: 1.243 Vali Acc: 0.440 Test Loss: 1.243 Test Acc: 0.440
Validation loss decreased (-0.399987 --> -0.439988).  Saving model ...
Epoch: 12 cost time: 1.2643775939941406
Epoch: 12, Steps: 4 | Train Loss: 0.676 Vali Loss: 1.203 Vali Acc: 0.420 Test Loss: 1.203 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3476402759552002
Epoch: 13, Steps: 4 | Train Loss: 0.676 Vali Loss: 1.143 Vali Acc: 0.480 Test Loss: 1.143 Test Acc: 0.480
Validation loss decreased (-0.439988 --> -0.479989).  Saving model ...
Epoch: 14 cost time: 1.2513830661773682
Epoch: 14, Steps: 4 | Train Loss: 0.552 Vali Loss: 1.133 Vali Acc: 0.520 Test Loss: 1.133 Test Acc: 0.520
Validation loss decreased (-0.479989 --> -0.519989).  Saving model ...
Epoch: 15 cost time: 1.2905659675598145
Epoch: 15, Steps: 4 | Train Loss: 0.394 Vali Loss: 1.108 Vali Acc: 0.480 Test Loss: 1.108 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1903812885284424
Epoch: 16, Steps: 4 | Train Loss: 0.406 Vali Loss: 1.090 Vali Acc: 0.520 Test Loss: 1.090 Test Acc: 0.520
Validation loss decreased (-0.519989 --> -0.519989).  Saving model ...
Epoch: 17 cost time: 1.2746450901031494
Epoch: 17, Steps: 4 | Train Loss: 0.543 Vali Loss: 1.113 Vali Acc: 0.500 Test Loss: 1.113 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1442909240722656
Epoch: 18, Steps: 4 | Train Loss: 0.354 Vali Loss: 1.060 Vali Acc: 0.500 Test Loss: 1.060 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.2046663761138916
Epoch: 19, Steps: 4 | Train Loss: 0.244 Vali Loss: 1.105 Vali Acc: 0.540 Test Loss: 1.105 Test Acc: 0.540
Validation loss decreased (-0.519989 --> -0.539989).  Saving model ...
Epoch: 20 cost time: 1.2704918384552002
Epoch: 20, Steps: 4 | Train Loss: 0.240 Vali Loss: 1.092 Vali Acc: 0.520 Test Loss: 1.092 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.110851526260376
Epoch: 21, Steps: 4 | Train Loss: 0.199 Vali Loss: 1.154 Vali Acc: 0.540 Test Loss: 1.154 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.2163856029510498
Epoch: 22, Steps: 4 | Train Loss: 0.191 Vali Loss: 1.062 Vali Acc: 0.580 Test Loss: 1.062 Test Acc: 0.580
Validation loss decreased (-0.539989 --> -0.579989).  Saving model ...
Epoch: 23 cost time: 1.168332576751709
Epoch: 23, Steps: 4 | Train Loss: 0.150 Vali Loss: 1.014 Vali Acc: 0.540 Test Loss: 1.014 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.2027390003204346
Epoch: 24, Steps: 4 | Train Loss: 0.167 Vali Loss: 1.030 Vali Acc: 0.520 Test Loss: 1.030 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.1472041606903076
Epoch: 25, Steps: 4 | Train Loss: 0.095 Vali Loss: 1.073 Vali Acc: 0.600 Test Loss: 1.073 Test Acc: 0.600
Validation loss decreased (-0.579989 --> -0.599989).  Saving model ...
Epoch: 26 cost time: 1.1929171085357666
Epoch: 26, Steps: 4 | Train Loss: 0.103 Vali Loss: 1.087 Vali Acc: 0.540 Test Loss: 1.087 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.1933393478393555
Epoch: 27, Steps: 4 | Train Loss: 0.183 Vali Loss: 1.080 Vali Acc: 0.560 Test Loss: 1.080 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.2187950611114502
Epoch: 28, Steps: 4 | Train Loss: 0.083 Vali Loss: 1.107 Vali Acc: 0.580 Test Loss: 1.107 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.101064682006836
Epoch: 29, Steps: 4 | Train Loss: 0.070 Vali Loss: 1.205 Vali Acc: 0.560 Test Loss: 1.205 Test Acc: 0.560
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.3147449493408203
Epoch: 30, Steps: 4 | Train Loss: 0.064 Vali Loss: 1.099 Vali Acc: 0.560 Test Loss: 1.099 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm16_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 258677
model size : 1.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm16_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.469831943511963
Epoch: 1, Steps: 4 | Train Loss: 1.674 Vali Loss: 1.629 Vali Acc: 0.200 Test Loss: 1.629 Test Acc: 0.200
Validation loss decreased (inf --> -0.199984).  Saving model ...
Epoch: 2 cost time: 1.4649548530578613
Epoch: 2, Steps: 4 | Train Loss: 1.608 Vali Loss: 1.621 Vali Acc: 0.240 Test Loss: 1.621 Test Acc: 0.240
Validation loss decreased (-0.199984 --> -0.239984).  Saving model ...
Epoch: 3 cost time: 1.5495238304138184
Epoch: 3, Steps: 4 | Train Loss: 1.522 Vali Loss: 1.609 Vali Acc: 0.300 Test Loss: 1.609 Test Acc: 0.300
Validation loss decreased (-0.239984 --> -0.299984).  Saving model ...
Epoch: 4 cost time: 1.4670219421386719
Epoch: 4, Steps: 4 | Train Loss: 1.503 Vali Loss: 1.600 Vali Acc: 0.320 Test Loss: 1.600 Test Acc: 0.320
Validation loss decreased (-0.299984 --> -0.319984).  Saving model ...
Epoch: 5 cost time: 1.6003737449645996
Epoch: 5, Steps: 4 | Train Loss: 1.568 Vali Loss: 1.583 Vali Acc: 0.300 Test Loss: 1.583 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6393048763275146
Epoch: 6, Steps: 4 | Train Loss: 1.205 Vali Loss: 1.543 Vali Acc: 0.300 Test Loss: 1.543 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.5871002674102783
Epoch: 7, Steps: 4 | Train Loss: 1.312 Vali Loss: 1.499 Vali Acc: 0.320 Test Loss: 1.499 Test Acc: 0.320
Validation loss decreased (-0.319984 --> -0.319985).  Saving model ...
Epoch: 8 cost time: 1.617748498916626
Epoch: 8, Steps: 4 | Train Loss: 1.174 Vali Loss: 1.450 Vali Acc: 0.360 Test Loss: 1.450 Test Acc: 0.360
Validation loss decreased (-0.319985 --> -0.359985).  Saving model ...
Epoch: 9 cost time: 1.487018346786499
Epoch: 9, Steps: 4 | Train Loss: 1.055 Vali Loss: 1.397 Vali Acc: 0.400 Test Loss: 1.397 Test Acc: 0.400
Validation loss decreased (-0.359985 --> -0.399986).  Saving model ...
Epoch: 10 cost time: 1.5557262897491455
Epoch: 10, Steps: 4 | Train Loss: 0.883 Vali Loss: 1.343 Vali Acc: 0.440 Test Loss: 1.343 Test Acc: 0.440
Validation loss decreased (-0.399986 --> -0.439987).  Saving model ...
Epoch: 11 cost time: 1.5638229846954346
Epoch: 11, Steps: 4 | Train Loss: 0.859 Vali Loss: 1.290 Vali Acc: 0.480 Test Loss: 1.290 Test Acc: 0.480
Validation loss decreased (-0.439987 --> -0.479987).  Saving model ...
Epoch: 12 cost time: 1.3558933734893799
Epoch: 12, Steps: 4 | Train Loss: 0.679 Vali Loss: 1.239 Vali Acc: 0.440 Test Loss: 1.239 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.473595380783081
Epoch: 13, Steps: 4 | Train Loss: 0.569 Vali Loss: 1.222 Vali Acc: 0.400 Test Loss: 1.222 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.5426952838897705
Epoch: 14, Steps: 4 | Train Loss: 0.568 Vali Loss: 1.182 Vali Acc: 0.440 Test Loss: 1.182 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.6180405616760254
Epoch: 15, Steps: 4 | Train Loss: 0.546 Vali Loss: 1.125 Vali Acc: 0.480 Test Loss: 1.125 Test Acc: 0.480
Validation loss decreased (-0.479987 --> -0.479989).  Saving model ...
Epoch: 16 cost time: 1.6039438247680664
Epoch: 16, Steps: 4 | Train Loss: 0.377 Vali Loss: 1.111 Vali Acc: 0.420 Test Loss: 1.111 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.6974220275878906
Epoch: 17, Steps: 4 | Train Loss: 0.365 Vali Loss: 1.071 Vali Acc: 0.520 Test Loss: 1.071 Test Acc: 0.520
Validation loss decreased (-0.479989 --> -0.519989).  Saving model ...
Epoch: 18 cost time: 1.570969820022583
Epoch: 18, Steps: 4 | Train Loss: 0.308 Vali Loss: 1.057 Vali Acc: 0.540 Test Loss: 1.057 Test Acc: 0.540
Validation loss decreased (-0.519989 --> -0.539989).  Saving model ...
Epoch: 19 cost time: 1.6632342338562012
Epoch: 19, Steps: 4 | Train Loss: 0.231 Vali Loss: 1.095 Vali Acc: 0.540 Test Loss: 1.095 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.4455349445343018
Epoch: 20, Steps: 4 | Train Loss: 0.244 Vali Loss: 1.111 Vali Acc: 0.480 Test Loss: 1.111 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.6465778350830078
Epoch: 21, Steps: 4 | Train Loss: 0.211 Vali Loss: 1.203 Vali Acc: 0.520 Test Loss: 1.203 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.683589220046997
Epoch: 22, Steps: 4 | Train Loss: 0.193 Vali Loss: 1.195 Vali Acc: 0.540 Test Loss: 1.195 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.5604438781738281
Epoch: 23, Steps: 4 | Train Loss: 0.167 Vali Loss: 1.197 Vali Acc: 0.460 Test Loss: 1.197 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.6362426280975342
Epoch: 24, Steps: 4 | Train Loss: 0.114 Vali Loss: 1.210 Vali Acc: 0.480 Test Loss: 1.210 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.6093940734863281
Epoch: 25, Steps: 4 | Train Loss: 0.102 Vali Loss: 1.187 Vali Acc: 0.520 Test Loss: 1.187 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.6331470012664795
Epoch: 26, Steps: 4 | Train Loss: 0.088 Vali Loss: 1.156 Vali Acc: 0.520 Test Loss: 1.156 Test Acc: 0.520
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.5853168964385986
Epoch: 27, Steps: 4 | Train Loss: 0.083 Vali Loss: 1.098 Vali Acc: 0.500 Test Loss: 1.098 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.5228173732757568
Epoch: 28, Steps: 4 | Train Loss: 0.109 Vali Loss: 1.116 Vali Acc: 0.480 Test Loss: 1.116 Test Acc: 0.480
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm16_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 379509
model size : 1.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm16_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.5693538188934326
Epoch: 1, Steps: 4 | Train Loss: 1.649 Vali Loss: 1.544 Vali Acc: 0.240 Test Loss: 1.544 Test Acc: 0.240
Validation loss decreased (inf --> -0.239985).  Saving model ...
Epoch: 2 cost time: 1.338634967803955
Epoch: 2, Steps: 4 | Train Loss: 1.676 Vali Loss: 1.528 Vali Acc: 0.260 Test Loss: 1.528 Test Acc: 0.260
Validation loss decreased (-0.239985 --> -0.259985).  Saving model ...
Epoch: 3 cost time: 1.3828163146972656
Epoch: 3, Steps: 4 | Train Loss: 1.603 Vali Loss: 1.509 Vali Acc: 0.320 Test Loss: 1.509 Test Acc: 0.320
Validation loss decreased (-0.259985 --> -0.319985).  Saving model ...
Epoch: 4 cost time: 1.4343950748443604
Epoch: 4, Steps: 4 | Train Loss: 1.449 Vali Loss: 1.499 Vali Acc: 0.400 Test Loss: 1.499 Test Acc: 0.400
Validation loss decreased (-0.319985 --> -0.399985).  Saving model ...
Epoch: 5 cost time: 1.3249988555908203
Epoch: 5, Steps: 4 | Train Loss: 1.367 Vali Loss: 1.500 Vali Acc: 0.400 Test Loss: 1.500 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2829837799072266
Epoch: 6, Steps: 4 | Train Loss: 1.313 Vali Loss: 1.494 Vali Acc: 0.400 Test Loss: 1.494 Test Acc: 0.400
Validation loss decreased (-0.399985 --> -0.399985).  Saving model ...
Epoch: 7 cost time: 1.3274421691894531
Epoch: 7, Steps: 4 | Train Loss: 1.141 Vali Loss: 1.488 Vali Acc: 0.380 Test Loss: 1.488 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2984492778778076
Epoch: 8, Steps: 4 | Train Loss: 1.220 Vali Loss: 1.472 Vali Acc: 0.400 Test Loss: 1.472 Test Acc: 0.400
Validation loss decreased (-0.399985 --> -0.399985).  Saving model ...
Epoch: 9 cost time: 1.4021403789520264
Epoch: 9, Steps: 4 | Train Loss: 1.144 Vali Loss: 1.417 Vali Acc: 0.480 Test Loss: 1.417 Test Acc: 0.480
Validation loss decreased (-0.399985 --> -0.479986).  Saving model ...
Epoch: 10 cost time: 1.3547275066375732
Epoch: 10, Steps: 4 | Train Loss: 0.900 Vali Loss: 1.344 Vali Acc: 0.480 Test Loss: 1.344 Test Acc: 0.480
Validation loss decreased (-0.479986 --> -0.479987).  Saving model ...
Epoch: 11 cost time: 1.2754566669464111
Epoch: 11, Steps: 4 | Train Loss: 0.731 Vali Loss: 1.272 Vali Acc: 0.500 Test Loss: 1.272 Test Acc: 0.500
Validation loss decreased (-0.479987 --> -0.499987).  Saving model ...
Epoch: 12 cost time: 1.3211231231689453
Epoch: 12, Steps: 4 | Train Loss: 0.703 Vali Loss: 1.217 Vali Acc: 0.420 Test Loss: 1.217 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3341460227966309
Epoch: 13, Steps: 4 | Train Loss: 0.659 Vali Loss: 1.202 Vali Acc: 0.480 Test Loss: 1.202 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.346778154373169
Epoch: 14, Steps: 4 | Train Loss: 0.503 Vali Loss: 1.175 Vali Acc: 0.480 Test Loss: 1.175 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.307969093322754
Epoch: 15, Steps: 4 | Train Loss: 0.531 Vali Loss: 1.151 Vali Acc: 0.500 Test Loss: 1.151 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499988).  Saving model ...
Epoch: 16 cost time: 1.2838339805603027
Epoch: 16, Steps: 4 | Train Loss: 0.430 Vali Loss: 1.123 Vali Acc: 0.500 Test Loss: 1.123 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499989).  Saving model ...
Epoch: 17 cost time: 1.359654426574707
Epoch: 17, Steps: 4 | Train Loss: 0.434 Vali Loss: 1.103 Vali Acc: 0.480 Test Loss: 1.103 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2791650295257568
Epoch: 18, Steps: 4 | Train Loss: 0.350 Vali Loss: 1.107 Vali Acc: 0.560 Test Loss: 1.107 Test Acc: 0.560
Validation loss decreased (-0.499989 --> -0.559989).  Saving model ...
Epoch: 19 cost time: 1.3551454544067383
Epoch: 19, Steps: 4 | Train Loss: 0.271 Vali Loss: 1.069 Vali Acc: 0.480 Test Loss: 1.069 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.388237476348877
Epoch: 20, Steps: 4 | Train Loss: 0.301 Vali Loss: 1.148 Vali Acc: 0.520 Test Loss: 1.148 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.3868374824523926
Epoch: 21, Steps: 4 | Train Loss: 0.190 Vali Loss: 1.125 Vali Acc: 0.520 Test Loss: 1.125 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.4312710762023926
Epoch: 22, Steps: 4 | Train Loss: 0.234 Vali Loss: 1.130 Vali Acc: 0.460 Test Loss: 1.130 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.3358426094055176
Epoch: 23, Steps: 4 | Train Loss: 0.277 Vali Loss: 1.113 Vali Acc: 0.500 Test Loss: 1.113 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.3904671669006348
Epoch: 24, Steps: 4 | Train Loss: 0.151 Vali Loss: 1.078 Vali Acc: 0.480 Test Loss: 1.078 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.313159704208374
Epoch: 25, Steps: 4 | Train Loss: 0.127 Vali Loss: 1.117 Vali Acc: 0.520 Test Loss: 1.117 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.5865461826324463
Epoch: 26, Steps: 4 | Train Loss: 0.106 Vali Loss: 1.093 Vali Acc: 0.460 Test Loss: 1.093 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.4080398082733154
Epoch: 27, Steps: 4 | Train Loss: 0.087 Vali Loss: 1.080 Vali Acc: 0.460 Test Loss: 1.080 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.5185835361480713
Epoch: 28, Steps: 4 | Train Loss: 0.075 Vali Loss: 1.106 Vali Acc: 0.460 Test Loss: 1.106 Test Acc: 0.460
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm16_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 172533
model size : 0.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm16_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.2704825401306152
Epoch: 1, Steps: 4 | Train Loss: 1.675 Vali Loss: 1.631 Vali Acc: 0.180 Test Loss: 1.631 Test Acc: 0.180
Validation loss decreased (inf --> -0.179984).  Saving model ...
Epoch: 2 cost time: 1.3704886436462402
Epoch: 2, Steps: 4 | Train Loss: 1.608 Vali Loss: 1.620 Vali Acc: 0.240 Test Loss: 1.620 Test Acc: 0.240
Validation loss decreased (-0.179984 --> -0.239984).  Saving model ...
Epoch: 3 cost time: 1.4552500247955322
Epoch: 3, Steps: 4 | Train Loss: 1.521 Vali Loss: 1.608 Vali Acc: 0.300 Test Loss: 1.608 Test Acc: 0.300
Validation loss decreased (-0.239984 --> -0.299984).  Saving model ...
Epoch: 4 cost time: 1.4192883968353271
Epoch: 4, Steps: 4 | Train Loss: 1.504 Vali Loss: 1.598 Vali Acc: 0.320 Test Loss: 1.598 Test Acc: 0.320
Validation loss decreased (-0.299984 --> -0.319984).  Saving model ...
Epoch: 5 cost time: 1.302711009979248
Epoch: 5, Steps: 4 | Train Loss: 1.570 Vali Loss: 1.581 Vali Acc: 0.300 Test Loss: 1.581 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.505300521850586
Epoch: 6, Steps: 4 | Train Loss: 1.207 Vali Loss: 1.539 Vali Acc: 0.300 Test Loss: 1.539 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.482877492904663
Epoch: 7, Steps: 4 | Train Loss: 1.316 Vali Loss: 1.491 Vali Acc: 0.320 Test Loss: 1.491 Test Acc: 0.320
Validation loss decreased (-0.319984 --> -0.319985).  Saving model ...
Epoch: 8 cost time: 1.3970842361450195
Epoch: 8, Steps: 4 | Train Loss: 1.177 Vali Loss: 1.438 Vali Acc: 0.400 Test Loss: 1.438 Test Acc: 0.400
Validation loss decreased (-0.319985 --> -0.399986).  Saving model ...
Epoch: 9 cost time: 1.3963799476623535
Epoch: 9, Steps: 4 | Train Loss: 1.060 Vali Loss: 1.382 Vali Acc: 0.400 Test Loss: 1.382 Test Acc: 0.400
Validation loss decreased (-0.399986 --> -0.399986).  Saving model ...
Epoch: 10 cost time: 1.3837881088256836
Epoch: 10, Steps: 4 | Train Loss: 0.889 Vali Loss: 1.325 Vali Acc: 0.420 Test Loss: 1.325 Test Acc: 0.420
Validation loss decreased (-0.399986 --> -0.419987).  Saving model ...
Epoch: 11 cost time: 1.395719289779663
Epoch: 11, Steps: 4 | Train Loss: 0.860 Vali Loss: 1.272 Vali Acc: 0.460 Test Loss: 1.272 Test Acc: 0.460
Validation loss decreased (-0.419987 --> -0.459987).  Saving model ...
Epoch: 12 cost time: 1.481860876083374
Epoch: 12, Steps: 4 | Train Loss: 0.686 Vali Loss: 1.223 Vali Acc: 0.440 Test Loss: 1.223 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.454331874847412
Epoch: 13, Steps: 4 | Train Loss: 0.577 Vali Loss: 1.191 Vali Acc: 0.480 Test Loss: 1.191 Test Acc: 0.480
Validation loss decreased (-0.459987 --> -0.479988).  Saving model ...
Epoch: 14 cost time: 1.4315385818481445
Epoch: 14, Steps: 4 | Train Loss: 0.579 Vali Loss: 1.148 Vali Acc: 0.480 Test Loss: 1.148 Test Acc: 0.480
Validation loss decreased (-0.479988 --> -0.479989).  Saving model ...
Epoch: 15 cost time: 1.3626575469970703
Epoch: 15, Steps: 4 | Train Loss: 0.560 Vali Loss: 1.087 Vali Acc: 0.540 Test Loss: 1.087 Test Acc: 0.540
Validation loss decreased (-0.479989 --> -0.539989).  Saving model ...
Epoch: 16 cost time: 1.5215744972229004
Epoch: 16, Steps: 4 | Train Loss: 0.381 Vali Loss: 1.067 Vali Acc: 0.500 Test Loss: 1.067 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.4426307678222656
Epoch: 17, Steps: 4 | Train Loss: 0.378 Vali Loss: 1.061 Vali Acc: 0.540 Test Loss: 1.061 Test Acc: 0.540
Validation loss decreased (-0.539989 --> -0.539989).  Saving model ...
Epoch: 18 cost time: 1.4350860118865967
Epoch: 18, Steps: 4 | Train Loss: 0.310 Vali Loss: 1.050 Vali Acc: 0.540 Test Loss: 1.050 Test Acc: 0.540
Validation loss decreased (-0.539989 --> -0.539989).  Saving model ...
Epoch: 19 cost time: 1.3783421516418457
Epoch: 19, Steps: 4 | Train Loss: 0.227 Vali Loss: 1.086 Vali Acc: 0.540 Test Loss: 1.086 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.4094114303588867
Epoch: 20, Steps: 4 | Train Loss: 0.243 Vali Loss: 1.086 Vali Acc: 0.520 Test Loss: 1.086 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.3330492973327637
Epoch: 21, Steps: 4 | Train Loss: 0.182 Vali Loss: 1.187 Vali Acc: 0.540 Test Loss: 1.187 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.3277647495269775
Epoch: 22, Steps: 4 | Train Loss: 0.188 Vali Loss: 1.185 Vali Acc: 0.560 Test Loss: 1.185 Test Acc: 0.560
Validation loss decreased (-0.539989 --> -0.559988).  Saving model ...
Epoch: 23 cost time: 1.2699601650238037
Epoch: 23, Steps: 4 | Train Loss: 0.171 Vali Loss: 1.193 Vali Acc: 0.500 Test Loss: 1.193 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.277998924255371
Epoch: 24, Steps: 4 | Train Loss: 0.113 Vali Loss: 1.226 Vali Acc: 0.520 Test Loss: 1.226 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.294931411743164
Epoch: 25, Steps: 4 | Train Loss: 0.109 Vali Loss: 1.191 Vali Acc: 0.520 Test Loss: 1.191 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.4587197303771973
Epoch: 26, Steps: 4 | Train Loss: 0.090 Vali Loss: 1.165 Vali Acc: 0.540 Test Loss: 1.165 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.3411123752593994
Epoch: 27, Steps: 4 | Train Loss: 0.082 Vali Loss: 1.123 Vali Acc: 0.520 Test Loss: 1.123 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.2628331184387207
Epoch: 28, Steps: 4 | Train Loss: 0.115 Vali Loss: 1.126 Vali Acc: 0.500 Test Loss: 1.126 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.2209234237670898
Epoch: 29, Steps: 4 | Train Loss: 0.064 Vali Loss: 1.119 Vali Acc: 0.500 Test Loss: 1.119 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.4459495544433594
Epoch: 30, Steps: 4 | Train Loss: 0.055 Vali Loss: 1.139 Vali Acc: 0.560 Test Loss: 1.139 Test Acc: 0.560
Validation loss decreased (-0.559988 --> -0.559989).  Saving model ...
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm16_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 379509
model size : 1.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm16_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.170234203338623
Epoch: 1, Steps: 4 | Train Loss: 1.641 Vali Loss: 1.544 Vali Acc: 0.240 Test Loss: 1.544 Test Acc: 0.240
Validation loss decreased (inf --> -0.239985).  Saving model ...
Epoch: 2 cost time: 1.268465518951416
Epoch: 2, Steps: 4 | Train Loss: 1.675 Vali Loss: 1.528 Vali Acc: 0.260 Test Loss: 1.528 Test Acc: 0.260
Validation loss decreased (-0.239985 --> -0.259985).  Saving model ...
Epoch: 3 cost time: 1.173067569732666
Epoch: 3, Steps: 4 | Train Loss: 1.605 Vali Loss: 1.510 Vali Acc: 0.320 Test Loss: 1.510 Test Acc: 0.320
Validation loss decreased (-0.259985 --> -0.319985).  Saving model ...
Epoch: 4 cost time: 1.1066079139709473
Epoch: 4, Steps: 4 | Train Loss: 1.454 Vali Loss: 1.498 Vali Acc: 0.400 Test Loss: 1.498 Test Acc: 0.400
Validation loss decreased (-0.319985 --> -0.399985).  Saving model ...
Epoch: 5 cost time: 1.0916144847869873
Epoch: 5, Steps: 4 | Train Loss: 1.367 Vali Loss: 1.499 Vali Acc: 0.400 Test Loss: 1.499 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.134357213973999
Epoch: 6, Steps: 4 | Train Loss: 1.316 Vali Loss: 1.494 Vali Acc: 0.400 Test Loss: 1.494 Test Acc: 0.400
Validation loss decreased (-0.399985 --> -0.399985).  Saving model ...
Epoch: 7 cost time: 1.0840258598327637
Epoch: 7, Steps: 4 | Train Loss: 1.143 Vali Loss: 1.488 Vali Acc: 0.380 Test Loss: 1.488 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.149179458618164
Epoch: 8, Steps: 4 | Train Loss: 1.222 Vali Loss: 1.472 Vali Acc: 0.400 Test Loss: 1.472 Test Acc: 0.400
Validation loss decreased (-0.399985 --> -0.399985).  Saving model ...
Epoch: 9 cost time: 1.160285472869873
Epoch: 9, Steps: 4 | Train Loss: 1.145 Vali Loss: 1.417 Vali Acc: 0.480 Test Loss: 1.417 Test Acc: 0.480
Validation loss decreased (-0.399985 --> -0.479986).  Saving model ...
Epoch: 10 cost time: 1.1319012641906738
Epoch: 10, Steps: 4 | Train Loss: 0.899 Vali Loss: 1.343 Vali Acc: 0.480 Test Loss: 1.343 Test Acc: 0.480
Validation loss decreased (-0.479986 --> -0.479987).  Saving model ...
Epoch: 11 cost time: 1.0273542404174805
Epoch: 11, Steps: 4 | Train Loss: 0.731 Vali Loss: 1.280 Vali Acc: 0.500 Test Loss: 1.280 Test Acc: 0.500
Validation loss decreased (-0.479987 --> -0.499987).  Saving model ...
Epoch: 12 cost time: 1.0028314590454102
Epoch: 12, Steps: 4 | Train Loss: 0.704 Vali Loss: 1.224 Vali Acc: 0.420 Test Loss: 1.224 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1396005153656006
Epoch: 13, Steps: 4 | Train Loss: 0.660 Vali Loss: 1.205 Vali Acc: 0.460 Test Loss: 1.205 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.0408825874328613
Epoch: 14, Steps: 4 | Train Loss: 0.503 Vali Loss: 1.175 Vali Acc: 0.480 Test Loss: 1.175 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.0351057052612305
Epoch: 15, Steps: 4 | Train Loss: 0.543 Vali Loss: 1.150 Vali Acc: 0.500 Test Loss: 1.150 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499988).  Saving model ...
Epoch: 16 cost time: 0.9283161163330078
Epoch: 16, Steps: 4 | Train Loss: 0.439 Vali Loss: 1.121 Vali Acc: 0.520 Test Loss: 1.121 Test Acc: 0.520
Validation loss decreased (-0.499988 --> -0.519989).  Saving model ...
Epoch: 17 cost time: 0.9420285224914551
Epoch: 17, Steps: 4 | Train Loss: 0.420 Vali Loss: 1.109 Vali Acc: 0.480 Test Loss: 1.109 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9815471172332764
Epoch: 18, Steps: 4 | Train Loss: 0.355 Vali Loss: 1.103 Vali Acc: 0.560 Test Loss: 1.103 Test Acc: 0.560
Validation loss decreased (-0.519989 --> -0.559989).  Saving model ...
Epoch: 19 cost time: 0.9632794857025146
Epoch: 19, Steps: 4 | Train Loss: 0.272 Vali Loss: 1.069 Vali Acc: 0.480 Test Loss: 1.069 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0905888080596924
Epoch: 20, Steps: 4 | Train Loss: 0.302 Vali Loss: 1.151 Vali Acc: 0.500 Test Loss: 1.151 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.9939398765563965
Epoch: 21, Steps: 4 | Train Loss: 0.189 Vali Loss: 1.126 Vali Acc: 0.520 Test Loss: 1.126 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.0011634826660156
Epoch: 22, Steps: 4 | Train Loss: 0.236 Vali Loss: 1.124 Vali Acc: 0.460 Test Loss: 1.124 Test Acc: 0.460
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.9769196510314941
Epoch: 23, Steps: 4 | Train Loss: 0.280 Vali Loss: 1.115 Vali Acc: 0.480 Test Loss: 1.115 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.0320491790771484
Epoch: 24, Steps: 4 | Train Loss: 0.151 Vali Loss: 1.073 Vali Acc: 0.460 Test Loss: 1.073 Test Acc: 0.460
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.9790465831756592
Epoch: 25, Steps: 4 | Train Loss: 0.128 Vali Loss: 1.107 Vali Acc: 0.520 Test Loss: 1.107 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.0164878368377686
Epoch: 26, Steps: 4 | Train Loss: 0.110 Vali Loss: 1.090 Vali Acc: 0.460 Test Loss: 1.090 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.1042413711547852
Epoch: 27, Steps: 4 | Train Loss: 0.087 Vali Loss: 1.078 Vali Acc: 0.500 Test Loss: 1.078 Test Acc: 0.500
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.0909638404846191
Epoch: 28, Steps: 4 | Train Loss: 0.075 Vali Loss: 1.105 Vali Acc: 0.440 Test Loss: 1.105 Test Acc: 0.440
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm16_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 172533
model size : 0.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm16_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.117562770843506
Epoch: 1, Steps: 4 | Train Loss: 1.672 Vali Loss: 1.632 Vali Acc: 0.180 Test Loss: 1.632 Test Acc: 0.180
Validation loss decreased (inf --> -0.179984).  Saving model ...
Epoch: 2 cost time: 1.1642546653747559
Epoch: 2, Steps: 4 | Train Loss: 1.605 Vali Loss: 1.623 Vali Acc: 0.220 Test Loss: 1.623 Test Acc: 0.220
Validation loss decreased (-0.179984 --> -0.219984).  Saving model ...
Epoch: 3 cost time: 1.1949739456176758
Epoch: 3, Steps: 4 | Train Loss: 1.521 Vali Loss: 1.610 Vali Acc: 0.300 Test Loss: 1.610 Test Acc: 0.300
Validation loss decreased (-0.219984 --> -0.299984).  Saving model ...
Epoch: 4 cost time: 1.132209062576294
Epoch: 4, Steps: 4 | Train Loss: 1.502 Vali Loss: 1.599 Vali Acc: 0.320 Test Loss: 1.599 Test Acc: 0.320
Validation loss decreased (-0.299984 --> -0.319984).  Saving model ...
Epoch: 5 cost time: 1.158153772354126
Epoch: 5, Steps: 4 | Train Loss: 1.569 Vali Loss: 1.581 Vali Acc: 0.300 Test Loss: 1.581 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0927505493164062
Epoch: 6, Steps: 4 | Train Loss: 1.206 Vali Loss: 1.538 Vali Acc: 0.300 Test Loss: 1.538 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.116898536682129
Epoch: 7, Steps: 4 | Train Loss: 1.316 Vali Loss: 1.490 Vali Acc: 0.320 Test Loss: 1.490 Test Acc: 0.320
Validation loss decreased (-0.319984 --> -0.319985).  Saving model ...
Epoch: 8 cost time: 1.1387498378753662
Epoch: 8, Steps: 4 | Train Loss: 1.179 Vali Loss: 1.437 Vali Acc: 0.380 Test Loss: 1.437 Test Acc: 0.380
Validation loss decreased (-0.319985 --> -0.379986).  Saving model ...
Epoch: 9 cost time: 1.1314818859100342
Epoch: 9, Steps: 4 | Train Loss: 1.062 Vali Loss: 1.380 Vali Acc: 0.400 Test Loss: 1.380 Test Acc: 0.400
Validation loss decreased (-0.379986 --> -0.399986).  Saving model ...
Epoch: 10 cost time: 1.1929082870483398
Epoch: 10, Steps: 4 | Train Loss: 0.895 Vali Loss: 1.322 Vali Acc: 0.420 Test Loss: 1.322 Test Acc: 0.420
Validation loss decreased (-0.399986 --> -0.419987).  Saving model ...
Epoch: 11 cost time: 1.120521068572998
Epoch: 11, Steps: 4 | Train Loss: 0.865 Vali Loss: 1.266 Vali Acc: 0.460 Test Loss: 1.266 Test Acc: 0.460
Validation loss decreased (-0.419987 --> -0.459987).  Saving model ...
Epoch: 12 cost time: 1.1704964637756348
Epoch: 12, Steps: 4 | Train Loss: 0.690 Vali Loss: 1.212 Vali Acc: 0.440 Test Loss: 1.212 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.076355218887329
Epoch: 13, Steps: 4 | Train Loss: 0.581 Vali Loss: 1.178 Vali Acc: 0.440 Test Loss: 1.178 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.1441450119018555
Epoch: 14, Steps: 4 | Train Loss: 0.589 Vali Loss: 1.134 Vali Acc: 0.460 Test Loss: 1.134 Test Acc: 0.460
Validation loss decreased (-0.459987 --> -0.459989).  Saving model ...
Epoch: 15 cost time: 1.1627452373504639
Epoch: 15, Steps: 4 | Train Loss: 0.563 Vali Loss: 1.070 Vali Acc: 0.520 Test Loss: 1.070 Test Acc: 0.520
Validation loss decreased (-0.459989 --> -0.519989).  Saving model ...
Epoch: 16 cost time: 1.1196050643920898
Epoch: 16, Steps: 4 | Train Loss: 0.382 Vali Loss: 1.049 Vali Acc: 0.500 Test Loss: 1.049 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1361839771270752
Epoch: 17, Steps: 4 | Train Loss: 0.387 Vali Loss: 1.031 Vali Acc: 0.520 Test Loss: 1.031 Test Acc: 0.520
Validation loss decreased (-0.519989 --> -0.519990).  Saving model ...
Epoch: 18 cost time: 1.2404210567474365
Epoch: 18, Steps: 4 | Train Loss: 0.317 Vali Loss: 1.013 Vali Acc: 0.540 Test Loss: 1.013 Test Acc: 0.540
Validation loss decreased (-0.519990 --> -0.539990).  Saving model ...
Epoch: 19 cost time: 1.1968538761138916
Epoch: 19, Steps: 4 | Train Loss: 0.228 Vali Loss: 1.010 Vali Acc: 0.540 Test Loss: 1.010 Test Acc: 0.540
Validation loss decreased (-0.539990 --> -0.539990).  Saving model ...
Epoch: 20 cost time: 1.0852138996124268
Epoch: 20, Steps: 4 | Train Loss: 0.255 Vali Loss: 1.038 Vali Acc: 0.600 Test Loss: 1.038 Test Acc: 0.600
Validation loss decreased (-0.539990 --> -0.599990).  Saving model ...
Epoch: 21 cost time: 1.198976755142212
Epoch: 21, Steps: 4 | Train Loss: 0.186 Vali Loss: 1.115 Vali Acc: 0.520 Test Loss: 1.115 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0646233558654785
Epoch: 22, Steps: 4 | Train Loss: 0.182 Vali Loss: 1.081 Vali Acc: 0.540 Test Loss: 1.081 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.197901725769043
Epoch: 23, Steps: 4 | Train Loss: 0.175 Vali Loss: 1.109 Vali Acc: 0.500 Test Loss: 1.109 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.1493313312530518
Epoch: 24, Steps: 4 | Train Loss: 0.119 Vali Loss: 1.148 Vali Acc: 0.500 Test Loss: 1.148 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.1672306060791016
Epoch: 25, Steps: 4 | Train Loss: 0.114 Vali Loss: 1.104 Vali Acc: 0.580 Test Loss: 1.104 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.0896656513214111
Epoch: 26, Steps: 4 | Train Loss: 0.096 Vali Loss: 1.088 Vali Acc: 0.560 Test Loss: 1.088 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.1717755794525146
Epoch: 27, Steps: 4 | Train Loss: 0.105 Vali Loss: 1.035 Vali Acc: 0.560 Test Loss: 1.035 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.1597678661346436
Epoch: 28, Steps: 4 | Train Loss: 0.150 Vali Loss: 1.065 Vali Acc: 0.580 Test Loss: 1.065 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.1344470977783203
Epoch: 29, Steps: 4 | Train Loss: 0.073 Vali Loss: 1.059 Vali Acc: 0.560 Test Loss: 1.059 Test Acc: 0.560
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.0899250507354736
Epoch: 30, Steps: 4 | Train Loss: 0.064 Vali Loss: 1.053 Vali Acc: 0.580 Test Loss: 1.053 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm16_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 379509
model size : 1.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm16_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.9843392372131348
Epoch: 1, Steps: 4 | Train Loss: 1.649 Vali Loss: 1.542 Vali Acc: 0.260 Test Loss: 1.542 Test Acc: 0.260
Validation loss decreased (inf --> -0.259985).  Saving model ...
Epoch: 2 cost time: 1.0591816902160645
Epoch: 2, Steps: 4 | Train Loss: 1.670 Vali Loss: 1.525 Vali Acc: 0.280 Test Loss: 1.525 Test Acc: 0.280
Validation loss decreased (-0.259985 --> -0.279985).  Saving model ...
Epoch: 3 cost time: 1.1399812698364258
Epoch: 3, Steps: 4 | Train Loss: 1.595 Vali Loss: 1.506 Vali Acc: 0.320 Test Loss: 1.506 Test Acc: 0.320
Validation loss decreased (-0.279985 --> -0.319985).  Saving model ...
Epoch: 4 cost time: 1.219217300415039
Epoch: 4, Steps: 4 | Train Loss: 1.441 Vali Loss: 1.495 Vali Acc: 0.400 Test Loss: 1.495 Test Acc: 0.400
Validation loss decreased (-0.319985 --> -0.399985).  Saving model ...
Epoch: 5 cost time: 1.0911598205566406
Epoch: 5, Steps: 4 | Train Loss: 1.364 Vali Loss: 1.496 Vali Acc: 0.400 Test Loss: 1.496 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0294849872589111
Epoch: 6, Steps: 4 | Train Loss: 1.310 Vali Loss: 1.491 Vali Acc: 0.400 Test Loss: 1.491 Test Acc: 0.400
Validation loss decreased (-0.399985 --> -0.399985).  Saving model ...
Epoch: 7 cost time: 1.0192902088165283
Epoch: 7, Steps: 4 | Train Loss: 1.145 Vali Loss: 1.486 Vali Acc: 0.400 Test Loss: 1.486 Test Acc: 0.400
Validation loss decreased (-0.399985 --> -0.399985).  Saving model ...
Epoch: 8 cost time: 1.2300183773040771
Epoch: 8, Steps: 4 | Train Loss: 1.215 Vali Loss: 1.471 Vali Acc: 0.400 Test Loss: 1.471 Test Acc: 0.400
Validation loss decreased (-0.399985 --> -0.399985).  Saving model ...
Epoch: 9 cost time: 1.1528534889221191
Epoch: 9, Steps: 4 | Train Loss: 1.150 Vali Loss: 1.415 Vali Acc: 0.440 Test Loss: 1.415 Test Acc: 0.440
Validation loss decreased (-0.399985 --> -0.439986).  Saving model ...
Epoch: 10 cost time: 1.1800270080566406
Epoch: 10, Steps: 4 | Train Loss: 0.914 Vali Loss: 1.341 Vali Acc: 0.460 Test Loss: 1.341 Test Acc: 0.460
Validation loss decreased (-0.439986 --> -0.459987).  Saving model ...
Epoch: 11 cost time: 1.1083884239196777
Epoch: 11, Steps: 4 | Train Loss: 0.736 Vali Loss: 1.276 Vali Acc: 0.480 Test Loss: 1.276 Test Acc: 0.480
Validation loss decreased (-0.459987 --> -0.479987).  Saving model ...
Epoch: 12 cost time: 1.1473770141601562
Epoch: 12, Steps: 4 | Train Loss: 0.723 Vali Loss: 1.219 Vali Acc: 0.440 Test Loss: 1.219 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0637130737304688
Epoch: 13, Steps: 4 | Train Loss: 0.659 Vali Loss: 1.204 Vali Acc: 0.500 Test Loss: 1.204 Test Acc: 0.500
Validation loss decreased (-0.479987 --> -0.499988).  Saving model ...
Epoch: 14 cost time: 1.1322126388549805
Epoch: 14, Steps: 4 | Train Loss: 0.528 Vali Loss: 1.177 Vali Acc: 0.500 Test Loss: 1.177 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 15 cost time: 1.173093557357788
Epoch: 15, Steps: 4 | Train Loss: 0.548 Vali Loss: 1.152 Vali Acc: 0.440 Test Loss: 1.152 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1434276103973389
Epoch: 16, Steps: 4 | Train Loss: 0.460 Vali Loss: 1.115 Vali Acc: 0.500 Test Loss: 1.115 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499989).  Saving model ...
Epoch: 17 cost time: 1.0498228073120117
Epoch: 17, Steps: 4 | Train Loss: 0.426 Vali Loss: 1.100 Vali Acc: 0.460 Test Loss: 1.100 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0436105728149414
Epoch: 18, Steps: 4 | Train Loss: 0.352 Vali Loss: 1.119 Vali Acc: 0.540 Test Loss: 1.119 Test Acc: 0.540
Validation loss decreased (-0.499989 --> -0.539989).  Saving model ...
Epoch: 19 cost time: 1.120032787322998
Epoch: 19, Steps: 4 | Train Loss: 0.272 Vali Loss: 1.079 Vali Acc: 0.480 Test Loss: 1.079 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0873816013336182
Epoch: 20, Steps: 4 | Train Loss: 0.305 Vali Loss: 1.153 Vali Acc: 0.520 Test Loss: 1.153 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.0981922149658203
Epoch: 21, Steps: 4 | Train Loss: 0.187 Vali Loss: 1.127 Vali Acc: 0.500 Test Loss: 1.127 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.0058608055114746
Epoch: 22, Steps: 4 | Train Loss: 0.234 Vali Loss: 1.133 Vali Acc: 0.480 Test Loss: 1.133 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.080082654953003
Epoch: 23, Steps: 4 | Train Loss: 0.291 Vali Loss: 1.140 Vali Acc: 0.480 Test Loss: 1.140 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.0383517742156982
Epoch: 24, Steps: 4 | Train Loss: 0.153 Vali Loss: 1.096 Vali Acc: 0.440 Test Loss: 1.096 Test Acc: 0.440
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.1024353504180908
Epoch: 25, Steps: 4 | Train Loss: 0.127 Vali Loss: 1.114 Vali Acc: 0.520 Test Loss: 1.114 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.1126916408538818
Epoch: 26, Steps: 4 | Train Loss: 0.113 Vali Loss: 1.097 Vali Acc: 0.460 Test Loss: 1.097 Test Acc: 0.460
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.1686286926269531
Epoch: 27, Steps: 4 | Train Loss: 0.091 Vali Loss: 1.088 Vali Acc: 0.460 Test Loss: 1.088 Test Acc: 0.460
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.1543965339660645
Epoch: 28, Steps: 4 | Train Loss: 0.073 Vali Loss: 1.115 Vali Acc: 0.420 Test Loss: 1.115 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm16_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 172533
model size : 0.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm8_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.16510009765625
Epoch: 1, Steps: 4 | Train Loss: 1.730 Vali Loss: 1.578 Vali Acc: 0.160 Test Loss: 1.578 Test Acc: 0.160
Validation loss decreased (inf --> -0.159984).  Saving model ...
Epoch: 2 cost time: 2.16552472114563
Epoch: 2, Steps: 4 | Train Loss: 1.586 Vali Loss: 1.564 Vali Acc: 0.160 Test Loss: 1.564 Test Acc: 0.160
Validation loss decreased (-0.159984 --> -0.159984).  Saving model ...
Epoch: 3 cost time: 1.917842149734497
Epoch: 3, Steps: 4 | Train Loss: 1.556 Vali Loss: 1.545 Vali Acc: 0.220 Test Loss: 1.545 Test Acc: 0.220
Validation loss decreased (-0.159984 --> -0.219985).  Saving model ...
Epoch: 4 cost time: 2.146833896636963
Epoch: 4, Steps: 4 | Train Loss: 1.515 Vali Loss: 1.530 Vali Acc: 0.260 Test Loss: 1.530 Test Acc: 0.260
Validation loss decreased (-0.219985 --> -0.259985).  Saving model ...
Epoch: 5 cost time: 2.033195972442627
Epoch: 5, Steps: 4 | Train Loss: 1.428 Vali Loss: 1.519 Vali Acc: 0.300 Test Loss: 1.519 Test Acc: 0.300
Validation loss decreased (-0.259985 --> -0.299985).  Saving model ...
Epoch: 6 cost time: 1.9732441902160645
Epoch: 6, Steps: 4 | Train Loss: 1.415 Vali Loss: 1.519 Vali Acc: 0.260 Test Loss: 1.519 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.987295150756836
Epoch: 7, Steps: 4 | Train Loss: 1.299 Vali Loss: 1.517 Vali Acc: 0.300 Test Loss: 1.517 Test Acc: 0.300
Validation loss decreased (-0.299985 --> -0.299985).  Saving model ...
Epoch: 8 cost time: 2.020923137664795
Epoch: 8, Steps: 4 | Train Loss: 1.272 Vali Loss: 1.500 Vali Acc: 0.320 Test Loss: 1.500 Test Acc: 0.320
Validation loss decreased (-0.299985 --> -0.319985).  Saving model ...
Epoch: 9 cost time: 2.124189853668213
Epoch: 9, Steps: 4 | Train Loss: 1.178 Vali Loss: 1.488 Vali Acc: 0.360 Test Loss: 1.488 Test Acc: 0.360
Validation loss decreased (-0.319985 --> -0.359985).  Saving model ...
Epoch: 10 cost time: 2.177490234375
Epoch: 10, Steps: 4 | Train Loss: 1.095 Vali Loss: 1.469 Vali Acc: 0.360 Test Loss: 1.469 Test Acc: 0.360
Validation loss decreased (-0.359985 --> -0.359985).  Saving model ...
Epoch: 11 cost time: 1.975355625152588
Epoch: 11, Steps: 4 | Train Loss: 0.926 Vali Loss: 1.425 Vali Acc: 0.320 Test Loss: 1.425 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.093039035797119
Epoch: 12, Steps: 4 | Train Loss: 0.857 Vali Loss: 1.380 Vali Acc: 0.300 Test Loss: 1.380 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.012423038482666
Epoch: 13, Steps: 4 | Train Loss: 0.807 Vali Loss: 1.359 Vali Acc: 0.320 Test Loss: 1.359 Test Acc: 0.320
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.0937399864196777
Epoch: 14, Steps: 4 | Train Loss: 0.667 Vali Loss: 1.339 Vali Acc: 0.340 Test Loss: 1.339 Test Acc: 0.340
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.9602181911468506
Epoch: 15, Steps: 4 | Train Loss: 0.624 Vali Loss: 1.286 Vali Acc: 0.360 Test Loss: 1.286 Test Acc: 0.360
Validation loss decreased (-0.359985 --> -0.359987).  Saving model ...
Epoch: 16 cost time: 1.9560637474060059
Epoch: 16, Steps: 4 | Train Loss: 0.572 Vali Loss: 1.284 Vali Acc: 0.380 Test Loss: 1.284 Test Acc: 0.380
Validation loss decreased (-0.359987 --> -0.379987).  Saving model ...
Epoch: 17 cost time: 1.995492935180664
Epoch: 17, Steps: 4 | Train Loss: 0.606 Vali Loss: 1.275 Vali Acc: 0.300 Test Loss: 1.275 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.0490100383758545
Epoch: 18, Steps: 4 | Train Loss: 0.486 Vali Loss: 1.268 Vali Acc: 0.380 Test Loss: 1.268 Test Acc: 0.380
Validation loss decreased (-0.379987 --> -0.379987).  Saving model ...
Epoch: 19 cost time: 1.9652705192565918
Epoch: 19, Steps: 4 | Train Loss: 0.392 Vali Loss: 1.286 Vali Acc: 0.380 Test Loss: 1.286 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.0046591758728027
Epoch: 20, Steps: 4 | Train Loss: 0.391 Vali Loss: 1.383 Vali Acc: 0.380 Test Loss: 1.383 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.911203384399414
Epoch: 21, Steps: 4 | Train Loss: 0.298 Vali Loss: 1.497 Vali Acc: 0.360 Test Loss: 1.497 Test Acc: 0.360
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.034510612487793
Epoch: 22, Steps: 4 | Train Loss: 0.275 Vali Loss: 1.477 Vali Acc: 0.380 Test Loss: 1.477 Test Acc: 0.380
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.9241559505462646
Epoch: 23, Steps: 4 | Train Loss: 0.258 Vali Loss: 1.570 Vali Acc: 0.420 Test Loss: 1.570 Test Acc: 0.420
Validation loss decreased (-0.379987 --> -0.419984).  Saving model ...
Epoch: 24 cost time: 2.166846752166748
Epoch: 24, Steps: 4 | Train Loss: 0.244 Vali Loss: 1.573 Vali Acc: 0.400 Test Loss: 1.573 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.070868730545044
Epoch: 25, Steps: 4 | Train Loss: 0.208 Vali Loss: 1.596 Vali Acc: 0.420 Test Loss: 1.596 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.166229248046875
Epoch: 26, Steps: 4 | Train Loss: 0.293 Vali Loss: 1.479 Vali Acc: 0.380 Test Loss: 1.479 Test Acc: 0.380
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.212158679962158
Epoch: 27, Steps: 4 | Train Loss: 0.199 Vali Loss: 1.481 Vali Acc: 0.400 Test Loss: 1.481 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.110283613204956
Epoch: 28, Steps: 4 | Train Loss: 0.159 Vali Loss: 1.505 Vali Acc: 0.420 Test Loss: 1.505 Test Acc: 0.420
Validation loss decreased (-0.419984 --> -0.419985).  Saving model ...
Epoch: 29 cost time: 2.27232027053833
Epoch: 29, Steps: 4 | Train Loss: 0.259 Vali Loss: 1.722 Vali Acc: 0.380 Test Loss: 1.722 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.40865421295166
Epoch: 30, Steps: 4 | Train Loss: 0.189 Vali Loss: 1.557 Vali Acc: 0.380 Test Loss: 1.557 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm8_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.42
model parameter : 629725
model size : 2.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm8_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.7608070373535156
Epoch: 1, Steps: 4 | Train Loss: 1.616 Vali Loss: 1.646 Vali Acc: 0.260 Test Loss: 1.646 Test Acc: 0.260
Validation loss decreased (inf --> -0.259984).  Saving model ...
Epoch: 2 cost time: 1.712005376815796
Epoch: 2, Steps: 4 | Train Loss: 1.533 Vali Loss: 1.629 Vali Acc: 0.280 Test Loss: 1.629 Test Acc: 0.280
Validation loss decreased (-0.259984 --> -0.279984).  Saving model ...
Epoch: 3 cost time: 1.5410807132720947
Epoch: 3, Steps: 4 | Train Loss: 1.526 Vali Loss: 1.602 Vali Acc: 0.260 Test Loss: 1.602 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.688187599182129
Epoch: 4, Steps: 4 | Train Loss: 1.472 Vali Loss: 1.575 Vali Acc: 0.300 Test Loss: 1.575 Test Acc: 0.300
Validation loss decreased (-0.279984 --> -0.299984).  Saving model ...
Epoch: 5 cost time: 1.5390827655792236
Epoch: 5, Steps: 4 | Train Loss: 1.396 Vali Loss: 1.545 Vali Acc: 0.380 Test Loss: 1.545 Test Acc: 0.380
Validation loss decreased (-0.299984 --> -0.379985).  Saving model ...
Epoch: 6 cost time: 1.6751275062561035
Epoch: 6, Steps: 4 | Train Loss: 1.352 Vali Loss: 1.510 Vali Acc: 0.380 Test Loss: 1.510 Test Acc: 0.380
Validation loss decreased (-0.379985 --> -0.379985).  Saving model ...
Epoch: 7 cost time: 1.652073860168457
Epoch: 7, Steps: 4 | Train Loss: 1.264 Vali Loss: 1.473 Vali Acc: 0.340 Test Loss: 1.473 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.599945068359375
Epoch: 8, Steps: 4 | Train Loss: 1.161 Vali Loss: 1.442 Vali Acc: 0.340 Test Loss: 1.442 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.6243798732757568
Epoch: 9, Steps: 4 | Train Loss: 1.262 Vali Loss: 1.414 Vali Acc: 0.340 Test Loss: 1.414 Test Acc: 0.340
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.6007037162780762
Epoch: 10, Steps: 4 | Train Loss: 0.953 Vali Loss: 1.384 Vali Acc: 0.400 Test Loss: 1.384 Test Acc: 0.400
Validation loss decreased (-0.379985 --> -0.399986).  Saving model ...
Epoch: 11 cost time: 1.7070846557617188
Epoch: 11, Steps: 4 | Train Loss: 1.035 Vali Loss: 1.367 Vali Acc: 0.420 Test Loss: 1.367 Test Acc: 0.420
Validation loss decreased (-0.399986 --> -0.419986).  Saving model ...
Epoch: 12 cost time: 1.5563976764678955
Epoch: 12, Steps: 4 | Train Loss: 0.906 Vali Loss: 1.338 Vali Acc: 0.440 Test Loss: 1.338 Test Acc: 0.440
Validation loss decreased (-0.419986 --> -0.439987).  Saving model ...
Epoch: 13 cost time: 1.6174638271331787
Epoch: 13, Steps: 4 | Train Loss: 0.831 Vali Loss: 1.325 Vali Acc: 0.400 Test Loss: 1.325 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6213405132293701
Epoch: 14, Steps: 4 | Train Loss: 0.736 Vali Loss: 1.308 Vali Acc: 0.400 Test Loss: 1.308 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.6653563976287842
Epoch: 15, Steps: 4 | Train Loss: 0.669 Vali Loss: 1.279 Vali Acc: 0.420 Test Loss: 1.279 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.6975226402282715
Epoch: 16, Steps: 4 | Train Loss: 0.646 Vali Loss: 1.242 Vali Acc: 0.440 Test Loss: 1.242 Test Acc: 0.440
Validation loss decreased (-0.439987 --> -0.439988).  Saving model ...
Epoch: 17 cost time: 1.6101346015930176
Epoch: 17, Steps: 4 | Train Loss: 0.498 Vali Loss: 1.250 Vali Acc: 0.400 Test Loss: 1.250 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.5606324672698975
Epoch: 18, Steps: 4 | Train Loss: 0.439 Vali Loss: 1.186 Vali Acc: 0.460 Test Loss: 1.186 Test Acc: 0.460
Validation loss decreased (-0.439988 --> -0.459988).  Saving model ...
Epoch: 19 cost time: 1.5261712074279785
Epoch: 19, Steps: 4 | Train Loss: 0.407 Vali Loss: 1.146 Vali Acc: 0.500 Test Loss: 1.146 Test Acc: 0.500
Validation loss decreased (-0.459988 --> -0.499989).  Saving model ...
Epoch: 20 cost time: 1.8242192268371582
Epoch: 20, Steps: 4 | Train Loss: 0.554 Vali Loss: 1.194 Vali Acc: 0.420 Test Loss: 1.194 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.635084629058838
Epoch: 21, Steps: 4 | Train Loss: 0.341 Vali Loss: 1.182 Vali Acc: 0.460 Test Loss: 1.182 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.7583916187286377
Epoch: 22, Steps: 4 | Train Loss: 0.275 Vali Loss: 1.168 Vali Acc: 0.440 Test Loss: 1.168 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.5380859375
Epoch: 23, Steps: 4 | Train Loss: 0.232 Vali Loss: 1.092 Vali Acc: 0.520 Test Loss: 1.092 Test Acc: 0.520
Validation loss decreased (-0.499989 --> -0.519989).  Saving model ...
Epoch: 24 cost time: 1.6456830501556396
Epoch: 24, Steps: 4 | Train Loss: 0.195 Vali Loss: 1.128 Vali Acc: 0.520 Test Loss: 1.128 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.6290795803070068
Epoch: 25, Steps: 4 | Train Loss: 0.200 Vali Loss: 1.325 Vali Acc: 0.460 Test Loss: 1.325 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.6408720016479492
Epoch: 26, Steps: 4 | Train Loss: 0.174 Vali Loss: 1.181 Vali Acc: 0.520 Test Loss: 1.181 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.540522575378418
Epoch: 27, Steps: 4 | Train Loss: 0.165 Vali Loss: 1.204 Vali Acc: 0.480 Test Loss: 1.204 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.5061819553375244
Epoch: 28, Steps: 4 | Train Loss: 0.274 Vali Loss: 1.153 Vali Acc: 0.580 Test Loss: 1.153 Test Acc: 0.580
Validation loss decreased (-0.519989 --> -0.579988).  Saving model ...
Epoch: 29 cost time: 1.6973533630371094
Epoch: 29, Steps: 4 | Train Loss: 0.106 Vali Loss: 1.162 Vali Acc: 0.580 Test Loss: 1.162 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.628157377243042
Epoch: 30, Steps: 4 | Train Loss: 0.078 Vali Loss: 1.154 Vali Acc: 0.600 Test Loss: 1.154 Test Acc: 0.600
Validation loss decreased (-0.579988 --> -0.599988).  Saving model ...
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm8_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 215741
model size : 0.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm8_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.6264541149139404
Epoch: 1, Steps: 4 | Train Loss: 1.730 Vali Loss: 1.577 Vali Acc: 0.180 Test Loss: 1.577 Test Acc: 0.180
Validation loss decreased (inf --> -0.179984).  Saving model ...
Epoch: 2 cost time: 1.5459659099578857
Epoch: 2, Steps: 4 | Train Loss: 1.580 Vali Loss: 1.564 Vali Acc: 0.200 Test Loss: 1.564 Test Acc: 0.200
Validation loss decreased (-0.179984 --> -0.199984).  Saving model ...
Epoch: 3 cost time: 1.5045349597930908
Epoch: 3, Steps: 4 | Train Loss: 1.555 Vali Loss: 1.545 Vali Acc: 0.240 Test Loss: 1.545 Test Acc: 0.240
Validation loss decreased (-0.199984 --> -0.239985).  Saving model ...
Epoch: 4 cost time: 1.5541541576385498
Epoch: 4, Steps: 4 | Train Loss: 1.522 Vali Loss: 1.533 Vali Acc: 0.300 Test Loss: 1.533 Test Acc: 0.300
Validation loss decreased (-0.239985 --> -0.299985).  Saving model ...
Epoch: 5 cost time: 1.6510632038116455
Epoch: 5, Steps: 4 | Train Loss: 1.433 Vali Loss: 1.523 Vali Acc: 0.320 Test Loss: 1.523 Test Acc: 0.320
Validation loss decreased (-0.299985 --> -0.319985).  Saving model ...
Epoch: 6 cost time: 1.5428030490875244
Epoch: 6, Steps: 4 | Train Loss: 1.426 Vali Loss: 1.522 Vali Acc: 0.280 Test Loss: 1.522 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6156187057495117
Epoch: 7, Steps: 4 | Train Loss: 1.307 Vali Loss: 1.521 Vali Acc: 0.320 Test Loss: 1.521 Test Acc: 0.320
Validation loss decreased (-0.319985 --> -0.319985).  Saving model ...
Epoch: 8 cost time: 1.6765153408050537
Epoch: 8, Steps: 4 | Train Loss: 1.290 Vali Loss: 1.507 Vali Acc: 0.340 Test Loss: 1.507 Test Acc: 0.340
Validation loss decreased (-0.319985 --> -0.339985).  Saving model ...
Epoch: 9 cost time: 1.5806467533111572
Epoch: 9, Steps: 4 | Train Loss: 1.162 Vali Loss: 1.491 Vali Acc: 0.380 Test Loss: 1.491 Test Acc: 0.380
Validation loss decreased (-0.339985 --> -0.379985).  Saving model ...
Epoch: 10 cost time: 1.6684741973876953
Epoch: 10, Steps: 4 | Train Loss: 1.098 Vali Loss: 1.456 Vali Acc: 0.360 Test Loss: 1.456 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6303744316101074
Epoch: 11, Steps: 4 | Train Loss: 0.930 Vali Loss: 1.411 Vali Acc: 0.380 Test Loss: 1.411 Test Acc: 0.380
Validation loss decreased (-0.379985 --> -0.379986).  Saving model ...
Epoch: 12 cost time: 1.7371304035186768
Epoch: 12, Steps: 4 | Train Loss: 0.861 Vali Loss: 1.372 Vali Acc: 0.360 Test Loss: 1.372 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7638883590698242
Epoch: 13, Steps: 4 | Train Loss: 0.810 Vali Loss: 1.341 Vali Acc: 0.360 Test Loss: 1.341 Test Acc: 0.360
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.722121238708496
Epoch: 14, Steps: 4 | Train Loss: 0.667 Vali Loss: 1.309 Vali Acc: 0.380 Test Loss: 1.309 Test Acc: 0.380
Validation loss decreased (-0.379986 --> -0.379987).  Saving model ...
Epoch: 15 cost time: 1.7989130020141602
Epoch: 15, Steps: 4 | Train Loss: 0.601 Vali Loss: 1.289 Vali Acc: 0.420 Test Loss: 1.289 Test Acc: 0.420
Validation loss decreased (-0.379987 --> -0.419987).  Saving model ...
Epoch: 16 cost time: 1.7691855430603027
Epoch: 16, Steps: 4 | Train Loss: 0.575 Vali Loss: 1.265 Vali Acc: 0.480 Test Loss: 1.265 Test Acc: 0.480
Validation loss decreased (-0.419987 --> -0.479987).  Saving model ...
Epoch: 17 cost time: 1.7842028141021729
Epoch: 17, Steps: 4 | Train Loss: 0.652 Vali Loss: 1.227 Vali Acc: 0.420 Test Loss: 1.227 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.732710599899292
Epoch: 18, Steps: 4 | Train Loss: 0.463 Vali Loss: 1.272 Vali Acc: 0.360 Test Loss: 1.272 Test Acc: 0.360
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.728698492050171
Epoch: 19, Steps: 4 | Train Loss: 0.404 Vali Loss: 1.298 Vali Acc: 0.420 Test Loss: 1.298 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.7728314399719238
Epoch: 20, Steps: 4 | Train Loss: 0.383 Vali Loss: 1.323 Vali Acc: 0.380 Test Loss: 1.323 Test Acc: 0.380
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.8253402709960938
Epoch: 21, Steps: 4 | Train Loss: 0.262 Vali Loss: 1.462 Vali Acc: 0.340 Test Loss: 1.462 Test Acc: 0.340
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.7987408638000488
Epoch: 22, Steps: 4 | Train Loss: 0.456 Vali Loss: 1.360 Vali Acc: 0.420 Test Loss: 1.360 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.7421951293945312
Epoch: 23, Steps: 4 | Train Loss: 0.306 Vali Loss: 1.382 Vali Acc: 0.440 Test Loss: 1.382 Test Acc: 0.440
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.8205292224884033
Epoch: 24, Steps: 4 | Train Loss: 0.223 Vali Loss: 1.592 Vali Acc: 0.360 Test Loss: 1.592 Test Acc: 0.360
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.780334711074829
Epoch: 25, Steps: 4 | Train Loss: 0.194 Vali Loss: 1.485 Vali Acc: 0.420 Test Loss: 1.485 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.916271686553955
Epoch: 26, Steps: 4 | Train Loss: 0.240 Vali Loss: 1.512 Vali Acc: 0.420 Test Loss: 1.512 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm8_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.48
model parameter : 629725
model size : 2.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm8_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.4876835346221924
Epoch: 1, Steps: 4 | Train Loss: 1.618 Vali Loss: 1.645 Vali Acc: 0.260 Test Loss: 1.645 Test Acc: 0.260
Validation loss decreased (inf --> -0.259984).  Saving model ...
Epoch: 2 cost time: 1.3791682720184326
Epoch: 2, Steps: 4 | Train Loss: 1.536 Vali Loss: 1.626 Vali Acc: 0.280 Test Loss: 1.626 Test Acc: 0.280
Validation loss decreased (-0.259984 --> -0.279984).  Saving model ...
Epoch: 3 cost time: 1.3007159233093262
Epoch: 3, Steps: 4 | Train Loss: 1.519 Vali Loss: 1.598 Vali Acc: 0.260 Test Loss: 1.598 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3709795475006104
Epoch: 4, Steps: 4 | Train Loss: 1.477 Vali Loss: 1.572 Vali Acc: 0.300 Test Loss: 1.572 Test Acc: 0.300
Validation loss decreased (-0.279984 --> -0.299984).  Saving model ...
Epoch: 5 cost time: 1.3623359203338623
Epoch: 5, Steps: 4 | Train Loss: 1.396 Vali Loss: 1.548 Vali Acc: 0.360 Test Loss: 1.548 Test Acc: 0.360
Validation loss decreased (-0.299984 --> -0.359985).  Saving model ...
Epoch: 6 cost time: 1.330866813659668
Epoch: 6, Steps: 4 | Train Loss: 1.350 Vali Loss: 1.509 Vali Acc: 0.380 Test Loss: 1.509 Test Acc: 0.380
Validation loss decreased (-0.359985 --> -0.379985).  Saving model ...
Epoch: 7 cost time: 1.313838243484497
Epoch: 7, Steps: 4 | Train Loss: 1.263 Vali Loss: 1.477 Vali Acc: 0.360 Test Loss: 1.477 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5102288722991943
Epoch: 8, Steps: 4 | Train Loss: 1.157 Vali Loss: 1.443 Vali Acc: 0.340 Test Loss: 1.443 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.3240678310394287
Epoch: 9, Steps: 4 | Train Loss: 1.260 Vali Loss: 1.414 Vali Acc: 0.340 Test Loss: 1.414 Test Acc: 0.340
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.381728172302246
Epoch: 10, Steps: 4 | Train Loss: 0.955 Vali Loss: 1.386 Vali Acc: 0.380 Test Loss: 1.386 Test Acc: 0.380
Validation loss decreased (-0.379985 --> -0.379986).  Saving model ...
Epoch: 11 cost time: 1.2998719215393066
Epoch: 11, Steps: 4 | Train Loss: 1.003 Vali Loss: 1.369 Vali Acc: 0.400 Test Loss: 1.369 Test Acc: 0.400
Validation loss decreased (-0.379986 --> -0.399986).  Saving model ...
Epoch: 12 cost time: 1.3525607585906982
Epoch: 12, Steps: 4 | Train Loss: 0.923 Vali Loss: 1.340 Vali Acc: 0.440 Test Loss: 1.340 Test Acc: 0.440
Validation loss decreased (-0.399986 --> -0.439987).  Saving model ...
Epoch: 13 cost time: 1.4189252853393555
Epoch: 13, Steps: 4 | Train Loss: 0.818 Vali Loss: 1.321 Vali Acc: 0.400 Test Loss: 1.321 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4691588878631592
Epoch: 14, Steps: 4 | Train Loss: 0.719 Vali Loss: 1.304 Vali Acc: 0.400 Test Loss: 1.304 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.4882802963256836
Epoch: 15, Steps: 4 | Train Loss: 0.662 Vali Loss: 1.265 Vali Acc: 0.460 Test Loss: 1.265 Test Acc: 0.460
Validation loss decreased (-0.439987 --> -0.459987).  Saving model ...
Epoch: 16 cost time: 1.4016613960266113
Epoch: 16, Steps: 4 | Train Loss: 0.643 Vali Loss: 1.235 Vali Acc: 0.480 Test Loss: 1.235 Test Acc: 0.480
Validation loss decreased (-0.459987 --> -0.479988).  Saving model ...
Epoch: 17 cost time: 1.4518556594848633
Epoch: 17, Steps: 4 | Train Loss: 0.491 Vali Loss: 1.250 Vali Acc: 0.440 Test Loss: 1.250 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.3388893604278564
Epoch: 18, Steps: 4 | Train Loss: 0.450 Vali Loss: 1.194 Vali Acc: 0.440 Test Loss: 1.194 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.3240430355072021
Epoch: 19, Steps: 4 | Train Loss: 0.413 Vali Loss: 1.137 Vali Acc: 0.500 Test Loss: 1.137 Test Acc: 0.500
Validation loss decreased (-0.479988 --> -0.499989).  Saving model ...
Epoch: 20 cost time: 1.3147528171539307
Epoch: 20, Steps: 4 | Train Loss: 0.581 Vali Loss: 1.166 Vali Acc: 0.500 Test Loss: 1.166 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.3870151042938232
Epoch: 21, Steps: 4 | Train Loss: 0.345 Vali Loss: 1.169 Vali Acc: 0.480 Test Loss: 1.169 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.3443505764007568
Epoch: 22, Steps: 4 | Train Loss: 0.271 Vali Loss: 1.140 Vali Acc: 0.540 Test Loss: 1.140 Test Acc: 0.540
Validation loss decreased (-0.499989 --> -0.539989).  Saving model ...
Epoch: 23 cost time: 1.4096641540527344
Epoch: 23, Steps: 4 | Train Loss: 0.230 Vali Loss: 1.090 Vali Acc: 0.520 Test Loss: 1.090 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.3981518745422363
Epoch: 24, Steps: 4 | Train Loss: 0.201 Vali Loss: 1.115 Vali Acc: 0.480 Test Loss: 1.115 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.4997789859771729
Epoch: 25, Steps: 4 | Train Loss: 0.237 Vali Loss: 1.220 Vali Acc: 0.500 Test Loss: 1.220 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.4575884342193604
Epoch: 26, Steps: 4 | Train Loss: 0.187 Vali Loss: 1.176 Vali Acc: 0.500 Test Loss: 1.176 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.468888282775879
Epoch: 27, Steps: 4 | Train Loss: 0.145 Vali Loss: 1.213 Vali Acc: 0.500 Test Loss: 1.213 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.4630300998687744
Epoch: 28, Steps: 4 | Train Loss: 0.355 Vali Loss: 1.181 Vali Acc: 0.500 Test Loss: 1.181 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.41363525390625
Epoch: 29, Steps: 4 | Train Loss: 0.119 Vali Loss: 1.194 Vali Acc: 0.480 Test Loss: 1.194 Test Acc: 0.480
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.3269703388214111
Epoch: 30, Steps: 4 | Train Loss: 0.096 Vali Loss: 1.167 Vali Acc: 0.560 Test Loss: 1.167 Test Acc: 0.560
Validation loss decreased (-0.539989 --> -0.559988).  Saving model ...
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm8_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 215741
model size : 0.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm8_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.217721462249756
Epoch: 1, Steps: 4 | Train Loss: 1.739 Vali Loss: 1.580 Vali Acc: 0.160 Test Loss: 1.580 Test Acc: 0.160
Validation loss decreased (inf --> -0.159984).  Saving model ...
Epoch: 2 cost time: 1.3561971187591553
Epoch: 2, Steps: 4 | Train Loss: 1.585 Vali Loss: 1.570 Vali Acc: 0.180 Test Loss: 1.570 Test Acc: 0.180
Validation loss decreased (-0.159984 --> -0.179984).  Saving model ...
Epoch: 3 cost time: 1.3096482753753662
Epoch: 3, Steps: 4 | Train Loss: 1.557 Vali Loss: 1.553 Vali Acc: 0.240 Test Loss: 1.553 Test Acc: 0.240
Validation loss decreased (-0.179984 --> -0.239984).  Saving model ...
Epoch: 4 cost time: 1.382491111755371
Epoch: 4, Steps: 4 | Train Loss: 1.530 Vali Loss: 1.538 Vali Acc: 0.320 Test Loss: 1.538 Test Acc: 0.320
Validation loss decreased (-0.239984 --> -0.319985).  Saving model ...
Epoch: 5 cost time: 1.390723705291748
Epoch: 5, Steps: 4 | Train Loss: 1.458 Vali Loss: 1.527 Vali Acc: 0.340 Test Loss: 1.527 Test Acc: 0.340
Validation loss decreased (-0.319985 --> -0.339985).  Saving model ...
Epoch: 6 cost time: 1.3787612915039062
Epoch: 6, Steps: 4 | Train Loss: 1.446 Vali Loss: 1.523 Vali Acc: 0.320 Test Loss: 1.523 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4517035484313965
Epoch: 7, Steps: 4 | Train Loss: 1.310 Vali Loss: 1.519 Vali Acc: 0.300 Test Loss: 1.519 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.4228758811950684
Epoch: 8, Steps: 4 | Train Loss: 1.305 Vali Loss: 1.496 Vali Acc: 0.320 Test Loss: 1.496 Test Acc: 0.320
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.4117579460144043
Epoch: 9, Steps: 4 | Train Loss: 1.189 Vali Loss: 1.473 Vali Acc: 0.340 Test Loss: 1.473 Test Acc: 0.340
Validation loss decreased (-0.339985 --> -0.339985).  Saving model ...
Epoch: 10 cost time: 1.3778650760650635
Epoch: 10, Steps: 4 | Train Loss: 1.121 Vali Loss: 1.443 Vali Acc: 0.340 Test Loss: 1.443 Test Acc: 0.340
Validation loss decreased (-0.339985 --> -0.339986).  Saving model ...
Epoch: 11 cost time: 1.4523978233337402
Epoch: 11, Steps: 4 | Train Loss: 0.974 Vali Loss: 1.391 Vali Acc: 0.400 Test Loss: 1.391 Test Acc: 0.400
Validation loss decreased (-0.339986 --> -0.399986).  Saving model ...
Epoch: 12 cost time: 1.357086181640625
Epoch: 12, Steps: 4 | Train Loss: 0.895 Vali Loss: 1.344 Vali Acc: 0.400 Test Loss: 1.344 Test Acc: 0.400
Validation loss decreased (-0.399986 --> -0.399987).  Saving model ...
Epoch: 13 cost time: 1.3949296474456787
Epoch: 13, Steps: 4 | Train Loss: 0.869 Vali Loss: 1.303 Vali Acc: 0.400 Test Loss: 1.303 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 14 cost time: 1.3192179203033447
Epoch: 14, Steps: 4 | Train Loss: 0.714 Vali Loss: 1.257 Vali Acc: 0.380 Test Loss: 1.257 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3623571395874023
Epoch: 15, Steps: 4 | Train Loss: 0.652 Vali Loss: 1.218 Vali Acc: 0.400 Test Loss: 1.218 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399988).  Saving model ...
Epoch: 16 cost time: 1.330653190612793
Epoch: 16, Steps: 4 | Train Loss: 0.651 Vali Loss: 1.210 Vali Acc: 0.380 Test Loss: 1.210 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3482587337493896
Epoch: 17, Steps: 4 | Train Loss: 0.691 Vali Loss: 1.194 Vali Acc: 0.380 Test Loss: 1.194 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.4076321125030518
Epoch: 18, Steps: 4 | Train Loss: 0.545 Vali Loss: 1.195 Vali Acc: 0.400 Test Loss: 1.195 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 19 cost time: 1.4262070655822754
Epoch: 19, Steps: 4 | Train Loss: 0.459 Vali Loss: 1.211 Vali Acc: 0.400 Test Loss: 1.211 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.429455041885376
Epoch: 20, Steps: 4 | Train Loss: 0.451 Vali Loss: 1.238 Vali Acc: 0.420 Test Loss: 1.238 Test Acc: 0.420
Validation loss decreased (-0.399988 --> -0.419988).  Saving model ...
Epoch: 21 cost time: 1.3995487689971924
Epoch: 21, Steps: 4 | Train Loss: 0.380 Vali Loss: 1.257 Vali Acc: 0.400 Test Loss: 1.257 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.4470598697662354
Epoch: 22, Steps: 4 | Train Loss: 0.386 Vali Loss: 1.274 Vali Acc: 0.440 Test Loss: 1.274 Test Acc: 0.440
Validation loss decreased (-0.419988 --> -0.439987).  Saving model ...
Epoch: 23 cost time: 1.352233648300171
Epoch: 23, Steps: 4 | Train Loss: 0.337 Vali Loss: 1.383 Vali Acc: 0.420 Test Loss: 1.383 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.619431734085083
Epoch: 24, Steps: 4 | Train Loss: 0.315 Vali Loss: 1.331 Vali Acc: 0.460 Test Loss: 1.331 Test Acc: 0.460
Validation loss decreased (-0.439987 --> -0.459987).  Saving model ...
Epoch: 25 cost time: 1.4240198135375977
Epoch: 25, Steps: 4 | Train Loss: 0.246 Vali Loss: 1.309 Vali Acc: 0.400 Test Loss: 1.309 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.3890914916992188
Epoch: 26, Steps: 4 | Train Loss: 0.277 Vali Loss: 1.297 Vali Acc: 0.480 Test Loss: 1.297 Test Acc: 0.480
Validation loss decreased (-0.459987 --> -0.479987).  Saving model ...
Epoch: 27 cost time: 1.4138128757476807
Epoch: 27, Steps: 4 | Train Loss: 0.293 Vali Loss: 1.387 Vali Acc: 0.400 Test Loss: 1.387 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.4131669998168945
Epoch: 28, Steps: 4 | Train Loss: 0.351 Vali Loss: 1.757 Vali Acc: 0.240 Test Loss: 1.757 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.2689509391784668
Epoch: 29, Steps: 4 | Train Loss: 0.456 Vali Loss: 1.431 Vali Acc: 0.360 Test Loss: 1.431 Test Acc: 0.360
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.4071462154388428
Epoch: 30, Steps: 4 | Train Loss: 0.200 Vali Loss: 1.364 Vali Acc: 0.360 Test Loss: 1.364 Test Acc: 0.360
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm8_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.48
model parameter : 629725
model size : 2.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm8_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.29355525970459
Epoch: 1, Steps: 4 | Train Loss: 1.622 Vali Loss: 1.641 Vali Acc: 0.240 Test Loss: 1.641 Test Acc: 0.240
Validation loss decreased (inf --> -0.239984).  Saving model ...
Epoch: 2 cost time: 1.2188241481781006
Epoch: 2, Steps: 4 | Train Loss: 1.542 Vali Loss: 1.625 Vali Acc: 0.280 Test Loss: 1.625 Test Acc: 0.280
Validation loss decreased (-0.239984 --> -0.279984).  Saving model ...
Epoch: 3 cost time: 1.1846606731414795
Epoch: 3, Steps: 4 | Train Loss: 1.511 Vali Loss: 1.600 Vali Acc: 0.280 Test Loss: 1.600 Test Acc: 0.280
Validation loss decreased (-0.279984 --> -0.279984).  Saving model ...
Epoch: 4 cost time: 1.220064640045166
Epoch: 4, Steps: 4 | Train Loss: 1.503 Vali Loss: 1.575 Vali Acc: 0.280 Test Loss: 1.575 Test Acc: 0.280
Validation loss decreased (-0.279984 --> -0.279984).  Saving model ...
Epoch: 5 cost time: 1.1526083946228027
Epoch: 5, Steps: 4 | Train Loss: 1.395 Vali Loss: 1.545 Vali Acc: 0.340 Test Loss: 1.545 Test Acc: 0.340
Validation loss decreased (-0.279984 --> -0.339985).  Saving model ...
Epoch: 6 cost time: 1.1391150951385498
Epoch: 6, Steps: 4 | Train Loss: 1.360 Vali Loss: 1.509 Vali Acc: 0.340 Test Loss: 1.509 Test Acc: 0.340
Validation loss decreased (-0.339985 --> -0.339985).  Saving model ...
Epoch: 7 cost time: 1.1214370727539062
Epoch: 7, Steps: 4 | Train Loss: 1.277 Vali Loss: 1.473 Vali Acc: 0.360 Test Loss: 1.473 Test Acc: 0.360
Validation loss decreased (-0.339985 --> -0.359985).  Saving model ...
Epoch: 8 cost time: 1.025984525680542
Epoch: 8, Steps: 4 | Train Loss: 1.176 Vali Loss: 1.440 Vali Acc: 0.360 Test Loss: 1.440 Test Acc: 0.360
Validation loss decreased (-0.359985 --> -0.359986).  Saving model ...
Epoch: 9 cost time: 0.9966182708740234
Epoch: 9, Steps: 4 | Train Loss: 1.285 Vali Loss: 1.410 Vali Acc: 0.380 Test Loss: 1.410 Test Acc: 0.380
Validation loss decreased (-0.359986 --> -0.379986).  Saving model ...
Epoch: 10 cost time: 1.1518633365631104
Epoch: 10, Steps: 4 | Train Loss: 0.979 Vali Loss: 1.369 Vali Acc: 0.440 Test Loss: 1.369 Test Acc: 0.440
Validation loss decreased (-0.379986 --> -0.439986).  Saving model ...
Epoch: 11 cost time: 1.2356488704681396
Epoch: 11, Steps: 4 | Train Loss: 1.054 Vali Loss: 1.349 Vali Acc: 0.440 Test Loss: 1.349 Test Acc: 0.440
Validation loss decreased (-0.439986 --> -0.439987).  Saving model ...
Epoch: 12 cost time: 1.0979397296905518
Epoch: 12, Steps: 4 | Train Loss: 0.935 Vali Loss: 1.330 Vali Acc: 0.420 Test Loss: 1.330 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1047773361206055
Epoch: 13, Steps: 4 | Train Loss: 0.863 Vali Loss: 1.309 Vali Acc: 0.420 Test Loss: 1.309 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.0812947750091553
Epoch: 14, Steps: 4 | Train Loss: 0.749 Vali Loss: 1.288 Vali Acc: 0.420 Test Loss: 1.288 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.1298999786376953
Epoch: 15, Steps: 4 | Train Loss: 0.745 Vali Loss: 1.246 Vali Acc: 0.460 Test Loss: 1.246 Test Acc: 0.460
Validation loss decreased (-0.439987 --> -0.459988).  Saving model ...
Epoch: 16 cost time: 1.0638136863708496
Epoch: 16, Steps: 4 | Train Loss: 0.681 Vali Loss: 1.216 Vali Acc: 0.500 Test Loss: 1.216 Test Acc: 0.500
Validation loss decreased (-0.459988 --> -0.499988).  Saving model ...
Epoch: 17 cost time: 1.184924840927124
Epoch: 17, Steps: 4 | Train Loss: 0.535 Vali Loss: 1.218 Vali Acc: 0.440 Test Loss: 1.218 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.12056565284729
Epoch: 18, Steps: 4 | Train Loss: 0.486 Vali Loss: 1.181 Vali Acc: 0.460 Test Loss: 1.181 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.1134982109069824
Epoch: 19, Steps: 4 | Train Loss: 0.467 Vali Loss: 1.109 Vali Acc: 0.480 Test Loss: 1.109 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.156233549118042
Epoch: 20, Steps: 4 | Train Loss: 0.587 Vali Loss: 1.111 Vali Acc: 0.520 Test Loss: 1.111 Test Acc: 0.520
Validation loss decreased (-0.499988 --> -0.519989).  Saving model ...
Epoch: 21 cost time: 1.0792043209075928
Epoch: 21, Steps: 4 | Train Loss: 0.419 Vali Loss: 1.121 Vali Acc: 0.500 Test Loss: 1.121 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.1803302764892578
Epoch: 22, Steps: 4 | Train Loss: 0.315 Vali Loss: 1.090 Vali Acc: 0.500 Test Loss: 1.090 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.1905927658081055
Epoch: 23, Steps: 4 | Train Loss: 0.255 Vali Loss: 1.071 Vali Acc: 0.480 Test Loss: 1.071 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.2005317211151123
Epoch: 24, Steps: 4 | Train Loss: 0.271 Vali Loss: 1.076 Vali Acc: 0.500 Test Loss: 1.076 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.1646952629089355
Epoch: 25, Steps: 4 | Train Loss: 0.278 Vali Loss: 1.135 Vali Acc: 0.460 Test Loss: 1.135 Test Acc: 0.460
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.2016403675079346
Epoch: 26, Steps: 4 | Train Loss: 0.230 Vali Loss: 1.081 Vali Acc: 0.520 Test Loss: 1.081 Test Acc: 0.520
Validation loss decreased (-0.519989 --> -0.519989).  Saving model ...
Epoch: 27 cost time: 1.1927196979522705
Epoch: 27, Steps: 4 | Train Loss: 0.185 Vali Loss: 1.108 Vali Acc: 0.440 Test Loss: 1.108 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.0889487266540527
Epoch: 28, Steps: 4 | Train Loss: 0.426 Vali Loss: 1.134 Vali Acc: 0.520 Test Loss: 1.134 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.2150895595550537
Epoch: 29, Steps: 4 | Train Loss: 0.198 Vali Loss: 1.133 Vali Acc: 0.500 Test Loss: 1.133 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.0723106861114502
Epoch: 30, Steps: 4 | Train Loss: 0.187 Vali Loss: 1.104 Vali Acc: 0.540 Test Loss: 1.104 Test Acc: 0.540
Validation loss decreased (-0.519989 --> -0.539989).  Saving model ...
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm8_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 215741
model size : 0.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm8_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.5660560131073
Epoch: 1, Steps: 4 | Train Loss: 1.696 Vali Loss: 1.610 Vali Acc: 0.240 Test Loss: 1.610 Test Acc: 0.240
Validation loss decreased (inf --> -0.239984).  Saving model ...
Epoch: 2 cost time: 1.4360506534576416
Epoch: 2, Steps: 4 | Train Loss: 1.632 Vali Loss: 1.601 Vali Acc: 0.260 Test Loss: 1.601 Test Acc: 0.260
Validation loss decreased (-0.239984 --> -0.259984).  Saving model ...
Epoch: 3 cost time: 1.450838565826416
Epoch: 3, Steps: 4 | Train Loss: 1.702 Vali Loss: 1.590 Vali Acc: 0.320 Test Loss: 1.590 Test Acc: 0.320
Validation loss decreased (-0.259984 --> -0.319984).  Saving model ...
Epoch: 4 cost time: 1.4619619846343994
Epoch: 4, Steps: 4 | Train Loss: 1.623 Vali Loss: 1.580 Vali Acc: 0.300 Test Loss: 1.580 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4408597946166992
Epoch: 5, Steps: 4 | Train Loss: 1.513 Vali Loss: 1.574 Vali Acc: 0.320 Test Loss: 1.574 Test Acc: 0.320
Validation loss decreased (-0.319984 --> -0.319984).  Saving model ...
Epoch: 6 cost time: 1.45680570602417
Epoch: 6, Steps: 4 | Train Loss: 1.452 Vali Loss: 1.569 Vali Acc: 0.320 Test Loss: 1.569 Test Acc: 0.320
Validation loss decreased (-0.319984 --> -0.319984).  Saving model ...
Epoch: 7 cost time: 1.6674046516418457
Epoch: 7, Steps: 4 | Train Loss: 1.345 Vali Loss: 1.566 Vali Acc: 0.280 Test Loss: 1.566 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6016972064971924
Epoch: 8, Steps: 4 | Train Loss: 1.377 Vali Loss: 1.559 Vali Acc: 0.280 Test Loss: 1.559 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.687920093536377
Epoch: 9, Steps: 4 | Train Loss: 1.291 Vali Loss: 1.538 Vali Acc: 0.320 Test Loss: 1.538 Test Acc: 0.320
Validation loss decreased (-0.319984 --> -0.319985).  Saving model ...
Epoch: 10 cost time: 1.5875539779663086
Epoch: 10, Steps: 4 | Train Loss: 1.149 Vali Loss: 1.522 Vali Acc: 0.340 Test Loss: 1.522 Test Acc: 0.340
Validation loss decreased (-0.319985 --> -0.339985).  Saving model ...
Epoch: 11 cost time: 1.76090669631958
Epoch: 11, Steps: 4 | Train Loss: 1.135 Vali Loss: 1.499 Vali Acc: 0.380 Test Loss: 1.499 Test Acc: 0.380
Validation loss decreased (-0.339985 --> -0.379985).  Saving model ...
Epoch: 12 cost time: 1.6564288139343262
Epoch: 12, Steps: 4 | Train Loss: 1.116 Vali Loss: 1.463 Vali Acc: 0.400 Test Loss: 1.463 Test Acc: 0.400
Validation loss decreased (-0.379985 --> -0.399985).  Saving model ...
Epoch: 13 cost time: 1.6829993724822998
Epoch: 13, Steps: 4 | Train Loss: 1.041 Vali Loss: 1.410 Vali Acc: 0.440 Test Loss: 1.410 Test Acc: 0.440
Validation loss decreased (-0.399985 --> -0.439986).  Saving model ...
Epoch: 14 cost time: 1.7287845611572266
Epoch: 14, Steps: 4 | Train Loss: 0.918 Vali Loss: 1.350 Vali Acc: 0.440 Test Loss: 1.350 Test Acc: 0.440
Validation loss decreased (-0.439986 --> -0.439986).  Saving model ...
Epoch: 15 cost time: 1.6345481872558594
Epoch: 15, Steps: 4 | Train Loss: 0.844 Vali Loss: 1.310 Vali Acc: 0.440 Test Loss: 1.310 Test Acc: 0.440
Validation loss decreased (-0.439986 --> -0.439987).  Saving model ...
Epoch: 16 cost time: 1.7483422756195068
Epoch: 16, Steps: 4 | Train Loss: 0.739 Vali Loss: 1.256 Vali Acc: 0.420 Test Loss: 1.256 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.7246320247650146
Epoch: 17, Steps: 4 | Train Loss: 0.740 Vali Loss: 1.261 Vali Acc: 0.440 Test Loss: 1.261 Test Acc: 0.440
Validation loss decreased (-0.439987 --> -0.439987).  Saving model ...
Epoch: 18 cost time: 1.7102322578430176
Epoch: 18, Steps: 4 | Train Loss: 0.906 Vali Loss: 1.271 Vali Acc: 0.400 Test Loss: 1.271 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.753999948501587
Epoch: 19, Steps: 4 | Train Loss: 0.507 Vali Loss: 1.120 Vali Acc: 0.460 Test Loss: 1.120 Test Acc: 0.460
Validation loss decreased (-0.439987 --> -0.459989).  Saving model ...
Epoch: 20 cost time: 1.6528675556182861
Epoch: 20, Steps: 4 | Train Loss: 0.484 Vali Loss: 1.101 Vali Acc: 0.480 Test Loss: 1.101 Test Acc: 0.480
Validation loss decreased (-0.459989 --> -0.479989).  Saving model ...
Epoch: 21 cost time: 1.7394328117370605
Epoch: 21, Steps: 4 | Train Loss: 0.435 Vali Loss: 1.199 Vali Acc: 0.420 Test Loss: 1.199 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.6187717914581299
Epoch: 22, Steps: 4 | Train Loss: 0.423 Vali Loss: 1.072 Vali Acc: 0.500 Test Loss: 1.072 Test Acc: 0.500
Validation loss decreased (-0.479989 --> -0.499989).  Saving model ...
Epoch: 23 cost time: 1.6879198551177979
Epoch: 23, Steps: 4 | Train Loss: 0.402 Vali Loss: 1.045 Vali Acc: 0.500 Test Loss: 1.045 Test Acc: 0.500
Validation loss decreased (-0.499989 --> -0.499990).  Saving model ...
Epoch: 24 cost time: 1.7080707550048828
Epoch: 24, Steps: 4 | Train Loss: 0.321 Vali Loss: 1.089 Vali Acc: 0.500 Test Loss: 1.089 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.7365987300872803
Epoch: 25, Steps: 4 | Train Loss: 0.284 Vali Loss: 1.073 Vali Acc: 0.520 Test Loss: 1.073 Test Acc: 0.520
Validation loss decreased (-0.499990 --> -0.519989).  Saving model ...
Epoch: 26 cost time: 1.8378667831420898
Epoch: 26, Steps: 4 | Train Loss: 0.297 Vali Loss: 1.081 Vali Acc: 0.540 Test Loss: 1.081 Test Acc: 0.540
Validation loss decreased (-0.519989 --> -0.539989).  Saving model ...
Epoch: 27 cost time: 1.6487646102905273
Epoch: 27, Steps: 4 | Train Loss: 0.231 Vali Loss: 0.984 Vali Acc: 0.560 Test Loss: 0.984 Test Acc: 0.560
Validation loss decreased (-0.539989 --> -0.559990).  Saving model ...
Epoch: 28 cost time: 1.6523890495300293
Epoch: 28, Steps: 4 | Train Loss: 0.228 Vali Loss: 1.025 Vali Acc: 0.520 Test Loss: 1.025 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.6929020881652832
Epoch: 29, Steps: 4 | Train Loss: 0.178 Vali Loss: 1.136 Vali Acc: 0.500 Test Loss: 1.136 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.605816125869751
Epoch: 30, Steps: 4 | Train Loss: 0.191 Vali Loss: 1.035 Vali Acc: 0.560 Test Loss: 1.035 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm8_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 336477
model size : 1.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm8_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.441102981567383
Epoch: 1, Steps: 4 | Train Loss: 1.666 Vali Loss: 1.595 Vali Acc: 0.240 Test Loss: 1.595 Test Acc: 0.240
Validation loss decreased (inf --> -0.239984).  Saving model ...
Epoch: 2 cost time: 1.2698123455047607
Epoch: 2, Steps: 4 | Train Loss: 1.525 Vali Loss: 1.590 Vali Acc: 0.280 Test Loss: 1.590 Test Acc: 0.280
Validation loss decreased (-0.239984 --> -0.279984).  Saving model ...
Epoch: 3 cost time: 1.3689601421356201
Epoch: 3, Steps: 4 | Train Loss: 1.585 Vali Loss: 1.582 Vali Acc: 0.260 Test Loss: 1.582 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2389764785766602
Epoch: 4, Steps: 4 | Train Loss: 1.433 Vali Loss: 1.575 Vali Acc: 0.260 Test Loss: 1.575 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.3148317337036133
Epoch: 5, Steps: 4 | Train Loss: 1.458 Vali Loss: 1.561 Vali Acc: 0.320 Test Loss: 1.561 Test Acc: 0.320
Validation loss decreased (-0.279984 --> -0.319984).  Saving model ...
Epoch: 6 cost time: 1.3332524299621582
Epoch: 6, Steps: 4 | Train Loss: 1.358 Vali Loss: 1.541 Vali Acc: 0.320 Test Loss: 1.541 Test Acc: 0.320
Validation loss decreased (-0.319984 --> -0.319985).  Saving model ...
Epoch: 7 cost time: 1.3030107021331787
Epoch: 7, Steps: 4 | Train Loss: 1.434 Vali Loss: 1.518 Vali Acc: 0.400 Test Loss: 1.518 Test Acc: 0.400
Validation loss decreased (-0.319985 --> -0.399985).  Saving model ...
Epoch: 8 cost time: 1.331775188446045
Epoch: 8, Steps: 4 | Train Loss: 1.233 Vali Loss: 1.483 Vali Acc: 0.400 Test Loss: 1.483 Test Acc: 0.400
Validation loss decreased (-0.399985 --> -0.399985).  Saving model ...
Epoch: 9 cost time: 1.2080976963043213
Epoch: 9, Steps: 4 | Train Loss: 1.261 Vali Loss: 1.452 Vali Acc: 0.400 Test Loss: 1.452 Test Acc: 0.400
Validation loss decreased (-0.399985 --> -0.399985).  Saving model ...
Epoch: 10 cost time: 1.2340598106384277
Epoch: 10, Steps: 4 | Train Loss: 1.097 Vali Loss: 1.446 Vali Acc: 0.400 Test Loss: 1.446 Test Acc: 0.400
Validation loss decreased (-0.399985 --> -0.399986).  Saving model ...
Epoch: 11 cost time: 1.2172751426696777
Epoch: 11, Steps: 4 | Train Loss: 0.981 Vali Loss: 1.444 Vali Acc: 0.420 Test Loss: 1.444 Test Acc: 0.420
Validation loss decreased (-0.399986 --> -0.419986).  Saving model ...
Epoch: 12 cost time: 1.2219460010528564
Epoch: 12, Steps: 4 | Train Loss: 0.882 Vali Loss: 1.421 Vali Acc: 0.420 Test Loss: 1.421 Test Acc: 0.420
Validation loss decreased (-0.419986 --> -0.419986).  Saving model ...
Epoch: 13 cost time: 1.2740492820739746
Epoch: 13, Steps: 4 | Train Loss: 0.879 Vali Loss: 1.401 Vali Acc: 0.400 Test Loss: 1.401 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4373230934143066
Epoch: 14, Steps: 4 | Train Loss: 0.818 Vali Loss: 1.399 Vali Acc: 0.420 Test Loss: 1.399 Test Acc: 0.420
Validation loss decreased (-0.419986 --> -0.419986).  Saving model ...
Epoch: 15 cost time: 1.253023386001587
Epoch: 15, Steps: 4 | Train Loss: 0.766 Vali Loss: 1.406 Vali Acc: 0.400 Test Loss: 1.406 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2179267406463623
Epoch: 16, Steps: 4 | Train Loss: 0.738 Vali Loss: 1.338 Vali Acc: 0.420 Test Loss: 1.338 Test Acc: 0.420
Validation loss decreased (-0.419986 --> -0.419987).  Saving model ...
Epoch: 17 cost time: 1.3071041107177734
Epoch: 17, Steps: 4 | Train Loss: 0.667 Vali Loss: 1.357 Vali Acc: 0.440 Test Loss: 1.357 Test Acc: 0.440
Validation loss decreased (-0.419987 --> -0.439986).  Saving model ...
Epoch: 18 cost time: 1.188854694366455
Epoch: 18, Steps: 4 | Train Loss: 0.649 Vali Loss: 1.357 Vali Acc: 0.460 Test Loss: 1.357 Test Acc: 0.460
Validation loss decreased (-0.439986 --> -0.459986).  Saving model ...
Epoch: 19 cost time: 1.3133227825164795
Epoch: 19, Steps: 4 | Train Loss: 0.442 Vali Loss: 1.337 Vali Acc: 0.440 Test Loss: 1.337 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.190488338470459
Epoch: 20, Steps: 4 | Train Loss: 0.413 Vali Loss: 1.358 Vali Acc: 0.400 Test Loss: 1.358 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.258835792541504
Epoch: 21, Steps: 4 | Train Loss: 0.459 Vali Loss: 1.347 Vali Acc: 0.460 Test Loss: 1.347 Test Acc: 0.460
Validation loss decreased (-0.459986 --> -0.459987).  Saving model ...
Epoch: 22 cost time: 1.1711821556091309
Epoch: 22, Steps: 4 | Train Loss: 0.387 Vali Loss: 1.369 Vali Acc: 0.440 Test Loss: 1.369 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.3029303550720215
Epoch: 23, Steps: 4 | Train Loss: 0.369 Vali Loss: 1.447 Vali Acc: 0.340 Test Loss: 1.447 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.2298531532287598
Epoch: 24, Steps: 4 | Train Loss: 0.447 Vali Loss: 1.320 Vali Acc: 0.440 Test Loss: 1.320 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.2660439014434814
Epoch: 25, Steps: 4 | Train Loss: 0.286 Vali Loss: 1.339 Vali Acc: 0.460 Test Loss: 1.339 Test Acc: 0.460
Validation loss decreased (-0.459987 --> -0.459987).  Saving model ...
Epoch: 26 cost time: 1.1743266582489014
Epoch: 26, Steps: 4 | Train Loss: 0.245 Vali Loss: 1.420 Vali Acc: 0.460 Test Loss: 1.420 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.215766191482544
Epoch: 27, Steps: 4 | Train Loss: 0.245 Vali Loss: 1.374 Vali Acc: 0.480 Test Loss: 1.374 Test Acc: 0.480
Validation loss decreased (-0.459987 --> -0.479986).  Saving model ...
Epoch: 28 cost time: 1.2965128421783447
Epoch: 28, Steps: 4 | Train Loss: 0.205 Vali Loss: 1.384 Vali Acc: 0.360 Test Loss: 1.384 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.3957092761993408
Epoch: 29, Steps: 4 | Train Loss: 0.219 Vali Loss: 1.396 Vali Acc: 0.420 Test Loss: 1.396 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.3751804828643799
Epoch: 30, Steps: 4 | Train Loss: 0.183 Vali Loss: 1.455 Vali Acc: 0.420 Test Loss: 1.455 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm8_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.48
model parameter : 129469
model size : 0.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm8_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.413076400756836
Epoch: 1, Steps: 4 | Train Loss: 1.704 Vali Loss: 1.613 Vali Acc: 0.240 Test Loss: 1.613 Test Acc: 0.240
Validation loss decreased (inf --> -0.239984).  Saving model ...
Epoch: 2 cost time: 1.3544766902923584
Epoch: 2, Steps: 4 | Train Loss: 1.624 Vali Loss: 1.606 Vali Acc: 0.320 Test Loss: 1.606 Test Acc: 0.320
Validation loss decreased (-0.239984 --> -0.319984).  Saving model ...
Epoch: 3 cost time: 1.3594369888305664
Epoch: 3, Steps: 4 | Train Loss: 1.700 Vali Loss: 1.596 Vali Acc: 0.340 Test Loss: 1.596 Test Acc: 0.340
Validation loss decreased (-0.319984 --> -0.339984).  Saving model ...
Epoch: 4 cost time: 1.309035301208496
Epoch: 4, Steps: 4 | Train Loss: 1.619 Vali Loss: 1.587 Vali Acc: 0.300 Test Loss: 1.587 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3414223194122314
Epoch: 5, Steps: 4 | Train Loss: 1.508 Vali Loss: 1.582 Vali Acc: 0.340 Test Loss: 1.582 Test Acc: 0.340
Validation loss decreased (-0.339984 --> -0.339984).  Saving model ...
Epoch: 6 cost time: 1.2260818481445312
Epoch: 6, Steps: 4 | Train Loss: 1.453 Vali Loss: 1.577 Vali Acc: 0.340 Test Loss: 1.577 Test Acc: 0.340
Validation loss decreased (-0.339984 --> -0.339984).  Saving model ...
Epoch: 7 cost time: 1.3422207832336426
Epoch: 7, Steps: 4 | Train Loss: 1.340 Vali Loss: 1.573 Vali Acc: 0.300 Test Loss: 1.573 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3274650573730469
Epoch: 8, Steps: 4 | Train Loss: 1.373 Vali Loss: 1.568 Vali Acc: 0.300 Test Loss: 1.568 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.2631051540374756
Epoch: 9, Steps: 4 | Train Loss: 1.290 Vali Loss: 1.554 Vali Acc: 0.360 Test Loss: 1.554 Test Acc: 0.360
Validation loss decreased (-0.339984 --> -0.359984).  Saving model ...
Epoch: 10 cost time: 1.357102394104004
Epoch: 10, Steps: 4 | Train Loss: 1.144 Vali Loss: 1.544 Vali Acc: 0.360 Test Loss: 1.544 Test Acc: 0.360
Validation loss decreased (-0.359984 --> -0.359985).  Saving model ...
Epoch: 11 cost time: 1.293982744216919
Epoch: 11, Steps: 4 | Train Loss: 1.133 Vali Loss: 1.519 Vali Acc: 0.380 Test Loss: 1.519 Test Acc: 0.380
Validation loss decreased (-0.359985 --> -0.379985).  Saving model ...
Epoch: 12 cost time: 1.2829310894012451
Epoch: 12, Steps: 4 | Train Loss: 1.118 Vali Loss: 1.479 Vali Acc: 0.380 Test Loss: 1.479 Test Acc: 0.380
Validation loss decreased (-0.379985 --> -0.379985).  Saving model ...
Epoch: 13 cost time: 1.3169076442718506
Epoch: 13, Steps: 4 | Train Loss: 1.037 Vali Loss: 1.433 Vali Acc: 0.380 Test Loss: 1.433 Test Acc: 0.380
Validation loss decreased (-0.379985 --> -0.379986).  Saving model ...
Epoch: 14 cost time: 1.3183326721191406
Epoch: 14, Steps: 4 | Train Loss: 0.907 Vali Loss: 1.391 Vali Acc: 0.400 Test Loss: 1.391 Test Acc: 0.400
Validation loss decreased (-0.379986 --> -0.399986).  Saving model ...
Epoch: 15 cost time: 1.3324205875396729
Epoch: 15, Steps: 4 | Train Loss: 0.842 Vali Loss: 1.335 Vali Acc: 0.420 Test Loss: 1.335 Test Acc: 0.420
Validation loss decreased (-0.399986 --> -0.419987).  Saving model ...
Epoch: 16 cost time: 1.3304142951965332
Epoch: 16, Steps: 4 | Train Loss: 0.737 Vali Loss: 1.254 Vali Acc: 0.440 Test Loss: 1.254 Test Acc: 0.440
Validation loss decreased (-0.419987 --> -0.439987).  Saving model ...
Epoch: 17 cost time: 1.2607643604278564
Epoch: 17, Steps: 4 | Train Loss: 0.748 Vali Loss: 1.271 Vali Acc: 0.440 Test Loss: 1.271 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2856171131134033
Epoch: 18, Steps: 4 | Train Loss: 0.916 Vali Loss: 1.273 Vali Acc: 0.480 Test Loss: 1.273 Test Acc: 0.480
Validation loss decreased (-0.439987 --> -0.479987).  Saving model ...
Epoch: 19 cost time: 1.2141973972320557
Epoch: 19, Steps: 4 | Train Loss: 0.523 Vali Loss: 1.106 Vali Acc: 0.440 Test Loss: 1.106 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.2314114570617676
Epoch: 20, Steps: 4 | Train Loss: 0.501 Vali Loss: 1.083 Vali Acc: 0.460 Test Loss: 1.083 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.3653650283813477
Epoch: 21, Steps: 4 | Train Loss: 0.458 Vali Loss: 1.254 Vali Acc: 0.420 Test Loss: 1.254 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.2738122940063477
Epoch: 22, Steps: 4 | Train Loss: 0.476 Vali Loss: 1.027 Vali Acc: 0.500 Test Loss: 1.027 Test Acc: 0.500
Validation loss decreased (-0.479987 --> -0.499990).  Saving model ...
Epoch: 23 cost time: 1.250044822692871
Epoch: 23, Steps: 4 | Train Loss: 0.412 Vali Loss: 0.994 Vali Acc: 0.520 Test Loss: 0.994 Test Acc: 0.520
Validation loss decreased (-0.499990 --> -0.519990).  Saving model ...
Epoch: 24 cost time: 1.248610258102417
Epoch: 24, Steps: 4 | Train Loss: 0.347 Vali Loss: 1.137 Vali Acc: 0.460 Test Loss: 1.137 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.3632113933563232
Epoch: 25, Steps: 4 | Train Loss: 0.332 Vali Loss: 1.013 Vali Acc: 0.540 Test Loss: 1.013 Test Acc: 0.540
Validation loss decreased (-0.519990 --> -0.539990).  Saving model ...
Epoch: 26 cost time: 1.2736806869506836
Epoch: 26, Steps: 4 | Train Loss: 0.319 Vali Loss: 0.962 Vali Acc: 0.560 Test Loss: 0.962 Test Acc: 0.560
Validation loss decreased (-0.539990 --> -0.559990).  Saving model ...
Epoch: 27 cost time: 1.381155014038086
Epoch: 27, Steps: 4 | Train Loss: 0.251 Vali Loss: 0.969 Vali Acc: 0.560 Test Loss: 0.969 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.369990587234497
Epoch: 28, Steps: 4 | Train Loss: 0.179 Vali Loss: 0.979 Vali Acc: 0.520 Test Loss: 0.979 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.412010908126831
Epoch: 29, Steps: 4 | Train Loss: 0.190 Vali Loss: 1.025 Vali Acc: 0.480 Test Loss: 1.025 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.3130638599395752
Epoch: 30, Steps: 4 | Train Loss: 0.159 Vali Loss: 1.083 Vali Acc: 0.500 Test Loss: 1.083 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm8_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 336477
model size : 1.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm8_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.282480239868164
Epoch: 1, Steps: 4 | Train Loss: 1.666 Vali Loss: 1.595 Vali Acc: 0.240 Test Loss: 1.595 Test Acc: 0.240
Validation loss decreased (inf --> -0.239984).  Saving model ...
Epoch: 2 cost time: 1.1830449104309082
Epoch: 2, Steps: 4 | Train Loss: 1.530 Vali Loss: 1.589 Vali Acc: 0.280 Test Loss: 1.589 Test Acc: 0.280
Validation loss decreased (-0.239984 --> -0.279984).  Saving model ...
Epoch: 3 cost time: 1.219508171081543
Epoch: 3, Steps: 4 | Train Loss: 1.589 Vali Loss: 1.581 Vali Acc: 0.260 Test Loss: 1.581 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.24617338180542
Epoch: 4, Steps: 4 | Train Loss: 1.429 Vali Loss: 1.573 Vali Acc: 0.280 Test Loss: 1.573 Test Acc: 0.280
Validation loss decreased (-0.279984 --> -0.279984).  Saving model ...
Epoch: 5 cost time: 1.2995641231536865
Epoch: 5, Steps: 4 | Train Loss: 1.464 Vali Loss: 1.560 Vali Acc: 0.320 Test Loss: 1.560 Test Acc: 0.320
Validation loss decreased (-0.279984 --> -0.319984).  Saving model ...
Epoch: 6 cost time: 1.1537964344024658
Epoch: 6, Steps: 4 | Train Loss: 1.359 Vali Loss: 1.540 Vali Acc: 0.300 Test Loss: 1.540 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1231038570404053
Epoch: 7, Steps: 4 | Train Loss: 1.432 Vali Loss: 1.516 Vali Acc: 0.420 Test Loss: 1.516 Test Acc: 0.420
Validation loss decreased (-0.319984 --> -0.419985).  Saving model ...
Epoch: 8 cost time: 1.155548095703125
Epoch: 8, Steps: 4 | Train Loss: 1.238 Vali Loss: 1.479 Vali Acc: 0.360 Test Loss: 1.479 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2395973205566406
Epoch: 9, Steps: 4 | Train Loss: 1.256 Vali Loss: 1.447 Vali Acc: 0.380 Test Loss: 1.447 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.1550860404968262
Epoch: 10, Steps: 4 | Train Loss: 1.102 Vali Loss: 1.437 Vali Acc: 0.400 Test Loss: 1.437 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.2816824913024902
Epoch: 11, Steps: 4 | Train Loss: 0.969 Vali Loss: 1.423 Vali Acc: 0.400 Test Loss: 1.423 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.1218338012695312
Epoch: 12, Steps: 4 | Train Loss: 0.865 Vali Loss: 1.409 Vali Acc: 0.400 Test Loss: 1.409 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.0985815525054932
Epoch: 13, Steps: 4 | Train Loss: 0.876 Vali Loss: 1.396 Vali Acc: 0.400 Test Loss: 1.396 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.2043020725250244
Epoch: 14, Steps: 4 | Train Loss: 0.802 Vali Loss: 1.384 Vali Acc: 0.380 Test Loss: 1.384 Test Acc: 0.380
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.1272144317626953
Epoch: 15, Steps: 4 | Train Loss: 0.761 Vali Loss: 1.384 Vali Acc: 0.380 Test Loss: 1.384 Test Acc: 0.380
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.1955950260162354
Epoch: 16, Steps: 4 | Train Loss: 0.717 Vali Loss: 1.334 Vali Acc: 0.420 Test Loss: 1.334 Test Acc: 0.420
Validation loss decreased (-0.419985 --> -0.419987).  Saving model ...
Epoch: 17 cost time: 1.1561059951782227
Epoch: 17, Steps: 4 | Train Loss: 0.645 Vali Loss: 1.361 Vali Acc: 0.400 Test Loss: 1.361 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2320876121520996
Epoch: 18, Steps: 4 | Train Loss: 0.676 Vali Loss: 1.344 Vali Acc: 0.400 Test Loss: 1.344 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.219334363937378
Epoch: 19, Steps: 4 | Train Loss: 0.444 Vali Loss: 1.318 Vali Acc: 0.420 Test Loss: 1.318 Test Acc: 0.420
Validation loss decreased (-0.419987 --> -0.419987).  Saving model ...
Epoch: 20 cost time: 1.1602063179016113
Epoch: 20, Steps: 4 | Train Loss: 0.399 Vali Loss: 1.355 Vali Acc: 0.360 Test Loss: 1.355 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.1108677387237549
Epoch: 21, Steps: 4 | Train Loss: 0.470 Vali Loss: 1.317 Vali Acc: 0.440 Test Loss: 1.317 Test Acc: 0.440
Validation loss decreased (-0.419987 --> -0.439987).  Saving model ...
Epoch: 22 cost time: 1.1260206699371338
Epoch: 22, Steps: 4 | Train Loss: 0.391 Vali Loss: 1.319 Vali Acc: 0.460 Test Loss: 1.319 Test Acc: 0.460
Validation loss decreased (-0.439987 --> -0.459987).  Saving model ...
Epoch: 23 cost time: 1.1810972690582275
Epoch: 23, Steps: 4 | Train Loss: 0.350 Vali Loss: 1.393 Vali Acc: 0.320 Test Loss: 1.393 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.0693871974945068
Epoch: 24, Steps: 4 | Train Loss: 0.481 Vali Loss: 1.302 Vali Acc: 0.420 Test Loss: 1.302 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.1909005641937256
Epoch: 25, Steps: 4 | Train Loss: 0.278 Vali Loss: 1.327 Vali Acc: 0.520 Test Loss: 1.327 Test Acc: 0.520
Validation loss decreased (-0.459987 --> -0.519987).  Saving model ...
Epoch: 26 cost time: 1.1610941886901855
Epoch: 26, Steps: 4 | Train Loss: 0.250 Vali Loss: 1.362 Vali Acc: 0.480 Test Loss: 1.362 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.1172103881835938
Epoch: 27, Steps: 4 | Train Loss: 0.238 Vali Loss: 1.313 Vali Acc: 0.500 Test Loss: 1.313 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.0869512557983398
Epoch: 28, Steps: 4 | Train Loss: 0.195 Vali Loss: 1.283 Vali Acc: 0.500 Test Loss: 1.283 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.134805679321289
Epoch: 29, Steps: 4 | Train Loss: 0.220 Vali Loss: 1.294 Vali Acc: 0.480 Test Loss: 1.294 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.136122703552246
Epoch: 30, Steps: 4 | Train Loss: 0.162 Vali Loss: 1.303 Vali Acc: 0.480 Test Loss: 1.303 Test Acc: 0.480
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm8_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.52
model parameter : 129469
model size : 0.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm8_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.289517879486084
Epoch: 1, Steps: 4 | Train Loss: 1.702 Vali Loss: 1.622 Vali Acc: 0.260 Test Loss: 1.622 Test Acc: 0.260
Validation loss decreased (inf --> -0.259984).  Saving model ...
Epoch: 2 cost time: 1.141627550125122
Epoch: 2, Steps: 4 | Train Loss: 1.620 Vali Loss: 1.615 Vali Acc: 0.280 Test Loss: 1.615 Test Acc: 0.280
Validation loss decreased (-0.259984 --> -0.279984).  Saving model ...
Epoch: 3 cost time: 1.1342179775238037
Epoch: 3, Steps: 4 | Train Loss: 1.694 Vali Loss: 1.605 Vali Acc: 0.340 Test Loss: 1.605 Test Acc: 0.340
Validation loss decreased (-0.279984 --> -0.339984).  Saving model ...
Epoch: 4 cost time: 1.1233899593353271
Epoch: 4, Steps: 4 | Train Loss: 1.616 Vali Loss: 1.597 Vali Acc: 0.280 Test Loss: 1.597 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1913974285125732
Epoch: 5, Steps: 4 | Train Loss: 1.511 Vali Loss: 1.591 Vali Acc: 0.300 Test Loss: 1.591 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1472907066345215
Epoch: 6, Steps: 4 | Train Loss: 1.444 Vali Loss: 1.587 Vali Acc: 0.280 Test Loss: 1.587 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.0676701068878174
Epoch: 7, Steps: 4 | Train Loss: 1.344 Vali Loss: 1.584 Vali Acc: 0.280 Test Loss: 1.584 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.1423346996307373
Epoch: 8, Steps: 4 | Train Loss: 1.373 Vali Loss: 1.579 Vali Acc: 0.300 Test Loss: 1.579 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.1836552619934082
Epoch: 9, Steps: 4 | Train Loss: 1.306 Vali Loss: 1.565 Vali Acc: 0.340 Test Loss: 1.565 Test Acc: 0.340
Validation loss decreased (-0.339984 --> -0.339984).  Saving model ...
Epoch: 10 cost time: 1.0553345680236816
Epoch: 10, Steps: 4 | Train Loss: 1.147 Vali Loss: 1.558 Vali Acc: 0.360 Test Loss: 1.558 Test Acc: 0.360
Validation loss decreased (-0.339984 --> -0.359984).  Saving model ...
Epoch: 11 cost time: 1.1806116104125977
Epoch: 11, Steps: 4 | Train Loss: 1.136 Vali Loss: 1.545 Vali Acc: 0.360 Test Loss: 1.545 Test Acc: 0.360
Validation loss decreased (-0.359984 --> -0.359985).  Saving model ...
Epoch: 12 cost time: 1.1489732265472412
Epoch: 12, Steps: 4 | Train Loss: 1.126 Vali Loss: 1.510 Vali Acc: 0.380 Test Loss: 1.510 Test Acc: 0.380
Validation loss decreased (-0.359985 --> -0.379985).  Saving model ...
Epoch: 13 cost time: 1.1816973686218262
Epoch: 13, Steps: 4 | Train Loss: 1.032 Vali Loss: 1.455 Vali Acc: 0.400 Test Loss: 1.455 Test Acc: 0.400
Validation loss decreased (-0.379985 --> -0.399985).  Saving model ...
Epoch: 14 cost time: 1.176213264465332
Epoch: 14, Steps: 4 | Train Loss: 0.923 Vali Loss: 1.404 Vali Acc: 0.360 Test Loss: 1.404 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2003693580627441
Epoch: 15, Steps: 4 | Train Loss: 0.857 Vali Loss: 1.371 Vali Acc: 0.440 Test Loss: 1.371 Test Acc: 0.440
Validation loss decreased (-0.399985 --> -0.439986).  Saving model ...
Epoch: 16 cost time: 1.2055821418762207
Epoch: 16, Steps: 4 | Train Loss: 0.760 Vali Loss: 1.302 Vali Acc: 0.420 Test Loss: 1.302 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0330967903137207
Epoch: 17, Steps: 4 | Train Loss: 0.779 Vali Loss: 1.313 Vali Acc: 0.440 Test Loss: 1.313 Test Acc: 0.440
Validation loss decreased (-0.439986 --> -0.439987).  Saving model ...
Epoch: 18 cost time: 1.0135064125061035
Epoch: 18, Steps: 4 | Train Loss: 0.927 Vali Loss: 1.309 Vali Acc: 0.480 Test Loss: 1.309 Test Acc: 0.480
Validation loss decreased (-0.439987 --> -0.479987).  Saving model ...
Epoch: 19 cost time: 1.1695566177368164
Epoch: 19, Steps: 4 | Train Loss: 0.532 Vali Loss: 1.149 Vali Acc: 0.440 Test Loss: 1.149 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1323273181915283
Epoch: 20, Steps: 4 | Train Loss: 0.522 Vali Loss: 1.114 Vali Acc: 0.440 Test Loss: 1.114 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.124190092086792
Epoch: 21, Steps: 4 | Train Loss: 0.483 Vali Loss: 1.258 Vali Acc: 0.420 Test Loss: 1.258 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.1477196216583252
Epoch: 22, Steps: 4 | Train Loss: 0.496 Vali Loss: 1.166 Vali Acc: 0.420 Test Loss: 1.166 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.130458116531372
Epoch: 23, Steps: 4 | Train Loss: 0.470 Vali Loss: 1.111 Vali Acc: 0.440 Test Loss: 1.111 Test Acc: 0.440
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.1624269485473633
Epoch: 24, Steps: 4 | Train Loss: 0.409 Vali Loss: 1.197 Vali Acc: 0.420 Test Loss: 1.197 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.1359100341796875
Epoch: 25, Steps: 4 | Train Loss: 0.395 Vali Loss: 1.138 Vali Acc: 0.480 Test Loss: 1.138 Test Acc: 0.480
Validation loss decreased (-0.479987 --> -0.479989).  Saving model ...
Epoch: 26 cost time: 1.1321239471435547
Epoch: 26, Steps: 4 | Train Loss: 0.338 Vali Loss: 1.057 Vali Acc: 0.560 Test Loss: 1.057 Test Acc: 0.560
Validation loss decreased (-0.479989 --> -0.559989).  Saving model ...
Epoch: 27 cost time: 1.3354411125183105
Epoch: 27, Steps: 4 | Train Loss: 0.315 Vali Loss: 1.007 Vali Acc: 0.500 Test Loss: 1.007 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.1876559257507324
Epoch: 28, Steps: 4 | Train Loss: 0.226 Vali Loss: 1.032 Vali Acc: 0.520 Test Loss: 1.032 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.226008653640747
Epoch: 29, Steps: 4 | Train Loss: 0.222 Vali Loss: 0.951 Vali Acc: 0.540 Test Loss: 0.951 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.3017420768737793
Epoch: 30, Steps: 4 | Train Loss: 0.228 Vali Loss: 1.077 Vali Acc: 0.480 Test Loss: 1.077 Test Acc: 0.480
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm8_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 336477
model size : 1.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm8_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.157505512237549
Epoch: 1, Steps: 4 | Train Loss: 1.680 Vali Loss: 1.599 Vali Acc: 0.200 Test Loss: 1.599 Test Acc: 0.200
Validation loss decreased (inf --> -0.199984).  Saving model ...
Epoch: 2 cost time: 1.2576723098754883
Epoch: 2, Steps: 4 | Train Loss: 1.526 Vali Loss: 1.594 Vali Acc: 0.240 Test Loss: 1.594 Test Acc: 0.240
Validation loss decreased (-0.199984 --> -0.239984).  Saving model ...
Epoch: 3 cost time: 1.2181882858276367
Epoch: 3, Steps: 4 | Train Loss: 1.589 Vali Loss: 1.583 Vali Acc: 0.220 Test Loss: 1.583 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1057178974151611
Epoch: 4, Steps: 4 | Train Loss: 1.437 Vali Loss: 1.574 Vali Acc: 0.260 Test Loss: 1.574 Test Acc: 0.260
Validation loss decreased (-0.239984 --> -0.259984).  Saving model ...
Epoch: 5 cost time: 1.1265549659729004
Epoch: 5, Steps: 4 | Train Loss: 1.475 Vali Loss: 1.556 Vali Acc: 0.320 Test Loss: 1.556 Test Acc: 0.320
Validation loss decreased (-0.259984 --> -0.319984).  Saving model ...
Epoch: 6 cost time: 1.1067140102386475
Epoch: 6, Steps: 4 | Train Loss: 1.344 Vali Loss: 1.533 Vali Acc: 0.400 Test Loss: 1.533 Test Acc: 0.400
Validation loss decreased (-0.319984 --> -0.399985).  Saving model ...
Epoch: 7 cost time: 1.2239322662353516
Epoch: 7, Steps: 4 | Train Loss: 1.407 Vali Loss: 1.507 Vali Acc: 0.420 Test Loss: 1.507 Test Acc: 0.420
Validation loss decreased (-0.399985 --> -0.419985).  Saving model ...
Epoch: 8 cost time: 1.096137285232544
Epoch: 8, Steps: 4 | Train Loss: 1.232 Vali Loss: 1.472 Vali Acc: 0.440 Test Loss: 1.472 Test Acc: 0.440
Validation loss decreased (-0.419985 --> -0.439985).  Saving model ...
Epoch: 9 cost time: 0.9927716255187988
Epoch: 9, Steps: 4 | Train Loss: 1.259 Vali Loss: 1.445 Vali Acc: 0.380 Test Loss: 1.445 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.194916009902954
Epoch: 10, Steps: 4 | Train Loss: 1.087 Vali Loss: 1.437 Vali Acc: 0.420 Test Loss: 1.437 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0667247772216797
Epoch: 11, Steps: 4 | Train Loss: 1.004 Vali Loss: 1.424 Vali Acc: 0.400 Test Loss: 1.424 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.0294387340545654
Epoch: 12, Steps: 4 | Train Loss: 0.885 Vali Loss: 1.402 Vali Acc: 0.400 Test Loss: 1.402 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.1006031036376953
Epoch: 13, Steps: 4 | Train Loss: 0.888 Vali Loss: 1.390 Vali Acc: 0.400 Test Loss: 1.390 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.023298978805542
Epoch: 14, Steps: 4 | Train Loss: 0.836 Vali Loss: 1.377 Vali Acc: 0.400 Test Loss: 1.377 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.1214981079101562
Epoch: 15, Steps: 4 | Train Loss: 0.775 Vali Loss: 1.374 Vali Acc: 0.380 Test Loss: 1.374 Test Acc: 0.380
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.9915976524353027
Epoch: 16, Steps: 4 | Train Loss: 0.719 Vali Loss: 1.315 Vali Acc: 0.460 Test Loss: 1.315 Test Acc: 0.460
Validation loss decreased (-0.439985 --> -0.459987).  Saving model ...
Epoch: 17 cost time: 1.132598638534546
Epoch: 17, Steps: 4 | Train Loss: 0.682 Vali Loss: 1.317 Vali Acc: 0.440 Test Loss: 1.317 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.166569471359253
Epoch: 18, Steps: 4 | Train Loss: 0.713 Vali Loss: 1.333 Vali Acc: 0.460 Test Loss: 1.333 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.1462061405181885
Epoch: 19, Steps: 4 | Train Loss: 0.488 Vali Loss: 1.280 Vali Acc: 0.460 Test Loss: 1.280 Test Acc: 0.460
Validation loss decreased (-0.459987 --> -0.459987).  Saving model ...
Epoch: 20 cost time: 1.2388865947723389
Epoch: 20, Steps: 4 | Train Loss: 0.464 Vali Loss: 1.289 Vali Acc: 0.440 Test Loss: 1.289 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.239375352859497
Epoch: 21, Steps: 4 | Train Loss: 0.530 Vali Loss: 1.272 Vali Acc: 0.440 Test Loss: 1.272 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.244640827178955
Epoch: 22, Steps: 4 | Train Loss: 0.405 Vali Loss: 1.264 Vali Acc: 0.460 Test Loss: 1.264 Test Acc: 0.460
Validation loss decreased (-0.459987 --> -0.459987).  Saving model ...
Epoch: 23 cost time: 1.2643287181854248
Epoch: 23, Steps: 4 | Train Loss: 0.474 Vali Loss: 1.290 Vali Acc: 0.460 Test Loss: 1.290 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.111912727355957
Epoch: 24, Steps: 4 | Train Loss: 0.481 Vali Loss: 1.285 Vali Acc: 0.400 Test Loss: 1.285 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.2397654056549072
Epoch: 25, Steps: 4 | Train Loss: 0.319 Vali Loss: 1.315 Vali Acc: 0.520 Test Loss: 1.315 Test Acc: 0.520
Validation loss decreased (-0.459987 --> -0.519987).  Saving model ...
Epoch: 26 cost time: 1.1664776802062988
Epoch: 26, Steps: 4 | Train Loss: 0.296 Vali Loss: 1.299 Vali Acc: 0.520 Test Loss: 1.299 Test Acc: 0.520
Validation loss decreased (-0.519987 --> -0.519987).  Saving model ...
Epoch: 27 cost time: 1.2109246253967285
Epoch: 27, Steps: 4 | Train Loss: 0.288 Vali Loss: 1.306 Vali Acc: 0.480 Test Loss: 1.306 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.1079347133636475
Epoch: 28, Steps: 4 | Train Loss: 0.244 Vali Loss: 1.265 Vali Acc: 0.500 Test Loss: 1.265 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.1286048889160156
Epoch: 29, Steps: 4 | Train Loss: 0.257 Vali Loss: 1.223 Vali Acc: 0.540 Test Loss: 1.223 Test Acc: 0.540
Validation loss decreased (-0.519987 --> -0.539988).  Saving model ...
Epoch: 30 cost time: 1.1637072563171387
Epoch: 30, Steps: 4 | Train Loss: 0.202 Vali Loss: 1.226 Vali Acc: 0.500 Test Loss: 1.226 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm8_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.54
model parameter : 129469
model size : 0.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm8_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.5966947078704834
Epoch: 1, Steps: 4 | Train Loss: 1.856 Vali Loss: 1.800 Vali Acc: 0.220 Test Loss: 1.800 Test Acc: 0.220
Validation loss decreased (inf --> -0.219982).  Saving model ...
Epoch: 2 cost time: 1.3701555728912354
Epoch: 2, Steps: 4 | Train Loss: 1.674 Vali Loss: 1.774 Vali Acc: 0.220 Test Loss: 1.774 Test Acc: 0.220
Validation loss decreased (-0.219982 --> -0.219982).  Saving model ...
Epoch: 3 cost time: 1.3626787662506104
Epoch: 3, Steps: 4 | Train Loss: 1.644 Vali Loss: 1.735 Vali Acc: 0.220 Test Loss: 1.735 Test Acc: 0.220
Validation loss decreased (-0.219982 --> -0.219983).  Saving model ...
Epoch: 4 cost time: 1.4543871879577637
Epoch: 4, Steps: 4 | Train Loss: 1.585 Vali Loss: 1.687 Vali Acc: 0.200 Test Loss: 1.687 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3703584671020508
Epoch: 5, Steps: 4 | Train Loss: 1.469 Vali Loss: 1.642 Vali Acc: 0.180 Test Loss: 1.642 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.3801772594451904
Epoch: 6, Steps: 4 | Train Loss: 1.393 Vali Loss: 1.598 Vali Acc: 0.240 Test Loss: 1.598 Test Acc: 0.240
Validation loss decreased (-0.219983 --> -0.239984).  Saving model ...
Epoch: 7 cost time: 1.4452989101409912
Epoch: 7, Steps: 4 | Train Loss: 1.428 Vali Loss: 1.557 Vali Acc: 0.280 Test Loss: 1.557 Test Acc: 0.280
Validation loss decreased (-0.239984 --> -0.279984).  Saving model ...
Epoch: 8 cost time: 1.4697062969207764
Epoch: 8, Steps: 4 | Train Loss: 1.384 Vali Loss: 1.520 Vali Acc: 0.260 Test Loss: 1.520 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4090447425842285
Epoch: 9, Steps: 4 | Train Loss: 1.281 Vali Loss: 1.467 Vali Acc: 0.320 Test Loss: 1.467 Test Acc: 0.320
Validation loss decreased (-0.279984 --> -0.319985).  Saving model ...
Epoch: 10 cost time: 1.39308762550354
Epoch: 10, Steps: 4 | Train Loss: 1.140 Vali Loss: 1.420 Vali Acc: 0.360 Test Loss: 1.420 Test Acc: 0.360
Validation loss decreased (-0.319985 --> -0.359986).  Saving model ...
Epoch: 11 cost time: 1.4388055801391602
Epoch: 11, Steps: 4 | Train Loss: 1.102 Vali Loss: 1.362 Vali Acc: 0.400 Test Loss: 1.362 Test Acc: 0.400
Validation loss decreased (-0.359986 --> -0.399986).  Saving model ...
Epoch: 12 cost time: 1.3701457977294922
Epoch: 12, Steps: 4 | Train Loss: 1.038 Vali Loss: 1.305 Vali Acc: 0.480 Test Loss: 1.305 Test Acc: 0.480
Validation loss decreased (-0.399986 --> -0.479987).  Saving model ...
Epoch: 13 cost time: 1.4928336143493652
Epoch: 13, Steps: 4 | Train Loss: 0.895 Vali Loss: 1.254 Vali Acc: 0.500 Test Loss: 1.254 Test Acc: 0.500
Validation loss decreased (-0.479987 --> -0.499987).  Saving model ...
Epoch: 14 cost time: 1.4182929992675781
Epoch: 14, Steps: 4 | Train Loss: 0.832 Vali Loss: 1.215 Vali Acc: 0.480 Test Loss: 1.215 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4287056922912598
Epoch: 15, Steps: 4 | Train Loss: 0.732 Vali Loss: 1.174 Vali Acc: 0.500 Test Loss: 1.174 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499988).  Saving model ...
Epoch: 16 cost time: 1.501697063446045
Epoch: 16, Steps: 4 | Train Loss: 0.556 Vali Loss: 1.122 Vali Acc: 0.560 Test Loss: 1.122 Test Acc: 0.560
Validation loss decreased (-0.499988 --> -0.559989).  Saving model ...
Epoch: 17 cost time: 1.4257385730743408
Epoch: 17, Steps: 4 | Train Loss: 0.632 Vali Loss: 1.090 Vali Acc: 0.560 Test Loss: 1.090 Test Acc: 0.560
Validation loss decreased (-0.559989 --> -0.559989).  Saving model ...
Epoch: 18 cost time: 1.332510232925415
Epoch: 18, Steps: 4 | Train Loss: 0.492 Vali Loss: 1.057 Vali Acc: 0.580 Test Loss: 1.057 Test Acc: 0.580
Validation loss decreased (-0.559989 --> -0.579989).  Saving model ...
Epoch: 19 cost time: 1.5769903659820557
Epoch: 19, Steps: 4 | Train Loss: 0.425 Vali Loss: 1.040 Vali Acc: 0.560 Test Loss: 1.040 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.3336760997772217
Epoch: 20, Steps: 4 | Train Loss: 0.330 Vali Loss: 1.031 Vali Acc: 0.560 Test Loss: 1.031 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.3677558898925781
Epoch: 21, Steps: 4 | Train Loss: 0.307 Vali Loss: 1.003 Vali Acc: 0.500 Test Loss: 1.003 Test Acc: 0.500
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.3538331985473633
Epoch: 22, Steps: 4 | Train Loss: 0.329 Vali Loss: 1.027 Vali Acc: 0.500 Test Loss: 1.027 Test Acc: 0.500
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.3816606998443604
Epoch: 23, Steps: 4 | Train Loss: 0.272 Vali Loss: 1.015 Vali Acc: 0.540 Test Loss: 1.015 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.5461890697479248
Epoch: 24, Steps: 4 | Train Loss: 0.226 Vali Loss: 0.989 Vali Acc: 0.600 Test Loss: 0.989 Test Acc: 0.600
Validation loss decreased (-0.579989 --> -0.599990).  Saving model ...
Epoch: 25 cost time: 1.4162888526916504
Epoch: 25, Steps: 4 | Train Loss: 0.230 Vali Loss: 1.011 Vali Acc: 0.580 Test Loss: 1.011 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.3896098136901855
Epoch: 26, Steps: 4 | Train Loss: 0.189 Vali Loss: 1.029 Vali Acc: 0.580 Test Loss: 1.029 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.3590102195739746
Epoch: 27, Steps: 4 | Train Loss: 0.211 Vali Loss: 1.082 Vali Acc: 0.600 Test Loss: 1.082 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.4592835903167725
Epoch: 28, Steps: 4 | Train Loss: 0.164 Vali Loss: 1.104 Vali Acc: 0.520 Test Loss: 1.104 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.4233057498931885
Epoch: 29, Steps: 4 | Train Loss: 0.213 Vali Loss: 1.042 Vali Acc: 0.520 Test Loss: 1.042 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.372450828552246
Epoch: 30, Steps: 4 | Train Loss: 0.222 Vali Loss: 1.140 Vali Acc: 0.560 Test Loss: 1.140 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm8_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 189853
model size : 0.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm8_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.2571115493774414
Epoch: 1, Steps: 4 | Train Loss: 1.661 Vali Loss: 1.641 Vali Acc: 0.140 Test Loss: 1.641 Test Acc: 0.140
Validation loss decreased (inf --> -0.139984).  Saving model ...
Epoch: 2 cost time: 1.1866157054901123
Epoch: 2, Steps: 4 | Train Loss: 1.500 Vali Loss: 1.617 Vali Acc: 0.160 Test Loss: 1.617 Test Acc: 0.160
Validation loss decreased (-0.139984 --> -0.159984).  Saving model ...
Epoch: 3 cost time: 1.1163687705993652
Epoch: 3, Steps: 4 | Train Loss: 1.597 Vali Loss: 1.587 Vali Acc: 0.140 Test Loss: 1.587 Test Acc: 0.140
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2970352172851562
Epoch: 4, Steps: 4 | Train Loss: 1.464 Vali Loss: 1.548 Vali Acc: 0.320 Test Loss: 1.548 Test Acc: 0.320
Validation loss decreased (-0.159984 --> -0.319985).  Saving model ...
Epoch: 5 cost time: 1.0910165309906006
Epoch: 5, Steps: 4 | Train Loss: 1.419 Vali Loss: 1.514 Vali Acc: 0.340 Test Loss: 1.514 Test Acc: 0.340
Validation loss decreased (-0.319985 --> -0.339985).  Saving model ...
Epoch: 6 cost time: 1.2103805541992188
Epoch: 6, Steps: 4 | Train Loss: 1.339 Vali Loss: 1.491 Vali Acc: 0.340 Test Loss: 1.491 Test Acc: 0.340
Validation loss decreased (-0.339985 --> -0.339985).  Saving model ...
Epoch: 7 cost time: 1.0627799034118652
Epoch: 7, Steps: 4 | Train Loss: 1.282 Vali Loss: 1.465 Vali Acc: 0.360 Test Loss: 1.465 Test Acc: 0.360
Validation loss decreased (-0.339985 --> -0.359985).  Saving model ...
Epoch: 8 cost time: 1.188448190689087
Epoch: 8, Steps: 4 | Train Loss: 1.261 Vali Loss: 1.434 Vali Acc: 0.400 Test Loss: 1.434 Test Acc: 0.400
Validation loss decreased (-0.359985 --> -0.399986).  Saving model ...
Epoch: 9 cost time: 1.198328971862793
Epoch: 9, Steps: 4 | Train Loss: 1.001 Vali Loss: 1.406 Vali Acc: 0.440 Test Loss: 1.406 Test Acc: 0.440
Validation loss decreased (-0.399986 --> -0.439986).  Saving model ...
Epoch: 10 cost time: 1.1355655193328857
Epoch: 10, Steps: 4 | Train Loss: 1.024 Vali Loss: 1.380 Vali Acc: 0.460 Test Loss: 1.380 Test Acc: 0.460
Validation loss decreased (-0.439986 --> -0.459986).  Saving model ...
Epoch: 11 cost time: 1.1733157634735107
Epoch: 11, Steps: 4 | Train Loss: 1.009 Vali Loss: 1.361 Vali Acc: 0.440 Test Loss: 1.361 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1301188468933105
Epoch: 12, Steps: 4 | Train Loss: 0.965 Vali Loss: 1.336 Vali Acc: 0.440 Test Loss: 1.336 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1683349609375
Epoch: 13, Steps: 4 | Train Loss: 0.799 Vali Loss: 1.304 Vali Acc: 0.460 Test Loss: 1.304 Test Acc: 0.460
Validation loss decreased (-0.459986 --> -0.459987).  Saving model ...
Epoch: 14 cost time: 1.2098023891448975
Epoch: 14, Steps: 4 | Train Loss: 1.014 Vali Loss: 1.278 Vali Acc: 0.460 Test Loss: 1.278 Test Acc: 0.460
Validation loss decreased (-0.459987 --> -0.459987).  Saving model ...
Epoch: 15 cost time: 1.1815989017486572
Epoch: 15, Steps: 4 | Train Loss: 0.592 Vali Loss: 1.239 Vali Acc: 0.480 Test Loss: 1.239 Test Acc: 0.480
Validation loss decreased (-0.459987 --> -0.479988).  Saving model ...
Epoch: 16 cost time: 1.0854649543762207
Epoch: 16, Steps: 4 | Train Loss: 0.613 Vali Loss: 1.211 Vali Acc: 0.500 Test Loss: 1.211 Test Acc: 0.500
Validation loss decreased (-0.479988 --> -0.499988).  Saving model ...
Epoch: 17 cost time: 1.095947027206421
Epoch: 17, Steps: 4 | Train Loss: 0.694 Vali Loss: 1.185 Vali Acc: 0.500 Test Loss: 1.185 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 18 cost time: 1.103694200515747
Epoch: 18, Steps: 4 | Train Loss: 0.535 Vali Loss: 1.156 Vali Acc: 0.460 Test Loss: 1.156 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1151530742645264
Epoch: 19, Steps: 4 | Train Loss: 0.469 Vali Loss: 1.122 Vali Acc: 0.480 Test Loss: 1.122 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.1549229621887207
Epoch: 20, Steps: 4 | Train Loss: 0.416 Vali Loss: 1.130 Vali Acc: 0.540 Test Loss: 1.130 Test Acc: 0.540
Validation loss decreased (-0.499988 --> -0.539989).  Saving model ...
Epoch: 21 cost time: 1.1920857429504395
Epoch: 21, Steps: 4 | Train Loss: 0.421 Vali Loss: 1.148 Vali Acc: 0.480 Test Loss: 1.148 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2438950538635254
Epoch: 22, Steps: 4 | Train Loss: 0.330 Vali Loss: 1.164 Vali Acc: 0.500 Test Loss: 1.164 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.1401886940002441
Epoch: 23, Steps: 4 | Train Loss: 0.307 Vali Loss: 1.175 Vali Acc: 0.520 Test Loss: 1.175 Test Acc: 0.520
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.0320947170257568
Epoch: 24, Steps: 4 | Train Loss: 0.254 Vali Loss: 1.196 Vali Acc: 0.520 Test Loss: 1.196 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.109607458114624
Epoch: 25, Steps: 4 | Train Loss: 0.242 Vali Loss: 1.151 Vali Acc: 0.540 Test Loss: 1.151 Test Acc: 0.540
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.107375144958496
Epoch: 26, Steps: 4 | Train Loss: 0.260 Vali Loss: 1.122 Vali Acc: 0.480 Test Loss: 1.122 Test Acc: 0.480
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.0770385265350342
Epoch: 27, Steps: 4 | Train Loss: 0.304 Vali Loss: 1.116 Vali Acc: 0.500 Test Loss: 1.116 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.0675795078277588
Epoch: 28, Steps: 4 | Train Loss: 0.195 Vali Loss: 1.181 Vali Acc: 0.580 Test Loss: 1.181 Test Acc: 0.580
Validation loss decreased (-0.539989 --> -0.579988).  Saving model ...
Epoch: 29 cost time: 1.0323374271392822
Epoch: 29, Steps: 4 | Train Loss: 0.232 Vali Loss: 1.156 Vali Acc: 0.520 Test Loss: 1.156 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.0128207206726074
Epoch: 30, Steps: 4 | Train Loss: 0.364 Vali Loss: 1.160 Vali Acc: 0.480 Test Loss: 1.160 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm8_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.58
model parameter : 86333
model size : 0.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm8_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.296398878097534
Epoch: 1, Steps: 4 | Train Loss: 1.853 Vali Loss: 1.805 Vali Acc: 0.200 Test Loss: 1.805 Test Acc: 0.200
Validation loss decreased (inf --> -0.199982).  Saving model ...
Epoch: 2 cost time: 1.2043752670288086
Epoch: 2, Steps: 4 | Train Loss: 1.673 Vali Loss: 1.778 Vali Acc: 0.200 Test Loss: 1.778 Test Acc: 0.200
Validation loss decreased (-0.199982 --> -0.199982).  Saving model ...
Epoch: 3 cost time: 1.18996000289917
Epoch: 3, Steps: 4 | Train Loss: 1.636 Vali Loss: 1.738 Vali Acc: 0.200 Test Loss: 1.738 Test Acc: 0.200
Validation loss decreased (-0.199982 --> -0.199983).  Saving model ...
Epoch: 4 cost time: 1.3140177726745605
Epoch: 4, Steps: 4 | Train Loss: 1.586 Vali Loss: 1.693 Vali Acc: 0.200 Test Loss: 1.693 Test Acc: 0.200
Validation loss decreased (-0.199983 --> -0.199983).  Saving model ...
Epoch: 5 cost time: 1.3018527030944824
Epoch: 5, Steps: 4 | Train Loss: 1.470 Vali Loss: 1.646 Vali Acc: 0.180 Test Loss: 1.646 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1991603374481201
Epoch: 6, Steps: 4 | Train Loss: 1.396 Vali Loss: 1.603 Vali Acc: 0.260 Test Loss: 1.603 Test Acc: 0.260
Validation loss decreased (-0.199983 --> -0.259984).  Saving model ...
Epoch: 7 cost time: 1.207310438156128
Epoch: 7, Steps: 4 | Train Loss: 1.423 Vali Loss: 1.563 Vali Acc: 0.300 Test Loss: 1.563 Test Acc: 0.300
Validation loss decreased (-0.259984 --> -0.299984).  Saving model ...
Epoch: 8 cost time: 1.1937751770019531
Epoch: 8, Steps: 4 | Train Loss: 1.397 Vali Loss: 1.528 Vali Acc: 0.280 Test Loss: 1.528 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2238538265228271
Epoch: 9, Steps: 4 | Train Loss: 1.295 Vali Loss: 1.477 Vali Acc: 0.320 Test Loss: 1.477 Test Acc: 0.320
Validation loss decreased (-0.299984 --> -0.319985).  Saving model ...
Epoch: 10 cost time: 1.3302435874938965
Epoch: 10, Steps: 4 | Train Loss: 1.139 Vali Loss: 1.430 Vali Acc: 0.400 Test Loss: 1.430 Test Acc: 0.400
Validation loss decreased (-0.319985 --> -0.399986).  Saving model ...
Epoch: 11 cost time: 1.2588350772857666
Epoch: 11, Steps: 4 | Train Loss: 1.104 Vali Loss: 1.369 Vali Acc: 0.400 Test Loss: 1.369 Test Acc: 0.400
Validation loss decreased (-0.399986 --> -0.399986).  Saving model ...
Epoch: 12 cost time: 1.2196321487426758
Epoch: 12, Steps: 4 | Train Loss: 1.036 Vali Loss: 1.313 Vali Acc: 0.480 Test Loss: 1.313 Test Acc: 0.480
Validation loss decreased (-0.399986 --> -0.479987).  Saving model ...
Epoch: 13 cost time: 1.241913080215454
Epoch: 13, Steps: 4 | Train Loss: 0.896 Vali Loss: 1.262 Vali Acc: 0.540 Test Loss: 1.262 Test Acc: 0.540
Validation loss decreased (-0.479987 --> -0.539987).  Saving model ...
Epoch: 14 cost time: 1.1826729774475098
Epoch: 14, Steps: 4 | Train Loss: 0.842 Vali Loss: 1.222 Vali Acc: 0.500 Test Loss: 1.222 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2736093997955322
Epoch: 15, Steps: 4 | Train Loss: 0.729 Vali Loss: 1.181 Vali Acc: 0.480 Test Loss: 1.181 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.2206916809082031
Epoch: 16, Steps: 4 | Train Loss: 0.558 Vali Loss: 1.130 Vali Acc: 0.560 Test Loss: 1.130 Test Acc: 0.560
Validation loss decreased (-0.539987 --> -0.559989).  Saving model ...
Epoch: 17 cost time: 1.2648706436157227
Epoch: 17, Steps: 4 | Train Loss: 0.620 Vali Loss: 1.098 Vali Acc: 0.600 Test Loss: 1.098 Test Acc: 0.600
Validation loss decreased (-0.559989 --> -0.599989).  Saving model ...
Epoch: 18 cost time: 1.1879432201385498
Epoch: 18, Steps: 4 | Train Loss: 0.490 Vali Loss: 1.062 Vali Acc: 0.580 Test Loss: 1.062 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2467007637023926
Epoch: 19, Steps: 4 | Train Loss: 0.421 Vali Loss: 1.042 Vali Acc: 0.520 Test Loss: 1.042 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.2165391445159912
Epoch: 20, Steps: 4 | Train Loss: 0.346 Vali Loss: 1.027 Vali Acc: 0.540 Test Loss: 1.027 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.2239279747009277
Epoch: 21, Steps: 4 | Train Loss: 0.304 Vali Loss: 0.996 Vali Acc: 0.520 Test Loss: 0.996 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.2151479721069336
Epoch: 22, Steps: 4 | Train Loss: 0.330 Vali Loss: 0.994 Vali Acc: 0.520 Test Loss: 0.994 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.2675836086273193
Epoch: 23, Steps: 4 | Train Loss: 0.275 Vali Loss: 0.987 Vali Acc: 0.540 Test Loss: 0.987 Test Acc: 0.540
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.2425706386566162
Epoch: 24, Steps: 4 | Train Loss: 0.229 Vali Loss: 0.959 Vali Acc: 0.560 Test Loss: 0.959 Test Acc: 0.560
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.2373123168945312
Epoch: 25, Steps: 4 | Train Loss: 0.220 Vali Loss: 0.991 Vali Acc: 0.600 Test Loss: 0.991 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599990).  Saving model ...
Epoch: 26 cost time: 1.223170518875122
Epoch: 26, Steps: 4 | Train Loss: 0.167 Vali Loss: 1.005 Vali Acc: 0.560 Test Loss: 1.005 Test Acc: 0.560
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.2606041431427002
Epoch: 27, Steps: 4 | Train Loss: 0.162 Vali Loss: 1.030 Vali Acc: 0.560 Test Loss: 1.030 Test Acc: 0.560
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.256866216659546
Epoch: 28, Steps: 4 | Train Loss: 0.145 Vali Loss: 1.012 Vali Acc: 0.580 Test Loss: 1.012 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.2069814205169678
Epoch: 29, Steps: 4 | Train Loss: 0.145 Vali Loss: 1.037 Vali Acc: 0.540 Test Loss: 1.037 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.283456802368164
Epoch: 30, Steps: 4 | Train Loss: 0.281 Vali Loss: 1.099 Vali Acc: 0.520 Test Loss: 1.099 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm8_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 189853
model size : 0.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm8_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.15767502784729
Epoch: 1, Steps: 4 | Train Loss: 1.665 Vali Loss: 1.640 Vali Acc: 0.160 Test Loss: 1.640 Test Acc: 0.160
Validation loss decreased (inf --> -0.159984).  Saving model ...
Epoch: 2 cost time: 1.1257572174072266
Epoch: 2, Steps: 4 | Train Loss: 1.507 Vali Loss: 1.620 Vali Acc: 0.140 Test Loss: 1.620 Test Acc: 0.140
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.003026008605957
Epoch: 3, Steps: 4 | Train Loss: 1.602 Vali Loss: 1.592 Vali Acc: 0.200 Test Loss: 1.592 Test Acc: 0.200
Validation loss decreased (-0.159984 --> -0.199984).  Saving model ...
Epoch: 4 cost time: 1.1067993640899658
Epoch: 4, Steps: 4 | Train Loss: 1.474 Vali Loss: 1.556 Vali Acc: 0.340 Test Loss: 1.556 Test Acc: 0.340
Validation loss decreased (-0.199984 --> -0.339984).  Saving model ...
Epoch: 5 cost time: 1.1255195140838623
Epoch: 5, Steps: 4 | Train Loss: 1.431 Vali Loss: 1.527 Vali Acc: 0.300 Test Loss: 1.527 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9644412994384766
Epoch: 6, Steps: 4 | Train Loss: 1.336 Vali Loss: 1.501 Vali Acc: 0.340 Test Loss: 1.501 Test Acc: 0.340
Validation loss decreased (-0.339984 --> -0.339985).  Saving model ...
Epoch: 7 cost time: 0.9913816452026367
Epoch: 7, Steps: 4 | Train Loss: 1.289 Vali Loss: 1.474 Vali Acc: 0.340 Test Loss: 1.474 Test Acc: 0.340
Validation loss decreased (-0.339985 --> -0.339985).  Saving model ...
Epoch: 8 cost time: 1.0484566688537598
Epoch: 8, Steps: 4 | Train Loss: 1.257 Vali Loss: 1.438 Vali Acc: 0.360 Test Loss: 1.438 Test Acc: 0.360
Validation loss decreased (-0.339985 --> -0.359986).  Saving model ...
Epoch: 9 cost time: 1.0313658714294434
Epoch: 9, Steps: 4 | Train Loss: 1.003 Vali Loss: 1.405 Vali Acc: 0.460 Test Loss: 1.405 Test Acc: 0.460
Validation loss decreased (-0.359986 --> -0.459986).  Saving model ...
Epoch: 10 cost time: 1.015362024307251
Epoch: 10, Steps: 4 | Train Loss: 1.020 Vali Loss: 1.378 Vali Acc: 0.440 Test Loss: 1.378 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1200129985809326
Epoch: 11, Steps: 4 | Train Loss: 1.017 Vali Loss: 1.357 Vali Acc: 0.440 Test Loss: 1.357 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.0321671962738037
Epoch: 12, Steps: 4 | Train Loss: 0.967 Vali Loss: 1.324 Vali Acc: 0.440 Test Loss: 1.324 Test Acc: 0.440
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.0318195819854736
Epoch: 13, Steps: 4 | Train Loss: 0.788 Vali Loss: 1.285 Vali Acc: 0.480 Test Loss: 1.285 Test Acc: 0.480
Validation loss decreased (-0.459986 --> -0.479987).  Saving model ...
Epoch: 14 cost time: 1.0584394931793213
Epoch: 14, Steps: 4 | Train Loss: 0.987 Vali Loss: 1.258 Vali Acc: 0.460 Test Loss: 1.258 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1266241073608398
Epoch: 15, Steps: 4 | Train Loss: 0.590 Vali Loss: 1.225 Vali Acc: 0.480 Test Loss: 1.225 Test Acc: 0.480
Validation loss decreased (-0.479987 --> -0.479988).  Saving model ...
Epoch: 16 cost time: 1.0430190563201904
Epoch: 16, Steps: 4 | Train Loss: 0.579 Vali Loss: 1.205 Vali Acc: 0.480 Test Loss: 1.205 Test Acc: 0.480
Validation loss decreased (-0.479988 --> -0.479988).  Saving model ...
Epoch: 17 cost time: 1.032956838607788
Epoch: 17, Steps: 4 | Train Loss: 0.689 Vali Loss: 1.183 Vali Acc: 0.480 Test Loss: 1.183 Test Acc: 0.480
Validation loss decreased (-0.479988 --> -0.479988).  Saving model ...
Epoch: 18 cost time: 1.0199618339538574
Epoch: 18, Steps: 4 | Train Loss: 0.529 Vali Loss: 1.152 Vali Acc: 0.460 Test Loss: 1.152 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9975619316101074
Epoch: 19, Steps: 4 | Train Loss: 0.469 Vali Loss: 1.118 Vali Acc: 0.520 Test Loss: 1.118 Test Acc: 0.520
Validation loss decreased (-0.479988 --> -0.519989).  Saving model ...
Epoch: 20 cost time: 1.0802335739135742
Epoch: 20, Steps: 4 | Train Loss: 0.401 Vali Loss: 1.127 Vali Acc: 0.540 Test Loss: 1.127 Test Acc: 0.540
Validation loss decreased (-0.519989 --> -0.539989).  Saving model ...
Epoch: 21 cost time: 1.1310911178588867
Epoch: 21, Steps: 4 | Train Loss: 0.412 Vali Loss: 1.144 Vali Acc: 0.500 Test Loss: 1.144 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.1901895999908447
Epoch: 22, Steps: 4 | Train Loss: 0.324 Vali Loss: 1.147 Vali Acc: 0.440 Test Loss: 1.147 Test Acc: 0.440
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.1166725158691406
Epoch: 23, Steps: 4 | Train Loss: 0.295 Vali Loss: 1.144 Vali Acc: 0.480 Test Loss: 1.144 Test Acc: 0.480
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.094202995300293
Epoch: 24, Steps: 4 | Train Loss: 0.246 Vali Loss: 1.173 Vali Acc: 0.520 Test Loss: 1.173 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.2103710174560547
Epoch: 25, Steps: 4 | Train Loss: 0.234 Vali Loss: 1.150 Vali Acc: 0.520 Test Loss: 1.150 Test Acc: 0.520
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.1490905284881592
Epoch: 26, Steps: 4 | Train Loss: 0.252 Vali Loss: 1.105 Vali Acc: 0.520 Test Loss: 1.105 Test Acc: 0.520
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.1877620220184326
Epoch: 27, Steps: 4 | Train Loss: 0.302 Vali Loss: 1.088 Vali Acc: 0.520 Test Loss: 1.088 Test Acc: 0.520
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.1238737106323242
Epoch: 28, Steps: 4 | Train Loss: 0.186 Vali Loss: 1.149 Vali Acc: 0.560 Test Loss: 1.149 Test Acc: 0.560
Validation loss decreased (-0.539989 --> -0.559989).  Saving model ...
Epoch: 29 cost time: 1.1223242282867432
Epoch: 29, Steps: 4 | Train Loss: 0.211 Vali Loss: 1.125 Vali Acc: 0.480 Test Loss: 1.125 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.078352689743042
Epoch: 30, Steps: 4 | Train Loss: 0.336 Vali Loss: 1.130 Vali Acc: 0.480 Test Loss: 1.130 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm8_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 86333
model size : 0.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm8_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.3167712688446045
Epoch: 1, Steps: 4 | Train Loss: 1.848 Vali Loss: 1.790 Vali Acc: 0.180 Test Loss: 1.790 Test Acc: 0.180
Validation loss decreased (inf --> -0.179982).  Saving model ...
Epoch: 2 cost time: 1.0197668075561523
Epoch: 2, Steps: 4 | Train Loss: 1.680 Vali Loss: 1.761 Vali Acc: 0.200 Test Loss: 1.761 Test Acc: 0.200
Validation loss decreased (-0.179982 --> -0.199982).  Saving model ...
Epoch: 3 cost time: 1.1528582572937012
Epoch: 3, Steps: 4 | Train Loss: 1.629 Vali Loss: 1.723 Vali Acc: 0.200 Test Loss: 1.723 Test Acc: 0.200
Validation loss decreased (-0.199982 --> -0.199983).  Saving model ...
Epoch: 4 cost time: 1.093862533569336
Epoch: 4, Steps: 4 | Train Loss: 1.590 Vali Loss: 1.670 Vali Acc: 0.280 Test Loss: 1.670 Test Acc: 0.280
Validation loss decreased (-0.199983 --> -0.279983).  Saving model ...
Epoch: 5 cost time: 0.9980309009552002
Epoch: 5, Steps: 4 | Train Loss: 1.468 Vali Loss: 1.650 Vali Acc: 0.220 Test Loss: 1.650 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.13606595993042
Epoch: 6, Steps: 4 | Train Loss: 1.410 Vali Loss: 1.607 Vali Acc: 0.240 Test Loss: 1.607 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.164163589477539
Epoch: 7, Steps: 4 | Train Loss: 1.439 Vali Loss: 1.568 Vali Acc: 0.280 Test Loss: 1.568 Test Acc: 0.280
Validation loss decreased (-0.279983 --> -0.279984).  Saving model ...
Epoch: 8 cost time: 1.0849127769470215
Epoch: 8, Steps: 4 | Train Loss: 1.410 Vali Loss: 1.533 Vali Acc: 0.280 Test Loss: 1.533 Test Acc: 0.280
Validation loss decreased (-0.279984 --> -0.279985).  Saving model ...
Epoch: 9 cost time: 1.0538458824157715
Epoch: 9, Steps: 4 | Train Loss: 1.326 Vali Loss: 1.484 Vali Acc: 0.340 Test Loss: 1.484 Test Acc: 0.340
Validation loss decreased (-0.279985 --> -0.339985).  Saving model ...
Epoch: 10 cost time: 1.0479888916015625
Epoch: 10, Steps: 4 | Train Loss: 1.150 Vali Loss: 1.427 Vali Acc: 0.400 Test Loss: 1.427 Test Acc: 0.400
Validation loss decreased (-0.339985 --> -0.399986).  Saving model ...
Epoch: 11 cost time: 1.1311943531036377
Epoch: 11, Steps: 4 | Train Loss: 1.135 Vali Loss: 1.367 Vali Acc: 0.440 Test Loss: 1.367 Test Acc: 0.440
Validation loss decreased (-0.399986 --> -0.439986).  Saving model ...
Epoch: 12 cost time: 1.0638549327850342
Epoch: 12, Steps: 4 | Train Loss: 1.068 Vali Loss: 1.318 Vali Acc: 0.460 Test Loss: 1.318 Test Acc: 0.460
Validation loss decreased (-0.439986 --> -0.459987).  Saving model ...
Epoch: 13 cost time: 1.0609149932861328
Epoch: 13, Steps: 4 | Train Loss: 0.916 Vali Loss: 1.265 Vali Acc: 0.520 Test Loss: 1.265 Test Acc: 0.520
Validation loss decreased (-0.459987 --> -0.519987).  Saving model ...
Epoch: 14 cost time: 1.0004920959472656
Epoch: 14, Steps: 4 | Train Loss: 0.864 Vali Loss: 1.220 Vali Acc: 0.500 Test Loss: 1.220 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.109588384628296
Epoch: 15, Steps: 4 | Train Loss: 0.758 Vali Loss: 1.180 Vali Acc: 0.460 Test Loss: 1.180 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.1492109298706055
Epoch: 16, Steps: 4 | Train Loss: 0.592 Vali Loss: 1.139 Vali Acc: 0.540 Test Loss: 1.139 Test Acc: 0.540
Validation loss decreased (-0.519987 --> -0.539989).  Saving model ...
Epoch: 17 cost time: 1.0884943008422852
Epoch: 17, Steps: 4 | Train Loss: 0.670 Vali Loss: 1.114 Vali Acc: 0.560 Test Loss: 1.114 Test Acc: 0.560
Validation loss decreased (-0.539989 --> -0.559989).  Saving model ...
Epoch: 18 cost time: 1.1912345886230469
Epoch: 18, Steps: 4 | Train Loss: 0.545 Vali Loss: 1.080 Vali Acc: 0.580 Test Loss: 1.080 Test Acc: 0.580
Validation loss decreased (-0.559989 --> -0.579989).  Saving model ...
Epoch: 19 cost time: 1.133084774017334
Epoch: 19, Steps: 4 | Train Loss: 0.485 Vali Loss: 1.061 Vali Acc: 0.540 Test Loss: 1.061 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0424613952636719
Epoch: 20, Steps: 4 | Train Loss: 0.384 Vali Loss: 1.062 Vali Acc: 0.580 Test Loss: 1.062 Test Acc: 0.580
Validation loss decreased (-0.579989 --> -0.579989).  Saving model ...
Epoch: 21 cost time: 1.0177459716796875
Epoch: 21, Steps: 4 | Train Loss: 0.345 Vali Loss: 1.043 Vali Acc: 0.520 Test Loss: 1.043 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.127220869064331
Epoch: 22, Steps: 4 | Train Loss: 0.368 Vali Loss: 1.045 Vali Acc: 0.520 Test Loss: 1.045 Test Acc: 0.520
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.0845117568969727
Epoch: 23, Steps: 4 | Train Loss: 0.327 Vali Loss: 1.021 Vali Acc: 0.540 Test Loss: 1.021 Test Acc: 0.540
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.2170207500457764
Epoch: 24, Steps: 4 | Train Loss: 0.297 Vali Loss: 0.993 Vali Acc: 0.540 Test Loss: 0.993 Test Acc: 0.540
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.096658706665039
Epoch: 25, Steps: 4 | Train Loss: 0.320 Vali Loss: 1.019 Vali Acc: 0.560 Test Loss: 1.019 Test Acc: 0.560
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.0965518951416016
Epoch: 26, Steps: 4 | Train Loss: 0.205 Vali Loss: 1.069 Vali Acc: 0.560 Test Loss: 1.069 Test Acc: 0.560
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.082820177078247
Epoch: 27, Steps: 4 | Train Loss: 0.210 Vali Loss: 1.078 Vali Acc: 0.540 Test Loss: 1.078 Test Acc: 0.540
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.1682333946228027
Epoch: 28, Steps: 4 | Train Loss: 0.187 Vali Loss: 1.046 Vali Acc: 0.560 Test Loss: 1.046 Test Acc: 0.560
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.0947792530059814
Epoch: 29, Steps: 4 | Train Loss: 0.193 Vali Loss: 1.039 Vali Acc: 0.580 Test Loss: 1.039 Test Acc: 0.580
Validation loss decreased (-0.579989 --> -0.579990).  Saving model ...
Epoch: 30 cost time: 1.1704702377319336
Epoch: 30, Steps: 4 | Train Loss: 0.229 Vali Loss: 1.152 Vali Acc: 0.600 Test Loss: 1.152 Test Acc: 0.600
Validation loss decreased (-0.579990 --> -0.599988).  Saving model ...
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm8_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.6
model parameter : 189853
model size : 0.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm8_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.1689839363098145
Epoch: 1, Steps: 4 | Train Loss: 1.669 Vali Loss: 1.628 Vali Acc: 0.180 Test Loss: 1.628 Test Acc: 0.180
Validation loss decreased (inf --> -0.179984).  Saving model ...
Epoch: 2 cost time: 1.030066967010498
Epoch: 2, Steps: 4 | Train Loss: 1.499 Vali Loss: 1.606 Vali Acc: 0.200 Test Loss: 1.606 Test Acc: 0.200
Validation loss decreased (-0.179984 --> -0.199984).  Saving model ...
Epoch: 3 cost time: 0.9761075973510742
Epoch: 3, Steps: 4 | Train Loss: 1.599 Vali Loss: 1.587 Vali Acc: 0.180 Test Loss: 1.587 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.059861183166504
Epoch: 4, Steps: 4 | Train Loss: 1.448 Vali Loss: 1.550 Vali Acc: 0.340 Test Loss: 1.550 Test Acc: 0.340
Validation loss decreased (-0.199984 --> -0.339984).  Saving model ...
Epoch: 5 cost time: 0.980942964553833
Epoch: 5, Steps: 4 | Train Loss: 1.429 Vali Loss: 1.518 Vali Acc: 0.320 Test Loss: 1.518 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.045720100402832
Epoch: 6, Steps: 4 | Train Loss: 1.343 Vali Loss: 1.490 Vali Acc: 0.340 Test Loss: 1.490 Test Acc: 0.340
Validation loss decreased (-0.339984 --> -0.339985).  Saving model ...
Epoch: 7 cost time: 1.013251781463623
Epoch: 7, Steps: 4 | Train Loss: 1.322 Vali Loss: 1.463 Vali Acc: 0.340 Test Loss: 1.463 Test Acc: 0.340
Validation loss decreased (-0.339985 --> -0.339985).  Saving model ...
Epoch: 8 cost time: 1.003025770187378
Epoch: 8, Steps: 4 | Train Loss: 1.270 Vali Loss: 1.431 Vali Acc: 0.400 Test Loss: 1.431 Test Acc: 0.400
Validation loss decreased (-0.339985 --> -0.399986).  Saving model ...
Epoch: 9 cost time: 1.0560438632965088
Epoch: 9, Steps: 4 | Train Loss: 1.021 Vali Loss: 1.403 Vali Acc: 0.380 Test Loss: 1.403 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.074394941329956
Epoch: 10, Steps: 4 | Train Loss: 1.010 Vali Loss: 1.374 Vali Acc: 0.420 Test Loss: 1.374 Test Acc: 0.420
Validation loss decreased (-0.399986 --> -0.419986).  Saving model ...
Epoch: 11 cost time: 1.1151070594787598
Epoch: 11, Steps: 4 | Train Loss: 1.010 Vali Loss: 1.351 Vali Acc: 0.460 Test Loss: 1.351 Test Acc: 0.460
Validation loss decreased (-0.419986 --> -0.459986).  Saving model ...
Epoch: 12 cost time: 0.9797389507293701
Epoch: 12, Steps: 4 | Train Loss: 0.983 Vali Loss: 1.323 Vali Acc: 0.440 Test Loss: 1.323 Test Acc: 0.440
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0351464748382568
Epoch: 13, Steps: 4 | Train Loss: 0.836 Vali Loss: 1.280 Vali Acc: 0.480 Test Loss: 1.280 Test Acc: 0.480
Validation loss decreased (-0.459986 --> -0.479987).  Saving model ...
Epoch: 14 cost time: 1.0238869190216064
Epoch: 14, Steps: 4 | Train Loss: 1.035 Vali Loss: 1.247 Vali Acc: 0.480 Test Loss: 1.247 Test Acc: 0.480
Validation loss decreased (-0.479987 --> -0.479988).  Saving model ...
Epoch: 15 cost time: 1.026343822479248
Epoch: 15, Steps: 4 | Train Loss: 0.625 Vali Loss: 1.213 Vali Acc: 0.480 Test Loss: 1.213 Test Acc: 0.480
Validation loss decreased (-0.479988 --> -0.479988).  Saving model ...
Epoch: 16 cost time: 1.0375306606292725
Epoch: 16, Steps: 4 | Train Loss: 0.622 Vali Loss: 1.198 Vali Acc: 0.480 Test Loss: 1.198 Test Acc: 0.480
Validation loss decreased (-0.479988 --> -0.479988).  Saving model ...
Epoch: 17 cost time: 1.0186100006103516
Epoch: 17, Steps: 4 | Train Loss: 0.758 Vali Loss: 1.196 Vali Acc: 0.500 Test Loss: 1.196 Test Acc: 0.500
Validation loss decreased (-0.479988 --> -0.499988).  Saving model ...
Epoch: 18 cost time: 1.0320477485656738
Epoch: 18, Steps: 4 | Train Loss: 0.542 Vali Loss: 1.130 Vali Acc: 0.460 Test Loss: 1.130 Test Acc: 0.460
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0415639877319336
Epoch: 19, Steps: 4 | Train Loss: 0.476 Vali Loss: 1.110 Vali Acc: 0.460 Test Loss: 1.110 Test Acc: 0.460
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9984512329101562
Epoch: 20, Steps: 4 | Train Loss: 0.453 Vali Loss: 1.110 Vali Acc: 0.520 Test Loss: 1.110 Test Acc: 0.520
Validation loss decreased (-0.499988 --> -0.519989).  Saving model ...
Epoch: 21 cost time: 1.0299274921417236
Epoch: 21, Steps: 4 | Train Loss: 0.456 Vali Loss: 1.144 Vali Acc: 0.520 Test Loss: 1.144 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0926344394683838
Epoch: 22, Steps: 4 | Train Loss: 0.368 Vali Loss: 1.124 Vali Acc: 0.560 Test Loss: 1.124 Test Acc: 0.560
Validation loss decreased (-0.519989 --> -0.559989).  Saving model ...
Epoch: 23 cost time: 1.076939344406128
Epoch: 23, Steps: 4 | Train Loss: 0.324 Vali Loss: 1.169 Vali Acc: 0.540 Test Loss: 1.169 Test Acc: 0.540
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.006497859954834
Epoch: 24, Steps: 4 | Train Loss: 0.289 Vali Loss: 1.165 Vali Acc: 0.540 Test Loss: 1.165 Test Acc: 0.540
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.0428926944732666
Epoch: 25, Steps: 4 | Train Loss: 0.259 Vali Loss: 1.145 Vali Acc: 0.560 Test Loss: 1.145 Test Acc: 0.560
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.0618691444396973
Epoch: 26, Steps: 4 | Train Loss: 0.317 Vali Loss: 1.085 Vali Acc: 0.520 Test Loss: 1.085 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.0481345653533936
Epoch: 27, Steps: 4 | Train Loss: 0.383 Vali Loss: 1.054 Vali Acc: 0.500 Test Loss: 1.054 Test Acc: 0.500
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.9899139404296875
Epoch: 28, Steps: 4 | Train Loss: 0.209 Vali Loss: 1.071 Vali Acc: 0.500 Test Loss: 1.071 Test Acc: 0.500
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.0316030979156494
Epoch: 29, Steps: 4 | Train Loss: 0.209 Vali Loss: 1.129 Vali Acc: 0.500 Test Loss: 1.129 Test Acc: 0.500
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.0034232139587402
Epoch: 30, Steps: 4 | Train Loss: 0.204 Vali Loss: 1.016 Vali Acc: 0.560 Test Loss: 1.016 Test Acc: 0.560
Validation loss decreased (-0.559989 --> -0.559990).  Saving model ...
>>>>>>>testing : classification_CLS_DuckDuckGeese_TimesNet_UEA_ftM_sl270_ll0_pl0_el2_dm8_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.56
model parameter : 86333
model size : 0.50MB
