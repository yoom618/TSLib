Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm128_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 16.65673804283142
Epoch: 1, Steps: 1 | Train Loss: 1.131 Vali Loss: 1.075 Vali Acc: 0.333 Test Loss: 1.075 Test Acc: 0.333
Validation loss decreased (inf --> -0.333323).  Saving model ...
Epoch: 2 cost time: 9.442400217056274
Epoch: 2, Steps: 1 | Train Loss: 1.039 Vali Loss: 1.075 Vali Acc: 0.400 Test Loss: 1.075 Test Acc: 0.400
Validation loss decreased (-0.333323 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 9.078948974609375
Epoch: 3, Steps: 1 | Train Loss: 0.917 Vali Loss: 1.081 Vali Acc: 0.400 Test Loss: 1.081 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 9.501117467880249
Epoch: 4, Steps: 1 | Train Loss: 0.838 Vali Loss: 1.090 Vali Acc: 0.400 Test Loss: 1.090 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 10.038719415664673
Epoch: 5, Steps: 1 | Train Loss: 0.821 Vali Loss: 1.098 Vali Acc: 0.467 Test Loss: 1.098 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 6 cost time: 9.54861569404602
Epoch: 6, Steps: 1 | Train Loss: 0.794 Vali Loss: 1.114 Vali Acc: 0.467 Test Loss: 1.114 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 8.933858394622803
Epoch: 7, Steps: 1 | Train Loss: 0.586 Vali Loss: 1.142 Vali Acc: 0.467 Test Loss: 1.142 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 9.497099161148071
Epoch: 8, Steps: 1 | Train Loss: 0.406 Vali Loss: 1.187 Vali Acc: 0.333 Test Loss: 1.187 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 9.826324701309204
Epoch: 9, Steps: 1 | Train Loss: 0.282 Vali Loss: 1.235 Vali Acc: 0.333 Test Loss: 1.235 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 10.069950103759766
Epoch: 10, Steps: 1 | Train Loss: 0.202 Vali Loss: 1.285 Vali Acc: 0.400 Test Loss: 1.285 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 9.688387632369995
Epoch: 11, Steps: 1 | Train Loss: 0.117 Vali Loss: 1.353 Vali Acc: 0.200 Test Loss: 1.353 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 9.399581909179688
Epoch: 12, Steps: 1 | Train Loss: 0.075 Vali Loss: 1.421 Vali Acc: 0.200 Test Loss: 1.421 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 9.067923307418823
Epoch: 13, Steps: 1 | Train Loss: 0.035 Vali Loss: 1.493 Vali Acc: 0.267 Test Loss: 1.493 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 9.42004132270813
Epoch: 14, Steps: 1 | Train Loss: 0.022 Vali Loss: 1.565 Vali Acc: 0.267 Test Loss: 1.565 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 9.359073400497437
Epoch: 15, Steps: 1 | Train Loss: 0.010 Vali Loss: 1.639 Vali Acc: 0.267 Test Loss: 1.639 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm128_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 75229699
model size : 289.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm128_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 6.4885172843933105
Epoch: 1, Steps: 1 | Train Loss: 1.143 Vali Loss: 1.119 Vali Acc: 0.267 Test Loss: 1.119 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 3.290419340133667
Epoch: 2, Steps: 1 | Train Loss: 1.064 Vali Loss: 1.108 Vali Acc: 0.333 Test Loss: 1.108 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 3.293600559234619
Epoch: 3, Steps: 1 | Train Loss: 0.934 Vali Loss: 1.107 Vali Acc: 0.333 Test Loss: 1.107 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 3.4972822666168213
Epoch: 4, Steps: 1 | Train Loss: 0.933 Vali Loss: 1.110 Vali Acc: 0.267 Test Loss: 1.110 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.0597639083862305
Epoch: 5, Steps: 1 | Train Loss: 0.887 Vali Loss: 1.113 Vali Acc: 0.333 Test Loss: 1.113 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.3089585304260254
Epoch: 6, Steps: 1 | Train Loss: 0.751 Vali Loss: 1.121 Vali Acc: 0.333 Test Loss: 1.121 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.206155300140381
Epoch: 7, Steps: 1 | Train Loss: 0.639 Vali Loss: 1.136 Vali Acc: 0.267 Test Loss: 1.136 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.8184773921966553
Epoch: 8, Steps: 1 | Train Loss: 0.465 Vali Loss: 1.170 Vali Acc: 0.267 Test Loss: 1.170 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.0488274097442627
Epoch: 9, Steps: 1 | Train Loss: 0.341 Vali Loss: 1.217 Vali Acc: 0.267 Test Loss: 1.217 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.9347143173217773
Epoch: 10, Steps: 1 | Train Loss: 0.255 Vali Loss: 1.263 Vali Acc: 0.133 Test Loss: 1.263 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 3.2000157833099365
Epoch: 11, Steps: 1 | Train Loss: 0.148 Vali Loss: 1.315 Vali Acc: 0.267 Test Loss: 1.315 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.6807215213775635
Epoch: 12, Steps: 1 | Train Loss: 0.102 Vali Loss: 1.374 Vali Acc: 0.267 Test Loss: 1.374 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.6907296180725098
Epoch: 13, Steps: 1 | Train Loss: 0.063 Vali Loss: 1.439 Vali Acc: 0.267 Test Loss: 1.439 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm128_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 22273539
model size : 87.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm128_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 10.746700525283813
Epoch: 1, Steps: 1 | Train Loss: 1.125 Vali Loss: 1.053 Vali Acc: 0.400 Test Loss: 1.053 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 4.605172634124756
Epoch: 2, Steps: 1 | Train Loss: 1.040 Vali Loss: 1.051 Vali Acc: 0.467 Test Loss: 1.051 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 5.630105257034302
Epoch: 3, Steps: 1 | Train Loss: 0.915 Vali Loss: 1.055 Vali Acc: 0.467 Test Loss: 1.055 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.030468702316284
Epoch: 4, Steps: 1 | Train Loss: 0.846 Vali Loss: 1.064 Vali Acc: 0.333 Test Loss: 1.064 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.331590175628662
Epoch: 5, Steps: 1 | Train Loss: 0.817 Vali Loss: 1.072 Vali Acc: 0.333 Test Loss: 1.072 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.884553670883179
Epoch: 6, Steps: 1 | Train Loss: 0.788 Vali Loss: 1.090 Vali Acc: 0.467 Test Loss: 1.090 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 5.624600172042847
Epoch: 7, Steps: 1 | Train Loss: 0.598 Vali Loss: 1.123 Vali Acc: 0.333 Test Loss: 1.123 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 5.343319654464722
Epoch: 8, Steps: 1 | Train Loss: 0.427 Vali Loss: 1.172 Vali Acc: 0.333 Test Loss: 1.172 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 5.9245312213897705
Epoch: 9, Steps: 1 | Train Loss: 0.300 Vali Loss: 1.229 Vali Acc: 0.333 Test Loss: 1.229 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 5.864445447921753
Epoch: 10, Steps: 1 | Train Loss: 0.215 Vali Loss: 1.294 Vali Acc: 0.333 Test Loss: 1.294 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 6.038624286651611
Epoch: 11, Steps: 1 | Train Loss: 0.126 Vali Loss: 1.383 Vali Acc: 0.267 Test Loss: 1.383 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 6.08320689201355
Epoch: 12, Steps: 1 | Train Loss: 0.082 Vali Loss: 1.465 Vali Acc: 0.267 Test Loss: 1.465 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm128_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 75229699
model size : 289.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm128_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 5.439345836639404
Epoch: 1, Steps: 1 | Train Loss: 1.173 Vali Loss: 1.119 Vali Acc: 0.267 Test Loss: 1.119 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 1.7397632598876953
Epoch: 2, Steps: 1 | Train Loss: 1.086 Vali Loss: 1.108 Vali Acc: 0.333 Test Loss: 1.108 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 1.8544538021087646
Epoch: 3, Steps: 1 | Train Loss: 0.951 Vali Loss: 1.109 Vali Acc: 0.267 Test Loss: 1.109 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7938613891601562
Epoch: 4, Steps: 1 | Train Loss: 0.953 Vali Loss: 1.114 Vali Acc: 0.267 Test Loss: 1.114 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.7694549560546875
Epoch: 5, Steps: 1 | Train Loss: 0.903 Vali Loss: 1.119 Vali Acc: 0.333 Test Loss: 1.119 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.7278761863708496
Epoch: 6, Steps: 1 | Train Loss: 0.772 Vali Loss: 1.128 Vali Acc: 0.267 Test Loss: 1.128 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.6351463794708252
Epoch: 7, Steps: 1 | Train Loss: 0.658 Vali Loss: 1.145 Vali Acc: 0.333 Test Loss: 1.145 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.9081263542175293
Epoch: 8, Steps: 1 | Train Loss: 0.483 Vali Loss: 1.182 Vali Acc: 0.200 Test Loss: 1.182 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.9950025081634521
Epoch: 9, Steps: 1 | Train Loss: 0.351 Vali Loss: 1.235 Vali Acc: 0.200 Test Loss: 1.235 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.804276466369629
Epoch: 10, Steps: 1 | Train Loss: 0.264 Vali Loss: 1.288 Vali Acc: 0.133 Test Loss: 1.288 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.031022787094116
Epoch: 11, Steps: 1 | Train Loss: 0.156 Vali Loss: 1.347 Vali Acc: 0.267 Test Loss: 1.347 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.8364100456237793
Epoch: 12, Steps: 1 | Train Loss: 0.107 Vali Loss: 1.414 Vali Acc: 0.267 Test Loss: 1.414 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm128_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 22273539
model size : 87.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm128_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 8.465933322906494
Epoch: 1, Steps: 1 | Train Loss: 1.125 Vali Loss: 1.075 Vali Acc: 0.400 Test Loss: 1.075 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 2.925299644470215
Epoch: 2, Steps: 1 | Train Loss: 1.043 Vali Loss: 1.073 Vali Acc: 0.400 Test Loss: 1.073 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 2.9961764812469482
Epoch: 3, Steps: 1 | Train Loss: 0.916 Vali Loss: 1.078 Vali Acc: 0.400 Test Loss: 1.078 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.812934637069702
Epoch: 4, Steps: 1 | Train Loss: 0.853 Vali Loss: 1.087 Vali Acc: 0.400 Test Loss: 1.087 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.6878771781921387
Epoch: 5, Steps: 1 | Train Loss: 0.822 Vali Loss: 1.096 Vali Acc: 0.333 Test Loss: 1.096 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.9933836460113525
Epoch: 6, Steps: 1 | Train Loss: 0.790 Vali Loss: 1.116 Vali Acc: 0.467 Test Loss: 1.116 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 7 cost time: 2.977440595626831
Epoch: 7, Steps: 1 | Train Loss: 0.622 Vali Loss: 1.149 Vali Acc: 0.333 Test Loss: 1.149 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.963779926300049
Epoch: 8, Steps: 1 | Train Loss: 0.453 Vali Loss: 1.199 Vali Acc: 0.333 Test Loss: 1.199 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.9999685287475586
Epoch: 9, Steps: 1 | Train Loss: 0.321 Vali Loss: 1.258 Vali Acc: 0.333 Test Loss: 1.258 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.962275981903076
Epoch: 10, Steps: 1 | Train Loss: 0.232 Vali Loss: 1.323 Vali Acc: 0.333 Test Loss: 1.323 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.4177744388580322
Epoch: 11, Steps: 1 | Train Loss: 0.141 Vali Loss: 1.407 Vali Acc: 0.267 Test Loss: 1.407 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.4518861770629883
Epoch: 12, Steps: 1 | Train Loss: 0.089 Vali Loss: 1.485 Vali Acc: 0.200 Test Loss: 1.485 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.467397689819336
Epoch: 13, Steps: 1 | Train Loss: 0.046 Vali Loss: 1.564 Vali Acc: 0.133 Test Loss: 1.564 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.7804503440856934
Epoch: 14, Steps: 1 | Train Loss: 0.027 Vali Loss: 1.649 Vali Acc: 0.133 Test Loss: 1.649 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.924217462539673
Epoch: 15, Steps: 1 | Train Loss: 0.013 Vali Loss: 1.740 Vali Acc: 0.133 Test Loss: 1.740 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.9051380157470703
Epoch: 16, Steps: 1 | Train Loss: 0.007 Vali Loss: 1.834 Vali Acc: 0.133 Test Loss: 1.834 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm128_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 75229699
model size : 289.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm128_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 4.257017612457275
Epoch: 1, Steps: 1 | Train Loss: 1.182 Vali Loss: 1.126 Vali Acc: 0.333 Test Loss: 1.126 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 1.356123685836792
Epoch: 2, Steps: 1 | Train Loss: 1.098 Vali Loss: 1.116 Vali Acc: 0.400 Test Loss: 1.116 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 1.3742167949676514
Epoch: 3, Steps: 1 | Train Loss: 0.956 Vali Loss: 1.118 Vali Acc: 0.333 Test Loss: 1.118 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5301849842071533
Epoch: 4, Steps: 1 | Train Loss: 0.957 Vali Loss: 1.123 Vali Acc: 0.333 Test Loss: 1.123 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.4034702777862549
Epoch: 5, Steps: 1 | Train Loss: 0.904 Vali Loss: 1.128 Vali Acc: 0.400 Test Loss: 1.128 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.521214485168457
Epoch: 6, Steps: 1 | Train Loss: 0.773 Vali Loss: 1.136 Vali Acc: 0.333 Test Loss: 1.136 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.5402171611785889
Epoch: 7, Steps: 1 | Train Loss: 0.677 Vali Loss: 1.153 Vali Acc: 0.333 Test Loss: 1.153 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.5561420917510986
Epoch: 8, Steps: 1 | Train Loss: 0.506 Vali Loss: 1.191 Vali Acc: 0.267 Test Loss: 1.191 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.5357460975646973
Epoch: 9, Steps: 1 | Train Loss: 0.374 Vali Loss: 1.247 Vali Acc: 0.133 Test Loss: 1.247 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.3712873458862305
Epoch: 10, Steps: 1 | Train Loss: 0.282 Vali Loss: 1.302 Vali Acc: 0.267 Test Loss: 1.302 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.596848726272583
Epoch: 11, Steps: 1 | Train Loss: 0.173 Vali Loss: 1.357 Vali Acc: 0.333 Test Loss: 1.357 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.3088457584381104
Epoch: 12, Steps: 1 | Train Loss: 0.118 Vali Loss: 1.421 Vali Acc: 0.267 Test Loss: 1.421 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm128_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 22273539
model size : 87.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm128_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 8.373022317886353
Epoch: 1, Steps: 1 | Train Loss: 1.099 Vali Loss: 1.113 Vali Acc: 0.333 Test Loss: 1.113 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 4.831250429153442
Epoch: 2, Steps: 1 | Train Loss: 1.042 Vali Loss: 1.120 Vali Acc: 0.333 Test Loss: 1.120 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.88319206237793
Epoch: 3, Steps: 1 | Train Loss: 0.906 Vali Loss: 1.130 Vali Acc: 0.333 Test Loss: 1.130 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.909000635147095
Epoch: 4, Steps: 1 | Train Loss: 0.851 Vali Loss: 1.138 Vali Acc: 0.267 Test Loss: 1.138 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.914220571517944
Epoch: 5, Steps: 1 | Train Loss: 0.817 Vali Loss: 1.146 Vali Acc: 0.267 Test Loss: 1.146 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.447279453277588
Epoch: 6, Steps: 1 | Train Loss: 0.751 Vali Loss: 1.167 Vali Acc: 0.333 Test Loss: 1.167 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.295882701873779
Epoch: 7, Steps: 1 | Train Loss: 0.621 Vali Loss: 1.202 Vali Acc: 0.267 Test Loss: 1.202 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.482329607009888
Epoch: 8, Steps: 1 | Train Loss: 0.458 Vali Loss: 1.251 Vali Acc: 0.267 Test Loss: 1.251 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 4.486986398696899
Epoch: 9, Steps: 1 | Train Loss: 0.316 Vali Loss: 1.315 Vali Acc: 0.333 Test Loss: 1.315 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 4.7991907596588135
Epoch: 10, Steps: 1 | Train Loss: 0.238 Vali Loss: 1.392 Vali Acc: 0.333 Test Loss: 1.392 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 4.365127086639404
Epoch: 11, Steps: 1 | Train Loss: 0.145 Vali Loss: 1.502 Vali Acc: 0.333 Test Loss: 1.502 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm128_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 37740035
model size : 146.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm128_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 4.6599931716918945
Epoch: 1, Steps: 1 | Train Loss: 1.145 Vali Loss: 1.156 Vali Acc: 0.333 Test Loss: 1.156 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 1.9947218894958496
Epoch: 2, Steps: 1 | Train Loss: 1.025 Vali Loss: 1.166 Vali Acc: 0.333 Test Loss: 1.166 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.142449378967285
Epoch: 3, Steps: 1 | Train Loss: 1.002 Vali Loss: 1.178 Vali Acc: 0.333 Test Loss: 1.178 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.067934989929199
Epoch: 4, Steps: 1 | Train Loss: 0.893 Vali Loss: 1.188 Vali Acc: 0.333 Test Loss: 1.188 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.000730037689209
Epoch: 5, Steps: 1 | Train Loss: 0.816 Vali Loss: 1.196 Vali Acc: 0.333 Test Loss: 1.196 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.057962417602539
Epoch: 6, Steps: 1 | Train Loss: 0.812 Vali Loss: 1.213 Vali Acc: 0.333 Test Loss: 1.213 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.02292537689209
Epoch: 7, Steps: 1 | Train Loss: 0.652 Vali Loss: 1.234 Vali Acc: 0.267 Test Loss: 1.234 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.8974814414978027
Epoch: 8, Steps: 1 | Train Loss: 0.474 Vali Loss: 1.263 Vali Acc: 0.267 Test Loss: 1.263 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.8516225814819336
Epoch: 9, Steps: 1 | Train Loss: 0.352 Vali Loss: 1.307 Vali Acc: 0.267 Test Loss: 1.307 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.986572504043579
Epoch: 10, Steps: 1 | Train Loss: 0.269 Vali Loss: 1.362 Vali Acc: 0.267 Test Loss: 1.362 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.9514846801757812
Epoch: 11, Steps: 1 | Train Loss: 0.176 Vali Loss: 1.416 Vali Acc: 0.267 Test Loss: 1.416 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm128_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 11261443
model size : 45.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm128_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 7.22335410118103
Epoch: 1, Steps: 1 | Train Loss: 1.097 Vali Loss: 1.111 Vali Acc: 0.333 Test Loss: 1.111 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 3.4501657485961914
Epoch: 2, Steps: 1 | Train Loss: 1.041 Vali Loss: 1.119 Vali Acc: 0.333 Test Loss: 1.119 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.9859328269958496
Epoch: 3, Steps: 1 | Train Loss: 0.907 Vali Loss: 1.130 Vali Acc: 0.333 Test Loss: 1.130 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.0628790855407715
Epoch: 4, Steps: 1 | Train Loss: 0.853 Vali Loss: 1.139 Vali Acc: 0.267 Test Loss: 1.139 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.0961945056915283
Epoch: 5, Steps: 1 | Train Loss: 0.822 Vali Loss: 1.147 Vali Acc: 0.267 Test Loss: 1.147 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.049466133117676
Epoch: 6, Steps: 1 | Train Loss: 0.753 Vali Loss: 1.166 Vali Acc: 0.400 Test Loss: 1.166 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 7 cost time: 3.2300729751586914
Epoch: 7, Steps: 1 | Train Loss: 0.630 Vali Loss: 1.197 Vali Acc: 0.267 Test Loss: 1.197 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.5435354709625244
Epoch: 8, Steps: 1 | Train Loss: 0.472 Vali Loss: 1.243 Vali Acc: 0.333 Test Loss: 1.243 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.183248996734619
Epoch: 9, Steps: 1 | Train Loss: 0.328 Vali Loss: 1.301 Vali Acc: 0.333 Test Loss: 1.301 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.2755022048950195
Epoch: 10, Steps: 1 | Train Loss: 0.245 Vali Loss: 1.375 Vali Acc: 0.333 Test Loss: 1.375 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.216212272644043
Epoch: 11, Steps: 1 | Train Loss: 0.151 Vali Loss: 1.483 Vali Acc: 0.333 Test Loss: 1.483 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.2766449451446533
Epoch: 12, Steps: 1 | Train Loss: 0.089 Vali Loss: 1.581 Vali Acc: 0.333 Test Loss: 1.581 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.208223819732666
Epoch: 13, Steps: 1 | Train Loss: 0.055 Vali Loss: 1.667 Vali Acc: 0.333 Test Loss: 1.667 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.1688711643218994
Epoch: 14, Steps: 1 | Train Loss: 0.032 Vali Loss: 1.746 Vali Acc: 0.267 Test Loss: 1.746 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.144646406173706
Epoch: 15, Steps: 1 | Train Loss: 0.018 Vali Loss: 1.824 Vali Acc: 0.333 Test Loss: 1.824 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.5790493488311768
Epoch: 16, Steps: 1 | Train Loss: 0.011 Vali Loss: 1.912 Vali Acc: 0.333 Test Loss: 1.912 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm128_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 37740035
model size : 146.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm128_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 4.475964307785034
Epoch: 1, Steps: 1 | Train Loss: 1.153 Vali Loss: 1.143 Vali Acc: 0.333 Test Loss: 1.143 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.9917805194854736
Epoch: 2, Steps: 1 | Train Loss: 1.038 Vali Loss: 1.155 Vali Acc: 0.333 Test Loss: 1.155 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4279348850250244
Epoch: 3, Steps: 1 | Train Loss: 1.011 Vali Loss: 1.168 Vali Acc: 0.333 Test Loss: 1.168 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.5766088962554932
Epoch: 4, Steps: 1 | Train Loss: 0.895 Vali Loss: 1.180 Vali Acc: 0.333 Test Loss: 1.180 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.1867640018463135
Epoch: 5, Steps: 1 | Train Loss: 0.835 Vali Loss: 1.189 Vali Acc: 0.333 Test Loss: 1.189 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.46205472946167
Epoch: 6, Steps: 1 | Train Loss: 0.821 Vali Loss: 1.209 Vali Acc: 0.333 Test Loss: 1.209 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.32192063331604
Epoch: 7, Steps: 1 | Train Loss: 0.664 Vali Loss: 1.234 Vali Acc: 0.267 Test Loss: 1.234 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.401310682296753
Epoch: 8, Steps: 1 | Train Loss: 0.495 Vali Loss: 1.269 Vali Acc: 0.267 Test Loss: 1.269 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.508152961730957
Epoch: 9, Steps: 1 | Train Loss: 0.371 Vali Loss: 1.321 Vali Acc: 0.267 Test Loss: 1.321 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.4201998710632324
Epoch: 10, Steps: 1 | Train Loss: 0.282 Vali Loss: 1.383 Vali Acc: 0.267 Test Loss: 1.383 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.4182531833648682
Epoch: 11, Steps: 1 | Train Loss: 0.193 Vali Loss: 1.444 Vali Acc: 0.267 Test Loss: 1.444 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm128_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 11261443
model size : 45.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm128_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 5.670619010925293
Epoch: 1, Steps: 1 | Train Loss: 1.101 Vali Loss: 1.110 Vali Acc: 0.333 Test Loss: 1.110 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 1.9769630432128906
Epoch: 2, Steps: 1 | Train Loss: 1.048 Vali Loss: 1.119 Vali Acc: 0.333 Test Loss: 1.119 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.927499532699585
Epoch: 3, Steps: 1 | Train Loss: 0.918 Vali Loss: 1.130 Vali Acc: 0.267 Test Loss: 1.130 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.9212462902069092
Epoch: 4, Steps: 1 | Train Loss: 0.856 Vali Loss: 1.139 Vali Acc: 0.267 Test Loss: 1.139 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.9917924404144287
Epoch: 5, Steps: 1 | Train Loss: 0.832 Vali Loss: 1.148 Vali Acc: 0.267 Test Loss: 1.148 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.8836758136749268
Epoch: 6, Steps: 1 | Train Loss: 0.755 Vali Loss: 1.167 Vali Acc: 0.333 Test Loss: 1.167 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.9082601070404053
Epoch: 7, Steps: 1 | Train Loss: 0.649 Vali Loss: 1.200 Vali Acc: 0.333 Test Loss: 1.200 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.432901382446289
Epoch: 8, Steps: 1 | Train Loss: 0.486 Vali Loss: 1.247 Vali Acc: 0.333 Test Loss: 1.247 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.9235358238220215
Epoch: 9, Steps: 1 | Train Loss: 0.345 Vali Loss: 1.307 Vali Acc: 0.333 Test Loss: 1.307 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.7825191020965576
Epoch: 10, Steps: 1 | Train Loss: 0.259 Vali Loss: 1.383 Vali Acc: 0.400 Test Loss: 1.383 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399986).  Saving model ...
Epoch: 11 cost time: 1.8435635566711426
Epoch: 11, Steps: 1 | Train Loss: 0.165 Vali Loss: 1.487 Vali Acc: 0.400 Test Loss: 1.487 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8548378944396973
Epoch: 12, Steps: 1 | Train Loss: 0.099 Vali Loss: 1.584 Vali Acc: 0.400 Test Loss: 1.584 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.945113182067871
Epoch: 13, Steps: 1 | Train Loss: 0.062 Vali Loss: 1.671 Vali Acc: 0.333 Test Loss: 1.671 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.8936009407043457
Epoch: 14, Steps: 1 | Train Loss: 0.036 Vali Loss: 1.756 Vali Acc: 0.333 Test Loss: 1.756 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.9062392711639404
Epoch: 15, Steps: 1 | Train Loss: 0.020 Vali Loss: 1.845 Vali Acc: 0.333 Test Loss: 1.845 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.898134469985962
Epoch: 16, Steps: 1 | Train Loss: 0.013 Vali Loss: 1.943 Vali Acc: 0.333 Test Loss: 1.943 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.7353200912475586
Epoch: 17, Steps: 1 | Train Loss: 0.006 Vali Loss: 2.045 Vali Acc: 0.333 Test Loss: 2.045 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.7701623439788818
Epoch: 18, Steps: 1 | Train Loss: 0.004 Vali Loss: 2.148 Vali Acc: 0.333 Test Loss: 2.148 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.9580848217010498
Epoch: 19, Steps: 1 | Train Loss: 0.002 Vali Loss: 2.252 Vali Acc: 0.333 Test Loss: 2.252 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.7939915657043457
Epoch: 20, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.354 Vali Acc: 0.333 Test Loss: 2.354 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm128_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 37740035
model size : 146.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm128_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 3.216292381286621
Epoch: 1, Steps: 1 | Train Loss: 1.159 Vali Loss: 1.121 Vali Acc: 0.400 Test Loss: 1.121 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 1.0757231712341309
Epoch: 2, Steps: 1 | Train Loss: 1.037 Vali Loss: 1.132 Vali Acc: 0.400 Test Loss: 1.132 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1580331325531006
Epoch: 3, Steps: 1 | Train Loss: 1.010 Vali Loss: 1.146 Vali Acc: 0.467 Test Loss: 1.146 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 4 cost time: 0.9652895927429199
Epoch: 4, Steps: 1 | Train Loss: 0.895 Vali Loss: 1.158 Vali Acc: 0.400 Test Loss: 1.158 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.036252737045288
Epoch: 5, Steps: 1 | Train Loss: 0.842 Vali Loss: 1.169 Vali Acc: 0.400 Test Loss: 1.169 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.089876651763916
Epoch: 6, Steps: 1 | Train Loss: 0.818 Vali Loss: 1.190 Vali Acc: 0.333 Test Loss: 1.190 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.9964084625244141
Epoch: 7, Steps: 1 | Train Loss: 0.674 Vali Loss: 1.216 Vali Acc: 0.267 Test Loss: 1.216 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.899519681930542
Epoch: 8, Steps: 1 | Train Loss: 0.506 Vali Loss: 1.253 Vali Acc: 0.267 Test Loss: 1.253 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.0183401107788086
Epoch: 9, Steps: 1 | Train Loss: 0.380 Vali Loss: 1.307 Vali Acc: 0.267 Test Loss: 1.307 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.0329632759094238
Epoch: 10, Steps: 1 | Train Loss: 0.293 Vali Loss: 1.373 Vali Acc: 0.267 Test Loss: 1.373 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.0515384674072266
Epoch: 11, Steps: 1 | Train Loss: 0.204 Vali Loss: 1.438 Vali Acc: 0.267 Test Loss: 1.438 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.0972440242767334
Epoch: 12, Steps: 1 | Train Loss: 0.112 Vali Loss: 1.534 Vali Acc: 0.267 Test Loss: 1.534 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.1864945888519287
Epoch: 13, Steps: 1 | Train Loss: 0.075 Vali Loss: 1.618 Vali Acc: 0.267 Test Loss: 1.618 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm128_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 11261443
model size : 45.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm64_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 10.115558385848999
Epoch: 1, Steps: 1 | Train Loss: 1.161 Vali Loss: 1.149 Vali Acc: 0.333 Test Loss: 1.149 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 4.971314191818237
Epoch: 2, Steps: 1 | Train Loss: 1.078 Vali Loss: 1.154 Vali Acc: 0.333 Test Loss: 1.154 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.410547256469727
Epoch: 3, Steps: 1 | Train Loss: 1.043 Vali Loss: 1.161 Vali Acc: 0.400 Test Loss: 1.161 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 4 cost time: 5.383067607879639
Epoch: 4, Steps: 1 | Train Loss: 1.009 Vali Loss: 1.168 Vali Acc: 0.333 Test Loss: 1.168 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.558624982833862
Epoch: 5, Steps: 1 | Train Loss: 0.975 Vali Loss: 1.174 Vali Acc: 0.333 Test Loss: 1.174 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.311203718185425
Epoch: 6, Steps: 1 | Train Loss: 0.933 Vali Loss: 1.185 Vali Acc: 0.333 Test Loss: 1.185 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.665852785110474
Epoch: 7, Steps: 1 | Train Loss: 0.805 Vali Loss: 1.198 Vali Acc: 0.333 Test Loss: 1.198 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.439411163330078
Epoch: 8, Steps: 1 | Train Loss: 0.714 Vali Loss: 1.212 Vali Acc: 0.333 Test Loss: 1.212 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 5.088756322860718
Epoch: 9, Steps: 1 | Train Loss: 0.562 Vali Loss: 1.228 Vali Acc: 0.267 Test Loss: 1.228 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 6.025376796722412
Epoch: 10, Steps: 1 | Train Loss: 0.494 Vali Loss: 1.249 Vali Acc: 0.267 Test Loss: 1.249 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 5.64767050743103
Epoch: 11, Steps: 1 | Train Loss: 0.389 Vali Loss: 1.270 Vali Acc: 0.267 Test Loss: 1.270 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 6.03325080871582
Epoch: 12, Steps: 1 | Train Loss: 0.286 Vali Loss: 1.298 Vali Acc: 0.267 Test Loss: 1.298 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 5.61644983291626
Epoch: 13, Steps: 1 | Train Loss: 0.223 Vali Loss: 1.335 Vali Acc: 0.333 Test Loss: 1.335 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm64_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 37617923
model size : 144.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm64_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 5.647423505783081
Epoch: 1, Steps: 1 | Train Loss: 1.168 Vali Loss: 1.121 Vali Acc: 0.467 Test Loss: 1.121 Test Acc: 0.467
Validation loss decreased (inf --> -0.466655).  Saving model ...
Epoch: 2 cost time: 2.095097541809082
Epoch: 2, Steps: 1 | Train Loss: 1.132 Vali Loss: 1.117 Vali Acc: 0.467 Test Loss: 1.117 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 3 cost time: 1.8684358596801758
Epoch: 3, Steps: 1 | Train Loss: 0.972 Vali Loss: 1.117 Vali Acc: 0.467 Test Loss: 1.117 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.049144744873047
Epoch: 4, Steps: 1 | Train Loss: 0.928 Vali Loss: 1.120 Vali Acc: 0.467 Test Loss: 1.120 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.142606496810913
Epoch: 5, Steps: 1 | Train Loss: 0.934 Vali Loss: 1.124 Vali Acc: 0.400 Test Loss: 1.124 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.0054433345794678
Epoch: 6, Steps: 1 | Train Loss: 0.903 Vali Loss: 1.134 Vali Acc: 0.400 Test Loss: 1.134 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.0041985511779785
Epoch: 7, Steps: 1 | Train Loss: 0.750 Vali Loss: 1.149 Vali Acc: 0.400 Test Loss: 1.149 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.0040955543518066
Epoch: 8, Steps: 1 | Train Loss: 0.699 Vali Loss: 1.174 Vali Acc: 0.333 Test Loss: 1.174 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.0887579917907715
Epoch: 9, Steps: 1 | Train Loss: 0.587 Vali Loss: 1.210 Vali Acc: 0.400 Test Loss: 1.210 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.7030014991760254
Epoch: 10, Steps: 1 | Train Loss: 0.471 Vali Loss: 1.246 Vali Acc: 0.333 Test Loss: 1.246 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.9945433139801025
Epoch: 11, Steps: 1 | Train Loss: 0.384 Vali Loss: 1.275 Vali Acc: 0.333 Test Loss: 1.275 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.9785175323486328
Epoch: 12, Steps: 1 | Train Loss: 0.298 Vali Loss: 1.300 Vali Acc: 0.333 Test Loss: 1.300 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm64_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 11138819
model size : 43.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm64_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 8.638773441314697
Epoch: 1, Steps: 1 | Train Loss: 1.164 Vali Loss: 1.148 Vali Acc: 0.333 Test Loss: 1.148 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 3.2653768062591553
Epoch: 2, Steps: 1 | Train Loss: 1.098 Vali Loss: 1.154 Vali Acc: 0.333 Test Loss: 1.154 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.5525155067443848
Epoch: 3, Steps: 1 | Train Loss: 1.059 Vali Loss: 1.161 Vali Acc: 0.400 Test Loss: 1.161 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 4 cost time: 3.448744535446167
Epoch: 4, Steps: 1 | Train Loss: 1.016 Vali Loss: 1.168 Vali Acc: 0.333 Test Loss: 1.168 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.390422821044922
Epoch: 5, Steps: 1 | Train Loss: 0.977 Vali Loss: 1.174 Vali Acc: 0.333 Test Loss: 1.174 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.5962250232696533
Epoch: 6, Steps: 1 | Train Loss: 0.940 Vali Loss: 1.185 Vali Acc: 0.333 Test Loss: 1.185 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.397282838821411
Epoch: 7, Steps: 1 | Train Loss: 0.828 Vali Loss: 1.200 Vali Acc: 0.333 Test Loss: 1.200 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.2935478687286377
Epoch: 8, Steps: 1 | Train Loss: 0.736 Vali Loss: 1.215 Vali Acc: 0.333 Test Loss: 1.215 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.8383634090423584
Epoch: 9, Steps: 1 | Train Loss: 0.603 Vali Loss: 1.233 Vali Acc: 0.267 Test Loss: 1.233 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.4801688194274902
Epoch: 10, Steps: 1 | Train Loss: 0.521 Vali Loss: 1.257 Vali Acc: 0.267 Test Loss: 1.257 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 3.8212993144989014
Epoch: 11, Steps: 1 | Train Loss: 0.416 Vali Loss: 1.282 Vali Acc: 0.267 Test Loss: 1.282 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 3.655247449874878
Epoch: 12, Steps: 1 | Train Loss: 0.312 Vali Loss: 1.316 Vali Acc: 0.333 Test Loss: 1.316 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 3.765700101852417
Epoch: 13, Steps: 1 | Train Loss: 0.241 Vali Loss: 1.360 Vali Acc: 0.333 Test Loss: 1.360 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm64_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 37617923
model size : 144.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm64_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 4.215732097625732
Epoch: 1, Steps: 1 | Train Loss: 1.165 Vali Loss: 1.116 Vali Acc: 0.467 Test Loss: 1.116 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 1.3236043453216553
Epoch: 2, Steps: 1 | Train Loss: 1.118 Vali Loss: 1.112 Vali Acc: 0.467 Test Loss: 1.112 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 1.3864262104034424
Epoch: 3, Steps: 1 | Train Loss: 0.965 Vali Loss: 1.112 Vali Acc: 0.467 Test Loss: 1.112 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2777574062347412
Epoch: 4, Steps: 1 | Train Loss: 0.923 Vali Loss: 1.115 Vali Acc: 0.400 Test Loss: 1.115 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.3615310192108154
Epoch: 5, Steps: 1 | Train Loss: 0.931 Vali Loss: 1.119 Vali Acc: 0.400 Test Loss: 1.119 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.3462400436401367
Epoch: 6, Steps: 1 | Train Loss: 0.893 Vali Loss: 1.129 Vali Acc: 0.400 Test Loss: 1.129 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.4777929782867432
Epoch: 7, Steps: 1 | Train Loss: 0.754 Vali Loss: 1.145 Vali Acc: 0.400 Test Loss: 1.145 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.3402559757232666
Epoch: 8, Steps: 1 | Train Loss: 0.710 Vali Loss: 1.170 Vali Acc: 0.400 Test Loss: 1.170 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.3340837955474854
Epoch: 9, Steps: 1 | Train Loss: 0.598 Vali Loss: 1.206 Vali Acc: 0.333 Test Loss: 1.206 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.3674914836883545
Epoch: 10, Steps: 1 | Train Loss: 0.484 Vali Loss: 1.242 Vali Acc: 0.333 Test Loss: 1.242 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.4489402770996094
Epoch: 11, Steps: 1 | Train Loss: 0.388 Vali Loss: 1.273 Vali Acc: 0.333 Test Loss: 1.273 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.352794885635376
Epoch: 12, Steps: 1 | Train Loss: 0.302 Vali Loss: 1.303 Vali Acc: 0.333 Test Loss: 1.303 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm64_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 11138819
model size : 43.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm64_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 6.173711538314819
Epoch: 1, Steps: 1 | Train Loss: 1.172 Vali Loss: 1.150 Vali Acc: 0.333 Test Loss: 1.150 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 1.9357068538665771
Epoch: 2, Steps: 1 | Train Loss: 1.095 Vali Loss: 1.155 Vali Acc: 0.333 Test Loss: 1.155 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.0234923362731934
Epoch: 3, Steps: 1 | Train Loss: 1.055 Vali Loss: 1.163 Vali Acc: 0.333 Test Loss: 1.163 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.8794925212860107
Epoch: 4, Steps: 1 | Train Loss: 1.013 Vali Loss: 1.170 Vali Acc: 0.267 Test Loss: 1.170 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.912895917892456
Epoch: 5, Steps: 1 | Train Loss: 0.968 Vali Loss: 1.177 Vali Acc: 0.267 Test Loss: 1.177 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.7224209308624268
Epoch: 6, Steps: 1 | Train Loss: 0.939 Vali Loss: 1.188 Vali Acc: 0.267 Test Loss: 1.188 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.8167245388031006
Epoch: 7, Steps: 1 | Train Loss: 0.843 Vali Loss: 1.202 Vali Acc: 0.333 Test Loss: 1.202 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.44010329246521
Epoch: 8, Steps: 1 | Train Loss: 0.765 Vali Loss: 1.216 Vali Acc: 0.267 Test Loss: 1.216 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.9405546188354492
Epoch: 9, Steps: 1 | Train Loss: 0.636 Vali Loss: 1.233 Vali Acc: 0.267 Test Loss: 1.233 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.9833433628082275
Epoch: 10, Steps: 1 | Train Loss: 0.552 Vali Loss: 1.256 Vali Acc: 0.200 Test Loss: 1.256 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.011631727218628
Epoch: 11, Steps: 1 | Train Loss: 0.441 Vali Loss: 1.282 Vali Acc: 0.200 Test Loss: 1.282 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm64_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 37617923
model size : 144.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm64_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 3.4619879722595215
Epoch: 1, Steps: 1 | Train Loss: 1.162 Vali Loss: 1.122 Vali Acc: 0.467 Test Loss: 1.122 Test Acc: 0.467
Validation loss decreased (inf --> -0.466655).  Saving model ...
Epoch: 2 cost time: 1.075667142868042
Epoch: 2, Steps: 1 | Train Loss: 1.112 Vali Loss: 1.118 Vali Acc: 0.467 Test Loss: 1.118 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 3 cost time: 1.0195400714874268
Epoch: 3, Steps: 1 | Train Loss: 0.963 Vali Loss: 1.117 Vali Acc: 0.467 Test Loss: 1.117 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 4 cost time: 1.074568271636963
Epoch: 4, Steps: 1 | Train Loss: 0.922 Vali Loss: 1.120 Vali Acc: 0.400 Test Loss: 1.120 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9299724102020264
Epoch: 5, Steps: 1 | Train Loss: 0.930 Vali Loss: 1.124 Vali Acc: 0.400 Test Loss: 1.124 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.0048346519470215
Epoch: 6, Steps: 1 | Train Loss: 0.890 Vali Loss: 1.135 Vali Acc: 0.400 Test Loss: 1.135 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.0089855194091797
Epoch: 7, Steps: 1 | Train Loss: 0.760 Vali Loss: 1.153 Vali Acc: 0.400 Test Loss: 1.153 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.1076607704162598
Epoch: 8, Steps: 1 | Train Loss: 0.728 Vali Loss: 1.180 Vali Acc: 0.400 Test Loss: 1.180 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.1055102348327637
Epoch: 9, Steps: 1 | Train Loss: 0.616 Vali Loss: 1.219 Vali Acc: 0.333 Test Loss: 1.219 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.0988273620605469
Epoch: 10, Steps: 1 | Train Loss: 0.501 Vali Loss: 1.257 Vali Acc: 0.333 Test Loss: 1.257 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.0420968532562256
Epoch: 11, Steps: 1 | Train Loss: 0.412 Vali Loss: 1.289 Vali Acc: 0.333 Test Loss: 1.289 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.2169268131256104
Epoch: 12, Steps: 1 | Train Loss: 0.326 Vali Loss: 1.320 Vali Acc: 0.400 Test Loss: 1.320 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.0261659622192383
Epoch: 13, Steps: 1 | Train Loss: 0.241 Vali Loss: 1.363 Vali Acc: 0.400 Test Loss: 1.363 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm64_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 11138819
model size : 43.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm64_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 6.405493497848511
Epoch: 1, Steps: 1 | Train Loss: 1.202 Vali Loss: 1.124 Vali Acc: 0.200 Test Loss: 1.124 Test Acc: 0.200
Validation loss decreased (inf --> -0.199989).  Saving model ...
Epoch: 2 cost time: 3.1371514797210693
Epoch: 2, Steps: 1 | Train Loss: 1.090 Vali Loss: 1.115 Vali Acc: 0.200 Test Loss: 1.115 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 3 cost time: 2.9653947353363037
Epoch: 3, Steps: 1 | Train Loss: 1.060 Vali Loss: 1.114 Vali Acc: 0.333 Test Loss: 1.114 Test Acc: 0.333
Validation loss decreased (-0.199989 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 3.570081949234009
Epoch: 4, Steps: 1 | Train Loss: 0.910 Vali Loss: 1.118 Vali Acc: 0.267 Test Loss: 1.118 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.496002674102783
Epoch: 5, Steps: 1 | Train Loss: 0.920 Vali Loss: 1.125 Vali Acc: 0.333 Test Loss: 1.125 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.4531197547912598
Epoch: 6, Steps: 1 | Train Loss: 0.898 Vali Loss: 1.138 Vali Acc: 0.267 Test Loss: 1.138 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.9862992763519287
Epoch: 7, Steps: 1 | Train Loss: 0.776 Vali Loss: 1.157 Vali Acc: 0.267 Test Loss: 1.157 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.039750814437866
Epoch: 8, Steps: 1 | Train Loss: 0.720 Vali Loss: 1.176 Vali Acc: 0.267 Test Loss: 1.176 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.2135367393493652
Epoch: 9, Steps: 1 | Train Loss: 0.597 Vali Loss: 1.193 Vali Acc: 0.267 Test Loss: 1.193 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.3503990173339844
Epoch: 10, Steps: 1 | Train Loss: 0.503 Vali Loss: 1.213 Vali Acc: 0.200 Test Loss: 1.213 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 3.3814525604248047
Epoch: 11, Steps: 1 | Train Loss: 0.418 Vali Loss: 1.240 Vali Acc: 0.200 Test Loss: 1.240 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 3.3558261394500732
Epoch: 12, Steps: 1 | Train Loss: 0.361 Vali Loss: 1.280 Vali Acc: 0.333 Test Loss: 1.280 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 3.2613656520843506
Epoch: 13, Steps: 1 | Train Loss: 0.289 Vali Loss: 1.323 Vali Acc: 0.333 Test Loss: 1.323 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm64_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 18871555
model size : 73.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm64_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 3.9111273288726807
Epoch: 1, Steps: 1 | Train Loss: 1.003 Vali Loss: 1.101 Vali Acc: 0.200 Test Loss: 1.101 Test Acc: 0.200
Validation loss decreased (inf --> -0.199989).  Saving model ...
Epoch: 2 cost time: 1.2519829273223877
Epoch: 2, Steps: 1 | Train Loss: 1.017 Vali Loss: 1.107 Vali Acc: 0.333 Test Loss: 1.107 Test Acc: 0.333
Validation loss decreased (-0.199989 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 1.3274705410003662
Epoch: 3, Steps: 1 | Train Loss: 0.903 Vali Loss: 1.117 Vali Acc: 0.467 Test Loss: 1.117 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466655).  Saving model ...
Epoch: 4 cost time: 1.2450809478759766
Epoch: 4, Steps: 1 | Train Loss: 0.863 Vali Loss: 1.125 Vali Acc: 0.467 Test Loss: 1.125 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3245832920074463
Epoch: 5, Steps: 1 | Train Loss: 0.898 Vali Loss: 1.133 Vali Acc: 0.400 Test Loss: 1.133 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.3538265228271484
Epoch: 6, Steps: 1 | Train Loss: 0.838 Vali Loss: 1.143 Vali Acc: 0.400 Test Loss: 1.143 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.2179632186889648
Epoch: 7, Steps: 1 | Train Loss: 0.688 Vali Loss: 1.152 Vali Acc: 0.400 Test Loss: 1.152 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.3299291133880615
Epoch: 8, Steps: 1 | Train Loss: 0.583 Vali Loss: 1.163 Vali Acc: 0.400 Test Loss: 1.163 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.3539106845855713
Epoch: 9, Steps: 1 | Train Loss: 0.488 Vali Loss: 1.178 Vali Acc: 0.333 Test Loss: 1.178 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.1511754989624023
Epoch: 10, Steps: 1 | Train Loss: 0.406 Vali Loss: 1.203 Vali Acc: 0.267 Test Loss: 1.203 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.1539738178253174
Epoch: 11, Steps: 1 | Train Loss: 0.338 Vali Loss: 1.239 Vali Acc: 0.267 Test Loss: 1.239 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.2950313091278076
Epoch: 12, Steps: 1 | Train Loss: 0.263 Vali Loss: 1.280 Vali Acc: 0.333 Test Loss: 1.280 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.2944247722625732
Epoch: 13, Steps: 1 | Train Loss: 0.217 Vali Loss: 1.344 Vali Acc: 0.267 Test Loss: 1.344 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm64_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 5631747
model size : 22.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm64_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 5.594198703765869
Epoch: 1, Steps: 1 | Train Loss: 1.227 Vali Loss: 1.125 Vali Acc: 0.200 Test Loss: 1.125 Test Acc: 0.200
Validation loss decreased (inf --> -0.199989).  Saving model ...
Epoch: 2 cost time: 2.423353910446167
Epoch: 2, Steps: 1 | Train Loss: 1.103 Vali Loss: 1.117 Vali Acc: 0.267 Test Loss: 1.117 Test Acc: 0.267
Validation loss decreased (-0.199989 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 2.40665864944458
Epoch: 3, Steps: 1 | Train Loss: 1.065 Vali Loss: 1.117 Vali Acc: 0.333 Test Loss: 1.117 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 2.4964754581451416
Epoch: 4, Steps: 1 | Train Loss: 0.911 Vali Loss: 1.121 Vali Acc: 0.267 Test Loss: 1.121 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.403982400894165
Epoch: 5, Steps: 1 | Train Loss: 0.922 Vali Loss: 1.128 Vali Acc: 0.333 Test Loss: 1.128 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.3740780353546143
Epoch: 6, Steps: 1 | Train Loss: 0.898 Vali Loss: 1.140 Vali Acc: 0.267 Test Loss: 1.140 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.423845052719116
Epoch: 7, Steps: 1 | Train Loss: 0.775 Vali Loss: 1.156 Vali Acc: 0.267 Test Loss: 1.156 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.3719077110290527
Epoch: 8, Steps: 1 | Train Loss: 0.718 Vali Loss: 1.174 Vali Acc: 0.267 Test Loss: 1.174 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.2339694499969482
Epoch: 9, Steps: 1 | Train Loss: 0.596 Vali Loss: 1.188 Vali Acc: 0.200 Test Loss: 1.188 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.1580142974853516
Epoch: 10, Steps: 1 | Train Loss: 0.502 Vali Loss: 1.205 Vali Acc: 0.133 Test Loss: 1.205 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.2361090183258057
Epoch: 11, Steps: 1 | Train Loss: 0.419 Vali Loss: 1.228 Vali Acc: 0.200 Test Loss: 1.228 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.284557819366455
Epoch: 12, Steps: 1 | Train Loss: 0.361 Vali Loss: 1.262 Vali Acc: 0.333 Test Loss: 1.262 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.305921792984009
Epoch: 13, Steps: 1 | Train Loss: 0.295 Vali Loss: 1.303 Vali Acc: 0.333 Test Loss: 1.303 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm64_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 18871555
model size : 73.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm64_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 3.664293050765991
Epoch: 1, Steps: 1 | Train Loss: 1.011 Vali Loss: 1.102 Vali Acc: 0.200 Test Loss: 1.102 Test Acc: 0.200
Validation loss decreased (inf --> -0.199989).  Saving model ...
Epoch: 2 cost time: 0.9334168434143066
Epoch: 2, Steps: 1 | Train Loss: 1.021 Vali Loss: 1.109 Vali Acc: 0.333 Test Loss: 1.109 Test Acc: 0.333
Validation loss decreased (-0.199989 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.9663453102111816
Epoch: 3, Steps: 1 | Train Loss: 0.910 Vali Loss: 1.119 Vali Acc: 0.467 Test Loss: 1.119 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466655).  Saving model ...
Epoch: 4 cost time: 0.9738538265228271
Epoch: 4, Steps: 1 | Train Loss: 0.880 Vali Loss: 1.128 Vali Acc: 0.400 Test Loss: 1.128 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0201647281646729
Epoch: 5, Steps: 1 | Train Loss: 0.904 Vali Loss: 1.136 Vali Acc: 0.400 Test Loss: 1.136 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9929189682006836
Epoch: 6, Steps: 1 | Train Loss: 0.837 Vali Loss: 1.146 Vali Acc: 0.400 Test Loss: 1.146 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.957244873046875
Epoch: 7, Steps: 1 | Train Loss: 0.694 Vali Loss: 1.156 Vali Acc: 0.400 Test Loss: 1.156 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.0226964950561523
Epoch: 8, Steps: 1 | Train Loss: 0.593 Vali Loss: 1.168 Vali Acc: 0.400 Test Loss: 1.168 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.1839377880096436
Epoch: 9, Steps: 1 | Train Loss: 0.501 Vali Loss: 1.184 Vali Acc: 0.333 Test Loss: 1.184 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.1114754676818848
Epoch: 10, Steps: 1 | Train Loss: 0.424 Vali Loss: 1.211 Vali Acc: 0.333 Test Loss: 1.211 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.9944677352905273
Epoch: 11, Steps: 1 | Train Loss: 0.358 Vali Loss: 1.251 Vali Acc: 0.333 Test Loss: 1.251 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.9815587997436523
Epoch: 12, Steps: 1 | Train Loss: 0.278 Vali Loss: 1.298 Vali Acc: 0.333 Test Loss: 1.298 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.0279452800750732
Epoch: 13, Steps: 1 | Train Loss: 0.228 Vali Loss: 1.366 Vali Acc: 0.267 Test Loss: 1.366 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm64_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 5631747
model size : 22.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm64_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 4.040055274963379
Epoch: 1, Steps: 1 | Train Loss: 1.218 Vali Loss: 1.113 Vali Acc: 0.200 Test Loss: 1.113 Test Acc: 0.200
Validation loss decreased (inf --> -0.199989).  Saving model ...
Epoch: 2 cost time: 1.2206785678863525
Epoch: 2, Steps: 1 | Train Loss: 1.096 Vali Loss: 1.105 Vali Acc: 0.333 Test Loss: 1.105 Test Acc: 0.333
Validation loss decreased (-0.199989 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 1.250319242477417
Epoch: 3, Steps: 1 | Train Loss: 1.051 Vali Loss: 1.106 Vali Acc: 0.333 Test Loss: 1.106 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2455871105194092
Epoch: 4, Steps: 1 | Train Loss: 0.902 Vali Loss: 1.111 Vali Acc: 0.267 Test Loss: 1.111 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2415704727172852
Epoch: 5, Steps: 1 | Train Loss: 0.914 Vali Loss: 1.118 Vali Acc: 0.333 Test Loss: 1.118 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.3113553524017334
Epoch: 6, Steps: 1 | Train Loss: 0.895 Vali Loss: 1.132 Vali Acc: 0.267 Test Loss: 1.132 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.3062591552734375
Epoch: 7, Steps: 1 | Train Loss: 0.782 Vali Loss: 1.150 Vali Acc: 0.267 Test Loss: 1.150 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.5083677768707275
Epoch: 8, Steps: 1 | Train Loss: 0.734 Vali Loss: 1.169 Vali Acc: 0.267 Test Loss: 1.169 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.4239461421966553
Epoch: 9, Steps: 1 | Train Loss: 0.614 Vali Loss: 1.184 Vali Acc: 0.267 Test Loss: 1.184 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.2594730854034424
Epoch: 10, Steps: 1 | Train Loss: 0.523 Vali Loss: 1.203 Vali Acc: 0.200 Test Loss: 1.203 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.3354592323303223
Epoch: 11, Steps: 1 | Train Loss: 0.442 Vali Loss: 1.229 Vali Acc: 0.200 Test Loss: 1.229 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.3355145454406738
Epoch: 12, Steps: 1 | Train Loss: 0.382 Vali Loss: 1.265 Vali Acc: 0.200 Test Loss: 1.265 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm64_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 18871555
model size : 73.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm64_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.755851984024048
Epoch: 1, Steps: 1 | Train Loss: 0.999 Vali Loss: 1.109 Vali Acc: 0.200 Test Loss: 1.109 Test Acc: 0.200
Validation loss decreased (inf --> -0.199989).  Saving model ...
Epoch: 2 cost time: 0.829481840133667
Epoch: 2, Steps: 1 | Train Loss: 1.016 Vali Loss: 1.115 Vali Acc: 0.333 Test Loss: 1.115 Test Acc: 0.333
Validation loss decreased (-0.199989 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.8611869812011719
Epoch: 3, Steps: 1 | Train Loss: 0.899 Vali Loss: 1.124 Vali Acc: 0.400 Test Loss: 1.124 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.8814938068389893
Epoch: 4, Steps: 1 | Train Loss: 0.878 Vali Loss: 1.132 Vali Acc: 0.333 Test Loss: 1.132 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8132996559143066
Epoch: 5, Steps: 1 | Train Loss: 0.906 Vali Loss: 1.140 Vali Acc: 0.333 Test Loss: 1.140 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.7773125171661377
Epoch: 6, Steps: 1 | Train Loss: 0.832 Vali Loss: 1.149 Vali Acc: 0.333 Test Loss: 1.149 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.8224287033081055
Epoch: 7, Steps: 1 | Train Loss: 0.704 Vali Loss: 1.159 Vali Acc: 0.333 Test Loss: 1.159 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.8612127304077148
Epoch: 8, Steps: 1 | Train Loss: 0.607 Vali Loss: 1.172 Vali Acc: 0.333 Test Loss: 1.172 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.8418643474578857
Epoch: 9, Steps: 1 | Train Loss: 0.522 Vali Loss: 1.188 Vali Acc: 0.333 Test Loss: 1.188 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.8394303321838379
Epoch: 10, Steps: 1 | Train Loss: 0.444 Vali Loss: 1.216 Vali Acc: 0.267 Test Loss: 1.216 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.9192061424255371
Epoch: 11, Steps: 1 | Train Loss: 0.377 Vali Loss: 1.256 Vali Acc: 0.333 Test Loss: 1.256 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.844357967376709
Epoch: 12, Steps: 1 | Train Loss: 0.297 Vali Loss: 1.303 Vali Acc: 0.333 Test Loss: 1.303 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.8178253173828125
Epoch: 13, Steps: 1 | Train Loss: 0.246 Vali Loss: 1.371 Vali Acc: 0.267 Test Loss: 1.371 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm64_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 5631747
model size : 22.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm64_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 4.832939624786377
Epoch: 1, Steps: 1 | Train Loss: 1.170 Vali Loss: 1.090 Vali Acc: 0.400 Test Loss: 1.090 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 2.2474236488342285
Epoch: 2, Steps: 1 | Train Loss: 1.117 Vali Loss: 1.090 Vali Acc: 0.333 Test Loss: 1.090 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.2937819957733154
Epoch: 3, Steps: 1 | Train Loss: 1.085 Vali Loss: 1.099 Vali Acc: 0.400 Test Loss: 1.099 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.2647788524627686
Epoch: 4, Steps: 1 | Train Loss: 1.022 Vali Loss: 1.109 Vali Acc: 0.200 Test Loss: 1.109 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.0598738193511963
Epoch: 5, Steps: 1 | Train Loss: 0.920 Vali Loss: 1.120 Vali Acc: 0.200 Test Loss: 1.120 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.176478862762451
Epoch: 6, Steps: 1 | Train Loss: 0.855 Vali Loss: 1.133 Vali Acc: 0.133 Test Loss: 1.133 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.2220420837402344
Epoch: 7, Steps: 1 | Train Loss: 0.780 Vali Loss: 1.150 Vali Acc: 0.133 Test Loss: 1.150 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.0194928646087646
Epoch: 8, Steps: 1 | Train Loss: 0.675 Vali Loss: 1.165 Vali Acc: 0.133 Test Loss: 1.165 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.0057532787323
Epoch: 9, Steps: 1 | Train Loss: 0.602 Vali Loss: 1.183 Vali Acc: 0.400 Test Loss: 1.183 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.999298095703125
Epoch: 10, Steps: 1 | Train Loss: 0.485 Vali Loss: 1.207 Vali Acc: 0.400 Test Loss: 1.207 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.123063087463379
Epoch: 11, Steps: 1 | Train Loss: 0.407 Vali Loss: 1.240 Vali Acc: 0.333 Test Loss: 1.240 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm64_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 9498371
model size : 37.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm64_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.9890897274017334
Epoch: 1, Steps: 1 | Train Loss: 1.155 Vali Loss: 1.223 Vali Acc: 0.200 Test Loss: 1.223 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.908501148223877
Epoch: 2, Steps: 1 | Train Loss: 1.023 Vali Loss: 1.219 Vali Acc: 0.133 Test Loss: 1.219 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9131321907043457
Epoch: 3, Steps: 1 | Train Loss: 0.996 Vali Loss: 1.222 Vali Acc: 0.267 Test Loss: 1.222 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266654).  Saving model ...
Epoch: 4 cost time: 1.0117599964141846
Epoch: 4, Steps: 1 | Train Loss: 0.976 Vali Loss: 1.230 Vali Acc: 0.267 Test Loss: 1.230 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9558651447296143
Epoch: 5, Steps: 1 | Train Loss: 0.971 Vali Loss: 1.237 Vali Acc: 0.200 Test Loss: 1.237 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.933323860168457
Epoch: 6, Steps: 1 | Train Loss: 0.799 Vali Loss: 1.247 Vali Acc: 0.200 Test Loss: 1.247 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.7426691055297852
Epoch: 7, Steps: 1 | Train Loss: 0.809 Vali Loss: 1.259 Vali Acc: 0.200 Test Loss: 1.259 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.7965664863586426
Epoch: 8, Steps: 1 | Train Loss: 0.734 Vali Loss: 1.275 Vali Acc: 0.200 Test Loss: 1.275 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.9132261276245117
Epoch: 9, Steps: 1 | Train Loss: 0.628 Vali Loss: 1.293 Vali Acc: 0.200 Test Loss: 1.293 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.9440460205078125
Epoch: 10, Steps: 1 | Train Loss: 0.515 Vali Loss: 1.318 Vali Acc: 0.200 Test Loss: 1.318 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.9517033100128174
Epoch: 11, Steps: 1 | Train Loss: 0.400 Vali Loss: 1.350 Vali Acc: 0.200 Test Loss: 1.350 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.9505248069763184
Epoch: 12, Steps: 1 | Train Loss: 0.321 Vali Loss: 1.389 Vali Acc: 0.200 Test Loss: 1.389 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.9597330093383789
Epoch: 13, Steps: 1 | Train Loss: 0.268 Vali Loss: 1.438 Vali Acc: 0.200 Test Loss: 1.438 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm64_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 2878211
model size : 12.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm64_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 4.198628902435303
Epoch: 1, Steps: 1 | Train Loss: 1.164 Vali Loss: 1.101 Vali Acc: 0.400 Test Loss: 1.101 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 1.4579153060913086
Epoch: 2, Steps: 1 | Train Loss: 1.116 Vali Loss: 1.100 Vali Acc: 0.333 Test Loss: 1.100 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.539928913116455
Epoch: 3, Steps: 1 | Train Loss: 1.077 Vali Loss: 1.108 Vali Acc: 0.400 Test Loss: 1.108 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.7187259197235107
Epoch: 4, Steps: 1 | Train Loss: 1.014 Vali Loss: 1.118 Vali Acc: 0.200 Test Loss: 1.118 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.5413737297058105
Epoch: 5, Steps: 1 | Train Loss: 0.914 Vali Loss: 1.128 Vali Acc: 0.200 Test Loss: 1.128 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.5664551258087158
Epoch: 6, Steps: 1 | Train Loss: 0.849 Vali Loss: 1.141 Vali Acc: 0.133 Test Loss: 1.141 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.6877174377441406
Epoch: 7, Steps: 1 | Train Loss: 0.780 Vali Loss: 1.158 Vali Acc: 0.133 Test Loss: 1.158 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.6838841438293457
Epoch: 8, Steps: 1 | Train Loss: 0.681 Vali Loss: 1.173 Vali Acc: 0.133 Test Loss: 1.173 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.6711530685424805
Epoch: 9, Steps: 1 | Train Loss: 0.608 Vali Loss: 1.191 Vali Acc: 0.333 Test Loss: 1.191 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.7989213466644287
Epoch: 10, Steps: 1 | Train Loss: 0.492 Vali Loss: 1.215 Vali Acc: 0.400 Test Loss: 1.215 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.6378703117370605
Epoch: 11, Steps: 1 | Train Loss: 0.422 Vali Loss: 1.248 Vali Acc: 0.333 Test Loss: 1.248 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm64_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 9498371
model size : 37.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm64_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.8044443130493164
Epoch: 1, Steps: 1 | Train Loss: 1.145 Vali Loss: 1.231 Vali Acc: 0.200 Test Loss: 1.231 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.6948394775390625
Epoch: 2, Steps: 1 | Train Loss: 1.024 Vali Loss: 1.226 Vali Acc: 0.133 Test Loss: 1.226 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7082700729370117
Epoch: 3, Steps: 1 | Train Loss: 0.997 Vali Loss: 1.229 Vali Acc: 0.267 Test Loss: 1.229 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266654).  Saving model ...
Epoch: 4 cost time: 0.8413386344909668
Epoch: 4, Steps: 1 | Train Loss: 0.972 Vali Loss: 1.236 Vali Acc: 0.267 Test Loss: 1.236 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7828235626220703
Epoch: 5, Steps: 1 | Train Loss: 0.970 Vali Loss: 1.243 Vali Acc: 0.267 Test Loss: 1.243 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.7755460739135742
Epoch: 6, Steps: 1 | Train Loss: 0.800 Vali Loss: 1.252 Vali Acc: 0.200 Test Loss: 1.252 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.8085317611694336
Epoch: 7, Steps: 1 | Train Loss: 0.810 Vali Loss: 1.262 Vali Acc: 0.200 Test Loss: 1.262 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.950141429901123
Epoch: 8, Steps: 1 | Train Loss: 0.734 Vali Loss: 1.275 Vali Acc: 0.200 Test Loss: 1.275 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.7967522144317627
Epoch: 9, Steps: 1 | Train Loss: 0.636 Vali Loss: 1.291 Vali Acc: 0.200 Test Loss: 1.291 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.8478085994720459
Epoch: 10, Steps: 1 | Train Loss: 0.509 Vali Loss: 1.313 Vali Acc: 0.267 Test Loss: 1.313 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.9313445091247559
Epoch: 11, Steps: 1 | Train Loss: 0.407 Vali Loss: 1.342 Vali Acc: 0.267 Test Loss: 1.342 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.7852318286895752
Epoch: 12, Steps: 1 | Train Loss: 0.328 Vali Loss: 1.377 Vali Acc: 0.267 Test Loss: 1.377 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.8822145462036133
Epoch: 13, Steps: 1 | Train Loss: 0.270 Vali Loss: 1.421 Vali Acc: 0.267 Test Loss: 1.421 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm64_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 2878211
model size : 12.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm64_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 3.448073625564575
Epoch: 1, Steps: 1 | Train Loss: 1.160 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 1.0465507507324219
Epoch: 2, Steps: 1 | Train Loss: 1.112 Vali Loss: 1.091 Vali Acc: 0.333 Test Loss: 1.091 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9982116222381592
Epoch: 3, Steps: 1 | Train Loss: 1.078 Vali Loss: 1.099 Vali Acc: 0.400 Test Loss: 1.099 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9806747436523438
Epoch: 4, Steps: 1 | Train Loss: 1.011 Vali Loss: 1.109 Vali Acc: 0.267 Test Loss: 1.109 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.1882240772247314
Epoch: 5, Steps: 1 | Train Loss: 0.912 Vali Loss: 1.118 Vali Acc: 0.200 Test Loss: 1.118 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.9807455539703369
Epoch: 6, Steps: 1 | Train Loss: 0.844 Vali Loss: 1.132 Vali Acc: 0.200 Test Loss: 1.132 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.009800910949707
Epoch: 7, Steps: 1 | Train Loss: 0.782 Vali Loss: 1.149 Vali Acc: 0.133 Test Loss: 1.149 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.9321000576019287
Epoch: 8, Steps: 1 | Train Loss: 0.689 Vali Loss: 1.165 Vali Acc: 0.200 Test Loss: 1.165 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.8756792545318604
Epoch: 9, Steps: 1 | Train Loss: 0.620 Vali Loss: 1.183 Vali Acc: 0.333 Test Loss: 1.183 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.9134814739227295
Epoch: 10, Steps: 1 | Train Loss: 0.506 Vali Loss: 1.208 Vali Acc: 0.333 Test Loss: 1.208 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.9127507209777832
Epoch: 11, Steps: 1 | Train Loss: 0.435 Vali Loss: 1.242 Vali Acc: 0.333 Test Loss: 1.242 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm64_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 9498371
model size : 37.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm64_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.4150662422180176
Epoch: 1, Steps: 1 | Train Loss: 1.144 Vali Loss: 1.221 Vali Acc: 0.200 Test Loss: 1.221 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.6555185317993164
Epoch: 2, Steps: 1 | Train Loss: 1.029 Vali Loss: 1.213 Vali Acc: 0.200 Test Loss: 1.213 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 3 cost time: 0.6281564235687256
Epoch: 3, Steps: 1 | Train Loss: 1.004 Vali Loss: 1.215 Vali Acc: 0.267 Test Loss: 1.215 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266655).  Saving model ...
Epoch: 4 cost time: 0.6891887187957764
Epoch: 4, Steps: 1 | Train Loss: 0.972 Vali Loss: 1.221 Vali Acc: 0.267 Test Loss: 1.221 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6141173839569092
Epoch: 5, Steps: 1 | Train Loss: 0.972 Vali Loss: 1.228 Vali Acc: 0.267 Test Loss: 1.228 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.596576452255249
Epoch: 6, Steps: 1 | Train Loss: 0.802 Vali Loss: 1.238 Vali Acc: 0.267 Test Loss: 1.238 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.6496603488922119
Epoch: 7, Steps: 1 | Train Loss: 0.815 Vali Loss: 1.249 Vali Acc: 0.200 Test Loss: 1.249 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.6443376541137695
Epoch: 8, Steps: 1 | Train Loss: 0.738 Vali Loss: 1.263 Vali Acc: 0.200 Test Loss: 1.263 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.5823030471801758
Epoch: 9, Steps: 1 | Train Loss: 0.650 Vali Loss: 1.281 Vali Acc: 0.200 Test Loss: 1.281 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.672088623046875
Epoch: 10, Steps: 1 | Train Loss: 0.523 Vali Loss: 1.304 Vali Acc: 0.333 Test Loss: 1.304 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333320).  Saving model ...
Epoch: 11 cost time: 0.5518274307250977
Epoch: 11, Steps: 1 | Train Loss: 0.417 Vali Loss: 1.334 Vali Acc: 0.267 Test Loss: 1.334 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6302745342254639
Epoch: 12, Steps: 1 | Train Loss: 0.341 Vali Loss: 1.371 Vali Acc: 0.267 Test Loss: 1.371 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.637077808380127
Epoch: 13, Steps: 1 | Train Loss: 0.282 Vali Loss: 1.416 Vali Acc: 0.267 Test Loss: 1.416 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.626765251159668
Epoch: 14, Steps: 1 | Train Loss: 0.235 Vali Loss: 1.459 Vali Acc: 0.267 Test Loss: 1.459 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.5998539924621582
Epoch: 15, Steps: 1 | Train Loss: 0.174 Vali Loss: 1.504 Vali Acc: 0.267 Test Loss: 1.504 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.6178479194641113
Epoch: 16, Steps: 1 | Train Loss: 0.136 Vali Loss: 1.548 Vali Acc: 0.267 Test Loss: 1.548 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.6393587589263916
Epoch: 17, Steps: 1 | Train Loss: 0.097 Vali Loss: 1.597 Vali Acc: 0.267 Test Loss: 1.597 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.6174144744873047
Epoch: 18, Steps: 1 | Train Loss: 0.075 Vali Loss: 1.647 Vali Acc: 0.267 Test Loss: 1.647 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.6141965389251709
Epoch: 19, Steps: 1 | Train Loss: 0.046 Vali Loss: 1.702 Vali Acc: 0.333 Test Loss: 1.702 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.603410005569458
Epoch: 20, Steps: 1 | Train Loss: 0.032 Vali Loss: 1.760 Vali Acc: 0.333 Test Loss: 1.760 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm64_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 2878211
model size : 12.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm32_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 4.6500794887542725
Epoch: 1, Steps: 1 | Train Loss: 1.027 Vali Loss: 1.091 Vali Acc: 0.267 Test Loss: 1.091 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 2.1866822242736816
Epoch: 2, Steps: 1 | Train Loss: 1.117 Vali Loss: 1.092 Vali Acc: 0.267 Test Loss: 1.092 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.1371872425079346
Epoch: 3, Steps: 1 | Train Loss: 1.054 Vali Loss: 1.096 Vali Acc: 0.267 Test Loss: 1.096 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.211186170578003
Epoch: 4, Steps: 1 | Train Loss: 0.977 Vali Loss: 1.100 Vali Acc: 0.333 Test Loss: 1.100 Test Acc: 0.333
Validation loss decreased (-0.266656 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 2.128980875015259
Epoch: 5, Steps: 1 | Train Loss: 0.948 Vali Loss: 1.104 Vali Acc: 0.333 Test Loss: 1.104 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.1996073722839355
Epoch: 6, Steps: 1 | Train Loss: 0.954 Vali Loss: 1.109 Vali Acc: 0.400 Test Loss: 1.109 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 2.140388250350952
Epoch: 7, Steps: 1 | Train Loss: 0.833 Vali Loss: 1.107 Vali Acc: 0.400 Test Loss: 1.107 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 2.166486978530884
Epoch: 8, Steps: 1 | Train Loss: 0.891 Vali Loss: 1.116 Vali Acc: 0.400 Test Loss: 1.116 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.7944867610931396
Epoch: 9, Steps: 1 | Train Loss: 0.779 Vali Loss: 1.126 Vali Acc: 0.333 Test Loss: 1.126 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.144700527191162
Epoch: 10, Steps: 1 | Train Loss: 0.658 Vali Loss: 1.139 Vali Acc: 0.333 Test Loss: 1.139 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.2874996662139893
Epoch: 11, Steps: 1 | Train Loss: 0.612 Vali Loss: 1.155 Vali Acc: 0.267 Test Loss: 1.155 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.299543619155884
Epoch: 12, Steps: 1 | Train Loss: 0.608 Vali Loss: 1.173 Vali Acc: 0.267 Test Loss: 1.173 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.1888654232025146
Epoch: 13, Steps: 1 | Train Loss: 0.489 Vali Loss: 1.193 Vali Acc: 0.267 Test Loss: 1.193 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.2371435165405273
Epoch: 14, Steps: 1 | Train Loss: 0.436 Vali Loss: 1.219 Vali Acc: 0.267 Test Loss: 1.219 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.2209694385528564
Epoch: 15, Steps: 1 | Train Loss: 0.376 Vali Loss: 1.238 Vali Acc: 0.267 Test Loss: 1.238 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.281038999557495
Epoch: 16, Steps: 1 | Train Loss: 0.346 Vali Loss: 1.255 Vali Acc: 0.267 Test Loss: 1.255 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.263986110687256
Epoch: 17, Steps: 1 | Train Loss: 0.291 Vali Loss: 1.275 Vali Acc: 0.267 Test Loss: 1.275 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm32_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 9437315
model size : 36.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm32_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 3.141653299331665
Epoch: 1, Steps: 1 | Train Loss: 1.308 Vali Loss: 1.129 Vali Acc: 0.400 Test Loss: 1.129 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.9996201992034912
Epoch: 2, Steps: 1 | Train Loss: 1.172 Vali Loss: 1.115 Vali Acc: 0.467 Test Loss: 1.115 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 1.0399837493896484
Epoch: 3, Steps: 1 | Train Loss: 1.168 Vali Loss: 1.106 Vali Acc: 0.467 Test Loss: 1.106 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.988053560256958
Epoch: 4, Steps: 1 | Train Loss: 1.049 Vali Loss: 1.102 Vali Acc: 0.267 Test Loss: 1.102 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0437300205230713
Epoch: 5, Steps: 1 | Train Loss: 1.023 Vali Loss: 1.100 Vali Acc: 0.267 Test Loss: 1.100 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9761266708374023
Epoch: 6, Steps: 1 | Train Loss: 1.063 Vali Loss: 1.100 Vali Acc: 0.200 Test Loss: 1.100 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.8354465961456299
Epoch: 7, Steps: 1 | Train Loss: 0.995 Vali Loss: 1.100 Vali Acc: 0.200 Test Loss: 1.100 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.9763431549072266
Epoch: 8, Steps: 1 | Train Loss: 0.928 Vali Loss: 1.102 Vali Acc: 0.267 Test Loss: 1.102 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.0205860137939453
Epoch: 9, Steps: 1 | Train Loss: 0.844 Vali Loss: 1.106 Vali Acc: 0.267 Test Loss: 1.106 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.9795582294464111
Epoch: 10, Steps: 1 | Train Loss: 0.861 Vali Loss: 1.113 Vali Acc: 0.267 Test Loss: 1.113 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.0725417137145996
Epoch: 11, Steps: 1 | Train Loss: 0.709 Vali Loss: 1.123 Vali Acc: 0.200 Test Loss: 1.123 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.0460858345031738
Epoch: 12, Steps: 1 | Train Loss: 0.620 Vali Loss: 1.135 Vali Acc: 0.333 Test Loss: 1.135 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.8931312561035156
Epoch: 13, Steps: 1 | Train Loss: 0.595 Vali Loss: 1.149 Vali Acc: 0.333 Test Loss: 1.149 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm32_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 2816899
model size : 11.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm32_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 4.346357345581055
Epoch: 1, Steps: 1 | Train Loss: 1.028 Vali Loss: 1.087 Vali Acc: 0.267 Test Loss: 1.087 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 1.615009069442749
Epoch: 2, Steps: 1 | Train Loss: 1.117 Vali Loss: 1.089 Vali Acc: 0.267 Test Loss: 1.089 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6239173412322998
Epoch: 3, Steps: 1 | Train Loss: 1.054 Vali Loss: 1.093 Vali Acc: 0.267 Test Loss: 1.093 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.5483860969543457
Epoch: 4, Steps: 1 | Train Loss: 0.978 Vali Loss: 1.097 Vali Acc: 0.333 Test Loss: 1.097 Test Acc: 0.333
Validation loss decreased (-0.266656 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 1.628209114074707
Epoch: 5, Steps: 1 | Train Loss: 0.949 Vali Loss: 1.101 Vali Acc: 0.333 Test Loss: 1.101 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5249757766723633
Epoch: 6, Steps: 1 | Train Loss: 0.954 Vali Loss: 1.105 Vali Acc: 0.333 Test Loss: 1.105 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.5237219333648682
Epoch: 7, Steps: 1 | Train Loss: 0.833 Vali Loss: 1.112 Vali Acc: 0.333 Test Loss: 1.112 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.4921865463256836
Epoch: 8, Steps: 1 | Train Loss: 0.891 Vali Loss: 1.120 Vali Acc: 0.333 Test Loss: 1.120 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.6085667610168457
Epoch: 9, Steps: 1 | Train Loss: 0.779 Vali Loss: 1.131 Vali Acc: 0.267 Test Loss: 1.131 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.6192948818206787
Epoch: 10, Steps: 1 | Train Loss: 0.658 Vali Loss: 1.145 Vali Acc: 0.267 Test Loss: 1.145 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.5920486450195312
Epoch: 11, Steps: 1 | Train Loss: 0.612 Vali Loss: 1.161 Vali Acc: 0.200 Test Loss: 1.161 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.5598056316375732
Epoch: 12, Steps: 1 | Train Loss: 0.609 Vali Loss: 1.180 Vali Acc: 0.267 Test Loss: 1.180 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.5446383953094482
Epoch: 13, Steps: 1 | Train Loss: 0.489 Vali Loss: 1.201 Vali Acc: 0.267 Test Loss: 1.201 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.5706384181976318
Epoch: 14, Steps: 1 | Train Loss: 0.437 Vali Loss: 1.223 Vali Acc: 0.267 Test Loss: 1.223 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm32_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 9437315
model size : 36.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm32_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.9314358234405518
Epoch: 1, Steps: 1 | Train Loss: 1.337 Vali Loss: 1.122 Vali Acc: 0.400 Test Loss: 1.122 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.9417574405670166
Epoch: 2, Steps: 1 | Train Loss: 1.218 Vali Loss: 1.109 Vali Acc: 0.467 Test Loss: 1.109 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.8426163196563721
Epoch: 3, Steps: 1 | Train Loss: 1.167 Vali Loss: 1.101 Vali Acc: 0.400 Test Loss: 1.101 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8956074714660645
Epoch: 4, Steps: 1 | Train Loss: 1.065 Vali Loss: 1.097 Vali Acc: 0.267 Test Loss: 1.097 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.8408043384552002
Epoch: 5, Steps: 1 | Train Loss: 1.029 Vali Loss: 1.096 Vali Acc: 0.267 Test Loss: 1.096 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.7655725479125977
Epoch: 6, Steps: 1 | Train Loss: 1.066 Vali Loss: 1.096 Vali Acc: 0.200 Test Loss: 1.096 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.8776974678039551
Epoch: 7, Steps: 1 | Train Loss: 1.017 Vali Loss: 1.097 Vali Acc: 0.267 Test Loss: 1.097 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.8471899032592773
Epoch: 8, Steps: 1 | Train Loss: 0.970 Vali Loss: 1.100 Vali Acc: 0.333 Test Loss: 1.100 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.7907238006591797
Epoch: 9, Steps: 1 | Train Loss: 0.856 Vali Loss: 1.105 Vali Acc: 0.267 Test Loss: 1.105 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.8104515075683594
Epoch: 10, Steps: 1 | Train Loss: 0.886 Vali Loss: 1.112 Vali Acc: 0.333 Test Loss: 1.112 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.6676230430603027
Epoch: 11, Steps: 1 | Train Loss: 0.725 Vali Loss: 1.122 Vali Acc: 0.267 Test Loss: 1.122 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.840886116027832
Epoch: 12, Steps: 1 | Train Loss: 0.640 Vali Loss: 1.135 Vali Acc: 0.333 Test Loss: 1.135 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm32_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 2816899
model size : 11.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm32_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 3.3299901485443115
Epoch: 1, Steps: 1 | Train Loss: 1.029 Vali Loss: 1.100 Vali Acc: 0.267 Test Loss: 1.100 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 1.106229543685913
Epoch: 2, Steps: 1 | Train Loss: 1.116 Vali Loss: 1.102 Vali Acc: 0.267 Test Loss: 1.102 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0291671752929688
Epoch: 3, Steps: 1 | Train Loss: 1.054 Vali Loss: 1.106 Vali Acc: 0.267 Test Loss: 1.106 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0630459785461426
Epoch: 4, Steps: 1 | Train Loss: 0.978 Vali Loss: 1.110 Vali Acc: 0.333 Test Loss: 1.110 Test Acc: 0.333
Validation loss decreased (-0.266656 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.9798126220703125
Epoch: 5, Steps: 1 | Train Loss: 0.943 Vali Loss: 1.114 Vali Acc: 0.333 Test Loss: 1.114 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.995093822479248
Epoch: 6, Steps: 1 | Train Loss: 0.953 Vali Loss: 1.120 Vali Acc: 0.400 Test Loss: 1.120 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.9584572315216064
Epoch: 7, Steps: 1 | Train Loss: 0.840 Vali Loss: 1.127 Vali Acc: 0.400 Test Loss: 1.127 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.023634433746338
Epoch: 8, Steps: 1 | Train Loss: 0.910 Vali Loss: 1.137 Vali Acc: 0.400 Test Loss: 1.137 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9835801124572754
Epoch: 9, Steps: 1 | Train Loss: 0.801 Vali Loss: 1.149 Vali Acc: 0.333 Test Loss: 1.149 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.0517873764038086
Epoch: 10, Steps: 1 | Train Loss: 0.677 Vali Loss: 1.164 Vali Acc: 0.267 Test Loss: 1.164 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.1040520668029785
Epoch: 11, Steps: 1 | Train Loss: 0.637 Vali Loss: 1.182 Vali Acc: 0.267 Test Loss: 1.182 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.9920229911804199
Epoch: 12, Steps: 1 | Train Loss: 0.634 Vali Loss: 1.203 Vali Acc: 0.267 Test Loss: 1.203 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.9797708988189697
Epoch: 13, Steps: 1 | Train Loss: 0.515 Vali Loss: 1.226 Vali Acc: 0.267 Test Loss: 1.226 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.0904486179351807
Epoch: 14, Steps: 1 | Train Loss: 0.458 Vali Loss: 1.251 Vali Acc: 0.267 Test Loss: 1.251 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.9463653564453125
Epoch: 15, Steps: 1 | Train Loss: 0.394 Vali Loss: 1.276 Vali Acc: 0.267 Test Loss: 1.276 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.9752099514007568
Epoch: 16, Steps: 1 | Train Loss: 0.372 Vali Loss: 1.301 Vali Acc: 0.200 Test Loss: 1.301 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm32_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 9437315
model size : 36.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm32_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.638934373855591
Epoch: 1, Steps: 1 | Train Loss: 1.321 Vali Loss: 1.145 Vali Acc: 0.400 Test Loss: 1.145 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.6870293617248535
Epoch: 2, Steps: 1 | Train Loss: 1.203 Vali Loss: 1.131 Vali Acc: 0.467 Test Loss: 1.131 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 3 cost time: 0.8455255031585693
Epoch: 3, Steps: 1 | Train Loss: 1.187 Vali Loss: 1.123 Vali Acc: 0.400 Test Loss: 1.123 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.717479944229126
Epoch: 4, Steps: 1 | Train Loss: 1.089 Vali Loss: 1.120 Vali Acc: 0.267 Test Loss: 1.120 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.6904053688049316
Epoch: 5, Steps: 1 | Train Loss: 1.048 Vali Loss: 1.119 Vali Acc: 0.267 Test Loss: 1.119 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.7267217636108398
Epoch: 6, Steps: 1 | Train Loss: 1.074 Vali Loss: 1.119 Vali Acc: 0.133 Test Loss: 1.119 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.6865143775939941
Epoch: 7, Steps: 1 | Train Loss: 1.016 Vali Loss: 1.121 Vali Acc: 0.200 Test Loss: 1.121 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.7301943302154541
Epoch: 8, Steps: 1 | Train Loss: 0.956 Vali Loss: 1.125 Vali Acc: 0.200 Test Loss: 1.125 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.7841897010803223
Epoch: 9, Steps: 1 | Train Loss: 0.879 Vali Loss: 1.130 Vali Acc: 0.200 Test Loss: 1.130 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.6807775497436523
Epoch: 10, Steps: 1 | Train Loss: 0.896 Vali Loss: 1.137 Vali Acc: 0.267 Test Loss: 1.137 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.7084915637969971
Epoch: 11, Steps: 1 | Train Loss: 0.749 Vali Loss: 1.148 Vali Acc: 0.133 Test Loss: 1.148 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.6911308765411377
Epoch: 12, Steps: 1 | Train Loss: 0.661 Vali Loss: 1.163 Vali Acc: 0.333 Test Loss: 1.163 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm32_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 2816899
model size : 11.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm32_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 3.5364415645599365
Epoch: 1, Steps: 1 | Train Loss: 1.176 Vali Loss: 1.149 Vali Acc: 0.200 Test Loss: 1.149 Test Acc: 0.200
Validation loss decreased (inf --> -0.199989).  Saving model ...
Epoch: 2 cost time: 1.36037015914917
Epoch: 2, Steps: 1 | Train Loss: 1.032 Vali Loss: 1.147 Vali Acc: 0.200 Test Loss: 1.147 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 3 cost time: 1.4104247093200684
Epoch: 3, Steps: 1 | Train Loss: 1.025 Vali Loss: 1.147 Vali Acc: 0.200 Test Loss: 1.147 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 4 cost time: 1.356736660003662
Epoch: 4, Steps: 1 | Train Loss: 1.008 Vali Loss: 1.147 Vali Acc: 0.200 Test Loss: 1.147 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.30226469039917
Epoch: 5, Steps: 1 | Train Loss: 0.990 Vali Loss: 1.149 Vali Acc: 0.200 Test Loss: 1.149 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.3884198665618896
Epoch: 6, Steps: 1 | Train Loss: 0.919 Vali Loss: 1.151 Vali Acc: 0.267 Test Loss: 1.151 Test Acc: 0.267
Validation loss decreased (-0.199989 --> -0.266655).  Saving model ...
Epoch: 7 cost time: 1.4174754619598389
Epoch: 7, Steps: 1 | Train Loss: 0.889 Vali Loss: 1.153 Vali Acc: 0.200 Test Loss: 1.153 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0769469738006592
Epoch: 8, Steps: 1 | Train Loss: 0.840 Vali Loss: 1.157 Vali Acc: 0.267 Test Loss: 1.157 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.3860836029052734
Epoch: 9, Steps: 1 | Train Loss: 0.778 Vali Loss: 1.161 Vali Acc: 0.200 Test Loss: 1.161 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.340958833694458
Epoch: 10, Steps: 1 | Train Loss: 0.667 Vali Loss: 1.167 Vali Acc: 0.133 Test Loss: 1.167 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.4073784351348877
Epoch: 11, Steps: 1 | Train Loss: 0.629 Vali Loss: 1.175 Vali Acc: 0.133 Test Loss: 1.175 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.3619914054870605
Epoch: 12, Steps: 1 | Train Loss: 0.557 Vali Loss: 1.184 Vali Acc: 0.133 Test Loss: 1.184 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.4576210975646973
Epoch: 13, Steps: 1 | Train Loss: 0.500 Vali Loss: 1.193 Vali Acc: 0.133 Test Loss: 1.193 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.3823482990264893
Epoch: 14, Steps: 1 | Train Loss: 0.467 Vali Loss: 1.202 Vali Acc: 0.133 Test Loss: 1.202 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.3281936645507812
Epoch: 15, Steps: 1 | Train Loss: 0.385 Vali Loss: 1.214 Vali Acc: 0.133 Test Loss: 1.214 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.3869502544403076
Epoch: 16, Steps: 1 | Train Loss: 0.340 Vali Loss: 1.225 Vali Acc: 0.200 Test Loss: 1.225 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm32_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 4749955
model size : 18.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm32_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.6953353881835938
Epoch: 1, Steps: 1 | Train Loss: 1.313 Vali Loss: 1.151 Vali Acc: 0.467 Test Loss: 1.151 Test Acc: 0.467
Validation loss decreased (inf --> -0.466655).  Saving model ...
Epoch: 2 cost time: 0.7994742393493652
Epoch: 2, Steps: 1 | Train Loss: 1.219 Vali Loss: 1.123 Vali Acc: 0.400 Test Loss: 1.123 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8236026763916016
Epoch: 3, Steps: 1 | Train Loss: 1.089 Vali Loss: 1.108 Vali Acc: 0.333 Test Loss: 1.108 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7720947265625
Epoch: 4, Steps: 1 | Train Loss: 1.094 Vali Loss: 1.101 Vali Acc: 0.267 Test Loss: 1.101 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.8650820255279541
Epoch: 5, Steps: 1 | Train Loss: 1.060 Vali Loss: 1.099 Vali Acc: 0.333 Test Loss: 1.099 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.7799861431121826
Epoch: 6, Steps: 1 | Train Loss: 0.953 Vali Loss: 1.101 Vali Acc: 0.267 Test Loss: 1.101 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.7482738494873047
Epoch: 7, Steps: 1 | Train Loss: 0.908 Vali Loss: 1.105 Vali Acc: 0.333 Test Loss: 1.105 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.8598518371582031
Epoch: 8, Steps: 1 | Train Loss: 0.935 Vali Loss: 1.109 Vali Acc: 0.333 Test Loss: 1.109 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.7844874858856201
Epoch: 9, Steps: 1 | Train Loss: 0.815 Vali Loss: 1.113 Vali Acc: 0.333 Test Loss: 1.113 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.8185935020446777
Epoch: 10, Steps: 1 | Train Loss: 0.696 Vali Loss: 1.116 Vali Acc: 0.333 Test Loss: 1.116 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.8883416652679443
Epoch: 11, Steps: 1 | Train Loss: 0.717 Vali Loss: 1.118 Vali Acc: 0.333 Test Loss: 1.118 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm32_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 1439619
model size : 6.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm32_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 3.7937979698181152
Epoch: 1, Steps: 1 | Train Loss: 1.169 Vali Loss: 1.150 Vali Acc: 0.200 Test Loss: 1.150 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 1.3395981788635254
Epoch: 2, Steps: 1 | Train Loss: 1.028 Vali Loss: 1.148 Vali Acc: 0.200 Test Loss: 1.148 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199989).  Saving model ...
Epoch: 3 cost time: 1.2740952968597412
Epoch: 3, Steps: 1 | Train Loss: 1.023 Vali Loss: 1.148 Vali Acc: 0.200 Test Loss: 1.148 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 4 cost time: 1.1449849605560303
Epoch: 4, Steps: 1 | Train Loss: 1.007 Vali Loss: 1.149 Vali Acc: 0.133 Test Loss: 1.149 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.109842300415039
Epoch: 5, Steps: 1 | Train Loss: 0.988 Vali Loss: 1.151 Vali Acc: 0.133 Test Loss: 1.151 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1371991634368896
Epoch: 6, Steps: 1 | Train Loss: 0.920 Vali Loss: 1.153 Vali Acc: 0.200 Test Loss: 1.153 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.2452430725097656
Epoch: 7, Steps: 1 | Train Loss: 0.888 Vali Loss: 1.156 Vali Acc: 0.133 Test Loss: 1.156 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.1853771209716797
Epoch: 8, Steps: 1 | Train Loss: 0.843 Vali Loss: 1.160 Vali Acc: 0.200 Test Loss: 1.160 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.2202329635620117
Epoch: 9, Steps: 1 | Train Loss: 0.779 Vali Loss: 1.165 Vali Acc: 0.133 Test Loss: 1.165 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.2253515720367432
Epoch: 10, Steps: 1 | Train Loss: 0.672 Vali Loss: 1.172 Vali Acc: 0.133 Test Loss: 1.172 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.2142317295074463
Epoch: 11, Steps: 1 | Train Loss: 0.630 Vali Loss: 1.181 Vali Acc: 0.133 Test Loss: 1.181 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.2021708488464355
Epoch: 12, Steps: 1 | Train Loss: 0.561 Vali Loss: 1.191 Vali Acc: 0.133 Test Loss: 1.191 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.270064115524292
Epoch: 13, Steps: 1 | Train Loss: 0.479 Vali Loss: 1.202 Vali Acc: 0.133 Test Loss: 1.202 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm32_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.2
model parameter : 4749955
model size : 18.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm32_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.730306625366211
Epoch: 1, Steps: 1 | Train Loss: 1.303 Vali Loss: 1.151 Vali Acc: 0.467 Test Loss: 1.151 Test Acc: 0.467
Validation loss decreased (inf --> -0.466655).  Saving model ...
Epoch: 2 cost time: 0.760195255279541
Epoch: 2, Steps: 1 | Train Loss: 1.224 Vali Loss: 1.124 Vali Acc: 0.400 Test Loss: 1.124 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7247328758239746
Epoch: 3, Steps: 1 | Train Loss: 1.082 Vali Loss: 1.109 Vali Acc: 0.333 Test Loss: 1.109 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.851332426071167
Epoch: 4, Steps: 1 | Train Loss: 1.100 Vali Loss: 1.102 Vali Acc: 0.267 Test Loss: 1.102 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7686736583709717
Epoch: 5, Steps: 1 | Train Loss: 1.053 Vali Loss: 1.101 Vali Acc: 0.333 Test Loss: 1.101 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.7304418087005615
Epoch: 6, Steps: 1 | Train Loss: 0.961 Vali Loss: 1.103 Vali Acc: 0.267 Test Loss: 1.103 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.8659026622772217
Epoch: 7, Steps: 1 | Train Loss: 0.905 Vali Loss: 1.108 Vali Acc: 0.333 Test Loss: 1.108 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.7263853549957275
Epoch: 8, Steps: 1 | Train Loss: 0.928 Vali Loss: 1.114 Vali Acc: 0.333 Test Loss: 1.114 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.7298617362976074
Epoch: 9, Steps: 1 | Train Loss: 0.818 Vali Loss: 1.120 Vali Acc: 0.333 Test Loss: 1.120 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.7973623275756836
Epoch: 10, Steps: 1 | Train Loss: 0.715 Vali Loss: 1.124 Vali Acc: 0.333 Test Loss: 1.124 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.7663576602935791
Epoch: 11, Steps: 1 | Train Loss: 0.727 Vali Loss: 1.129 Vali Acc: 0.333 Test Loss: 1.129 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm32_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 1439619
model size : 6.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm32_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.549832820892334
Epoch: 1, Steps: 1 | Train Loss: 1.170 Vali Loss: 1.142 Vali Acc: 0.200 Test Loss: 1.142 Test Acc: 0.200
Validation loss decreased (inf --> -0.199989).  Saving model ...
Epoch: 2 cost time: 0.7860167026519775
Epoch: 2, Steps: 1 | Train Loss: 1.026 Vali Loss: 1.140 Vali Acc: 0.200 Test Loss: 1.140 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 3 cost time: 0.8641300201416016
Epoch: 3, Steps: 1 | Train Loss: 1.026 Vali Loss: 1.139 Vali Acc: 0.200 Test Loss: 1.139 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 4 cost time: 0.7066702842712402
Epoch: 4, Steps: 1 | Train Loss: 1.003 Vali Loss: 1.140 Vali Acc: 0.133 Test Loss: 1.140 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8090243339538574
Epoch: 5, Steps: 1 | Train Loss: 0.986 Vali Loss: 1.142 Vali Acc: 0.133 Test Loss: 1.142 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9061949253082275
Epoch: 6, Steps: 1 | Train Loss: 0.922 Vali Loss: 1.144 Vali Acc: 0.200 Test Loss: 1.144 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.8279268741607666
Epoch: 7, Steps: 1 | Train Loss: 0.894 Vali Loss: 1.146 Vali Acc: 0.200 Test Loss: 1.146 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.904332160949707
Epoch: 8, Steps: 1 | Train Loss: 0.855 Vali Loss: 1.150 Vali Acc: 0.267 Test Loss: 1.150 Test Acc: 0.267
Validation loss decreased (-0.199989 --> -0.266655).  Saving model ...
Epoch: 9 cost time: 0.9130079746246338
Epoch: 9, Steps: 1 | Train Loss: 0.805 Vali Loss: 1.154 Vali Acc: 0.133 Test Loss: 1.154 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.911236047744751
Epoch: 10, Steps: 1 | Train Loss: 0.703 Vali Loss: 1.160 Vali Acc: 0.133 Test Loss: 1.160 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8787662982940674
Epoch: 11, Steps: 1 | Train Loss: 0.663 Vali Loss: 1.168 Vali Acc: 0.133 Test Loss: 1.168 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.8356842994689941
Epoch: 12, Steps: 1 | Train Loss: 0.608 Vali Loss: 1.177 Vali Acc: 0.200 Test Loss: 1.177 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.9423098564147949
Epoch: 13, Steps: 1 | Train Loss: 0.521 Vali Loss: 1.185 Vali Acc: 0.267 Test Loss: 1.185 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.9273183345794678
Epoch: 14, Steps: 1 | Train Loss: 0.521 Vali Loss: 1.194 Vali Acc: 0.200 Test Loss: 1.194 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.9468441009521484
Epoch: 15, Steps: 1 | Train Loss: 0.434 Vali Loss: 1.206 Vali Acc: 0.200 Test Loss: 1.206 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.7220003604888916
Epoch: 16, Steps: 1 | Train Loss: 0.389 Vali Loss: 1.217 Vali Acc: 0.200 Test Loss: 1.217 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.9252474308013916
Epoch: 17, Steps: 1 | Train Loss: 0.326 Vali Loss: 1.226 Vali Acc: 0.200 Test Loss: 1.226 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.8077950477600098
Epoch: 18, Steps: 1 | Train Loss: 0.280 Vali Loss: 1.234 Vali Acc: 0.200 Test Loss: 1.234 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm32_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 4749955
model size : 18.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm32_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.5571117401123047
Epoch: 1, Steps: 1 | Train Loss: 1.290 Vali Loss: 1.148 Vali Acc: 0.467 Test Loss: 1.148 Test Acc: 0.467
Validation loss decreased (inf --> -0.466655).  Saving model ...
Epoch: 2 cost time: 0.6017529964447021
Epoch: 2, Steps: 1 | Train Loss: 1.208 Vali Loss: 1.121 Vali Acc: 0.400 Test Loss: 1.121 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6361439228057861
Epoch: 3, Steps: 1 | Train Loss: 1.093 Vali Loss: 1.106 Vali Acc: 0.333 Test Loss: 1.106 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5988633632659912
Epoch: 4, Steps: 1 | Train Loss: 1.100 Vali Loss: 1.100 Vali Acc: 0.333 Test Loss: 1.100 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.6381196975708008
Epoch: 5, Steps: 1 | Train Loss: 1.057 Vali Loss: 1.100 Vali Acc: 0.333 Test Loss: 1.100 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.6754693984985352
Epoch: 6, Steps: 1 | Train Loss: 0.966 Vali Loss: 1.104 Vali Acc: 0.267 Test Loss: 1.104 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.5854377746582031
Epoch: 7, Steps: 1 | Train Loss: 0.909 Vali Loss: 1.110 Vali Acc: 0.333 Test Loss: 1.110 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.61065673828125
Epoch: 8, Steps: 1 | Train Loss: 0.935 Vali Loss: 1.116 Vali Acc: 0.333 Test Loss: 1.116 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.5861003398895264
Epoch: 9, Steps: 1 | Train Loss: 0.833 Vali Loss: 1.122 Vali Acc: 0.333 Test Loss: 1.122 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.6239800453186035
Epoch: 10, Steps: 1 | Train Loss: 0.717 Vali Loss: 1.127 Vali Acc: 0.333 Test Loss: 1.127 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.6410508155822754
Epoch: 11, Steps: 1 | Train Loss: 0.744 Vali Loss: 1.133 Vali Acc: 0.333 Test Loss: 1.133 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm32_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 1439619
model size : 6.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm32_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.8825864791870117
Epoch: 1, Steps: 1 | Train Loss: 1.263 Vali Loss: 1.124 Vali Acc: 0.400 Test Loss: 1.124 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 1.0395195484161377
Epoch: 2, Steps: 1 | Train Loss: 1.277 Vali Loss: 1.122 Vali Acc: 0.467 Test Loss: 1.122 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 3 cost time: 1.0438287258148193
Epoch: 3, Steps: 1 | Train Loss: 1.183 Vali Loss: 1.120 Vali Acc: 0.467 Test Loss: 1.120 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 4 cost time: 0.9707536697387695
Epoch: 4, Steps: 1 | Train Loss: 1.158 Vali Loss: 1.121 Vali Acc: 0.467 Test Loss: 1.121 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1158668994903564
Epoch: 5, Steps: 1 | Train Loss: 1.144 Vali Loss: 1.122 Vali Acc: 0.467 Test Loss: 1.122 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.0705804824829102
Epoch: 6, Steps: 1 | Train Loss: 1.052 Vali Loss: 1.125 Vali Acc: 0.400 Test Loss: 1.125 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.012030839920044
Epoch: 7, Steps: 1 | Train Loss: 1.045 Vali Loss: 1.128 Vali Acc: 0.333 Test Loss: 1.128 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.0066633224487305
Epoch: 8, Steps: 1 | Train Loss: 0.894 Vali Loss: 1.134 Vali Acc: 0.333 Test Loss: 1.134 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.0855743885040283
Epoch: 9, Steps: 1 | Train Loss: 0.882 Vali Loss: 1.141 Vali Acc: 0.333 Test Loss: 1.141 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.1689472198486328
Epoch: 10, Steps: 1 | Train Loss: 0.849 Vali Loss: 1.151 Vali Acc: 0.267 Test Loss: 1.151 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.9274086952209473
Epoch: 11, Steps: 1 | Train Loss: 0.745 Vali Loss: 1.164 Vali Acc: 0.267 Test Loss: 1.164 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.0810835361480713
Epoch: 12, Steps: 1 | Train Loss: 0.648 Vali Loss: 1.180 Vali Acc: 0.267 Test Loss: 1.180 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.0700852870941162
Epoch: 13, Steps: 1 | Train Loss: 0.618 Vali Loss: 1.199 Vali Acc: 0.267 Test Loss: 1.199 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm32_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 2406275
model size : 9.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm32_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.2939391136169434
Epoch: 1, Steps: 1 | Train Loss: 1.116 Vali Loss: 1.073 Vali Acc: 0.333 Test Loss: 1.073 Test Acc: 0.333
Validation loss decreased (inf --> -0.333323).  Saving model ...
Epoch: 2 cost time: 0.6459352970123291
Epoch: 2, Steps: 1 | Train Loss: 1.011 Vali Loss: 1.075 Vali Acc: 0.333 Test Loss: 1.075 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6362094879150391
Epoch: 3, Steps: 1 | Train Loss: 0.958 Vali Loss: 1.077 Vali Acc: 0.333 Test Loss: 1.077 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6374874114990234
Epoch: 4, Steps: 1 | Train Loss: 0.945 Vali Loss: 1.080 Vali Acc: 0.333 Test Loss: 1.080 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.6749017238616943
Epoch: 5, Steps: 1 | Train Loss: 0.952 Vali Loss: 1.083 Vali Acc: 0.400 Test Loss: 1.083 Test Acc: 0.400
Validation loss decreased (-0.333323 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.7883243560791016
Epoch: 6, Steps: 1 | Train Loss: 0.927 Vali Loss: 1.088 Vali Acc: 0.400 Test Loss: 1.088 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6281535625457764
Epoch: 7, Steps: 1 | Train Loss: 0.830 Vali Loss: 1.094 Vali Acc: 0.400 Test Loss: 1.094 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.6125845909118652
Epoch: 8, Steps: 1 | Train Loss: 0.778 Vali Loss: 1.102 Vali Acc: 0.333 Test Loss: 1.102 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.6015117168426514
Epoch: 9, Steps: 1 | Train Loss: 0.757 Vali Loss: 1.109 Vali Acc: 0.333 Test Loss: 1.109 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.7418735027313232
Epoch: 10, Steps: 1 | Train Loss: 0.693 Vali Loss: 1.119 Vali Acc: 0.333 Test Loss: 1.119 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.6519200801849365
Epoch: 11, Steps: 1 | Train Loss: 0.597 Vali Loss: 1.130 Vali Acc: 0.400 Test Loss: 1.130 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.6734070777893066
Epoch: 12, Steps: 1 | Train Loss: 0.523 Vali Loss: 1.141 Vali Acc: 0.267 Test Loss: 1.141 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.7026798725128174
Epoch: 13, Steps: 1 | Train Loss: 0.482 Vali Loss: 1.157 Vali Acc: 0.267 Test Loss: 1.157 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.6575667858123779
Epoch: 14, Steps: 1 | Train Loss: 0.426 Vali Loss: 1.174 Vali Acc: 0.267 Test Loss: 1.174 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.6750469207763672
Epoch: 15, Steps: 1 | Train Loss: 0.350 Vali Loss: 1.195 Vali Acc: 0.267 Test Loss: 1.195 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm32_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 750979
model size : 3.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm32_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 3.098806142807007
Epoch: 1, Steps: 1 | Train Loss: 1.248 Vali Loss: 1.112 Vali Acc: 0.533 Test Loss: 1.112 Test Acc: 0.533
Validation loss decreased (inf --> -0.533322).  Saving model ...
Epoch: 2 cost time: 0.8838956356048584
Epoch: 2, Steps: 1 | Train Loss: 1.265 Vali Loss: 1.109 Vali Acc: 0.533 Test Loss: 1.109 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 3 cost time: 0.8536789417266846
Epoch: 3, Steps: 1 | Train Loss: 1.169 Vali Loss: 1.107 Vali Acc: 0.533 Test Loss: 1.107 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 4 cost time: 0.9142355918884277
Epoch: 4, Steps: 1 | Train Loss: 1.162 Vali Loss: 1.107 Vali Acc: 0.533 Test Loss: 1.107 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9069530963897705
Epoch: 5, Steps: 1 | Train Loss: 1.148 Vali Loss: 1.109 Vali Acc: 0.533 Test Loss: 1.109 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8561832904815674
Epoch: 6, Steps: 1 | Train Loss: 1.053 Vali Loss: 1.110 Vali Acc: 0.333 Test Loss: 1.110 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.8753881454467773
Epoch: 7, Steps: 1 | Train Loss: 1.043 Vali Loss: 1.114 Vali Acc: 0.333 Test Loss: 1.114 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.8774330615997314
Epoch: 8, Steps: 1 | Train Loss: 0.898 Vali Loss: 1.119 Vali Acc: 0.333 Test Loss: 1.119 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.8966507911682129
Epoch: 9, Steps: 1 | Train Loss: 0.895 Vali Loss: 1.125 Vali Acc: 0.267 Test Loss: 1.125 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.9507784843444824
Epoch: 10, Steps: 1 | Train Loss: 0.854 Vali Loss: 1.134 Vali Acc: 0.267 Test Loss: 1.134 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.8911116123199463
Epoch: 11, Steps: 1 | Train Loss: 0.769 Vali Loss: 1.146 Vali Acc: 0.267 Test Loss: 1.146 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.861074686050415
Epoch: 12, Steps: 1 | Train Loss: 0.661 Vali Loss: 1.162 Vali Acc: 0.267 Test Loss: 1.162 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.8171749114990234
Epoch: 13, Steps: 1 | Train Loss: 0.643 Vali Loss: 1.180 Vali Acc: 0.267 Test Loss: 1.180 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm32_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 2406275
model size : 9.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm32_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.314300775527954
Epoch: 1, Steps: 1 | Train Loss: 1.116 Vali Loss: 1.060 Vali Acc: 0.400 Test Loss: 1.060 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.5387401580810547
Epoch: 2, Steps: 1 | Train Loss: 1.001 Vali Loss: 1.060 Vali Acc: 0.333 Test Loss: 1.060 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5819706916809082
Epoch: 3, Steps: 1 | Train Loss: 0.952 Vali Loss: 1.063 Vali Acc: 0.333 Test Loss: 1.063 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6023514270782471
Epoch: 4, Steps: 1 | Train Loss: 0.944 Vali Loss: 1.065 Vali Acc: 0.333 Test Loss: 1.065 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.6578798294067383
Epoch: 5, Steps: 1 | Train Loss: 0.942 Vali Loss: 1.068 Vali Acc: 0.400 Test Loss: 1.068 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.6247777938842773
Epoch: 6, Steps: 1 | Train Loss: 0.926 Vali Loss: 1.072 Vali Acc: 0.400 Test Loss: 1.072 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.6059212684631348
Epoch: 7, Steps: 1 | Train Loss: 0.831 Vali Loss: 1.078 Vali Acc: 0.400 Test Loss: 1.078 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.7188317775726318
Epoch: 8, Steps: 1 | Train Loss: 0.799 Vali Loss: 1.085 Vali Acc: 0.400 Test Loss: 1.085 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.5944998264312744
Epoch: 9, Steps: 1 | Train Loss: 0.769 Vali Loss: 1.091 Vali Acc: 0.333 Test Loss: 1.091 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.6299238204956055
Epoch: 10, Steps: 1 | Train Loss: 0.694 Vali Loss: 1.099 Vali Acc: 0.333 Test Loss: 1.099 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.6191811561584473
Epoch: 11, Steps: 1 | Train Loss: 0.601 Vali Loss: 1.110 Vali Acc: 0.333 Test Loss: 1.110 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm32_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 750979
model size : 3.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm32_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.530283212661743
Epoch: 1, Steps: 1 | Train Loss: 1.240 Vali Loss: 1.099 Vali Acc: 0.533 Test Loss: 1.099 Test Acc: 0.533
Validation loss decreased (inf --> -0.533322).  Saving model ...
Epoch: 2 cost time: 0.7047455310821533
Epoch: 2, Steps: 1 | Train Loss: 1.262 Vali Loss: 1.094 Vali Acc: 0.533 Test Loss: 1.094 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 3 cost time: 0.6598830223083496
Epoch: 3, Steps: 1 | Train Loss: 1.169 Vali Loss: 1.092 Vali Acc: 0.533 Test Loss: 1.092 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 4 cost time: 0.6736946105957031
Epoch: 4, Steps: 1 | Train Loss: 1.157 Vali Loss: 1.092 Vali Acc: 0.533 Test Loss: 1.092 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 5 cost time: 0.7696421146392822
Epoch: 5, Steps: 1 | Train Loss: 1.147 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.894658088684082
Epoch: 6, Steps: 1 | Train Loss: 1.049 Vali Loss: 1.095 Vali Acc: 0.333 Test Loss: 1.095 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.6932013034820557
Epoch: 7, Steps: 1 | Train Loss: 1.043 Vali Loss: 1.099 Vali Acc: 0.333 Test Loss: 1.099 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.743638277053833
Epoch: 8, Steps: 1 | Train Loss: 0.901 Vali Loss: 1.104 Vali Acc: 0.333 Test Loss: 1.104 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.6788196563720703
Epoch: 9, Steps: 1 | Train Loss: 0.903 Vali Loss: 1.111 Vali Acc: 0.267 Test Loss: 1.111 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.6517372131347656
Epoch: 10, Steps: 1 | Train Loss: 0.867 Vali Loss: 1.121 Vali Acc: 0.267 Test Loss: 1.121 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.5994265079498291
Epoch: 11, Steps: 1 | Train Loss: 0.780 Vali Loss: 1.134 Vali Acc: 0.267 Test Loss: 1.134 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.7214474678039551
Epoch: 12, Steps: 1 | Train Loss: 0.674 Vali Loss: 1.150 Vali Acc: 0.200 Test Loss: 1.150 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.6364121437072754
Epoch: 13, Steps: 1 | Train Loss: 0.657 Vali Loss: 1.170 Vali Acc: 0.267 Test Loss: 1.170 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.7661807537078857
Epoch: 14, Steps: 1 | Train Loss: 0.568 Vali Loss: 1.192 Vali Acc: 0.267 Test Loss: 1.192 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm32_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 2406275
model size : 9.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm32_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.2978076934814453
Epoch: 1, Steps: 1 | Train Loss: 1.120 Vali Loss: 1.097 Vali Acc: 0.400 Test Loss: 1.097 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.4832160472869873
Epoch: 2, Steps: 1 | Train Loss: 0.999 Vali Loss: 1.097 Vali Acc: 0.333 Test Loss: 1.097 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5788960456848145
Epoch: 3, Steps: 1 | Train Loss: 0.951 Vali Loss: 1.099 Vali Acc: 0.333 Test Loss: 1.099 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5215613842010498
Epoch: 4, Steps: 1 | Train Loss: 0.941 Vali Loss: 1.101 Vali Acc: 0.267 Test Loss: 1.101 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.6180434226989746
Epoch: 5, Steps: 1 | Train Loss: 0.946 Vali Loss: 1.104 Vali Acc: 0.333 Test Loss: 1.104 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5138278007507324
Epoch: 6, Steps: 1 | Train Loss: 0.922 Vali Loss: 1.108 Vali Acc: 0.333 Test Loss: 1.108 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.510162353515625
Epoch: 7, Steps: 1 | Train Loss: 0.831 Vali Loss: 1.115 Vali Acc: 0.333 Test Loss: 1.115 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.5430908203125
Epoch: 8, Steps: 1 | Train Loss: 0.777 Vali Loss: 1.122 Vali Acc: 0.267 Test Loss: 1.122 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.5240423679351807
Epoch: 9, Steps: 1 | Train Loss: 0.757 Vali Loss: 1.129 Vali Acc: 0.267 Test Loss: 1.129 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.5321605205535889
Epoch: 10, Steps: 1 | Train Loss: 0.695 Vali Loss: 1.138 Vali Acc: 0.267 Test Loss: 1.138 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.5897350311279297
Epoch: 11, Steps: 1 | Train Loss: 0.603 Vali Loss: 1.149 Vali Acc: 0.267 Test Loss: 1.149 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm32_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 750979
model size : 3.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm16_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 3.4481308460235596
Epoch: 1, Steps: 1 | Train Loss: 1.134 Vali Loss: 1.118 Vali Acc: 0.133 Test Loss: 1.118 Test Acc: 0.133
Validation loss decreased (inf --> -0.133322).  Saving model ...
Epoch: 2 cost time: 1.2663090229034424
Epoch: 2, Steps: 1 | Train Loss: 1.054 Vali Loss: 1.120 Vali Acc: 0.133 Test Loss: 1.120 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2248914241790771
Epoch: 3, Steps: 1 | Train Loss: 1.029 Vali Loss: 1.122 Vali Acc: 0.200 Test Loss: 1.122 Test Acc: 0.200
Validation loss decreased (-0.133322 --> -0.199989).  Saving model ...
Epoch: 4 cost time: 1.1819381713867188
Epoch: 4, Steps: 1 | Train Loss: 1.016 Vali Loss: 1.125 Vali Acc: 0.200 Test Loss: 1.125 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1809775829315186
Epoch: 5, Steps: 1 | Train Loss: 1.124 Vali Loss: 1.128 Vali Acc: 0.200 Test Loss: 1.128 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.2080035209655762
Epoch: 6, Steps: 1 | Train Loss: 0.987 Vali Loss: 1.130 Vali Acc: 0.200 Test Loss: 1.130 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.2651174068450928
Epoch: 7, Steps: 1 | Train Loss: 0.957 Vali Loss: 1.133 Vali Acc: 0.267 Test Loss: 1.133 Test Acc: 0.267
Validation loss decreased (-0.199989 --> -0.266655).  Saving model ...
Epoch: 8 cost time: 1.1921205520629883
Epoch: 8, Steps: 1 | Train Loss: 0.903 Vali Loss: 1.137 Vali Acc: 0.267 Test Loss: 1.137 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9524705410003662
Epoch: 9, Steps: 1 | Train Loss: 0.875 Vali Loss: 1.142 Vali Acc: 0.267 Test Loss: 1.142 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.1880769729614258
Epoch: 10, Steps: 1 | Train Loss: 0.888 Vali Loss: 1.147 Vali Acc: 0.267 Test Loss: 1.147 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.216085433959961
Epoch: 11, Steps: 1 | Train Loss: 0.794 Vali Loss: 1.154 Vali Acc: 0.267 Test Loss: 1.154 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.1938207149505615
Epoch: 12, Steps: 1 | Train Loss: 0.771 Vali Loss: 1.162 Vali Acc: 0.267 Test Loss: 1.162 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.1959073543548584
Epoch: 13, Steps: 1 | Train Loss: 0.708 Vali Loss: 1.170 Vali Acc: 0.267 Test Loss: 1.170 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.1594977378845215
Epoch: 14, Steps: 1 | Train Loss: 0.698 Vali Loss: 1.180 Vali Acc: 0.267 Test Loss: 1.180 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.2260379791259766
Epoch: 15, Steps: 1 | Train Loss: 0.671 Vali Loss: 1.190 Vali Acc: 0.267 Test Loss: 1.190 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.2591032981872559
Epoch: 16, Steps: 1 | Train Loss: 0.619 Vali Loss: 1.200 Vali Acc: 0.267 Test Loss: 1.200 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.1954855918884277
Epoch: 17, Steps: 1 | Train Loss: 0.576 Vali Loss: 1.211 Vali Acc: 0.267 Test Loss: 1.211 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm16_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 2375747
model size : 9.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm16_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.503152847290039
Epoch: 1, Steps: 1 | Train Loss: 1.066 Vali Loss: 1.095 Vali Acc: 0.467 Test Loss: 1.095 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.7122466564178467
Epoch: 2, Steps: 1 | Train Loss: 1.059 Vali Loss: 1.098 Vali Acc: 0.467 Test Loss: 1.098 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7061777114868164
Epoch: 3, Steps: 1 | Train Loss: 1.060 Vali Loss: 1.101 Vali Acc: 0.467 Test Loss: 1.101 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.631781816482544
Epoch: 4, Steps: 1 | Train Loss: 1.025 Vali Loss: 1.104 Vali Acc: 0.400 Test Loss: 1.104 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.6701769828796387
Epoch: 5, Steps: 1 | Train Loss: 0.954 Vali Loss: 1.107 Vali Acc: 0.400 Test Loss: 1.107 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.7131891250610352
Epoch: 6, Steps: 1 | Train Loss: 0.937 Vali Loss: 1.109 Vali Acc: 0.400 Test Loss: 1.109 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.6702194213867188
Epoch: 7, Steps: 1 | Train Loss: 0.905 Vali Loss: 1.112 Vali Acc: 0.400 Test Loss: 1.112 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.6876540184020996
Epoch: 8, Steps: 1 | Train Loss: 0.918 Vali Loss: 1.115 Vali Acc: 0.400 Test Loss: 1.115 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.6306805610656738
Epoch: 9, Steps: 1 | Train Loss: 0.890 Vali Loss: 1.118 Vali Acc: 0.400 Test Loss: 1.118 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.700031042098999
Epoch: 10, Steps: 1 | Train Loss: 0.879 Vali Loss: 1.122 Vali Acc: 0.400 Test Loss: 1.122 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.6200940608978271
Epoch: 11, Steps: 1 | Train Loss: 0.750 Vali Loss: 1.126 Vali Acc: 0.400 Test Loss: 1.126 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm16_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 720323
model size : 3.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm16_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 3.0206644535064697
Epoch: 1, Steps: 1 | Train Loss: 1.134 Vali Loss: 1.111 Vali Acc: 0.200 Test Loss: 1.111 Test Acc: 0.200
Validation loss decreased (inf --> -0.199989).  Saving model ...
Epoch: 2 cost time: 1.0107471942901611
Epoch: 2, Steps: 1 | Train Loss: 1.054 Vali Loss: 1.112 Vali Acc: 0.133 Test Loss: 1.112 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9913520812988281
Epoch: 3, Steps: 1 | Train Loss: 1.033 Vali Loss: 1.114 Vali Acc: 0.200 Test Loss: 1.114 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9505622386932373
Epoch: 4, Steps: 1 | Train Loss: 1.016 Vali Loss: 1.117 Vali Acc: 0.200 Test Loss: 1.117 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.0304138660430908
Epoch: 5, Steps: 1 | Train Loss: 1.129 Vali Loss: 1.120 Vali Acc: 0.200 Test Loss: 1.120 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.0209527015686035
Epoch: 6, Steps: 1 | Train Loss: 0.990 Vali Loss: 1.122 Vali Acc: 0.200 Test Loss: 1.122 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.9723560810089111
Epoch: 7, Steps: 1 | Train Loss: 0.964 Vali Loss: 1.125 Vali Acc: 0.333 Test Loss: 1.125 Test Acc: 0.333
Validation loss decreased (-0.199989 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 1.0406115055084229
Epoch: 8, Steps: 1 | Train Loss: 0.908 Vali Loss: 1.129 Vali Acc: 0.267 Test Loss: 1.129 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9258327484130859
Epoch: 9, Steps: 1 | Train Loss: 0.884 Vali Loss: 1.135 Vali Acc: 0.267 Test Loss: 1.135 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9886445999145508
Epoch: 10, Steps: 1 | Train Loss: 0.902 Vali Loss: 1.140 Vali Acc: 0.267 Test Loss: 1.140 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.9320883750915527
Epoch: 11, Steps: 1 | Train Loss: 0.804 Vali Loss: 1.147 Vali Acc: 0.267 Test Loss: 1.147 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.9934163093566895
Epoch: 12, Steps: 1 | Train Loss: 0.788 Vali Loss: 1.155 Vali Acc: 0.267 Test Loss: 1.155 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.9982330799102783
Epoch: 13, Steps: 1 | Train Loss: 0.720 Vali Loss: 1.165 Vali Acc: 0.267 Test Loss: 1.165 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.0379424095153809
Epoch: 14, Steps: 1 | Train Loss: 0.712 Vali Loss: 1.175 Vali Acc: 0.267 Test Loss: 1.175 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.9451370239257812
Epoch: 15, Steps: 1 | Train Loss: 0.687 Vali Loss: 1.186 Vali Acc: 0.267 Test Loss: 1.186 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.933884859085083
Epoch: 16, Steps: 1 | Train Loss: 0.633 Vali Loss: 1.197 Vali Acc: 0.267 Test Loss: 1.197 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.9081456661224365
Epoch: 17, Steps: 1 | Train Loss: 0.585 Vali Loss: 1.210 Vali Acc: 0.267 Test Loss: 1.210 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm16_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 2375747
model size : 9.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm16_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.438847780227661
Epoch: 1, Steps: 1 | Train Loss: 1.074 Vali Loss: 1.087 Vali Acc: 0.533 Test Loss: 1.087 Test Acc: 0.533
Validation loss decreased (inf --> -0.533322).  Saving model ...
Epoch: 2 cost time: 0.6168460845947266
Epoch: 2, Steps: 1 | Train Loss: 1.054 Vali Loss: 1.089 Vali Acc: 0.533 Test Loss: 1.089 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6454918384552002
Epoch: 3, Steps: 1 | Train Loss: 1.066 Vali Loss: 1.092 Vali Acc: 0.467 Test Loss: 1.092 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6695153713226318
Epoch: 4, Steps: 1 | Train Loss: 1.037 Vali Loss: 1.095 Vali Acc: 0.400 Test Loss: 1.095 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.6631569862365723
Epoch: 5, Steps: 1 | Train Loss: 0.953 Vali Loss: 1.098 Vali Acc: 0.400 Test Loss: 1.098 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.688826322555542
Epoch: 6, Steps: 1 | Train Loss: 0.938 Vali Loss: 1.100 Vali Acc: 0.400 Test Loss: 1.100 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.6742126941680908
Epoch: 7, Steps: 1 | Train Loss: 0.910 Vali Loss: 1.103 Vali Acc: 0.400 Test Loss: 1.103 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.7956929206848145
Epoch: 8, Steps: 1 | Train Loss: 0.924 Vali Loss: 1.107 Vali Acc: 0.400 Test Loss: 1.107 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.7349982261657715
Epoch: 9, Steps: 1 | Train Loss: 0.893 Vali Loss: 1.111 Vali Acc: 0.467 Test Loss: 1.111 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.7660627365112305
Epoch: 10, Steps: 1 | Train Loss: 0.883 Vali Loss: 1.115 Vali Acc: 0.467 Test Loss: 1.115 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.6650617122650146
Epoch: 11, Steps: 1 | Train Loss: 0.759 Vali Loss: 1.121 Vali Acc: 0.467 Test Loss: 1.121 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm16_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 720323
model size : 3.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm16_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.547783851623535
Epoch: 1, Steps: 1 | Train Loss: 1.130 Vali Loss: 1.099 Vali Acc: 0.400 Test Loss: 1.099 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.7483165264129639
Epoch: 2, Steps: 1 | Train Loss: 1.050 Vali Loss: 1.100 Vali Acc: 0.333 Test Loss: 1.100 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7112674713134766
Epoch: 3, Steps: 1 | Train Loss: 1.025 Vali Loss: 1.102 Vali Acc: 0.267 Test Loss: 1.102 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7238326072692871
Epoch: 4, Steps: 1 | Train Loss: 1.011 Vali Loss: 1.105 Vali Acc: 0.200 Test Loss: 1.105 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7328493595123291
Epoch: 5, Steps: 1 | Train Loss: 1.125 Vali Loss: 1.108 Vali Acc: 0.267 Test Loss: 1.108 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.833653450012207
Epoch: 6, Steps: 1 | Train Loss: 0.985 Vali Loss: 1.110 Vali Acc: 0.333 Test Loss: 1.110 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.8055498600006104
Epoch: 7, Steps: 1 | Train Loss: 0.955 Vali Loss: 1.113 Vali Acc: 0.333 Test Loss: 1.113 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.6928665637969971
Epoch: 8, Steps: 1 | Train Loss: 0.910 Vali Loss: 1.117 Vali Acc: 0.333 Test Loss: 1.117 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.7933633327484131
Epoch: 9, Steps: 1 | Train Loss: 0.883 Vali Loss: 1.123 Vali Acc: 0.267 Test Loss: 1.123 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.7584872245788574
Epoch: 10, Steps: 1 | Train Loss: 0.902 Vali Loss: 1.129 Vali Acc: 0.267 Test Loss: 1.129 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.6876962184906006
Epoch: 11, Steps: 1 | Train Loss: 0.812 Vali Loss: 1.136 Vali Acc: 0.267 Test Loss: 1.136 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm16_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 2375747
model size : 9.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm16_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.27593994140625
Epoch: 1, Steps: 1 | Train Loss: 1.063 Vali Loss: 1.082 Vali Acc: 0.533 Test Loss: 1.082 Test Acc: 0.533
Validation loss decreased (inf --> -0.533323).  Saving model ...
Epoch: 2 cost time: 0.5665032863616943
Epoch: 2, Steps: 1 | Train Loss: 1.038 Vali Loss: 1.085 Vali Acc: 0.533 Test Loss: 1.085 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5632462501525879
Epoch: 3, Steps: 1 | Train Loss: 1.051 Vali Loss: 1.088 Vali Acc: 0.467 Test Loss: 1.088 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6040520668029785
Epoch: 4, Steps: 1 | Train Loss: 1.026 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5717213153839111
Epoch: 5, Steps: 1 | Train Loss: 0.944 Vali Loss: 1.094 Vali Acc: 0.400 Test Loss: 1.094 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5923724174499512
Epoch: 6, Steps: 1 | Train Loss: 0.921 Vali Loss: 1.097 Vali Acc: 0.400 Test Loss: 1.097 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.7130215167999268
Epoch: 7, Steps: 1 | Train Loss: 0.907 Vali Loss: 1.100 Vali Acc: 0.400 Test Loss: 1.100 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.5574665069580078
Epoch: 8, Steps: 1 | Train Loss: 0.913 Vali Loss: 1.104 Vali Acc: 0.400 Test Loss: 1.104 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.5714116096496582
Epoch: 9, Steps: 1 | Train Loss: 0.891 Vali Loss: 1.108 Vali Acc: 0.467 Test Loss: 1.108 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.623133659362793
Epoch: 10, Steps: 1 | Train Loss: 0.875 Vali Loss: 1.113 Vali Acc: 0.467 Test Loss: 1.113 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.61600661277771
Epoch: 11, Steps: 1 | Train Loss: 0.750 Vali Loss: 1.118 Vali Acc: 0.467 Test Loss: 1.118 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm16_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 720323
model size : 3.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm16_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.8850057125091553
Epoch: 1, Steps: 1 | Train Loss: 1.322 Vali Loss: 1.081 Vali Acc: 0.333 Test Loss: 1.081 Test Acc: 0.333
Validation loss decreased (inf --> -0.333323).  Saving model ...
Epoch: 2 cost time: 0.9315710067749023
Epoch: 2, Steps: 1 | Train Loss: 1.247 Vali Loss: 1.076 Vali Acc: 0.333 Test Loss: 1.076 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 3 cost time: 0.9757168292999268
Epoch: 3, Steps: 1 | Train Loss: 1.154 Vali Loss: 1.073 Vali Acc: 0.333 Test Loss: 1.073 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 4 cost time: 0.8864521980285645
Epoch: 4, Steps: 1 | Train Loss: 1.206 Vali Loss: 1.072 Vali Acc: 0.333 Test Loss: 1.072 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 5 cost time: 0.9590981006622314
Epoch: 5, Steps: 1 | Train Loss: 1.101 Vali Loss: 1.072 Vali Acc: 0.333 Test Loss: 1.072 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9151997566223145
Epoch: 6, Steps: 1 | Train Loss: 1.155 Vali Loss: 1.074 Vali Acc: 0.333 Test Loss: 1.074 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9415225982666016
Epoch: 7, Steps: 1 | Train Loss: 1.128 Vali Loss: 1.077 Vali Acc: 0.333 Test Loss: 1.077 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.9559452533721924
Epoch: 8, Steps: 1 | Train Loss: 1.000 Vali Loss: 1.080 Vali Acc: 0.400 Test Loss: 1.080 Test Acc: 0.400
Validation loss decreased (-0.333323 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 0.8764383792877197
Epoch: 9, Steps: 1 | Train Loss: 1.022 Vali Loss: 1.085 Vali Acc: 0.400 Test Loss: 1.085 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9351065158843994
Epoch: 10, Steps: 1 | Train Loss: 0.929 Vali Loss: 1.089 Vali Acc: 0.400 Test Loss: 1.089 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9861969947814941
Epoch: 11, Steps: 1 | Train Loss: 0.962 Vali Loss: 1.094 Vali Acc: 0.333 Test Loss: 1.094 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.804985761642456
Epoch: 12, Steps: 1 | Train Loss: 0.939 Vali Loss: 1.098 Vali Acc: 0.333 Test Loss: 1.098 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.7864177227020264
Epoch: 13, Steps: 1 | Train Loss: 0.834 Vali Loss: 1.101 Vali Acc: 0.333 Test Loss: 1.101 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.8575630187988281
Epoch: 14, Steps: 1 | Train Loss: 0.833 Vali Loss: 1.104 Vali Acc: 0.333 Test Loss: 1.104 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.853346586227417
Epoch: 15, Steps: 1 | Train Loss: 0.732 Vali Loss: 1.107 Vali Acc: 0.333 Test Loss: 1.107 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.9694230556488037
Epoch: 16, Steps: 1 | Train Loss: 0.667 Vali Loss: 1.110 Vali Acc: 0.267 Test Loss: 1.110 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.8817219734191895
Epoch: 17, Steps: 1 | Train Loss: 0.673 Vali Loss: 1.114 Vali Acc: 0.267 Test Loss: 1.114 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.8694441318511963
Epoch: 18, Steps: 1 | Train Loss: 0.639 Vali Loss: 1.118 Vali Acc: 0.400 Test Loss: 1.118 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm16_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 1203523
model size : 4.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm16_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.5151281356811523
Epoch: 1, Steps: 1 | Train Loss: 1.352 Vali Loss: 1.106 Vali Acc: 0.267 Test Loss: 1.106 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.6136264801025391
Epoch: 2, Steps: 1 | Train Loss: 1.391 Vali Loss: 1.094 Vali Acc: 0.400 Test Loss: 1.094 Test Acc: 0.400
Validation loss decreased (-0.266656 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.5778646469116211
Epoch: 3, Steps: 1 | Train Loss: 1.219 Vali Loss: 1.086 Vali Acc: 0.400 Test Loss: 1.086 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.5581569671630859
Epoch: 4, Steps: 1 | Train Loss: 1.116 Vali Loss: 1.083 Vali Acc: 0.400 Test Loss: 1.083 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.5585107803344727
Epoch: 5, Steps: 1 | Train Loss: 1.144 Vali Loss: 1.082 Vali Acc: 0.467 Test Loss: 1.082 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 6 cost time: 0.5592114925384521
Epoch: 6, Steps: 1 | Train Loss: 1.095 Vali Loss: 1.083 Vali Acc: 0.400 Test Loss: 1.083 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5251152515411377
Epoch: 7, Steps: 1 | Train Loss: 1.105 Vali Loss: 1.086 Vali Acc: 0.400 Test Loss: 1.086 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.5950267314910889
Epoch: 8, Steps: 1 | Train Loss: 1.007 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.56569504737854
Epoch: 9, Steps: 1 | Train Loss: 0.992 Vali Loss: 1.098 Vali Acc: 0.333 Test Loss: 1.098 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.5692694187164307
Epoch: 10, Steps: 1 | Train Loss: 0.965 Vali Loss: 1.107 Vali Acc: 0.400 Test Loss: 1.107 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.5813262462615967
Epoch: 11, Steps: 1 | Train Loss: 0.893 Vali Loss: 1.115 Vali Acc: 0.400 Test Loss: 1.115 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.6440596580505371
Epoch: 12, Steps: 1 | Train Loss: 0.867 Vali Loss: 1.123 Vali Acc: 0.400 Test Loss: 1.123 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.5915563106536865
Epoch: 13, Steps: 1 | Train Loss: 0.894 Vali Loss: 1.132 Vali Acc: 0.400 Test Loss: 1.132 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.6609799861907959
Epoch: 14, Steps: 1 | Train Loss: 0.841 Vali Loss: 1.140 Vali Acc: 0.400 Test Loss: 1.140 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.6323108673095703
Epoch: 15, Steps: 1 | Train Loss: 0.762 Vali Loss: 1.146 Vali Acc: 0.400 Test Loss: 1.146 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm16_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 375747
model size : 1.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm16_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.5786972045898438
Epoch: 1, Steps: 1 | Train Loss: 1.334 Vali Loss: 1.073 Vali Acc: 0.333 Test Loss: 1.073 Test Acc: 0.333
Validation loss decreased (inf --> -0.333323).  Saving model ...
Epoch: 2 cost time: 0.8090696334838867
Epoch: 2, Steps: 1 | Train Loss: 1.250 Vali Loss: 1.068 Vali Acc: 0.333 Test Loss: 1.068 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 3 cost time: 0.7428677082061768
Epoch: 3, Steps: 1 | Train Loss: 1.164 Vali Loss: 1.066 Vali Acc: 0.333 Test Loss: 1.066 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 4 cost time: 0.7992660999298096
Epoch: 4, Steps: 1 | Train Loss: 1.215 Vali Loss: 1.065 Vali Acc: 0.333 Test Loss: 1.065 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 5 cost time: 0.7693696022033691
Epoch: 5, Steps: 1 | Train Loss: 1.114 Vali Loss: 1.065 Vali Acc: 0.333 Test Loss: 1.065 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7051832675933838
Epoch: 6, Steps: 1 | Train Loss: 1.152 Vali Loss: 1.067 Vali Acc: 0.333 Test Loss: 1.067 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.7583937644958496
Epoch: 7, Steps: 1 | Train Loss: 1.139 Vali Loss: 1.070 Vali Acc: 0.333 Test Loss: 1.070 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.7866895198822021
Epoch: 8, Steps: 1 | Train Loss: 1.018 Vali Loss: 1.074 Vali Acc: 0.333 Test Loss: 1.074 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.7635869979858398
Epoch: 9, Steps: 1 | Train Loss: 1.037 Vali Loss: 1.078 Vali Acc: 0.333 Test Loss: 1.078 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.8045654296875
Epoch: 10, Steps: 1 | Train Loss: 0.948 Vali Loss: 1.083 Vali Acc: 0.333 Test Loss: 1.083 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.7921285629272461
Epoch: 11, Steps: 1 | Train Loss: 0.958 Vali Loss: 1.088 Vali Acc: 0.333 Test Loss: 1.088 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.7797179222106934
Epoch: 12, Steps: 1 | Train Loss: 0.959 Vali Loss: 1.093 Vali Acc: 0.333 Test Loss: 1.093 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.7757437229156494
Epoch: 13, Steps: 1 | Train Loss: 0.855 Vali Loss: 1.096 Vali Acc: 0.333 Test Loss: 1.096 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.7414813041687012
Epoch: 14, Steps: 1 | Train Loss: 0.851 Vali Loss: 1.099 Vali Acc: 0.333 Test Loss: 1.099 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm16_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 1203523
model size : 4.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm16_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.2421975135803223
Epoch: 1, Steps: 1 | Train Loss: 1.340 Vali Loss: 1.100 Vali Acc: 0.267 Test Loss: 1.100 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.6271493434906006
Epoch: 2, Steps: 1 | Train Loss: 1.365 Vali Loss: 1.087 Vali Acc: 0.400 Test Loss: 1.087 Test Acc: 0.400
Validation loss decreased (-0.266656 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.6232836246490479
Epoch: 3, Steps: 1 | Train Loss: 1.210 Vali Loss: 1.080 Vali Acc: 0.400 Test Loss: 1.080 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.7032732963562012
Epoch: 4, Steps: 1 | Train Loss: 1.099 Vali Loss: 1.076 Vali Acc: 0.400 Test Loss: 1.076 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.6331310272216797
Epoch: 5, Steps: 1 | Train Loss: 1.130 Vali Loss: 1.076 Vali Acc: 0.467 Test Loss: 1.076 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 6 cost time: 0.6754429340362549
Epoch: 6, Steps: 1 | Train Loss: 1.092 Vali Loss: 1.077 Vali Acc: 0.533 Test Loss: 1.077 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 7 cost time: 0.6222352981567383
Epoch: 7, Steps: 1 | Train Loss: 1.085 Vali Loss: 1.080 Vali Acc: 0.467 Test Loss: 1.080 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6367950439453125
Epoch: 8, Steps: 1 | Train Loss: 1.001 Vali Loss: 1.086 Vali Acc: 0.467 Test Loss: 1.086 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.5466673374176025
Epoch: 9, Steps: 1 | Train Loss: 0.986 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.5229659080505371
Epoch: 10, Steps: 1 | Train Loss: 0.955 Vali Loss: 1.102 Vali Acc: 0.467 Test Loss: 1.102 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.5569362640380859
Epoch: 11, Steps: 1 | Train Loss: 0.899 Vali Loss: 1.110 Vali Acc: 0.400 Test Loss: 1.110 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.6108605861663818
Epoch: 12, Steps: 1 | Train Loss: 0.868 Vali Loss: 1.119 Vali Acc: 0.400 Test Loss: 1.119 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.6367716789245605
Epoch: 13, Steps: 1 | Train Loss: 0.888 Vali Loss: 1.127 Vali Acc: 0.400 Test Loss: 1.127 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.6082563400268555
Epoch: 14, Steps: 1 | Train Loss: 0.837 Vali Loss: 1.135 Vali Acc: 0.400 Test Loss: 1.135 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.5473496913909912
Epoch: 15, Steps: 1 | Train Loss: 0.756 Vali Loss: 1.141 Vali Acc: 0.400 Test Loss: 1.141 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.5580589771270752
Epoch: 16, Steps: 1 | Train Loss: 0.717 Vali Loss: 1.146 Vali Acc: 0.467 Test Loss: 1.146 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm16_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 375747
model size : 1.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm16_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.5589346885681152
Epoch: 1, Steps: 1 | Train Loss: 1.330 Vali Loss: 1.071 Vali Acc: 0.333 Test Loss: 1.071 Test Acc: 0.333
Validation loss decreased (inf --> -0.333323).  Saving model ...
Epoch: 2 cost time: 0.6761007308959961
Epoch: 2, Steps: 1 | Train Loss: 1.250 Vali Loss: 1.066 Vali Acc: 0.333 Test Loss: 1.066 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 3 cost time: 0.6707377433776855
Epoch: 3, Steps: 1 | Train Loss: 1.165 Vali Loss: 1.063 Vali Acc: 0.400 Test Loss: 1.063 Test Acc: 0.400
Validation loss decreased (-0.333323 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.6219692230224609
Epoch: 4, Steps: 1 | Train Loss: 1.215 Vali Loss: 1.062 Vali Acc: 0.333 Test Loss: 1.062 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6860682964324951
Epoch: 5, Steps: 1 | Train Loss: 1.116 Vali Loss: 1.062 Vali Acc: 0.400 Test Loss: 1.062 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.6454942226409912
Epoch: 6, Steps: 1 | Train Loss: 1.163 Vali Loss: 1.064 Vali Acc: 0.467 Test Loss: 1.064 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 7 cost time: 0.694408655166626
Epoch: 7, Steps: 1 | Train Loss: 1.144 Vali Loss: 1.066 Vali Acc: 0.467 Test Loss: 1.066 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6732180118560791
Epoch: 8, Steps: 1 | Train Loss: 1.025 Vali Loss: 1.070 Vali Acc: 0.467 Test Loss: 1.070 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.6958732604980469
Epoch: 9, Steps: 1 | Train Loss: 1.044 Vali Loss: 1.074 Vali Acc: 0.400 Test Loss: 1.074 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.6802306175231934
Epoch: 10, Steps: 1 | Train Loss: 0.950 Vali Loss: 1.079 Vali Acc: 0.333 Test Loss: 1.079 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.6660125255584717
Epoch: 11, Steps: 1 | Train Loss: 0.971 Vali Loss: 1.084 Vali Acc: 0.333 Test Loss: 1.084 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.7585270404815674
Epoch: 12, Steps: 1 | Train Loss: 0.972 Vali Loss: 1.088 Vali Acc: 0.400 Test Loss: 1.088 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.686652421951294
Epoch: 13, Steps: 1 | Train Loss: 0.868 Vali Loss: 1.092 Vali Acc: 0.400 Test Loss: 1.092 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.7337856292724609
Epoch: 14, Steps: 1 | Train Loss: 0.861 Vali Loss: 1.095 Vali Acc: 0.467 Test Loss: 1.095 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.7665431499481201
Epoch: 15, Steps: 1 | Train Loss: 0.767 Vali Loss: 1.098 Vali Acc: 0.467 Test Loss: 1.098 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.6673336029052734
Epoch: 16, Steps: 1 | Train Loss: 0.694 Vali Loss: 1.102 Vali Acc: 0.400 Test Loss: 1.102 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm16_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 1203523
model size : 4.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm16_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.207623243331909
Epoch: 1, Steps: 1 | Train Loss: 1.337 Vali Loss: 1.120 Vali Acc: 0.200 Test Loss: 1.120 Test Acc: 0.200
Validation loss decreased (inf --> -0.199989).  Saving model ...
Epoch: 2 cost time: 0.5486588478088379
Epoch: 2, Steps: 1 | Train Loss: 1.367 Vali Loss: 1.105 Vali Acc: 0.267 Test Loss: 1.105 Test Acc: 0.267
Validation loss decreased (-0.199989 --> -0.266656).  Saving model ...
Epoch: 3 cost time: 0.5534780025482178
Epoch: 3, Steps: 1 | Train Loss: 1.204 Vali Loss: 1.096 Vali Acc: 0.333 Test Loss: 1.096 Test Acc: 0.333
Validation loss decreased (-0.266656 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.5832803249359131
Epoch: 4, Steps: 1 | Train Loss: 1.098 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.6500871181488037
Epoch: 5, Steps: 1 | Train Loss: 1.125 Vali Loss: 1.089 Vali Acc: 0.400 Test Loss: 1.089 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.6915814876556396
Epoch: 6, Steps: 1 | Train Loss: 1.092 Vali Loss: 1.090 Vali Acc: 0.400 Test Loss: 1.090 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5887744426727295
Epoch: 7, Steps: 1 | Train Loss: 1.086 Vali Loss: 1.092 Vali Acc: 0.400 Test Loss: 1.092 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.6271471977233887
Epoch: 8, Steps: 1 | Train Loss: 1.006 Vali Loss: 1.096 Vali Acc: 0.467 Test Loss: 1.096 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 9 cost time: 0.5689399242401123
Epoch: 9, Steps: 1 | Train Loss: 0.988 Vali Loss: 1.102 Vali Acc: 0.467 Test Loss: 1.102 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5463430881500244
Epoch: 10, Steps: 1 | Train Loss: 0.961 Vali Loss: 1.110 Vali Acc: 0.467 Test Loss: 1.110 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.5910918712615967
Epoch: 11, Steps: 1 | Train Loss: 0.899 Vali Loss: 1.118 Vali Acc: 0.467 Test Loss: 1.118 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.5799813270568848
Epoch: 12, Steps: 1 | Train Loss: 0.873 Vali Loss: 1.126 Vali Acc: 0.467 Test Loss: 1.126 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.5960297584533691
Epoch: 13, Steps: 1 | Train Loss: 0.903 Vali Loss: 1.133 Vali Acc: 0.467 Test Loss: 1.133 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.6256833076477051
Epoch: 14, Steps: 1 | Train Loss: 0.846 Vali Loss: 1.140 Vali Acc: 0.467 Test Loss: 1.140 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.5679688453674316
Epoch: 15, Steps: 1 | Train Loss: 0.764 Vali Loss: 1.146 Vali Acc: 0.467 Test Loss: 1.146 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.5526473522186279
Epoch: 16, Steps: 1 | Train Loss: 0.724 Vali Loss: 1.150 Vali Acc: 0.467 Test Loss: 1.150 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.5469791889190674
Epoch: 17, Steps: 1 | Train Loss: 0.709 Vali Loss: 1.155 Vali Acc: 0.400 Test Loss: 1.155 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.5402097702026367
Epoch: 18, Steps: 1 | Train Loss: 0.677 Vali Loss: 1.161 Vali Acc: 0.267 Test Loss: 1.161 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm16_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 375747
model size : 1.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm16_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.8945817947387695
Epoch: 1, Steps: 1 | Train Loss: 1.125 Vali Loss: 1.111 Vali Acc: 0.400 Test Loss: 1.111 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.9010531902313232
Epoch: 2, Steps: 1 | Train Loss: 1.191 Vali Loss: 1.101 Vali Acc: 0.333 Test Loss: 1.101 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8397126197814941
Epoch: 3, Steps: 1 | Train Loss: 1.048 Vali Loss: 1.095 Vali Acc: 0.333 Test Loss: 1.095 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0131142139434814
Epoch: 4, Steps: 1 | Train Loss: 1.066 Vali Loss: 1.090 Vali Acc: 0.333 Test Loss: 1.090 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.6961066722869873
Epoch: 5, Steps: 1 | Train Loss: 1.014 Vali Loss: 1.088 Vali Acc: 0.333 Test Loss: 1.088 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.7683539390563965
Epoch: 6, Steps: 1 | Train Loss: 0.959 Vali Loss: 1.087 Vali Acc: 0.267 Test Loss: 1.087 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.8467178344726562
Epoch: 7, Steps: 1 | Train Loss: 1.007 Vali Loss: 1.086 Vali Acc: 0.267 Test Loss: 1.086 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.8135721683502197
Epoch: 8, Steps: 1 | Train Loss: 0.931 Vali Loss: 1.087 Vali Acc: 0.333 Test Loss: 1.087 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.8489241600036621
Epoch: 9, Steps: 1 | Train Loss: 0.946 Vali Loss: 1.088 Vali Acc: 0.333 Test Loss: 1.088 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.8710458278656006
Epoch: 10, Steps: 1 | Train Loss: 0.875 Vali Loss: 1.090 Vali Acc: 0.333 Test Loss: 1.090 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.8740377426147461
Epoch: 11, Steps: 1 | Train Loss: 0.894 Vali Loss: 1.094 Vali Acc: 0.333 Test Loss: 1.094 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm16_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 617411
model size : 2.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm16_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.350984811782837
Epoch: 1, Steps: 1 | Train Loss: 1.193 Vali Loss: 1.167 Vali Acc: 0.267 Test Loss: 1.167 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.6623623371124268
Epoch: 2, Steps: 1 | Train Loss: 1.062 Vali Loss: 1.170 Vali Acc: 0.267 Test Loss: 1.170 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5996620655059814
Epoch: 3, Steps: 1 | Train Loss: 1.102 Vali Loss: 1.173 Vali Acc: 0.267 Test Loss: 1.173 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6070418357849121
Epoch: 4, Steps: 1 | Train Loss: 1.013 Vali Loss: 1.176 Vali Acc: 0.267 Test Loss: 1.176 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.6805615425109863
Epoch: 5, Steps: 1 | Train Loss: 0.957 Vali Loss: 1.179 Vali Acc: 0.267 Test Loss: 1.179 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5580627918243408
Epoch: 6, Steps: 1 | Train Loss: 1.044 Vali Loss: 1.182 Vali Acc: 0.267 Test Loss: 1.182 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.5950055122375488
Epoch: 7, Steps: 1 | Train Loss: 1.017 Vali Loss: 1.186 Vali Acc: 0.267 Test Loss: 1.186 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.6769659519195557
Epoch: 8, Steps: 1 | Train Loss: 0.955 Vali Loss: 1.191 Vali Acc: 0.267 Test Loss: 1.191 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.6705617904663086
Epoch: 9, Steps: 1 | Train Loss: 0.935 Vali Loss: 1.197 Vali Acc: 0.333 Test Loss: 1.197 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333321).  Saving model ...
Epoch: 10 cost time: 0.6547801494598389
Epoch: 10, Steps: 1 | Train Loss: 0.879 Vali Loss: 1.204 Vali Acc: 0.333 Test Loss: 1.204 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6596107482910156
Epoch: 11, Steps: 1 | Train Loss: 0.831 Vali Loss: 1.212 Vali Acc: 0.333 Test Loss: 1.212 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.6581144332885742
Epoch: 12, Steps: 1 | Train Loss: 0.807 Vali Loss: 1.221 Vali Acc: 0.333 Test Loss: 1.221 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.6866743564605713
Epoch: 13, Steps: 1 | Train Loss: 0.733 Vali Loss: 1.231 Vali Acc: 0.333 Test Loss: 1.231 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.6435039043426514
Epoch: 14, Steps: 1 | Train Loss: 0.682 Vali Loss: 1.243 Vali Acc: 0.333 Test Loss: 1.243 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.7760941982269287
Epoch: 15, Steps: 1 | Train Loss: 0.675 Vali Loss: 1.255 Vali Acc: 0.333 Test Loss: 1.255 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.6209228038787842
Epoch: 16, Steps: 1 | Train Loss: 0.574 Vali Loss: 1.269 Vali Acc: 0.333 Test Loss: 1.269 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.6046645641326904
Epoch: 17, Steps: 1 | Train Loss: 0.571 Vali Loss: 1.283 Vali Acc: 0.333 Test Loss: 1.283 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.5966899394989014
Epoch: 18, Steps: 1 | Train Loss: 0.543 Vali Loss: 1.299 Vali Acc: 0.333 Test Loss: 1.299 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.5769922733306885
Epoch: 19, Steps: 1 | Train Loss: 0.474 Vali Loss: 1.315 Vali Acc: 0.333 Test Loss: 1.315 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm16_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 203459
model size : 1.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm16_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.7198657989501953
Epoch: 1, Steps: 1 | Train Loss: 1.135 Vali Loss: 1.111 Vali Acc: 0.400 Test Loss: 1.111 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.7175819873809814
Epoch: 2, Steps: 1 | Train Loss: 1.196 Vali Loss: 1.101 Vali Acc: 0.333 Test Loss: 1.101 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7744176387786865
Epoch: 3, Steps: 1 | Train Loss: 1.050 Vali Loss: 1.095 Vali Acc: 0.333 Test Loss: 1.095 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8426384925842285
Epoch: 4, Steps: 1 | Train Loss: 1.073 Vali Loss: 1.090 Vali Acc: 0.333 Test Loss: 1.090 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7992148399353027
Epoch: 5, Steps: 1 | Train Loss: 1.017 Vali Loss: 1.088 Vali Acc: 0.267 Test Loss: 1.088 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.7360188961029053
Epoch: 6, Steps: 1 | Train Loss: 0.962 Vali Loss: 1.087 Vali Acc: 0.267 Test Loss: 1.087 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.7268421649932861
Epoch: 7, Steps: 1 | Train Loss: 1.016 Vali Loss: 1.086 Vali Acc: 0.267 Test Loss: 1.086 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.7460546493530273
Epoch: 8, Steps: 1 | Train Loss: 0.932 Vali Loss: 1.087 Vali Acc: 0.333 Test Loss: 1.087 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.7073063850402832
Epoch: 9, Steps: 1 | Train Loss: 0.951 Vali Loss: 1.089 Vali Acc: 0.333 Test Loss: 1.089 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.7834451198577881
Epoch: 10, Steps: 1 | Train Loss: 0.862 Vali Loss: 1.091 Vali Acc: 0.333 Test Loss: 1.091 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.8391578197479248
Epoch: 11, Steps: 1 | Train Loss: 0.901 Vali Loss: 1.095 Vali Acc: 0.333 Test Loss: 1.095 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm16_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 617411
model size : 2.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm16_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.3228204250335693
Epoch: 1, Steps: 1 | Train Loss: 1.168 Vali Loss: 1.158 Vali Acc: 0.267 Test Loss: 1.158 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.5078723430633545
Epoch: 2, Steps: 1 | Train Loss: 1.045 Vali Loss: 1.161 Vali Acc: 0.267 Test Loss: 1.161 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5583486557006836
Epoch: 3, Steps: 1 | Train Loss: 1.086 Vali Loss: 1.164 Vali Acc: 0.267 Test Loss: 1.164 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5870344638824463
Epoch: 4, Steps: 1 | Train Loss: 1.000 Vali Loss: 1.167 Vali Acc: 0.267 Test Loss: 1.167 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5460991859436035
Epoch: 5, Steps: 1 | Train Loss: 0.944 Vali Loss: 1.170 Vali Acc: 0.267 Test Loss: 1.170 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5542430877685547
Epoch: 6, Steps: 1 | Train Loss: 1.028 Vali Loss: 1.173 Vali Acc: 0.267 Test Loss: 1.173 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.5663573741912842
Epoch: 7, Steps: 1 | Train Loss: 1.007 Vali Loss: 1.177 Vali Acc: 0.267 Test Loss: 1.177 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.5186593532562256
Epoch: 8, Steps: 1 | Train Loss: 0.940 Vali Loss: 1.181 Vali Acc: 0.267 Test Loss: 1.181 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.6319029331207275
Epoch: 9, Steps: 1 | Train Loss: 0.921 Vali Loss: 1.187 Vali Acc: 0.333 Test Loss: 1.187 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333321).  Saving model ...
Epoch: 10 cost time: 0.640592098236084
Epoch: 10, Steps: 1 | Train Loss: 0.880 Vali Loss: 1.194 Vali Acc: 0.333 Test Loss: 1.194 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.5818057060241699
Epoch: 11, Steps: 1 | Train Loss: 0.828 Vali Loss: 1.202 Vali Acc: 0.333 Test Loss: 1.202 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.6192097663879395
Epoch: 12, Steps: 1 | Train Loss: 0.808 Vali Loss: 1.211 Vali Acc: 0.333 Test Loss: 1.211 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.5833861827850342
Epoch: 13, Steps: 1 | Train Loss: 0.730 Vali Loss: 1.221 Vali Acc: 0.333 Test Loss: 1.221 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.5381991863250732
Epoch: 14, Steps: 1 | Train Loss: 0.675 Vali Loss: 1.233 Vali Acc: 0.333 Test Loss: 1.233 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.5972614288330078
Epoch: 15, Steps: 1 | Train Loss: 0.674 Vali Loss: 1.246 Vali Acc: 0.333 Test Loss: 1.246 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.5367014408111572
Epoch: 16, Steps: 1 | Train Loss: 0.579 Vali Loss: 1.259 Vali Acc: 0.333 Test Loss: 1.259 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.5285017490386963
Epoch: 17, Steps: 1 | Train Loss: 0.572 Vali Loss: 1.274 Vali Acc: 0.333 Test Loss: 1.274 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.5849738121032715
Epoch: 18, Steps: 1 | Train Loss: 0.544 Vali Loss: 1.290 Vali Acc: 0.333 Test Loss: 1.290 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.5941355228424072
Epoch: 19, Steps: 1 | Train Loss: 0.474 Vali Loss: 1.306 Vali Acc: 0.333 Test Loss: 1.306 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm16_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 203459
model size : 1.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm16_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.3877553939819336
Epoch: 1, Steps: 1 | Train Loss: 1.137 Vali Loss: 1.091 Vali Acc: 0.467 Test Loss: 1.091 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.6615638732910156
Epoch: 2, Steps: 1 | Train Loss: 1.201 Vali Loss: 1.080 Vali Acc: 0.400 Test Loss: 1.080 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6431534290313721
Epoch: 3, Steps: 1 | Train Loss: 1.055 Vali Loss: 1.073 Vali Acc: 0.400 Test Loss: 1.073 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6471107006072998
Epoch: 4, Steps: 1 | Train Loss: 1.074 Vali Loss: 1.069 Vali Acc: 0.400 Test Loss: 1.069 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7008376121520996
Epoch: 5, Steps: 1 | Train Loss: 1.022 Vali Loss: 1.066 Vali Acc: 0.333 Test Loss: 1.066 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.6889686584472656
Epoch: 6, Steps: 1 | Train Loss: 0.970 Vali Loss: 1.065 Vali Acc: 0.333 Test Loss: 1.065 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.7176868915557861
Epoch: 7, Steps: 1 | Train Loss: 1.020 Vali Loss: 1.064 Vali Acc: 0.400 Test Loss: 1.064 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.6467390060424805
Epoch: 8, Steps: 1 | Train Loss: 0.936 Vali Loss: 1.065 Vali Acc: 0.400 Test Loss: 1.065 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.7371687889099121
Epoch: 9, Steps: 1 | Train Loss: 0.956 Vali Loss: 1.067 Vali Acc: 0.400 Test Loss: 1.067 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.6919510364532471
Epoch: 10, Steps: 1 | Train Loss: 0.867 Vali Loss: 1.069 Vali Acc: 0.400 Test Loss: 1.069 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.6162900924682617
Epoch: 11, Steps: 1 | Train Loss: 0.908 Vali Loss: 1.073 Vali Acc: 0.400 Test Loss: 1.073 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm16_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 617411
model size : 2.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm16_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.1351351737976074
Epoch: 1, Steps: 1 | Train Loss: 1.169 Vali Loss: 1.140 Vali Acc: 0.267 Test Loss: 1.140 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.6112618446350098
Epoch: 2, Steps: 1 | Train Loss: 1.038 Vali Loss: 1.143 Vali Acc: 0.333 Test Loss: 1.143 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.5684061050415039
Epoch: 3, Steps: 1 | Train Loss: 1.093 Vali Loss: 1.147 Vali Acc: 0.333 Test Loss: 1.147 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.4991888999938965
Epoch: 4, Steps: 1 | Train Loss: 0.997 Vali Loss: 1.151 Vali Acc: 0.333 Test Loss: 1.151 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.5180869102478027
Epoch: 5, Steps: 1 | Train Loss: 0.951 Vali Loss: 1.155 Vali Acc: 0.333 Test Loss: 1.155 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.6021757125854492
Epoch: 6, Steps: 1 | Train Loss: 1.031 Vali Loss: 1.158 Vali Acc: 0.333 Test Loss: 1.158 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.5453004837036133
Epoch: 7, Steps: 1 | Train Loss: 1.014 Vali Loss: 1.163 Vali Acc: 0.333 Test Loss: 1.163 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.45999860763549805
Epoch: 8, Steps: 1 | Train Loss: 0.945 Vali Loss: 1.169 Vali Acc: 0.267 Test Loss: 1.169 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.4369621276855469
Epoch: 9, Steps: 1 | Train Loss: 0.922 Vali Loss: 1.176 Vali Acc: 0.333 Test Loss: 1.176 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.46260643005371094
Epoch: 10, Steps: 1 | Train Loss: 0.882 Vali Loss: 1.184 Vali Acc: 0.333 Test Loss: 1.184 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.4884974956512451
Epoch: 11, Steps: 1 | Train Loss: 0.836 Vali Loss: 1.193 Vali Acc: 0.333 Test Loss: 1.193 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.48261022567749023
Epoch: 12, Steps: 1 | Train Loss: 0.814 Vali Loss: 1.204 Vali Acc: 0.333 Test Loss: 1.204 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm16_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 203459
model size : 1.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm8_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 3.4371352195739746
Epoch: 1, Steps: 1 | Train Loss: 1.142 Vali Loss: 1.208 Vali Acc: 0.267 Test Loss: 1.208 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 1.1529090404510498
Epoch: 2, Steps: 1 | Train Loss: 1.126 Vali Loss: 1.197 Vali Acc: 0.333 Test Loss: 1.197 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 1.1681933403015137
Epoch: 3, Steps: 1 | Train Loss: 1.081 Vali Loss: 1.188 Vali Acc: 0.267 Test Loss: 1.188 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2121460437774658
Epoch: 4, Steps: 1 | Train Loss: 1.053 Vali Loss: 1.182 Vali Acc: 0.267 Test Loss: 1.182 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.1160039901733398
Epoch: 5, Steps: 1 | Train Loss: 1.034 Vali Loss: 1.177 Vali Acc: 0.200 Test Loss: 1.177 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.1826705932617188
Epoch: 6, Steps: 1 | Train Loss: 1.009 Vali Loss: 1.178 Vali Acc: 0.200 Test Loss: 1.178 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.961857795715332
Epoch: 7, Steps: 1 | Train Loss: 1.011 Vali Loss: 1.178 Vali Acc: 0.200 Test Loss: 1.178 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.1152517795562744
Epoch: 8, Steps: 1 | Train Loss: 0.981 Vali Loss: 1.180 Vali Acc: 0.200 Test Loss: 1.180 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.087937355041504
Epoch: 9, Steps: 1 | Train Loss: 1.011 Vali Loss: 1.181 Vali Acc: 0.333 Test Loss: 1.181 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 10 cost time: 1.1075160503387451
Epoch: 10, Steps: 1 | Train Loss: 0.956 Vali Loss: 1.183 Vali Acc: 0.333 Test Loss: 1.183 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0305347442626953
Epoch: 11, Steps: 1 | Train Loss: 0.984 Vali Loss: 1.186 Vali Acc: 0.333 Test Loss: 1.186 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9827401638031006
Epoch: 12, Steps: 1 | Train Loss: 0.917 Vali Loss: 1.189 Vali Acc: 0.333 Test Loss: 1.189 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.1079983711242676
Epoch: 13, Steps: 1 | Train Loss: 0.845 Vali Loss: 1.194 Vali Acc: 0.333 Test Loss: 1.194 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.120438575744629
Epoch: 14, Steps: 1 | Train Loss: 0.868 Vali Loss: 1.199 Vali Acc: 0.333 Test Loss: 1.199 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.1571357250213623
Epoch: 15, Steps: 1 | Train Loss: 0.782 Vali Loss: 1.206 Vali Acc: 0.333 Test Loss: 1.206 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.081183910369873
Epoch: 16, Steps: 1 | Train Loss: 0.783 Vali Loss: 1.214 Vali Acc: 0.333 Test Loss: 1.214 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.9972224235534668
Epoch: 17, Steps: 1 | Train Loss: 0.806 Vali Loss: 1.222 Vali Acc: 0.333 Test Loss: 1.222 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.104992151260376
Epoch: 18, Steps: 1 | Train Loss: 0.766 Vali Loss: 1.230 Vali Acc: 0.333 Test Loss: 1.230 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.1143834590911865
Epoch: 19, Steps: 1 | Train Loss: 0.746 Vali Loss: 1.237 Vali Acc: 0.333 Test Loss: 1.237 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm8_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 1188643
model size : 4.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm8_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.5365681648254395
Epoch: 1, Steps: 1 | Train Loss: 1.132 Vali Loss: 1.071 Vali Acc: 0.533 Test Loss: 1.071 Test Acc: 0.533
Validation loss decreased (inf --> -0.533323).  Saving model ...
Epoch: 2 cost time: 0.6496405601501465
Epoch: 2, Steps: 1 | Train Loss: 1.082 Vali Loss: 1.071 Vali Acc: 0.600 Test Loss: 1.071 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599989).  Saving model ...
Epoch: 3 cost time: 0.6429553031921387
Epoch: 3, Steps: 1 | Train Loss: 1.075 Vali Loss: 1.072 Vali Acc: 0.533 Test Loss: 1.072 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6601822376251221
Epoch: 4, Steps: 1 | Train Loss: 0.988 Vali Loss: 1.074 Vali Acc: 0.467 Test Loss: 1.074 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.6418178081512451
Epoch: 5, Steps: 1 | Train Loss: 1.009 Vali Loss: 1.075 Vali Acc: 0.467 Test Loss: 1.075 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.6979007720947266
Epoch: 6, Steps: 1 | Train Loss: 1.003 Vali Loss: 1.076 Vali Acc: 0.467 Test Loss: 1.076 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.698436975479126
Epoch: 7, Steps: 1 | Train Loss: 1.024 Vali Loss: 1.077 Vali Acc: 0.400 Test Loss: 1.077 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.6485073566436768
Epoch: 8, Steps: 1 | Train Loss: 1.021 Vali Loss: 1.078 Vali Acc: 0.400 Test Loss: 1.078 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.7085616588592529
Epoch: 9, Steps: 1 | Train Loss: 1.001 Vali Loss: 1.080 Vali Acc: 0.400 Test Loss: 1.080 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.7038407325744629
Epoch: 10, Steps: 1 | Train Loss: 0.924 Vali Loss: 1.082 Vali Acc: 0.400 Test Loss: 1.082 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.6388096809387207
Epoch: 11, Steps: 1 | Train Loss: 0.910 Vali Loss: 1.083 Vali Acc: 0.400 Test Loss: 1.083 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.7586135864257812
Epoch: 12, Steps: 1 | Train Loss: 0.966 Vali Loss: 1.085 Vali Acc: 0.400 Test Loss: 1.085 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm8_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 360675
model size : 1.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm8_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.999739408493042
Epoch: 1, Steps: 1 | Train Loss: 1.148 Vali Loss: 1.201 Vali Acc: 0.267 Test Loss: 1.201 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.857062578201294
Epoch: 2, Steps: 1 | Train Loss: 1.121 Vali Loss: 1.190 Vali Acc: 0.333 Test Loss: 1.190 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 0.8140077590942383
Epoch: 3, Steps: 1 | Train Loss: 1.081 Vali Loss: 1.181 Vali Acc: 0.267 Test Loss: 1.181 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8166215419769287
Epoch: 4, Steps: 1 | Train Loss: 1.051 Vali Loss: 1.175 Vali Acc: 0.267 Test Loss: 1.175 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.7663030624389648
Epoch: 5, Steps: 1 | Train Loss: 1.032 Vali Loss: 1.170 Vali Acc: 0.200 Test Loss: 1.170 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.8993961811065674
Epoch: 6, Steps: 1 | Train Loss: 1.001 Vali Loss: 1.171 Vali Acc: 0.200 Test Loss: 1.171 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.8383438587188721
Epoch: 7, Steps: 1 | Train Loss: 1.009 Vali Loss: 1.171 Vali Acc: 0.200 Test Loss: 1.171 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.8229005336761475
Epoch: 8, Steps: 1 | Train Loss: 0.975 Vali Loss: 1.173 Vali Acc: 0.200 Test Loss: 1.173 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.8395698070526123
Epoch: 9, Steps: 1 | Train Loss: 1.005 Vali Loss: 1.175 Vali Acc: 0.333 Test Loss: 1.175 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 10 cost time: 0.8262984752655029
Epoch: 10, Steps: 1 | Train Loss: 0.960 Vali Loss: 1.178 Vali Acc: 0.333 Test Loss: 1.178 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.81685471534729
Epoch: 11, Steps: 1 | Train Loss: 0.980 Vali Loss: 1.181 Vali Acc: 0.333 Test Loss: 1.181 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9096136093139648
Epoch: 12, Steps: 1 | Train Loss: 0.914 Vali Loss: 1.185 Vali Acc: 0.333 Test Loss: 1.185 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.9237873554229736
Epoch: 13, Steps: 1 | Train Loss: 0.842 Vali Loss: 1.190 Vali Acc: 0.333 Test Loss: 1.190 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.8882670402526855
Epoch: 14, Steps: 1 | Train Loss: 0.865 Vali Loss: 1.196 Vali Acc: 0.333 Test Loss: 1.196 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.8737587928771973
Epoch: 15, Steps: 1 | Train Loss: 0.778 Vali Loss: 1.203 Vali Acc: 0.333 Test Loss: 1.203 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.9254283905029297
Epoch: 16, Steps: 1 | Train Loss: 0.789 Vali Loss: 1.212 Vali Acc: 0.333 Test Loss: 1.212 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.9389386177062988
Epoch: 17, Steps: 1 | Train Loss: 0.803 Vali Loss: 1.221 Vali Acc: 0.333 Test Loss: 1.221 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.8826401233673096
Epoch: 18, Steps: 1 | Train Loss: 0.759 Vali Loss: 1.231 Vali Acc: 0.333 Test Loss: 1.231 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.9438974857330322
Epoch: 19, Steps: 1 | Train Loss: 0.734 Vali Loss: 1.242 Vali Acc: 0.333 Test Loss: 1.242 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm8_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 1188643
model size : 4.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm8_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.446653366088867
Epoch: 1, Steps: 1 | Train Loss: 1.137 Vali Loss: 1.076 Vali Acc: 0.533 Test Loss: 1.076 Test Acc: 0.533
Validation loss decreased (inf --> -0.533323).  Saving model ...
Epoch: 2 cost time: 0.594735860824585
Epoch: 2, Steps: 1 | Train Loss: 1.087 Vali Loss: 1.076 Vali Acc: 0.600 Test Loss: 1.076 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599989).  Saving model ...
Epoch: 3 cost time: 0.563779354095459
Epoch: 3, Steps: 1 | Train Loss: 1.089 Vali Loss: 1.077 Vali Acc: 0.533 Test Loss: 1.077 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7280621528625488
Epoch: 4, Steps: 1 | Train Loss: 0.999 Vali Loss: 1.079 Vali Acc: 0.467 Test Loss: 1.079 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.6487352848052979
Epoch: 5, Steps: 1 | Train Loss: 1.029 Vali Loss: 1.081 Vali Acc: 0.467 Test Loss: 1.081 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.6031818389892578
Epoch: 6, Steps: 1 | Train Loss: 1.006 Vali Loss: 1.082 Vali Acc: 0.467 Test Loss: 1.082 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.5705530643463135
Epoch: 7, Steps: 1 | Train Loss: 1.042 Vali Loss: 1.083 Vali Acc: 0.467 Test Loss: 1.083 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.6679573059082031
Epoch: 8, Steps: 1 | Train Loss: 1.050 Vali Loss: 1.085 Vali Acc: 0.467 Test Loss: 1.085 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.5862047672271729
Epoch: 9, Steps: 1 | Train Loss: 1.009 Vali Loss: 1.087 Vali Acc: 0.400 Test Loss: 1.087 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.6417522430419922
Epoch: 10, Steps: 1 | Train Loss: 0.942 Vali Loss: 1.090 Vali Acc: 0.400 Test Loss: 1.090 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.5781915187835693
Epoch: 11, Steps: 1 | Train Loss: 0.921 Vali Loss: 1.092 Vali Acc: 0.400 Test Loss: 1.092 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.6717092990875244
Epoch: 12, Steps: 1 | Train Loss: 0.974 Vali Loss: 1.095 Vali Acc: 0.400 Test Loss: 1.095 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm8_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 360675
model size : 1.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm8_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.5523760318756104
Epoch: 1, Steps: 1 | Train Loss: 1.165 Vali Loss: 1.184 Vali Acc: 0.267 Test Loss: 1.184 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.6539738178253174
Epoch: 2, Steps: 1 | Train Loss: 1.128 Vali Loss: 1.172 Vali Acc: 0.333 Test Loss: 1.172 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.6264562606811523
Epoch: 3, Steps: 1 | Train Loss: 1.090 Vali Loss: 1.164 Vali Acc: 0.333 Test Loss: 1.164 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.5964059829711914
Epoch: 4, Steps: 1 | Train Loss: 1.057 Vali Loss: 1.157 Vali Acc: 0.267 Test Loss: 1.157 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7303082942962646
Epoch: 5, Steps: 1 | Train Loss: 1.042 Vali Loss: 1.153 Vali Acc: 0.200 Test Loss: 1.153 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.7301809787750244
Epoch: 6, Steps: 1 | Train Loss: 1.012 Vali Loss: 1.152 Vali Acc: 0.200 Test Loss: 1.152 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.6025269031524658
Epoch: 7, Steps: 1 | Train Loss: 1.023 Vali Loss: 1.150 Vali Acc: 0.200 Test Loss: 1.150 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.6683192253112793
Epoch: 8, Steps: 1 | Train Loss: 0.996 Vali Loss: 1.149 Vali Acc: 0.200 Test Loss: 1.149 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.5966143608093262
Epoch: 9, Steps: 1 | Train Loss: 1.029 Vali Loss: 1.149 Vali Acc: 0.333 Test Loss: 1.149 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 10 cost time: 0.6122708320617676
Epoch: 10, Steps: 1 | Train Loss: 0.980 Vali Loss: 1.149 Vali Acc: 0.333 Test Loss: 1.149 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 11 cost time: 0.6129255294799805
Epoch: 11, Steps: 1 | Train Loss: 1.009 Vali Loss: 1.149 Vali Acc: 0.333 Test Loss: 1.149 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5712566375732422
Epoch: 12, Steps: 1 | Train Loss: 0.953 Vali Loss: 1.150 Vali Acc: 0.333 Test Loss: 1.150 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.6290390491485596
Epoch: 13, Steps: 1 | Train Loss: 0.884 Vali Loss: 1.151 Vali Acc: 0.333 Test Loss: 1.151 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.6030466556549072
Epoch: 14, Steps: 1 | Train Loss: 0.911 Vali Loss: 1.153 Vali Acc: 0.333 Test Loss: 1.153 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.6312758922576904
Epoch: 15, Steps: 1 | Train Loss: 0.822 Vali Loss: 1.155 Vali Acc: 0.333 Test Loss: 1.155 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.6467599868774414
Epoch: 16, Steps: 1 | Train Loss: 0.855 Vali Loss: 1.158 Vali Acc: 0.333 Test Loss: 1.158 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.591116189956665
Epoch: 17, Steps: 1 | Train Loss: 0.873 Vali Loss: 1.162 Vali Acc: 0.333 Test Loss: 1.162 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.6532025337219238
Epoch: 18, Steps: 1 | Train Loss: 0.823 Vali Loss: 1.166 Vali Acc: 0.333 Test Loss: 1.166 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.6394970417022705
Epoch: 19, Steps: 1 | Train Loss: 0.806 Vali Loss: 1.170 Vali Acc: 0.333 Test Loss: 1.170 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.6638908386230469
Epoch: 20, Steps: 1 | Train Loss: 0.782 Vali Loss: 1.176 Vali Acc: 0.267 Test Loss: 1.176 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm8_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 1188643
model size : 4.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm8_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.305633068084717
Epoch: 1, Steps: 1 | Train Loss: 1.145 Vali Loss: 1.093 Vali Acc: 0.333 Test Loss: 1.093 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.6178674697875977
Epoch: 2, Steps: 1 | Train Loss: 1.094 Vali Loss: 1.094 Vali Acc: 0.333 Test Loss: 1.094 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5507903099060059
Epoch: 3, Steps: 1 | Train Loss: 1.079 Vali Loss: 1.095 Vali Acc: 0.400 Test Loss: 1.095 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.5619692802429199
Epoch: 4, Steps: 1 | Train Loss: 0.994 Vali Loss: 1.096 Vali Acc: 0.400 Test Loss: 1.096 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5818414688110352
Epoch: 5, Steps: 1 | Train Loss: 1.030 Vali Loss: 1.098 Vali Acc: 0.400 Test Loss: 1.098 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.5776817798614502
Epoch: 6, Steps: 1 | Train Loss: 1.015 Vali Loss: 1.098 Vali Acc: 0.400 Test Loss: 1.098 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.5431902408599854
Epoch: 7, Steps: 1 | Train Loss: 1.036 Vali Loss: 1.099 Vali Acc: 0.333 Test Loss: 1.099 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.5780136585235596
Epoch: 8, Steps: 1 | Train Loss: 1.067 Vali Loss: 1.100 Vali Acc: 0.333 Test Loss: 1.100 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.5438594818115234
Epoch: 9, Steps: 1 | Train Loss: 1.013 Vali Loss: 1.100 Vali Acc: 0.333 Test Loss: 1.100 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.6621966361999512
Epoch: 10, Steps: 1 | Train Loss: 0.967 Vali Loss: 1.101 Vali Acc: 0.333 Test Loss: 1.101 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.7247357368469238
Epoch: 11, Steps: 1 | Train Loss: 0.934 Vali Loss: 1.102 Vali Acc: 0.400 Test Loss: 1.102 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.6428279876708984
Epoch: 12, Steps: 1 | Train Loss: 1.012 Vali Loss: 1.103 Vali Acc: 0.400 Test Loss: 1.103 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.6212189197540283
Epoch: 13, Steps: 1 | Train Loss: 0.931 Vali Loss: 1.104 Vali Acc: 0.400 Test Loss: 1.104 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm8_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 360675
model size : 1.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm8_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.9032487869262695
Epoch: 1, Steps: 1 | Train Loss: 1.063 Vali Loss: 1.097 Vali Acc: 0.467 Test Loss: 1.097 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.8548986911773682
Epoch: 2, Steps: 1 | Train Loss: 1.090 Vali Loss: 1.096 Vali Acc: 0.400 Test Loss: 1.096 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7964036464691162
Epoch: 3, Steps: 1 | Train Loss: 1.070 Vali Loss: 1.096 Vali Acc: 0.400 Test Loss: 1.096 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.913386344909668
Epoch: 4, Steps: 1 | Train Loss: 1.000 Vali Loss: 1.095 Vali Acc: 0.467 Test Loss: 1.095 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 0.886864185333252
Epoch: 5, Steps: 1 | Train Loss: 1.036 Vali Loss: 1.095 Vali Acc: 0.467 Test Loss: 1.095 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 6 cost time: 0.8676133155822754
Epoch: 6, Steps: 1 | Train Loss: 1.003 Vali Loss: 1.096 Vali Acc: 0.467 Test Loss: 1.096 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7985773086547852
Epoch: 7, Steps: 1 | Train Loss: 1.018 Vali Loss: 1.096 Vali Acc: 0.467 Test Loss: 1.096 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.7195377349853516
Epoch: 8, Steps: 1 | Train Loss: 1.032 Vali Loss: 1.097 Vali Acc: 0.467 Test Loss: 1.097 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.7021613121032715
Epoch: 9, Steps: 1 | Train Loss: 0.941 Vali Loss: 1.098 Vali Acc: 0.467 Test Loss: 1.098 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.9086096286773682
Epoch: 10, Steps: 1 | Train Loss: 0.913 Vali Loss: 1.099 Vali Acc: 0.533 Test Loss: 1.099 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 11 cost time: 0.8217461109161377
Epoch: 11, Steps: 1 | Train Loss: 0.921 Vali Loss: 1.101 Vali Acc: 0.533 Test Loss: 1.101 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8196465969085693
Epoch: 12, Steps: 1 | Train Loss: 0.894 Vali Loss: 1.102 Vali Acc: 0.533 Test Loss: 1.102 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.0047104358673096
Epoch: 13, Steps: 1 | Train Loss: 0.882 Vali Loss: 1.104 Vali Acc: 0.600 Test Loss: 1.104 Test Acc: 0.600
Validation loss decreased (-0.533322 --> -0.599989).  Saving model ...
Epoch: 14 cost time: 0.8636643886566162
Epoch: 14, Steps: 1 | Train Loss: 0.814 Vali Loss: 1.106 Vali Acc: 0.600 Test Loss: 1.106 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0036828517913818
Epoch: 15, Steps: 1 | Train Loss: 0.818 Vali Loss: 1.107 Vali Acc: 0.600 Test Loss: 1.107 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.8854095935821533
Epoch: 16, Steps: 1 | Train Loss: 0.799 Vali Loss: 1.109 Vali Acc: 0.600 Test Loss: 1.109 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.8368091583251953
Epoch: 17, Steps: 1 | Train Loss: 0.735 Vali Loss: 1.111 Vali Acc: 0.600 Test Loss: 1.111 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.9472072124481201
Epoch: 18, Steps: 1 | Train Loss: 0.743 Vali Loss: 1.113 Vali Acc: 0.533 Test Loss: 1.113 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.8700392246246338
Epoch: 19, Steps: 1 | Train Loss: 0.704 Vali Loss: 1.115 Vali Acc: 0.533 Test Loss: 1.115 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.8426957130432129
Epoch: 20, Steps: 1 | Train Loss: 0.639 Vali Loss: 1.117 Vali Acc: 0.533 Test Loss: 1.117 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.8526332378387451
Epoch: 21, Steps: 1 | Train Loss: 0.637 Vali Loss: 1.119 Vali Acc: 0.467 Test Loss: 1.119 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.8308656215667725
Epoch: 22, Steps: 1 | Train Loss: 0.632 Vali Loss: 1.121 Vali Acc: 0.467 Test Loss: 1.121 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.8199353218078613
Epoch: 23, Steps: 1 | Train Loss: 0.591 Vali Loss: 1.123 Vali Acc: 0.400 Test Loss: 1.123 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm8_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 602147
model size : 2.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm8_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.588939905166626
Epoch: 1, Steps: 1 | Train Loss: 1.035 Vali Loss: 1.177 Vali Acc: 0.267 Test Loss: 1.177 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.5865020751953125
Epoch: 2, Steps: 1 | Train Loss: 1.080 Vali Loss: 1.172 Vali Acc: 0.267 Test Loss: 1.172 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.6413788795471191
Epoch: 3, Steps: 1 | Train Loss: 1.142 Vali Loss: 1.169 Vali Acc: 0.200 Test Loss: 1.169 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5980291366577148
Epoch: 4, Steps: 1 | Train Loss: 1.055 Vali Loss: 1.166 Vali Acc: 0.133 Test Loss: 1.166 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.6779625415802002
Epoch: 5, Steps: 1 | Train Loss: 1.060 Vali Loss: 1.165 Vali Acc: 0.067 Test Loss: 1.165 Test Acc: 0.067
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.6328558921813965
Epoch: 6, Steps: 1 | Train Loss: 0.947 Vali Loss: 1.164 Vali Acc: 0.067 Test Loss: 1.164 Test Acc: 0.067
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.5761363506317139
Epoch: 7, Steps: 1 | Train Loss: 1.007 Vali Loss: 1.163 Vali Acc: 0.067 Test Loss: 1.163 Test Acc: 0.067
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.6063010692596436
Epoch: 8, Steps: 1 | Train Loss: 0.982 Vali Loss: 1.162 Vali Acc: 0.067 Test Loss: 1.162 Test Acc: 0.067
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.5861372947692871
Epoch: 9, Steps: 1 | Train Loss: 1.019 Vali Loss: 1.161 Vali Acc: 0.067 Test Loss: 1.161 Test Acc: 0.067
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.624182939529419
Epoch: 10, Steps: 1 | Train Loss: 0.981 Vali Loss: 1.160 Vali Acc: 0.067 Test Loss: 1.160 Test Acc: 0.067
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.6098804473876953
Epoch: 11, Steps: 1 | Train Loss: 0.998 Vali Loss: 1.158 Vali Acc: 0.067 Test Loss: 1.158 Test Acc: 0.067
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.5849080085754395
Epoch: 12, Steps: 1 | Train Loss: 0.969 Vali Loss: 1.157 Vali Acc: 0.067 Test Loss: 1.157 Test Acc: 0.067
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm8_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 188131
model size : 0.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm8_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.7362003326416016
Epoch: 1, Steps: 1 | Train Loss: 1.058 Vali Loss: 1.100 Vali Acc: 0.400 Test Loss: 1.100 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.6779282093048096
Epoch: 2, Steps: 1 | Train Loss: 1.084 Vali Loss: 1.099 Vali Acc: 0.400 Test Loss: 1.099 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.7490394115447998
Epoch: 3, Steps: 1 | Train Loss: 1.065 Vali Loss: 1.098 Vali Acc: 0.400 Test Loss: 1.098 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.7401249408721924
Epoch: 4, Steps: 1 | Train Loss: 1.001 Vali Loss: 1.098 Vali Acc: 0.467 Test Loss: 1.098 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 0.7259774208068848
Epoch: 5, Steps: 1 | Train Loss: 1.033 Vali Loss: 1.098 Vali Acc: 0.467 Test Loss: 1.098 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 6 cost time: 0.6713502407073975
Epoch: 6, Steps: 1 | Train Loss: 0.998 Vali Loss: 1.098 Vali Acc: 0.467 Test Loss: 1.098 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7668921947479248
Epoch: 7, Steps: 1 | Train Loss: 1.015 Vali Loss: 1.098 Vali Acc: 0.467 Test Loss: 1.098 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.7201623916625977
Epoch: 8, Steps: 1 | Train Loss: 1.029 Vali Loss: 1.099 Vali Acc: 0.467 Test Loss: 1.099 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.6755225658416748
Epoch: 9, Steps: 1 | Train Loss: 0.938 Vali Loss: 1.100 Vali Acc: 0.467 Test Loss: 1.100 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.6602625846862793
Epoch: 10, Steps: 1 | Train Loss: 0.911 Vali Loss: 1.100 Vali Acc: 0.533 Test Loss: 1.100 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 11 cost time: 0.6740927696228027
Epoch: 11, Steps: 1 | Train Loss: 0.919 Vali Loss: 1.101 Vali Acc: 0.533 Test Loss: 1.101 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7151577472686768
Epoch: 12, Steps: 1 | Train Loss: 0.896 Vali Loss: 1.103 Vali Acc: 0.533 Test Loss: 1.103 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.760751485824585
Epoch: 13, Steps: 1 | Train Loss: 0.880 Vali Loss: 1.104 Vali Acc: 0.600 Test Loss: 1.104 Test Acc: 0.600
Validation loss decreased (-0.533322 --> -0.599989).  Saving model ...
Epoch: 14 cost time: 0.7994492053985596
Epoch: 14, Steps: 1 | Train Loss: 0.815 Vali Loss: 1.106 Vali Acc: 0.600 Test Loss: 1.106 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7121098041534424
Epoch: 15, Steps: 1 | Train Loss: 0.818 Vali Loss: 1.108 Vali Acc: 0.600 Test Loss: 1.108 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.6877303123474121
Epoch: 16, Steps: 1 | Train Loss: 0.798 Vali Loss: 1.110 Vali Acc: 0.600 Test Loss: 1.110 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.7871181964874268
Epoch: 17, Steps: 1 | Train Loss: 0.735 Vali Loss: 1.111 Vali Acc: 0.533 Test Loss: 1.111 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.7101233005523682
Epoch: 18, Steps: 1 | Train Loss: 0.743 Vali Loss: 1.113 Vali Acc: 0.533 Test Loss: 1.113 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.6759917736053467
Epoch: 19, Steps: 1 | Train Loss: 0.706 Vali Loss: 1.115 Vali Acc: 0.533 Test Loss: 1.115 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.6902480125427246
Epoch: 20, Steps: 1 | Train Loss: 0.639 Vali Loss: 1.117 Vali Acc: 0.533 Test Loss: 1.117 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.6559505462646484
Epoch: 21, Steps: 1 | Train Loss: 0.640 Vali Loss: 1.119 Vali Acc: 0.467 Test Loss: 1.119 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.709989070892334
Epoch: 22, Steps: 1 | Train Loss: 0.632 Vali Loss: 1.120 Vali Acc: 0.400 Test Loss: 1.120 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.6656713485717773
Epoch: 23, Steps: 1 | Train Loss: 0.593 Vali Loss: 1.121 Vali Acc: 0.400 Test Loss: 1.121 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm8_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 602147
model size : 2.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm8_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.4403772354125977
Epoch: 1, Steps: 1 | Train Loss: 1.017 Vali Loss: 1.187 Vali Acc: 0.267 Test Loss: 1.187 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.5980708599090576
Epoch: 2, Steps: 1 | Train Loss: 1.070 Vali Loss: 1.182 Vali Acc: 0.267 Test Loss: 1.182 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.6828784942626953
Epoch: 3, Steps: 1 | Train Loss: 1.124 Vali Loss: 1.178 Vali Acc: 0.200 Test Loss: 1.178 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6099541187286377
Epoch: 4, Steps: 1 | Train Loss: 1.037 Vali Loss: 1.175 Vali Acc: 0.200 Test Loss: 1.175 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.69169020652771
Epoch: 5, Steps: 1 | Train Loss: 1.048 Vali Loss: 1.174 Vali Acc: 0.133 Test Loss: 1.174 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.5598039627075195
Epoch: 6, Steps: 1 | Train Loss: 0.927 Vali Loss: 1.173 Vali Acc: 0.067 Test Loss: 1.173 Test Acc: 0.067
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.5282182693481445
Epoch: 7, Steps: 1 | Train Loss: 1.009 Vali Loss: 1.173 Vali Acc: 0.133 Test Loss: 1.173 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.5416548252105713
Epoch: 8, Steps: 1 | Train Loss: 0.964 Vali Loss: 1.172 Vali Acc: 0.067 Test Loss: 1.172 Test Acc: 0.067
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.5914516448974609
Epoch: 9, Steps: 1 | Train Loss: 0.998 Vali Loss: 1.171 Vali Acc: 0.067 Test Loss: 1.171 Test Acc: 0.067
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.6987884044647217
Epoch: 10, Steps: 1 | Train Loss: 0.965 Vali Loss: 1.170 Vali Acc: 0.067 Test Loss: 1.170 Test Acc: 0.067
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.5988433361053467
Epoch: 11, Steps: 1 | Train Loss: 0.974 Vali Loss: 1.169 Vali Acc: 0.067 Test Loss: 1.169 Test Acc: 0.067
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.5871384143829346
Epoch: 12, Steps: 1 | Train Loss: 0.961 Vali Loss: 1.168 Vali Acc: 0.067 Test Loss: 1.168 Test Acc: 0.067
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm8_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 188131
model size : 0.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm8_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.459759473800659
Epoch: 1, Steps: 1 | Train Loss: 1.062 Vali Loss: 1.089 Vali Acc: 0.400 Test Loss: 1.089 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.49982142448425293
Epoch: 2, Steps: 1 | Train Loss: 1.090 Vali Loss: 1.089 Vali Acc: 0.400 Test Loss: 1.089 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.5713808536529541
Epoch: 3, Steps: 1 | Train Loss: 1.077 Vali Loss: 1.089 Vali Acc: 0.400 Test Loss: 1.089 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5527005195617676
Epoch: 4, Steps: 1 | Train Loss: 1.006 Vali Loss: 1.089 Vali Acc: 0.400 Test Loss: 1.089 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.5965368747711182
Epoch: 5, Steps: 1 | Train Loss: 1.036 Vali Loss: 1.090 Vali Acc: 0.400 Test Loss: 1.090 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.6088826656341553
Epoch: 6, Steps: 1 | Train Loss: 1.001 Vali Loss: 1.090 Vali Acc: 0.467 Test Loss: 1.090 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 7 cost time: 0.5622508525848389
Epoch: 7, Steps: 1 | Train Loss: 1.016 Vali Loss: 1.091 Vali Acc: 0.467 Test Loss: 1.091 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5596451759338379
Epoch: 8, Steps: 1 | Train Loss: 1.037 Vali Loss: 1.092 Vali Acc: 0.467 Test Loss: 1.092 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.620358943939209
Epoch: 9, Steps: 1 | Train Loss: 0.946 Vali Loss: 1.093 Vali Acc: 0.533 Test Loss: 1.093 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 10 cost time: 0.5826349258422852
Epoch: 10, Steps: 1 | Train Loss: 0.919 Vali Loss: 1.094 Vali Acc: 0.533 Test Loss: 1.094 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.612675666809082
Epoch: 11, Steps: 1 | Train Loss: 0.928 Vali Loss: 1.095 Vali Acc: 0.533 Test Loss: 1.095 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.6104083061218262
Epoch: 12, Steps: 1 | Train Loss: 0.906 Vali Loss: 1.096 Vali Acc: 0.533 Test Loss: 1.096 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.5755867958068848
Epoch: 13, Steps: 1 | Train Loss: 0.903 Vali Loss: 1.098 Vali Acc: 0.533 Test Loss: 1.098 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.5444798469543457
Epoch: 14, Steps: 1 | Train Loss: 0.837 Vali Loss: 1.100 Vali Acc: 0.533 Test Loss: 1.100 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.6183428764343262
Epoch: 15, Steps: 1 | Train Loss: 0.836 Vali Loss: 1.102 Vali Acc: 0.467 Test Loss: 1.102 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.6055526733398438
Epoch: 16, Steps: 1 | Train Loss: 0.818 Vali Loss: 1.104 Vali Acc: 0.467 Test Loss: 1.104 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.5910158157348633
Epoch: 17, Steps: 1 | Train Loss: 0.757 Vali Loss: 1.107 Vali Acc: 0.400 Test Loss: 1.107 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.615755558013916
Epoch: 18, Steps: 1 | Train Loss: 0.775 Vali Loss: 1.109 Vali Acc: 0.400 Test Loss: 1.109 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.5880782604217529
Epoch: 19, Steps: 1 | Train Loss: 0.728 Vali Loss: 1.112 Vali Acc: 0.400 Test Loss: 1.112 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm8_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 602147
model size : 2.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm8_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.2430524826049805
Epoch: 1, Steps: 1 | Train Loss: 1.012 Vali Loss: 1.129 Vali Acc: 0.267 Test Loss: 1.129 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.5146379470825195
Epoch: 2, Steps: 1 | Train Loss: 1.057 Vali Loss: 1.125 Vali Acc: 0.267 Test Loss: 1.125 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.5031039714813232
Epoch: 3, Steps: 1 | Train Loss: 1.108 Vali Loss: 1.122 Vali Acc: 0.133 Test Loss: 1.122 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.4954488277435303
Epoch: 4, Steps: 1 | Train Loss: 1.034 Vali Loss: 1.121 Vali Acc: 0.200 Test Loss: 1.121 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.499478816986084
Epoch: 5, Steps: 1 | Train Loss: 1.040 Vali Loss: 1.121 Vali Acc: 0.200 Test Loss: 1.121 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.5319125652313232
Epoch: 6, Steps: 1 | Train Loss: 0.926 Vali Loss: 1.121 Vali Acc: 0.200 Test Loss: 1.121 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.5256021022796631
Epoch: 7, Steps: 1 | Train Loss: 0.996 Vali Loss: 1.121 Vali Acc: 0.200 Test Loss: 1.121 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.560307502746582
Epoch: 8, Steps: 1 | Train Loss: 0.967 Vali Loss: 1.121 Vali Acc: 0.200 Test Loss: 1.121 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.47738194465637207
Epoch: 9, Steps: 1 | Train Loss: 1.005 Vali Loss: 1.121 Vali Acc: 0.200 Test Loss: 1.121 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.5116713047027588
Epoch: 10, Steps: 1 | Train Loss: 0.973 Vali Loss: 1.121 Vali Acc: 0.200 Test Loss: 1.121 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.5022993087768555
Epoch: 11, Steps: 1 | Train Loss: 0.981 Vali Loss: 1.121 Vali Acc: 0.200 Test Loss: 1.121 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.5922372341156006
Epoch: 12, Steps: 1 | Train Loss: 0.969 Vali Loss: 1.121 Vali Acc: 0.200 Test Loss: 1.121 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm8_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 188131
model size : 0.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm8_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.6648154258728027
Epoch: 1, Steps: 1 | Train Loss: 1.249 Vali Loss: 1.163 Vali Acc: 0.133 Test Loss: 1.163 Test Acc: 0.133
Validation loss decreased (inf --> -0.133322).  Saving model ...
Epoch: 2 cost time: 0.7527916431427002
Epoch: 2, Steps: 1 | Train Loss: 1.023 Vali Loss: 1.164 Vali Acc: 0.133 Test Loss: 1.164 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7590157985687256
Epoch: 3, Steps: 1 | Train Loss: 1.031 Vali Loss: 1.165 Vali Acc: 0.267 Test Loss: 1.165 Test Acc: 0.267
Validation loss decreased (-0.133322 --> -0.266655).  Saving model ...
Epoch: 4 cost time: 0.6909646987915039
Epoch: 4, Steps: 1 | Train Loss: 1.013 Vali Loss: 1.167 Vali Acc: 0.267 Test Loss: 1.167 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6395924091339111
Epoch: 5, Steps: 1 | Train Loss: 1.028 Vali Loss: 1.170 Vali Acc: 0.267 Test Loss: 1.170 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.6004762649536133
Epoch: 6, Steps: 1 | Train Loss: 0.977 Vali Loss: 1.172 Vali Acc: 0.267 Test Loss: 1.172 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.6917285919189453
Epoch: 7, Steps: 1 | Train Loss: 1.059 Vali Loss: 1.174 Vali Acc: 0.267 Test Loss: 1.174 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.7469780445098877
Epoch: 8, Steps: 1 | Train Loss: 1.048 Vali Loss: 1.177 Vali Acc: 0.267 Test Loss: 1.177 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.6894433498382568
Epoch: 9, Steps: 1 | Train Loss: 1.015 Vali Loss: 1.181 Vali Acc: 0.267 Test Loss: 1.181 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.7894179821014404
Epoch: 10, Steps: 1 | Train Loss: 0.947 Vali Loss: 1.185 Vali Acc: 0.267 Test Loss: 1.185 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.7579402923583984
Epoch: 11, Steps: 1 | Train Loss: 0.885 Vali Loss: 1.189 Vali Acc: 0.267 Test Loss: 1.189 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.762984037399292
Epoch: 12, Steps: 1 | Train Loss: 0.900 Vali Loss: 1.194 Vali Acc: 0.267 Test Loss: 1.194 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.8310880661010742
Epoch: 13, Steps: 1 | Train Loss: 0.882 Vali Loss: 1.200 Vali Acc: 0.267 Test Loss: 1.200 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm8_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 308899
model size : 1.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm8_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.309809923171997
Epoch: 1, Steps: 1 | Train Loss: 1.189 Vali Loss: 1.138 Vali Acc: 0.333 Test Loss: 1.138 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.5609591007232666
Epoch: 2, Steps: 1 | Train Loss: 1.134 Vali Loss: 1.134 Vali Acc: 0.200 Test Loss: 1.134 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5985860824584961
Epoch: 3, Steps: 1 | Train Loss: 1.112 Vali Loss: 1.133 Vali Acc: 0.267 Test Loss: 1.133 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.587155818939209
Epoch: 4, Steps: 1 | Train Loss: 1.107 Vali Loss: 1.132 Vali Acc: 0.267 Test Loss: 1.132 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.6334328651428223
Epoch: 5, Steps: 1 | Train Loss: 1.075 Vali Loss: 1.132 Vali Acc: 0.400 Test Loss: 1.132 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.5844259262084961
Epoch: 6, Steps: 1 | Train Loss: 1.092 Vali Loss: 1.132 Vali Acc: 0.333 Test Loss: 1.132 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6741783618927002
Epoch: 7, Steps: 1 | Train Loss: 1.022 Vali Loss: 1.133 Vali Acc: 0.267 Test Loss: 1.133 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.5856833457946777
Epoch: 8, Steps: 1 | Train Loss: 1.031 Vali Loss: 1.134 Vali Acc: 0.200 Test Loss: 1.134 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.6713876724243164
Epoch: 9, Steps: 1 | Train Loss: 0.972 Vali Loss: 1.136 Vali Acc: 0.200 Test Loss: 1.136 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.6436061859130859
Epoch: 10, Steps: 1 | Train Loss: 1.015 Vali Loss: 1.138 Vali Acc: 0.200 Test Loss: 1.138 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.659980297088623
Epoch: 11, Steps: 1 | Train Loss: 0.963 Vali Loss: 1.140 Vali Acc: 0.133 Test Loss: 1.140 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.569868803024292
Epoch: 12, Steps: 1 | Train Loss: 0.955 Vali Loss: 1.142 Vali Acc: 0.133 Test Loss: 1.142 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.6023125648498535
Epoch: 13, Steps: 1 | Train Loss: 0.955 Vali Loss: 1.145 Vali Acc: 0.133 Test Loss: 1.145 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.5601952075958252
Epoch: 14, Steps: 1 | Train Loss: 0.898 Vali Loss: 1.149 Vali Acc: 0.133 Test Loss: 1.149 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.5773260593414307
Epoch: 15, Steps: 1 | Train Loss: 0.832 Vali Loss: 1.152 Vali Acc: 0.133 Test Loss: 1.152 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm8_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 101859
model size : 0.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm8_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.43243408203125
Epoch: 1, Steps: 1 | Train Loss: 1.252 Vali Loss: 1.164 Vali Acc: 0.133 Test Loss: 1.164 Test Acc: 0.133
Validation loss decreased (inf --> -0.133322).  Saving model ...
Epoch: 2 cost time: 0.6437170505523682
Epoch: 2, Steps: 1 | Train Loss: 1.023 Vali Loss: 1.164 Vali Acc: 0.133 Test Loss: 1.164 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6823165416717529
Epoch: 3, Steps: 1 | Train Loss: 1.021 Vali Loss: 1.165 Vali Acc: 0.267 Test Loss: 1.165 Test Acc: 0.267
Validation loss decreased (-0.133322 --> -0.266655).  Saving model ...
Epoch: 4 cost time: 0.6846065521240234
Epoch: 4, Steps: 1 | Train Loss: 1.022 Vali Loss: 1.167 Vali Acc: 0.267 Test Loss: 1.167 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6433701515197754
Epoch: 5, Steps: 1 | Train Loss: 1.032 Vali Loss: 1.169 Vali Acc: 0.267 Test Loss: 1.169 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.6846890449523926
Epoch: 6, Steps: 1 | Train Loss: 0.978 Vali Loss: 1.171 Vali Acc: 0.267 Test Loss: 1.171 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.6560604572296143
Epoch: 7, Steps: 1 | Train Loss: 1.064 Vali Loss: 1.173 Vali Acc: 0.267 Test Loss: 1.173 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.5850389003753662
Epoch: 8, Steps: 1 | Train Loss: 1.043 Vali Loss: 1.175 Vali Acc: 0.267 Test Loss: 1.175 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.6200523376464844
Epoch: 9, Steps: 1 | Train Loss: 1.016 Vali Loss: 1.178 Vali Acc: 0.267 Test Loss: 1.178 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.5917108058929443
Epoch: 10, Steps: 1 | Train Loss: 0.957 Vali Loss: 1.181 Vali Acc: 0.267 Test Loss: 1.181 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.6607155799865723
Epoch: 11, Steps: 1 | Train Loss: 0.884 Vali Loss: 1.185 Vali Acc: 0.267 Test Loss: 1.185 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.6132194995880127
Epoch: 12, Steps: 1 | Train Loss: 0.905 Vali Loss: 1.189 Vali Acc: 0.267 Test Loss: 1.189 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.620293140411377
Epoch: 13, Steps: 1 | Train Loss: 0.886 Vali Loss: 1.193 Vali Acc: 0.267 Test Loss: 1.193 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm8_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 308899
model size : 1.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm8_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.35094952583313
Epoch: 1, Steps: 1 | Train Loss: 1.202 Vali Loss: 1.138 Vali Acc: 0.333 Test Loss: 1.138 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.5216667652130127
Epoch: 2, Steps: 1 | Train Loss: 1.141 Vali Loss: 1.134 Vali Acc: 0.200 Test Loss: 1.134 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5110049247741699
Epoch: 3, Steps: 1 | Train Loss: 1.122 Vali Loss: 1.132 Vali Acc: 0.267 Test Loss: 1.132 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5819025039672852
Epoch: 4, Steps: 1 | Train Loss: 1.105 Vali Loss: 1.131 Vali Acc: 0.267 Test Loss: 1.131 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5339117050170898
Epoch: 5, Steps: 1 | Train Loss: 1.077 Vali Loss: 1.132 Vali Acc: 0.400 Test Loss: 1.132 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.4948689937591553
Epoch: 6, Steps: 1 | Train Loss: 1.088 Vali Loss: 1.132 Vali Acc: 0.400 Test Loss: 1.132 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5049223899841309
Epoch: 7, Steps: 1 | Train Loss: 1.020 Vali Loss: 1.133 Vali Acc: 0.267 Test Loss: 1.133 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.5394687652587891
Epoch: 8, Steps: 1 | Train Loss: 1.044 Vali Loss: 1.134 Vali Acc: 0.200 Test Loss: 1.134 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.5346062183380127
Epoch: 9, Steps: 1 | Train Loss: 0.991 Vali Loss: 1.136 Vali Acc: 0.200 Test Loss: 1.136 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.5410799980163574
Epoch: 10, Steps: 1 | Train Loss: 1.014 Vali Loss: 1.138 Vali Acc: 0.200 Test Loss: 1.138 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.5436279773712158
Epoch: 11, Steps: 1 | Train Loss: 0.970 Vali Loss: 1.140 Vali Acc: 0.200 Test Loss: 1.140 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.5164618492126465
Epoch: 12, Steps: 1 | Train Loss: 0.959 Vali Loss: 1.142 Vali Acc: 0.133 Test Loss: 1.142 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.5341792106628418
Epoch: 13, Steps: 1 | Train Loss: 0.951 Vali Loss: 1.145 Vali Acc: 0.133 Test Loss: 1.145 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.5726776123046875
Epoch: 14, Steps: 1 | Train Loss: 0.900 Vali Loss: 1.149 Vali Acc: 0.133 Test Loss: 1.149 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.603090763092041
Epoch: 15, Steps: 1 | Train Loss: 0.848 Vali Loss: 1.152 Vali Acc: 0.133 Test Loss: 1.152 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm8_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 101859
model size : 0.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm8_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.412165403366089
Epoch: 1, Steps: 1 | Train Loss: 1.278 Vali Loss: 1.156 Vali Acc: 0.333 Test Loss: 1.156 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.5640618801116943
Epoch: 2, Steps: 1 | Train Loss: 1.059 Vali Loss: 1.157 Vali Acc: 0.333 Test Loss: 1.157 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.624295711517334
Epoch: 3, Steps: 1 | Train Loss: 1.051 Vali Loss: 1.158 Vali Acc: 0.267 Test Loss: 1.158 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.646721363067627
Epoch: 4, Steps: 1 | Train Loss: 1.048 Vali Loss: 1.160 Vali Acc: 0.267 Test Loss: 1.160 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5928285121917725
Epoch: 5, Steps: 1 | Train Loss: 1.070 Vali Loss: 1.162 Vali Acc: 0.333 Test Loss: 1.162 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5436227321624756
Epoch: 6, Steps: 1 | Train Loss: 1.002 Vali Loss: 1.164 Vali Acc: 0.333 Test Loss: 1.164 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.5797731876373291
Epoch: 7, Steps: 1 | Train Loss: 1.088 Vali Loss: 1.166 Vali Acc: 0.400 Test Loss: 1.166 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 8 cost time: 0.531144380569458
Epoch: 8, Steps: 1 | Train Loss: 1.068 Vali Loss: 1.168 Vali Acc: 0.333 Test Loss: 1.168 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5876162052154541
Epoch: 9, Steps: 1 | Train Loss: 1.048 Vali Loss: 1.170 Vali Acc: 0.333 Test Loss: 1.170 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.5475733280181885
Epoch: 10, Steps: 1 | Train Loss: 0.971 Vali Loss: 1.173 Vali Acc: 0.333 Test Loss: 1.173 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.5479729175567627
Epoch: 11, Steps: 1 | Train Loss: 0.914 Vali Loss: 1.176 Vali Acc: 0.333 Test Loss: 1.176 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.6123788356781006
Epoch: 12, Steps: 1 | Train Loss: 0.920 Vali Loss: 1.179 Vali Acc: 0.333 Test Loss: 1.179 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.5685234069824219
Epoch: 13, Steps: 1 | Train Loss: 0.918 Vali Loss: 1.183 Vali Acc: 0.333 Test Loss: 1.183 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.5774242877960205
Epoch: 14, Steps: 1 | Train Loss: 0.836 Vali Loss: 1.186 Vali Acc: 0.333 Test Loss: 1.186 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.5493042469024658
Epoch: 15, Steps: 1 | Train Loss: 0.821 Vali Loss: 1.190 Vali Acc: 0.333 Test Loss: 1.190 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.5240573883056641
Epoch: 16, Steps: 1 | Train Loss: 0.845 Vali Loss: 1.195 Vali Acc: 0.333 Test Loss: 1.195 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.5475502014160156
Epoch: 17, Steps: 1 | Train Loss: 0.764 Vali Loss: 1.199 Vali Acc: 0.333 Test Loss: 1.199 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm8_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 308899
model size : 1.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm8_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.246703624725342
Epoch: 1, Steps: 1 | Train Loss: 1.211 Vali Loss: 1.149 Vali Acc: 0.333 Test Loss: 1.149 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.518592119216919
Epoch: 2, Steps: 1 | Train Loss: 1.150 Vali Loss: 1.145 Vali Acc: 0.200 Test Loss: 1.145 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.559945821762085
Epoch: 3, Steps: 1 | Train Loss: 1.118 Vali Loss: 1.143 Vali Acc: 0.200 Test Loss: 1.143 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5172185897827148
Epoch: 4, Steps: 1 | Train Loss: 1.102 Vali Loss: 1.142 Vali Acc: 0.200 Test Loss: 1.142 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5044021606445312
Epoch: 5, Steps: 1 | Train Loss: 1.081 Vali Loss: 1.142 Vali Acc: 0.333 Test Loss: 1.142 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.5533230304718018
Epoch: 6, Steps: 1 | Train Loss: 1.092 Vali Loss: 1.143 Vali Acc: 0.267 Test Loss: 1.143 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.44567227363586426
Epoch: 7, Steps: 1 | Train Loss: 1.019 Vali Loss: 1.144 Vali Acc: 0.200 Test Loss: 1.144 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.47931480407714844
Epoch: 8, Steps: 1 | Train Loss: 1.039 Vali Loss: 1.145 Vali Acc: 0.133 Test Loss: 1.145 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.5785658359527588
Epoch: 9, Steps: 1 | Train Loss: 0.984 Vali Loss: 1.146 Vali Acc: 0.133 Test Loss: 1.146 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.5425918102264404
Epoch: 10, Steps: 1 | Train Loss: 1.018 Vali Loss: 1.148 Vali Acc: 0.133 Test Loss: 1.148 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.5864114761352539
Epoch: 11, Steps: 1 | Train Loss: 0.974 Vali Loss: 1.150 Vali Acc: 0.133 Test Loss: 1.150 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.5038518905639648
Epoch: 12, Steps: 1 | Train Loss: 0.960 Vali Loss: 1.153 Vali Acc: 0.067 Test Loss: 1.153 Test Acc: 0.067
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.5041399002075195
Epoch: 13, Steps: 1 | Train Loss: 0.951 Vali Loss: 1.156 Vali Acc: 0.067 Test Loss: 1.156 Test Acc: 0.067
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.5858824253082275
Epoch: 14, Steps: 1 | Train Loss: 0.902 Vali Loss: 1.159 Vali Acc: 0.067 Test Loss: 1.159 Test Acc: 0.067
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.5689048767089844
Epoch: 15, Steps: 1 | Train Loss: 0.852 Vali Loss: 1.163 Vali Acc: 0.133 Test Loss: 1.163 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el4_dm8_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 101859
model size : 0.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm128_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 10.595781803131104
Epoch: 1, Steps: 1 | Train Loss: 1.148 Vali Loss: 1.170 Vali Acc: 0.267 Test Loss: 1.170 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 4.250550985336304
Epoch: 2, Steps: 1 | Train Loss: 1.061 Vali Loss: 1.161 Vali Acc: 0.200 Test Loss: 1.161 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.223341226577759
Epoch: 3, Steps: 1 | Train Loss: 1.020 Vali Loss: 1.168 Vali Acc: 0.200 Test Loss: 1.168 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.4250359535217285
Epoch: 4, Steps: 1 | Train Loss: 0.922 Vali Loss: 1.178 Vali Acc: 0.333 Test Loss: 1.178 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 5.378386735916138
Epoch: 5, Steps: 1 | Train Loss: 0.868 Vali Loss: 1.186 Vali Acc: 0.333 Test Loss: 1.186 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.181351661682129
Epoch: 6, Steps: 1 | Train Loss: 0.878 Vali Loss: 1.202 Vali Acc: 0.267 Test Loss: 1.202 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.189603090286255
Epoch: 7, Steps: 1 | Train Loss: 0.664 Vali Loss: 1.235 Vali Acc: 0.200 Test Loss: 1.235 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 5.32678484916687
Epoch: 8, Steps: 1 | Train Loss: 0.453 Vali Loss: 1.290 Vali Acc: 0.267 Test Loss: 1.290 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 5.156636953353882
Epoch: 9, Steps: 1 | Train Loss: 0.348 Vali Loss: 1.333 Vali Acc: 0.267 Test Loss: 1.333 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 5.262785196304321
Epoch: 10, Steps: 1 | Train Loss: 0.278 Vali Loss: 1.364 Vali Acc: 0.333 Test Loss: 1.364 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 5.263580322265625
Epoch: 11, Steps: 1 | Train Loss: 0.208 Vali Loss: 1.415 Vali Acc: 0.267 Test Loss: 1.415 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 5.174863576889038
Epoch: 12, Steps: 1 | Train Loss: 0.113 Vali Loss: 1.495 Vali Acc: 0.400 Test Loss: 1.495 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399985).  Saving model ...
Epoch: 13 cost time: 5.048234939575195
Epoch: 13, Steps: 1 | Train Loss: 0.073 Vali Loss: 1.600 Vali Acc: 0.267 Test Loss: 1.600 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.082143545150757
Epoch: 14, Steps: 1 | Train Loss: 0.042 Vali Loss: 1.720 Vali Acc: 0.333 Test Loss: 1.720 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.608668088912964
Epoch: 15, Steps: 1 | Train Loss: 0.023 Vali Loss: 1.831 Vali Acc: 0.333 Test Loss: 1.831 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.69973087310791
Epoch: 16, Steps: 1 | Train Loss: 0.013 Vali Loss: 1.928 Vali Acc: 0.333 Test Loss: 1.928 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.752418041229248
Epoch: 17, Steps: 1 | Train Loss: 0.009 Vali Loss: 2.008 Vali Acc: 0.333 Test Loss: 2.008 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 4.87168025970459
Epoch: 18, Steps: 1 | Train Loss: 0.005 Vali Loss: 2.072 Vali Acc: 0.333 Test Loss: 2.072 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 4.79506778717041
Epoch: 19, Steps: 1 | Train Loss: 0.002 Vali Loss: 2.131 Vali Acc: 0.333 Test Loss: 2.131 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 4.876209259033203
Epoch: 20, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.187 Vali Acc: 0.267 Test Loss: 2.187 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 4.8864054679870605
Epoch: 21, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.241 Vali Acc: 0.267 Test Loss: 2.241 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 4.769184827804565
Epoch: 22, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.294 Vali Acc: 0.267 Test Loss: 2.294 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm128_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 56484099
model size : 217.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm128_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 5.165095806121826
Epoch: 1, Steps: 1 | Train Loss: 1.243 Vali Loss: 1.186 Vali Acc: 0.267 Test Loss: 1.186 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 1.7254633903503418
Epoch: 2, Steps: 1 | Train Loss: 1.096 Vali Loss: 1.177 Vali Acc: 0.333 Test Loss: 1.177 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 1.698737621307373
Epoch: 3, Steps: 1 | Train Loss: 1.035 Vali Loss: 1.187 Vali Acc: 0.267 Test Loss: 1.187 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7100584506988525
Epoch: 4, Steps: 1 | Train Loss: 0.946 Vali Loss: 1.200 Vali Acc: 0.267 Test Loss: 1.200 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.675069808959961
Epoch: 5, Steps: 1 | Train Loss: 0.920 Vali Loss: 1.206 Vali Acc: 0.267 Test Loss: 1.206 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.4987826347351074
Epoch: 6, Steps: 1 | Train Loss: 0.859 Vali Loss: 1.216 Vali Acc: 0.333 Test Loss: 1.216 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.8056690692901611
Epoch: 7, Steps: 1 | Train Loss: 0.653 Vali Loss: 1.234 Vali Acc: 0.267 Test Loss: 1.234 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.7045462131500244
Epoch: 8, Steps: 1 | Train Loss: 0.569 Vali Loss: 1.265 Vali Acc: 0.267 Test Loss: 1.265 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.722475528717041
Epoch: 9, Steps: 1 | Train Loss: 0.381 Vali Loss: 1.314 Vali Acc: 0.200 Test Loss: 1.314 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.8526113033294678
Epoch: 10, Steps: 1 | Train Loss: 0.291 Vali Loss: 1.380 Vali Acc: 0.267 Test Loss: 1.380 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.929058313369751
Epoch: 11, Steps: 1 | Train Loss: 0.182 Vali Loss: 1.451 Vali Acc: 0.200 Test Loss: 1.451 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.8496265411376953
Epoch: 12, Steps: 1 | Train Loss: 0.098 Vali Loss: 1.519 Vali Acc: 0.267 Test Loss: 1.519 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm128_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 16766979
model size : 66.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm128_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 8.206273555755615
Epoch: 1, Steps: 1 | Train Loss: 1.155 Vali Loss: 1.164 Vali Acc: 0.333 Test Loss: 1.164 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 2.8022921085357666
Epoch: 2, Steps: 1 | Train Loss: 1.059 Vali Loss: 1.156 Vali Acc: 0.200 Test Loss: 1.156 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.2717220783233643
Epoch: 3, Steps: 1 | Train Loss: 1.004 Vali Loss: 1.163 Vali Acc: 0.200 Test Loss: 1.163 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.3041765689849854
Epoch: 4, Steps: 1 | Train Loss: 0.914 Vali Loss: 1.174 Vali Acc: 0.333 Test Loss: 1.174 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.785149097442627
Epoch: 5, Steps: 1 | Train Loss: 0.868 Vali Loss: 1.182 Vali Acc: 0.267 Test Loss: 1.182 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.817531108856201
Epoch: 6, Steps: 1 | Train Loss: 0.873 Vali Loss: 1.199 Vali Acc: 0.267 Test Loss: 1.199 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.66807222366333
Epoch: 7, Steps: 1 | Train Loss: 0.672 Vali Loss: 1.233 Vali Acc: 0.200 Test Loss: 1.233 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.8172035217285156
Epoch: 8, Steps: 1 | Train Loss: 0.467 Vali Loss: 1.289 Vali Acc: 0.267 Test Loss: 1.289 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.667726516723633
Epoch: 9, Steps: 1 | Train Loss: 0.361 Vali Loss: 1.333 Vali Acc: 0.267 Test Loss: 1.333 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.8794305324554443
Epoch: 10, Steps: 1 | Train Loss: 0.284 Vali Loss: 1.370 Vali Acc: 0.333 Test Loss: 1.370 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.7108380794525146
Epoch: 11, Steps: 1 | Train Loss: 0.212 Vali Loss: 1.433 Vali Acc: 0.267 Test Loss: 1.433 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm128_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 56484099
model size : 217.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm128_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 3.5618209838867188
Epoch: 1, Steps: 1 | Train Loss: 1.238 Vali Loss: 1.185 Vali Acc: 0.267 Test Loss: 1.185 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 1.1831066608428955
Epoch: 2, Steps: 1 | Train Loss: 1.082 Vali Loss: 1.176 Vali Acc: 0.400 Test Loss: 1.176 Test Acc: 0.400
Validation loss decreased (-0.266655 --> -0.399988).  Saving model ...
Epoch: 3 cost time: 1.2325024604797363
Epoch: 3, Steps: 1 | Train Loss: 1.037 Vali Loss: 1.187 Vali Acc: 0.267 Test Loss: 1.187 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2507283687591553
Epoch: 4, Steps: 1 | Train Loss: 0.944 Vali Loss: 1.199 Vali Acc: 0.267 Test Loss: 1.199 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2530055046081543
Epoch: 5, Steps: 1 | Train Loss: 0.914 Vali Loss: 1.206 Vali Acc: 0.267 Test Loss: 1.206 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.182469129562378
Epoch: 6, Steps: 1 | Train Loss: 0.857 Vali Loss: 1.216 Vali Acc: 0.267 Test Loss: 1.216 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.2050039768218994
Epoch: 7, Steps: 1 | Train Loss: 0.656 Vali Loss: 1.234 Vali Acc: 0.200 Test Loss: 1.234 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.3167858123779297
Epoch: 8, Steps: 1 | Train Loss: 0.577 Vali Loss: 1.269 Vali Acc: 0.267 Test Loss: 1.269 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.3324027061462402
Epoch: 9, Steps: 1 | Train Loss: 0.391 Vali Loss: 1.319 Vali Acc: 0.200 Test Loss: 1.319 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.267652988433838
Epoch: 10, Steps: 1 | Train Loss: 0.298 Vali Loss: 1.387 Vali Acc: 0.200 Test Loss: 1.387 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.1658673286437988
Epoch: 11, Steps: 1 | Train Loss: 0.184 Vali Loss: 1.468 Vali Acc: 0.200 Test Loss: 1.468 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.0845229625701904
Epoch: 12, Steps: 1 | Train Loss: 0.105 Vali Loss: 1.551 Vali Acc: 0.267 Test Loss: 1.551 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm128_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 16766979
model size : 66.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm128_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 5.09125280380249
Epoch: 1, Steps: 1 | Train Loss: 1.160 Vali Loss: 1.153 Vali Acc: 0.400 Test Loss: 1.153 Test Acc: 0.400
Validation loss decreased (inf --> -0.399988).  Saving model ...
Epoch: 2 cost time: 1.7726187705993652
Epoch: 2, Steps: 1 | Train Loss: 1.059 Vali Loss: 1.143 Vali Acc: 0.200 Test Loss: 1.143 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8164339065551758
Epoch: 3, Steps: 1 | Train Loss: 0.997 Vali Loss: 1.151 Vali Acc: 0.200 Test Loss: 1.151 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.823934555053711
Epoch: 4, Steps: 1 | Train Loss: 0.914 Vali Loss: 1.163 Vali Acc: 0.333 Test Loss: 1.163 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.9557900428771973
Epoch: 5, Steps: 1 | Train Loss: 0.869 Vali Loss: 1.172 Vali Acc: 0.267 Test Loss: 1.172 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.908411979675293
Epoch: 6, Steps: 1 | Train Loss: 0.873 Vali Loss: 1.191 Vali Acc: 0.267 Test Loss: 1.191 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.9230461120605469
Epoch: 7, Steps: 1 | Train Loss: 0.688 Vali Loss: 1.229 Vali Acc: 0.267 Test Loss: 1.229 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.8622679710388184
Epoch: 8, Steps: 1 | Train Loss: 0.479 Vali Loss: 1.288 Vali Acc: 0.333 Test Loss: 1.288 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.8321328163146973
Epoch: 9, Steps: 1 | Train Loss: 0.375 Vali Loss: 1.335 Vali Acc: 0.333 Test Loss: 1.335 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.8899943828582764
Epoch: 10, Steps: 1 | Train Loss: 0.296 Vali Loss: 1.373 Vali Acc: 0.400 Test Loss: 1.373 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.5945758819580078
Epoch: 11, Steps: 1 | Train Loss: 0.221 Vali Loss: 1.437 Vali Acc: 0.267 Test Loss: 1.437 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm128_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 56484099
model size : 217.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm128_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 3.3314499855041504
Epoch: 1, Steps: 1 | Train Loss: 1.263 Vali Loss: 1.154 Vali Acc: 0.267 Test Loss: 1.154 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.8591642379760742
Epoch: 2, Steps: 1 | Train Loss: 1.109 Vali Loss: 1.146 Vali Acc: 0.400 Test Loss: 1.146 Test Acc: 0.400
Validation loss decreased (-0.266655 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 1.0202059745788574
Epoch: 3, Steps: 1 | Train Loss: 1.057 Vali Loss: 1.158 Vali Acc: 0.267 Test Loss: 1.158 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0564045906066895
Epoch: 4, Steps: 1 | Train Loss: 0.957 Vali Loss: 1.171 Vali Acc: 0.267 Test Loss: 1.171 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.1353230476379395
Epoch: 5, Steps: 1 | Train Loss: 0.926 Vali Loss: 1.179 Vali Acc: 0.267 Test Loss: 1.179 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.0305273532867432
Epoch: 6, Steps: 1 | Train Loss: 0.872 Vali Loss: 1.189 Vali Acc: 0.333 Test Loss: 1.189 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.0259225368499756
Epoch: 7, Steps: 1 | Train Loss: 0.679 Vali Loss: 1.207 Vali Acc: 0.333 Test Loss: 1.207 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.963158130645752
Epoch: 8, Steps: 1 | Train Loss: 0.609 Vali Loss: 1.239 Vali Acc: 0.267 Test Loss: 1.239 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.0103399753570557
Epoch: 9, Steps: 1 | Train Loss: 0.413 Vali Loss: 1.290 Vali Acc: 0.267 Test Loss: 1.290 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.9543681144714355
Epoch: 10, Steps: 1 | Train Loss: 0.320 Vali Loss: 1.358 Vali Acc: 0.200 Test Loss: 1.358 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.9745166301727295
Epoch: 11, Steps: 1 | Train Loss: 0.202 Vali Loss: 1.438 Vali Acc: 0.267 Test Loss: 1.438 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.1572823524475098
Epoch: 12, Steps: 1 | Train Loss: 0.117 Vali Loss: 1.521 Vali Acc: 0.333 Test Loss: 1.521 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm128_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 16766979
model size : 66.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm128_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 5.983272314071655
Epoch: 1, Steps: 1 | Train Loss: 1.115 Vali Loss: 1.127 Vali Acc: 0.333 Test Loss: 1.127 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 2.7280335426330566
Epoch: 2, Steps: 1 | Train Loss: 0.987 Vali Loss: 1.131 Vali Acc: 0.400 Test Loss: 1.131 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 2.745588779449463
Epoch: 3, Steps: 1 | Train Loss: 0.907 Vali Loss: 1.140 Vali Acc: 0.333 Test Loss: 1.140 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.5687832832336426
Epoch: 4, Steps: 1 | Train Loss: 0.825 Vali Loss: 1.150 Vali Acc: 0.267 Test Loss: 1.150 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.700331687927246
Epoch: 5, Steps: 1 | Train Loss: 0.769 Vali Loss: 1.159 Vali Acc: 0.267 Test Loss: 1.159 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.6012606620788574
Epoch: 6, Steps: 1 | Train Loss: 0.798 Vali Loss: 1.180 Vali Acc: 0.400 Test Loss: 1.180 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.4501848220825195
Epoch: 7, Steps: 1 | Train Loss: 0.615 Vali Loss: 1.219 Vali Acc: 0.267 Test Loss: 1.219 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.4095795154571533
Epoch: 8, Steps: 1 | Train Loss: 0.440 Vali Loss: 1.282 Vali Acc: 0.133 Test Loss: 1.282 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.672053098678589
Epoch: 9, Steps: 1 | Train Loss: 0.347 Vali Loss: 1.343 Vali Acc: 0.133 Test Loss: 1.343 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.477302312850952
Epoch: 10, Steps: 1 | Train Loss: 0.220 Vali Loss: 1.394 Vali Acc: 0.267 Test Loss: 1.394 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.513782501220703
Epoch: 11, Steps: 1 | Train Loss: 0.153 Vali Loss: 1.470 Vali Acc: 0.267 Test Loss: 1.470 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.6324360370635986
Epoch: 12, Steps: 1 | Train Loss: 0.096 Vali Loss: 1.557 Vali Acc: 0.200 Test Loss: 1.557 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm128_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 28366851
model size : 110.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm128_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 3.18099308013916
Epoch: 1, Steps: 1 | Train Loss: 1.198 Vali Loss: 1.053 Vali Acc: 0.467 Test Loss: 1.053 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 1.1060395240783691
Epoch: 2, Steps: 1 | Train Loss: 1.124 Vali Loss: 1.059 Vali Acc: 0.533 Test Loss: 1.059 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 3 cost time: 1.1219182014465332
Epoch: 3, Steps: 1 | Train Loss: 1.071 Vali Loss: 1.072 Vali Acc: 0.467 Test Loss: 1.072 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1016149520874023
Epoch: 4, Steps: 1 | Train Loss: 0.932 Vali Loss: 1.080 Vali Acc: 0.467 Test Loss: 1.080 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.1056513786315918
Epoch: 5, Steps: 1 | Train Loss: 0.933 Vali Loss: 1.082 Vali Acc: 0.400 Test Loss: 1.082 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.1285266876220703
Epoch: 6, Steps: 1 | Train Loss: 0.831 Vali Loss: 1.082 Vali Acc: 0.467 Test Loss: 1.082 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.0935447216033936
Epoch: 7, Steps: 1 | Train Loss: 0.704 Vali Loss: 1.087 Vali Acc: 0.400 Test Loss: 1.087 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.185025930404663
Epoch: 8, Steps: 1 | Train Loss: 0.562 Vali Loss: 1.117 Vali Acc: 0.333 Test Loss: 1.117 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.1277432441711426
Epoch: 9, Steps: 1 | Train Loss: 0.426 Vali Loss: 1.167 Vali Acc: 0.333 Test Loss: 1.167 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.1172542572021484
Epoch: 10, Steps: 1 | Train Loss: 0.318 Vali Loss: 1.213 Vali Acc: 0.267 Test Loss: 1.213 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.1168818473815918
Epoch: 11, Steps: 1 | Train Loss: 0.195 Vali Loss: 1.256 Vali Acc: 0.267 Test Loss: 1.256 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.2083470821380615
Epoch: 12, Steps: 1 | Train Loss: 0.133 Vali Loss: 1.292 Vali Acc: 0.333 Test Loss: 1.292 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm128_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 8507907
model size : 34.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm128_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 5.115014314651489
Epoch: 1, Steps: 1 | Train Loss: 1.116 Vali Loss: 1.132 Vali Acc: 0.333 Test Loss: 1.132 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 1.735595941543579
Epoch: 2, Steps: 1 | Train Loss: 0.990 Vali Loss: 1.136 Vali Acc: 0.400 Test Loss: 1.136 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 1.6274490356445312
Epoch: 3, Steps: 1 | Train Loss: 0.909 Vali Loss: 1.146 Vali Acc: 0.333 Test Loss: 1.146 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3017191886901855
Epoch: 4, Steps: 1 | Train Loss: 0.824 Vali Loss: 1.156 Vali Acc: 0.267 Test Loss: 1.156 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.5954201221466064
Epoch: 5, Steps: 1 | Train Loss: 0.769 Vali Loss: 1.165 Vali Acc: 0.267 Test Loss: 1.165 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.7133278846740723
Epoch: 6, Steps: 1 | Train Loss: 0.802 Vali Loss: 1.185 Vali Acc: 0.400 Test Loss: 1.185 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.6327712535858154
Epoch: 7, Steps: 1 | Train Loss: 0.621 Vali Loss: 1.222 Vali Acc: 0.267 Test Loss: 1.222 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.5954926013946533
Epoch: 8, Steps: 1 | Train Loss: 0.453 Vali Loss: 1.282 Vali Acc: 0.200 Test Loss: 1.282 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.6318485736846924
Epoch: 9, Steps: 1 | Train Loss: 0.358 Vali Loss: 1.339 Vali Acc: 0.200 Test Loss: 1.339 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.587639570236206
Epoch: 10, Steps: 1 | Train Loss: 0.227 Vali Loss: 1.384 Vali Acc: 0.267 Test Loss: 1.384 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.6699879169464111
Epoch: 11, Steps: 1 | Train Loss: 0.156 Vali Loss: 1.453 Vali Acc: 0.333 Test Loss: 1.453 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.5116817951202393
Epoch: 12, Steps: 1 | Train Loss: 0.099 Vali Loss: 1.534 Vali Acc: 0.200 Test Loss: 1.534 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm128_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 28366851
model size : 110.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm128_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.981747627258301
Epoch: 1, Steps: 1 | Train Loss: 1.206 Vali Loss: 1.043 Vali Acc: 0.467 Test Loss: 1.043 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.8247931003570557
Epoch: 2, Steps: 1 | Train Loss: 1.138 Vali Loss: 1.048 Vali Acc: 0.533 Test Loss: 1.048 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 3 cost time: 0.9801154136657715
Epoch: 3, Steps: 1 | Train Loss: 1.090 Vali Loss: 1.060 Vali Acc: 0.467 Test Loss: 1.060 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9817631244659424
Epoch: 4, Steps: 1 | Train Loss: 0.937 Vali Loss: 1.068 Vali Acc: 0.333 Test Loss: 1.068 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9107697010040283
Epoch: 5, Steps: 1 | Train Loss: 0.940 Vali Loss: 1.071 Vali Acc: 0.400 Test Loss: 1.071 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.9042203426361084
Epoch: 6, Steps: 1 | Train Loss: 0.829 Vali Loss: 1.074 Vali Acc: 0.467 Test Loss: 1.074 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.9159023761749268
Epoch: 7, Steps: 1 | Train Loss: 0.714 Vali Loss: 1.086 Vali Acc: 0.400 Test Loss: 1.086 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.8883175849914551
Epoch: 8, Steps: 1 | Train Loss: 0.571 Vali Loss: 1.122 Vali Acc: 0.333 Test Loss: 1.122 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.8669295310974121
Epoch: 9, Steps: 1 | Train Loss: 0.435 Vali Loss: 1.178 Vali Acc: 0.400 Test Loss: 1.178 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.8032753467559814
Epoch: 10, Steps: 1 | Train Loss: 0.324 Vali Loss: 1.228 Vali Acc: 0.333 Test Loss: 1.228 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.9970004558563232
Epoch: 11, Steps: 1 | Train Loss: 0.198 Vali Loss: 1.274 Vali Acc: 0.333 Test Loss: 1.274 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.9040608406066895
Epoch: 12, Steps: 1 | Train Loss: 0.137 Vali Loss: 1.314 Vali Acc: 0.400 Test Loss: 1.314 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm128_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 8507907
model size : 34.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm128_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 3.801194190979004
Epoch: 1, Steps: 1 | Train Loss: 1.127 Vali Loss: 1.130 Vali Acc: 0.333 Test Loss: 1.130 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 1.2729487419128418
Epoch: 2, Steps: 1 | Train Loss: 0.993 Vali Loss: 1.135 Vali Acc: 0.400 Test Loss: 1.135 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 1.2925772666931152
Epoch: 3, Steps: 1 | Train Loss: 0.910 Vali Loss: 1.145 Vali Acc: 0.333 Test Loss: 1.145 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2914328575134277
Epoch: 4, Steps: 1 | Train Loss: 0.825 Vali Loss: 1.155 Vali Acc: 0.267 Test Loss: 1.155 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.144585371017456
Epoch: 5, Steps: 1 | Train Loss: 0.775 Vali Loss: 1.165 Vali Acc: 0.267 Test Loss: 1.165 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.0545094013214111
Epoch: 6, Steps: 1 | Train Loss: 0.807 Vali Loss: 1.184 Vali Acc: 0.400 Test Loss: 1.184 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.0051307678222656
Epoch: 7, Steps: 1 | Train Loss: 0.639 Vali Loss: 1.222 Vali Acc: 0.267 Test Loss: 1.222 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.9765377044677734
Epoch: 8, Steps: 1 | Train Loss: 0.471 Vali Loss: 1.280 Vali Acc: 0.200 Test Loss: 1.280 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.347754716873169
Epoch: 9, Steps: 1 | Train Loss: 0.370 Vali Loss: 1.338 Vali Acc: 0.200 Test Loss: 1.338 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.3609914779663086
Epoch: 10, Steps: 1 | Train Loss: 0.236 Vali Loss: 1.391 Vali Acc: 0.267 Test Loss: 1.391 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.3110685348510742
Epoch: 11, Steps: 1 | Train Loss: 0.164 Vali Loss: 1.467 Vali Acc: 0.267 Test Loss: 1.467 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.1824977397918701
Epoch: 12, Steps: 1 | Train Loss: 0.105 Vali Loss: 1.549 Vali Acc: 0.200 Test Loss: 1.549 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm128_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 28366851
model size : 110.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm128_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.89259934425354
Epoch: 1, Steps: 1 | Train Loss: 1.185 Vali Loss: 1.040 Vali Acc: 0.467 Test Loss: 1.040 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.7911100387573242
Epoch: 2, Steps: 1 | Train Loss: 1.120 Vali Loss: 1.046 Vali Acc: 0.533 Test Loss: 1.046 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 3 cost time: 0.8745927810668945
Epoch: 3, Steps: 1 | Train Loss: 1.069 Vali Loss: 1.058 Vali Acc: 0.467 Test Loss: 1.058 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8820610046386719
Epoch: 4, Steps: 1 | Train Loss: 0.918 Vali Loss: 1.067 Vali Acc: 0.467 Test Loss: 1.067 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.8114528656005859
Epoch: 5, Steps: 1 | Train Loss: 0.931 Vali Loss: 1.070 Vali Acc: 0.467 Test Loss: 1.070 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.7775735855102539
Epoch: 6, Steps: 1 | Train Loss: 0.809 Vali Loss: 1.073 Vali Acc: 0.400 Test Loss: 1.073 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.7766866683959961
Epoch: 7, Steps: 1 | Train Loss: 0.713 Vali Loss: 1.085 Vali Acc: 0.400 Test Loss: 1.085 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.7182910442352295
Epoch: 8, Steps: 1 | Train Loss: 0.571 Vali Loss: 1.123 Vali Acc: 0.333 Test Loss: 1.123 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.8110556602478027
Epoch: 9, Steps: 1 | Train Loss: 0.441 Vali Loss: 1.179 Vali Acc: 0.333 Test Loss: 1.179 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.7941973209381104
Epoch: 10, Steps: 1 | Train Loss: 0.330 Vali Loss: 1.231 Vali Acc: 0.333 Test Loss: 1.231 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.8103775978088379
Epoch: 11, Steps: 1 | Train Loss: 0.205 Vali Loss: 1.283 Vali Acc: 0.333 Test Loss: 1.283 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.864133358001709
Epoch: 12, Steps: 1 | Train Loss: 0.141 Vali Loss: 1.329 Vali Acc: 0.333 Test Loss: 1.329 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm128_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 8507907
model size : 34.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm64_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 6.917137622833252
Epoch: 1, Steps: 1 | Train Loss: 1.180 Vali Loss: 1.110 Vali Acc: 0.400 Test Loss: 1.110 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 2.7858548164367676
Epoch: 2, Steps: 1 | Train Loss: 1.097 Vali Loss: 1.101 Vali Acc: 0.333 Test Loss: 1.101 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.1262927055358887
Epoch: 3, Steps: 1 | Train Loss: 1.056 Vali Loss: 1.098 Vali Acc: 0.267 Test Loss: 1.098 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.894834041595459
Epoch: 4, Steps: 1 | Train Loss: 1.068 Vali Loss: 1.099 Vali Acc: 0.267 Test Loss: 1.099 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.956955671310425
Epoch: 5, Steps: 1 | Train Loss: 0.958 Vali Loss: 1.101 Vali Acc: 0.200 Test Loss: 1.101 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.1079046726226807
Epoch: 6, Steps: 1 | Train Loss: 0.919 Vali Loss: 1.108 Vali Acc: 0.200 Test Loss: 1.108 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.827648401260376
Epoch: 7, Steps: 1 | Train Loss: 0.826 Vali Loss: 1.118 Vali Acc: 0.267 Test Loss: 1.118 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.8098111152648926
Epoch: 8, Steps: 1 | Train Loss: 0.733 Vali Loss: 1.136 Vali Acc: 0.200 Test Loss: 1.136 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 3.085850238800049
Epoch: 9, Steps: 1 | Train Loss: 0.639 Vali Loss: 1.164 Vali Acc: 0.333 Test Loss: 1.164 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 3.1768014430999756
Epoch: 10, Steps: 1 | Train Loss: 0.492 Vali Loss: 1.195 Vali Acc: 0.267 Test Loss: 1.195 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 3.1419222354888916
Epoch: 11, Steps: 1 | Train Loss: 0.429 Vali Loss: 1.234 Vali Acc: 0.267 Test Loss: 1.234 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm64_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 28244355
model size : 108.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm64_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 4.014477252960205
Epoch: 1, Steps: 1 | Train Loss: 1.059 Vali Loss: 1.200 Vali Acc: 0.267 Test Loss: 1.200 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 1.2766685485839844
Epoch: 2, Steps: 1 | Train Loss: 1.078 Vali Loss: 1.199 Vali Acc: 0.267 Test Loss: 1.199 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 1.1741445064544678
Epoch: 3, Steps: 1 | Train Loss: 0.930 Vali Loss: 1.203 Vali Acc: 0.267 Test Loss: 1.203 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.28895902633667
Epoch: 4, Steps: 1 | Train Loss: 0.870 Vali Loss: 1.209 Vali Acc: 0.267 Test Loss: 1.209 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2695167064666748
Epoch: 5, Steps: 1 | Train Loss: 0.833 Vali Loss: 1.217 Vali Acc: 0.267 Test Loss: 1.217 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.1926355361938477
Epoch: 6, Steps: 1 | Train Loss: 0.843 Vali Loss: 1.230 Vali Acc: 0.267 Test Loss: 1.230 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.2421505451202393
Epoch: 7, Steps: 1 | Train Loss: 0.725 Vali Loss: 1.248 Vali Acc: 0.267 Test Loss: 1.248 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.1502039432525635
Epoch: 8, Steps: 1 | Train Loss: 0.636 Vali Loss: 1.269 Vali Acc: 0.267 Test Loss: 1.269 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.0933127403259277
Epoch: 9, Steps: 1 | Train Loss: 0.563 Vali Loss: 1.298 Vali Acc: 0.200 Test Loss: 1.298 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.3255798816680908
Epoch: 10, Steps: 1 | Train Loss: 0.430 Vali Loss: 1.330 Vali Acc: 0.200 Test Loss: 1.330 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.0956957340240479
Epoch: 11, Steps: 1 | Train Loss: 0.355 Vali Loss: 1.353 Vali Acc: 0.200 Test Loss: 1.353 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.2511656284332275
Epoch: 12, Steps: 1 | Train Loss: 0.284 Vali Loss: 1.374 Vali Acc: 0.267 Test Loss: 1.374 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm64_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 8385027
model size : 33.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm64_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 5.891445159912109
Epoch: 1, Steps: 1 | Train Loss: 1.179 Vali Loss: 1.110 Vali Acc: 0.400 Test Loss: 1.110 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 1.8948547840118408
Epoch: 2, Steps: 1 | Train Loss: 1.097 Vali Loss: 1.101 Vali Acc: 0.333 Test Loss: 1.101 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5566377639770508
Epoch: 3, Steps: 1 | Train Loss: 1.055 Vali Loss: 1.098 Vali Acc: 0.267 Test Loss: 1.098 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.507023811340332
Epoch: 4, Steps: 1 | Train Loss: 1.068 Vali Loss: 1.099 Vali Acc: 0.267 Test Loss: 1.099 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.8587760925292969
Epoch: 5, Steps: 1 | Train Loss: 0.957 Vali Loss: 1.101 Vali Acc: 0.133 Test Loss: 1.101 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.9385955333709717
Epoch: 6, Steps: 1 | Train Loss: 0.919 Vali Loss: 1.108 Vali Acc: 0.200 Test Loss: 1.108 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.7638514041900635
Epoch: 7, Steps: 1 | Train Loss: 0.826 Vali Loss: 1.119 Vali Acc: 0.267 Test Loss: 1.119 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.8926022052764893
Epoch: 8, Steps: 1 | Train Loss: 0.732 Vali Loss: 1.137 Vali Acc: 0.200 Test Loss: 1.137 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.8650574684143066
Epoch: 9, Steps: 1 | Train Loss: 0.641 Vali Loss: 1.166 Vali Acc: 0.200 Test Loss: 1.166 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.7837457656860352
Epoch: 10, Steps: 1 | Train Loss: 0.495 Vali Loss: 1.198 Vali Acc: 0.267 Test Loss: 1.198 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.8195226192474365
Epoch: 11, Steps: 1 | Train Loss: 0.431 Vali Loss: 1.238 Vali Acc: 0.333 Test Loss: 1.238 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm64_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 28244355
model size : 108.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm64_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 3.2198355197906494
Epoch: 1, Steps: 1 | Train Loss: 1.074 Vali Loss: 1.196 Vali Acc: 0.267 Test Loss: 1.196 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.9023785591125488
Epoch: 2, Steps: 1 | Train Loss: 1.097 Vali Loss: 1.195 Vali Acc: 0.267 Test Loss: 1.195 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.9105648994445801
Epoch: 3, Steps: 1 | Train Loss: 0.947 Vali Loss: 1.197 Vali Acc: 0.267 Test Loss: 1.197 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8372876644134521
Epoch: 4, Steps: 1 | Train Loss: 0.884 Vali Loss: 1.202 Vali Acc: 0.267 Test Loss: 1.202 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9854223728179932
Epoch: 5, Steps: 1 | Train Loss: 0.845 Vali Loss: 1.209 Vali Acc: 0.333 Test Loss: 1.209 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333321).  Saving model ...
Epoch: 6 cost time: 0.9326307773590088
Epoch: 6, Steps: 1 | Train Loss: 0.863 Vali Loss: 1.222 Vali Acc: 0.267 Test Loss: 1.222 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7530522346496582
Epoch: 7, Steps: 1 | Train Loss: 0.744 Vali Loss: 1.240 Vali Acc: 0.267 Test Loss: 1.240 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.8222947120666504
Epoch: 8, Steps: 1 | Train Loss: 0.657 Vali Loss: 1.261 Vali Acc: 0.200 Test Loss: 1.261 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.0126800537109375
Epoch: 9, Steps: 1 | Train Loss: 0.578 Vali Loss: 1.290 Vali Acc: 0.200 Test Loss: 1.290 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.9717366695404053
Epoch: 10, Steps: 1 | Train Loss: 0.445 Vali Loss: 1.323 Vali Acc: 0.200 Test Loss: 1.323 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.0950140953063965
Epoch: 11, Steps: 1 | Train Loss: 0.372 Vali Loss: 1.349 Vali Acc: 0.267 Test Loss: 1.349 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.001218557357788
Epoch: 12, Steps: 1 | Train Loss: 0.295 Vali Loss: 1.373 Vali Acc: 0.267 Test Loss: 1.373 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.9835500717163086
Epoch: 13, Steps: 1 | Train Loss: 0.232 Vali Loss: 1.403 Vali Acc: 0.267 Test Loss: 1.403 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.0347189903259277
Epoch: 14, Steps: 1 | Train Loss: 0.160 Vali Loss: 1.448 Vali Acc: 0.267 Test Loss: 1.448 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.9919531345367432
Epoch: 15, Steps: 1 | Train Loss: 0.130 Vali Loss: 1.509 Vali Acc: 0.267 Test Loss: 1.509 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm64_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 8385027
model size : 33.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm64_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 3.798617124557495
Epoch: 1, Steps: 1 | Train Loss: 1.183 Vali Loss: 1.087 Vali Acc: 0.333 Test Loss: 1.087 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 1.3801422119140625
Epoch: 2, Steps: 1 | Train Loss: 1.098 Vali Loss: 1.078 Vali Acc: 0.267 Test Loss: 1.078 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3285529613494873
Epoch: 3, Steps: 1 | Train Loss: 1.053 Vali Loss: 1.076 Vali Acc: 0.267 Test Loss: 1.076 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.40081787109375
Epoch: 4, Steps: 1 | Train Loss: 1.067 Vali Loss: 1.077 Vali Acc: 0.267 Test Loss: 1.077 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.4468014240264893
Epoch: 5, Steps: 1 | Train Loss: 0.963 Vali Loss: 1.079 Vali Acc: 0.133 Test Loss: 1.079 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.433103084564209
Epoch: 6, Steps: 1 | Train Loss: 0.919 Vali Loss: 1.085 Vali Acc: 0.200 Test Loss: 1.085 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.4321985244750977
Epoch: 7, Steps: 1 | Train Loss: 0.834 Vali Loss: 1.096 Vali Acc: 0.267 Test Loss: 1.096 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.4785292148590088
Epoch: 8, Steps: 1 | Train Loss: 0.759 Vali Loss: 1.112 Vali Acc: 0.200 Test Loss: 1.112 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.3581736087799072
Epoch: 9, Steps: 1 | Train Loss: 0.665 Vali Loss: 1.139 Vali Acc: 0.200 Test Loss: 1.139 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.4284694194793701
Epoch: 10, Steps: 1 | Train Loss: 0.518 Vali Loss: 1.167 Vali Acc: 0.267 Test Loss: 1.167 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.5622460842132568
Epoch: 11, Steps: 1 | Train Loss: 0.456 Vali Loss: 1.204 Vali Acc: 0.267 Test Loss: 1.204 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm64_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 28244355
model size : 108.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm64_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.9172139167785645
Epoch: 1, Steps: 1 | Train Loss: 1.071 Vali Loss: 1.169 Vali Acc: 0.333 Test Loss: 1.169 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.857414960861206
Epoch: 2, Steps: 1 | Train Loss: 1.088 Vali Loss: 1.166 Vali Acc: 0.333 Test Loss: 1.166 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.8248355388641357
Epoch: 3, Steps: 1 | Train Loss: 0.949 Vali Loss: 1.167 Vali Acc: 0.333 Test Loss: 1.167 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7811694145202637
Epoch: 4, Steps: 1 | Train Loss: 0.877 Vali Loss: 1.172 Vali Acc: 0.333 Test Loss: 1.172 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.8851449489593506
Epoch: 5, Steps: 1 | Train Loss: 0.842 Vali Loss: 1.179 Vali Acc: 0.400 Test Loss: 1.179 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 6 cost time: 0.8696563243865967
Epoch: 6, Steps: 1 | Train Loss: 0.863 Vali Loss: 1.192 Vali Acc: 0.333 Test Loss: 1.192 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7804224491119385
Epoch: 7, Steps: 1 | Train Loss: 0.751 Vali Loss: 1.209 Vali Acc: 0.333 Test Loss: 1.209 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.7008779048919678
Epoch: 8, Steps: 1 | Train Loss: 0.673 Vali Loss: 1.231 Vali Acc: 0.267 Test Loss: 1.231 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.9254271984100342
Epoch: 9, Steps: 1 | Train Loss: 0.598 Vali Loss: 1.261 Vali Acc: 0.267 Test Loss: 1.261 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.8562626838684082
Epoch: 10, Steps: 1 | Train Loss: 0.469 Vali Loss: 1.294 Vali Acc: 0.333 Test Loss: 1.294 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.7935521602630615
Epoch: 11, Steps: 1 | Train Loss: 0.388 Vali Loss: 1.320 Vali Acc: 0.333 Test Loss: 1.320 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.8124561309814453
Epoch: 12, Steps: 1 | Train Loss: 0.309 Vali Loss: 1.346 Vali Acc: 0.333 Test Loss: 1.346 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.8462803363800049
Epoch: 13, Steps: 1 | Train Loss: 0.249 Vali Loss: 1.379 Vali Acc: 0.333 Test Loss: 1.379 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.7845950126647949
Epoch: 14, Steps: 1 | Train Loss: 0.173 Vali Loss: 1.428 Vali Acc: 0.333 Test Loss: 1.428 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.8767523765563965
Epoch: 15, Steps: 1 | Train Loss: 0.140 Vali Loss: 1.492 Vali Acc: 0.333 Test Loss: 1.492 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm64_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 8385027
model size : 33.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm64_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 4.610161542892456
Epoch: 1, Steps: 1 | Train Loss: 1.173 Vali Loss: 1.109 Vali Acc: 0.267 Test Loss: 1.109 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 1.6166915893554688
Epoch: 2, Steps: 1 | Train Loss: 1.092 Vali Loss: 1.111 Vali Acc: 0.267 Test Loss: 1.111 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6442389488220215
Epoch: 3, Steps: 1 | Train Loss: 1.054 Vali Loss: 1.116 Vali Acc: 0.267 Test Loss: 1.116 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.6500024795532227
Epoch: 4, Steps: 1 | Train Loss: 0.994 Vali Loss: 1.123 Vali Acc: 0.200 Test Loss: 1.123 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.7049832344055176
Epoch: 5, Steps: 1 | Train Loss: 0.979 Vali Loss: 1.131 Vali Acc: 0.267 Test Loss: 1.131 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.7593638896942139
Epoch: 6, Steps: 1 | Train Loss: 0.875 Vali Loss: 1.140 Vali Acc: 0.400 Test Loss: 1.140 Test Acc: 0.400
Validation loss decreased (-0.266656 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 1.6716599464416504
Epoch: 7, Steps: 1 | Train Loss: 0.789 Vali Loss: 1.151 Vali Acc: 0.467 Test Loss: 1.151 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 8 cost time: 1.7231380939483643
Epoch: 8, Steps: 1 | Train Loss: 0.656 Vali Loss: 1.164 Vali Acc: 0.467 Test Loss: 1.164 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4705448150634766
Epoch: 9, Steps: 1 | Train Loss: 0.582 Vali Loss: 1.181 Vali Acc: 0.533 Test Loss: 1.181 Test Acc: 0.533
Validation loss decreased (-0.466655 --> -0.533322).  Saving model ...
Epoch: 10 cost time: 1.8472399711608887
Epoch: 10, Steps: 1 | Train Loss: 0.485 Vali Loss: 1.206 Vali Acc: 0.533 Test Loss: 1.206 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8816332817077637
Epoch: 11, Steps: 1 | Train Loss: 0.397 Vali Loss: 1.235 Vali Acc: 0.533 Test Loss: 1.235 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.9123022556304932
Epoch: 12, Steps: 1 | Train Loss: 0.290 Vali Loss: 1.268 Vali Acc: 0.467 Test Loss: 1.268 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.901984453201294
Epoch: 13, Steps: 1 | Train Loss: 0.240 Vali Loss: 1.309 Vali Acc: 0.467 Test Loss: 1.309 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.902559757232666
Epoch: 14, Steps: 1 | Train Loss: 0.173 Vali Loss: 1.352 Vali Acc: 0.400 Test Loss: 1.352 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.8240635395050049
Epoch: 15, Steps: 1 | Train Loss: 0.133 Vali Loss: 1.404 Vali Acc: 0.400 Test Loss: 1.404 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.817687749862671
Epoch: 16, Steps: 1 | Train Loss: 0.090 Vali Loss: 1.460 Vali Acc: 0.333 Test Loss: 1.460 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.8589410781860352
Epoch: 17, Steps: 1 | Train Loss: 0.066 Vali Loss: 1.508 Vali Acc: 0.333 Test Loss: 1.508 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.486133337020874
Epoch: 18, Steps: 1 | Train Loss: 0.055 Vali Loss: 1.550 Vali Acc: 0.333 Test Loss: 1.550 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.8748042583465576
Epoch: 19, Steps: 1 | Train Loss: 0.035 Vali Loss: 1.590 Vali Acc: 0.333 Test Loss: 1.590 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm64_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 14184579
model size : 55.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm64_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 3.1379380226135254
Epoch: 1, Steps: 1 | Train Loss: 1.109 Vali Loss: 1.116 Vali Acc: 0.400 Test Loss: 1.116 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.9376204013824463
Epoch: 2, Steps: 1 | Train Loss: 1.076 Vali Loss: 1.119 Vali Acc: 0.400 Test Loss: 1.119 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9521052837371826
Epoch: 3, Steps: 1 | Train Loss: 1.057 Vali Loss: 1.125 Vali Acc: 0.333 Test Loss: 1.125 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9524290561676025
Epoch: 4, Steps: 1 | Train Loss: 1.026 Vali Loss: 1.132 Vali Acc: 0.333 Test Loss: 1.132 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.0175299644470215
Epoch: 5, Steps: 1 | Train Loss: 0.867 Vali Loss: 1.139 Vali Acc: 0.267 Test Loss: 1.139 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.9313523769378662
Epoch: 6, Steps: 1 | Train Loss: 0.811 Vali Loss: 1.147 Vali Acc: 0.267 Test Loss: 1.147 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.8208060264587402
Epoch: 7, Steps: 1 | Train Loss: 0.786 Vali Loss: 1.156 Vali Acc: 0.200 Test Loss: 1.156 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.8064773082733154
Epoch: 8, Steps: 1 | Train Loss: 0.740 Vali Loss: 1.168 Vali Acc: 0.133 Test Loss: 1.168 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.9711751937866211
Epoch: 9, Steps: 1 | Train Loss: 0.593 Vali Loss: 1.184 Vali Acc: 0.200 Test Loss: 1.184 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.9145641326904297
Epoch: 10, Steps: 1 | Train Loss: 0.489 Vali Loss: 1.206 Vali Acc: 0.200 Test Loss: 1.206 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.9836127758026123
Epoch: 11, Steps: 1 | Train Loss: 0.466 Vali Loss: 1.238 Vali Acc: 0.200 Test Loss: 1.238 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm64_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 4254723
model size : 17.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm64_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 4.142007827758789
Epoch: 1, Steps: 1 | Train Loss: 1.180 Vali Loss: 1.110 Vali Acc: 0.267 Test Loss: 1.110 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 1.2391796112060547
Epoch: 2, Steps: 1 | Train Loss: 1.102 Vali Loss: 1.113 Vali Acc: 0.267 Test Loss: 1.113 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2264461517333984
Epoch: 3, Steps: 1 | Train Loss: 1.066 Vali Loss: 1.119 Vali Acc: 0.267 Test Loss: 1.119 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.3117735385894775
Epoch: 4, Steps: 1 | Train Loss: 1.002 Vali Loss: 1.127 Vali Acc: 0.200 Test Loss: 1.127 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.2521576881408691
Epoch: 5, Steps: 1 | Train Loss: 0.989 Vali Loss: 1.135 Vali Acc: 0.333 Test Loss: 1.135 Test Acc: 0.333
Validation loss decreased (-0.266656 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 1.2416744232177734
Epoch: 6, Steps: 1 | Train Loss: 0.879 Vali Loss: 1.144 Vali Acc: 0.400 Test Loss: 1.144 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 1.258251667022705
Epoch: 7, Steps: 1 | Train Loss: 0.810 Vali Loss: 1.154 Vali Acc: 0.467 Test Loss: 1.154 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 8 cost time: 1.207650899887085
Epoch: 8, Steps: 1 | Train Loss: 0.674 Vali Loss: 1.167 Vali Acc: 0.467 Test Loss: 1.167 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1488900184631348
Epoch: 9, Steps: 1 | Train Loss: 0.608 Vali Loss: 1.183 Vali Acc: 0.533 Test Loss: 1.183 Test Acc: 0.533
Validation loss decreased (-0.466655 --> -0.533322).  Saving model ...
Epoch: 10 cost time: 1.2165696620941162
Epoch: 10, Steps: 1 | Train Loss: 0.520 Vali Loss: 1.208 Vali Acc: 0.533 Test Loss: 1.208 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2403857707977295
Epoch: 11, Steps: 1 | Train Loss: 0.415 Vali Loss: 1.238 Vali Acc: 0.533 Test Loss: 1.238 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1964664459228516
Epoch: 12, Steps: 1 | Train Loss: 0.308 Vali Loss: 1.275 Vali Acc: 0.467 Test Loss: 1.275 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.1602396965026855
Epoch: 13, Steps: 1 | Train Loss: 0.255 Vali Loss: 1.319 Vali Acc: 0.467 Test Loss: 1.319 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.171788215637207
Epoch: 14, Steps: 1 | Train Loss: 0.185 Vali Loss: 1.367 Vali Acc: 0.400 Test Loss: 1.367 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.1912834644317627
Epoch: 15, Steps: 1 | Train Loss: 0.142 Vali Loss: 1.424 Vali Acc: 0.400 Test Loss: 1.424 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.3009552955627441
Epoch: 16, Steps: 1 | Train Loss: 0.096 Vali Loss: 1.486 Vali Acc: 0.333 Test Loss: 1.486 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.1832115650177002
Epoch: 17, Steps: 1 | Train Loss: 0.071 Vali Loss: 1.536 Vali Acc: 0.333 Test Loss: 1.536 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.2142314910888672
Epoch: 18, Steps: 1 | Train Loss: 0.059 Vali Loss: 1.578 Vali Acc: 0.333 Test Loss: 1.578 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.2177162170410156
Epoch: 19, Steps: 1 | Train Loss: 0.037 Vali Loss: 1.619 Vali Acc: 0.333 Test Loss: 1.619 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm64_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 14184579
model size : 55.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm64_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 3.099216938018799
Epoch: 1, Steps: 1 | Train Loss: 1.116 Vali Loss: 1.109 Vali Acc: 0.333 Test Loss: 1.109 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.7508487701416016
Epoch: 2, Steps: 1 | Train Loss: 1.083 Vali Loss: 1.113 Vali Acc: 0.333 Test Loss: 1.113 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7015509605407715
Epoch: 3, Steps: 1 | Train Loss: 1.061 Vali Loss: 1.120 Vali Acc: 0.333 Test Loss: 1.120 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8419821262359619
Epoch: 4, Steps: 1 | Train Loss: 1.031 Vali Loss: 1.128 Vali Acc: 0.333 Test Loss: 1.128 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.847801685333252
Epoch: 5, Steps: 1 | Train Loss: 0.869 Vali Loss: 1.134 Vali Acc: 0.333 Test Loss: 1.134 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.8621616363525391
Epoch: 6, Steps: 1 | Train Loss: 0.819 Vali Loss: 1.142 Vali Acc: 0.333 Test Loss: 1.142 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.8490502834320068
Epoch: 7, Steps: 1 | Train Loss: 0.791 Vali Loss: 1.151 Vali Acc: 0.267 Test Loss: 1.151 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.8335530757904053
Epoch: 8, Steps: 1 | Train Loss: 0.748 Vali Loss: 1.164 Vali Acc: 0.200 Test Loss: 1.164 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.7675807476043701
Epoch: 9, Steps: 1 | Train Loss: 0.600 Vali Loss: 1.179 Vali Acc: 0.267 Test Loss: 1.179 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.844491720199585
Epoch: 10, Steps: 1 | Train Loss: 0.498 Vali Loss: 1.202 Vali Acc: 0.267 Test Loss: 1.202 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.7549664974212646
Epoch: 11, Steps: 1 | Train Loss: 0.473 Vali Loss: 1.233 Vali Acc: 0.267 Test Loss: 1.233 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm64_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 4254723
model size : 17.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm64_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 3.4865682125091553
Epoch: 1, Steps: 1 | Train Loss: 1.168 Vali Loss: 1.115 Vali Acc: 0.267 Test Loss: 1.115 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.9618024826049805
Epoch: 2, Steps: 1 | Train Loss: 1.104 Vali Loss: 1.119 Vali Acc: 0.267 Test Loss: 1.119 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8267691135406494
Epoch: 3, Steps: 1 | Train Loss: 1.058 Vali Loss: 1.125 Vali Acc: 0.267 Test Loss: 1.125 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9984776973724365
Epoch: 4, Steps: 1 | Train Loss: 0.993 Vali Loss: 1.133 Vali Acc: 0.200 Test Loss: 1.133 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.9494044780731201
Epoch: 5, Steps: 1 | Train Loss: 0.981 Vali Loss: 1.140 Vali Acc: 0.333 Test Loss: 1.140 Test Acc: 0.333
Validation loss decreased (-0.266656 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 1.0331759452819824
Epoch: 6, Steps: 1 | Train Loss: 0.874 Vali Loss: 1.149 Vali Acc: 0.400 Test Loss: 1.149 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 1.1167962551116943
Epoch: 7, Steps: 1 | Train Loss: 0.818 Vali Loss: 1.160 Vali Acc: 0.467 Test Loss: 1.160 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 8 cost time: 1.1191115379333496
Epoch: 8, Steps: 1 | Train Loss: 0.689 Vali Loss: 1.174 Vali Acc: 0.467 Test Loss: 1.174 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9504632949829102
Epoch: 9, Steps: 1 | Train Loss: 0.628 Vali Loss: 1.193 Vali Acc: 0.533 Test Loss: 1.193 Test Acc: 0.533
Validation loss decreased (-0.466655 --> -0.533321).  Saving model ...
Epoch: 10 cost time: 0.9420192241668701
Epoch: 10, Steps: 1 | Train Loss: 0.539 Vali Loss: 1.219 Vali Acc: 0.533 Test Loss: 1.219 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9513120651245117
Epoch: 11, Steps: 1 | Train Loss: 0.431 Vali Loss: 1.252 Vali Acc: 0.467 Test Loss: 1.252 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.8958873748779297
Epoch: 12, Steps: 1 | Train Loss: 0.321 Vali Loss: 1.290 Vali Acc: 0.533 Test Loss: 1.290 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.8706769943237305
Epoch: 13, Steps: 1 | Train Loss: 0.273 Vali Loss: 1.336 Vali Acc: 0.467 Test Loss: 1.336 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.9322185516357422
Epoch: 14, Steps: 1 | Train Loss: 0.197 Vali Loss: 1.385 Vali Acc: 0.467 Test Loss: 1.385 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.9638831615447998
Epoch: 15, Steps: 1 | Train Loss: 0.152 Vali Loss: 1.446 Vali Acc: 0.400 Test Loss: 1.446 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.9729957580566406
Epoch: 16, Steps: 1 | Train Loss: 0.104 Vali Loss: 1.512 Vali Acc: 0.400 Test Loss: 1.512 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.8627932071685791
Epoch: 17, Steps: 1 | Train Loss: 0.082 Vali Loss: 1.561 Vali Acc: 0.400 Test Loss: 1.561 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.0200061798095703
Epoch: 18, Steps: 1 | Train Loss: 0.068 Vali Loss: 1.602 Vali Acc: 0.400 Test Loss: 1.602 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.0514986515045166
Epoch: 19, Steps: 1 | Train Loss: 0.041 Vali Loss: 1.647 Vali Acc: 0.400 Test Loss: 1.647 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm64_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 14184579
model size : 55.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm64_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.4468109607696533
Epoch: 1, Steps: 1 | Train Loss: 1.120 Vali Loss: 1.109 Vali Acc: 0.333 Test Loss: 1.109 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.6627368927001953
Epoch: 2, Steps: 1 | Train Loss: 1.079 Vali Loss: 1.113 Vali Acc: 0.333 Test Loss: 1.113 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6537365913391113
Epoch: 3, Steps: 1 | Train Loss: 1.060 Vali Loss: 1.120 Vali Acc: 0.333 Test Loss: 1.120 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7465767860412598
Epoch: 4, Steps: 1 | Train Loss: 1.031 Vali Loss: 1.128 Vali Acc: 0.333 Test Loss: 1.128 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.6478872299194336
Epoch: 5, Steps: 1 | Train Loss: 0.867 Vali Loss: 1.134 Vali Acc: 0.333 Test Loss: 1.134 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.6935644149780273
Epoch: 6, Steps: 1 | Train Loss: 0.820 Vali Loss: 1.143 Vali Acc: 0.333 Test Loss: 1.143 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.6368825435638428
Epoch: 7, Steps: 1 | Train Loss: 0.792 Vali Loss: 1.152 Vali Acc: 0.200 Test Loss: 1.152 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.6706116199493408
Epoch: 8, Steps: 1 | Train Loss: 0.760 Vali Loss: 1.163 Vali Acc: 0.200 Test Loss: 1.163 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.6543359756469727
Epoch: 9, Steps: 1 | Train Loss: 0.610 Vali Loss: 1.178 Vali Acc: 0.267 Test Loss: 1.178 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.647916316986084
Epoch: 10, Steps: 1 | Train Loss: 0.514 Vali Loss: 1.201 Vali Acc: 0.267 Test Loss: 1.201 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.553124189376831
Epoch: 11, Steps: 1 | Train Loss: 0.489 Vali Loss: 1.232 Vali Acc: 0.267 Test Loss: 1.232 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm64_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 4254723
model size : 17.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm64_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 3.8488121032714844
Epoch: 1, Steps: 1 | Train Loss: 1.123 Vali Loss: 1.131 Vali Acc: 0.267 Test Loss: 1.131 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 1.2530369758605957
Epoch: 2, Steps: 1 | Train Loss: 0.980 Vali Loss: 1.133 Vali Acc: 0.267 Test Loss: 1.133 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2364325523376465
Epoch: 3, Steps: 1 | Train Loss: 0.962 Vali Loss: 1.139 Vali Acc: 0.267 Test Loss: 1.139 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.2540791034698486
Epoch: 4, Steps: 1 | Train Loss: 0.892 Vali Loss: 1.145 Vali Acc: 0.267 Test Loss: 1.145 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.2313885688781738
Epoch: 5, Steps: 1 | Train Loss: 0.837 Vali Loss: 1.151 Vali Acc: 0.267 Test Loss: 1.151 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.2818427085876465
Epoch: 6, Steps: 1 | Train Loss: 0.735 Vali Loss: 1.160 Vali Acc: 0.267 Test Loss: 1.160 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.2414424419403076
Epoch: 7, Steps: 1 | Train Loss: 0.715 Vali Loss: 1.170 Vali Acc: 0.200 Test Loss: 1.170 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.385286808013916
Epoch: 8, Steps: 1 | Train Loss: 0.640 Vali Loss: 1.187 Vali Acc: 0.133 Test Loss: 1.187 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.2969539165496826
Epoch: 9, Steps: 1 | Train Loss: 0.495 Vali Loss: 1.211 Vali Acc: 0.133 Test Loss: 1.211 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.266047477722168
Epoch: 10, Steps: 1 | Train Loss: 0.456 Vali Loss: 1.237 Vali Acc: 0.133 Test Loss: 1.237 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.2452585697174072
Epoch: 11, Steps: 1 | Train Loss: 0.395 Vali Loss: 1.266 Vali Acc: 0.133 Test Loss: 1.266 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm64_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 7154691
model size : 28.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm64_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.5982985496520996
Epoch: 1, Steps: 1 | Train Loss: 1.182 Vali Loss: 1.188 Vali Acc: 0.400 Test Loss: 1.188 Test Acc: 0.400
Validation loss decreased (inf --> -0.399988).  Saving model ...
Epoch: 2 cost time: 0.733163595199585
Epoch: 2, Steps: 1 | Train Loss: 1.116 Vali Loss: 1.165 Vali Acc: 0.267 Test Loss: 1.165 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.733668327331543
Epoch: 3, Steps: 1 | Train Loss: 1.050 Vali Loss: 1.159 Vali Acc: 0.200 Test Loss: 1.159 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7209606170654297
Epoch: 4, Steps: 1 | Train Loss: 1.063 Vali Loss: 1.160 Vali Acc: 0.133 Test Loss: 1.160 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.6760663986206055
Epoch: 5, Steps: 1 | Train Loss: 0.982 Vali Loss: 1.164 Vali Acc: 0.133 Test Loss: 1.164 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.6880230903625488
Epoch: 6, Steps: 1 | Train Loss: 0.872 Vali Loss: 1.169 Vali Acc: 0.200 Test Loss: 1.169 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.6414146423339844
Epoch: 7, Steps: 1 | Train Loss: 0.826 Vali Loss: 1.177 Vali Acc: 0.200 Test Loss: 1.177 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.7114696502685547
Epoch: 8, Steps: 1 | Train Loss: 0.760 Vali Loss: 1.189 Vali Acc: 0.200 Test Loss: 1.189 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.707726001739502
Epoch: 9, Steps: 1 | Train Loss: 0.666 Vali Loss: 1.208 Vali Acc: 0.200 Test Loss: 1.208 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.7181854248046875
Epoch: 10, Steps: 1 | Train Loss: 0.552 Vali Loss: 1.238 Vali Acc: 0.133 Test Loss: 1.238 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.7693517208099365
Epoch: 11, Steps: 1 | Train Loss: 0.457 Vali Loss: 1.274 Vali Acc: 0.200 Test Loss: 1.274 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm64_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 2189571
model size : 9.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm64_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 3.2266035079956055
Epoch: 1, Steps: 1 | Train Loss: 1.123 Vali Loss: 1.135 Vali Acc: 0.200 Test Loss: 1.135 Test Acc: 0.200
Validation loss decreased (inf --> -0.199989).  Saving model ...
Epoch: 2 cost time: 0.8520984649658203
Epoch: 2, Steps: 1 | Train Loss: 0.972 Vali Loss: 1.138 Vali Acc: 0.200 Test Loss: 1.138 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9312732219696045
Epoch: 3, Steps: 1 | Train Loss: 0.955 Vali Loss: 1.144 Vali Acc: 0.267 Test Loss: 1.144 Test Acc: 0.267
Validation loss decreased (-0.199989 --> -0.266655).  Saving model ...
Epoch: 4 cost time: 0.9164113998413086
Epoch: 4, Steps: 1 | Train Loss: 0.888 Vali Loss: 1.151 Vali Acc: 0.200 Test Loss: 1.151 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9172017574310303
Epoch: 5, Steps: 1 | Train Loss: 0.833 Vali Loss: 1.158 Vali Acc: 0.267 Test Loss: 1.158 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.7774062156677246
Epoch: 6, Steps: 1 | Train Loss: 0.732 Vali Loss: 1.167 Vali Acc: 0.267 Test Loss: 1.167 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.8004200458526611
Epoch: 7, Steps: 1 | Train Loss: 0.714 Vali Loss: 1.179 Vali Acc: 0.200 Test Loss: 1.179 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.0457890033721924
Epoch: 8, Steps: 1 | Train Loss: 0.643 Vali Loss: 1.196 Vali Acc: 0.267 Test Loss: 1.196 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.9504635334014893
Epoch: 9, Steps: 1 | Train Loss: 0.504 Vali Loss: 1.221 Vali Acc: 0.200 Test Loss: 1.221 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.9388480186462402
Epoch: 10, Steps: 1 | Train Loss: 0.465 Vali Loss: 1.249 Vali Acc: 0.267 Test Loss: 1.249 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.8856515884399414
Epoch: 11, Steps: 1 | Train Loss: 0.400 Vali Loss: 1.279 Vali Acc: 0.267 Test Loss: 1.279 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.8887150287628174
Epoch: 12, Steps: 1 | Train Loss: 0.293 Vali Loss: 1.308 Vali Acc: 0.200 Test Loss: 1.308 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.9315555095672607
Epoch: 13, Steps: 1 | Train Loss: 0.249 Vali Loss: 1.337 Vali Acc: 0.200 Test Loss: 1.337 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm64_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 7154691
model size : 28.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm64_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.4373929500579834
Epoch: 1, Steps: 1 | Train Loss: 1.186 Vali Loss: 1.198 Vali Acc: 0.333 Test Loss: 1.198 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.644777774810791
Epoch: 2, Steps: 1 | Train Loss: 1.113 Vali Loss: 1.176 Vali Acc: 0.200 Test Loss: 1.176 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.67413330078125
Epoch: 3, Steps: 1 | Train Loss: 1.042 Vali Loss: 1.170 Vali Acc: 0.200 Test Loss: 1.170 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5409493446350098
Epoch: 4, Steps: 1 | Train Loss: 1.065 Vali Loss: 1.172 Vali Acc: 0.133 Test Loss: 1.172 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5430929660797119
Epoch: 5, Steps: 1 | Train Loss: 0.980 Vali Loss: 1.176 Vali Acc: 0.133 Test Loss: 1.176 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.642510175704956
Epoch: 6, Steps: 1 | Train Loss: 0.877 Vali Loss: 1.181 Vali Acc: 0.200 Test Loss: 1.181 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.6618843078613281
Epoch: 7, Steps: 1 | Train Loss: 0.831 Vali Loss: 1.188 Vali Acc: 0.200 Test Loss: 1.188 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.6271376609802246
Epoch: 8, Steps: 1 | Train Loss: 0.768 Vali Loss: 1.200 Vali Acc: 0.200 Test Loss: 1.200 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.6749520301818848
Epoch: 9, Steps: 1 | Train Loss: 0.673 Vali Loss: 1.220 Vali Acc: 0.200 Test Loss: 1.220 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.6506142616271973
Epoch: 10, Steps: 1 | Train Loss: 0.558 Vali Loss: 1.251 Vali Acc: 0.067 Test Loss: 1.251 Test Acc: 0.067
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.6906919479370117
Epoch: 11, Steps: 1 | Train Loss: 0.465 Vali Loss: 1.289 Vali Acc: 0.133 Test Loss: 1.289 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm64_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 2189571
model size : 9.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm64_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.6784555912017822
Epoch: 1, Steps: 1 | Train Loss: 1.127 Vali Loss: 1.133 Vali Acc: 0.267 Test Loss: 1.133 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.7371089458465576
Epoch: 2, Steps: 1 | Train Loss: 0.974 Vali Loss: 1.137 Vali Acc: 0.267 Test Loss: 1.137 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7552392482757568
Epoch: 3, Steps: 1 | Train Loss: 0.961 Vali Loss: 1.142 Vali Acc: 0.333 Test Loss: 1.142 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.8243181705474854
Epoch: 4, Steps: 1 | Train Loss: 0.892 Vali Loss: 1.149 Vali Acc: 0.200 Test Loss: 1.149 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7728261947631836
Epoch: 5, Steps: 1 | Train Loss: 0.839 Vali Loss: 1.156 Vali Acc: 0.267 Test Loss: 1.156 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8313741683959961
Epoch: 6, Steps: 1 | Train Loss: 0.735 Vali Loss: 1.165 Vali Acc: 0.267 Test Loss: 1.165 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.6440465450286865
Epoch: 7, Steps: 1 | Train Loss: 0.724 Vali Loss: 1.177 Vali Acc: 0.200 Test Loss: 1.177 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.7937972545623779
Epoch: 8, Steps: 1 | Train Loss: 0.654 Vali Loss: 1.195 Vali Acc: 0.200 Test Loss: 1.195 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.804375410079956
Epoch: 9, Steps: 1 | Train Loss: 0.518 Vali Loss: 1.220 Vali Acc: 0.267 Test Loss: 1.220 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.747514009475708
Epoch: 10, Steps: 1 | Train Loss: 0.477 Vali Loss: 1.248 Vali Acc: 0.267 Test Loss: 1.248 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.7998197078704834
Epoch: 11, Steps: 1 | Train Loss: 0.413 Vali Loss: 1.280 Vali Acc: 0.267 Test Loss: 1.280 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.7805876731872559
Epoch: 12, Steps: 1 | Train Loss: 0.305 Vali Loss: 1.311 Vali Acc: 0.200 Test Loss: 1.311 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.8425841331481934
Epoch: 13, Steps: 1 | Train Loss: 0.258 Vali Loss: 1.345 Vali Acc: 0.200 Test Loss: 1.345 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm64_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 7154691
model size : 28.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm64_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.495434284210205
Epoch: 1, Steps: 1 | Train Loss: 1.174 Vali Loss: 1.193 Vali Acc: 0.333 Test Loss: 1.193 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.5401167869567871
Epoch: 2, Steps: 1 | Train Loss: 1.100 Vali Loss: 1.172 Vali Acc: 0.267 Test Loss: 1.172 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5104827880859375
Epoch: 3, Steps: 1 | Train Loss: 1.037 Vali Loss: 1.166 Vali Acc: 0.200 Test Loss: 1.166 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5391736030578613
Epoch: 4, Steps: 1 | Train Loss: 1.061 Vali Loss: 1.167 Vali Acc: 0.133 Test Loss: 1.167 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5774185657501221
Epoch: 5, Steps: 1 | Train Loss: 0.973 Vali Loss: 1.171 Vali Acc: 0.133 Test Loss: 1.171 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5822265148162842
Epoch: 6, Steps: 1 | Train Loss: 0.870 Vali Loss: 1.178 Vali Acc: 0.200 Test Loss: 1.178 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.5434210300445557
Epoch: 7, Steps: 1 | Train Loss: 0.828 Vali Loss: 1.187 Vali Acc: 0.200 Test Loss: 1.187 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.5806338787078857
Epoch: 8, Steps: 1 | Train Loss: 0.763 Vali Loss: 1.201 Vali Acc: 0.200 Test Loss: 1.201 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.5801997184753418
Epoch: 9, Steps: 1 | Train Loss: 0.681 Vali Loss: 1.223 Vali Acc: 0.267 Test Loss: 1.223 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.6026208400726318
Epoch: 10, Steps: 1 | Train Loss: 0.566 Vali Loss: 1.256 Vali Acc: 0.133 Test Loss: 1.256 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.6521213054656982
Epoch: 11, Steps: 1 | Train Loss: 0.471 Vali Loss: 1.296 Vali Acc: 0.133 Test Loss: 1.296 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm64_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 2189571
model size : 9.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm32_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 4.003652095794678
Epoch: 1, Steps: 1 | Train Loss: 1.070 Vali Loss: 1.117 Vali Acc: 0.467 Test Loss: 1.117 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 1.3250751495361328
Epoch: 2, Steps: 1 | Train Loss: 1.017 Vali Loss: 1.109 Vali Acc: 0.467 Test Loss: 1.109 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 1.322873592376709
Epoch: 3, Steps: 1 | Train Loss: 0.987 Vali Loss: 1.106 Vali Acc: 0.467 Test Loss: 1.106 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 1.1385698318481445
Epoch: 4, Steps: 1 | Train Loss: 1.017 Vali Loss: 1.106 Vali Acc: 0.333 Test Loss: 1.106 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3027722835540771
Epoch: 5, Steps: 1 | Train Loss: 0.959 Vali Loss: 1.107 Vali Acc: 0.200 Test Loss: 1.107 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.3074865341186523
Epoch: 6, Steps: 1 | Train Loss: 0.889 Vali Loss: 1.110 Vali Acc: 0.200 Test Loss: 1.110 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.3588569164276123
Epoch: 7, Steps: 1 | Train Loss: 0.866 Vali Loss: 1.115 Vali Acc: 0.200 Test Loss: 1.115 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.351637363433838
Epoch: 8, Steps: 1 | Train Loss: 0.845 Vali Loss: 1.122 Vali Acc: 0.200 Test Loss: 1.122 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.333160400390625
Epoch: 9, Steps: 1 | Train Loss: 0.711 Vali Loss: 1.130 Vali Acc: 0.200 Test Loss: 1.130 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.2982585430145264
Epoch: 10, Steps: 1 | Train Loss: 0.655 Vali Loss: 1.140 Vali Acc: 0.133 Test Loss: 1.140 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.350083827972412
Epoch: 11, Steps: 1 | Train Loss: 0.591 Vali Loss: 1.152 Vali Acc: 0.133 Test Loss: 1.152 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.3410899639129639
Epoch: 12, Steps: 1 | Train Loss: 0.493 Vali Loss: 1.168 Vali Acc: 0.067 Test Loss: 1.168 Test Acc: 0.067
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.155951976776123
Epoch: 13, Steps: 1 | Train Loss: 0.514 Vali Loss: 1.182 Vali Acc: 0.133 Test Loss: 1.182 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm32_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 7093443
model size : 27.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm32_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.748429298400879
Epoch: 1, Steps: 1 | Train Loss: 1.101 Vali Loss: 1.080 Vali Acc: 0.333 Test Loss: 1.080 Test Acc: 0.333
Validation loss decreased (inf --> -0.333323).  Saving model ...
Epoch: 2 cost time: 0.758404016494751
Epoch: 2, Steps: 1 | Train Loss: 1.066 Vali Loss: 1.058 Vali Acc: 0.400 Test Loss: 1.058 Test Acc: 0.400
Validation loss decreased (-0.333323 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.7821528911590576
Epoch: 3, Steps: 1 | Train Loss: 1.015 Vali Loss: 1.044 Vali Acc: 0.533 Test Loss: 1.044 Test Acc: 0.533
Validation loss decreased (-0.399989 --> -0.533323).  Saving model ...
Epoch: 4 cost time: 0.8175632953643799
Epoch: 4, Steps: 1 | Train Loss: 1.025 Vali Loss: 1.038 Vali Acc: 0.533 Test Loss: 1.038 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 5 cost time: 0.7848334312438965
Epoch: 5, Steps: 1 | Train Loss: 0.970 Vali Loss: 1.036 Vali Acc: 0.333 Test Loss: 1.036 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7971560955047607
Epoch: 6, Steps: 1 | Train Loss: 0.924 Vali Loss: 1.038 Vali Acc: 0.400 Test Loss: 1.038 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.7754430770874023
Epoch: 7, Steps: 1 | Train Loss: 0.867 Vali Loss: 1.042 Vali Acc: 0.400 Test Loss: 1.042 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.8125598430633545
Epoch: 8, Steps: 1 | Train Loss: 0.821 Vali Loss: 1.049 Vali Acc: 0.467 Test Loss: 1.049 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.6786155700683594
Epoch: 9, Steps: 1 | Train Loss: 0.782 Vali Loss: 1.057 Vali Acc: 0.467 Test Loss: 1.057 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.8249936103820801
Epoch: 10, Steps: 1 | Train Loss: 0.722 Vali Loss: 1.064 Vali Acc: 0.467 Test Loss: 1.064 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.7399876117706299
Epoch: 11, Steps: 1 | Train Loss: 0.662 Vali Loss: 1.071 Vali Acc: 0.400 Test Loss: 1.071 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.7428383827209473
Epoch: 12, Steps: 1 | Train Loss: 0.582 Vali Loss: 1.080 Vali Acc: 0.467 Test Loss: 1.080 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.7624969482421875
Epoch: 13, Steps: 1 | Train Loss: 0.488 Vali Loss: 1.093 Vali Acc: 0.467 Test Loss: 1.093 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.7443511486053467
Epoch: 14, Steps: 1 | Train Loss: 0.479 Vali Loss: 1.110 Vali Acc: 0.400 Test Loss: 1.110 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm32_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 2128131
model size : 8.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm32_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 3.445185422897339
Epoch: 1, Steps: 1 | Train Loss: 1.064 Vali Loss: 1.115 Vali Acc: 0.467 Test Loss: 1.115 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 1.0318365097045898
Epoch: 2, Steps: 1 | Train Loss: 1.012 Vali Loss: 1.108 Vali Acc: 0.467 Test Loss: 1.108 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 1.0282258987426758
Epoch: 3, Steps: 1 | Train Loss: 0.981 Vali Loss: 1.105 Vali Acc: 0.467 Test Loss: 1.105 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 1.0400409698486328
Epoch: 4, Steps: 1 | Train Loss: 1.014 Vali Loss: 1.105 Vali Acc: 0.333 Test Loss: 1.105 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0497426986694336
Epoch: 5, Steps: 1 | Train Loss: 0.957 Vali Loss: 1.106 Vali Acc: 0.200 Test Loss: 1.106 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9516668319702148
Epoch: 6, Steps: 1 | Train Loss: 0.891 Vali Loss: 1.109 Vali Acc: 0.133 Test Loss: 1.109 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.9905214309692383
Epoch: 7, Steps: 1 | Train Loss: 0.870 Vali Loss: 1.113 Vali Acc: 0.200 Test Loss: 1.113 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.9656515121459961
Epoch: 8, Steps: 1 | Train Loss: 0.851 Vali Loss: 1.120 Vali Acc: 0.200 Test Loss: 1.120 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.9160466194152832
Epoch: 9, Steps: 1 | Train Loss: 0.726 Vali Loss: 1.128 Vali Acc: 0.200 Test Loss: 1.128 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.8997352123260498
Epoch: 10, Steps: 1 | Train Loss: 0.671 Vali Loss: 1.138 Vali Acc: 0.200 Test Loss: 1.138 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.9329102039337158
Epoch: 11, Steps: 1 | Train Loss: 0.607 Vali Loss: 1.151 Vali Acc: 0.133 Test Loss: 1.151 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.9950389862060547
Epoch: 12, Steps: 1 | Train Loss: 0.511 Vali Loss: 1.168 Vali Acc: 0.067 Test Loss: 1.168 Test Acc: 0.067
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.0073537826538086
Epoch: 13, Steps: 1 | Train Loss: 0.541 Vali Loss: 1.188 Vali Acc: 0.133 Test Loss: 1.188 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm32_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 7093443
model size : 27.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm32_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.4499552249908447
Epoch: 1, Steps: 1 | Train Loss: 1.102 Vali Loss: 1.092 Vali Acc: 0.333 Test Loss: 1.092 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.6639611721038818
Epoch: 2, Steps: 1 | Train Loss: 1.062 Vali Loss: 1.070 Vali Acc: 0.267 Test Loss: 1.070 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.700089693069458
Epoch: 3, Steps: 1 | Train Loss: 0.999 Vali Loss: 1.057 Vali Acc: 0.467 Test Loss: 1.057 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.7225980758666992
Epoch: 4, Steps: 1 | Train Loss: 1.024 Vali Loss: 1.051 Vali Acc: 0.533 Test Loss: 1.051 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 5 cost time: 0.6391851902008057
Epoch: 5, Steps: 1 | Train Loss: 0.971 Vali Loss: 1.049 Vali Acc: 0.333 Test Loss: 1.049 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.67331862449646
Epoch: 6, Steps: 1 | Train Loss: 0.922 Vali Loss: 1.051 Vali Acc: 0.400 Test Loss: 1.051 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.6897847652435303
Epoch: 7, Steps: 1 | Train Loss: 0.873 Vali Loss: 1.057 Vali Acc: 0.400 Test Loss: 1.057 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.6890954971313477
Epoch: 8, Steps: 1 | Train Loss: 0.827 Vali Loss: 1.065 Vali Acc: 0.467 Test Loss: 1.065 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.8535065650939941
Epoch: 9, Steps: 1 | Train Loss: 0.792 Vali Loss: 1.073 Vali Acc: 0.467 Test Loss: 1.073 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.6599743366241455
Epoch: 10, Steps: 1 | Train Loss: 0.743 Vali Loss: 1.082 Vali Acc: 0.400 Test Loss: 1.082 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.6683948040008545
Epoch: 11, Steps: 1 | Train Loss: 0.667 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.6339273452758789
Epoch: 12, Steps: 1 | Train Loss: 0.612 Vali Loss: 1.102 Vali Acc: 0.467 Test Loss: 1.102 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.7430565357208252
Epoch: 13, Steps: 1 | Train Loss: 0.522 Vali Loss: 1.116 Vali Acc: 0.467 Test Loss: 1.116 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.6241157054901123
Epoch: 14, Steps: 1 | Train Loss: 0.495 Vali Loss: 1.134 Vali Acc: 0.533 Test Loss: 1.134 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm32_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 2128131
model size : 8.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm32_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.950676918029785
Epoch: 1, Steps: 1 | Train Loss: 1.075 Vali Loss: 1.134 Vali Acc: 0.400 Test Loss: 1.134 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.8502662181854248
Epoch: 2, Steps: 1 | Train Loss: 1.016 Vali Loss: 1.126 Vali Acc: 0.400 Test Loss: 1.126 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.7649071216583252
Epoch: 3, Steps: 1 | Train Loss: 0.985 Vali Loss: 1.123 Vali Acc: 0.400 Test Loss: 1.123 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.7908976078033447
Epoch: 4, Steps: 1 | Train Loss: 1.023 Vali Loss: 1.123 Vali Acc: 0.133 Test Loss: 1.123 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7839007377624512
Epoch: 5, Steps: 1 | Train Loss: 0.960 Vali Loss: 1.125 Vali Acc: 0.133 Test Loss: 1.125 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8364672660827637
Epoch: 6, Steps: 1 | Train Loss: 0.900 Vali Loss: 1.129 Vali Acc: 0.067 Test Loss: 1.129 Test Acc: 0.067
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.7219431400299072
Epoch: 7, Steps: 1 | Train Loss: 0.877 Vali Loss: 1.134 Vali Acc: 0.133 Test Loss: 1.134 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.7783305644989014
Epoch: 8, Steps: 1 | Train Loss: 0.865 Vali Loss: 1.141 Vali Acc: 0.133 Test Loss: 1.141 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.8018522262573242
Epoch: 9, Steps: 1 | Train Loss: 0.739 Vali Loss: 1.151 Vali Acc: 0.133 Test Loss: 1.151 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.8562140464782715
Epoch: 10, Steps: 1 | Train Loss: 0.686 Vali Loss: 1.162 Vali Acc: 0.133 Test Loss: 1.162 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.896312952041626
Epoch: 11, Steps: 1 | Train Loss: 0.621 Vali Loss: 1.177 Vali Acc: 0.067 Test Loss: 1.177 Test Acc: 0.067
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.8754832744598389
Epoch: 12, Steps: 1 | Train Loss: 0.531 Vali Loss: 1.195 Vali Acc: 0.067 Test Loss: 1.195 Test Acc: 0.067
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.8548262119293213
Epoch: 13, Steps: 1 | Train Loss: 0.553 Vali Loss: 1.218 Vali Acc: 0.133 Test Loss: 1.218 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm32_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 7093443
model size : 27.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm32_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.1950008869171143
Epoch: 1, Steps: 1 | Train Loss: 1.102 Vali Loss: 1.136 Vali Acc: 0.267 Test Loss: 1.136 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.5951895713806152
Epoch: 2, Steps: 1 | Train Loss: 1.053 Vali Loss: 1.118 Vali Acc: 0.267 Test Loss: 1.118 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.5749552249908447
Epoch: 3, Steps: 1 | Train Loss: 1.000 Vali Loss: 1.108 Vali Acc: 0.467 Test Loss: 1.108 Test Acc: 0.467
Validation loss decreased (-0.266655 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.6567761898040771
Epoch: 4, Steps: 1 | Train Loss: 1.025 Vali Loss: 1.106 Vali Acc: 0.467 Test Loss: 1.106 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 0.5869119167327881
Epoch: 5, Steps: 1 | Train Loss: 0.952 Vali Loss: 1.108 Vali Acc: 0.267 Test Loss: 1.108 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5816442966461182
Epoch: 6, Steps: 1 | Train Loss: 0.913 Vali Loss: 1.112 Vali Acc: 0.333 Test Loss: 1.112 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.5934548377990723
Epoch: 7, Steps: 1 | Train Loss: 0.874 Vali Loss: 1.120 Vali Acc: 0.333 Test Loss: 1.120 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.6206197738647461
Epoch: 8, Steps: 1 | Train Loss: 0.828 Vali Loss: 1.129 Vali Acc: 0.400 Test Loss: 1.129 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.6232671737670898
Epoch: 9, Steps: 1 | Train Loss: 0.803 Vali Loss: 1.138 Vali Acc: 0.333 Test Loss: 1.138 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.6320464611053467
Epoch: 10, Steps: 1 | Train Loss: 0.742 Vali Loss: 1.146 Vali Acc: 0.267 Test Loss: 1.146 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.6707572937011719
Epoch: 11, Steps: 1 | Train Loss: 0.684 Vali Loss: 1.154 Vali Acc: 0.267 Test Loss: 1.154 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.5890655517578125
Epoch: 12, Steps: 1 | Train Loss: 0.611 Vali Loss: 1.164 Vali Acc: 0.333 Test Loss: 1.164 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.5749661922454834
Epoch: 13, Steps: 1 | Train Loss: 0.517 Vali Loss: 1.176 Vali Acc: 0.333 Test Loss: 1.176 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.5634047985076904
Epoch: 14, Steps: 1 | Train Loss: 0.534 Vali Loss: 1.193 Vali Acc: 0.333 Test Loss: 1.193 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm32_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 2128131
model size : 8.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm32_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.8789680004119873
Epoch: 1, Steps: 1 | Train Loss: 1.067 Vali Loss: 1.094 Vali Acc: 0.467 Test Loss: 1.094 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.9697525501251221
Epoch: 2, Steps: 1 | Train Loss: 1.009 Vali Loss: 1.094 Vali Acc: 0.400 Test Loss: 1.094 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9353339672088623
Epoch: 3, Steps: 1 | Train Loss: 0.997 Vali Loss: 1.097 Vali Acc: 0.267 Test Loss: 1.097 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8884398937225342
Epoch: 4, Steps: 1 | Train Loss: 0.948 Vali Loss: 1.100 Vali Acc: 0.200 Test Loss: 1.100 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7744312286376953
Epoch: 5, Steps: 1 | Train Loss: 0.927 Vali Loss: 1.103 Vali Acc: 0.133 Test Loss: 1.103 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.9693207740783691
Epoch: 6, Steps: 1 | Train Loss: 0.820 Vali Loss: 1.106 Vali Acc: 0.133 Test Loss: 1.106 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.0071687698364258
Epoch: 7, Steps: 1 | Train Loss: 0.749 Vali Loss: 1.110 Vali Acc: 0.200 Test Loss: 1.110 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.0007283687591553
Epoch: 8, Steps: 1 | Train Loss: 0.804 Vali Loss: 1.116 Vali Acc: 0.267 Test Loss: 1.116 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.0035998821258545
Epoch: 9, Steps: 1 | Train Loss: 0.740 Vali Loss: 1.124 Vali Acc: 0.267 Test Loss: 1.124 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.9694836139678955
Epoch: 10, Steps: 1 | Train Loss: 0.641 Vali Loss: 1.134 Vali Acc: 0.267 Test Loss: 1.134 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.101440668106079
Epoch: 11, Steps: 1 | Train Loss: 0.618 Vali Loss: 1.145 Vali Acc: 0.267 Test Loss: 1.145 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm32_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 3577923
model size : 14.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm32_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.3958146572113037
Epoch: 1, Steps: 1 | Train Loss: 1.030 Vali Loss: 1.178 Vali Acc: 0.267 Test Loss: 1.178 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.6591067314147949
Epoch: 2, Steps: 1 | Train Loss: 0.976 Vali Loss: 1.179 Vali Acc: 0.200 Test Loss: 1.179 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6233525276184082
Epoch: 3, Steps: 1 | Train Loss: 0.933 Vali Loss: 1.185 Vali Acc: 0.200 Test Loss: 1.185 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.674720048904419
Epoch: 4, Steps: 1 | Train Loss: 0.920 Vali Loss: 1.195 Vali Acc: 0.267 Test Loss: 1.195 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5634431838989258
Epoch: 5, Steps: 1 | Train Loss: 0.921 Vali Loss: 1.206 Vali Acc: 0.267 Test Loss: 1.206 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.554389476776123
Epoch: 6, Steps: 1 | Train Loss: 0.845 Vali Loss: 1.216 Vali Acc: 0.267 Test Loss: 1.216 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.538585901260376
Epoch: 7, Steps: 1 | Train Loss: 0.839 Vali Loss: 1.228 Vali Acc: 0.267 Test Loss: 1.228 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.6183881759643555
Epoch: 8, Steps: 1 | Train Loss: 0.788 Vali Loss: 1.238 Vali Acc: 0.267 Test Loss: 1.238 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.6053032875061035
Epoch: 9, Steps: 1 | Train Loss: 0.715 Vali Loss: 1.249 Vali Acc: 0.267 Test Loss: 1.249 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.608182430267334
Epoch: 10, Steps: 1 | Train Loss: 0.604 Vali Loss: 1.259 Vali Acc: 0.267 Test Loss: 1.259 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.698559045791626
Epoch: 11, Steps: 1 | Train Loss: 0.604 Vali Loss: 1.269 Vali Acc: 0.200 Test Loss: 1.269 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm32_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 1095171
model size : 4.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm32_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.631779193878174
Epoch: 1, Steps: 1 | Train Loss: 1.067 Vali Loss: 1.092 Vali Acc: 0.467 Test Loss: 1.092 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.7527520656585693
Epoch: 2, Steps: 1 | Train Loss: 1.009 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7262635231018066
Epoch: 3, Steps: 1 | Train Loss: 0.997 Vali Loss: 1.095 Vali Acc: 0.267 Test Loss: 1.095 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8255245685577393
Epoch: 4, Steps: 1 | Train Loss: 0.948 Vali Loss: 1.098 Vali Acc: 0.200 Test Loss: 1.098 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7451109886169434
Epoch: 5, Steps: 1 | Train Loss: 0.927 Vali Loss: 1.102 Vali Acc: 0.133 Test Loss: 1.102 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.6710398197174072
Epoch: 6, Steps: 1 | Train Loss: 0.820 Vali Loss: 1.105 Vali Acc: 0.133 Test Loss: 1.105 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.6789629459381104
Epoch: 7, Steps: 1 | Train Loss: 0.749 Vali Loss: 1.109 Vali Acc: 0.200 Test Loss: 1.109 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.7357301712036133
Epoch: 8, Steps: 1 | Train Loss: 0.804 Vali Loss: 1.115 Vali Acc: 0.267 Test Loss: 1.115 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.7344691753387451
Epoch: 9, Steps: 1 | Train Loss: 0.740 Vali Loss: 1.122 Vali Acc: 0.267 Test Loss: 1.122 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.9288196563720703
Epoch: 10, Steps: 1 | Train Loss: 0.641 Vali Loss: 1.132 Vali Acc: 0.267 Test Loss: 1.132 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.7859551906585693
Epoch: 11, Steps: 1 | Train Loss: 0.619 Vali Loss: 1.143 Vali Acc: 0.267 Test Loss: 1.143 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm32_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 3577923
model size : 14.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm32_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.125884771347046
Epoch: 1, Steps: 1 | Train Loss: 1.036 Vali Loss: 1.193 Vali Acc: 0.267 Test Loss: 1.193 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.5462768077850342
Epoch: 2, Steps: 1 | Train Loss: 0.979 Vali Loss: 1.194 Vali Acc: 0.200 Test Loss: 1.194 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5379548072814941
Epoch: 3, Steps: 1 | Train Loss: 0.939 Vali Loss: 1.202 Vali Acc: 0.200 Test Loss: 1.202 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6144583225250244
Epoch: 4, Steps: 1 | Train Loss: 0.929 Vali Loss: 1.212 Vali Acc: 0.267 Test Loss: 1.212 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.568047046661377
Epoch: 5, Steps: 1 | Train Loss: 0.925 Vali Loss: 1.223 Vali Acc: 0.267 Test Loss: 1.223 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.6933906078338623
Epoch: 6, Steps: 1 | Train Loss: 0.850 Vali Loss: 1.234 Vali Acc: 0.267 Test Loss: 1.234 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.5802652835845947
Epoch: 7, Steps: 1 | Train Loss: 0.843 Vali Loss: 1.247 Vali Acc: 0.267 Test Loss: 1.247 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.6316025257110596
Epoch: 8, Steps: 1 | Train Loss: 0.789 Vali Loss: 1.258 Vali Acc: 0.267 Test Loss: 1.258 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.6255762577056885
Epoch: 9, Steps: 1 | Train Loss: 0.718 Vali Loss: 1.270 Vali Acc: 0.267 Test Loss: 1.270 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.5744040012359619
Epoch: 10, Steps: 1 | Train Loss: 0.607 Vali Loss: 1.282 Vali Acc: 0.267 Test Loss: 1.282 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.5651016235351562
Epoch: 11, Steps: 1 | Train Loss: 0.610 Vali Loss: 1.293 Vali Acc: 0.267 Test Loss: 1.293 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm32_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 1095171
model size : 4.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm32_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.322690010070801
Epoch: 1, Steps: 1 | Train Loss: 1.078 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.6141440868377686
Epoch: 2, Steps: 1 | Train Loss: 1.022 Vali Loss: 1.093 Vali Acc: 0.333 Test Loss: 1.093 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6390669345855713
Epoch: 3, Steps: 1 | Train Loss: 1.014 Vali Loss: 1.096 Vali Acc: 0.200 Test Loss: 1.096 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6615169048309326
Epoch: 4, Steps: 1 | Train Loss: 0.963 Vali Loss: 1.100 Vali Acc: 0.133 Test Loss: 1.100 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.720491886138916
Epoch: 5, Steps: 1 | Train Loss: 0.949 Vali Loss: 1.103 Vali Acc: 0.133 Test Loss: 1.103 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.704423189163208
Epoch: 6, Steps: 1 | Train Loss: 0.827 Vali Loss: 1.106 Vali Acc: 0.133 Test Loss: 1.106 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.7471668720245361
Epoch: 7, Steps: 1 | Train Loss: 0.762 Vali Loss: 1.111 Vali Acc: 0.267 Test Loss: 1.111 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.7033424377441406
Epoch: 8, Steps: 1 | Train Loss: 0.819 Vali Loss: 1.117 Vali Acc: 0.267 Test Loss: 1.117 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.6261186599731445
Epoch: 9, Steps: 1 | Train Loss: 0.769 Vali Loss: 1.126 Vali Acc: 0.267 Test Loss: 1.126 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.6702890396118164
Epoch: 10, Steps: 1 | Train Loss: 0.659 Vali Loss: 1.137 Vali Acc: 0.267 Test Loss: 1.137 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.6171565055847168
Epoch: 11, Steps: 1 | Train Loss: 0.635 Vali Loss: 1.149 Vali Acc: 0.267 Test Loss: 1.149 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm32_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 3577923
model size : 14.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm32_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.058533191680908
Epoch: 1, Steps: 1 | Train Loss: 1.032 Vali Loss: 1.190 Vali Acc: 0.267 Test Loss: 1.190 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.48055195808410645
Epoch: 2, Steps: 1 | Train Loss: 0.982 Vali Loss: 1.189 Vali Acc: 0.200 Test Loss: 1.189 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.4469146728515625
Epoch: 3, Steps: 1 | Train Loss: 0.943 Vali Loss: 1.194 Vali Acc: 0.200 Test Loss: 1.194 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.475461483001709
Epoch: 4, Steps: 1 | Train Loss: 0.924 Vali Loss: 1.203 Vali Acc: 0.200 Test Loss: 1.203 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.49037957191467285
Epoch: 5, Steps: 1 | Train Loss: 0.921 Vali Loss: 1.213 Vali Acc: 0.267 Test Loss: 1.213 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.503241777420044
Epoch: 6, Steps: 1 | Train Loss: 0.850 Vali Loss: 1.224 Vali Acc: 0.267 Test Loss: 1.224 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.515711784362793
Epoch: 7, Steps: 1 | Train Loss: 0.850 Vali Loss: 1.236 Vali Acc: 0.267 Test Loss: 1.236 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.5416393280029297
Epoch: 8, Steps: 1 | Train Loss: 0.797 Vali Loss: 1.247 Vali Acc: 0.267 Test Loss: 1.247 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.5521352291107178
Epoch: 9, Steps: 1 | Train Loss: 0.730 Vali Loss: 1.259 Vali Acc: 0.267 Test Loss: 1.259 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.49281811714172363
Epoch: 10, Steps: 1 | Train Loss: 0.624 Vali Loss: 1.270 Vali Acc: 0.267 Test Loss: 1.270 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.5075221061706543
Epoch: 11, Steps: 1 | Train Loss: 0.631 Vali Loss: 1.281 Vali Acc: 0.267 Test Loss: 1.281 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm32_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 1095171
model size : 4.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm32_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.638157606124878
Epoch: 1, Steps: 1 | Train Loss: 1.052 Vali Loss: 1.131 Vali Acc: 0.333 Test Loss: 1.131 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.6731100082397461
Epoch: 2, Steps: 1 | Train Loss: 1.047 Vali Loss: 1.122 Vali Acc: 0.267 Test Loss: 1.122 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7590909004211426
Epoch: 3, Steps: 1 | Train Loss: 1.034 Vali Loss: 1.117 Vali Acc: 0.267 Test Loss: 1.117 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6992597579956055
Epoch: 4, Steps: 1 | Train Loss: 0.924 Vali Loss: 1.114 Vali Acc: 0.200 Test Loss: 1.114 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.702242374420166
Epoch: 5, Steps: 1 | Train Loss: 0.900 Vali Loss: 1.113 Vali Acc: 0.200 Test Loss: 1.113 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.6962809562683105
Epoch: 6, Steps: 1 | Train Loss: 0.904 Vali Loss: 1.115 Vali Acc: 0.133 Test Loss: 1.115 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.6623268127441406
Epoch: 7, Steps: 1 | Train Loss: 0.839 Vali Loss: 1.117 Vali Acc: 0.133 Test Loss: 1.117 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.820814847946167
Epoch: 8, Steps: 1 | Train Loss: 0.892 Vali Loss: 1.121 Vali Acc: 0.133 Test Loss: 1.121 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.8202228546142578
Epoch: 9, Steps: 1 | Train Loss: 0.755 Vali Loss: 1.127 Vali Acc: 0.200 Test Loss: 1.127 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.7223622798919678
Epoch: 10, Steps: 1 | Train Loss: 0.686 Vali Loss: 1.135 Vali Acc: 0.200 Test Loss: 1.135 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.7464308738708496
Epoch: 11, Steps: 1 | Train Loss: 0.635 Vali Loss: 1.146 Vali Acc: 0.200 Test Loss: 1.146 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm32_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 1820163
model size : 7.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm32_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.2577717304229736
Epoch: 1, Steps: 1 | Train Loss: 1.102 Vali Loss: 1.133 Vali Acc: 0.133 Test Loss: 1.133 Test Acc: 0.133
Validation loss decreased (inf --> -0.133322).  Saving model ...
Epoch: 2 cost time: 0.540459394454956
Epoch: 2, Steps: 1 | Train Loss: 1.072 Vali Loss: 1.132 Vali Acc: 0.200 Test Loss: 1.132 Test Acc: 0.200
Validation loss decreased (-0.133322 --> -0.199989).  Saving model ...
Epoch: 3 cost time: 0.575721025466919
Epoch: 3, Steps: 1 | Train Loss: 1.102 Vali Loss: 1.131 Vali Acc: 0.200 Test Loss: 1.131 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 4 cost time: 0.6455004215240479
Epoch: 4, Steps: 1 | Train Loss: 1.032 Vali Loss: 1.131 Vali Acc: 0.200 Test Loss: 1.131 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 5 cost time: 0.5723738670349121
Epoch: 5, Steps: 1 | Train Loss: 1.009 Vali Loss: 1.131 Vali Acc: 0.200 Test Loss: 1.131 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.586634635925293
Epoch: 6, Steps: 1 | Train Loss: 0.936 Vali Loss: 1.133 Vali Acc: 0.200 Test Loss: 1.133 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.5006468296051025
Epoch: 7, Steps: 1 | Train Loss: 0.890 Vali Loss: 1.135 Vali Acc: 0.200 Test Loss: 1.135 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.635045051574707
Epoch: 8, Steps: 1 | Train Loss: 0.851 Vali Loss: 1.139 Vali Acc: 0.200 Test Loss: 1.139 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.6663124561309814
Epoch: 9, Steps: 1 | Train Loss: 0.801 Vali Loss: 1.144 Vali Acc: 0.200 Test Loss: 1.144 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.5442230701446533
Epoch: 10, Steps: 1 | Train Loss: 0.751 Vali Loss: 1.151 Vali Acc: 0.200 Test Loss: 1.151 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.5716819763183594
Epoch: 11, Steps: 1 | Train Loss: 0.683 Vali Loss: 1.161 Vali Acc: 0.200 Test Loss: 1.161 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.5371561050415039
Epoch: 12, Steps: 1 | Train Loss: 0.598 Vali Loss: 1.174 Vali Acc: 0.200 Test Loss: 1.174 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.5649709701538086
Epoch: 13, Steps: 1 | Train Loss: 0.521 Vali Loss: 1.189 Vali Acc: 0.267 Test Loss: 1.189 Test Acc: 0.267
Validation loss decreased (-0.199989 --> -0.266655).  Saving model ...
Epoch: 14 cost time: 0.5558817386627197
Epoch: 14, Steps: 1 | Train Loss: 0.471 Vali Loss: 1.208 Vali Acc: 0.267 Test Loss: 1.208 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5699186325073242
Epoch: 15, Steps: 1 | Train Loss: 0.396 Vali Loss: 1.230 Vali Acc: 0.267 Test Loss: 1.230 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.5654149055480957
Epoch: 16, Steps: 1 | Train Loss: 0.359 Vali Loss: 1.253 Vali Acc: 0.267 Test Loss: 1.253 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.5526132583618164
Epoch: 17, Steps: 1 | Train Loss: 0.308 Vali Loss: 1.277 Vali Acc: 0.267 Test Loss: 1.277 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.5859906673431396
Epoch: 18, Steps: 1 | Train Loss: 0.266 Vali Loss: 1.301 Vali Acc: 0.267 Test Loss: 1.301 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.5796325206756592
Epoch: 19, Steps: 1 | Train Loss: 0.212 Vali Loss: 1.326 Vali Acc: 0.267 Test Loss: 1.326 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.6335830688476562
Epoch: 20, Steps: 1 | Train Loss: 0.175 Vali Loss: 1.354 Vali Acc: 0.267 Test Loss: 1.354 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.658193826675415
Epoch: 21, Steps: 1 | Train Loss: 0.135 Vali Loss: 1.386 Vali Acc: 0.267 Test Loss: 1.386 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.5842173099517822
Epoch: 22, Steps: 1 | Train Loss: 0.115 Vali Loss: 1.421 Vali Acc: 0.267 Test Loss: 1.421 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.6859655380249023
Epoch: 23, Steps: 1 | Train Loss: 0.101 Vali Loss: 1.460 Vali Acc: 0.267 Test Loss: 1.460 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm32_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 578691
model size : 2.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm32_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.6270687580108643
Epoch: 1, Steps: 1 | Train Loss: 1.064 Vali Loss: 1.135 Vali Acc: 0.333 Test Loss: 1.135 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.6854863166809082
Epoch: 2, Steps: 1 | Train Loss: 1.053 Vali Loss: 1.126 Vali Acc: 0.267 Test Loss: 1.126 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6962659358978271
Epoch: 3, Steps: 1 | Train Loss: 1.036 Vali Loss: 1.122 Vali Acc: 0.267 Test Loss: 1.122 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7250916957855225
Epoch: 4, Steps: 1 | Train Loss: 0.928 Vali Loss: 1.119 Vali Acc: 0.200 Test Loss: 1.119 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.6477925777435303
Epoch: 5, Steps: 1 | Train Loss: 0.899 Vali Loss: 1.119 Vali Acc: 0.200 Test Loss: 1.119 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.7164998054504395
Epoch: 6, Steps: 1 | Train Loss: 0.903 Vali Loss: 1.121 Vali Acc: 0.133 Test Loss: 1.121 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.7073659896850586
Epoch: 7, Steps: 1 | Train Loss: 0.844 Vali Loss: 1.125 Vali Acc: 0.133 Test Loss: 1.125 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.6903293132781982
Epoch: 8, Steps: 1 | Train Loss: 0.889 Vali Loss: 1.130 Vali Acc: 0.133 Test Loss: 1.130 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.7008514404296875
Epoch: 9, Steps: 1 | Train Loss: 0.750 Vali Loss: 1.137 Vali Acc: 0.200 Test Loss: 1.137 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.6808714866638184
Epoch: 10, Steps: 1 | Train Loss: 0.683 Vali Loss: 1.146 Vali Acc: 0.200 Test Loss: 1.146 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.6901941299438477
Epoch: 11, Steps: 1 | Train Loss: 0.629 Vali Loss: 1.158 Vali Acc: 0.200 Test Loss: 1.158 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm32_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 1820163
model size : 7.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm32_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.2791788578033447
Epoch: 1, Steps: 1 | Train Loss: 1.124 Vali Loss: 1.136 Vali Acc: 0.133 Test Loss: 1.136 Test Acc: 0.133
Validation loss decreased (inf --> -0.133322).  Saving model ...
Epoch: 2 cost time: 0.5551891326904297
Epoch: 2, Steps: 1 | Train Loss: 1.094 Vali Loss: 1.135 Vali Acc: 0.133 Test Loss: 1.135 Test Acc: 0.133
Validation loss decreased (-0.133322 --> -0.133322).  Saving model ...
Epoch: 3 cost time: 0.5920968055725098
Epoch: 3, Steps: 1 | Train Loss: 1.116 Vali Loss: 1.135 Vali Acc: 0.200 Test Loss: 1.135 Test Acc: 0.200
Validation loss decreased (-0.133322 --> -0.199989).  Saving model ...
Epoch: 4 cost time: 0.5645148754119873
Epoch: 4, Steps: 1 | Train Loss: 1.053 Vali Loss: 1.135 Vali Acc: 0.200 Test Loss: 1.135 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.664421796798706
Epoch: 5, Steps: 1 | Train Loss: 1.024 Vali Loss: 1.137 Vali Acc: 0.200 Test Loss: 1.137 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.6151342391967773
Epoch: 6, Steps: 1 | Train Loss: 0.944 Vali Loss: 1.139 Vali Acc: 0.267 Test Loss: 1.139 Test Acc: 0.267
Validation loss decreased (-0.199989 --> -0.266655).  Saving model ...
Epoch: 7 cost time: 0.5338602066040039
Epoch: 7, Steps: 1 | Train Loss: 0.893 Vali Loss: 1.142 Vali Acc: 0.200 Test Loss: 1.142 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5359344482421875
Epoch: 8, Steps: 1 | Train Loss: 0.861 Vali Loss: 1.147 Vali Acc: 0.200 Test Loss: 1.147 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.5347709655761719
Epoch: 9, Steps: 1 | Train Loss: 0.812 Vali Loss: 1.154 Vali Acc: 0.267 Test Loss: 1.154 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.5348227024078369
Epoch: 10, Steps: 1 | Train Loss: 0.765 Vali Loss: 1.163 Vali Acc: 0.200 Test Loss: 1.163 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.5089278221130371
Epoch: 11, Steps: 1 | Train Loss: 0.683 Vali Loss: 1.175 Vali Acc: 0.200 Test Loss: 1.175 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.5991129875183105
Epoch: 12, Steps: 1 | Train Loss: 0.599 Vali Loss: 1.190 Vali Acc: 0.200 Test Loss: 1.190 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.5040700435638428
Epoch: 13, Steps: 1 | Train Loss: 0.519 Vali Loss: 1.208 Vali Acc: 0.200 Test Loss: 1.208 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.5778617858886719
Epoch: 14, Steps: 1 | Train Loss: 0.470 Vali Loss: 1.231 Vali Acc: 0.267 Test Loss: 1.231 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.5550210475921631
Epoch: 15, Steps: 1 | Train Loss: 0.395 Vali Loss: 1.256 Vali Acc: 0.267 Test Loss: 1.256 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.6131904125213623
Epoch: 16, Steps: 1 | Train Loss: 0.358 Vali Loss: 1.283 Vali Acc: 0.267 Test Loss: 1.283 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm32_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 578691
model size : 2.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm32_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.499812126159668
Epoch: 1, Steps: 1 | Train Loss: 1.051 Vali Loss: 1.118 Vali Acc: 0.333 Test Loss: 1.118 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.6577253341674805
Epoch: 2, Steps: 1 | Train Loss: 1.053 Vali Loss: 1.109 Vali Acc: 0.267 Test Loss: 1.109 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.732987642288208
Epoch: 3, Steps: 1 | Train Loss: 1.033 Vali Loss: 1.104 Vali Acc: 0.267 Test Loss: 1.104 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7850494384765625
Epoch: 4, Steps: 1 | Train Loss: 0.926 Vali Loss: 1.101 Vali Acc: 0.133 Test Loss: 1.101 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.6484417915344238
Epoch: 5, Steps: 1 | Train Loss: 0.905 Vali Loss: 1.101 Vali Acc: 0.200 Test Loss: 1.101 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.6204752922058105
Epoch: 6, Steps: 1 | Train Loss: 0.902 Vali Loss: 1.103 Vali Acc: 0.133 Test Loss: 1.103 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.6383185386657715
Epoch: 7, Steps: 1 | Train Loss: 0.848 Vali Loss: 1.106 Vali Acc: 0.133 Test Loss: 1.106 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.6554968357086182
Epoch: 8, Steps: 1 | Train Loss: 0.905 Vali Loss: 1.112 Vali Acc: 0.133 Test Loss: 1.112 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.7035436630249023
Epoch: 9, Steps: 1 | Train Loss: 0.763 Vali Loss: 1.118 Vali Acc: 0.133 Test Loss: 1.118 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.6733870506286621
Epoch: 10, Steps: 1 | Train Loss: 0.712 Vali Loss: 1.128 Vali Acc: 0.267 Test Loss: 1.128 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.6491374969482422
Epoch: 11, Steps: 1 | Train Loss: 0.652 Vali Loss: 1.139 Vali Acc: 0.200 Test Loss: 1.139 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm32_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 1820163
model size : 7.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm32_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.2662434577941895
Epoch: 1, Steps: 1 | Train Loss: 1.131 Vali Loss: 1.147 Vali Acc: 0.200 Test Loss: 1.147 Test Acc: 0.200
Validation loss decreased (inf --> -0.199989).  Saving model ...
Epoch: 2 cost time: 0.5451526641845703
Epoch: 2, Steps: 1 | Train Loss: 1.106 Vali Loss: 1.146 Vali Acc: 0.200 Test Loss: 1.146 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 3 cost time: 0.5871007442474365
Epoch: 3, Steps: 1 | Train Loss: 1.117 Vali Loss: 1.145 Vali Acc: 0.133 Test Loss: 1.145 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6266531944274902
Epoch: 4, Steps: 1 | Train Loss: 1.042 Vali Loss: 1.145 Vali Acc: 0.200 Test Loss: 1.145 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 5 cost time: 0.5718097686767578
Epoch: 5, Steps: 1 | Train Loss: 1.030 Vali Loss: 1.146 Vali Acc: 0.200 Test Loss: 1.146 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5551693439483643
Epoch: 6, Steps: 1 | Train Loss: 0.941 Vali Loss: 1.148 Vali Acc: 0.200 Test Loss: 1.148 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.5271327495574951
Epoch: 7, Steps: 1 | Train Loss: 0.904 Vali Loss: 1.150 Vali Acc: 0.200 Test Loss: 1.150 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.5423626899719238
Epoch: 8, Steps: 1 | Train Loss: 0.879 Vali Loss: 1.155 Vali Acc: 0.133 Test Loss: 1.155 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.5635566711425781
Epoch: 9, Steps: 1 | Train Loss: 0.833 Vali Loss: 1.161 Vali Acc: 0.200 Test Loss: 1.161 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.49023914337158203
Epoch: 10, Steps: 1 | Train Loss: 0.789 Vali Loss: 1.169 Vali Acc: 0.333 Test Loss: 1.169 Test Acc: 0.333
Validation loss decreased (-0.199989 --> -0.333322).  Saving model ...
Epoch: 11 cost time: 0.6266536712646484
Epoch: 11, Steps: 1 | Train Loss: 0.704 Vali Loss: 1.180 Vali Acc: 0.333 Test Loss: 1.180 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.583524227142334
Epoch: 12, Steps: 1 | Train Loss: 0.624 Vali Loss: 1.195 Vali Acc: 0.333 Test Loss: 1.195 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.5547492504119873
Epoch: 13, Steps: 1 | Train Loss: 0.545 Vali Loss: 1.211 Vali Acc: 0.333 Test Loss: 1.211 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.5873913764953613
Epoch: 14, Steps: 1 | Train Loss: 0.514 Vali Loss: 1.231 Vali Acc: 0.333 Test Loss: 1.231 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.6110258102416992
Epoch: 15, Steps: 1 | Train Loss: 0.438 Vali Loss: 1.252 Vali Acc: 0.333 Test Loss: 1.252 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.5784039497375488
Epoch: 16, Steps: 1 | Train Loss: 0.399 Vali Loss: 1.275 Vali Acc: 0.333 Test Loss: 1.275 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.576509952545166
Epoch: 17, Steps: 1 | Train Loss: 0.345 Vali Loss: 1.298 Vali Acc: 0.333 Test Loss: 1.298 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.587913990020752
Epoch: 18, Steps: 1 | Train Loss: 0.306 Vali Loss: 1.319 Vali Acc: 0.333 Test Loss: 1.319 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.5677447319030762
Epoch: 19, Steps: 1 | Train Loss: 0.255 Vali Loss: 1.342 Vali Acc: 0.333 Test Loss: 1.342 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.5928745269775391
Epoch: 20, Steps: 1 | Train Loss: 0.212 Vali Loss: 1.365 Vali Acc: 0.333 Test Loss: 1.365 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm32_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 578691
model size : 2.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm16_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 3.3967442512512207
Epoch: 1, Steps: 1 | Train Loss: 1.202 Vali Loss: 1.082 Vali Acc: 0.400 Test Loss: 1.082 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.9970188140869141
Epoch: 2, Steps: 1 | Train Loss: 1.094 Vali Loss: 1.073 Vali Acc: 0.400 Test Loss: 1.073 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.915576696395874
Epoch: 3, Steps: 1 | Train Loss: 1.053 Vali Loss: 1.069 Vali Acc: 0.400 Test Loss: 1.069 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 1.073655366897583
Epoch: 4, Steps: 1 | Train Loss: 1.069 Vali Loss: 1.066 Vali Acc: 0.467 Test Loss: 1.066 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 1.12736177444458
Epoch: 5, Steps: 1 | Train Loss: 1.047 Vali Loss: 1.066 Vali Acc: 0.467 Test Loss: 1.066 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 6 cost time: 0.8986203670501709
Epoch: 6, Steps: 1 | Train Loss: 0.975 Vali Loss: 1.067 Vali Acc: 0.400 Test Loss: 1.067 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0491766929626465
Epoch: 7, Steps: 1 | Train Loss: 0.936 Vali Loss: 1.068 Vali Acc: 0.400 Test Loss: 1.068 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.878326416015625
Epoch: 8, Steps: 1 | Train Loss: 0.953 Vali Loss: 1.070 Vali Acc: 0.267 Test Loss: 1.070 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.9641127586364746
Epoch: 9, Steps: 1 | Train Loss: 0.894 Vali Loss: 1.072 Vali Acc: 0.333 Test Loss: 1.072 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.0920398235321045
Epoch: 10, Steps: 1 | Train Loss: 0.857 Vali Loss: 1.074 Vali Acc: 0.400 Test Loss: 1.074 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.0470662117004395
Epoch: 11, Steps: 1 | Train Loss: 0.848 Vali Loss: 1.077 Vali Acc: 0.467 Test Loss: 1.077 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.1236653327941895
Epoch: 12, Steps: 1 | Train Loss: 0.798 Vali Loss: 1.080 Vali Acc: 0.467 Test Loss: 1.080 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.0410056114196777
Epoch: 13, Steps: 1 | Train Loss: 0.726 Vali Loss: 1.084 Vali Acc: 0.467 Test Loss: 1.084 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.8966052532196045
Epoch: 14, Steps: 1 | Train Loss: 0.702 Vali Loss: 1.088 Vali Acc: 0.400 Test Loss: 1.088 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.0551435947418213
Epoch: 15, Steps: 1 | Train Loss: 0.707 Vali Loss: 1.092 Vali Acc: 0.400 Test Loss: 1.092 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm16_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 1789539
model size : 7.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm16_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.715315341949463
Epoch: 1, Steps: 1 | Train Loss: 1.059 Vali Loss: 1.153 Vali Acc: 0.333 Test Loss: 1.153 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.7760567665100098
Epoch: 2, Steps: 1 | Train Loss: 1.084 Vali Loss: 1.157 Vali Acc: 0.333 Test Loss: 1.157 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7489707469940186
Epoch: 3, Steps: 1 | Train Loss: 1.020 Vali Loss: 1.162 Vali Acc: 0.333 Test Loss: 1.162 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7297947406768799
Epoch: 4, Steps: 1 | Train Loss: 0.969 Vali Loss: 1.167 Vali Acc: 0.333 Test Loss: 1.167 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7098345756530762
Epoch: 5, Steps: 1 | Train Loss: 0.996 Vali Loss: 1.173 Vali Acc: 0.333 Test Loss: 1.173 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.6892895698547363
Epoch: 6, Steps: 1 | Train Loss: 0.966 Vali Loss: 1.178 Vali Acc: 0.267 Test Loss: 1.178 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.7425405979156494
Epoch: 7, Steps: 1 | Train Loss: 0.883 Vali Loss: 1.184 Vali Acc: 0.200 Test Loss: 1.184 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.7358794212341309
Epoch: 8, Steps: 1 | Train Loss: 0.968 Vali Loss: 1.191 Vali Acc: 0.200 Test Loss: 1.191 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.7703406810760498
Epoch: 9, Steps: 1 | Train Loss: 0.801 Vali Loss: 1.199 Vali Acc: 0.200 Test Loss: 1.199 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.7087652683258057
Epoch: 10, Steps: 1 | Train Loss: 0.861 Vali Loss: 1.207 Vali Acc: 0.200 Test Loss: 1.207 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.7338552474975586
Epoch: 11, Steps: 1 | Train Loss: 0.801 Vali Loss: 1.216 Vali Acc: 0.133 Test Loss: 1.216 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm16_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 547971
model size : 2.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm16_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 3.2195181846618652
Epoch: 1, Steps: 1 | Train Loss: 1.205 Vali Loss: 1.078 Vali Acc: 0.400 Test Loss: 1.078 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.9532511234283447
Epoch: 2, Steps: 1 | Train Loss: 1.095 Vali Loss: 1.070 Vali Acc: 0.400 Test Loss: 1.070 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.890639066696167
Epoch: 3, Steps: 1 | Train Loss: 1.057 Vali Loss: 1.065 Vali Acc: 0.400 Test Loss: 1.065 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.896639347076416
Epoch: 4, Steps: 1 | Train Loss: 1.071 Vali Loss: 1.063 Vali Acc: 0.467 Test Loss: 1.063 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 0.969102144241333
Epoch: 5, Steps: 1 | Train Loss: 1.045 Vali Loss: 1.063 Vali Acc: 0.467 Test Loss: 1.063 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 6 cost time: 0.9068787097930908
Epoch: 6, Steps: 1 | Train Loss: 0.978 Vali Loss: 1.063 Vali Acc: 0.400 Test Loss: 1.063 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.869488000869751
Epoch: 7, Steps: 1 | Train Loss: 0.943 Vali Loss: 1.065 Vali Acc: 0.400 Test Loss: 1.065 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.8380601406097412
Epoch: 8, Steps: 1 | Train Loss: 0.952 Vali Loss: 1.066 Vali Acc: 0.333 Test Loss: 1.066 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.8539328575134277
Epoch: 9, Steps: 1 | Train Loss: 0.895 Vali Loss: 1.068 Vali Acc: 0.333 Test Loss: 1.068 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.8879969120025635
Epoch: 10, Steps: 1 | Train Loss: 0.862 Vali Loss: 1.071 Vali Acc: 0.467 Test Loss: 1.071 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.0286643505096436
Epoch: 11, Steps: 1 | Train Loss: 0.848 Vali Loss: 1.074 Vali Acc: 0.533 Test Loss: 1.074 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 12 cost time: 0.9162633419036865
Epoch: 12, Steps: 1 | Train Loss: 0.803 Vali Loss: 1.077 Vali Acc: 0.467 Test Loss: 1.077 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8526873588562012
Epoch: 13, Steps: 1 | Train Loss: 0.733 Vali Loss: 1.080 Vali Acc: 0.467 Test Loss: 1.080 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.8987066745758057
Epoch: 14, Steps: 1 | Train Loss: 0.711 Vali Loss: 1.084 Vali Acc: 0.400 Test Loss: 1.084 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.9243783950805664
Epoch: 15, Steps: 1 | Train Loss: 0.715 Vali Loss: 1.088 Vali Acc: 0.400 Test Loss: 1.088 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.9677622318267822
Epoch: 16, Steps: 1 | Train Loss: 0.613 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.8810250759124756
Epoch: 17, Steps: 1 | Train Loss: 0.567 Vali Loss: 1.101 Vali Acc: 0.400 Test Loss: 1.101 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.8669328689575195
Epoch: 18, Steps: 1 | Train Loss: 0.478 Vali Loss: 1.110 Vali Acc: 0.400 Test Loss: 1.110 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.9081788063049316
Epoch: 19, Steps: 1 | Train Loss: 0.481 Vali Loss: 1.121 Vali Acc: 0.333 Test Loss: 1.121 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.8629300594329834
Epoch: 20, Steps: 1 | Train Loss: 0.483 Vali Loss: 1.134 Vali Acc: 0.267 Test Loss: 1.134 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.8163249492645264
Epoch: 21, Steps: 1 | Train Loss: 0.420 Vali Loss: 1.148 Vali Acc: 0.267 Test Loss: 1.148 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm16_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 1789539
model size : 7.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm16_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.8799936771392822
Epoch: 1, Steps: 1 | Train Loss: 1.074 Vali Loss: 1.155 Vali Acc: 0.267 Test Loss: 1.155 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.6347198486328125
Epoch: 2, Steps: 1 | Train Loss: 1.083 Vali Loss: 1.159 Vali Acc: 0.267 Test Loss: 1.159 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6043932437896729
Epoch: 3, Steps: 1 | Train Loss: 1.024 Vali Loss: 1.164 Vali Acc: 0.333 Test Loss: 1.164 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.6275839805603027
Epoch: 4, Steps: 1 | Train Loss: 0.979 Vali Loss: 1.169 Vali Acc: 0.333 Test Loss: 1.169 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6895034313201904
Epoch: 5, Steps: 1 | Train Loss: 0.996 Vali Loss: 1.175 Vali Acc: 0.333 Test Loss: 1.175 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.6484315395355225
Epoch: 6, Steps: 1 | Train Loss: 0.971 Vali Loss: 1.180 Vali Acc: 0.267 Test Loss: 1.180 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.6877801418304443
Epoch: 7, Steps: 1 | Train Loss: 0.889 Vali Loss: 1.186 Vali Acc: 0.200 Test Loss: 1.186 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.6420161724090576
Epoch: 8, Steps: 1 | Train Loss: 0.978 Vali Loss: 1.192 Vali Acc: 0.200 Test Loss: 1.192 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.6835203170776367
Epoch: 9, Steps: 1 | Train Loss: 0.808 Vali Loss: 1.200 Vali Acc: 0.200 Test Loss: 1.200 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.7802333831787109
Epoch: 10, Steps: 1 | Train Loss: 0.869 Vali Loss: 1.208 Vali Acc: 0.200 Test Loss: 1.208 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.6459939479827881
Epoch: 11, Steps: 1 | Train Loss: 0.810 Vali Loss: 1.217 Vali Acc: 0.133 Test Loss: 1.217 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.5839123725891113
Epoch: 12, Steps: 1 | Train Loss: 0.779 Vali Loss: 1.227 Vali Acc: 0.133 Test Loss: 1.227 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.6538097858428955
Epoch: 13, Steps: 1 | Train Loss: 0.684 Vali Loss: 1.238 Vali Acc: 0.200 Test Loss: 1.238 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm16_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 547971
model size : 2.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm16_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.584958791732788
Epoch: 1, Steps: 1 | Train Loss: 1.214 Vali Loss: 1.086 Vali Acc: 0.400 Test Loss: 1.086 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.6060471534729004
Epoch: 2, Steps: 1 | Train Loss: 1.091 Vali Loss: 1.079 Vali Acc: 0.400 Test Loss: 1.079 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.667717695236206
Epoch: 3, Steps: 1 | Train Loss: 1.063 Vali Loss: 1.076 Vali Acc: 0.400 Test Loss: 1.076 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.65901780128479
Epoch: 4, Steps: 1 | Train Loss: 1.069 Vali Loss: 1.075 Vali Acc: 0.400 Test Loss: 1.075 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.710010290145874
Epoch: 5, Steps: 1 | Train Loss: 1.047 Vali Loss: 1.076 Vali Acc: 0.467 Test Loss: 1.076 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 6 cost time: 0.6994092464447021
Epoch: 6, Steps: 1 | Train Loss: 0.987 Vali Loss: 1.078 Vali Acc: 0.400 Test Loss: 1.078 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7734541893005371
Epoch: 7, Steps: 1 | Train Loss: 0.942 Vali Loss: 1.081 Vali Acc: 0.400 Test Loss: 1.081 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.696690559387207
Epoch: 8, Steps: 1 | Train Loss: 0.956 Vali Loss: 1.084 Vali Acc: 0.400 Test Loss: 1.084 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.7952780723571777
Epoch: 9, Steps: 1 | Train Loss: 0.904 Vali Loss: 1.088 Vali Acc: 0.400 Test Loss: 1.088 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.682774543762207
Epoch: 10, Steps: 1 | Train Loss: 0.869 Vali Loss: 1.093 Vali Acc: 0.467 Test Loss: 1.093 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.7658302783966064
Epoch: 11, Steps: 1 | Train Loss: 0.860 Vali Loss: 1.098 Vali Acc: 0.533 Test Loss: 1.098 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 12 cost time: 0.7604012489318848
Epoch: 12, Steps: 1 | Train Loss: 0.818 Vali Loss: 1.103 Vali Acc: 0.467 Test Loss: 1.103 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7895174026489258
Epoch: 13, Steps: 1 | Train Loss: 0.747 Vali Loss: 1.108 Vali Acc: 0.400 Test Loss: 1.108 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.6694149971008301
Epoch: 14, Steps: 1 | Train Loss: 0.725 Vali Loss: 1.113 Vali Acc: 0.400 Test Loss: 1.113 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.7095229625701904
Epoch: 15, Steps: 1 | Train Loss: 0.733 Vali Loss: 1.119 Vali Acc: 0.400 Test Loss: 1.119 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.7327330112457275
Epoch: 16, Steps: 1 | Train Loss: 0.628 Vali Loss: 1.126 Vali Acc: 0.400 Test Loss: 1.126 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.6832625865936279
Epoch: 17, Steps: 1 | Train Loss: 0.581 Vali Loss: 1.134 Vali Acc: 0.400 Test Loss: 1.134 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.7739038467407227
Epoch: 18, Steps: 1 | Train Loss: 0.491 Vali Loss: 1.144 Vali Acc: 0.333 Test Loss: 1.144 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.7566070556640625
Epoch: 19, Steps: 1 | Train Loss: 0.495 Vali Loss: 1.157 Vali Acc: 0.267 Test Loss: 1.157 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.6452414989471436
Epoch: 20, Steps: 1 | Train Loss: 0.494 Vali Loss: 1.171 Vali Acc: 0.267 Test Loss: 1.171 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.7297217845916748
Epoch: 21, Steps: 1 | Train Loss: 0.427 Vali Loss: 1.187 Vali Acc: 0.267 Test Loss: 1.187 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm16_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 1789539
model size : 7.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm16_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.333280563354492
Epoch: 1, Steps: 1 | Train Loss: 1.086 Vali Loss: 1.133 Vali Acc: 0.333 Test Loss: 1.133 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.5667212009429932
Epoch: 2, Steps: 1 | Train Loss: 1.086 Vali Loss: 1.137 Vali Acc: 0.267 Test Loss: 1.137 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7388699054718018
Epoch: 3, Steps: 1 | Train Loss: 1.028 Vali Loss: 1.141 Vali Acc: 0.267 Test Loss: 1.141 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7296011447906494
Epoch: 4, Steps: 1 | Train Loss: 0.983 Vali Loss: 1.146 Vali Acc: 0.267 Test Loss: 1.146 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.6712486743927002
Epoch: 5, Steps: 1 | Train Loss: 1.004 Vali Loss: 1.151 Vali Acc: 0.267 Test Loss: 1.151 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.6850483417510986
Epoch: 6, Steps: 1 | Train Loss: 0.977 Vali Loss: 1.156 Vali Acc: 0.200 Test Loss: 1.156 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.6361768245697021
Epoch: 7, Steps: 1 | Train Loss: 0.890 Vali Loss: 1.162 Vali Acc: 0.133 Test Loss: 1.162 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.556523323059082
Epoch: 8, Steps: 1 | Train Loss: 0.978 Vali Loss: 1.169 Vali Acc: 0.133 Test Loss: 1.169 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.6492884159088135
Epoch: 9, Steps: 1 | Train Loss: 0.800 Vali Loss: 1.177 Vali Acc: 0.133 Test Loss: 1.177 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.5753726959228516
Epoch: 10, Steps: 1 | Train Loss: 0.873 Vali Loss: 1.186 Vali Acc: 0.133 Test Loss: 1.186 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.6816322803497314
Epoch: 11, Steps: 1 | Train Loss: 0.815 Vali Loss: 1.196 Vali Acc: 0.200 Test Loss: 1.196 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm16_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 547971
model size : 2.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm16_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.8084678649902344
Epoch: 1, Steps: 1 | Train Loss: 1.148 Vali Loss: 1.119 Vali Acc: 0.333 Test Loss: 1.119 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.7213597297668457
Epoch: 2, Steps: 1 | Train Loss: 1.069 Vali Loss: 1.120 Vali Acc: 0.200 Test Loss: 1.120 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8780052661895752
Epoch: 3, Steps: 1 | Train Loss: 1.011 Vali Loss: 1.120 Vali Acc: 0.267 Test Loss: 1.120 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8994097709655762
Epoch: 4, Steps: 1 | Train Loss: 1.026 Vali Loss: 1.120 Vali Acc: 0.267 Test Loss: 1.120 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.9132046699523926
Epoch: 5, Steps: 1 | Train Loss: 0.924 Vali Loss: 1.120 Vali Acc: 0.267 Test Loss: 1.120 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.8851125240325928
Epoch: 6, Steps: 1 | Train Loss: 0.937 Vali Loss: 1.121 Vali Acc: 0.267 Test Loss: 1.121 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.837456226348877
Epoch: 7, Steps: 1 | Train Loss: 0.947 Vali Loss: 1.121 Vali Acc: 0.333 Test Loss: 1.121 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.9872362613677979
Epoch: 8, Steps: 1 | Train Loss: 0.902 Vali Loss: 1.121 Vali Acc: 0.333 Test Loss: 1.121 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.0132005214691162
Epoch: 9, Steps: 1 | Train Loss: 0.876 Vali Loss: 1.122 Vali Acc: 0.333 Test Loss: 1.122 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.8909163475036621
Epoch: 10, Steps: 1 | Train Loss: 0.851 Vali Loss: 1.123 Vali Acc: 0.400 Test Loss: 1.123 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 11 cost time: 0.8901669979095459
Epoch: 11, Steps: 1 | Train Loss: 0.804 Vali Loss: 1.125 Vali Acc: 0.400 Test Loss: 1.125 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9943466186523438
Epoch: 12, Steps: 1 | Train Loss: 0.765 Vali Loss: 1.127 Vali Acc: 0.333 Test Loss: 1.127 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9169340133666992
Epoch: 13, Steps: 1 | Train Loss: 0.742 Vali Loss: 1.130 Vali Acc: 0.333 Test Loss: 1.130 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.9002583026885986
Epoch: 14, Steps: 1 | Train Loss: 0.696 Vali Loss: 1.134 Vali Acc: 0.267 Test Loss: 1.134 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.8508865833282471
Epoch: 15, Steps: 1 | Train Loss: 0.679 Vali Loss: 1.138 Vali Acc: 0.333 Test Loss: 1.138 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.8458218574523926
Epoch: 16, Steps: 1 | Train Loss: 0.631 Vali Loss: 1.144 Vali Acc: 0.333 Test Loss: 1.144 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.8738830089569092
Epoch: 17, Steps: 1 | Train Loss: 0.592 Vali Loss: 1.151 Vali Acc: 0.333 Test Loss: 1.151 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.838432788848877
Epoch: 18, Steps: 1 | Train Loss: 0.527 Vali Loss: 1.157 Vali Acc: 0.267 Test Loss: 1.157 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.9622554779052734
Epoch: 19, Steps: 1 | Train Loss: 0.517 Vali Loss: 1.163 Vali Acc: 0.333 Test Loss: 1.163 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.0332458019256592
Epoch: 20, Steps: 1 | Train Loss: 0.485 Vali Loss: 1.170 Vali Acc: 0.333 Test Loss: 1.170 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm16_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 910371
model size : 3.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm16_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.6247031688690186
Epoch: 1, Steps: 1 | Train Loss: 1.115 Vali Loss: 1.045 Vali Acc: 0.533 Test Loss: 1.045 Test Acc: 0.533
Validation loss decreased (inf --> -0.533323).  Saving model ...
Epoch: 2 cost time: 0.6732861995697021
Epoch: 2, Steps: 1 | Train Loss: 1.178 Vali Loss: 1.043 Vali Acc: 0.533 Test Loss: 1.043 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 3 cost time: 0.7055253982543945
Epoch: 3, Steps: 1 | Train Loss: 1.099 Vali Loss: 1.044 Vali Acc: 0.600 Test Loss: 1.044 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599990).  Saving model ...
Epoch: 4 cost time: 0.8245294094085693
Epoch: 4, Steps: 1 | Train Loss: 1.085 Vali Loss: 1.044 Vali Acc: 0.533 Test Loss: 1.044 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9027321338653564
Epoch: 5, Steps: 1 | Train Loss: 1.131 Vali Loss: 1.045 Vali Acc: 0.533 Test Loss: 1.045 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.6266658306121826
Epoch: 6, Steps: 1 | Train Loss: 1.064 Vali Loss: 1.046 Vali Acc: 0.467 Test Loss: 1.046 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.7544505596160889
Epoch: 7, Steps: 1 | Train Loss: 0.970 Vali Loss: 1.048 Vali Acc: 0.467 Test Loss: 1.048 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.7074835300445557
Epoch: 8, Steps: 1 | Train Loss: 1.023 Vali Loss: 1.050 Vali Acc: 0.533 Test Loss: 1.050 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.80657958984375
Epoch: 9, Steps: 1 | Train Loss: 0.927 Vali Loss: 1.052 Vali Acc: 0.600 Test Loss: 1.052 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.6563410758972168
Epoch: 10, Steps: 1 | Train Loss: 0.910 Vali Loss: 1.054 Vali Acc: 0.400 Test Loss: 1.054 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.6904935836791992
Epoch: 11, Steps: 1 | Train Loss: 0.928 Vali Loss: 1.055 Vali Acc: 0.400 Test Loss: 1.055 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.6601991653442383
Epoch: 12, Steps: 1 | Train Loss: 0.850 Vali Loss: 1.056 Vali Acc: 0.467 Test Loss: 1.056 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.7567095756530762
Epoch: 13, Steps: 1 | Train Loss: 0.841 Vali Loss: 1.056 Vali Acc: 0.467 Test Loss: 1.056 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm16_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 289539
model size : 1.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm16_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.744197368621826
Epoch: 1, Steps: 1 | Train Loss: 1.148 Vali Loss: 1.122 Vali Acc: 0.267 Test Loss: 1.122 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.6864943504333496
Epoch: 2, Steps: 1 | Train Loss: 1.070 Vali Loss: 1.122 Vali Acc: 0.200 Test Loss: 1.122 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7100903987884521
Epoch: 3, Steps: 1 | Train Loss: 1.014 Vali Loss: 1.122 Vali Acc: 0.267 Test Loss: 1.122 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7944498062133789
Epoch: 4, Steps: 1 | Train Loss: 1.028 Vali Loss: 1.123 Vali Acc: 0.267 Test Loss: 1.123 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.8014931678771973
Epoch: 5, Steps: 1 | Train Loss: 0.929 Vali Loss: 1.122 Vali Acc: 0.267 Test Loss: 1.122 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.787761926651001
Epoch: 6, Steps: 1 | Train Loss: 0.938 Vali Loss: 1.123 Vali Acc: 0.267 Test Loss: 1.123 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.6666848659515381
Epoch: 7, Steps: 1 | Train Loss: 0.952 Vali Loss: 1.123 Vali Acc: 0.267 Test Loss: 1.123 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.7106611728668213
Epoch: 8, Steps: 1 | Train Loss: 0.904 Vali Loss: 1.123 Vali Acc: 0.333 Test Loss: 1.123 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 9 cost time: 0.6985228061676025
Epoch: 9, Steps: 1 | Train Loss: 0.881 Vali Loss: 1.124 Vali Acc: 0.333 Test Loss: 1.124 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7382292747497559
Epoch: 10, Steps: 1 | Train Loss: 0.852 Vali Loss: 1.126 Vali Acc: 0.333 Test Loss: 1.126 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.7336075305938721
Epoch: 11, Steps: 1 | Train Loss: 0.807 Vali Loss: 1.127 Vali Acc: 0.333 Test Loss: 1.127 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.7201871871948242
Epoch: 12, Steps: 1 | Train Loss: 0.771 Vali Loss: 1.130 Vali Acc: 0.333 Test Loss: 1.130 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.7341454029083252
Epoch: 13, Steps: 1 | Train Loss: 0.748 Vali Loss: 1.133 Vali Acc: 0.333 Test Loss: 1.133 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.7045800685882568
Epoch: 14, Steps: 1 | Train Loss: 0.701 Vali Loss: 1.137 Vali Acc: 0.267 Test Loss: 1.137 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.6353838443756104
Epoch: 15, Steps: 1 | Train Loss: 0.685 Vali Loss: 1.142 Vali Acc: 0.267 Test Loss: 1.142 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.7648749351501465
Epoch: 16, Steps: 1 | Train Loss: 0.640 Vali Loss: 1.148 Vali Acc: 0.267 Test Loss: 1.148 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.8018827438354492
Epoch: 17, Steps: 1 | Train Loss: 0.588 Vali Loss: 1.156 Vali Acc: 0.267 Test Loss: 1.156 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.7685322761535645
Epoch: 18, Steps: 1 | Train Loss: 0.535 Vali Loss: 1.163 Vali Acc: 0.267 Test Loss: 1.163 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm16_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 910371
model size : 3.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm16_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.466979503631592
Epoch: 1, Steps: 1 | Train Loss: 1.120 Vali Loss: 1.037 Vali Acc: 0.467 Test Loss: 1.037 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.6284792423248291
Epoch: 2, Steps: 1 | Train Loss: 1.186 Vali Loss: 1.036 Vali Acc: 0.533 Test Loss: 1.036 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 3 cost time: 0.6304802894592285
Epoch: 3, Steps: 1 | Train Loss: 1.106 Vali Loss: 1.036 Vali Acc: 0.600 Test Loss: 1.036 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599990).  Saving model ...
Epoch: 4 cost time: 0.6508743762969971
Epoch: 4, Steps: 1 | Train Loss: 1.086 Vali Loss: 1.037 Vali Acc: 0.533 Test Loss: 1.037 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5944478511810303
Epoch: 5, Steps: 1 | Train Loss: 1.119 Vali Loss: 1.038 Vali Acc: 0.533 Test Loss: 1.038 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.6670937538146973
Epoch: 6, Steps: 1 | Train Loss: 1.068 Vali Loss: 1.039 Vali Acc: 0.467 Test Loss: 1.039 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.5792012214660645
Epoch: 7, Steps: 1 | Train Loss: 0.975 Vali Loss: 1.041 Vali Acc: 0.467 Test Loss: 1.041 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.6251978874206543
Epoch: 8, Steps: 1 | Train Loss: 1.028 Vali Loss: 1.043 Vali Acc: 0.467 Test Loss: 1.043 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.6701598167419434
Epoch: 9, Steps: 1 | Train Loss: 0.929 Vali Loss: 1.045 Vali Acc: 0.533 Test Loss: 1.045 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.6417546272277832
Epoch: 10, Steps: 1 | Train Loss: 0.914 Vali Loss: 1.048 Vali Acc: 0.400 Test Loss: 1.048 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.5930628776550293
Epoch: 11, Steps: 1 | Train Loss: 0.926 Vali Loss: 1.049 Vali Acc: 0.400 Test Loss: 1.049 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.5833475589752197
Epoch: 12, Steps: 1 | Train Loss: 0.853 Vali Loss: 1.050 Vali Acc: 0.467 Test Loss: 1.050 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.6723644733428955
Epoch: 13, Steps: 1 | Train Loss: 0.844 Vali Loss: 1.051 Vali Acc: 0.533 Test Loss: 1.051 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm16_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 289539
model size : 1.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm16_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.6249349117279053
Epoch: 1, Steps: 1 | Train Loss: 1.143 Vali Loss: 1.115 Vali Acc: 0.267 Test Loss: 1.115 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.7764873504638672
Epoch: 2, Steps: 1 | Train Loss: 1.070 Vali Loss: 1.116 Vali Acc: 0.200 Test Loss: 1.116 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7604689598083496
Epoch: 3, Steps: 1 | Train Loss: 1.011 Vali Loss: 1.117 Vali Acc: 0.267 Test Loss: 1.117 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7253539562225342
Epoch: 4, Steps: 1 | Train Loss: 1.028 Vali Loss: 1.117 Vali Acc: 0.267 Test Loss: 1.117 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.6973519325256348
Epoch: 5, Steps: 1 | Train Loss: 0.925 Vali Loss: 1.117 Vali Acc: 0.267 Test Loss: 1.117 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.7428271770477295
Epoch: 6, Steps: 1 | Train Loss: 0.937 Vali Loss: 1.118 Vali Acc: 0.267 Test Loss: 1.118 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.7377219200134277
Epoch: 7, Steps: 1 | Train Loss: 0.953 Vali Loss: 1.118 Vali Acc: 0.267 Test Loss: 1.118 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.6795234680175781
Epoch: 8, Steps: 1 | Train Loss: 0.907 Vali Loss: 1.119 Vali Acc: 0.333 Test Loss: 1.119 Test Acc: 0.333
Validation loss decreased (-0.266656 --> -0.333322).  Saving model ...
Epoch: 9 cost time: 0.6906843185424805
Epoch: 9, Steps: 1 | Train Loss: 0.881 Vali Loss: 1.120 Vali Acc: 0.333 Test Loss: 1.120 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7646865844726562
Epoch: 10, Steps: 1 | Train Loss: 0.852 Vali Loss: 1.122 Vali Acc: 0.333 Test Loss: 1.122 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.6727972030639648
Epoch: 11, Steps: 1 | Train Loss: 0.810 Vali Loss: 1.124 Vali Acc: 0.400 Test Loss: 1.124 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 12 cost time: 0.6411705017089844
Epoch: 12, Steps: 1 | Train Loss: 0.772 Vali Loss: 1.127 Vali Acc: 0.333 Test Loss: 1.127 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7150535583496094
Epoch: 13, Steps: 1 | Train Loss: 0.752 Vali Loss: 1.131 Vali Acc: 0.400 Test Loss: 1.131 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.664036750793457
Epoch: 14, Steps: 1 | Train Loss: 0.708 Vali Loss: 1.136 Vali Acc: 0.333 Test Loss: 1.136 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.7448785305023193
Epoch: 15, Steps: 1 | Train Loss: 0.692 Vali Loss: 1.142 Vali Acc: 0.333 Test Loss: 1.142 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.7246413230895996
Epoch: 16, Steps: 1 | Train Loss: 0.648 Vali Loss: 1.149 Vali Acc: 0.400 Test Loss: 1.149 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.7640986442565918
Epoch: 17, Steps: 1 | Train Loss: 0.594 Vali Loss: 1.157 Vali Acc: 0.333 Test Loss: 1.157 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.6522581577301025
Epoch: 18, Steps: 1 | Train Loss: 0.541 Vali Loss: 1.164 Vali Acc: 0.333 Test Loss: 1.164 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.6667220592498779
Epoch: 19, Steps: 1 | Train Loss: 0.531 Vali Loss: 1.171 Vali Acc: 0.267 Test Loss: 1.171 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.6480216979980469
Epoch: 20, Steps: 1 | Train Loss: 0.496 Vali Loss: 1.180 Vali Acc: 0.267 Test Loss: 1.180 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.8010308742523193
Epoch: 21, Steps: 1 | Train Loss: 0.435 Vali Loss: 1.189 Vali Acc: 0.267 Test Loss: 1.189 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm16_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 910371
model size : 3.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm16_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.5137858390808105
Epoch: 1, Steps: 1 | Train Loss: 1.126 Vali Loss: 1.038 Vali Acc: 0.333 Test Loss: 1.038 Test Acc: 0.333
Validation loss decreased (inf --> -0.333323).  Saving model ...
Epoch: 2 cost time: 0.623814582824707
Epoch: 2, Steps: 1 | Train Loss: 1.188 Vali Loss: 1.036 Vali Acc: 0.400 Test Loss: 1.036 Test Acc: 0.400
Validation loss decreased (-0.333323 --> -0.399990).  Saving model ...
Epoch: 3 cost time: 0.6577587127685547
Epoch: 3, Steps: 1 | Train Loss: 1.110 Vali Loss: 1.036 Vali Acc: 0.533 Test Loss: 1.036 Test Acc: 0.533
Validation loss decreased (-0.399990 --> -0.533323).  Saving model ...
Epoch: 4 cost time: 0.5144290924072266
Epoch: 4, Steps: 1 | Train Loss: 1.101 Vali Loss: 1.037 Vali Acc: 0.533 Test Loss: 1.037 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6135835647583008
Epoch: 5, Steps: 1 | Train Loss: 1.121 Vali Loss: 1.039 Vali Acc: 0.533 Test Loss: 1.039 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.5431804656982422
Epoch: 6, Steps: 1 | Train Loss: 1.068 Vali Loss: 1.040 Vali Acc: 0.467 Test Loss: 1.040 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.5392944812774658
Epoch: 7, Steps: 1 | Train Loss: 0.984 Vali Loss: 1.042 Vali Acc: 0.467 Test Loss: 1.042 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.5340785980224609
Epoch: 8, Steps: 1 | Train Loss: 1.040 Vali Loss: 1.044 Vali Acc: 0.533 Test Loss: 1.044 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.5786318778991699
Epoch: 9, Steps: 1 | Train Loss: 0.937 Vali Loss: 1.047 Vali Acc: 0.533 Test Loss: 1.047 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.5974035263061523
Epoch: 10, Steps: 1 | Train Loss: 0.931 Vali Loss: 1.050 Vali Acc: 0.467 Test Loss: 1.050 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.5665504932403564
Epoch: 11, Steps: 1 | Train Loss: 0.935 Vali Loss: 1.052 Vali Acc: 0.467 Test Loss: 1.052 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.5351860523223877
Epoch: 12, Steps: 1 | Train Loss: 0.867 Vali Loss: 1.053 Vali Acc: 0.533 Test Loss: 1.053 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.535550594329834
Epoch: 13, Steps: 1 | Train Loss: 0.857 Vali Loss: 1.055 Vali Acc: 0.467 Test Loss: 1.055 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm16_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 289539
model size : 1.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm16_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.9906017780303955
Epoch: 1, Steps: 1 | Train Loss: 1.126 Vali Loss: 1.131 Vali Acc: 0.267 Test Loss: 1.131 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.8559980392456055
Epoch: 2, Steps: 1 | Train Loss: 1.096 Vali Loss: 1.119 Vali Acc: 0.267 Test Loss: 1.119 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.8032739162445068
Epoch: 3, Steps: 1 | Train Loss: 1.009 Vali Loss: 1.114 Vali Acc: 0.267 Test Loss: 1.114 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266656).  Saving model ...
Epoch: 4 cost time: 0.8547742366790771
Epoch: 4, Steps: 1 | Train Loss: 1.076 Vali Loss: 1.112 Vali Acc: 0.267 Test Loss: 1.112 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 5 cost time: 0.8462281227111816
Epoch: 5, Steps: 1 | Train Loss: 0.961 Vali Loss: 1.112 Vali Acc: 0.267 Test Loss: 1.112 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7890145778656006
Epoch: 6, Steps: 1 | Train Loss: 0.978 Vali Loss: 1.113 Vali Acc: 0.333 Test Loss: 1.113 Test Acc: 0.333
Validation loss decreased (-0.266656 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.7854049205780029
Epoch: 7, Steps: 1 | Train Loss: 0.901 Vali Loss: 1.115 Vali Acc: 0.467 Test Loss: 1.115 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466656).  Saving model ...
Epoch: 8 cost time: 0.770930290222168
Epoch: 8, Steps: 1 | Train Loss: 0.944 Vali Loss: 1.117 Vali Acc: 0.533 Test Loss: 1.117 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 9 cost time: 0.8408167362213135
Epoch: 9, Steps: 1 | Train Loss: 0.886 Vali Loss: 1.120 Vali Acc: 0.467 Test Loss: 1.120 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9117200374603271
Epoch: 10, Steps: 1 | Train Loss: 0.875 Vali Loss: 1.123 Vali Acc: 0.467 Test Loss: 1.123 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8147826194763184
Epoch: 11, Steps: 1 | Train Loss: 0.879 Vali Loss: 1.127 Vali Acc: 0.467 Test Loss: 1.127 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.8469157218933105
Epoch: 12, Steps: 1 | Train Loss: 0.786 Vali Loss: 1.130 Vali Acc: 0.467 Test Loss: 1.130 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.7918686866760254
Epoch: 13, Steps: 1 | Train Loss: 0.800 Vali Loss: 1.132 Vali Acc: 0.400 Test Loss: 1.132 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.8283991813659668
Epoch: 14, Steps: 1 | Train Loss: 0.748 Vali Loss: 1.136 Vali Acc: 0.400 Test Loss: 1.136 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.8653137683868408
Epoch: 15, Steps: 1 | Train Loss: 0.686 Vali Loss: 1.140 Vali Acc: 0.333 Test Loss: 1.140 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.8591480255126953
Epoch: 16, Steps: 1 | Train Loss: 0.685 Vali Loss: 1.146 Vali Acc: 0.267 Test Loss: 1.146 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.7642924785614014
Epoch: 17, Steps: 1 | Train Loss: 0.578 Vali Loss: 1.153 Vali Acc: 0.200 Test Loss: 1.153 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.7604458332061768
Epoch: 18, Steps: 1 | Train Loss: 0.539 Vali Loss: 1.160 Vali Acc: 0.200 Test Loss: 1.160 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm16_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 470787
model size : 2.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm16_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.5233943462371826
Epoch: 1, Steps: 1 | Train Loss: 1.130 Vali Loss: 1.093 Vali Acc: 0.200 Test Loss: 1.093 Test Acc: 0.200
Validation loss decreased (inf --> -0.199989).  Saving model ...
Epoch: 2 cost time: 0.6063261032104492
Epoch: 2, Steps: 1 | Train Loss: 1.118 Vali Loss: 1.088 Vali Acc: 0.200 Test Loss: 1.088 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 3 cost time: 0.6421706676483154
Epoch: 3, Steps: 1 | Train Loss: 1.007 Vali Loss: 1.085 Vali Acc: 0.200 Test Loss: 1.085 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 4 cost time: 0.6350479125976562
Epoch: 4, Steps: 1 | Train Loss: 1.018 Vali Loss: 1.084 Vali Acc: 0.200 Test Loss: 1.084 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 5 cost time: 0.6424970626831055
Epoch: 5, Steps: 1 | Train Loss: 1.001 Vali Loss: 1.086 Vali Acc: 0.267 Test Loss: 1.086 Test Acc: 0.267
Validation loss decreased (-0.199989 --> -0.266656).  Saving model ...
Epoch: 6 cost time: 0.6528921127319336
Epoch: 6, Steps: 1 | Train Loss: 0.975 Vali Loss: 1.087 Vali Acc: 0.333 Test Loss: 1.087 Test Acc: 0.333
Validation loss decreased (-0.266656 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.6745259761810303
Epoch: 7, Steps: 1 | Train Loss: 0.905 Vali Loss: 1.089 Vali Acc: 0.333 Test Loss: 1.089 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.637054443359375
Epoch: 8, Steps: 1 | Train Loss: 0.956 Vali Loss: 1.092 Vali Acc: 0.333 Test Loss: 1.092 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.6193289756774902
Epoch: 9, Steps: 1 | Train Loss: 0.851 Vali Loss: 1.094 Vali Acc: 0.333 Test Loss: 1.094 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.7039740085601807
Epoch: 10, Steps: 1 | Train Loss: 0.818 Vali Loss: 1.098 Vali Acc: 0.333 Test Loss: 1.098 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.7103326320648193
Epoch: 11, Steps: 1 | Train Loss: 0.803 Vali Loss: 1.101 Vali Acc: 0.333 Test Loss: 1.101 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.6520106792449951
Epoch: 12, Steps: 1 | Train Loss: 0.830 Vali Loss: 1.105 Vali Acc: 0.333 Test Loss: 1.105 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.5979015827178955
Epoch: 13, Steps: 1 | Train Loss: 0.779 Vali Loss: 1.110 Vali Acc: 0.267 Test Loss: 1.110 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.5739326477050781
Epoch: 14, Steps: 1 | Train Loss: 0.722 Vali Loss: 1.116 Vali Acc: 0.267 Test Loss: 1.116 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.5595760345458984
Epoch: 15, Steps: 1 | Train Loss: 0.680 Vali Loss: 1.122 Vali Acc: 0.200 Test Loss: 1.122 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.5596120357513428
Epoch: 16, Steps: 1 | Train Loss: 0.695 Vali Loss: 1.129 Vali Acc: 0.200 Test Loss: 1.129 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm16_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 160323
model size : 0.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm16_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.8590893745422363
Epoch: 1, Steps: 1 | Train Loss: 1.130 Vali Loss: 1.137 Vali Acc: 0.267 Test Loss: 1.137 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.694394588470459
Epoch: 2, Steps: 1 | Train Loss: 1.094 Vali Loss: 1.126 Vali Acc: 0.267 Test Loss: 1.126 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.6987271308898926
Epoch: 3, Steps: 1 | Train Loss: 1.007 Vali Loss: 1.119 Vali Acc: 0.267 Test Loss: 1.119 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 4 cost time: 0.779425859451294
Epoch: 4, Steps: 1 | Train Loss: 1.075 Vali Loss: 1.117 Vali Acc: 0.267 Test Loss: 1.117 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 5 cost time: 0.7064476013183594
Epoch: 5, Steps: 1 | Train Loss: 0.960 Vali Loss: 1.117 Vali Acc: 0.267 Test Loss: 1.117 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 6 cost time: 0.677621603012085
Epoch: 6, Steps: 1 | Train Loss: 0.979 Vali Loss: 1.118 Vali Acc: 0.333 Test Loss: 1.118 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.7095057964324951
Epoch: 7, Steps: 1 | Train Loss: 0.899 Vali Loss: 1.119 Vali Acc: 0.400 Test Loss: 1.119 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.6930642127990723
Epoch: 8, Steps: 1 | Train Loss: 0.946 Vali Loss: 1.121 Vali Acc: 0.467 Test Loss: 1.121 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 9 cost time: 0.6840105056762695
Epoch: 9, Steps: 1 | Train Loss: 0.890 Vali Loss: 1.124 Vali Acc: 0.467 Test Loss: 1.124 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6865024566650391
Epoch: 10, Steps: 1 | Train Loss: 0.878 Vali Loss: 1.127 Vali Acc: 0.467 Test Loss: 1.127 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.6655468940734863
Epoch: 11, Steps: 1 | Train Loss: 0.881 Vali Loss: 1.129 Vali Acc: 0.467 Test Loss: 1.129 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.7205870151519775
Epoch: 12, Steps: 1 | Train Loss: 0.788 Vali Loss: 1.132 Vali Acc: 0.467 Test Loss: 1.132 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.7008178234100342
Epoch: 13, Steps: 1 | Train Loss: 0.801 Vali Loss: 1.134 Vali Acc: 0.467 Test Loss: 1.134 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.7516803741455078
Epoch: 14, Steps: 1 | Train Loss: 0.751 Vali Loss: 1.137 Vali Acc: 0.400 Test Loss: 1.137 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.7231578826904297
Epoch: 15, Steps: 1 | Train Loss: 0.688 Vali Loss: 1.141 Vali Acc: 0.333 Test Loss: 1.141 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.8329470157623291
Epoch: 16, Steps: 1 | Train Loss: 0.686 Vali Loss: 1.147 Vali Acc: 0.200 Test Loss: 1.147 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.8311753273010254
Epoch: 17, Steps: 1 | Train Loss: 0.578 Vali Loss: 1.154 Vali Acc: 0.200 Test Loss: 1.154 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.6692700386047363
Epoch: 18, Steps: 1 | Train Loss: 0.541 Vali Loss: 1.161 Vali Acc: 0.200 Test Loss: 1.161 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm16_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 470787
model size : 2.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm16_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.466411828994751
Epoch: 1, Steps: 1 | Train Loss: 1.100 Vali Loss: 1.088 Vali Acc: 0.267 Test Loss: 1.088 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.5686423778533936
Epoch: 2, Steps: 1 | Train Loss: 1.110 Vali Loss: 1.084 Vali Acc: 0.200 Test Loss: 1.084 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6422631740570068
Epoch: 3, Steps: 1 | Train Loss: 0.987 Vali Loss: 1.081 Vali Acc: 0.200 Test Loss: 1.081 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.615001916885376
Epoch: 4, Steps: 1 | Train Loss: 1.018 Vali Loss: 1.081 Vali Acc: 0.200 Test Loss: 1.081 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.6115899085998535
Epoch: 5, Steps: 1 | Train Loss: 0.995 Vali Loss: 1.082 Vali Acc: 0.267 Test Loss: 1.082 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 6 cost time: 0.5540854930877686
Epoch: 6, Steps: 1 | Train Loss: 0.977 Vali Loss: 1.084 Vali Acc: 0.267 Test Loss: 1.084 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5696072578430176
Epoch: 7, Steps: 1 | Train Loss: 0.890 Vali Loss: 1.086 Vali Acc: 0.333 Test Loss: 1.086 Test Acc: 0.333
Validation loss decreased (-0.266656 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.5555624961853027
Epoch: 8, Steps: 1 | Train Loss: 0.960 Vali Loss: 1.089 Vali Acc: 0.333 Test Loss: 1.089 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.514174222946167
Epoch: 9, Steps: 1 | Train Loss: 0.857 Vali Loss: 1.092 Vali Acc: 0.333 Test Loss: 1.092 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.5487215518951416
Epoch: 10, Steps: 1 | Train Loss: 0.824 Vali Loss: 1.096 Vali Acc: 0.333 Test Loss: 1.096 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.5593597888946533
Epoch: 11, Steps: 1 | Train Loss: 0.802 Vali Loss: 1.100 Vali Acc: 0.333 Test Loss: 1.100 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.5167739391326904
Epoch: 12, Steps: 1 | Train Loss: 0.834 Vali Loss: 1.104 Vali Acc: 0.267 Test Loss: 1.104 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.6288261413574219
Epoch: 13, Steps: 1 | Train Loss: 0.780 Vali Loss: 1.110 Vali Acc: 0.267 Test Loss: 1.110 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.6073756217956543
Epoch: 14, Steps: 1 | Train Loss: 0.721 Vali Loss: 1.116 Vali Acc: 0.267 Test Loss: 1.116 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.5631940364837646
Epoch: 15, Steps: 1 | Train Loss: 0.685 Vali Loss: 1.122 Vali Acc: 0.200 Test Loss: 1.122 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.5816652774810791
Epoch: 16, Steps: 1 | Train Loss: 0.701 Vali Loss: 1.129 Vali Acc: 0.200 Test Loss: 1.129 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.671471118927002
Epoch: 17, Steps: 1 | Train Loss: 0.613 Vali Loss: 1.137 Vali Acc: 0.267 Test Loss: 1.137 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm16_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 160323
model size : 0.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm16_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.4797654151916504
Epoch: 1, Steps: 1 | Train Loss: 1.129 Vali Loss: 1.148 Vali Acc: 0.267 Test Loss: 1.148 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.6002068519592285
Epoch: 2, Steps: 1 | Train Loss: 1.091 Vali Loss: 1.135 Vali Acc: 0.267 Test Loss: 1.135 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.6192371845245361
Epoch: 3, Steps: 1 | Train Loss: 1.006 Vali Loss: 1.129 Vali Acc: 0.333 Test Loss: 1.129 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.5965032577514648
Epoch: 4, Steps: 1 | Train Loss: 1.071 Vali Loss: 1.126 Vali Acc: 0.333 Test Loss: 1.126 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.6365110874176025
Epoch: 5, Steps: 1 | Train Loss: 0.957 Vali Loss: 1.126 Vali Acc: 0.333 Test Loss: 1.126 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.6736264228820801
Epoch: 6, Steps: 1 | Train Loss: 0.972 Vali Loss: 1.127 Vali Acc: 0.400 Test Loss: 1.127 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.6727943420410156
Epoch: 7, Steps: 1 | Train Loss: 0.893 Vali Loss: 1.129 Vali Acc: 0.400 Test Loss: 1.129 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6915004253387451
Epoch: 8, Steps: 1 | Train Loss: 0.943 Vali Loss: 1.131 Vali Acc: 0.467 Test Loss: 1.131 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 9 cost time: 0.6322619915008545
Epoch: 9, Steps: 1 | Train Loss: 0.891 Vali Loss: 1.134 Vali Acc: 0.467 Test Loss: 1.134 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7418646812438965
Epoch: 10, Steps: 1 | Train Loss: 0.880 Vali Loss: 1.137 Vali Acc: 0.467 Test Loss: 1.137 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.7476825714111328
Epoch: 11, Steps: 1 | Train Loss: 0.881 Vali Loss: 1.140 Vali Acc: 0.467 Test Loss: 1.140 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.5768866539001465
Epoch: 12, Steps: 1 | Train Loss: 0.786 Vali Loss: 1.143 Vali Acc: 0.467 Test Loss: 1.143 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.639911413192749
Epoch: 13, Steps: 1 | Train Loss: 0.805 Vali Loss: 1.146 Vali Acc: 0.533 Test Loss: 1.146 Test Acc: 0.533
Validation loss decreased (-0.466655 --> -0.533322).  Saving model ...
Epoch: 14 cost time: 0.6044414043426514
Epoch: 14, Steps: 1 | Train Loss: 0.757 Vali Loss: 1.149 Vali Acc: 0.400 Test Loss: 1.149 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6101078987121582
Epoch: 15, Steps: 1 | Train Loss: 0.693 Vali Loss: 1.154 Vali Acc: 0.333 Test Loss: 1.154 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7196149826049805
Epoch: 16, Steps: 1 | Train Loss: 0.692 Vali Loss: 1.160 Vali Acc: 0.267 Test Loss: 1.160 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.7048535346984863
Epoch: 17, Steps: 1 | Train Loss: 0.583 Vali Loss: 1.167 Vali Acc: 0.267 Test Loss: 1.167 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.6380393505096436
Epoch: 18, Steps: 1 | Train Loss: 0.544 Vali Loss: 1.174 Vali Acc: 0.200 Test Loss: 1.174 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.6667132377624512
Epoch: 19, Steps: 1 | Train Loss: 0.549 Vali Loss: 1.182 Vali Acc: 0.200 Test Loss: 1.182 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.6510648727416992
Epoch: 20, Steps: 1 | Train Loss: 0.497 Vali Loss: 1.190 Vali Acc: 0.200 Test Loss: 1.190 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.604029655456543
Epoch: 21, Steps: 1 | Train Loss: 0.480 Vali Loss: 1.198 Vali Acc: 0.200 Test Loss: 1.198 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.6267178058624268
Epoch: 22, Steps: 1 | Train Loss: 0.436 Vali Loss: 1.206 Vali Acc: 0.200 Test Loss: 1.206 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.6774868965148926
Epoch: 23, Steps: 1 | Train Loss: 0.347 Vali Loss: 1.214 Vali Acc: 0.200 Test Loss: 1.214 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm16_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 470787
model size : 2.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm16_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.313753128051758
Epoch: 1, Steps: 1 | Train Loss: 1.127 Vali Loss: 1.070 Vali Acc: 0.267 Test Loss: 1.070 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.5440638065338135
Epoch: 2, Steps: 1 | Train Loss: 1.114 Vali Loss: 1.064 Vali Acc: 0.267 Test Loss: 1.064 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 3 cost time: 0.5431952476501465
Epoch: 3, Steps: 1 | Train Loss: 0.996 Vali Loss: 1.061 Vali Acc: 0.200 Test Loss: 1.061 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5275537967681885
Epoch: 4, Steps: 1 | Train Loss: 1.014 Vali Loss: 1.061 Vali Acc: 0.200 Test Loss: 1.061 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.5301847457885742
Epoch: 5, Steps: 1 | Train Loss: 1.002 Vali Loss: 1.062 Vali Acc: 0.267 Test Loss: 1.062 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 6 cost time: 0.5332562923431396
Epoch: 6, Steps: 1 | Train Loss: 0.969 Vali Loss: 1.064 Vali Acc: 0.400 Test Loss: 1.064 Test Acc: 0.400
Validation loss decreased (-0.266656 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.5878753662109375
Epoch: 7, Steps: 1 | Train Loss: 0.911 Vali Loss: 1.066 Vali Acc: 0.400 Test Loss: 1.066 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5614862442016602
Epoch: 8, Steps: 1 | Train Loss: 0.957 Vali Loss: 1.068 Vali Acc: 0.400 Test Loss: 1.068 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.5687320232391357
Epoch: 9, Steps: 1 | Train Loss: 0.855 Vali Loss: 1.071 Vali Acc: 0.400 Test Loss: 1.071 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.5228104591369629
Epoch: 10, Steps: 1 | Train Loss: 0.827 Vali Loss: 1.075 Vali Acc: 0.400 Test Loss: 1.075 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.5289919376373291
Epoch: 11, Steps: 1 | Train Loss: 0.808 Vali Loss: 1.079 Vali Acc: 0.333 Test Loss: 1.079 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.5431244373321533
Epoch: 12, Steps: 1 | Train Loss: 0.826 Vali Loss: 1.084 Vali Acc: 0.267 Test Loss: 1.084 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.596125602722168
Epoch: 13, Steps: 1 | Train Loss: 0.783 Vali Loss: 1.089 Vali Acc: 0.267 Test Loss: 1.089 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.5784962177276611
Epoch: 14, Steps: 1 | Train Loss: 0.718 Vali Loss: 1.095 Vali Acc: 0.267 Test Loss: 1.095 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.5853126049041748
Epoch: 15, Steps: 1 | Train Loss: 0.682 Vali Loss: 1.102 Vali Acc: 0.267 Test Loss: 1.102 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.5845623016357422
Epoch: 16, Steps: 1 | Train Loss: 0.709 Vali Loss: 1.109 Vali Acc: 0.267 Test Loss: 1.109 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm16_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 160323
model size : 0.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm8_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 3.387202024459839
Epoch: 1, Steps: 1 | Train Loss: 1.224 Vali Loss: 1.114 Vali Acc: 0.333 Test Loss: 1.114 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.9912123680114746
Epoch: 2, Steps: 1 | Train Loss: 1.110 Vali Loss: 1.111 Vali Acc: 0.333 Test Loss: 1.111 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.8609492778778076
Epoch: 3, Steps: 1 | Train Loss: 1.131 Vali Loss: 1.109 Vali Acc: 0.267 Test Loss: 1.109 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0700225830078125
Epoch: 4, Steps: 1 | Train Loss: 1.129 Vali Loss: 1.109 Vali Acc: 0.267 Test Loss: 1.109 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.8774092197418213
Epoch: 5, Steps: 1 | Train Loss: 1.126 Vali Loss: 1.109 Vali Acc: 0.267 Test Loss: 1.109 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.9398033618927002
Epoch: 6, Steps: 1 | Train Loss: 1.061 Vali Loss: 1.110 Vali Acc: 0.267 Test Loss: 1.110 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.9302594661712646
Epoch: 7, Steps: 1 | Train Loss: 0.990 Vali Loss: 1.111 Vali Acc: 0.267 Test Loss: 1.111 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.9797406196594238
Epoch: 8, Steps: 1 | Train Loss: 1.108 Vali Loss: 1.113 Vali Acc: 0.200 Test Loss: 1.113 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.8795409202575684
Epoch: 9, Steps: 1 | Train Loss: 1.028 Vali Loss: 1.115 Vali Acc: 0.333 Test Loss: 1.115 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.9235286712646484
Epoch: 10, Steps: 1 | Train Loss: 0.986 Vali Loss: 1.119 Vali Acc: 0.333 Test Loss: 1.119 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.8573634624481201
Epoch: 11, Steps: 1 | Train Loss: 0.933 Vali Loss: 1.123 Vali Acc: 0.333 Test Loss: 1.123 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.8080706596374512
Epoch: 12, Steps: 1 | Train Loss: 0.923 Vali Loss: 1.128 Vali Acc: 0.333 Test Loss: 1.128 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm8_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 895347
model size : 3.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm8_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.7257161140441895
Epoch: 1, Steps: 1 | Train Loss: 1.218 Vali Loss: 1.173 Vali Acc: 0.333 Test Loss: 1.173 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.6574673652648926
Epoch: 2, Steps: 1 | Train Loss: 1.154 Vali Loss: 1.157 Vali Acc: 0.333 Test Loss: 1.157 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.6880755424499512
Epoch: 3, Steps: 1 | Train Loss: 1.197 Vali Loss: 1.145 Vali Acc: 0.333 Test Loss: 1.145 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.6364753246307373
Epoch: 4, Steps: 1 | Train Loss: 1.230 Vali Loss: 1.135 Vali Acc: 0.333 Test Loss: 1.135 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.7072587013244629
Epoch: 5, Steps: 1 | Train Loss: 1.054 Vali Loss: 1.129 Vali Acc: 0.467 Test Loss: 1.129 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466655).  Saving model ...
Epoch: 6 cost time: 0.8114652633666992
Epoch: 6, Steps: 1 | Train Loss: 1.171 Vali Loss: 1.125 Vali Acc: 0.467 Test Loss: 1.125 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 7 cost time: 0.6227068901062012
Epoch: 7, Steps: 1 | Train Loss: 1.010 Vali Loss: 1.122 Vali Acc: 0.467 Test Loss: 1.122 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 8 cost time: 0.6389870643615723
Epoch: 8, Steps: 1 | Train Loss: 1.092 Vali Loss: 1.120 Vali Acc: 0.467 Test Loss: 1.120 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 9 cost time: 0.6451146602630615
Epoch: 9, Steps: 1 | Train Loss: 0.974 Vali Loss: 1.119 Vali Acc: 0.400 Test Loss: 1.119 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6473538875579834
Epoch: 10, Steps: 1 | Train Loss: 1.024 Vali Loss: 1.119 Vali Acc: 0.333 Test Loss: 1.119 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.6648581027984619
Epoch: 11, Steps: 1 | Train Loss: 1.021 Vali Loss: 1.121 Vali Acc: 0.400 Test Loss: 1.121 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.6743381023406982
Epoch: 12, Steps: 1 | Train Loss: 0.892 Vali Loss: 1.124 Vali Acc: 0.400 Test Loss: 1.124 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.6239233016967773
Epoch: 13, Steps: 1 | Train Loss: 0.968 Vali Loss: 1.128 Vali Acc: 0.333 Test Loss: 1.128 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.6592676639556885
Epoch: 14, Steps: 1 | Train Loss: 0.929 Vali Loss: 1.132 Vali Acc: 0.333 Test Loss: 1.132 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.6086246967315674
Epoch: 15, Steps: 1 | Train Loss: 0.856 Vali Loss: 1.137 Vali Acc: 0.333 Test Loss: 1.137 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.6059536933898926
Epoch: 16, Steps: 1 | Train Loss: 0.814 Vali Loss: 1.143 Vali Acc: 0.333 Test Loss: 1.143 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.6329450607299805
Epoch: 17, Steps: 1 | Train Loss: 0.853 Vali Loss: 1.149 Vali Acc: 0.333 Test Loss: 1.149 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.6382193565368652
Epoch: 18, Steps: 1 | Train Loss: 0.764 Vali Loss: 1.154 Vali Acc: 0.333 Test Loss: 1.154 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm8_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 274371
model size : 1.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm8_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.918912649154663
Epoch: 1, Steps: 1 | Train Loss: 1.228 Vali Loss: 1.120 Vali Acc: 0.333 Test Loss: 1.120 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.7720553874969482
Epoch: 2, Steps: 1 | Train Loss: 1.115 Vali Loss: 1.117 Vali Acc: 0.333 Test Loss: 1.117 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.8164031505584717
Epoch: 3, Steps: 1 | Train Loss: 1.130 Vali Loss: 1.115 Vali Acc: 0.200 Test Loss: 1.115 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.842693567276001
Epoch: 4, Steps: 1 | Train Loss: 1.123 Vali Loss: 1.114 Vali Acc: 0.200 Test Loss: 1.114 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9814579486846924
Epoch: 5, Steps: 1 | Train Loss: 1.124 Vali Loss: 1.114 Vali Acc: 0.267 Test Loss: 1.114 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.8777153491973877
Epoch: 6, Steps: 1 | Train Loss: 1.055 Vali Loss: 1.115 Vali Acc: 0.267 Test Loss: 1.115 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.8894355297088623
Epoch: 7, Steps: 1 | Train Loss: 0.994 Vali Loss: 1.117 Vali Acc: 0.267 Test Loss: 1.117 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.8387882709503174
Epoch: 8, Steps: 1 | Train Loss: 1.115 Vali Loss: 1.119 Vali Acc: 0.200 Test Loss: 1.119 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.8081808090209961
Epoch: 9, Steps: 1 | Train Loss: 1.026 Vali Loss: 1.122 Vali Acc: 0.267 Test Loss: 1.122 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.8390660285949707
Epoch: 10, Steps: 1 | Train Loss: 0.988 Vali Loss: 1.125 Vali Acc: 0.267 Test Loss: 1.125 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.8243057727813721
Epoch: 11, Steps: 1 | Train Loss: 0.934 Vali Loss: 1.130 Vali Acc: 0.333 Test Loss: 1.130 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.8713259696960449
Epoch: 12, Steps: 1 | Train Loss: 0.929 Vali Loss: 1.135 Vali Acc: 0.333 Test Loss: 1.135 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm8_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 895347
model size : 3.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm8_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.670140504837036
Epoch: 1, Steps: 1 | Train Loss: 1.211 Vali Loss: 1.172 Vali Acc: 0.333 Test Loss: 1.172 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.552969217300415
Epoch: 2, Steps: 1 | Train Loss: 1.152 Vali Loss: 1.156 Vali Acc: 0.333 Test Loss: 1.156 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.5160462856292725
Epoch: 3, Steps: 1 | Train Loss: 1.190 Vali Loss: 1.143 Vali Acc: 0.333 Test Loss: 1.143 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.4996044635772705
Epoch: 4, Steps: 1 | Train Loss: 1.223 Vali Loss: 1.133 Vali Acc: 0.333 Test Loss: 1.133 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.5959703922271729
Epoch: 5, Steps: 1 | Train Loss: 1.039 Vali Loss: 1.127 Vali Acc: 0.467 Test Loss: 1.127 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466655).  Saving model ...
Epoch: 6 cost time: 0.5957777500152588
Epoch: 6, Steps: 1 | Train Loss: 1.151 Vali Loss: 1.124 Vali Acc: 0.467 Test Loss: 1.124 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 7 cost time: 0.5519530773162842
Epoch: 7, Steps: 1 | Train Loss: 1.018 Vali Loss: 1.121 Vali Acc: 0.467 Test Loss: 1.121 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 8 cost time: 0.5320966243743896
Epoch: 8, Steps: 1 | Train Loss: 1.084 Vali Loss: 1.120 Vali Acc: 0.467 Test Loss: 1.120 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 9 cost time: 0.5587079524993896
Epoch: 9, Steps: 1 | Train Loss: 0.969 Vali Loss: 1.120 Vali Acc: 0.333 Test Loss: 1.120 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.606985330581665
Epoch: 10, Steps: 1 | Train Loss: 1.024 Vali Loss: 1.122 Vali Acc: 0.400 Test Loss: 1.122 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.5914208889007568
Epoch: 11, Steps: 1 | Train Loss: 1.023 Vali Loss: 1.124 Vali Acc: 0.400 Test Loss: 1.124 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.5502333641052246
Epoch: 12, Steps: 1 | Train Loss: 0.892 Vali Loss: 1.127 Vali Acc: 0.400 Test Loss: 1.127 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.698793888092041
Epoch: 13, Steps: 1 | Train Loss: 0.960 Vali Loss: 1.130 Vali Acc: 0.400 Test Loss: 1.130 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.5454699993133545
Epoch: 14, Steps: 1 | Train Loss: 0.928 Vali Loss: 1.133 Vali Acc: 0.467 Test Loss: 1.133 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.6424477100372314
Epoch: 15, Steps: 1 | Train Loss: 0.856 Vali Loss: 1.136 Vali Acc: 0.467 Test Loss: 1.136 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.5931687355041504
Epoch: 16, Steps: 1 | Train Loss: 0.795 Vali Loss: 1.140 Vali Acc: 0.467 Test Loss: 1.140 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.6195898056030273
Epoch: 17, Steps: 1 | Train Loss: 0.853 Vali Loss: 1.144 Vali Acc: 0.400 Test Loss: 1.144 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.6346330642700195
Epoch: 18, Steps: 1 | Train Loss: 0.762 Vali Loss: 1.148 Vali Acc: 0.400 Test Loss: 1.148 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm8_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 274371
model size : 1.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm8_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.762995481491089
Epoch: 1, Steps: 1 | Train Loss: 1.240 Vali Loss: 1.132 Vali Acc: 0.400 Test Loss: 1.132 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.7238333225250244
Epoch: 2, Steps: 1 | Train Loss: 1.120 Vali Loss: 1.128 Vali Acc: 0.400 Test Loss: 1.128 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.7991256713867188
Epoch: 3, Steps: 1 | Train Loss: 1.133 Vali Loss: 1.126 Vali Acc: 0.267 Test Loss: 1.126 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.620621919631958
Epoch: 4, Steps: 1 | Train Loss: 1.122 Vali Loss: 1.124 Vali Acc: 0.267 Test Loss: 1.124 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.6875042915344238
Epoch: 5, Steps: 1 | Train Loss: 1.133 Vali Loss: 1.124 Vali Acc: 0.333 Test Loss: 1.124 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.6219377517700195
Epoch: 6, Steps: 1 | Train Loss: 1.063 Vali Loss: 1.125 Vali Acc: 0.200 Test Loss: 1.125 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.6454665660858154
Epoch: 7, Steps: 1 | Train Loss: 1.001 Vali Loss: 1.126 Vali Acc: 0.200 Test Loss: 1.126 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.6663968563079834
Epoch: 8, Steps: 1 | Train Loss: 1.119 Vali Loss: 1.127 Vali Acc: 0.200 Test Loss: 1.127 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.640723705291748
Epoch: 9, Steps: 1 | Train Loss: 1.035 Vali Loss: 1.129 Vali Acc: 0.267 Test Loss: 1.129 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.6139206886291504
Epoch: 10, Steps: 1 | Train Loss: 1.007 Vali Loss: 1.132 Vali Acc: 0.267 Test Loss: 1.132 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.6493649482727051
Epoch: 11, Steps: 1 | Train Loss: 0.953 Vali Loss: 1.136 Vali Acc: 0.267 Test Loss: 1.136 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.6275029182434082
Epoch: 12, Steps: 1 | Train Loss: 0.946 Vali Loss: 1.140 Vali Acc: 0.267 Test Loss: 1.140 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm8_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 895347
model size : 3.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm8_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.461608648300171
Epoch: 1, Steps: 1 | Train Loss: 1.186 Vali Loss: 1.140 Vali Acc: 0.333 Test Loss: 1.140 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.5461230278015137
Epoch: 2, Steps: 1 | Train Loss: 1.133 Vali Loss: 1.126 Vali Acc: 0.333 Test Loss: 1.126 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.5195596218109131
Epoch: 3, Steps: 1 | Train Loss: 1.178 Vali Loss: 1.116 Vali Acc: 0.333 Test Loss: 1.116 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.571537971496582
Epoch: 4, Steps: 1 | Train Loss: 1.197 Vali Loss: 1.109 Vali Acc: 0.467 Test Loss: 1.109 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 0.5046262741088867
Epoch: 5, Steps: 1 | Train Loss: 1.027 Vali Loss: 1.105 Vali Acc: 0.533 Test Loss: 1.105 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 6 cost time: 0.4478626251220703
Epoch: 6, Steps: 1 | Train Loss: 1.152 Vali Loss: 1.104 Vali Acc: 0.467 Test Loss: 1.104 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.4817488193511963
Epoch: 7, Steps: 1 | Train Loss: 1.028 Vali Loss: 1.103 Vali Acc: 0.333 Test Loss: 1.103 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.4817790985107422
Epoch: 8, Steps: 1 | Train Loss: 1.075 Vali Loss: 1.103 Vali Acc: 0.400 Test Loss: 1.103 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.5407681465148926
Epoch: 9, Steps: 1 | Train Loss: 0.978 Vali Loss: 1.104 Vali Acc: 0.400 Test Loss: 1.104 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.4747171401977539
Epoch: 10, Steps: 1 | Train Loss: 1.039 Vali Loss: 1.105 Vali Acc: 0.400 Test Loss: 1.105 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.5271310806274414
Epoch: 11, Steps: 1 | Train Loss: 1.041 Vali Loss: 1.107 Vali Acc: 0.400 Test Loss: 1.107 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.5544126033782959
Epoch: 12, Steps: 1 | Train Loss: 0.924 Vali Loss: 1.110 Vali Acc: 0.467 Test Loss: 1.110 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.5474495887756348
Epoch: 13, Steps: 1 | Train Loss: 0.975 Vali Loss: 1.114 Vali Acc: 0.400 Test Loss: 1.114 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.5803070068359375
Epoch: 14, Steps: 1 | Train Loss: 0.950 Vali Loss: 1.117 Vali Acc: 0.400 Test Loss: 1.117 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.5805652141571045
Epoch: 15, Steps: 1 | Train Loss: 0.898 Vali Loss: 1.120 Vali Acc: 0.400 Test Loss: 1.120 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm8_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 274371
model size : 1.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm8_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 3.0613656044006348
Epoch: 1, Steps: 1 | Train Loss: 1.087 Vali Loss: 1.115 Vali Acc: 0.400 Test Loss: 1.115 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.7854337692260742
Epoch: 2, Steps: 1 | Train Loss: 1.175 Vali Loss: 1.105 Vali Acc: 0.467 Test Loss: 1.105 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.6832962036132812
Epoch: 3, Steps: 1 | Train Loss: 1.138 Vali Loss: 1.099 Vali Acc: 0.333 Test Loss: 1.099 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7428803443908691
Epoch: 4, Steps: 1 | Train Loss: 1.059 Vali Loss: 1.096 Vali Acc: 0.333 Test Loss: 1.096 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.7602968215942383
Epoch: 5, Steps: 1 | Train Loss: 1.142 Vali Loss: 1.094 Vali Acc: 0.333 Test Loss: 1.094 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.6858367919921875
Epoch: 6, Steps: 1 | Train Loss: 0.969 Vali Loss: 1.093 Vali Acc: 0.333 Test Loss: 1.093 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.6954190731048584
Epoch: 7, Steps: 1 | Train Loss: 1.017 Vali Loss: 1.094 Vali Acc: 0.333 Test Loss: 1.094 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.6929576396942139
Epoch: 8, Steps: 1 | Train Loss: 1.101 Vali Loss: 1.095 Vali Acc: 0.333 Test Loss: 1.095 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.6947610378265381
Epoch: 9, Steps: 1 | Train Loss: 1.038 Vali Loss: 1.097 Vali Acc: 0.333 Test Loss: 1.097 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.6872553825378418
Epoch: 10, Steps: 1 | Train Loss: 1.003 Vali Loss: 1.100 Vali Acc: 0.400 Test Loss: 1.100 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.7422769069671631
Epoch: 11, Steps: 1 | Train Loss: 0.968 Vali Loss: 1.104 Vali Acc: 0.400 Test Loss: 1.104 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.7765910625457764
Epoch: 12, Steps: 1 | Train Loss: 0.939 Vali Loss: 1.108 Vali Acc: 0.333 Test Loss: 1.108 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm8_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 455475
model size : 1.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm8_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.5914225578308105
Epoch: 1, Steps: 1 | Train Loss: 1.028 Vali Loss: 1.113 Vali Acc: 0.333 Test Loss: 1.113 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.5988118648529053
Epoch: 2, Steps: 1 | Train Loss: 1.078 Vali Loss: 1.111 Vali Acc: 0.400 Test Loss: 1.111 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.6287882328033447
Epoch: 3, Steps: 1 | Train Loss: 1.084 Vali Loss: 1.110 Vali Acc: 0.400 Test Loss: 1.110 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.5881772041320801
Epoch: 4, Steps: 1 | Train Loss: 1.082 Vali Loss: 1.110 Vali Acc: 0.400 Test Loss: 1.110 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6355931758880615
Epoch: 5, Steps: 1 | Train Loss: 0.987 Vali Loss: 1.111 Vali Acc: 0.400 Test Loss: 1.111 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.7319929599761963
Epoch: 6, Steps: 1 | Train Loss: 1.062 Vali Loss: 1.112 Vali Acc: 0.400 Test Loss: 1.112 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.7003841400146484
Epoch: 7, Steps: 1 | Train Loss: 0.937 Vali Loss: 1.113 Vali Acc: 0.400 Test Loss: 1.113 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.639122724533081
Epoch: 8, Steps: 1 | Train Loss: 0.951 Vali Loss: 1.114 Vali Acc: 0.400 Test Loss: 1.114 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.5709850788116455
Epoch: 9, Steps: 1 | Train Loss: 0.950 Vali Loss: 1.116 Vali Acc: 0.400 Test Loss: 1.116 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.6284027099609375
Epoch: 10, Steps: 1 | Train Loss: 0.926 Vali Loss: 1.118 Vali Acc: 0.400 Test Loss: 1.118 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.5578687191009521
Epoch: 11, Steps: 1 | Train Loss: 0.909 Vali Loss: 1.120 Vali Acc: 0.400 Test Loss: 1.120 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.603036642074585
Epoch: 12, Steps: 1 | Train Loss: 0.812 Vali Loss: 1.123 Vali Acc: 0.400 Test Loss: 1.123 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.5574479103088379
Epoch: 13, Steps: 1 | Train Loss: 0.819 Vali Loss: 1.125 Vali Acc: 0.400 Test Loss: 1.125 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm8_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 144963
model size : 0.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm8_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.515169858932495
Epoch: 1, Steps: 1 | Train Loss: 1.088 Vali Loss: 1.119 Vali Acc: 0.400 Test Loss: 1.119 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.5491604804992676
Epoch: 2, Steps: 1 | Train Loss: 1.172 Vali Loss: 1.110 Vali Acc: 0.467 Test Loss: 1.110 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.6295528411865234
Epoch: 3, Steps: 1 | Train Loss: 1.132 Vali Loss: 1.104 Vali Acc: 0.333 Test Loss: 1.104 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6273939609527588
Epoch: 4, Steps: 1 | Train Loss: 1.057 Vali Loss: 1.100 Vali Acc: 0.333 Test Loss: 1.100 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.6222131252288818
Epoch: 5, Steps: 1 | Train Loss: 1.143 Vali Loss: 1.098 Vali Acc: 0.333 Test Loss: 1.098 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.6310644149780273
Epoch: 6, Steps: 1 | Train Loss: 0.970 Vali Loss: 1.098 Vali Acc: 0.333 Test Loss: 1.098 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.6398446559906006
Epoch: 7, Steps: 1 | Train Loss: 1.017 Vali Loss: 1.098 Vali Acc: 0.333 Test Loss: 1.098 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.5808360576629639
Epoch: 8, Steps: 1 | Train Loss: 1.100 Vali Loss: 1.099 Vali Acc: 0.333 Test Loss: 1.099 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.6723554134368896
Epoch: 9, Steps: 1 | Train Loss: 1.039 Vali Loss: 1.101 Vali Acc: 0.333 Test Loss: 1.101 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.6829304695129395
Epoch: 10, Steps: 1 | Train Loss: 1.001 Vali Loss: 1.104 Vali Acc: 0.400 Test Loss: 1.104 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.7085521221160889
Epoch: 11, Steps: 1 | Train Loss: 0.968 Vali Loss: 1.108 Vali Acc: 0.400 Test Loss: 1.108 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.6670699119567871
Epoch: 12, Steps: 1 | Train Loss: 0.938 Vali Loss: 1.112 Vali Acc: 0.333 Test Loss: 1.112 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm8_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 455475
model size : 1.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm8_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.617405414581299
Epoch: 1, Steps: 1 | Train Loss: 1.036 Vali Loss: 1.113 Vali Acc: 0.333 Test Loss: 1.113 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.5930678844451904
Epoch: 2, Steps: 1 | Train Loss: 1.087 Vali Loss: 1.111 Vali Acc: 0.400 Test Loss: 1.111 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.5986042022705078
Epoch: 3, Steps: 1 | Train Loss: 1.078 Vali Loss: 1.110 Vali Acc: 0.400 Test Loss: 1.110 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.5686731338500977
Epoch: 4, Steps: 1 | Train Loss: 1.079 Vali Loss: 1.110 Vali Acc: 0.400 Test Loss: 1.110 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6038668155670166
Epoch: 5, Steps: 1 | Train Loss: 0.991 Vali Loss: 1.112 Vali Acc: 0.400 Test Loss: 1.112 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.6614058017730713
Epoch: 6, Steps: 1 | Train Loss: 1.062 Vali Loss: 1.112 Vali Acc: 0.400 Test Loss: 1.112 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.568345308303833
Epoch: 7, Steps: 1 | Train Loss: 0.936 Vali Loss: 1.113 Vali Acc: 0.400 Test Loss: 1.113 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.5595722198486328
Epoch: 8, Steps: 1 | Train Loss: 0.952 Vali Loss: 1.115 Vali Acc: 0.400 Test Loss: 1.115 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.5162651538848877
Epoch: 9, Steps: 1 | Train Loss: 0.948 Vali Loss: 1.117 Vali Acc: 0.400 Test Loss: 1.117 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.5259323120117188
Epoch: 10, Steps: 1 | Train Loss: 0.917 Vali Loss: 1.119 Vali Acc: 0.400 Test Loss: 1.119 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.5476233959197998
Epoch: 11, Steps: 1 | Train Loss: 0.906 Vali Loss: 1.121 Vali Acc: 0.400 Test Loss: 1.121 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.5548312664031982
Epoch: 12, Steps: 1 | Train Loss: 0.813 Vali Loss: 1.124 Vali Acc: 0.400 Test Loss: 1.124 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.5662651062011719
Epoch: 13, Steps: 1 | Train Loss: 0.822 Vali Loss: 1.127 Vali Acc: 0.400 Test Loss: 1.127 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm8_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 144963
model size : 0.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm8_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.520904541015625
Epoch: 1, Steps: 1 | Train Loss: 1.091 Vali Loss: 1.131 Vali Acc: 0.400 Test Loss: 1.131 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.5451695919036865
Epoch: 2, Steps: 1 | Train Loss: 1.166 Vali Loss: 1.122 Vali Acc: 0.400 Test Loss: 1.122 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.6265149116516113
Epoch: 3, Steps: 1 | Train Loss: 1.126 Vali Loss: 1.116 Vali Acc: 0.333 Test Loss: 1.116 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.555405855178833
Epoch: 4, Steps: 1 | Train Loss: 1.061 Vali Loss: 1.112 Vali Acc: 0.267 Test Loss: 1.112 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.6009805202484131
Epoch: 5, Steps: 1 | Train Loss: 1.149 Vali Loss: 1.110 Vali Acc: 0.200 Test Loss: 1.110 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.5884850025177002
Epoch: 6, Steps: 1 | Train Loss: 0.965 Vali Loss: 1.110 Vali Acc: 0.200 Test Loss: 1.110 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.5824990272521973
Epoch: 7, Steps: 1 | Train Loss: 1.021 Vali Loss: 1.110 Vali Acc: 0.200 Test Loss: 1.110 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.5922043323516846
Epoch: 8, Steps: 1 | Train Loss: 1.108 Vali Loss: 1.110 Vali Acc: 0.200 Test Loss: 1.110 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.5335042476654053
Epoch: 9, Steps: 1 | Train Loss: 1.043 Vali Loss: 1.111 Vali Acc: 0.267 Test Loss: 1.111 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.5355479717254639
Epoch: 10, Steps: 1 | Train Loss: 1.006 Vali Loss: 1.113 Vali Acc: 0.333 Test Loss: 1.113 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.6620125770568848
Epoch: 11, Steps: 1 | Train Loss: 0.973 Vali Loss: 1.116 Vali Acc: 0.333 Test Loss: 1.116 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.5460059642791748
Epoch: 12, Steps: 1 | Train Loss: 0.956 Vali Loss: 1.118 Vali Acc: 0.400 Test Loss: 1.118 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 13 cost time: 0.5504183769226074
Epoch: 13, Steps: 1 | Train Loss: 0.971 Vali Loss: 1.121 Vali Acc: 0.400 Test Loss: 1.121 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.599231481552124
Epoch: 14, Steps: 1 | Train Loss: 0.918 Vali Loss: 1.123 Vali Acc: 0.333 Test Loss: 1.123 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.566838264465332
Epoch: 15, Steps: 1 | Train Loss: 0.882 Vali Loss: 1.124 Vali Acc: 0.333 Test Loss: 1.124 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.584263801574707
Epoch: 16, Steps: 1 | Train Loss: 0.863 Vali Loss: 1.126 Vali Acc: 0.333 Test Loss: 1.126 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.5993359088897705
Epoch: 17, Steps: 1 | Train Loss: 0.792 Vali Loss: 1.127 Vali Acc: 0.333 Test Loss: 1.127 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.5834083557128906
Epoch: 18, Steps: 1 | Train Loss: 0.830 Vali Loss: 1.127 Vali Acc: 0.333 Test Loss: 1.127 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.5777034759521484
Epoch: 19, Steps: 1 | Train Loss: 0.798 Vali Loss: 1.128 Vali Acc: 0.333 Test Loss: 1.128 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.5748810768127441
Epoch: 20, Steps: 1 | Train Loss: 0.745 Vali Loss: 1.128 Vali Acc: 0.333 Test Loss: 1.128 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.5539216995239258
Epoch: 21, Steps: 1 | Train Loss: 0.763 Vali Loss: 1.128 Vali Acc: 0.333 Test Loss: 1.128 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.5927367210388184
Epoch: 22, Steps: 1 | Train Loss: 0.709 Vali Loss: 1.128 Vali Acc: 0.333 Test Loss: 1.128 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm8_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 455475
model size : 1.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm8_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.25382399559021
Epoch: 1, Steps: 1 | Train Loss: 1.029 Vali Loss: 1.103 Vali Acc: 0.333 Test Loss: 1.103 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.43930745124816895
Epoch: 2, Steps: 1 | Train Loss: 1.079 Vali Loss: 1.101 Vali Acc: 0.400 Test Loss: 1.101 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.5101382732391357
Epoch: 3, Steps: 1 | Train Loss: 1.080 Vali Loss: 1.101 Vali Acc: 0.333 Test Loss: 1.101 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.47920656204223633
Epoch: 4, Steps: 1 | Train Loss: 1.077 Vali Loss: 1.101 Vali Acc: 0.333 Test Loss: 1.101 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.515364408493042
Epoch: 5, Steps: 1 | Train Loss: 0.981 Vali Loss: 1.103 Vali Acc: 0.333 Test Loss: 1.103 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.5412766933441162
Epoch: 6, Steps: 1 | Train Loss: 1.058 Vali Loss: 1.104 Vali Acc: 0.400 Test Loss: 1.104 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.4745478630065918
Epoch: 7, Steps: 1 | Train Loss: 0.931 Vali Loss: 1.105 Vali Acc: 0.400 Test Loss: 1.105 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.5197422504425049
Epoch: 8, Steps: 1 | Train Loss: 0.937 Vali Loss: 1.107 Vali Acc: 0.400 Test Loss: 1.107 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.5575666427612305
Epoch: 9, Steps: 1 | Train Loss: 0.941 Vali Loss: 1.109 Vali Acc: 0.400 Test Loss: 1.109 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.5515460968017578
Epoch: 10, Steps: 1 | Train Loss: 0.911 Vali Loss: 1.112 Vali Acc: 0.400 Test Loss: 1.112 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.5498425960540771
Epoch: 11, Steps: 1 | Train Loss: 0.899 Vali Loss: 1.115 Vali Acc: 0.400 Test Loss: 1.115 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.5014793872833252
Epoch: 12, Steps: 1 | Train Loss: 0.806 Vali Loss: 1.119 Vali Acc: 0.400 Test Loss: 1.119 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm8_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 144963
model size : 0.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm8_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.849687337875366
Epoch: 1, Steps: 1 | Train Loss: 1.102 Vali Loss: 1.134 Vali Acc: 0.400 Test Loss: 1.134 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.6417644023895264
Epoch: 2, Steps: 1 | Train Loss: 1.165 Vali Loss: 1.130 Vali Acc: 0.333 Test Loss: 1.130 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6392996311187744
Epoch: 3, Steps: 1 | Train Loss: 1.155 Vali Loss: 1.126 Vali Acc: 0.400 Test Loss: 1.126 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.7044546604156494
Epoch: 4, Steps: 1 | Train Loss: 1.120 Vali Loss: 1.125 Vali Acc: 0.400 Test Loss: 1.125 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.6952242851257324
Epoch: 5, Steps: 1 | Train Loss: 1.147 Vali Loss: 1.124 Vali Acc: 0.333 Test Loss: 1.124 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7944445610046387
Epoch: 6, Steps: 1 | Train Loss: 1.019 Vali Loss: 1.124 Vali Acc: 0.333 Test Loss: 1.124 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.7474768161773682
Epoch: 7, Steps: 1 | Train Loss: 1.010 Vali Loss: 1.124 Vali Acc: 0.267 Test Loss: 1.124 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.771369457244873
Epoch: 8, Steps: 1 | Train Loss: 0.980 Vali Loss: 1.125 Vali Acc: 0.267 Test Loss: 1.125 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.7047204971313477
Epoch: 9, Steps: 1 | Train Loss: 0.995 Vali Loss: 1.126 Vali Acc: 0.267 Test Loss: 1.126 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.6344926357269287
Epoch: 10, Steps: 1 | Train Loss: 0.951 Vali Loss: 1.127 Vali Acc: 0.267 Test Loss: 1.127 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.6919989585876465
Epoch: 11, Steps: 1 | Train Loss: 0.942 Vali Loss: 1.129 Vali Acc: 0.333 Test Loss: 1.129 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.6624634265899658
Epoch: 12, Steps: 1 | Train Loss: 0.923 Vali Loss: 1.132 Vali Acc: 0.400 Test Loss: 1.132 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.7062017917633057
Epoch: 13, Steps: 1 | Train Loss: 0.924 Vali Loss: 1.135 Vali Acc: 0.400 Test Loss: 1.135 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.67742919921875
Epoch: 14, Steps: 1 | Train Loss: 0.871 Vali Loss: 1.139 Vali Acc: 0.400 Test Loss: 1.139 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm8_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 235539
model size : 1.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm8_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.409817695617676
Epoch: 1, Steps: 1 | Train Loss: 1.184 Vali Loss: 1.121 Vali Acc: 0.467 Test Loss: 1.121 Test Acc: 0.467
Validation loss decreased (inf --> -0.466655).  Saving model ...
Epoch: 2 cost time: 0.5837843418121338
Epoch: 2, Steps: 1 | Train Loss: 1.158 Vali Loss: 1.118 Vali Acc: 0.467 Test Loss: 1.118 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 3 cost time: 0.5684473514556885
Epoch: 3, Steps: 1 | Train Loss: 1.114 Vali Loss: 1.117 Vali Acc: 0.400 Test Loss: 1.117 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5482497215270996
Epoch: 4, Steps: 1 | Train Loss: 1.144 Vali Loss: 1.116 Vali Acc: 0.400 Test Loss: 1.116 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.6125109195709229
Epoch: 5, Steps: 1 | Train Loss: 1.124 Vali Loss: 1.115 Vali Acc: 0.400 Test Loss: 1.115 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.6083381175994873
Epoch: 6, Steps: 1 | Train Loss: 1.104 Vali Loss: 1.115 Vali Acc: 0.400 Test Loss: 1.115 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.5807487964630127
Epoch: 7, Steps: 1 | Train Loss: 1.096 Vali Loss: 1.115 Vali Acc: 0.400 Test Loss: 1.115 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.5794556140899658
Epoch: 8, Steps: 1 | Train Loss: 1.125 Vali Loss: 1.115 Vali Acc: 0.400 Test Loss: 1.115 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.5605819225311279
Epoch: 9, Steps: 1 | Train Loss: 1.124 Vali Loss: 1.115 Vali Acc: 0.400 Test Loss: 1.115 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.5497791767120361
Epoch: 10, Steps: 1 | Train Loss: 1.021 Vali Loss: 1.116 Vali Acc: 0.467 Test Loss: 1.116 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466656).  Saving model ...
Epoch: 11 cost time: 0.5628054141998291
Epoch: 11, Steps: 1 | Train Loss: 1.060 Vali Loss: 1.116 Vali Acc: 0.467 Test Loss: 1.116 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6382913589477539
Epoch: 12, Steps: 1 | Train Loss: 0.975 Vali Loss: 1.117 Vali Acc: 0.467 Test Loss: 1.117 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.5740337371826172
Epoch: 13, Steps: 1 | Train Loss: 0.962 Vali Loss: 1.118 Vali Acc: 0.467 Test Loss: 1.118 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.5847511291503906
Epoch: 14, Steps: 1 | Train Loss: 0.890 Vali Loss: 1.119 Vali Acc: 0.467 Test Loss: 1.119 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.7576992511749268
Epoch: 15, Steps: 1 | Train Loss: 0.939 Vali Loss: 1.121 Vali Acc: 0.467 Test Loss: 1.121 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.6253182888031006
Epoch: 16, Steps: 1 | Train Loss: 0.861 Vali Loss: 1.123 Vali Acc: 0.467 Test Loss: 1.123 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.6069836616516113
Epoch: 17, Steps: 1 | Train Loss: 0.836 Vali Loss: 1.125 Vali Acc: 0.467 Test Loss: 1.125 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.5466723442077637
Epoch: 18, Steps: 1 | Train Loss: 0.827 Vali Loss: 1.127 Vali Acc: 0.533 Test Loss: 1.127 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 19 cost time: 0.5847184658050537
Epoch: 19, Steps: 1 | Train Loss: 0.831 Vali Loss: 1.130 Vali Acc: 0.533 Test Loss: 1.130 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.5240774154663086
Epoch: 20, Steps: 1 | Train Loss: 0.774 Vali Loss: 1.133 Vali Acc: 0.533 Test Loss: 1.133 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.6007356643676758
Epoch: 21, Steps: 1 | Train Loss: 0.745 Vali Loss: 1.137 Vali Acc: 0.533 Test Loss: 1.137 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.56085205078125
Epoch: 22, Steps: 1 | Train Loss: 0.742 Vali Loss: 1.142 Vali Acc: 0.467 Test Loss: 1.142 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.5465407371520996
Epoch: 23, Steps: 1 | Train Loss: 0.704 Vali Loss: 1.146 Vali Acc: 0.467 Test Loss: 1.146 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.6313035488128662
Epoch: 24, Steps: 1 | Train Loss: 0.639 Vali Loss: 1.152 Vali Acc: 0.467 Test Loss: 1.152 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.5596504211425781
Epoch: 25, Steps: 1 | Train Loss: 0.594 Vali Loss: 1.157 Vali Acc: 0.467 Test Loss: 1.157 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.584702730178833
Epoch: 26, Steps: 1 | Train Loss: 0.539 Vali Loss: 1.163 Vali Acc: 0.467 Test Loss: 1.163 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.5859875679016113
Epoch: 27, Steps: 1 | Train Loss: 0.545 Vali Loss: 1.169 Vali Acc: 0.467 Test Loss: 1.169 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.5948967933654785
Epoch: 28, Steps: 1 | Train Loss: 0.511 Vali Loss: 1.176 Vali Acc: 0.467 Test Loss: 1.176 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm8_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 80259
model size : 0.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm8_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.4914987087249756
Epoch: 1, Steps: 1 | Train Loss: 1.102 Vali Loss: 1.134 Vali Acc: 0.400 Test Loss: 1.134 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.5750672817230225
Epoch: 2, Steps: 1 | Train Loss: 1.161 Vali Loss: 1.130 Vali Acc: 0.333 Test Loss: 1.130 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5377190113067627
Epoch: 3, Steps: 1 | Train Loss: 1.146 Vali Loss: 1.127 Vali Acc: 0.400 Test Loss: 1.127 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.6084175109863281
Epoch: 4, Steps: 1 | Train Loss: 1.119 Vali Loss: 1.125 Vali Acc: 0.400 Test Loss: 1.125 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.5780744552612305
Epoch: 5, Steps: 1 | Train Loss: 1.142 Vali Loss: 1.124 Vali Acc: 0.333 Test Loss: 1.124 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.6263761520385742
Epoch: 6, Steps: 1 | Train Loss: 1.017 Vali Loss: 1.124 Vali Acc: 0.333 Test Loss: 1.124 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.7710158824920654
Epoch: 7, Steps: 1 | Train Loss: 1.003 Vali Loss: 1.124 Vali Acc: 0.267 Test Loss: 1.124 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.6540431976318359
Epoch: 8, Steps: 1 | Train Loss: 0.979 Vali Loss: 1.125 Vali Acc: 0.267 Test Loss: 1.125 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.5843925476074219
Epoch: 9, Steps: 1 | Train Loss: 0.992 Vali Loss: 1.126 Vali Acc: 0.267 Test Loss: 1.126 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.5474979877471924
Epoch: 10, Steps: 1 | Train Loss: 0.947 Vali Loss: 1.127 Vali Acc: 0.267 Test Loss: 1.127 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.7012712955474854
Epoch: 11, Steps: 1 | Train Loss: 0.939 Vali Loss: 1.130 Vali Acc: 0.333 Test Loss: 1.130 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.6055362224578857
Epoch: 12, Steps: 1 | Train Loss: 0.913 Vali Loss: 1.132 Vali Acc: 0.333 Test Loss: 1.132 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.6582214832305908
Epoch: 13, Steps: 1 | Train Loss: 0.924 Vali Loss: 1.136 Vali Acc: 0.400 Test Loss: 1.136 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.6009049415588379
Epoch: 14, Steps: 1 | Train Loss: 0.868 Vali Loss: 1.139 Vali Acc: 0.400 Test Loss: 1.139 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm8_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 235539
model size : 1.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm8_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.352846384048462
Epoch: 1, Steps: 1 | Train Loss: 1.188 Vali Loss: 1.114 Vali Acc: 0.467 Test Loss: 1.114 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.4994678497314453
Epoch: 2, Steps: 1 | Train Loss: 1.161 Vali Loss: 1.112 Vali Acc: 0.467 Test Loss: 1.112 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.5131289958953857
Epoch: 3, Steps: 1 | Train Loss: 1.113 Vali Loss: 1.110 Vali Acc: 0.333 Test Loss: 1.110 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5170032978057861
Epoch: 4, Steps: 1 | Train Loss: 1.160 Vali Loss: 1.109 Vali Acc: 0.400 Test Loss: 1.109 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.5094683170318604
Epoch: 5, Steps: 1 | Train Loss: 1.127 Vali Loss: 1.108 Vali Acc: 0.400 Test Loss: 1.108 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.47570037841796875
Epoch: 6, Steps: 1 | Train Loss: 1.111 Vali Loss: 1.108 Vali Acc: 0.400 Test Loss: 1.108 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.5702013969421387
Epoch: 7, Steps: 1 | Train Loss: 1.102 Vali Loss: 1.108 Vali Acc: 0.400 Test Loss: 1.108 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.5701401233673096
Epoch: 8, Steps: 1 | Train Loss: 1.126 Vali Loss: 1.108 Vali Acc: 0.400 Test Loss: 1.108 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.4940974712371826
Epoch: 9, Steps: 1 | Train Loss: 1.129 Vali Loss: 1.108 Vali Acc: 0.467 Test Loss: 1.108 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 10 cost time: 0.5878326892852783
Epoch: 10, Steps: 1 | Train Loss: 1.014 Vali Loss: 1.108 Vali Acc: 0.467 Test Loss: 1.108 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.48869752883911133
Epoch: 11, Steps: 1 | Train Loss: 1.062 Vali Loss: 1.108 Vali Acc: 0.467 Test Loss: 1.108 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.6472046375274658
Epoch: 12, Steps: 1 | Train Loss: 0.978 Vali Loss: 1.109 Vali Acc: 0.467 Test Loss: 1.109 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.5322835445404053
Epoch: 13, Steps: 1 | Train Loss: 0.970 Vali Loss: 1.109 Vali Acc: 0.467 Test Loss: 1.109 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.5784645080566406
Epoch: 14, Steps: 1 | Train Loss: 0.906 Vali Loss: 1.110 Vali Acc: 0.467 Test Loss: 1.110 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.513375997543335
Epoch: 15, Steps: 1 | Train Loss: 0.939 Vali Loss: 1.111 Vali Acc: 0.467 Test Loss: 1.111 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.5324065685272217
Epoch: 16, Steps: 1 | Train Loss: 0.858 Vali Loss: 1.112 Vali Acc: 0.467 Test Loss: 1.112 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.4862709045410156
Epoch: 17, Steps: 1 | Train Loss: 0.838 Vali Loss: 1.114 Vali Acc: 0.467 Test Loss: 1.114 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.5154707431793213
Epoch: 18, Steps: 1 | Train Loss: 0.832 Vali Loss: 1.116 Vali Acc: 0.533 Test Loss: 1.116 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 19 cost time: 0.6096827983856201
Epoch: 19, Steps: 1 | Train Loss: 0.840 Vali Loss: 1.118 Vali Acc: 0.533 Test Loss: 1.118 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.47367382049560547
Epoch: 20, Steps: 1 | Train Loss: 0.776 Vali Loss: 1.120 Vali Acc: 0.533 Test Loss: 1.120 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.5034737586975098
Epoch: 21, Steps: 1 | Train Loss: 0.756 Vali Loss: 1.123 Vali Acc: 0.533 Test Loss: 1.123 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.5158951282501221
Epoch: 22, Steps: 1 | Train Loss: 0.749 Vali Loss: 1.127 Vali Acc: 0.533 Test Loss: 1.127 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.4828920364379883
Epoch: 23, Steps: 1 | Train Loss: 0.712 Vali Loss: 1.130 Vali Acc: 0.533 Test Loss: 1.130 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.5601413249969482
Epoch: 24, Steps: 1 | Train Loss: 0.640 Vali Loss: 1.134 Vali Acc: 0.533 Test Loss: 1.134 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.5214133262634277
Epoch: 25, Steps: 1 | Train Loss: 0.603 Vali Loss: 1.139 Vali Acc: 0.533 Test Loss: 1.139 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.5166628360748291
Epoch: 26, Steps: 1 | Train Loss: 0.548 Vali Loss: 1.143 Vali Acc: 0.467 Test Loss: 1.143 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.5376157760620117
Epoch: 27, Steps: 1 | Train Loss: 0.550 Vali Loss: 1.147 Vali Acc: 0.467 Test Loss: 1.147 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.5320241451263428
Epoch: 28, Steps: 1 | Train Loss: 0.514 Vali Loss: 1.152 Vali Acc: 0.467 Test Loss: 1.152 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm8_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 80259
model size : 0.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm8_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.369223117828369
Epoch: 1, Steps: 1 | Train Loss: 1.098 Vali Loss: 1.134 Vali Acc: 0.333 Test Loss: 1.134 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.6463415622711182
Epoch: 2, Steps: 1 | Train Loss: 1.152 Vali Loss: 1.130 Vali Acc: 0.333 Test Loss: 1.130 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.5282802581787109
Epoch: 3, Steps: 1 | Train Loss: 1.145 Vali Loss: 1.127 Vali Acc: 0.400 Test Loss: 1.127 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.6448924541473389
Epoch: 4, Steps: 1 | Train Loss: 1.118 Vali Loss: 1.125 Vali Acc: 0.333 Test Loss: 1.125 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5489826202392578
Epoch: 5, Steps: 1 | Train Loss: 1.154 Vali Loss: 1.124 Vali Acc: 0.333 Test Loss: 1.124 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.512113094329834
Epoch: 6, Steps: 1 | Train Loss: 1.019 Vali Loss: 1.124 Vali Acc: 0.333 Test Loss: 1.124 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.5090274810791016
Epoch: 7, Steps: 1 | Train Loss: 1.019 Vali Loss: 1.124 Vali Acc: 0.267 Test Loss: 1.124 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.5510244369506836
Epoch: 8, Steps: 1 | Train Loss: 0.994 Vali Loss: 1.125 Vali Acc: 0.267 Test Loss: 1.125 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.5408143997192383
Epoch: 9, Steps: 1 | Train Loss: 0.996 Vali Loss: 1.126 Vali Acc: 0.333 Test Loss: 1.126 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.5764720439910889
Epoch: 10, Steps: 1 | Train Loss: 0.962 Vali Loss: 1.127 Vali Acc: 0.333 Test Loss: 1.127 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.5780637264251709
Epoch: 11, Steps: 1 | Train Loss: 0.963 Vali Loss: 1.130 Vali Acc: 0.333 Test Loss: 1.130 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.6357705593109131
Epoch: 12, Steps: 1 | Train Loss: 0.920 Vali Loss: 1.132 Vali Acc: 0.333 Test Loss: 1.132 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.5991513729095459
Epoch: 13, Steps: 1 | Train Loss: 0.955 Vali Loss: 1.135 Vali Acc: 0.333 Test Loss: 1.135 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm8_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 235539
model size : 1.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm8_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.369462251663208
Epoch: 1, Steps: 1 | Train Loss: 1.195 Vali Loss: 1.120 Vali Acc: 0.467 Test Loss: 1.120 Test Acc: 0.467
Validation loss decreased (inf --> -0.466655).  Saving model ...
Epoch: 2 cost time: 0.4775722026824951
Epoch: 2, Steps: 1 | Train Loss: 1.157 Vali Loss: 1.118 Vali Acc: 0.467 Test Loss: 1.118 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 3 cost time: 0.48816490173339844
Epoch: 3, Steps: 1 | Train Loss: 1.111 Vali Loss: 1.116 Vali Acc: 0.333 Test Loss: 1.116 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5302572250366211
Epoch: 4, Steps: 1 | Train Loss: 1.147 Vali Loss: 1.115 Vali Acc: 0.400 Test Loss: 1.115 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.507439374923706
Epoch: 5, Steps: 1 | Train Loss: 1.128 Vali Loss: 1.115 Vali Acc: 0.400 Test Loss: 1.115 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.5079226493835449
Epoch: 6, Steps: 1 | Train Loss: 1.115 Vali Loss: 1.115 Vali Acc: 0.400 Test Loss: 1.115 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.5098240375518799
Epoch: 7, Steps: 1 | Train Loss: 1.106 Vali Loss: 1.115 Vali Acc: 0.400 Test Loss: 1.115 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.5509614944458008
Epoch: 8, Steps: 1 | Train Loss: 1.125 Vali Loss: 1.116 Vali Acc: 0.400 Test Loss: 1.116 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.49240851402282715
Epoch: 9, Steps: 1 | Train Loss: 1.126 Vali Loss: 1.116 Vali Acc: 0.467 Test Loss: 1.116 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466656).  Saving model ...
Epoch: 10 cost time: 0.5111353397369385
Epoch: 10, Steps: 1 | Train Loss: 1.014 Vali Loss: 1.117 Vali Acc: 0.467 Test Loss: 1.117 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.44893884658813477
Epoch: 11, Steps: 1 | Train Loss: 1.063 Vali Loss: 1.118 Vali Acc: 0.467 Test Loss: 1.118 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.5051360130310059
Epoch: 12, Steps: 1 | Train Loss: 0.975 Vali Loss: 1.119 Vali Acc: 0.467 Test Loss: 1.119 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.45160436630249023
Epoch: 13, Steps: 1 | Train Loss: 0.974 Vali Loss: 1.121 Vali Acc: 0.467 Test Loss: 1.121 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.43651556968688965
Epoch: 14, Steps: 1 | Train Loss: 0.914 Vali Loss: 1.122 Vali Acc: 0.467 Test Loss: 1.122 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.44495558738708496
Epoch: 15, Steps: 1 | Train Loss: 0.951 Vali Loss: 1.124 Vali Acc: 0.467 Test Loss: 1.124 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.450056791305542
Epoch: 16, Steps: 1 | Train Loss: 0.863 Vali Loss: 1.126 Vali Acc: 0.467 Test Loss: 1.126 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.44553494453430176
Epoch: 17, Steps: 1 | Train Loss: 0.844 Vali Loss: 1.128 Vali Acc: 0.467 Test Loss: 1.128 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.4481072425842285
Epoch: 18, Steps: 1 | Train Loss: 0.830 Vali Loss: 1.131 Vali Acc: 0.467 Test Loss: 1.131 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.5057225227355957
Epoch: 19, Steps: 1 | Train Loss: 0.852 Vali Loss: 1.134 Vali Acc: 0.533 Test Loss: 1.134 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 20 cost time: 0.4395174980163574
Epoch: 20, Steps: 1 | Train Loss: 0.786 Vali Loss: 1.138 Vali Acc: 0.533 Test Loss: 1.138 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.4594998359680176
Epoch: 21, Steps: 1 | Train Loss: 0.761 Vali Loss: 1.142 Vali Acc: 0.533 Test Loss: 1.142 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.479902982711792
Epoch: 22, Steps: 1 | Train Loss: 0.762 Vali Loss: 1.147 Vali Acc: 0.533 Test Loss: 1.147 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.454378604888916
Epoch: 23, Steps: 1 | Train Loss: 0.719 Vali Loss: 1.152 Vali Acc: 0.533 Test Loss: 1.152 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.485154390335083
Epoch: 24, Steps: 1 | Train Loss: 0.642 Vali Loss: 1.157 Vali Acc: 0.533 Test Loss: 1.157 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.5108187198638916
Epoch: 25, Steps: 1 | Train Loss: 0.608 Vali Loss: 1.163 Vali Acc: 0.467 Test Loss: 1.163 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.48571300506591797
Epoch: 26, Steps: 1 | Train Loss: 0.549 Vali Loss: 1.168 Vali Acc: 0.467 Test Loss: 1.168 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.4794802665710449
Epoch: 27, Steps: 1 | Train Loss: 0.552 Vali Loss: 1.174 Vali Acc: 0.467 Test Loss: 1.174 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.49741649627685547
Epoch: 28, Steps: 1 | Train Loss: 0.521 Vali Loss: 1.181 Vali Acc: 0.467 Test Loss: 1.181 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.4888942241668701
Epoch: 29, Steps: 1 | Train Loss: 0.499 Vali Loss: 1.188 Vali Acc: 0.467 Test Loss: 1.188 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el3_dm8_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 80259
model size : 0.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm128_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 10.031211614608765
Epoch: 1, Steps: 1 | Train Loss: 1.220 Vali Loss: 1.152 Vali Acc: 0.200 Test Loss: 1.152 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 7.209933519363403
Epoch: 2, Steps: 1 | Train Loss: 1.084 Vali Loss: 1.161 Vali Acc: 0.333 Test Loss: 1.161 Test Acc: 0.333
Validation loss decreased (-0.199988 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 3.330508232116699
Epoch: 3, Steps: 1 | Train Loss: 1.042 Vali Loss: 1.174 Vali Acc: 0.333 Test Loss: 1.174 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.3692069053649902
Epoch: 4, Steps: 1 | Train Loss: 0.954 Vali Loss: 1.187 Vali Acc: 0.333 Test Loss: 1.187 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.0772812366485596
Epoch: 5, Steps: 1 | Train Loss: 0.890 Vali Loss: 1.198 Vali Acc: 0.267 Test Loss: 1.198 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.840632915496826
Epoch: 6, Steps: 1 | Train Loss: 0.829 Vali Loss: 1.224 Vali Acc: 0.267 Test Loss: 1.224 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.2393970489501953
Epoch: 7, Steps: 1 | Train Loss: 0.597 Vali Loss: 1.254 Vali Acc: 0.333 Test Loss: 1.254 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.0690033435821533
Epoch: 8, Steps: 1 | Train Loss: 0.462 Vali Loss: 1.292 Vali Acc: 0.267 Test Loss: 1.292 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.060610055923462
Epoch: 9, Steps: 1 | Train Loss: 0.344 Vali Loss: 1.333 Vali Acc: 0.267 Test Loss: 1.333 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.2150778770446777
Epoch: 10, Steps: 1 | Train Loss: 0.231 Vali Loss: 1.392 Vali Acc: 0.267 Test Loss: 1.392 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.8269894123077393
Epoch: 11, Steps: 1 | Train Loss: 0.156 Vali Loss: 1.471 Vali Acc: 0.333 Test Loss: 1.471 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 3.3437271118164062
Epoch: 12, Steps: 1 | Train Loss: 0.103 Vali Loss: 1.548 Vali Acc: 0.333 Test Loss: 1.548 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm128_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 37738499
model size : 146.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm128_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 4.3188557624816895
Epoch: 1, Steps: 1 | Train Loss: 1.127 Vali Loss: 1.168 Vali Acc: 0.133 Test Loss: 1.168 Test Acc: 0.133
Validation loss decreased (inf --> -0.133322).  Saving model ...
Epoch: 2 cost time: 1.6260085105895996
Epoch: 2, Steps: 1 | Train Loss: 1.098 Vali Loss: 1.170 Vali Acc: 0.133 Test Loss: 1.170 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4496829509735107
Epoch: 3, Steps: 1 | Train Loss: 0.976 Vali Loss: 1.180 Vali Acc: 0.267 Test Loss: 1.180 Test Acc: 0.267
Validation loss decreased (-0.133322 --> -0.266655).  Saving model ...
Epoch: 4 cost time: 1.5126574039459229
Epoch: 4, Steps: 1 | Train Loss: 0.906 Vali Loss: 1.193 Vali Acc: 0.267 Test Loss: 1.193 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.444779634475708
Epoch: 5, Steps: 1 | Train Loss: 0.908 Vali Loss: 1.205 Vali Acc: 0.267 Test Loss: 1.205 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.3135967254638672
Epoch: 6, Steps: 1 | Train Loss: 0.768 Vali Loss: 1.227 Vali Acc: 0.267 Test Loss: 1.227 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.4707372188568115
Epoch: 7, Steps: 1 | Train Loss: 0.642 Vali Loss: 1.259 Vali Acc: 0.200 Test Loss: 1.259 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.5255520343780518
Epoch: 8, Steps: 1 | Train Loss: 0.511 Vali Loss: 1.308 Vali Acc: 0.133 Test Loss: 1.308 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.5287222862243652
Epoch: 9, Steps: 1 | Train Loss: 0.379 Vali Loss: 1.368 Vali Acc: 0.200 Test Loss: 1.368 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.496380090713501
Epoch: 10, Steps: 1 | Train Loss: 0.265 Vali Loss: 1.433 Vali Acc: 0.267 Test Loss: 1.433 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.3153984546661377
Epoch: 11, Steps: 1 | Train Loss: 0.187 Vali Loss: 1.517 Vali Acc: 0.333 Test Loss: 1.517 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333318).  Saving model ...
Epoch: 12 cost time: 1.430832862854004
Epoch: 12, Steps: 1 | Train Loss: 0.113 Vali Loss: 1.607 Vali Acc: 0.267 Test Loss: 1.607 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4529929161071777
Epoch: 13, Steps: 1 | Train Loss: 0.069 Vali Loss: 1.677 Vali Acc: 0.267 Test Loss: 1.677 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.5006968975067139
Epoch: 14, Steps: 1 | Train Loss: 0.039 Vali Loss: 1.751 Vali Acc: 0.267 Test Loss: 1.751 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.48297119140625
Epoch: 15, Steps: 1 | Train Loss: 0.033 Vali Loss: 1.816 Vali Acc: 0.267 Test Loss: 1.816 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.524465560913086
Epoch: 16, Steps: 1 | Train Loss: 0.012 Vali Loss: 1.886 Vali Acc: 0.333 Test Loss: 1.886 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.420414924621582
Epoch: 17, Steps: 1 | Train Loss: 0.007 Vali Loss: 1.962 Vali Acc: 0.333 Test Loss: 1.962 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.4408376216888428
Epoch: 18, Steps: 1 | Train Loss: 0.004 Vali Loss: 2.040 Vali Acc: 0.333 Test Loss: 2.040 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.4191172122955322
Epoch: 19, Steps: 1 | Train Loss: 0.002 Vali Loss: 2.116 Vali Acc: 0.333 Test Loss: 2.116 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.488499641418457
Epoch: 20, Steps: 1 | Train Loss: 0.002 Vali Loss: 2.190 Vali Acc: 0.333 Test Loss: 2.190 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.4614508152008057
Epoch: 21, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.262 Vali Acc: 0.333 Test Loss: 2.262 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm128_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 11260419
model size : 45.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm128_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 6.930151700973511
Epoch: 1, Steps: 1 | Train Loss: 1.224 Vali Loss: 1.157 Vali Acc: 0.200 Test Loss: 1.157 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 2.449953079223633
Epoch: 2, Steps: 1 | Train Loss: 1.078 Vali Loss: 1.166 Vali Acc: 0.333 Test Loss: 1.166 Test Acc: 0.333
Validation loss decreased (-0.199988 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 2.6410391330718994
Epoch: 3, Steps: 1 | Train Loss: 1.045 Vali Loss: 1.180 Vali Acc: 0.333 Test Loss: 1.180 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.4714808464050293
Epoch: 4, Steps: 1 | Train Loss: 0.959 Vali Loss: 1.194 Vali Acc: 0.267 Test Loss: 1.194 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.5169034004211426
Epoch: 5, Steps: 1 | Train Loss: 0.892 Vali Loss: 1.206 Vali Acc: 0.267 Test Loss: 1.206 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.6461751461029053
Epoch: 6, Steps: 1 | Train Loss: 0.825 Vali Loss: 1.231 Vali Acc: 0.267 Test Loss: 1.231 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.402494192123413
Epoch: 7, Steps: 1 | Train Loss: 0.623 Vali Loss: 1.261 Vali Acc: 0.333 Test Loss: 1.261 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.6104719638824463
Epoch: 8, Steps: 1 | Train Loss: 0.504 Vali Loss: 1.301 Vali Acc: 0.267 Test Loss: 1.301 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.4916577339172363
Epoch: 9, Steps: 1 | Train Loss: 0.377 Vali Loss: 1.346 Vali Acc: 0.333 Test Loss: 1.346 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.29988431930542
Epoch: 10, Steps: 1 | Train Loss: 0.256 Vali Loss: 1.414 Vali Acc: 0.333 Test Loss: 1.414 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.1925806999206543
Epoch: 11, Steps: 1 | Train Loss: 0.166 Vali Loss: 1.507 Vali Acc: 0.333 Test Loss: 1.507 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.4724843502044678
Epoch: 12, Steps: 1 | Train Loss: 0.112 Vali Loss: 1.582 Vali Acc: 0.333 Test Loss: 1.582 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm128_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 37738499
model size : 146.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm128_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 4.268291473388672
Epoch: 1, Steps: 1 | Train Loss: 1.107 Vali Loss: 1.167 Vali Acc: 0.200 Test Loss: 1.167 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 1.2269997596740723
Epoch: 2, Steps: 1 | Train Loss: 1.092 Vali Loss: 1.168 Vali Acc: 0.133 Test Loss: 1.168 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2198116779327393
Epoch: 3, Steps: 1 | Train Loss: 0.984 Vali Loss: 1.179 Vali Acc: 0.267 Test Loss: 1.179 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266655).  Saving model ...
Epoch: 4 cost time: 1.1727252006530762
Epoch: 4, Steps: 1 | Train Loss: 0.894 Vali Loss: 1.192 Vali Acc: 0.267 Test Loss: 1.192 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1535441875457764
Epoch: 5, Steps: 1 | Train Loss: 0.907 Vali Loss: 1.205 Vali Acc: 0.267 Test Loss: 1.205 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.2271652221679688
Epoch: 6, Steps: 1 | Train Loss: 0.767 Vali Loss: 1.223 Vali Acc: 0.267 Test Loss: 1.223 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.1909477710723877
Epoch: 7, Steps: 1 | Train Loss: 0.646 Vali Loss: 1.251 Vali Acc: 0.267 Test Loss: 1.251 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.3720154762268066
Epoch: 8, Steps: 1 | Train Loss: 0.517 Vali Loss: 1.296 Vali Acc: 0.133 Test Loss: 1.296 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.2025306224822998
Epoch: 9, Steps: 1 | Train Loss: 0.389 Vali Loss: 1.353 Vali Acc: 0.133 Test Loss: 1.353 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.2597856521606445
Epoch: 10, Steps: 1 | Train Loss: 0.269 Vali Loss: 1.416 Vali Acc: 0.267 Test Loss: 1.416 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.1821660995483398
Epoch: 11, Steps: 1 | Train Loss: 0.190 Vali Loss: 1.499 Vali Acc: 0.333 Test Loss: 1.499 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333318).  Saving model ...
Epoch: 12 cost time: 1.2805230617523193
Epoch: 12, Steps: 1 | Train Loss: 0.117 Vali Loss: 1.589 Vali Acc: 0.333 Test Loss: 1.589 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.332451343536377
Epoch: 13, Steps: 1 | Train Loss: 0.069 Vali Loss: 1.656 Vali Acc: 0.333 Test Loss: 1.656 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.2766716480255127
Epoch: 14, Steps: 1 | Train Loss: 0.038 Vali Loss: 1.725 Vali Acc: 0.267 Test Loss: 1.725 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.1483228206634521
Epoch: 15, Steps: 1 | Train Loss: 0.023 Vali Loss: 1.802 Vali Acc: 0.267 Test Loss: 1.802 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.2082781791687012
Epoch: 16, Steps: 1 | Train Loss: 0.012 Vali Loss: 1.883 Vali Acc: 0.267 Test Loss: 1.883 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.2560360431671143
Epoch: 17, Steps: 1 | Train Loss: 0.007 Vali Loss: 1.968 Vali Acc: 0.267 Test Loss: 1.968 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.3090486526489258
Epoch: 18, Steps: 1 | Train Loss: 0.004 Vali Loss: 2.054 Vali Acc: 0.267 Test Loss: 2.054 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.3073410987854004
Epoch: 19, Steps: 1 | Train Loss: 0.002 Vali Loss: 2.140 Vali Acc: 0.267 Test Loss: 2.140 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.3054008483886719
Epoch: 20, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.225 Vali Acc: 0.267 Test Loss: 2.225 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.145097017288208
Epoch: 21, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.307 Vali Acc: 0.267 Test Loss: 2.307 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm128_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 11260419
model size : 45.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm128_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 6.096412897109985
Epoch: 1, Steps: 1 | Train Loss: 1.223 Vali Loss: 1.139 Vali Acc: 0.200 Test Loss: 1.139 Test Acc: 0.200
Validation loss decreased (inf --> -0.199989).  Saving model ...
Epoch: 2 cost time: 1.7247724533081055
Epoch: 2, Steps: 1 | Train Loss: 1.082 Vali Loss: 1.149 Vali Acc: 0.333 Test Loss: 1.149 Test Acc: 0.333
Validation loss decreased (-0.199989 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 2.0450456142425537
Epoch: 3, Steps: 1 | Train Loss: 1.045 Vali Loss: 1.163 Vali Acc: 0.333 Test Loss: 1.163 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.217789649963379
Epoch: 4, Steps: 1 | Train Loss: 0.960 Vali Loss: 1.178 Vali Acc: 0.267 Test Loss: 1.178 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.0580978393554688
Epoch: 5, Steps: 1 | Train Loss: 0.892 Vali Loss: 1.189 Vali Acc: 0.267 Test Loss: 1.189 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.1268792152404785
Epoch: 6, Steps: 1 | Train Loss: 0.824 Vali Loss: 1.214 Vali Acc: 0.267 Test Loss: 1.214 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.111192464828491
Epoch: 7, Steps: 1 | Train Loss: 0.635 Vali Loss: 1.245 Vali Acc: 0.333 Test Loss: 1.245 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.0337281227111816
Epoch: 8, Steps: 1 | Train Loss: 0.518 Vali Loss: 1.284 Vali Acc: 0.267 Test Loss: 1.284 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.286215305328369
Epoch: 9, Steps: 1 | Train Loss: 0.389 Vali Loss: 1.330 Vali Acc: 0.267 Test Loss: 1.330 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.0479888916015625
Epoch: 10, Steps: 1 | Train Loss: 0.267 Vali Loss: 1.400 Vali Acc: 0.267 Test Loss: 1.400 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.0136425495147705
Epoch: 11, Steps: 1 | Train Loss: 0.176 Vali Loss: 1.491 Vali Acc: 0.333 Test Loss: 1.491 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.9864647388458252
Epoch: 12, Steps: 1 | Train Loss: 0.118 Vali Loss: 1.569 Vali Acc: 0.333 Test Loss: 1.569 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm128_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 37738499
model size : 146.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm128_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 3.3641250133514404
Epoch: 1, Steps: 1 | Train Loss: 1.110 Vali Loss: 1.167 Vali Acc: 0.133 Test Loss: 1.167 Test Acc: 0.133
Validation loss decreased (inf --> -0.133322).  Saving model ...
Epoch: 2 cost time: 0.93631911277771
Epoch: 2, Steps: 1 | Train Loss: 1.095 Vali Loss: 1.169 Vali Acc: 0.133 Test Loss: 1.169 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9358375072479248
Epoch: 3, Steps: 1 | Train Loss: 0.977 Vali Loss: 1.181 Vali Acc: 0.267 Test Loss: 1.181 Test Acc: 0.267
Validation loss decreased (-0.133322 --> -0.266655).  Saving model ...
Epoch: 4 cost time: 1.0818791389465332
Epoch: 4, Steps: 1 | Train Loss: 0.883 Vali Loss: 1.195 Vali Acc: 0.267 Test Loss: 1.195 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.102339744567871
Epoch: 5, Steps: 1 | Train Loss: 0.898 Vali Loss: 1.207 Vali Acc: 0.267 Test Loss: 1.207 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.0562214851379395
Epoch: 6, Steps: 1 | Train Loss: 0.759 Vali Loss: 1.224 Vali Acc: 0.267 Test Loss: 1.224 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.9945564270019531
Epoch: 7, Steps: 1 | Train Loss: 0.648 Vali Loss: 1.253 Vali Acc: 0.267 Test Loss: 1.253 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.033860445022583
Epoch: 8, Steps: 1 | Train Loss: 0.524 Vali Loss: 1.298 Vali Acc: 0.200 Test Loss: 1.298 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.0986649990081787
Epoch: 9, Steps: 1 | Train Loss: 0.398 Vali Loss: 1.355 Vali Acc: 0.200 Test Loss: 1.355 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.0064325332641602
Epoch: 10, Steps: 1 | Train Loss: 0.276 Vali Loss: 1.419 Vali Acc: 0.200 Test Loss: 1.419 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.0826539993286133
Epoch: 11, Steps: 1 | Train Loss: 0.196 Vali Loss: 1.504 Vali Acc: 0.267 Test Loss: 1.504 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.0216896533966064
Epoch: 12, Steps: 1 | Train Loss: 0.122 Vali Loss: 1.595 Vali Acc: 0.333 Test Loss: 1.595 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333317).  Saving model ...
Epoch: 13 cost time: 0.971566915512085
Epoch: 13, Steps: 1 | Train Loss: 0.076 Vali Loss: 1.661 Vali Acc: 0.333 Test Loss: 1.661 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.181929111480713
Epoch: 14, Steps: 1 | Train Loss: 0.042 Vali Loss: 1.733 Vali Acc: 0.267 Test Loss: 1.733 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.035895824432373
Epoch: 15, Steps: 1 | Train Loss: 0.025 Vali Loss: 1.814 Vali Acc: 0.200 Test Loss: 1.814 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.9288976192474365
Epoch: 16, Steps: 1 | Train Loss: 0.013 Vali Loss: 1.899 Vali Acc: 0.200 Test Loss: 1.899 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.9752845764160156
Epoch: 17, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.987 Vali Acc: 0.333 Test Loss: 1.987 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.0197186470031738
Epoch: 18, Steps: 1 | Train Loss: 0.005 Vali Loss: 2.077 Vali Acc: 0.333 Test Loss: 2.077 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.1039824485778809
Epoch: 19, Steps: 1 | Train Loss: 0.003 Vali Loss: 2.167 Vali Acc: 0.333 Test Loss: 2.167 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.1641850471496582
Epoch: 20, Steps: 1 | Train Loss: 0.002 Vali Loss: 2.256 Vali Acc: 0.333 Test Loss: 2.256 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.2063732147216797
Epoch: 21, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.342 Vali Acc: 0.267 Test Loss: 2.342 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.114088535308838
Epoch: 22, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.426 Vali Acc: 0.267 Test Loss: 2.426 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm128_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 11260419
model size : 45.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm128_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 6.533815145492554
Epoch: 1, Steps: 1 | Train Loss: 1.233 Vali Loss: 1.133 Vali Acc: 0.400 Test Loss: 1.133 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 2.0539562702178955
Epoch: 2, Steps: 1 | Train Loss: 1.193 Vali Loss: 1.130 Vali Acc: 0.333 Test Loss: 1.130 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.110645055770874
Epoch: 3, Steps: 1 | Train Loss: 1.072 Vali Loss: 1.135 Vali Acc: 0.267 Test Loss: 1.135 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.055634021759033
Epoch: 4, Steps: 1 | Train Loss: 0.981 Vali Loss: 1.143 Vali Acc: 0.333 Test Loss: 1.143 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.8630964756011963
Epoch: 5, Steps: 1 | Train Loss: 0.874 Vali Loss: 1.151 Vali Acc: 0.333 Test Loss: 1.151 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.0115859508514404
Epoch: 6, Steps: 1 | Train Loss: 0.783 Vali Loss: 1.171 Vali Acc: 0.400 Test Loss: 1.171 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.9960520267486572
Epoch: 7, Steps: 1 | Train Loss: 0.660 Vali Loss: 1.204 Vali Acc: 0.267 Test Loss: 1.204 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.0468945503234863
Epoch: 8, Steps: 1 | Train Loss: 0.472 Vali Loss: 1.256 Vali Acc: 0.267 Test Loss: 1.256 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.0750818252563477
Epoch: 9, Steps: 1 | Train Loss: 0.353 Vali Loss: 1.314 Vali Acc: 0.267 Test Loss: 1.314 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.955869436264038
Epoch: 10, Steps: 1 | Train Loss: 0.242 Vali Loss: 1.365 Vali Acc: 0.267 Test Loss: 1.365 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.9044861793518066
Epoch: 11, Steps: 1 | Train Loss: 0.208 Vali Loss: 1.420 Vali Acc: 0.400 Test Loss: 1.420 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm128_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 18993667
model size : 74.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm128_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 3.8971381187438965
Epoch: 1, Steps: 1 | Train Loss: 1.083 Vali Loss: 1.094 Vali Acc: 0.333 Test Loss: 1.094 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 1.0004839897155762
Epoch: 2, Steps: 1 | Train Loss: 1.011 Vali Loss: 1.096 Vali Acc: 0.400 Test Loss: 1.096 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 1.1069481372833252
Epoch: 3, Steps: 1 | Train Loss: 0.869 Vali Loss: 1.106 Vali Acc: 0.333 Test Loss: 1.106 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.20847749710083
Epoch: 4, Steps: 1 | Train Loss: 0.866 Vali Loss: 1.113 Vali Acc: 0.333 Test Loss: 1.113 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.0347304344177246
Epoch: 5, Steps: 1 | Train Loss: 0.775 Vali Loss: 1.119 Vali Acc: 0.333 Test Loss: 1.119 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.0334935188293457
Epoch: 6, Steps: 1 | Train Loss: 0.770 Vali Loss: 1.133 Vali Acc: 0.333 Test Loss: 1.133 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.0784213542938232
Epoch: 7, Steps: 1 | Train Loss: 0.624 Vali Loss: 1.156 Vali Acc: 0.267 Test Loss: 1.156 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.0125110149383545
Epoch: 8, Steps: 1 | Train Loss: 0.498 Vali Loss: 1.194 Vali Acc: 0.333 Test Loss: 1.194 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.177241563796997
Epoch: 9, Steps: 1 | Train Loss: 0.311 Vali Loss: 1.244 Vali Acc: 0.267 Test Loss: 1.244 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.0447676181793213
Epoch: 10, Steps: 1 | Train Loss: 0.264 Vali Loss: 1.303 Vali Acc: 0.267 Test Loss: 1.303 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.9890594482421875
Epoch: 11, Steps: 1 | Train Loss: 0.164 Vali Loss: 1.378 Vali Acc: 0.267 Test Loss: 1.378 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.078599452972412
Epoch: 12, Steps: 1 | Train Loss: 0.096 Vali Loss: 1.456 Vali Acc: 0.267 Test Loss: 1.456 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm128_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 5754371
model size : 24.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm128_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 5.179876327514648
Epoch: 1, Steps: 1 | Train Loss: 1.239 Vali Loss: 1.121 Vali Acc: 0.400 Test Loss: 1.121 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 1.5357005596160889
Epoch: 2, Steps: 1 | Train Loss: 1.194 Vali Loss: 1.116 Vali Acc: 0.333 Test Loss: 1.116 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5448682308197021
Epoch: 3, Steps: 1 | Train Loss: 1.073 Vali Loss: 1.121 Vali Acc: 0.200 Test Loss: 1.121 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.5550427436828613
Epoch: 4, Steps: 1 | Train Loss: 0.985 Vali Loss: 1.128 Vali Acc: 0.333 Test Loss: 1.128 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.4155139923095703
Epoch: 5, Steps: 1 | Train Loss: 0.870 Vali Loss: 1.136 Vali Acc: 0.333 Test Loss: 1.136 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.4462177753448486
Epoch: 6, Steps: 1 | Train Loss: 0.788 Vali Loss: 1.156 Vali Acc: 0.333 Test Loss: 1.156 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.4608337879180908
Epoch: 7, Steps: 1 | Train Loss: 0.677 Vali Loss: 1.189 Vali Acc: 0.333 Test Loss: 1.189 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.4593863487243652
Epoch: 8, Steps: 1 | Train Loss: 0.488 Vali Loss: 1.241 Vali Acc: 0.333 Test Loss: 1.241 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.484938144683838
Epoch: 9, Steps: 1 | Train Loss: 0.365 Vali Loss: 1.299 Vali Acc: 0.267 Test Loss: 1.299 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.4733200073242188
Epoch: 10, Steps: 1 | Train Loss: 0.250 Vali Loss: 1.349 Vali Acc: 0.333 Test Loss: 1.349 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.557685375213623
Epoch: 11, Steps: 1 | Train Loss: 0.211 Vali Loss: 1.403 Vali Acc: 0.333 Test Loss: 1.403 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm128_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 18993667
model size : 74.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm128_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 3.2534234523773193
Epoch: 1, Steps: 1 | Train Loss: 1.086 Vali Loss: 1.103 Vali Acc: 0.333 Test Loss: 1.103 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.8425400257110596
Epoch: 2, Steps: 1 | Train Loss: 1.012 Vali Loss: 1.104 Vali Acc: 0.400 Test Loss: 1.104 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.8452050685882568
Epoch: 3, Steps: 1 | Train Loss: 0.869 Vali Loss: 1.113 Vali Acc: 0.333 Test Loss: 1.113 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.988039493560791
Epoch: 4, Steps: 1 | Train Loss: 0.873 Vali Loss: 1.120 Vali Acc: 0.333 Test Loss: 1.120 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9695413112640381
Epoch: 5, Steps: 1 | Train Loss: 0.787 Vali Loss: 1.126 Vali Acc: 0.333 Test Loss: 1.126 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.9751880168914795
Epoch: 6, Steps: 1 | Train Loss: 0.777 Vali Loss: 1.141 Vali Acc: 0.333 Test Loss: 1.141 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.8022997379302979
Epoch: 7, Steps: 1 | Train Loss: 0.631 Vali Loss: 1.165 Vali Acc: 0.267 Test Loss: 1.165 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.9383854866027832
Epoch: 8, Steps: 1 | Train Loss: 0.506 Vali Loss: 1.206 Vali Acc: 0.333 Test Loss: 1.206 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.8597168922424316
Epoch: 9, Steps: 1 | Train Loss: 0.316 Vali Loss: 1.258 Vali Acc: 0.267 Test Loss: 1.258 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.9406330585479736
Epoch: 10, Steps: 1 | Train Loss: 0.269 Vali Loss: 1.318 Vali Acc: 0.267 Test Loss: 1.318 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.922635555267334
Epoch: 11, Steps: 1 | Train Loss: 0.167 Vali Loss: 1.395 Vali Acc: 0.267 Test Loss: 1.395 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.9502208232879639
Epoch: 12, Steps: 1 | Train Loss: 0.098 Vali Loss: 1.476 Vali Acc: 0.267 Test Loss: 1.476 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm128_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 5754371
model size : 24.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm128_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 4.154706716537476
Epoch: 1, Steps: 1 | Train Loss: 1.241 Vali Loss: 1.120 Vali Acc: 0.400 Test Loss: 1.120 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 1.3068311214447021
Epoch: 2, Steps: 1 | Train Loss: 1.189 Vali Loss: 1.116 Vali Acc: 0.333 Test Loss: 1.116 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2304577827453613
Epoch: 3, Steps: 1 | Train Loss: 1.068 Vali Loss: 1.121 Vali Acc: 0.267 Test Loss: 1.121 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.2557592391967773
Epoch: 4, Steps: 1 | Train Loss: 0.980 Vali Loss: 1.128 Vali Acc: 0.333 Test Loss: 1.128 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.2501201629638672
Epoch: 5, Steps: 1 | Train Loss: 0.872 Vali Loss: 1.136 Vali Acc: 0.333 Test Loss: 1.136 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.2615656852722168
Epoch: 6, Steps: 1 | Train Loss: 0.789 Vali Loss: 1.155 Vali Acc: 0.333 Test Loss: 1.155 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.2645845413208008
Epoch: 7, Steps: 1 | Train Loss: 0.687 Vali Loss: 1.189 Vali Acc: 0.333 Test Loss: 1.189 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.1778254508972168
Epoch: 8, Steps: 1 | Train Loss: 0.500 Vali Loss: 1.239 Vali Acc: 0.267 Test Loss: 1.239 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.2596416473388672
Epoch: 9, Steps: 1 | Train Loss: 0.377 Vali Loss: 1.296 Vali Acc: 0.333 Test Loss: 1.296 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.2899751663208008
Epoch: 10, Steps: 1 | Train Loss: 0.260 Vali Loss: 1.351 Vali Acc: 0.333 Test Loss: 1.351 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.3483076095581055
Epoch: 11, Steps: 1 | Train Loss: 0.218 Vali Loss: 1.413 Vali Acc: 0.333 Test Loss: 1.413 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm128_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 18993667
model size : 74.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm128_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.9026989936828613
Epoch: 1, Steps: 1 | Train Loss: 1.098 Vali Loss: 1.103 Vali Acc: 0.333 Test Loss: 1.103 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.7615790367126465
Epoch: 2, Steps: 1 | Train Loss: 1.021 Vali Loss: 1.105 Vali Acc: 0.333 Test Loss: 1.105 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7652182579040527
Epoch: 3, Steps: 1 | Train Loss: 0.880 Vali Loss: 1.114 Vali Acc: 0.333 Test Loss: 1.114 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.787860631942749
Epoch: 4, Steps: 1 | Train Loss: 0.878 Vali Loss: 1.121 Vali Acc: 0.333 Test Loss: 1.121 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.8065512180328369
Epoch: 5, Steps: 1 | Train Loss: 0.786 Vali Loss: 1.128 Vali Acc: 0.333 Test Loss: 1.128 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.7527995109558105
Epoch: 6, Steps: 1 | Train Loss: 0.787 Vali Loss: 1.144 Vali Acc: 0.267 Test Loss: 1.144 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.7475829124450684
Epoch: 7, Steps: 1 | Train Loss: 0.638 Vali Loss: 1.170 Vali Acc: 0.333 Test Loss: 1.170 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.7805769443511963
Epoch: 8, Steps: 1 | Train Loss: 0.516 Vali Loss: 1.213 Vali Acc: 0.333 Test Loss: 1.213 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.7448410987854004
Epoch: 9, Steps: 1 | Train Loss: 0.321 Vali Loss: 1.268 Vali Acc: 0.267 Test Loss: 1.268 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.8245210647583008
Epoch: 10, Steps: 1 | Train Loss: 0.277 Vali Loss: 1.332 Vali Acc: 0.267 Test Loss: 1.332 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.8380918502807617
Epoch: 11, Steps: 1 | Train Loss: 0.172 Vali Loss: 1.413 Vali Acc: 0.267 Test Loss: 1.413 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm128_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 5754371
model size : 24.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm64_df256_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 7.232287168502808
Epoch: 1, Steps: 1 | Train Loss: 1.119 Vali Loss: 1.175 Vali Acc: 0.267 Test Loss: 1.175 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 2.0141515731811523
Epoch: 2, Steps: 1 | Train Loss: 1.042 Vali Loss: 1.170 Vali Acc: 0.200 Test Loss: 1.170 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9497365951538086
Epoch: 3, Steps: 1 | Train Loss: 0.988 Vali Loss: 1.177 Vali Acc: 0.267 Test Loss: 1.177 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.0070204734802246
Epoch: 4, Steps: 1 | Train Loss: 0.955 Vali Loss: 1.188 Vali Acc: 0.400 Test Loss: 1.188 Test Acc: 0.400
Validation loss decreased (-0.266655 --> -0.399988).  Saving model ...
Epoch: 5 cost time: 2.0664448738098145
Epoch: 5, Steps: 1 | Train Loss: 0.905 Vali Loss: 1.199 Vali Acc: 0.400 Test Loss: 1.199 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.0905308723449707
Epoch: 6, Steps: 1 | Train Loss: 0.876 Vali Loss: 1.218 Vali Acc: 0.400 Test Loss: 1.218 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.0897469520568848
Epoch: 7, Steps: 1 | Train Loss: 0.735 Vali Loss: 1.232 Vali Acc: 0.333 Test Loss: 1.232 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.9497907161712646
Epoch: 8, Steps: 1 | Train Loss: 0.750 Vali Loss: 1.243 Vali Acc: 0.333 Test Loss: 1.243 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.2148656845092773
Epoch: 9, Steps: 1 | Train Loss: 0.606 Vali Loss: 1.252 Vali Acc: 0.333 Test Loss: 1.252 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.1073739528656006
Epoch: 10, Steps: 1 | Train Loss: 0.485 Vali Loss: 1.268 Vali Acc: 0.133 Test Loss: 1.268 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.9355785846710205
Epoch: 11, Steps: 1 | Train Loss: 0.423 Vali Loss: 1.288 Vali Acc: 0.133 Test Loss: 1.288 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.0845389366149902
Epoch: 12, Steps: 1 | Train Loss: 0.369 Vali Loss: 1.318 Vali Acc: 0.133 Test Loss: 1.318 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.9535982608795166
Epoch: 13, Steps: 1 | Train Loss: 0.261 Vali Loss: 1.355 Vali Acc: 0.133 Test Loss: 1.355 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.1488187313079834
Epoch: 14, Steps: 1 | Train Loss: 0.211 Vali Loss: 1.406 Vali Acc: 0.267 Test Loss: 1.406 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm64_df256_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 18870787
model size : 73.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm64_df256_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 3.9711966514587402
Epoch: 1, Steps: 1 | Train Loss: 1.196 Vali Loss: 1.169 Vali Acc: 0.200 Test Loss: 1.169 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 1.0679831504821777
Epoch: 2, Steps: 1 | Train Loss: 1.045 Vali Loss: 1.170 Vali Acc: 0.200 Test Loss: 1.170 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0917389392852783
Epoch: 3, Steps: 1 | Train Loss: 1.035 Vali Loss: 1.173 Vali Acc: 0.200 Test Loss: 1.173 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1081962585449219
Epoch: 4, Steps: 1 | Train Loss: 0.968 Vali Loss: 1.176 Vali Acc: 0.200 Test Loss: 1.176 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.2322540283203125
Epoch: 5, Steps: 1 | Train Loss: 0.952 Vali Loss: 1.179 Vali Acc: 0.200 Test Loss: 1.179 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.0570008754730225
Epoch: 6, Steps: 1 | Train Loss: 0.957 Vali Loss: 1.184 Vali Acc: 0.200 Test Loss: 1.184 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.0873003005981445
Epoch: 7, Steps: 1 | Train Loss: 0.817 Vali Loss: 1.191 Vali Acc: 0.267 Test Loss: 1.191 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266655).  Saving model ...
Epoch: 8 cost time: 1.0807592868804932
Epoch: 8, Steps: 1 | Train Loss: 0.725 Vali Loss: 1.200 Vali Acc: 0.200 Test Loss: 1.200 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3597609996795654
Epoch: 9, Steps: 1 | Train Loss: 0.611 Vali Loss: 1.213 Vali Acc: 0.200 Test Loss: 1.213 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.1836180686950684
Epoch: 10, Steps: 1 | Train Loss: 0.506 Vali Loss: 1.231 Vali Acc: 0.200 Test Loss: 1.231 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.1117863655090332
Epoch: 11, Steps: 1 | Train Loss: 0.443 Vali Loss: 1.245 Vali Acc: 0.200 Test Loss: 1.245 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.1772594451904297
Epoch: 12, Steps: 1 | Train Loss: 0.324 Vali Loss: 1.259 Vali Acc: 0.333 Test Loss: 1.259 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333321).  Saving model ...
Epoch: 13 cost time: 1.2017202377319336
Epoch: 13, Steps: 1 | Train Loss: 0.264 Vali Loss: 1.283 Vali Acc: 0.267 Test Loss: 1.283 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.240466833114624
Epoch: 14, Steps: 1 | Train Loss: 0.191 Vali Loss: 1.316 Vali Acc: 0.200 Test Loss: 1.316 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.183584213256836
Epoch: 15, Steps: 1 | Train Loss: 0.148 Vali Loss: 1.350 Vali Acc: 0.200 Test Loss: 1.350 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.2185232639312744
Epoch: 16, Steps: 1 | Train Loss: 0.116 Vali Loss: 1.383 Vali Acc: 0.267 Test Loss: 1.383 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.2276148796081543
Epoch: 17, Steps: 1 | Train Loss: 0.086 Vali Loss: 1.408 Vali Acc: 0.267 Test Loss: 1.408 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.3302104473114014
Epoch: 18, Steps: 1 | Train Loss: 0.060 Vali Loss: 1.437 Vali Acc: 0.267 Test Loss: 1.437 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.2407631874084473
Epoch: 19, Steps: 1 | Train Loss: 0.039 Vali Loss: 1.468 Vali Acc: 0.267 Test Loss: 1.468 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.1720430850982666
Epoch: 20, Steps: 1 | Train Loss: 0.027 Vali Loss: 1.501 Vali Acc: 0.267 Test Loss: 1.501 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.2355024814605713
Epoch: 21, Steps: 1 | Train Loss: 0.018 Vali Loss: 1.536 Vali Acc: 0.267 Test Loss: 1.536 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.2984287738800049
Epoch: 22, Steps: 1 | Train Loss: 0.013 Vali Loss: 1.573 Vali Acc: 0.267 Test Loss: 1.573 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm64_df256_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 5631235
model size : 22.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm64_df256_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 5.412025213241577
Epoch: 1, Steps: 1 | Train Loss: 1.119 Vali Loss: 1.175 Vali Acc: 0.267 Test Loss: 1.175 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 1.629023551940918
Epoch: 2, Steps: 1 | Train Loss: 1.042 Vali Loss: 1.170 Vali Acc: 0.200 Test Loss: 1.170 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4206585884094238
Epoch: 3, Steps: 1 | Train Loss: 0.987 Vali Loss: 1.177 Vali Acc: 0.267 Test Loss: 1.177 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.5770199298858643
Epoch: 4, Steps: 1 | Train Loss: 0.955 Vali Loss: 1.188 Vali Acc: 0.400 Test Loss: 1.188 Test Acc: 0.400
Validation loss decreased (-0.266655 --> -0.399988).  Saving model ...
Epoch: 5 cost time: 1.5994069576263428
Epoch: 5, Steps: 1 | Train Loss: 0.905 Vali Loss: 1.199 Vali Acc: 0.400 Test Loss: 1.199 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5441880226135254
Epoch: 6, Steps: 1 | Train Loss: 0.877 Vali Loss: 1.218 Vali Acc: 0.333 Test Loss: 1.218 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.55680251121521
Epoch: 7, Steps: 1 | Train Loss: 0.737 Vali Loss: 1.233 Vali Acc: 0.333 Test Loss: 1.233 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.5477428436279297
Epoch: 8, Steps: 1 | Train Loss: 0.757 Vali Loss: 1.244 Vali Acc: 0.333 Test Loss: 1.244 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.6101536750793457
Epoch: 9, Steps: 1 | Train Loss: 0.602 Vali Loss: 1.254 Vali Acc: 0.333 Test Loss: 1.254 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.5255396366119385
Epoch: 10, Steps: 1 | Train Loss: 0.491 Vali Loss: 1.269 Vali Acc: 0.133 Test Loss: 1.269 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.6054446697235107
Epoch: 11, Steps: 1 | Train Loss: 0.427 Vali Loss: 1.290 Vali Acc: 0.133 Test Loss: 1.290 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.5692243576049805
Epoch: 12, Steps: 1 | Train Loss: 0.375 Vali Loss: 1.319 Vali Acc: 0.133 Test Loss: 1.319 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.600161075592041
Epoch: 13, Steps: 1 | Train Loss: 0.267 Vali Loss: 1.355 Vali Acc: 0.133 Test Loss: 1.355 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.7435078620910645
Epoch: 14, Steps: 1 | Train Loss: 0.215 Vali Loss: 1.405 Vali Acc: 0.200 Test Loss: 1.405 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm64_df256_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 18870787
model size : 73.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm64_df256_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 3.491586685180664
Epoch: 1, Steps: 1 | Train Loss: 1.174 Vali Loss: 1.160 Vali Acc: 0.200 Test Loss: 1.160 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.9113719463348389
Epoch: 2, Steps: 1 | Train Loss: 1.025 Vali Loss: 1.162 Vali Acc: 0.200 Test Loss: 1.162 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0322129726409912
Epoch: 3, Steps: 1 | Train Loss: 1.024 Vali Loss: 1.165 Vali Acc: 0.267 Test Loss: 1.165 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266655).  Saving model ...
Epoch: 4 cost time: 0.9609403610229492
Epoch: 4, Steps: 1 | Train Loss: 0.949 Vali Loss: 1.168 Vali Acc: 0.267 Test Loss: 1.168 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0946414470672607
Epoch: 5, Steps: 1 | Train Loss: 0.938 Vali Loss: 1.171 Vali Acc: 0.333 Test Loss: 1.171 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.9837915897369385
Epoch: 6, Steps: 1 | Train Loss: 0.942 Vali Loss: 1.176 Vali Acc: 0.333 Test Loss: 1.176 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8949465751647949
Epoch: 7, Steps: 1 | Train Loss: 0.815 Vali Loss: 1.184 Vali Acc: 0.333 Test Loss: 1.184 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9637691974639893
Epoch: 8, Steps: 1 | Train Loss: 0.729 Vali Loss: 1.194 Vali Acc: 0.267 Test Loss: 1.194 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.9763877391815186
Epoch: 9, Steps: 1 | Train Loss: 0.619 Vali Loss: 1.208 Vali Acc: 0.267 Test Loss: 1.208 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.9873909950256348
Epoch: 10, Steps: 1 | Train Loss: 0.516 Vali Loss: 1.228 Vali Acc: 0.267 Test Loss: 1.228 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.0025527477264404
Epoch: 11, Steps: 1 | Train Loss: 0.456 Vali Loss: 1.247 Vali Acc: 0.333 Test Loss: 1.247 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.1021766662597656
Epoch: 12, Steps: 1 | Train Loss: 0.340 Vali Loss: 1.267 Vali Acc: 0.267 Test Loss: 1.267 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.0765376091003418
Epoch: 13, Steps: 1 | Train Loss: 0.278 Vali Loss: 1.299 Vali Acc: 0.200 Test Loss: 1.299 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.025221347808838
Epoch: 14, Steps: 1 | Train Loss: 0.201 Vali Loss: 1.340 Vali Acc: 0.200 Test Loss: 1.340 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.9452340602874756
Epoch: 15, Steps: 1 | Train Loss: 0.157 Vali Loss: 1.380 Vali Acc: 0.200 Test Loss: 1.380 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm64_df256_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 5631235
model size : 22.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm64_df256_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 4.5988991260528564
Epoch: 1, Steps: 1 | Train Loss: 1.115 Vali Loss: 1.194 Vali Acc: 0.200 Test Loss: 1.194 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 1.248342514038086
Epoch: 2, Steps: 1 | Train Loss: 1.038 Vali Loss: 1.189 Vali Acc: 0.133 Test Loss: 1.189 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3648347854614258
Epoch: 3, Steps: 1 | Train Loss: 0.980 Vali Loss: 1.196 Vali Acc: 0.267 Test Loss: 1.196 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266655).  Saving model ...
Epoch: 4 cost time: 1.349973440170288
Epoch: 4, Steps: 1 | Train Loss: 0.948 Vali Loss: 1.207 Vali Acc: 0.333 Test Loss: 1.207 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333321).  Saving model ...
Epoch: 5 cost time: 1.333592414855957
Epoch: 5, Steps: 1 | Train Loss: 0.899 Vali Loss: 1.217 Vali Acc: 0.267 Test Loss: 1.217 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2595341205596924
Epoch: 6, Steps: 1 | Train Loss: 0.874 Vali Loss: 1.235 Vali Acc: 0.333 Test Loss: 1.235 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.3387045860290527
Epoch: 7, Steps: 1 | Train Loss: 0.747 Vali Loss: 1.247 Vali Acc: 0.333 Test Loss: 1.247 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.329246997833252
Epoch: 8, Steps: 1 | Train Loss: 0.771 Vali Loss: 1.255 Vali Acc: 0.333 Test Loss: 1.255 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.3461365699768066
Epoch: 9, Steps: 1 | Train Loss: 0.617 Vali Loss: 1.263 Vali Acc: 0.267 Test Loss: 1.263 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.4328231811523438
Epoch: 10, Steps: 1 | Train Loss: 0.504 Vali Loss: 1.278 Vali Acc: 0.133 Test Loss: 1.278 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.510946273803711
Epoch: 11, Steps: 1 | Train Loss: 0.437 Vali Loss: 1.299 Vali Acc: 0.133 Test Loss: 1.299 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.3013865947723389
Epoch: 12, Steps: 1 | Train Loss: 0.388 Vali Loss: 1.329 Vali Acc: 0.133 Test Loss: 1.329 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.3371706008911133
Epoch: 13, Steps: 1 | Train Loss: 0.280 Vali Loss: 1.367 Vali Acc: 0.133 Test Loss: 1.367 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.3169960975646973
Epoch: 14, Steps: 1 | Train Loss: 0.225 Vali Loss: 1.417 Vali Acc: 0.200 Test Loss: 1.417 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm64_df256_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 18870787
model size : 73.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm64_df256_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.8238492012023926
Epoch: 1, Steps: 1 | Train Loss: 1.175 Vali Loss: 1.128 Vali Acc: 0.200 Test Loss: 1.128 Test Acc: 0.200
Validation loss decreased (inf --> -0.199989).  Saving model ...
Epoch: 2 cost time: 0.7305033206939697
Epoch: 2, Steps: 1 | Train Loss: 1.020 Vali Loss: 1.131 Vali Acc: 0.267 Test Loss: 1.131 Test Acc: 0.267
Validation loss decreased (-0.199989 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.7138872146606445
Epoch: 3, Steps: 1 | Train Loss: 1.022 Vali Loss: 1.135 Vali Acc: 0.333 Test Loss: 1.135 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.7593865394592285
Epoch: 4, Steps: 1 | Train Loss: 0.946 Vali Loss: 1.139 Vali Acc: 0.333 Test Loss: 1.139 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8089072704315186
Epoch: 5, Steps: 1 | Train Loss: 0.932 Vali Loss: 1.143 Vali Acc: 0.400 Test Loss: 1.143 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.8433551788330078
Epoch: 6, Steps: 1 | Train Loss: 0.945 Vali Loss: 1.151 Vali Acc: 0.400 Test Loss: 1.151 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7844796180725098
Epoch: 7, Steps: 1 | Train Loss: 0.829 Vali Loss: 1.162 Vali Acc: 0.400 Test Loss: 1.162 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.7917742729187012
Epoch: 8, Steps: 1 | Train Loss: 0.746 Vali Loss: 1.177 Vali Acc: 0.333 Test Loss: 1.177 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.8688304424285889
Epoch: 9, Steps: 1 | Train Loss: 0.636 Vali Loss: 1.196 Vali Acc: 0.200 Test Loss: 1.196 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.8223128318786621
Epoch: 10, Steps: 1 | Train Loss: 0.536 Vali Loss: 1.221 Vali Acc: 0.267 Test Loss: 1.221 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.7320570945739746
Epoch: 11, Steps: 1 | Train Loss: 0.473 Vali Loss: 1.246 Vali Acc: 0.333 Test Loss: 1.246 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.7739167213439941
Epoch: 12, Steps: 1 | Train Loss: 0.360 Vali Loss: 1.275 Vali Acc: 0.333 Test Loss: 1.275 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.7733709812164307
Epoch: 13, Steps: 1 | Train Loss: 0.291 Vali Loss: 1.316 Vali Acc: 0.200 Test Loss: 1.316 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.8356523513793945
Epoch: 14, Steps: 1 | Train Loss: 0.211 Vali Loss: 1.366 Vali Acc: 0.267 Test Loss: 1.366 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.8167135715484619
Epoch: 15, Steps: 1 | Train Loss: 0.169 Vali Loss: 1.411 Vali Acc: 0.267 Test Loss: 1.411 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm64_df256_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 5631235
model size : 22.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm64_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 4.854971170425415
Epoch: 1, Steps: 1 | Train Loss: 1.126 Vali Loss: 1.130 Vali Acc: 0.333 Test Loss: 1.130 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 1.432943344116211
Epoch: 2, Steps: 1 | Train Loss: 1.126 Vali Loss: 1.130 Vali Acc: 0.333 Test Loss: 1.130 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 1.374234914779663
Epoch: 3, Steps: 1 | Train Loss: 1.076 Vali Loss: 1.132 Vali Acc: 0.400 Test Loss: 1.132 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 1.4870185852050781
Epoch: 4, Steps: 1 | Train Loss: 0.987 Vali Loss: 1.135 Vali Acc: 0.467 Test Loss: 1.135 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 5 cost time: 1.380113124847412
Epoch: 5, Steps: 1 | Train Loss: 0.903 Vali Loss: 1.138 Vali Acc: 0.333 Test Loss: 1.138 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3060331344604492
Epoch: 6, Steps: 1 | Train Loss: 0.875 Vali Loss: 1.146 Vali Acc: 0.333 Test Loss: 1.146 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.3301937580108643
Epoch: 7, Steps: 1 | Train Loss: 0.774 Vali Loss: 1.157 Vali Acc: 0.267 Test Loss: 1.157 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.3887319564819336
Epoch: 8, Steps: 1 | Train Loss: 0.677 Vali Loss: 1.169 Vali Acc: 0.267 Test Loss: 1.169 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.3092312812805176
Epoch: 9, Steps: 1 | Train Loss: 0.652 Vali Loss: 1.187 Vali Acc: 0.333 Test Loss: 1.187 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.2858307361602783
Epoch: 10, Steps: 1 | Train Loss: 0.483 Vali Loss: 1.211 Vali Acc: 0.267 Test Loss: 1.211 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.3504447937011719
Epoch: 11, Steps: 1 | Train Loss: 0.473 Vali Loss: 1.238 Vali Acc: 0.267 Test Loss: 1.238 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.4730653762817383
Epoch: 12, Steps: 1 | Train Loss: 0.367 Vali Loss: 1.262 Vali Acc: 0.200 Test Loss: 1.262 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.371295690536499
Epoch: 13, Steps: 1 | Train Loss: 0.291 Vali Loss: 1.283 Vali Acc: 0.200 Test Loss: 1.283 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.3211603164672852
Epoch: 14, Steps: 1 | Train Loss: 0.232 Vali Loss: 1.306 Vali Acc: 0.267 Test Loss: 1.306 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm64_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 9497603
model size : 37.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm64_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 3.1261892318725586
Epoch: 1, Steps: 1 | Train Loss: 1.171 Vali Loss: 1.074 Vali Acc: 0.467 Test Loss: 1.074 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.8260118961334229
Epoch: 2, Steps: 1 | Train Loss: 1.170 Vali Loss: 1.079 Vali Acc: 0.400 Test Loss: 1.079 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7983760833740234
Epoch: 3, Steps: 1 | Train Loss: 1.066 Vali Loss: 1.088 Vali Acc: 0.400 Test Loss: 1.088 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8080480098724365
Epoch: 4, Steps: 1 | Train Loss: 0.935 Vali Loss: 1.099 Vali Acc: 0.333 Test Loss: 1.099 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.8237967491149902
Epoch: 5, Steps: 1 | Train Loss: 0.961 Vali Loss: 1.111 Vali Acc: 0.333 Test Loss: 1.111 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.8086400032043457
Epoch: 6, Steps: 1 | Train Loss: 0.955 Vali Loss: 1.127 Vali Acc: 0.333 Test Loss: 1.127 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.8249790668487549
Epoch: 7, Steps: 1 | Train Loss: 0.841 Vali Loss: 1.142 Vali Acc: 0.333 Test Loss: 1.142 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.9640712738037109
Epoch: 8, Steps: 1 | Train Loss: 0.741 Vali Loss: 1.154 Vali Acc: 0.267 Test Loss: 1.154 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.7947514057159424
Epoch: 9, Steps: 1 | Train Loss: 0.591 Vali Loss: 1.167 Vali Acc: 0.333 Test Loss: 1.167 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.822843074798584
Epoch: 10, Steps: 1 | Train Loss: 0.521 Vali Loss: 1.188 Vali Acc: 0.333 Test Loss: 1.188 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.742267370223999
Epoch: 11, Steps: 1 | Train Loss: 0.416 Vali Loss: 1.217 Vali Acc: 0.333 Test Loss: 1.217 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm64_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 2877699
model size : 12.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm64_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 3.9731855392456055
Epoch: 1, Steps: 1 | Train Loss: 1.132 Vali Loss: 1.130 Vali Acc: 0.400 Test Loss: 1.130 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 1.0920555591583252
Epoch: 2, Steps: 1 | Train Loss: 1.133 Vali Loss: 1.129 Vali Acc: 0.400 Test Loss: 1.129 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 1.2560756206512451
Epoch: 3, Steps: 1 | Train Loss: 1.086 Vali Loss: 1.130 Vali Acc: 0.467 Test Loss: 1.130 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 4 cost time: 1.180058240890503
Epoch: 4, Steps: 1 | Train Loss: 0.997 Vali Loss: 1.132 Vali Acc: 0.467 Test Loss: 1.132 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1545000076293945
Epoch: 5, Steps: 1 | Train Loss: 0.915 Vali Loss: 1.134 Vali Acc: 0.333 Test Loss: 1.134 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.104386806488037
Epoch: 6, Steps: 1 | Train Loss: 0.887 Vali Loss: 1.140 Vali Acc: 0.333 Test Loss: 1.140 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.1564397811889648
Epoch: 7, Steps: 1 | Train Loss: 0.791 Vali Loss: 1.149 Vali Acc: 0.267 Test Loss: 1.149 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.1145062446594238
Epoch: 8, Steps: 1 | Train Loss: 0.699 Vali Loss: 1.160 Vali Acc: 0.267 Test Loss: 1.160 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.102116584777832
Epoch: 9, Steps: 1 | Train Loss: 0.672 Vali Loss: 1.176 Vali Acc: 0.267 Test Loss: 1.176 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.2545928955078125
Epoch: 10, Steps: 1 | Train Loss: 0.508 Vali Loss: 1.198 Vali Acc: 0.267 Test Loss: 1.198 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.12264084815979
Epoch: 11, Steps: 1 | Train Loss: 0.489 Vali Loss: 1.224 Vali Acc: 0.200 Test Loss: 1.224 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.0723025798797607
Epoch: 12, Steps: 1 | Train Loss: 0.381 Vali Loss: 1.248 Vali Acc: 0.200 Test Loss: 1.248 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.1293590068817139
Epoch: 13, Steps: 1 | Train Loss: 0.305 Vali Loss: 1.268 Vali Acc: 0.267 Test Loss: 1.268 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm64_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 9497603
model size : 37.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm64_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.9012060165405273
Epoch: 1, Steps: 1 | Train Loss: 1.163 Vali Loss: 1.075 Vali Acc: 0.467 Test Loss: 1.075 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.714714527130127
Epoch: 2, Steps: 1 | Train Loss: 1.160 Vali Loss: 1.081 Vali Acc: 0.400 Test Loss: 1.081 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7338268756866455
Epoch: 3, Steps: 1 | Train Loss: 1.060 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7447178363800049
Epoch: 4, Steps: 1 | Train Loss: 0.919 Vali Loss: 1.103 Vali Acc: 0.333 Test Loss: 1.103 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7306196689605713
Epoch: 5, Steps: 1 | Train Loss: 0.947 Vali Loss: 1.115 Vali Acc: 0.333 Test Loss: 1.115 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.7173328399658203
Epoch: 6, Steps: 1 | Train Loss: 0.952 Vali Loss: 1.132 Vali Acc: 0.333 Test Loss: 1.132 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.7534604072570801
Epoch: 7, Steps: 1 | Train Loss: 0.840 Vali Loss: 1.148 Vali Acc: 0.333 Test Loss: 1.148 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.729882001876831
Epoch: 8, Steps: 1 | Train Loss: 0.747 Vali Loss: 1.162 Vali Acc: 0.267 Test Loss: 1.162 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.8246018886566162
Epoch: 9, Steps: 1 | Train Loss: 0.601 Vali Loss: 1.176 Vali Acc: 0.333 Test Loss: 1.176 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.7763049602508545
Epoch: 10, Steps: 1 | Train Loss: 0.535 Vali Loss: 1.200 Vali Acc: 0.333 Test Loss: 1.200 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.7711892127990723
Epoch: 11, Steps: 1 | Train Loss: 0.435 Vali Loss: 1.234 Vali Acc: 0.333 Test Loss: 1.234 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm64_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 2877699
model size : 12.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm64_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 3.4749643802642822
Epoch: 1, Steps: 1 | Train Loss: 1.133 Vali Loss: 1.108 Vali Acc: 0.400 Test Loss: 1.108 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.9475831985473633
Epoch: 2, Steps: 1 | Train Loss: 1.131 Vali Loss: 1.108 Vali Acc: 0.400 Test Loss: 1.108 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.9189395904541016
Epoch: 3, Steps: 1 | Train Loss: 1.087 Vali Loss: 1.109 Vali Acc: 0.467 Test Loss: 1.109 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 1.0257718563079834
Epoch: 4, Steps: 1 | Train Loss: 0.999 Vali Loss: 1.111 Vali Acc: 0.467 Test Loss: 1.111 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8814659118652344
Epoch: 5, Steps: 1 | Train Loss: 0.919 Vali Loss: 1.114 Vali Acc: 0.400 Test Loss: 1.114 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1146492958068848
Epoch: 6, Steps: 1 | Train Loss: 0.888 Vali Loss: 1.120 Vali Acc: 0.333 Test Loss: 1.120 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.0425093173980713
Epoch: 7, Steps: 1 | Train Loss: 0.801 Vali Loss: 1.130 Vali Acc: 0.267 Test Loss: 1.130 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.9282634258270264
Epoch: 8, Steps: 1 | Train Loss: 0.714 Vali Loss: 1.140 Vali Acc: 0.267 Test Loss: 1.140 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.8235006332397461
Epoch: 9, Steps: 1 | Train Loss: 0.688 Vali Loss: 1.156 Vali Acc: 0.267 Test Loss: 1.156 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.8824167251586914
Epoch: 10, Steps: 1 | Train Loss: 0.523 Vali Loss: 1.178 Vali Acc: 0.200 Test Loss: 1.178 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.0091559886932373
Epoch: 11, Steps: 1 | Train Loss: 0.500 Vali Loss: 1.205 Vali Acc: 0.200 Test Loss: 1.205 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.9970102310180664
Epoch: 12, Steps: 1 | Train Loss: 0.393 Vali Loss: 1.230 Vali Acc: 0.200 Test Loss: 1.230 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.970261812210083
Epoch: 13, Steps: 1 | Train Loss: 0.317 Vali Loss: 1.252 Vali Acc: 0.200 Test Loss: 1.252 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm64_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 9497603
model size : 37.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm64_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.84147047996521
Epoch: 1, Steps: 1 | Train Loss: 1.165 Vali Loss: 1.067 Vali Acc: 0.467 Test Loss: 1.067 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.6007850170135498
Epoch: 2, Steps: 1 | Train Loss: 1.168 Vali Loss: 1.075 Vali Acc: 0.400 Test Loss: 1.075 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5711061954498291
Epoch: 3, Steps: 1 | Train Loss: 1.061 Vali Loss: 1.086 Vali Acc: 0.400 Test Loss: 1.086 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5838353633880615
Epoch: 4, Steps: 1 | Train Loss: 0.921 Vali Loss: 1.099 Vali Acc: 0.333 Test Loss: 1.099 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.6432263851165771
Epoch: 5, Steps: 1 | Train Loss: 0.949 Vali Loss: 1.111 Vali Acc: 0.333 Test Loss: 1.111 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.6312747001647949
Epoch: 6, Steps: 1 | Train Loss: 0.952 Vali Loss: 1.128 Vali Acc: 0.400 Test Loss: 1.128 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.591179609298706
Epoch: 7, Steps: 1 | Train Loss: 0.848 Vali Loss: 1.145 Vali Acc: 0.333 Test Loss: 1.145 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.625593900680542
Epoch: 8, Steps: 1 | Train Loss: 0.755 Vali Loss: 1.159 Vali Acc: 0.333 Test Loss: 1.159 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.6550908088684082
Epoch: 9, Steps: 1 | Train Loss: 0.607 Vali Loss: 1.174 Vali Acc: 0.400 Test Loss: 1.174 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.6706571578979492
Epoch: 10, Steps: 1 | Train Loss: 0.545 Vali Loss: 1.199 Vali Acc: 0.400 Test Loss: 1.199 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.6313135623931885
Epoch: 11, Steps: 1 | Train Loss: 0.447 Vali Loss: 1.235 Vali Acc: 0.400 Test Loss: 1.235 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm64_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 2877699
model size : 12.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm64_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 3.719296932220459
Epoch: 1, Steps: 1 | Train Loss: 1.183 Vali Loss: 1.102 Vali Acc: 0.400 Test Loss: 1.102 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 1.0074996948242188
Epoch: 2, Steps: 1 | Train Loss: 1.057 Vali Loss: 1.103 Vali Acc: 0.333 Test Loss: 1.103 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9784882068634033
Epoch: 3, Steps: 1 | Train Loss: 1.069 Vali Loss: 1.104 Vali Acc: 0.333 Test Loss: 1.104 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0890305042266846
Epoch: 4, Steps: 1 | Train Loss: 0.997 Vali Loss: 1.106 Vali Acc: 0.333 Test Loss: 1.106 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.0499827861785889
Epoch: 5, Steps: 1 | Train Loss: 1.017 Vali Loss: 1.108 Vali Acc: 0.333 Test Loss: 1.108 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.1398303508758545
Epoch: 6, Steps: 1 | Train Loss: 0.866 Vali Loss: 1.113 Vali Acc: 0.333 Test Loss: 1.113 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.1136996746063232
Epoch: 7, Steps: 1 | Train Loss: 0.804 Vali Loss: 1.118 Vali Acc: 0.333 Test Loss: 1.118 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.9250566959381104
Epoch: 8, Steps: 1 | Train Loss: 0.731 Vali Loss: 1.123 Vali Acc: 0.333 Test Loss: 1.123 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.8755302429199219
Epoch: 9, Steps: 1 | Train Loss: 0.619 Vali Loss: 1.130 Vali Acc: 0.333 Test Loss: 1.130 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.964768648147583
Epoch: 10, Steps: 1 | Train Loss: 0.549 Vali Loss: 1.143 Vali Acc: 0.333 Test Loss: 1.143 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.9141581058502197
Epoch: 11, Steps: 1 | Train Loss: 0.441 Vali Loss: 1.167 Vali Acc: 0.333 Test Loss: 1.167 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm64_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 4811011
model size : 19.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm64_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.752235174179077
Epoch: 1, Steps: 1 | Train Loss: 1.314 Vali Loss: 1.187 Vali Acc: 0.133 Test Loss: 1.187 Test Acc: 0.133
Validation loss decreased (inf --> -0.133321).  Saving model ...
Epoch: 2 cost time: 0.6470146179199219
Epoch: 2, Steps: 1 | Train Loss: 1.131 Vali Loss: 1.187 Vali Acc: 0.133 Test Loss: 1.187 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6011667251586914
Epoch: 3, Steps: 1 | Train Loss: 1.135 Vali Loss: 1.192 Vali Acc: 0.200 Test Loss: 1.192 Test Acc: 0.200
Validation loss decreased (-0.133321 --> -0.199988).  Saving model ...
Epoch: 4 cost time: 0.6243109703063965
Epoch: 4, Steps: 1 | Train Loss: 1.005 Vali Loss: 1.198 Vali Acc: 0.200 Test Loss: 1.198 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.63869309425354
Epoch: 5, Steps: 1 | Train Loss: 1.017 Vali Loss: 1.205 Vali Acc: 0.333 Test Loss: 1.205 Test Acc: 0.333
Validation loss decreased (-0.199988 --> -0.333321).  Saving model ...
Epoch: 6 cost time: 0.6562938690185547
Epoch: 6, Steps: 1 | Train Loss: 0.942 Vali Loss: 1.216 Vali Acc: 0.333 Test Loss: 1.216 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7642059326171875
Epoch: 7, Steps: 1 | Train Loss: 0.801 Vali Loss: 1.231 Vali Acc: 0.333 Test Loss: 1.231 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.7115457057952881
Epoch: 8, Steps: 1 | Train Loss: 0.677 Vali Loss: 1.247 Vali Acc: 0.267 Test Loss: 1.247 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.6714503765106201
Epoch: 9, Steps: 1 | Train Loss: 0.624 Vali Loss: 1.265 Vali Acc: 0.267 Test Loss: 1.265 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.6276364326477051
Epoch: 10, Steps: 1 | Train Loss: 0.502 Vali Loss: 1.289 Vali Acc: 0.333 Test Loss: 1.289 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.6666040420532227
Epoch: 11, Steps: 1 | Train Loss: 0.413 Vali Loss: 1.321 Vali Acc: 0.333 Test Loss: 1.321 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.6610636711120605
Epoch: 12, Steps: 1 | Train Loss: 0.375 Vali Loss: 1.359 Vali Acc: 0.267 Test Loss: 1.359 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.7462542057037354
Epoch: 13, Steps: 1 | Train Loss: 0.293 Vali Loss: 1.399 Vali Acc: 0.267 Test Loss: 1.399 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.6443886756896973
Epoch: 14, Steps: 1 | Train Loss: 0.212 Vali Loss: 1.441 Vali Acc: 0.267 Test Loss: 1.441 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.704169750213623
Epoch: 15, Steps: 1 | Train Loss: 0.180 Vali Loss: 1.484 Vali Acc: 0.333 Test Loss: 1.484 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm64_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 1500931
model size : 6.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm64_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 3.37324595451355
Epoch: 1, Steps: 1 | Train Loss: 1.183 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.7931985855102539
Epoch: 2, Steps: 1 | Train Loss: 1.058 Vali Loss: 1.091 Vali Acc: 0.333 Test Loss: 1.091 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8326387405395508
Epoch: 3, Steps: 1 | Train Loss: 1.070 Vali Loss: 1.092 Vali Acc: 0.333 Test Loss: 1.092 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8561737537384033
Epoch: 4, Steps: 1 | Train Loss: 0.999 Vali Loss: 1.093 Vali Acc: 0.333 Test Loss: 1.093 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.863670825958252
Epoch: 5, Steps: 1 | Train Loss: 1.018 Vali Loss: 1.096 Vali Acc: 0.333 Test Loss: 1.096 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.9825930595397949
Epoch: 6, Steps: 1 | Train Loss: 0.867 Vali Loss: 1.099 Vali Acc: 0.333 Test Loss: 1.099 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.893714189529419
Epoch: 7, Steps: 1 | Train Loss: 0.806 Vali Loss: 1.104 Vali Acc: 0.333 Test Loss: 1.104 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.8620882034301758
Epoch: 8, Steps: 1 | Train Loss: 0.732 Vali Loss: 1.109 Vali Acc: 0.333 Test Loss: 1.109 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.8113918304443359
Epoch: 9, Steps: 1 | Train Loss: 0.620 Vali Loss: 1.116 Vali Acc: 0.333 Test Loss: 1.116 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.9039766788482666
Epoch: 10, Steps: 1 | Train Loss: 0.550 Vali Loss: 1.128 Vali Acc: 0.333 Test Loss: 1.128 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.8939061164855957
Epoch: 11, Steps: 1 | Train Loss: 0.443 Vali Loss: 1.151 Vali Acc: 0.333 Test Loss: 1.151 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm64_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 4811011
model size : 19.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm64_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.7123823165893555
Epoch: 1, Steps: 1 | Train Loss: 1.313 Vali Loss: 1.187 Vali Acc: 0.133 Test Loss: 1.187 Test Acc: 0.133
Validation loss decreased (inf --> -0.133321).  Saving model ...
Epoch: 2 cost time: 0.5974581241607666
Epoch: 2, Steps: 1 | Train Loss: 1.121 Vali Loss: 1.187 Vali Acc: 0.133 Test Loss: 1.187 Test Acc: 0.133
Validation loss decreased (-0.133321 --> -0.133321).  Saving model ...
Epoch: 3 cost time: 0.6188483238220215
Epoch: 3, Steps: 1 | Train Loss: 1.130 Vali Loss: 1.191 Vali Acc: 0.200 Test Loss: 1.191 Test Acc: 0.200
Validation loss decreased (-0.133321 --> -0.199988).  Saving model ...
Epoch: 4 cost time: 0.5705361366271973
Epoch: 4, Steps: 1 | Train Loss: 1.008 Vali Loss: 1.197 Vali Acc: 0.267 Test Loss: 1.197 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266655).  Saving model ...
Epoch: 5 cost time: 0.557910680770874
Epoch: 5, Steps: 1 | Train Loss: 1.018 Vali Loss: 1.204 Vali Acc: 0.267 Test Loss: 1.204 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.6174130439758301
Epoch: 6, Steps: 1 | Train Loss: 0.937 Vali Loss: 1.215 Vali Acc: 0.333 Test Loss: 1.215 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333321).  Saving model ...
Epoch: 7 cost time: 0.5423612594604492
Epoch: 7, Steps: 1 | Train Loss: 0.807 Vali Loss: 1.228 Vali Acc: 0.333 Test Loss: 1.228 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6512107849121094
Epoch: 8, Steps: 1 | Train Loss: 0.687 Vali Loss: 1.242 Vali Acc: 0.267 Test Loss: 1.242 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.643195629119873
Epoch: 9, Steps: 1 | Train Loss: 0.622 Vali Loss: 1.260 Vali Acc: 0.267 Test Loss: 1.260 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.6795415878295898
Epoch: 10, Steps: 1 | Train Loss: 0.507 Vali Loss: 1.281 Vali Acc: 0.400 Test Loss: 1.281 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399987).  Saving model ...
Epoch: 11 cost time: 0.6400573253631592
Epoch: 11, Steps: 1 | Train Loss: 0.419 Vali Loss: 1.311 Vali Acc: 0.333 Test Loss: 1.311 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7177996635437012
Epoch: 12, Steps: 1 | Train Loss: 0.384 Vali Loss: 1.347 Vali Acc: 0.267 Test Loss: 1.347 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.6391949653625488
Epoch: 13, Steps: 1 | Train Loss: 0.301 Vali Loss: 1.384 Vali Acc: 0.267 Test Loss: 1.384 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.6113419532775879
Epoch: 14, Steps: 1 | Train Loss: 0.218 Vali Loss: 1.424 Vali Acc: 0.267 Test Loss: 1.424 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.604844331741333
Epoch: 15, Steps: 1 | Train Loss: 0.183 Vali Loss: 1.464 Vali Acc: 0.267 Test Loss: 1.464 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.5856027603149414
Epoch: 16, Steps: 1 | Train Loss: 0.135 Vali Loss: 1.513 Vali Acc: 0.333 Test Loss: 1.513 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.629422664642334
Epoch: 17, Steps: 1 | Train Loss: 0.096 Vali Loss: 1.562 Vali Acc: 0.333 Test Loss: 1.562 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.6286122798919678
Epoch: 18, Steps: 1 | Train Loss: 0.063 Vali Loss: 1.612 Vali Acc: 0.333 Test Loss: 1.612 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.644179105758667
Epoch: 19, Steps: 1 | Train Loss: 0.048 Vali Loss: 1.661 Vali Acc: 0.333 Test Loss: 1.661 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.6390652656555176
Epoch: 20, Steps: 1 | Train Loss: 0.029 Vali Loss: 1.707 Vali Acc: 0.333 Test Loss: 1.707 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm64_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 1500931
model size : 6.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm64_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 3.0922486782073975
Epoch: 1, Steps: 1 | Train Loss: 1.174 Vali Loss: 1.094 Vali Acc: 0.400 Test Loss: 1.094 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.6778278350830078
Epoch: 2, Steps: 1 | Train Loss: 1.056 Vali Loss: 1.095 Vali Acc: 0.333 Test Loss: 1.095 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7016506195068359
Epoch: 3, Steps: 1 | Train Loss: 1.063 Vali Loss: 1.097 Vali Acc: 0.333 Test Loss: 1.097 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7009084224700928
Epoch: 4, Steps: 1 | Train Loss: 0.990 Vali Loss: 1.099 Vali Acc: 0.333 Test Loss: 1.099 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.6643626689910889
Epoch: 5, Steps: 1 | Train Loss: 1.021 Vali Loss: 1.101 Vali Acc: 0.333 Test Loss: 1.101 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.7304801940917969
Epoch: 6, Steps: 1 | Train Loss: 0.870 Vali Loss: 1.105 Vali Acc: 0.333 Test Loss: 1.105 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.8361380100250244
Epoch: 7, Steps: 1 | Train Loss: 0.806 Vali Loss: 1.109 Vali Acc: 0.333 Test Loss: 1.109 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.7644870281219482
Epoch: 8, Steps: 1 | Train Loss: 0.745 Vali Loss: 1.114 Vali Acc: 0.400 Test Loss: 1.114 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.8038647174835205
Epoch: 9, Steps: 1 | Train Loss: 0.631 Vali Loss: 1.121 Vali Acc: 0.400 Test Loss: 1.121 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.7404522895812988
Epoch: 10, Steps: 1 | Train Loss: 0.562 Vali Loss: 1.133 Vali Acc: 0.400 Test Loss: 1.133 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.6723980903625488
Epoch: 11, Steps: 1 | Train Loss: 0.458 Vali Loss: 1.156 Vali Acc: 0.333 Test Loss: 1.156 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm64_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 4811011
model size : 19.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm64_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.452968120574951
Epoch: 1, Steps: 1 | Train Loss: 1.301 Vali Loss: 1.190 Vali Acc: 0.133 Test Loss: 1.190 Test Acc: 0.133
Validation loss decreased (inf --> -0.133321).  Saving model ...
Epoch: 2 cost time: 0.5848793983459473
Epoch: 2, Steps: 1 | Train Loss: 1.116 Vali Loss: 1.192 Vali Acc: 0.200 Test Loss: 1.192 Test Acc: 0.200
Validation loss decreased (-0.133321 --> -0.199988).  Saving model ...
Epoch: 3 cost time: 0.5616252422332764
Epoch: 3, Steps: 1 | Train Loss: 1.124 Vali Loss: 1.198 Vali Acc: 0.267 Test Loss: 1.198 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266655).  Saving model ...
Epoch: 4 cost time: 0.5544307231903076
Epoch: 4, Steps: 1 | Train Loss: 1.004 Vali Loss: 1.206 Vali Acc: 0.333 Test Loss: 1.206 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333321).  Saving model ...
Epoch: 5 cost time: 0.6246950626373291
Epoch: 5, Steps: 1 | Train Loss: 1.007 Vali Loss: 1.213 Vali Acc: 0.333 Test Loss: 1.213 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.739351749420166
Epoch: 6, Steps: 1 | Train Loss: 0.931 Vali Loss: 1.227 Vali Acc: 0.333 Test Loss: 1.227 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.6334431171417236
Epoch: 7, Steps: 1 | Train Loss: 0.801 Vali Loss: 1.243 Vali Acc: 0.333 Test Loss: 1.243 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.5852406024932861
Epoch: 8, Steps: 1 | Train Loss: 0.689 Vali Loss: 1.260 Vali Acc: 0.267 Test Loss: 1.260 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.6412093639373779
Epoch: 9, Steps: 1 | Train Loss: 0.630 Vali Loss: 1.279 Vali Acc: 0.267 Test Loss: 1.279 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.6133675575256348
Epoch: 10, Steps: 1 | Train Loss: 0.509 Vali Loss: 1.304 Vali Acc: 0.400 Test Loss: 1.304 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399987).  Saving model ...
Epoch: 11 cost time: 0.5250601768493652
Epoch: 11, Steps: 1 | Train Loss: 0.423 Vali Loss: 1.336 Vali Acc: 0.400 Test Loss: 1.336 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5633556842803955
Epoch: 12, Steps: 1 | Train Loss: 0.387 Vali Loss: 1.375 Vali Acc: 0.333 Test Loss: 1.375 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.5837020874023438
Epoch: 13, Steps: 1 | Train Loss: 0.308 Vali Loss: 1.417 Vali Acc: 0.333 Test Loss: 1.417 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.5718181133270264
Epoch: 14, Steps: 1 | Train Loss: 0.221 Vali Loss: 1.461 Vali Acc: 0.333 Test Loss: 1.461 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.5575873851776123
Epoch: 15, Steps: 1 | Train Loss: 0.188 Vali Loss: 1.507 Vali Acc: 0.333 Test Loss: 1.507 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.5801060199737549
Epoch: 16, Steps: 1 | Train Loss: 0.139 Vali Loss: 1.562 Vali Acc: 0.333 Test Loss: 1.562 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.5822882652282715
Epoch: 17, Steps: 1 | Train Loss: 0.100 Vali Loss: 1.615 Vali Acc: 0.333 Test Loss: 1.615 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.5781102180480957
Epoch: 18, Steps: 1 | Train Loss: 0.065 Vali Loss: 1.666 Vali Acc: 0.333 Test Loss: 1.666 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.5643205642700195
Epoch: 19, Steps: 1 | Train Loss: 0.050 Vali Loss: 1.717 Vali Acc: 0.333 Test Loss: 1.717 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.5463576316833496
Epoch: 20, Steps: 1 | Train Loss: 0.030 Vali Loss: 1.765 Vali Acc: 0.333 Test Loss: 1.765 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm64_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 1500931
model size : 6.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm32_df128_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 3.8954968452453613
Epoch: 1, Steps: 1 | Train Loss: 1.128 Vali Loss: 1.092 Vali Acc: 0.400 Test Loss: 1.092 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 1.0592701435089111
Epoch: 2, Steps: 1 | Train Loss: 1.065 Vali Loss: 1.091 Vali Acc: 0.333 Test Loss: 1.091 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1361603736877441
Epoch: 3, Steps: 1 | Train Loss: 1.066 Vali Loss: 1.090 Vali Acc: 0.333 Test Loss: 1.090 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0887248516082764
Epoch: 4, Steps: 1 | Train Loss: 0.981 Vali Loss: 1.090 Vali Acc: 0.400 Test Loss: 1.090 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.9734461307525635
Epoch: 5, Steps: 1 | Train Loss: 0.959 Vali Loss: 1.090 Vali Acc: 0.400 Test Loss: 1.090 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.034233570098877
Epoch: 6, Steps: 1 | Train Loss: 0.905 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.0001907348632812
Epoch: 7, Steps: 1 | Train Loss: 0.957 Vali Loss: 1.094 Vali Acc: 0.400 Test Loss: 1.094 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.9915993213653564
Epoch: 8, Steps: 1 | Train Loss: 0.875 Vali Loss: 1.098 Vali Acc: 0.333 Test Loss: 1.098 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.0047786235809326
Epoch: 9, Steps: 1 | Train Loss: 0.747 Vali Loss: 1.104 Vali Acc: 0.400 Test Loss: 1.104 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.132018804550171
Epoch: 10, Steps: 1 | Train Loss: 0.719 Vali Loss: 1.114 Vali Acc: 0.400 Test Loss: 1.114 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.069059133529663
Epoch: 11, Steps: 1 | Train Loss: 0.628 Vali Loss: 1.126 Vali Acc: 0.333 Test Loss: 1.126 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.9951977729797363
Epoch: 12, Steps: 1 | Train Loss: 0.615 Vali Loss: 1.141 Vali Acc: 0.333 Test Loss: 1.141 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.9838342666625977
Epoch: 13, Steps: 1 | Train Loss: 0.550 Vali Loss: 1.158 Vali Acc: 0.333 Test Loss: 1.158 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.010742425918579
Epoch: 14, Steps: 1 | Train Loss: 0.496 Vali Loss: 1.177 Vali Acc: 0.333 Test Loss: 1.177 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm32_df128_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 4749571
model size : 18.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm32_df128_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.703840494155884
Epoch: 1, Steps: 1 | Train Loss: 1.097 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.7061841487884521
Epoch: 2, Steps: 1 | Train Loss: 1.047 Vali Loss: 1.082 Vali Acc: 0.467 Test Loss: 1.082 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.6403942108154297
Epoch: 3, Steps: 1 | Train Loss: 0.968 Vali Loss: 1.077 Vali Acc: 0.600 Test Loss: 1.077 Test Acc: 0.600
Validation loss decreased (-0.466656 --> -0.599989).  Saving model ...
Epoch: 4 cost time: 0.7342166900634766
Epoch: 4, Steps: 1 | Train Loss: 0.950 Vali Loss: 1.074 Vali Acc: 0.533 Test Loss: 1.074 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7205109596252441
Epoch: 5, Steps: 1 | Train Loss: 0.892 Vali Loss: 1.075 Vali Acc: 0.533 Test Loss: 1.075 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.7612030506134033
Epoch: 6, Steps: 1 | Train Loss: 0.881 Vali Loss: 1.077 Vali Acc: 0.467 Test Loss: 1.077 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.6811273097991943
Epoch: 7, Steps: 1 | Train Loss: 0.873 Vali Loss: 1.080 Vali Acc: 0.467 Test Loss: 1.080 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.7708148956298828
Epoch: 8, Steps: 1 | Train Loss: 0.813 Vali Loss: 1.085 Vali Acc: 0.467 Test Loss: 1.085 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.7012014389038086
Epoch: 9, Steps: 1 | Train Loss: 0.699 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.7233269214630127
Epoch: 10, Steps: 1 | Train Loss: 0.661 Vali Loss: 1.102 Vali Acc: 0.400 Test Loss: 1.102 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.7707157135009766
Epoch: 11, Steps: 1 | Train Loss: 0.636 Vali Loss: 1.116 Vali Acc: 0.400 Test Loss: 1.116 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.7726504802703857
Epoch: 12, Steps: 1 | Train Loss: 0.606 Vali Loss: 1.136 Vali Acc: 0.400 Test Loss: 1.136 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.8431384563446045
Epoch: 13, Steps: 1 | Train Loss: 0.497 Vali Loss: 1.158 Vali Acc: 0.400 Test Loss: 1.158 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm32_df128_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 1439363
model size : 6.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm32_df128_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 3.137131452560425
Epoch: 1, Steps: 1 | Train Loss: 1.122 Vali Loss: 1.092 Vali Acc: 0.400 Test Loss: 1.092 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.8894305229187012
Epoch: 2, Steps: 1 | Train Loss: 1.062 Vali Loss: 1.090 Vali Acc: 0.400 Test Loss: 1.090 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.913860559463501
Epoch: 3, Steps: 1 | Train Loss: 1.066 Vali Loss: 1.090 Vali Acc: 0.400 Test Loss: 1.090 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 1.0016944408416748
Epoch: 4, Steps: 1 | Train Loss: 0.984 Vali Loss: 1.090 Vali Acc: 0.400 Test Loss: 1.090 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.9599180221557617
Epoch: 5, Steps: 1 | Train Loss: 0.964 Vali Loss: 1.090 Vali Acc: 0.400 Test Loss: 1.090 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9071879386901855
Epoch: 6, Steps: 1 | Train Loss: 0.902 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.0150108337402344
Epoch: 7, Steps: 1 | Train Loss: 0.956 Vali Loss: 1.093 Vali Acc: 0.333 Test Loss: 1.093 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.9472305774688721
Epoch: 8, Steps: 1 | Train Loss: 0.880 Vali Loss: 1.097 Vali Acc: 0.333 Test Loss: 1.097 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.9134523868560791
Epoch: 9, Steps: 1 | Train Loss: 0.758 Vali Loss: 1.104 Vali Acc: 0.400 Test Loss: 1.104 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.8581926822662354
Epoch: 10, Steps: 1 | Train Loss: 0.733 Vali Loss: 1.113 Vali Acc: 0.400 Test Loss: 1.113 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.8864343166351318
Epoch: 11, Steps: 1 | Train Loss: 0.638 Vali Loss: 1.125 Vali Acc: 0.400 Test Loss: 1.125 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.0745480060577393
Epoch: 12, Steps: 1 | Train Loss: 0.624 Vali Loss: 1.139 Vali Acc: 0.400 Test Loss: 1.139 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.0080785751342773
Epoch: 13, Steps: 1 | Train Loss: 0.564 Vali Loss: 1.156 Vali Acc: 0.333 Test Loss: 1.156 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.0006978511810303
Epoch: 14, Steps: 1 | Train Loss: 0.496 Vali Loss: 1.174 Vali Acc: 0.333 Test Loss: 1.174 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm32_df128_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 4749571
model size : 18.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm32_df128_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.8248586654663086
Epoch: 1, Steps: 1 | Train Loss: 1.097 Vali Loss: 1.091 Vali Acc: 0.467 Test Loss: 1.091 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.6276865005493164
Epoch: 2, Steps: 1 | Train Loss: 1.047 Vali Loss: 1.080 Vali Acc: 0.467 Test Loss: 1.080 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.6815862655639648
Epoch: 3, Steps: 1 | Train Loss: 0.969 Vali Loss: 1.074 Vali Acc: 0.600 Test Loss: 1.074 Test Acc: 0.600
Validation loss decreased (-0.466656 --> -0.599989).  Saving model ...
Epoch: 4 cost time: 0.7120561599731445
Epoch: 4, Steps: 1 | Train Loss: 0.950 Vali Loss: 1.072 Vali Acc: 0.533 Test Loss: 1.072 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8166069984436035
Epoch: 5, Steps: 1 | Train Loss: 0.892 Vali Loss: 1.072 Vali Acc: 0.533 Test Loss: 1.072 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.7664320468902588
Epoch: 6, Steps: 1 | Train Loss: 0.881 Vali Loss: 1.074 Vali Acc: 0.467 Test Loss: 1.074 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.8537614345550537
Epoch: 7, Steps: 1 | Train Loss: 0.872 Vali Loss: 1.078 Vali Acc: 0.467 Test Loss: 1.078 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.758500337600708
Epoch: 8, Steps: 1 | Train Loss: 0.813 Vali Loss: 1.083 Vali Acc: 0.467 Test Loss: 1.083 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.7688620090484619
Epoch: 9, Steps: 1 | Train Loss: 0.699 Vali Loss: 1.090 Vali Acc: 0.400 Test Loss: 1.090 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.6590664386749268
Epoch: 10, Steps: 1 | Train Loss: 0.661 Vali Loss: 1.100 Vali Acc: 0.400 Test Loss: 1.100 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.7314212322235107
Epoch: 11, Steps: 1 | Train Loss: 0.636 Vali Loss: 1.114 Vali Acc: 0.400 Test Loss: 1.114 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.8343098163604736
Epoch: 12, Steps: 1 | Train Loss: 0.606 Vali Loss: 1.134 Vali Acc: 0.400 Test Loss: 1.134 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.8114659786224365
Epoch: 13, Steps: 1 | Train Loss: 0.495 Vali Loss: 1.157 Vali Acc: 0.400 Test Loss: 1.157 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm32_df128_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 1439363
model size : 6.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm32_df128_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.7217330932617188
Epoch: 1, Steps: 1 | Train Loss: 1.124 Vali Loss: 1.100 Vali Acc: 0.400 Test Loss: 1.100 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.767791748046875
Epoch: 2, Steps: 1 | Train Loss: 1.069 Vali Loss: 1.098 Vali Acc: 0.333 Test Loss: 1.098 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8356719017028809
Epoch: 3, Steps: 1 | Train Loss: 1.066 Vali Loss: 1.098 Vali Acc: 0.400 Test Loss: 1.098 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.8505582809448242
Epoch: 4, Steps: 1 | Train Loss: 0.994 Vali Loss: 1.097 Vali Acc: 0.467 Test Loss: 1.097 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 0.8452160358428955
Epoch: 5, Steps: 1 | Train Loss: 0.964 Vali Loss: 1.098 Vali Acc: 0.400 Test Loss: 1.098 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8568005561828613
Epoch: 6, Steps: 1 | Train Loss: 0.903 Vali Loss: 1.099 Vali Acc: 0.400 Test Loss: 1.099 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.8031907081604004
Epoch: 7, Steps: 1 | Train Loss: 0.962 Vali Loss: 1.101 Vali Acc: 0.400 Test Loss: 1.101 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.8812313079833984
Epoch: 8, Steps: 1 | Train Loss: 0.883 Vali Loss: 1.105 Vali Acc: 0.400 Test Loss: 1.105 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.833202600479126
Epoch: 9, Steps: 1 | Train Loss: 0.768 Vali Loss: 1.112 Vali Acc: 0.400 Test Loss: 1.112 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.7797670364379883
Epoch: 10, Steps: 1 | Train Loss: 0.740 Vali Loss: 1.121 Vali Acc: 0.400 Test Loss: 1.121 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.7382478713989258
Epoch: 11, Steps: 1 | Train Loss: 0.653 Vali Loss: 1.132 Vali Acc: 0.400 Test Loss: 1.132 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.9450321197509766
Epoch: 12, Steps: 1 | Train Loss: 0.645 Vali Loss: 1.145 Vali Acc: 0.400 Test Loss: 1.145 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.8549149036407471
Epoch: 13, Steps: 1 | Train Loss: 0.574 Vali Loss: 1.161 Vali Acc: 0.333 Test Loss: 1.161 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.7906434535980225
Epoch: 14, Steps: 1 | Train Loss: 0.540 Vali Loss: 1.178 Vali Acc: 0.333 Test Loss: 1.178 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm32_df128_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 4749571
model size : 18.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm32_df128_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.5287973880767822
Epoch: 1, Steps: 1 | Train Loss: 1.112 Vali Loss: 1.100 Vali Acc: 0.467 Test Loss: 1.100 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.6252555847167969
Epoch: 2, Steps: 1 | Train Loss: 1.058 Vali Loss: 1.088 Vali Acc: 0.533 Test Loss: 1.088 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 3 cost time: 0.5845091342926025
Epoch: 3, Steps: 1 | Train Loss: 0.975 Vali Loss: 1.082 Vali Acc: 0.600 Test Loss: 1.082 Test Acc: 0.600
Validation loss decreased (-0.533322 --> -0.599989).  Saving model ...
Epoch: 4 cost time: 0.5975592136383057
Epoch: 4, Steps: 1 | Train Loss: 0.956 Vali Loss: 1.080 Vali Acc: 0.600 Test Loss: 1.080 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 5 cost time: 0.6071395874023438
Epoch: 5, Steps: 1 | Train Loss: 0.897 Vali Loss: 1.080 Vali Acc: 0.600 Test Loss: 1.080 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5847110748291016
Epoch: 6, Steps: 1 | Train Loss: 0.885 Vali Loss: 1.083 Vali Acc: 0.400 Test Loss: 1.083 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.5931553840637207
Epoch: 7, Steps: 1 | Train Loss: 0.878 Vali Loss: 1.087 Vali Acc: 0.400 Test Loss: 1.087 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.6215708255767822
Epoch: 8, Steps: 1 | Train Loss: 0.823 Vali Loss: 1.093 Vali Acc: 0.333 Test Loss: 1.093 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.6207590103149414
Epoch: 9, Steps: 1 | Train Loss: 0.713 Vali Loss: 1.101 Vali Acc: 0.333 Test Loss: 1.101 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.6584517955780029
Epoch: 10, Steps: 1 | Train Loss: 0.676 Vali Loss: 1.112 Vali Acc: 0.400 Test Loss: 1.112 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.5918855667114258
Epoch: 11, Steps: 1 | Train Loss: 0.656 Vali Loss: 1.127 Vali Acc: 0.400 Test Loss: 1.127 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.5919101238250732
Epoch: 12, Steps: 1 | Train Loss: 0.622 Vali Loss: 1.147 Vali Acc: 0.400 Test Loss: 1.147 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.5262477397918701
Epoch: 13, Steps: 1 | Train Loss: 0.514 Vali Loss: 1.172 Vali Acc: 0.333 Test Loss: 1.172 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.5930080413818359
Epoch: 14, Steps: 1 | Train Loss: 0.462 Vali Loss: 1.194 Vali Acc: 0.333 Test Loss: 1.194 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm32_df128_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 1439363
model size : 6.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm32_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 3.0454418659210205
Epoch: 1, Steps: 1 | Train Loss: 1.223 Vali Loss: 1.117 Vali Acc: 0.267 Test Loss: 1.117 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.9547781944274902
Epoch: 2, Steps: 1 | Train Loss: 1.103 Vali Loss: 1.117 Vali Acc: 0.267 Test Loss: 1.117 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.8257765769958496
Epoch: 3, Steps: 1 | Train Loss: 1.068 Vali Loss: 1.119 Vali Acc: 0.267 Test Loss: 1.119 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9766159057617188
Epoch: 4, Steps: 1 | Train Loss: 1.004 Vali Loss: 1.123 Vali Acc: 0.333 Test Loss: 1.123 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.8314099311828613
Epoch: 5, Steps: 1 | Train Loss: 1.015 Vali Loss: 1.128 Vali Acc: 0.333 Test Loss: 1.128 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.894838809967041
Epoch: 6, Steps: 1 | Train Loss: 0.915 Vali Loss: 1.134 Vali Acc: 0.333 Test Loss: 1.134 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.879382848739624
Epoch: 7, Steps: 1 | Train Loss: 0.852 Vali Loss: 1.141 Vali Acc: 0.333 Test Loss: 1.141 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.7874414920806885
Epoch: 8, Steps: 1 | Train Loss: 0.866 Vali Loss: 1.150 Vali Acc: 0.333 Test Loss: 1.150 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.8192896842956543
Epoch: 9, Steps: 1 | Train Loss: 0.816 Vali Loss: 1.160 Vali Acc: 0.333 Test Loss: 1.160 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.8145074844360352
Epoch: 10, Steps: 1 | Train Loss: 0.716 Vali Loss: 1.172 Vali Acc: 0.333 Test Loss: 1.172 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.729344367980957
Epoch: 11, Steps: 1 | Train Loss: 0.622 Vali Loss: 1.185 Vali Acc: 0.333 Test Loss: 1.185 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.7988052368164062
Epoch: 12, Steps: 1 | Train Loss: 0.535 Vali Loss: 1.200 Vali Acc: 0.333 Test Loss: 1.200 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.8327267169952393
Epoch: 13, Steps: 1 | Train Loss: 0.512 Vali Loss: 1.218 Vali Acc: 0.333 Test Loss: 1.218 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.8172409534454346
Epoch: 14, Steps: 1 | Train Loss: 0.402 Vali Loss: 1.235 Vali Acc: 0.267 Test Loss: 1.235 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm32_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 2405891
model size : 9.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm32_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.7684125900268555
Epoch: 1, Steps: 1 | Train Loss: 1.051 Vali Loss: 1.227 Vali Acc: 0.267 Test Loss: 1.227 Test Acc: 0.267
Validation loss decreased (inf --> -0.266654).  Saving model ...
Epoch: 2 cost time: 0.6097302436828613
Epoch: 2, Steps: 1 | Train Loss: 1.014 Vali Loss: 1.226 Vali Acc: 0.267 Test Loss: 1.226 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 3 cost time: 0.6317179203033447
Epoch: 3, Steps: 1 | Train Loss: 0.969 Vali Loss: 1.227 Vali Acc: 0.267 Test Loss: 1.227 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6978516578674316
Epoch: 4, Steps: 1 | Train Loss: 0.987 Vali Loss: 1.228 Vali Acc: 0.133 Test Loss: 1.228 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.7086226940155029
Epoch: 5, Steps: 1 | Train Loss: 0.861 Vali Loss: 1.230 Vali Acc: 0.200 Test Loss: 1.230 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.6695706844329834
Epoch: 6, Steps: 1 | Train Loss: 0.880 Vali Loss: 1.232 Vali Acc: 0.200 Test Loss: 1.232 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.6827483177185059
Epoch: 7, Steps: 1 | Train Loss: 0.835 Vali Loss: 1.234 Vali Acc: 0.133 Test Loss: 1.234 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.7008123397827148
Epoch: 8, Steps: 1 | Train Loss: 0.763 Vali Loss: 1.237 Vali Acc: 0.133 Test Loss: 1.237 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.6068122386932373
Epoch: 9, Steps: 1 | Train Loss: 0.735 Vali Loss: 1.240 Vali Acc: 0.133 Test Loss: 1.240 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.6639883518218994
Epoch: 10, Steps: 1 | Train Loss: 0.633 Vali Loss: 1.243 Vali Acc: 0.133 Test Loss: 1.243 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.6338107585906982
Epoch: 11, Steps: 1 | Train Loss: 0.608 Vali Loss: 1.248 Vali Acc: 0.133 Test Loss: 1.248 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.7035143375396729
Epoch: 12, Steps: 1 | Train Loss: 0.474 Vali Loss: 1.253 Vali Acc: 0.067 Test Loss: 1.253 Test Acc: 0.067
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm32_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 750723
model size : 3.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm32_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.9402897357940674
Epoch: 1, Steps: 1 | Train Loss: 1.217 Vali Loss: 1.113 Vali Acc: 0.200 Test Loss: 1.113 Test Acc: 0.200
Validation loss decreased (inf --> -0.199989).  Saving model ...
Epoch: 2 cost time: 0.7260580062866211
Epoch: 2, Steps: 1 | Train Loss: 1.105 Vali Loss: 1.113 Vali Acc: 0.267 Test Loss: 1.113 Test Acc: 0.267
Validation loss decreased (-0.199989 --> -0.266656).  Saving model ...
Epoch: 3 cost time: 0.7770383358001709
Epoch: 3, Steps: 1 | Train Loss: 1.072 Vali Loss: 1.116 Vali Acc: 0.267 Test Loss: 1.116 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8075876235961914
Epoch: 4, Steps: 1 | Train Loss: 0.999 Vali Loss: 1.120 Vali Acc: 0.267 Test Loss: 1.120 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.679429292678833
Epoch: 5, Steps: 1 | Train Loss: 1.005 Vali Loss: 1.125 Vali Acc: 0.333 Test Loss: 1.125 Test Acc: 0.333
Validation loss decreased (-0.266656 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.6793277263641357
Epoch: 6, Steps: 1 | Train Loss: 0.916 Vali Loss: 1.131 Vali Acc: 0.333 Test Loss: 1.131 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7805085182189941
Epoch: 7, Steps: 1 | Train Loss: 0.860 Vali Loss: 1.139 Vali Acc: 0.333 Test Loss: 1.139 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.6995179653167725
Epoch: 8, Steps: 1 | Train Loss: 0.869 Vali Loss: 1.148 Vali Acc: 0.333 Test Loss: 1.148 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.7280664443969727
Epoch: 9, Steps: 1 | Train Loss: 0.827 Vali Loss: 1.158 Vali Acc: 0.333 Test Loss: 1.158 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.7676548957824707
Epoch: 10, Steps: 1 | Train Loss: 0.743 Vali Loss: 1.170 Vali Acc: 0.333 Test Loss: 1.170 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.7329361438751221
Epoch: 11, Steps: 1 | Train Loss: 0.655 Vali Loss: 1.183 Vali Acc: 0.333 Test Loss: 1.183 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.7011950016021729
Epoch: 12, Steps: 1 | Train Loss: 0.551 Vali Loss: 1.199 Vali Acc: 0.333 Test Loss: 1.199 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.6933004856109619
Epoch: 13, Steps: 1 | Train Loss: 0.530 Vali Loss: 1.217 Vali Acc: 0.267 Test Loss: 1.217 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.7102713584899902
Epoch: 14, Steps: 1 | Train Loss: 0.460 Vali Loss: 1.235 Vali Acc: 0.267 Test Loss: 1.235 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.6656308174133301
Epoch: 15, Steps: 1 | Train Loss: 0.406 Vali Loss: 1.255 Vali Acc: 0.267 Test Loss: 1.255 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm32_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 2405891
model size : 9.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm32_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.5686283111572266
Epoch: 1, Steps: 1 | Train Loss: 1.052 Vali Loss: 1.223 Vali Acc: 0.267 Test Loss: 1.223 Test Acc: 0.267
Validation loss decreased (inf --> -0.266654).  Saving model ...
Epoch: 2 cost time: 0.6302547454833984
Epoch: 2, Steps: 1 | Train Loss: 1.025 Vali Loss: 1.221 Vali Acc: 0.267 Test Loss: 1.221 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 3 cost time: 0.6711959838867188
Epoch: 3, Steps: 1 | Train Loss: 0.978 Vali Loss: 1.222 Vali Acc: 0.267 Test Loss: 1.222 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5996789932250977
Epoch: 4, Steps: 1 | Train Loss: 0.988 Vali Loss: 1.223 Vali Acc: 0.200 Test Loss: 1.223 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.6034605503082275
Epoch: 5, Steps: 1 | Train Loss: 0.863 Vali Loss: 1.225 Vali Acc: 0.200 Test Loss: 1.225 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.5951004028320312
Epoch: 6, Steps: 1 | Train Loss: 0.882 Vali Loss: 1.226 Vali Acc: 0.200 Test Loss: 1.226 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.5876309871673584
Epoch: 7, Steps: 1 | Train Loss: 0.844 Vali Loss: 1.228 Vali Acc: 0.133 Test Loss: 1.228 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.6593959331512451
Epoch: 8, Steps: 1 | Train Loss: 0.764 Vali Loss: 1.230 Vali Acc: 0.133 Test Loss: 1.230 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.5720093250274658
Epoch: 9, Steps: 1 | Train Loss: 0.737 Vali Loss: 1.233 Vali Acc: 0.133 Test Loss: 1.233 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.6136882305145264
Epoch: 10, Steps: 1 | Train Loss: 0.626 Vali Loss: 1.236 Vali Acc: 0.133 Test Loss: 1.236 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.5729260444641113
Epoch: 11, Steps: 1 | Train Loss: 0.607 Vali Loss: 1.240 Vali Acc: 0.067 Test Loss: 1.240 Test Acc: 0.067
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.5760495662689209
Epoch: 12, Steps: 1 | Train Loss: 0.481 Vali Loss: 1.245 Vali Acc: 0.067 Test Loss: 1.245 Test Acc: 0.067
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm32_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 750723
model size : 3.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm32_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.4950761795043945
Epoch: 1, Steps: 1 | Train Loss: 1.196 Vali Loss: 1.108 Vali Acc: 0.333 Test Loss: 1.108 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.6584584712982178
Epoch: 2, Steps: 1 | Train Loss: 1.084 Vali Loss: 1.108 Vali Acc: 0.400 Test Loss: 1.108 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.6363871097564697
Epoch: 3, Steps: 1 | Train Loss: 1.053 Vali Loss: 1.110 Vali Acc: 0.333 Test Loss: 1.110 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6915860176086426
Epoch: 4, Steps: 1 | Train Loss: 0.999 Vali Loss: 1.114 Vali Acc: 0.333 Test Loss: 1.114 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.6831777095794678
Epoch: 5, Steps: 1 | Train Loss: 1.002 Vali Loss: 1.120 Vali Acc: 0.333 Test Loss: 1.120 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.694249153137207
Epoch: 6, Steps: 1 | Train Loss: 0.910 Vali Loss: 1.126 Vali Acc: 0.333 Test Loss: 1.126 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.7244019508361816
Epoch: 7, Steps: 1 | Train Loss: 0.856 Vali Loss: 1.134 Vali Acc: 0.333 Test Loss: 1.134 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.6149775981903076
Epoch: 8, Steps: 1 | Train Loss: 0.882 Vali Loss: 1.143 Vali Acc: 0.333 Test Loss: 1.143 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.6822443008422852
Epoch: 9, Steps: 1 | Train Loss: 0.835 Vali Loss: 1.153 Vali Acc: 0.333 Test Loss: 1.153 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.7713110446929932
Epoch: 10, Steps: 1 | Train Loss: 0.750 Vali Loss: 1.165 Vali Acc: 0.333 Test Loss: 1.165 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.6378235816955566
Epoch: 11, Steps: 1 | Train Loss: 0.655 Vali Loss: 1.179 Vali Acc: 0.333 Test Loss: 1.179 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.6935036182403564
Epoch: 12, Steps: 1 | Train Loss: 0.578 Vali Loss: 1.196 Vali Acc: 0.267 Test Loss: 1.196 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm32_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 2405891
model size : 9.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm32_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.406428098678589
Epoch: 1, Steps: 1 | Train Loss: 1.041 Vali Loss: 1.220 Vali Acc: 0.200 Test Loss: 1.220 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.5106480121612549
Epoch: 2, Steps: 1 | Train Loss: 1.014 Vali Loss: 1.219 Vali Acc: 0.133 Test Loss: 1.219 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5684974193572998
Epoch: 3, Steps: 1 | Train Loss: 0.967 Vali Loss: 1.219 Vali Acc: 0.133 Test Loss: 1.219 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5695607662200928
Epoch: 4, Steps: 1 | Train Loss: 0.988 Vali Loss: 1.220 Vali Acc: 0.133 Test Loss: 1.220 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5004775524139404
Epoch: 5, Steps: 1 | Train Loss: 0.873 Vali Loss: 1.222 Vali Acc: 0.133 Test Loss: 1.222 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5158524513244629
Epoch: 6, Steps: 1 | Train Loss: 0.884 Vali Loss: 1.224 Vali Acc: 0.133 Test Loss: 1.224 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.5634164810180664
Epoch: 7, Steps: 1 | Train Loss: 0.841 Vali Loss: 1.227 Vali Acc: 0.133 Test Loss: 1.227 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.5429103374481201
Epoch: 8, Steps: 1 | Train Loss: 0.781 Vali Loss: 1.230 Vali Acc: 0.133 Test Loss: 1.230 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.5448687076568604
Epoch: 9, Steps: 1 | Train Loss: 0.747 Vali Loss: 1.234 Vali Acc: 0.200 Test Loss: 1.234 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.5166771411895752
Epoch: 10, Steps: 1 | Train Loss: 0.641 Vali Loss: 1.238 Vali Acc: 0.067 Test Loss: 1.238 Test Acc: 0.067
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.5798742771148682
Epoch: 11, Steps: 1 | Train Loss: 0.635 Vali Loss: 1.244 Vali Acc: 0.067 Test Loss: 1.244 Test Acc: 0.067
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm32_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.2
model parameter : 750723
model size : 3.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm32_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.8017961978912354
Epoch: 1, Steps: 1 | Train Loss: 1.090 Vali Loss: 1.119 Vali Acc: 0.267 Test Loss: 1.119 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.7365853786468506
Epoch: 2, Steps: 1 | Train Loss: 1.042 Vali Loss: 1.113 Vali Acc: 0.333 Test Loss: 1.113 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.664146900177002
Epoch: 3, Steps: 1 | Train Loss: 0.954 Vali Loss: 1.111 Vali Acc: 0.333 Test Loss: 1.111 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.7389540672302246
Epoch: 4, Steps: 1 | Train Loss: 0.941 Vali Loss: 1.112 Vali Acc: 0.400 Test Loss: 1.112 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.6890583038330078
Epoch: 5, Steps: 1 | Train Loss: 0.869 Vali Loss: 1.114 Vali Acc: 0.400 Test Loss: 1.114 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7277688980102539
Epoch: 6, Steps: 1 | Train Loss: 0.813 Vali Loss: 1.117 Vali Acc: 0.400 Test Loss: 1.117 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.7230432033538818
Epoch: 7, Steps: 1 | Train Loss: 0.788 Vali Loss: 1.121 Vali Acc: 0.333 Test Loss: 1.121 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.7850112915039062
Epoch: 8, Steps: 1 | Train Loss: 0.805 Vali Loss: 1.126 Vali Acc: 0.267 Test Loss: 1.126 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.7956039905548096
Epoch: 9, Steps: 1 | Train Loss: 0.704 Vali Loss: 1.133 Vali Acc: 0.267 Test Loss: 1.133 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.8399357795715332
Epoch: 10, Steps: 1 | Train Loss: 0.729 Vali Loss: 1.142 Vali Acc: 0.267 Test Loss: 1.142 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.7544543743133545
Epoch: 11, Steps: 1 | Train Loss: 0.597 Vali Loss: 1.154 Vali Acc: 0.200 Test Loss: 1.154 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.7197299003601074
Epoch: 12, Steps: 1 | Train Loss: 0.551 Vali Loss: 1.167 Vali Acc: 0.200 Test Loss: 1.167 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.6906933784484863
Epoch: 13, Steps: 1 | Train Loss: 0.503 Vali Loss: 1.181 Vali Acc: 0.200 Test Loss: 1.181 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.7959520816802979
Epoch: 14, Steps: 1 | Train Loss: 0.413 Vali Loss: 1.194 Vali Acc: 0.200 Test Loss: 1.194 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm32_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 1234051
model size : 5.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm32_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.3663244247436523
Epoch: 1, Steps: 1 | Train Loss: 1.078 Vali Loss: 1.089 Vali Acc: 0.333 Test Loss: 1.089 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.5486671924591064
Epoch: 2, Steps: 1 | Train Loss: 1.096 Vali Loss: 1.091 Vali Acc: 0.333 Test Loss: 1.091 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5438086986541748
Epoch: 3, Steps: 1 | Train Loss: 1.064 Vali Loss: 1.094 Vali Acc: 0.333 Test Loss: 1.094 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.55238938331604
Epoch: 4, Steps: 1 | Train Loss: 0.965 Vali Loss: 1.097 Vali Acc: 0.333 Test Loss: 1.097 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5349628925323486
Epoch: 5, Steps: 1 | Train Loss: 1.036 Vali Loss: 1.100 Vali Acc: 0.333 Test Loss: 1.100 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.616948127746582
Epoch: 6, Steps: 1 | Train Loss: 0.953 Vali Loss: 1.104 Vali Acc: 0.333 Test Loss: 1.104 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.5198991298675537
Epoch: 7, Steps: 1 | Train Loss: 0.944 Vali Loss: 1.110 Vali Acc: 0.400 Test Loss: 1.110 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.5344619750976562
Epoch: 8, Steps: 1 | Train Loss: 0.825 Vali Loss: 1.117 Vali Acc: 0.400 Test Loss: 1.117 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5618131160736084
Epoch: 9, Steps: 1 | Train Loss: 0.798 Vali Loss: 1.126 Vali Acc: 0.400 Test Loss: 1.126 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.5321254730224609
Epoch: 10, Steps: 1 | Train Loss: 0.760 Vali Loss: 1.137 Vali Acc: 0.333 Test Loss: 1.137 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.6302740573883057
Epoch: 11, Steps: 1 | Train Loss: 0.657 Vali Loss: 1.150 Vali Acc: 0.333 Test Loss: 1.150 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.5619428157806396
Epoch: 12, Steps: 1 | Train Loss: 0.610 Vali Loss: 1.166 Vali Acc: 0.333 Test Loss: 1.166 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.5672528743743896
Epoch: 13, Steps: 1 | Train Loss: 0.522 Vali Loss: 1.184 Vali Acc: 0.333 Test Loss: 1.184 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.5354180335998535
Epoch: 14, Steps: 1 | Train Loss: 0.464 Vali Loss: 1.205 Vali Acc: 0.267 Test Loss: 1.205 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.5532135963439941
Epoch: 15, Steps: 1 | Train Loss: 0.451 Vali Loss: 1.227 Vali Acc: 0.333 Test Loss: 1.227 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.5526752471923828
Epoch: 16, Steps: 1 | Train Loss: 0.344 Vali Loss: 1.252 Vali Acc: 0.333 Test Loss: 1.252 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.5407350063323975
Epoch: 17, Steps: 1 | Train Loss: 0.298 Vali Loss: 1.279 Vali Acc: 0.333 Test Loss: 1.279 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm32_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 406403
model size : 2.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm32_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.6693613529205322
Epoch: 1, Steps: 1 | Train Loss: 1.087 Vali Loss: 1.118 Vali Acc: 0.267 Test Loss: 1.118 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.6821610927581787
Epoch: 2, Steps: 1 | Train Loss: 1.032 Vali Loss: 1.112 Vali Acc: 0.267 Test Loss: 1.112 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266656).  Saving model ...
Epoch: 3 cost time: 0.7435927391052246
Epoch: 3, Steps: 1 | Train Loss: 0.953 Vali Loss: 1.111 Vali Acc: 0.333 Test Loss: 1.111 Test Acc: 0.333
Validation loss decreased (-0.266656 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.7025527954101562
Epoch: 4, Steps: 1 | Train Loss: 0.940 Vali Loss: 1.111 Vali Acc: 0.400 Test Loss: 1.111 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.6425435543060303
Epoch: 5, Steps: 1 | Train Loss: 0.864 Vali Loss: 1.113 Vali Acc: 0.400 Test Loss: 1.113 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7662999629974365
Epoch: 6, Steps: 1 | Train Loss: 0.813 Vali Loss: 1.116 Vali Acc: 0.333 Test Loss: 1.116 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.7332274913787842
Epoch: 7, Steps: 1 | Train Loss: 0.784 Vali Loss: 1.120 Vali Acc: 0.333 Test Loss: 1.120 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.7488746643066406
Epoch: 8, Steps: 1 | Train Loss: 0.804 Vali Loss: 1.126 Vali Acc: 0.267 Test Loss: 1.126 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.7491562366485596
Epoch: 9, Steps: 1 | Train Loss: 0.705 Vali Loss: 1.133 Vali Acc: 0.267 Test Loss: 1.133 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.6592142581939697
Epoch: 10, Steps: 1 | Train Loss: 0.729 Vali Loss: 1.142 Vali Acc: 0.267 Test Loss: 1.142 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.7661254405975342
Epoch: 11, Steps: 1 | Train Loss: 0.597 Vali Loss: 1.154 Vali Acc: 0.200 Test Loss: 1.154 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.7280750274658203
Epoch: 12, Steps: 1 | Train Loss: 0.551 Vali Loss: 1.167 Vali Acc: 0.200 Test Loss: 1.167 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.7110545635223389
Epoch: 13, Steps: 1 | Train Loss: 0.506 Vali Loss: 1.181 Vali Acc: 0.200 Test Loss: 1.181 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.7220873832702637
Epoch: 14, Steps: 1 | Train Loss: 0.413 Vali Loss: 1.194 Vali Acc: 0.200 Test Loss: 1.194 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm32_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 1234051
model size : 5.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm32_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.3890039920806885
Epoch: 1, Steps: 1 | Train Loss: 1.092 Vali Loss: 1.082 Vali Acc: 0.400 Test Loss: 1.082 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.5136456489562988
Epoch: 2, Steps: 1 | Train Loss: 1.093 Vali Loss: 1.083 Vali Acc: 0.400 Test Loss: 1.083 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.532841682434082
Epoch: 3, Steps: 1 | Train Loss: 1.075 Vali Loss: 1.086 Vali Acc: 0.333 Test Loss: 1.086 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6047930717468262
Epoch: 4, Steps: 1 | Train Loss: 0.959 Vali Loss: 1.088 Vali Acc: 0.333 Test Loss: 1.088 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5974833965301514
Epoch: 5, Steps: 1 | Train Loss: 1.039 Vali Loss: 1.091 Vali Acc: 0.333 Test Loss: 1.091 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.50301194190979
Epoch: 6, Steps: 1 | Train Loss: 0.970 Vali Loss: 1.094 Vali Acc: 0.333 Test Loss: 1.094 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.5700390338897705
Epoch: 7, Steps: 1 | Train Loss: 0.944 Vali Loss: 1.099 Vali Acc: 0.333 Test Loss: 1.099 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.5813491344451904
Epoch: 8, Steps: 1 | Train Loss: 0.834 Vali Loss: 1.105 Vali Acc: 0.333 Test Loss: 1.105 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.5722126960754395
Epoch: 9, Steps: 1 | Train Loss: 0.812 Vali Loss: 1.113 Vali Acc: 0.400 Test Loss: 1.113 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.5485217571258545
Epoch: 10, Steps: 1 | Train Loss: 0.774 Vali Loss: 1.124 Vali Acc: 0.400 Test Loss: 1.124 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.5347259044647217
Epoch: 11, Steps: 1 | Train Loss: 0.670 Vali Loss: 1.136 Vali Acc: 0.400 Test Loss: 1.136 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm32_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 406403
model size : 2.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm32_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.38163423538208
Epoch: 1, Steps: 1 | Train Loss: 1.091 Vali Loss: 1.111 Vali Acc: 0.333 Test Loss: 1.111 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.6548728942871094
Epoch: 2, Steps: 1 | Train Loss: 1.027 Vali Loss: 1.104 Vali Acc: 0.267 Test Loss: 1.104 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6172199249267578
Epoch: 3, Steps: 1 | Train Loss: 0.956 Vali Loss: 1.102 Vali Acc: 0.267 Test Loss: 1.102 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5821139812469482
Epoch: 4, Steps: 1 | Train Loss: 0.944 Vali Loss: 1.103 Vali Acc: 0.333 Test Loss: 1.103 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.6552472114562988
Epoch: 5, Steps: 1 | Train Loss: 0.858 Vali Loss: 1.105 Vali Acc: 0.333 Test Loss: 1.105 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.6469829082489014
Epoch: 6, Steps: 1 | Train Loss: 0.821 Vali Loss: 1.108 Vali Acc: 0.400 Test Loss: 1.108 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.5624427795410156
Epoch: 7, Steps: 1 | Train Loss: 0.793 Vali Loss: 1.113 Vali Acc: 0.333 Test Loss: 1.113 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.553534746170044
Epoch: 8, Steps: 1 | Train Loss: 0.813 Vali Loss: 1.119 Vali Acc: 0.333 Test Loss: 1.119 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.6698181629180908
Epoch: 9, Steps: 1 | Train Loss: 0.727 Vali Loss: 1.127 Vali Acc: 0.267 Test Loss: 1.127 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.5880947113037109
Epoch: 10, Steps: 1 | Train Loss: 0.755 Vali Loss: 1.137 Vali Acc: 0.267 Test Loss: 1.137 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.544283390045166
Epoch: 11, Steps: 1 | Train Loss: 0.613 Vali Loss: 1.151 Vali Acc: 0.200 Test Loss: 1.151 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.6048705577850342
Epoch: 12, Steps: 1 | Train Loss: 0.576 Vali Loss: 1.165 Vali Acc: 0.200 Test Loss: 1.165 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.6182334423065186
Epoch: 13, Steps: 1 | Train Loss: 0.532 Vali Loss: 1.181 Vali Acc: 0.200 Test Loss: 1.181 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.6110150814056396
Epoch: 14, Steps: 1 | Train Loss: 0.442 Vali Loss: 1.196 Vali Acc: 0.200 Test Loss: 1.196 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.5985829830169678
Epoch: 15, Steps: 1 | Train Loss: 0.411 Vali Loss: 1.212 Vali Acc: 0.200 Test Loss: 1.212 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.6017558574676514
Epoch: 16, Steps: 1 | Train Loss: 0.352 Vali Loss: 1.228 Vali Acc: 0.200 Test Loss: 1.228 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm32_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 1234051
model size : 5.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm32_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.4181554317474365
Epoch: 1, Steps: 1 | Train Loss: 1.094 Vali Loss: 1.089 Vali Acc: 0.400 Test Loss: 1.089 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.5188999176025391
Epoch: 2, Steps: 1 | Train Loss: 1.078 Vali Loss: 1.090 Vali Acc: 0.400 Test Loss: 1.090 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.518845796585083
Epoch: 3, Steps: 1 | Train Loss: 1.078 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5216078758239746
Epoch: 4, Steps: 1 | Train Loss: 0.946 Vali Loss: 1.096 Vali Acc: 0.400 Test Loss: 1.096 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5379679203033447
Epoch: 5, Steps: 1 | Train Loss: 1.027 Vali Loss: 1.100 Vali Acc: 0.400 Test Loss: 1.100 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5520000457763672
Epoch: 6, Steps: 1 | Train Loss: 0.970 Vali Loss: 1.104 Vali Acc: 0.400 Test Loss: 1.104 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.5734198093414307
Epoch: 7, Steps: 1 | Train Loss: 0.940 Vali Loss: 1.110 Vali Acc: 0.467 Test Loss: 1.110 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 8 cost time: 0.5250053405761719
Epoch: 8, Steps: 1 | Train Loss: 0.826 Vali Loss: 1.118 Vali Acc: 0.467 Test Loss: 1.118 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5544312000274658
Epoch: 9, Steps: 1 | Train Loss: 0.783 Vali Loss: 1.128 Vali Acc: 0.467 Test Loss: 1.128 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.4652552604675293
Epoch: 10, Steps: 1 | Train Loss: 0.768 Vali Loss: 1.140 Vali Acc: 0.467 Test Loss: 1.140 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.6844274997711182
Epoch: 11, Steps: 1 | Train Loss: 0.665 Vali Loss: 1.154 Vali Acc: 0.533 Test Loss: 1.154 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 12 cost time: 0.4597628116607666
Epoch: 12, Steps: 1 | Train Loss: 0.622 Vali Loss: 1.171 Vali Acc: 0.467 Test Loss: 1.171 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.47037601470947266
Epoch: 13, Steps: 1 | Train Loss: 0.534 Vali Loss: 1.190 Vali Acc: 0.533 Test Loss: 1.190 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.5126607418060303
Epoch: 14, Steps: 1 | Train Loss: 0.484 Vali Loss: 1.211 Vali Acc: 0.467 Test Loss: 1.211 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.502450704574585
Epoch: 15, Steps: 1 | Train Loss: 0.473 Vali Loss: 1.234 Vali Acc: 0.400 Test Loss: 1.234 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.4744861125946045
Epoch: 16, Steps: 1 | Train Loss: 0.362 Vali Loss: 1.260 Vali Acc: 0.400 Test Loss: 1.260 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.5179312229156494
Epoch: 17, Steps: 1 | Train Loss: 0.323 Vali Loss: 1.288 Vali Acc: 0.400 Test Loss: 1.288 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.5794272422790527
Epoch: 18, Steps: 1 | Train Loss: 0.281 Vali Loss: 1.317 Vali Acc: 0.400 Test Loss: 1.317 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.6140756607055664
Epoch: 19, Steps: 1 | Train Loss: 0.225 Vali Loss: 1.344 Vali Acc: 0.400 Test Loss: 1.344 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.60585618019104
Epoch: 20, Steps: 1 | Train Loss: 0.187 Vali Loss: 1.369 Vali Acc: 0.400 Test Loss: 1.369 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.49720025062561035
Epoch: 21, Steps: 1 | Train Loss: 0.161 Vali Loss: 1.394 Vali Acc: 0.400 Test Loss: 1.394 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm32_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 406403
model size : 2.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm16_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.9753150939941406
Epoch: 1, Steps: 1 | Train Loss: 1.138 Vali Loss: 1.180 Vali Acc: 0.400 Test Loss: 1.180 Test Acc: 0.400
Validation loss decreased (inf --> -0.399988).  Saving model ...
Epoch: 2 cost time: 0.7334940433502197
Epoch: 2, Steps: 1 | Train Loss: 1.039 Vali Loss: 1.158 Vali Acc: 0.400 Test Loss: 1.158 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 3 cost time: 0.768254280090332
Epoch: 3, Steps: 1 | Train Loss: 1.040 Vali Loss: 1.143 Vali Acc: 0.400 Test Loss: 1.143 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.8050036430358887
Epoch: 4, Steps: 1 | Train Loss: 1.006 Vali Loss: 1.135 Vali Acc: 0.400 Test Loss: 1.135 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.8158097267150879
Epoch: 5, Steps: 1 | Train Loss: 1.010 Vali Loss: 1.130 Vali Acc: 0.333 Test Loss: 1.130 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7683324813842773
Epoch: 6, Steps: 1 | Train Loss: 1.012 Vali Loss: 1.131 Vali Acc: 0.200 Test Loss: 1.131 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.8615953922271729
Epoch: 7, Steps: 1 | Train Loss: 0.956 Vali Loss: 1.132 Vali Acc: 0.333 Test Loss: 1.132 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.742809534072876
Epoch: 8, Steps: 1 | Train Loss: 0.940 Vali Loss: 1.136 Vali Acc: 0.267 Test Loss: 1.136 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.7513399124145508
Epoch: 9, Steps: 1 | Train Loss: 0.883 Vali Loss: 1.140 Vali Acc: 0.267 Test Loss: 1.140 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.7790796756744385
Epoch: 10, Steps: 1 | Train Loss: 0.831 Vali Loss: 1.144 Vali Acc: 0.267 Test Loss: 1.144 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.8283956050872803
Epoch: 11, Steps: 1 | Train Loss: 0.829 Vali Loss: 1.148 Vali Acc: 0.267 Test Loss: 1.148 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.848527193069458
Epoch: 12, Steps: 1 | Train Loss: 0.747 Vali Loss: 1.154 Vali Acc: 0.200 Test Loss: 1.154 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.7505664825439453
Epoch: 13, Steps: 1 | Train Loss: 0.719 Vali Loss: 1.159 Vali Acc: 0.267 Test Loss: 1.159 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.6936931610107422
Epoch: 14, Steps: 1 | Train Loss: 0.718 Vali Loss: 1.166 Vali Acc: 0.267 Test Loss: 1.166 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm16_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 1203331
model size : 4.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm16_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.4305434226989746
Epoch: 1, Steps: 1 | Train Loss: 1.050 Vali Loss: 1.127 Vali Acc: 0.400 Test Loss: 1.127 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.5849812030792236
Epoch: 2, Steps: 1 | Train Loss: 1.094 Vali Loss: 1.125 Vali Acc: 0.400 Test Loss: 1.125 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.5308966636657715
Epoch: 3, Steps: 1 | Train Loss: 1.006 Vali Loss: 1.125 Vali Acc: 0.333 Test Loss: 1.125 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5806446075439453
Epoch: 4, Steps: 1 | Train Loss: 0.991 Vali Loss: 1.126 Vali Acc: 0.333 Test Loss: 1.126 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.519223690032959
Epoch: 5, Steps: 1 | Train Loss: 0.986 Vali Loss: 1.128 Vali Acc: 0.333 Test Loss: 1.128 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.6413283348083496
Epoch: 6, Steps: 1 | Train Loss: 0.904 Vali Loss: 1.130 Vali Acc: 0.333 Test Loss: 1.130 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.6243209838867188
Epoch: 7, Steps: 1 | Train Loss: 0.976 Vali Loss: 1.132 Vali Acc: 0.333 Test Loss: 1.132 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.6876866817474365
Epoch: 8, Steps: 1 | Train Loss: 0.906 Vali Loss: 1.136 Vali Acc: 0.400 Test Loss: 1.136 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.6498494148254395
Epoch: 9, Steps: 1 | Train Loss: 0.923 Vali Loss: 1.139 Vali Acc: 0.400 Test Loss: 1.139 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.5813460350036621
Epoch: 10, Steps: 1 | Train Loss: 0.851 Vali Loss: 1.144 Vali Acc: 0.400 Test Loss: 1.144 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.6375434398651123
Epoch: 11, Steps: 1 | Train Loss: 0.832 Vali Loss: 1.149 Vali Acc: 0.400 Test Loss: 1.149 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.5551691055297852
Epoch: 12, Steps: 1 | Train Loss: 0.840 Vali Loss: 1.155 Vali Acc: 0.400 Test Loss: 1.155 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm16_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 375619
model size : 1.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm16_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.761930465698242
Epoch: 1, Steps: 1 | Train Loss: 1.130 Vali Loss: 1.181 Vali Acc: 0.400 Test Loss: 1.181 Test Acc: 0.400
Validation loss decreased (inf --> -0.399988).  Saving model ...
Epoch: 2 cost time: 0.7431066036224365
Epoch: 2, Steps: 1 | Train Loss: 1.040 Vali Loss: 1.159 Vali Acc: 0.400 Test Loss: 1.159 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 3 cost time: 0.6689960956573486
Epoch: 3, Steps: 1 | Train Loss: 1.032 Vali Loss: 1.144 Vali Acc: 0.400 Test Loss: 1.144 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.7029194831848145
Epoch: 4, Steps: 1 | Train Loss: 1.005 Vali Loss: 1.135 Vali Acc: 0.400 Test Loss: 1.135 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.6540226936340332
Epoch: 5, Steps: 1 | Train Loss: 1.006 Vali Loss: 1.131 Vali Acc: 0.267 Test Loss: 1.131 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.6856038570404053
Epoch: 6, Steps: 1 | Train Loss: 1.009 Vali Loss: 1.130 Vali Acc: 0.200 Test Loss: 1.130 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.6732563972473145
Epoch: 7, Steps: 1 | Train Loss: 0.955 Vali Loss: 1.130 Vali Acc: 0.333 Test Loss: 1.130 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.7036921977996826
Epoch: 8, Steps: 1 | Train Loss: 0.951 Vali Loss: 1.131 Vali Acc: 0.333 Test Loss: 1.131 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.6467645168304443
Epoch: 9, Steps: 1 | Train Loss: 0.888 Vali Loss: 1.133 Vali Acc: 0.333 Test Loss: 1.133 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.6958229541778564
Epoch: 10, Steps: 1 | Train Loss: 0.845 Vali Loss: 1.135 Vali Acc: 0.267 Test Loss: 1.135 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.7608492374420166
Epoch: 11, Steps: 1 | Train Loss: 0.840 Vali Loss: 1.138 Vali Acc: 0.267 Test Loss: 1.138 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.7710666656494141
Epoch: 12, Steps: 1 | Train Loss: 0.763 Vali Loss: 1.140 Vali Acc: 0.400 Test Loss: 1.140 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.6693775653839111
Epoch: 13, Steps: 1 | Train Loss: 0.736 Vali Loss: 1.143 Vali Acc: 0.467 Test Loss: 1.143 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 14 cost time: 0.6336262226104736
Epoch: 14, Steps: 1 | Train Loss: 0.737 Vali Loss: 1.147 Vali Acc: 0.400 Test Loss: 1.147 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.695967435836792
Epoch: 15, Steps: 1 | Train Loss: 0.634 Vali Loss: 1.151 Vali Acc: 0.400 Test Loss: 1.151 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7082343101501465
Epoch: 16, Steps: 1 | Train Loss: 0.669 Vali Loss: 1.156 Vali Acc: 0.400 Test Loss: 1.156 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.7094879150390625
Epoch: 17, Steps: 1 | Train Loss: 0.545 Vali Loss: 1.163 Vali Acc: 0.467 Test Loss: 1.163 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.701185941696167
Epoch: 18, Steps: 1 | Train Loss: 0.541 Vali Loss: 1.171 Vali Acc: 0.467 Test Loss: 1.171 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.7265810966491699
Epoch: 19, Steps: 1 | Train Loss: 0.507 Vali Loss: 1.179 Vali Acc: 0.467 Test Loss: 1.179 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.6845037937164307
Epoch: 20, Steps: 1 | Train Loss: 0.479 Vali Loss: 1.186 Vali Acc: 0.400 Test Loss: 1.186 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.7032465934753418
Epoch: 21, Steps: 1 | Train Loss: 0.419 Vali Loss: 1.193 Vali Acc: 0.400 Test Loss: 1.193 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.7024214267730713
Epoch: 22, Steps: 1 | Train Loss: 0.429 Vali Loss: 1.200 Vali Acc: 0.333 Test Loss: 1.200 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.6934068202972412
Epoch: 23, Steps: 1 | Train Loss: 0.402 Vali Loss: 1.207 Vali Acc: 0.333 Test Loss: 1.207 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm16_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 1203331
model size : 4.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm16_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.533597946166992
Epoch: 1, Steps: 1 | Train Loss: 1.052 Vali Loss: 1.127 Vali Acc: 0.400 Test Loss: 1.127 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.5792338848114014
Epoch: 2, Steps: 1 | Train Loss: 1.082 Vali Loss: 1.126 Vali Acc: 0.400 Test Loss: 1.126 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.6214849948883057
Epoch: 3, Steps: 1 | Train Loss: 1.013 Vali Loss: 1.126 Vali Acc: 0.333 Test Loss: 1.126 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6080446243286133
Epoch: 4, Steps: 1 | Train Loss: 0.992 Vali Loss: 1.127 Vali Acc: 0.333 Test Loss: 1.127 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.5756523609161377
Epoch: 5, Steps: 1 | Train Loss: 0.984 Vali Loss: 1.129 Vali Acc: 0.333 Test Loss: 1.129 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.6385986804962158
Epoch: 6, Steps: 1 | Train Loss: 0.909 Vali Loss: 1.131 Vali Acc: 0.333 Test Loss: 1.131 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.589726448059082
Epoch: 7, Steps: 1 | Train Loss: 0.976 Vali Loss: 1.134 Vali Acc: 0.333 Test Loss: 1.134 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.575875997543335
Epoch: 8, Steps: 1 | Train Loss: 0.908 Vali Loss: 1.137 Vali Acc: 0.400 Test Loss: 1.137 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.5805284976959229
Epoch: 9, Steps: 1 | Train Loss: 0.929 Vali Loss: 1.141 Vali Acc: 0.400 Test Loss: 1.141 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.58683180809021
Epoch: 10, Steps: 1 | Train Loss: 0.857 Vali Loss: 1.146 Vali Acc: 0.400 Test Loss: 1.146 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.5673925876617432
Epoch: 11, Steps: 1 | Train Loss: 0.832 Vali Loss: 1.152 Vali Acc: 0.400 Test Loss: 1.152 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.6292405128479004
Epoch: 12, Steps: 1 | Train Loss: 0.842 Vali Loss: 1.158 Vali Acc: 0.400 Test Loss: 1.158 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm16_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 375619
model size : 1.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm16_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.4398677349090576
Epoch: 1, Steps: 1 | Train Loss: 1.121 Vali Loss: 1.181 Vali Acc: 0.400 Test Loss: 1.181 Test Acc: 0.400
Validation loss decreased (inf --> -0.399988).  Saving model ...
Epoch: 2 cost time: 0.5975801944732666
Epoch: 2, Steps: 1 | Train Loss: 1.044 Vali Loss: 1.159 Vali Acc: 0.400 Test Loss: 1.159 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 3 cost time: 0.6545760631561279
Epoch: 3, Steps: 1 | Train Loss: 1.026 Vali Loss: 1.144 Vali Acc: 0.400 Test Loss: 1.144 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.5849003791809082
Epoch: 4, Steps: 1 | Train Loss: 1.006 Vali Loss: 1.135 Vali Acc: 0.400 Test Loss: 1.135 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.662590503692627
Epoch: 5, Steps: 1 | Train Loss: 1.004 Vali Loss: 1.131 Vali Acc: 0.200 Test Loss: 1.131 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.620995044708252
Epoch: 6, Steps: 1 | Train Loss: 1.005 Vali Loss: 1.130 Vali Acc: 0.200 Test Loss: 1.130 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.6790688037872314
Epoch: 7, Steps: 1 | Train Loss: 0.954 Vali Loss: 1.130 Vali Acc: 0.267 Test Loss: 1.130 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.6026768684387207
Epoch: 8, Steps: 1 | Train Loss: 0.953 Vali Loss: 1.131 Vali Acc: 0.333 Test Loss: 1.131 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.6412920951843262
Epoch: 9, Steps: 1 | Train Loss: 0.890 Vali Loss: 1.132 Vali Acc: 0.333 Test Loss: 1.132 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.5885705947875977
Epoch: 10, Steps: 1 | Train Loss: 0.851 Vali Loss: 1.134 Vali Acc: 0.333 Test Loss: 1.134 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.576683759689331
Epoch: 11, Steps: 1 | Train Loss: 0.846 Vali Loss: 1.136 Vali Acc: 0.333 Test Loss: 1.136 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.6742148399353027
Epoch: 12, Steps: 1 | Train Loss: 0.776 Vali Loss: 1.137 Vali Acc: 0.333 Test Loss: 1.137 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.6421968936920166
Epoch: 13, Steps: 1 | Train Loss: 0.754 Vali Loss: 1.140 Vali Acc: 0.533 Test Loss: 1.140 Test Acc: 0.533
Validation loss decreased (-0.399989 --> -0.533322).  Saving model ...
Epoch: 14 cost time: 0.633216142654419
Epoch: 14, Steps: 1 | Train Loss: 0.749 Vali Loss: 1.143 Vali Acc: 0.467 Test Loss: 1.143 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7140390872955322
Epoch: 15, Steps: 1 | Train Loss: 0.654 Vali Loss: 1.147 Vali Acc: 0.467 Test Loss: 1.147 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.6186618804931641
Epoch: 16, Steps: 1 | Train Loss: 0.688 Vali Loss: 1.151 Vali Acc: 0.400 Test Loss: 1.151 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.658489465713501
Epoch: 17, Steps: 1 | Train Loss: 0.555 Vali Loss: 1.157 Vali Acc: 0.467 Test Loss: 1.157 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.589111328125
Epoch: 18, Steps: 1 | Train Loss: 0.558 Vali Loss: 1.164 Vali Acc: 0.467 Test Loss: 1.164 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.5995476245880127
Epoch: 19, Steps: 1 | Train Loss: 0.534 Vali Loss: 1.171 Vali Acc: 0.467 Test Loss: 1.171 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.643526554107666
Epoch: 20, Steps: 1 | Train Loss: 0.506 Vali Loss: 1.177 Vali Acc: 0.467 Test Loss: 1.177 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.6632249355316162
Epoch: 21, Steps: 1 | Train Loss: 0.429 Vali Loss: 1.184 Vali Acc: 0.400 Test Loss: 1.184 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.6624429225921631
Epoch: 22, Steps: 1 | Train Loss: 0.443 Vali Loss: 1.191 Vali Acc: 0.333 Test Loss: 1.191 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.5892374515533447
Epoch: 23, Steps: 1 | Train Loss: 0.409 Vali Loss: 1.198 Vali Acc: 0.400 Test Loss: 1.198 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm16_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 1203331
model size : 4.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm16_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.2971267700195312
Epoch: 1, Steps: 1 | Train Loss: 1.056 Vali Loss: 1.130 Vali Acc: 0.400 Test Loss: 1.130 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.5773787498474121
Epoch: 2, Steps: 1 | Train Loss: 1.080 Vali Loss: 1.130 Vali Acc: 0.333 Test Loss: 1.130 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5492978096008301
Epoch: 3, Steps: 1 | Train Loss: 1.006 Vali Loss: 1.131 Vali Acc: 0.400 Test Loss: 1.131 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5137383937835693
Epoch: 4, Steps: 1 | Train Loss: 0.989 Vali Loss: 1.133 Vali Acc: 0.400 Test Loss: 1.133 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.6142494678497314
Epoch: 5, Steps: 1 | Train Loss: 0.987 Vali Loss: 1.136 Vali Acc: 0.400 Test Loss: 1.136 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5594253540039062
Epoch: 6, Steps: 1 | Train Loss: 0.904 Vali Loss: 1.139 Vali Acc: 0.400 Test Loss: 1.139 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.6545107364654541
Epoch: 7, Steps: 1 | Train Loss: 0.985 Vali Loss: 1.143 Vali Acc: 0.400 Test Loss: 1.143 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.5448892116546631
Epoch: 8, Steps: 1 | Train Loss: 0.912 Vali Loss: 1.147 Vali Acc: 0.400 Test Loss: 1.147 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.6228945255279541
Epoch: 9, Steps: 1 | Train Loss: 0.924 Vali Loss: 1.152 Vali Acc: 0.400 Test Loss: 1.152 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.6037249565124512
Epoch: 10, Steps: 1 | Train Loss: 0.855 Vali Loss: 1.159 Vali Acc: 0.400 Test Loss: 1.159 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.5962605476379395
Epoch: 11, Steps: 1 | Train Loss: 0.835 Vali Loss: 1.165 Vali Acc: 0.400 Test Loss: 1.165 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm16_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 375619
model size : 1.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm16_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 3.054500102996826
Epoch: 1, Steps: 1 | Train Loss: 1.160 Vali Loss: 1.142 Vali Acc: 0.400 Test Loss: 1.142 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.7447237968444824
Epoch: 2, Steps: 1 | Train Loss: 1.090 Vali Loss: 1.131 Vali Acc: 0.400 Test Loss: 1.131 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.6496806144714355
Epoch: 3, Steps: 1 | Train Loss: 1.067 Vali Loss: 1.123 Vali Acc: 0.400 Test Loss: 1.123 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.8263046741485596
Epoch: 4, Steps: 1 | Train Loss: 1.002 Vali Loss: 1.119 Vali Acc: 0.467 Test Loss: 1.119 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 5 cost time: 0.7593176364898682
Epoch: 5, Steps: 1 | Train Loss: 1.007 Vali Loss: 1.117 Vali Acc: 0.467 Test Loss: 1.117 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 6 cost time: 0.6487174034118652
Epoch: 6, Steps: 1 | Train Loss: 0.947 Vali Loss: 1.118 Vali Acc: 0.467 Test Loss: 1.118 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7511875629425049
Epoch: 7, Steps: 1 | Train Loss: 0.910 Vali Loss: 1.120 Vali Acc: 0.467 Test Loss: 1.120 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.7063877582550049
Epoch: 8, Steps: 1 | Train Loss: 0.880 Vali Loss: 1.123 Vali Acc: 0.467 Test Loss: 1.123 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.6753318309783936
Epoch: 9, Steps: 1 | Train Loss: 0.828 Vali Loss: 1.127 Vali Acc: 0.467 Test Loss: 1.127 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.6442244052886963
Epoch: 10, Steps: 1 | Train Loss: 0.860 Vali Loss: 1.132 Vali Acc: 0.467 Test Loss: 1.132 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.7218625545501709
Epoch: 11, Steps: 1 | Train Loss: 0.790 Vali Loss: 1.138 Vali Acc: 0.467 Test Loss: 1.138 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.8135087490081787
Epoch: 12, Steps: 1 | Train Loss: 0.747 Vali Loss: 1.144 Vali Acc: 0.467 Test Loss: 1.144 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.6429767608642578
Epoch: 13, Steps: 1 | Train Loss: 0.743 Vali Loss: 1.150 Vali Acc: 0.467 Test Loss: 1.150 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.6725864410400391
Epoch: 14, Steps: 1 | Train Loss: 0.672 Vali Loss: 1.157 Vali Acc: 0.467 Test Loss: 1.157 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.6787500381469727
Epoch: 15, Steps: 1 | Train Loss: 0.681 Vali Loss: 1.165 Vali Acc: 0.400 Test Loss: 1.165 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm16_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 617219
model size : 2.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm16_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.3794126510620117
Epoch: 1, Steps: 1 | Train Loss: 1.110 Vali Loss: 1.187 Vali Acc: 0.267 Test Loss: 1.187 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.5339770317077637
Epoch: 2, Steps: 1 | Train Loss: 1.049 Vali Loss: 1.189 Vali Acc: 0.267 Test Loss: 1.189 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6283054351806641
Epoch: 3, Steps: 1 | Train Loss: 1.111 Vali Loss: 1.191 Vali Acc: 0.267 Test Loss: 1.191 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5247058868408203
Epoch: 4, Steps: 1 | Train Loss: 1.035 Vali Loss: 1.192 Vali Acc: 0.267 Test Loss: 1.192 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5351033210754395
Epoch: 5, Steps: 1 | Train Loss: 1.028 Vali Loss: 1.194 Vali Acc: 0.267 Test Loss: 1.194 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5238018035888672
Epoch: 6, Steps: 1 | Train Loss: 0.975 Vali Loss: 1.196 Vali Acc: 0.267 Test Loss: 1.196 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.5795679092407227
Epoch: 7, Steps: 1 | Train Loss: 0.921 Vali Loss: 1.199 Vali Acc: 0.333 Test Loss: 1.199 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333321).  Saving model ...
Epoch: 8 cost time: 0.5337717533111572
Epoch: 8, Steps: 1 | Train Loss: 0.949 Vali Loss: 1.203 Vali Acc: 0.400 Test Loss: 1.203 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399988).  Saving model ...
Epoch: 9 cost time: 0.593759298324585
Epoch: 9, Steps: 1 | Train Loss: 0.892 Vali Loss: 1.207 Vali Acc: 0.400 Test Loss: 1.207 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.4943819046020508
Epoch: 10, Steps: 1 | Train Loss: 0.833 Vali Loss: 1.212 Vali Acc: 0.400 Test Loss: 1.212 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.579052209854126
Epoch: 11, Steps: 1 | Train Loss: 0.801 Vali Loss: 1.218 Vali Acc: 0.400 Test Loss: 1.218 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.6030631065368652
Epoch: 12, Steps: 1 | Train Loss: 0.838 Vali Loss: 1.225 Vali Acc: 0.400 Test Loss: 1.225 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.6029202938079834
Epoch: 13, Steps: 1 | Train Loss: 0.778 Vali Loss: 1.232 Vali Acc: 0.400 Test Loss: 1.232 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.5801255702972412
Epoch: 14, Steps: 1 | Train Loss: 0.734 Vali Loss: 1.240 Vali Acc: 0.333 Test Loss: 1.240 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.6423494815826416
Epoch: 15, Steps: 1 | Train Loss: 0.627 Vali Loss: 1.249 Vali Acc: 0.333 Test Loss: 1.249 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.6536121368408203
Epoch: 16, Steps: 1 | Train Loss: 0.626 Vali Loss: 1.257 Vali Acc: 0.267 Test Loss: 1.257 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.606090784072876
Epoch: 17, Steps: 1 | Train Loss: 0.664 Vali Loss: 1.266 Vali Acc: 0.267 Test Loss: 1.266 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.5987594127655029
Epoch: 18, Steps: 1 | Train Loss: 0.620 Vali Loss: 1.277 Vali Acc: 0.267 Test Loss: 1.277 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm16_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 203331
model size : 1.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm16_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.6050076484680176
Epoch: 1, Steps: 1 | Train Loss: 1.159 Vali Loss: 1.142 Vali Acc: 0.400 Test Loss: 1.142 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.580970287322998
Epoch: 2, Steps: 1 | Train Loss: 1.086 Vali Loss: 1.130 Vali Acc: 0.400 Test Loss: 1.130 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.6190745830535889
Epoch: 3, Steps: 1 | Train Loss: 1.063 Vali Loss: 1.123 Vali Acc: 0.400 Test Loss: 1.123 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.5510976314544678
Epoch: 4, Steps: 1 | Train Loss: 1.003 Vali Loss: 1.118 Vali Acc: 0.467 Test Loss: 1.118 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 5 cost time: 0.6137664318084717
Epoch: 5, Steps: 1 | Train Loss: 1.006 Vali Loss: 1.117 Vali Acc: 0.467 Test Loss: 1.117 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466656).  Saving model ...
Epoch: 6 cost time: 0.6523723602294922
Epoch: 6, Steps: 1 | Train Loss: 0.944 Vali Loss: 1.117 Vali Acc: 0.467 Test Loss: 1.117 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6641805171966553
Epoch: 7, Steps: 1 | Train Loss: 0.908 Vali Loss: 1.120 Vali Acc: 0.467 Test Loss: 1.120 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.7156331539154053
Epoch: 8, Steps: 1 | Train Loss: 0.879 Vali Loss: 1.123 Vali Acc: 0.467 Test Loss: 1.123 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.6820549964904785
Epoch: 9, Steps: 1 | Train Loss: 0.830 Vali Loss: 1.127 Vali Acc: 0.467 Test Loss: 1.127 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.6565344333648682
Epoch: 10, Steps: 1 | Train Loss: 0.857 Vali Loss: 1.132 Vali Acc: 0.467 Test Loss: 1.132 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.6372501850128174
Epoch: 11, Steps: 1 | Train Loss: 0.793 Vali Loss: 1.138 Vali Acc: 0.467 Test Loss: 1.138 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.6520636081695557
Epoch: 12, Steps: 1 | Train Loss: 0.753 Vali Loss: 1.144 Vali Acc: 0.467 Test Loss: 1.144 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.5841107368469238
Epoch: 13, Steps: 1 | Train Loss: 0.748 Vali Loss: 1.150 Vali Acc: 0.467 Test Loss: 1.150 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.7249288558959961
Epoch: 14, Steps: 1 | Train Loss: 0.676 Vali Loss: 1.157 Vali Acc: 0.467 Test Loss: 1.157 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.6525096893310547
Epoch: 15, Steps: 1 | Train Loss: 0.687 Vali Loss: 1.165 Vali Acc: 0.400 Test Loss: 1.165 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm16_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 617219
model size : 2.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm16_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.2396457195281982
Epoch: 1, Steps: 1 | Train Loss: 1.114 Vali Loss: 1.184 Vali Acc: 0.267 Test Loss: 1.184 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.48728322982788086
Epoch: 2, Steps: 1 | Train Loss: 1.052 Vali Loss: 1.185 Vali Acc: 0.267 Test Loss: 1.185 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5876104831695557
Epoch: 3, Steps: 1 | Train Loss: 1.110 Vali Loss: 1.186 Vali Acc: 0.267 Test Loss: 1.186 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.46710872650146484
Epoch: 4, Steps: 1 | Train Loss: 1.034 Vali Loss: 1.186 Vali Acc: 0.267 Test Loss: 1.186 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.542689323425293
Epoch: 5, Steps: 1 | Train Loss: 1.020 Vali Loss: 1.187 Vali Acc: 0.267 Test Loss: 1.187 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5527758598327637
Epoch: 6, Steps: 1 | Train Loss: 0.979 Vali Loss: 1.188 Vali Acc: 0.267 Test Loss: 1.188 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.5627059936523438
Epoch: 7, Steps: 1 | Train Loss: 0.916 Vali Loss: 1.189 Vali Acc: 0.333 Test Loss: 1.189 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333321).  Saving model ...
Epoch: 8 cost time: 0.48383307456970215
Epoch: 8, Steps: 1 | Train Loss: 0.955 Vali Loss: 1.192 Vali Acc: 0.333 Test Loss: 1.192 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.43053483963012695
Epoch: 9, Steps: 1 | Train Loss: 0.895 Vali Loss: 1.194 Vali Acc: 0.267 Test Loss: 1.194 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.4570457935333252
Epoch: 10, Steps: 1 | Train Loss: 0.835 Vali Loss: 1.197 Vali Acc: 0.267 Test Loss: 1.197 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.4492321014404297
Epoch: 11, Steps: 1 | Train Loss: 0.808 Vali Loss: 1.201 Vali Acc: 0.267 Test Loss: 1.201 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.5760996341705322
Epoch: 12, Steps: 1 | Train Loss: 0.844 Vali Loss: 1.205 Vali Acc: 0.267 Test Loss: 1.205 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.48858642578125
Epoch: 13, Steps: 1 | Train Loss: 0.787 Vali Loss: 1.210 Vali Acc: 0.333 Test Loss: 1.210 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.5028667449951172
Epoch: 14, Steps: 1 | Train Loss: 0.739 Vali Loss: 1.216 Vali Acc: 0.333 Test Loss: 1.216 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.5342741012573242
Epoch: 15, Steps: 1 | Train Loss: 0.641 Vali Loss: 1.222 Vali Acc: 0.267 Test Loss: 1.222 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.5028767585754395
Epoch: 16, Steps: 1 | Train Loss: 0.640 Vali Loss: 1.228 Vali Acc: 0.267 Test Loss: 1.228 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.623798131942749
Epoch: 17, Steps: 1 | Train Loss: 0.667 Vali Loss: 1.235 Vali Acc: 0.267 Test Loss: 1.235 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm16_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 203331
model size : 1.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm16_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.3776309490203857
Epoch: 1, Steps: 1 | Train Loss: 1.163 Vali Loss: 1.154 Vali Acc: 0.333 Test Loss: 1.154 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.6524772644042969
Epoch: 2, Steps: 1 | Train Loss: 1.085 Vali Loss: 1.143 Vali Acc: 0.333 Test Loss: 1.143 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.6401934623718262
Epoch: 3, Steps: 1 | Train Loss: 1.065 Vali Loss: 1.136 Vali Acc: 0.333 Test Loss: 1.136 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.6208281517028809
Epoch: 4, Steps: 1 | Train Loss: 0.998 Vali Loss: 1.132 Vali Acc: 0.333 Test Loss: 1.132 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.5773963928222656
Epoch: 5, Steps: 1 | Train Loss: 1.008 Vali Loss: 1.131 Vali Acc: 0.467 Test Loss: 1.131 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466655).  Saving model ...
Epoch: 6 cost time: 0.5940730571746826
Epoch: 6, Steps: 1 | Train Loss: 0.946 Vali Loss: 1.131 Vali Acc: 0.467 Test Loss: 1.131 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5692651271820068
Epoch: 7, Steps: 1 | Train Loss: 0.916 Vali Loss: 1.133 Vali Acc: 0.467 Test Loss: 1.133 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.6071493625640869
Epoch: 8, Steps: 1 | Train Loss: 0.888 Vali Loss: 1.135 Vali Acc: 0.467 Test Loss: 1.135 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.6553435325622559
Epoch: 9, Steps: 1 | Train Loss: 0.840 Vali Loss: 1.138 Vali Acc: 0.467 Test Loss: 1.138 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.6513206958770752
Epoch: 10, Steps: 1 | Train Loss: 0.872 Vali Loss: 1.141 Vali Acc: 0.467 Test Loss: 1.141 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.5765976905822754
Epoch: 11, Steps: 1 | Train Loss: 0.812 Vali Loss: 1.145 Vali Acc: 0.467 Test Loss: 1.145 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.5943219661712646
Epoch: 12, Steps: 1 | Train Loss: 0.767 Vali Loss: 1.149 Vali Acc: 0.467 Test Loss: 1.149 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.596411943435669
Epoch: 13, Steps: 1 | Train Loss: 0.770 Vali Loss: 1.153 Vali Acc: 0.467 Test Loss: 1.153 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.5404119491577148
Epoch: 14, Steps: 1 | Train Loss: 0.699 Vali Loss: 1.157 Vali Acc: 0.467 Test Loss: 1.157 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.5628001689910889
Epoch: 15, Steps: 1 | Train Loss: 0.710 Vali Loss: 1.162 Vali Acc: 0.400 Test Loss: 1.162 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm16_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 617219
model size : 2.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm16_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.1984360218048096
Epoch: 1, Steps: 1 | Train Loss: 1.116 Vali Loss: 1.173 Vali Acc: 0.267 Test Loss: 1.173 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.4454655647277832
Epoch: 2, Steps: 1 | Train Loss: 1.047 Vali Loss: 1.175 Vali Acc: 0.267 Test Loss: 1.175 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.4895000457763672
Epoch: 3, Steps: 1 | Train Loss: 1.108 Vali Loss: 1.175 Vali Acc: 0.333 Test Loss: 1.175 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.5184016227722168
Epoch: 4, Steps: 1 | Train Loss: 1.021 Vali Loss: 1.175 Vali Acc: 0.267 Test Loss: 1.175 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5393145084381104
Epoch: 5, Steps: 1 | Train Loss: 1.016 Vali Loss: 1.176 Vali Acc: 0.267 Test Loss: 1.176 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.5831544399261475
Epoch: 6, Steps: 1 | Train Loss: 0.970 Vali Loss: 1.177 Vali Acc: 0.267 Test Loss: 1.177 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.5873165130615234
Epoch: 7, Steps: 1 | Train Loss: 0.904 Vali Loss: 1.179 Vali Acc: 0.333 Test Loss: 1.179 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.5911073684692383
Epoch: 8, Steps: 1 | Train Loss: 0.957 Vali Loss: 1.181 Vali Acc: 0.333 Test Loss: 1.181 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.4976806640625
Epoch: 9, Steps: 1 | Train Loss: 0.893 Vali Loss: 1.184 Vali Acc: 0.333 Test Loss: 1.184 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.5245952606201172
Epoch: 10, Steps: 1 | Train Loss: 0.841 Vali Loss: 1.187 Vali Acc: 0.333 Test Loss: 1.187 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.5077602863311768
Epoch: 11, Steps: 1 | Train Loss: 0.805 Vali Loss: 1.190 Vali Acc: 0.333 Test Loss: 1.190 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.4417879581451416
Epoch: 12, Steps: 1 | Train Loss: 0.843 Vali Loss: 1.194 Vali Acc: 0.333 Test Loss: 1.194 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.4708833694458008
Epoch: 13, Steps: 1 | Train Loss: 0.784 Vali Loss: 1.200 Vali Acc: 0.333 Test Loss: 1.200 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm16_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 203331
model size : 1.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm16_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.648749351501465
Epoch: 1, Steps: 1 | Train Loss: 1.116 Vali Loss: 1.050 Vali Acc: 0.400 Test Loss: 1.050 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.6399962902069092
Epoch: 2, Steps: 1 | Train Loss: 1.116 Vali Loss: 1.052 Vali Acc: 0.400 Test Loss: 1.052 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7648532390594482
Epoch: 3, Steps: 1 | Train Loss: 1.129 Vali Loss: 1.053 Vali Acc: 0.467 Test Loss: 1.053 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.6972401142120361
Epoch: 4, Steps: 1 | Train Loss: 1.028 Vali Loss: 1.055 Vali Acc: 0.467 Test Loss: 1.055 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6873123645782471
Epoch: 5, Steps: 1 | Train Loss: 1.060 Vali Loss: 1.058 Vali Acc: 0.467 Test Loss: 1.058 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.7175028324127197
Epoch: 6, Steps: 1 | Train Loss: 1.018 Vali Loss: 1.060 Vali Acc: 0.467 Test Loss: 1.060 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.670792818069458
Epoch: 7, Steps: 1 | Train Loss: 1.047 Vali Loss: 1.063 Vali Acc: 0.467 Test Loss: 1.063 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.6504621505737305
Epoch: 8, Steps: 1 | Train Loss: 0.976 Vali Loss: 1.066 Vali Acc: 0.467 Test Loss: 1.066 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.593759298324585
Epoch: 9, Steps: 1 | Train Loss: 0.950 Vali Loss: 1.071 Vali Acc: 0.467 Test Loss: 1.071 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.7053561210632324
Epoch: 10, Steps: 1 | Train Loss: 0.862 Vali Loss: 1.076 Vali Acc: 0.467 Test Loss: 1.076 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.6564805507659912
Epoch: 11, Steps: 1 | Train Loss: 0.811 Vali Loss: 1.082 Vali Acc: 0.467 Test Loss: 1.082 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.5929787158966064
Epoch: 12, Steps: 1 | Train Loss: 0.765 Vali Loss: 1.090 Vali Acc: 0.467 Test Loss: 1.090 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.7246944904327393
Epoch: 13, Steps: 1 | Train Loss: 0.771 Vali Loss: 1.098 Vali Acc: 0.467 Test Loss: 1.098 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm16_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 324163
model size : 1.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm16_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.532371759414673
Epoch: 1, Steps: 1 | Train Loss: 1.224 Vali Loss: 1.157 Vali Acc: 0.267 Test Loss: 1.157 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.533374547958374
Epoch: 2, Steps: 1 | Train Loss: 1.180 Vali Loss: 1.143 Vali Acc: 0.400 Test Loss: 1.143 Test Acc: 0.400
Validation loss decreased (-0.266655 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.5274965763092041
Epoch: 3, Steps: 1 | Train Loss: 1.167 Vali Loss: 1.133 Vali Acc: 0.400 Test Loss: 1.133 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.5168418884277344
Epoch: 4, Steps: 1 | Train Loss: 1.102 Vali Loss: 1.127 Vali Acc: 0.467 Test Loss: 1.127 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 5 cost time: 0.485703706741333
Epoch: 5, Steps: 1 | Train Loss: 1.132 Vali Loss: 1.125 Vali Acc: 0.267 Test Loss: 1.125 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5640923976898193
Epoch: 6, Steps: 1 | Train Loss: 1.091 Vali Loss: 1.126 Vali Acc: 0.267 Test Loss: 1.126 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.5335903167724609
Epoch: 7, Steps: 1 | Train Loss: 1.081 Vali Loss: 1.130 Vali Acc: 0.333 Test Loss: 1.130 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.509476900100708
Epoch: 8, Steps: 1 | Train Loss: 1.036 Vali Loss: 1.134 Vali Acc: 0.267 Test Loss: 1.134 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.560906171798706
Epoch: 9, Steps: 1 | Train Loss: 0.990 Vali Loss: 1.141 Vali Acc: 0.267 Test Loss: 1.141 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.5734241008758545
Epoch: 10, Steps: 1 | Train Loss: 0.942 Vali Loss: 1.149 Vali Acc: 0.267 Test Loss: 1.149 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.5280959606170654
Epoch: 11, Steps: 1 | Train Loss: 0.899 Vali Loss: 1.158 Vali Acc: 0.267 Test Loss: 1.158 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.5539753437042236
Epoch: 12, Steps: 1 | Train Loss: 0.840 Vali Loss: 1.168 Vali Acc: 0.200 Test Loss: 1.168 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.5486660003662109
Epoch: 13, Steps: 1 | Train Loss: 0.833 Vali Loss: 1.178 Vali Acc: 0.200 Test Loss: 1.178 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.5605530738830566
Epoch: 14, Steps: 1 | Train Loss: 0.763 Vali Loss: 1.189 Vali Acc: 0.200 Test Loss: 1.189 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm16_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 117187
model size : 0.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm16_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.5134263038635254
Epoch: 1, Steps: 1 | Train Loss: 1.122 Vali Loss: 1.044 Vali Acc: 0.333 Test Loss: 1.044 Test Acc: 0.333
Validation loss decreased (inf --> -0.333323).  Saving model ...
Epoch: 2 cost time: 0.6167910099029541
Epoch: 2, Steps: 1 | Train Loss: 1.126 Vali Loss: 1.045 Vali Acc: 0.400 Test Loss: 1.045 Test Acc: 0.400
Validation loss decreased (-0.333323 --> -0.399990).  Saving model ...
Epoch: 3 cost time: 0.5709347724914551
Epoch: 3, Steps: 1 | Train Loss: 1.133 Vali Loss: 1.047 Vali Acc: 0.467 Test Loss: 1.047 Test Acc: 0.467
Validation loss decreased (-0.399990 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.5966858863830566
Epoch: 4, Steps: 1 | Train Loss: 1.028 Vali Loss: 1.049 Vali Acc: 0.467 Test Loss: 1.049 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6409680843353271
Epoch: 5, Steps: 1 | Train Loss: 1.062 Vali Loss: 1.052 Vali Acc: 0.467 Test Loss: 1.052 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.6785280704498291
Epoch: 6, Steps: 1 | Train Loss: 1.017 Vali Loss: 1.054 Vali Acc: 0.467 Test Loss: 1.054 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.6765069961547852
Epoch: 7, Steps: 1 | Train Loss: 1.040 Vali Loss: 1.057 Vali Acc: 0.467 Test Loss: 1.057 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.5865366458892822
Epoch: 8, Steps: 1 | Train Loss: 0.975 Vali Loss: 1.060 Vali Acc: 0.467 Test Loss: 1.060 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.6105992794036865
Epoch: 9, Steps: 1 | Train Loss: 0.954 Vali Loss: 1.065 Vali Acc: 0.467 Test Loss: 1.065 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.6525988578796387
Epoch: 10, Steps: 1 | Train Loss: 0.867 Vali Loss: 1.071 Vali Acc: 0.467 Test Loss: 1.071 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.5939755439758301
Epoch: 11, Steps: 1 | Train Loss: 0.814 Vali Loss: 1.078 Vali Acc: 0.467 Test Loss: 1.078 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.6023604869842529
Epoch: 12, Steps: 1 | Train Loss: 0.767 Vali Loss: 1.085 Vali Acc: 0.467 Test Loss: 1.085 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.5982775688171387
Epoch: 13, Steps: 1 | Train Loss: 0.777 Vali Loss: 1.094 Vali Acc: 0.467 Test Loss: 1.094 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm16_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 324163
model size : 1.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm16_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.395996570587158
Epoch: 1, Steps: 1 | Train Loss: 1.233 Vali Loss: 1.168 Vali Acc: 0.267 Test Loss: 1.168 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.5360007286071777
Epoch: 2, Steps: 1 | Train Loss: 1.176 Vali Loss: 1.153 Vali Acc: 0.400 Test Loss: 1.153 Test Acc: 0.400
Validation loss decreased (-0.266655 --> -0.399988).  Saving model ...
Epoch: 3 cost time: 0.5409562587738037
Epoch: 3, Steps: 1 | Train Loss: 1.181 Vali Loss: 1.143 Vali Acc: 0.400 Test Loss: 1.143 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.63844895362854
Epoch: 4, Steps: 1 | Train Loss: 1.112 Vali Loss: 1.137 Vali Acc: 0.400 Test Loss: 1.137 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.5943112373352051
Epoch: 5, Steps: 1 | Train Loss: 1.140 Vali Loss: 1.135 Vali Acc: 0.267 Test Loss: 1.135 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5595386028289795
Epoch: 6, Steps: 1 | Train Loss: 1.103 Vali Loss: 1.135 Vali Acc: 0.267 Test Loss: 1.135 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.6241214275360107
Epoch: 7, Steps: 1 | Train Loss: 1.090 Vali Loss: 1.138 Vali Acc: 0.333 Test Loss: 1.138 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.6688125133514404
Epoch: 8, Steps: 1 | Train Loss: 1.045 Vali Loss: 1.143 Vali Acc: 0.267 Test Loss: 1.143 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.5134434700012207
Epoch: 9, Steps: 1 | Train Loss: 1.000 Vali Loss: 1.149 Vali Acc: 0.267 Test Loss: 1.149 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.534287691116333
Epoch: 10, Steps: 1 | Train Loss: 0.947 Vali Loss: 1.156 Vali Acc: 0.267 Test Loss: 1.156 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.5419979095458984
Epoch: 11, Steps: 1 | Train Loss: 0.908 Vali Loss: 1.164 Vali Acc: 0.267 Test Loss: 1.164 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.558413028717041
Epoch: 12, Steps: 1 | Train Loss: 0.854 Vali Loss: 1.173 Vali Acc: 0.200 Test Loss: 1.173 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.554166316986084
Epoch: 13, Steps: 1 | Train Loss: 0.844 Vali Loss: 1.182 Vali Acc: 0.200 Test Loss: 1.182 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.5522699356079102
Epoch: 14, Steps: 1 | Train Loss: 0.777 Vali Loss: 1.192 Vali Acc: 0.200 Test Loss: 1.192 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm16_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 117187
model size : 0.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm16_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.430126190185547
Epoch: 1, Steps: 1 | Train Loss: 1.140 Vali Loss: 1.056 Vali Acc: 0.333 Test Loss: 1.056 Test Acc: 0.333
Validation loss decreased (inf --> -0.333323).  Saving model ...
Epoch: 2 cost time: 0.5154948234558105
Epoch: 2, Steps: 1 | Train Loss: 1.134 Vali Loss: 1.058 Vali Acc: 0.400 Test Loss: 1.058 Test Acc: 0.400
Validation loss decreased (-0.333323 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.6426117420196533
Epoch: 3, Steps: 1 | Train Loss: 1.150 Vali Loss: 1.060 Vali Acc: 0.467 Test Loss: 1.060 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.6219797134399414
Epoch: 4, Steps: 1 | Train Loss: 1.031 Vali Loss: 1.062 Vali Acc: 0.467 Test Loss: 1.062 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.62021803855896
Epoch: 5, Steps: 1 | Train Loss: 1.067 Vali Loss: 1.065 Vali Acc: 0.467 Test Loss: 1.065 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.5939610004425049
Epoch: 6, Steps: 1 | Train Loss: 1.021 Vali Loss: 1.067 Vali Acc: 0.467 Test Loss: 1.067 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.6225569248199463
Epoch: 7, Steps: 1 | Train Loss: 1.055 Vali Loss: 1.071 Vali Acc: 0.467 Test Loss: 1.071 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.5412986278533936
Epoch: 8, Steps: 1 | Train Loss: 0.981 Vali Loss: 1.075 Vali Acc: 0.467 Test Loss: 1.075 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.6455099582672119
Epoch: 9, Steps: 1 | Train Loss: 0.964 Vali Loss: 1.080 Vali Acc: 0.467 Test Loss: 1.080 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.5531229972839355
Epoch: 10, Steps: 1 | Train Loss: 0.882 Vali Loss: 1.086 Vali Acc: 0.467 Test Loss: 1.086 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.5739588737487793
Epoch: 11, Steps: 1 | Train Loss: 0.831 Vali Loss: 1.094 Vali Acc: 0.467 Test Loss: 1.094 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.5588932037353516
Epoch: 12, Steps: 1 | Train Loss: 0.777 Vali Loss: 1.102 Vali Acc: 0.467 Test Loss: 1.102 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.6178798675537109
Epoch: 13, Steps: 1 | Train Loss: 0.786 Vali Loss: 1.112 Vali Acc: 0.467 Test Loss: 1.112 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm16_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 324163
model size : 1.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            16                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm16_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.1654629707336426
Epoch: 1, Steps: 1 | Train Loss: 1.238 Vali Loss: 1.170 Vali Acc: 0.267 Test Loss: 1.170 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.4775087833404541
Epoch: 2, Steps: 1 | Train Loss: 1.191 Vali Loss: 1.155 Vali Acc: 0.400 Test Loss: 1.155 Test Acc: 0.400
Validation loss decreased (-0.266655 --> -0.399988).  Saving model ...
Epoch: 3 cost time: 0.47547006607055664
Epoch: 3, Steps: 1 | Train Loss: 1.184 Vali Loss: 1.144 Vali Acc: 0.400 Test Loss: 1.144 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.5486798286437988
Epoch: 4, Steps: 1 | Train Loss: 1.116 Vali Loss: 1.137 Vali Acc: 0.400 Test Loss: 1.137 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.4877190589904785
Epoch: 5, Steps: 1 | Train Loss: 1.147 Vali Loss: 1.134 Vali Acc: 0.267 Test Loss: 1.134 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5327897071838379
Epoch: 6, Steps: 1 | Train Loss: 1.103 Vali Loss: 1.135 Vali Acc: 0.200 Test Loss: 1.135 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.5437657833099365
Epoch: 7, Steps: 1 | Train Loss: 1.090 Vali Loss: 1.137 Vali Acc: 0.267 Test Loss: 1.137 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.5100390911102295
Epoch: 8, Steps: 1 | Train Loss: 1.047 Vali Loss: 1.142 Vali Acc: 0.267 Test Loss: 1.142 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.5027222633361816
Epoch: 9, Steps: 1 | Train Loss: 1.007 Vali Loss: 1.147 Vali Acc: 0.267 Test Loss: 1.147 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.5835881233215332
Epoch: 10, Steps: 1 | Train Loss: 0.949 Vali Loss: 1.155 Vali Acc: 0.267 Test Loss: 1.155 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.45668935775756836
Epoch: 11, Steps: 1 | Train Loss: 0.920 Vali Loss: 1.162 Vali Acc: 0.267 Test Loss: 1.162 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.5009922981262207
Epoch: 12, Steps: 1 | Train Loss: 0.862 Vali Loss: 1.171 Vali Acc: 0.200 Test Loss: 1.171 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.5262222290039062
Epoch: 13, Steps: 1 | Train Loss: 0.854 Vali Loss: 1.180 Vali Acc: 0.267 Test Loss: 1.180 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.5547478199005127
Epoch: 14, Steps: 1 | Train Loss: 0.784 Vali Loss: 1.189 Vali Acc: 0.267 Test Loss: 1.189 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm16_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 117187
model size : 0.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm8_df64_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 3.1032257080078125
Epoch: 1, Steps: 1 | Train Loss: 1.159 Vali Loss: 1.110 Vali Acc: 0.333 Test Loss: 1.110 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.8080785274505615
Epoch: 2, Steps: 1 | Train Loss: 1.157 Vali Loss: 1.109 Vali Acc: 0.333 Test Loss: 1.109 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.7906439304351807
Epoch: 3, Steps: 1 | Train Loss: 1.146 Vali Loss: 1.109 Vali Acc: 0.267 Test Loss: 1.109 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7690978050231934
Epoch: 4, Steps: 1 | Train Loss: 1.077 Vali Loss: 1.109 Vali Acc: 0.200 Test Loss: 1.109 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.7882931232452393
Epoch: 5, Steps: 1 | Train Loss: 1.046 Vali Loss: 1.110 Vali Acc: 0.200 Test Loss: 1.110 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.7305929660797119
Epoch: 6, Steps: 1 | Train Loss: 1.052 Vali Loss: 1.110 Vali Acc: 0.200 Test Loss: 1.110 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.7300326824188232
Epoch: 7, Steps: 1 | Train Loss: 1.057 Vali Loss: 1.111 Vali Acc: 0.200 Test Loss: 1.111 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.8217594623565674
Epoch: 8, Steps: 1 | Train Loss: 1.080 Vali Loss: 1.112 Vali Acc: 0.333 Test Loss: 1.112 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.783747673034668
Epoch: 9, Steps: 1 | Train Loss: 1.032 Vali Loss: 1.113 Vali Acc: 0.400 Test Loss: 1.113 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 10 cost time: 0.7567389011383057
Epoch: 10, Steps: 1 | Train Loss: 0.976 Vali Loss: 1.115 Vali Acc: 0.400 Test Loss: 1.115 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7415001392364502
Epoch: 11, Steps: 1 | Train Loss: 1.013 Vali Loss: 1.117 Vali Acc: 0.400 Test Loss: 1.117 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7223238945007324
Epoch: 12, Steps: 1 | Train Loss: 0.920 Vali Loss: 1.119 Vali Acc: 0.400 Test Loss: 1.119 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.7310853004455566
Epoch: 13, Steps: 1 | Train Loss: 0.944 Vali Loss: 1.121 Vali Acc: 0.400 Test Loss: 1.121 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.7552752494812012
Epoch: 14, Steps: 1 | Train Loss: 0.927 Vali Loss: 1.123 Vali Acc: 0.400 Test Loss: 1.123 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.753089427947998
Epoch: 15, Steps: 1 | Train Loss: 0.872 Vali Loss: 1.125 Vali Acc: 0.400 Test Loss: 1.125 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.7481834888458252
Epoch: 16, Steps: 1 | Train Loss: 0.818 Vali Loss: 1.127 Vali Acc: 0.400 Test Loss: 1.127 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.8009703159332275
Epoch: 17, Steps: 1 | Train Loss: 0.769 Vali Loss: 1.129 Vali Acc: 0.400 Test Loss: 1.129 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.8076443672180176
Epoch: 18, Steps: 1 | Train Loss: 0.764 Vali Loss: 1.131 Vali Acc: 0.333 Test Loss: 1.131 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.7696990966796875
Epoch: 19, Steps: 1 | Train Loss: 0.717 Vali Loss: 1.133 Vali Acc: 0.333 Test Loss: 1.133 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm8_df64_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 602051
model size : 2.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm8_df64_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.5789783000946045
Epoch: 1, Steps: 1 | Train Loss: 1.014 Vali Loss: 1.036 Vali Acc: 0.333 Test Loss: 1.036 Test Acc: 0.333
Validation loss decreased (inf --> -0.333323).  Saving model ...
Epoch: 2 cost time: 0.5650629997253418
Epoch: 2, Steps: 1 | Train Loss: 1.013 Vali Loss: 1.033 Vali Acc: 0.400 Test Loss: 1.033 Test Acc: 0.400
Validation loss decreased (-0.333323 --> -0.399990).  Saving model ...
Epoch: 3 cost time: 0.5527215003967285
Epoch: 3, Steps: 1 | Train Loss: 0.951 Vali Loss: 1.031 Vali Acc: 0.467 Test Loss: 1.031 Test Acc: 0.467
Validation loss decreased (-0.399990 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.6661481857299805
Epoch: 4, Steps: 1 | Train Loss: 0.963 Vali Loss: 1.030 Vali Acc: 0.467 Test Loss: 1.030 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 0.552567720413208
Epoch: 5, Steps: 1 | Train Loss: 0.938 Vali Loss: 1.029 Vali Acc: 0.667 Test Loss: 1.029 Test Acc: 0.667
Validation loss decreased (-0.466656 --> -0.666656).  Saving model ...
Epoch: 6 cost time: 0.6205322742462158
Epoch: 6, Steps: 1 | Train Loss: 0.951 Vali Loss: 1.028 Vali Acc: 0.667 Test Loss: 1.028 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666656).  Saving model ...
Epoch: 7 cost time: 0.5498883724212646
Epoch: 7, Steps: 1 | Train Loss: 0.889 Vali Loss: 1.028 Vali Acc: 0.667 Test Loss: 1.028 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.546607255935669
Epoch: 8, Steps: 1 | Train Loss: 0.825 Vali Loss: 1.028 Vali Acc: 0.600 Test Loss: 1.028 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.5823051929473877
Epoch: 9, Steps: 1 | Train Loss: 0.951 Vali Loss: 1.029 Vali Acc: 0.600 Test Loss: 1.029 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.5909864902496338
Epoch: 10, Steps: 1 | Train Loss: 0.814 Vali Loss: 1.029 Vali Acc: 0.600 Test Loss: 1.029 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.5871932506561279
Epoch: 11, Steps: 1 | Train Loss: 0.827 Vali Loss: 1.031 Vali Acc: 0.600 Test Loss: 1.031 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.5502650737762451
Epoch: 12, Steps: 1 | Train Loss: 0.864 Vali Loss: 1.033 Vali Acc: 0.600 Test Loss: 1.033 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.6133928298950195
Epoch: 13, Steps: 1 | Train Loss: 0.803 Vali Loss: 1.035 Vali Acc: 0.533 Test Loss: 1.035 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.6077427864074707
Epoch: 14, Steps: 1 | Train Loss: 0.724 Vali Loss: 1.039 Vali Acc: 0.533 Test Loss: 1.039 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.5431501865386963
Epoch: 15, Steps: 1 | Train Loss: 0.768 Vali Loss: 1.042 Vali Acc: 0.533 Test Loss: 1.042 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.602916955947876
Epoch: 16, Steps: 1 | Train Loss: 0.757 Vali Loss: 1.047 Vali Acc: 0.533 Test Loss: 1.047 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm8_df64_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6666666666666666
model parameter : 188067
model size : 0.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm8_df64_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.6781888008117676
Epoch: 1, Steps: 1 | Train Loss: 1.159 Vali Loss: 1.111 Vali Acc: 0.333 Test Loss: 1.111 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.6084859371185303
Epoch: 2, Steps: 1 | Train Loss: 1.157 Vali Loss: 1.110 Vali Acc: 0.333 Test Loss: 1.110 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.6647584438323975
Epoch: 3, Steps: 1 | Train Loss: 1.150 Vali Loss: 1.110 Vali Acc: 0.267 Test Loss: 1.110 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6491899490356445
Epoch: 4, Steps: 1 | Train Loss: 1.083 Vali Loss: 1.110 Vali Acc: 0.200 Test Loss: 1.110 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.6769165992736816
Epoch: 5, Steps: 1 | Train Loss: 1.048 Vali Loss: 1.111 Vali Acc: 0.200 Test Loss: 1.111 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.6990451812744141
Epoch: 6, Steps: 1 | Train Loss: 1.053 Vali Loss: 1.111 Vali Acc: 0.200 Test Loss: 1.111 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.6986885070800781
Epoch: 7, Steps: 1 | Train Loss: 1.060 Vali Loss: 1.112 Vali Acc: 0.200 Test Loss: 1.112 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.6912271976470947
Epoch: 8, Steps: 1 | Train Loss: 1.083 Vali Loss: 1.113 Vali Acc: 0.200 Test Loss: 1.113 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.6379406452178955
Epoch: 9, Steps: 1 | Train Loss: 1.042 Vali Loss: 1.114 Vali Acc: 0.333 Test Loss: 1.114 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.6697299480438232
Epoch: 10, Steps: 1 | Train Loss: 0.981 Vali Loss: 1.116 Vali Acc: 0.400 Test Loss: 1.116 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 11 cost time: 0.6487340927124023
Epoch: 11, Steps: 1 | Train Loss: 1.015 Vali Loss: 1.118 Vali Acc: 0.400 Test Loss: 1.118 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6676020622253418
Epoch: 12, Steps: 1 | Train Loss: 0.925 Vali Loss: 1.120 Vali Acc: 0.400 Test Loss: 1.120 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.6703219413757324
Epoch: 13, Steps: 1 | Train Loss: 0.947 Vali Loss: 1.122 Vali Acc: 0.400 Test Loss: 1.122 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.6335644721984863
Epoch: 14, Steps: 1 | Train Loss: 0.940 Vali Loss: 1.124 Vali Acc: 0.400 Test Loss: 1.124 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.647545576095581
Epoch: 15, Steps: 1 | Train Loss: 0.880 Vali Loss: 1.126 Vali Acc: 0.400 Test Loss: 1.126 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.6606316566467285
Epoch: 16, Steps: 1 | Train Loss: 0.822 Vali Loss: 1.128 Vali Acc: 0.400 Test Loss: 1.128 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.6432802677154541
Epoch: 17, Steps: 1 | Train Loss: 0.773 Vali Loss: 1.130 Vali Acc: 0.333 Test Loss: 1.130 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.6419413089752197
Epoch: 18, Steps: 1 | Train Loss: 0.769 Vali Loss: 1.132 Vali Acc: 0.333 Test Loss: 1.132 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.8261299133300781
Epoch: 19, Steps: 1 | Train Loss: 0.720 Vali Loss: 1.134 Vali Acc: 0.267 Test Loss: 1.134 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.6785159111022949
Epoch: 20, Steps: 1 | Train Loss: 0.745 Vali Loss: 1.136 Vali Acc: 0.267 Test Loss: 1.136 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm8_df64_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 602051
model size : 2.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm8_df64_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.5125715732574463
Epoch: 1, Steps: 1 | Train Loss: 1.015 Vali Loss: 1.035 Vali Acc: 0.333 Test Loss: 1.035 Test Acc: 0.333
Validation loss decreased (inf --> -0.333323).  Saving model ...
Epoch: 2 cost time: 0.5366096496582031
Epoch: 2, Steps: 1 | Train Loss: 1.020 Vali Loss: 1.033 Vali Acc: 0.400 Test Loss: 1.033 Test Acc: 0.400
Validation loss decreased (-0.333323 --> -0.399990).  Saving model ...
Epoch: 3 cost time: 0.5049357414245605
Epoch: 3, Steps: 1 | Train Loss: 0.949 Vali Loss: 1.030 Vali Acc: 0.533 Test Loss: 1.030 Test Acc: 0.533
Validation loss decreased (-0.399990 --> -0.533323).  Saving model ...
Epoch: 4 cost time: 0.5306754112243652
Epoch: 4, Steps: 1 | Train Loss: 0.963 Vali Loss: 1.029 Vali Acc: 0.533 Test Loss: 1.029 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 5 cost time: 0.5411372184753418
Epoch: 5, Steps: 1 | Train Loss: 0.944 Vali Loss: 1.028 Vali Acc: 0.600 Test Loss: 1.028 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599990).  Saving model ...
Epoch: 6 cost time: 0.4795560836791992
Epoch: 6, Steps: 1 | Train Loss: 0.951 Vali Loss: 1.028 Vali Acc: 0.667 Test Loss: 1.028 Test Acc: 0.667
Validation loss decreased (-0.599990 --> -0.666656).  Saving model ...
Epoch: 7 cost time: 0.5760314464569092
Epoch: 7, Steps: 1 | Train Loss: 0.888 Vali Loss: 1.029 Vali Acc: 0.667 Test Loss: 1.029 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5396912097930908
Epoch: 8, Steps: 1 | Train Loss: 0.823 Vali Loss: 1.029 Vali Acc: 0.600 Test Loss: 1.029 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.533876895904541
Epoch: 9, Steps: 1 | Train Loss: 0.950 Vali Loss: 1.030 Vali Acc: 0.600 Test Loss: 1.030 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.5573530197143555
Epoch: 10, Steps: 1 | Train Loss: 0.812 Vali Loss: 1.031 Vali Acc: 0.600 Test Loss: 1.031 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.6447851657867432
Epoch: 11, Steps: 1 | Train Loss: 0.827 Vali Loss: 1.033 Vali Acc: 0.600 Test Loss: 1.033 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.5605390071868896
Epoch: 12, Steps: 1 | Train Loss: 0.866 Vali Loss: 1.036 Vali Acc: 0.533 Test Loss: 1.036 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.5544605255126953
Epoch: 13, Steps: 1 | Train Loss: 0.801 Vali Loss: 1.039 Vali Acc: 0.533 Test Loss: 1.039 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.5142905712127686
Epoch: 14, Steps: 1 | Train Loss: 0.724 Vali Loss: 1.042 Vali Acc: 0.533 Test Loss: 1.042 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.5839550495147705
Epoch: 15, Steps: 1 | Train Loss: 0.766 Vali Loss: 1.046 Vali Acc: 0.533 Test Loss: 1.046 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.5583813190460205
Epoch: 16, Steps: 1 | Train Loss: 0.757 Vali Loss: 1.051 Vali Acc: 0.533 Test Loss: 1.051 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm8_df64_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6666666666666666
model parameter : 188067
model size : 0.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm8_df64_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.489272356033325
Epoch: 1, Steps: 1 | Train Loss: 1.170 Vali Loss: 1.116 Vali Acc: 0.333 Test Loss: 1.116 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.6163148880004883
Epoch: 2, Steps: 1 | Train Loss: 1.164 Vali Loss: 1.115 Vali Acc: 0.200 Test Loss: 1.115 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6048562526702881
Epoch: 3, Steps: 1 | Train Loss: 1.155 Vali Loss: 1.115 Vali Acc: 0.267 Test Loss: 1.115 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5599527359008789
Epoch: 4, Steps: 1 | Train Loss: 1.083 Vali Loss: 1.116 Vali Acc: 0.267 Test Loss: 1.116 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5510962009429932
Epoch: 5, Steps: 1 | Train Loss: 1.053 Vali Loss: 1.116 Vali Acc: 0.267 Test Loss: 1.116 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5716361999511719
Epoch: 6, Steps: 1 | Train Loss: 1.047 Vali Loss: 1.117 Vali Acc: 0.267 Test Loss: 1.117 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.5430333614349365
Epoch: 7, Steps: 1 | Train Loss: 1.069 Vali Loss: 1.117 Vali Acc: 0.267 Test Loss: 1.117 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.5594615936279297
Epoch: 8, Steps: 1 | Train Loss: 1.088 Vali Loss: 1.118 Vali Acc: 0.267 Test Loss: 1.118 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.5379815101623535
Epoch: 9, Steps: 1 | Train Loss: 1.055 Vali Loss: 1.119 Vali Acc: 0.267 Test Loss: 1.119 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.5726528167724609
Epoch: 10, Steps: 1 | Train Loss: 0.998 Vali Loss: 1.120 Vali Acc: 0.267 Test Loss: 1.120 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.5591399669647217
Epoch: 11, Steps: 1 | Train Loss: 1.034 Vali Loss: 1.121 Vali Acc: 0.267 Test Loss: 1.121 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm8_df64_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 602051
model size : 2.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm8_df64_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.3113961219787598
Epoch: 1, Steps: 1 | Train Loss: 1.010 Vali Loss: 1.061 Vali Acc: 0.267 Test Loss: 1.061 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.49627017974853516
Epoch: 2, Steps: 1 | Train Loss: 1.022 Vali Loss: 1.059 Vali Acc: 0.400 Test Loss: 1.059 Test Acc: 0.400
Validation loss decreased (-0.266656 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.566948652267456
Epoch: 3, Steps: 1 | Train Loss: 0.947 Vali Loss: 1.058 Vali Acc: 0.400 Test Loss: 1.058 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.572279691696167
Epoch: 4, Steps: 1 | Train Loss: 0.964 Vali Loss: 1.057 Vali Acc: 0.467 Test Loss: 1.057 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 0.40780186653137207
Epoch: 5, Steps: 1 | Train Loss: 0.942 Vali Loss: 1.057 Vali Acc: 0.600 Test Loss: 1.057 Test Acc: 0.600
Validation loss decreased (-0.466656 --> -0.599989).  Saving model ...
Epoch: 6 cost time: 0.5447874069213867
Epoch: 6, Steps: 1 | Train Loss: 0.953 Vali Loss: 1.057 Vali Acc: 0.667 Test Loss: 1.057 Test Acc: 0.667
Validation loss decreased (-0.599989 --> -0.666656).  Saving model ...
Epoch: 7 cost time: 0.4559788703918457
Epoch: 7, Steps: 1 | Train Loss: 0.882 Vali Loss: 1.057 Vali Acc: 0.667 Test Loss: 1.057 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5758113861083984
Epoch: 8, Steps: 1 | Train Loss: 0.830 Vali Loss: 1.057 Vali Acc: 0.667 Test Loss: 1.057 Test Acc: 0.667
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.5045523643493652
Epoch: 9, Steps: 1 | Train Loss: 0.957 Vali Loss: 1.058 Vali Acc: 0.667 Test Loss: 1.058 Test Acc: 0.667
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.494171142578125
Epoch: 10, Steps: 1 | Train Loss: 0.821 Vali Loss: 1.058 Vali Acc: 0.667 Test Loss: 1.058 Test Acc: 0.667
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.4965629577636719
Epoch: 11, Steps: 1 | Train Loss: 0.832 Vali Loss: 1.059 Vali Acc: 0.600 Test Loss: 1.059 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.5567760467529297
Epoch: 12, Steps: 1 | Train Loss: 0.885 Vali Loss: 1.060 Vali Acc: 0.600 Test Loss: 1.060 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.5676333904266357
Epoch: 13, Steps: 1 | Train Loss: 0.820 Vali Loss: 1.062 Vali Acc: 0.600 Test Loss: 1.062 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.5366871356964111
Epoch: 14, Steps: 1 | Train Loss: 0.753 Vali Loss: 1.064 Vali Acc: 0.600 Test Loss: 1.064 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.5019345283508301
Epoch: 15, Steps: 1 | Train Loss: 0.786 Vali Loss: 1.066 Vali Acc: 0.600 Test Loss: 1.066 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.46480846405029297
Epoch: 16, Steps: 1 | Train Loss: 0.789 Vali Loss: 1.069 Vali Acc: 0.600 Test Loss: 1.069 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm8_df64_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6666666666666666
model parameter : 188067
model size : 0.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm8_df32_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.7464351654052734
Epoch: 1, Steps: 1 | Train Loss: 1.219 Vali Loss: 1.168 Vali Acc: 0.267 Test Loss: 1.168 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.6671662330627441
Epoch: 2, Steps: 1 | Train Loss: 1.221 Vali Loss: 1.169 Vali Acc: 0.267 Test Loss: 1.169 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6724741458892822
Epoch: 3, Steps: 1 | Train Loss: 1.142 Vali Loss: 1.170 Vali Acc: 0.267 Test Loss: 1.170 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5719101428985596
Epoch: 4, Steps: 1 | Train Loss: 1.080 Vali Loss: 1.171 Vali Acc: 0.267 Test Loss: 1.171 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5869927406311035
Epoch: 5, Steps: 1 | Train Loss: 1.065 Vali Loss: 1.172 Vali Acc: 0.200 Test Loss: 1.172 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5710527896881104
Epoch: 6, Steps: 1 | Train Loss: 1.041 Vali Loss: 1.173 Vali Acc: 0.200 Test Loss: 1.173 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.5679054260253906
Epoch: 7, Steps: 1 | Train Loss: 1.003 Vali Loss: 1.175 Vali Acc: 0.200 Test Loss: 1.175 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.6137301921844482
Epoch: 8, Steps: 1 | Train Loss: 1.051 Vali Loss: 1.177 Vali Acc: 0.267 Test Loss: 1.177 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.6378514766693115
Epoch: 9, Steps: 1 | Train Loss: 0.993 Vali Loss: 1.180 Vali Acc: 0.267 Test Loss: 1.180 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.6251246929168701
Epoch: 10, Steps: 1 | Train Loss: 1.011 Vali Loss: 1.183 Vali Acc: 0.267 Test Loss: 1.183 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.677879810333252
Epoch: 11, Steps: 1 | Train Loss: 1.030 Vali Loss: 1.186 Vali Acc: 0.200 Test Loss: 1.186 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm8_df32_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 308803
model size : 1.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm8_df32_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.496617078781128
Epoch: 1, Steps: 1 | Train Loss: 1.019 Vali Loss: 1.104 Vali Acc: 0.333 Test Loss: 1.104 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.5973310470581055
Epoch: 2, Steps: 1 | Train Loss: 1.012 Vali Loss: 1.098 Vali Acc: 0.400 Test Loss: 1.098 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.630702018737793
Epoch: 3, Steps: 1 | Train Loss: 1.041 Vali Loss: 1.094 Vali Acc: 0.400 Test Loss: 1.094 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.5586369037628174
Epoch: 4, Steps: 1 | Train Loss: 0.986 Vali Loss: 1.092 Vali Acc: 0.400 Test Loss: 1.092 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.5878031253814697
Epoch: 5, Steps: 1 | Train Loss: 0.965 Vali Loss: 1.092 Vali Acc: 0.333 Test Loss: 1.092 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5435798168182373
Epoch: 6, Steps: 1 | Train Loss: 0.971 Vali Loss: 1.092 Vali Acc: 0.333 Test Loss: 1.092 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.49979352951049805
Epoch: 7, Steps: 1 | Train Loss: 0.971 Vali Loss: 1.093 Vali Acc: 0.333 Test Loss: 1.093 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.5808331966400146
Epoch: 8, Steps: 1 | Train Loss: 0.855 Vali Loss: 1.094 Vali Acc: 0.333 Test Loss: 1.094 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.5883378982543945
Epoch: 9, Steps: 1 | Train Loss: 0.869 Vali Loss: 1.096 Vali Acc: 0.333 Test Loss: 1.096 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.5638139247894287
Epoch: 10, Steps: 1 | Train Loss: 0.891 Vali Loss: 1.097 Vali Acc: 0.333 Test Loss: 1.097 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.578005313873291
Epoch: 11, Steps: 1 | Train Loss: 0.906 Vali Loss: 1.099 Vali Acc: 0.400 Test Loss: 1.099 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.6119160652160645
Epoch: 12, Steps: 1 | Train Loss: 0.844 Vali Loss: 1.102 Vali Acc: 0.467 Test Loss: 1.102 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 13 cost time: 0.5294990539550781
Epoch: 13, Steps: 1 | Train Loss: 0.829 Vali Loss: 1.105 Vali Acc: 0.467 Test Loss: 1.105 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.531775712966919
Epoch: 14, Steps: 1 | Train Loss: 0.835 Vali Loss: 1.108 Vali Acc: 0.400 Test Loss: 1.108 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6432678699493408
Epoch: 15, Steps: 1 | Train Loss: 0.763 Vali Loss: 1.112 Vali Acc: 0.467 Test Loss: 1.112 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.5631165504455566
Epoch: 16, Steps: 1 | Train Loss: 0.740 Vali Loss: 1.116 Vali Acc: 0.467 Test Loss: 1.116 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.5934524536132812
Epoch: 17, Steps: 1 | Train Loss: 0.764 Vali Loss: 1.121 Vali Acc: 0.467 Test Loss: 1.121 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.5317807197570801
Epoch: 18, Steps: 1 | Train Loss: 0.738 Vali Loss: 1.125 Vali Acc: 0.467 Test Loss: 1.125 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.5017576217651367
Epoch: 19, Steps: 1 | Train Loss: 0.662 Vali Loss: 1.130 Vali Acc: 0.400 Test Loss: 1.130 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.5477705001831055
Epoch: 20, Steps: 1 | Train Loss: 0.649 Vali Loss: 1.134 Vali Acc: 0.400 Test Loss: 1.134 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.5986132621765137
Epoch: 21, Steps: 1 | Train Loss: 0.645 Vali Loss: 1.138 Vali Acc: 0.400 Test Loss: 1.138 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.606494665145874
Epoch: 22, Steps: 1 | Train Loss: 0.632 Vali Loss: 1.143 Vali Acc: 0.400 Test Loss: 1.143 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm8_df32_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 101795
model size : 0.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm8_df32_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.4518685340881348
Epoch: 1, Steps: 1 | Train Loss: 1.219 Vali Loss: 1.168 Vali Acc: 0.267 Test Loss: 1.168 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.557408332824707
Epoch: 2, Steps: 1 | Train Loss: 1.223 Vali Loss: 1.169 Vali Acc: 0.267 Test Loss: 1.169 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.519650936126709
Epoch: 3, Steps: 1 | Train Loss: 1.144 Vali Loss: 1.170 Vali Acc: 0.267 Test Loss: 1.170 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5404760837554932
Epoch: 4, Steps: 1 | Train Loss: 1.080 Vali Loss: 1.171 Vali Acc: 0.267 Test Loss: 1.171 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.6013174057006836
Epoch: 5, Steps: 1 | Train Loss: 1.070 Vali Loss: 1.172 Vali Acc: 0.200 Test Loss: 1.172 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5849599838256836
Epoch: 6, Steps: 1 | Train Loss: 1.040 Vali Loss: 1.173 Vali Acc: 0.200 Test Loss: 1.173 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.5768003463745117
Epoch: 7, Steps: 1 | Train Loss: 1.005 Vali Loss: 1.175 Vali Acc: 0.200 Test Loss: 1.175 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.6502306461334229
Epoch: 8, Steps: 1 | Train Loss: 1.054 Vali Loss: 1.177 Vali Acc: 0.200 Test Loss: 1.177 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.5855255126953125
Epoch: 9, Steps: 1 | Train Loss: 0.992 Vali Loss: 1.180 Vali Acc: 0.267 Test Loss: 1.180 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.5368053913116455
Epoch: 10, Steps: 1 | Train Loss: 1.016 Vali Loss: 1.182 Vali Acc: 0.267 Test Loss: 1.182 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.4690887928009033
Epoch: 11, Steps: 1 | Train Loss: 1.030 Vali Loss: 1.186 Vali Acc: 0.200 Test Loss: 1.186 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm8_df32_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 308803
model size : 1.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm8_df32_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.595388889312744
Epoch: 1, Steps: 1 | Train Loss: 1.031 Vali Loss: 1.104 Vali Acc: 0.333 Test Loss: 1.104 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.4938027858734131
Epoch: 2, Steps: 1 | Train Loss: 1.020 Vali Loss: 1.098 Vali Acc: 0.400 Test Loss: 1.098 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.5052552223205566
Epoch: 3, Steps: 1 | Train Loss: 1.039 Vali Loss: 1.094 Vali Acc: 0.333 Test Loss: 1.094 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.4424750804901123
Epoch: 4, Steps: 1 | Train Loss: 0.994 Vali Loss: 1.092 Vali Acc: 0.400 Test Loss: 1.092 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.5039691925048828
Epoch: 5, Steps: 1 | Train Loss: 0.971 Vali Loss: 1.092 Vali Acc: 0.333 Test Loss: 1.092 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.524298906326294
Epoch: 6, Steps: 1 | Train Loss: 0.978 Vali Loss: 1.092 Vali Acc: 0.333 Test Loss: 1.092 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.49414706230163574
Epoch: 7, Steps: 1 | Train Loss: 0.976 Vali Loss: 1.093 Vali Acc: 0.333 Test Loss: 1.093 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.49608492851257324
Epoch: 8, Steps: 1 | Train Loss: 0.856 Vali Loss: 1.094 Vali Acc: 0.333 Test Loss: 1.094 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.5924978256225586
Epoch: 9, Steps: 1 | Train Loss: 0.875 Vali Loss: 1.095 Vali Acc: 0.333 Test Loss: 1.095 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.550548791885376
Epoch: 10, Steps: 1 | Train Loss: 0.892 Vali Loss: 1.097 Vali Acc: 0.333 Test Loss: 1.097 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.4890923500061035
Epoch: 11, Steps: 1 | Train Loss: 0.912 Vali Loss: 1.099 Vali Acc: 0.400 Test Loss: 1.099 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.5020344257354736
Epoch: 12, Steps: 1 | Train Loss: 0.846 Vali Loss: 1.102 Vali Acc: 0.467 Test Loss: 1.102 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 13 cost time: 0.5796940326690674
Epoch: 13, Steps: 1 | Train Loss: 0.832 Vali Loss: 1.105 Vali Acc: 0.467 Test Loss: 1.105 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.4369165897369385
Epoch: 14, Steps: 1 | Train Loss: 0.832 Vali Loss: 1.109 Vali Acc: 0.533 Test Loss: 1.109 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 15 cost time: 0.4544250965118408
Epoch: 15, Steps: 1 | Train Loss: 0.766 Vali Loss: 1.112 Vali Acc: 0.467 Test Loss: 1.112 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5083558559417725
Epoch: 16, Steps: 1 | Train Loss: 0.744 Vali Loss: 1.117 Vali Acc: 0.467 Test Loss: 1.117 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.4633939266204834
Epoch: 17, Steps: 1 | Train Loss: 0.760 Vali Loss: 1.122 Vali Acc: 0.400 Test Loss: 1.122 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.44778895378112793
Epoch: 18, Steps: 1 | Train Loss: 0.740 Vali Loss: 1.127 Vali Acc: 0.400 Test Loss: 1.127 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.4725382328033447
Epoch: 19, Steps: 1 | Train Loss: 0.667 Vali Loss: 1.132 Vali Acc: 0.400 Test Loss: 1.132 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.4484419822692871
Epoch: 20, Steps: 1 | Train Loss: 0.653 Vali Loss: 1.136 Vali Acc: 0.400 Test Loss: 1.136 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.5359022617340088
Epoch: 21, Steps: 1 | Train Loss: 0.647 Vali Loss: 1.141 Vali Acc: 0.400 Test Loss: 1.141 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.46392035484313965
Epoch: 22, Steps: 1 | Train Loss: 0.637 Vali Loss: 1.146 Vali Acc: 0.400 Test Loss: 1.146 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.49474191665649414
Epoch: 23, Steps: 1 | Train Loss: 0.601 Vali Loss: 1.152 Vali Acc: 0.400 Test Loss: 1.152 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.5353872776031494
Epoch: 24, Steps: 1 | Train Loss: 0.549 Vali Loss: 1.158 Vali Acc: 0.400 Test Loss: 1.158 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm8_df32_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 101795
model size : 0.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm8_df32_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.4748220443725586
Epoch: 1, Steps: 1 | Train Loss: 1.227 Vali Loss: 1.178 Vali Acc: 0.200 Test Loss: 1.178 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.5445766448974609
Epoch: 2, Steps: 1 | Train Loss: 1.229 Vali Loss: 1.179 Vali Acc: 0.200 Test Loss: 1.179 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6054725646972656
Epoch: 3, Steps: 1 | Train Loss: 1.150 Vali Loss: 1.181 Vali Acc: 0.200 Test Loss: 1.181 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5050971508026123
Epoch: 4, Steps: 1 | Train Loss: 1.085 Vali Loss: 1.183 Vali Acc: 0.200 Test Loss: 1.183 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5353720188140869
Epoch: 5, Steps: 1 | Train Loss: 1.080 Vali Loss: 1.185 Vali Acc: 0.200 Test Loss: 1.185 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.46608495712280273
Epoch: 6, Steps: 1 | Train Loss: 1.038 Vali Loss: 1.186 Vali Acc: 0.200 Test Loss: 1.186 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.513253927230835
Epoch: 7, Steps: 1 | Train Loss: 1.012 Vali Loss: 1.187 Vali Acc: 0.200 Test Loss: 1.187 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.4606156349182129
Epoch: 8, Steps: 1 | Train Loss: 1.065 Vali Loss: 1.189 Vali Acc: 0.200 Test Loss: 1.189 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.48799800872802734
Epoch: 9, Steps: 1 | Train Loss: 1.000 Vali Loss: 1.190 Vali Acc: 0.267 Test Loss: 1.190 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266655).  Saving model ...
Epoch: 10 cost time: 0.505368709564209
Epoch: 10, Steps: 1 | Train Loss: 1.019 Vali Loss: 1.192 Vali Acc: 0.267 Test Loss: 1.192 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.5297415256500244
Epoch: 11, Steps: 1 | Train Loss: 1.046 Vali Loss: 1.194 Vali Acc: 0.267 Test Loss: 1.194 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.5051834583282471
Epoch: 12, Steps: 1 | Train Loss: 0.896 Vali Loss: 1.196 Vali Acc: 0.267 Test Loss: 1.196 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.4708402156829834
Epoch: 13, Steps: 1 | Train Loss: 0.992 Vali Loss: 1.198 Vali Acc: 0.267 Test Loss: 1.198 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.5132925510406494
Epoch: 14, Steps: 1 | Train Loss: 0.892 Vali Loss: 1.201 Vali Acc: 0.200 Test Loss: 1.201 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.549903154373169
Epoch: 15, Steps: 1 | Train Loss: 0.950 Vali Loss: 1.204 Vali Acc: 0.200 Test Loss: 1.204 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.4836540222167969
Epoch: 16, Steps: 1 | Train Loss: 0.857 Vali Loss: 1.207 Vali Acc: 0.200 Test Loss: 1.207 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.5085208415985107
Epoch: 17, Steps: 1 | Train Loss: 0.865 Vali Loss: 1.210 Vali Acc: 0.200 Test Loss: 1.210 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.5234766006469727
Epoch: 18, Steps: 1 | Train Loss: 0.852 Vali Loss: 1.213 Vali Acc: 0.200 Test Loss: 1.213 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.5630626678466797
Epoch: 19, Steps: 1 | Train Loss: 0.772 Vali Loss: 1.216 Vali Acc: 0.200 Test Loss: 1.216 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm8_df32_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 308803
model size : 1.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               32                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm8_df32_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.07330322265625
Epoch: 1, Steps: 1 | Train Loss: 1.016 Vali Loss: 1.091 Vali Acc: 0.333 Test Loss: 1.091 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.5700728893280029
Epoch: 2, Steps: 1 | Train Loss: 1.019 Vali Loss: 1.085 Vali Acc: 0.333 Test Loss: 1.085 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.5482163429260254
Epoch: 3, Steps: 1 | Train Loss: 1.045 Vali Loss: 1.080 Vali Acc: 0.333 Test Loss: 1.080 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333323).  Saving model ...
Epoch: 4 cost time: 0.545281171798706
Epoch: 4, Steps: 1 | Train Loss: 0.979 Vali Loss: 1.077 Vali Acc: 0.400 Test Loss: 1.077 Test Acc: 0.400
Validation loss decreased (-0.333323 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.5271091461181641
Epoch: 5, Steps: 1 | Train Loss: 0.962 Vali Loss: 1.076 Vali Acc: 0.400 Test Loss: 1.076 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.5330655574798584
Epoch: 6, Steps: 1 | Train Loss: 0.976 Vali Loss: 1.076 Vali Acc: 0.333 Test Loss: 1.076 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.4700443744659424
Epoch: 7, Steps: 1 | Train Loss: 0.976 Vali Loss: 1.076 Vali Acc: 0.333 Test Loss: 1.076 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.5177998542785645
Epoch: 8, Steps: 1 | Train Loss: 0.861 Vali Loss: 1.077 Vali Acc: 0.333 Test Loss: 1.077 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.45973825454711914
Epoch: 9, Steps: 1 | Train Loss: 0.874 Vali Loss: 1.078 Vali Acc: 0.333 Test Loss: 1.078 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.44039249420166016
Epoch: 10, Steps: 1 | Train Loss: 0.897 Vali Loss: 1.080 Vali Acc: 0.333 Test Loss: 1.080 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.4343583583831787
Epoch: 11, Steps: 1 | Train Loss: 0.910 Vali Loss: 1.081 Vali Acc: 0.333 Test Loss: 1.081 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.5118539333343506
Epoch: 12, Steps: 1 | Train Loss: 0.869 Vali Loss: 1.084 Vali Acc: 0.400 Test Loss: 1.084 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.47623395919799805
Epoch: 13, Steps: 1 | Train Loss: 0.846 Vali Loss: 1.086 Vali Acc: 0.467 Test Loss: 1.086 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 14 cost time: 0.4677705764770508
Epoch: 14, Steps: 1 | Train Loss: 0.832 Vali Loss: 1.089 Vali Acc: 0.467 Test Loss: 1.089 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5094926357269287
Epoch: 15, Steps: 1 | Train Loss: 0.764 Vali Loss: 1.092 Vali Acc: 0.467 Test Loss: 1.092 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.5025856494903564
Epoch: 16, Steps: 1 | Train Loss: 0.757 Vali Loss: 1.096 Vali Acc: 0.467 Test Loss: 1.096 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.5345180034637451
Epoch: 17, Steps: 1 | Train Loss: 0.771 Vali Loss: 1.101 Vali Acc: 0.467 Test Loss: 1.101 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.456085205078125
Epoch: 18, Steps: 1 | Train Loss: 0.748 Vali Loss: 1.105 Vali Acc: 0.467 Test Loss: 1.105 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.5023617744445801
Epoch: 19, Steps: 1 | Train Loss: 0.674 Vali Loss: 1.109 Vali Acc: 0.467 Test Loss: 1.109 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.5385348796844482
Epoch: 20, Steps: 1 | Train Loss: 0.668 Vali Loss: 1.114 Vali Acc: 0.467 Test Loss: 1.114 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.5399043560028076
Epoch: 21, Steps: 1 | Train Loss: 0.667 Vali Loss: 1.118 Vali Acc: 0.467 Test Loss: 1.118 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.491314172744751
Epoch: 22, Steps: 1 | Train Loss: 0.652 Vali Loss: 1.123 Vali Acc: 0.467 Test Loss: 1.123 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.45512819290161133
Epoch: 23, Steps: 1 | Train Loss: 0.618 Vali Loss: 1.128 Vali Acc: 0.467 Test Loss: 1.128 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm8_df32_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 101795
model size : 0.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm8_df16_nk6_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.5893099308013916
Epoch: 1, Steps: 1 | Train Loss: 1.168 Vali Loss: 1.125 Vali Acc: 0.400 Test Loss: 1.125 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.626413106918335
Epoch: 2, Steps: 1 | Train Loss: 1.023 Vali Loss: 1.113 Vali Acc: 0.333 Test Loss: 1.113 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5530173778533936
Epoch: 3, Steps: 1 | Train Loss: 1.096 Vali Loss: 1.104 Vali Acc: 0.333 Test Loss: 1.104 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5904064178466797
Epoch: 4, Steps: 1 | Train Loss: 1.051 Vali Loss: 1.098 Vali Acc: 0.400 Test Loss: 1.098 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.5670580863952637
Epoch: 5, Steps: 1 | Train Loss: 1.076 Vali Loss: 1.094 Vali Acc: 0.467 Test Loss: 1.094 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 6 cost time: 0.7090106010437012
Epoch: 6, Steps: 1 | Train Loss: 1.032 Vali Loss: 1.092 Vali Acc: 0.400 Test Loss: 1.092 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6824090480804443
Epoch: 7, Steps: 1 | Train Loss: 1.024 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.6746842861175537
Epoch: 8, Steps: 1 | Train Loss: 0.991 Vali Loss: 1.090 Vali Acc: 0.333 Test Loss: 1.090 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.6805465221405029
Epoch: 9, Steps: 1 | Train Loss: 0.936 Vali Loss: 1.090 Vali Acc: 0.267 Test Loss: 1.090 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.752068042755127
Epoch: 10, Steps: 1 | Train Loss: 0.948 Vali Loss: 1.091 Vali Acc: 0.267 Test Loss: 1.091 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.5720603466033936
Epoch: 11, Steps: 1 | Train Loss: 0.965 Vali Loss: 1.092 Vali Acc: 0.267 Test Loss: 1.092 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.6486680507659912
Epoch: 12, Steps: 1 | Train Loss: 0.879 Vali Loss: 1.094 Vali Acc: 0.200 Test Loss: 1.094 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.5788629055023193
Epoch: 13, Steps: 1 | Train Loss: 0.821 Vali Loss: 1.096 Vali Acc: 0.267 Test Loss: 1.096 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.6344430446624756
Epoch: 14, Steps: 1 | Train Loss: 0.850 Vali Loss: 1.099 Vali Acc: 0.400 Test Loss: 1.099 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.6911220550537109
Epoch: 15, Steps: 1 | Train Loss: 0.826 Vali Loss: 1.103 Vali Acc: 0.400 Test Loss: 1.103 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm8_df16_nk6_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 162179
model size : 0.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm8_df16_nk4_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.4804232120513916
Epoch: 1, Steps: 1 | Train Loss: 1.113 Vali Loss: 1.187 Vali Acc: 0.333 Test Loss: 1.187 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.5243778228759766
Epoch: 2, Steps: 1 | Train Loss: 1.093 Vali Loss: 1.178 Vali Acc: 0.267 Test Loss: 1.178 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5465981960296631
Epoch: 3, Steps: 1 | Train Loss: 1.111 Vali Loss: 1.171 Vali Acc: 0.267 Test Loss: 1.171 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.4991915225982666
Epoch: 4, Steps: 1 | Train Loss: 1.128 Vali Loss: 1.166 Vali Acc: 0.200 Test Loss: 1.166 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5038912296295166
Epoch: 5, Steps: 1 | Train Loss: 1.011 Vali Loss: 1.163 Vali Acc: 0.133 Test Loss: 1.163 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5756533145904541
Epoch: 6, Steps: 1 | Train Loss: 1.073 Vali Loss: 1.162 Vali Acc: 0.133 Test Loss: 1.162 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.5338268280029297
Epoch: 7, Steps: 1 | Train Loss: 1.022 Vali Loss: 1.162 Vali Acc: 0.133 Test Loss: 1.162 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.5748083591461182
Epoch: 8, Steps: 1 | Train Loss: 0.992 Vali Loss: 1.161 Vali Acc: 0.200 Test Loss: 1.161 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.5481257438659668
Epoch: 9, Steps: 1 | Train Loss: 0.971 Vali Loss: 1.161 Vali Acc: 0.200 Test Loss: 1.161 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.6110203266143799
Epoch: 10, Steps: 1 | Train Loss: 0.977 Vali Loss: 1.161 Vali Acc: 0.200 Test Loss: 1.161 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.5278127193450928
Epoch: 11, Steps: 1 | Train Loss: 0.893 Vali Loss: 1.162 Vali Acc: 0.133 Test Loss: 1.162 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm8_df16_nk4_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 58659
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm8_df16_nk6_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.6403841972351074
Epoch: 1, Steps: 1 | Train Loss: 1.165 Vali Loss: 1.125 Vali Acc: 0.400 Test Loss: 1.125 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.6617875099182129
Epoch: 2, Steps: 1 | Train Loss: 1.023 Vali Loss: 1.113 Vali Acc: 0.333 Test Loss: 1.113 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6177718639373779
Epoch: 3, Steps: 1 | Train Loss: 1.097 Vali Loss: 1.104 Vali Acc: 0.333 Test Loss: 1.104 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7005548477172852
Epoch: 4, Steps: 1 | Train Loss: 1.051 Vali Loss: 1.098 Vali Acc: 0.400 Test Loss: 1.098 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.6174395084381104
Epoch: 5, Steps: 1 | Train Loss: 1.076 Vali Loss: 1.093 Vali Acc: 0.467 Test Loss: 1.093 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 6 cost time: 0.5439910888671875
Epoch: 6, Steps: 1 | Train Loss: 1.032 Vali Loss: 1.092 Vali Acc: 0.400 Test Loss: 1.092 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6297922134399414
Epoch: 7, Steps: 1 | Train Loss: 1.024 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.526839017868042
Epoch: 8, Steps: 1 | Train Loss: 0.991 Vali Loss: 1.090 Vali Acc: 0.333 Test Loss: 1.090 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.5754764080047607
Epoch: 9, Steps: 1 | Train Loss: 0.937 Vali Loss: 1.090 Vali Acc: 0.267 Test Loss: 1.090 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.5691473484039307
Epoch: 10, Steps: 1 | Train Loss: 0.948 Vali Loss: 1.090 Vali Acc: 0.267 Test Loss: 1.090 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.5921707153320312
Epoch: 11, Steps: 1 | Train Loss: 0.964 Vali Loss: 1.091 Vali Acc: 0.267 Test Loss: 1.091 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.6171517372131348
Epoch: 12, Steps: 1 | Train Loss: 0.878 Vali Loss: 1.093 Vali Acc: 0.267 Test Loss: 1.093 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.6218559741973877
Epoch: 13, Steps: 1 | Train Loss: 0.821 Vali Loss: 1.095 Vali Acc: 0.200 Test Loss: 1.095 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.5814085006713867
Epoch: 14, Steps: 1 | Train Loss: 0.849 Vali Loss: 1.098 Vali Acc: 0.400 Test Loss: 1.098 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.6282804012298584
Epoch: 15, Steps: 1 | Train Loss: 0.826 Vali Loss: 1.101 Vali Acc: 0.400 Test Loss: 1.101 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm8_df16_nk6_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 162179
model size : 0.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm8_df16_nk4_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.541722059249878
Epoch: 1, Steps: 1 | Train Loss: 1.112 Vali Loss: 1.187 Vali Acc: 0.333 Test Loss: 1.187 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.5876080989837646
Epoch: 2, Steps: 1 | Train Loss: 1.093 Vali Loss: 1.179 Vali Acc: 0.267 Test Loss: 1.179 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5169103145599365
Epoch: 3, Steps: 1 | Train Loss: 1.111 Vali Loss: 1.172 Vali Acc: 0.267 Test Loss: 1.172 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5656919479370117
Epoch: 4, Steps: 1 | Train Loss: 1.124 Vali Loss: 1.167 Vali Acc: 0.200 Test Loss: 1.167 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.517059326171875
Epoch: 5, Steps: 1 | Train Loss: 1.010 Vali Loss: 1.164 Vali Acc: 0.133 Test Loss: 1.164 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.526785135269165
Epoch: 6, Steps: 1 | Train Loss: 1.064 Vali Loss: 1.163 Vali Acc: 0.133 Test Loss: 1.163 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.565974235534668
Epoch: 7, Steps: 1 | Train Loss: 1.019 Vali Loss: 1.162 Vali Acc: 0.133 Test Loss: 1.162 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.5251250267028809
Epoch: 8, Steps: 1 | Train Loss: 0.992 Vali Loss: 1.161 Vali Acc: 0.200 Test Loss: 1.161 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.5930633544921875
Epoch: 9, Steps: 1 | Train Loss: 0.968 Vali Loss: 1.161 Vali Acc: 0.200 Test Loss: 1.161 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.5405592918395996
Epoch: 10, Steps: 1 | Train Loss: 0.973 Vali Loss: 1.161 Vali Acc: 0.200 Test Loss: 1.161 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.6225261688232422
Epoch: 11, Steps: 1 | Train Loss: 0.892 Vali Loss: 1.162 Vali Acc: 0.200 Test Loss: 1.162 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm8_df16_nk4_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 58659
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm8_df16_nk6_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.4063868522644043
Epoch: 1, Steps: 1 | Train Loss: 1.169 Vali Loss: 1.121 Vali Acc: 0.400 Test Loss: 1.121 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.6988339424133301
Epoch: 2, Steps: 1 | Train Loss: 1.023 Vali Loss: 1.109 Vali Acc: 0.333 Test Loss: 1.109 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5926597118377686
Epoch: 3, Steps: 1 | Train Loss: 1.097 Vali Loss: 1.099 Vali Acc: 0.333 Test Loss: 1.099 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5935368537902832
Epoch: 4, Steps: 1 | Train Loss: 1.051 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.4720580577850342
Epoch: 5, Steps: 1 | Train Loss: 1.075 Vali Loss: 1.088 Vali Acc: 0.400 Test Loss: 1.088 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.5299880504608154
Epoch: 6, Steps: 1 | Train Loss: 1.034 Vali Loss: 1.087 Vali Acc: 0.333 Test Loss: 1.087 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5685417652130127
Epoch: 7, Steps: 1 | Train Loss: 1.022 Vali Loss: 1.085 Vali Acc: 0.333 Test Loss: 1.085 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.6297190189361572
Epoch: 8, Steps: 1 | Train Loss: 0.996 Vali Loss: 1.084 Vali Acc: 0.267 Test Loss: 1.084 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.6378276348114014
Epoch: 9, Steps: 1 | Train Loss: 0.942 Vali Loss: 1.084 Vali Acc: 0.200 Test Loss: 1.084 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.7181105613708496
Epoch: 10, Steps: 1 | Train Loss: 0.951 Vali Loss: 1.084 Vali Acc: 0.200 Test Loss: 1.084 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.5410747528076172
Epoch: 11, Steps: 1 | Train Loss: 0.969 Vali Loss: 1.085 Vali Acc: 0.200 Test Loss: 1.085 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.5090658664703369
Epoch: 12, Steps: 1 | Train Loss: 0.889 Vali Loss: 1.086 Vali Acc: 0.200 Test Loss: 1.086 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.5735809803009033
Epoch: 13, Steps: 1 | Train Loss: 0.832 Vali Loss: 1.088 Vali Acc: 0.333 Test Loss: 1.088 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.6357934474945068
Epoch: 14, Steps: 1 | Train Loss: 0.857 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.5485219955444336
Epoch: 15, Steps: 1 | Train Loss: 0.840 Vali Loss: 1.094 Vali Acc: 0.400 Test Loss: 1.094 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm8_df16_nk6_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 162179
model size : 0.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              TimesNet            

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        4                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            8                   
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               16                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       30                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm8_df16_nk4_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.260432004928589
Epoch: 1, Steps: 1 | Train Loss: 1.109 Vali Loss: 1.195 Vali Acc: 0.333 Test Loss: 1.195 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.47687244415283203
Epoch: 2, Steps: 1 | Train Loss: 1.093 Vali Loss: 1.187 Vali Acc: 0.267 Test Loss: 1.187 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.4472169876098633
Epoch: 3, Steps: 1 | Train Loss: 1.113 Vali Loss: 1.180 Vali Acc: 0.200 Test Loss: 1.180 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5192086696624756
Epoch: 4, Steps: 1 | Train Loss: 1.115 Vali Loss: 1.175 Vali Acc: 0.133 Test Loss: 1.175 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.4802069664001465
Epoch: 5, Steps: 1 | Train Loss: 1.011 Vali Loss: 1.172 Vali Acc: 0.133 Test Loss: 1.172 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.4165627956390381
Epoch: 6, Steps: 1 | Train Loss: 1.065 Vali Loss: 1.171 Vali Acc: 0.133 Test Loss: 1.171 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.4950718879699707
Epoch: 7, Steps: 1 | Train Loss: 1.022 Vali Loss: 1.170 Vali Acc: 0.133 Test Loss: 1.170 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.5392234325408936
Epoch: 8, Steps: 1 | Train Loss: 0.985 Vali Loss: 1.170 Vali Acc: 0.200 Test Loss: 1.170 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.42760586738586426
Epoch: 9, Steps: 1 | Train Loss: 0.968 Vali Loss: 1.170 Vali Acc: 0.200 Test Loss: 1.170 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.4618668556213379
Epoch: 10, Steps: 1 | Train Loss: 0.979 Vali Loss: 1.170 Vali Acc: 0.200 Test Loss: 1.170 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.48751044273376465
Epoch: 11, Steps: 1 | Train Loss: 0.893 Vali Loss: 1.171 Vali Acc: 0.133 Test Loss: 1.171 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_TimesNet_UEA_ftM_sl640_ll0_pl0_el2_dm8_df16_nk4_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 58659
model size : 0.39MB
