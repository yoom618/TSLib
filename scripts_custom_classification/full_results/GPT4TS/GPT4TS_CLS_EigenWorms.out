Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps720_str180_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.7948057651519775
Epoch: 1, Steps: 8 | Train Loss: 1.649 Vali Loss: 1.549 Vali Acc: 0.420 Test Loss: 1.549 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 1.639267921447754
Epoch: 2, Steps: 8 | Train Loss: 1.417 Vali Loss: 1.544 Vali Acc: 0.405 Test Loss: 1.544 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7183527946472168
Epoch: 3, Steps: 8 | Train Loss: 1.226 Vali Loss: 1.406 Vali Acc: 0.458 Test Loss: 1.406 Test Acc: 0.458
Validation loss decreased (-0.419832 --> -0.458001).  Saving model ...
Epoch: 4 cost time: 1.7553794384002686
Epoch: 4, Steps: 8 | Train Loss: 0.855 Vali Loss: 1.276 Vali Acc: 0.481 Test Loss: 1.276 Test Acc: 0.481
Validation loss decreased (-0.458001 --> -0.480903).  Saving model ...
Epoch: 5 cost time: 2.511716365814209
Epoch: 5, Steps: 8 | Train Loss: 0.465 Vali Loss: 1.635 Vali Acc: 0.550 Test Loss: 1.635 Test Acc: 0.550
Validation loss decreased (-0.480903 --> -0.549602).  Saving model ...
Epoch: 6 cost time: 2.191673994064331
Epoch: 6, Steps: 8 | Train Loss: 0.169 Vali Loss: 1.600 Vali Acc: 0.450 Test Loss: 1.600 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7728867530822754
Epoch: 7, Steps: 8 | Train Loss: 0.053 Vali Loss: 2.268 Vali Acc: 0.443 Test Loss: 2.268 Test Acc: 0.443
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.4848928451538086
Epoch: 8, Steps: 8 | Train Loss: 0.034 Vali Loss: 1.949 Vali Acc: 0.550 Test Loss: 1.949 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.0406112670898438
Epoch: 9, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.935 Vali Acc: 0.473 Test Loss: 1.935 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.145585060119629
Epoch: 10, Steps: 8 | Train Loss: 0.005 Vali Loss: 2.145 Vali Acc: 0.527 Test Loss: 2.145 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.1301827430725098
Epoch: 11, Steps: 8 | Train Loss: 0.004 Vali Loss: 2.026 Vali Acc: 0.542 Test Loss: 2.026 Test Acc: 0.542
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.9526546001434326
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.246 Vali Acc: 0.511 Test Loss: 2.246 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.0480430126190186
Epoch: 13, Steps: 8 | Train Loss: 0.005 Vali Loss: 2.259 Vali Acc: 0.473 Test Loss: 2.259 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.2686474323272705
Epoch: 14, Steps: 8 | Train Loss: 0.003 Vali Loss: 2.302 Vali Acc: 0.527 Test Loss: 2.302 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.9096124172210693
Epoch: 15, Steps: 8 | Train Loss: 0.002 Vali Loss: 2.218 Vali Acc: 0.511 Test Loss: 2.218 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps720_str180_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 53848325
model size : 220.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps720_str360_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.049852132797241
Epoch: 1, Steps: 8 | Train Loss: 1.619 Vali Loss: 1.643 Vali Acc: 0.420 Test Loss: 1.643 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 2.20621919631958
Epoch: 2, Steps: 8 | Train Loss: 1.459 Vali Loss: 1.605 Vali Acc: 0.206 Test Loss: 1.605 Test Acc: 0.206
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8360686302185059
Epoch: 3, Steps: 8 | Train Loss: 1.236 Vali Loss: 1.508 Vali Acc: 0.450 Test Loss: 1.508 Test Acc: 0.450
Validation loss decreased (-0.419831 --> -0.450367).  Saving model ...
Epoch: 4 cost time: 1.5459799766540527
Epoch: 4, Steps: 8 | Train Loss: 1.020 Vali Loss: 1.348 Vali Acc: 0.511 Test Loss: 1.348 Test Acc: 0.511
Validation loss decreased (-0.450367 --> -0.511437).  Saving model ...
Epoch: 5 cost time: 1.4892017841339111
Epoch: 5, Steps: 8 | Train Loss: 0.692 Vali Loss: 1.318 Vali Acc: 0.542 Test Loss: 1.318 Test Acc: 0.542
Validation loss decreased (-0.511437 --> -0.541972).  Saving model ...
Epoch: 6 cost time: 1.9140090942382812
Epoch: 6, Steps: 8 | Train Loss: 0.342 Vali Loss: 1.273 Vali Acc: 0.534 Test Loss: 1.273 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7948942184448242
Epoch: 7, Steps: 8 | Train Loss: 0.127 Vali Loss: 1.121 Vali Acc: 0.626 Test Loss: 1.121 Test Acc: 0.626
Validation loss decreased (-0.541972 --> -0.625943).  Saving model ...
Epoch: 8 cost time: 1.6102778911590576
Epoch: 8, Steps: 8 | Train Loss: 0.047 Vali Loss: 1.523 Vali Acc: 0.611 Test Loss: 1.523 Test Acc: 0.611
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.9640262126922607
Epoch: 9, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.327 Vali Acc: 0.626 Test Loss: 1.327 Test Acc: 0.626
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.627446174621582
Epoch: 10, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.368 Vali Acc: 0.618 Test Loss: 1.368 Test Acc: 0.618
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.616274118423462
Epoch: 11, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.568 Vali Acc: 0.626 Test Loss: 1.568 Test Acc: 0.626
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.4914588928222656
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.578 Vali Acc: 0.595 Test Loss: 1.578 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.4367425441741943
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.598 Vali Acc: 0.618 Test Loss: 1.598 Test Acc: 0.618
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.5229237079620361
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.652 Vali Acc: 0.649 Test Loss: 1.652 Test Acc: 0.649
Validation loss decreased (-0.625943 --> -0.648838).  Saving model ...
Epoch: 15 cost time: 1.407102108001709
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.697 Vali Acc: 0.649 Test Loss: 1.697 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.265618085861206
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.689 Vali Acc: 0.649 Test Loss: 1.689 Test Acc: 0.649
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.5359225273132324
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.663 Vali Acc: 0.664 Test Loss: 1.663 Test Acc: 0.664
Validation loss decreased (-0.648838 --> -0.664106).  Saving model ...
Epoch: 18 cost time: 1.5029168128967285
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.627 Vali Acc: 0.656 Test Loss: 1.627 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.5339598655700684
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.605 Vali Acc: 0.649 Test Loss: 1.605 Test Acc: 0.649
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.3745830059051514
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.598 Vali Acc: 0.664 Test Loss: 1.598 Test Acc: 0.664
Validation loss decreased (-0.664106 --> -0.664106).  Saving model ...
Epoch: 21 cost time: 1.3748888969421387
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.602 Vali Acc: 0.664 Test Loss: 1.602 Test Acc: 0.664
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0506718158721924
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.616 Vali Acc: 0.656 Test Loss: 1.616 Test Acc: 0.656
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.8589975833892822
Epoch: 23, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.634 Vali Acc: 0.656 Test Loss: 1.634 Test Acc: 0.656
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.879413366317749
Epoch: 24, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.646 Vali Acc: 0.656 Test Loss: 1.646 Test Acc: 0.656
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.9549014568328857
Epoch: 25, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.653 Vali Acc: 0.656 Test Loss: 1.653 Test Acc: 0.656
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.2421150207519531
Epoch: 26, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.651 Vali Acc: 0.656 Test Loss: 1.651 Test Acc: 0.656
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.4402308464050293
Epoch: 27, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.642 Vali Acc: 0.656 Test Loss: 1.642 Test Acc: 0.656
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.5804309844970703
Epoch: 28, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.633 Vali Acc: 0.656 Test Loss: 1.633 Test Acc: 0.656
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.5296630859375
Epoch: 29, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.636 Vali Acc: 0.656 Test Loss: 1.636 Test Acc: 0.656
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.5535616874694824
Epoch: 30, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.644 Vali Acc: 0.656 Test Loss: 1.644 Test Acc: 0.656
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps720_str360_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6641221374045801
model parameter : 53590277
model size : 219.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps720_str720_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.9612040519714355
Epoch: 1, Steps: 8 | Train Loss: 1.572 Vali Loss: 1.600 Vali Acc: 0.420 Test Loss: 1.600 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 0.840034008026123
Epoch: 2, Steps: 8 | Train Loss: 1.406 Vali Loss: 1.490 Vali Acc: 0.420 Test Loss: 1.490 Test Acc: 0.420
Validation loss decreased (-0.419831 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 1.5346119403839111
Epoch: 3, Steps: 8 | Train Loss: 1.201 Vali Loss: 1.464 Vali Acc: 0.450 Test Loss: 1.464 Test Acc: 0.450
Validation loss decreased (-0.419832 --> -0.450367).  Saving model ...
Epoch: 4 cost time: 1.4317233562469482
Epoch: 4, Steps: 8 | Train Loss: 0.918 Vali Loss: 1.506 Vali Acc: 0.466 Test Loss: 1.506 Test Acc: 0.466
Validation loss decreased (-0.450367 --> -0.465634).  Saving model ...
Epoch: 5 cost time: 1.7969050407409668
Epoch: 5, Steps: 8 | Train Loss: 0.616 Vali Loss: 1.407 Vali Acc: 0.466 Test Loss: 1.407 Test Acc: 0.466
Validation loss decreased (-0.465634 --> -0.465635).  Saving model ...
Epoch: 6 cost time: 1.1114001274108887
Epoch: 6, Steps: 8 | Train Loss: 0.369 Vali Loss: 1.492 Vali Acc: 0.527 Test Loss: 1.492 Test Acc: 0.527
Validation loss decreased (-0.465635 --> -0.526703).  Saving model ...
Epoch: 7 cost time: 1.1846582889556885
Epoch: 7, Steps: 8 | Train Loss: 0.161 Vali Loss: 1.522 Vali Acc: 0.504 Test Loss: 1.522 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.431943655014038
Epoch: 8, Steps: 8 | Train Loss: 0.062 Vali Loss: 1.518 Vali Acc: 0.511 Test Loss: 1.518 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.218937873840332
Epoch: 9, Steps: 8 | Train Loss: 0.021 Vali Loss: 1.654 Vali Acc: 0.496 Test Loss: 1.654 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.7504146099090576
Epoch: 10, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.693 Vali Acc: 0.481 Test Loss: 1.693 Test Acc: 0.481
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.5275614261627197
Epoch: 11, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.755 Vali Acc: 0.473 Test Loss: 1.755 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.4947717189788818
Epoch: 12, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.683 Vali Acc: 0.466 Test Loss: 1.683 Test Acc: 0.466
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.3506228923797607
Epoch: 13, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.659 Vali Acc: 0.473 Test Loss: 1.659 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.506443738937378
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.689 Vali Acc: 0.496 Test Loss: 1.689 Test Acc: 0.496
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.1308577060699463
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.717 Vali Acc: 0.489 Test Loss: 1.717 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.584094762802124
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.737 Vali Acc: 0.481 Test Loss: 1.737 Test Acc: 0.481
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps720_str720_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 53461253
model size : 218.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps750_str188_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.643789052963257
Epoch: 1, Steps: 8 | Train Loss: 1.565 Vali Loss: 1.617 Vali Acc: 0.420 Test Loss: 1.617 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 2.2811152935028076
Epoch: 2, Steps: 8 | Train Loss: 1.457 Vali Loss: 1.519 Vali Acc: 0.420 Test Loss: 1.519 Test Acc: 0.420
Validation loss decreased (-0.419831 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 2.32912278175354
Epoch: 3, Steps: 8 | Train Loss: 1.169 Vali Loss: 1.469 Vali Acc: 0.427 Test Loss: 1.469 Test Acc: 0.427
Validation loss decreased (-0.419832 --> -0.427466).  Saving model ...
Epoch: 4 cost time: 2.0531411170959473
Epoch: 4, Steps: 8 | Train Loss: 0.889 Vali Loss: 1.230 Vali Acc: 0.481 Test Loss: 1.230 Test Acc: 0.481
Validation loss decreased (-0.427466 --> -0.480904).  Saving model ...
Epoch: 5 cost time: 1.9518837928771973
Epoch: 5, Steps: 8 | Train Loss: 0.419 Vali Loss: 1.399 Vali Acc: 0.534 Test Loss: 1.399 Test Acc: 0.534
Validation loss decreased (-0.480904 --> -0.534337).  Saving model ...
Epoch: 6 cost time: 2.166792154312134
Epoch: 6, Steps: 8 | Train Loss: 0.121 Vali Loss: 1.521 Vali Acc: 0.542 Test Loss: 1.521 Test Acc: 0.542
Validation loss decreased (-0.534337 --> -0.541970).  Saving model ...
Epoch: 7 cost time: 2.1076533794403076
Epoch: 7, Steps: 8 | Train Loss: 0.038 Vali Loss: 1.392 Vali Acc: 0.573 Test Loss: 1.392 Test Acc: 0.573
Validation loss decreased (-0.541970 --> -0.572505).  Saving model ...
Epoch: 8 cost time: 1.7011821269989014
Epoch: 8, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.527 Vali Acc: 0.565 Test Loss: 1.527 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8669917583465576
Epoch: 9, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.707 Vali Acc: 0.542 Test Loss: 1.707 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.6848101615905762
Epoch: 10, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.966 Vali Acc: 0.527 Test Loss: 1.966 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.8779773712158203
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.834 Vali Acc: 0.511 Test Loss: 1.834 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.0783755779266357
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.797 Vali Acc: 0.550 Test Loss: 1.797 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.9532110691070557
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.780 Vali Acc: 0.527 Test Loss: 1.780 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.0126266479492188
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.811 Vali Acc: 0.542 Test Loss: 1.811 Test Acc: 0.542
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.8656058311462402
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.833 Vali Acc: 0.542 Test Loss: 1.833 Test Acc: 0.542
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.9639923572540283
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.809 Vali Acc: 0.542 Test Loss: 1.809 Test Acc: 0.542
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.2958521842956543
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.780 Vali Acc: 0.542 Test Loss: 1.780 Test Acc: 0.542
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps750_str188_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5725190839694656
model parameter : 54241541
model size : 221.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps750_str375_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.2756590843200684
Epoch: 1, Steps: 8 | Train Loss: 1.542 Vali Loss: 1.606 Vali Acc: 0.420 Test Loss: 1.606 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 1.6805603504180908
Epoch: 2, Steps: 8 | Train Loss: 1.400 Vali Loss: 1.567 Vali Acc: 0.435 Test Loss: 1.567 Test Acc: 0.435
Validation loss decreased (-0.419831 --> -0.435099).  Saving model ...
Epoch: 3 cost time: 1.678950309753418
Epoch: 3, Steps: 8 | Train Loss: 1.255 Vali Loss: 1.484 Vali Acc: 0.443 Test Loss: 1.484 Test Acc: 0.443
Validation loss decreased (-0.435099 --> -0.442733).  Saving model ...
Epoch: 4 cost time: 1.824521541595459
Epoch: 4, Steps: 8 | Train Loss: 1.001 Vali Loss: 1.382 Vali Acc: 0.435 Test Loss: 1.382 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6867961883544922
Epoch: 5, Steps: 8 | Train Loss: 0.670 Vali Loss: 1.370 Vali Acc: 0.527 Test Loss: 1.370 Test Acc: 0.527
Validation loss decreased (-0.442733 --> -0.526704).  Saving model ...
Epoch: 6 cost time: 1.6781315803527832
Epoch: 6, Steps: 8 | Train Loss: 0.344 Vali Loss: 1.304 Vali Acc: 0.489 Test Loss: 1.304 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5679011344909668
Epoch: 7, Steps: 8 | Train Loss: 0.133 Vali Loss: 1.422 Vali Acc: 0.496 Test Loss: 1.422 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.4896354675292969
Epoch: 8, Steps: 8 | Train Loss: 0.048 Vali Loss: 1.368 Vali Acc: 0.496 Test Loss: 1.368 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.2221696376800537
Epoch: 9, Steps: 8 | Train Loss: 0.018 Vali Loss: 1.312 Vali Acc: 0.557 Test Loss: 1.312 Test Acc: 0.557
Validation loss decreased (-0.526704 --> -0.557239).  Saving model ...
Epoch: 10 cost time: 1.35457444190979
Epoch: 10, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.351 Vali Acc: 0.573 Test Loss: 1.351 Test Acc: 0.573
Validation loss decreased (-0.557239 --> -0.572506).  Saving model ...
Epoch: 11 cost time: 1.4102821350097656
Epoch: 11, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.344 Vali Acc: 0.603 Test Loss: 1.344 Test Acc: 0.603
Validation loss decreased (-0.572506 --> -0.603040).  Saving model ...
Epoch: 12 cost time: 1.230177640914917
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.418 Vali Acc: 0.550 Test Loss: 1.418 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3169572353363037
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.479 Vali Acc: 0.550 Test Loss: 1.479 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.3617503643035889
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.500 Vali Acc: 0.550 Test Loss: 1.500 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.3860020637512207
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.474 Vali Acc: 0.565 Test Loss: 1.474 Test Acc: 0.565
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.2358975410461426
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.465 Vali Acc: 0.565 Test Loss: 1.465 Test Acc: 0.565
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.2754499912261963
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.464 Vali Acc: 0.565 Test Loss: 1.464 Test Acc: 0.565
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.7410485744476318
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.469 Vali Acc: 0.557 Test Loss: 1.469 Test Acc: 0.557
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.3832495212554932
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.483 Vali Acc: 0.565 Test Loss: 1.483 Test Acc: 0.565
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.4881534576416016
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.505 Vali Acc: 0.573 Test Loss: 1.505 Test Acc: 0.573
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.2563629150390625
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.520 Vali Acc: 0.580 Test Loss: 1.520 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps750_str375_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6030534351145038
model parameter : 53994245
model size : 220.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps750_str750_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.1702115535736084
Epoch: 1, Steps: 8 | Train Loss: 1.562 Vali Loss: 1.634 Vali Acc: 0.420 Test Loss: 1.634 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 1.3402550220489502
Epoch: 2, Steps: 8 | Train Loss: 1.399 Vali Loss: 1.487 Vali Acc: 0.435 Test Loss: 1.487 Test Acc: 0.435
Validation loss decreased (-0.419831 --> -0.435100).  Saving model ...
Epoch: 3 cost time: 1.59267258644104
Epoch: 3, Steps: 8 | Train Loss: 1.232 Vali Loss: 1.408 Vali Acc: 0.481 Test Loss: 1.408 Test Acc: 0.481
Validation loss decreased (-0.435100 --> -0.480902).  Saving model ...
Epoch: 4 cost time: 1.1550474166870117
Epoch: 4, Steps: 8 | Train Loss: 0.914 Vali Loss: 1.292 Vali Acc: 0.511 Test Loss: 1.292 Test Acc: 0.511
Validation loss decreased (-0.480902 --> -0.511437).  Saving model ...
Epoch: 5 cost time: 1.0098607540130615
Epoch: 5, Steps: 8 | Train Loss: 0.610 Vali Loss: 1.272 Vali Acc: 0.504 Test Loss: 1.272 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.352015495300293
Epoch: 6, Steps: 8 | Train Loss: 0.354 Vali Loss: 1.210 Vali Acc: 0.519 Test Loss: 1.210 Test Acc: 0.519
Validation loss decreased (-0.511437 --> -0.519072).  Saving model ...
Epoch: 7 cost time: 1.3195397853851318
Epoch: 7, Steps: 8 | Train Loss: 0.161 Vali Loss: 1.286 Vali Acc: 0.527 Test Loss: 1.286 Test Acc: 0.527
Validation loss decreased (-0.519072 --> -0.526705).  Saving model ...
Epoch: 8 cost time: 1.399123191833496
Epoch: 8, Steps: 8 | Train Loss: 0.060 Vali Loss: 1.320 Vali Acc: 0.511 Test Loss: 1.320 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.678161382675171
Epoch: 9, Steps: 8 | Train Loss: 0.026 Vali Loss: 1.464 Vali Acc: 0.519 Test Loss: 1.464 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.6020541191101074
Epoch: 10, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.449 Vali Acc: 0.527 Test Loss: 1.449 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.4867606163024902
Epoch: 11, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.560 Vali Acc: 0.542 Test Loss: 1.560 Test Acc: 0.542
Validation loss decreased (-0.526705 --> -0.541969).  Saving model ...
Epoch: 12 cost time: 1.316857099533081
Epoch: 12, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.689 Vali Acc: 0.542 Test Loss: 1.689 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.27156400680542
Epoch: 13, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.654 Vali Acc: 0.527 Test Loss: 1.654 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.2887909412384033
Epoch: 14, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.666 Vali Acc: 0.519 Test Loss: 1.666 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.3188929557800293
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.715 Vali Acc: 0.542 Test Loss: 1.715 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.3585448265075684
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.733 Vali Acc: 0.550 Test Loss: 1.733 Test Acc: 0.550
Validation loss decreased (-0.541969 --> -0.549601).  Saving model ...
Epoch: 17 cost time: 1.1560049057006836
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.725 Vali Acc: 0.550 Test Loss: 1.725 Test Acc: 0.550
Validation loss decreased (-0.549601 --> -0.549601).  Saving model ...
Epoch: 18 cost time: 1.25822114944458
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.707 Vali Acc: 0.542 Test Loss: 1.707 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.3692526817321777
Epoch: 19, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.690 Vali Acc: 0.527 Test Loss: 1.690 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.1912977695465088
Epoch: 20, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.695 Vali Acc: 0.527 Test Loss: 1.695 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.1444978713989258
Epoch: 21, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.714 Vali Acc: 0.527 Test Loss: 1.714 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.2408690452575684
Epoch: 22, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.724 Vali Acc: 0.527 Test Loss: 1.724 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.2050182819366455
Epoch: 23, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.732 Vali Acc: 0.519 Test Loss: 1.732 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.3696911334991455
Epoch: 24, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.739 Vali Acc: 0.519 Test Loss: 1.739 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.1501567363739014
Epoch: 25, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.741 Vali Acc: 0.519 Test Loss: 1.741 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.310267686843872
Epoch: 26, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.754 Vali Acc: 0.519 Test Loss: 1.754 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.0120773315429688
Epoch: 27, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.772 Vali Acc: 0.519 Test Loss: 1.772 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps750_str750_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 53870597
model size : 220.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps782_str196_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.589102268218994
Epoch: 1, Steps: 8 | Train Loss: 1.550 Vali Loss: 1.610 Vali Acc: 0.420 Test Loss: 1.610 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 2.308222770690918
Epoch: 2, Steps: 8 | Train Loss: 1.482 Vali Loss: 1.480 Vali Acc: 0.427 Test Loss: 1.480 Test Acc: 0.427
Validation loss decreased (-0.419831 --> -0.427466).  Saving model ...
Epoch: 3 cost time: 2.214756727218628
Epoch: 3, Steps: 8 | Train Loss: 1.264 Vali Loss: 1.474 Vali Acc: 0.466 Test Loss: 1.474 Test Acc: 0.466
Validation loss decreased (-0.427466 --> -0.465634).  Saving model ...
Epoch: 4 cost time: 1.8313734531402588
Epoch: 4, Steps: 8 | Train Loss: 0.943 Vali Loss: 1.512 Vali Acc: 0.450 Test Loss: 1.512 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7809345722198486
Epoch: 5, Steps: 8 | Train Loss: 0.503 Vali Loss: 1.310 Vali Acc: 0.450 Test Loss: 1.310 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.9761440753936768
Epoch: 6, Steps: 8 | Train Loss: 0.164 Vali Loss: 1.515 Vali Acc: 0.527 Test Loss: 1.515 Test Acc: 0.527
Validation loss decreased (-0.465634 --> -0.526702).  Saving model ...
Epoch: 7 cost time: 1.429062843322754
Epoch: 7, Steps: 8 | Train Loss: 0.051 Vali Loss: 1.644 Vali Acc: 0.534 Test Loss: 1.644 Test Acc: 0.534
Validation loss decreased (-0.526702 --> -0.534335).  Saving model ...
Epoch: 8 cost time: 1.5067720413208008
Epoch: 8, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.637 Vali Acc: 0.473 Test Loss: 1.637 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6081361770629883
Epoch: 9, Steps: 8 | Train Loss: 0.042 Vali Loss: 1.802 Vali Acc: 0.542 Test Loss: 1.802 Test Acc: 0.542
Validation loss decreased (-0.534335 --> -0.541967).  Saving model ...
Epoch: 10 cost time: 1.376603364944458
Epoch: 10, Steps: 8 | Train Loss: 0.006 Vali Loss: 2.291 Vali Acc: 0.534 Test Loss: 2.291 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.361426830291748
Epoch: 11, Steps: 8 | Train Loss: 0.003 Vali Loss: 2.234 Vali Acc: 0.519 Test Loss: 2.234 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.4117157459259033
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.985 Vali Acc: 0.534 Test Loss: 1.985 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.496060848236084
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.949 Vali Acc: 0.481 Test Loss: 1.949 Test Acc: 0.481
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.5174028873443604
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.975 Vali Acc: 0.496 Test Loss: 1.975 Test Acc: 0.496
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.4515836238861084
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.986 Vali Acc: 0.504 Test Loss: 1.986 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.6148583889007568
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.971 Vali Acc: 0.504 Test Loss: 1.971 Test Acc: 0.504
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.4457900524139404
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.977 Vali Acc: 0.504 Test Loss: 1.977 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.5821607112884521
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.988 Vali Acc: 0.504 Test Loss: 1.988 Test Acc: 0.504
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.1709809303283691
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.000 Vali Acc: 0.504 Test Loss: 2.000 Test Acc: 0.504
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps782_str196_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 54662405
model size : 223.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps782_str391_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.814018726348877
Epoch: 1, Steps: 8 | Train Loss: 1.571 Vali Loss: 1.646 Vali Acc: 0.427 Test Loss: 1.646 Test Acc: 0.427
Validation loss decreased (inf --> -0.427464).  Saving model ...
Epoch: 2 cost time: 1.1412358283996582
Epoch: 2, Steps: 8 | Train Loss: 1.415 Vali Loss: 1.550 Vali Acc: 0.420 Test Loss: 1.550 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0898783206939697
Epoch: 3, Steps: 8 | Train Loss: 1.240 Vali Loss: 1.437 Vali Acc: 0.489 Test Loss: 1.437 Test Acc: 0.489
Validation loss decreased (-0.427464 --> -0.488535).  Saving model ...
Epoch: 4 cost time: 0.9468042850494385
Epoch: 4, Steps: 8 | Train Loss: 0.941 Vali Loss: 1.470 Vali Acc: 0.473 Test Loss: 1.470 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8541622161865234
Epoch: 5, Steps: 8 | Train Loss: 0.649 Vali Loss: 1.301 Vali Acc: 0.519 Test Loss: 1.301 Test Acc: 0.519
Validation loss decreased (-0.488535 --> -0.519071).  Saving model ...
Epoch: 6 cost time: 1.6763982772827148
Epoch: 6, Steps: 8 | Train Loss: 0.303 Vali Loss: 1.473 Vali Acc: 0.504 Test Loss: 1.473 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.181811809539795
Epoch: 7, Steps: 8 | Train Loss: 0.110 Vali Loss: 1.488 Vali Acc: 0.504 Test Loss: 1.488 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9746596813201904
Epoch: 8, Steps: 8 | Train Loss: 0.037 Vali Loss: 1.658 Vali Acc: 0.550 Test Loss: 1.658 Test Acc: 0.550
Validation loss decreased (-0.519071 --> -0.549602).  Saving model ...
Epoch: 9 cost time: 1.3435659408569336
Epoch: 9, Steps: 8 | Train Loss: 0.024 Vali Loss: 1.793 Vali Acc: 0.519 Test Loss: 1.793 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2912745475769043
Epoch: 10, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.974 Vali Acc: 0.489 Test Loss: 1.974 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.4828462600708008
Epoch: 11, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.909 Vali Acc: 0.504 Test Loss: 1.909 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.4065337181091309
Epoch: 12, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.925 Vali Acc: 0.557 Test Loss: 1.925 Test Acc: 0.557
Validation loss decreased (-0.549602 --> -0.557233).  Saving model ...
Epoch: 13 cost time: 1.915390968322754
Epoch: 13, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.842 Vali Acc: 0.534 Test Loss: 1.842 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.5882391929626465
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.806 Vali Acc: 0.542 Test Loss: 1.806 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.3435702323913574
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.900 Vali Acc: 0.557 Test Loss: 1.900 Test Acc: 0.557
Validation loss decreased (-0.557233 --> -0.557233).  Saving model ...
Epoch: 16 cost time: 1.6610674858093262
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.940 Vali Acc: 0.550 Test Loss: 1.940 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.275667667388916
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.956 Vali Acc: 0.550 Test Loss: 1.956 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.5261549949645996
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.975 Vali Acc: 0.557 Test Loss: 1.975 Test Acc: 0.557
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.7217023372650146
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.988 Vali Acc: 0.557 Test Loss: 1.988 Test Acc: 0.557
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.4989302158355713
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.990 Vali Acc: 0.557 Test Loss: 1.990 Test Acc: 0.557
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.8791043758392334
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.994 Vali Acc: 0.550 Test Loss: 1.994 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.5171048641204834
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.997 Vali Acc: 0.550 Test Loss: 1.997 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.510404109954834
Epoch: 23, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.000 Vali Acc: 0.557 Test Loss: 2.000 Test Acc: 0.557
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.0889573097229004
Epoch: 24, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.005 Vali Acc: 0.557 Test Loss: 2.005 Test Acc: 0.557
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.263369083404541
Epoch: 25, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.012 Vali Acc: 0.557 Test Loss: 2.012 Test Acc: 0.557
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps782_str391_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 54425861
model size : 222.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps782_str782_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.7513911724090576
Epoch: 1, Steps: 8 | Train Loss: 1.551 Vali Loss: 1.588 Vali Acc: 0.420 Test Loss: 1.588 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 1.214468002319336
Epoch: 2, Steps: 8 | Train Loss: 1.399 Vali Loss: 1.520 Vali Acc: 0.420 Test Loss: 1.520 Test Acc: 0.420
Validation loss decreased (-0.419831 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 1.2318549156188965
Epoch: 3, Steps: 8 | Train Loss: 1.209 Vali Loss: 1.494 Vali Acc: 0.496 Test Loss: 1.494 Test Acc: 0.496
Validation loss decreased (-0.419832 --> -0.496168).  Saving model ...
Epoch: 4 cost time: 1.5354595184326172
Epoch: 4, Steps: 8 | Train Loss: 0.926 Vali Loss: 1.463 Vali Acc: 0.443 Test Loss: 1.463 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0376296043395996
Epoch: 5, Steps: 8 | Train Loss: 0.645 Vali Loss: 1.384 Vali Acc: 0.496 Test Loss: 1.384 Test Acc: 0.496
Validation loss decreased (-0.496168 --> -0.496169).  Saving model ...
Epoch: 6 cost time: 1.109212875366211
Epoch: 6, Steps: 8 | Train Loss: 0.376 Vali Loss: 1.409 Vali Acc: 0.450 Test Loss: 1.409 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2141757011413574
Epoch: 7, Steps: 8 | Train Loss: 0.174 Vali Loss: 1.420 Vali Acc: 0.527 Test Loss: 1.420 Test Acc: 0.527
Validation loss decreased (-0.496169 --> -0.526703).  Saving model ...
Epoch: 8 cost time: 1.3441956043243408
Epoch: 8, Steps: 8 | Train Loss: 0.065 Vali Loss: 1.536 Vali Acc: 0.519 Test Loss: 1.536 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9855737686157227
Epoch: 9, Steps: 8 | Train Loss: 0.034 Vali Loss: 1.629 Vali Acc: 0.481 Test Loss: 1.629 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.4805243015289307
Epoch: 10, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.824 Vali Acc: 0.473 Test Loss: 1.824 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.2512967586517334
Epoch: 11, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.837 Vali Acc: 0.466 Test Loss: 1.837 Test Acc: 0.466
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.4883003234863281
Epoch: 12, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.793 Vali Acc: 0.466 Test Loss: 1.793 Test Acc: 0.466
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.9801599979400635
Epoch: 13, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.811 Vali Acc: 0.504 Test Loss: 1.811 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.0443637371063232
Epoch: 14, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.857 Vali Acc: 0.481 Test Loss: 1.857 Test Acc: 0.481
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.1836657524108887
Epoch: 15, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.863 Vali Acc: 0.466 Test Loss: 1.863 Test Acc: 0.466
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.1906490325927734
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.864 Vali Acc: 0.466 Test Loss: 1.864 Test Acc: 0.466
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.188236951828003
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.865 Vali Acc: 0.473 Test Loss: 1.865 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps782_str782_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 54307589
model size : 221.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps818_str205_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.639345645904541
Epoch: 1, Steps: 8 | Train Loss: 1.580 Vali Loss: 1.602 Vali Acc: 0.420 Test Loss: 1.602 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 1.604034185409546
Epoch: 2, Steps: 8 | Train Loss: 1.429 Vali Loss: 1.561 Vali Acc: 0.427 Test Loss: 1.561 Test Acc: 0.427
Validation loss decreased (-0.419831 --> -0.427465).  Saving model ...
Epoch: 3 cost time: 1.2992489337921143
Epoch: 3, Steps: 8 | Train Loss: 1.078 Vali Loss: 1.463 Vali Acc: 0.458 Test Loss: 1.463 Test Acc: 0.458
Validation loss decreased (-0.427465 --> -0.458001).  Saving model ...
Epoch: 4 cost time: 1.6815402507781982
Epoch: 4, Steps: 8 | Train Loss: 0.771 Vali Loss: 1.411 Vali Acc: 0.450 Test Loss: 1.411 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.364647388458252
Epoch: 5, Steps: 8 | Train Loss: 0.382 Vali Loss: 1.497 Vali Acc: 0.435 Test Loss: 1.497 Test Acc: 0.435
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.902784824371338
Epoch: 6, Steps: 8 | Train Loss: 0.169 Vali Loss: 1.625 Vali Acc: 0.542 Test Loss: 1.625 Test Acc: 0.542
Validation loss decreased (-0.458001 --> -0.541968).  Saving model ...
Epoch: 7 cost time: 1.8430085182189941
Epoch: 7, Steps: 8 | Train Loss: 0.037 Vali Loss: 1.871 Vali Acc: 0.534 Test Loss: 1.871 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8237464427947998
Epoch: 8, Steps: 8 | Train Loss: 0.034 Vali Loss: 1.756 Vali Acc: 0.519 Test Loss: 1.756 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.4494364261627197
Epoch: 9, Steps: 8 | Train Loss: 0.016 Vali Loss: 2.134 Vali Acc: 0.542 Test Loss: 2.134 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.42191743850708
Epoch: 10, Steps: 8 | Train Loss: 0.020 Vali Loss: 1.899 Vali Acc: 0.473 Test Loss: 1.899 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.6914958953857422
Epoch: 11, Steps: 8 | Train Loss: 0.025 Vali Loss: 2.387 Vali Acc: 0.534 Test Loss: 2.387 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.7161166667938232
Epoch: 12, Steps: 8 | Train Loss: 0.025 Vali Loss: 2.295 Vali Acc: 0.489 Test Loss: 2.295 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.9731037616729736
Epoch: 13, Steps: 8 | Train Loss: 0.015 Vali Loss: 2.508 Vali Acc: 0.580 Test Loss: 2.508 Test Acc: 0.580
Validation loss decreased (-0.541968 --> -0.580128).  Saving model ...
Epoch: 14 cost time: 1.8064653873443604
Epoch: 14, Steps: 8 | Train Loss: 0.006 Vali Loss: 2.153 Vali Acc: 0.542 Test Loss: 2.153 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.5080506801605225
Epoch: 15, Steps: 8 | Train Loss: 0.004 Vali Loss: 2.403 Vali Acc: 0.458 Test Loss: 2.403 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.6293728351593018
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.425 Vali Acc: 0.542 Test Loss: 2.425 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.367591381072998
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.673 Vali Acc: 0.565 Test Loss: 2.673 Test Acc: 0.565
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.968118667602539
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.571 Vali Acc: 0.542 Test Loss: 2.571 Test Acc: 0.542
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.616706371307373
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.502 Vali Acc: 0.511 Test Loss: 2.502 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.6430621147155762
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.462 Vali Acc: 0.527 Test Loss: 2.462 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.8332107067108154
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.439 Vali Acc: 0.519 Test Loss: 2.439 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.4469919204711914
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.435 Vali Acc: 0.527 Test Loss: 2.435 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.3152143955230713
Epoch: 23, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.442 Vali Acc: 0.527 Test Loss: 2.442 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps818_str205_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5801526717557252
model parameter : 55138565
model size : 225.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps818_str409_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.5230181217193604
Epoch: 1, Steps: 8 | Train Loss: 1.526 Vali Loss: 1.590 Vali Acc: 0.420 Test Loss: 1.590 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 1.5644636154174805
Epoch: 2, Steps: 8 | Train Loss: 1.419 Vali Loss: 1.539 Vali Acc: 0.420 Test Loss: 1.539 Test Acc: 0.420
Validation loss decreased (-0.419831 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 1.454340934753418
Epoch: 3, Steps: 8 | Train Loss: 1.125 Vali Loss: 1.317 Vali Acc: 0.534 Test Loss: 1.317 Test Acc: 0.534
Validation loss decreased (-0.419832 --> -0.534338).  Saving model ...
Epoch: 4 cost time: 1.368485689163208
Epoch: 4, Steps: 8 | Train Loss: 0.791 Vali Loss: 1.267 Vali Acc: 0.550 Test Loss: 1.267 Test Acc: 0.550
Validation loss decreased (-0.534338 --> -0.549606).  Saving model ...
Epoch: 5 cost time: 1.5312278270721436
Epoch: 5, Steps: 8 | Train Loss: 0.461 Vali Loss: 1.229 Vali Acc: 0.496 Test Loss: 1.229 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2678823471069336
Epoch: 6, Steps: 8 | Train Loss: 0.219 Vali Loss: 1.365 Vali Acc: 0.511 Test Loss: 1.365 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.3299388885498047
Epoch: 7, Steps: 8 | Train Loss: 0.073 Vali Loss: 1.277 Vali Acc: 0.565 Test Loss: 1.277 Test Acc: 0.565
Validation loss decreased (-0.549606 --> -0.564873).  Saving model ...
Epoch: 8 cost time: 1.7091457843780518
Epoch: 8, Steps: 8 | Train Loss: 0.036 Vali Loss: 1.381 Vali Acc: 0.489 Test Loss: 1.381 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.594785451889038
Epoch: 9, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.543 Vali Acc: 0.527 Test Loss: 1.543 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.7363858222961426
Epoch: 10, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.522 Vali Acc: 0.534 Test Loss: 1.522 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.8233702182769775
Epoch: 11, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.521 Vali Acc: 0.527 Test Loss: 1.521 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.6196091175079346
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.583 Vali Acc: 0.504 Test Loss: 1.583 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.8194310665130615
Epoch: 13, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.699 Vali Acc: 0.511 Test Loss: 1.699 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.2044804096221924
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.639 Vali Acc: 0.496 Test Loss: 1.639 Test Acc: 0.496
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.2263379096984863
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.592 Vali Acc: 0.511 Test Loss: 1.592 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.5873563289642334
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.580 Vali Acc: 0.496 Test Loss: 1.580 Test Acc: 0.496
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.5620996952056885
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.585 Vali Acc: 0.496 Test Loss: 1.585 Test Acc: 0.496
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps818_str409_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5648854961832062
model parameter : 54912773
model size : 224.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps818_str818_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.5760583877563477
Epoch: 1, Steps: 8 | Train Loss: 1.531 Vali Loss: 1.515 Vali Acc: 0.420 Test Loss: 1.515 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 1.2810947895050049
Epoch: 2, Steps: 8 | Train Loss: 1.392 Vali Loss: 1.521 Vali Acc: 0.458 Test Loss: 1.521 Test Acc: 0.458
Validation loss decreased (-0.419832 --> -0.458000).  Saving model ...
Epoch: 3 cost time: 1.4343070983886719
Epoch: 3, Steps: 8 | Train Loss: 1.153 Vali Loss: 1.380 Vali Acc: 0.504 Test Loss: 1.380 Test Acc: 0.504
Validation loss decreased (-0.458000 --> -0.503803).  Saving model ...
Epoch: 4 cost time: 1.0888102054595947
Epoch: 4, Steps: 8 | Train Loss: 0.848 Vali Loss: 1.247 Vali Acc: 0.557 Test Loss: 1.247 Test Acc: 0.557
Validation loss decreased (-0.503803 --> -0.557239).  Saving model ...
Epoch: 5 cost time: 1.126068115234375
Epoch: 5, Steps: 8 | Train Loss: 0.581 Vali Loss: 1.209 Vali Acc: 0.550 Test Loss: 1.209 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1912667751312256
Epoch: 6, Steps: 8 | Train Loss: 0.323 Vali Loss: 1.242 Vali Acc: 0.534 Test Loss: 1.242 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.327134609222412
Epoch: 7, Steps: 8 | Train Loss: 0.144 Vali Loss: 1.364 Vali Acc: 0.519 Test Loss: 1.364 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.1638050079345703
Epoch: 8, Steps: 8 | Train Loss: 0.051 Vali Loss: 1.506 Vali Acc: 0.504 Test Loss: 1.506 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.103633165359497
Epoch: 9, Steps: 8 | Train Loss: 0.019 Vali Loss: 1.677 Vali Acc: 0.534 Test Loss: 1.677 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.1542816162109375
Epoch: 10, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.535 Vali Acc: 0.504 Test Loss: 1.535 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.2048916816711426
Epoch: 11, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.639 Vali Acc: 0.534 Test Loss: 1.639 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.225715160369873
Epoch: 12, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.676 Vali Acc: 0.511 Test Loss: 1.676 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.2804522514343262
Epoch: 13, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.668 Vali Acc: 0.534 Test Loss: 1.668 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.0739355087280273
Epoch: 14, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.667 Vali Acc: 0.519 Test Loss: 1.667 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps818_str818_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 54799877
model size : 223.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps857_str215_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.3278067111968994
Epoch: 1, Steps: 8 | Train Loss: 1.546 Vali Loss: 1.743 Vali Acc: 0.420 Test Loss: 1.743 Test Acc: 0.420
Validation loss decreased (inf --> -0.419830).  Saving model ...
Epoch: 2 cost time: 1.4894263744354248
Epoch: 2, Steps: 8 | Train Loss: 1.503 Vali Loss: 1.672 Vali Acc: 0.214 Test Loss: 1.672 Test Acc: 0.214
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.63753080368042
Epoch: 3, Steps: 8 | Train Loss: 1.221 Vali Loss: 1.589 Vali Acc: 0.420 Test Loss: 1.589 Test Acc: 0.420
Validation loss decreased (-0.419830 --> -0.419831).  Saving model ...
Epoch: 4 cost time: 1.6991515159606934
Epoch: 4, Steps: 8 | Train Loss: 0.904 Vali Loss: 1.412 Vali Acc: 0.450 Test Loss: 1.412 Test Acc: 0.450
Validation loss decreased (-0.419831 --> -0.450368).  Saving model ...
Epoch: 5 cost time: 1.1181259155273438
Epoch: 5, Steps: 8 | Train Loss: 0.536 Vali Loss: 1.503 Vali Acc: 0.473 Test Loss: 1.503 Test Acc: 0.473
Validation loss decreased (-0.450368 --> -0.473267).  Saving model ...
Epoch: 6 cost time: 1.8234834671020508
Epoch: 6, Steps: 8 | Train Loss: 0.171 Vali Loss: 1.515 Vali Acc: 0.435 Test Loss: 1.515 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.874138355255127
Epoch: 7, Steps: 8 | Train Loss: 0.094 Vali Loss: 1.442 Vali Acc: 0.511 Test Loss: 1.442 Test Acc: 0.511
Validation loss decreased (-0.473267 --> -0.511436).  Saving model ...
Epoch: 8 cost time: 1.818662405014038
Epoch: 8, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.778 Vali Acc: 0.519 Test Loss: 1.778 Test Acc: 0.519
Validation loss decreased (-0.511436 --> -0.519066).  Saving model ...
Epoch: 9 cost time: 1.5862176418304443
Epoch: 9, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.639 Vali Acc: 0.595 Test Loss: 1.639 Test Acc: 0.595
Validation loss decreased (-0.519066 --> -0.595403).  Saving model ...
Epoch: 10 cost time: 1.436145305633545
Epoch: 10, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.591 Vali Acc: 0.580 Test Loss: 1.591 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.9994659423828125
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.679 Vali Acc: 0.557 Test Loss: 1.679 Test Acc: 0.557
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.6040279865264893
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.689 Vali Acc: 0.565 Test Loss: 1.689 Test Acc: 0.565
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.4197990894317627
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.736 Vali Acc: 0.595 Test Loss: 1.736 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.3847320079803467
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.756 Vali Acc: 0.595 Test Loss: 1.756 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.685481309890747
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.767 Vali Acc: 0.595 Test Loss: 1.767 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.65883207321167
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.782 Vali Acc: 0.588 Test Loss: 1.782 Test Acc: 0.588
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.7302391529083252
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.799 Vali Acc: 0.595 Test Loss: 1.799 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.8792531490325928
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.818 Vali Acc: 0.588 Test Loss: 1.818 Test Acc: 0.588
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.9220430850982666
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.823 Vali Acc: 0.588 Test Loss: 1.823 Test Acc: 0.588
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps857_str215_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5954198473282443
model parameter : 55656197
model size : 226.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps857_str429_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.7725963592529297
Epoch: 1, Steps: 8 | Train Loss: 1.647 Vali Loss: 1.611 Vali Acc: 0.420 Test Loss: 1.611 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 1.2065205574035645
Epoch: 2, Steps: 8 | Train Loss: 1.393 Vali Loss: 1.570 Vali Acc: 0.443 Test Loss: 1.570 Test Acc: 0.443
Validation loss decreased (-0.419831 --> -0.442732).  Saving model ...
Epoch: 3 cost time: 1.231548547744751
Epoch: 3, Steps: 8 | Train Loss: 1.170 Vali Loss: 1.512 Vali Acc: 0.450 Test Loss: 1.512 Test Acc: 0.450
Validation loss decreased (-0.442732 --> -0.450367).  Saving model ...
Epoch: 4 cost time: 1.1084613800048828
Epoch: 4, Steps: 8 | Train Loss: 0.881 Vali Loss: 1.475 Vali Acc: 0.458 Test Loss: 1.475 Test Acc: 0.458
Validation loss decreased (-0.450367 --> -0.458001).  Saving model ...
Epoch: 5 cost time: 1.2698156833648682
Epoch: 5, Steps: 8 | Train Loss: 0.585 Vali Loss: 1.404 Vali Acc: 0.511 Test Loss: 1.404 Test Acc: 0.511
Validation loss decreased (-0.458001 --> -0.511436).  Saving model ...
Epoch: 6 cost time: 1.2039384841918945
Epoch: 6, Steps: 8 | Train Loss: 0.262 Vali Loss: 1.443 Vali Acc: 0.427 Test Loss: 1.443 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8721656799316406
Epoch: 7, Steps: 8 | Train Loss: 0.110 Vali Loss: 1.739 Vali Acc: 0.511 Test Loss: 1.739 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.0421233177185059
Epoch: 8, Steps: 8 | Train Loss: 0.046 Vali Loss: 1.661 Vali Acc: 0.458 Test Loss: 1.661 Test Acc: 0.458
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.8562166690826416
Epoch: 9, Steps: 8 | Train Loss: 0.016 Vali Loss: 2.017 Vali Acc: 0.519 Test Loss: 2.017 Test Acc: 0.519
Validation loss decreased (-0.511436 --> -0.519064).  Saving model ...
Epoch: 10 cost time: 1.269688606262207
Epoch: 10, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.720 Vali Acc: 0.473 Test Loss: 1.720 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.852161169052124
Epoch: 11, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.778 Vali Acc: 0.504 Test Loss: 1.778 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1246554851531982
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.959 Vali Acc: 0.550 Test Loss: 1.959 Test Acc: 0.550
Validation loss decreased (-0.519064 --> -0.549599).  Saving model ...
Epoch: 13 cost time: 0.9723212718963623
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.009 Vali Acc: 0.550 Test Loss: 2.009 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.167039155960083
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.980 Vali Acc: 0.542 Test Loss: 1.980 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.0182621479034424
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.944 Vali Acc: 0.557 Test Loss: 1.944 Test Acc: 0.557
Validation loss decreased (-0.549599 --> -0.557232).  Saving model ...
Epoch: 16 cost time: 1.7213466167449951
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.937 Vali Acc: 0.542 Test Loss: 1.937 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2771501541137695
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.944 Vali Acc: 0.542 Test Loss: 1.944 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.2718846797943115
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.969 Vali Acc: 0.542 Test Loss: 1.969 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.4993970394134521
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.020 Vali Acc: 0.550 Test Loss: 2.020 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.2070965766906738
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.058 Vali Acc: 0.557 Test Loss: 2.058 Test Acc: 0.557
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.4387996196746826
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.066 Vali Acc: 0.550 Test Loss: 2.066 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.347820520401001
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.060 Vali Acc: 0.550 Test Loss: 2.060 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.4542953968048096
Epoch: 23, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.055 Vali Acc: 0.550 Test Loss: 2.055 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.9080839157104492
Epoch: 24, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.055 Vali Acc: 0.550 Test Loss: 2.055 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.2820954322814941
Epoch: 25, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.056 Vali Acc: 0.550 Test Loss: 2.056 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps857_str429_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 55441157
model size : 226.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps857_str857_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.210397958755493
Epoch: 1, Steps: 8 | Train Loss: 1.550 Vali Loss: 1.583 Vali Acc: 0.420 Test Loss: 1.583 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 1.6808133125305176
Epoch: 2, Steps: 8 | Train Loss: 1.393 Vali Loss: 1.501 Vali Acc: 0.450 Test Loss: 1.501 Test Acc: 0.450
Validation loss decreased (-0.419832 --> -0.450367).  Saving model ...
Epoch: 3 cost time: 1.4744908809661865
Epoch: 3, Steps: 8 | Train Loss: 1.162 Vali Loss: 1.434 Vali Acc: 0.473 Test Loss: 1.434 Test Acc: 0.473
Validation loss decreased (-0.450367 --> -0.473268).  Saving model ...
Epoch: 4 cost time: 1.3681488037109375
Epoch: 4, Steps: 8 | Train Loss: 0.894 Vali Loss: 1.385 Vali Acc: 0.481 Test Loss: 1.385 Test Acc: 0.481
Validation loss decreased (-0.473268 --> -0.480902).  Saving model ...
Epoch: 5 cost time: 1.5410079956054688
Epoch: 5, Steps: 8 | Train Loss: 0.577 Vali Loss: 1.398 Vali Acc: 0.481 Test Loss: 1.398 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.4554731845855713
Epoch: 6, Steps: 8 | Train Loss: 0.343 Vali Loss: 1.474 Vali Acc: 0.473 Test Loss: 1.474 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.387638807296753
Epoch: 7, Steps: 8 | Train Loss: 0.155 Vali Loss: 1.530 Vali Acc: 0.496 Test Loss: 1.530 Test Acc: 0.496
Validation loss decreased (-0.480902 --> -0.496168).  Saving model ...
Epoch: 8 cost time: 1.4317870140075684
Epoch: 8, Steps: 8 | Train Loss: 0.053 Vali Loss: 1.662 Vali Acc: 0.481 Test Loss: 1.662 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2111575603485107
Epoch: 9, Steps: 8 | Train Loss: 0.021 Vali Loss: 1.650 Vali Acc: 0.473 Test Loss: 1.650 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.319502353668213
Epoch: 10, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.732 Vali Acc: 0.458 Test Loss: 1.732 Test Acc: 0.458
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.4661047458648682
Epoch: 11, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.843 Vali Acc: 0.458 Test Loss: 1.843 Test Acc: 0.458
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.3617291450500488
Epoch: 12, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.955 Vali Acc: 0.496 Test Loss: 1.955 Test Acc: 0.496
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.531792402267456
Epoch: 13, Steps: 8 | Train Loss: 0.003 Vali Loss: 2.004 Vali Acc: 0.496 Test Loss: 2.004 Test Acc: 0.496
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.2294213771820068
Epoch: 14, Steps: 8 | Train Loss: 0.002 Vali Loss: 2.024 Vali Acc: 0.489 Test Loss: 2.024 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.63454008102417
Epoch: 15, Steps: 8 | Train Loss: 0.002 Vali Loss: 2.012 Vali Acc: 0.496 Test Loss: 2.012 Test Acc: 0.496
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.3063738346099854
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.023 Vali Acc: 0.481 Test Loss: 2.023 Test Acc: 0.481
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.1273112297058105
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.025 Vali Acc: 0.466 Test Loss: 2.025 Test Acc: 0.466
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps857_str857_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.4961832061068702
model parameter : 55333637
model size : 225.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps900_str225_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.5765111446380615
Epoch: 1, Steps: 8 | Train Loss: 1.648 Vali Loss: 1.774 Vali Acc: 0.420 Test Loss: 1.774 Test Acc: 0.420
Validation loss decreased (inf --> -0.419830).  Saving model ...
Epoch: 2 cost time: 1.8893518447875977
Epoch: 2, Steps: 8 | Train Loss: 1.469 Vali Loss: 1.495 Vali Acc: 0.443 Test Loss: 1.495 Test Acc: 0.443
Validation loss decreased (-0.419830 --> -0.442733).  Saving model ...
Epoch: 3 cost time: 2.2965238094329834
Epoch: 3, Steps: 8 | Train Loss: 1.188 Vali Loss: 1.480 Vali Acc: 0.450 Test Loss: 1.480 Test Acc: 0.450
Validation loss decreased (-0.442733 --> -0.450367).  Saving model ...
Epoch: 4 cost time: 1.9221484661102295
Epoch: 4, Steps: 8 | Train Loss: 0.820 Vali Loss: 1.501 Vali Acc: 0.466 Test Loss: 1.501 Test Acc: 0.466
Validation loss decreased (-0.450367 --> -0.465634).  Saving model ...
Epoch: 5 cost time: 1.6082398891448975
Epoch: 5, Steps: 8 | Train Loss: 0.442 Vali Loss: 1.444 Vali Acc: 0.397 Test Loss: 1.444 Test Acc: 0.397
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8827059268951416
Epoch: 6, Steps: 8 | Train Loss: 0.134 Vali Loss: 1.588 Vali Acc: 0.473 Test Loss: 1.588 Test Acc: 0.473
Validation loss decreased (-0.465634 --> -0.473267).  Saving model ...
Epoch: 7 cost time: 1.9624509811401367
Epoch: 7, Steps: 8 | Train Loss: 0.030 Vali Loss: 2.349 Vali Acc: 0.573 Test Loss: 2.349 Test Acc: 0.573
Validation loss decreased (-0.473267 --> -0.572496).  Saving model ...
Epoch: 8 cost time: 1.4375331401824951
Epoch: 8, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.872 Vali Acc: 0.496 Test Loss: 1.872 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.642395257949829
Epoch: 9, Steps: 8 | Train Loss: 0.008 Vali Loss: 2.173 Vali Acc: 0.565 Test Loss: 2.173 Test Acc: 0.565
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.5730688571929932
Epoch: 10, Steps: 8 | Train Loss: 0.002 Vali Loss: 2.270 Vali Acc: 0.565 Test Loss: 2.270 Test Acc: 0.565
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.4756224155426025
Epoch: 11, Steps: 8 | Train Loss: 0.003 Vali Loss: 2.358 Vali Acc: 0.550 Test Loss: 2.358 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.6947777271270752
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.528 Vali Acc: 0.565 Test Loss: 2.528 Test Acc: 0.565
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.9475750923156738
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.354 Vali Acc: 0.542 Test Loss: 2.354 Test Acc: 0.542
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.8418042659759521
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.403 Vali Acc: 0.489 Test Loss: 2.403 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.8293342590332031
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.494 Vali Acc: 0.481 Test Loss: 2.494 Test Acc: 0.481
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.862288475036621
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.645 Vali Acc: 0.496 Test Loss: 2.645 Test Acc: 0.496
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.8442034721374512
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.704 Vali Acc: 0.527 Test Loss: 2.704 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps900_str225_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5725190839694656
model parameter : 56229125
model size : 229.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps900_str450_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.8135969638824463
Epoch: 1, Steps: 8 | Train Loss: 1.541 Vali Loss: 1.688 Vali Acc: 0.420 Test Loss: 1.688 Test Acc: 0.420
Validation loss decreased (inf --> -0.419830).  Saving model ...
Epoch: 2 cost time: 1.1608777046203613
Epoch: 2, Steps: 8 | Train Loss: 1.392 Vali Loss: 1.496 Vali Acc: 0.458 Test Loss: 1.496 Test Acc: 0.458
Validation loss decreased (-0.419830 --> -0.458000).  Saving model ...
Epoch: 3 cost time: 1.2378783226013184
Epoch: 3, Steps: 8 | Train Loss: 1.125 Vali Loss: 1.397 Vali Acc: 0.511 Test Loss: 1.397 Test Acc: 0.511
Validation loss decreased (-0.458000 --> -0.511436).  Saving model ...
Epoch: 4 cost time: 0.8867473602294922
Epoch: 4, Steps: 8 | Train Loss: 0.776 Vali Loss: 1.367 Vali Acc: 0.511 Test Loss: 1.367 Test Acc: 0.511
Validation loss decreased (-0.511436 --> -0.511437).  Saving model ...
Epoch: 5 cost time: 1.4725267887115479
Epoch: 5, Steps: 8 | Train Loss: 0.410 Vali Loss: 1.352 Vali Acc: 0.511 Test Loss: 1.352 Test Acc: 0.511
Validation loss decreased (-0.511437 --> -0.511437).  Saving model ...
Epoch: 6 cost time: 1.2149555683135986
Epoch: 6, Steps: 8 | Train Loss: 0.198 Vali Loss: 1.401 Vali Acc: 0.550 Test Loss: 1.401 Test Acc: 0.550
Validation loss decreased (-0.511437 --> -0.549604).  Saving model ...
Epoch: 7 cost time: 1.4679172039031982
Epoch: 7, Steps: 8 | Train Loss: 0.066 Vali Loss: 1.586 Vali Acc: 0.527 Test Loss: 1.586 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0863261222839355
Epoch: 8, Steps: 8 | Train Loss: 0.026 Vali Loss: 1.451 Vali Acc: 0.534 Test Loss: 1.451 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.281137466430664
Epoch: 9, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.694 Vali Acc: 0.534 Test Loss: 1.694 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.4267470836639404
Epoch: 10, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.715 Vali Acc: 0.519 Test Loss: 1.715 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.1333301067352295
Epoch: 11, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.726 Vali Acc: 0.534 Test Loss: 1.726 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.1878373622894287
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.769 Vali Acc: 0.557 Test Loss: 1.769 Test Acc: 0.557
Validation loss decreased (-0.549604 --> -0.557234).  Saving model ...
Epoch: 13 cost time: 1.586007833480835
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.782 Vali Acc: 0.550 Test Loss: 1.782 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.290886640548706
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.808 Vali Acc: 0.534 Test Loss: 1.808 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.4123573303222656
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.811 Vali Acc: 0.534 Test Loss: 1.811 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.3763465881347656
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.804 Vali Acc: 0.527 Test Loss: 1.804 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.4229950904846191
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.818 Vali Acc: 0.527 Test Loss: 1.818 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.5304124355316162
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.826 Vali Acc: 0.534 Test Loss: 1.826 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.1017615795135498
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.835 Vali Acc: 0.534 Test Loss: 1.835 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.1140739917755127
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.853 Vali Acc: 0.534 Test Loss: 1.853 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.2978131771087646
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.869 Vali Acc: 0.534 Test Loss: 1.869 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.5304787158966064
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.884 Vali Acc: 0.534 Test Loss: 1.884 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps900_str450_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 56024837
model size : 228.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps900_str900_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.9973957538604736
Epoch: 1, Steps: 8 | Train Loss: 1.534 Vali Loss: 1.547 Vali Acc: 0.420 Test Loss: 1.547 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 1.1467416286468506
Epoch: 2, Steps: 8 | Train Loss: 1.378 Vali Loss: 1.553 Vali Acc: 0.435 Test Loss: 1.553 Test Acc: 0.435
Validation loss decreased (-0.419832 --> -0.435099).  Saving model ...
Epoch: 3 cost time: 1.2859745025634766
Epoch: 3, Steps: 8 | Train Loss: 1.137 Vali Loss: 1.509 Vali Acc: 0.466 Test Loss: 1.509 Test Acc: 0.466
Validation loss decreased (-0.435099 --> -0.465634).  Saving model ...
Epoch: 4 cost time: 1.2928216457366943
Epoch: 4, Steps: 8 | Train Loss: 0.830 Vali Loss: 1.500 Vali Acc: 0.481 Test Loss: 1.500 Test Acc: 0.481
Validation loss decreased (-0.465634 --> -0.480901).  Saving model ...
Epoch: 5 cost time: 1.6316916942596436
Epoch: 5, Steps: 8 | Train Loss: 0.541 Vali Loss: 1.357 Vali Acc: 0.557 Test Loss: 1.357 Test Acc: 0.557
Validation loss decreased (-0.480901 --> -0.557238).  Saving model ...
Epoch: 6 cost time: 1.465980052947998
Epoch: 6, Steps: 8 | Train Loss: 0.251 Vali Loss: 1.516 Vali Acc: 0.534 Test Loss: 1.516 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2294001579284668
Epoch: 7, Steps: 8 | Train Loss: 0.104 Vali Loss: 1.490 Vali Acc: 0.542 Test Loss: 1.490 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9397408962249756
Epoch: 8, Steps: 8 | Train Loss: 0.038 Vali Loss: 1.533 Vali Acc: 0.595 Test Loss: 1.533 Test Acc: 0.595
Validation loss decreased (-0.557238 --> -0.595405).  Saving model ...
Epoch: 9 cost time: 1.2751414775848389
Epoch: 9, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.532 Vali Acc: 0.595 Test Loss: 1.532 Test Acc: 0.595
Validation loss decreased (-0.595405 --> -0.595405).  Saving model ...
Epoch: 10 cost time: 1.1810657978057861
Epoch: 10, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.532 Vali Acc: 0.550 Test Loss: 1.532 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.252333402633667
Epoch: 11, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.511 Vali Acc: 0.550 Test Loss: 1.511 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.2157654762268066
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.545 Vali Acc: 0.580 Test Loss: 1.545 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.0338490009307861
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.602 Vali Acc: 0.580 Test Loss: 1.602 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.216271162033081
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.655 Vali Acc: 0.588 Test Loss: 1.655 Test Acc: 0.588
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.3793675899505615
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.686 Vali Acc: 0.573 Test Loss: 1.686 Test Acc: 0.573
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.0105464458465576
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.706 Vali Acc: 0.573 Test Loss: 1.706 Test Acc: 0.573
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.7583029270172119
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.708 Vali Acc: 0.573 Test Loss: 1.708 Test Acc: 0.573
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.1625006198883057
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.710 Vali Acc: 0.573 Test Loss: 1.710 Test Acc: 0.573
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.9276151657104492
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.725 Vali Acc: 0.573 Test Loss: 1.725 Test Acc: 0.573
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps900_str900_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5954198473282443
model parameter : 55922693
model size : 228.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps947_str237_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.6677582263946533
Epoch: 1, Steps: 8 | Train Loss: 1.619 Vali Loss: 1.720 Vali Acc: 0.420 Test Loss: 1.720 Test Acc: 0.420
Validation loss decreased (inf --> -0.419830).  Saving model ...
Epoch: 2 cost time: 1.3885107040405273
Epoch: 2, Steps: 8 | Train Loss: 1.462 Vali Loss: 1.470 Vali Acc: 0.481 Test Loss: 1.470 Test Acc: 0.481
Validation loss decreased (-0.419830 --> -0.480901).  Saving model ...
Epoch: 3 cost time: 1.825697898864746
Epoch: 3, Steps: 8 | Train Loss: 1.166 Vali Loss: 1.365 Vali Acc: 0.489 Test Loss: 1.365 Test Acc: 0.489
Validation loss decreased (-0.480901 --> -0.488536).  Saving model ...
Epoch: 4 cost time: 1.3513076305389404
Epoch: 4, Steps: 8 | Train Loss: 0.863 Vali Loss: 1.342 Vali Acc: 0.443 Test Loss: 1.342 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6379246711730957
Epoch: 5, Steps: 8 | Train Loss: 0.521 Vali Loss: 1.419 Vali Acc: 0.527 Test Loss: 1.419 Test Acc: 0.527
Validation loss decreased (-0.488536 --> -0.526703).  Saving model ...
Epoch: 6 cost time: 1.711881399154663
Epoch: 6, Steps: 8 | Train Loss: 0.235 Vali Loss: 1.411 Vali Acc: 0.519 Test Loss: 1.411 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.860457420349121
Epoch: 7, Steps: 8 | Train Loss: 0.063 Vali Loss: 1.682 Vali Acc: 0.511 Test Loss: 1.682 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.139171600341797
Epoch: 8, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.915 Vali Acc: 0.550 Test Loss: 1.915 Test Acc: 0.550
Validation loss decreased (-0.526703 --> -0.549599).  Saving model ...
Epoch: 9 cost time: 2.0182931423187256
Epoch: 9, Steps: 8 | Train Loss: 0.006 Vali Loss: 2.078 Vali Acc: 0.565 Test Loss: 2.078 Test Acc: 0.565
Validation loss decreased (-0.549599 --> -0.564865).  Saving model ...
Epoch: 10 cost time: 1.4670848846435547
Epoch: 10, Steps: 8 | Train Loss: 0.003 Vali Loss: 2.364 Vali Acc: 0.580 Test Loss: 2.364 Test Acc: 0.580
Validation loss decreased (-0.564865 --> -0.580129).  Saving model ...
Epoch: 11 cost time: 1.9387753009796143
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.172 Vali Acc: 0.527 Test Loss: 2.172 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5845937728881836
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.227 Vali Acc: 0.527 Test Loss: 2.227 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.1427035331726074
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.358 Vali Acc: 0.542 Test Loss: 2.358 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.4842302799224854
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.394 Vali Acc: 0.542 Test Loss: 2.394 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.4717261791229248
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.397 Vali Acc: 0.550 Test Loss: 2.397 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.8943769931793213
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.408 Vali Acc: 0.550 Test Loss: 2.408 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.737475872039795
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.419 Vali Acc: 0.565 Test Loss: 2.419 Test Acc: 0.565
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.594508409500122
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.429 Vali Acc: 0.565 Test Loss: 2.429 Test Acc: 0.565
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.7282004356384277
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.435 Vali Acc: 0.565 Test Loss: 2.435 Test Acc: 0.565
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.9131805896759033
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.440 Vali Acc: 0.573 Test Loss: 2.440 Test Acc: 0.573
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps947_str237_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5801526717557252
model parameter : 56857349
model size : 231.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps947_str474_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.420100688934326
Epoch: 1, Steps: 8 | Train Loss: 1.598 Vali Loss: 1.584 Vali Acc: 0.420 Test Loss: 1.584 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 1.493912935256958
Epoch: 2, Steps: 8 | Train Loss: 1.374 Vali Loss: 1.421 Vali Acc: 0.473 Test Loss: 1.421 Test Acc: 0.473
Validation loss decreased (-0.419831 --> -0.473268).  Saving model ...
Epoch: 3 cost time: 1.644911527633667
Epoch: 3, Steps: 8 | Train Loss: 1.103 Vali Loss: 1.335 Vali Acc: 0.573 Test Loss: 1.335 Test Acc: 0.573
Validation loss decreased (-0.473268 --> -0.572506).  Saving model ...
Epoch: 4 cost time: 1.7632710933685303
Epoch: 4, Steps: 8 | Train Loss: 0.812 Vali Loss: 1.211 Vali Acc: 0.573 Test Loss: 1.211 Test Acc: 0.573
Validation loss decreased (-0.572506 --> -0.572507).  Saving model ...
Epoch: 5 cost time: 1.62042236328125
Epoch: 5, Steps: 8 | Train Loss: 0.524 Vali Loss: 1.226 Vali Acc: 0.573 Test Loss: 1.226 Test Acc: 0.573
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.4021949768066406
Epoch: 6, Steps: 8 | Train Loss: 0.241 Vali Loss: 1.173 Vali Acc: 0.565 Test Loss: 1.173 Test Acc: 0.565
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.5484657287597656
Epoch: 7, Steps: 8 | Train Loss: 0.075 Vali Loss: 1.294 Vali Acc: 0.542 Test Loss: 1.294 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.497751235961914
Epoch: 8, Steps: 8 | Train Loss: 0.023 Vali Loss: 1.423 Vali Acc: 0.489 Test Loss: 1.423 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.4115445613861084
Epoch: 9, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.481 Vali Acc: 0.504 Test Loss: 1.481 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.5284044742584229
Epoch: 10, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.556 Vali Acc: 0.519 Test Loss: 1.556 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.500342607498169
Epoch: 11, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.603 Vali Acc: 0.542 Test Loss: 1.603 Test Acc: 0.542
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.4123649597167969
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.614 Vali Acc: 0.504 Test Loss: 1.614 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.3188116550445557
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.641 Vali Acc: 0.504 Test Loss: 1.641 Test Acc: 0.504
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.588653326034546
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.658 Vali Acc: 0.519 Test Loss: 1.658 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps947_str474_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5725190839694656
model parameter : 56663813
model size : 230.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps947_str947_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.387742042541504
Epoch: 1, Steps: 8 | Train Loss: 1.626 Vali Loss: 1.556 Vali Acc: 0.420 Test Loss: 1.556 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 1.5368247032165527
Epoch: 2, Steps: 8 | Train Loss: 1.411 Vali Loss: 1.575 Vali Acc: 0.420 Test Loss: 1.575 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3940706253051758
Epoch: 3, Steps: 8 | Train Loss: 1.201 Vali Loss: 1.529 Vali Acc: 0.481 Test Loss: 1.529 Test Acc: 0.481
Validation loss decreased (-0.419832 --> -0.480901).  Saving model ...
Epoch: 4 cost time: 1.5619513988494873
Epoch: 4, Steps: 8 | Train Loss: 0.872 Vali Loss: 1.541 Vali Acc: 0.443 Test Loss: 1.541 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0528981685638428
Epoch: 5, Steps: 8 | Train Loss: 0.549 Vali Loss: 1.502 Vali Acc: 0.527 Test Loss: 1.502 Test Acc: 0.527
Validation loss decreased (-0.480901 --> -0.526703).  Saving model ...
Epoch: 6 cost time: 1.016974925994873
Epoch: 6, Steps: 8 | Train Loss: 0.279 Vali Loss: 1.602 Vali Acc: 0.511 Test Loss: 1.602 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9348304271697998
Epoch: 7, Steps: 8 | Train Loss: 0.118 Vali Loss: 1.685 Vali Acc: 0.542 Test Loss: 1.685 Test Acc: 0.542
Validation loss decreased (-0.526703 --> -0.541968).  Saving model ...
Epoch: 8 cost time: 0.9894609451293945
Epoch: 8, Steps: 8 | Train Loss: 0.038 Vali Loss: 1.616 Vali Acc: 0.527 Test Loss: 1.616 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2131023406982422
Epoch: 9, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.695 Vali Acc: 0.542 Test Loss: 1.695 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.0276415348052979
Epoch: 10, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.795 Vali Acc: 0.511 Test Loss: 1.795 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.0892033576965332
Epoch: 11, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.823 Vali Acc: 0.542 Test Loss: 1.823 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.2631103992462158
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.832 Vali Acc: 0.527 Test Loss: 1.832 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.2510268688201904
Epoch: 13, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.839 Vali Acc: 0.534 Test Loss: 1.839 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.1015944480895996
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.844 Vali Acc: 0.534 Test Loss: 1.844 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.1322267055511475
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.858 Vali Acc: 0.550 Test Loss: 1.858 Test Acc: 0.550
Validation loss decreased (-0.541968 --> -0.549600).  Saving model ...
Epoch: 16 cost time: 1.013533115386963
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.877 Vali Acc: 0.550 Test Loss: 1.877 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1926743984222412
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.894 Vali Acc: 0.557 Test Loss: 1.894 Test Acc: 0.557
Validation loss decreased (-0.549600 --> -0.557233).  Saving model ...
Epoch: 18 cost time: 1.4071524143218994
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.905 Vali Acc: 0.557 Test Loss: 1.905 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.6455914974212646
Epoch: 19, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.924 Vali Acc: 0.565 Test Loss: 1.924 Test Acc: 0.565
Validation loss decreased (-0.557233 --> -0.564866).  Saving model ...
Epoch: 20 cost time: 1.255448579788208
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.940 Vali Acc: 0.573 Test Loss: 1.940 Test Acc: 0.573
Validation loss decreased (-0.564866 --> -0.572500).  Saving model ...
Epoch: 21 cost time: 1.209963083267212
Epoch: 21, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.951 Vali Acc: 0.573 Test Loss: 1.951 Test Acc: 0.573
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.4084115028381348
Epoch: 22, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.952 Vali Acc: 0.565 Test Loss: 1.952 Test Acc: 0.565
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.311887502670288
Epoch: 23, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.960 Vali Acc: 0.557 Test Loss: 1.960 Test Acc: 0.557
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.1771132946014404
Epoch: 24, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.969 Vali Acc: 0.557 Test Loss: 1.969 Test Acc: 0.557
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.2086825370788574
Epoch: 25, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.968 Vali Acc: 0.557 Test Loss: 1.968 Test Acc: 0.557
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.383368730545044
Epoch: 26, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.967 Vali Acc: 0.557 Test Loss: 1.967 Test Acc: 0.557
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.3272764682769775
Epoch: 27, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.961 Vali Acc: 0.557 Test Loss: 1.961 Test Acc: 0.557
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.33292818069458
Epoch: 28, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.960 Vali Acc: 0.557 Test Loss: 1.960 Test Acc: 0.557
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.9711134433746338
Epoch: 29, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.969 Vali Acc: 0.550 Test Loss: 1.969 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.8307254314422607
Epoch: 30, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.980 Vali Acc: 0.550 Test Loss: 1.980 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps947_str947_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5725190839694656
model parameter : 56567045
model size : 230.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps1000_str250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.449127435684204
Epoch: 1, Steps: 8 | Train Loss: 1.670 Vali Loss: 1.601 Vali Acc: 0.420 Test Loss: 1.601 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 1.7312870025634766
Epoch: 2, Steps: 8 | Train Loss: 1.408 Vali Loss: 1.567 Vali Acc: 0.427 Test Loss: 1.567 Test Acc: 0.427
Validation loss decreased (-0.419831 --> -0.427465).  Saving model ...
Epoch: 3 cost time: 1.4686543941497803
Epoch: 3, Steps: 8 | Train Loss: 1.148 Vali Loss: 1.442 Vali Acc: 0.481 Test Loss: 1.442 Test Acc: 0.481
Validation loss decreased (-0.427465 --> -0.480902).  Saving model ...
Epoch: 4 cost time: 1.1357948780059814
Epoch: 4, Steps: 8 | Train Loss: 0.780 Vali Loss: 1.352 Vali Acc: 0.557 Test Loss: 1.352 Test Acc: 0.557
Validation loss decreased (-0.480902 --> -0.557238).  Saving model ...
Epoch: 5 cost time: 1.1953084468841553
Epoch: 5, Steps: 8 | Train Loss: 0.338 Vali Loss: 1.453 Vali Acc: 0.427 Test Loss: 1.453 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.533703088760376
Epoch: 6, Steps: 8 | Train Loss: 0.164 Vali Loss: 1.531 Vali Acc: 0.427 Test Loss: 1.531 Test Acc: 0.427
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.2954037189483643
Epoch: 7, Steps: 8 | Train Loss: 0.044 Vali Loss: 1.763 Vali Acc: 0.450 Test Loss: 1.763 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.3284938335418701
Epoch: 8, Steps: 8 | Train Loss: 0.023 Vali Loss: 1.889 Vali Acc: 0.489 Test Loss: 1.889 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.4709632396697998
Epoch: 9, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.855 Vali Acc: 0.420 Test Loss: 1.855 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.3416447639465332
Epoch: 10, Steps: 8 | Train Loss: 0.011 Vali Loss: 2.208 Vali Acc: 0.489 Test Loss: 2.208 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.4811270236968994
Epoch: 11, Steps: 8 | Train Loss: 0.011 Vali Loss: 2.119 Vali Acc: 0.466 Test Loss: 2.119 Test Acc: 0.466
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.5138227939605713
Epoch: 12, Steps: 8 | Train Loss: 0.003 Vali Loss: 2.023 Vali Acc: 0.458 Test Loss: 2.023 Test Acc: 0.458
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.4629905223846436
Epoch: 13, Steps: 8 | Train Loss: 0.002 Vali Loss: 2.126 Vali Acc: 0.511 Test Loss: 2.126 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.7671983242034912
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.217 Vali Acc: 0.504 Test Loss: 2.217 Test Acc: 0.504
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps1000_str250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 57568517
model size : 234.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps1000_str500_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.60612154006958
Epoch: 1, Steps: 8 | Train Loss: 1.577 Vali Loss: 1.638 Vali Acc: 0.420 Test Loss: 1.638 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 1.1137797832489014
Epoch: 2, Steps: 8 | Train Loss: 1.379 Vali Loss: 1.520 Vali Acc: 0.427 Test Loss: 1.520 Test Acc: 0.427
Validation loss decreased (-0.419831 --> -0.427466).  Saving model ...
Epoch: 3 cost time: 1.7026135921478271
Epoch: 3, Steps: 8 | Train Loss: 1.149 Vali Loss: 1.434 Vali Acc: 0.489 Test Loss: 1.434 Test Acc: 0.489
Validation loss decreased (-0.427466 --> -0.488535).  Saving model ...
Epoch: 4 cost time: 1.122161626815796
Epoch: 4, Steps: 8 | Train Loss: 0.798 Vali Loss: 1.365 Vali Acc: 0.466 Test Loss: 1.365 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2231078147888184
Epoch: 5, Steps: 8 | Train Loss: 0.504 Vali Loss: 1.362 Vali Acc: 0.557 Test Loss: 1.362 Test Acc: 0.557
Validation loss decreased (-0.488535 --> -0.557238).  Saving model ...
Epoch: 6 cost time: 1.2685554027557373
Epoch: 6, Steps: 8 | Train Loss: 0.242 Vali Loss: 1.323 Vali Acc: 0.450 Test Loss: 1.323 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1238987445831299
Epoch: 7, Steps: 8 | Train Loss: 0.109 Vali Loss: 1.570 Vali Acc: 0.534 Test Loss: 1.570 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.258892297744751
Epoch: 8, Steps: 8 | Train Loss: 0.039 Vali Loss: 1.444 Vali Acc: 0.443 Test Loss: 1.444 Test Acc: 0.443
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.0391216278076172
Epoch: 9, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.488 Vali Acc: 0.489 Test Loss: 1.488 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.1569721698760986
Epoch: 10, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.657 Vali Acc: 0.489 Test Loss: 1.657 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.9544007778167725
Epoch: 11, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.596 Vali Acc: 0.489 Test Loss: 1.596 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.320988416671753
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.608 Vali Acc: 0.504 Test Loss: 1.608 Test Acc: 0.504
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.0948514938354492
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.632 Vali Acc: 0.511 Test Loss: 1.632 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.2506349086761475
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.673 Vali Acc: 0.489 Test Loss: 1.673 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.169896125793457
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.709 Vali Acc: 0.504 Test Loss: 1.709 Test Acc: 0.504
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps1000_str500_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 57385733
model size : 233.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps1000_str1000_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.6547672748565674
Epoch: 1, Steps: 8 | Train Loss: 1.505 Vali Loss: 1.567 Vali Acc: 0.420 Test Loss: 1.567 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 1.096703052520752
Epoch: 2, Steps: 8 | Train Loss: 1.362 Vali Loss: 1.536 Vali Acc: 0.420 Test Loss: 1.536 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 1.1451456546783447
Epoch: 3, Steps: 8 | Train Loss: 1.090 Vali Loss: 1.554 Vali Acc: 0.435 Test Loss: 1.554 Test Acc: 0.435
Validation loss decreased (-0.419832 --> -0.435099).  Saving model ...
Epoch: 4 cost time: 1.235450029373169
Epoch: 4, Steps: 8 | Train Loss: 0.799 Vali Loss: 1.485 Vali Acc: 0.458 Test Loss: 1.485 Test Acc: 0.458
Validation loss decreased (-0.435099 --> -0.458000).  Saving model ...
Epoch: 5 cost time: 1.1532504558563232
Epoch: 5, Steps: 8 | Train Loss: 0.548 Vali Loss: 1.431 Vali Acc: 0.443 Test Loss: 1.431 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0901837348937988
Epoch: 6, Steps: 8 | Train Loss: 0.306 Vali Loss: 1.443 Vali Acc: 0.481 Test Loss: 1.443 Test Acc: 0.481
Validation loss decreased (-0.458000 --> -0.480902).  Saving model ...
Epoch: 7 cost time: 1.140561819076538
Epoch: 7, Steps: 8 | Train Loss: 0.150 Vali Loss: 1.483 Vali Acc: 0.519 Test Loss: 1.483 Test Acc: 0.519
Validation loss decreased (-0.480902 --> -0.519069).  Saving model ...
Epoch: 8 cost time: 1.144258975982666
Epoch: 8, Steps: 8 | Train Loss: 0.070 Vali Loss: 1.504 Vali Acc: 0.557 Test Loss: 1.504 Test Acc: 0.557
Validation loss decreased (-0.519069 --> -0.557237).  Saving model ...
Epoch: 9 cost time: 1.2710075378417969
Epoch: 9, Steps: 8 | Train Loss: 0.028 Vali Loss: 1.750 Vali Acc: 0.542 Test Loss: 1.750 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1128020286560059
Epoch: 10, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.657 Vali Acc: 0.519 Test Loss: 1.657 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0950896739959717
Epoch: 11, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.616 Vali Acc: 0.534 Test Loss: 1.616 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.1874408721923828
Epoch: 12, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.622 Vali Acc: 0.542 Test Loss: 1.622 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.5773730278015137
Epoch: 13, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.665 Vali Acc: 0.573 Test Loss: 1.665 Test Acc: 0.573
Validation loss decreased (-0.557237 --> -0.572502).  Saving model ...
Epoch: 14 cost time: 0.9860408306121826
Epoch: 14, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.722 Vali Acc: 0.550 Test Loss: 1.722 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.852837324142456
Epoch: 15, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.756 Vali Acc: 0.550 Test Loss: 1.756 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.2156741619110107
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.758 Vali Acc: 0.550 Test Loss: 1.758 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.1596343517303467
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.749 Vali Acc: 0.550 Test Loss: 1.749 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.125300645828247
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.725 Vali Acc: 0.557 Test Loss: 1.725 Test Acc: 0.557
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.9354932308197021
Epoch: 19, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.717 Vali Acc: 0.565 Test Loss: 1.717 Test Acc: 0.565
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.0496323108673096
Epoch: 20, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.735 Vali Acc: 0.565 Test Loss: 1.735 Test Acc: 0.565
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.269496202468872
Epoch: 21, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.754 Vali Acc: 0.550 Test Loss: 1.754 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.323814868927002
Epoch: 22, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.768 Vali Acc: 0.542 Test Loss: 1.768 Test Acc: 0.542
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.402111291885376
Epoch: 23, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.779 Vali Acc: 0.550 Test Loss: 1.779 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps1000_str1000_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5725190839694656
model parameter : 57294341
model size : 233.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps1058_str265_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.2545528411865234
Epoch: 1, Steps: 8 | Train Loss: 1.651 Vali Loss: 1.619 Vali Acc: 0.420 Test Loss: 1.619 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 1.4265646934509277
Epoch: 2, Steps: 8 | Train Loss: 1.491 Vali Loss: 1.556 Vali Acc: 0.351 Test Loss: 1.556 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3439347743988037
Epoch: 3, Steps: 8 | Train Loss: 1.173 Vali Loss: 1.489 Vali Acc: 0.473 Test Loss: 1.489 Test Acc: 0.473
Validation loss decreased (-0.419831 --> -0.473268).  Saving model ...
Epoch: 4 cost time: 1.3082730770111084
Epoch: 4, Steps: 8 | Train Loss: 0.848 Vali Loss: 1.377 Vali Acc: 0.519 Test Loss: 1.377 Test Acc: 0.519
Validation loss decreased (-0.473268 --> -0.519070).  Saving model ...
Epoch: 5 cost time: 1.9751956462860107
Epoch: 5, Steps: 8 | Train Loss: 0.453 Vali Loss: 1.221 Vali Acc: 0.603 Test Loss: 1.221 Test Acc: 0.603
Validation loss decreased (-0.519070 --> -0.603041).  Saving model ...
Epoch: 6 cost time: 1.2664425373077393
Epoch: 6, Steps: 8 | Train Loss: 0.145 Vali Loss: 1.322 Vali Acc: 0.573 Test Loss: 1.322 Test Acc: 0.573
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4510011672973633
Epoch: 7, Steps: 8 | Train Loss: 0.041 Vali Loss: 1.595 Vali Acc: 0.580 Test Loss: 1.595 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.063382863998413
Epoch: 8, Steps: 8 | Train Loss: 0.019 Vali Loss: 1.497 Vali Acc: 0.550 Test Loss: 1.497 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.1303534507751465
Epoch: 9, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.835 Vali Acc: 0.519 Test Loss: 1.835 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.4458467960357666
Epoch: 10, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.821 Vali Acc: 0.550 Test Loss: 1.821 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.9841001033782959
Epoch: 11, Steps: 8 | Train Loss: 0.002 Vali Loss: 2.415 Vali Acc: 0.504 Test Loss: 2.415 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.0858848094940186
Epoch: 12, Steps: 8 | Train Loss: 0.004 Vali Loss: 2.088 Vali Acc: 0.588 Test Loss: 2.088 Test Acc: 0.588
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.2398438453674316
Epoch: 13, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.905 Vali Acc: 0.557 Test Loss: 1.905 Test Acc: 0.557
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.9421908855438232
Epoch: 14, Steps: 8 | Train Loss: 0.002 Vali Loss: 2.209 Vali Acc: 0.527 Test Loss: 2.209 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.219658374786377
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.384 Vali Acc: 0.534 Test Loss: 2.384 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps1058_str265_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6030534351145038
model parameter : 58348805
model size : 237.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps1058_str529_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.0198729038238525
Epoch: 1, Steps: 8 | Train Loss: 1.591 Vali Loss: 1.683 Vali Acc: 0.420 Test Loss: 1.683 Test Acc: 0.420
Validation loss decreased (inf --> -0.419830).  Saving model ...
Epoch: 2 cost time: 1.0732390880584717
Epoch: 2, Steps: 8 | Train Loss: 1.388 Vali Loss: 1.489 Vali Acc: 0.466 Test Loss: 1.489 Test Acc: 0.466
Validation loss decreased (-0.419830 --> -0.465634).  Saving model ...
Epoch: 3 cost time: 1.4310171604156494
Epoch: 3, Steps: 8 | Train Loss: 1.128 Vali Loss: 1.427 Vali Acc: 0.511 Test Loss: 1.427 Test Acc: 0.511
Validation loss decreased (-0.465634 --> -0.511436).  Saving model ...
Epoch: 4 cost time: 1.3253545761108398
Epoch: 4, Steps: 8 | Train Loss: 0.818 Vali Loss: 1.345 Vali Acc: 0.504 Test Loss: 1.345 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4328398704528809
Epoch: 5, Steps: 8 | Train Loss: 0.454 Vali Loss: 1.418 Vali Acc: 0.427 Test Loss: 1.418 Test Acc: 0.427
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.0986700057983398
Epoch: 6, Steps: 8 | Train Loss: 0.223 Vali Loss: 1.449 Vali Acc: 0.511 Test Loss: 1.449 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.6331102848052979
Epoch: 7, Steps: 8 | Train Loss: 0.090 Vali Loss: 1.416 Vali Acc: 0.496 Test Loss: 1.416 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.5929582118988037
Epoch: 8, Steps: 8 | Train Loss: 0.030 Vali Loss: 1.627 Vali Acc: 0.565 Test Loss: 1.627 Test Acc: 0.565
Validation loss decreased (-0.511436 --> -0.564869).  Saving model ...
Epoch: 9 cost time: 1.1065831184387207
Epoch: 9, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.598 Vali Acc: 0.496 Test Loss: 1.598 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2100117206573486
Epoch: 10, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.474 Vali Acc: 0.496 Test Loss: 1.474 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.2105748653411865
Epoch: 11, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.519 Vali Acc: 0.511 Test Loss: 1.519 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.1885292530059814
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.609 Vali Acc: 0.534 Test Loss: 1.609 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.1581189632415771
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.652 Vali Acc: 0.527 Test Loss: 1.652 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.1060066223144531
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.653 Vali Acc: 0.511 Test Loss: 1.653 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.0959789752960205
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.646 Vali Acc: 0.511 Test Loss: 1.646 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.59525465965271
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.647 Vali Acc: 0.511 Test Loss: 1.647 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.6715946197509766
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.654 Vali Acc: 0.511 Test Loss: 1.654 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.6142034530639648
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.665 Vali Acc: 0.519 Test Loss: 1.665 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps1058_str529_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5648854961832062
model parameter : 58176773
model size : 236.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps1058_str1058_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.4283037185668945
Epoch: 1, Steps: 8 | Train Loss: 1.569 Vali Loss: 1.544 Vali Acc: 0.420 Test Loss: 1.544 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 1.0739471912384033
Epoch: 2, Steps: 8 | Train Loss: 1.378 Vali Loss: 1.514 Vali Acc: 0.443 Test Loss: 1.514 Test Acc: 0.443
Validation loss decreased (-0.419832 --> -0.442733).  Saving model ...
Epoch: 3 cost time: 1.0995848178863525
Epoch: 3, Steps: 8 | Train Loss: 1.076 Vali Loss: 1.465 Vali Acc: 0.473 Test Loss: 1.465 Test Acc: 0.473
Validation loss decreased (-0.442733 --> -0.473268).  Saving model ...
Epoch: 4 cost time: 1.1530883312225342
Epoch: 4, Steps: 8 | Train Loss: 0.774 Vali Loss: 1.423 Vali Acc: 0.511 Test Loss: 1.423 Test Acc: 0.511
Validation loss decreased (-0.473268 --> -0.511436).  Saving model ...
Epoch: 5 cost time: 1.2629446983337402
Epoch: 5, Steps: 8 | Train Loss: 0.477 Vali Loss: 1.433 Vali Acc: 0.527 Test Loss: 1.433 Test Acc: 0.527
Validation loss decreased (-0.511436 --> -0.526703).  Saving model ...
Epoch: 6 cost time: 1.085310459136963
Epoch: 6, Steps: 8 | Train Loss: 0.250 Vali Loss: 1.421 Vali Acc: 0.511 Test Loss: 1.421 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2035574913024902
Epoch: 7, Steps: 8 | Train Loss: 0.100 Vali Loss: 1.386 Vali Acc: 0.504 Test Loss: 1.386 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.000457763671875
Epoch: 8, Steps: 8 | Train Loss: 0.038 Vali Loss: 1.377 Vali Acc: 0.496 Test Loss: 1.377 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.030604600906372
Epoch: 9, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.564 Vali Acc: 0.511 Test Loss: 1.564 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.5167381763458252
Epoch: 10, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.628 Vali Acc: 0.542 Test Loss: 1.628 Test Acc: 0.542
Validation loss decreased (-0.526703 --> -0.541968).  Saving model ...
Epoch: 11 cost time: 1.1734113693237305
Epoch: 11, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.623 Vali Acc: 0.504 Test Loss: 1.623 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3193631172180176
Epoch: 12, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.579 Vali Acc: 0.511 Test Loss: 1.579 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.6038730144500732
Epoch: 13, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.579 Vali Acc: 0.511 Test Loss: 1.579 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.1452851295471191
Epoch: 14, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.589 Vali Acc: 0.519 Test Loss: 1.589 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.5868241786956787
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.604 Vali Acc: 0.519 Test Loss: 1.604 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.108351230621338
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.617 Vali Acc: 0.534 Test Loss: 1.617 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.0441513061523438
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.621 Vali Acc: 0.511 Test Loss: 1.621 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.1147754192352295
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.625 Vali Acc: 0.511 Test Loss: 1.625 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.5206215381622314
Epoch: 19, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.633 Vali Acc: 0.527 Test Loss: 1.633 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.0709130764007568
Epoch: 20, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.642 Vali Acc: 0.519 Test Loss: 1.642 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps1058_str1058_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 58090757
model size : 236.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps1124_str281_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.4541006088256836
Epoch: 1, Steps: 8 | Train Loss: 1.629 Vali Loss: 1.579 Vali Acc: 0.420 Test Loss: 1.579 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 1.872363805770874
Epoch: 2, Steps: 8 | Train Loss: 1.386 Vali Loss: 1.561 Vali Acc: 0.397 Test Loss: 1.561 Test Acc: 0.397
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4488072395324707
Epoch: 3, Steps: 8 | Train Loss: 1.131 Vali Loss: 1.418 Vali Acc: 0.481 Test Loss: 1.418 Test Acc: 0.481
Validation loss decreased (-0.419832 --> -0.480902).  Saving model ...
Epoch: 4 cost time: 1.395996332168579
Epoch: 4, Steps: 8 | Train Loss: 0.799 Vali Loss: 1.320 Vali Acc: 0.550 Test Loss: 1.320 Test Acc: 0.550
Validation loss decreased (-0.480902 --> -0.549605).  Saving model ...
Epoch: 5 cost time: 1.1846983432769775
Epoch: 5, Steps: 8 | Train Loss: 0.433 Vali Loss: 1.401 Vali Acc: 0.481 Test Loss: 1.401 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.498600959777832
Epoch: 6, Steps: 8 | Train Loss: 0.169 Vali Loss: 1.308 Vali Acc: 0.565 Test Loss: 1.308 Test Acc: 0.565
Validation loss decreased (-0.549605 --> -0.564872).  Saving model ...
Epoch: 7 cost time: 2.0123846530914307
Epoch: 7, Steps: 8 | Train Loss: 0.045 Vali Loss: 1.684 Vali Acc: 0.534 Test Loss: 1.684 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6681320667266846
Epoch: 8, Steps: 8 | Train Loss: 0.021 Vali Loss: 1.629 Vali Acc: 0.519 Test Loss: 1.629 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.6140003204345703
Epoch: 9, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.467 Vali Acc: 0.588 Test Loss: 1.467 Test Acc: 0.588
Validation loss decreased (-0.564872 --> -0.587772).  Saving model ...
Epoch: 10 cost time: 1.2620139122009277
Epoch: 10, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.728 Vali Acc: 0.573 Test Loss: 1.728 Test Acc: 0.573
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.475109577178955
Epoch: 11, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.842 Vali Acc: 0.534 Test Loss: 1.842 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.321763277053833
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.889 Vali Acc: 0.565 Test Loss: 1.889 Test Acc: 0.565
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.693939208984375
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.955 Vali Acc: 0.557 Test Loss: 1.955 Test Acc: 0.557
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.4901738166809082
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.942 Vali Acc: 0.557 Test Loss: 1.942 Test Acc: 0.557
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.1783249378204346
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.951 Vali Acc: 0.542 Test Loss: 1.951 Test Acc: 0.542
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.3143134117126465
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.970 Vali Acc: 0.550 Test Loss: 1.970 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.5539181232452393
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.967 Vali Acc: 0.542 Test Loss: 1.967 Test Acc: 0.542
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.2957231998443604
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.970 Vali Acc: 0.557 Test Loss: 1.970 Test Acc: 0.557
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.8743517398834229
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.973 Vali Acc: 0.557 Test Loss: 1.973 Test Acc: 0.557
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps1124_str281_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5877862595419847
model parameter : 59245061
model size : 240.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps1124_str562_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.56007981300354
Epoch: 1, Steps: 8 | Train Loss: 1.551 Vali Loss: 1.615 Vali Acc: 0.420 Test Loss: 1.615 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 1.4567244052886963
Epoch: 2, Steps: 8 | Train Loss: 1.344 Vali Loss: 1.526 Vali Acc: 0.466 Test Loss: 1.526 Test Acc: 0.466
Validation loss decreased (-0.419831 --> -0.465634).  Saving model ...
Epoch: 3 cost time: 1.0850863456726074
Epoch: 3, Steps: 8 | Train Loss: 1.082 Vali Loss: 1.490 Vali Acc: 0.458 Test Loss: 1.490 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1868970394134521
Epoch: 4, Steps: 8 | Train Loss: 0.741 Vali Loss: 1.447 Vali Acc: 0.466 Test Loss: 1.447 Test Acc: 0.466
Validation loss decreased (-0.465634 --> -0.465634).  Saving model ...
Epoch: 5 cost time: 1.173405408859253
Epoch: 5, Steps: 8 | Train Loss: 0.417 Vali Loss: 1.437 Vali Acc: 0.504 Test Loss: 1.437 Test Acc: 0.504
Validation loss decreased (-0.465634 --> -0.503802).  Saving model ...
Epoch: 6 cost time: 1.1238629817962646
Epoch: 6, Steps: 8 | Train Loss: 0.150 Vali Loss: 1.458 Vali Acc: 0.511 Test Loss: 1.458 Test Acc: 0.511
Validation loss decreased (-0.503802 --> -0.511436).  Saving model ...
Epoch: 7 cost time: 1.0242719650268555
Epoch: 7, Steps: 8 | Train Loss: 0.062 Vali Loss: 1.535 Vali Acc: 0.527 Test Loss: 1.535 Test Acc: 0.527
Validation loss decreased (-0.511436 --> -0.526702).  Saving model ...
Epoch: 8 cost time: 1.000286340713501
Epoch: 8, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.632 Vali Acc: 0.450 Test Loss: 1.632 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2103941440582275
Epoch: 9, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.684 Vali Acc: 0.519 Test Loss: 1.684 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.4341983795166016
Epoch: 10, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.633 Vali Acc: 0.519 Test Loss: 1.633 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.5290005207061768
Epoch: 11, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.599 Vali Acc: 0.511 Test Loss: 1.599 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.597430944442749
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.611 Vali Acc: 0.504 Test Loss: 1.611 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.4426238536834717
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.629 Vali Acc: 0.496 Test Loss: 1.629 Test Acc: 0.496
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.5551350116729736
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.652 Vali Acc: 0.511 Test Loss: 1.652 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.2598607540130615
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.674 Vali Acc: 0.511 Test Loss: 1.674 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.264284610748291
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.681 Vali Acc: 0.511 Test Loss: 1.681 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.8042607307434082
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.683 Vali Acc: 0.519 Test Loss: 1.683 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps1124_str562_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 59083781
model size : 240.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps1124_str1124_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.89316463470459
Epoch: 1, Steps: 8 | Train Loss: 1.512 Vali Loss: 1.585 Vali Acc: 0.420 Test Loss: 1.585 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 1.3012025356292725
Epoch: 2, Steps: 8 | Train Loss: 1.370 Vali Loss: 1.529 Vali Acc: 0.420 Test Loss: 1.529 Test Acc: 0.420
Validation loss decreased (-0.419831 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 1.2207942008972168
Epoch: 3, Steps: 8 | Train Loss: 1.153 Vali Loss: 1.484 Vali Acc: 0.496 Test Loss: 1.484 Test Acc: 0.496
Validation loss decreased (-0.419832 --> -0.496168).  Saving model ...
Epoch: 4 cost time: 1.3885018825531006
Epoch: 4, Steps: 8 | Train Loss: 0.819 Vali Loss: 1.405 Vali Acc: 0.473 Test Loss: 1.405 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1939971446990967
Epoch: 5, Steps: 8 | Train Loss: 0.477 Vali Loss: 1.400 Vali Acc: 0.511 Test Loss: 1.400 Test Acc: 0.511
Validation loss decreased (-0.496168 --> -0.511436).  Saving model ...
Epoch: 6 cost time: 1.1980328559875488
Epoch: 6, Steps: 8 | Train Loss: 0.219 Vali Loss: 1.482 Vali Acc: 0.519 Test Loss: 1.482 Test Acc: 0.519
Validation loss decreased (-0.511436 --> -0.519069).  Saving model ...
Epoch: 7 cost time: 0.9339218139648438
Epoch: 7, Steps: 8 | Train Loss: 0.105 Vali Loss: 1.540 Vali Acc: 0.466 Test Loss: 1.540 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8309457302093506
Epoch: 8, Steps: 8 | Train Loss: 0.034 Vali Loss: 1.688 Vali Acc: 0.473 Test Loss: 1.688 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8247950077056885
Epoch: 9, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.842 Vali Acc: 0.511 Test Loss: 1.842 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.6332175731658936
Epoch: 10, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.901 Vali Acc: 0.496 Test Loss: 1.901 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.3313159942626953
Epoch: 11, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.901 Vali Acc: 0.519 Test Loss: 1.901 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.2079803943634033
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.896 Vali Acc: 0.511 Test Loss: 1.896 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.184525728225708
Epoch: 13, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.907 Vali Acc: 0.504 Test Loss: 1.907 Test Acc: 0.504
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.185349941253662
Epoch: 14, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.928 Vali Acc: 0.504 Test Loss: 1.928 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.264678955078125
Epoch: 15, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.944 Vali Acc: 0.519 Test Loss: 1.944 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.181328296661377
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.960 Vali Acc: 0.527 Test Loss: 1.960 Test Acc: 0.527
Validation loss decreased (-0.519069 --> -0.526698).  Saving model ...
Epoch: 17 cost time: 1.362417459487915
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.967 Vali Acc: 0.542 Test Loss: 1.967 Test Acc: 0.542
Validation loss decreased (-0.526698 --> -0.541965).  Saving model ...
Epoch: 18 cost time: 1.4362034797668457
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.972 Vali Acc: 0.519 Test Loss: 1.972 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0482256412506104
Epoch: 19, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.977 Vali Acc: 0.511 Test Loss: 1.977 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.3076608180999756
Epoch: 20, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.993 Vali Acc: 0.534 Test Loss: 1.993 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.1997301578521729
Epoch: 21, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.012 Vali Acc: 0.534 Test Loss: 2.012 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.3491694927215576
Epoch: 22, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.026 Vali Acc: 0.534 Test Loss: 2.026 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.354088544845581
Epoch: 23, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.038 Vali Acc: 0.542 Test Loss: 2.038 Test Acc: 0.542
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.3026485443115234
Epoch: 24, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.048 Vali Acc: 0.534 Test Loss: 2.048 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.1940338611602783
Epoch: 25, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.061 Vali Acc: 0.534 Test Loss: 2.061 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.3505985736846924
Epoch: 26, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.072 Vali Acc: 0.527 Test Loss: 2.072 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.2978951930999756
Epoch: 27, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.086 Vali Acc: 0.534 Test Loss: 2.086 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps1124_str1124_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 59003141
model size : 239.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps1199_str300_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.98115873336792
Epoch: 1, Steps: 8 | Train Loss: 1.542 Vali Loss: 1.585 Vali Acc: 0.420 Test Loss: 1.585 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 1.5697448253631592
Epoch: 2, Steps: 8 | Train Loss: 1.369 Vali Loss: 1.458 Vali Acc: 0.427 Test Loss: 1.458 Test Acc: 0.427
Validation loss decreased (-0.419831 --> -0.427466).  Saving model ...
Epoch: 3 cost time: 1.8334782123565674
Epoch: 3, Steps: 8 | Train Loss: 1.006 Vali Loss: 1.487 Vali Acc: 0.427 Test Loss: 1.487 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.0594699382781982
Epoch: 4, Steps: 8 | Train Loss: 0.597 Vali Loss: 1.389 Vali Acc: 0.481 Test Loss: 1.389 Test Acc: 0.481
Validation loss decreased (-0.427466 --> -0.480902).  Saving model ...
Epoch: 5 cost time: 1.4905998706817627
Epoch: 5, Steps: 8 | Train Loss: 0.218 Vali Loss: 1.366 Vali Acc: 0.481 Test Loss: 1.366 Test Acc: 0.481
Validation loss decreased (-0.480902 --> -0.480902).  Saving model ...
Epoch: 6 cost time: 1.6932406425476074
Epoch: 6, Steps: 8 | Train Loss: 0.076 Vali Loss: 1.504 Vali Acc: 0.489 Test Loss: 1.504 Test Acc: 0.489
Validation loss decreased (-0.480902 --> -0.488535).  Saving model ...
Epoch: 7 cost time: 1.8437821865081787
Epoch: 7, Steps: 8 | Train Loss: 0.024 Vali Loss: 1.504 Vali Acc: 0.519 Test Loss: 1.504 Test Acc: 0.519
Validation loss decreased (-0.488535 --> -0.519069).  Saving model ...
Epoch: 8 cost time: 1.4181139469146729
Epoch: 8, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.848 Vali Acc: 0.511 Test Loss: 1.848 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.7802929878234863
Epoch: 9, Steps: 8 | Train Loss: 0.003 Vali Loss: 2.148 Vali Acc: 0.527 Test Loss: 2.148 Test Acc: 0.527
Validation loss decreased (-0.519069 --> -0.526696).  Saving model ...
Epoch: 10 cost time: 2.4679512977600098
Epoch: 10, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.753 Vali Acc: 0.527 Test Loss: 1.753 Test Acc: 0.527
Validation loss decreased (-0.526696 --> -0.526700).  Saving model ...
Epoch: 11 cost time: 1.9063720703125
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.686 Vali Acc: 0.519 Test Loss: 1.686 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.0715880393981934
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.765 Vali Acc: 0.519 Test Loss: 1.765 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.163827657699585
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.851 Vali Acc: 0.542 Test Loss: 1.851 Test Acc: 0.542
Validation loss decreased (-0.526700 --> -0.541966).  Saving model ...
Epoch: 14 cost time: 1.9688549041748047
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.898 Vali Acc: 0.542 Test Loss: 1.898 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.8608181476593018
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.918 Vali Acc: 0.534 Test Loss: 1.918 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.2072031497955322
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.924 Vali Acc: 0.527 Test Loss: 1.924 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.6105577945709229
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.930 Vali Acc: 0.527 Test Loss: 1.930 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.8120837211608887
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.925 Vali Acc: 0.527 Test Loss: 1.925 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.0266189575195312
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.936 Vali Acc: 0.527 Test Loss: 1.936 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.37786602973938
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.970 Vali Acc: 0.527 Test Loss: 1.970 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.6528255939483643
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.993 Vali Acc: 0.534 Test Loss: 1.993 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.1770095825195312
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.008 Vali Acc: 0.534 Test Loss: 2.008 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.581127166748047
Epoch: 23, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.018 Vali Acc: 0.534 Test Loss: 2.018 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps1199_str300_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 60254981
model size : 244.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps1199_str600_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.2228517532348633
Epoch: 1, Steps: 8 | Train Loss: 1.564 Vali Loss: 1.603 Vali Acc: 0.420 Test Loss: 1.603 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 1.6358964443206787
Epoch: 2, Steps: 8 | Train Loss: 1.337 Vali Loss: 1.569 Vali Acc: 0.466 Test Loss: 1.569 Test Acc: 0.466
Validation loss decreased (-0.419831 --> -0.465633).  Saving model ...
Epoch: 3 cost time: 1.8594539165496826
Epoch: 3, Steps: 8 | Train Loss: 1.060 Vali Loss: 1.492 Vali Acc: 0.511 Test Loss: 1.492 Test Acc: 0.511
Validation loss decreased (-0.465633 --> -0.511435).  Saving model ...
Epoch: 4 cost time: 1.819545030593872
Epoch: 4, Steps: 8 | Train Loss: 0.716 Vali Loss: 1.453 Vali Acc: 0.481 Test Loss: 1.453 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4854693412780762
Epoch: 5, Steps: 8 | Train Loss: 0.417 Vali Loss: 1.385 Vali Acc: 0.489 Test Loss: 1.385 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.521388292312622
Epoch: 6, Steps: 8 | Train Loss: 0.159 Vali Loss: 1.360 Vali Acc: 0.481 Test Loss: 1.360 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.8158936500549316
Epoch: 7, Steps: 8 | Train Loss: 0.048 Vali Loss: 1.519 Vali Acc: 0.511 Test Loss: 1.519 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.8846352100372314
Epoch: 8, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.631 Vali Acc: 0.496 Test Loss: 1.631 Test Acc: 0.496
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.7685651779174805
Epoch: 9, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.572 Vali Acc: 0.534 Test Loss: 1.572 Test Acc: 0.534
Validation loss decreased (-0.511435 --> -0.534335).  Saving model ...
Epoch: 10 cost time: 1.8231360912322998
Epoch: 10, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.571 Vali Acc: 0.534 Test Loss: 1.571 Test Acc: 0.534
Validation loss decreased (-0.534335 --> -0.534335).  Saving model ...
Epoch: 11 cost time: 1.7842168807983398
Epoch: 11, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.592 Vali Acc: 0.534 Test Loss: 1.592 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.6654555797576904
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.635 Vali Acc: 0.527 Test Loss: 1.635 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.7430322170257568
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.659 Vali Acc: 0.527 Test Loss: 1.659 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.186225414276123
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.667 Vali Acc: 0.511 Test Loss: 1.667 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.4789636135101318
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.677 Vali Acc: 0.534 Test Loss: 1.677 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.3555786609649658
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.690 Vali Acc: 0.550 Test Loss: 1.690 Test Acc: 0.550
Validation loss decreased (-0.534335 --> -0.549601).  Saving model ...
Epoch: 17 cost time: 1.4134411811828613
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.698 Vali Acc: 0.557 Test Loss: 1.698 Test Acc: 0.557
Validation loss decreased (-0.549601 --> -0.557235).  Saving model ...
Epoch: 18 cost time: 1.4736039638519287
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.701 Vali Acc: 0.557 Test Loss: 1.701 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1091692447662354
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.691 Vali Acc: 0.542 Test Loss: 1.691 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.5423228740692139
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.689 Vali Acc: 0.534 Test Loss: 1.689 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.0993843078613281
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.695 Vali Acc: 0.542 Test Loss: 1.695 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.1793513298034668
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.707 Vali Acc: 0.550 Test Loss: 1.707 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.8863732814788818
Epoch: 23, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.713 Vali Acc: 0.542 Test Loss: 1.713 Test Acc: 0.542
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.8561725616455078
Epoch: 24, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.719 Vali Acc: 0.542 Test Loss: 1.719 Test Acc: 0.542
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.0411632061004639
Epoch: 25, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.725 Vali Acc: 0.542 Test Loss: 1.725 Test Acc: 0.542
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.3024029731750488
Epoch: 26, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.732 Vali Acc: 0.534 Test Loss: 1.732 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.0918114185333252
Epoch: 27, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.739 Vali Acc: 0.534 Test Loss: 1.739 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps1199_str600_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 60104453
model size : 243.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps1199_str1199_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.729459524154663
Epoch: 1, Steps: 8 | Train Loss: 1.538 Vali Loss: 1.550 Vali Acc: 0.420 Test Loss: 1.550 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 0.9865798950195312
Epoch: 2, Steps: 8 | Train Loss: 1.338 Vali Loss: 1.487 Vali Acc: 0.435 Test Loss: 1.487 Test Acc: 0.435
Validation loss decreased (-0.419832 --> -0.435100).  Saving model ...
Epoch: 3 cost time: 0.9981553554534912
Epoch: 3, Steps: 8 | Train Loss: 1.059 Vali Loss: 1.426 Vali Acc: 0.534 Test Loss: 1.426 Test Acc: 0.534
Validation loss decreased (-0.435100 --> -0.534337).  Saving model ...
Epoch: 4 cost time: 1.3404383659362793
Epoch: 4, Steps: 8 | Train Loss: 0.743 Vali Loss: 1.349 Vali Acc: 0.466 Test Loss: 1.349 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2599847316741943
Epoch: 5, Steps: 8 | Train Loss: 0.404 Vali Loss: 1.381 Vali Acc: 0.504 Test Loss: 1.381 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.586561679840088
Epoch: 6, Steps: 8 | Train Loss: 0.181 Vali Loss: 1.416 Vali Acc: 0.519 Test Loss: 1.416 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.2789924144744873
Epoch: 7, Steps: 8 | Train Loss: 0.058 Vali Loss: 1.538 Vali Acc: 0.519 Test Loss: 1.538 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.2416059970855713
Epoch: 8, Steps: 8 | Train Loss: 0.026 Vali Loss: 1.543 Vali Acc: 0.504 Test Loss: 1.543 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.0795743465423584
Epoch: 9, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.604 Vali Acc: 0.489 Test Loss: 1.604 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.3998920917510986
Epoch: 10, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.701 Vali Acc: 0.496 Test Loss: 1.701 Test Acc: 0.496
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.382009744644165
Epoch: 11, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.747 Vali Acc: 0.496 Test Loss: 1.747 Test Acc: 0.496
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.4198675155639648
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.766 Vali Acc: 0.504 Test Loss: 1.766 Test Acc: 0.504
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.1454739570617676
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.772 Vali Acc: 0.489 Test Loss: 1.772 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps1199_str1199_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 60029189
model size : 243.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps1285_str322_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.758833646774292
Epoch: 1, Steps: 8 | Train Loss: 1.526 Vali Loss: 1.584 Vali Acc: 0.420 Test Loss: 1.584 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 1.5900788307189941
Epoch: 2, Steps: 8 | Train Loss: 1.315 Vali Loss: 1.489 Vali Acc: 0.458 Test Loss: 1.489 Test Acc: 0.458
Validation loss decreased (-0.419831 --> -0.458000).  Saving model ...
Epoch: 3 cost time: 1.5247137546539307
Epoch: 3, Steps: 8 | Train Loss: 1.000 Vali Loss: 1.396 Vali Acc: 0.473 Test Loss: 1.396 Test Acc: 0.473
Validation loss decreased (-0.458000 --> -0.473268).  Saving model ...
Epoch: 4 cost time: 1.5481152534484863
Epoch: 4, Steps: 8 | Train Loss: 0.646 Vali Loss: 1.443 Vali Acc: 0.496 Test Loss: 1.443 Test Acc: 0.496
Validation loss decreased (-0.473268 --> -0.496169).  Saving model ...
Epoch: 5 cost time: 1.4490268230438232
Epoch: 5, Steps: 8 | Train Loss: 0.339 Vali Loss: 1.275 Vali Acc: 0.557 Test Loss: 1.275 Test Acc: 0.557
Validation loss decreased (-0.496169 --> -0.557239).  Saving model ...
Epoch: 6 cost time: 1.3983941078186035
Epoch: 6, Steps: 8 | Train Loss: 0.127 Vali Loss: 1.355 Vali Acc: 0.527 Test Loss: 1.355 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2754082679748535
Epoch: 7, Steps: 8 | Train Loss: 0.041 Vali Loss: 1.480 Vali Acc: 0.534 Test Loss: 1.480 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.424173355102539
Epoch: 8, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.526 Vali Acc: 0.542 Test Loss: 1.526 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.9974110126495361
Epoch: 9, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.519 Vali Acc: 0.588 Test Loss: 1.519 Test Acc: 0.588
Validation loss decreased (-0.557239 --> -0.587771).  Saving model ...
Epoch: 10 cost time: 1.6116623878479004
Epoch: 10, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.655 Vali Acc: 0.580 Test Loss: 1.655 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.315976619720459
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.679 Vali Acc: 0.557 Test Loss: 1.679 Test Acc: 0.557
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.8848395347595215
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.721 Vali Acc: 0.527 Test Loss: 1.721 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.1292707920074463
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.742 Vali Acc: 0.527 Test Loss: 1.742 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.983119010925293
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.751 Vali Acc: 0.534 Test Loss: 1.751 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.4288034439086914
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.749 Vali Acc: 0.527 Test Loss: 1.749 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.431004524230957
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.737 Vali Acc: 0.527 Test Loss: 1.737 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.960716962814331
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.714 Vali Acc: 0.534 Test Loss: 1.714 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.4831740856170654
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.712 Vali Acc: 0.542 Test Loss: 1.712 Test Acc: 0.542
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.2507376670837402
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.717 Vali Acc: 0.542 Test Loss: 1.717 Test Acc: 0.542
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps1285_str322_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5877862595419847
model parameter : 61422341
model size : 248.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps1285_str643_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.2706687450408936
Epoch: 1, Steps: 8 | Train Loss: 1.536 Vali Loss: 1.602 Vali Acc: 0.420 Test Loss: 1.602 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 1.1755940914154053
Epoch: 2, Steps: 8 | Train Loss: 1.393 Vali Loss: 1.508 Vali Acc: 0.435 Test Loss: 1.508 Test Acc: 0.435
Validation loss decreased (-0.419831 --> -0.435099).  Saving model ...
Epoch: 3 cost time: 1.561959981918335
Epoch: 3, Steps: 8 | Train Loss: 1.119 Vali Loss: 1.472 Vali Acc: 0.458 Test Loss: 1.472 Test Acc: 0.458
Validation loss decreased (-0.435099 --> -0.458001).  Saving model ...
Epoch: 4 cost time: 1.4095828533172607
Epoch: 4, Steps: 8 | Train Loss: 0.733 Vali Loss: 1.411 Vali Acc: 0.458 Test Loss: 1.411 Test Acc: 0.458
Validation loss decreased (-0.458001 --> -0.458001).  Saving model ...
Epoch: 5 cost time: 1.3444056510925293
Epoch: 5, Steps: 8 | Train Loss: 0.369 Vali Loss: 1.388 Vali Acc: 0.527 Test Loss: 1.388 Test Acc: 0.527
Validation loss decreased (-0.458001 --> -0.526704).  Saving model ...
Epoch: 6 cost time: 1.2453968524932861
Epoch: 6, Steps: 8 | Train Loss: 0.168 Vali Loss: 1.406 Vali Acc: 0.511 Test Loss: 1.406 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.394810438156128
Epoch: 7, Steps: 8 | Train Loss: 0.048 Vali Loss: 1.373 Vali Acc: 0.511 Test Loss: 1.373 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.3675756454467773
Epoch: 8, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.423 Vali Acc: 0.542 Test Loss: 1.423 Test Acc: 0.542
Validation loss decreased (-0.526704 --> -0.541970).  Saving model ...
Epoch: 9 cost time: 1.322669506072998
Epoch: 9, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.709 Vali Acc: 0.534 Test Loss: 1.709 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5380017757415771
Epoch: 10, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.721 Vali Acc: 0.542 Test Loss: 1.721 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.147411584854126
Epoch: 11, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.667 Vali Acc: 0.542 Test Loss: 1.667 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.4395074844360352
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.674 Vali Acc: 0.550 Test Loss: 1.674 Test Acc: 0.550
Validation loss decreased (-0.541970 --> -0.549602).  Saving model ...
Epoch: 13 cost time: 1.4713025093078613
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.698 Vali Acc: 0.550 Test Loss: 1.698 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.312272548675537
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.723 Vali Acc: 0.550 Test Loss: 1.723 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.614715814590454
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.749 Vali Acc: 0.542 Test Loss: 1.749 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.3319194316864014
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.760 Vali Acc: 0.557 Test Loss: 1.760 Test Acc: 0.557
Validation loss decreased (-0.549602 --> -0.557234).  Saving model ...
Epoch: 17 cost time: 1.4428892135620117
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.762 Vali Acc: 0.557 Test Loss: 1.762 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2807581424713135
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.768 Vali Acc: 0.557 Test Loss: 1.768 Test Acc: 0.557
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.765033483505249
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.780 Vali Acc: 0.550 Test Loss: 1.780 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.288445234298706
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.785 Vali Acc: 0.550 Test Loss: 1.785 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.2224068641662598
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.794 Vali Acc: 0.550 Test Loss: 1.794 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.4561340808868408
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.789 Vali Acc: 0.550 Test Loss: 1.789 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.1579649448394775
Epoch: 23, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.791 Vali Acc: 0.550 Test Loss: 1.791 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.593724250793457
Epoch: 24, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.785 Vali Acc: 0.542 Test Loss: 1.785 Test Acc: 0.542
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.9016854763031006
Epoch: 25, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.788 Vali Acc: 0.542 Test Loss: 1.788 Test Acc: 0.542
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.8898749351501465
Epoch: 26, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.791 Vali Acc: 0.542 Test Loss: 1.791 Test Acc: 0.542
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps1285_str643_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 61282565
model size : 248.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps1285_str1285_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.0288076400756836
Epoch: 1, Steps: 8 | Train Loss: 1.515 Vali Loss: 1.573 Vali Acc: 0.420 Test Loss: 1.573 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 1.593980312347412
Epoch: 2, Steps: 8 | Train Loss: 1.350 Vali Loss: 1.517 Vali Acc: 0.450 Test Loss: 1.517 Test Acc: 0.450
Validation loss decreased (-0.419832 --> -0.450367).  Saving model ...
Epoch: 3 cost time: 1.0765631198883057
Epoch: 3, Steps: 8 | Train Loss: 1.036 Vali Loss: 1.501 Vali Acc: 0.443 Test Loss: 1.501 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5424184799194336
Epoch: 4, Steps: 8 | Train Loss: 0.675 Vali Loss: 1.458 Vali Acc: 0.458 Test Loss: 1.458 Test Acc: 0.458
Validation loss decreased (-0.450367 --> -0.458001).  Saving model ...
Epoch: 5 cost time: 1.429603099822998
Epoch: 5, Steps: 8 | Train Loss: 0.393 Vali Loss: 1.426 Vali Acc: 0.511 Test Loss: 1.426 Test Acc: 0.511
Validation loss decreased (-0.458001 --> -0.511436).  Saving model ...
Epoch: 6 cost time: 1.5322294235229492
Epoch: 6, Steps: 8 | Train Loss: 0.197 Vali Loss: 1.536 Vali Acc: 0.511 Test Loss: 1.536 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4425039291381836
Epoch: 7, Steps: 8 | Train Loss: 0.088 Vali Loss: 1.616 Vali Acc: 0.473 Test Loss: 1.616 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.3715970516204834
Epoch: 8, Steps: 8 | Train Loss: 0.032 Vali Loss: 1.647 Vali Acc: 0.473 Test Loss: 1.647 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.3009402751922607
Epoch: 9, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.750 Vali Acc: 0.511 Test Loss: 1.750 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.4375402927398682
Epoch: 10, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.815 Vali Acc: 0.519 Test Loss: 1.815 Test Acc: 0.519
Validation loss decreased (-0.511436 --> -0.519066).  Saving model ...
Epoch: 11 cost time: 1.383420467376709
Epoch: 11, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.801 Vali Acc: 0.527 Test Loss: 1.801 Test Acc: 0.527
Validation loss decreased (-0.519066 --> -0.526700).  Saving model ...
Epoch: 12 cost time: 1.5714590549468994
Epoch: 12, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.786 Vali Acc: 0.550 Test Loss: 1.786 Test Acc: 0.550
Validation loss decreased (-0.526700 --> -0.549600).  Saving model ...
Epoch: 13 cost time: 1.4832909107208252
Epoch: 13, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.783 Vali Acc: 0.550 Test Loss: 1.783 Test Acc: 0.550
Validation loss decreased (-0.549600 --> -0.549600).  Saving model ...
Epoch: 14 cost time: 1.3237555027008057
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.791 Vali Acc: 0.542 Test Loss: 1.791 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.797417402267456
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.808 Vali Acc: 0.534 Test Loss: 1.808 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.567899227142334
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.828 Vali Acc: 0.542 Test Loss: 1.828 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.6350224018096924
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.841 Vali Acc: 0.550 Test Loss: 1.841 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.731717824935913
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.848 Vali Acc: 0.550 Test Loss: 1.848 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.3180649280548096
Epoch: 19, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.852 Vali Acc: 0.550 Test Loss: 1.852 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.5851848125457764
Epoch: 20, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.859 Vali Acc: 0.550 Test Loss: 1.859 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.4576702117919922
Epoch: 21, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.866 Vali Acc: 0.550 Test Loss: 1.866 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.25435209274292
Epoch: 22, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.871 Vali Acc: 0.550 Test Loss: 1.871 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.452627420425415
Epoch: 23, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.871 Vali Acc: 0.542 Test Loss: 1.871 Test Acc: 0.542
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps1285_str1285_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 61212677
model size : 248.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps1384_str346_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.699579954147339
Epoch: 1, Steps: 8 | Train Loss: 1.537 Vali Loss: 1.548 Vali Acc: 0.412 Test Loss: 1.548 Test Acc: 0.412
Validation loss decreased (inf --> -0.412198).  Saving model ...
Epoch: 2 cost time: 1.1866109371185303
Epoch: 2, Steps: 8 | Train Loss: 1.401 Vali Loss: 1.504 Vali Acc: 0.443 Test Loss: 1.504 Test Acc: 0.443
Validation loss decreased (-0.412198 --> -0.442733).  Saving model ...
Epoch: 3 cost time: 1.779594898223877
Epoch: 3, Steps: 8 | Train Loss: 1.059 Vali Loss: 1.394 Vali Acc: 0.504 Test Loss: 1.394 Test Acc: 0.504
Validation loss decreased (-0.442733 --> -0.503803).  Saving model ...
Epoch: 4 cost time: 1.4274635314941406
Epoch: 4, Steps: 8 | Train Loss: 0.730 Vali Loss: 1.460 Vali Acc: 0.519 Test Loss: 1.460 Test Acc: 0.519
Validation loss decreased (-0.503803 --> -0.519069).  Saving model ...
Epoch: 5 cost time: 1.5574514865875244
Epoch: 5, Steps: 8 | Train Loss: 0.384 Vali Loss: 1.384 Vali Acc: 0.496 Test Loss: 1.384 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.192420244216919
Epoch: 6, Steps: 8 | Train Loss: 0.123 Vali Loss: 1.553 Vali Acc: 0.473 Test Loss: 1.553 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.3893260955810547
Epoch: 7, Steps: 8 | Train Loss: 0.035 Vali Loss: 1.480 Vali Acc: 0.580 Test Loss: 1.480 Test Acc: 0.580
Validation loss decreased (-0.519069 --> -0.580138).  Saving model ...
Epoch: 8 cost time: 1.5466227531433105
Epoch: 8, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.576 Vali Acc: 0.550 Test Loss: 1.576 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.436140775680542
Epoch: 9, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.728 Vali Acc: 0.511 Test Loss: 1.728 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.9321131706237793
Epoch: 10, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.826 Vali Acc: 0.550 Test Loss: 1.826 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.2513487339019775
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.875 Vali Acc: 0.511 Test Loss: 1.875 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.021293878555298
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.877 Vali Acc: 0.511 Test Loss: 1.877 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.9096553325653076
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.889 Vali Acc: 0.534 Test Loss: 1.889 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.8266265392303467
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.911 Vali Acc: 0.542 Test Loss: 1.911 Test Acc: 0.542
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.588801622390747
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.933 Vali Acc: 0.542 Test Loss: 1.933 Test Acc: 0.542
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.346944808959961
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.952 Vali Acc: 0.542 Test Loss: 1.952 Test Acc: 0.542
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.7597672939300537
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.966 Vali Acc: 0.542 Test Loss: 1.966 Test Acc: 0.542
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps1384_str346_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5801526717557252
model parameter : 62769413
model size : 254.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps1384_str692_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.3188881874084473
Epoch: 1, Steps: 8 | Train Loss: 1.513 Vali Loss: 1.518 Vali Acc: 0.420 Test Loss: 1.518 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 0.8833255767822266
Epoch: 2, Steps: 8 | Train Loss: 1.309 Vali Loss: 1.407 Vali Acc: 0.458 Test Loss: 1.407 Test Acc: 0.458
Validation loss decreased (-0.419832 --> -0.458001).  Saving model ...
Epoch: 3 cost time: 1.0846922397613525
Epoch: 3, Steps: 8 | Train Loss: 0.989 Vali Loss: 1.348 Vali Acc: 0.542 Test Loss: 1.348 Test Acc: 0.542
Validation loss decreased (-0.458001 --> -0.541971).  Saving model ...
Epoch: 4 cost time: 1.6497275829315186
Epoch: 4, Steps: 8 | Train Loss: 0.661 Vali Loss: 1.296 Vali Acc: 0.542 Test Loss: 1.296 Test Acc: 0.542
Validation loss decreased (-0.541971 --> -0.541972).  Saving model ...
Epoch: 5 cost time: 1.3461170196533203
Epoch: 5, Steps: 8 | Train Loss: 0.331 Vali Loss: 1.368 Vali Acc: 0.527 Test Loss: 1.368 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.978917121887207
Epoch: 6, Steps: 8 | Train Loss: 0.147 Vali Loss: 1.593 Vali Acc: 0.542 Test Loss: 1.593 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.5697927474975586
Epoch: 7, Steps: 8 | Train Loss: 0.051 Vali Loss: 1.444 Vali Acc: 0.511 Test Loss: 1.444 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.279855728149414
Epoch: 8, Steps: 8 | Train Loss: 0.021 Vali Loss: 1.631 Vali Acc: 0.473 Test Loss: 1.631 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.1554276943206787
Epoch: 9, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.851 Vali Acc: 0.496 Test Loss: 1.851 Test Acc: 0.496
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.5151174068450928
Epoch: 10, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.820 Vali Acc: 0.527 Test Loss: 1.820 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.3976690769195557
Epoch: 11, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.794 Vali Acc: 0.588 Test Loss: 1.794 Test Acc: 0.588
Validation loss decreased (-0.541972 --> -0.587768).  Saving model ...
Epoch: 12 cost time: 1.3949437141418457
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.802 Vali Acc: 0.580 Test Loss: 1.802 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0076043605804443
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.810 Vali Acc: 0.580 Test Loss: 1.810 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.2027149200439453
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.824 Vali Acc: 0.580 Test Loss: 1.824 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.0588304996490479
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.833 Vali Acc: 0.580 Test Loss: 1.833 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.3526034355163574
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.841 Vali Acc: 0.580 Test Loss: 1.841 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.4252207279205322
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.856 Vali Acc: 0.580 Test Loss: 1.856 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.4187452793121338
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.867 Vali Acc: 0.580 Test Loss: 1.867 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.3650286197662354
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.875 Vali Acc: 0.580 Test Loss: 1.875 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.32639479637146
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.886 Vali Acc: 0.565 Test Loss: 1.886 Test Acc: 0.565
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.3419075012207031
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.900 Vali Acc: 0.565 Test Loss: 1.900 Test Acc: 0.565
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps1384_str692_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5877862595419847
model parameter : 62640389
model size : 253.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps1384_str1384_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.1816349029541016
Epoch: 1, Steps: 8 | Train Loss: 1.543 Vali Loss: 1.598 Vali Acc: 0.420 Test Loss: 1.598 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 0.9487438201904297
Epoch: 2, Steps: 8 | Train Loss: 1.353 Vali Loss: 1.465 Vali Acc: 0.435 Test Loss: 1.465 Test Acc: 0.435
Validation loss decreased (-0.419831 --> -0.435100).  Saving model ...
Epoch: 3 cost time: 0.9678058624267578
Epoch: 3, Steps: 8 | Train Loss: 1.045 Vali Loss: 1.373 Vali Acc: 0.504 Test Loss: 1.373 Test Acc: 0.504
Validation loss decreased (-0.435100 --> -0.503803).  Saving model ...
Epoch: 4 cost time: 1.004431962966919
Epoch: 4, Steps: 8 | Train Loss: 0.670 Vali Loss: 1.391 Vali Acc: 0.489 Test Loss: 1.391 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0760910511016846
Epoch: 5, Steps: 8 | Train Loss: 0.343 Vali Loss: 1.479 Vali Acc: 0.496 Test Loss: 1.479 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.2332193851470947
Epoch: 6, Steps: 8 | Train Loss: 0.138 Vali Loss: 1.537 Vali Acc: 0.489 Test Loss: 1.537 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.2013647556304932
Epoch: 7, Steps: 8 | Train Loss: 0.062 Vali Loss: 1.490 Vali Acc: 0.504 Test Loss: 1.490 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.3869028091430664
Epoch: 8, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.536 Vali Acc: 0.511 Test Loss: 1.536 Test Acc: 0.511
Validation loss decreased (-0.503803 --> -0.511435).  Saving model ...
Epoch: 9 cost time: 1.1650550365447998
Epoch: 9, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.608 Vali Acc: 0.511 Test Loss: 1.608 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2834248542785645
Epoch: 10, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.645 Vali Acc: 0.504 Test Loss: 1.645 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.1897389888763428
Epoch: 11, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.664 Vali Acc: 0.496 Test Loss: 1.664 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.2037405967712402
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.680 Vali Acc: 0.496 Test Loss: 1.680 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.186755657196045
Epoch: 13, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.688 Vali Acc: 0.489 Test Loss: 1.688 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.2410976886749268
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.695 Vali Acc: 0.489 Test Loss: 1.695 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.2547876834869385
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.706 Vali Acc: 0.489 Test Loss: 1.706 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.162557601928711
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.716 Vali Acc: 0.489 Test Loss: 1.716 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.1367177963256836
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.724 Vali Acc: 0.489 Test Loss: 1.724 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.2300443649291992
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.731 Vali Acc: 0.489 Test Loss: 1.731 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps1384_str1384_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5114503816793893
model parameter : 62575877
model size : 253.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps1499_str375_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.2315871715545654
Epoch: 1, Steps: 8 | Train Loss: 1.569 Vali Loss: 1.624 Vali Acc: 0.420 Test Loss: 1.624 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 1.2793095111846924
Epoch: 2, Steps: 8 | Train Loss: 1.365 Vali Loss: 1.542 Vali Acc: 0.443 Test Loss: 1.542 Test Acc: 0.443
Validation loss decreased (-0.419831 --> -0.442733).  Saving model ...
Epoch: 3 cost time: 1.5526225566864014
Epoch: 3, Steps: 8 | Train Loss: 0.988 Vali Loss: 1.456 Vali Acc: 0.466 Test Loss: 1.456 Test Acc: 0.466
Validation loss decreased (-0.442733 --> -0.465634).  Saving model ...
Epoch: 4 cost time: 1.449575662612915
Epoch: 4, Steps: 8 | Train Loss: 0.627 Vali Loss: 1.445 Vali Acc: 0.473 Test Loss: 1.445 Test Acc: 0.473
Validation loss decreased (-0.465634 --> -0.473268).  Saving model ...
Epoch: 5 cost time: 1.863487958908081
Epoch: 5, Steps: 8 | Train Loss: 0.274 Vali Loss: 1.328 Vali Acc: 0.519 Test Loss: 1.328 Test Acc: 0.519
Validation loss decreased (-0.473268 --> -0.519071).  Saving model ...
Epoch: 6 cost time: 1.165787935256958
Epoch: 6, Steps: 8 | Train Loss: 0.091 Vali Loss: 1.639 Vali Acc: 0.427 Test Loss: 1.639 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2423760890960693
Epoch: 7, Steps: 8 | Train Loss: 0.033 Vali Loss: 1.620 Vali Acc: 0.527 Test Loss: 1.620 Test Acc: 0.527
Validation loss decreased (-0.519071 --> -0.526701).  Saving model ...
Epoch: 8 cost time: 1.9146196842193604
Epoch: 8, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.574 Vali Acc: 0.450 Test Loss: 1.574 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4744832515716553
Epoch: 9, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.611 Vali Acc: 0.443 Test Loss: 1.611 Test Acc: 0.443
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.6013703346252441
Epoch: 10, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.689 Vali Acc: 0.504 Test Loss: 1.689 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.9257941246032715
Epoch: 11, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.728 Vali Acc: 0.511 Test Loss: 1.728 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.6649928092956543
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.745 Vali Acc: 0.504 Test Loss: 1.745 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.7108080387115479
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.785 Vali Acc: 0.496 Test Loss: 1.785 Test Acc: 0.496
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.758206844329834
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.803 Vali Acc: 0.496 Test Loss: 1.803 Test Acc: 0.496
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.6709556579589844
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.807 Vali Acc: 0.489 Test Loss: 1.807 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.4721510410308838
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.813 Vali Acc: 0.481 Test Loss: 1.813 Test Acc: 0.481
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.0614051818847656
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.813 Vali Acc: 0.489 Test Loss: 1.813 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps1499_str375_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 64337669
model size : 260.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps1499_str750_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.9392597675323486
Epoch: 1, Steps: 8 | Train Loss: 1.531 Vali Loss: 1.575 Vali Acc: 0.420 Test Loss: 1.575 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 2.137138843536377
Epoch: 2, Steps: 8 | Train Loss: 1.329 Vali Loss: 1.505 Vali Acc: 0.435 Test Loss: 1.505 Test Acc: 0.435
Validation loss decreased (-0.419832 --> -0.435099).  Saving model ...
Epoch: 3 cost time: 1.9663927555084229
Epoch: 3, Steps: 8 | Train Loss: 1.045 Vali Loss: 1.374 Vali Acc: 0.504 Test Loss: 1.374 Test Acc: 0.504
Validation loss decreased (-0.435099 --> -0.503803).  Saving model ...
Epoch: 4 cost time: 1.6667649745941162
Epoch: 4, Steps: 8 | Train Loss: 0.697 Vali Loss: 1.379 Vali Acc: 0.504 Test Loss: 1.379 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.302088737487793
Epoch: 5, Steps: 8 | Train Loss: 0.333 Vali Loss: 1.421 Vali Acc: 0.504 Test Loss: 1.421 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.489196538925171
Epoch: 6, Steps: 8 | Train Loss: 0.128 Vali Loss: 1.490 Vali Acc: 0.466 Test Loss: 1.490 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.5706682205200195
Epoch: 7, Steps: 8 | Train Loss: 0.040 Vali Loss: 1.531 Vali Acc: 0.504 Test Loss: 1.531 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.4566221237182617
Epoch: 8, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.644 Vali Acc: 0.458 Test Loss: 1.644 Test Acc: 0.458
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.4244427680969238
Epoch: 9, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.735 Vali Acc: 0.473 Test Loss: 1.735 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.4941191673278809
Epoch: 10, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.809 Vali Acc: 0.466 Test Loss: 1.809 Test Acc: 0.466
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.6397819519042969
Epoch: 11, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.824 Vali Acc: 0.473 Test Loss: 1.824 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.6816322803497314
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.847 Vali Acc: 0.458 Test Loss: 1.847 Test Acc: 0.458
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.9649538993835449
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.858 Vali Acc: 0.458 Test Loss: 1.858 Test Acc: 0.458
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps1499_str750_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5038167938931297
model parameter : 64219397
model size : 259.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps1499_str1499_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.4497342109680176
Epoch: 1, Steps: 8 | Train Loss: 1.503 Vali Loss: 1.525 Vali Acc: 0.420 Test Loss: 1.525 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 1.2927396297454834
Epoch: 2, Steps: 8 | Train Loss: 1.333 Vali Loss: 1.473 Vali Acc: 0.435 Test Loss: 1.473 Test Acc: 0.435
Validation loss decreased (-0.419832 --> -0.435100).  Saving model ...
Epoch: 3 cost time: 1.9411671161651611
Epoch: 3, Steps: 8 | Train Loss: 1.023 Vali Loss: 1.429 Vali Acc: 0.511 Test Loss: 1.429 Test Acc: 0.511
Validation loss decreased (-0.435100 --> -0.511436).  Saving model ...
Epoch: 4 cost time: 1.3352744579315186
Epoch: 4, Steps: 8 | Train Loss: 0.668 Vali Loss: 1.449 Vali Acc: 0.435 Test Loss: 1.449 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.318110466003418
Epoch: 5, Steps: 8 | Train Loss: 0.338 Vali Loss: 1.475 Vali Acc: 0.496 Test Loss: 1.475 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.6025357246398926
Epoch: 6, Steps: 8 | Train Loss: 0.142 Vali Loss: 1.539 Vali Acc: 0.466 Test Loss: 1.539 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.5469632148742676
Epoch: 7, Steps: 8 | Train Loss: 0.064 Vali Loss: 1.634 Vali Acc: 0.435 Test Loss: 1.634 Test Acc: 0.435
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.5235533714294434
Epoch: 8, Steps: 8 | Train Loss: 0.028 Vali Loss: 1.601 Vali Acc: 0.489 Test Loss: 1.601 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.5258095264434814
Epoch: 9, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.619 Vali Acc: 0.534 Test Loss: 1.619 Test Acc: 0.534
Validation loss decreased (-0.511436 --> -0.534335).  Saving model ...
Epoch: 10 cost time: 1.5264832973480225
Epoch: 10, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.664 Vali Acc: 0.519 Test Loss: 1.664 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3172781467437744
Epoch: 11, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.667 Vali Acc: 0.519 Test Loss: 1.667 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.3514657020568848
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.666 Vali Acc: 0.511 Test Loss: 1.666 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.3619904518127441
Epoch: 13, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.665 Vali Acc: 0.519 Test Loss: 1.665 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.3080880641937256
Epoch: 14, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.668 Vali Acc: 0.519 Test Loss: 1.668 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.5638229846954346
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.670 Vali Acc: 0.519 Test Loss: 1.670 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.354663372039795
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.680 Vali Acc: 0.519 Test Loss: 1.680 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.6821413040161133
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.688 Vali Acc: 0.519 Test Loss: 1.688 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.5359063148498535
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.692 Vali Acc: 0.519 Test Loss: 1.692 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.4181950092315674
Epoch: 19, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.697 Vali Acc: 0.519 Test Loss: 1.697 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps1499_str1499_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 64160261
model size : 259.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps1635_str409_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.2411580085754395
Epoch: 1, Steps: 8 | Train Loss: 1.576 Vali Loss: 1.587 Vali Acc: 0.420 Test Loss: 1.587 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 1.578707218170166
Epoch: 2, Steps: 8 | Train Loss: 1.348 Vali Loss: 1.579 Vali Acc: 0.435 Test Loss: 1.579 Test Acc: 0.435
Validation loss decreased (-0.419831 --> -0.435099).  Saving model ...
Epoch: 3 cost time: 1.5316414833068848
Epoch: 3, Steps: 8 | Train Loss: 1.018 Vali Loss: 1.405 Vali Acc: 0.511 Test Loss: 1.405 Test Acc: 0.511
Validation loss decreased (-0.435099 --> -0.511436).  Saving model ...
Epoch: 4 cost time: 1.4303717613220215
Epoch: 4, Steps: 8 | Train Loss: 0.632 Vali Loss: 1.405 Vali Acc: 0.489 Test Loss: 1.405 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.431884765625
Epoch: 5, Steps: 8 | Train Loss: 0.308 Vali Loss: 1.369 Vali Acc: 0.511 Test Loss: 1.369 Test Acc: 0.511
Validation loss decreased (-0.511436 --> -0.511437).  Saving model ...
Epoch: 6 cost time: 1.6455886363983154
Epoch: 6, Steps: 8 | Train Loss: 0.099 Vali Loss: 1.358 Vali Acc: 0.443 Test Loss: 1.358 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.678551197052002
Epoch: 7, Steps: 8 | Train Loss: 0.050 Vali Loss: 1.504 Vali Acc: 0.504 Test Loss: 1.504 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.3842780590057373
Epoch: 8, Steps: 8 | Train Loss: 0.025 Vali Loss: 1.463 Vali Acc: 0.565 Test Loss: 1.463 Test Acc: 0.565
Validation loss decreased (-0.511437 --> -0.564871).  Saving model ...
Epoch: 9 cost time: 1.4651250839233398
Epoch: 9, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.740 Vali Acc: 0.534 Test Loss: 1.740 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5620975494384766
Epoch: 10, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.664 Vali Acc: 0.542 Test Loss: 1.664 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.6921441555023193
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.686 Vali Acc: 0.542 Test Loss: 1.686 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.7888977527618408
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.724 Vali Acc: 0.557 Test Loss: 1.724 Test Acc: 0.557
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.076432704925537
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.752 Vali Acc: 0.542 Test Loss: 1.752 Test Acc: 0.542
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.5804955959320068
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.766 Vali Acc: 0.542 Test Loss: 1.766 Test Acc: 0.542
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.8331711292266846
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.779 Vali Acc: 0.542 Test Loss: 1.779 Test Acc: 0.542
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.9495301246643066
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.781 Vali Acc: 0.542 Test Loss: 1.781 Test Acc: 0.542
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.6114044189453125
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.782 Vali Acc: 0.542 Test Loss: 1.782 Test Acc: 0.542
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.089202642440796
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.800 Vali Acc: 0.527 Test Loss: 1.800 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps1635_str409_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5648854961832062
model parameter : 66196229
model size : 267.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps1635_str818_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.459383249282837
Epoch: 1, Steps: 8 | Train Loss: 1.479 Vali Loss: 1.589 Vali Acc: 0.420 Test Loss: 1.589 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 1.798034906387329
Epoch: 2, Steps: 8 | Train Loss: 1.325 Vali Loss: 1.533 Vali Acc: 0.458 Test Loss: 1.533 Test Acc: 0.458
Validation loss decreased (-0.419831 --> -0.458000).  Saving model ...
Epoch: 3 cost time: 1.7783257961273193
Epoch: 3, Steps: 8 | Train Loss: 0.989 Vali Loss: 1.529 Vali Acc: 0.435 Test Loss: 1.529 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.559236764907837
Epoch: 4, Steps: 8 | Train Loss: 0.623 Vali Loss: 1.490 Vali Acc: 0.496 Test Loss: 1.490 Test Acc: 0.496
Validation loss decreased (-0.458000 --> -0.496168).  Saving model ...
Epoch: 5 cost time: 1.6795828342437744
Epoch: 5, Steps: 8 | Train Loss: 0.319 Vali Loss: 1.403 Vali Acc: 0.443 Test Loss: 1.403 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.509972333908081
Epoch: 6, Steps: 8 | Train Loss: 0.131 Vali Loss: 1.452 Vali Acc: 0.527 Test Loss: 1.452 Test Acc: 0.527
Validation loss decreased (-0.496168 --> -0.526703).  Saving model ...
Epoch: 7 cost time: 1.5761752128601074
Epoch: 7, Steps: 8 | Train Loss: 0.043 Vali Loss: 1.593 Vali Acc: 0.466 Test Loss: 1.593 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6430773735046387
Epoch: 8, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.714 Vali Acc: 0.496 Test Loss: 1.714 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.8643145561218262
Epoch: 9, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.792 Vali Acc: 0.489 Test Loss: 1.792 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.4047791957855225
Epoch: 10, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.829 Vali Acc: 0.489 Test Loss: 1.829 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.607372760772705
Epoch: 11, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.853 Vali Acc: 0.481 Test Loss: 1.853 Test Acc: 0.481
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.5880050659179688
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.873 Vali Acc: 0.481 Test Loss: 1.873 Test Acc: 0.481
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.1233723163604736
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.885 Vali Acc: 0.496 Test Loss: 1.885 Test Acc: 0.496
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.5512232780456543
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.893 Vali Acc: 0.504 Test Loss: 1.893 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.537818193435669
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.898 Vali Acc: 0.504 Test Loss: 1.898 Test Acc: 0.504
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.7703862190246582
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.908 Vali Acc: 0.496 Test Loss: 1.908 Test Acc: 0.496
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps1635_str818_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 66088709
model size : 266.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps1635_str1635_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.9742918014526367
Epoch: 1, Steps: 8 | Train Loss: 1.588 Vali Loss: 1.563 Vali Acc: 0.420 Test Loss: 1.563 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 1.2553009986877441
Epoch: 2, Steps: 8 | Train Loss: 1.331 Vali Loss: 1.484 Vali Acc: 0.481 Test Loss: 1.484 Test Acc: 0.481
Validation loss decreased (-0.419832 --> -0.480901).  Saving model ...
Epoch: 3 cost time: 1.2188513278961182
Epoch: 3, Steps: 8 | Train Loss: 0.998 Vali Loss: 1.439 Vali Acc: 0.504 Test Loss: 1.439 Test Acc: 0.504
Validation loss decreased (-0.480901 --> -0.503802).  Saving model ...
Epoch: 4 cost time: 1.330202341079712
Epoch: 4, Steps: 8 | Train Loss: 0.647 Vali Loss: 1.417 Vali Acc: 0.435 Test Loss: 1.417 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2929916381835938
Epoch: 5, Steps: 8 | Train Loss: 0.299 Vali Loss: 1.532 Vali Acc: 0.496 Test Loss: 1.532 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.301819086074829
Epoch: 6, Steps: 8 | Train Loss: 0.138 Vali Loss: 1.564 Vali Acc: 0.458 Test Loss: 1.564 Test Acc: 0.458
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.251636028289795
Epoch: 7, Steps: 8 | Train Loss: 0.059 Vali Loss: 1.552 Vali Acc: 0.435 Test Loss: 1.552 Test Acc: 0.435
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.5365355014801025
Epoch: 8, Steps: 8 | Train Loss: 0.025 Vali Loss: 1.651 Vali Acc: 0.496 Test Loss: 1.651 Test Acc: 0.496
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.7014384269714355
Epoch: 9, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.633 Vali Acc: 0.496 Test Loss: 1.633 Test Acc: 0.496
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.7192423343658447
Epoch: 10, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.642 Vali Acc: 0.481 Test Loss: 1.642 Test Acc: 0.481
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.9237980842590332
Epoch: 11, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.663 Vali Acc: 0.504 Test Loss: 1.663 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.2591636180877686
Epoch: 12, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.697 Vali Acc: 0.542 Test Loss: 1.697 Test Acc: 0.542
Validation loss decreased (-0.503802 --> -0.541968).  Saving model ...
Epoch: 13 cost time: 1.2813515663146973
Epoch: 13, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.734 Vali Acc: 0.527 Test Loss: 1.734 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.5974757671356201
Epoch: 14, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.765 Vali Acc: 0.519 Test Loss: 1.765 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.35957670211792
Epoch: 15, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.779 Vali Acc: 0.519 Test Loss: 1.779 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.7475895881652832
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.787 Vali Acc: 0.511 Test Loss: 1.787 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.7041168212890625
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.796 Vali Acc: 0.511 Test Loss: 1.796 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.3886747360229492
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.801 Vali Acc: 0.527 Test Loss: 1.801 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.2755041122436523
Epoch: 19, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.803 Vali Acc: 0.527 Test Loss: 1.803 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.3770532608032227
Epoch: 20, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.809 Vali Acc: 0.527 Test Loss: 1.809 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.3872013092041016
Epoch: 21, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.816 Vali Acc: 0.527 Test Loss: 1.816 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.4288763999938965
Epoch: 22, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.823 Vali Acc: 0.527 Test Loss: 1.823 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps1635_str1635_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 66034949
model size : 266.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps1799_str450_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.248814821243286
Epoch: 1, Steps: 8 | Train Loss: 1.529 Vali Loss: 1.608 Vali Acc: 0.420 Test Loss: 1.608 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 1.5228841304779053
Epoch: 2, Steps: 8 | Train Loss: 1.362 Vali Loss: 1.476 Vali Acc: 0.450 Test Loss: 1.476 Test Acc: 0.450
Validation loss decreased (-0.419831 --> -0.450367).  Saving model ...
Epoch: 3 cost time: 1.7252087593078613
Epoch: 3, Steps: 8 | Train Loss: 0.972 Vali Loss: 1.359 Vali Acc: 0.527 Test Loss: 1.359 Test Acc: 0.527
Validation loss decreased (-0.450367 --> -0.526704).  Saving model ...
Epoch: 4 cost time: 1.8164327144622803
Epoch: 4, Steps: 8 | Train Loss: 0.571 Vali Loss: 1.329 Vali Acc: 0.519 Test Loss: 1.329 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3728327751159668
Epoch: 5, Steps: 8 | Train Loss: 0.231 Vali Loss: 1.357 Vali Acc: 0.550 Test Loss: 1.357 Test Acc: 0.550
Validation loss decreased (-0.526704 --> -0.549605).  Saving model ...
Epoch: 6 cost time: 1.8258049488067627
Epoch: 6, Steps: 8 | Train Loss: 0.067 Vali Loss: 1.572 Vali Acc: 0.534 Test Loss: 1.572 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.662729024887085
Epoch: 7, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.578 Vali Acc: 0.527 Test Loss: 1.578 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.774585247039795
Epoch: 8, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.611 Vali Acc: 0.511 Test Loss: 1.611 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.5326814651489258
Epoch: 9, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.713 Vali Acc: 0.527 Test Loss: 1.713 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.5256016254425049
Epoch: 10, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.816 Vali Acc: 0.557 Test Loss: 1.816 Test Acc: 0.557
Validation loss decreased (-0.549605 --> -0.557234).  Saving model ...
Epoch: 11 cost time: 2.229853391647339
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.864 Vali Acc: 0.557 Test Loss: 1.864 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.2415506839752197
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.886 Vali Acc: 0.565 Test Loss: 1.886 Test Acc: 0.565
Validation loss decreased (-0.557234 --> -0.564867).  Saving model ...
Epoch: 13 cost time: 1.3402631282806396
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.880 Vali Acc: 0.557 Test Loss: 1.880 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3478777408599854
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.869 Vali Acc: 0.557 Test Loss: 1.869 Test Acc: 0.557
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.7933027744293213
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.860 Vali Acc: 0.557 Test Loss: 1.860 Test Acc: 0.557
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.673635721206665
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.859 Vali Acc: 0.565 Test Loss: 1.859 Test Acc: 0.565
Validation loss decreased (-0.564867 --> -0.564867).  Saving model ...
Epoch: 17 cost time: 1.7672247886657715
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.862 Vali Acc: 0.565 Test Loss: 1.862 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.7532267570495605
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.875 Vali Acc: 0.565 Test Loss: 1.875 Test Acc: 0.565
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.2765471935272217
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.886 Vali Acc: 0.565 Test Loss: 1.886 Test Acc: 0.565
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.8963556289672852
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.882 Vali Acc: 0.565 Test Loss: 1.882 Test Acc: 0.565
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.9322459697723389
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.878 Vali Acc: 0.565 Test Loss: 1.878 Test Acc: 0.565
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.8172411918640137
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.873 Vali Acc: 0.565 Test Loss: 1.873 Test Acc: 0.565
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.720824956893921
Epoch: 23, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.874 Vali Acc: 0.565 Test Loss: 1.874 Test Acc: 0.565
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.444108486175537
Epoch: 24, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.878 Vali Acc: 0.565 Test Loss: 1.878 Test Acc: 0.565
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.0267202854156494
Epoch: 25, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.885 Vali Acc: 0.565 Test Loss: 1.885 Test Acc: 0.565
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.4233274459838867
Epoch: 26, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.897 Vali Acc: 0.565 Test Loss: 1.897 Test Acc: 0.565
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps1799_str450_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5648854961832062
model parameter : 68441861
model size : 275.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps1799_str900_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.4909658432006836
Epoch: 1, Steps: 8 | Train Loss: 1.645 Vali Loss: 1.556 Vali Acc: 0.420 Test Loss: 1.556 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 1.2603132724761963
Epoch: 2, Steps: 8 | Train Loss: 1.313 Vali Loss: 1.475 Vali Acc: 0.450 Test Loss: 1.475 Test Acc: 0.450
Validation loss decreased (-0.419832 --> -0.450367).  Saving model ...
Epoch: 3 cost time: 2.777292013168335
Epoch: 3, Steps: 8 | Train Loss: 1.013 Vali Loss: 1.441 Vali Acc: 0.458 Test Loss: 1.441 Test Acc: 0.458
Validation loss decreased (-0.450367 --> -0.458001).  Saving model ...
Epoch: 4 cost time: 1.8805363178253174
Epoch: 4, Steps: 8 | Train Loss: 0.588 Vali Loss: 1.499 Vali Acc: 0.511 Test Loss: 1.499 Test Acc: 0.511
Validation loss decreased (-0.458001 --> -0.511435).  Saving model ...
Epoch: 5 cost time: 1.6385362148284912
Epoch: 5, Steps: 8 | Train Loss: 0.291 Vali Loss: 1.447 Vali Acc: 0.504 Test Loss: 1.447 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3994152545928955
Epoch: 6, Steps: 8 | Train Loss: 0.113 Vali Loss: 1.537 Vali Acc: 0.504 Test Loss: 1.537 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.5455503463745117
Epoch: 7, Steps: 8 | Train Loss: 0.030 Vali Loss: 1.570 Vali Acc: 0.473 Test Loss: 1.570 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.6777417659759521
Epoch: 8, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.720 Vali Acc: 0.504 Test Loss: 1.720 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.6705777645111084
Epoch: 9, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.775 Vali Acc: 0.534 Test Loss: 1.775 Test Acc: 0.534
Validation loss decreased (-0.511435 --> -0.534333).  Saving model ...
Epoch: 10 cost time: 1.5993142127990723
Epoch: 10, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.812 Vali Acc: 0.519 Test Loss: 1.812 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6666173934936523
Epoch: 11, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.861 Vali Acc: 0.550 Test Loss: 1.861 Test Acc: 0.550
Validation loss decreased (-0.534333 --> -0.549600).  Saving model ...
Epoch: 12 cost time: 1.698082447052002
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.873 Vali Acc: 0.557 Test Loss: 1.873 Test Acc: 0.557
Validation loss decreased (-0.549600 --> -0.557233).  Saving model ...
Epoch: 13 cost time: 1.412888765335083
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.882 Vali Acc: 0.557 Test Loss: 1.882 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.8037312030792236
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.889 Vali Acc: 0.542 Test Loss: 1.889 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.8426613807678223
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.903 Vali Acc: 0.519 Test Loss: 1.903 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.715120553970337
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.921 Vali Acc: 0.519 Test Loss: 1.921 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.8873746395111084
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.939 Vali Acc: 0.519 Test Loss: 1.939 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.5679662227630615
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.953 Vali Acc: 0.527 Test Loss: 1.953 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.413423538208008
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.966 Vali Acc: 0.527 Test Loss: 1.966 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.4848761558532715
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.980 Vali Acc: 0.527 Test Loss: 1.980 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.866304874420166
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.988 Vali Acc: 0.527 Test Loss: 1.988 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.7584619522094727
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.997 Vali Acc: 0.519 Test Loss: 1.997 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps1799_str900_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 68345093
model size : 275.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps1799_str1799_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.3390719890594482
Epoch: 1, Steps: 8 | Train Loss: 1.537 Vali Loss: 1.549 Vali Acc: 0.420 Test Loss: 1.549 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 1.4585700035095215
Epoch: 2, Steps: 8 | Train Loss: 1.325 Vali Loss: 1.540 Vali Acc: 0.420 Test Loss: 1.540 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 1.4170899391174316
Epoch: 3, Steps: 8 | Train Loss: 1.031 Vali Loss: 1.526 Vali Acc: 0.466 Test Loss: 1.526 Test Acc: 0.466
Validation loss decreased (-0.419832 --> -0.465634).  Saving model ...
Epoch: 4 cost time: 1.5817131996154785
Epoch: 4, Steps: 8 | Train Loss: 0.609 Vali Loss: 1.502 Vali Acc: 0.489 Test Loss: 1.502 Test Acc: 0.489
Validation loss decreased (-0.465634 --> -0.488535).  Saving model ...
Epoch: 5 cost time: 1.7264041900634766
Epoch: 5, Steps: 8 | Train Loss: 0.293 Vali Loss: 1.539 Vali Acc: 0.511 Test Loss: 1.539 Test Acc: 0.511
Validation loss decreased (-0.488535 --> -0.511435).  Saving model ...
Epoch: 6 cost time: 1.308089017868042
Epoch: 6, Steps: 8 | Train Loss: 0.109 Vali Loss: 1.482 Vali Acc: 0.496 Test Loss: 1.482 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3532776832580566
Epoch: 7, Steps: 8 | Train Loss: 0.034 Vali Loss: 1.540 Vali Acc: 0.489 Test Loss: 1.540 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.3600647449493408
Epoch: 8, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.628 Vali Acc: 0.489 Test Loss: 1.628 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.4191577434539795
Epoch: 9, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.707 Vali Acc: 0.504 Test Loss: 1.707 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.4861655235290527
Epoch: 10, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.754 Vali Acc: 0.504 Test Loss: 1.754 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.5173165798187256
Epoch: 11, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.767 Vali Acc: 0.504 Test Loss: 1.767 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.5396037101745605
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.769 Vali Acc: 0.496 Test Loss: 1.769 Test Acc: 0.496
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.8337271213531494
Epoch: 13, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.786 Vali Acc: 0.496 Test Loss: 1.786 Test Acc: 0.496
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.5741753578186035
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.805 Vali Acc: 0.504 Test Loss: 1.805 Test Acc: 0.504
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.3607065677642822
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.822 Vali Acc: 0.504 Test Loss: 1.822 Test Acc: 0.504
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps1799_str1799_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5114503816793893
model parameter : 68296709
model size : 275.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps1999_str500_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.699866533279419
Epoch: 1, Steps: 8 | Train Loss: 1.587 Vali Loss: 1.550 Vali Acc: 0.420 Test Loss: 1.550 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 2.197327136993408
Epoch: 2, Steps: 8 | Train Loss: 1.261 Vali Loss: 1.437 Vali Acc: 0.450 Test Loss: 1.437 Test Acc: 0.450
Validation loss decreased (-0.419832 --> -0.450367).  Saving model ...
Epoch: 3 cost time: 2.0243284702301025
Epoch: 3, Steps: 8 | Train Loss: 0.874 Vali Loss: 1.402 Vali Acc: 0.466 Test Loss: 1.402 Test Acc: 0.466
Validation loss decreased (-0.450367 --> -0.465635).  Saving model ...
Epoch: 4 cost time: 1.7003428936004639
Epoch: 4, Steps: 8 | Train Loss: 0.472 Vali Loss: 1.434 Vali Acc: 0.489 Test Loss: 1.434 Test Acc: 0.489
Validation loss decreased (-0.465635 --> -0.488535).  Saving model ...
Epoch: 5 cost time: 1.7165477275848389
Epoch: 5, Steps: 8 | Train Loss: 0.198 Vali Loss: 1.318 Vali Acc: 0.504 Test Loss: 1.318 Test Acc: 0.504
Validation loss decreased (-0.488535 --> -0.503804).  Saving model ...
Epoch: 6 cost time: 2.5738940238952637
Epoch: 6, Steps: 8 | Train Loss: 0.057 Vali Loss: 1.372 Vali Acc: 0.542 Test Loss: 1.372 Test Acc: 0.542
Validation loss decreased (-0.503804 --> -0.541971).  Saving model ...
Epoch: 7 cost time: 2.1086349487304688
Epoch: 7, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.346 Vali Acc: 0.580 Test Loss: 1.346 Test Acc: 0.580
Validation loss decreased (-0.541971 --> -0.580139).  Saving model ...
Epoch: 8 cost time: 2.073734998703003
Epoch: 8, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.376 Vali Acc: 0.588 Test Loss: 1.376 Test Acc: 0.588
Validation loss decreased (-0.580139 --> -0.587772).  Saving model ...
Epoch: 9 cost time: 1.4035522937774658
Epoch: 9, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.458 Vali Acc: 0.580 Test Loss: 1.458 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.603247880935669
Epoch: 10, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.511 Vali Acc: 0.588 Test Loss: 1.511 Test Acc: 0.588
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.227334499359131
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.535 Vali Acc: 0.580 Test Loss: 1.535 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.8873627185821533
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.534 Vali Acc: 0.580 Test Loss: 1.534 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.168846607208252
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.532 Vali Acc: 0.580 Test Loss: 1.532 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.6427083015441895
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.530 Vali Acc: 0.573 Test Loss: 1.530 Test Acc: 0.573
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.762038230895996
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.522 Vali Acc: 0.580 Test Loss: 1.522 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.010633945465088
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.519 Vali Acc: 0.580 Test Loss: 1.519 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.6548733711242676
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.522 Vali Acc: 0.580 Test Loss: 1.522 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.4082138538360596
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.536 Vali Acc: 0.580 Test Loss: 1.536 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps1999_str500_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5877862595419847
model parameter : 71185157
model size : 286.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps1999_str1000_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.279919147491455
Epoch: 1, Steps: 8 | Train Loss: 1.582 Vali Loss: 1.556 Vali Acc: 0.420 Test Loss: 1.556 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 1.9650890827178955
Epoch: 2, Steps: 8 | Train Loss: 1.287 Vali Loss: 1.549 Vali Acc: 0.420 Test Loss: 1.549 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 1.126671314239502
Epoch: 3, Steps: 8 | Train Loss: 0.874 Vali Loss: 1.453 Vali Acc: 0.466 Test Loss: 1.453 Test Acc: 0.466
Validation loss decreased (-0.419832 --> -0.465634).  Saving model ...
Epoch: 4 cost time: 1.7780280113220215
Epoch: 4, Steps: 8 | Train Loss: 0.502 Vali Loss: 1.496 Vali Acc: 0.473 Test Loss: 1.496 Test Acc: 0.473
Validation loss decreased (-0.465634 --> -0.473267).  Saving model ...
Epoch: 5 cost time: 1.2465214729309082
Epoch: 5, Steps: 8 | Train Loss: 0.200 Vali Loss: 1.557 Vali Acc: 0.473 Test Loss: 1.557 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5021779537200928
Epoch: 6, Steps: 8 | Train Loss: 0.070 Vali Loss: 1.624 Vali Acc: 0.496 Test Loss: 1.624 Test Acc: 0.496
Validation loss decreased (-0.473267 --> -0.496167).  Saving model ...
Epoch: 7 cost time: 1.0318922996520996
Epoch: 7, Steps: 8 | Train Loss: 0.019 Vali Loss: 1.638 Vali Acc: 0.511 Test Loss: 1.638 Test Acc: 0.511
Validation loss decreased (-0.496167 --> -0.511434).  Saving model ...
Epoch: 8 cost time: 2.1934080123901367
Epoch: 8, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.669 Vali Acc: 0.504 Test Loss: 1.669 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.147151470184326
Epoch: 9, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.711 Vali Acc: 0.511 Test Loss: 1.711 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.1640143394470215
Epoch: 10, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.731 Vali Acc: 0.504 Test Loss: 1.731 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.9328691959381104
Epoch: 11, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.752 Vali Acc: 0.511 Test Loss: 1.752 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.699502944946289
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.750 Vali Acc: 0.504 Test Loss: 1.750 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.5547821521759033
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.746 Vali Acc: 0.496 Test Loss: 1.746 Test Acc: 0.496
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.5127241611480713
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.751 Vali Acc: 0.496 Test Loss: 1.751 Test Acc: 0.496
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.9192605018615723
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.763 Vali Acc: 0.504 Test Loss: 1.763 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.4366309642791748
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.779 Vali Acc: 0.511 Test Loss: 1.779 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.2930395603179932
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.792 Vali Acc: 0.511 Test Loss: 1.792 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps1999_str1000_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5114503816793893
model parameter : 71099141
model size : 285.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps1999_str1999_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.6959493160247803
Epoch: 1, Steps: 8 | Train Loss: 1.505 Vali Loss: 1.536 Vali Acc: 0.420 Test Loss: 1.536 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 1.303335189819336
Epoch: 2, Steps: 8 | Train Loss: 1.290 Vali Loss: 1.504 Vali Acc: 0.435 Test Loss: 1.504 Test Acc: 0.435
Validation loss decreased (-0.419832 --> -0.435099).  Saving model ...
Epoch: 3 cost time: 1.1956713199615479
Epoch: 3, Steps: 8 | Train Loss: 0.894 Vali Loss: 1.527 Vali Acc: 0.443 Test Loss: 1.527 Test Acc: 0.443
Validation loss decreased (-0.435099 --> -0.442733).  Saving model ...
Epoch: 4 cost time: 1.5526697635650635
Epoch: 4, Steps: 8 | Train Loss: 0.526 Vali Loss: 1.562 Vali Acc: 0.466 Test Loss: 1.562 Test Acc: 0.466
Validation loss decreased (-0.442733 --> -0.465633).  Saving model ...
Epoch: 5 cost time: 1.6678135395050049
Epoch: 5, Steps: 8 | Train Loss: 0.257 Vali Loss: 1.605 Vali Acc: 0.489 Test Loss: 1.605 Test Acc: 0.489
Validation loss decreased (-0.465633 --> -0.488534).  Saving model ...
Epoch: 6 cost time: 1.4155867099761963
Epoch: 6, Steps: 8 | Train Loss: 0.094 Vali Loss: 1.592 Vali Acc: 0.450 Test Loss: 1.592 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.8436131477355957
Epoch: 7, Steps: 8 | Train Loss: 0.032 Vali Loss: 1.672 Vali Acc: 0.466 Test Loss: 1.672 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.4828290939331055
Epoch: 8, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.725 Vali Acc: 0.473 Test Loss: 1.725 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.3745193481445312
Epoch: 9, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.755 Vali Acc: 0.473 Test Loss: 1.755 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.2758448123931885
Epoch: 10, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.784 Vali Acc: 0.466 Test Loss: 1.784 Test Acc: 0.466
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.873037338256836
Epoch: 11, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.820 Vali Acc: 0.466 Test Loss: 1.820 Test Acc: 0.466
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.3307976722717285
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.838 Vali Acc: 0.458 Test Loss: 1.838 Test Acc: 0.458
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.3492364883422852
Epoch: 13, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.856 Vali Acc: 0.458 Test Loss: 1.856 Test Acc: 0.458
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.3411006927490234
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.874 Vali Acc: 0.458 Test Loss: 1.874 Test Acc: 0.458
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.641937494277954
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.886 Vali Acc: 0.466 Test Loss: 1.886 Test Acc: 0.466
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps1999_str1999_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.48854961832061067
model parameter : 71056133
model size : 285.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps2248_str562_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.63328218460083
Epoch: 1, Steps: 8 | Train Loss: 1.554 Vali Loss: 1.583 Vali Acc: 0.420 Test Loss: 1.583 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 1.814152479171753
Epoch: 2, Steps: 8 | Train Loss: 1.296 Vali Loss: 1.466 Vali Acc: 0.397 Test Loss: 1.466 Test Acc: 0.397
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.690880298614502
Epoch: 3, Steps: 8 | Train Loss: 0.874 Vali Loss: 1.394 Vali Acc: 0.511 Test Loss: 1.394 Test Acc: 0.511
Validation loss decreased (-0.419832 --> -0.511436).  Saving model ...
Epoch: 4 cost time: 1.8992106914520264
Epoch: 4, Steps: 8 | Train Loss: 0.513 Vali Loss: 1.390 Vali Acc: 0.473 Test Loss: 1.390 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.467346668243408
Epoch: 5, Steps: 8 | Train Loss: 0.215 Vali Loss: 1.531 Vali Acc: 0.481 Test Loss: 1.531 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.867368459701538
Epoch: 6, Steps: 8 | Train Loss: 0.062 Vali Loss: 1.588 Vali Acc: 0.473 Test Loss: 1.588 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.6538190841674805
Epoch: 7, Steps: 8 | Train Loss: 0.028 Vali Loss: 1.597 Vali Acc: 0.481 Test Loss: 1.597 Test Acc: 0.481
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.5331506729125977
Epoch: 8, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.698 Vali Acc: 0.519 Test Loss: 1.698 Test Acc: 0.519
Validation loss decreased (-0.511436 --> -0.519067).  Saving model ...
Epoch: 9 cost time: 1.39304518699646
Epoch: 9, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.806 Vali Acc: 0.504 Test Loss: 1.806 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2627019882202148
Epoch: 10, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.833 Vali Acc: 0.473 Test Loss: 1.833 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.4203789234161377
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.863 Vali Acc: 0.458 Test Loss: 1.863 Test Acc: 0.458
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.4226346015930176
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.886 Vali Acc: 0.458 Test Loss: 1.886 Test Acc: 0.458
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.6475870609283447
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.911 Vali Acc: 0.481 Test Loss: 1.911 Test Acc: 0.481
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.4928510189056396
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.935 Vali Acc: 0.473 Test Loss: 1.935 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.2651278972625732
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.954 Vali Acc: 0.481 Test Loss: 1.954 Test Acc: 0.481
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.7620034217834473
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.965 Vali Acc: 0.481 Test Loss: 1.965 Test Acc: 0.481
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.142216682434082
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.983 Vali Acc: 0.489 Test Loss: 1.983 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.8580322265625
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.994 Vali Acc: 0.489 Test Loss: 1.994 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps2248_str562_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 74611205
model size : 299.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps2248_str1124_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.936753273010254
Epoch: 1, Steps: 8 | Train Loss: 1.506 Vali Loss: 1.559 Vali Acc: 0.420 Test Loss: 1.559 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 1.1614172458648682
Epoch: 2, Steps: 8 | Train Loss: 1.287 Vali Loss: 1.456 Vali Acc: 0.489 Test Loss: 1.456 Test Acc: 0.489
Validation loss decreased (-0.419832 --> -0.488535).  Saving model ...
Epoch: 3 cost time: 1.4775338172912598
Epoch: 3, Steps: 8 | Train Loss: 0.901 Vali Loss: 1.402 Vali Acc: 0.527 Test Loss: 1.402 Test Acc: 0.527
Validation loss decreased (-0.488535 --> -0.526704).  Saving model ...
Epoch: 4 cost time: 1.3918778896331787
Epoch: 4, Steps: 8 | Train Loss: 0.495 Vali Loss: 1.416 Vali Acc: 0.466 Test Loss: 1.416 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5431861877441406
Epoch: 5, Steps: 8 | Train Loss: 0.215 Vali Loss: 1.421 Vali Acc: 0.458 Test Loss: 1.421 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.7782306671142578
Epoch: 6, Steps: 8 | Train Loss: 0.079 Vali Loss: 1.493 Vali Acc: 0.489 Test Loss: 1.493 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.9070305824279785
Epoch: 7, Steps: 8 | Train Loss: 0.027 Vali Loss: 1.530 Vali Acc: 0.466 Test Loss: 1.530 Test Acc: 0.466
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.7152795791625977
Epoch: 8, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.575 Vali Acc: 0.458 Test Loss: 1.575 Test Acc: 0.458
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.8252630233764648
Epoch: 9, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.618 Vali Acc: 0.496 Test Loss: 1.618 Test Acc: 0.496
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.7883949279785156
Epoch: 10, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.646 Vali Acc: 0.504 Test Loss: 1.646 Test Acc: 0.504
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.6670947074890137
Epoch: 11, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.673 Vali Acc: 0.504 Test Loss: 1.673 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.5378189086914062
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.698 Vali Acc: 0.504 Test Loss: 1.698 Test Acc: 0.504
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.8261055946350098
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.724 Vali Acc: 0.504 Test Loss: 1.724 Test Acc: 0.504
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps2248_str1124_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 74535941
model size : 299.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps2248_str2248_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.0552878379821777
Epoch: 1, Steps: 8 | Train Loss: 1.509 Vali Loss: 1.514 Vali Acc: 0.420 Test Loss: 1.514 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 1.1914494037628174
Epoch: 2, Steps: 8 | Train Loss: 1.273 Vali Loss: 1.504 Vali Acc: 0.458 Test Loss: 1.504 Test Acc: 0.458
Validation loss decreased (-0.419832 --> -0.458000).  Saving model ...
Epoch: 3 cost time: 1.4274492263793945
Epoch: 3, Steps: 8 | Train Loss: 0.875 Vali Loss: 1.516 Vali Acc: 0.458 Test Loss: 1.516 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2434842586517334
Epoch: 4, Steps: 8 | Train Loss: 0.476 Vali Loss: 1.532 Vali Acc: 0.466 Test Loss: 1.532 Test Acc: 0.466
Validation loss decreased (-0.458000 --> -0.465634).  Saving model ...
Epoch: 5 cost time: 1.1284539699554443
Epoch: 5, Steps: 8 | Train Loss: 0.209 Vali Loss: 1.569 Vali Acc: 0.443 Test Loss: 1.569 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2163305282592773
Epoch: 6, Steps: 8 | Train Loss: 0.086 Vali Loss: 1.569 Vali Acc: 0.473 Test Loss: 1.569 Test Acc: 0.473
Validation loss decreased (-0.465634 --> -0.473267).  Saving model ...
Epoch: 7 cost time: 1.2114741802215576
Epoch: 7, Steps: 8 | Train Loss: 0.031 Vali Loss: 1.636 Vali Acc: 0.481 Test Loss: 1.636 Test Acc: 0.481
Validation loss decreased (-0.473267 --> -0.480900).  Saving model ...
Epoch: 8 cost time: 1.5569138526916504
Epoch: 8, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.719 Vali Acc: 0.489 Test Loss: 1.719 Test Acc: 0.489
Validation loss decreased (-0.480900 --> -0.488532).  Saving model ...
Epoch: 9 cost time: 1.2877819538116455
Epoch: 9, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.768 Vali Acc: 0.496 Test Loss: 1.768 Test Acc: 0.496
Validation loss decreased (-0.488532 --> -0.496166).  Saving model ...
Epoch: 10 cost time: 1.440345287322998
Epoch: 10, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.799 Vali Acc: 0.473 Test Loss: 1.799 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6159512996673584
Epoch: 11, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.815 Vali Acc: 0.473 Test Loss: 1.815 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.4796953201293945
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.826 Vali Acc: 0.496 Test Loss: 1.826 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.014735221862793
Epoch: 13, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.839 Vali Acc: 0.504 Test Loss: 1.839 Test Acc: 0.504
Validation loss decreased (-0.496166 --> -0.503798).  Saving model ...
Epoch: 14 cost time: 1.334650993347168
Epoch: 14, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.850 Vali Acc: 0.504 Test Loss: 1.850 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.469634771347046
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.860 Vali Acc: 0.496 Test Loss: 1.860 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.5336761474609375
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.864 Vali Acc: 0.496 Test Loss: 1.864 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.6362755298614502
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.874 Vali Acc: 0.496 Test Loss: 1.874 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.4825842380523682
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.883 Vali Acc: 0.496 Test Loss: 1.883 Test Acc: 0.496
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.7761127948760986
Epoch: 19, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.891 Vali Acc: 0.496 Test Loss: 1.891 Test Acc: 0.496
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.5250685214996338
Epoch: 20, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.900 Vali Acc: 0.496 Test Loss: 1.900 Test Acc: 0.496
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.27154541015625
Epoch: 21, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.908 Vali Acc: 0.496 Test Loss: 1.908 Test Acc: 0.496
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.7640883922576904
Epoch: 22, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.917 Vali Acc: 0.496 Test Loss: 1.917 Test Acc: 0.496
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.9242072105407715
Epoch: 23, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.925 Vali Acc: 0.504 Test Loss: 1.925 Test Acc: 0.504
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps2248_str2248_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5038167938931297
model parameter : 74498309
model size : 298.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps2570_str643_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.7334537506103516
Epoch: 1, Steps: 8 | Train Loss: 1.563 Vali Loss: 1.547 Vali Acc: 0.420 Test Loss: 1.547 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 1.7425429821014404
Epoch: 2, Steps: 8 | Train Loss: 1.248 Vali Loss: 1.441 Vali Acc: 0.481 Test Loss: 1.441 Test Acc: 0.481
Validation loss decreased (-0.419832 --> -0.480902).  Saving model ...
Epoch: 3 cost time: 2.1536569595336914
Epoch: 3, Steps: 8 | Train Loss: 0.783 Vali Loss: 1.432 Vali Acc: 0.473 Test Loss: 1.432 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.271010160446167
Epoch: 4, Steps: 8 | Train Loss: 0.372 Vali Loss: 1.404 Vali Acc: 0.519 Test Loss: 1.404 Test Acc: 0.519
Validation loss decreased (-0.480902 --> -0.519070).  Saving model ...
Epoch: 5 cost time: 1.462888240814209
Epoch: 5, Steps: 8 | Train Loss: 0.140 Vali Loss: 1.493 Vali Acc: 0.542 Test Loss: 1.493 Test Acc: 0.542
Validation loss decreased (-0.519070 --> -0.541970).  Saving model ...
Epoch: 6 cost time: 1.4761748313903809
Epoch: 6, Steps: 8 | Train Loss: 0.034 Vali Loss: 1.661 Vali Acc: 0.450 Test Loss: 1.661 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.0993783473968506
Epoch: 7, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.706 Vali Acc: 0.481 Test Loss: 1.706 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2203660011291504
Epoch: 8, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.837 Vali Acc: 0.496 Test Loss: 1.837 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.6015644073486328
Epoch: 9, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.923 Vali Acc: 0.489 Test Loss: 1.923 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.6561675071716309
Epoch: 10, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.868 Vali Acc: 0.458 Test Loss: 1.868 Test Acc: 0.458
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.6444945335388184
Epoch: 11, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.838 Vali Acc: 0.489 Test Loss: 1.838 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.6491239070892334
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.847 Vali Acc: 0.511 Test Loss: 1.847 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.9489586353302002
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.880 Vali Acc: 0.511 Test Loss: 1.880 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.696437120437622
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.912 Vali Acc: 0.511 Test Loss: 1.912 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.8560035228729248
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.935 Vali Acc: 0.511 Test Loss: 1.935 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps2570_str643_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 79035653
model size : 316.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps2570_str1285_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.947376012802124
Epoch: 1, Steps: 8 | Train Loss: 1.515 Vali Loss: 1.520 Vali Acc: 0.420 Test Loss: 1.520 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 1.7416048049926758
Epoch: 2, Steps: 8 | Train Loss: 1.274 Vali Loss: 1.499 Vali Acc: 0.443 Test Loss: 1.499 Test Acc: 0.443
Validation loss decreased (-0.419832 --> -0.442733).  Saving model ...
Epoch: 3 cost time: 2.1331303119659424
Epoch: 3, Steps: 8 | Train Loss: 0.849 Vali Loss: 1.422 Vali Acc: 0.481 Test Loss: 1.422 Test Acc: 0.481
Validation loss decreased (-0.442733 --> -0.480902).  Saving model ...
Epoch: 4 cost time: 1.633772850036621
Epoch: 4, Steps: 8 | Train Loss: 0.417 Vali Loss: 1.387 Vali Acc: 0.496 Test Loss: 1.387 Test Acc: 0.496
Validation loss decreased (-0.480902 --> -0.496169).  Saving model ...
Epoch: 5 cost time: 1.765195369720459
Epoch: 5, Steps: 8 | Train Loss: 0.132 Vali Loss: 1.487 Vali Acc: 0.496 Test Loss: 1.487 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5481808185577393
Epoch: 6, Steps: 8 | Train Loss: 0.050 Vali Loss: 1.552 Vali Acc: 0.519 Test Loss: 1.552 Test Acc: 0.519
Validation loss decreased (-0.496169 --> -0.519068).  Saving model ...
Epoch: 7 cost time: 1.6367204189300537
Epoch: 7, Steps: 8 | Train Loss: 0.022 Vali Loss: 1.614 Vali Acc: 0.511 Test Loss: 1.614 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7344996929168701
Epoch: 8, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.681 Vali Acc: 0.496 Test Loss: 1.681 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.5782222747802734
Epoch: 9, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.733 Vali Acc: 0.511 Test Loss: 1.733 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.6854186058044434
Epoch: 10, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.758 Vali Acc: 0.511 Test Loss: 1.758 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.6217246055603027
Epoch: 11, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.768 Vali Acc: 0.496 Test Loss: 1.768 Test Acc: 0.496
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.4916496276855469
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.774 Vali Acc: 0.496 Test Loss: 1.774 Test Acc: 0.496
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.5480639934539795
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.779 Vali Acc: 0.496 Test Loss: 1.779 Test Acc: 0.496
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.5784332752227783
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.787 Vali Acc: 0.496 Test Loss: 1.787 Test Acc: 0.496
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.5281126499176025
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.794 Vali Acc: 0.496 Test Loss: 1.794 Test Acc: 0.496
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.852081537246704
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.800 Vali Acc: 0.496 Test Loss: 1.800 Test Acc: 0.496
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps2570_str1285_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 78971141
model size : 315.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps2570_str2570_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.495232582092285
Epoch: 1, Steps: 8 | Train Loss: 1.562 Vali Loss: 1.497 Vali Acc: 0.420 Test Loss: 1.497 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 2.15531063079834
Epoch: 2, Steps: 8 | Train Loss: 1.241 Vali Loss: 1.447 Vali Acc: 0.466 Test Loss: 1.447 Test Acc: 0.466
Validation loss decreased (-0.419832 --> -0.465634).  Saving model ...
Epoch: 3 cost time: 1.6483261585235596
Epoch: 3, Steps: 8 | Train Loss: 0.776 Vali Loss: 1.502 Vali Acc: 0.496 Test Loss: 1.502 Test Acc: 0.496
Validation loss decreased (-0.465634 --> -0.496168).  Saving model ...
Epoch: 4 cost time: 1.8730309009552002
Epoch: 4, Steps: 8 | Train Loss: 0.397 Vali Loss: 1.536 Vali Acc: 0.489 Test Loss: 1.536 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.1379387378692627
Epoch: 5, Steps: 8 | Train Loss: 0.176 Vali Loss: 1.615 Vali Acc: 0.489 Test Loss: 1.615 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.627579689025879
Epoch: 6, Steps: 8 | Train Loss: 0.059 Vali Loss: 1.604 Vali Acc: 0.466 Test Loss: 1.604 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.0684454441070557
Epoch: 7, Steps: 8 | Train Loss: 0.019 Vali Loss: 1.640 Vali Acc: 0.481 Test Loss: 1.640 Test Acc: 0.481
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.5395848751068115
Epoch: 8, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.702 Vali Acc: 0.466 Test Loss: 1.702 Test Acc: 0.466
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.6485493183135986
Epoch: 9, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.766 Vali Acc: 0.458 Test Loss: 1.766 Test Acc: 0.458
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.5550873279571533
Epoch: 10, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.814 Vali Acc: 0.466 Test Loss: 1.814 Test Acc: 0.466
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.022150993347168
Epoch: 11, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.845 Vali Acc: 0.458 Test Loss: 1.845 Test Acc: 0.458
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.798084020614624
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.860 Vali Acc: 0.458 Test Loss: 1.860 Test Acc: 0.458
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.1500182151794434
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.875 Vali Acc: 0.458 Test Loss: 1.875 Test Acc: 0.458
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps2570_str2570_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.4961832061068702
model parameter : 78938885
model size : 315.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps2998_str750_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.220504522323608
Epoch: 1, Steps: 8 | Train Loss: 1.546 Vali Loss: 1.528 Vali Acc: 0.420 Test Loss: 1.528 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 2.698077917098999
Epoch: 2, Steps: 8 | Train Loss: 1.173 Vali Loss: 1.412 Vali Acc: 0.481 Test Loss: 1.412 Test Acc: 0.481
Validation loss decreased (-0.419832 --> -0.480902).  Saving model ...
Epoch: 3 cost time: 2.3742311000823975
Epoch: 3, Steps: 8 | Train Loss: 0.746 Vali Loss: 1.488 Vali Acc: 0.382 Test Loss: 1.488 Test Acc: 0.382
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.546999454498291
Epoch: 4, Steps: 8 | Train Loss: 0.325 Vali Loss: 1.529 Vali Acc: 0.435 Test Loss: 1.529 Test Acc: 0.435
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.2436671257019043
Epoch: 5, Steps: 8 | Train Loss: 0.122 Vali Loss: 1.704 Vali Acc: 0.473 Test Loss: 1.704 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.9897902011871338
Epoch: 6, Steps: 8 | Train Loss: 0.034 Vali Loss: 1.759 Vali Acc: 0.473 Test Loss: 1.759 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.9162042140960693
Epoch: 7, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.804 Vali Acc: 0.473 Test Loss: 1.804 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.1066243648529053
Epoch: 8, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.931 Vali Acc: 0.481 Test Loss: 1.931 Test Acc: 0.481
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.463606595993042
Epoch: 9, Steps: 8 | Train Loss: 0.003 Vali Loss: 2.021 Vali Acc: 0.473 Test Loss: 2.021 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.85640287399292
Epoch: 10, Steps: 8 | Train Loss: 0.002 Vali Loss: 2.031 Vali Acc: 0.435 Test Loss: 2.031 Test Acc: 0.435
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.123596429824829
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.042 Vali Acc: 0.435 Test Loss: 2.042 Test Acc: 0.435
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.041720151901245
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.047 Vali Acc: 0.435 Test Loss: 2.047 Test Acc: 0.435
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps2998_str750_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.48091603053435117
model parameter : 84930821
model size : 338.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps2998_str1499_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.2054576873779297
Epoch: 1, Steps: 8 | Train Loss: 1.544 Vali Loss: 1.540 Vali Acc: 0.420 Test Loss: 1.540 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 1.5118296146392822
Epoch: 2, Steps: 8 | Train Loss: 1.238 Vali Loss: 1.445 Vali Acc: 0.489 Test Loss: 1.445 Test Acc: 0.489
Validation loss decreased (-0.419832 --> -0.488535).  Saving model ...
Epoch: 3 cost time: 1.6774091720581055
Epoch: 3, Steps: 8 | Train Loss: 0.776 Vali Loss: 1.526 Vali Acc: 0.450 Test Loss: 1.526 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7114150524139404
Epoch: 4, Steps: 8 | Train Loss: 0.393 Vali Loss: 1.551 Vali Acc: 0.473 Test Loss: 1.551 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.5383632183074951
Epoch: 5, Steps: 8 | Train Loss: 0.169 Vali Loss: 1.679 Vali Acc: 0.504 Test Loss: 1.679 Test Acc: 0.504
Validation loss decreased (-0.488535 --> -0.503800).  Saving model ...
Epoch: 6 cost time: 1.3023929595947266
Epoch: 6, Steps: 8 | Train Loss: 0.047 Vali Loss: 1.620 Vali Acc: 0.511 Test Loss: 1.620 Test Acc: 0.511
Validation loss decreased (-0.503800 --> -0.511434).  Saving model ...
Epoch: 7 cost time: 1.5563671588897705
Epoch: 7, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.554 Vali Acc: 0.534 Test Loss: 1.554 Test Acc: 0.534
Validation loss decreased (-0.511434 --> -0.534336).  Saving model ...
Epoch: 8 cost time: 2.188477039337158
Epoch: 8, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.587 Vali Acc: 0.542 Test Loss: 1.587 Test Acc: 0.542
Validation loss decreased (-0.534336 --> -0.541969).  Saving model ...
Epoch: 9 cost time: 2.064288377761841
Epoch: 9, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.630 Vali Acc: 0.550 Test Loss: 1.630 Test Acc: 0.550
Validation loss decreased (-0.541969 --> -0.549602).  Saving model ...
Epoch: 10 cost time: 1.720123529434204
Epoch: 10, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.669 Vali Acc: 0.550 Test Loss: 1.669 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.9668974876403809
Epoch: 11, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.695 Vali Acc: 0.534 Test Loss: 1.695 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.7952888011932373
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.709 Vali Acc: 0.542 Test Loss: 1.709 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.6327321529388428
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.718 Vali Acc: 0.542 Test Loss: 1.718 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.8827810287475586
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.728 Vali Acc: 0.542 Test Loss: 1.728 Test Acc: 0.542
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.6205437183380127
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.737 Vali Acc: 0.542 Test Loss: 1.737 Test Acc: 0.542
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.7052607536315918
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.744 Vali Acc: 0.542 Test Loss: 1.744 Test Acc: 0.542
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.9350106716156006
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.758 Vali Acc: 0.542 Test Loss: 1.758 Test Acc: 0.542
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.2419207096099854
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.774 Vali Acc: 0.542 Test Loss: 1.774 Test Acc: 0.542
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.02370548248291
Epoch: 19, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.790 Vali Acc: 0.542 Test Loss: 1.790 Test Acc: 0.542
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps2998_str1499_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 84877061
model size : 338.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps2998_str2998_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.3867671489715576
Epoch: 1, Steps: 8 | Train Loss: 1.598 Vali Loss: 1.558 Vali Acc: 0.420 Test Loss: 1.558 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 1.9810280799865723
Epoch: 2, Steps: 8 | Train Loss: 1.235 Vali Loss: 1.570 Vali Acc: 0.427 Test Loss: 1.570 Test Acc: 0.427
Validation loss decreased (-0.419832 --> -0.427465).  Saving model ...
Epoch: 3 cost time: 2.134831666946411
Epoch: 3, Steps: 8 | Train Loss: 0.760 Vali Loss: 1.594 Vali Acc: 0.412 Test Loss: 1.594 Test Acc: 0.412
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.975287437438965
Epoch: 4, Steps: 8 | Train Loss: 0.377 Vali Loss: 1.541 Vali Acc: 0.489 Test Loss: 1.541 Test Acc: 0.489
Validation loss decreased (-0.427465 --> -0.488534).  Saving model ...
Epoch: 5 cost time: 2.0939784049987793
Epoch: 5, Steps: 8 | Train Loss: 0.151 Vali Loss: 1.580 Vali Acc: 0.473 Test Loss: 1.580 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.1789615154266357
Epoch: 6, Steps: 8 | Train Loss: 0.069 Vali Loss: 1.636 Vali Acc: 0.450 Test Loss: 1.636 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.0614020824432373
Epoch: 7, Steps: 8 | Train Loss: 0.026 Vali Loss: 1.634 Vali Acc: 0.466 Test Loss: 1.634 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.7789113521575928
Epoch: 8, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.676 Vali Acc: 0.466 Test Loss: 1.676 Test Acc: 0.466
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.6353192329406738
Epoch: 9, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.715 Vali Acc: 0.473 Test Loss: 1.715 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.2348361015319824
Epoch: 10, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.745 Vali Acc: 0.466 Test Loss: 1.745 Test Acc: 0.466
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.8264071941375732
Epoch: 11, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.767 Vali Acc: 0.466 Test Loss: 1.767 Test Acc: 0.466
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.6030371189117432
Epoch: 12, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.785 Vali Acc: 0.466 Test Loss: 1.785 Test Acc: 0.466
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.7267546653747559
Epoch: 13, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.807 Vali Acc: 0.466 Test Loss: 1.807 Test Acc: 0.466
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.7833855152130127
Epoch: 14, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.827 Vali Acc: 0.466 Test Loss: 1.827 Test Acc: 0.466
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps2998_str2998_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.48854961832061067
model parameter : 84850181
model size : 338.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps3597_str900_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.7891407012939453
Epoch: 1, Steps: 8 | Train Loss: 1.716 Vali Loss: 1.548 Vali Acc: 0.420 Test Loss: 1.548 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 1.8482182025909424
Epoch: 2, Steps: 8 | Train Loss: 1.224 Vali Loss: 1.548 Vali Acc: 0.450 Test Loss: 1.548 Test Acc: 0.450
Validation loss decreased (-0.419832 --> -0.450366).  Saving model ...
Epoch: 3 cost time: 1.9771571159362793
Epoch: 3, Steps: 8 | Train Loss: 0.663 Vali Loss: 1.454 Vali Acc: 0.458 Test Loss: 1.454 Test Acc: 0.458
Validation loss decreased (-0.450366 --> -0.458001).  Saving model ...
Epoch: 4 cost time: 2.117917776107788
Epoch: 4, Steps: 8 | Train Loss: 0.316 Vali Loss: 1.515 Vali Acc: 0.435 Test Loss: 1.515 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6982698440551758
Epoch: 5, Steps: 8 | Train Loss: 0.100 Vali Loss: 1.688 Vali Acc: 0.450 Test Loss: 1.688 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.090266227722168
Epoch: 6, Steps: 8 | Train Loss: 0.024 Vali Loss: 1.765 Vali Acc: 0.435 Test Loss: 1.765 Test Acc: 0.435
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.827768087387085
Epoch: 7, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.833 Vali Acc: 0.489 Test Loss: 1.833 Test Acc: 0.489
Validation loss decreased (-0.458001 --> -0.488531).  Saving model ...
Epoch: 8 cost time: 2.278703212738037
Epoch: 8, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.847 Vali Acc: 0.489 Test Loss: 1.847 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6597344875335693
Epoch: 9, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.846 Vali Acc: 0.473 Test Loss: 1.846 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.7834243774414062
Epoch: 10, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.853 Vali Acc: 0.473 Test Loss: 1.853 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.949843168258667
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.867 Vali Acc: 0.450 Test Loss: 1.867 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.696446418762207
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.884 Vali Acc: 0.443 Test Loss: 1.884 Test Acc: 0.443
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.7551672458648682
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.896 Vali Acc: 0.450 Test Loss: 1.896 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.6176812648773193
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.909 Vali Acc: 0.450 Test Loss: 1.909 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.7396209239959717
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.922 Vali Acc: 0.450 Test Loss: 1.922 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.0211994647979736
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.930 Vali Acc: 0.450 Test Loss: 1.930 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.8962583541870117
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.935 Vali Acc: 0.450 Test Loss: 1.935 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps3597_str900_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.48854961832061067
model parameter : 93189893
model size : 370.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps3597_str1799_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.527348279953003
Epoch: 1, Steps: 8 | Train Loss: 1.575 Vali Loss: 1.520 Vali Acc: 0.427 Test Loss: 1.520 Test Acc: 0.427
Validation loss decreased (inf --> -0.427466).  Saving model ...
Epoch: 2 cost time: 1.5239150524139404
Epoch: 2, Steps: 8 | Train Loss: 1.202 Vali Loss: 1.528 Vali Acc: 0.458 Test Loss: 1.528 Test Acc: 0.458
Validation loss decreased (-0.427466 --> -0.458000).  Saving model ...
Epoch: 3 cost time: 2.6433331966400146
Epoch: 3, Steps: 8 | Train Loss: 0.653 Vali Loss: 1.542 Vali Acc: 0.481 Test Loss: 1.542 Test Acc: 0.481
Validation loss decreased (-0.458000 --> -0.480901).  Saving model ...
Epoch: 4 cost time: 2.8088924884796143
Epoch: 4, Steps: 8 | Train Loss: 0.324 Vali Loss: 1.490 Vali Acc: 0.481 Test Loss: 1.490 Test Acc: 0.481
Validation loss decreased (-0.480901 --> -0.480901).  Saving model ...
Epoch: 5 cost time: 2.837214231491089
Epoch: 5, Steps: 8 | Train Loss: 0.139 Vali Loss: 1.490 Vali Acc: 0.496 Test Loss: 1.490 Test Acc: 0.496
Validation loss decreased (-0.480901 --> -0.496168).  Saving model ...
Epoch: 6 cost time: 1.3369204998016357
Epoch: 6, Steps: 8 | Train Loss: 0.041 Vali Loss: 1.562 Vali Acc: 0.489 Test Loss: 1.562 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.171290397644043
Epoch: 7, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.626 Vali Acc: 0.473 Test Loss: 1.626 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.9250807762145996
Epoch: 8, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.666 Vali Acc: 0.473 Test Loss: 1.666 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.2225377559661865
Epoch: 9, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.690 Vali Acc: 0.458 Test Loss: 1.690 Test Acc: 0.458
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.2469446659088135
Epoch: 10, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.708 Vali Acc: 0.450 Test Loss: 1.708 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.099435806274414
Epoch: 11, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.730 Vali Acc: 0.450 Test Loss: 1.730 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.715378999710083
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.753 Vali Acc: 0.458 Test Loss: 1.753 Test Acc: 0.458
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.668783187866211
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.778 Vali Acc: 0.466 Test Loss: 1.778 Test Acc: 0.466
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.1191282272338867
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.800 Vali Acc: 0.466 Test Loss: 1.800 Test Acc: 0.466
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.979973077774048
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.815 Vali Acc: 0.450 Test Loss: 1.815 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps3597_str1799_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.4961832061068702
model parameter : 93146885
model size : 370.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps3597_str3597_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.5040011405944824
Epoch: 1, Steps: 8 | Train Loss: 1.584 Vali Loss: 1.531 Vali Acc: 0.427 Test Loss: 1.531 Test Acc: 0.427
Validation loss decreased (inf --> -0.427466).  Saving model ...
Epoch: 2 cost time: 1.9235880374908447
Epoch: 2, Steps: 8 | Train Loss: 1.196 Vali Loss: 1.504 Vali Acc: 0.473 Test Loss: 1.504 Test Acc: 0.473
Validation loss decreased (-0.427466 --> -0.473267).  Saving model ...
Epoch: 3 cost time: 1.9743590354919434
Epoch: 3, Steps: 8 | Train Loss: 0.679 Vali Loss: 1.544 Vali Acc: 0.435 Test Loss: 1.544 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.215034008026123
Epoch: 4, Steps: 8 | Train Loss: 0.273 Vali Loss: 1.576 Vali Acc: 0.405 Test Loss: 1.576 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.1894173622131348
Epoch: 5, Steps: 8 | Train Loss: 0.100 Vali Loss: 1.586 Vali Acc: 0.466 Test Loss: 1.586 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.1078989505767822
Epoch: 6, Steps: 8 | Train Loss: 0.036 Vali Loss: 1.618 Vali Acc: 0.450 Test Loss: 1.618 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.8603479862213135
Epoch: 7, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.660 Vali Acc: 0.473 Test Loss: 1.660 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.0385849475860596
Epoch: 8, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.653 Vali Acc: 0.489 Test Loss: 1.653 Test Acc: 0.489
Validation loss decreased (-0.473267 --> -0.488533).  Saving model ...
Epoch: 9 cost time: 2.0859198570251465
Epoch: 9, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.669 Vali Acc: 0.496 Test Loss: 1.669 Test Acc: 0.496
Validation loss decreased (-0.488533 --> -0.496167).  Saving model ...
Epoch: 10 cost time: 1.6086859703063965
Epoch: 10, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.683 Vali Acc: 0.489 Test Loss: 1.683 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.4040513038635254
Epoch: 11, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.693 Vali Acc: 0.489 Test Loss: 1.693 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.81113862991333
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.705 Vali Acc: 0.489 Test Loss: 1.705 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.125323534011841
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.719 Vali Acc: 0.481 Test Loss: 1.719 Test Acc: 0.481
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.173635482788086
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.731 Vali Acc: 0.481 Test Loss: 1.731 Test Acc: 0.481
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.5022943019866943
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.743 Vali Acc: 0.481 Test Loss: 1.743 Test Acc: 0.481
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.7844102382659912
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.753 Vali Acc: 0.481 Test Loss: 1.753 Test Acc: 0.481
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.851621150970459
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.764 Vali Acc: 0.473 Test Loss: 1.764 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.622269868850708
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.775 Vali Acc: 0.466 Test Loss: 1.775 Test Acc: 0.466
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.57331919670105
Epoch: 19, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.787 Vali Acc: 0.466 Test Loss: 1.787 Test Acc: 0.466
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el6_dm768_df768_ps3597_str3597_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.4961832061068702
model parameter : 93125381
model size : 369.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps720_str180_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.5524380207061768
Epoch: 1, Steps: 8 | Train Loss: 1.679 Vali Loss: 1.543 Vali Acc: 0.420 Test Loss: 1.543 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 1.854032278060913
Epoch: 2, Steps: 8 | Train Loss: 1.415 Vali Loss: 1.576 Vali Acc: 0.420 Test Loss: 1.576 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6676206588745117
Epoch: 3, Steps: 8 | Train Loss: 1.236 Vali Loss: 1.426 Vali Acc: 0.450 Test Loss: 1.426 Test Acc: 0.450
Validation loss decreased (-0.419832 --> -0.450367).  Saving model ...
Epoch: 4 cost time: 2.209118366241455
Epoch: 4, Steps: 8 | Train Loss: 0.880 Vali Loss: 1.309 Vali Acc: 0.527 Test Loss: 1.309 Test Acc: 0.527
Validation loss decreased (-0.450367 --> -0.526704).  Saving model ...
Epoch: 5 cost time: 2.0450596809387207
Epoch: 5, Steps: 8 | Train Loss: 0.465 Vali Loss: 1.448 Vali Acc: 0.511 Test Loss: 1.448 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7388732433319092
Epoch: 6, Steps: 8 | Train Loss: 0.190 Vali Loss: 1.255 Vali Acc: 0.496 Test Loss: 1.255 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.5937473773956299
Epoch: 7, Steps: 8 | Train Loss: 0.038 Vali Loss: 1.645 Vali Acc: 0.435 Test Loss: 1.645 Test Acc: 0.435
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.6350162029266357
Epoch: 8, Steps: 8 | Train Loss: 0.036 Vali Loss: 1.830 Vali Acc: 0.595 Test Loss: 1.830 Test Acc: 0.595
Validation loss decreased (-0.526704 --> -0.595402).  Saving model ...
Epoch: 9 cost time: 1.5639498233795166
Epoch: 9, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.420 Vali Acc: 0.489 Test Loss: 1.420 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2991302013397217
Epoch: 10, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.739 Vali Acc: 0.557 Test Loss: 1.739 Test Acc: 0.557
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.1659653186798096
Epoch: 11, Steps: 8 | Train Loss: 0.018 Vali Loss: 1.846 Vali Acc: 0.504 Test Loss: 1.846 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.3714325428009033
Epoch: 12, Steps: 8 | Train Loss: 0.006 Vali Loss: 2.282 Vali Acc: 0.534 Test Loss: 2.282 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.1154050827026367
Epoch: 13, Steps: 8 | Train Loss: 0.002 Vali Loss: 2.203 Vali Acc: 0.542 Test Loss: 2.203 Test Acc: 0.542
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.4342074394226074
Epoch: 14, Steps: 8 | Train Loss: 0.006 Vali Loss: 2.479 Vali Acc: 0.527 Test Loss: 2.479 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.1742498874664307
Epoch: 15, Steps: 8 | Train Loss: 0.011 Vali Loss: 2.171 Vali Acc: 0.511 Test Loss: 2.171 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.5464544296264648
Epoch: 16, Steps: 8 | Train Loss: 0.002 Vali Loss: 2.461 Vali Acc: 0.443 Test Loss: 2.461 Test Acc: 0.443
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.4829113483428955
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.575 Vali Acc: 0.466 Test Loss: 2.575 Test Acc: 0.466
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.5201160907745361
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.536 Vali Acc: 0.458 Test Loss: 2.536 Test Acc: 0.458
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps720_str180_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5954198473282443
model parameter : 46760453
model size : 193.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps720_str360_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.772230863571167
Epoch: 1, Steps: 8 | Train Loss: 1.579 Vali Loss: 1.646 Vali Acc: 0.420 Test Loss: 1.646 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 1.2303142547607422
Epoch: 2, Steps: 8 | Train Loss: 1.465 Vali Loss: 1.593 Vali Acc: 0.168 Test Loss: 1.593 Test Acc: 0.168
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1255700588226318
Epoch: 3, Steps: 8 | Train Loss: 1.225 Vali Loss: 1.491 Vali Acc: 0.443 Test Loss: 1.491 Test Acc: 0.443
Validation loss decreased (-0.419831 --> -0.442733).  Saving model ...
Epoch: 4 cost time: 1.2485172748565674
Epoch: 4, Steps: 8 | Train Loss: 0.946 Vali Loss: 1.324 Vali Acc: 0.496 Test Loss: 1.324 Test Acc: 0.496
Validation loss decreased (-0.442733 --> -0.496170).  Saving model ...
Epoch: 5 cost time: 1.074521541595459
Epoch: 5, Steps: 8 | Train Loss: 0.645 Vali Loss: 1.277 Vali Acc: 0.511 Test Loss: 1.277 Test Acc: 0.511
Validation loss decreased (-0.496170 --> -0.511438).  Saving model ...
Epoch: 6 cost time: 1.5818977355957031
Epoch: 6, Steps: 8 | Train Loss: 0.324 Vali Loss: 1.274 Vali Acc: 0.527 Test Loss: 1.274 Test Acc: 0.527
Validation loss decreased (-0.511438 --> -0.526705).  Saving model ...
Epoch: 7 cost time: 1.2846269607543945
Epoch: 7, Steps: 8 | Train Loss: 0.108 Vali Loss: 1.202 Vali Acc: 0.603 Test Loss: 1.202 Test Acc: 0.603
Validation loss decreased (-0.526705 --> -0.603041).  Saving model ...
Epoch: 8 cost time: 1.0783612728118896
Epoch: 8, Steps: 8 | Train Loss: 0.050 Vali Loss: 1.592 Vali Acc: 0.580 Test Loss: 1.592 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9739151000976562
Epoch: 9, Steps: 8 | Train Loss: 0.020 Vali Loss: 1.471 Vali Acc: 0.573 Test Loss: 1.471 Test Acc: 0.573
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9949970245361328
Epoch: 10, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.540 Vali Acc: 0.580 Test Loss: 1.540 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.7817432880401611
Epoch: 11, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.618 Vali Acc: 0.588 Test Loss: 1.618 Test Acc: 0.588
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.642671823501587
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.596 Vali Acc: 0.580 Test Loss: 1.596 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.6112558841705322
Epoch: 13, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.719 Vali Acc: 0.603 Test Loss: 1.719 Test Acc: 0.603
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.421980381011963
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.844 Vali Acc: 0.611 Test Loss: 1.844 Test Acc: 0.611
Validation loss decreased (-0.603041 --> -0.610669).  Saving model ...
Epoch: 15 cost time: 1.6348469257354736
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.826 Vali Acc: 0.595 Test Loss: 1.826 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.723412275314331
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.745 Vali Acc: 0.595 Test Loss: 1.745 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.648428201675415
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.717 Vali Acc: 0.595 Test Loss: 1.717 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.7604193687438965
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.722 Vali Acc: 0.595 Test Loss: 1.722 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.6585798263549805
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.731 Vali Acc: 0.603 Test Loss: 1.731 Test Acc: 0.603
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.5008370876312256
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.739 Vali Acc: 0.595 Test Loss: 1.739 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.064284324645996
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.749 Vali Acc: 0.603 Test Loss: 1.749 Test Acc: 0.603
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.0778234004974365
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.765 Vali Acc: 0.595 Test Loss: 1.765 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.9158275127410889
Epoch: 23, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.769 Vali Acc: 0.595 Test Loss: 1.769 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.0583431720733643
Epoch: 24, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.773 Vali Acc: 0.595 Test Loss: 1.773 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps720_str360_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6106870229007634
model parameter : 46502405
model size : 192.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps720_str720_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.989471197128296
Epoch: 1, Steps: 8 | Train Loss: 1.574 Vali Loss: 1.603 Vali Acc: 0.420 Test Loss: 1.603 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 1.4386143684387207
Epoch: 2, Steps: 8 | Train Loss: 1.423 Vali Loss: 1.502 Vali Acc: 0.427 Test Loss: 1.502 Test Acc: 0.427
Validation loss decreased (-0.419831 --> -0.427466).  Saving model ...
Epoch: 3 cost time: 0.9533877372741699
Epoch: 3, Steps: 8 | Train Loss: 1.173 Vali Loss: 1.478 Vali Acc: 0.504 Test Loss: 1.478 Test Acc: 0.504
Validation loss decreased (-0.427466 --> -0.503802).  Saving model ...
Epoch: 4 cost time: 1.1867811679840088
Epoch: 4, Steps: 8 | Train Loss: 0.905 Vali Loss: 1.463 Vali Acc: 0.489 Test Loss: 1.463 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9446897506713867
Epoch: 5, Steps: 8 | Train Loss: 0.592 Vali Loss: 1.373 Vali Acc: 0.534 Test Loss: 1.373 Test Acc: 0.534
Validation loss decreased (-0.503802 --> -0.534337).  Saving model ...
Epoch: 6 cost time: 1.0084846019744873
Epoch: 6, Steps: 8 | Train Loss: 0.329 Vali Loss: 1.429 Vali Acc: 0.542 Test Loss: 1.429 Test Acc: 0.542
Validation loss decreased (-0.534337 --> -0.541970).  Saving model ...
Epoch: 7 cost time: 1.1256053447723389
Epoch: 7, Steps: 8 | Train Loss: 0.128 Vali Loss: 1.520 Vali Acc: 0.481 Test Loss: 1.520 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8931515216827393
Epoch: 8, Steps: 8 | Train Loss: 0.054 Vali Loss: 1.690 Vali Acc: 0.519 Test Loss: 1.690 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9177572727203369
Epoch: 9, Steps: 8 | Train Loss: 0.020 Vali Loss: 1.808 Vali Acc: 0.481 Test Loss: 1.808 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.9880268573760986
Epoch: 10, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.726 Vali Acc: 0.511 Test Loss: 1.726 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.0339109897613525
Epoch: 11, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.846 Vali Acc: 0.519 Test Loss: 1.846 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.2165966033935547
Epoch: 12, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.879 Vali Acc: 0.511 Test Loss: 1.879 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.1304962635040283
Epoch: 13, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.884 Vali Acc: 0.496 Test Loss: 1.884 Test Acc: 0.496
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.1018948554992676
Epoch: 14, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.907 Vali Acc: 0.504 Test Loss: 1.907 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.4134607315063477
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.939 Vali Acc: 0.489 Test Loss: 1.939 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.1088616847991943
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.953 Vali Acc: 0.489 Test Loss: 1.953 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps720_str720_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 46373381
model size : 191.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps750_str188_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.0371038913726807
Epoch: 1, Steps: 8 | Train Loss: 1.558 Vali Loss: 1.624 Vali Acc: 0.420 Test Loss: 1.624 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 1.5507409572601318
Epoch: 2, Steps: 8 | Train Loss: 1.432 Vali Loss: 1.512 Vali Acc: 0.420 Test Loss: 1.512 Test Acc: 0.420
Validation loss decreased (-0.419831 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 1.9435725212097168
Epoch: 3, Steps: 8 | Train Loss: 1.168 Vali Loss: 1.392 Vali Acc: 0.435 Test Loss: 1.392 Test Acc: 0.435
Validation loss decreased (-0.419832 --> -0.435101).  Saving model ...
Epoch: 4 cost time: 1.2339794635772705
Epoch: 4, Steps: 8 | Train Loss: 0.849 Vali Loss: 1.182 Vali Acc: 0.527 Test Loss: 1.182 Test Acc: 0.527
Validation loss decreased (-0.435101 --> -0.526706).  Saving model ...
Epoch: 5 cost time: 1.1127195358276367
Epoch: 5, Steps: 8 | Train Loss: 0.426 Vali Loss: 1.185 Vali Acc: 0.550 Test Loss: 1.185 Test Acc: 0.550
Validation loss decreased (-0.526706 --> -0.549606).  Saving model ...
Epoch: 6 cost time: 2.0224952697753906
Epoch: 6, Steps: 8 | Train Loss: 0.109 Vali Loss: 1.393 Vali Acc: 0.588 Test Loss: 1.393 Test Acc: 0.588
Validation loss decreased (-0.549606 --> -0.587772).  Saving model ...
Epoch: 7 cost time: 1.4099323749542236
Epoch: 7, Steps: 8 | Train Loss: 0.027 Vali Loss: 1.487 Vali Acc: 0.588 Test Loss: 1.487 Test Acc: 0.588
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5627777576446533
Epoch: 8, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.688 Vali Acc: 0.542 Test Loss: 1.688 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.5186920166015625
Epoch: 9, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.822 Vali Acc: 0.573 Test Loss: 1.822 Test Acc: 0.573
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.2317891120910645
Epoch: 10, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.535 Vali Acc: 0.542 Test Loss: 1.535 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.9661781787872314
Epoch: 11, Steps: 8 | Train Loss: 0.007 Vali Loss: 2.019 Vali Acc: 0.534 Test Loss: 2.019 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.8478636741638184
Epoch: 12, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.629 Vali Acc: 0.573 Test Loss: 1.629 Test Acc: 0.573
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.205244779586792
Epoch: 13, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.876 Vali Acc: 0.580 Test Loss: 1.876 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.998814582824707
Epoch: 14, Steps: 8 | Train Loss: 0.005 Vali Loss: 3.357 Vali Acc: 0.550 Test Loss: 3.357 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.3869967460632324
Epoch: 15, Steps: 8 | Train Loss: 0.028 Vali Loss: 2.417 Vali Acc: 0.504 Test Loss: 2.417 Test Acc: 0.504
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.903778076171875
Epoch: 16, Steps: 8 | Train Loss: 0.007 Vali Loss: 2.425 Vali Acc: 0.534 Test Loss: 2.425 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps750_str188_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5877862595419847
model parameter : 47153669
model size : 194.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps750_str375_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.191035747528076
Epoch: 1, Steps: 8 | Train Loss: 1.538 Vali Loss: 1.618 Vali Acc: 0.420 Test Loss: 1.618 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 1.4306418895721436
Epoch: 2, Steps: 8 | Train Loss: 1.401 Vali Loss: 1.570 Vali Acc: 0.443 Test Loss: 1.570 Test Acc: 0.443
Validation loss decreased (-0.419831 --> -0.442732).  Saving model ...
Epoch: 3 cost time: 1.2487003803253174
Epoch: 3, Steps: 8 | Train Loss: 1.233 Vali Loss: 1.457 Vali Acc: 0.458 Test Loss: 1.457 Test Acc: 0.458
Validation loss decreased (-0.442732 --> -0.458001).  Saving model ...
Epoch: 4 cost time: 0.9319887161254883
Epoch: 4, Steps: 8 | Train Loss: 0.919 Vali Loss: 1.370 Vali Acc: 0.435 Test Loss: 1.370 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1954567432403564
Epoch: 5, Steps: 8 | Train Loss: 0.608 Vali Loss: 1.429 Vali Acc: 0.519 Test Loss: 1.429 Test Acc: 0.519
Validation loss decreased (-0.458001 --> -0.519070).  Saving model ...
Epoch: 6 cost time: 1.1989130973815918
Epoch: 6, Steps: 8 | Train Loss: 0.275 Vali Loss: 1.327 Vali Acc: 0.481 Test Loss: 1.327 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2731554508209229
Epoch: 7, Steps: 8 | Train Loss: 0.116 Vali Loss: 1.368 Vali Acc: 0.534 Test Loss: 1.368 Test Acc: 0.534
Validation loss decreased (-0.519070 --> -0.534337).  Saving model ...
Epoch: 8 cost time: 1.414053201675415
Epoch: 8, Steps: 8 | Train Loss: 0.031 Vali Loss: 1.419 Vali Acc: 0.489 Test Loss: 1.419 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2765514850616455
Epoch: 9, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.769 Vali Acc: 0.489 Test Loss: 1.769 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.5720891952514648
Epoch: 10, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.674 Vali Acc: 0.466 Test Loss: 1.674 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.8411030769348145
Epoch: 11, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.801 Vali Acc: 0.504 Test Loss: 1.801 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.6341469287872314
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.849 Vali Acc: 0.511 Test Loss: 1.849 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.7570562362670898
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.799 Vali Acc: 0.527 Test Loss: 1.799 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.4923622608184814
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.774 Vali Acc: 0.534 Test Loss: 1.774 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.062171697616577
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.794 Vali Acc: 0.534 Test Loss: 1.794 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.5170893669128418
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.813 Vali Acc: 0.550 Test Loss: 1.813 Test Acc: 0.550
Validation loss decreased (-0.534337 --> -0.549600).  Saving model ...
Epoch: 17 cost time: 1.7474567890167236
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.837 Vali Acc: 0.573 Test Loss: 1.837 Test Acc: 0.573
Validation loss decreased (-0.549600 --> -0.572501).  Saving model ...
Epoch: 18 cost time: 1.4195361137390137
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.863 Vali Acc: 0.573 Test Loss: 1.863 Test Acc: 0.573
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9063756465911865
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.892 Vali Acc: 0.573 Test Loss: 1.892 Test Acc: 0.573
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.444211483001709
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.931 Vali Acc: 0.580 Test Loss: 1.931 Test Acc: 0.580
Validation loss decreased (-0.572501 --> -0.580133).  Saving model ...
Epoch: 21 cost time: 1.4118211269378662
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.952 Vali Acc: 0.580 Test Loss: 1.952 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.3761398792266846
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.949 Vali Acc: 0.557 Test Loss: 1.949 Test Acc: 0.557
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.70107102394104
Epoch: 23, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.940 Vali Acc: 0.557 Test Loss: 1.940 Test Acc: 0.557
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.5388340950012207
Epoch: 24, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.933 Vali Acc: 0.565 Test Loss: 1.933 Test Acc: 0.565
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.509695053100586
Epoch: 25, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.930 Vali Acc: 0.557 Test Loss: 1.930 Test Acc: 0.557
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.3539302349090576
Epoch: 26, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.939 Vali Acc: 0.557 Test Loss: 1.939 Test Acc: 0.557
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.5058341026306152
Epoch: 27, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.951 Vali Acc: 0.557 Test Loss: 1.951 Test Acc: 0.557
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.584289789199829
Epoch: 28, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.957 Vali Acc: 0.557 Test Loss: 1.957 Test Acc: 0.557
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.4708819389343262
Epoch: 29, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.963 Vali Acc: 0.557 Test Loss: 1.963 Test Acc: 0.557
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.3410813808441162
Epoch: 30, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.975 Vali Acc: 0.557 Test Loss: 1.975 Test Acc: 0.557
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps750_str375_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5801526717557252
model parameter : 46906373
model size : 193.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps750_str750_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.6936757564544678
Epoch: 1, Steps: 8 | Train Loss: 1.574 Vali Loss: 1.632 Vali Acc: 0.420 Test Loss: 1.632 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 1.8756756782531738
Epoch: 2, Steps: 8 | Train Loss: 1.390 Vali Loss: 1.498 Vali Acc: 0.427 Test Loss: 1.498 Test Acc: 0.427
Validation loss decreased (-0.419831 --> -0.427466).  Saving model ...
Epoch: 3 cost time: 1.1585934162139893
Epoch: 3, Steps: 8 | Train Loss: 1.252 Vali Loss: 1.439 Vali Acc: 0.435 Test Loss: 1.439 Test Acc: 0.435
Validation loss decreased (-0.427466 --> -0.435100).  Saving model ...
Epoch: 4 cost time: 1.0257108211517334
Epoch: 4, Steps: 8 | Train Loss: 0.965 Vali Loss: 1.368 Vali Acc: 0.511 Test Loss: 1.368 Test Acc: 0.511
Validation loss decreased (-0.435100 --> -0.511437).  Saving model ...
Epoch: 5 cost time: 0.8127098083496094
Epoch: 5, Steps: 8 | Train Loss: 0.663 Vali Loss: 1.296 Vali Acc: 0.473 Test Loss: 1.296 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3057749271392822
Epoch: 6, Steps: 8 | Train Loss: 0.370 Vali Loss: 1.328 Vali Acc: 0.489 Test Loss: 1.328 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.6043152809143066
Epoch: 7, Steps: 8 | Train Loss: 0.164 Vali Loss: 1.294 Vali Acc: 0.550 Test Loss: 1.294 Test Acc: 0.550
Validation loss decreased (-0.511437 --> -0.549605).  Saving model ...
Epoch: 8 cost time: 1.0911812782287598
Epoch: 8, Steps: 8 | Train Loss: 0.057 Vali Loss: 1.507 Vali Acc: 0.527 Test Loss: 1.507 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3318564891815186
Epoch: 9, Steps: 8 | Train Loss: 0.021 Vali Loss: 1.494 Vali Acc: 0.534 Test Loss: 1.494 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.699721097946167
Epoch: 10, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.611 Vali Acc: 0.473 Test Loss: 1.611 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.5696096420288086
Epoch: 11, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.687 Vali Acc: 0.504 Test Loss: 1.687 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.402635097503662
Epoch: 12, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.726 Vali Acc: 0.496 Test Loss: 1.726 Test Acc: 0.496
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.8257081508636475
Epoch: 13, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.740 Vali Acc: 0.527 Test Loss: 1.740 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.230987787246704
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.761 Vali Acc: 0.511 Test Loss: 1.761 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.2739901542663574
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.786 Vali Acc: 0.511 Test Loss: 1.786 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.155541181564331
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.805 Vali Acc: 0.511 Test Loss: 1.805 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.192211389541626
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.808 Vali Acc: 0.511 Test Loss: 1.808 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps750_str750_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 46782725
model size : 193.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps782_str196_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.692021608352661
Epoch: 1, Steps: 8 | Train Loss: 1.555 Vali Loss: 1.623 Vali Acc: 0.420 Test Loss: 1.623 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 1.7822284698486328
Epoch: 2, Steps: 8 | Train Loss: 1.478 Vali Loss: 1.470 Vali Acc: 0.427 Test Loss: 1.470 Test Acc: 0.427
Validation loss decreased (-0.419831 --> -0.427466).  Saving model ...
Epoch: 3 cost time: 1.6809725761413574
Epoch: 3, Steps: 8 | Train Loss: 1.229 Vali Loss: 1.465 Vali Acc: 0.435 Test Loss: 1.465 Test Acc: 0.435
Validation loss decreased (-0.427466 --> -0.435100).  Saving model ...
Epoch: 4 cost time: 1.6037919521331787
Epoch: 4, Steps: 8 | Train Loss: 0.820 Vali Loss: 1.502 Vali Acc: 0.473 Test Loss: 1.502 Test Acc: 0.473
Validation loss decreased (-0.435100 --> -0.473267).  Saving model ...
Epoch: 5 cost time: 1.3731417655944824
Epoch: 5, Steps: 8 | Train Loss: 0.406 Vali Loss: 1.481 Vali Acc: 0.397 Test Loss: 1.481 Test Acc: 0.397
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.674370288848877
Epoch: 6, Steps: 8 | Train Loss: 0.126 Vali Loss: 1.871 Vali Acc: 0.511 Test Loss: 1.871 Test Acc: 0.511
Validation loss decreased (-0.473267 --> -0.511432).  Saving model ...
Epoch: 7 cost time: 1.4481401443481445
Epoch: 7, Steps: 8 | Train Loss: 0.036 Vali Loss: 1.918 Vali Acc: 0.534 Test Loss: 1.918 Test Acc: 0.534
Validation loss decreased (-0.511432 --> -0.534332).  Saving model ...
Epoch: 8 cost time: 1.694857120513916
Epoch: 8, Steps: 8 | Train Loss: 0.013 Vali Loss: 2.166 Vali Acc: 0.496 Test Loss: 2.166 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5533764362335205
Epoch: 9, Steps: 8 | Train Loss: 0.006 Vali Loss: 2.533 Vali Acc: 0.511 Test Loss: 2.533 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.529860019683838
Epoch: 10, Steps: 8 | Train Loss: 0.002 Vali Loss: 2.283 Vali Acc: 0.504 Test Loss: 2.283 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.7303621768951416
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.221 Vali Acc: 0.557 Test Loss: 2.221 Test Acc: 0.557
Validation loss decreased (-0.534332 --> -0.557230).  Saving model ...
Epoch: 12 cost time: 1.8200840950012207
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.286 Vali Acc: 0.550 Test Loss: 2.286 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.968632459640503
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.374 Vali Acc: 0.550 Test Loss: 2.374 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.058626651763916
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.435 Vali Acc: 0.550 Test Loss: 2.435 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.876241683959961
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.442 Vali Acc: 0.550 Test Loss: 2.442 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.002018690109253
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.447 Vali Acc: 0.550 Test Loss: 2.447 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.3476893901824951
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.449 Vali Acc: 0.550 Test Loss: 2.449 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.5934340953826904
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.455 Vali Acc: 0.550 Test Loss: 2.455 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.5348224639892578
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.451 Vali Acc: 0.550 Test Loss: 2.451 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.7906908988952637
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.455 Vali Acc: 0.557 Test Loss: 2.455 Test Acc: 0.557
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.250091552734375
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.463 Vali Acc: 0.557 Test Loss: 2.463 Test Acc: 0.557
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps782_str196_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 47574533
model size : 196.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps782_str391_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.18656587600708
Epoch: 1, Steps: 8 | Train Loss: 1.529 Vali Loss: 1.641 Vali Acc: 0.427 Test Loss: 1.641 Test Acc: 0.427
Validation loss decreased (inf --> -0.427465).  Saving model ...
Epoch: 2 cost time: 1.3851516246795654
Epoch: 2, Steps: 8 | Train Loss: 1.412 Vali Loss: 1.560 Vali Acc: 0.420 Test Loss: 1.560 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1397411823272705
Epoch: 3, Steps: 8 | Train Loss: 1.201 Vali Loss: 1.479 Vali Acc: 0.489 Test Loss: 1.479 Test Acc: 0.489
Validation loss decreased (-0.427465 --> -0.488535).  Saving model ...
Epoch: 4 cost time: 1.2567028999328613
Epoch: 4, Steps: 8 | Train Loss: 0.900 Vali Loss: 1.452 Vali Acc: 0.496 Test Loss: 1.452 Test Acc: 0.496
Validation loss decreased (-0.488535 --> -0.496169).  Saving model ...
Epoch: 5 cost time: 1.0824389457702637
Epoch: 5, Steps: 8 | Train Loss: 0.549 Vali Loss: 1.361 Vali Acc: 0.511 Test Loss: 1.361 Test Acc: 0.511
Validation loss decreased (-0.496169 --> -0.511437).  Saving model ...
Epoch: 6 cost time: 1.3266589641571045
Epoch: 6, Steps: 8 | Train Loss: 0.222 Vali Loss: 1.543 Vali Acc: 0.473 Test Loss: 1.543 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0633118152618408
Epoch: 7, Steps: 8 | Train Loss: 0.089 Vali Loss: 1.654 Vali Acc: 0.481 Test Loss: 1.654 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.8973085880279541
Epoch: 8, Steps: 8 | Train Loss: 0.031 Vali Loss: 1.873 Vali Acc: 0.573 Test Loss: 1.873 Test Acc: 0.573
Validation loss decreased (-0.511437 --> -0.572500).  Saving model ...
Epoch: 9 cost time: 1.021677017211914
Epoch: 9, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.826 Vali Acc: 0.496 Test Loss: 1.826 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1678917407989502
Epoch: 10, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.796 Vali Acc: 0.489 Test Loss: 1.796 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8592643737792969
Epoch: 11, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.886 Vali Acc: 0.504 Test Loss: 1.886 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.158118724822998
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.889 Vali Acc: 0.496 Test Loss: 1.889 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.1561908721923828
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.929 Vali Acc: 0.489 Test Loss: 1.929 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.7766683101654053
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.018 Vali Acc: 0.489 Test Loss: 2.018 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.1191861629486084
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.081 Vali Acc: 0.511 Test Loss: 2.081 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.1562271118164062
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.113 Vali Acc: 0.511 Test Loss: 2.113 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.2230310440063477
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.116 Vali Acc: 0.504 Test Loss: 2.116 Test Acc: 0.504
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.9149577617645264
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.140 Vali Acc: 0.511 Test Loss: 2.140 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps782_str391_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5725190839694656
model parameter : 47337989
model size : 195.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps782_str782_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.6319892406463623
Epoch: 1, Steps: 8 | Train Loss: 1.538 Vali Loss: 1.591 Vali Acc: 0.420 Test Loss: 1.591 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 1.3425416946411133
Epoch: 2, Steps: 8 | Train Loss: 1.383 Vali Loss: 1.517 Vali Acc: 0.427 Test Loss: 1.517 Test Acc: 0.427
Validation loss decreased (-0.419831 --> -0.427466).  Saving model ...
Epoch: 3 cost time: 1.5096218585968018
Epoch: 3, Steps: 8 | Train Loss: 1.184 Vali Loss: 1.489 Vali Acc: 0.473 Test Loss: 1.489 Test Acc: 0.473
Validation loss decreased (-0.427466 --> -0.473268).  Saving model ...
Epoch: 4 cost time: 1.114150047302246
Epoch: 4, Steps: 8 | Train Loss: 0.864 Vali Loss: 1.457 Vali Acc: 0.473 Test Loss: 1.457 Test Acc: 0.473
Validation loss decreased (-0.473268 --> -0.473268).  Saving model ...
Epoch: 5 cost time: 0.99881911277771
Epoch: 5, Steps: 8 | Train Loss: 0.597 Vali Loss: 1.351 Vali Acc: 0.473 Test Loss: 1.351 Test Acc: 0.473
Validation loss decreased (-0.473268 --> -0.473269).  Saving model ...
Epoch: 6 cost time: 1.5495564937591553
Epoch: 6, Steps: 8 | Train Loss: 0.304 Vali Loss: 1.330 Vali Acc: 0.504 Test Loss: 1.330 Test Acc: 0.504
Validation loss decreased (-0.473269 --> -0.503803).  Saving model ...
Epoch: 7 cost time: 1.6476986408233643
Epoch: 7, Steps: 8 | Train Loss: 0.140 Vali Loss: 1.260 Vali Acc: 0.542 Test Loss: 1.260 Test Acc: 0.542
Validation loss decreased (-0.503803 --> -0.541972).  Saving model ...
Epoch: 8 cost time: 1.229982614517212
Epoch: 8, Steps: 8 | Train Loss: 0.046 Vali Loss: 1.356 Vali Acc: 0.557 Test Loss: 1.356 Test Acc: 0.557
Validation loss decreased (-0.541972 --> -0.557238).  Saving model ...
Epoch: 9 cost time: 1.0182428359985352
Epoch: 9, Steps: 8 | Train Loss: 0.021 Vali Loss: 1.521 Vali Acc: 0.534 Test Loss: 1.521 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4124462604522705
Epoch: 10, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.593 Vali Acc: 0.550 Test Loss: 1.593 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.6221284866333008
Epoch: 11, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.612 Vali Acc: 0.557 Test Loss: 1.612 Test Acc: 0.557
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.3729312419891357
Epoch: 12, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.663 Vali Acc: 0.565 Test Loss: 1.663 Test Acc: 0.565
Validation loss decreased (-0.557238 --> -0.564869).  Saving model ...
Epoch: 13 cost time: 0.9076976776123047
Epoch: 13, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.622 Vali Acc: 0.573 Test Loss: 1.622 Test Acc: 0.573
Validation loss decreased (-0.564869 --> -0.572503).  Saving model ...
Epoch: 14 cost time: 1.5312137603759766
Epoch: 14, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.626 Vali Acc: 0.588 Test Loss: 1.626 Test Acc: 0.588
Validation loss decreased (-0.572503 --> -0.587770).  Saving model ...
Epoch: 15 cost time: 1.174929141998291
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.632 Vali Acc: 0.588 Test Loss: 1.632 Test Acc: 0.588
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.6351597309112549
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.651 Vali Acc: 0.588 Test Loss: 1.651 Test Acc: 0.588
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.0171902179718018
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.658 Vali Acc: 0.595 Test Loss: 1.658 Test Acc: 0.595
Validation loss decreased (-0.587770 --> -0.595403).  Saving model ...
Epoch: 18 cost time: 1.833120346069336
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.657 Vali Acc: 0.595 Test Loss: 1.657 Test Acc: 0.595
Validation loss decreased (-0.595403 --> -0.595403).  Saving model ...
Epoch: 19 cost time: 1.0451292991638184
Epoch: 19, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.655 Vali Acc: 0.595 Test Loss: 1.655 Test Acc: 0.595
Validation loss decreased (-0.595403 --> -0.595403).  Saving model ...
Epoch: 20 cost time: 1.4141852855682373
Epoch: 20, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.663 Vali Acc: 0.595 Test Loss: 1.663 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.2475624084472656
Epoch: 21, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.682 Vali Acc: 0.603 Test Loss: 1.682 Test Acc: 0.603
Validation loss decreased (-0.595403 --> -0.603037).  Saving model ...
Epoch: 22 cost time: 1.1042687892913818
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.703 Vali Acc: 0.603 Test Loss: 1.703 Test Acc: 0.603
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.3769073486328125
Epoch: 23, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.717 Vali Acc: 0.603 Test Loss: 1.717 Test Acc: 0.603
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.813166856765747
Epoch: 24, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.727 Vali Acc: 0.603 Test Loss: 1.727 Test Acc: 0.603
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.320713996887207
Epoch: 25, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.732 Vali Acc: 0.595 Test Loss: 1.732 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.171104907989502
Epoch: 26, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.733 Vali Acc: 0.595 Test Loss: 1.733 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.5996804237365723
Epoch: 27, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.734 Vali Acc: 0.595 Test Loss: 1.734 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.259491205215454
Epoch: 28, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.742 Vali Acc: 0.595 Test Loss: 1.742 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.3107354640960693
Epoch: 29, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.754 Vali Acc: 0.595 Test Loss: 1.754 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.820115327835083
Epoch: 30, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.779 Vali Acc: 0.595 Test Loss: 1.779 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.201296329498291
Epoch: 31, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.800 Vali Acc: 0.595 Test Loss: 1.800 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps782_str782_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6030534351145038
model parameter : 47219717
model size : 194.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps818_str205_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.679368734359741
Epoch: 1, Steps: 8 | Train Loss: 1.580 Vali Loss: 1.593 Vali Acc: 0.420 Test Loss: 1.593 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 1.6336379051208496
Epoch: 2, Steps: 8 | Train Loss: 1.430 Vali Loss: 1.572 Vali Acc: 0.405 Test Loss: 1.572 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4984161853790283
Epoch: 3, Steps: 8 | Train Loss: 1.132 Vali Loss: 1.442 Vali Acc: 0.450 Test Loss: 1.442 Test Acc: 0.450
Validation loss decreased (-0.419831 --> -0.450367).  Saving model ...
Epoch: 4 cost time: 1.4716975688934326
Epoch: 4, Steps: 8 | Train Loss: 0.714 Vali Loss: 1.356 Vali Acc: 0.450 Test Loss: 1.356 Test Acc: 0.450
Validation loss decreased (-0.450367 --> -0.450368).  Saving model ...
Epoch: 5 cost time: 1.5892596244812012
Epoch: 5, Steps: 8 | Train Loss: 0.326 Vali Loss: 1.445 Vali Acc: 0.405 Test Loss: 1.445 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.4789464473724365
Epoch: 6, Steps: 8 | Train Loss: 0.109 Vali Loss: 1.476 Vali Acc: 0.573 Test Loss: 1.476 Test Acc: 0.573
Validation loss decreased (-0.450368 --> -0.572504).  Saving model ...
Epoch: 7 cost time: 1.480222225189209
Epoch: 7, Steps: 8 | Train Loss: 0.031 Vali Loss: 1.633 Vali Acc: 0.565 Test Loss: 1.633 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4727635383605957
Epoch: 8, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.557 Vali Acc: 0.580 Test Loss: 1.557 Test Acc: 0.580
Validation loss decreased (-0.572504 --> -0.580137).  Saving model ...
Epoch: 9 cost time: 1.3712925910949707
Epoch: 9, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.843 Vali Acc: 0.527 Test Loss: 1.843 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4589636325836182
Epoch: 10, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.769 Vali Acc: 0.595 Test Loss: 1.769 Test Acc: 0.595
Validation loss decreased (-0.580137 --> -0.595402).  Saving model ...
Epoch: 11 cost time: 1.3900654315948486
Epoch: 11, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.688 Vali Acc: 0.618 Test Loss: 1.688 Test Acc: 0.618
Validation loss decreased (-0.595402 --> -0.618304).  Saving model ...
Epoch: 12 cost time: 1.1652801036834717
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.905 Vali Acc: 0.565 Test Loss: 1.905 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.08534836769104
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.938 Vali Acc: 0.542 Test Loss: 1.938 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.0869050025939941
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.833 Vali Acc: 0.626 Test Loss: 1.833 Test Acc: 0.626
Validation loss decreased (-0.618304 --> -0.625936).  Saving model ...
Epoch: 15 cost time: 1.6392877101898193
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.826 Vali Acc: 0.626 Test Loss: 1.826 Test Acc: 0.626
Validation loss decreased (-0.625936 --> -0.625936).  Saving model ...
Epoch: 16 cost time: 1.2348110675811768
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.853 Vali Acc: 0.595 Test Loss: 1.853 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3090543746948242
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.916 Vali Acc: 0.573 Test Loss: 1.916 Test Acc: 0.573
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.010817289352417
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.966 Vali Acc: 0.565 Test Loss: 1.966 Test Acc: 0.565
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.9870193004608154
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.972 Vali Acc: 0.565 Test Loss: 1.972 Test Acc: 0.565
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.013551950454712
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.978 Vali Acc: 0.565 Test Loss: 1.978 Test Acc: 0.565
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.0135581493377686
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.979 Vali Acc: 0.565 Test Loss: 1.979 Test Acc: 0.565
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.5105268955230713
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.985 Vali Acc: 0.565 Test Loss: 1.985 Test Acc: 0.565
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.4685311317443848
Epoch: 23, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.000 Vali Acc: 0.573 Test Loss: 2.000 Test Acc: 0.573
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.0816943645477295
Epoch: 24, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.012 Vali Acc: 0.573 Test Loss: 2.012 Test Acc: 0.573
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.1907734870910645
Epoch: 25, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.019 Vali Acc: 0.573 Test Loss: 2.019 Test Acc: 0.573
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps818_str205_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6259541984732825
model parameter : 48050693
model size : 197.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps818_str409_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.573636531829834
Epoch: 1, Steps: 8 | Train Loss: 1.531 Vali Loss: 1.586 Vali Acc: 0.420 Test Loss: 1.586 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 1.5534377098083496
Epoch: 2, Steps: 8 | Train Loss: 1.414 Vali Loss: 1.545 Vali Acc: 0.443 Test Loss: 1.545 Test Acc: 0.443
Validation loss decreased (-0.419831 --> -0.442733).  Saving model ...
Epoch: 3 cost time: 0.9388167858123779
Epoch: 3, Steps: 8 | Train Loss: 1.172 Vali Loss: 1.402 Vali Acc: 0.466 Test Loss: 1.402 Test Acc: 0.466
Validation loss decreased (-0.442733 --> -0.465635).  Saving model ...
Epoch: 4 cost time: 1.1575579643249512
Epoch: 4, Steps: 8 | Train Loss: 0.823 Vali Loss: 1.229 Vali Acc: 0.557 Test Loss: 1.229 Test Acc: 0.557
Validation loss decreased (-0.465635 --> -0.557240).  Saving model ...
Epoch: 5 cost time: 1.2316937446594238
Epoch: 5, Steps: 8 | Train Loss: 0.471 Vali Loss: 1.249 Vali Acc: 0.489 Test Loss: 1.249 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.450087070465088
Epoch: 6, Steps: 8 | Train Loss: 0.255 Vali Loss: 1.373 Vali Acc: 0.519 Test Loss: 1.373 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.8088452816009521
Epoch: 7, Steps: 8 | Train Loss: 0.085 Vali Loss: 1.267 Vali Acc: 0.588 Test Loss: 1.267 Test Acc: 0.588
Validation loss decreased (-0.557240 --> -0.587774).  Saving model ...
Epoch: 8 cost time: 1.3656578063964844
Epoch: 8, Steps: 8 | Train Loss: 0.023 Vali Loss: 1.261 Vali Acc: 0.565 Test Loss: 1.261 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2925949096679688
Epoch: 9, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.217 Vali Acc: 0.618 Test Loss: 1.217 Test Acc: 0.618
Validation loss decreased (-0.587774 --> -0.618308).  Saving model ...
Epoch: 10 cost time: 1.506833553314209
Epoch: 10, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.297 Vali Acc: 0.580 Test Loss: 1.297 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.17854905128479
Epoch: 11, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.344 Vali Acc: 0.580 Test Loss: 1.344 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.522146224975586
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.378 Vali Acc: 0.603 Test Loss: 1.378 Test Acc: 0.603
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.6377406120300293
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.418 Vali Acc: 0.603 Test Loss: 1.418 Test Acc: 0.603
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.0853960514068604
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.354 Vali Acc: 0.618 Test Loss: 1.354 Test Acc: 0.618
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.105633020401001
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.319 Vali Acc: 0.588 Test Loss: 1.319 Test Acc: 0.588
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.3092153072357178
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.341 Vali Acc: 0.580 Test Loss: 1.341 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.0337719917297363
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.370 Vali Acc: 0.603 Test Loss: 1.370 Test Acc: 0.603
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.204336166381836
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.386 Vali Acc: 0.603 Test Loss: 1.386 Test Acc: 0.603
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.9427003860473633
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.398 Vali Acc: 0.603 Test Loss: 1.398 Test Acc: 0.603
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps818_str409_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6183206106870229
model parameter : 47824901
model size : 197.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps818_str818_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.354551076889038
Epoch: 1, Steps: 8 | Train Loss: 1.524 Vali Loss: 1.514 Vali Acc: 0.420 Test Loss: 1.514 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 0.7818295955657959
Epoch: 2, Steps: 8 | Train Loss: 1.395 Vali Loss: 1.525 Vali Acc: 0.435 Test Loss: 1.525 Test Acc: 0.435
Validation loss decreased (-0.419832 --> -0.435099).  Saving model ...
Epoch: 3 cost time: 1.3056559562683105
Epoch: 3, Steps: 8 | Train Loss: 1.168 Vali Loss: 1.431 Vali Acc: 0.496 Test Loss: 1.431 Test Acc: 0.496
Validation loss decreased (-0.435099 --> -0.496169).  Saving model ...
Epoch: 4 cost time: 0.9384710788726807
Epoch: 4, Steps: 8 | Train Loss: 0.848 Vali Loss: 1.282 Vali Acc: 0.550 Test Loss: 1.282 Test Acc: 0.550
Validation loss decreased (-0.496169 --> -0.549605).  Saving model ...
Epoch: 5 cost time: 0.901587724685669
Epoch: 5, Steps: 8 | Train Loss: 0.575 Vali Loss: 1.231 Vali Acc: 0.557 Test Loss: 1.231 Test Acc: 0.557
Validation loss decreased (-0.549605 --> -0.557240).  Saving model ...
Epoch: 6 cost time: 0.8614120483398438
Epoch: 6, Steps: 8 | Train Loss: 0.297 Vali Loss: 1.187 Vali Acc: 0.588 Test Loss: 1.187 Test Acc: 0.588
Validation loss decreased (-0.557240 --> -0.587774).  Saving model ...
Epoch: 7 cost time: 0.9139268398284912
Epoch: 7, Steps: 8 | Train Loss: 0.125 Vali Loss: 1.147 Vali Acc: 0.588 Test Loss: 1.147 Test Acc: 0.588
Validation loss decreased (-0.587774 --> -0.587775).  Saving model ...
Epoch: 8 cost time: 1.0623786449432373
Epoch: 8, Steps: 8 | Train Loss: 0.044 Vali Loss: 1.349 Vali Acc: 0.511 Test Loss: 1.349 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.07667875289917
Epoch: 9, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.570 Vali Acc: 0.496 Test Loss: 1.570 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.985053300857544
Epoch: 10, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.632 Vali Acc: 0.496 Test Loss: 1.632 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.9899587631225586
Epoch: 11, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.598 Vali Acc: 0.496 Test Loss: 1.598 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.8892247676849365
Epoch: 12, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.593 Vali Acc: 0.489 Test Loss: 1.593 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.8570897579193115
Epoch: 13, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.649 Vali Acc: 0.489 Test Loss: 1.649 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.9791834354400635
Epoch: 14, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.686 Vali Acc: 0.504 Test Loss: 1.686 Test Acc: 0.504
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.0680065155029297
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.687 Vali Acc: 0.519 Test Loss: 1.687 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.2077438831329346
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.684 Vali Acc: 0.519 Test Loss: 1.684 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.1215393543243408
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.680 Vali Acc: 0.519 Test Loss: 1.680 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps818_str818_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5877862595419847
model parameter : 47712005
model size : 196.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps857_str215_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.463014841079712
Epoch: 1, Steps: 8 | Train Loss: 1.565 Vali Loss: 1.734 Vali Acc: 0.420 Test Loss: 1.734 Test Acc: 0.420
Validation loss decreased (inf --> -0.419830).  Saving model ...
Epoch: 2 cost time: 1.3478596210479736
Epoch: 2, Steps: 8 | Train Loss: 1.489 Vali Loss: 1.654 Vali Acc: 0.221 Test Loss: 1.654 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0182878971099854
Epoch: 3, Steps: 8 | Train Loss: 1.208 Vali Loss: 1.509 Vali Acc: 0.427 Test Loss: 1.509 Test Acc: 0.427
Validation loss decreased (-0.419830 --> -0.427466).  Saving model ...
Epoch: 4 cost time: 1.2529311180114746
Epoch: 4, Steps: 8 | Train Loss: 0.839 Vali Loss: 1.366 Vali Acc: 0.527 Test Loss: 1.366 Test Acc: 0.527
Validation loss decreased (-0.427466 --> -0.526704).  Saving model ...
Epoch: 5 cost time: 1.7555899620056152
Epoch: 5, Steps: 8 | Train Loss: 0.498 Vali Loss: 1.473 Vali Acc: 0.450 Test Loss: 1.473 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.419616460800171
Epoch: 6, Steps: 8 | Train Loss: 0.166 Vali Loss: 1.623 Vali Acc: 0.405 Test Loss: 1.623 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.5119895935058594
Epoch: 7, Steps: 8 | Train Loss: 0.038 Vali Loss: 1.502 Vali Acc: 0.489 Test Loss: 1.502 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.3988313674926758
Epoch: 8, Steps: 8 | Train Loss: 0.015 Vali Loss: 2.163 Vali Acc: 0.389 Test Loss: 2.163 Test Acc: 0.389
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.3317644596099854
Epoch: 9, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.858 Vali Acc: 0.511 Test Loss: 1.858 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.0214905738830566
Epoch: 10, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.994 Vali Acc: 0.504 Test Loss: 1.994 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.2503254413604736
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.789 Vali Acc: 0.466 Test Loss: 1.789 Test Acc: 0.466
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.3846917152404785
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.835 Vali Acc: 0.489 Test Loss: 1.835 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.8244128227233887
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.927 Vali Acc: 0.481 Test Loss: 1.927 Test Acc: 0.481
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.912043809890747
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.985 Vali Acc: 0.511 Test Loss: 1.985 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps857_str215_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 48568325
model size : 199.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps857_str429_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.2782607078552246
Epoch: 1, Steps: 8 | Train Loss: 1.642 Vali Loss: 1.612 Vali Acc: 0.420 Test Loss: 1.612 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 1.3291409015655518
Epoch: 2, Steps: 8 | Train Loss: 1.399 Vali Loss: 1.547 Vali Acc: 0.443 Test Loss: 1.547 Test Acc: 0.443
Validation loss decreased (-0.419831 --> -0.442733).  Saving model ...
Epoch: 3 cost time: 1.3212025165557861
Epoch: 3, Steps: 8 | Train Loss: 1.127 Vali Loss: 1.418 Vali Acc: 0.496 Test Loss: 1.418 Test Acc: 0.496
Validation loss decreased (-0.442733 --> -0.496169).  Saving model ...
Epoch: 4 cost time: 1.0278723239898682
Epoch: 4, Steps: 8 | Train Loss: 0.812 Vali Loss: 1.365 Vali Acc: 0.504 Test Loss: 1.365 Test Acc: 0.504
Validation loss decreased (-0.496169 --> -0.503803).  Saving model ...
Epoch: 5 cost time: 0.8286142349243164
Epoch: 5, Steps: 8 | Train Loss: 0.504 Vali Loss: 1.383 Vali Acc: 0.519 Test Loss: 1.383 Test Acc: 0.519
Validation loss decreased (-0.503803 --> -0.519070).  Saving model ...
Epoch: 6 cost time: 0.9942600727081299
Epoch: 6, Steps: 8 | Train Loss: 0.224 Vali Loss: 1.397 Vali Acc: 0.473 Test Loss: 1.397 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1005749702453613
Epoch: 7, Steps: 8 | Train Loss: 0.088 Vali Loss: 1.561 Vali Acc: 0.511 Test Loss: 1.561 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1294198036193848
Epoch: 8, Steps: 8 | Train Loss: 0.028 Vali Loss: 1.491 Vali Acc: 0.542 Test Loss: 1.491 Test Acc: 0.542
Validation loss decreased (-0.519070 --> -0.541970).  Saving model ...
Epoch: 9 cost time: 1.947072982788086
Epoch: 9, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.523 Vali Acc: 0.527 Test Loss: 1.523 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2007806301116943
Epoch: 10, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.534 Vali Acc: 0.557 Test Loss: 1.534 Test Acc: 0.557
Validation loss decreased (-0.541970 --> -0.557237).  Saving model ...
Epoch: 11 cost time: 1.847348928451538
Epoch: 11, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.828 Vali Acc: 0.527 Test Loss: 1.828 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3259334564208984
Epoch: 12, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.937 Vali Acc: 0.511 Test Loss: 1.937 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.434110164642334
Epoch: 13, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.895 Vali Acc: 0.496 Test Loss: 1.895 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.9779133796691895
Epoch: 14, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.863 Vali Acc: 0.496 Test Loss: 1.863 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.8690309524536133
Epoch: 15, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.851 Vali Acc: 0.511 Test Loss: 1.851 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.5023291110992432
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.867 Vali Acc: 0.527 Test Loss: 1.867 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.487259864807129
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.888 Vali Acc: 0.542 Test Loss: 1.888 Test Acc: 0.542
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.1857523918151855
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.898 Vali Acc: 0.519 Test Loss: 1.898 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.2725155353546143
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.911 Vali Acc: 0.534 Test Loss: 1.911 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.124359369277954
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.925 Vali Acc: 0.527 Test Loss: 1.925 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps857_str429_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 48353285
model size : 199.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps857_str857_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.8841018676757812
Epoch: 1, Steps: 8 | Train Loss: 1.538 Vali Loss: 1.584 Vali Acc: 0.420 Test Loss: 1.584 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 1.8158042430877686
Epoch: 2, Steps: 8 | Train Loss: 1.404 Vali Loss: 1.493 Vali Acc: 0.458 Test Loss: 1.493 Test Acc: 0.458
Validation loss decreased (-0.419831 --> -0.458000).  Saving model ...
Epoch: 3 cost time: 1.2031688690185547
Epoch: 3, Steps: 8 | Train Loss: 1.206 Vali Loss: 1.415 Vali Acc: 0.473 Test Loss: 1.415 Test Acc: 0.473
Validation loss decreased (-0.458000 --> -0.473268).  Saving model ...
Epoch: 4 cost time: 1.0549869537353516
Epoch: 4, Steps: 8 | Train Loss: 0.937 Vali Loss: 1.368 Vali Acc: 0.481 Test Loss: 1.368 Test Acc: 0.481
Validation loss decreased (-0.473268 --> -0.480902).  Saving model ...
Epoch: 5 cost time: 0.9569015502929688
Epoch: 5, Steps: 8 | Train Loss: 0.639 Vali Loss: 1.403 Vali Acc: 0.504 Test Loss: 1.403 Test Acc: 0.504
Validation loss decreased (-0.480902 --> -0.503803).  Saving model ...
Epoch: 6 cost time: 1.0307416915893555
Epoch: 6, Steps: 8 | Train Loss: 0.377 Vali Loss: 1.438 Vali Acc: 0.473 Test Loss: 1.438 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9537672996520996
Epoch: 7, Steps: 8 | Train Loss: 0.172 Vali Loss: 1.495 Vali Acc: 0.489 Test Loss: 1.495 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1388916969299316
Epoch: 8, Steps: 8 | Train Loss: 0.074 Vali Loss: 1.461 Vali Acc: 0.458 Test Loss: 1.461 Test Acc: 0.458
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.9375486373901367
Epoch: 9, Steps: 8 | Train Loss: 0.026 Vali Loss: 1.559 Vali Acc: 0.481 Test Loss: 1.559 Test Acc: 0.481
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.9236767292022705
Epoch: 10, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.666 Vali Acc: 0.496 Test Loss: 1.666 Test Acc: 0.496
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.1012828350067139
Epoch: 11, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.713 Vali Acc: 0.489 Test Loss: 1.713 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.3575279712677002
Epoch: 12, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.769 Vali Acc: 0.511 Test Loss: 1.769 Test Acc: 0.511
Validation loss decreased (-0.503803 --> -0.511433).  Saving model ...
Epoch: 13 cost time: 1.1899282932281494
Epoch: 13, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.789 Vali Acc: 0.496 Test Loss: 1.789 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8163061141967773
Epoch: 14, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.774 Vali Acc: 0.496 Test Loss: 1.774 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.353437900543213
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.771 Vali Acc: 0.496 Test Loss: 1.771 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.024561882019043
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.781 Vali Acc: 0.489 Test Loss: 1.781 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.9499485492706299
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.787 Vali Acc: 0.496 Test Loss: 1.787 Test Acc: 0.496
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.8250863552093506
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.787 Vali Acc: 0.489 Test Loss: 1.787 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.8951146602630615
Epoch: 19, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.794 Vali Acc: 0.504 Test Loss: 1.794 Test Acc: 0.504
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.8679676055908203
Epoch: 20, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.796 Vali Acc: 0.504 Test Loss: 1.796 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.8167600631713867
Epoch: 21, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.804 Vali Acc: 0.504 Test Loss: 1.804 Test Acc: 0.504
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.0157394409179688
Epoch: 22, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.816 Vali Acc: 0.511 Test Loss: 1.816 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps857_str857_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5114503816793893
model parameter : 48245765
model size : 198.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps900_str225_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.2408933639526367
Epoch: 1, Steps: 8 | Train Loss: 1.661 Vali Loss: 1.774 Vali Acc: 0.420 Test Loss: 1.774 Test Acc: 0.420
Validation loss decreased (inf --> -0.419830).  Saving model ...
Epoch: 2 cost time: 1.882394552230835
Epoch: 2, Steps: 8 | Train Loss: 1.450 Vali Loss: 1.528 Vali Acc: 0.435 Test Loss: 1.528 Test Acc: 0.435
Validation loss decreased (-0.419830 --> -0.435099).  Saving model ...
Epoch: 3 cost time: 1.5530929565429688
Epoch: 3, Steps: 8 | Train Loss: 1.177 Vali Loss: 1.504 Vali Acc: 0.458 Test Loss: 1.504 Test Acc: 0.458
Validation loss decreased (-0.435099 --> -0.458000).  Saving model ...
Epoch: 4 cost time: 1.1285080909729004
Epoch: 4, Steps: 8 | Train Loss: 0.751 Vali Loss: 1.333 Vali Acc: 0.542 Test Loss: 1.333 Test Acc: 0.542
Validation loss decreased (-0.458000 --> -0.541971).  Saving model ...
Epoch: 5 cost time: 1.6142964363098145
Epoch: 5, Steps: 8 | Train Loss: 0.354 Vali Loss: 1.375 Vali Acc: 0.412 Test Loss: 1.375 Test Acc: 0.412
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5424485206604004
Epoch: 6, Steps: 8 | Train Loss: 0.112 Vali Loss: 1.564 Vali Acc: 0.519 Test Loss: 1.564 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.407921552658081
Epoch: 7, Steps: 8 | Train Loss: 0.026 Vali Loss: 2.219 Vali Acc: 0.550 Test Loss: 2.219 Test Acc: 0.550
Validation loss decreased (-0.541971 --> -0.549596).  Saving model ...
Epoch: 8 cost time: 1.652238130569458
Epoch: 8, Steps: 8 | Train Loss: 0.018 Vali Loss: 1.636 Vali Acc: 0.473 Test Loss: 1.636 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.7781140804290771
Epoch: 9, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.797 Vali Acc: 0.527 Test Loss: 1.797 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.381284236907959
Epoch: 10, Steps: 8 | Train Loss: 0.007 Vali Loss: 2.021 Vali Acc: 0.519 Test Loss: 2.021 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.865051507949829
Epoch: 11, Steps: 8 | Train Loss: 0.003 Vali Loss: 2.372 Vali Acc: 0.550 Test Loss: 2.372 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.4376728534698486
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 2.335 Vali Acc: 0.534 Test Loss: 2.335 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.5080246925354004
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.115 Vali Acc: 0.542 Test Loss: 2.115 Test Acc: 0.542
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.363501787185669
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.035 Vali Acc: 0.534 Test Loss: 2.035 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.347984790802002
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.055 Vali Acc: 0.542 Test Loss: 2.055 Test Acc: 0.542
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.5206477642059326
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.091 Vali Acc: 0.542 Test Loss: 2.091 Test Acc: 0.542
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.3299734592437744
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.111 Vali Acc: 0.550 Test Loss: 2.111 Test Acc: 0.550
Validation loss decreased (-0.549596 --> -0.549597).  Saving model ...
Epoch: 18 cost time: 1.7870283126831055
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.136 Vali Acc: 0.550 Test Loss: 2.136 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2862284183502197
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.146 Vali Acc: 0.550 Test Loss: 2.146 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.6793856620788574
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.146 Vali Acc: 0.550 Test Loss: 2.146 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.6229450702667236
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.153 Vali Acc: 0.557 Test Loss: 2.153 Test Acc: 0.557
Validation loss decreased (-0.549597 --> -0.557230).  Saving model ...
Epoch: 22 cost time: 1.549516201019287
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.156 Vali Acc: 0.557 Test Loss: 2.156 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.7467470169067383
Epoch: 23, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.152 Vali Acc: 0.557 Test Loss: 2.152 Test Acc: 0.557
Validation loss decreased (-0.557230 --> -0.557230).  Saving model ...
Epoch: 24 cost time: 1.542146921157837
Epoch: 24, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.160 Vali Acc: 0.557 Test Loss: 2.160 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.732675552368164
Epoch: 25, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.169 Vali Acc: 0.557 Test Loss: 2.169 Test Acc: 0.557
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.4394407272338867
Epoch: 26, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.177 Vali Acc: 0.557 Test Loss: 2.177 Test Acc: 0.557
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.869818925857544
Epoch: 27, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.178 Vali Acc: 0.557 Test Loss: 2.178 Test Acc: 0.557
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.7506256103515625
Epoch: 28, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.197 Vali Acc: 0.557 Test Loss: 2.197 Test Acc: 0.557
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.7159030437469482
Epoch: 29, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.217 Vali Acc: 0.573 Test Loss: 2.217 Test Acc: 0.573
Validation loss decreased (-0.557230 --> -0.572497).  Saving model ...
Epoch: 30 cost time: 1.5307762622833252
Epoch: 30, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.221 Vali Acc: 0.573 Test Loss: 2.221 Test Acc: 0.573
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.3558101654052734
Epoch: 31, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.209 Vali Acc: 0.573 Test Loss: 2.209 Test Acc: 0.573
Validation loss decreased (-0.572497 --> -0.572497).  Saving model ...
Epoch: 32 cost time: 1.6504566669464111
Epoch: 32, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.212 Vali Acc: 0.573 Test Loss: 2.212 Test Acc: 0.573
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.285667896270752
Epoch: 33, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.212 Vali Acc: 0.573 Test Loss: 2.212 Test Acc: 0.573
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.6131608486175537
Epoch: 34, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.217 Vali Acc: 0.565 Test Loss: 2.217 Test Acc: 0.565
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.8789308071136475
Epoch: 35, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.221 Vali Acc: 0.565 Test Loss: 2.221 Test Acc: 0.565
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.796861171722412
Epoch: 36, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.221 Vali Acc: 0.565 Test Loss: 2.221 Test Acc: 0.565
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.6316568851470947
Epoch: 37, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.216 Vali Acc: 0.573 Test Loss: 2.216 Test Acc: 0.573
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.4669840335845947
Epoch: 38, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.206 Vali Acc: 0.573 Test Loss: 2.206 Test Acc: 0.573
Validation loss decreased (-0.572497 --> -0.572497).  Saving model ...
Epoch: 39 cost time: 1.5259499549865723
Epoch: 39, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.206 Vali Acc: 0.565 Test Loss: 2.206 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.5890178680419922
Epoch: 40, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.213 Vali Acc: 0.565 Test Loss: 2.213 Test Acc: 0.565
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.7403688430786133
Epoch: 41, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.220 Vali Acc: 0.565 Test Loss: 2.220 Test Acc: 0.565
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.5295875072479248
Epoch: 42, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.225 Vali Acc: 0.565 Test Loss: 2.225 Test Acc: 0.565
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.425130844116211
Epoch: 43, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.231 Vali Acc: 0.565 Test Loss: 2.231 Test Acc: 0.565
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.4518930912017822
Epoch: 44, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.238 Vali Acc: 0.573 Test Loss: 2.238 Test Acc: 0.573
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 1.557692289352417
Epoch: 45, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.244 Vali Acc: 0.573 Test Loss: 2.244 Test Acc: 0.573
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 1.5596740245819092
Epoch: 46, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.248 Vali Acc: 0.573 Test Loss: 2.248 Test Acc: 0.573
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 1.4148027896881104
Epoch: 47, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.252 Vali Acc: 0.580 Test Loss: 2.252 Test Acc: 0.580
Validation loss decreased (-0.572497 --> -0.580130).  Saving model ...
Epoch: 48 cost time: 1.512373447418213
Epoch: 48, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.249 Vali Acc: 0.580 Test Loss: 2.249 Test Acc: 0.580
Validation loss decreased (-0.580130 --> -0.580130).  Saving model ...
Epoch: 49 cost time: 1.6171514987945557
Epoch: 49, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.250 Vali Acc: 0.573 Test Loss: 2.250 Test Acc: 0.573
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.6111996173858643
Epoch: 50, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.249 Vali Acc: 0.573 Test Loss: 2.249 Test Acc: 0.573
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps900_str225_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5801526717557252
model parameter : 49141253
model size : 202.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps900_str450_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.887441873550415
Epoch: 1, Steps: 8 | Train Loss: 1.527 Vali Loss: 1.683 Vali Acc: 0.420 Test Loss: 1.683 Test Acc: 0.420
Validation loss decreased (inf --> -0.419830).  Saving model ...
Epoch: 2 cost time: 1.3122355937957764
Epoch: 2, Steps: 8 | Train Loss: 1.391 Vali Loss: 1.508 Vali Acc: 0.458 Test Loss: 1.508 Test Acc: 0.458
Validation loss decreased (-0.419830 --> -0.458000).  Saving model ...
Epoch: 3 cost time: 1.0499560832977295
Epoch: 3, Steps: 8 | Train Loss: 1.124 Vali Loss: 1.368 Vali Acc: 0.504 Test Loss: 1.368 Test Acc: 0.504
Validation loss decreased (-0.458000 --> -0.503803).  Saving model ...
Epoch: 4 cost time: 1.1420226097106934
Epoch: 4, Steps: 8 | Train Loss: 0.754 Vali Loss: 1.263 Vali Acc: 0.557 Test Loss: 1.263 Test Acc: 0.557
Validation loss decreased (-0.503803 --> -0.557239).  Saving model ...
Epoch: 5 cost time: 1.157503366470337
Epoch: 5, Steps: 8 | Train Loss: 0.423 Vali Loss: 1.230 Vali Acc: 0.550 Test Loss: 1.230 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.254709005355835
Epoch: 6, Steps: 8 | Train Loss: 0.183 Vali Loss: 1.355 Vali Acc: 0.550 Test Loss: 1.355 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.4434232711791992
Epoch: 7, Steps: 8 | Train Loss: 0.073 Vali Loss: 1.375 Vali Acc: 0.580 Test Loss: 1.375 Test Acc: 0.580
Validation loss decreased (-0.557239 --> -0.580139).  Saving model ...
Epoch: 8 cost time: 1.0900297164916992
Epoch: 8, Steps: 8 | Train Loss: 0.022 Vali Loss: 1.309 Vali Acc: 0.550 Test Loss: 1.309 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3942670822143555
Epoch: 9, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.443 Vali Acc: 0.519 Test Loss: 1.443 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.321453332901001
Epoch: 10, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.530 Vali Acc: 0.542 Test Loss: 1.530 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.2505006790161133
Epoch: 11, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.422 Vali Acc: 0.550 Test Loss: 1.422 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.593750238418579
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.434 Vali Acc: 0.595 Test Loss: 1.434 Test Acc: 0.595
Validation loss decreased (-0.580139 --> -0.595406).  Saving model ...
Epoch: 13 cost time: 1.2921035289764404
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.483 Vali Acc: 0.580 Test Loss: 1.483 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1339333057403564
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.532 Vali Acc: 0.565 Test Loss: 1.532 Test Acc: 0.565
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.2443957328796387
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.539 Vali Acc: 0.565 Test Loss: 1.539 Test Acc: 0.565
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.0947327613830566
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.524 Vali Acc: 0.557 Test Loss: 1.524 Test Acc: 0.557
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.5287079811096191
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.517 Vali Acc: 0.565 Test Loss: 1.517 Test Acc: 0.565
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.056440830230713
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.521 Vali Acc: 0.557 Test Loss: 1.521 Test Acc: 0.557
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.19352388381958
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.537 Vali Acc: 0.573 Test Loss: 1.537 Test Acc: 0.573
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.2446508407592773
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.543 Vali Acc: 0.557 Test Loss: 1.543 Test Acc: 0.557
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.4164879322052002
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.549 Vali Acc: 0.550 Test Loss: 1.549 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.5517516136169434
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.558 Vali Acc: 0.550 Test Loss: 1.558 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps900_str450_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5954198473282443
model parameter : 48936965
model size : 201.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps900_str900_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.09033465385437
Epoch: 1, Steps: 8 | Train Loss: 1.545 Vali Loss: 1.544 Vali Acc: 0.420 Test Loss: 1.544 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 1.2038404941558838
Epoch: 2, Steps: 8 | Train Loss: 1.389 Vali Loss: 1.545 Vali Acc: 0.420 Test Loss: 1.545 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0964100360870361
Epoch: 3, Steps: 8 | Train Loss: 1.148 Vali Loss: 1.489 Vali Acc: 0.504 Test Loss: 1.489 Test Acc: 0.504
Validation loss decreased (-0.419832 --> -0.503802).  Saving model ...
Epoch: 4 cost time: 1.0569546222686768
Epoch: 4, Steps: 8 | Train Loss: 0.821 Vali Loss: 1.470 Vali Acc: 0.458 Test Loss: 1.470 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0603406429290771
Epoch: 5, Steps: 8 | Train Loss: 0.504 Vali Loss: 1.385 Vali Acc: 0.511 Test Loss: 1.385 Test Acc: 0.511
Validation loss decreased (-0.503802 --> -0.511437).  Saving model ...
Epoch: 6 cost time: 1.133958101272583
Epoch: 6, Steps: 8 | Train Loss: 0.246 Vali Loss: 1.418 Vali Acc: 0.565 Test Loss: 1.418 Test Acc: 0.565
Validation loss decreased (-0.511437 --> -0.564871).  Saving model ...
Epoch: 7 cost time: 1.03424072265625
Epoch: 7, Steps: 8 | Train Loss: 0.099 Vali Loss: 1.525 Vali Acc: 0.527 Test Loss: 1.525 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0682213306427002
Epoch: 8, Steps: 8 | Train Loss: 0.034 Vali Loss: 1.563 Vali Acc: 0.519 Test Loss: 1.563 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.25588059425354
Epoch: 9, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.542 Vali Acc: 0.519 Test Loss: 1.542 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.2731671333312988
Epoch: 10, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.608 Vali Acc: 0.527 Test Loss: 1.608 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.1446738243103027
Epoch: 11, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.579 Vali Acc: 0.527 Test Loss: 1.579 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.4364919662475586
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.585 Vali Acc: 0.527 Test Loss: 1.585 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.2712197303771973
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.605 Vali Acc: 0.519 Test Loss: 1.605 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.1045775413513184
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.629 Vali Acc: 0.519 Test Loss: 1.629 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.2871265411376953
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.649 Vali Acc: 0.511 Test Loss: 1.649 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.2631359100341797
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.663 Vali Acc: 0.519 Test Loss: 1.663 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps900_str900_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5648854961832062
model parameter : 48834821
model size : 200.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps947_str237_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.474973678588867
Epoch: 1, Steps: 8 | Train Loss: 1.628 Vali Loss: 1.715 Vali Acc: 0.420 Test Loss: 1.715 Test Acc: 0.420
Validation loss decreased (inf --> -0.419830).  Saving model ...
Epoch: 2 cost time: 1.487070083618164
Epoch: 2, Steps: 8 | Train Loss: 1.449 Vali Loss: 1.477 Vali Acc: 0.481 Test Loss: 1.477 Test Acc: 0.481
Validation loss decreased (-0.419830 --> -0.480901).  Saving model ...
Epoch: 3 cost time: 1.353062629699707
Epoch: 3, Steps: 8 | Train Loss: 1.181 Vali Loss: 1.414 Vali Acc: 0.489 Test Loss: 1.414 Test Acc: 0.489
Validation loss decreased (-0.480901 --> -0.488535).  Saving model ...
Epoch: 4 cost time: 1.3478147983551025
Epoch: 4, Steps: 8 | Train Loss: 0.838 Vali Loss: 1.386 Vali Acc: 0.412 Test Loss: 1.386 Test Acc: 0.412
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.463334083557129
Epoch: 5, Steps: 8 | Train Loss: 0.553 Vali Loss: 1.512 Vali Acc: 0.481 Test Loss: 1.512 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.4291126728057861
Epoch: 6, Steps: 8 | Train Loss: 0.208 Vali Loss: 1.383 Vali Acc: 0.573 Test Loss: 1.383 Test Acc: 0.573
Validation loss decreased (-0.488535 --> -0.572505).  Saving model ...
Epoch: 7 cost time: 1.0840849876403809
Epoch: 7, Steps: 8 | Train Loss: 0.084 Vali Loss: 1.815 Vali Acc: 0.458 Test Loss: 1.815 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.225269079208374
Epoch: 8, Steps: 8 | Train Loss: 0.022 Vali Loss: 1.792 Vali Acc: 0.504 Test Loss: 1.792 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.3898851871490479
Epoch: 9, Steps: 8 | Train Loss: 0.006 Vali Loss: 2.058 Vali Acc: 0.496 Test Loss: 2.058 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.2560791969299316
Epoch: 10, Steps: 8 | Train Loss: 0.003 Vali Loss: 2.214 Vali Acc: 0.527 Test Loss: 2.214 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.3157038688659668
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.095 Vali Acc: 0.534 Test Loss: 2.095 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.2801287174224854
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.089 Vali Acc: 0.550 Test Loss: 2.089 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.1307153701782227
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.132 Vali Acc: 0.565 Test Loss: 2.132 Test Acc: 0.565
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.3273508548736572
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.181 Vali Acc: 0.565 Test Loss: 2.181 Test Acc: 0.565
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.271838665008545
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.223 Vali Acc: 0.534 Test Loss: 2.223 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.2303967475891113
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.252 Vali Acc: 0.534 Test Loss: 2.252 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps947_str237_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5725190839694656
model parameter : 49769477
model size : 204.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps947_str474_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.471994161605835
Epoch: 1, Steps: 8 | Train Loss: 1.598 Vali Loss: 1.587 Vali Acc: 0.420 Test Loss: 1.587 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 0.9693467617034912
Epoch: 2, Steps: 8 | Train Loss: 1.377 Vali Loss: 1.440 Vali Acc: 0.473 Test Loss: 1.440 Test Acc: 0.473
Validation loss decreased (-0.419831 --> -0.473268).  Saving model ...
Epoch: 3 cost time: 1.159825086593628
Epoch: 3, Steps: 8 | Train Loss: 1.088 Vali Loss: 1.339 Vali Acc: 0.557 Test Loss: 1.339 Test Acc: 0.557
Validation loss decreased (-0.473268 --> -0.557239).  Saving model ...
Epoch: 4 cost time: 1.1247179508209229
Epoch: 4, Steps: 8 | Train Loss: 0.827 Vali Loss: 1.314 Vali Acc: 0.542 Test Loss: 1.314 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9358530044555664
Epoch: 5, Steps: 8 | Train Loss: 0.442 Vali Loss: 1.306 Vali Acc: 0.481 Test Loss: 1.306 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.22105073928833
Epoch: 6, Steps: 8 | Train Loss: 0.191 Vali Loss: 1.373 Vali Acc: 0.534 Test Loss: 1.373 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.1115105152130127
Epoch: 7, Steps: 8 | Train Loss: 0.073 Vali Loss: 1.312 Vali Acc: 0.557 Test Loss: 1.312 Test Acc: 0.557
Validation loss decreased (-0.557239 --> -0.557239).  Saving model ...
Epoch: 8 cost time: 1.1771326065063477
Epoch: 8, Steps: 8 | Train Loss: 0.033 Vali Loss: 1.375 Vali Acc: 0.550 Test Loss: 1.375 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.171067714691162
Epoch: 9, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.554 Vali Acc: 0.527 Test Loss: 1.554 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.5284359455108643
Epoch: 10, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.773 Vali Acc: 0.573 Test Loss: 1.773 Test Acc: 0.573
Validation loss decreased (-0.557239 --> -0.572501).  Saving model ...
Epoch: 11 cost time: 1.5982322692871094
Epoch: 11, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.699 Vali Acc: 0.550 Test Loss: 1.699 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0111026763916016
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.702 Vali Acc: 0.504 Test Loss: 1.702 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.2213575839996338
Epoch: 13, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.698 Vali Acc: 0.542 Test Loss: 1.698 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.1493258476257324
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.747 Vali Acc: 0.550 Test Loss: 1.747 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.2975242137908936
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.784 Vali Acc: 0.550 Test Loss: 1.784 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.3396062850952148
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.800 Vali Acc: 0.550 Test Loss: 1.800 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.3359324932098389
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.802 Vali Acc: 0.542 Test Loss: 1.802 Test Acc: 0.542
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.2242121696472168
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.811 Vali Acc: 0.542 Test Loss: 1.811 Test Acc: 0.542
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.2012724876403809
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.818 Vali Acc: 0.550 Test Loss: 1.818 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.2357747554779053
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.821 Vali Acc: 0.550 Test Loss: 1.821 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps947_str474_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5725190839694656
model parameter : 49575941
model size : 203.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps947_str947_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.2089080810546875
Epoch: 1, Steps: 8 | Train Loss: 1.639 Vali Loss: 1.557 Vali Acc: 0.420 Test Loss: 1.557 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 0.9974114894866943
Epoch: 2, Steps: 8 | Train Loss: 1.424 Vali Loss: 1.586 Vali Acc: 0.420 Test Loss: 1.586 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.21018385887146
Epoch: 3, Steps: 8 | Train Loss: 1.181 Vali Loss: 1.501 Vali Acc: 0.489 Test Loss: 1.501 Test Acc: 0.489
Validation loss decreased (-0.419832 --> -0.488535).  Saving model ...
Epoch: 4 cost time: 1.3936035633087158
Epoch: 4, Steps: 8 | Train Loss: 0.884 Vali Loss: 1.474 Vali Acc: 0.489 Test Loss: 1.474 Test Acc: 0.489
Validation loss decreased (-0.488535 --> -0.488535).  Saving model ...
Epoch: 5 cost time: 0.953446626663208
Epoch: 5, Steps: 8 | Train Loss: 0.537 Vali Loss: 1.448 Vali Acc: 0.511 Test Loss: 1.448 Test Acc: 0.511
Validation loss decreased (-0.488535 --> -0.511436).  Saving model ...
Epoch: 6 cost time: 1.0929386615753174
Epoch: 6, Steps: 8 | Train Loss: 0.264 Vali Loss: 1.569 Vali Acc: 0.534 Test Loss: 1.569 Test Acc: 0.534
Validation loss decreased (-0.511436 --> -0.534335).  Saving model ...
Epoch: 7 cost time: 1.0426812171936035
Epoch: 7, Steps: 8 | Train Loss: 0.102 Vali Loss: 1.591 Vali Acc: 0.534 Test Loss: 1.591 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1513755321502686
Epoch: 8, Steps: 8 | Train Loss: 0.041 Vali Loss: 1.533 Vali Acc: 0.565 Test Loss: 1.533 Test Acc: 0.565
Validation loss decreased (-0.534335 --> -0.564870).  Saving model ...
Epoch: 9 cost time: 1.0043799877166748
Epoch: 9, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.682 Vali Acc: 0.557 Test Loss: 1.682 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.874596118927002
Epoch: 10, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.773 Vali Acc: 0.557 Test Loss: 1.773 Test Acc: 0.557
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9660189151763916
Epoch: 11, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.763 Vali Acc: 0.542 Test Loss: 1.763 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.8726439476013184
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.760 Vali Acc: 0.550 Test Loss: 1.760 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.0170905590057373
Epoch: 13, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.771 Vali Acc: 0.550 Test Loss: 1.771 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.159123182296753
Epoch: 14, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.773 Vali Acc: 0.542 Test Loss: 1.773 Test Acc: 0.542
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.813539981842041
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.796 Vali Acc: 0.550 Test Loss: 1.796 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.9216592311859131
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.822 Vali Acc: 0.550 Test Loss: 1.822 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.136291265487671
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.839 Vali Acc: 0.557 Test Loss: 1.839 Test Acc: 0.557
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.2955424785614014
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.855 Vali Acc: 0.557 Test Loss: 1.855 Test Acc: 0.557
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps947_str947_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5648854961832062
model parameter : 49479173
model size : 203.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps1000_str250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.63297963142395
Epoch: 1, Steps: 8 | Train Loss: 1.653 Vali Loss: 1.597 Vali Acc: 0.420 Test Loss: 1.597 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 1.1317815780639648
Epoch: 2, Steps: 8 | Train Loss: 1.395 Vali Loss: 1.544 Vali Acc: 0.427 Test Loss: 1.544 Test Acc: 0.427
Validation loss decreased (-0.419831 --> -0.427465).  Saving model ...
Epoch: 3 cost time: 1.1356017589569092
Epoch: 3, Steps: 8 | Train Loss: 1.100 Vali Loss: 1.433 Vali Acc: 0.504 Test Loss: 1.433 Test Acc: 0.504
Validation loss decreased (-0.427465 --> -0.503802).  Saving model ...
Epoch: 4 cost time: 0.8718857765197754
Epoch: 4, Steps: 8 | Train Loss: 0.763 Vali Loss: 1.478 Vali Acc: 0.519 Test Loss: 1.478 Test Acc: 0.519
Validation loss decreased (-0.503802 --> -0.519069).  Saving model ...
Epoch: 5 cost time: 1.0848290920257568
Epoch: 5, Steps: 8 | Train Loss: 0.322 Vali Loss: 1.583 Vali Acc: 0.489 Test Loss: 1.583 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.648038625717163
Epoch: 6, Steps: 8 | Train Loss: 0.133 Vali Loss: 1.807 Vali Acc: 0.504 Test Loss: 1.807 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.3156611919403076
Epoch: 7, Steps: 8 | Train Loss: 0.040 Vali Loss: 1.820 Vali Acc: 0.519 Test Loss: 1.820 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.2522757053375244
Epoch: 8, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.930 Vali Acc: 0.511 Test Loss: 1.930 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.5207438468933105
Epoch: 9, Steps: 8 | Train Loss: 0.005 Vali Loss: 2.021 Vali Acc: 0.542 Test Loss: 2.021 Test Acc: 0.542
Validation loss decreased (-0.519069 --> -0.541965).  Saving model ...
Epoch: 10 cost time: 1.1595561504364014
Epoch: 10, Steps: 8 | Train Loss: 0.003 Vali Loss: 2.181 Vali Acc: 0.534 Test Loss: 2.181 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5013675689697266
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.948 Vali Acc: 0.504 Test Loss: 1.948 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.6074001789093018
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.896 Vali Acc: 0.496 Test Loss: 1.896 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.3760037422180176
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.961 Vali Acc: 0.504 Test Loss: 1.961 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.4391522407531738
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.055 Vali Acc: 0.534 Test Loss: 2.055 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.3408575057983398
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.102 Vali Acc: 0.519 Test Loss: 2.102 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.3798325061798096
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.093 Vali Acc: 0.527 Test Loss: 2.093 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.442610740661621
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.076 Vali Acc: 0.527 Test Loss: 2.076 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.2919018268585205
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.072 Vali Acc: 0.527 Test Loss: 2.072 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.00687837600708
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.075 Vali Acc: 0.534 Test Loss: 2.075 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps1000_str250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 50480645
model size : 207.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps1000_str500_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.3352277278900146
Epoch: 1, Steps: 8 | Train Loss: 1.580 Vali Loss: 1.633 Vali Acc: 0.420 Test Loss: 1.633 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 1.1048295497894287
Epoch: 2, Steps: 8 | Train Loss: 1.357 Vali Loss: 1.518 Vali Acc: 0.420 Test Loss: 1.518 Test Acc: 0.420
Validation loss decreased (-0.419831 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 1.0940563678741455
Epoch: 3, Steps: 8 | Train Loss: 1.125 Vali Loss: 1.461 Vali Acc: 0.458 Test Loss: 1.461 Test Acc: 0.458
Validation loss decreased (-0.419832 --> -0.458001).  Saving model ...
Epoch: 4 cost time: 1.3722915649414062
Epoch: 4, Steps: 8 | Train Loss: 0.781 Vali Loss: 1.299 Vali Acc: 0.573 Test Loss: 1.299 Test Acc: 0.573
Validation loss decreased (-0.458001 --> -0.572506).  Saving model ...
Epoch: 5 cost time: 0.9657127857208252
Epoch: 5, Steps: 8 | Train Loss: 0.456 Vali Loss: 1.381 Vali Acc: 0.557 Test Loss: 1.381 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8260958194732666
Epoch: 6, Steps: 8 | Train Loss: 0.222 Vali Loss: 1.454 Vali Acc: 0.450 Test Loss: 1.454 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9577901363372803
Epoch: 7, Steps: 8 | Train Loss: 0.078 Vali Loss: 1.702 Vali Acc: 0.527 Test Loss: 1.702 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.1293962001800537
Epoch: 8, Steps: 8 | Train Loss: 0.034 Vali Loss: 1.572 Vali Acc: 0.450 Test Loss: 1.572 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.0524394512176514
Epoch: 9, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.786 Vali Acc: 0.527 Test Loss: 1.786 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.9676222801208496
Epoch: 10, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.815 Vali Acc: 0.588 Test Loss: 1.815 Test Acc: 0.588
Validation loss decreased (-0.572506 --> -0.587768).  Saving model ...
Epoch: 11 cost time: 1.0900356769561768
Epoch: 11, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.763 Vali Acc: 0.527 Test Loss: 1.763 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1785218715667725
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.803 Vali Acc: 0.557 Test Loss: 1.803 Test Acc: 0.557
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1174674034118652
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.853 Vali Acc: 0.550 Test Loss: 1.853 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.9863927364349365
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.894 Vali Acc: 0.542 Test Loss: 1.894 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.017667531967163
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.918 Vali Acc: 0.527 Test Loss: 1.918 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.2883529663085938
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.920 Vali Acc: 0.534 Test Loss: 1.920 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.1037516593933105
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.920 Vali Acc: 0.534 Test Loss: 1.920 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.0177292823791504
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.923 Vali Acc: 0.534 Test Loss: 1.923 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.9577007293701172
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.910 Vali Acc: 0.534 Test Loss: 1.910 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.1334447860717773
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.916 Vali Acc: 0.527 Test Loss: 1.916 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps1000_str500_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5877862595419847
model parameter : 50297861
model size : 206.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps1000_str1000_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.5285260677337646
Epoch: 1, Steps: 8 | Train Loss: 1.532 Vali Loss: 1.570 Vali Acc: 0.420 Test Loss: 1.570 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 1.3397793769836426
Epoch: 2, Steps: 8 | Train Loss: 1.365 Vali Loss: 1.518 Vali Acc: 0.427 Test Loss: 1.518 Test Acc: 0.427
Validation loss decreased (-0.419832 --> -0.427466).  Saving model ...
Epoch: 3 cost time: 0.8328423500061035
Epoch: 3, Steps: 8 | Train Loss: 1.081 Vali Loss: 1.527 Vali Acc: 0.420 Test Loss: 1.527 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.052414894104004
Epoch: 4, Steps: 8 | Train Loss: 0.780 Vali Loss: 1.446 Vali Acc: 0.496 Test Loss: 1.446 Test Acc: 0.496
Validation loss decreased (-0.427466 --> -0.496169).  Saving model ...
Epoch: 5 cost time: 1.2005481719970703
Epoch: 5, Steps: 8 | Train Loss: 0.508 Vali Loss: 1.424 Vali Acc: 0.489 Test Loss: 1.424 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0109879970550537
Epoch: 6, Steps: 8 | Train Loss: 0.289 Vali Loss: 1.448 Vali Acc: 0.489 Test Loss: 1.448 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9160621166229248
Epoch: 7, Steps: 8 | Train Loss: 0.116 Vali Loss: 1.463 Vali Acc: 0.504 Test Loss: 1.463 Test Acc: 0.504
Validation loss decreased (-0.496169 --> -0.503802).  Saving model ...
Epoch: 8 cost time: 1.0277516841888428
Epoch: 8, Steps: 8 | Train Loss: 0.052 Vali Loss: 1.532 Vali Acc: 0.473 Test Loss: 1.532 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.88606858253479
Epoch: 9, Steps: 8 | Train Loss: 0.022 Vali Loss: 1.688 Vali Acc: 0.473 Test Loss: 1.688 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.076124668121338
Epoch: 10, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.739 Vali Acc: 0.458 Test Loss: 1.739 Test Acc: 0.458
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.9724133014678955
Epoch: 11, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.725 Vali Acc: 0.466 Test Loss: 1.725 Test Acc: 0.466
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.226968765258789
Epoch: 12, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.800 Vali Acc: 0.496 Test Loss: 1.800 Test Acc: 0.496
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.1231837272644043
Epoch: 13, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.890 Vali Acc: 0.496 Test Loss: 1.890 Test Acc: 0.496
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.1033055782318115
Epoch: 14, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.920 Vali Acc: 0.504 Test Loss: 1.920 Test Acc: 0.504
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.0179414749145508
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.919 Vali Acc: 0.496 Test Loss: 1.919 Test Acc: 0.496
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.2150993347167969
Epoch: 16, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.846 Vali Acc: 0.496 Test Loss: 1.846 Test Acc: 0.496
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.8782708644866943
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.759 Vali Acc: 0.519 Test Loss: 1.759 Test Acc: 0.519
Validation loss decreased (-0.503802 --> -0.519066).  Saving model ...
Epoch: 18 cost time: 1.1142725944519043
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.777 Vali Acc: 0.496 Test Loss: 1.777 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1298060417175293
Epoch: 19, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.798 Vali Acc: 0.496 Test Loss: 1.798 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.1387732028961182
Epoch: 20, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.812 Vali Acc: 0.496 Test Loss: 1.812 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.0492281913757324
Epoch: 21, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.825 Vali Acc: 0.489 Test Loss: 1.825 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.9825193881988525
Epoch: 22, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.842 Vali Acc: 0.481 Test Loss: 1.842 Test Acc: 0.481
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.8964803218841553
Epoch: 23, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.849 Vali Acc: 0.489 Test Loss: 1.849 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.8189444541931152
Epoch: 24, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.858 Vali Acc: 0.489 Test Loss: 1.858 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.1400415897369385
Epoch: 25, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.873 Vali Acc: 0.473 Test Loss: 1.873 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.2493679523468018
Epoch: 26, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.887 Vali Acc: 0.473 Test Loss: 1.887 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.244215726852417
Epoch: 27, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.896 Vali Acc: 0.481 Test Loss: 1.896 Test Acc: 0.481
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps1000_str1000_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 50206469
model size : 206.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps1058_str265_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.066105604171753
Epoch: 1, Steps: 8 | Train Loss: 1.668 Vali Loss: 1.598 Vali Acc: 0.420 Test Loss: 1.598 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 0.9560353755950928
Epoch: 2, Steps: 8 | Train Loss: 1.462 Vali Loss: 1.535 Vali Acc: 0.458 Test Loss: 1.535 Test Acc: 0.458
Validation loss decreased (-0.419831 --> -0.458000).  Saving model ...
Epoch: 3 cost time: 1.2864243984222412
Epoch: 3, Steps: 8 | Train Loss: 1.139 Vali Loss: 1.500 Vali Acc: 0.427 Test Loss: 1.500 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3013315200805664
Epoch: 4, Steps: 8 | Train Loss: 0.770 Vali Loss: 1.423 Vali Acc: 0.481 Test Loss: 1.423 Test Acc: 0.481
Validation loss decreased (-0.458000 --> -0.480902).  Saving model ...
Epoch: 5 cost time: 1.876668930053711
Epoch: 5, Steps: 8 | Train Loss: 0.441 Vali Loss: 1.478 Vali Acc: 0.557 Test Loss: 1.478 Test Acc: 0.557
Validation loss decreased (-0.480902 --> -0.557237).  Saving model ...
Epoch: 6 cost time: 1.0690054893493652
Epoch: 6, Steps: 8 | Train Loss: 0.158 Vali Loss: 1.528 Vali Acc: 0.511 Test Loss: 1.528 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7119622230529785
Epoch: 7, Steps: 8 | Train Loss: 0.039 Vali Loss: 1.994 Vali Acc: 0.443 Test Loss: 1.994 Test Acc: 0.443
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.4365758895874023
Epoch: 8, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.696 Vali Acc: 0.542 Test Loss: 1.696 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.1416940689086914
Epoch: 9, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.880 Vali Acc: 0.489 Test Loss: 1.880 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.9230632781982422
Epoch: 10, Steps: 8 | Train Loss: 0.003 Vali Loss: 2.207 Vali Acc: 0.511 Test Loss: 2.207 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.030353307723999
Epoch: 11, Steps: 8 | Train Loss: 0.002 Vali Loss: 2.370 Vali Acc: 0.519 Test Loss: 2.370 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.9251477718353271
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.368 Vali Acc: 0.504 Test Loss: 2.368 Test Acc: 0.504
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.75380539894104
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.393 Vali Acc: 0.527 Test Loss: 2.393 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.6470887660980225
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.335 Vali Acc: 0.527 Test Loss: 2.335 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.3298768997192383
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.322 Vali Acc: 0.542 Test Loss: 2.322 Test Acc: 0.542
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps1058_str265_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 51260933
model size : 210.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps1058_str529_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.734926700592041
Epoch: 1, Steps: 8 | Train Loss: 1.575 Vali Loss: 1.683 Vali Acc: 0.420 Test Loss: 1.683 Test Acc: 0.420
Validation loss decreased (inf --> -0.419830).  Saving model ...
Epoch: 2 cost time: 1.2781357765197754
Epoch: 2, Steps: 8 | Train Loss: 1.373 Vali Loss: 1.484 Vali Acc: 0.473 Test Loss: 1.484 Test Acc: 0.473
Validation loss decreased (-0.419830 --> -0.473268).  Saving model ...
Epoch: 3 cost time: 1.1782267093658447
Epoch: 3, Steps: 8 | Train Loss: 1.103 Vali Loss: 1.399 Vali Acc: 0.496 Test Loss: 1.399 Test Acc: 0.496
Validation loss decreased (-0.473268 --> -0.496169).  Saving model ...
Epoch: 4 cost time: 1.2852511405944824
Epoch: 4, Steps: 8 | Train Loss: 0.767 Vali Loss: 1.266 Vali Acc: 0.519 Test Loss: 1.266 Test Acc: 0.519
Validation loss decreased (-0.496169 --> -0.519071).  Saving model ...
Epoch: 5 cost time: 1.1207184791564941
Epoch: 5, Steps: 8 | Train Loss: 0.391 Vali Loss: 1.316 Vali Acc: 0.481 Test Loss: 1.316 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0534191131591797
Epoch: 6, Steps: 8 | Train Loss: 0.185 Vali Loss: 1.508 Vali Acc: 0.496 Test Loss: 1.508 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.3315858840942383
Epoch: 7, Steps: 8 | Train Loss: 0.064 Vali Loss: 1.384 Vali Acc: 0.519 Test Loss: 1.384 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.1529242992401123
Epoch: 8, Steps: 8 | Train Loss: 0.021 Vali Loss: 1.421 Vali Acc: 0.557 Test Loss: 1.421 Test Acc: 0.557
Validation loss decreased (-0.519071 --> -0.557238).  Saving model ...
Epoch: 9 cost time: 1.103318452835083
Epoch: 9, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.624 Vali Acc: 0.534 Test Loss: 1.624 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2307922840118408
Epoch: 10, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.476 Vali Acc: 0.542 Test Loss: 1.476 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9336559772491455
Epoch: 11, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.471 Vali Acc: 0.557 Test Loss: 1.471 Test Acc: 0.557
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.1822128295898438
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.529 Vali Acc: 0.550 Test Loss: 1.529 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.1789402961730957
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.586 Vali Acc: 0.542 Test Loss: 1.586 Test Acc: 0.542
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.213155746459961
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.628 Vali Acc: 0.534 Test Loss: 1.628 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.3393974304199219
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.641 Vali Acc: 0.527 Test Loss: 1.641 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.203016996383667
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.639 Vali Acc: 0.534 Test Loss: 1.639 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.2780263423919678
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.634 Vali Acc: 0.550 Test Loss: 1.634 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.2507553100585938
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.628 Vali Acc: 0.550 Test Loss: 1.628 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps1058_str529_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 51088901
model size : 209.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps1058_str1058_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.717942237854004
Epoch: 1, Steps: 8 | Train Loss: 1.580 Vali Loss: 1.544 Vali Acc: 0.420 Test Loss: 1.544 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 1.0487549304962158
Epoch: 2, Steps: 8 | Train Loss: 1.386 Vali Loss: 1.519 Vali Acc: 0.443 Test Loss: 1.519 Test Acc: 0.443
Validation loss decreased (-0.419832 --> -0.442733).  Saving model ...
Epoch: 3 cost time: 1.008457899093628
Epoch: 3, Steps: 8 | Train Loss: 1.104 Vali Loss: 1.481 Vali Acc: 0.458 Test Loss: 1.481 Test Acc: 0.458
Validation loss decreased (-0.442733 --> -0.458000).  Saving model ...
Epoch: 4 cost time: 1.4135849475860596
Epoch: 4, Steps: 8 | Train Loss: 0.827 Vali Loss: 1.531 Vali Acc: 0.481 Test Loss: 1.531 Test Acc: 0.481
Validation loss decreased (-0.458000 --> -0.480901).  Saving model ...
Epoch: 5 cost time: 0.8423240184783936
Epoch: 5, Steps: 8 | Train Loss: 0.507 Vali Loss: 1.472 Vali Acc: 0.511 Test Loss: 1.472 Test Acc: 0.511
Validation loss decreased (-0.480901 --> -0.511436).  Saving model ...
Epoch: 6 cost time: 1.3030109405517578
Epoch: 6, Steps: 8 | Train Loss: 0.267 Vali Loss: 1.443 Vali Acc: 0.504 Test Loss: 1.443 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9056739807128906
Epoch: 7, Steps: 8 | Train Loss: 0.103 Vali Loss: 1.611 Vali Acc: 0.511 Test Loss: 1.611 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.0416738986968994
Epoch: 8, Steps: 8 | Train Loss: 0.035 Vali Loss: 1.490 Vali Acc: 0.504 Test Loss: 1.490 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.121779441833496
Epoch: 9, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.596 Vali Acc: 0.542 Test Loss: 1.596 Test Acc: 0.542
Validation loss decreased (-0.511436 --> -0.541969).  Saving model ...
Epoch: 10 cost time: 1.184269905090332
Epoch: 10, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.686 Vali Acc: 0.550 Test Loss: 1.686 Test Acc: 0.550
Validation loss decreased (-0.541969 --> -0.549601).  Saving model ...
Epoch: 11 cost time: 1.0914528369903564
Epoch: 11, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.743 Vali Acc: 0.519 Test Loss: 1.743 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.070882797241211
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.782 Vali Acc: 0.527 Test Loss: 1.782 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.0192930698394775
Epoch: 13, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.803 Vali Acc: 0.527 Test Loss: 1.803 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.1889269351959229
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.821 Vali Acc: 0.527 Test Loss: 1.821 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.1303339004516602
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.830 Vali Acc: 0.527 Test Loss: 1.830 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.0370025634765625
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.846 Vali Acc: 0.519 Test Loss: 1.846 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.023482084274292
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.862 Vali Acc: 0.519 Test Loss: 1.862 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.9900107383728027
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.874 Vali Acc: 0.519 Test Loss: 1.874 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.8933873176574707
Epoch: 19, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.886 Vali Acc: 0.519 Test Loss: 1.886 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.1064426898956299
Epoch: 20, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.891 Vali Acc: 0.519 Test Loss: 1.891 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps1058_str1058_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 51002885
model size : 209.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps1124_str281_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.2276291847229004
Epoch: 1, Steps: 8 | Train Loss: 1.613 Vali Loss: 1.576 Vali Acc: 0.420 Test Loss: 1.576 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 1.1638267040252686
Epoch: 2, Steps: 8 | Train Loss: 1.358 Vali Loss: 1.554 Vali Acc: 0.412 Test Loss: 1.554 Test Acc: 0.412
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.497403621673584
Epoch: 3, Steps: 8 | Train Loss: 1.128 Vali Loss: 1.422 Vali Acc: 0.481 Test Loss: 1.422 Test Acc: 0.481
Validation loss decreased (-0.419832 --> -0.480902).  Saving model ...
Epoch: 4 cost time: 1.7404909133911133
Epoch: 4, Steps: 8 | Train Loss: 0.798 Vali Loss: 1.306 Vali Acc: 0.550 Test Loss: 1.306 Test Acc: 0.550
Validation loss decreased (-0.480902 --> -0.549605).  Saving model ...
Epoch: 5 cost time: 2.1971514225006104
Epoch: 5, Steps: 8 | Train Loss: 0.376 Vali Loss: 1.241 Vali Acc: 0.496 Test Loss: 1.241 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.9372522830963135
Epoch: 6, Steps: 8 | Train Loss: 0.111 Vali Loss: 1.357 Vali Acc: 0.466 Test Loss: 1.357 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.8441455364227295
Epoch: 7, Steps: 8 | Train Loss: 0.045 Vali Loss: 1.411 Vali Acc: 0.534 Test Loss: 1.411 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.4609873294830322
Epoch: 8, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.707 Vali Acc: 0.550 Test Loss: 1.707 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.5348842144012451
Epoch: 9, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.595 Vali Acc: 0.550 Test Loss: 1.595 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.4044644832611084
Epoch: 10, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.554 Vali Acc: 0.550 Test Loss: 1.554 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.4386422634124756
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.617 Vali Acc: 0.588 Test Loss: 1.617 Test Acc: 0.588
Validation loss decreased (-0.549605 --> -0.587770).  Saving model ...
Epoch: 12 cost time: 1.470745325088501
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.678 Vali Acc: 0.565 Test Loss: 1.678 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.041436195373535
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.686 Vali Acc: 0.573 Test Loss: 1.686 Test Acc: 0.573
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.469660758972168
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.676 Vali Acc: 0.573 Test Loss: 1.676 Test Acc: 0.573
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.0197086334228516
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.682 Vali Acc: 0.565 Test Loss: 1.682 Test Acc: 0.565
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.396932601928711
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.700 Vali Acc: 0.565 Test Loss: 1.700 Test Acc: 0.565
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.4656200408935547
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.730 Vali Acc: 0.557 Test Loss: 1.730 Test Acc: 0.557
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.3773682117462158
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.762 Vali Acc: 0.557 Test Loss: 1.762 Test Acc: 0.557
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.2686131000518799
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.776 Vali Acc: 0.557 Test Loss: 1.776 Test Acc: 0.557
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.4059076309204102
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.784 Vali Acc: 0.557 Test Loss: 1.784 Test Acc: 0.557
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.3456940650939941
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.787 Vali Acc: 0.557 Test Loss: 1.787 Test Acc: 0.557
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps1124_str281_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5877862595419847
model parameter : 52157189
model size : 213.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps1124_str562_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.7292909622192383
Epoch: 1, Steps: 8 | Train Loss: 1.530 Vali Loss: 1.621 Vali Acc: 0.420 Test Loss: 1.621 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 1.1340315341949463
Epoch: 2, Steps: 8 | Train Loss: 1.341 Vali Loss: 1.538 Vali Acc: 0.435 Test Loss: 1.538 Test Acc: 0.435
Validation loss decreased (-0.419831 --> -0.435099).  Saving model ...
Epoch: 3 cost time: 1.223313570022583
Epoch: 3, Steps: 8 | Train Loss: 1.073 Vali Loss: 1.485 Vali Acc: 0.473 Test Loss: 1.485 Test Acc: 0.473
Validation loss decreased (-0.435099 --> -0.473268).  Saving model ...
Epoch: 4 cost time: 1.3523154258728027
Epoch: 4, Steps: 8 | Train Loss: 0.722 Vali Loss: 1.463 Vali Acc: 0.473 Test Loss: 1.463 Test Acc: 0.473
Validation loss decreased (-0.473268 --> -0.473268).  Saving model ...
Epoch: 5 cost time: 0.9120602607727051
Epoch: 5, Steps: 8 | Train Loss: 0.403 Vali Loss: 1.458 Vali Acc: 0.473 Test Loss: 1.458 Test Acc: 0.473
Validation loss decreased (-0.473268 --> -0.473268).  Saving model ...
Epoch: 6 cost time: 1.6198186874389648
Epoch: 6, Steps: 8 | Train Loss: 0.163 Vali Loss: 1.452 Vali Acc: 0.496 Test Loss: 1.452 Test Acc: 0.496
Validation loss decreased (-0.473268 --> -0.496169).  Saving model ...
Epoch: 7 cost time: 1.136138677597046
Epoch: 7, Steps: 8 | Train Loss: 0.060 Vali Loss: 1.603 Vali Acc: 0.489 Test Loss: 1.603 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.096787929534912
Epoch: 8, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.691 Vali Acc: 0.458 Test Loss: 1.691 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.5331804752349854
Epoch: 9, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.732 Vali Acc: 0.534 Test Loss: 1.732 Test Acc: 0.534
Validation loss decreased (-0.496169 --> -0.534334).  Saving model ...
Epoch: 10 cost time: 1.1296534538269043
Epoch: 10, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.739 Vali Acc: 0.504 Test Loss: 1.739 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0359594821929932
Epoch: 11, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.737 Vali Acc: 0.473 Test Loss: 1.737 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.4260432720184326
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.741 Vali Acc: 0.496 Test Loss: 1.741 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.3088862895965576
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.754 Vali Acc: 0.519 Test Loss: 1.754 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.464460849761963
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.766 Vali Acc: 0.527 Test Loss: 1.766 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.1031169891357422
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.776 Vali Acc: 0.534 Test Loss: 1.776 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.2783095836639404
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.785 Vali Acc: 0.527 Test Loss: 1.785 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.0859880447387695
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.799 Vali Acc: 0.527 Test Loss: 1.799 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.519906759262085
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.808 Vali Acc: 0.534 Test Loss: 1.808 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.3417918682098389
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.812 Vali Acc: 0.542 Test Loss: 1.812 Test Acc: 0.542
Validation loss decreased (-0.534334 --> -0.541967).  Saving model ...
Epoch: 20 cost time: 1.2450735569000244
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.807 Vali Acc: 0.542 Test Loss: 1.807 Test Acc: 0.542
Validation loss decreased (-0.541967 --> -0.541967).  Saving model ...
Epoch: 21 cost time: 1.3031878471374512
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.805 Vali Acc: 0.542 Test Loss: 1.805 Test Acc: 0.542
Validation loss decreased (-0.541967 --> -0.541967).  Saving model ...
Epoch: 22 cost time: 1.1861522197723389
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.806 Vali Acc: 0.511 Test Loss: 1.806 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.1983873844146729
Epoch: 23, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.816 Vali Acc: 0.511 Test Loss: 1.816 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.161200761795044
Epoch: 24, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.824 Vali Acc: 0.511 Test Loss: 1.824 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.0310235023498535
Epoch: 25, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.828 Vali Acc: 0.511 Test Loss: 1.828 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.380506992340088
Epoch: 26, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.839 Vali Acc: 0.519 Test Loss: 1.839 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.1058831214904785
Epoch: 27, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.858 Vali Acc: 0.527 Test Loss: 1.858 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.1449847221374512
Epoch: 28, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.871 Vali Acc: 0.527 Test Loss: 1.871 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.2652289867401123
Epoch: 29, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.882 Vali Acc: 0.534 Test Loss: 1.882 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.1248412132263184
Epoch: 30, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.890 Vali Acc: 0.534 Test Loss: 1.890 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.0910422801971436
Epoch: 31, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.896 Vali Acc: 0.534 Test Loss: 1.896 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps1124_str562_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 51995909
model size : 213.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps1124_str1124_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.3917813301086426
Epoch: 1, Steps: 8 | Train Loss: 1.519 Vali Loss: 1.592 Vali Acc: 0.420 Test Loss: 1.592 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 1.2593884468078613
Epoch: 2, Steps: 8 | Train Loss: 1.365 Vali Loss: 1.520 Vali Acc: 0.420 Test Loss: 1.520 Test Acc: 0.420
Validation loss decreased (-0.419831 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 0.9777305126190186
Epoch: 3, Steps: 8 | Train Loss: 1.134 Vali Loss: 1.477 Vali Acc: 0.496 Test Loss: 1.477 Test Acc: 0.496
Validation loss decreased (-0.419832 --> -0.496168).  Saving model ...
Epoch: 4 cost time: 1.152592420578003
Epoch: 4, Steps: 8 | Train Loss: 0.787 Vali Loss: 1.396 Vali Acc: 0.504 Test Loss: 1.396 Test Acc: 0.504
Validation loss decreased (-0.496168 --> -0.503803).  Saving model ...
Epoch: 5 cost time: 1.1792032718658447
Epoch: 5, Steps: 8 | Train Loss: 0.462 Vali Loss: 1.423 Vali Acc: 0.450 Test Loss: 1.423 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1167399883270264
Epoch: 6, Steps: 8 | Train Loss: 0.239 Vali Loss: 1.537 Vali Acc: 0.481 Test Loss: 1.537 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.0534515380859375
Epoch: 7, Steps: 8 | Train Loss: 0.121 Vali Loss: 1.539 Vali Acc: 0.534 Test Loss: 1.539 Test Acc: 0.534
Validation loss decreased (-0.503803 --> -0.534336).  Saving model ...
Epoch: 8 cost time: 1.0204074382781982
Epoch: 8, Steps: 8 | Train Loss: 0.051 Vali Loss: 1.610 Vali Acc: 0.504 Test Loss: 1.610 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.403412103652954
Epoch: 9, Steps: 8 | Train Loss: 0.019 Vali Loss: 1.836 Vali Acc: 0.481 Test Loss: 1.836 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.3264110088348389
Epoch: 10, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.968 Vali Acc: 0.473 Test Loss: 1.968 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.8324625492095947
Epoch: 11, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.933 Vali Acc: 0.489 Test Loss: 1.933 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.5249755382537842
Epoch: 12, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.917 Vali Acc: 0.496 Test Loss: 1.917 Test Acc: 0.496
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.7629282474517822
Epoch: 13, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.937 Vali Acc: 0.496 Test Loss: 1.937 Test Acc: 0.496
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.598768949508667
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.955 Vali Acc: 0.504 Test Loss: 1.955 Test Acc: 0.504
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.4001762866973877
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.961 Vali Acc: 0.504 Test Loss: 1.961 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.5105583667755127
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.969 Vali Acc: 0.504 Test Loss: 1.969 Test Acc: 0.504
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.9736819267272949
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.982 Vali Acc: 0.504 Test Loss: 1.982 Test Acc: 0.504
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps1124_str1124_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 51915269
model size : 212.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps1199_str300_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.22037672996521
Epoch: 1, Steps: 8 | Train Loss: 1.547 Vali Loss: 1.587 Vali Acc: 0.420 Test Loss: 1.587 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 1.2359299659729004
Epoch: 2, Steps: 8 | Train Loss: 1.366 Vali Loss: 1.425 Vali Acc: 0.427 Test Loss: 1.425 Test Acc: 0.427
Validation loss decreased (-0.419831 --> -0.427467).  Saving model ...
Epoch: 3 cost time: 1.1667191982269287
Epoch: 3, Steps: 8 | Train Loss: 0.995 Vali Loss: 1.474 Vali Acc: 0.435 Test Loss: 1.474 Test Acc: 0.435
Validation loss decreased (-0.427467 --> -0.435100).  Saving model ...
Epoch: 4 cost time: 1.1809990406036377
Epoch: 4, Steps: 8 | Train Loss: 0.613 Vali Loss: 1.370 Vali Acc: 0.458 Test Loss: 1.370 Test Acc: 0.458
Validation loss decreased (-0.435100 --> -0.458002).  Saving model ...
Epoch: 5 cost time: 0.9836251735687256
Epoch: 5, Steps: 8 | Train Loss: 0.229 Vali Loss: 1.350 Vali Acc: 0.511 Test Loss: 1.350 Test Acc: 0.511
Validation loss decreased (-0.458002 --> -0.511437).  Saving model ...
Epoch: 6 cost time: 1.1769828796386719
Epoch: 6, Steps: 8 | Train Loss: 0.065 Vali Loss: 1.462 Vali Acc: 0.519 Test Loss: 1.462 Test Acc: 0.519
Validation loss decreased (-0.511437 --> -0.519069).  Saving model ...
Epoch: 7 cost time: 1.090731143951416
Epoch: 7, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.512 Vali Acc: 0.519 Test Loss: 1.512 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9068014621734619
Epoch: 8, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.560 Vali Acc: 0.527 Test Loss: 1.560 Test Acc: 0.527
Validation loss decreased (-0.519069 --> -0.526702).  Saving model ...
Epoch: 9 cost time: 1.2327868938446045
Epoch: 9, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.673 Vali Acc: 0.542 Test Loss: 1.673 Test Acc: 0.542
Validation loss decreased (-0.526702 --> -0.541968).  Saving model ...
Epoch: 10 cost time: 1.1084048748016357
Epoch: 10, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.745 Vali Acc: 0.550 Test Loss: 1.745 Test Acc: 0.550
Validation loss decreased (-0.541968 --> -0.549601).  Saving model ...
Epoch: 11 cost time: 1.3890879154205322
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.766 Vali Acc: 0.534 Test Loss: 1.766 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3166329860687256
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.781 Vali Acc: 0.519 Test Loss: 1.781 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.247290849685669
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.783 Vali Acc: 0.519 Test Loss: 1.783 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.3193931579589844
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.786 Vali Acc: 0.519 Test Loss: 1.786 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.1805438995361328
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.791 Vali Acc: 0.550 Test Loss: 1.791 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.9928419589996338
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.795 Vali Acc: 0.550 Test Loss: 1.795 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.1084167957305908
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.795 Vali Acc: 0.557 Test Loss: 1.795 Test Acc: 0.557
Validation loss decreased (-0.549601 --> -0.557234).  Saving model ...
Epoch: 18 cost time: 1.2037179470062256
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.801 Vali Acc: 0.557 Test Loss: 1.801 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1525092124938965
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.801 Vali Acc: 0.557 Test Loss: 1.801 Test Acc: 0.557
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.915001630783081
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.806 Vali Acc: 0.557 Test Loss: 1.806 Test Acc: 0.557
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.8807468414306641
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.812 Vali Acc: 0.557 Test Loss: 1.812 Test Acc: 0.557
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.1992378234863281
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.819 Vali Acc: 0.550 Test Loss: 1.819 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.2994904518127441
Epoch: 23, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.827 Vali Acc: 0.550 Test Loss: 1.827 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.5854058265686035
Epoch: 24, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.839 Vali Acc: 0.542 Test Loss: 1.839 Test Acc: 0.542
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.1917624473571777
Epoch: 25, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.845 Vali Acc: 0.550 Test Loss: 1.845 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.191742181777954
Epoch: 26, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.850 Vali Acc: 0.557 Test Loss: 1.850 Test Acc: 0.557
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.4229285717010498
Epoch: 27, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.855 Vali Acc: 0.550 Test Loss: 1.855 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps1199_str300_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 53167109
model size : 217.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps1199_str600_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.5726356506347656
Epoch: 1, Steps: 8 | Train Loss: 1.552 Vali Loss: 1.600 Vali Acc: 0.420 Test Loss: 1.600 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 0.9866187572479248
Epoch: 2, Steps: 8 | Train Loss: 1.357 Vali Loss: 1.565 Vali Acc: 0.504 Test Loss: 1.565 Test Acc: 0.504
Validation loss decreased (-0.419831 --> -0.503801).  Saving model ...
Epoch: 3 cost time: 1.3309483528137207
Epoch: 3, Steps: 8 | Train Loss: 1.060 Vali Loss: 1.453 Vali Acc: 0.504 Test Loss: 1.453 Test Acc: 0.504
Validation loss decreased (-0.503801 --> -0.503802).  Saving model ...
Epoch: 4 cost time: 1.551257610321045
Epoch: 4, Steps: 8 | Train Loss: 0.725 Vali Loss: 1.473 Vali Acc: 0.473 Test Loss: 1.473 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0712666511535645
Epoch: 5, Steps: 8 | Train Loss: 0.361 Vali Loss: 1.470 Vali Acc: 0.389 Test Loss: 1.470 Test Acc: 0.389
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1696553230285645
Epoch: 6, Steps: 8 | Train Loss: 0.139 Vali Loss: 1.493 Vali Acc: 0.466 Test Loss: 1.493 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.3520848751068115
Epoch: 7, Steps: 8 | Train Loss: 0.038 Vali Loss: 1.597 Vali Acc: 0.458 Test Loss: 1.597 Test Acc: 0.458
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.204279899597168
Epoch: 8, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.602 Vali Acc: 0.504 Test Loss: 1.602 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.3876113891601562
Epoch: 9, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.620 Vali Acc: 0.504 Test Loss: 1.620 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.1987106800079346
Epoch: 10, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.674 Vali Acc: 0.504 Test Loss: 1.674 Test Acc: 0.504
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.9148497581481934
Epoch: 11, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.721 Vali Acc: 0.504 Test Loss: 1.721 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.1506457328796387
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.751 Vali Acc: 0.511 Test Loss: 1.751 Test Acc: 0.511
Validation loss decreased (-0.503802 --> -0.511433).  Saving model ...
Epoch: 13 cost time: 1.3362321853637695
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.783 Vali Acc: 0.504 Test Loss: 1.783 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2581923007965088
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.816 Vali Acc: 0.519 Test Loss: 1.816 Test Acc: 0.519
Validation loss decreased (-0.511433 --> -0.519066).  Saving model ...
Epoch: 15 cost time: 1.9648232460021973
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.840 Vali Acc: 0.511 Test Loss: 1.840 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.3068814277648926
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.850 Vali Acc: 0.511 Test Loss: 1.850 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.3136100769042969
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.845 Vali Acc: 0.511 Test Loss: 1.845 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.232271432876587
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.846 Vali Acc: 0.511 Test Loss: 1.846 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.2975988388061523
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.846 Vali Acc: 0.511 Test Loss: 1.846 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.764700174331665
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.852 Vali Acc: 0.519 Test Loss: 1.852 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.4256927967071533
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.859 Vali Acc: 0.527 Test Loss: 1.859 Test Acc: 0.527
Validation loss decreased (-0.519066 --> -0.526699).  Saving model ...
Epoch: 22 cost time: 1.4503450393676758
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.867 Vali Acc: 0.534 Test Loss: 1.867 Test Acc: 0.534
Validation loss decreased (-0.526699 --> -0.534332).  Saving model ...
Epoch: 23 cost time: 1.0935008525848389
Epoch: 23, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.868 Vali Acc: 0.534 Test Loss: 1.868 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.2234163284301758
Epoch: 24, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.878 Vali Acc: 0.542 Test Loss: 1.878 Test Acc: 0.542
Validation loss decreased (-0.534332 --> -0.541966).  Saving model ...
Epoch: 25 cost time: 1.3359031677246094
Epoch: 25, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.883 Vali Acc: 0.542 Test Loss: 1.883 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.2881078720092773
Epoch: 26, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.895 Vali Acc: 0.534 Test Loss: 1.895 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.4189836978912354
Epoch: 27, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.903 Vali Acc: 0.534 Test Loss: 1.903 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.3942492008209229
Epoch: 28, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.904 Vali Acc: 0.534 Test Loss: 1.904 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.6483218669891357
Epoch: 29, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.909 Vali Acc: 0.534 Test Loss: 1.909 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.5745363235473633
Epoch: 30, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.910 Vali Acc: 0.542 Test Loss: 1.910 Test Acc: 0.542
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.571474552154541
Epoch: 31, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.906 Vali Acc: 0.534 Test Loss: 1.906 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.2759535312652588
Epoch: 32, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.907 Vali Acc: 0.519 Test Loss: 1.907 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.0887689590454102
Epoch: 33, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.909 Vali Acc: 0.519 Test Loss: 1.909 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.2174720764160156
Epoch: 34, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.908 Vali Acc: 0.511 Test Loss: 1.908 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps1199_str600_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 53016581
model size : 216.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps1199_str1199_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.7581074237823486
Epoch: 1, Steps: 8 | Train Loss: 1.544 Vali Loss: 1.550 Vali Acc: 0.420 Test Loss: 1.550 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 0.9762094020843506
Epoch: 2, Steps: 8 | Train Loss: 1.338 Vali Loss: 1.498 Vali Acc: 0.427 Test Loss: 1.498 Test Acc: 0.427
Validation loss decreased (-0.419832 --> -0.427466).  Saving model ...
Epoch: 3 cost time: 0.9073889255523682
Epoch: 3, Steps: 8 | Train Loss: 1.049 Vali Loss: 1.422 Vali Acc: 0.504 Test Loss: 1.422 Test Acc: 0.504
Validation loss decreased (-0.427466 --> -0.503803).  Saving model ...
Epoch: 4 cost time: 1.1579248905181885
Epoch: 4, Steps: 8 | Train Loss: 0.760 Vali Loss: 1.330 Vali Acc: 0.473 Test Loss: 1.330 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1067748069763184
Epoch: 5, Steps: 8 | Train Loss: 0.450 Vali Loss: 1.348 Vali Acc: 0.481 Test Loss: 1.348 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1419575214385986
Epoch: 6, Steps: 8 | Train Loss: 0.199 Vali Loss: 1.297 Vali Acc: 0.504 Test Loss: 1.297 Test Acc: 0.504
Validation loss decreased (-0.503803 --> -0.503804).  Saving model ...
Epoch: 7 cost time: 1.0206851959228516
Epoch: 7, Steps: 8 | Train Loss: 0.068 Vali Loss: 1.450 Vali Acc: 0.519 Test Loss: 1.450 Test Acc: 0.519
Validation loss decreased (-0.503804 --> -0.519069).  Saving model ...
Epoch: 8 cost time: 1.2576282024383545
Epoch: 8, Steps: 8 | Train Loss: 0.027 Vali Loss: 1.534 Vali Acc: 0.504 Test Loss: 1.534 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3619718551635742
Epoch: 9, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.503 Vali Acc: 0.511 Test Loss: 1.503 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.3660261631011963
Epoch: 10, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.569 Vali Acc: 0.519 Test Loss: 1.569 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.2095746994018555
Epoch: 11, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.617 Vali Acc: 0.511 Test Loss: 1.617 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.1330394744873047
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.642 Vali Acc: 0.519 Test Loss: 1.642 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.1002206802368164
Epoch: 13, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.670 Vali Acc: 0.511 Test Loss: 1.670 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.0527682304382324
Epoch: 14, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.687 Vali Acc: 0.511 Test Loss: 1.687 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.9919137954711914
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.711 Vali Acc: 0.511 Test Loss: 1.711 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.012575626373291
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.749 Vali Acc: 0.519 Test Loss: 1.749 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.1755342483520508
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.772 Vali Acc: 0.519 Test Loss: 1.772 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps1199_str1199_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 52941317
model size : 216.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps1285_str322_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.9069888591766357
Epoch: 1, Steps: 8 | Train Loss: 1.516 Vali Loss: 1.574 Vali Acc: 0.420 Test Loss: 1.574 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 1.1065309047698975
Epoch: 2, Steps: 8 | Train Loss: 1.313 Vali Loss: 1.464 Vali Acc: 0.420 Test Loss: 1.464 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419833).  Saving model ...
Epoch: 3 cost time: 1.3691256046295166
Epoch: 3, Steps: 8 | Train Loss: 0.990 Vali Loss: 1.403 Vali Acc: 0.443 Test Loss: 1.403 Test Acc: 0.443
Validation loss decreased (-0.419833 --> -0.442734).  Saving model ...
Epoch: 4 cost time: 1.128354549407959
Epoch: 4, Steps: 8 | Train Loss: 0.635 Vali Loss: 1.394 Vali Acc: 0.481 Test Loss: 1.394 Test Acc: 0.481
Validation loss decreased (-0.442734 --> -0.480902).  Saving model ...
Epoch: 5 cost time: 1.3317453861236572
Epoch: 5, Steps: 8 | Train Loss: 0.336 Vali Loss: 1.386 Vali Acc: 0.504 Test Loss: 1.386 Test Acc: 0.504
Validation loss decreased (-0.480902 --> -0.503803).  Saving model ...
Epoch: 6 cost time: 0.9166402816772461
Epoch: 6, Steps: 8 | Train Loss: 0.168 Vali Loss: 1.502 Vali Acc: 0.565 Test Loss: 1.502 Test Acc: 0.565
Validation loss decreased (-0.503803 --> -0.564870).  Saving model ...
Epoch: 7 cost time: 1.2502467632293701
Epoch: 7, Steps: 8 | Train Loss: 0.061 Vali Loss: 1.505 Vali Acc: 0.466 Test Loss: 1.505 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7044651508331299
Epoch: 8, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.663 Vali Acc: 0.542 Test Loss: 1.663 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.2995011806488037
Epoch: 9, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.620 Vali Acc: 0.527 Test Loss: 1.620 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.3213963508605957
Epoch: 10, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.674 Vali Acc: 0.511 Test Loss: 1.674 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.1106901168823242
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.773 Vali Acc: 0.504 Test Loss: 1.773 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.6246931552886963
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.856 Vali Acc: 0.504 Test Loss: 1.856 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.264960765838623
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.895 Vali Acc: 0.511 Test Loss: 1.895 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.2887639999389648
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.905 Vali Acc: 0.519 Test Loss: 1.905 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.7649061679840088
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.897 Vali Acc: 0.527 Test Loss: 1.897 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.5518772602081299
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.873 Vali Acc: 0.527 Test Loss: 1.873 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps1285_str322_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5648854961832062
model parameter : 54334469
model size : 221.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps1285_str643_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.020376682281494
Epoch: 1, Steps: 8 | Train Loss: 1.530 Vali Loss: 1.597 Vali Acc: 0.420 Test Loss: 1.597 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 1.2488527297973633
Epoch: 2, Steps: 8 | Train Loss: 1.376 Vali Loss: 1.510 Vali Acc: 0.443 Test Loss: 1.510 Test Acc: 0.443
Validation loss decreased (-0.419831 --> -0.442733).  Saving model ...
Epoch: 3 cost time: 1.1085560321807861
Epoch: 3, Steps: 8 | Train Loss: 1.097 Vali Loss: 1.474 Vali Acc: 0.496 Test Loss: 1.474 Test Acc: 0.496
Validation loss decreased (-0.442733 --> -0.496168).  Saving model ...
Epoch: 4 cost time: 1.0478174686431885
Epoch: 4, Steps: 8 | Train Loss: 0.709 Vali Loss: 1.410 Vali Acc: 0.473 Test Loss: 1.410 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9459786415100098
Epoch: 5, Steps: 8 | Train Loss: 0.351 Vali Loss: 1.408 Vali Acc: 0.504 Test Loss: 1.408 Test Acc: 0.504
Validation loss decreased (-0.496168 --> -0.503803).  Saving model ...
Epoch: 6 cost time: 0.9216892719268799
Epoch: 6, Steps: 8 | Train Loss: 0.128 Vali Loss: 1.450 Vali Acc: 0.557 Test Loss: 1.450 Test Acc: 0.557
Validation loss decreased (-0.503803 --> -0.557237).  Saving model ...
Epoch: 7 cost time: 1.0148200988769531
Epoch: 7, Steps: 8 | Train Loss: 0.036 Vali Loss: 1.491 Vali Acc: 0.504 Test Loss: 1.491 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1050019264221191
Epoch: 8, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.631 Vali Acc: 0.565 Test Loss: 1.631 Test Acc: 0.565
Validation loss decreased (-0.557237 --> -0.564869).  Saving model ...
Epoch: 9 cost time: 1.3896431922912598
Epoch: 9, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.802 Vali Acc: 0.542 Test Loss: 1.802 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1265654563903809
Epoch: 10, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.799 Vali Acc: 0.550 Test Loss: 1.799 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.1588902473449707
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.787 Vali Acc: 0.557 Test Loss: 1.787 Test Acc: 0.557
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.076984167098999
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.802 Vali Acc: 0.550 Test Loss: 1.802 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.2846698760986328
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.842 Vali Acc: 0.557 Test Loss: 1.842 Test Acc: 0.557
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.1274311542510986
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.881 Vali Acc: 0.565 Test Loss: 1.881 Test Acc: 0.565
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.1942033767700195
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.893 Vali Acc: 0.565 Test Loss: 1.893 Test Acc: 0.565
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.3216853141784668
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.891 Vali Acc: 0.565 Test Loss: 1.891 Test Acc: 0.565
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.1607694625854492
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.892 Vali Acc: 0.557 Test Loss: 1.892 Test Acc: 0.557
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.321547508239746
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.896 Vali Acc: 0.557 Test Loss: 1.896 Test Acc: 0.557
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps1285_str643_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5648854961832062
model parameter : 54194693
model size : 221.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps1285_str1285_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.2643189430236816
Epoch: 1, Steps: 8 | Train Loss: 1.504 Vali Loss: 1.578 Vali Acc: 0.420 Test Loss: 1.578 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 0.9779841899871826
Epoch: 2, Steps: 8 | Train Loss: 1.344 Vali Loss: 1.517 Vali Acc: 0.443 Test Loss: 1.517 Test Acc: 0.443
Validation loss decreased (-0.419832 --> -0.442733).  Saving model ...
Epoch: 3 cost time: 1.2829928398132324
Epoch: 3, Steps: 8 | Train Loss: 1.056 Vali Loss: 1.549 Vali Acc: 0.374 Test Loss: 1.549 Test Acc: 0.374
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2910995483398438
Epoch: 4, Steps: 8 | Train Loss: 0.742 Vali Loss: 1.421 Vali Acc: 0.458 Test Loss: 1.421 Test Acc: 0.458
Validation loss decreased (-0.442733 --> -0.458001).  Saving model ...
Epoch: 5 cost time: 1.2014350891113281
Epoch: 5, Steps: 8 | Train Loss: 0.406 Vali Loss: 1.394 Vali Acc: 0.481 Test Loss: 1.394 Test Acc: 0.481
Validation loss decreased (-0.458001 --> -0.480902).  Saving model ...
Epoch: 6 cost time: 1.1616237163543701
Epoch: 6, Steps: 8 | Train Loss: 0.198 Vali Loss: 1.458 Vali Acc: 0.496 Test Loss: 1.458 Test Acc: 0.496
Validation loss decreased (-0.480902 --> -0.496169).  Saving model ...
Epoch: 7 cost time: 1.1920058727264404
Epoch: 7, Steps: 8 | Train Loss: 0.080 Vali Loss: 1.505 Vali Acc: 0.496 Test Loss: 1.505 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.028947114944458
Epoch: 8, Steps: 8 | Train Loss: 0.033 Vali Loss: 1.500 Vali Acc: 0.534 Test Loss: 1.500 Test Acc: 0.534
Validation loss decreased (-0.496169 --> -0.534336).  Saving model ...
Epoch: 9 cost time: 1.0623369216918945
Epoch: 9, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.628 Vali Acc: 0.550 Test Loss: 1.628 Test Acc: 0.550
Validation loss decreased (-0.534336 --> -0.549602).  Saving model ...
Epoch: 10 cost time: 1.303114891052246
Epoch: 10, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.640 Vali Acc: 0.527 Test Loss: 1.640 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1204819679260254
Epoch: 11, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.638 Vali Acc: 0.519 Test Loss: 1.638 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.0339324474334717
Epoch: 12, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.666 Vali Acc: 0.519 Test Loss: 1.666 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.2021708488464355
Epoch: 13, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.732 Vali Acc: 0.527 Test Loss: 1.732 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.1622169017791748
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.769 Vali Acc: 0.519 Test Loss: 1.769 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.8968963623046875
Epoch: 15, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.782 Vali Acc: 0.519 Test Loss: 1.782 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.747107744216919
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.789 Vali Acc: 0.519 Test Loss: 1.789 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.054203987121582
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.795 Vali Acc: 0.519 Test Loss: 1.795 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.9245054721832275
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.802 Vali Acc: 0.519 Test Loss: 1.802 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.4966342449188232
Epoch: 19, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.814 Vali Acc: 0.519 Test Loss: 1.814 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps1285_str1285_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 54124805
model size : 221.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps1384_str346_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.6628894805908203
Epoch: 1, Steps: 8 | Train Loss: 1.526 Vali Loss: 1.543 Vali Acc: 0.412 Test Loss: 1.543 Test Acc: 0.412
Validation loss decreased (inf --> -0.412198).  Saving model ...
Epoch: 2 cost time: 1.81467604637146
Epoch: 2, Steps: 8 | Train Loss: 1.403 Vali Loss: 1.492 Vali Acc: 0.450 Test Loss: 1.492 Test Acc: 0.450
Validation loss decreased (-0.412198 --> -0.450367).  Saving model ...
Epoch: 3 cost time: 1.3580577373504639
Epoch: 3, Steps: 8 | Train Loss: 1.051 Vali Loss: 1.404 Vali Acc: 0.534 Test Loss: 1.404 Test Acc: 0.534
Validation loss decreased (-0.450367 --> -0.534337).  Saving model ...
Epoch: 4 cost time: 1.6813740730285645
Epoch: 4, Steps: 8 | Train Loss: 0.675 Vali Loss: 1.404 Vali Acc: 0.519 Test Loss: 1.404 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.373265266418457
Epoch: 5, Steps: 8 | Train Loss: 0.337 Vali Loss: 1.310 Vali Acc: 0.534 Test Loss: 1.310 Test Acc: 0.534
Validation loss decreased (-0.534337 --> -0.534338).  Saving model ...
Epoch: 6 cost time: 1.363438606262207
Epoch: 6, Steps: 8 | Train Loss: 0.096 Vali Loss: 1.584 Vali Acc: 0.519 Test Loss: 1.584 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3053479194641113
Epoch: 7, Steps: 8 | Train Loss: 0.024 Vali Loss: 1.433 Vali Acc: 0.580 Test Loss: 1.433 Test Acc: 0.580
Validation loss decreased (-0.534338 --> -0.580138).  Saving model ...
Epoch: 8 cost time: 1.1721570491790771
Epoch: 8, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.826 Vali Acc: 0.573 Test Loss: 1.826 Test Acc: 0.573
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0272645950317383
Epoch: 9, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.762 Vali Acc: 0.519 Test Loss: 1.762 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9193646907806396
Epoch: 10, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.872 Vali Acc: 0.550 Test Loss: 1.872 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.9795382022857666
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.998 Vali Acc: 0.527 Test Loss: 1.998 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.1644024848937988
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.019 Vali Acc: 0.519 Test Loss: 2.019 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.800870418548584
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.013 Vali Acc: 0.527 Test Loss: 2.013 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.2988073825836182
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.995 Vali Acc: 0.527 Test Loss: 1.995 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.1087443828582764
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.997 Vali Acc: 0.519 Test Loss: 1.997 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.3755462169647217
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.002 Vali Acc: 0.519 Test Loss: 2.002 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.4229724407196045
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.017 Vali Acc: 0.519 Test Loss: 2.017 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps1384_str346_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5801526717557252
model parameter : 55681541
model size : 227.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps1384_str692_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.3565475940704346
Epoch: 1, Steps: 8 | Train Loss: 1.511 Vali Loss: 1.515 Vali Acc: 0.435 Test Loss: 1.515 Test Acc: 0.435
Validation loss decreased (inf --> -0.435099).  Saving model ...
Epoch: 2 cost time: 0.9071474075317383
Epoch: 2, Steps: 8 | Train Loss: 1.303 Vali Loss: 1.420 Vali Acc: 0.450 Test Loss: 1.420 Test Acc: 0.450
Validation loss decreased (-0.435099 --> -0.450367).  Saving model ...
Epoch: 3 cost time: 1.0150783061981201
Epoch: 3, Steps: 8 | Train Loss: 0.977 Vali Loss: 1.335 Vali Acc: 0.550 Test Loss: 1.335 Test Acc: 0.550
Validation loss decreased (-0.450367 --> -0.549605).  Saving model ...
Epoch: 4 cost time: 0.9084622859954834
Epoch: 4, Steps: 8 | Train Loss: 0.612 Vali Loss: 1.343 Vali Acc: 0.489 Test Loss: 1.343 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8898582458496094
Epoch: 5, Steps: 8 | Train Loss: 0.320 Vali Loss: 1.342 Vali Acc: 0.473 Test Loss: 1.342 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.0566561222076416
Epoch: 6, Steps: 8 | Train Loss: 0.119 Vali Loss: 1.452 Vali Acc: 0.527 Test Loss: 1.452 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.9879205226898193
Epoch: 7, Steps: 8 | Train Loss: 0.037 Vali Loss: 1.442 Vali Acc: 0.466 Test Loss: 1.442 Test Acc: 0.466
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.0802221298217773
Epoch: 8, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.537 Vali Acc: 0.481 Test Loss: 1.537 Test Acc: 0.481
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.1130824089050293
Epoch: 9, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.625 Vali Acc: 0.504 Test Loss: 1.625 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.0229742527008057
Epoch: 10, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.677 Vali Acc: 0.519 Test Loss: 1.677 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.0088257789611816
Epoch: 11, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.679 Vali Acc: 0.511 Test Loss: 1.679 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.0380868911743164
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.671 Vali Acc: 0.519 Test Loss: 1.671 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.4128289222717285
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.671 Vali Acc: 0.519 Test Loss: 1.671 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps1384_str692_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 55552517
model size : 226.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps1384_str1384_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.409234046936035
Epoch: 1, Steps: 8 | Train Loss: 1.528 Vali Loss: 1.606 Vali Acc: 0.420 Test Loss: 1.606 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 1.3773307800292969
Epoch: 2, Steps: 8 | Train Loss: 1.315 Vali Loss: 1.478 Vali Acc: 0.443 Test Loss: 1.478 Test Acc: 0.443
Validation loss decreased (-0.419831 --> -0.442733).  Saving model ...
Epoch: 3 cost time: 0.8811807632446289
Epoch: 3, Steps: 8 | Train Loss: 1.044 Vali Loss: 1.379 Vali Acc: 0.519 Test Loss: 1.379 Test Acc: 0.519
Validation loss decreased (-0.442733 --> -0.519070).  Saving model ...
Epoch: 4 cost time: 0.8065965175628662
Epoch: 4, Steps: 8 | Train Loss: 0.723 Vali Loss: 1.353 Vali Acc: 0.481 Test Loss: 1.353 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9035983085632324
Epoch: 5, Steps: 8 | Train Loss: 0.377 Vali Loss: 1.432 Vali Acc: 0.511 Test Loss: 1.432 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.068411111831665
Epoch: 6, Steps: 8 | Train Loss: 0.167 Vali Loss: 1.416 Vali Acc: 0.519 Test Loss: 1.416 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.890906810760498
Epoch: 7, Steps: 8 | Train Loss: 0.061 Vali Loss: 1.420 Vali Acc: 0.489 Test Loss: 1.420 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.9713134765625
Epoch: 8, Steps: 8 | Train Loss: 0.027 Vali Loss: 1.572 Vali Acc: 0.534 Test Loss: 1.572 Test Acc: 0.534
Validation loss decreased (-0.519070 --> -0.534335).  Saving model ...
Epoch: 9 cost time: 1.0679168701171875
Epoch: 9, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.615 Vali Acc: 0.550 Test Loss: 1.615 Test Acc: 0.550
Validation loss decreased (-0.534335 --> -0.549602).  Saving model ...
Epoch: 10 cost time: 1.1218769550323486
Epoch: 10, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.611 Vali Acc: 0.527 Test Loss: 1.611 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1428906917572021
Epoch: 11, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.623 Vali Acc: 0.511 Test Loss: 1.623 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.0672364234924316
Epoch: 12, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.644 Vali Acc: 0.511 Test Loss: 1.644 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.0108110904693604
Epoch: 13, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.668 Vali Acc: 0.511 Test Loss: 1.668 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.814600944519043
Epoch: 14, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.691 Vali Acc: 0.511 Test Loss: 1.691 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.8475747108459473
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.717 Vali Acc: 0.511 Test Loss: 1.717 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.7980973720550537
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.743 Vali Acc: 0.519 Test Loss: 1.743 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.9816539287567139
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.763 Vali Acc: 0.519 Test Loss: 1.763 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.8863277435302734
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.786 Vali Acc: 0.519 Test Loss: 1.786 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.9732959270477295
Epoch: 19, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.797 Vali Acc: 0.511 Test Loss: 1.797 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps1384_str1384_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 55488005
model size : 226.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps1499_str375_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.3957595825195312
Epoch: 1, Steps: 8 | Train Loss: 1.576 Vali Loss: 1.634 Vali Acc: 0.420 Test Loss: 1.634 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 1.248490571975708
Epoch: 2, Steps: 8 | Train Loss: 1.343 Vali Loss: 1.539 Vali Acc: 0.450 Test Loss: 1.539 Test Acc: 0.450
Validation loss decreased (-0.419831 --> -0.450366).  Saving model ...
Epoch: 3 cost time: 1.7900700569152832
Epoch: 3, Steps: 8 | Train Loss: 1.035 Vali Loss: 1.465 Vali Acc: 0.496 Test Loss: 1.465 Test Acc: 0.496
Validation loss decreased (-0.450366 --> -0.496169).  Saving model ...
Epoch: 4 cost time: 1.6116948127746582
Epoch: 4, Steps: 8 | Train Loss: 0.628 Vali Loss: 1.420 Vali Acc: 0.511 Test Loss: 1.420 Test Acc: 0.511
Validation loss decreased (-0.496169 --> -0.511436).  Saving model ...
Epoch: 5 cost time: 1.3886997699737549
Epoch: 5, Steps: 8 | Train Loss: 0.272 Vali Loss: 1.319 Vali Acc: 0.450 Test Loss: 1.319 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.340484380722046
Epoch: 6, Steps: 8 | Train Loss: 0.088 Vali Loss: 1.508 Vali Acc: 0.511 Test Loss: 1.508 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.4420428276062012
Epoch: 7, Steps: 8 | Train Loss: 0.029 Vali Loss: 1.693 Vali Acc: 0.534 Test Loss: 1.693 Test Acc: 0.534
Validation loss decreased (-0.511436 --> -0.534334).  Saving model ...
Epoch: 8 cost time: 1.2683026790618896
Epoch: 8, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.635 Vali Acc: 0.519 Test Loss: 1.635 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5657997131347656
Epoch: 9, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.694 Vali Acc: 0.519 Test Loss: 1.694 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.7247798442840576
Epoch: 10, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.772 Vali Acc: 0.504 Test Loss: 1.772 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.3815650939941406
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.763 Vali Acc: 0.496 Test Loss: 1.763 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.6342475414276123
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.741 Vali Acc: 0.504 Test Loss: 1.741 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.602865219116211
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.757 Vali Acc: 0.519 Test Loss: 1.757 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.5947484970092773
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.771 Vali Acc: 0.519 Test Loss: 1.771 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.7160425186157227
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.797 Vali Acc: 0.527 Test Loss: 1.797 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.5915775299072266
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.824 Vali Acc: 0.519 Test Loss: 1.824 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.3266453742980957
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.813 Vali Acc: 0.527 Test Loss: 1.813 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps1499_str375_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 57249797
model size : 233.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps1499_str750_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.8507885932922363
Epoch: 1, Steps: 8 | Train Loss: 1.546 Vali Loss: 1.575 Vali Acc: 0.420 Test Loss: 1.575 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 1.32236647605896
Epoch: 2, Steps: 8 | Train Loss: 1.294 Vali Loss: 1.496 Vali Acc: 0.435 Test Loss: 1.496 Test Acc: 0.435
Validation loss decreased (-0.419832 --> -0.435100).  Saving model ...
Epoch: 3 cost time: 1.7301876544952393
Epoch: 3, Steps: 8 | Train Loss: 1.004 Vali Loss: 1.369 Vali Acc: 0.511 Test Loss: 1.369 Test Acc: 0.511
Validation loss decreased (-0.435100 --> -0.511437).  Saving model ...
Epoch: 4 cost time: 2.110304117202759
Epoch: 4, Steps: 8 | Train Loss: 0.680 Vali Loss: 1.387 Vali Acc: 0.511 Test Loss: 1.387 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.669464111328125
Epoch: 5, Steps: 8 | Train Loss: 0.315 Vali Loss: 1.369 Vali Acc: 0.511 Test Loss: 1.369 Test Acc: 0.511
Validation loss decreased (-0.511437 --> -0.511437).  Saving model ...
Epoch: 6 cost time: 2.1940269470214844
Epoch: 6, Steps: 8 | Train Loss: 0.104 Vali Loss: 1.459 Vali Acc: 0.519 Test Loss: 1.459 Test Acc: 0.519
Validation loss decreased (-0.511437 --> -0.519069).  Saving model ...
Epoch: 7 cost time: 1.5981266498565674
Epoch: 7, Steps: 8 | Train Loss: 0.031 Vali Loss: 1.508 Vali Acc: 0.527 Test Loss: 1.508 Test Acc: 0.527
Validation loss decreased (-0.519069 --> -0.526702).  Saving model ...
Epoch: 8 cost time: 1.7647278308868408
Epoch: 8, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.594 Vali Acc: 0.504 Test Loss: 1.594 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5452156066894531
Epoch: 9, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.643 Vali Acc: 0.489 Test Loss: 1.643 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.625950574874878
Epoch: 10, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.693 Vali Acc: 0.489 Test Loss: 1.693 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.5586087703704834
Epoch: 11, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.686 Vali Acc: 0.496 Test Loss: 1.686 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.780548095703125
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.675 Vali Acc: 0.527 Test Loss: 1.675 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.5655841827392578
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.673 Vali Acc: 0.519 Test Loss: 1.673 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.813107967376709
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.688 Vali Acc: 0.519 Test Loss: 1.688 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.5323097705841064
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.698 Vali Acc: 0.519 Test Loss: 1.698 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.776310682296753
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.708 Vali Acc: 0.519 Test Loss: 1.708 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.3021059036254883
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.727 Vali Acc: 0.519 Test Loss: 1.727 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps1499_str750_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 57131525
model size : 232.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps1499_str1499_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.233478546142578
Epoch: 1, Steps: 8 | Train Loss: 1.495 Vali Loss: 1.529 Vali Acc: 0.420 Test Loss: 1.529 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 1.1288883686065674
Epoch: 2, Steps: 8 | Train Loss: 1.323 Vali Loss: 1.473 Vali Acc: 0.435 Test Loss: 1.473 Test Acc: 0.435
Validation loss decreased (-0.419832 --> -0.435100).  Saving model ...
Epoch: 3 cost time: 1.5756330490112305
Epoch: 3, Steps: 8 | Train Loss: 1.037 Vali Loss: 1.420 Vali Acc: 0.519 Test Loss: 1.420 Test Acc: 0.519
Validation loss decreased (-0.435100 --> -0.519070).  Saving model ...
Epoch: 4 cost time: 1.247605562210083
Epoch: 4, Steps: 8 | Train Loss: 0.632 Vali Loss: 1.411 Vali Acc: 0.534 Test Loss: 1.411 Test Acc: 0.534
Validation loss decreased (-0.519070 --> -0.534337).  Saving model ...
Epoch: 5 cost time: 1.2235071659088135
Epoch: 5, Steps: 8 | Train Loss: 0.339 Vali Loss: 1.414 Vali Acc: 0.504 Test Loss: 1.414 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.386465311050415
Epoch: 6, Steps: 8 | Train Loss: 0.147 Vali Loss: 1.398 Vali Acc: 0.534 Test Loss: 1.398 Test Acc: 0.534
Validation loss decreased (-0.534337 --> -0.534337).  Saving model ...
Epoch: 7 cost time: 1.5217230319976807
Epoch: 7, Steps: 8 | Train Loss: 0.040 Vali Loss: 1.451 Vali Acc: 0.519 Test Loss: 1.451 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3412940502166748
Epoch: 8, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.453 Vali Acc: 0.542 Test Loss: 1.453 Test Acc: 0.542
Validation loss decreased (-0.534337 --> -0.541970).  Saving model ...
Epoch: 9 cost time: 1.15846848487854
Epoch: 9, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.459 Vali Acc: 0.557 Test Loss: 1.459 Test Acc: 0.557
Validation loss decreased (-0.541970 --> -0.557237).  Saving model ...
Epoch: 10 cost time: 1.296194076538086
Epoch: 10, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.488 Vali Acc: 0.565 Test Loss: 1.488 Test Acc: 0.565
Validation loss decreased (-0.557237 --> -0.564871).  Saving model ...
Epoch: 11 cost time: 1.4045681953430176
Epoch: 11, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.515 Vali Acc: 0.565 Test Loss: 1.515 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.60121750831604
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.531 Vali Acc: 0.580 Test Loss: 1.531 Test Acc: 0.580
Validation loss decreased (-0.564871 --> -0.580137).  Saving model ...
Epoch: 13 cost time: 1.4538161754608154
Epoch: 13, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.537 Vali Acc: 0.580 Test Loss: 1.537 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4846336841583252
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.542 Vali Acc: 0.580 Test Loss: 1.542 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.3040759563446045
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.551 Vali Acc: 0.580 Test Loss: 1.551 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.4930872917175293
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.561 Vali Acc: 0.588 Test Loss: 1.561 Test Acc: 0.588
Validation loss decreased (-0.580137 --> -0.587771).  Saving model ...
Epoch: 17 cost time: 1.4199872016906738
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.570 Vali Acc: 0.588 Test Loss: 1.570 Test Acc: 0.588
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.339963436126709
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.574 Vali Acc: 0.588 Test Loss: 1.574 Test Acc: 0.588
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.3065824508666992
Epoch: 19, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.581 Vali Acc: 0.588 Test Loss: 1.581 Test Acc: 0.588
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.303997278213501
Epoch: 20, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.583 Vali Acc: 0.588 Test Loss: 1.583 Test Acc: 0.588
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.2625415325164795
Epoch: 21, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.587 Vali Acc: 0.588 Test Loss: 1.587 Test Acc: 0.588
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.217895269393921
Epoch: 22, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.594 Vali Acc: 0.588 Test Loss: 1.594 Test Acc: 0.588
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.275456428527832
Epoch: 23, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.599 Vali Acc: 0.580 Test Loss: 1.599 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.329737663269043
Epoch: 24, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.606 Vali Acc: 0.580 Test Loss: 1.606 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.4053723812103271
Epoch: 25, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.610 Vali Acc: 0.580 Test Loss: 1.610 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.3031959533691406
Epoch: 26, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.613 Vali Acc: 0.588 Test Loss: 1.613 Test Acc: 0.588
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps1499_str1499_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5877862595419847
model parameter : 57072389
model size : 232.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps1635_str409_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.433424234390259
Epoch: 1, Steps: 8 | Train Loss: 1.583 Vali Loss: 1.596 Vali Acc: 0.420 Test Loss: 1.596 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 1.696650505065918
Epoch: 2, Steps: 8 | Train Loss: 1.322 Vali Loss: 1.593 Vali Acc: 0.427 Test Loss: 1.593 Test Acc: 0.427
Validation loss decreased (-0.419831 --> -0.427465).  Saving model ...
Epoch: 3 cost time: 1.628803014755249
Epoch: 3, Steps: 8 | Train Loss: 0.965 Vali Loss: 1.406 Vali Acc: 0.481 Test Loss: 1.406 Test Acc: 0.481
Validation loss decreased (-0.427465 --> -0.480902).  Saving model ...
Epoch: 4 cost time: 1.0444228649139404
Epoch: 4, Steps: 8 | Train Loss: 0.544 Vali Loss: 1.452 Vali Acc: 0.519 Test Loss: 1.452 Test Acc: 0.519
Validation loss decreased (-0.480902 --> -0.519069).  Saving model ...
Epoch: 5 cost time: 1.2647480964660645
Epoch: 5, Steps: 8 | Train Loss: 0.243 Vali Loss: 1.402 Vali Acc: 0.496 Test Loss: 1.402 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5322926044464111
Epoch: 6, Steps: 8 | Train Loss: 0.087 Vali Loss: 1.377 Vali Acc: 0.450 Test Loss: 1.377 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.6176836490631104
Epoch: 7, Steps: 8 | Train Loss: 0.025 Vali Loss: 1.520 Vali Acc: 0.504 Test Loss: 1.520 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.62394380569458
Epoch: 8, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.499 Vali Acc: 0.504 Test Loss: 1.499 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.1966407299041748
Epoch: 9, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.589 Vali Acc: 0.473 Test Loss: 1.589 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.5446269512176514
Epoch: 10, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.600 Vali Acc: 0.481 Test Loss: 1.600 Test Acc: 0.481
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.1277697086334229
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.600 Vali Acc: 0.504 Test Loss: 1.600 Test Acc: 0.504
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.7037129402160645
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.615 Vali Acc: 0.504 Test Loss: 1.615 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.3803865909576416
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.628 Vali Acc: 0.504 Test Loss: 1.628 Test Acc: 0.504
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.5223090648651123
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.637 Vali Acc: 0.519 Test Loss: 1.637 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps1635_str409_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 59108357
model size : 240.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps1635_str818_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.199140787124634
Epoch: 1, Steps: 8 | Train Loss: 1.507 Vali Loss: 1.590 Vali Acc: 0.420 Test Loss: 1.590 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 1.3924858570098877
Epoch: 2, Steps: 8 | Train Loss: 1.350 Vali Loss: 1.546 Vali Acc: 0.450 Test Loss: 1.546 Test Acc: 0.450
Validation loss decreased (-0.419831 --> -0.450366).  Saving model ...
Epoch: 3 cost time: 1.6432101726531982
Epoch: 3, Steps: 8 | Train Loss: 0.985 Vali Loss: 1.572 Vali Acc: 0.427 Test Loss: 1.572 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4247803688049316
Epoch: 4, Steps: 8 | Train Loss: 0.599 Vali Loss: 1.543 Vali Acc: 0.496 Test Loss: 1.543 Test Acc: 0.496
Validation loss decreased (-0.450366 --> -0.496168).  Saving model ...
Epoch: 5 cost time: 1.5141758918762207
Epoch: 5, Steps: 8 | Train Loss: 0.292 Vali Loss: 1.477 Vali Acc: 0.473 Test Loss: 1.477 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5720405578613281
Epoch: 6, Steps: 8 | Train Loss: 0.115 Vali Loss: 1.596 Vali Acc: 0.542 Test Loss: 1.596 Test Acc: 0.542
Validation loss decreased (-0.496168 --> -0.541969).  Saving model ...
Epoch: 7 cost time: 1.347860336303711
Epoch: 7, Steps: 8 | Train Loss: 0.039 Vali Loss: 1.707 Vali Acc: 0.504 Test Loss: 1.707 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3379170894622803
Epoch: 8, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.736 Vali Acc: 0.489 Test Loss: 1.736 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.227116584777832
Epoch: 9, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.762 Vali Acc: 0.496 Test Loss: 1.762 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.5492253303527832
Epoch: 10, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.785 Vali Acc: 0.504 Test Loss: 1.785 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.447817087173462
Epoch: 11, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.832 Vali Acc: 0.511 Test Loss: 1.832 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.5097434520721436
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.863 Vali Acc: 0.519 Test Loss: 1.863 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.3736793994903564
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.884 Vali Acc: 0.519 Test Loss: 1.884 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.3881080150604248
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.900 Vali Acc: 0.519 Test Loss: 1.900 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.8055849075317383
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.912 Vali Acc: 0.519 Test Loss: 1.912 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.3641464710235596
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.915 Vali Acc: 0.534 Test Loss: 1.915 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps1635_str818_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 59000837
model size : 239.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps1635_str1635_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.9620649814605713
Epoch: 1, Steps: 8 | Train Loss: 1.610 Vali Loss: 1.557 Vali Acc: 0.420 Test Loss: 1.557 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 1.222097396850586
Epoch: 2, Steps: 8 | Train Loss: 1.319 Vali Loss: 1.477 Vali Acc: 0.481 Test Loss: 1.477 Test Acc: 0.481
Validation loss decreased (-0.419832 --> -0.480901).  Saving model ...
Epoch: 3 cost time: 1.2036149501800537
Epoch: 3, Steps: 8 | Train Loss: 0.998 Vali Loss: 1.447 Vali Acc: 0.481 Test Loss: 1.447 Test Acc: 0.481
Validation loss decreased (-0.480901 --> -0.480902).  Saving model ...
Epoch: 4 cost time: 1.247255563735962
Epoch: 4, Steps: 8 | Train Loss: 0.644 Vali Loss: 1.435 Vali Acc: 0.511 Test Loss: 1.435 Test Acc: 0.511
Validation loss decreased (-0.480902 --> -0.511436).  Saving model ...
Epoch: 5 cost time: 1.457615852355957
Epoch: 5, Steps: 8 | Train Loss: 0.342 Vali Loss: 1.522 Vali Acc: 0.473 Test Loss: 1.522 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1694817543029785
Epoch: 6, Steps: 8 | Train Loss: 0.146 Vali Loss: 1.562 Vali Acc: 0.427 Test Loss: 1.562 Test Acc: 0.427
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.337705135345459
Epoch: 7, Steps: 8 | Train Loss: 0.053 Vali Loss: 1.610 Vali Acc: 0.427 Test Loss: 1.610 Test Acc: 0.427
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.398578405380249
Epoch: 8, Steps: 8 | Train Loss: 0.019 Vali Loss: 1.674 Vali Acc: 0.466 Test Loss: 1.674 Test Acc: 0.466
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.586648941040039
Epoch: 9, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.710 Vali Acc: 0.489 Test Loss: 1.710 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.449709415435791
Epoch: 10, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.730 Vali Acc: 0.504 Test Loss: 1.730 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.3869521617889404
Epoch: 11, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.734 Vali Acc: 0.481 Test Loss: 1.734 Test Acc: 0.481
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.5643506050109863
Epoch: 12, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.747 Vali Acc: 0.466 Test Loss: 1.747 Test Acc: 0.466
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.4172351360321045
Epoch: 13, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.761 Vali Acc: 0.473 Test Loss: 1.761 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.6061732769012451
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.768 Vali Acc: 0.481 Test Loss: 1.768 Test Acc: 0.481
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps1635_str1635_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5114503816793893
model parameter : 58947077
model size : 239.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps1799_str450_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.0857529640197754
Epoch: 1, Steps: 8 | Train Loss: 1.522 Vali Loss: 1.622 Vali Acc: 0.420 Test Loss: 1.622 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 1.6725142002105713
Epoch: 2, Steps: 8 | Train Loss: 1.386 Vali Loss: 1.453 Vali Acc: 0.466 Test Loss: 1.453 Test Acc: 0.466
Validation loss decreased (-0.419831 --> -0.465634).  Saving model ...
Epoch: 3 cost time: 2.008173942565918
Epoch: 3, Steps: 8 | Train Loss: 1.013 Vali Loss: 1.379 Vali Acc: 0.519 Test Loss: 1.379 Test Acc: 0.519
Validation loss decreased (-0.465634 --> -0.519070).  Saving model ...
Epoch: 4 cost time: 1.601794719696045
Epoch: 4, Steps: 8 | Train Loss: 0.595 Vali Loss: 1.377 Vali Acc: 0.489 Test Loss: 1.377 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3231520652770996
Epoch: 5, Steps: 8 | Train Loss: 0.240 Vali Loss: 1.405 Vali Acc: 0.466 Test Loss: 1.405 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.3724260330200195
Epoch: 6, Steps: 8 | Train Loss: 0.070 Vali Loss: 1.532 Vali Acc: 0.527 Test Loss: 1.532 Test Acc: 0.527
Validation loss decreased (-0.519070 --> -0.526702).  Saving model ...
Epoch: 7 cost time: 1.0139567852020264
Epoch: 7, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.486 Vali Acc: 0.504 Test Loss: 1.486 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.053863763809204
Epoch: 8, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.588 Vali Acc: 0.519 Test Loss: 1.588 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.2912068367004395
Epoch: 9, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.610 Vali Acc: 0.519 Test Loss: 1.610 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.3381898403167725
Epoch: 10, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.654 Vali Acc: 0.511 Test Loss: 1.654 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.5456650257110596
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.699 Vali Acc: 0.527 Test Loss: 1.699 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.2180042266845703
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.736 Vali Acc: 0.511 Test Loss: 1.736 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.5326850414276123
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.766 Vali Acc: 0.511 Test Loss: 1.766 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.5897541046142578
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.777 Vali Acc: 0.511 Test Loss: 1.777 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.5036463737487793
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.772 Vali Acc: 0.511 Test Loss: 1.772 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.9884853363037109
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.768 Vali Acc: 0.511 Test Loss: 1.768 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps1799_str450_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 61353989
model size : 248.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps1799_str900_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.097081422805786
Epoch: 1, Steps: 8 | Train Loss: 1.648 Vali Loss: 1.554 Vali Acc: 0.420 Test Loss: 1.554 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 1.882084608078003
Epoch: 2, Steps: 8 | Train Loss: 1.345 Vali Loss: 1.497 Vali Acc: 0.458 Test Loss: 1.497 Test Acc: 0.458
Validation loss decreased (-0.419832 --> -0.458000).  Saving model ...
Epoch: 3 cost time: 1.8589932918548584
Epoch: 3, Steps: 8 | Train Loss: 1.006 Vali Loss: 1.447 Vali Acc: 0.443 Test Loss: 1.447 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9626836776733398
Epoch: 4, Steps: 8 | Train Loss: 0.610 Vali Loss: 1.398 Vali Acc: 0.511 Test Loss: 1.398 Test Acc: 0.511
Validation loss decreased (-0.458000 --> -0.511436).  Saving model ...
Epoch: 5 cost time: 1.545487403869629
Epoch: 5, Steps: 8 | Train Loss: 0.322 Vali Loss: 1.381 Vali Acc: 0.489 Test Loss: 1.381 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3131258487701416
Epoch: 6, Steps: 8 | Train Loss: 0.107 Vali Loss: 1.634 Vali Acc: 0.542 Test Loss: 1.634 Test Acc: 0.542
Validation loss decreased (-0.511436 --> -0.541968).  Saving model ...
Epoch: 7 cost time: 1.8694770336151123
Epoch: 7, Steps: 8 | Train Loss: 0.043 Vali Loss: 1.597 Vali Acc: 0.443 Test Loss: 1.597 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7357141971588135
Epoch: 8, Steps: 8 | Train Loss: 0.018 Vali Loss: 1.672 Vali Acc: 0.496 Test Loss: 1.672 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.5461387634277344
Epoch: 9, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.778 Vali Acc: 0.504 Test Loss: 1.778 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.5957000255584717
Epoch: 10, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.752 Vali Acc: 0.511 Test Loss: 1.752 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.3074653148651123
Epoch: 11, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.810 Vali Acc: 0.481 Test Loss: 1.810 Test Acc: 0.481
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.6796605587005615
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.858 Vali Acc: 0.481 Test Loss: 1.858 Test Acc: 0.481
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.7027955055236816
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.885 Vali Acc: 0.489 Test Loss: 1.885 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.510866641998291
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.881 Vali Acc: 0.489 Test Loss: 1.881 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.245086908340454
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.900 Vali Acc: 0.504 Test Loss: 1.900 Test Acc: 0.504
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.3999969959259033
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.914 Vali Acc: 0.504 Test Loss: 1.914 Test Acc: 0.504
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps1799_str900_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 61257221
model size : 248.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps1799_str1799_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.295346975326538
Epoch: 1, Steps: 8 | Train Loss: 1.536 Vali Loss: 1.558 Vali Acc: 0.420 Test Loss: 1.558 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 1.0260238647460938
Epoch: 2, Steps: 8 | Train Loss: 1.304 Vali Loss: 1.552 Vali Acc: 0.420 Test Loss: 1.552 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 1.2828216552734375
Epoch: 3, Steps: 8 | Train Loss: 0.953 Vali Loss: 1.569 Vali Acc: 0.405 Test Loss: 1.569 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1733407974243164
Epoch: 4, Steps: 8 | Train Loss: 0.553 Vali Loss: 1.499 Vali Acc: 0.473 Test Loss: 1.499 Test Acc: 0.473
Validation loss decreased (-0.419832 --> -0.473267).  Saving model ...
Epoch: 5 cost time: 1.1518774032592773
Epoch: 5, Steps: 8 | Train Loss: 0.237 Vali Loss: 1.621 Vali Acc: 0.466 Test Loss: 1.621 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1253736019134521
Epoch: 6, Steps: 8 | Train Loss: 0.085 Vali Loss: 1.603 Vali Acc: 0.450 Test Loss: 1.603 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9566559791564941
Epoch: 7, Steps: 8 | Train Loss: 0.027 Vali Loss: 1.639 Vali Acc: 0.489 Test Loss: 1.639 Test Acc: 0.489
Validation loss decreased (-0.473267 --> -0.488533).  Saving model ...
Epoch: 8 cost time: 0.9946906566619873
Epoch: 8, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.673 Vali Acc: 0.473 Test Loss: 1.673 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0933144092559814
Epoch: 9, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.704 Vali Acc: 0.473 Test Loss: 1.704 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.2402920722961426
Epoch: 10, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.726 Vali Acc: 0.481 Test Loss: 1.726 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.0279314517974854
Epoch: 11, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.746 Vali Acc: 0.473 Test Loss: 1.746 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.097813606262207
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.762 Vali Acc: 0.473 Test Loss: 1.762 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.0988643169403076
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.787 Vali Acc: 0.481 Test Loss: 1.787 Test Acc: 0.481
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.9345440864562988
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.807 Vali Acc: 0.489 Test Loss: 1.807 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.137923002243042
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.825 Vali Acc: 0.489 Test Loss: 1.825 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.9749612808227539
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.844 Vali Acc: 0.489 Test Loss: 1.844 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.9399862289428711
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.852 Vali Acc: 0.489 Test Loss: 1.852 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps1799_str1799_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.48854961832061067
model parameter : 61208837
model size : 248.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps1999_str500_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.844524621963501
Epoch: 1, Steps: 8 | Train Loss: 1.601 Vali Loss: 1.546 Vali Acc: 0.420 Test Loss: 1.546 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 1.2519521713256836
Epoch: 2, Steps: 8 | Train Loss: 1.285 Vali Loss: 1.435 Vali Acc: 0.496 Test Loss: 1.435 Test Acc: 0.496
Validation loss decreased (-0.419832 --> -0.496169).  Saving model ...
Epoch: 3 cost time: 2.0244979858398438
Epoch: 3, Steps: 8 | Train Loss: 0.860 Vali Loss: 1.371 Vali Acc: 0.542 Test Loss: 1.371 Test Acc: 0.542
Validation loss decreased (-0.496169 --> -0.541971).  Saving model ...
Epoch: 4 cost time: 2.086782932281494
Epoch: 4, Steps: 8 | Train Loss: 0.427 Vali Loss: 1.416 Vali Acc: 0.473 Test Loss: 1.416 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.329552412033081
Epoch: 5, Steps: 8 | Train Loss: 0.150 Vali Loss: 1.544 Vali Acc: 0.496 Test Loss: 1.544 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.3190758228302
Epoch: 6, Steps: 8 | Train Loss: 0.041 Vali Loss: 1.600 Vali Acc: 0.481 Test Loss: 1.600 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.3492136001586914
Epoch: 7, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.525 Vali Acc: 0.550 Test Loss: 1.525 Test Acc: 0.550
Validation loss decreased (-0.541971 --> -0.549603).  Saving model ...
Epoch: 8 cost time: 1.810117483139038
Epoch: 8, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.626 Vali Acc: 0.565 Test Loss: 1.626 Test Acc: 0.565
Validation loss decreased (-0.549603 --> -0.564869).  Saving model ...
Epoch: 9 cost time: 1.944530725479126
Epoch: 9, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.751 Vali Acc: 0.527 Test Loss: 1.751 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7205021381378174
Epoch: 10, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.774 Vali Acc: 0.527 Test Loss: 1.774 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.5355048179626465
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.768 Vali Acc: 0.534 Test Loss: 1.768 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.8528392314910889
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.775 Vali Acc: 0.557 Test Loss: 1.775 Test Acc: 0.557
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.468970537185669
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.780 Vali Acc: 0.557 Test Loss: 1.780 Test Acc: 0.557
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.5605812072753906
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.781 Vali Acc: 0.557 Test Loss: 1.781 Test Acc: 0.557
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.6297564506530762
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.790 Vali Acc: 0.550 Test Loss: 1.790 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.429511547088623
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.804 Vali Acc: 0.550 Test Loss: 1.804 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.62825345993042
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.817 Vali Acc: 0.550 Test Loss: 1.817 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.5383179187774658
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.831 Vali Acc: 0.550 Test Loss: 1.831 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps1999_str500_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5648854961832062
model parameter : 64097285
model size : 259.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps1999_str1000_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.129376173019409
Epoch: 1, Steps: 8 | Train Loss: 1.573 Vali Loss: 1.550 Vali Acc: 0.420 Test Loss: 1.550 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 1.5227015018463135
Epoch: 2, Steps: 8 | Train Loss: 1.266 Vali Loss: 1.538 Vali Acc: 0.420 Test Loss: 1.538 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 1.352752923965454
Epoch: 3, Steps: 8 | Train Loss: 0.894 Vali Loss: 1.443 Vali Acc: 0.473 Test Loss: 1.443 Test Acc: 0.473
Validation loss decreased (-0.419832 --> -0.473268).  Saving model ...
Epoch: 4 cost time: 1.88923978805542
Epoch: 4, Steps: 8 | Train Loss: 0.527 Vali Loss: 1.427 Vali Acc: 0.534 Test Loss: 1.427 Test Acc: 0.534
Validation loss decreased (-0.473268 --> -0.534337).  Saving model ...
Epoch: 5 cost time: 1.6107134819030762
Epoch: 5, Steps: 8 | Train Loss: 0.258 Vali Loss: 1.480 Vali Acc: 0.504 Test Loss: 1.480 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.59409499168396
Epoch: 6, Steps: 8 | Train Loss: 0.103 Vali Loss: 1.568 Vali Acc: 0.519 Test Loss: 1.568 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.5226020812988281
Epoch: 7, Steps: 8 | Train Loss: 0.033 Vali Loss: 1.615 Vali Acc: 0.527 Test Loss: 1.615 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.2698402404785156
Epoch: 8, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.667 Vali Acc: 0.504 Test Loss: 1.667 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.5957496166229248
Epoch: 9, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.788 Vali Acc: 0.519 Test Loss: 1.788 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.45975661277771
Epoch: 10, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.830 Vali Acc: 0.504 Test Loss: 1.830 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.3908612728118896
Epoch: 11, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.865 Vali Acc: 0.519 Test Loss: 1.865 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.5153570175170898
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.904 Vali Acc: 0.519 Test Loss: 1.904 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.4528343677520752
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.934 Vali Acc: 0.511 Test Loss: 1.934 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.212681770324707
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.949 Vali Acc: 0.511 Test Loss: 1.949 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps1999_str1000_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 64011269
model size : 258.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps1999_str1999_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.4908058643341064
Epoch: 1, Steps: 8 | Train Loss: 1.528 Vali Loss: 1.540 Vali Acc: 0.420 Test Loss: 1.540 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 1.4237239360809326
Epoch: 2, Steps: 8 | Train Loss: 1.280 Vali Loss: 1.493 Vali Acc: 0.443 Test Loss: 1.493 Test Acc: 0.443
Validation loss decreased (-0.419832 --> -0.442733).  Saving model ...
Epoch: 3 cost time: 1.2942464351654053
Epoch: 3, Steps: 8 | Train Loss: 0.918 Vali Loss: 1.460 Vali Acc: 0.458 Test Loss: 1.460 Test Acc: 0.458
Validation loss decreased (-0.442733 --> -0.458001).  Saving model ...
Epoch: 4 cost time: 1.6773738861083984
Epoch: 4, Steps: 8 | Train Loss: 0.540 Vali Loss: 1.474 Vali Acc: 0.489 Test Loss: 1.474 Test Acc: 0.489
Validation loss decreased (-0.458001 --> -0.488535).  Saving model ...
Epoch: 5 cost time: 1.8357129096984863
Epoch: 5, Steps: 8 | Train Loss: 0.255 Vali Loss: 1.574 Vali Acc: 0.511 Test Loss: 1.574 Test Acc: 0.511
Validation loss decreased (-0.488535 --> -0.511435).  Saving model ...
Epoch: 6 cost time: 1.5721535682678223
Epoch: 6, Steps: 8 | Train Loss: 0.092 Vali Loss: 1.581 Vali Acc: 0.489 Test Loss: 1.581 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4132955074310303
Epoch: 7, Steps: 8 | Train Loss: 0.033 Vali Loss: 1.643 Vali Acc: 0.466 Test Loss: 1.643 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.513375997543335
Epoch: 8, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.684 Vali Acc: 0.481 Test Loss: 1.684 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.5850698947906494
Epoch: 9, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.701 Vali Acc: 0.481 Test Loss: 1.701 Test Acc: 0.481
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.535660982131958
Epoch: 10, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.726 Vali Acc: 0.489 Test Loss: 1.726 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.515113353729248
Epoch: 11, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.751 Vali Acc: 0.466 Test Loss: 1.751 Test Acc: 0.466
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.3701400756835938
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.773 Vali Acc: 0.466 Test Loss: 1.773 Test Acc: 0.466
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.3368840217590332
Epoch: 13, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.796 Vali Acc: 0.466 Test Loss: 1.796 Test Acc: 0.466
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.5014216899871826
Epoch: 14, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.820 Vali Acc: 0.473 Test Loss: 1.820 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.6886646747589111
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.835 Vali Acc: 0.473 Test Loss: 1.835 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps1999_str1999_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5114503816793893
model parameter : 63968261
model size : 258.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps2248_str562_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.866438150405884
Epoch: 1, Steps: 8 | Train Loss: 1.543 Vali Loss: 1.600 Vali Acc: 0.420 Test Loss: 1.600 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 1.8395752906799316
Epoch: 2, Steps: 8 | Train Loss: 1.311 Vali Loss: 1.485 Vali Acc: 0.405 Test Loss: 1.485 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4302456378936768
Epoch: 3, Steps: 8 | Train Loss: 0.852 Vali Loss: 1.335 Vali Acc: 0.496 Test Loss: 1.335 Test Acc: 0.496
Validation loss decreased (-0.419831 --> -0.496170).  Saving model ...
Epoch: 4 cost time: 1.9282042980194092
Epoch: 4, Steps: 8 | Train Loss: 0.473 Vali Loss: 1.418 Vali Acc: 0.489 Test Loss: 1.418 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.133728504180908
Epoch: 5, Steps: 8 | Train Loss: 0.166 Vali Loss: 1.486 Vali Acc: 0.511 Test Loss: 1.486 Test Acc: 0.511
Validation loss decreased (-0.496170 --> -0.511436).  Saving model ...
Epoch: 6 cost time: 1.4596326351165771
Epoch: 6, Steps: 8 | Train Loss: 0.040 Vali Loss: 1.610 Vali Acc: 0.534 Test Loss: 1.610 Test Acc: 0.534
Validation loss decreased (-0.511436 --> -0.534335).  Saving model ...
Epoch: 7 cost time: 1.4166581630706787
Epoch: 7, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.736 Vali Acc: 0.511 Test Loss: 1.736 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4525084495544434
Epoch: 8, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.863 Vali Acc: 0.496 Test Loss: 1.863 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.462066888809204
Epoch: 9, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.848 Vali Acc: 0.519 Test Loss: 1.848 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.0174124240875244
Epoch: 10, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.832 Vali Acc: 0.519 Test Loss: 1.832 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.416745662689209
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.858 Vali Acc: 0.527 Test Loss: 1.858 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.9814469814300537
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.889 Vali Acc: 0.534 Test Loss: 1.889 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.1781375408172607
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.923 Vali Acc: 0.534 Test Loss: 1.923 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.5901951789855957
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.952 Vali Acc: 0.534 Test Loss: 1.952 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.2198710441589355
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.975 Vali Acc: 0.534 Test Loss: 1.975 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.0712285041809082
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.987 Vali Acc: 0.534 Test Loss: 1.987 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps2248_str562_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 67523333
model size : 272.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps2248_str1124_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.571687698364258
Epoch: 1, Steps: 8 | Train Loss: 1.502 Vali Loss: 1.549 Vali Acc: 0.420 Test Loss: 1.549 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 1.2793490886688232
Epoch: 2, Steps: 8 | Train Loss: 1.248 Vali Loss: 1.437 Vali Acc: 0.496 Test Loss: 1.437 Test Acc: 0.496
Validation loss decreased (-0.419832 --> -0.496169).  Saving model ...
Epoch: 3 cost time: 1.1307737827301025
Epoch: 3, Steps: 8 | Train Loss: 0.853 Vali Loss: 1.439 Vali Acc: 0.458 Test Loss: 1.439 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0833301544189453
Epoch: 4, Steps: 8 | Train Loss: 0.455 Vali Loss: 1.398 Vali Acc: 0.473 Test Loss: 1.398 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2044641971588135
Epoch: 5, Steps: 8 | Train Loss: 0.189 Vali Loss: 1.464 Vali Acc: 0.466 Test Loss: 1.464 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.0045642852783203
Epoch: 6, Steps: 8 | Train Loss: 0.064 Vali Loss: 1.514 Vali Acc: 0.466 Test Loss: 1.514 Test Acc: 0.466
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.337395429611206
Epoch: 7, Steps: 8 | Train Loss: 0.021 Vali Loss: 1.573 Vali Acc: 0.427 Test Loss: 1.573 Test Acc: 0.427
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.2899744510650635
Epoch: 8, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.645 Vali Acc: 0.443 Test Loss: 1.645 Test Acc: 0.443
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.4223275184631348
Epoch: 9, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.696 Vali Acc: 0.458 Test Loss: 1.696 Test Acc: 0.458
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.4898512363433838
Epoch: 10, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.855 Vali Acc: 0.443 Test Loss: 1.855 Test Acc: 0.443
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.3737785816192627
Epoch: 11, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.870 Vali Acc: 0.450 Test Loss: 1.870 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.058664321899414
Epoch: 12, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.851 Vali Acc: 0.458 Test Loss: 1.851 Test Acc: 0.458
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps2248_str1124_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.4961832061068702
model parameter : 67448069
model size : 271.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps2248_str2248_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.769678831100464
Epoch: 1, Steps: 8 | Train Loss: 1.515 Vali Loss: 1.516 Vali Acc: 0.420 Test Loss: 1.516 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 1.1651885509490967
Epoch: 2, Steps: 8 | Train Loss: 1.271 Vali Loss: 1.499 Vali Acc: 0.443 Test Loss: 1.499 Test Acc: 0.443
Validation loss decreased (-0.419832 --> -0.442733).  Saving model ...
Epoch: 3 cost time: 1.1744327545166016
Epoch: 3, Steps: 8 | Train Loss: 0.855 Vali Loss: 1.556 Vali Acc: 0.473 Test Loss: 1.556 Test Acc: 0.473
Validation loss decreased (-0.442733 --> -0.473267).  Saving model ...
Epoch: 4 cost time: 1.3620376586914062
Epoch: 4, Steps: 8 | Train Loss: 0.447 Vali Loss: 1.576 Vali Acc: 0.466 Test Loss: 1.576 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9812884330749512
Epoch: 5, Steps: 8 | Train Loss: 0.196 Vali Loss: 1.665 Vali Acc: 0.458 Test Loss: 1.665 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1475934982299805
Epoch: 6, Steps: 8 | Train Loss: 0.074 Vali Loss: 1.740 Vali Acc: 0.481 Test Loss: 1.740 Test Acc: 0.481
Validation loss decreased (-0.473267 --> -0.480899).  Saving model ...
Epoch: 7 cost time: 1.3764643669128418
Epoch: 7, Steps: 8 | Train Loss: 0.028 Vali Loss: 1.807 Vali Acc: 0.489 Test Loss: 1.807 Test Acc: 0.489
Validation loss decreased (-0.480899 --> -0.488532).  Saving model ...
Epoch: 8 cost time: 1.3800773620605469
Epoch: 8, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.868 Vali Acc: 0.511 Test Loss: 1.868 Test Acc: 0.511
Validation loss decreased (-0.488532 --> -0.511432).  Saving model ...
Epoch: 9 cost time: 1.4023778438568115
Epoch: 9, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.906 Vali Acc: 0.496 Test Loss: 1.906 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4128303527832031
Epoch: 10, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.941 Vali Acc: 0.504 Test Loss: 1.941 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.3701984882354736
Epoch: 11, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.968 Vali Acc: 0.504 Test Loss: 1.968 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.3650774955749512
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.990 Vali Acc: 0.504 Test Loss: 1.990 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.4843580722808838
Epoch: 13, Steps: 8 | Train Loss: 0.002 Vali Loss: 2.001 Vali Acc: 0.504 Test Loss: 2.001 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.150317668914795
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.018 Vali Acc: 0.489 Test Loss: 2.018 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.3134746551513672
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.030 Vali Acc: 0.489 Test Loss: 2.030 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.2664334774017334
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.044 Vali Acc: 0.504 Test Loss: 2.044 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.1518290042877197
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.062 Vali Acc: 0.496 Test Loss: 2.062 Test Acc: 0.496
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.3429985046386719
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.076 Vali Acc: 0.496 Test Loss: 2.076 Test Acc: 0.496
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps2248_str2248_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5114503816793893
model parameter : 67410437
model size : 271.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps2570_str643_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.055368423461914
Epoch: 1, Steps: 8 | Train Loss: 1.562 Vali Loss: 1.546 Vali Acc: 0.420 Test Loss: 1.546 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 1.3526952266693115
Epoch: 2, Steps: 8 | Train Loss: 1.210 Vali Loss: 1.447 Vali Acc: 0.473 Test Loss: 1.447 Test Acc: 0.473
Validation loss decreased (-0.419832 --> -0.473268).  Saving model ...
Epoch: 3 cost time: 2.0594775676727295
Epoch: 3, Steps: 8 | Train Loss: 0.749 Vali Loss: 1.413 Vali Acc: 0.489 Test Loss: 1.413 Test Acc: 0.489
Validation loss decreased (-0.473268 --> -0.488535).  Saving model ...
Epoch: 4 cost time: 1.4666099548339844
Epoch: 4, Steps: 8 | Train Loss: 0.347 Vali Loss: 1.391 Vali Acc: 0.550 Test Loss: 1.391 Test Acc: 0.550
Validation loss decreased (-0.488535 --> -0.549604).  Saving model ...
Epoch: 5 cost time: 1.5031423568725586
Epoch: 5, Steps: 8 | Train Loss: 0.126 Vali Loss: 1.415 Vali Acc: 0.557 Test Loss: 1.415 Test Acc: 0.557
Validation loss decreased (-0.549604 --> -0.557238).  Saving model ...
Epoch: 6 cost time: 1.3420073986053467
Epoch: 6, Steps: 8 | Train Loss: 0.034 Vali Loss: 1.636 Vali Acc: 0.496 Test Loss: 1.636 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5970561504364014
Epoch: 7, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.805 Vali Acc: 0.489 Test Loss: 1.805 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.3589825630187988
Epoch: 8, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.809 Vali Acc: 0.473 Test Loss: 1.809 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.3572556972503662
Epoch: 9, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.822 Vali Acc: 0.504 Test Loss: 1.822 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.43031907081604
Epoch: 10, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.849 Vali Acc: 0.519 Test Loss: 1.849 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.1004254817962646
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.862 Vali Acc: 0.527 Test Loss: 1.862 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.4120259284973145
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.874 Vali Acc: 0.519 Test Loss: 1.874 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.0235304832458496
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.887 Vali Acc: 0.519 Test Loss: 1.887 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.953608512878418
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.891 Vali Acc: 0.504 Test Loss: 1.891 Test Acc: 0.504
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.4772660732269287
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.903 Vali Acc: 0.511 Test Loss: 1.903 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps2570_str643_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 71947781
model size : 289.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps2570_str1285_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.098738193511963
Epoch: 1, Steps: 8 | Train Loss: 1.524 Vali Loss: 1.520 Vali Acc: 0.420 Test Loss: 1.520 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 2.226205587387085
Epoch: 2, Steps: 8 | Train Loss: 1.237 Vali Loss: 1.487 Vali Acc: 0.443 Test Loss: 1.487 Test Acc: 0.443
Validation loss decreased (-0.419832 --> -0.442733).  Saving model ...
Epoch: 3 cost time: 1.6699838638305664
Epoch: 3, Steps: 8 | Train Loss: 0.855 Vali Loss: 1.473 Vali Acc: 0.435 Test Loss: 1.473 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5645191669464111
Epoch: 4, Steps: 8 | Train Loss: 0.431 Vali Loss: 1.432 Vali Acc: 0.511 Test Loss: 1.432 Test Acc: 0.511
Validation loss decreased (-0.442733 --> -0.511436).  Saving model ...
Epoch: 5 cost time: 1.6019117832183838
Epoch: 5, Steps: 8 | Train Loss: 0.173 Vali Loss: 1.487 Vali Acc: 0.496 Test Loss: 1.487 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6369707584381104
Epoch: 6, Steps: 8 | Train Loss: 0.060 Vali Loss: 1.541 Vali Acc: 0.519 Test Loss: 1.541 Test Acc: 0.519
Validation loss decreased (-0.511436 --> -0.519069).  Saving model ...
Epoch: 7 cost time: 1.9952292442321777
Epoch: 7, Steps: 8 | Train Loss: 0.018 Vali Loss: 1.611 Vali Acc: 0.519 Test Loss: 1.611 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5654137134552002
Epoch: 8, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.674 Vali Acc: 0.534 Test Loss: 1.674 Test Acc: 0.534
Validation loss decreased (-0.519069 --> -0.534334).  Saving model ...
Epoch: 9 cost time: 1.7792384624481201
Epoch: 9, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.713 Vali Acc: 0.542 Test Loss: 1.713 Test Acc: 0.542
Validation loss decreased (-0.534334 --> -0.541968).  Saving model ...
Epoch: 10 cost time: 1.5713868141174316
Epoch: 10, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.749 Vali Acc: 0.542 Test Loss: 1.749 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6196143627166748
Epoch: 11, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.780 Vali Acc: 0.542 Test Loss: 1.780 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.801584243774414
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.805 Vali Acc: 0.542 Test Loss: 1.805 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.7072553634643555
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.828 Vali Acc: 0.542 Test Loss: 1.828 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.6868877410888672
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.847 Vali Acc: 0.542 Test Loss: 1.847 Test Acc: 0.542
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.7573516368865967
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.864 Vali Acc: 0.542 Test Loss: 1.864 Test Acc: 0.542
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.832322597503662
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.876 Vali Acc: 0.542 Test Loss: 1.876 Test Acc: 0.542
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.9449090957641602
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.884 Vali Acc: 0.542 Test Loss: 1.884 Test Acc: 0.542
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.985764741897583
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.890 Vali Acc: 0.542 Test Loss: 1.890 Test Acc: 0.542
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.8835928440093994
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.895 Vali Acc: 0.542 Test Loss: 1.895 Test Acc: 0.542
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps2570_str1285_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 71883269
model size : 288.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps2570_str2570_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.1004505157470703
Epoch: 1, Steps: 8 | Train Loss: 1.549 Vali Loss: 1.500 Vali Acc: 0.420 Test Loss: 1.500 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 1.4804189205169678
Epoch: 2, Steps: 8 | Train Loss: 1.225 Vali Loss: 1.482 Vali Acc: 0.481 Test Loss: 1.482 Test Acc: 0.481
Validation loss decreased (-0.419832 --> -0.480901).  Saving model ...
Epoch: 3 cost time: 1.440593957901001
Epoch: 3, Steps: 8 | Train Loss: 0.780 Vali Loss: 1.501 Vali Acc: 0.504 Test Loss: 1.501 Test Acc: 0.504
Validation loss decreased (-0.480901 --> -0.503802).  Saving model ...
Epoch: 4 cost time: 1.5416390895843506
Epoch: 4, Steps: 8 | Train Loss: 0.404 Vali Loss: 1.531 Vali Acc: 0.466 Test Loss: 1.531 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4327733516693115
Epoch: 5, Steps: 8 | Train Loss: 0.168 Vali Loss: 1.522 Vali Acc: 0.527 Test Loss: 1.522 Test Acc: 0.527
Validation loss decreased (-0.503802 --> -0.526702).  Saving model ...
Epoch: 6 cost time: 1.420677661895752
Epoch: 6, Steps: 8 | Train Loss: 0.051 Vali Loss: 1.525 Vali Acc: 0.458 Test Loss: 1.525 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.51224946975708
Epoch: 7, Steps: 8 | Train Loss: 0.019 Vali Loss: 1.624 Vali Acc: 0.458 Test Loss: 1.624 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.7072932720184326
Epoch: 8, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.699 Vali Acc: 0.473 Test Loss: 1.699 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.4629104137420654
Epoch: 9, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.749 Vali Acc: 0.473 Test Loss: 1.749 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.276700735092163
Epoch: 10, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.785 Vali Acc: 0.481 Test Loss: 1.785 Test Acc: 0.481
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.7551155090332031
Epoch: 11, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.808 Vali Acc: 0.473 Test Loss: 1.808 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.640578269958496
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.820 Vali Acc: 0.466 Test Loss: 1.820 Test Acc: 0.466
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.3253815174102783
Epoch: 13, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.842 Vali Acc: 0.473 Test Loss: 1.842 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.0008749961853027
Epoch: 14, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.844 Vali Acc: 0.466 Test Loss: 1.844 Test Acc: 0.466
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.3704755306243896
Epoch: 15, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.857 Vali Acc: 0.450 Test Loss: 1.857 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps2570_str2570_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 71851013
model size : 288.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps2998_str750_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.6960365772247314
Epoch: 1, Steps: 8 | Train Loss: 1.566 Vali Loss: 1.510 Vali Acc: 0.420 Test Loss: 1.510 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 1.8983433246612549
Epoch: 2, Steps: 8 | Train Loss: 1.210 Vali Loss: 1.385 Vali Acc: 0.481 Test Loss: 1.385 Test Acc: 0.481
Validation loss decreased (-0.419832 --> -0.480902).  Saving model ...
Epoch: 3 cost time: 1.733011245727539
Epoch: 3, Steps: 8 | Train Loss: 0.747 Vali Loss: 1.353 Vali Acc: 0.435 Test Loss: 1.353 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8076426982879639
Epoch: 4, Steps: 8 | Train Loss: 0.328 Vali Loss: 1.404 Vali Acc: 0.489 Test Loss: 1.404 Test Acc: 0.489
Validation loss decreased (-0.480902 --> -0.488536).  Saving model ...
Epoch: 5 cost time: 1.8031330108642578
Epoch: 5, Steps: 8 | Train Loss: 0.108 Vali Loss: 1.518 Vali Acc: 0.473 Test Loss: 1.518 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.597515344619751
Epoch: 6, Steps: 8 | Train Loss: 0.031 Vali Loss: 1.603 Vali Acc: 0.489 Test Loss: 1.603 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.224154233932495
Epoch: 7, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.649 Vali Acc: 0.489 Test Loss: 1.649 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.6823914051055908
Epoch: 8, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.751 Vali Acc: 0.473 Test Loss: 1.751 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.06070876121521
Epoch: 9, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.823 Vali Acc: 0.466 Test Loss: 1.823 Test Acc: 0.466
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.456770420074463
Epoch: 10, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.863 Vali Acc: 0.458 Test Loss: 1.863 Test Acc: 0.458
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.300414562225342
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.891 Vali Acc: 0.466 Test Loss: 1.891 Test Acc: 0.466
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.8666105270385742
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.910 Vali Acc: 0.458 Test Loss: 1.910 Test Acc: 0.458
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.5742664337158203
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.921 Vali Acc: 0.458 Test Loss: 1.921 Test Acc: 0.458
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.9600708484649658
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.923 Vali Acc: 0.473 Test Loss: 1.923 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps2998_str750_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.48854961832061067
model parameter : 77842949
model size : 311.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps2998_str1499_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.0882577896118164
Epoch: 1, Steps: 8 | Train Loss: 1.517 Vali Loss: 1.542 Vali Acc: 0.420 Test Loss: 1.542 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 1.7910656929016113
Epoch: 2, Steps: 8 | Train Loss: 1.210 Vali Loss: 1.503 Vali Acc: 0.466 Test Loss: 1.503 Test Acc: 0.466
Validation loss decreased (-0.419832 --> -0.465634).  Saving model ...
Epoch: 3 cost time: 1.7119710445404053
Epoch: 3, Steps: 8 | Train Loss: 0.736 Vali Loss: 1.507 Vali Acc: 0.405 Test Loss: 1.507 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.138601779937744
Epoch: 4, Steps: 8 | Train Loss: 0.346 Vali Loss: 1.595 Vali Acc: 0.466 Test Loss: 1.595 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.734325885772705
Epoch: 5, Steps: 8 | Train Loss: 0.142 Vali Loss: 1.602 Vali Acc: 0.466 Test Loss: 1.602 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.5154414176940918
Epoch: 6, Steps: 8 | Train Loss: 0.042 Vali Loss: 1.583 Vali Acc: 0.473 Test Loss: 1.583 Test Acc: 0.473
Validation loss decreased (-0.465634 --> -0.473267).  Saving model ...
Epoch: 7 cost time: 1.517122745513916
Epoch: 7, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.686 Vali Acc: 0.481 Test Loss: 1.686 Test Acc: 0.481
Validation loss decreased (-0.473267 --> -0.480899).  Saving model ...
Epoch: 8 cost time: 1.9415481090545654
Epoch: 8, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.737 Vali Acc: 0.481 Test Loss: 1.737 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.9112582206726074
Epoch: 9, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.778 Vali Acc: 0.473 Test Loss: 1.778 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.4149563312530518
Epoch: 10, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.822 Vali Acc: 0.473 Test Loss: 1.822 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.831895351409912
Epoch: 11, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.858 Vali Acc: 0.466 Test Loss: 1.858 Test Acc: 0.466
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.0937325954437256
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.882 Vali Acc: 0.466 Test Loss: 1.882 Test Acc: 0.466
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.76375412940979
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.905 Vali Acc: 0.481 Test Loss: 1.905 Test Acc: 0.481
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.606428623199463
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.924 Vali Acc: 0.481 Test Loss: 1.924 Test Acc: 0.481
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.656299591064453
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.940 Vali Acc: 0.481 Test Loss: 1.940 Test Acc: 0.481
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.5818066596984863
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.952 Vali Acc: 0.481 Test Loss: 1.952 Test Acc: 0.481
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.214470148086548
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.962 Vali Acc: 0.496 Test Loss: 1.962 Test Acc: 0.496
Validation loss decreased (-0.480899 --> -0.496164).  Saving model ...
Epoch: 18 cost time: 2.2714784145355225
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.970 Vali Acc: 0.496 Test Loss: 1.970 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.898972511291504
Epoch: 19, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.973 Vali Acc: 0.489 Test Loss: 1.973 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.7724542617797852
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.980 Vali Acc: 0.489 Test Loss: 1.980 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.6666603088378906
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.983 Vali Acc: 0.481 Test Loss: 1.983 Test Acc: 0.481
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.08152174949646
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.988 Vali Acc: 0.481 Test Loss: 1.988 Test Acc: 0.481
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.3913476467132568
Epoch: 23, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.990 Vali Acc: 0.466 Test Loss: 1.990 Test Acc: 0.466
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.1444945335388184
Epoch: 24, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.995 Vali Acc: 0.466 Test Loss: 1.995 Test Acc: 0.466
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.108469009399414
Epoch: 25, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.001 Vali Acc: 0.466 Test Loss: 2.001 Test Acc: 0.466
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.9153454303741455
Epoch: 26, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.007 Vali Acc: 0.466 Test Loss: 2.007 Test Acc: 0.466
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.8009397983551025
Epoch: 27, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.016 Vali Acc: 0.466 Test Loss: 2.016 Test Acc: 0.466
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps2998_str1499_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.4961832061068702
model parameter : 77789189
model size : 311.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps2998_str2998_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.277890682220459
Epoch: 1, Steps: 8 | Train Loss: 1.607 Vali Loss: 1.561 Vali Acc: 0.405 Test Loss: 1.561 Test Acc: 0.405
Validation loss decreased (inf --> -0.404565).  Saving model ...
Epoch: 2 cost time: 2.12790584564209
Epoch: 2, Steps: 8 | Train Loss: 1.232 Vali Loss: 1.531 Vali Acc: 0.427 Test Loss: 1.531 Test Acc: 0.427
Validation loss decreased (-0.404565 --> -0.427466).  Saving model ...
Epoch: 3 cost time: 2.4866645336151123
Epoch: 3, Steps: 8 | Train Loss: 0.692 Vali Loss: 1.543 Vali Acc: 0.412 Test Loss: 1.543 Test Acc: 0.412
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.52695369720459
Epoch: 4, Steps: 8 | Train Loss: 0.331 Vali Loss: 1.586 Vali Acc: 0.435 Test Loss: 1.586 Test Acc: 0.435
Validation loss decreased (-0.427466 --> -0.435099).  Saving model ...
Epoch: 5 cost time: 2.2771401405334473
Epoch: 5, Steps: 8 | Train Loss: 0.132 Vali Loss: 1.639 Vali Acc: 0.466 Test Loss: 1.639 Test Acc: 0.466
Validation loss decreased (-0.435099 --> -0.465632).  Saving model ...
Epoch: 6 cost time: 2.2778148651123047
Epoch: 6, Steps: 8 | Train Loss: 0.045 Vali Loss: 1.714 Vali Acc: 0.481 Test Loss: 1.714 Test Acc: 0.481
Validation loss decreased (-0.465632 --> -0.480899).  Saving model ...
Epoch: 7 cost time: 2.457845687866211
Epoch: 7, Steps: 8 | Train Loss: 0.020 Vali Loss: 1.733 Vali Acc: 0.473 Test Loss: 1.733 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.9403607845306396
Epoch: 8, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.772 Vali Acc: 0.489 Test Loss: 1.772 Test Acc: 0.489
Validation loss decreased (-0.480899 --> -0.488532).  Saving model ...
Epoch: 9 cost time: 2.049992084503174
Epoch: 9, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.813 Vali Acc: 0.481 Test Loss: 1.813 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.046243906021118
Epoch: 10, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.846 Vali Acc: 0.489 Test Loss: 1.846 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.9974594116210938
Epoch: 11, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.864 Vali Acc: 0.489 Test Loss: 1.864 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.8828232288360596
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.883 Vali Acc: 0.489 Test Loss: 1.883 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.6917452812194824
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.895 Vali Acc: 0.489 Test Loss: 1.895 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.1095023155212402
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.908 Vali Acc: 0.489 Test Loss: 1.908 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.3279974460601807
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.921 Vali Acc: 0.489 Test Loss: 1.921 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.319110631942749
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.935 Vali Acc: 0.489 Test Loss: 1.935 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.4157488346099854
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.949 Vali Acc: 0.481 Test Loss: 1.949 Test Acc: 0.481
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.349428415298462
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.955 Vali Acc: 0.481 Test Loss: 1.955 Test Acc: 0.481
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps2998_str2998_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.48854961832061067
model parameter : 77762309
model size : 311.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps3597_str900_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.07385516166687
Epoch: 1, Steps: 8 | Train Loss: 1.694 Vali Loss: 1.546 Vali Acc: 0.427 Test Loss: 1.546 Test Acc: 0.427
Validation loss decreased (inf --> -0.427465).  Saving model ...
Epoch: 2 cost time: 2.2127246856689453
Epoch: 2, Steps: 8 | Train Loss: 1.192 Vali Loss: 1.512 Vali Acc: 0.466 Test Loss: 1.512 Test Acc: 0.466
Validation loss decreased (-0.427465 --> -0.465634).  Saving model ...
Epoch: 3 cost time: 2.1576216220855713
Epoch: 3, Steps: 8 | Train Loss: 0.610 Vali Loss: 1.478 Vali Acc: 0.405 Test Loss: 1.478 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.5787365436553955
Epoch: 4, Steps: 8 | Train Loss: 0.262 Vali Loss: 1.433 Vali Acc: 0.450 Test Loss: 1.433 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.489107131958008
Epoch: 5, Steps: 8 | Train Loss: 0.085 Vali Loss: 1.490 Vali Acc: 0.504 Test Loss: 1.490 Test Acc: 0.504
Validation loss decreased (-0.465634 --> -0.503802).  Saving model ...
Epoch: 6 cost time: 2.314197301864624
Epoch: 6, Steps: 8 | Train Loss: 0.023 Vali Loss: 1.532 Vali Acc: 0.466 Test Loss: 1.532 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.054391622543335
Epoch: 7, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.616 Vali Acc: 0.481 Test Loss: 1.616 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.530477523803711
Epoch: 8, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.658 Vali Acc: 0.481 Test Loss: 1.658 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.2759604454040527
Epoch: 9, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.684 Vali Acc: 0.473 Test Loss: 1.684 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.9186317920684814
Epoch: 10, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.704 Vali Acc: 0.473 Test Loss: 1.704 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.370213508605957
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.722 Vali Acc: 0.473 Test Loss: 1.722 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.718763589859009
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.734 Vali Acc: 0.481 Test Loss: 1.734 Test Acc: 0.481
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.4112801551818848
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.744 Vali Acc: 0.481 Test Loss: 1.744 Test Acc: 0.481
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.9488894939422607
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.754 Vali Acc: 0.481 Test Loss: 1.754 Test Acc: 0.481
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.0545530319213867
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.763 Vali Acc: 0.489 Test Loss: 1.763 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps3597_str900_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5038167938931297
model parameter : 86102021
model size : 343.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps3597_str1799_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.45670747756958
Epoch: 1, Steps: 8 | Train Loss: 1.579 Vali Loss: 1.522 Vali Acc: 0.420 Test Loss: 1.522 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 2.161530017852783
Epoch: 2, Steps: 8 | Train Loss: 1.252 Vali Loss: 1.541 Vali Acc: 0.458 Test Loss: 1.541 Test Acc: 0.458
Validation loss decreased (-0.419832 --> -0.458000).  Saving model ...
Epoch: 3 cost time: 2.0719258785247803
Epoch: 3, Steps: 8 | Train Loss: 0.678 Vali Loss: 1.607 Vali Acc: 0.458 Test Loss: 1.607 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4939138889312744
Epoch: 4, Steps: 8 | Train Loss: 0.315 Vali Loss: 1.605 Vali Acc: 0.450 Test Loss: 1.605 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.5363287925720215
Epoch: 5, Steps: 8 | Train Loss: 0.128 Vali Loss: 1.612 Vali Acc: 0.489 Test Loss: 1.612 Test Acc: 0.489
Validation loss decreased (-0.458000 --> -0.488534).  Saving model ...
Epoch: 6 cost time: 2.534787654876709
Epoch: 6, Steps: 8 | Train Loss: 0.049 Vali Loss: 1.659 Vali Acc: 0.458 Test Loss: 1.659 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7212669849395752
Epoch: 7, Steps: 8 | Train Loss: 0.021 Vali Loss: 1.694 Vali Acc: 0.443 Test Loss: 1.694 Test Acc: 0.443
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.8510875701904297
Epoch: 8, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.730 Vali Acc: 0.481 Test Loss: 1.730 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.48838210105896
Epoch: 9, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.750 Vali Acc: 0.473 Test Loss: 1.750 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.123861312866211
Epoch: 10, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.773 Vali Acc: 0.473 Test Loss: 1.773 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.480820417404175
Epoch: 11, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.797 Vali Acc: 0.481 Test Loss: 1.797 Test Acc: 0.481
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.0918877124786377
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.818 Vali Acc: 0.489 Test Loss: 1.818 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.239232063293457
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.837 Vali Acc: 0.489 Test Loss: 1.837 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.3519856929779053
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.854 Vali Acc: 0.489 Test Loss: 1.854 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.721449613571167
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.866 Vali Acc: 0.489 Test Loss: 1.866 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps3597_str1799_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.48854961832061067
model parameter : 86059013
model size : 342.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps3597_str3597_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.578336477279663
Epoch: 1, Steps: 8 | Train Loss: 1.594 Vali Loss: 1.529 Vali Acc: 0.412 Test Loss: 1.529 Test Acc: 0.412
Validation loss decreased (inf --> -0.412198).  Saving model ...
Epoch: 2 cost time: 1.987360954284668
Epoch: 2, Steps: 8 | Train Loss: 1.245 Vali Loss: 1.483 Vali Acc: 0.443 Test Loss: 1.483 Test Acc: 0.443
Validation loss decreased (-0.412198 --> -0.442733).  Saving model ...
Epoch: 3 cost time: 2.2749955654144287
Epoch: 3, Steps: 8 | Train Loss: 0.715 Vali Loss: 1.447 Vali Acc: 0.450 Test Loss: 1.447 Test Acc: 0.450
Validation loss decreased (-0.442733 --> -0.450367).  Saving model ...
Epoch: 4 cost time: 2.1122705936431885
Epoch: 4, Steps: 8 | Train Loss: 0.363 Vali Loss: 1.592 Vali Acc: 0.450 Test Loss: 1.592 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.087538242340088
Epoch: 5, Steps: 8 | Train Loss: 0.122 Vali Loss: 1.662 Vali Acc: 0.435 Test Loss: 1.662 Test Acc: 0.435
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.1761105060577393
Epoch: 6, Steps: 8 | Train Loss: 0.040 Vali Loss: 1.686 Vali Acc: 0.458 Test Loss: 1.686 Test Acc: 0.458
Validation loss decreased (-0.450367 --> -0.457998).  Saving model ...
Epoch: 7 cost time: 1.8019497394561768
Epoch: 7, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.733 Vali Acc: 0.443 Test Loss: 1.733 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.3185698986053467
Epoch: 8, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.779 Vali Acc: 0.443 Test Loss: 1.779 Test Acc: 0.443
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.087692975997925
Epoch: 9, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.811 Vali Acc: 0.443 Test Loss: 1.811 Test Acc: 0.443
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.190927028656006
Epoch: 10, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.837 Vali Acc: 0.450 Test Loss: 1.837 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.1943087577819824
Epoch: 11, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.855 Vali Acc: 0.435 Test Loss: 1.855 Test Acc: 0.435
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.918632984161377
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.869 Vali Acc: 0.420 Test Loss: 1.869 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.869279146194458
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.883 Vali Acc: 0.420 Test Loss: 1.883 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.6883745193481445
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.893 Vali Acc: 0.420 Test Loss: 1.893 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.5478100776672363
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.905 Vali Acc: 0.420 Test Loss: 1.905 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.29958438873291
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.917 Vali Acc: 0.420 Test Loss: 1.917 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el5_dm768_df768_ps3597_str3597_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.4580152671755725
model parameter : 86037509
model size : 342.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps720_str180_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.678123950958252
Epoch: 1, Steps: 8 | Train Loss: 1.670 Vali Loss: 1.560 Vali Acc: 0.420 Test Loss: 1.560 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 1.736546277999878
Epoch: 2, Steps: 8 | Train Loss: 1.414 Vali Loss: 1.574 Vali Acc: 0.405 Test Loss: 1.574 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2457869052886963
Epoch: 3, Steps: 8 | Train Loss: 1.236 Vali Loss: 1.455 Vali Acc: 0.443 Test Loss: 1.455 Test Acc: 0.443
Validation loss decreased (-0.419832 --> -0.442734).  Saving model ...
Epoch: 4 cost time: 1.641573429107666
Epoch: 4, Steps: 8 | Train Loss: 0.883 Vali Loss: 1.332 Vali Acc: 0.527 Test Loss: 1.332 Test Acc: 0.527
Validation loss decreased (-0.442734 --> -0.526704).  Saving model ...
Epoch: 5 cost time: 1.5252017974853516
Epoch: 5, Steps: 8 | Train Loss: 0.517 Vali Loss: 1.432 Vali Acc: 0.519 Test Loss: 1.432 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7597312927246094
Epoch: 6, Steps: 8 | Train Loss: 0.191 Vali Loss: 1.232 Vali Acc: 0.489 Test Loss: 1.232 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.687631368637085
Epoch: 7, Steps: 8 | Train Loss: 0.040 Vali Loss: 1.753 Vali Acc: 0.466 Test Loss: 1.753 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.8641903400421143
Epoch: 8, Steps: 8 | Train Loss: 0.052 Vali Loss: 2.646 Vali Acc: 0.519 Test Loss: 2.646 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.7389593124389648
Epoch: 9, Steps: 8 | Train Loss: 0.035 Vali Loss: 1.599 Vali Acc: 0.542 Test Loss: 1.599 Test Acc: 0.542
Validation loss decreased (-0.526704 --> -0.541969).  Saving model ...
Epoch: 10 cost time: 1.6168606281280518
Epoch: 10, Steps: 8 | Train Loss: 0.018 Vali Loss: 2.409 Vali Acc: 0.565 Test Loss: 2.409 Test Acc: 0.565
Validation loss decreased (-0.541969 --> -0.564861).  Saving model ...
Epoch: 11 cost time: 1.6963250637054443
Epoch: 11, Steps: 8 | Train Loss: 0.004 Vali Loss: 2.121 Vali Acc: 0.511 Test Loss: 2.121 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.736255407333374
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 2.374 Vali Acc: 0.550 Test Loss: 2.374 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.5687901973724365
Epoch: 13, Steps: 8 | Train Loss: 0.002 Vali Loss: 2.199 Vali Acc: 0.542 Test Loss: 2.199 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.527101755142212
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.146 Vali Acc: 0.534 Test Loss: 2.146 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.4485588073730469
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.172 Vali Acc: 0.534 Test Loss: 2.172 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.7042176723480225
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.262 Vali Acc: 0.550 Test Loss: 2.262 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.7200865745544434
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.274 Vali Acc: 0.557 Test Loss: 2.274 Test Acc: 0.557
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.772270917892456
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.272 Vali Acc: 0.550 Test Loss: 2.272 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.681760311126709
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.276 Vali Acc: 0.557 Test Loss: 2.276 Test Acc: 0.557
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.6271307468414307
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.275 Vali Acc: 0.557 Test Loss: 2.275 Test Acc: 0.557
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps720_str180_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5648854961832062
model parameter : 39672581
model size : 166.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps720_str360_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.6992366313934326
Epoch: 1, Steps: 8 | Train Loss: 1.616 Vali Loss: 1.658 Vali Acc: 0.420 Test Loss: 1.658 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 1.3191673755645752
Epoch: 2, Steps: 8 | Train Loss: 1.479 Vali Loss: 1.578 Vali Acc: 0.191 Test Loss: 1.578 Test Acc: 0.191
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1799805164337158
Epoch: 3, Steps: 8 | Train Loss: 1.215 Vali Loss: 1.480 Vali Acc: 0.443 Test Loss: 1.480 Test Acc: 0.443
Validation loss decreased (-0.419831 --> -0.442733).  Saving model ...
Epoch: 4 cost time: 1.1954033374786377
Epoch: 4, Steps: 8 | Train Loss: 0.937 Vali Loss: 1.258 Vali Acc: 0.519 Test Loss: 1.258 Test Acc: 0.519
Validation loss decreased (-0.442733 --> -0.519071).  Saving model ...
Epoch: 5 cost time: 1.1681666374206543
Epoch: 5, Steps: 8 | Train Loss: 0.632 Vali Loss: 1.292 Vali Acc: 0.550 Test Loss: 1.292 Test Acc: 0.550
Validation loss decreased (-0.519071 --> -0.549605).  Saving model ...
Epoch: 6 cost time: 1.2378034591674805
Epoch: 6, Steps: 8 | Train Loss: 0.321 Vali Loss: 1.291 Vali Acc: 0.588 Test Loss: 1.291 Test Acc: 0.588
Validation loss decreased (-0.549605 --> -0.587773).  Saving model ...
Epoch: 7 cost time: 0.7893869876861572
Epoch: 7, Steps: 8 | Train Loss: 0.129 Vali Loss: 1.278 Vali Acc: 0.573 Test Loss: 1.278 Test Acc: 0.573
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1547398567199707
Epoch: 8, Steps: 8 | Train Loss: 0.051 Vali Loss: 1.825 Vali Acc: 0.595 Test Loss: 1.825 Test Acc: 0.595
Validation loss decreased (-0.587773 --> -0.595402).  Saving model ...
Epoch: 9 cost time: 1.6320090293884277
Epoch: 9, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.643 Vali Acc: 0.573 Test Loss: 1.643 Test Acc: 0.573
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2046277523040771
Epoch: 10, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.830 Vali Acc: 0.550 Test Loss: 1.830 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.2265973091125488
Epoch: 11, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.777 Vali Acc: 0.588 Test Loss: 1.777 Test Acc: 0.588
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.2168662548065186
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.603 Vali Acc: 0.580 Test Loss: 1.603 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.3565993309020996
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.605 Vali Acc: 0.580 Test Loss: 1.605 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.1070404052734375
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.700 Vali Acc: 0.603 Test Loss: 1.700 Test Acc: 0.603
Validation loss decreased (-0.595402 --> -0.603036).  Saving model ...
Epoch: 15 cost time: 1.6230223178863525
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.777 Vali Acc: 0.595 Test Loss: 1.777 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2481586933135986
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.813 Vali Acc: 0.611 Test Loss: 1.813 Test Acc: 0.611
Validation loss decreased (-0.603036 --> -0.610669).  Saving model ...
Epoch: 17 cost time: 1.0642824172973633
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.788 Vali Acc: 0.611 Test Loss: 1.788 Test Acc: 0.611
Validation loss decreased (-0.610669 --> -0.610669).  Saving model ...
Epoch: 18 cost time: 1.083296298980713
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.763 Vali Acc: 0.611 Test Loss: 1.763 Test Acc: 0.611
Validation loss decreased (-0.610669 --> -0.610669).  Saving model ...
Epoch: 19 cost time: 1.154388427734375
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.744 Vali Acc: 0.611 Test Loss: 1.744 Test Acc: 0.611
Validation loss decreased (-0.610669 --> -0.610670).  Saving model ...
Epoch: 20 cost time: 1.149982213973999
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.748 Vali Acc: 0.611 Test Loss: 1.748 Test Acc: 0.611
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.054490089416504
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.758 Vali Acc: 0.611 Test Loss: 1.758 Test Acc: 0.611
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.6100704669952393
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.767 Vali Acc: 0.618 Test Loss: 1.767 Test Acc: 0.618
Validation loss decreased (-0.610670 --> -0.618303).  Saving model ...
Epoch: 23 cost time: 1.432725429534912
Epoch: 23, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.777 Vali Acc: 0.618 Test Loss: 1.777 Test Acc: 0.618
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.2365570068359375
Epoch: 24, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.781 Vali Acc: 0.618 Test Loss: 1.781 Test Acc: 0.618
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.2117736339569092
Epoch: 25, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.786 Vali Acc: 0.618 Test Loss: 1.786 Test Acc: 0.618
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.337104320526123
Epoch: 26, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.797 Vali Acc: 0.626 Test Loss: 1.797 Test Acc: 0.626
Validation loss decreased (-0.618303 --> -0.625936).  Saving model ...
Epoch: 27 cost time: 1.6720542907714844
Epoch: 27, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.797 Vali Acc: 0.626 Test Loss: 1.797 Test Acc: 0.626
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.5787053108215332
Epoch: 28, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.793 Vali Acc: 0.618 Test Loss: 1.793 Test Acc: 0.618
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.9784152507781982
Epoch: 29, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.786 Vali Acc: 0.618 Test Loss: 1.786 Test Acc: 0.618
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.282846212387085
Epoch: 30, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.786 Vali Acc: 0.618 Test Loss: 1.786 Test Acc: 0.618
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.2477962970733643
Epoch: 31, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.789 Vali Acc: 0.618 Test Loss: 1.789 Test Acc: 0.618
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.4544315338134766
Epoch: 32, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.793 Vali Acc: 0.618 Test Loss: 1.793 Test Acc: 0.618
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.3459358215332031
Epoch: 33, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.789 Vali Acc: 0.618 Test Loss: 1.789 Test Acc: 0.618
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.2102885246276855
Epoch: 34, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.797 Vali Acc: 0.618 Test Loss: 1.797 Test Acc: 0.618
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.5872697830200195
Epoch: 35, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.804 Vali Acc: 0.611 Test Loss: 1.804 Test Acc: 0.611
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.2252378463745117
Epoch: 36, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.808 Vali Acc: 0.611 Test Loss: 1.808 Test Acc: 0.611
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps720_str360_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6259541984732825
model parameter : 39414533
model size : 165.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps720_str720_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.5095841884613037
Epoch: 1, Steps: 8 | Train Loss: 1.593 Vali Loss: 1.606 Vali Acc: 0.420 Test Loss: 1.606 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 1.0871484279632568
Epoch: 2, Steps: 8 | Train Loss: 1.428 Vali Loss: 1.490 Vali Acc: 0.427 Test Loss: 1.490 Test Acc: 0.427
Validation loss decreased (-0.419831 --> -0.427466).  Saving model ...
Epoch: 3 cost time: 0.9969432353973389
Epoch: 3, Steps: 8 | Train Loss: 1.183 Vali Loss: 1.470 Vali Acc: 0.481 Test Loss: 1.470 Test Acc: 0.481
Validation loss decreased (-0.427466 --> -0.480901).  Saving model ...
Epoch: 4 cost time: 1.093860149383545
Epoch: 4, Steps: 8 | Train Loss: 0.925 Vali Loss: 1.445 Vali Acc: 0.511 Test Loss: 1.445 Test Acc: 0.511
Validation loss decreased (-0.480901 --> -0.511436).  Saving model ...
Epoch: 5 cost time: 0.9656474590301514
Epoch: 5, Steps: 8 | Train Loss: 0.600 Vali Loss: 1.380 Vali Acc: 0.489 Test Loss: 1.380 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1010949611663818
Epoch: 6, Steps: 8 | Train Loss: 0.336 Vali Loss: 1.426 Vali Acc: 0.527 Test Loss: 1.426 Test Acc: 0.527
Validation loss decreased (-0.511436 --> -0.526703).  Saving model ...
Epoch: 7 cost time: 0.8893067836761475
Epoch: 7, Steps: 8 | Train Loss: 0.139 Vali Loss: 1.510 Vali Acc: 0.534 Test Loss: 1.510 Test Acc: 0.534
Validation loss decreased (-0.526703 --> -0.534336).  Saving model ...
Epoch: 8 cost time: 0.9695663452148438
Epoch: 8, Steps: 8 | Train Loss: 0.051 Vali Loss: 1.598 Vali Acc: 0.550 Test Loss: 1.598 Test Acc: 0.550
Validation loss decreased (-0.534336 --> -0.549602).  Saving model ...
Epoch: 9 cost time: 0.9698476791381836
Epoch: 9, Steps: 8 | Train Loss: 0.021 Vali Loss: 1.636 Vali Acc: 0.489 Test Loss: 1.636 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8983299732208252
Epoch: 10, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.636 Vali Acc: 0.527 Test Loss: 1.636 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.7156658172607422
Epoch: 11, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.690 Vali Acc: 0.534 Test Loss: 1.690 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.7279565334320068
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.671 Vali Acc: 0.565 Test Loss: 1.671 Test Acc: 0.565
Validation loss decreased (-0.549602 --> -0.564869).  Saving model ...
Epoch: 13 cost time: 0.9196913242340088
Epoch: 13, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.659 Vali Acc: 0.557 Test Loss: 1.659 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9699304103851318
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.629 Vali Acc: 0.557 Test Loss: 1.629 Test Acc: 0.557
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.0250236988067627
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.627 Vali Acc: 0.557 Test Loss: 1.627 Test Acc: 0.557
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.1225192546844482
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.639 Vali Acc: 0.557 Test Loss: 1.639 Test Acc: 0.557
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.2997827529907227
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.659 Vali Acc: 0.565 Test Loss: 1.659 Test Acc: 0.565
Validation loss decreased (-0.564869 --> -0.564869).  Saving model ...
Epoch: 18 cost time: 1.215540885925293
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.683 Vali Acc: 0.550 Test Loss: 1.683 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0808384418487549
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.699 Vali Acc: 0.550 Test Loss: 1.699 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.1540939807891846
Epoch: 20, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.709 Vali Acc: 0.550 Test Loss: 1.709 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.457453727722168
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.721 Vali Acc: 0.550 Test Loss: 1.721 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.0456879138946533
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.735 Vali Acc: 0.557 Test Loss: 1.735 Test Acc: 0.557
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.0293145179748535
Epoch: 23, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.743 Vali Acc: 0.557 Test Loss: 1.743 Test Acc: 0.557
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.598832607269287
Epoch: 24, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.752 Vali Acc: 0.557 Test Loss: 1.752 Test Acc: 0.557
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.022700309753418
Epoch: 25, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.759 Vali Acc: 0.557 Test Loss: 1.759 Test Acc: 0.557
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.1593570709228516
Epoch: 26, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.764 Vali Acc: 0.557 Test Loss: 1.764 Test Acc: 0.557
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.1180784702301025
Epoch: 27, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.771 Vali Acc: 0.557 Test Loss: 1.771 Test Acc: 0.557
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps720_str720_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5648854961832062
model parameter : 39285509
model size : 164.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps750_str188_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.063781976699829
Epoch: 1, Steps: 8 | Train Loss: 1.559 Vali Loss: 1.638 Vali Acc: 0.420 Test Loss: 1.638 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 1.4938242435455322
Epoch: 2, Steps: 8 | Train Loss: 1.454 Vali Loss: 1.528 Vali Acc: 0.420 Test Loss: 1.528 Test Acc: 0.420
Validation loss decreased (-0.419831 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 1.253425121307373
Epoch: 3, Steps: 8 | Train Loss: 1.192 Vali Loss: 1.472 Vali Acc: 0.420 Test Loss: 1.472 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419833).  Saving model ...
Epoch: 4 cost time: 1.4247291088104248
Epoch: 4, Steps: 8 | Train Loss: 0.901 Vali Loss: 1.247 Vali Acc: 0.527 Test Loss: 1.247 Test Acc: 0.527
Validation loss decreased (-0.419833 --> -0.526705).  Saving model ...
Epoch: 5 cost time: 1.4324729442596436
Epoch: 5, Steps: 8 | Train Loss: 0.494 Vali Loss: 1.200 Vali Acc: 0.534 Test Loss: 1.200 Test Acc: 0.534
Validation loss decreased (-0.526705 --> -0.534339).  Saving model ...
Epoch: 6 cost time: 1.4890553951263428
Epoch: 6, Steps: 8 | Train Loss: 0.149 Vali Loss: 1.361 Vali Acc: 0.527 Test Loss: 1.361 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5862393379211426
Epoch: 7, Steps: 8 | Train Loss: 0.052 Vali Loss: 1.364 Vali Acc: 0.527 Test Loss: 1.364 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.347579002380371
Epoch: 8, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.495 Vali Acc: 0.519 Test Loss: 1.495 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.3205108642578125
Epoch: 9, Steps: 8 | Train Loss: 0.009 Vali Loss: 2.057 Vali Acc: 0.489 Test Loss: 2.057 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.5292143821716309
Epoch: 10, Steps: 8 | Train Loss: 0.014 Vali Loss: 2.141 Vali Acc: 0.511 Test Loss: 2.141 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.6086528301239014
Epoch: 11, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.848 Vali Acc: 0.519 Test Loss: 1.848 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.343127965927124
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.675 Vali Acc: 0.473 Test Loss: 1.675 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.2901363372802734
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.818 Vali Acc: 0.504 Test Loss: 1.818 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.667100191116333
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.863 Vali Acc: 0.504 Test Loss: 1.863 Test Acc: 0.504
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.4688854217529297
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.907 Vali Acc: 0.496 Test Loss: 1.907 Test Acc: 0.496
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps750_str188_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 40065797
model size : 167.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps750_str375_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.9199719429016113
Epoch: 1, Steps: 8 | Train Loss: 1.549 Vali Loss: 1.622 Vali Acc: 0.420 Test Loss: 1.622 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 1.2436974048614502
Epoch: 2, Steps: 8 | Train Loss: 1.405 Vali Loss: 1.581 Vali Acc: 0.443 Test Loss: 1.581 Test Acc: 0.443
Validation loss decreased (-0.419831 --> -0.442732).  Saving model ...
Epoch: 3 cost time: 1.12164306640625
Epoch: 3, Steps: 8 | Train Loss: 1.241 Vali Loss: 1.487 Vali Acc: 0.450 Test Loss: 1.487 Test Acc: 0.450
Validation loss decreased (-0.442732 --> -0.450367).  Saving model ...
Epoch: 4 cost time: 1.1827027797698975
Epoch: 4, Steps: 8 | Train Loss: 0.939 Vali Loss: 1.336 Vali Acc: 0.466 Test Loss: 1.336 Test Acc: 0.466
Validation loss decreased (-0.450367 --> -0.465635).  Saving model ...
Epoch: 5 cost time: 1.3058280944824219
Epoch: 5, Steps: 8 | Train Loss: 0.598 Vali Loss: 1.388 Vali Acc: 0.527 Test Loss: 1.388 Test Acc: 0.527
Validation loss decreased (-0.465635 --> -0.526704).  Saving model ...
Epoch: 6 cost time: 1.3494298458099365
Epoch: 6, Steps: 8 | Train Loss: 0.279 Vali Loss: 1.338 Vali Acc: 0.481 Test Loss: 1.338 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.272592306137085
Epoch: 7, Steps: 8 | Train Loss: 0.101 Vali Loss: 1.479 Vali Acc: 0.573 Test Loss: 1.479 Test Acc: 0.573
Validation loss decreased (-0.526704 --> -0.572504).  Saving model ...
Epoch: 8 cost time: 1.4393632411956787
Epoch: 8, Steps: 8 | Train Loss: 0.024 Vali Loss: 1.374 Vali Acc: 0.511 Test Loss: 1.374 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.624659538269043
Epoch: 9, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.701 Vali Acc: 0.527 Test Loss: 1.701 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.7952053546905518
Epoch: 10, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.867 Vali Acc: 0.573 Test Loss: 1.867 Test Acc: 0.573
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.9809854030609131
Epoch: 11, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.641 Vali Acc: 0.542 Test Loss: 1.641 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.2227396965026855
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.654 Vali Acc: 0.573 Test Loss: 1.654 Test Acc: 0.573
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.3108727931976318
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.721 Vali Acc: 0.573 Test Loss: 1.721 Test Acc: 0.573
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.1433358192443848
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.752 Vali Acc: 0.557 Test Loss: 1.752 Test Acc: 0.557
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.222482681274414
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.763 Vali Acc: 0.557 Test Loss: 1.763 Test Acc: 0.557
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.3015496730804443
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.776 Vali Acc: 0.557 Test Loss: 1.776 Test Acc: 0.557
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.328798532485962
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.786 Vali Acc: 0.557 Test Loss: 1.786 Test Acc: 0.557
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps750_str375_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5725190839694656
model parameter : 39818501
model size : 166.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps750_str750_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.104783058166504
Epoch: 1, Steps: 8 | Train Loss: 1.554 Vali Loss: 1.629 Vali Acc: 0.420 Test Loss: 1.629 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 1.0542287826538086
Epoch: 2, Steps: 8 | Train Loss: 1.410 Vali Loss: 1.483 Vali Acc: 0.427 Test Loss: 1.483 Test Acc: 0.427
Validation loss decreased (-0.419831 --> -0.427466).  Saving model ...
Epoch: 3 cost time: 0.7614078521728516
Epoch: 3, Steps: 8 | Train Loss: 1.185 Vali Loss: 1.424 Vali Acc: 0.466 Test Loss: 1.424 Test Acc: 0.466
Validation loss decreased (-0.427466 --> -0.465635).  Saving model ...
Epoch: 4 cost time: 1.2255828380584717
Epoch: 4, Steps: 8 | Train Loss: 0.875 Vali Loss: 1.311 Vali Acc: 0.504 Test Loss: 1.311 Test Acc: 0.504
Validation loss decreased (-0.465635 --> -0.503804).  Saving model ...
Epoch: 5 cost time: 0.9720039367675781
Epoch: 5, Steps: 8 | Train Loss: 0.554 Vali Loss: 1.231 Vali Acc: 0.496 Test Loss: 1.231 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1296396255493164
Epoch: 6, Steps: 8 | Train Loss: 0.303 Vali Loss: 1.264 Vali Acc: 0.527 Test Loss: 1.264 Test Acc: 0.527
Validation loss decreased (-0.503804 --> -0.526705).  Saving model ...
Epoch: 7 cost time: 1.740307092666626
Epoch: 7, Steps: 8 | Train Loss: 0.140 Vali Loss: 1.396 Vali Acc: 0.496 Test Loss: 1.396 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5623598098754883
Epoch: 8, Steps: 8 | Train Loss: 0.049 Vali Loss: 1.510 Vali Acc: 0.557 Test Loss: 1.510 Test Acc: 0.557
Validation loss decreased (-0.526705 --> -0.557237).  Saving model ...
Epoch: 9 cost time: 1.1618647575378418
Epoch: 9, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.553 Vali Acc: 0.504 Test Loss: 1.553 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2090826034545898
Epoch: 10, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.553 Vali Acc: 0.481 Test Loss: 1.553 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.5106444358825684
Epoch: 11, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.630 Vali Acc: 0.496 Test Loss: 1.630 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.6397922039031982
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.798 Vali Acc: 0.534 Test Loss: 1.798 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.9608278274536133
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.853 Vali Acc: 0.527 Test Loss: 1.853 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.0246353149414062
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.839 Vali Acc: 0.511 Test Loss: 1.839 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.1373026371002197
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.813 Vali Acc: 0.511 Test Loss: 1.813 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.0653331279754639
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.796 Vali Acc: 0.504 Test Loss: 1.796 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.5319769382476807
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.806 Vali Acc: 0.504 Test Loss: 1.806 Test Acc: 0.504
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.5190436840057373
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.829 Vali Acc: 0.511 Test Loss: 1.829 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps750_str750_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 39694853
model size : 166.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps782_str196_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.0700786113739014
Epoch: 1, Steps: 8 | Train Loss: 1.552 Vali Loss: 1.610 Vali Acc: 0.420 Test Loss: 1.610 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 1.868079423904419
Epoch: 2, Steps: 8 | Train Loss: 1.446 Vali Loss: 1.466 Vali Acc: 0.435 Test Loss: 1.466 Test Acc: 0.435
Validation loss decreased (-0.419831 --> -0.435100).  Saving model ...
Epoch: 3 cost time: 1.493920087814331
Epoch: 3, Steps: 8 | Train Loss: 1.221 Vali Loss: 1.494 Vali Acc: 0.435 Test Loss: 1.494 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6702425479888916
Epoch: 4, Steps: 8 | Train Loss: 0.835 Vali Loss: 1.443 Vali Acc: 0.473 Test Loss: 1.443 Test Acc: 0.473
Validation loss decreased (-0.435100 --> -0.473268).  Saving model ...
Epoch: 5 cost time: 1.876633882522583
Epoch: 5, Steps: 8 | Train Loss: 0.448 Vali Loss: 1.450 Vali Acc: 0.420 Test Loss: 1.450 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8060262203216553
Epoch: 6, Steps: 8 | Train Loss: 0.158 Vali Loss: 1.608 Vali Acc: 0.504 Test Loss: 1.608 Test Acc: 0.504
Validation loss decreased (-0.473268 --> -0.503801).  Saving model ...
Epoch: 7 cost time: 1.5924656391143799
Epoch: 7, Steps: 8 | Train Loss: 0.030 Vali Loss: 1.780 Vali Acc: 0.527 Test Loss: 1.780 Test Acc: 0.527
Validation loss decreased (-0.503801 --> -0.526700).  Saving model ...
Epoch: 8 cost time: 1.5898051261901855
Epoch: 8, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.569 Vali Acc: 0.450 Test Loss: 1.569 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.522730827331543
Epoch: 9, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.678 Vali Acc: 0.496 Test Loss: 1.678 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.6138741970062256
Epoch: 10, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.678 Vali Acc: 0.496 Test Loss: 1.678 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.8127400875091553
Epoch: 11, Steps: 8 | Train Loss: 0.009 Vali Loss: 2.160 Vali Acc: 0.481 Test Loss: 2.160 Test Acc: 0.481
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.4594247341156006
Epoch: 12, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.722 Vali Acc: 0.534 Test Loss: 1.722 Test Acc: 0.534
Validation loss decreased (-0.526700 --> -0.534334).  Saving model ...
Epoch: 13 cost time: 1.6711561679840088
Epoch: 13, Steps: 8 | Train Loss: 0.006 Vali Loss: 2.118 Vali Acc: 0.489 Test Loss: 2.118 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4312846660614014
Epoch: 14, Steps: 8 | Train Loss: 0.007 Vali Loss: 2.382 Vali Acc: 0.473 Test Loss: 2.382 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.4634690284729004
Epoch: 15, Steps: 8 | Train Loss: 0.021 Vali Loss: 2.390 Vali Acc: 0.504 Test Loss: 2.390 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.5698049068450928
Epoch: 16, Steps: 8 | Train Loss: 0.017 Vali Loss: 2.742 Vali Acc: 0.458 Test Loss: 2.742 Test Acc: 0.458
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.5209579467773438
Epoch: 17, Steps: 8 | Train Loss: 0.015 Vali Loss: 2.416 Vali Acc: 0.481 Test Loss: 2.416 Test Acc: 0.481
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.7181167602539062
Epoch: 18, Steps: 8 | Train Loss: 0.005 Vali Loss: 2.565 Vali Acc: 0.504 Test Loss: 2.565 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.9474289417266846
Epoch: 19, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.890 Vali Acc: 0.466 Test Loss: 2.890 Test Acc: 0.466
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.022357225418091
Epoch: 20, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.694 Vali Acc: 0.489 Test Loss: 2.694 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.207937240600586
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.438 Vali Acc: 0.527 Test Loss: 2.438 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.1129143238067627
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.363 Vali Acc: 0.496 Test Loss: 2.363 Test Acc: 0.496
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps782_str196_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 40486661
model size : 169.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps782_str391_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.029885768890381
Epoch: 1, Steps: 8 | Train Loss: 1.547 Vali Loss: 1.644 Vali Acc: 0.435 Test Loss: 1.644 Test Acc: 0.435
Validation loss decreased (inf --> -0.435098).  Saving model ...
Epoch: 2 cost time: 1.4513506889343262
Epoch: 2, Steps: 8 | Train Loss: 1.384 Vali Loss: 1.547 Vali Acc: 0.420 Test Loss: 1.547 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3732635974884033
Epoch: 3, Steps: 8 | Train Loss: 1.219 Vali Loss: 1.512 Vali Acc: 0.450 Test Loss: 1.512 Test Acc: 0.450
Validation loss decreased (-0.435098 --> -0.450367).  Saving model ...
Epoch: 4 cost time: 1.4139878749847412
Epoch: 4, Steps: 8 | Train Loss: 0.972 Vali Loss: 1.559 Vali Acc: 0.435 Test Loss: 1.559 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3332908153533936
Epoch: 5, Steps: 8 | Train Loss: 0.583 Vali Loss: 1.369 Vali Acc: 0.511 Test Loss: 1.369 Test Acc: 0.511
Validation loss decreased (-0.450367 --> -0.511437).  Saving model ...
Epoch: 6 cost time: 1.4858241081237793
Epoch: 6, Steps: 8 | Train Loss: 0.239 Vali Loss: 1.391 Vali Acc: 0.420 Test Loss: 1.391 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7380833625793457
Epoch: 7, Steps: 8 | Train Loss: 0.073 Vali Loss: 1.639 Vali Acc: 0.496 Test Loss: 1.639 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.7098307609558105
Epoch: 8, Steps: 8 | Train Loss: 0.018 Vali Loss: 1.692 Vali Acc: 0.473 Test Loss: 1.692 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.3440463542938232
Epoch: 9, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.886 Vali Acc: 0.504 Test Loss: 1.886 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.2296674251556396
Epoch: 10, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.663 Vali Acc: 0.534 Test Loss: 1.663 Test Acc: 0.534
Validation loss decreased (-0.511437 --> -0.534335).  Saving model ...
Epoch: 11 cost time: 1.124983787536621
Epoch: 11, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.629 Vali Acc: 0.527 Test Loss: 1.629 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9410045146942139
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.215 Vali Acc: 0.534 Test Loss: 2.215 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1297824382781982
Epoch: 13, Steps: 8 | Train Loss: 0.002 Vali Loss: 2.157 Vali Acc: 0.534 Test Loss: 2.157 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.2433664798736572
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.937 Vali Acc: 0.489 Test Loss: 1.937 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.2861721515655518
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.888 Vali Acc: 0.489 Test Loss: 1.888 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.2003450393676758
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.982 Vali Acc: 0.504 Test Loss: 1.982 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.527996301651001
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.082 Vali Acc: 0.527 Test Loss: 2.082 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.2336699962615967
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.142 Vali Acc: 0.519 Test Loss: 2.142 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.3239288330078125
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.190 Vali Acc: 0.504 Test Loss: 2.190 Test Acc: 0.504
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.2019686698913574
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.153 Vali Acc: 0.519 Test Loss: 2.153 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps782_str391_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 40250117
model size : 168.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps782_str782_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.6287033557891846
Epoch: 1, Steps: 8 | Train Loss: 1.533 Vali Loss: 1.594 Vali Acc: 0.420 Test Loss: 1.594 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 1.660017728805542
Epoch: 2, Steps: 8 | Train Loss: 1.415 Vali Loss: 1.514 Vali Acc: 0.420 Test Loss: 1.514 Test Acc: 0.420
Validation loss decreased (-0.419831 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 0.9104471206665039
Epoch: 3, Steps: 8 | Train Loss: 1.220 Vali Loss: 1.479 Vali Acc: 0.481 Test Loss: 1.479 Test Acc: 0.481
Validation loss decreased (-0.419832 --> -0.480901).  Saving model ...
Epoch: 4 cost time: 1.1426348686218262
Epoch: 4, Steps: 8 | Train Loss: 0.940 Vali Loss: 1.483 Vali Acc: 0.450 Test Loss: 1.483 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3027362823486328
Epoch: 5, Steps: 8 | Train Loss: 0.648 Vali Loss: 1.399 Vali Acc: 0.466 Test Loss: 1.399 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.3254828453063965
Epoch: 6, Steps: 8 | Train Loss: 0.346 Vali Loss: 1.329 Vali Acc: 0.489 Test Loss: 1.329 Test Acc: 0.489
Validation loss decreased (-0.480901 --> -0.488536).  Saving model ...
Epoch: 7 cost time: 1.3331618309020996
Epoch: 7, Steps: 8 | Train Loss: 0.141 Vali Loss: 1.326 Vali Acc: 0.534 Test Loss: 1.326 Test Acc: 0.534
Validation loss decreased (-0.488536 --> -0.534338).  Saving model ...
Epoch: 8 cost time: 1.3622114658355713
Epoch: 8, Steps: 8 | Train Loss: 0.058 Vali Loss: 1.560 Vali Acc: 0.534 Test Loss: 1.560 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.117173433303833
Epoch: 9, Steps: 8 | Train Loss: 0.021 Vali Loss: 1.642 Vali Acc: 0.542 Test Loss: 1.642 Test Acc: 0.542
Validation loss decreased (-0.534338 --> -0.541968).  Saving model ...
Epoch: 10 cost time: 1.0660765171051025
Epoch: 10, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.576 Vali Acc: 0.534 Test Loss: 1.576 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1669337749481201
Epoch: 11, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.631 Vali Acc: 0.511 Test Loss: 1.631 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1728911399841309
Epoch: 12, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.683 Vali Acc: 0.542 Test Loss: 1.683 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.2233359813690186
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.697 Vali Acc: 0.542 Test Loss: 1.697 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.1291375160217285
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.690 Vali Acc: 0.542 Test Loss: 1.690 Test Acc: 0.542
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.1723744869232178
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.688 Vali Acc: 0.534 Test Loss: 1.688 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.3073735237121582
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.693 Vali Acc: 0.534 Test Loss: 1.693 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.6499156951904297
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.693 Vali Acc: 0.534 Test Loss: 1.693 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.625389575958252
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.704 Vali Acc: 0.542 Test Loss: 1.704 Test Acc: 0.542
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.2340152263641357
Epoch: 19, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.718 Vali Acc: 0.534 Test Loss: 1.718 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps782_str782_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 40131845
model size : 167.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps818_str205_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.2387588024139404
Epoch: 1, Steps: 8 | Train Loss: 1.564 Vali Loss: 1.594 Vali Acc: 0.420 Test Loss: 1.594 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 1.3369624614715576
Epoch: 2, Steps: 8 | Train Loss: 1.443 Vali Loss: 1.545 Vali Acc: 0.412 Test Loss: 1.545 Test Acc: 0.412
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.383467674255371
Epoch: 3, Steps: 8 | Train Loss: 1.123 Vali Loss: 1.448 Vali Acc: 0.420 Test Loss: 1.448 Test Acc: 0.420
Validation loss decreased (-0.419831 --> -0.419833).  Saving model ...
Epoch: 4 cost time: 1.2258992195129395
Epoch: 4, Steps: 8 | Train Loss: 0.746 Vali Loss: 1.418 Vali Acc: 0.435 Test Loss: 1.418 Test Acc: 0.435
Validation loss decreased (-0.419833 --> -0.435100).  Saving model ...
Epoch: 5 cost time: 1.4269068241119385
Epoch: 5, Steps: 8 | Train Loss: 0.368 Vali Loss: 1.310 Vali Acc: 0.405 Test Loss: 1.310 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.4042658805847168
Epoch: 6, Steps: 8 | Train Loss: 0.127 Vali Loss: 1.419 Vali Acc: 0.519 Test Loss: 1.419 Test Acc: 0.519
Validation loss decreased (-0.435100 --> -0.519070).  Saving model ...
Epoch: 7 cost time: 1.511216640472412
Epoch: 7, Steps: 8 | Train Loss: 0.037 Vali Loss: 1.654 Vali Acc: 0.519 Test Loss: 1.654 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3768787384033203
Epoch: 8, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.625 Vali Acc: 0.458 Test Loss: 1.625 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.9103670120239258
Epoch: 9, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.787 Vali Acc: 0.557 Test Loss: 1.787 Test Acc: 0.557
Validation loss decreased (-0.519070 --> -0.557234).  Saving model ...
Epoch: 10 cost time: 1.4953279495239258
Epoch: 10, Steps: 8 | Train Loss: 0.007 Vali Loss: 2.672 Vali Acc: 0.412 Test Loss: 2.672 Test Acc: 0.412
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5628275871276855
Epoch: 11, Steps: 8 | Train Loss: 0.053 Vali Loss: 2.238 Vali Acc: 0.489 Test Loss: 2.238 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.5480401515960693
Epoch: 12, Steps: 8 | Train Loss: 0.006 Vali Loss: 2.372 Vali Acc: 0.412 Test Loss: 2.372 Test Acc: 0.412
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.5441622734069824
Epoch: 13, Steps: 8 | Train Loss: 0.004 Vali Loss: 2.226 Vali Acc: 0.458 Test Loss: 2.226 Test Acc: 0.458
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.5028703212738037
Epoch: 14, Steps: 8 | Train Loss: 0.011 Vali Loss: 2.134 Vali Acc: 0.511 Test Loss: 2.134 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.487527847290039
Epoch: 15, Steps: 8 | Train Loss: 0.004 Vali Loss: 2.209 Vali Acc: 0.550 Test Loss: 2.209 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.5052907466888428
Epoch: 16, Steps: 8 | Train Loss: 0.021 Vali Loss: 2.272 Vali Acc: 0.534 Test Loss: 2.272 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.4633698463439941
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.492 Vali Acc: 0.481 Test Loss: 2.492 Test Acc: 0.481
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.4440221786499023
Epoch: 18, Steps: 8 | Train Loss: 0.002 Vali Loss: 2.310 Vali Acc: 0.511 Test Loss: 2.310 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.4250681400299072
Epoch: 19, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.463 Vali Acc: 0.534 Test Loss: 2.463 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps818_str205_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 40962821
model size : 170.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps818_str409_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.603586435317993
Epoch: 1, Steps: 8 | Train Loss: 1.518 Vali Loss: 1.590 Vali Acc: 0.420 Test Loss: 1.590 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 1.1754233837127686
Epoch: 2, Steps: 8 | Train Loss: 1.404 Vali Loss: 1.527 Vali Acc: 0.458 Test Loss: 1.527 Test Acc: 0.458
Validation loss decreased (-0.419831 --> -0.458000).  Saving model ...
Epoch: 3 cost time: 1.4424958229064941
Epoch: 3, Steps: 8 | Train Loss: 1.139 Vali Loss: 1.369 Vali Acc: 0.496 Test Loss: 1.369 Test Acc: 0.496
Validation loss decreased (-0.458000 --> -0.496170).  Saving model ...
Epoch: 4 cost time: 1.1770002841949463
Epoch: 4, Steps: 8 | Train Loss: 0.803 Vali Loss: 1.281 Vali Acc: 0.542 Test Loss: 1.281 Test Acc: 0.542
Validation loss decreased (-0.496170 --> -0.541972).  Saving model ...
Epoch: 5 cost time: 1.482780933380127
Epoch: 5, Steps: 8 | Train Loss: 0.439 Vali Loss: 1.295 Vali Acc: 0.504 Test Loss: 1.295 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1786274909973145
Epoch: 6, Steps: 8 | Train Loss: 0.221 Vali Loss: 1.209 Vali Acc: 0.519 Test Loss: 1.209 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.4082000255584717
Epoch: 7, Steps: 8 | Train Loss: 0.087 Vali Loss: 1.252 Vali Acc: 0.573 Test Loss: 1.252 Test Acc: 0.573
Validation loss decreased (-0.541972 --> -0.572507).  Saving model ...
Epoch: 8 cost time: 1.0933561325073242
Epoch: 8, Steps: 8 | Train Loss: 0.029 Vali Loss: 1.351 Vali Acc: 0.550 Test Loss: 1.351 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4423532485961914
Epoch: 9, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.208 Vali Acc: 0.550 Test Loss: 1.208 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.1175463199615479
Epoch: 10, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.358 Vali Acc: 0.511 Test Loss: 1.358 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.102076530456543
Epoch: 11, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.457 Vali Acc: 0.557 Test Loss: 1.457 Test Acc: 0.557
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.9445850849151611
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.466 Vali Acc: 0.580 Test Loss: 1.466 Test Acc: 0.580
Validation loss decreased (-0.572507 --> -0.580138).  Saving model ...
Epoch: 13 cost time: 1.4599215984344482
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.450 Vali Acc: 0.595 Test Loss: 1.450 Test Acc: 0.595
Validation loss decreased (-0.580138 --> -0.595405).  Saving model ...
Epoch: 14 cost time: 1.3161771297454834
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.437 Vali Acc: 0.580 Test Loss: 1.437 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2606699466705322
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.431 Vali Acc: 0.573 Test Loss: 1.431 Test Acc: 0.573
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.902083158493042
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.449 Vali Acc: 0.580 Test Loss: 1.449 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.9903428554534912
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.479 Vali Acc: 0.565 Test Loss: 1.479 Test Acc: 0.565
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.2608206272125244
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.508 Vali Acc: 0.565 Test Loss: 1.508 Test Acc: 0.565
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.2311909198760986
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.525 Vali Acc: 0.573 Test Loss: 1.525 Test Acc: 0.573
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.4128608703613281
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.527 Vali Acc: 0.580 Test Loss: 1.527 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.262911081314087
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.526 Vali Acc: 0.573 Test Loss: 1.526 Test Acc: 0.573
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.1417560577392578
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.535 Vali Acc: 0.580 Test Loss: 1.535 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.593534231185913
Epoch: 23, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.535 Vali Acc: 0.580 Test Loss: 1.535 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps818_str409_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5954198473282443
model parameter : 40737029
model size : 170.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps818_str818_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.779026746749878
Epoch: 1, Steps: 8 | Train Loss: 1.524 Vali Loss: 1.512 Vali Acc: 0.420 Test Loss: 1.512 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 0.9294366836547852
Epoch: 2, Steps: 8 | Train Loss: 1.403 Vali Loss: 1.538 Vali Acc: 0.450 Test Loss: 1.538 Test Acc: 0.450
Validation loss decreased (-0.419832 --> -0.450366).  Saving model ...
Epoch: 3 cost time: 1.1778838634490967
Epoch: 3, Steps: 8 | Train Loss: 1.182 Vali Loss: 1.408 Vali Acc: 0.489 Test Loss: 1.408 Test Acc: 0.489
Validation loss decreased (-0.450366 --> -0.488536).  Saving model ...
Epoch: 4 cost time: 0.9433116912841797
Epoch: 4, Steps: 8 | Train Loss: 0.873 Vali Loss: 1.277 Vali Acc: 0.542 Test Loss: 1.277 Test Acc: 0.542
Validation loss decreased (-0.488536 --> -0.541972).  Saving model ...
Epoch: 5 cost time: 1.0589652061462402
Epoch: 5, Steps: 8 | Train Loss: 0.551 Vali Loss: 1.246 Vali Acc: 0.511 Test Loss: 1.246 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6209981441497803
Epoch: 6, Steps: 8 | Train Loss: 0.291 Vali Loss: 1.195 Vali Acc: 0.565 Test Loss: 1.195 Test Acc: 0.565
Validation loss decreased (-0.541972 --> -0.564874).  Saving model ...
Epoch: 7 cost time: 1.0426573753356934
Epoch: 7, Steps: 8 | Train Loss: 0.140 Vali Loss: 1.172 Vali Acc: 0.542 Test Loss: 1.172 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.12825608253479
Epoch: 8, Steps: 8 | Train Loss: 0.047 Vali Loss: 1.283 Vali Acc: 0.603 Test Loss: 1.283 Test Acc: 0.603
Validation loss decreased (-0.564874 --> -0.603041).  Saving model ...
Epoch: 9 cost time: 1.213043451309204
Epoch: 9, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.284 Vali Acc: 0.573 Test Loss: 1.284 Test Acc: 0.573
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0327303409576416
Epoch: 10, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.309 Vali Acc: 0.534 Test Loss: 1.309 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.4110984802246094
Epoch: 11, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.378 Vali Acc: 0.557 Test Loss: 1.378 Test Acc: 0.557
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.5963859558105469
Epoch: 12, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.378 Vali Acc: 0.542 Test Loss: 1.378 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.0199306011199951
Epoch: 13, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.368 Vali Acc: 0.542 Test Loss: 1.368 Test Acc: 0.542
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.0945703983306885
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.367 Vali Acc: 0.534 Test Loss: 1.367 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.5597963333129883
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.376 Vali Acc: 0.534 Test Loss: 1.376 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.0397276878356934
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.396 Vali Acc: 0.534 Test Loss: 1.396 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.987586498260498
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.410 Vali Acc: 0.534 Test Loss: 1.410 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.9762473106384277
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.417 Vali Acc: 0.534 Test Loss: 1.417 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps818_str818_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6030534351145038
model parameter : 40624133
model size : 169.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps857_str215_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.5922791957855225
Epoch: 1, Steps: 8 | Train Loss: 1.555 Vali Loss: 1.722 Vali Acc: 0.420 Test Loss: 1.722 Test Acc: 0.420
Validation loss decreased (inf --> -0.419830).  Saving model ...
Epoch: 2 cost time: 2.125880241394043
Epoch: 2, Steps: 8 | Train Loss: 1.477 Vali Loss: 1.651 Vali Acc: 0.244 Test Loss: 1.651 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9567530155181885
Epoch: 3, Steps: 8 | Train Loss: 1.213 Vali Loss: 1.547 Vali Acc: 0.427 Test Loss: 1.547 Test Acc: 0.427
Validation loss decreased (-0.419830 --> -0.427465).  Saving model ...
Epoch: 4 cost time: 1.4384124279022217
Epoch: 4, Steps: 8 | Train Loss: 0.892 Vali Loss: 1.382 Vali Acc: 0.481 Test Loss: 1.382 Test Acc: 0.481
Validation loss decreased (-0.427465 --> -0.480902).  Saving model ...
Epoch: 5 cost time: 1.3919432163238525
Epoch: 5, Steps: 8 | Train Loss: 0.603 Vali Loss: 1.486 Vali Acc: 0.450 Test Loss: 1.486 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.452472448348999
Epoch: 6, Steps: 8 | Train Loss: 0.250 Vali Loss: 1.514 Vali Acc: 0.481 Test Loss: 1.514 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.4269649982452393
Epoch: 7, Steps: 8 | Train Loss: 0.071 Vali Loss: 1.541 Vali Acc: 0.527 Test Loss: 1.541 Test Acc: 0.527
Validation loss decreased (-0.480902 --> -0.526702).  Saving model ...
Epoch: 8 cost time: 1.3505399227142334
Epoch: 8, Steps: 8 | Train Loss: 0.019 Vali Loss: 1.669 Vali Acc: 0.511 Test Loss: 1.669 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.482609748840332
Epoch: 9, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.997 Vali Acc: 0.542 Test Loss: 1.997 Test Acc: 0.542
Validation loss decreased (-0.526702 --> -0.541965).  Saving model ...
Epoch: 10 cost time: 1.4990015029907227
Epoch: 10, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.605 Vali Acc: 0.542 Test Loss: 1.605 Test Acc: 0.542
Validation loss decreased (-0.541965 --> -0.541969).  Saving model ...
Epoch: 11 cost time: 1.2550275325775146
Epoch: 11, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.627 Vali Acc: 0.557 Test Loss: 1.627 Test Acc: 0.557
Validation loss decreased (-0.541969 --> -0.557236).  Saving model ...
Epoch: 12 cost time: 1.673426866531372
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.815 Vali Acc: 0.565 Test Loss: 1.815 Test Acc: 0.565
Validation loss decreased (-0.557236 --> -0.564867).  Saving model ...
Epoch: 13 cost time: 1.257427453994751
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.799 Vali Acc: 0.573 Test Loss: 1.799 Test Acc: 0.573
Validation loss decreased (-0.564867 --> -0.572501).  Saving model ...
Epoch: 14 cost time: 1.2244088649749756
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.743 Vali Acc: 0.557 Test Loss: 1.743 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.7493712902069092
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.717 Vali Acc: 0.550 Test Loss: 1.717 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.2497084140777588
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.689 Vali Acc: 0.542 Test Loss: 1.689 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.3824245929718018
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.701 Vali Acc: 0.565 Test Loss: 1.701 Test Acc: 0.565
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.3817903995513916
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.731 Vali Acc: 0.565 Test Loss: 1.731 Test Acc: 0.565
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.2085106372833252
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.760 Vali Acc: 0.565 Test Loss: 1.760 Test Acc: 0.565
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.6882483959197998
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.788 Vali Acc: 0.565 Test Loss: 1.788 Test Acc: 0.565
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.7420496940612793
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.800 Vali Acc: 0.565 Test Loss: 1.800 Test Acc: 0.565
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.4893558025360107
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.802 Vali Acc: 0.565 Test Loss: 1.802 Test Acc: 0.565
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.4917035102844238
Epoch: 23, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.806 Vali Acc: 0.565 Test Loss: 1.806 Test Acc: 0.565
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps857_str215_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5725190839694656
model parameter : 41480453
model size : 172.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps857_str429_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.629303216934204
Epoch: 1, Steps: 8 | Train Loss: 1.656 Vali Loss: 1.619 Vali Acc: 0.420 Test Loss: 1.619 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 1.621107578277588
Epoch: 2, Steps: 8 | Train Loss: 1.424 Vali Loss: 1.579 Vali Acc: 0.420 Test Loss: 1.579 Test Acc: 0.420
Validation loss decreased (-0.419831 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 1.624664068222046
Epoch: 3, Steps: 8 | Train Loss: 1.153 Vali Loss: 1.532 Vali Acc: 0.443 Test Loss: 1.532 Test Acc: 0.443
Validation loss decreased (-0.419832 --> -0.442733).  Saving model ...
Epoch: 4 cost time: 1.2167365550994873
Epoch: 4, Steps: 8 | Train Loss: 0.889 Vali Loss: 1.387 Vali Acc: 0.489 Test Loss: 1.387 Test Acc: 0.489
Validation loss decreased (-0.442733 --> -0.488536).  Saving model ...
Epoch: 5 cost time: 1.163743495941162
Epoch: 5, Steps: 8 | Train Loss: 0.584 Vali Loss: 1.406 Vali Acc: 0.511 Test Loss: 1.406 Test Acc: 0.511
Validation loss decreased (-0.488536 --> -0.511436).  Saving model ...
Epoch: 6 cost time: 1.034693717956543
Epoch: 6, Steps: 8 | Train Loss: 0.288 Vali Loss: 1.267 Vali Acc: 0.504 Test Loss: 1.267 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2143406867980957
Epoch: 7, Steps: 8 | Train Loss: 0.108 Vali Loss: 1.327 Vali Acc: 0.573 Test Loss: 1.327 Test Acc: 0.573
Validation loss decreased (-0.511436 --> -0.572506).  Saving model ...
Epoch: 8 cost time: 1.0894172191619873
Epoch: 8, Steps: 8 | Train Loss: 0.027 Vali Loss: 1.455 Vali Acc: 0.542 Test Loss: 1.455 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.127234697341919
Epoch: 9, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.480 Vali Acc: 0.573 Test Loss: 1.480 Test Acc: 0.573
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8417062759399414
Epoch: 10, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.531 Vali Acc: 0.557 Test Loss: 1.531 Test Acc: 0.557
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.0617337226867676
Epoch: 11, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.626 Vali Acc: 0.557 Test Loss: 1.626 Test Acc: 0.557
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.3438005447387695
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.658 Vali Acc: 0.557 Test Loss: 1.658 Test Acc: 0.557
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.5030744075775146
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.612 Vali Acc: 0.580 Test Loss: 1.612 Test Acc: 0.580
Validation loss decreased (-0.572506 --> -0.580137).  Saving model ...
Epoch: 14 cost time: 1.3791451454162598
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.606 Vali Acc: 0.588 Test Loss: 1.606 Test Acc: 0.588
Validation loss decreased (-0.580137 --> -0.587770).  Saving model ...
Epoch: 15 cost time: 1.483832597732544
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.614 Vali Acc: 0.573 Test Loss: 1.614 Test Acc: 0.573
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.373396396636963
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.629 Vali Acc: 0.565 Test Loss: 1.629 Test Acc: 0.565
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.2222323417663574
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.651 Vali Acc: 0.565 Test Loss: 1.651 Test Acc: 0.565
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.2351934909820557
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.665 Vali Acc: 0.557 Test Loss: 1.665 Test Acc: 0.557
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.3530569076538086
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.669 Vali Acc: 0.557 Test Loss: 1.669 Test Acc: 0.557
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.4138925075531006
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.678 Vali Acc: 0.557 Test Loss: 1.678 Test Acc: 0.557
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.9575278759002686
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.680 Vali Acc: 0.557 Test Loss: 1.680 Test Acc: 0.557
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.081049919128418
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.685 Vali Acc: 0.557 Test Loss: 1.685 Test Acc: 0.557
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.1871027946472168
Epoch: 23, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.689 Vali Acc: 0.565 Test Loss: 1.689 Test Acc: 0.565
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.146653652191162
Epoch: 24, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.699 Vali Acc: 0.565 Test Loss: 1.699 Test Acc: 0.565
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps857_str429_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5877862595419847
model parameter : 41265413
model size : 172.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps857_str857_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.4583728313446045
Epoch: 1, Steps: 8 | Train Loss: 1.556 Vali Loss: 1.580 Vali Acc: 0.420 Test Loss: 1.580 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 1.0196988582611084
Epoch: 2, Steps: 8 | Train Loss: 1.413 Vali Loss: 1.497 Vali Acc: 0.427 Test Loss: 1.497 Test Acc: 0.427
Validation loss decreased (-0.419832 --> -0.427466).  Saving model ...
Epoch: 3 cost time: 1.3259384632110596
Epoch: 3, Steps: 8 | Train Loss: 1.141 Vali Loss: 1.430 Vali Acc: 0.466 Test Loss: 1.430 Test Acc: 0.466
Validation loss decreased (-0.427466 --> -0.465635).  Saving model ...
Epoch: 4 cost time: 0.9703176021575928
Epoch: 4, Steps: 8 | Train Loss: 0.878 Vali Loss: 1.366 Vali Acc: 0.504 Test Loss: 1.366 Test Acc: 0.504
Validation loss decreased (-0.465635 --> -0.503803).  Saving model ...
Epoch: 5 cost time: 1.0026981830596924
Epoch: 5, Steps: 8 | Train Loss: 0.598 Vali Loss: 1.354 Vali Acc: 0.511 Test Loss: 1.354 Test Acc: 0.511
Validation loss decreased (-0.503803 --> -0.511437).  Saving model ...
Epoch: 6 cost time: 1.1499600410461426
Epoch: 6, Steps: 8 | Train Loss: 0.313 Vali Loss: 1.341 Vali Acc: 0.511 Test Loss: 1.341 Test Acc: 0.511
Validation loss decreased (-0.511437 --> -0.511437).  Saving model ...
Epoch: 7 cost time: 1.1526951789855957
Epoch: 7, Steps: 8 | Train Loss: 0.119 Vali Loss: 1.423 Vali Acc: 0.519 Test Loss: 1.423 Test Acc: 0.519
Validation loss decreased (-0.511437 --> -0.519070).  Saving model ...
Epoch: 8 cost time: 1.2218725681304932
Epoch: 8, Steps: 8 | Train Loss: 0.033 Vali Loss: 1.464 Vali Acc: 0.481 Test Loss: 1.464 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0510225296020508
Epoch: 9, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.511 Vali Acc: 0.489 Test Loss: 1.511 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.838435173034668
Epoch: 10, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.563 Vali Acc: 0.496 Test Loss: 1.563 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.155134916305542
Epoch: 11, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.508 Vali Acc: 0.496 Test Loss: 1.508 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.1951873302459717
Epoch: 12, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.500 Vali Acc: 0.504 Test Loss: 1.500 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.178363561630249
Epoch: 13, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.526 Vali Acc: 0.504 Test Loss: 1.526 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.1473374366760254
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.566 Vali Acc: 0.511 Test Loss: 1.566 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.322941780090332
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.579 Vali Acc: 0.511 Test Loss: 1.579 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.4670264720916748
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.593 Vali Acc: 0.511 Test Loss: 1.593 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.1261348724365234
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.599 Vali Acc: 0.511 Test Loss: 1.599 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps857_str857_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 41157893
model size : 171.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps900_str225_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.5753390789031982
Epoch: 1, Steps: 8 | Train Loss: 1.656 Vali Loss: 1.762 Vali Acc: 0.420 Test Loss: 1.762 Test Acc: 0.420
Validation loss decreased (inf --> -0.419830).  Saving model ...
Epoch: 2 cost time: 1.3564274311065674
Epoch: 2, Steps: 8 | Train Loss: 1.466 Vali Loss: 1.506 Vali Acc: 0.443 Test Loss: 1.506 Test Acc: 0.443
Validation loss decreased (-0.419830 --> -0.442733).  Saving model ...
Epoch: 3 cost time: 1.3924403190612793
Epoch: 3, Steps: 8 | Train Loss: 1.153 Vali Loss: 1.475 Vali Acc: 0.473 Test Loss: 1.475 Test Acc: 0.473
Validation loss decreased (-0.442733 --> -0.473268).  Saving model ...
Epoch: 4 cost time: 1.1449308395385742
Epoch: 4, Steps: 8 | Train Loss: 0.717 Vali Loss: 1.390 Vali Acc: 0.496 Test Loss: 1.390 Test Acc: 0.496
Validation loss decreased (-0.473268 --> -0.496169).  Saving model ...
Epoch: 5 cost time: 1.2691125869750977
Epoch: 5, Steps: 8 | Train Loss: 0.340 Vali Loss: 1.321 Vali Acc: 0.466 Test Loss: 1.321 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2597806453704834
Epoch: 6, Steps: 8 | Train Loss: 0.118 Vali Loss: 1.408 Vali Acc: 0.527 Test Loss: 1.408 Test Acc: 0.527
Validation loss decreased (-0.496169 --> -0.526703).  Saving model ...
Epoch: 7 cost time: 1.2642652988433838
Epoch: 7, Steps: 8 | Train Loss: 0.023 Vali Loss: 1.960 Vali Acc: 0.542 Test Loss: 1.960 Test Acc: 0.542
Validation loss decreased (-0.526703 --> -0.541965).  Saving model ...
Epoch: 8 cost time: 1.1950836181640625
Epoch: 8, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.568 Vali Acc: 0.489 Test Loss: 1.568 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3592901229858398
Epoch: 9, Steps: 8 | Train Loss: 0.019 Vali Loss: 2.657 Vali Acc: 0.504 Test Loss: 2.657 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.308056116104126
Epoch: 10, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.819 Vali Acc: 0.496 Test Loss: 1.819 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.2289402484893799
Epoch: 11, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.898 Vali Acc: 0.565 Test Loss: 1.898 Test Acc: 0.565
Validation loss decreased (-0.541965 --> -0.564867).  Saving model ...
Epoch: 12 cost time: 1.2565689086914062
Epoch: 12, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.988 Vali Acc: 0.573 Test Loss: 1.988 Test Acc: 0.573
Validation loss decreased (-0.564867 --> -0.572499).  Saving model ...
Epoch: 13 cost time: 1.9553265571594238
Epoch: 13, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.825 Vali Acc: 0.565 Test Loss: 1.825 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4244585037231445
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.137 Vali Acc: 0.557 Test Loss: 2.137 Test Acc: 0.557
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.320831298828125
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.940 Vali Acc: 0.519 Test Loss: 1.940 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.165229320526123
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.841 Vali Acc: 0.550 Test Loss: 1.841 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.4457180500030518
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.829 Vali Acc: 0.573 Test Loss: 1.829 Test Acc: 0.573
Validation loss decreased (-0.572499 --> -0.572501).  Saving model ...
Epoch: 18 cost time: 1.2255799770355225
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.851 Vali Acc: 0.573 Test Loss: 1.851 Test Acc: 0.573
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2840051651000977
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.879 Vali Acc: 0.565 Test Loss: 1.879 Test Acc: 0.565
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.1986782550811768
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.906 Vali Acc: 0.557 Test Loss: 1.906 Test Acc: 0.557
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.109999656677246
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.927 Vali Acc: 0.557 Test Loss: 1.927 Test Acc: 0.557
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.8825311660766602
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.939 Vali Acc: 0.557 Test Loss: 1.939 Test Acc: 0.557
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.2894914150238037
Epoch: 23, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.951 Vali Acc: 0.557 Test Loss: 1.951 Test Acc: 0.557
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.4012067317962646
Epoch: 24, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.967 Vali Acc: 0.565 Test Loss: 1.967 Test Acc: 0.565
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.3121438026428223
Epoch: 25, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.976 Vali Acc: 0.557 Test Loss: 1.976 Test Acc: 0.557
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.2537126541137695
Epoch: 26, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.980 Vali Acc: 0.565 Test Loss: 1.980 Test Acc: 0.565
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.710641860961914
Epoch: 27, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.987 Vali Acc: 0.565 Test Loss: 1.987 Test Acc: 0.565
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps900_str225_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5725190839694656
model parameter : 42053381
model size : 175.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps900_str450_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.8157286643981934
Epoch: 1, Steps: 8 | Train Loss: 1.535 Vali Loss: 1.687 Vali Acc: 0.420 Test Loss: 1.687 Test Acc: 0.420
Validation loss decreased (inf --> -0.419830).  Saving model ...
Epoch: 2 cost time: 1.2223548889160156
Epoch: 2, Steps: 8 | Train Loss: 1.388 Vali Loss: 1.495 Vali Acc: 0.420 Test Loss: 1.495 Test Acc: 0.420
Validation loss decreased (-0.419830 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 1.1893858909606934
Epoch: 3, Steps: 8 | Train Loss: 1.142 Vali Loss: 1.452 Vali Acc: 0.489 Test Loss: 1.452 Test Acc: 0.489
Validation loss decreased (-0.419832 --> -0.488535).  Saving model ...
Epoch: 4 cost time: 1.1557183265686035
Epoch: 4, Steps: 8 | Train Loss: 0.785 Vali Loss: 1.388 Vali Acc: 0.496 Test Loss: 1.388 Test Acc: 0.496
Validation loss decreased (-0.488535 --> -0.496169).  Saving model ...
Epoch: 5 cost time: 1.0900659561157227
Epoch: 5, Steps: 8 | Train Loss: 0.401 Vali Loss: 1.419 Vali Acc: 0.489 Test Loss: 1.419 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.312737226486206
Epoch: 6, Steps: 8 | Train Loss: 0.183 Vali Loss: 1.454 Vali Acc: 0.511 Test Loss: 1.454 Test Acc: 0.511
Validation loss decreased (-0.496169 --> -0.511436).  Saving model ...
Epoch: 7 cost time: 1.0038988590240479
Epoch: 7, Steps: 8 | Train Loss: 0.054 Vali Loss: 1.595 Vali Acc: 0.527 Test Loss: 1.595 Test Acc: 0.527
Validation loss decreased (-0.511436 --> -0.526702).  Saving model ...
Epoch: 8 cost time: 1.8536217212677002
Epoch: 8, Steps: 8 | Train Loss: 0.024 Vali Loss: 1.417 Vali Acc: 0.511 Test Loss: 1.417 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.396009922027588
Epoch: 9, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.480 Vali Acc: 0.496 Test Loss: 1.480 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.5871942043304443
Epoch: 10, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.799 Vali Acc: 0.527 Test Loss: 1.799 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.7858381271362305
Epoch: 11, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.735 Vali Acc: 0.527 Test Loss: 1.735 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.498417854309082
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.591 Vali Acc: 0.527 Test Loss: 1.591 Test Acc: 0.527
Validation loss decreased (-0.526702 --> -0.526702).  Saving model ...
Epoch: 13 cost time: 1.844763994216919
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.547 Vali Acc: 0.527 Test Loss: 1.547 Test Acc: 0.527
Validation loss decreased (-0.526702 --> -0.526702).  Saving model ...
Epoch: 14 cost time: 1.9040522575378418
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.578 Vali Acc: 0.519 Test Loss: 1.578 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4501924514770508
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.641 Vali Acc: 0.534 Test Loss: 1.641 Test Acc: 0.534
Validation loss decreased (-0.526702 --> -0.534335).  Saving model ...
Epoch: 16 cost time: 1.7132954597473145
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.680 Vali Acc: 0.542 Test Loss: 1.680 Test Acc: 0.542
Validation loss decreased (-0.534335 --> -0.541968).  Saving model ...
Epoch: 17 cost time: 1.4176788330078125
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.677 Vali Acc: 0.542 Test Loss: 1.677 Test Acc: 0.542
Validation loss decreased (-0.541968 --> -0.541968).  Saving model ...
Epoch: 18 cost time: 1.3457012176513672
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.666 Vali Acc: 0.550 Test Loss: 1.666 Test Acc: 0.550
Validation loss decreased (-0.541968 --> -0.549602).  Saving model ...
Epoch: 19 cost time: 1.2713427543640137
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.665 Vali Acc: 0.542 Test Loss: 1.665 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.2327842712402344
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.675 Vali Acc: 0.550 Test Loss: 1.675 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.404876947402954
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.677 Vali Acc: 0.534 Test Loss: 1.677 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.3429908752441406
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.681 Vali Acc: 0.527 Test Loss: 1.681 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.0465092658996582
Epoch: 23, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.685 Vali Acc: 0.527 Test Loss: 1.685 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.203355312347412
Epoch: 24, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.700 Vali Acc: 0.527 Test Loss: 1.700 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.1914541721343994
Epoch: 25, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.707 Vali Acc: 0.527 Test Loss: 1.707 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.308701515197754
Epoch: 26, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.721 Vali Acc: 0.527 Test Loss: 1.721 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.274728775024414
Epoch: 27, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.735 Vali Acc: 0.542 Test Loss: 1.735 Test Acc: 0.542
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.3032855987548828
Epoch: 28, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.734 Vali Acc: 0.534 Test Loss: 1.734 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps900_str450_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 41849093
model size : 174.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps900_str900_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.8225746154785156
Epoch: 1, Steps: 8 | Train Loss: 1.530 Vali Loss: 1.546 Vali Acc: 0.420 Test Loss: 1.546 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 0.8432459831237793
Epoch: 2, Steps: 8 | Train Loss: 1.378 Vali Loss: 1.555 Vali Acc: 0.420 Test Loss: 1.555 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.053724765777588
Epoch: 3, Steps: 8 | Train Loss: 1.136 Vali Loss: 1.543 Vali Acc: 0.466 Test Loss: 1.543 Test Acc: 0.466
Validation loss decreased (-0.419832 --> -0.465633).  Saving model ...
Epoch: 4 cost time: 1.1258878707885742
Epoch: 4, Steps: 8 | Train Loss: 0.838 Vali Loss: 1.529 Vali Acc: 0.481 Test Loss: 1.529 Test Acc: 0.481
Validation loss decreased (-0.465633 --> -0.480901).  Saving model ...
Epoch: 5 cost time: 1.0591652393341064
Epoch: 5, Steps: 8 | Train Loss: 0.518 Vali Loss: 1.492 Vali Acc: 0.519 Test Loss: 1.492 Test Acc: 0.519
Validation loss decreased (-0.480901 --> -0.519069).  Saving model ...
Epoch: 6 cost time: 1.5879735946655273
Epoch: 6, Steps: 8 | Train Loss: 0.252 Vali Loss: 1.553 Vali Acc: 0.504 Test Loss: 1.553 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.138371229171753
Epoch: 7, Steps: 8 | Train Loss: 0.092 Vali Loss: 1.502 Vali Acc: 0.496 Test Loss: 1.502 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.170591115951538
Epoch: 8, Steps: 8 | Train Loss: 0.029 Vali Loss: 1.513 Vali Acc: 0.527 Test Loss: 1.513 Test Acc: 0.527
Validation loss decreased (-0.519069 --> -0.526702).  Saving model ...
Epoch: 9 cost time: 1.0451247692108154
Epoch: 9, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.605 Vali Acc: 0.527 Test Loss: 1.605 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5579462051391602
Epoch: 10, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.628 Vali Acc: 0.542 Test Loss: 1.628 Test Acc: 0.542
Validation loss decreased (-0.526702 --> -0.541968).  Saving model ...
Epoch: 11 cost time: 1.1824233531951904
Epoch: 11, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.674 Vali Acc: 0.534 Test Loss: 1.674 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9963560104370117
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.740 Vali Acc: 0.519 Test Loss: 1.740 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1277687549591064
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.768 Vali Acc: 0.527 Test Loss: 1.768 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.4292383193969727
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.780 Vali Acc: 0.534 Test Loss: 1.780 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.2086825370788574
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.782 Vali Acc: 0.534 Test Loss: 1.782 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.8598809242248535
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.776 Vali Acc: 0.534 Test Loss: 1.776 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.494443416595459
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.761 Vali Acc: 0.519 Test Loss: 1.761 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.286736011505127
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.762 Vali Acc: 0.519 Test Loss: 1.762 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.021352767944336
Epoch: 19, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.770 Vali Acc: 0.534 Test Loss: 1.770 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.4406805038452148
Epoch: 20, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.773 Vali Acc: 0.527 Test Loss: 1.773 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps900_str900_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 41746949
model size : 173.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps947_str237_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.222172498703003
Epoch: 1, Steps: 8 | Train Loss: 1.611 Vali Loss: 1.716 Vali Acc: 0.420 Test Loss: 1.716 Test Acc: 0.420
Validation loss decreased (inf --> -0.419830).  Saving model ...
Epoch: 2 cost time: 1.8075063228607178
Epoch: 2, Steps: 8 | Train Loss: 1.448 Vali Loss: 1.503 Vali Acc: 0.427 Test Loss: 1.503 Test Acc: 0.427
Validation loss decreased (-0.419830 --> -0.427466).  Saving model ...
Epoch: 3 cost time: 2.156494140625
Epoch: 3, Steps: 8 | Train Loss: 1.188 Vali Loss: 1.417 Vali Acc: 0.466 Test Loss: 1.417 Test Acc: 0.466
Validation loss decreased (-0.427466 --> -0.465635).  Saving model ...
Epoch: 4 cost time: 1.8871400356292725
Epoch: 4, Steps: 8 | Train Loss: 0.879 Vali Loss: 1.286 Vali Acc: 0.466 Test Loss: 1.286 Test Acc: 0.466
Validation loss decreased (-0.465635 --> -0.465636).  Saving model ...
Epoch: 5 cost time: 1.7986104488372803
Epoch: 5, Steps: 8 | Train Loss: 0.565 Vali Loss: 1.306 Vali Acc: 0.511 Test Loss: 1.306 Test Acc: 0.511
Validation loss decreased (-0.465636 --> -0.511437).  Saving model ...
Epoch: 6 cost time: 1.713921070098877
Epoch: 6, Steps: 8 | Train Loss: 0.219 Vali Loss: 1.350 Vali Acc: 0.565 Test Loss: 1.350 Test Acc: 0.565
Validation loss decreased (-0.511437 --> -0.564872).  Saving model ...
Epoch: 7 cost time: 1.6349709033966064
Epoch: 7, Steps: 8 | Train Loss: 0.047 Vali Loss: 1.474 Vali Acc: 0.504 Test Loss: 1.474 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5999095439910889
Epoch: 8, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.975 Vali Acc: 0.565 Test Loss: 1.975 Test Acc: 0.565
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.3411321640014648
Epoch: 9, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.833 Vali Acc: 0.412 Test Loss: 1.833 Test Acc: 0.412
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.3658525943756104
Epoch: 10, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.859 Vali Acc: 0.565 Test Loss: 1.859 Test Acc: 0.565
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.9235117435455322
Epoch: 11, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.862 Vali Acc: 0.565 Test Loss: 1.862 Test Acc: 0.565
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.6300780773162842
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.747 Vali Acc: 0.534 Test Loss: 1.747 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.458554744720459
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.801 Vali Acc: 0.527 Test Loss: 1.801 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.2943668365478516
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.891 Vali Acc: 0.534 Test Loss: 1.891 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.0632121562957764
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.964 Vali Acc: 0.527 Test Loss: 1.964 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.759080410003662
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.001 Vali Acc: 0.534 Test Loss: 2.001 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps947_str237_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5648854961832062
model parameter : 42681605
model size : 177.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps947_str474_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.2737009525299072
Epoch: 1, Steps: 8 | Train Loss: 1.624 Vali Loss: 1.585 Vali Acc: 0.420 Test Loss: 1.585 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 1.3860433101654053
Epoch: 2, Steps: 8 | Train Loss: 1.397 Vali Loss: 1.450 Vali Acc: 0.466 Test Loss: 1.450 Test Acc: 0.466
Validation loss decreased (-0.419831 --> -0.465634).  Saving model ...
Epoch: 3 cost time: 1.2637650966644287
Epoch: 3, Steps: 8 | Train Loss: 1.126 Vali Loss: 1.367 Vali Acc: 0.534 Test Loss: 1.367 Test Acc: 0.534
Validation loss decreased (-0.465634 --> -0.534337).  Saving model ...
Epoch: 4 cost time: 1.284963607788086
Epoch: 4, Steps: 8 | Train Loss: 0.823 Vali Loss: 1.274 Vali Acc: 0.565 Test Loss: 1.274 Test Acc: 0.565
Validation loss decreased (-0.534337 --> -0.564873).  Saving model ...
Epoch: 5 cost time: 1.212965726852417
Epoch: 5, Steps: 8 | Train Loss: 0.533 Vali Loss: 1.200 Vali Acc: 0.542 Test Loss: 1.200 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.4868168830871582
Epoch: 6, Steps: 8 | Train Loss: 0.223 Vali Loss: 1.398 Vali Acc: 0.481 Test Loss: 1.398 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.167785406112671
Epoch: 7, Steps: 8 | Train Loss: 0.072 Vali Loss: 1.441 Vali Acc: 0.542 Test Loss: 1.441 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.2510285377502441
Epoch: 8, Steps: 8 | Train Loss: 0.018 Vali Loss: 1.548 Vali Acc: 0.443 Test Loss: 1.548 Test Acc: 0.443
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.3240876197814941
Epoch: 9, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.696 Vali Acc: 0.489 Test Loss: 1.696 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.314624547958374
Epoch: 10, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.622 Vali Acc: 0.504 Test Loss: 1.622 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.716984748840332
Epoch: 11, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.679 Vali Acc: 0.473 Test Loss: 1.679 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.4729113578796387
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.752 Vali Acc: 0.496 Test Loss: 1.752 Test Acc: 0.496
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.3515167236328125
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.769 Vali Acc: 0.504 Test Loss: 1.769 Test Acc: 0.504
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.1820244789123535
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.743 Vali Acc: 0.504 Test Loss: 1.743 Test Acc: 0.504
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps947_str474_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5648854961832062
model parameter : 42488069
model size : 176.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps947_str947_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.405871629714966
Epoch: 1, Steps: 8 | Train Loss: 1.642 Vali Loss: 1.558 Vali Acc: 0.420 Test Loss: 1.558 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 1.0778276920318604
Epoch: 2, Steps: 8 | Train Loss: 1.413 Vali Loss: 1.590 Vali Acc: 0.420 Test Loss: 1.590 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1512675285339355
Epoch: 3, Steps: 8 | Train Loss: 1.187 Vali Loss: 1.509 Vali Acc: 0.466 Test Loss: 1.509 Test Acc: 0.466
Validation loss decreased (-0.419832 --> -0.465634).  Saving model ...
Epoch: 4 cost time: 1.139052152633667
Epoch: 4, Steps: 8 | Train Loss: 0.901 Vali Loss: 1.449 Vali Acc: 0.496 Test Loss: 1.449 Test Acc: 0.496
Validation loss decreased (-0.465634 --> -0.496169).  Saving model ...
Epoch: 5 cost time: 1.1679956912994385
Epoch: 5, Steps: 8 | Train Loss: 0.579 Vali Loss: 1.455 Vali Acc: 0.511 Test Loss: 1.455 Test Acc: 0.511
Validation loss decreased (-0.496169 --> -0.511436).  Saving model ...
Epoch: 6 cost time: 1.1660938262939453
Epoch: 6, Steps: 8 | Train Loss: 0.293 Vali Loss: 1.607 Vali Acc: 0.481 Test Loss: 1.607 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0770320892333984
Epoch: 7, Steps: 8 | Train Loss: 0.114 Vali Loss: 1.736 Vali Acc: 0.458 Test Loss: 1.736 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.113546371459961
Epoch: 8, Steps: 8 | Train Loss: 0.040 Vali Loss: 1.873 Vali Acc: 0.496 Test Loss: 1.873 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.175196647644043
Epoch: 9, Steps: 8 | Train Loss: 0.019 Vali Loss: 2.049 Vali Acc: 0.511 Test Loss: 2.049 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.7139370441436768
Epoch: 10, Steps: 8 | Train Loss: 0.006 Vali Loss: 2.141 Vali Acc: 0.458 Test Loss: 2.141 Test Acc: 0.458
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.2728428840637207
Epoch: 11, Steps: 8 | Train Loss: 0.004 Vali Loss: 2.170 Vali Acc: 0.443 Test Loss: 2.170 Test Acc: 0.443
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.0908443927764893
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 2.153 Vali Acc: 0.481 Test Loss: 2.153 Test Acc: 0.481
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.427339792251587
Epoch: 13, Steps: 8 | Train Loss: 0.002 Vali Loss: 2.152 Vali Acc: 0.496 Test Loss: 2.152 Test Acc: 0.496
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.257378339767456
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.161 Vali Acc: 0.496 Test Loss: 2.161 Test Acc: 0.496
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.5716755390167236
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.164 Vali Acc: 0.496 Test Loss: 2.164 Test Acc: 0.496
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps947_str947_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5114503816793893
model parameter : 42391301
model size : 176.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps1000_str250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.2617878913879395
Epoch: 1, Steps: 8 | Train Loss: 1.676 Vali Loss: 1.594 Vali Acc: 0.420 Test Loss: 1.594 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 1.0780596733093262
Epoch: 2, Steps: 8 | Train Loss: 1.393 Vali Loss: 1.553 Vali Acc: 0.427 Test Loss: 1.553 Test Acc: 0.427
Validation loss decreased (-0.419831 --> -0.427465).  Saving model ...
Epoch: 3 cost time: 1.477431058883667
Epoch: 3, Steps: 8 | Train Loss: 1.155 Vali Loss: 1.387 Vali Acc: 0.511 Test Loss: 1.387 Test Acc: 0.511
Validation loss decreased (-0.427465 --> -0.511437).  Saving model ...
Epoch: 4 cost time: 1.4242618083953857
Epoch: 4, Steps: 8 | Train Loss: 0.801 Vali Loss: 1.377 Vali Acc: 0.496 Test Loss: 1.377 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6358892917633057
Epoch: 5, Steps: 8 | Train Loss: 0.322 Vali Loss: 1.358 Vali Acc: 0.496 Test Loss: 1.358 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.7645199298858643
Epoch: 6, Steps: 8 | Train Loss: 0.134 Vali Loss: 1.591 Vali Acc: 0.511 Test Loss: 1.591 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.5586950778961182
Epoch: 7, Steps: 8 | Train Loss: 0.044 Vali Loss: 1.754 Vali Acc: 0.489 Test Loss: 1.754 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.5549774169921875
Epoch: 8, Steps: 8 | Train Loss: 0.029 Vali Loss: 1.673 Vali Acc: 0.588 Test Loss: 1.673 Test Acc: 0.588
Validation loss decreased (-0.511437 --> -0.587770).  Saving model ...
Epoch: 9 cost time: 1.1129217147827148
Epoch: 9, Steps: 8 | Train Loss: 0.018 Vali Loss: 1.833 Vali Acc: 0.527 Test Loss: 1.833 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0215494632720947
Epoch: 10, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.879 Vali Acc: 0.504 Test Loss: 1.879 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0414936542510986
Epoch: 11, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.896 Vali Acc: 0.527 Test Loss: 1.896 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.1102993488311768
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.966 Vali Acc: 0.534 Test Loss: 1.966 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.0942070484161377
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.001 Vali Acc: 0.542 Test Loss: 2.001 Test Acc: 0.542
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.0820484161376953
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.914 Vali Acc: 0.550 Test Loss: 1.914 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.6160774230957031
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.886 Vali Acc: 0.550 Test Loss: 1.886 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.2056727409362793
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.889 Vali Acc: 0.557 Test Loss: 1.889 Test Acc: 0.557
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.2971513271331787
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.904 Vali Acc: 0.557 Test Loss: 1.904 Test Acc: 0.557
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.260547161102295
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.928 Vali Acc: 0.557 Test Loss: 1.928 Test Acc: 0.557
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps1000_str250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5877862595419847
model parameter : 43392773
model size : 180.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps1000_str500_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.5126569271087646
Epoch: 1, Steps: 8 | Train Loss: 1.569 Vali Loss: 1.650 Vali Acc: 0.420 Test Loss: 1.650 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 1.0294427871704102
Epoch: 2, Steps: 8 | Train Loss: 1.381 Vali Loss: 1.533 Vali Acc: 0.435 Test Loss: 1.533 Test Acc: 0.435
Validation loss decreased (-0.419831 --> -0.435099).  Saving model ...
Epoch: 3 cost time: 1.2995991706848145
Epoch: 3, Steps: 8 | Train Loss: 1.116 Vali Loss: 1.469 Vali Acc: 0.481 Test Loss: 1.469 Test Acc: 0.481
Validation loss decreased (-0.435099 --> -0.480901).  Saving model ...
Epoch: 4 cost time: 0.9954349994659424
Epoch: 4, Steps: 8 | Train Loss: 0.774 Vali Loss: 1.399 Vali Acc: 0.489 Test Loss: 1.399 Test Acc: 0.489
Validation loss decreased (-0.480901 --> -0.488536).  Saving model ...
Epoch: 5 cost time: 1.1243259906768799
Epoch: 5, Steps: 8 | Train Loss: 0.459 Vali Loss: 1.448 Vali Acc: 0.519 Test Loss: 1.448 Test Acc: 0.519
Validation loss decreased (-0.488536 --> -0.519069).  Saving model ...
Epoch: 6 cost time: 1.1534602642059326
Epoch: 6, Steps: 8 | Train Loss: 0.231 Vali Loss: 1.488 Vali Acc: 0.420 Test Loss: 1.488 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1434876918792725
Epoch: 7, Steps: 8 | Train Loss: 0.089 Vali Loss: 1.806 Vali Acc: 0.519 Test Loss: 1.806 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.027928352355957
Epoch: 8, Steps: 8 | Train Loss: 0.029 Vali Loss: 1.652 Vali Acc: 0.435 Test Loss: 1.652 Test Acc: 0.435
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.0051193237304688
Epoch: 9, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.751 Vali Acc: 0.527 Test Loss: 1.751 Test Acc: 0.527
Validation loss decreased (-0.519069 --> -0.526700).  Saving model ...
Epoch: 10 cost time: 1.162843942642212
Epoch: 10, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.934 Vali Acc: 0.504 Test Loss: 1.934 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5723440647125244
Epoch: 11, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.899 Vali Acc: 0.481 Test Loss: 1.899 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.3390982151031494
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.952 Vali Acc: 0.458 Test Loss: 1.952 Test Acc: 0.458
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.2685518264770508
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.004 Vali Acc: 0.466 Test Loss: 2.004 Test Acc: 0.466
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.1953709125518799
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.037 Vali Acc: 0.466 Test Loss: 2.037 Test Acc: 0.466
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.8169558048248291
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.073 Vali Acc: 0.473 Test Loss: 2.073 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.002854347229004
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.084 Vali Acc: 0.473 Test Loss: 2.084 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.4495747089385986
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.081 Vali Acc: 0.481 Test Loss: 2.081 Test Acc: 0.481
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.050123929977417
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.084 Vali Acc: 0.481 Test Loss: 2.084 Test Acc: 0.481
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.6005523204803467
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.092 Vali Acc: 0.473 Test Loss: 2.092 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps1000_str500_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 43209989
model size : 179.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps1000_str1000_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.00873064994812
Epoch: 1, Steps: 8 | Train Loss: 1.535 Vali Loss: 1.566 Vali Acc: 0.420 Test Loss: 1.566 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 1.026491403579712
Epoch: 2, Steps: 8 | Train Loss: 1.363 Vali Loss: 1.530 Vali Acc: 0.427 Test Loss: 1.530 Test Acc: 0.427
Validation loss decreased (-0.419832 --> -0.427466).  Saving model ...
Epoch: 3 cost time: 1.0499203205108643
Epoch: 3, Steps: 8 | Train Loss: 1.103 Vali Loss: 1.516 Vali Acc: 0.450 Test Loss: 1.516 Test Acc: 0.450
Validation loss decreased (-0.427466 --> -0.450367).  Saving model ...
Epoch: 4 cost time: 1.0425913333892822
Epoch: 4, Steps: 8 | Train Loss: 0.815 Vali Loss: 1.509 Vali Acc: 0.481 Test Loss: 1.509 Test Acc: 0.481
Validation loss decreased (-0.450367 --> -0.480901).  Saving model ...
Epoch: 5 cost time: 1.313293695449829
Epoch: 5, Steps: 8 | Train Loss: 0.523 Vali Loss: 1.407 Vali Acc: 0.481 Test Loss: 1.407 Test Acc: 0.481
Validation loss decreased (-0.480901 --> -0.480902).  Saving model ...
Epoch: 6 cost time: 1.7115099430084229
Epoch: 6, Steps: 8 | Train Loss: 0.266 Vali Loss: 1.435 Vali Acc: 0.511 Test Loss: 1.435 Test Acc: 0.511
Validation loss decreased (-0.480902 --> -0.511436).  Saving model ...
Epoch: 7 cost time: 1.310844898223877
Epoch: 7, Steps: 8 | Train Loss: 0.107 Vali Loss: 1.448 Vali Acc: 0.519 Test Loss: 1.448 Test Acc: 0.519
Validation loss decreased (-0.511436 --> -0.519069).  Saving model ...
Epoch: 8 cost time: 1.4583430290222168
Epoch: 8, Steps: 8 | Train Loss: 0.039 Vali Loss: 1.485 Vali Acc: 0.527 Test Loss: 1.485 Test Acc: 0.527
Validation loss decreased (-0.519069 --> -0.526703).  Saving model ...
Epoch: 9 cost time: 1.1794559955596924
Epoch: 9, Steps: 8 | Train Loss: 0.018 Vali Loss: 1.643 Vali Acc: 0.542 Test Loss: 1.643 Test Acc: 0.542
Validation loss decreased (-0.526703 --> -0.541968).  Saving model ...
Epoch: 10 cost time: 1.2397785186767578
Epoch: 10, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.624 Vali Acc: 0.519 Test Loss: 1.624 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7217514514923096
Epoch: 11, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.541 Vali Acc: 0.481 Test Loss: 1.541 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1189241409301758
Epoch: 12, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.553 Vali Acc: 0.489 Test Loss: 1.553 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.2887277603149414
Epoch: 13, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.585 Vali Acc: 0.511 Test Loss: 1.585 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.1779248714447021
Epoch: 14, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.609 Vali Acc: 0.511 Test Loss: 1.609 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.0969300270080566
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.631 Vali Acc: 0.519 Test Loss: 1.631 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.7660505771636963
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.651 Vali Acc: 0.527 Test Loss: 1.651 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.216569185256958
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.665 Vali Acc: 0.519 Test Loss: 1.665 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.0699870586395264
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.665 Vali Acc: 0.511 Test Loss: 1.665 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.1178531646728516
Epoch: 19, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.671 Vali Acc: 0.511 Test Loss: 1.671 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps1000_str1000_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 43118597
model size : 179.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps1058_str265_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.1371185779571533
Epoch: 1, Steps: 8 | Train Loss: 1.655 Vali Loss: 1.601 Vali Acc: 0.420 Test Loss: 1.601 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 1.5605332851409912
Epoch: 2, Steps: 8 | Train Loss: 1.470 Vali Loss: 1.552 Vali Acc: 0.435 Test Loss: 1.552 Test Acc: 0.435
Validation loss decreased (-0.419831 --> -0.435099).  Saving model ...
Epoch: 3 cost time: 1.4029691219329834
Epoch: 3, Steps: 8 | Train Loss: 1.128 Vali Loss: 1.433 Vali Acc: 0.466 Test Loss: 1.433 Test Acc: 0.466
Validation loss decreased (-0.435099 --> -0.465635).  Saving model ...
Epoch: 4 cost time: 1.6224944591522217
Epoch: 4, Steps: 8 | Train Loss: 0.766 Vali Loss: 1.396 Vali Acc: 0.504 Test Loss: 1.396 Test Acc: 0.504
Validation loss decreased (-0.465635 --> -0.503803).  Saving model ...
Epoch: 5 cost time: 0.9808516502380371
Epoch: 5, Steps: 8 | Train Loss: 0.427 Vali Loss: 1.355 Vali Acc: 0.542 Test Loss: 1.355 Test Acc: 0.542
Validation loss decreased (-0.503803 --> -0.541971).  Saving model ...
Epoch: 6 cost time: 1.244999647140503
Epoch: 6, Steps: 8 | Train Loss: 0.148 Vali Loss: 1.341 Vali Acc: 0.557 Test Loss: 1.341 Test Acc: 0.557
Validation loss decreased (-0.541971 --> -0.557238).  Saving model ...
Epoch: 7 cost time: 1.2522144317626953
Epoch: 7, Steps: 8 | Train Loss: 0.052 Vali Loss: 1.560 Vali Acc: 0.519 Test Loss: 1.560 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4175658226013184
Epoch: 8, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.284 Vali Acc: 0.557 Test Loss: 1.284 Test Acc: 0.557
Validation loss decreased (-0.557238 --> -0.557239).  Saving model ...
Epoch: 9 cost time: 1.2599029541015625
Epoch: 9, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.399 Vali Acc: 0.542 Test Loss: 1.399 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3398847579956055
Epoch: 10, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.711 Vali Acc: 0.573 Test Loss: 1.711 Test Acc: 0.573
Validation loss decreased (-0.557239 --> -0.572502).  Saving model ...
Epoch: 11 cost time: 1.6069536209106445
Epoch: 11, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.826 Vali Acc: 0.527 Test Loss: 1.826 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8817737102508545
Epoch: 12, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.865 Vali Acc: 0.527 Test Loss: 1.865 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.0411763191223145
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.624 Vali Acc: 0.588 Test Loss: 1.624 Test Acc: 0.588
Validation loss decreased (-0.572502 --> -0.587770).  Saving model ...
Epoch: 14 cost time: 1.5509576797485352
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.600 Vali Acc: 0.580 Test Loss: 1.600 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4534246921539307
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.628 Vali Acc: 0.573 Test Loss: 1.628 Test Acc: 0.573
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.203700065612793
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.662 Vali Acc: 0.588 Test Loss: 1.662 Test Acc: 0.588
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.433732271194458
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.666 Vali Acc: 0.580 Test Loss: 1.666 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.3204522132873535
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.662 Vali Acc: 0.588 Test Loss: 1.662 Test Acc: 0.588
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.2360310554504395
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.663 Vali Acc: 0.588 Test Loss: 1.663 Test Acc: 0.588
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.6492106914520264
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.655 Vali Acc: 0.588 Test Loss: 1.655 Test Acc: 0.588
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.5650689601898193
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.659 Vali Acc: 0.588 Test Loss: 1.659 Test Acc: 0.588
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.4184458255767822
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.666 Vali Acc: 0.588 Test Loss: 1.666 Test Acc: 0.588
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.4580049514770508
Epoch: 23, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.662 Vali Acc: 0.580 Test Loss: 1.662 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps1058_str265_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5877862595419847
model parameter : 44173061
model size : 183.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps1058_str529_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.667119026184082
Epoch: 1, Steps: 8 | Train Loss: 1.575 Vali Loss: 1.647 Vali Acc: 0.420 Test Loss: 1.647 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 1.1980247497558594
Epoch: 2, Steps: 8 | Train Loss: 1.372 Vali Loss: 1.472 Vali Acc: 0.496 Test Loss: 1.472 Test Acc: 0.496
Validation loss decreased (-0.419831 --> -0.496168).  Saving model ...
Epoch: 3 cost time: 1.296363115310669
Epoch: 3, Steps: 8 | Train Loss: 1.073 Vali Loss: 1.369 Vali Acc: 0.504 Test Loss: 1.369 Test Acc: 0.504
Validation loss decreased (-0.496168 --> -0.503803).  Saving model ...
Epoch: 4 cost time: 1.6055352687835693
Epoch: 4, Steps: 8 | Train Loss: 0.724 Vali Loss: 1.264 Vali Acc: 0.557 Test Loss: 1.264 Test Acc: 0.557
Validation loss decreased (-0.503803 --> -0.557239).  Saving model ...
Epoch: 5 cost time: 1.4186532497406006
Epoch: 5, Steps: 8 | Train Loss: 0.369 Vali Loss: 1.226 Vali Acc: 0.481 Test Loss: 1.226 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8105299472808838
Epoch: 6, Steps: 8 | Train Loss: 0.147 Vali Loss: 1.411 Vali Acc: 0.534 Test Loss: 1.411 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.3151054382324219
Epoch: 7, Steps: 8 | Train Loss: 0.073 Vali Loss: 1.343 Vali Acc: 0.481 Test Loss: 1.343 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.3601067066192627
Epoch: 8, Steps: 8 | Train Loss: 0.036 Vali Loss: 1.371 Vali Acc: 0.550 Test Loss: 1.371 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.6693105697631836
Epoch: 9, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.618 Vali Acc: 0.511 Test Loss: 1.618 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.2334377765655518
Epoch: 10, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.554 Vali Acc: 0.504 Test Loss: 1.554 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.5911386013031006
Epoch: 11, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.618 Vali Acc: 0.557 Test Loss: 1.618 Test Acc: 0.557
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.230299711227417
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.690 Vali Acc: 0.542 Test Loss: 1.690 Test Acc: 0.542
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.3505890369415283
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.720 Vali Acc: 0.550 Test Loss: 1.720 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.2275123596191406
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.743 Vali Acc: 0.550 Test Loss: 1.743 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps1058_str529_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 44001029
model size : 182.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps1058_str1058_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.50345778465271
Epoch: 1, Steps: 8 | Train Loss: 1.566 Vali Loss: 1.545 Vali Acc: 0.420 Test Loss: 1.545 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 1.0978589057922363
Epoch: 2, Steps: 8 | Train Loss: 1.389 Vali Loss: 1.500 Vali Acc: 0.435 Test Loss: 1.500 Test Acc: 0.435
Validation loss decreased (-0.419832 --> -0.435100).  Saving model ...
Epoch: 3 cost time: 1.120739459991455
Epoch: 3, Steps: 8 | Train Loss: 1.115 Vali Loss: 1.442 Vali Acc: 0.473 Test Loss: 1.442 Test Acc: 0.473
Validation loss decreased (-0.435100 --> -0.473268).  Saving model ...
Epoch: 4 cost time: 1.4505417346954346
Epoch: 4, Steps: 8 | Train Loss: 0.803 Vali Loss: 1.424 Vali Acc: 0.534 Test Loss: 1.424 Test Acc: 0.534
Validation loss decreased (-0.473268 --> -0.534337).  Saving model ...
Epoch: 5 cost time: 1.233293056488037
Epoch: 5, Steps: 8 | Train Loss: 0.492 Vali Loss: 1.369 Vali Acc: 0.504 Test Loss: 1.369 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0772500038146973
Epoch: 6, Steps: 8 | Train Loss: 0.215 Vali Loss: 1.514 Vali Acc: 0.489 Test Loss: 1.514 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.131941556930542
Epoch: 7, Steps: 8 | Train Loss: 0.084 Vali Loss: 1.604 Vali Acc: 0.481 Test Loss: 1.604 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.0296285152435303
Epoch: 8, Steps: 8 | Train Loss: 0.030 Vali Loss: 1.536 Vali Acc: 0.473 Test Loss: 1.536 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.949305534362793
Epoch: 9, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.611 Vali Acc: 0.527 Test Loss: 1.611 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.319281816482544
Epoch: 10, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.638 Vali Acc: 0.534 Test Loss: 1.638 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.1869738101959229
Epoch: 11, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.651 Vali Acc: 0.504 Test Loss: 1.651 Test Acc: 0.504
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.1553997993469238
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.664 Vali Acc: 0.504 Test Loss: 1.664 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.938488245010376
Epoch: 13, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.681 Vali Acc: 0.504 Test Loss: 1.681 Test Acc: 0.504
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.0785984992980957
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.698 Vali Acc: 0.496 Test Loss: 1.698 Test Acc: 0.496
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps1058_str1058_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 43915013
model size : 182.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps1124_str281_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.798572301864624
Epoch: 1, Steps: 8 | Train Loss: 1.654 Vali Loss: 1.577 Vali Acc: 0.420 Test Loss: 1.577 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 1.2050087451934814
Epoch: 2, Steps: 8 | Train Loss: 1.370 Vali Loss: 1.552 Vali Acc: 0.412 Test Loss: 1.552 Test Acc: 0.412
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.315065860748291
Epoch: 3, Steps: 8 | Train Loss: 1.112 Vali Loss: 1.416 Vali Acc: 0.504 Test Loss: 1.416 Test Acc: 0.504
Validation loss decreased (-0.419832 --> -0.503803).  Saving model ...
Epoch: 4 cost time: 1.0688707828521729
Epoch: 4, Steps: 8 | Train Loss: 0.791 Vali Loss: 1.304 Vali Acc: 0.565 Test Loss: 1.304 Test Acc: 0.565
Validation loss decreased (-0.503803 --> -0.564872).  Saving model ...
Epoch: 5 cost time: 1.1577847003936768
Epoch: 5, Steps: 8 | Train Loss: 0.380 Vali Loss: 1.227 Vali Acc: 0.519 Test Loss: 1.227 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.054490089416504
Epoch: 6, Steps: 8 | Train Loss: 0.130 Vali Loss: 1.372 Vali Acc: 0.542 Test Loss: 1.372 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.0844039916992188
Epoch: 7, Steps: 8 | Train Loss: 0.038 Vali Loss: 1.444 Vali Acc: 0.527 Test Loss: 1.444 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.1669995784759521
Epoch: 8, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.603 Vali Acc: 0.550 Test Loss: 1.603 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.6377031803131104
Epoch: 9, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.348 Vali Acc: 0.565 Test Loss: 1.348 Test Acc: 0.565
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.2724206447601318
Epoch: 10, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.433 Vali Acc: 0.573 Test Loss: 1.433 Test Acc: 0.573
Validation loss decreased (-0.564872 --> -0.572505).  Saving model ...
Epoch: 11 cost time: 1.5008649826049805
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.845 Vali Acc: 0.565 Test Loss: 1.845 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4556128978729248
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.629 Vali Acc: 0.534 Test Loss: 1.629 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.2604713439941406
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.671 Vali Acc: 0.519 Test Loss: 1.671 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.5584666728973389
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.744 Vali Acc: 0.542 Test Loss: 1.744 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.9000496864318848
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.793 Vali Acc: 0.527 Test Loss: 1.793 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.8641159534454346
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.770 Vali Acc: 0.534 Test Loss: 1.770 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.8054721355438232
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.751 Vali Acc: 0.542 Test Loss: 1.751 Test Acc: 0.542
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.338895320892334
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.743 Vali Acc: 0.573 Test Loss: 1.743 Test Acc: 0.573
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.0041828155517578
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.725 Vali Acc: 0.565 Test Loss: 1.725 Test Acc: 0.565
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.1692698001861572
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.714 Vali Acc: 0.550 Test Loss: 1.714 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps1124_str281_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5725190839694656
model parameter : 45069317
model size : 186.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps1124_str562_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.2408957481384277
Epoch: 1, Steps: 8 | Train Loss: 1.526 Vali Loss: 1.617 Vali Acc: 0.420 Test Loss: 1.617 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 1.3579413890838623
Epoch: 2, Steps: 8 | Train Loss: 1.326 Vali Loss: 1.528 Vali Acc: 0.435 Test Loss: 1.528 Test Acc: 0.435
Validation loss decreased (-0.419831 --> -0.435099).  Saving model ...
Epoch: 3 cost time: 1.150968074798584
Epoch: 3, Steps: 8 | Train Loss: 1.057 Vali Loss: 1.477 Vali Acc: 0.481 Test Loss: 1.477 Test Acc: 0.481
Validation loss decreased (-0.435099 --> -0.480901).  Saving model ...
Epoch: 4 cost time: 1.0322766304016113
Epoch: 4, Steps: 8 | Train Loss: 0.752 Vali Loss: 1.491 Vali Acc: 0.466 Test Loss: 1.491 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0716743469238281
Epoch: 5, Steps: 8 | Train Loss: 0.426 Vali Loss: 1.455 Vali Acc: 0.504 Test Loss: 1.455 Test Acc: 0.504
Validation loss decreased (-0.480901 --> -0.503802).  Saving model ...
Epoch: 6 cost time: 1.2186245918273926
Epoch: 6, Steps: 8 | Train Loss: 0.172 Vali Loss: 1.435 Vali Acc: 0.489 Test Loss: 1.435 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2210192680358887
Epoch: 7, Steps: 8 | Train Loss: 0.064 Vali Loss: 1.509 Vali Acc: 0.504 Test Loss: 1.509 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.4192867279052734
Epoch: 8, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.627 Vali Acc: 0.481 Test Loss: 1.627 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.2614092826843262
Epoch: 9, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.845 Vali Acc: 0.489 Test Loss: 1.845 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.627347707748413
Epoch: 10, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.827 Vali Acc: 0.511 Test Loss: 1.827 Test Acc: 0.511
Validation loss decreased (-0.503802 --> -0.511432).  Saving model ...
Epoch: 11 cost time: 1.3053162097930908
Epoch: 11, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.870 Vali Acc: 0.496 Test Loss: 1.870 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9117758274078369
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.956 Vali Acc: 0.504 Test Loss: 1.956 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9379770755767822
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.033 Vali Acc: 0.519 Test Loss: 2.033 Test Acc: 0.519
Validation loss decreased (-0.511432 --> -0.519064).  Saving model ...
Epoch: 14 cost time: 1.362884759902954
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.030 Vali Acc: 0.519 Test Loss: 2.030 Test Acc: 0.519
Validation loss decreased (-0.519064 --> -0.519064).  Saving model ...
Epoch: 15 cost time: 1.0676374435424805
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.006 Vali Acc: 0.527 Test Loss: 2.006 Test Acc: 0.527
Validation loss decreased (-0.519064 --> -0.526697).  Saving model ...
Epoch: 16 cost time: 1.2446625232696533
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.978 Vali Acc: 0.527 Test Loss: 1.978 Test Acc: 0.527
Validation loss decreased (-0.526697 --> -0.526698).  Saving model ...
Epoch: 17 cost time: 1.2160708904266357
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.965 Vali Acc: 0.527 Test Loss: 1.965 Test Acc: 0.527
Validation loss decreased (-0.526698 --> -0.526698).  Saving model ...
Epoch: 18 cost time: 1.1488196849822998
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.971 Vali Acc: 0.527 Test Loss: 1.971 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.7257630825042725
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.980 Vali Acc: 0.519 Test Loss: 1.980 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.251429557800293
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.986 Vali Acc: 0.519 Test Loss: 1.986 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.3481724262237549
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.991 Vali Acc: 0.519 Test Loss: 1.991 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.1544265747070312
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.997 Vali Acc: 0.519 Test Loss: 1.997 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.8038403987884521
Epoch: 23, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.008 Vali Acc: 0.519 Test Loss: 2.008 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.4120478630065918
Epoch: 24, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.023 Vali Acc: 0.519 Test Loss: 2.023 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.703237771987915
Epoch: 25, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.035 Vali Acc: 0.519 Test Loss: 2.035 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.1241602897644043
Epoch: 26, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.048 Vali Acc: 0.519 Test Loss: 2.048 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.134385108947754
Epoch: 27, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.050 Vali Acc: 0.519 Test Loss: 2.050 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps1124_str562_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 44908037
model size : 185.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps1124_str1124_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.5123233795166016
Epoch: 1, Steps: 8 | Train Loss: 1.502 Vali Loss: 1.588 Vali Acc: 0.420 Test Loss: 1.588 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 0.999781608581543
Epoch: 2, Steps: 8 | Train Loss: 1.374 Vali Loss: 1.522 Vali Acc: 0.420 Test Loss: 1.522 Test Acc: 0.420
Validation loss decreased (-0.419831 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 1.5052340030670166
Epoch: 3, Steps: 8 | Train Loss: 1.130 Vali Loss: 1.474 Vali Acc: 0.466 Test Loss: 1.474 Test Acc: 0.466
Validation loss decreased (-0.419832 --> -0.465634).  Saving model ...
Epoch: 4 cost time: 1.1889514923095703
Epoch: 4, Steps: 8 | Train Loss: 0.819 Vali Loss: 1.440 Vali Acc: 0.466 Test Loss: 1.440 Test Acc: 0.466
Validation loss decreased (-0.465634 --> -0.465634).  Saving model ...
Epoch: 5 cost time: 1.0578320026397705
Epoch: 5, Steps: 8 | Train Loss: 0.489 Vali Loss: 1.495 Vali Acc: 0.466 Test Loss: 1.495 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0517735481262207
Epoch: 6, Steps: 8 | Train Loss: 0.222 Vali Loss: 1.606 Vali Acc: 0.427 Test Loss: 1.606 Test Acc: 0.427
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.5046336650848389
Epoch: 7, Steps: 8 | Train Loss: 0.097 Vali Loss: 1.576 Vali Acc: 0.443 Test Loss: 1.576 Test Acc: 0.443
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.6843149662017822
Epoch: 8, Steps: 8 | Train Loss: 0.038 Vali Loss: 1.655 Vali Acc: 0.496 Test Loss: 1.655 Test Acc: 0.496
Validation loss decreased (-0.465634 --> -0.496167).  Saving model ...
Epoch: 9 cost time: 1.2436559200286865
Epoch: 9, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.905 Vali Acc: 0.496 Test Loss: 1.905 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1978447437286377
Epoch: 10, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.875 Vali Acc: 0.489 Test Loss: 1.875 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.1799166202545166
Epoch: 11, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.804 Vali Acc: 0.489 Test Loss: 1.804 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.2046160697937012
Epoch: 12, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.776 Vali Acc: 0.481 Test Loss: 1.776 Test Acc: 0.481
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.5821218490600586
Epoch: 13, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.781 Vali Acc: 0.504 Test Loss: 1.781 Test Acc: 0.504
Validation loss decreased (-0.496167 --> -0.503799).  Saving model ...
Epoch: 14 cost time: 1.5686852931976318
Epoch: 14, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.803 Vali Acc: 0.496 Test Loss: 1.803 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.491945505142212
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.830 Vali Acc: 0.481 Test Loss: 1.830 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.227294683456421
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.857 Vali Acc: 0.489 Test Loss: 1.857 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.4797616004943848
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.882 Vali Acc: 0.496 Test Loss: 1.882 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.6549863815307617
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.900 Vali Acc: 0.504 Test Loss: 1.900 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.4544177055358887
Epoch: 19, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.908 Vali Acc: 0.511 Test Loss: 1.908 Test Acc: 0.511
Validation loss decreased (-0.503799 --> -0.511431).  Saving model ...
Epoch: 20 cost time: 1.5538947582244873
Epoch: 20, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.921 Vali Acc: 0.496 Test Loss: 1.921 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0580415725708008
Epoch: 21, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.926 Vali Acc: 0.496 Test Loss: 1.926 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.9295620918273926
Epoch: 22, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.934 Vali Acc: 0.496 Test Loss: 1.934 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.5719120502471924
Epoch: 23, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.937 Vali Acc: 0.519 Test Loss: 1.937 Test Acc: 0.519
Validation loss decreased (-0.511431 --> -0.519065).  Saving model ...
Epoch: 24 cost time: 1.0103681087493896
Epoch: 24, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.938 Vali Acc: 0.519 Test Loss: 1.938 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0832607746124268
Epoch: 25, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.943 Vali Acc: 0.519 Test Loss: 1.943 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.1095211505889893
Epoch: 26, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.950 Vali Acc: 0.527 Test Loss: 1.950 Test Acc: 0.527
Validation loss decreased (-0.519065 --> -0.526698).  Saving model ...
Epoch: 27 cost time: 1.0510947704315186
Epoch: 27, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.957 Vali Acc: 0.534 Test Loss: 1.957 Test Acc: 0.534
Validation loss decreased (-0.526698 --> -0.534332).  Saving model ...
Epoch: 28 cost time: 1.2329795360565186
Epoch: 28, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.967 Vali Acc: 0.534 Test Loss: 1.967 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.9377901554107666
Epoch: 29, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.975 Vali Acc: 0.527 Test Loss: 1.975 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.1228854656219482
Epoch: 30, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.981 Vali Acc: 0.527 Test Loss: 1.981 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.1228995323181152
Epoch: 31, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.990 Vali Acc: 0.527 Test Loss: 1.990 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.9437406063079834
Epoch: 32, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.999 Vali Acc: 0.527 Test Loss: 1.999 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.8497073650360107
Epoch: 33, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.006 Vali Acc: 0.527 Test Loss: 2.006 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.9868848323822021
Epoch: 34, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.013 Vali Acc: 0.527 Test Loss: 2.013 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.0181567668914795
Epoch: 35, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.014 Vali Acc: 0.527 Test Loss: 2.014 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.218024730682373
Epoch: 36, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.016 Vali Acc: 0.527 Test Loss: 2.016 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.9838888645172119
Epoch: 37, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.022 Vali Acc: 0.527 Test Loss: 2.022 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps1124_str1124_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 44827397
model size : 185.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps1199_str300_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.5987162590026855
Epoch: 1, Steps: 8 | Train Loss: 1.538 Vali Loss: 1.581 Vali Acc: 0.420 Test Loss: 1.581 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 1.240156650543213
Epoch: 2, Steps: 8 | Train Loss: 1.386 Vali Loss: 1.425 Vali Acc: 0.443 Test Loss: 1.425 Test Acc: 0.443
Validation loss decreased (-0.419832 --> -0.442734).  Saving model ...
Epoch: 3 cost time: 1.2694008350372314
Epoch: 3, Steps: 8 | Train Loss: 1.015 Vali Loss: 1.402 Vali Acc: 0.489 Test Loss: 1.402 Test Acc: 0.489
Validation loss decreased (-0.442734 --> -0.488536).  Saving model ...
Epoch: 4 cost time: 1.3746991157531738
Epoch: 4, Steps: 8 | Train Loss: 0.685 Vali Loss: 1.343 Vali Acc: 0.496 Test Loss: 1.343 Test Acc: 0.496
Validation loss decreased (-0.488536 --> -0.496170).  Saving model ...
Epoch: 5 cost time: 1.2366816997528076
Epoch: 5, Steps: 8 | Train Loss: 0.293 Vali Loss: 1.339 Vali Acc: 0.473 Test Loss: 1.339 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.276841640472412
Epoch: 6, Steps: 8 | Train Loss: 0.110 Vali Loss: 1.512 Vali Acc: 0.496 Test Loss: 1.512 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.396904706954956
Epoch: 7, Steps: 8 | Train Loss: 0.030 Vali Loss: 1.549 Vali Acc: 0.504 Test Loss: 1.549 Test Acc: 0.504
Validation loss decreased (-0.496170 --> -0.503801).  Saving model ...
Epoch: 8 cost time: 1.1161689758300781
Epoch: 8, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.670 Vali Acc: 0.496 Test Loss: 1.670 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2333149909973145
Epoch: 9, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.917 Vali Acc: 0.511 Test Loss: 1.917 Test Acc: 0.511
Validation loss decreased (-0.503801 --> -0.511431).  Saving model ...
Epoch: 10 cost time: 1.2962923049926758
Epoch: 10, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.864 Vali Acc: 0.466 Test Loss: 1.864 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.179163932800293
Epoch: 11, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.833 Vali Acc: 0.481 Test Loss: 1.833 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1311192512512207
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.858 Vali Acc: 0.534 Test Loss: 1.858 Test Acc: 0.534
Validation loss decreased (-0.511431 --> -0.534333).  Saving model ...
Epoch: 13 cost time: 1.1924076080322266
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.856 Vali Acc: 0.542 Test Loss: 1.856 Test Acc: 0.542
Validation loss decreased (-0.534333 --> -0.541966).  Saving model ...
Epoch: 14 cost time: 1.566150188446045
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.838 Vali Acc: 0.542 Test Loss: 1.838 Test Acc: 0.542
Validation loss decreased (-0.541966 --> -0.541966).  Saving model ...
Epoch: 15 cost time: 1.2558701038360596
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.832 Vali Acc: 0.550 Test Loss: 1.832 Test Acc: 0.550
Validation loss decreased (-0.541966 --> -0.549600).  Saving model ...
Epoch: 16 cost time: 1.2970328330993652
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.822 Vali Acc: 0.557 Test Loss: 1.822 Test Acc: 0.557
Validation loss decreased (-0.549600 --> -0.557234).  Saving model ...
Epoch: 17 cost time: 1.257490873336792
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.815 Vali Acc: 0.550 Test Loss: 1.815 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.370171308517456
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.817 Vali Acc: 0.542 Test Loss: 1.817 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.2753963470458984
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.825 Vali Acc: 0.542 Test Loss: 1.825 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.4268324375152588
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.840 Vali Acc: 0.542 Test Loss: 1.840 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.2299981117248535
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.860 Vali Acc: 0.534 Test Loss: 1.860 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.1048333644866943
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.879 Vali Acc: 0.542 Test Loss: 1.879 Test Acc: 0.542
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.2778987884521484
Epoch: 23, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.891 Vali Acc: 0.527 Test Loss: 1.891 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.3890810012817383
Epoch: 24, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.892 Vali Acc: 0.527 Test Loss: 1.892 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.1115708351135254
Epoch: 25, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.888 Vali Acc: 0.527 Test Loss: 1.888 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.0840578079223633
Epoch: 26, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.894 Vali Acc: 0.527 Test Loss: 1.894 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps1199_str300_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 46079237
model size : 190.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps1199_str600_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.419034957885742
Epoch: 1, Steps: 8 | Train Loss: 1.541 Vali Loss: 1.600 Vali Acc: 0.420 Test Loss: 1.600 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 1.3857448101043701
Epoch: 2, Steps: 8 | Train Loss: 1.350 Vali Loss: 1.593 Vali Acc: 0.458 Test Loss: 1.593 Test Acc: 0.458
Validation loss decreased (-0.419831 --> -0.457999).  Saving model ...
Epoch: 3 cost time: 1.191877841949463
Epoch: 3, Steps: 8 | Train Loss: 1.031 Vali Loss: 1.505 Vali Acc: 0.450 Test Loss: 1.505 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2903954982757568
Epoch: 4, Steps: 8 | Train Loss: 0.700 Vali Loss: 1.439 Vali Acc: 0.481 Test Loss: 1.439 Test Acc: 0.481
Validation loss decreased (-0.457999 --> -0.480902).  Saving model ...
Epoch: 5 cost time: 1.2290093898773193
Epoch: 5, Steps: 8 | Train Loss: 0.361 Vali Loss: 1.407 Vali Acc: 0.489 Test Loss: 1.407 Test Acc: 0.489
Validation loss decreased (-0.480902 --> -0.488536).  Saving model ...
Epoch: 6 cost time: 1.4414143562316895
Epoch: 6, Steps: 8 | Train Loss: 0.147 Vali Loss: 1.409 Vali Acc: 0.489 Test Loss: 1.409 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5344581604003906
Epoch: 7, Steps: 8 | Train Loss: 0.036 Vali Loss: 1.475 Vali Acc: 0.489 Test Loss: 1.475 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.3459491729736328
Epoch: 8, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.606 Vali Acc: 0.504 Test Loss: 1.606 Test Acc: 0.504
Validation loss decreased (-0.488536 --> -0.503801).  Saving model ...
Epoch: 9 cost time: 1.4326584339141846
Epoch: 9, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.556 Vali Acc: 0.504 Test Loss: 1.556 Test Acc: 0.504
Validation loss decreased (-0.503801 --> -0.503801).  Saving model ...
Epoch: 10 cost time: 1.3567397594451904
Epoch: 10, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.529 Vali Acc: 0.519 Test Loss: 1.529 Test Acc: 0.519
Validation loss decreased (-0.503801 --> -0.519069).  Saving model ...
Epoch: 11 cost time: 1.1539082527160645
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.567 Vali Acc: 0.534 Test Loss: 1.567 Test Acc: 0.534
Validation loss decreased (-0.519069 --> -0.534335).  Saving model ...
Epoch: 12 cost time: 1.5020396709442139
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.612 Vali Acc: 0.527 Test Loss: 1.612 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3491203784942627
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.632 Vali Acc: 0.534 Test Loss: 1.632 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.4549682140350342
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.643 Vali Acc: 0.534 Test Loss: 1.643 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.335451602935791
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.653 Vali Acc: 0.534 Test Loss: 1.653 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.2640774250030518
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.662 Vali Acc: 0.534 Test Loss: 1.662 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.2970764636993408
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.665 Vali Acc: 0.534 Test Loss: 1.665 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.2212347984313965
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.683 Vali Acc: 0.534 Test Loss: 1.683 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.2814562320709229
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.689 Vali Acc: 0.534 Test Loss: 1.689 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.966066837310791
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.694 Vali Acc: 0.534 Test Loss: 1.694 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.9045810699462891
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.704 Vali Acc: 0.534 Test Loss: 1.704 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps1199_str600_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 45928709
model size : 189.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps1199_str1199_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.2958030700683594
Epoch: 1, Steps: 8 | Train Loss: 1.557 Vali Loss: 1.545 Vali Acc: 0.420 Test Loss: 1.545 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 0.9599494934082031
Epoch: 2, Steps: 8 | Train Loss: 1.329 Vali Loss: 1.492 Vali Acc: 0.443 Test Loss: 1.492 Test Acc: 0.443
Validation loss decreased (-0.419832 --> -0.442733).  Saving model ...
Epoch: 3 cost time: 1.266955852508545
Epoch: 3, Steps: 8 | Train Loss: 1.041 Vali Loss: 1.391 Vali Acc: 0.565 Test Loss: 1.391 Test Acc: 0.565
Validation loss decreased (-0.442733 --> -0.564872).  Saving model ...
Epoch: 4 cost time: 1.4454843997955322
Epoch: 4, Steps: 8 | Train Loss: 0.748 Vali Loss: 1.290 Vali Acc: 0.527 Test Loss: 1.290 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4706504344940186
Epoch: 5, Steps: 8 | Train Loss: 0.421 Vali Loss: 1.359 Vali Acc: 0.489 Test Loss: 1.359 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.2009541988372803
Epoch: 6, Steps: 8 | Train Loss: 0.190 Vali Loss: 1.343 Vali Acc: 0.450 Test Loss: 1.343 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.25801420211792
Epoch: 7, Steps: 8 | Train Loss: 0.064 Vali Loss: 1.492 Vali Acc: 0.489 Test Loss: 1.492 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.0358867645263672
Epoch: 8, Steps: 8 | Train Loss: 0.021 Vali Loss: 1.458 Vali Acc: 0.481 Test Loss: 1.458 Test Acc: 0.481
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.0632071495056152
Epoch: 9, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.457 Vali Acc: 0.504 Test Loss: 1.457 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.1502890586853027
Epoch: 10, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.539 Vali Acc: 0.519 Test Loss: 1.539 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.8384406566619873
Epoch: 11, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.597 Vali Acc: 0.519 Test Loss: 1.597 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.9835669994354248
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.626 Vali Acc: 0.511 Test Loss: 1.626 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.295285940170288
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.647 Vali Acc: 0.496 Test Loss: 1.647 Test Acc: 0.496
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps1199_str1199_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5648854961832062
model parameter : 45853445
model size : 189.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps1285_str322_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.1273293495178223
Epoch: 1, Steps: 8 | Train Loss: 1.508 Vali Loss: 1.583 Vali Acc: 0.420 Test Loss: 1.583 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 1.6108291149139404
Epoch: 2, Steps: 8 | Train Loss: 1.318 Vali Loss: 1.447 Vali Acc: 0.458 Test Loss: 1.447 Test Acc: 0.458
Validation loss decreased (-0.419831 --> -0.458001).  Saving model ...
Epoch: 3 cost time: 1.5570948123931885
Epoch: 3, Steps: 8 | Train Loss: 0.993 Vali Loss: 1.358 Vali Acc: 0.489 Test Loss: 1.358 Test Acc: 0.489
Validation loss decreased (-0.458001 --> -0.488536).  Saving model ...
Epoch: 4 cost time: 1.6444838047027588
Epoch: 4, Steps: 8 | Train Loss: 0.621 Vali Loss: 1.379 Vali Acc: 0.527 Test Loss: 1.379 Test Acc: 0.527
Validation loss decreased (-0.488536 --> -0.526704).  Saving model ...
Epoch: 5 cost time: 1.3226063251495361
Epoch: 5, Steps: 8 | Train Loss: 0.291 Vali Loss: 1.297 Vali Acc: 0.519 Test Loss: 1.297 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7427003383636475
Epoch: 6, Steps: 8 | Train Loss: 0.127 Vali Loss: 1.436 Vali Acc: 0.542 Test Loss: 1.436 Test Acc: 0.542
Validation loss decreased (-0.526704 --> -0.541970).  Saving model ...
Epoch: 7 cost time: 1.2535300254821777
Epoch: 7, Steps: 8 | Train Loss: 0.027 Vali Loss: 1.269 Vali Acc: 0.573 Test Loss: 1.269 Test Acc: 0.573
Validation loss decreased (-0.541970 --> -0.572506).  Saving model ...
Epoch: 8 cost time: 2.0371158123016357
Epoch: 8, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.502 Vali Acc: 0.550 Test Loss: 1.502 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5016872882843018
Epoch: 9, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.567 Vali Acc: 0.557 Test Loss: 1.567 Test Acc: 0.557
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.852484941482544
Epoch: 10, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.533 Vali Acc: 0.573 Test Loss: 1.533 Test Acc: 0.573
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.471968173980713
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.526 Vali Acc: 0.557 Test Loss: 1.526 Test Acc: 0.557
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.6114208698272705
Epoch: 12, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.538 Vali Acc: 0.565 Test Loss: 1.538 Test Acc: 0.565
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.6519529819488525
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.571 Vali Acc: 0.565 Test Loss: 1.571 Test Acc: 0.565
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.6037383079528809
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.597 Vali Acc: 0.565 Test Loss: 1.597 Test Acc: 0.565
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.1276469230651855
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.617 Vali Acc: 0.565 Test Loss: 1.617 Test Acc: 0.565
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.371044397354126
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.635 Vali Acc: 0.565 Test Loss: 1.635 Test Acc: 0.565
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.535801887512207
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.659 Vali Acc: 0.565 Test Loss: 1.659 Test Acc: 0.565
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps1285_str322_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5725190839694656
model parameter : 47246597
model size : 194.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps1285_str643_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.2842631340026855
Epoch: 1, Steps: 8 | Train Loss: 1.531 Vali Loss: 1.598 Vali Acc: 0.420 Test Loss: 1.598 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 1.252685785293579
Epoch: 2, Steps: 8 | Train Loss: 1.356 Vali Loss: 1.498 Vali Acc: 0.435 Test Loss: 1.498 Test Acc: 0.435
Validation loss decreased (-0.419831 --> -0.435100).  Saving model ...
Epoch: 3 cost time: 1.3632900714874268
Epoch: 3, Steps: 8 | Train Loss: 1.085 Vali Loss: 1.485 Vali Acc: 0.458 Test Loss: 1.485 Test Acc: 0.458
Validation loss decreased (-0.435100 --> -0.458000).  Saving model ...
Epoch: 4 cost time: 1.4724278450012207
Epoch: 4, Steps: 8 | Train Loss: 0.742 Vali Loss: 1.476 Vali Acc: 0.458 Test Loss: 1.476 Test Acc: 0.458
Validation loss decreased (-0.458000 --> -0.458001).  Saving model ...
Epoch: 5 cost time: 1.277221918106079
Epoch: 5, Steps: 8 | Train Loss: 0.400 Vali Loss: 1.378 Vali Acc: 0.473 Test Loss: 1.378 Test Acc: 0.473
Validation loss decreased (-0.458001 --> -0.473269).  Saving model ...
Epoch: 6 cost time: 1.225083589553833
Epoch: 6, Steps: 8 | Train Loss: 0.155 Vali Loss: 1.412 Vali Acc: 0.519 Test Loss: 1.412 Test Acc: 0.519
Validation loss decreased (-0.473269 --> -0.519070).  Saving model ...
Epoch: 7 cost time: 1.4241411685943604
Epoch: 7, Steps: 8 | Train Loss: 0.047 Vali Loss: 1.440 Vali Acc: 0.519 Test Loss: 1.440 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4673502445220947
Epoch: 8, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.432 Vali Acc: 0.565 Test Loss: 1.432 Test Acc: 0.565
Validation loss decreased (-0.519070 --> -0.564871).  Saving model ...
Epoch: 9 cost time: 1.299180507659912
Epoch: 9, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.486 Vali Acc: 0.550 Test Loss: 1.486 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2702605724334717
Epoch: 10, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.535 Vali Acc: 0.580 Test Loss: 1.535 Test Acc: 0.580
Validation loss decreased (-0.564871 --> -0.580137).  Saving model ...
Epoch: 11 cost time: 1.1701271533966064
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.554 Vali Acc: 0.573 Test Loss: 1.554 Test Acc: 0.573
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1995234489440918
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.586 Vali Acc: 0.573 Test Loss: 1.586 Test Acc: 0.573
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1770429611206055
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.624 Vali Acc: 0.573 Test Loss: 1.624 Test Acc: 0.573
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.339916706085205
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.642 Vali Acc: 0.565 Test Loss: 1.642 Test Acc: 0.565
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.2478728294372559
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.661 Vali Acc: 0.557 Test Loss: 1.661 Test Acc: 0.557
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.6246132850646973
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.663 Vali Acc: 0.573 Test Loss: 1.663 Test Acc: 0.573
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.4479153156280518
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.660 Vali Acc: 0.565 Test Loss: 1.660 Test Acc: 0.565
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.5408625602722168
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.674 Vali Acc: 0.565 Test Loss: 1.674 Test Acc: 0.565
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.5382273197174072
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.693 Vali Acc: 0.565 Test Loss: 1.693 Test Acc: 0.565
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.7228431701660156
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.708 Vali Acc: 0.565 Test Loss: 1.708 Test Acc: 0.565
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps1285_str643_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5801526717557252
model parameter : 47106821
model size : 194.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps1285_str1285_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.785377264022827
Epoch: 1, Steps: 8 | Train Loss: 1.503 Vali Loss: 1.580 Vali Acc: 0.420 Test Loss: 1.580 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 0.9691219329833984
Epoch: 2, Steps: 8 | Train Loss: 1.343 Vali Loss: 1.522 Vali Acc: 0.450 Test Loss: 1.522 Test Acc: 0.450
Validation loss decreased (-0.419832 --> -0.450366).  Saving model ...
Epoch: 3 cost time: 1.1083903312683105
Epoch: 3, Steps: 8 | Train Loss: 1.043 Vali Loss: 1.499 Vali Acc: 0.443 Test Loss: 1.499 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1911606788635254
Epoch: 4, Steps: 8 | Train Loss: 0.695 Vali Loss: 1.399 Vali Acc: 0.504 Test Loss: 1.399 Test Acc: 0.504
Validation loss decreased (-0.450366 --> -0.503803).  Saving model ...
Epoch: 5 cost time: 1.2378931045532227
Epoch: 5, Steps: 8 | Train Loss: 0.377 Vali Loss: 1.369 Vali Acc: 0.489 Test Loss: 1.369 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0334093570709229
Epoch: 6, Steps: 8 | Train Loss: 0.163 Vali Loss: 1.507 Vali Acc: 0.527 Test Loss: 1.507 Test Acc: 0.527
Validation loss decreased (-0.503803 --> -0.526702).  Saving model ...
Epoch: 7 cost time: 1.2573559284210205
Epoch: 7, Steps: 8 | Train Loss: 0.057 Vali Loss: 1.585 Vali Acc: 0.534 Test Loss: 1.585 Test Acc: 0.534
Validation loss decreased (-0.526702 --> -0.534335).  Saving model ...
Epoch: 8 cost time: 1.7114832401275635
Epoch: 8, Steps: 8 | Train Loss: 0.023 Vali Loss: 1.599 Vali Acc: 0.481 Test Loss: 1.599 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4588007926940918
Epoch: 9, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.723 Vali Acc: 0.504 Test Loss: 1.723 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.445042610168457
Epoch: 10, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.791 Vali Acc: 0.534 Test Loss: 1.791 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.2104542255401611
Epoch: 11, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.780 Vali Acc: 0.519 Test Loss: 1.780 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.6957366466522217
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.773 Vali Acc: 0.519 Test Loss: 1.773 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.4972352981567383
Epoch: 13, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.796 Vali Acc: 0.519 Test Loss: 1.796 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.3522312641143799
Epoch: 14, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.826 Vali Acc: 0.519 Test Loss: 1.826 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.314650297164917
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.837 Vali Acc: 0.527 Test Loss: 1.837 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.3490593433380127
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.848 Vali Acc: 0.527 Test Loss: 1.848 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.3090384006500244
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.837 Vali Acc: 0.542 Test Loss: 1.837 Test Acc: 0.542
Validation loss decreased (-0.534335 --> -0.541966).  Saving model ...
Epoch: 18 cost time: 1.3906545639038086
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.842 Vali Acc: 0.542 Test Loss: 1.842 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.325744867324829
Epoch: 19, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.861 Vali Acc: 0.542 Test Loss: 1.861 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.2484025955200195
Epoch: 20, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.881 Vali Acc: 0.534 Test Loss: 1.881 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.2457642555236816
Epoch: 21, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.880 Vali Acc: 0.534 Test Loss: 1.880 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.3049545288085938
Epoch: 22, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.884 Vali Acc: 0.534 Test Loss: 1.884 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.3004751205444336
Epoch: 23, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.882 Vali Acc: 0.534 Test Loss: 1.882 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.1710376739501953
Epoch: 24, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.880 Vali Acc: 0.527 Test Loss: 1.880 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.4440367221832275
Epoch: 25, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.884 Vali Acc: 0.527 Test Loss: 1.884 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.2908036708831787
Epoch: 26, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.892 Vali Acc: 0.527 Test Loss: 1.892 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.441990852355957
Epoch: 27, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.902 Vali Acc: 0.527 Test Loss: 1.902 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps1285_str1285_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 47036933
model size : 194.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps1384_str346_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.062957763671875
Epoch: 1, Steps: 8 | Train Loss: 1.535 Vali Loss: 1.552 Vali Acc: 0.412 Test Loss: 1.552 Test Acc: 0.412
Validation loss decreased (inf --> -0.412198).  Saving model ...
Epoch: 2 cost time: 1.3052003383636475
Epoch: 2, Steps: 8 | Train Loss: 1.387 Vali Loss: 1.544 Vali Acc: 0.427 Test Loss: 1.544 Test Acc: 0.427
Validation loss decreased (-0.412198 --> -0.427465).  Saving model ...
Epoch: 3 cost time: 0.9549663066864014
Epoch: 3, Steps: 8 | Train Loss: 1.044 Vali Loss: 1.421 Vali Acc: 0.489 Test Loss: 1.421 Test Acc: 0.489
Validation loss decreased (-0.427465 --> -0.488535).  Saving model ...
Epoch: 4 cost time: 1.3174612522125244
Epoch: 4, Steps: 8 | Train Loss: 0.698 Vali Loss: 1.416 Vali Acc: 0.511 Test Loss: 1.416 Test Acc: 0.511
Validation loss decreased (-0.488535 --> -0.511436).  Saving model ...
Epoch: 5 cost time: 1.5199174880981445
Epoch: 5, Steps: 8 | Train Loss: 0.361 Vali Loss: 1.274 Vali Acc: 0.489 Test Loss: 1.274 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.172431468963623
Epoch: 6, Steps: 8 | Train Loss: 0.100 Vali Loss: 1.479 Vali Acc: 0.496 Test Loss: 1.479 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1284515857696533
Epoch: 7, Steps: 8 | Train Loss: 0.027 Vali Loss: 1.382 Vali Acc: 0.573 Test Loss: 1.382 Test Acc: 0.573
Validation loss decreased (-0.511436 --> -0.572505).  Saving model ...
Epoch: 8 cost time: 1.2205331325531006
Epoch: 8, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.451 Vali Acc: 0.542 Test Loss: 1.451 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3361248970031738
Epoch: 9, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.474 Vali Acc: 0.534 Test Loss: 1.474 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.1679332256317139
Epoch: 10, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.581 Vali Acc: 0.565 Test Loss: 1.581 Test Acc: 0.565
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.3072459697723389
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.639 Vali Acc: 0.580 Test Loss: 1.639 Test Acc: 0.580
Validation loss decreased (-0.572505 --> -0.580136).  Saving model ...
Epoch: 12 cost time: 0.9299297332763672
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.640 Vali Acc: 0.580 Test Loss: 1.640 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4333813190460205
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.628 Vali Acc: 0.573 Test Loss: 1.628 Test Acc: 0.573
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.2153360843658447
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.620 Vali Acc: 0.580 Test Loss: 1.620 Test Acc: 0.580
Validation loss decreased (-0.580136 --> -0.580136).  Saving model ...
Epoch: 15 cost time: 1.406473159790039
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.630 Vali Acc: 0.573 Test Loss: 1.630 Test Acc: 0.573
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.494356393814087
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.638 Vali Acc: 0.580 Test Loss: 1.638 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.5345139503479004
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.639 Vali Acc: 0.573 Test Loss: 1.639 Test Acc: 0.573
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.7134628295898438
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.637 Vali Acc: 0.580 Test Loss: 1.637 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.3300375938415527
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.633 Vali Acc: 0.573 Test Loss: 1.633 Test Acc: 0.573
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.3975269794464111
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.635 Vali Acc: 0.580 Test Loss: 1.635 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.5243680477142334
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.647 Vali Acc: 0.573 Test Loss: 1.647 Test Acc: 0.573
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.3845205307006836
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.654 Vali Acc: 0.573 Test Loss: 1.654 Test Acc: 0.573
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.1993086338043213
Epoch: 23, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.664 Vali Acc: 0.573 Test Loss: 1.664 Test Acc: 0.573
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.1917979717254639
Epoch: 24, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.669 Vali Acc: 0.573 Test Loss: 1.669 Test Acc: 0.573
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps1384_str346_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5801526717557252
model parameter : 48593669
model size : 200.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps1384_str692_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.59706974029541
Epoch: 1, Steps: 8 | Train Loss: 1.515 Vali Loss: 1.523 Vali Acc: 0.420 Test Loss: 1.523 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 1.168013095855713
Epoch: 2, Steps: 8 | Train Loss: 1.298 Vali Loss: 1.430 Vali Acc: 0.466 Test Loss: 1.430 Test Acc: 0.466
Validation loss decreased (-0.419832 --> -0.465635).  Saving model ...
Epoch: 3 cost time: 0.8323161602020264
Epoch: 3, Steps: 8 | Train Loss: 0.948 Vali Loss: 1.344 Vali Acc: 0.527 Test Loss: 1.344 Test Acc: 0.527
Validation loss decreased (-0.465635 --> -0.526704).  Saving model ...
Epoch: 4 cost time: 1.1359107494354248
Epoch: 4, Steps: 8 | Train Loss: 0.629 Vali Loss: 1.356 Vali Acc: 0.519 Test Loss: 1.356 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1002156734466553
Epoch: 5, Steps: 8 | Train Loss: 0.360 Vali Loss: 1.400 Vali Acc: 0.458 Test Loss: 1.400 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9611012935638428
Epoch: 6, Steps: 8 | Train Loss: 0.133 Vali Loss: 1.502 Vali Acc: 0.443 Test Loss: 1.502 Test Acc: 0.443
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.072139024734497
Epoch: 7, Steps: 8 | Train Loss: 0.045 Vali Loss: 1.361 Vali Acc: 0.481 Test Loss: 1.361 Test Acc: 0.481
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.1282391548156738
Epoch: 8, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.480 Vali Acc: 0.481 Test Loss: 1.480 Test Acc: 0.481
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.2198116779327393
Epoch: 9, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.638 Vali Acc: 0.504 Test Loss: 1.638 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.1249079704284668
Epoch: 10, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.610 Vali Acc: 0.496 Test Loss: 1.610 Test Acc: 0.496
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.0899109840393066
Epoch: 11, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.562 Vali Acc: 0.534 Test Loss: 1.562 Test Acc: 0.534
Validation loss decreased (-0.526704 --> -0.534336).  Saving model ...
Epoch: 12 cost time: 1.0949156284332275
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.564 Vali Acc: 0.534 Test Loss: 1.564 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8494648933410645
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.590 Vali Acc: 0.534 Test Loss: 1.590 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.2929284572601318
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.623 Vali Acc: 0.527 Test Loss: 1.623 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.0300564765930176
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.651 Vali Acc: 0.527 Test Loss: 1.651 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.1278414726257324
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.663 Vali Acc: 0.527 Test Loss: 1.663 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.0808086395263672
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.679 Vali Acc: 0.527 Test Loss: 1.679 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.2745301723480225
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.681 Vali Acc: 0.519 Test Loss: 1.681 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.6063222885131836
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.684 Vali Acc: 0.519 Test Loss: 1.684 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.418748378753662
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.685 Vali Acc: 0.519 Test Loss: 1.685 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.3691847324371338
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.686 Vali Acc: 0.519 Test Loss: 1.686 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps1384_str692_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 48464645
model size : 199.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps1384_str1384_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.354343891143799
Epoch: 1, Steps: 8 | Train Loss: 1.539 Vali Loss: 1.603 Vali Acc: 0.420 Test Loss: 1.603 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 1.0731685161590576
Epoch: 2, Steps: 8 | Train Loss: 1.326 Vali Loss: 1.468 Vali Acc: 0.427 Test Loss: 1.468 Test Acc: 0.427
Validation loss decreased (-0.419831 --> -0.427466).  Saving model ...
Epoch: 3 cost time: 0.8652870655059814
Epoch: 3, Steps: 8 | Train Loss: 1.031 Vali Loss: 1.372 Vali Acc: 0.519 Test Loss: 1.372 Test Acc: 0.519
Validation loss decreased (-0.427466 --> -0.519070).  Saving model ...
Epoch: 4 cost time: 1.0648460388183594
Epoch: 4, Steps: 8 | Train Loss: 0.693 Vali Loss: 1.416 Vali Acc: 0.496 Test Loss: 1.416 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9792191982269287
Epoch: 5, Steps: 8 | Train Loss: 0.359 Vali Loss: 1.509 Vali Acc: 0.481 Test Loss: 1.509 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.0569207668304443
Epoch: 6, Steps: 8 | Train Loss: 0.138 Vali Loss: 1.562 Vali Acc: 0.466 Test Loss: 1.562 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.108109712600708
Epoch: 7, Steps: 8 | Train Loss: 0.060 Vali Loss: 1.669 Vali Acc: 0.489 Test Loss: 1.669 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.2199950218200684
Epoch: 8, Steps: 8 | Train Loss: 0.020 Vali Loss: 1.875 Vali Acc: 0.511 Test Loss: 1.875 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.0515859127044678
Epoch: 9, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.929 Vali Acc: 0.481 Test Loss: 1.929 Test Acc: 0.481
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.138232707977295
Epoch: 10, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.917 Vali Acc: 0.489 Test Loss: 1.917 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.1546761989593506
Epoch: 11, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.922 Vali Acc: 0.489 Test Loss: 1.922 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.0466294288635254
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.949 Vali Acc: 0.489 Test Loss: 1.949 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.2622871398925781
Epoch: 13, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.988 Vali Acc: 0.496 Test Loss: 1.988 Test Acc: 0.496
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps1384_str1384_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 48400133
model size : 199.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps1499_str375_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.6917266845703125
Epoch: 1, Steps: 8 | Train Loss: 1.572 Vali Loss: 1.639 Vali Acc: 0.420 Test Loss: 1.639 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 1.4487473964691162
Epoch: 2, Steps: 8 | Train Loss: 1.356 Vali Loss: 1.550 Vali Acc: 0.427 Test Loss: 1.550 Test Acc: 0.427
Validation loss decreased (-0.419831 --> -0.427465).  Saving model ...
Epoch: 3 cost time: 1.0423758029937744
Epoch: 3, Steps: 8 | Train Loss: 0.982 Vali Loss: 1.440 Vali Acc: 0.443 Test Loss: 1.440 Test Acc: 0.443
Validation loss decreased (-0.427465 --> -0.442734).  Saving model ...
Epoch: 4 cost time: 1.6150867938995361
Epoch: 4, Steps: 8 | Train Loss: 0.579 Vali Loss: 1.449 Vali Acc: 0.489 Test Loss: 1.449 Test Acc: 0.489
Validation loss decreased (-0.442734 --> -0.488535).  Saving model ...
Epoch: 5 cost time: 1.6356971263885498
Epoch: 5, Steps: 8 | Train Loss: 0.234 Vali Loss: 1.404 Vali Acc: 0.481 Test Loss: 1.404 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.36812424659729
Epoch: 6, Steps: 8 | Train Loss: 0.075 Vali Loss: 1.668 Vali Acc: 0.420 Test Loss: 1.668 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.2335150241851807
Epoch: 7, Steps: 8 | Train Loss: 0.022 Vali Loss: 1.650 Vali Acc: 0.519 Test Loss: 1.650 Test Acc: 0.519
Validation loss decreased (-0.488535 --> -0.519067).  Saving model ...
Epoch: 8 cost time: 1.7268602848052979
Epoch: 8, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.829 Vali Acc: 0.435 Test Loss: 1.829 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6197826862335205
Epoch: 9, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.957 Vali Acc: 0.473 Test Loss: 1.957 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.5602262020111084
Epoch: 10, Steps: 8 | Train Loss: 0.002 Vali Loss: 2.078 Vali Acc: 0.420 Test Loss: 2.078 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.4988741874694824
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.103 Vali Acc: 0.443 Test Loss: 2.103 Test Acc: 0.443
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.838212490081787
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.068 Vali Acc: 0.450 Test Loss: 2.068 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.5212702751159668
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.047 Vali Acc: 0.473 Test Loss: 2.047 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.5883140563964844
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.046 Vali Acc: 0.481 Test Loss: 2.046 Test Acc: 0.481
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.5802018642425537
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.057 Vali Acc: 0.489 Test Loss: 2.057 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.5872340202331543
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.079 Vali Acc: 0.489 Test Loss: 2.079 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.4309465885162354
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.089 Vali Acc: 0.481 Test Loss: 2.089 Test Acc: 0.481
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps1499_str375_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 50161925
model size : 206.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps1499_str750_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.958557367324829
Epoch: 1, Steps: 8 | Train Loss: 1.531 Vali Loss: 1.575 Vali Acc: 0.420 Test Loss: 1.575 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 1.1606414318084717
Epoch: 2, Steps: 8 | Train Loss: 1.289 Vali Loss: 1.478 Vali Acc: 0.443 Test Loss: 1.478 Test Acc: 0.443
Validation loss decreased (-0.419832 --> -0.442733).  Saving model ...
Epoch: 3 cost time: 1.2566375732421875
Epoch: 3, Steps: 8 | Train Loss: 0.979 Vali Loss: 1.359 Vali Acc: 0.481 Test Loss: 1.359 Test Acc: 0.481
Validation loss decreased (-0.442733 --> -0.480902).  Saving model ...
Epoch: 4 cost time: 1.2059221267700195
Epoch: 4, Steps: 8 | Train Loss: 0.637 Vali Loss: 1.427 Vali Acc: 0.496 Test Loss: 1.427 Test Acc: 0.496
Validation loss decreased (-0.480902 --> -0.496169).  Saving model ...
Epoch: 5 cost time: 1.1571869850158691
Epoch: 5, Steps: 8 | Train Loss: 0.301 Vali Loss: 1.327 Vali Acc: 0.557 Test Loss: 1.327 Test Acc: 0.557
Validation loss decreased (-0.496169 --> -0.557239).  Saving model ...
Epoch: 6 cost time: 1.2336955070495605
Epoch: 6, Steps: 8 | Train Loss: 0.100 Vali Loss: 1.440 Vali Acc: 0.504 Test Loss: 1.440 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.400712490081787
Epoch: 7, Steps: 8 | Train Loss: 0.031 Vali Loss: 1.385 Vali Acc: 0.511 Test Loss: 1.385 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.3649914264678955
Epoch: 8, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.413 Vali Acc: 0.519 Test Loss: 1.413 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.4695625305175781
Epoch: 9, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.464 Vali Acc: 0.534 Test Loss: 1.464 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.5435905456542969
Epoch: 10, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.540 Vali Acc: 0.519 Test Loss: 1.540 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.1973938941955566
Epoch: 11, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.560 Vali Acc: 0.550 Test Loss: 1.560 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.2552294731140137
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.554 Vali Acc: 0.534 Test Loss: 1.554 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.3392808437347412
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.552 Vali Acc: 0.542 Test Loss: 1.552 Test Acc: 0.542
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.3039002418518066
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.564 Vali Acc: 0.542 Test Loss: 1.564 Test Acc: 0.542
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.3638625144958496
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.576 Vali Acc: 0.542 Test Loss: 1.576 Test Acc: 0.542
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps1499_str750_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 50043653
model size : 205.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps1499_str1499_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.9497313499450684
Epoch: 1, Steps: 8 | Train Loss: 1.486 Vali Loss: 1.532 Vali Acc: 0.420 Test Loss: 1.532 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 1.2782328128814697
Epoch: 2, Steps: 8 | Train Loss: 1.342 Vali Loss: 1.482 Vali Acc: 0.443 Test Loss: 1.482 Test Acc: 0.443
Validation loss decreased (-0.419832 --> -0.442733).  Saving model ...
Epoch: 3 cost time: 1.276900291442871
Epoch: 3, Steps: 8 | Train Loss: 1.039 Vali Loss: 1.429 Vali Acc: 0.481 Test Loss: 1.429 Test Acc: 0.481
Validation loss decreased (-0.442733 --> -0.480902).  Saving model ...
Epoch: 4 cost time: 1.1171748638153076
Epoch: 4, Steps: 8 | Train Loss: 0.687 Vali Loss: 1.417 Vali Acc: 0.481 Test Loss: 1.417 Test Acc: 0.481
Validation loss decreased (-0.480902 --> -0.480902).  Saving model ...
Epoch: 5 cost time: 1.242621898651123
Epoch: 5, Steps: 8 | Train Loss: 0.341 Vali Loss: 1.389 Vali Acc: 0.504 Test Loss: 1.389 Test Acc: 0.504
Validation loss decreased (-0.480902 --> -0.503803).  Saving model ...
Epoch: 6 cost time: 1.2848095893859863
Epoch: 6, Steps: 8 | Train Loss: 0.124 Vali Loss: 1.382 Vali Acc: 0.489 Test Loss: 1.382 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2098255157470703
Epoch: 7, Steps: 8 | Train Loss: 0.050 Vali Loss: 1.484 Vali Acc: 0.496 Test Loss: 1.484 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1865642070770264
Epoch: 8, Steps: 8 | Train Loss: 0.021 Vali Loss: 1.541 Vali Acc: 0.481 Test Loss: 1.541 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.4342997074127197
Epoch: 9, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.543 Vali Acc: 0.489 Test Loss: 1.543 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.287956714630127
Epoch: 10, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.565 Vali Acc: 0.496 Test Loss: 1.565 Test Acc: 0.496
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.603851556777954
Epoch: 11, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.576 Vali Acc: 0.489 Test Loss: 1.576 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.2772023677825928
Epoch: 12, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.583 Vali Acc: 0.489 Test Loss: 1.583 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.2971415519714355
Epoch: 13, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.599 Vali Acc: 0.496 Test Loss: 1.599 Test Acc: 0.496
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.3626081943511963
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.616 Vali Acc: 0.511 Test Loss: 1.616 Test Acc: 0.511
Validation loss decreased (-0.503803 --> -0.511434).  Saving model ...
Epoch: 15 cost time: 1.372377634048462
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.627 Vali Acc: 0.504 Test Loss: 1.627 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.4652493000030518
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.636 Vali Acc: 0.511 Test Loss: 1.636 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.376493215560913
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.650 Vali Acc: 0.527 Test Loss: 1.650 Test Acc: 0.527
Validation loss decreased (-0.511434 --> -0.526701).  Saving model ...
Epoch: 18 cost time: 1.5928003787994385
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.663 Vali Acc: 0.527 Test Loss: 1.663 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.187816858291626
Epoch: 19, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.672 Vali Acc: 0.527 Test Loss: 1.672 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.1232013702392578
Epoch: 20, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.679 Vali Acc: 0.527 Test Loss: 1.679 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.363191843032837
Epoch: 21, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.686 Vali Acc: 0.527 Test Loss: 1.686 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.478198766708374
Epoch: 22, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.690 Vali Acc: 0.527 Test Loss: 1.690 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.3482041358947754
Epoch: 23, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.697 Vali Acc: 0.534 Test Loss: 1.697 Test Acc: 0.534
Validation loss decreased (-0.526701 --> -0.534334).  Saving model ...
Epoch: 24 cost time: 1.1728532314300537
Epoch: 24, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.698 Vali Acc: 0.534 Test Loss: 1.698 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.3496809005737305
Epoch: 25, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.700 Vali Acc: 0.534 Test Loss: 1.700 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.235224962234497
Epoch: 26, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.704 Vali Acc: 0.534 Test Loss: 1.704 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.1383633613586426
Epoch: 27, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.705 Vali Acc: 0.534 Test Loss: 1.705 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.9323594570159912
Epoch: 28, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.706 Vali Acc: 0.527 Test Loss: 1.706 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.4040303230285645
Epoch: 29, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.705 Vali Acc: 0.527 Test Loss: 1.705 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.2694196701049805
Epoch: 30, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.705 Vali Acc: 0.527 Test Loss: 1.705 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.407015085220337
Epoch: 31, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.704 Vali Acc: 0.527 Test Loss: 1.704 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.3030641078948975
Epoch: 32, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.705 Vali Acc: 0.527 Test Loss: 1.705 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.3188798427581787
Epoch: 33, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.708 Vali Acc: 0.527 Test Loss: 1.708 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps1499_str1499_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 49984517
model size : 205.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps1635_str409_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.8674166202545166
Epoch: 1, Steps: 8 | Train Loss: 1.577 Vali Loss: 1.595 Vali Acc: 0.420 Test Loss: 1.595 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 1.209900140762329
Epoch: 2, Steps: 8 | Train Loss: 1.317 Vali Loss: 1.573 Vali Acc: 0.450 Test Loss: 1.573 Test Acc: 0.450
Validation loss decreased (-0.419831 --> -0.450366).  Saving model ...
Epoch: 3 cost time: 1.4321870803833008
Epoch: 3, Steps: 8 | Train Loss: 0.999 Vali Loss: 1.419 Vali Acc: 0.511 Test Loss: 1.419 Test Acc: 0.511
Validation loss decreased (-0.450366 --> -0.511436).  Saving model ...
Epoch: 4 cost time: 1.2234325408935547
Epoch: 4, Steps: 8 | Train Loss: 0.616 Vali Loss: 1.373 Vali Acc: 0.489 Test Loss: 1.373 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3722445964813232
Epoch: 5, Steps: 8 | Train Loss: 0.298 Vali Loss: 1.383 Vali Acc: 0.519 Test Loss: 1.383 Test Acc: 0.519
Validation loss decreased (-0.511436 --> -0.519070).  Saving model ...
Epoch: 6 cost time: 1.3761978149414062
Epoch: 6, Steps: 8 | Train Loss: 0.081 Vali Loss: 1.301 Vali Acc: 0.550 Test Loss: 1.301 Test Acc: 0.550
Validation loss decreased (-0.519070 --> -0.549605).  Saving model ...
Epoch: 7 cost time: 1.283402919769287
Epoch: 7, Steps: 8 | Train Loss: 0.026 Vali Loss: 1.454 Vali Acc: 0.550 Test Loss: 1.454 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.189279556274414
Epoch: 8, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.552 Vali Acc: 0.565 Test Loss: 1.552 Test Acc: 0.565
Validation loss decreased (-0.549605 --> -0.564870).  Saving model ...
Epoch: 9 cost time: 1.417625904083252
Epoch: 9, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.544 Vali Acc: 0.534 Test Loss: 1.544 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3223283290863037
Epoch: 10, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.456 Vali Acc: 0.565 Test Loss: 1.456 Test Acc: 0.565
Validation loss decreased (-0.564870 --> -0.564871).  Saving model ...
Epoch: 11 cost time: 1.4031744003295898
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.489 Vali Acc: 0.565 Test Loss: 1.489 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5543298721313477
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.520 Vali Acc: 0.573 Test Loss: 1.520 Test Acc: 0.573
Validation loss decreased (-0.564871 --> -0.572504).  Saving model ...
Epoch: 13 cost time: 1.412792444229126
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.557 Vali Acc: 0.580 Test Loss: 1.557 Test Acc: 0.580
Validation loss decreased (-0.572504 --> -0.580137).  Saving model ...
Epoch: 14 cost time: 1.454930305480957
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.585 Vali Acc: 0.573 Test Loss: 1.585 Test Acc: 0.573
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4566969871520996
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.592 Vali Acc: 0.565 Test Loss: 1.592 Test Acc: 0.565
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.1593577861785889
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.593 Vali Acc: 0.557 Test Loss: 1.593 Test Acc: 0.557
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.3564012050628662
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.601 Vali Acc: 0.557 Test Loss: 1.601 Test Acc: 0.557
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.234886646270752
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.612 Vali Acc: 0.557 Test Loss: 1.612 Test Acc: 0.557
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.2324481010437012
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.614 Vali Acc: 0.557 Test Loss: 1.614 Test Acc: 0.557
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.343442440032959
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.621 Vali Acc: 0.557 Test Loss: 1.621 Test Acc: 0.557
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.6486146450042725
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.624 Vali Acc: 0.557 Test Loss: 1.624 Test Acc: 0.557
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.5882034301757812
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.627 Vali Acc: 0.557 Test Loss: 1.627 Test Acc: 0.557
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.663461446762085
Epoch: 23, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.630 Vali Acc: 0.557 Test Loss: 1.630 Test Acc: 0.557
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps1635_str409_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5801526717557252
model parameter : 52020485
model size : 213.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps1635_str818_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.2503421306610107
Epoch: 1, Steps: 8 | Train Loss: 1.477 Vali Loss: 1.595 Vali Acc: 0.420 Test Loss: 1.595 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 1.1068015098571777
Epoch: 2, Steps: 8 | Train Loss: 1.326 Vali Loss: 1.551 Vali Acc: 0.443 Test Loss: 1.551 Test Acc: 0.443
Validation loss decreased (-0.419831 --> -0.442733).  Saving model ...
Epoch: 3 cost time: 1.0502665042877197
Epoch: 3, Steps: 8 | Train Loss: 0.975 Vali Loss: 1.516 Vali Acc: 0.473 Test Loss: 1.516 Test Acc: 0.473
Validation loss decreased (-0.442733 --> -0.473267).  Saving model ...
Epoch: 4 cost time: 1.0800695419311523
Epoch: 4, Steps: 8 | Train Loss: 0.646 Vali Loss: 1.462 Vali Acc: 0.450 Test Loss: 1.462 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0114939212799072
Epoch: 5, Steps: 8 | Train Loss: 0.299 Vali Loss: 1.434 Vali Acc: 0.450 Test Loss: 1.434 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1072876453399658
Epoch: 6, Steps: 8 | Train Loss: 0.105 Vali Loss: 1.529 Vali Acc: 0.466 Test Loss: 1.529 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.9607689380645752
Epoch: 7, Steps: 8 | Train Loss: 0.033 Vali Loss: 1.764 Vali Acc: 0.473 Test Loss: 1.764 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.0495617389678955
Epoch: 8, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.721 Vali Acc: 0.458 Test Loss: 1.721 Test Acc: 0.458
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.2345523834228516
Epoch: 9, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.710 Vali Acc: 0.473 Test Loss: 1.710 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.0894429683685303
Epoch: 10, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.793 Vali Acc: 0.473 Test Loss: 1.793 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.0938591957092285
Epoch: 11, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.885 Vali Acc: 0.473 Test Loss: 1.885 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.2647020816802979
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.926 Vali Acc: 0.481 Test Loss: 1.926 Test Acc: 0.481
Validation loss decreased (-0.473267 --> -0.480897).  Saving model ...
Epoch: 13 cost time: 1.2192001342773438
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.938 Vali Acc: 0.489 Test Loss: 1.938 Test Acc: 0.489
Validation loss decreased (-0.480897 --> -0.488530).  Saving model ...
Epoch: 14 cost time: 0.9979109764099121
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.944 Vali Acc: 0.489 Test Loss: 1.944 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9150967597961426
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.951 Vali Acc: 0.489 Test Loss: 1.951 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.93215012550354
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.964 Vali Acc: 0.489 Test Loss: 1.964 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.9094436168670654
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.982 Vali Acc: 0.489 Test Loss: 1.982 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.0142121315002441
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.993 Vali Acc: 0.489 Test Loss: 1.993 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.8992621898651123
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.006 Vali Acc: 0.481 Test Loss: 2.006 Test Acc: 0.481
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.3150970935821533
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.013 Vali Acc: 0.481 Test Loss: 2.013 Test Acc: 0.481
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.427323579788208
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.016 Vali Acc: 0.481 Test Loss: 2.016 Test Acc: 0.481
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.246718168258667
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.026 Vali Acc: 0.481 Test Loss: 2.026 Test Acc: 0.481
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.127878189086914
Epoch: 23, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.034 Vali Acc: 0.481 Test Loss: 2.034 Test Acc: 0.481
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps1635_str818_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.48854961832061067
model parameter : 51912965
model size : 212.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps1635_str1635_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.5028629302978516
Epoch: 1, Steps: 8 | Train Loss: 1.601 Vali Loss: 1.564 Vali Acc: 0.420 Test Loss: 1.564 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 1.1409759521484375
Epoch: 2, Steps: 8 | Train Loss: 1.316 Vali Loss: 1.479 Vali Acc: 0.458 Test Loss: 1.479 Test Acc: 0.458
Validation loss decreased (-0.419832 --> -0.458000).  Saving model ...
Epoch: 3 cost time: 1.062087059020996
Epoch: 3, Steps: 8 | Train Loss: 1.004 Vali Loss: 1.448 Vali Acc: 0.473 Test Loss: 1.448 Test Acc: 0.473
Validation loss decreased (-0.458000 --> -0.473268).  Saving model ...
Epoch: 4 cost time: 1.1070733070373535
Epoch: 4, Steps: 8 | Train Loss: 0.647 Vali Loss: 1.461 Vali Acc: 0.443 Test Loss: 1.461 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0482966899871826
Epoch: 5, Steps: 8 | Train Loss: 0.290 Vali Loss: 1.489 Vali Acc: 0.458 Test Loss: 1.489 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1096305847167969
Epoch: 6, Steps: 8 | Train Loss: 0.123 Vali Loss: 1.444 Vali Acc: 0.450 Test Loss: 1.444 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.9876244068145752
Epoch: 7, Steps: 8 | Train Loss: 0.036 Vali Loss: 1.555 Vali Acc: 0.473 Test Loss: 1.555 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.15043306350708
Epoch: 8, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.668 Vali Acc: 0.466 Test Loss: 1.668 Test Acc: 0.466
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.1083462238311768
Epoch: 9, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.633 Vali Acc: 0.511 Test Loss: 1.633 Test Acc: 0.511
Validation loss decreased (-0.473268 --> -0.511434).  Saving model ...
Epoch: 10 cost time: 1.0769126415252686
Epoch: 10, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.577 Vali Acc: 0.504 Test Loss: 1.577 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9942317008972168
Epoch: 11, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.565 Vali Acc: 0.496 Test Loss: 1.565 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.0533876419067383
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.579 Vali Acc: 0.496 Test Loss: 1.579 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.1191685199737549
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.600 Vali Acc: 0.489 Test Loss: 1.600 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.3001172542572021
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.620 Vali Acc: 0.489 Test Loss: 1.620 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.1026325225830078
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.640 Vali Acc: 0.489 Test Loss: 1.640 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.2586617469787598
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.660 Vali Acc: 0.473 Test Loss: 1.660 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.18153977394104
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.680 Vali Acc: 0.481 Test Loss: 1.680 Test Acc: 0.481
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.1910908222198486
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.694 Vali Acc: 0.489 Test Loss: 1.694 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.1188879013061523
Epoch: 19, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.702 Vali Acc: 0.489 Test Loss: 1.702 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps1635_str1635_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5114503816793893
model parameter : 51859205
model size : 212.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps1799_str450_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.5634076595306396
Epoch: 1, Steps: 8 | Train Loss: 1.500 Vali Loss: 1.612 Vali Acc: 0.420 Test Loss: 1.612 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 1.1953818798065186
Epoch: 2, Steps: 8 | Train Loss: 1.377 Vali Loss: 1.508 Vali Acc: 0.450 Test Loss: 1.508 Test Acc: 0.450
Validation loss decreased (-0.419831 --> -0.450367).  Saving model ...
Epoch: 3 cost time: 1.1572091579437256
Epoch: 3, Steps: 8 | Train Loss: 0.940 Vali Loss: 1.404 Vali Acc: 0.519 Test Loss: 1.404 Test Acc: 0.519
Validation loss decreased (-0.450367 --> -0.519070).  Saving model ...
Epoch: 4 cost time: 1.182159662246704
Epoch: 4, Steps: 8 | Train Loss: 0.555 Vali Loss: 1.475 Vali Acc: 0.481 Test Loss: 1.475 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2891886234283447
Epoch: 5, Steps: 8 | Train Loss: 0.234 Vali Loss: 1.476 Vali Acc: 0.481 Test Loss: 1.476 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.2601385116577148
Epoch: 6, Steps: 8 | Train Loss: 0.059 Vali Loss: 1.535 Vali Acc: 0.511 Test Loss: 1.535 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.2189769744873047
Epoch: 7, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.594 Vali Acc: 0.511 Test Loss: 1.594 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.309966802597046
Epoch: 8, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.781 Vali Acc: 0.527 Test Loss: 1.781 Test Acc: 0.527
Validation loss decreased (-0.519070 --> -0.526700).  Saving model ...
Epoch: 9 cost time: 1.4835827350616455
Epoch: 9, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.762 Vali Acc: 0.511 Test Loss: 1.762 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2550747394561768
Epoch: 10, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.791 Vali Acc: 0.519 Test Loss: 1.791 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.6725523471832275
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.839 Vali Acc: 0.519 Test Loss: 1.839 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.5196681022644043
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.854 Vali Acc: 0.527 Test Loss: 1.854 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.2365257740020752
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.855 Vali Acc: 0.534 Test Loss: 1.855 Test Acc: 0.534
Validation loss decreased (-0.526700 --> -0.534333).  Saving model ...
Epoch: 14 cost time: 1.4048032760620117
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.861 Vali Acc: 0.534 Test Loss: 1.861 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2755417823791504
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.864 Vali Acc: 0.519 Test Loss: 1.864 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.469306468963623
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.869 Vali Acc: 0.519 Test Loss: 1.869 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.2468996047973633
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.878 Vali Acc: 0.527 Test Loss: 1.878 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.572443962097168
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.894 Vali Acc: 0.519 Test Loss: 1.894 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.2834711074829102
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.910 Vali Acc: 0.534 Test Loss: 1.910 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.443101406097412
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.923 Vali Acc: 0.542 Test Loss: 1.923 Test Acc: 0.542
Validation loss decreased (-0.534333 --> -0.541965).  Saving model ...
Epoch: 21 cost time: 1.281527042388916
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.936 Vali Acc: 0.534 Test Loss: 1.936 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.5616822242736816
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.941 Vali Acc: 0.527 Test Loss: 1.941 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.6328973770141602
Epoch: 23, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.946 Vali Acc: 0.534 Test Loss: 1.946 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.2580547332763672
Epoch: 24, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.952 Vali Acc: 0.534 Test Loss: 1.952 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.270493745803833
Epoch: 25, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.959 Vali Acc: 0.534 Test Loss: 1.959 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.0358788967132568
Epoch: 26, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.962 Vali Acc: 0.534 Test Loss: 1.962 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.2389066219329834
Epoch: 27, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.966 Vali Acc: 0.534 Test Loss: 1.966 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.394627332687378
Epoch: 28, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.970 Vali Acc: 0.534 Test Loss: 1.970 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.2452912330627441
Epoch: 29, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.974 Vali Acc: 0.527 Test Loss: 1.974 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.3335731029510498
Epoch: 30, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.978 Vali Acc: 0.527 Test Loss: 1.978 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps1799_str450_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 54266117
model size : 221.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps1799_str900_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.9162821769714355
Epoch: 1, Steps: 8 | Train Loss: 1.650 Vali Loss: 1.565 Vali Acc: 0.420 Test Loss: 1.565 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 1.46453857421875
Epoch: 2, Steps: 8 | Train Loss: 1.308 Vali Loss: 1.496 Vali Acc: 0.443 Test Loss: 1.496 Test Acc: 0.443
Validation loss decreased (-0.419832 --> -0.442733).  Saving model ...
Epoch: 3 cost time: 1.255988359451294
Epoch: 3, Steps: 8 | Train Loss: 0.996 Vali Loss: 1.379 Vali Acc: 0.458 Test Loss: 1.379 Test Acc: 0.458
Validation loss decreased (-0.442733 --> -0.458001).  Saving model ...
Epoch: 4 cost time: 1.1555023193359375
Epoch: 4, Steps: 8 | Train Loss: 0.535 Vali Loss: 1.397 Vali Acc: 0.527 Test Loss: 1.397 Test Acc: 0.527
Validation loss decreased (-0.458001 --> -0.526704).  Saving model ...
Epoch: 5 cost time: 1.568993330001831
Epoch: 5, Steps: 8 | Train Loss: 0.267 Vali Loss: 1.368 Vali Acc: 0.542 Test Loss: 1.368 Test Acc: 0.542
Validation loss decreased (-0.526704 --> -0.541971).  Saving model ...
Epoch: 6 cost time: 1.324815034866333
Epoch: 6, Steps: 8 | Train Loss: 0.111 Vali Loss: 1.507 Vali Acc: 0.542 Test Loss: 1.507 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2129607200622559
Epoch: 7, Steps: 8 | Train Loss: 0.036 Vali Loss: 1.509 Vali Acc: 0.519 Test Loss: 1.509 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1925947666168213
Epoch: 8, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.597 Vali Acc: 0.534 Test Loss: 1.597 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.2530827522277832
Epoch: 9, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.642 Vali Acc: 0.527 Test Loss: 1.642 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.3951807022094727
Epoch: 10, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.671 Vali Acc: 0.527 Test Loss: 1.671 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.343956708908081
Epoch: 11, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.710 Vali Acc: 0.527 Test Loss: 1.710 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.3651869297027588
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.721 Vali Acc: 0.527 Test Loss: 1.721 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.3932762145996094
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.728 Vali Acc: 0.534 Test Loss: 1.728 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.445685625076294
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.726 Vali Acc: 0.534 Test Loss: 1.726 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.4081549644470215
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.737 Vali Acc: 0.534 Test Loss: 1.737 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps1799_str900_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 54169349
model size : 221.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps1799_str1799_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.6026883125305176
Epoch: 1, Steps: 8 | Train Loss: 1.543 Vali Loss: 1.558 Vali Acc: 0.420 Test Loss: 1.558 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 1.1163954734802246
Epoch: 2, Steps: 8 | Train Loss: 1.323 Vali Loss: 1.548 Vali Acc: 0.427 Test Loss: 1.548 Test Acc: 0.427
Validation loss decreased (-0.419832 --> -0.427465).  Saving model ...
Epoch: 3 cost time: 1.1006288528442383
Epoch: 3, Steps: 8 | Train Loss: 0.965 Vali Loss: 1.507 Vali Acc: 0.466 Test Loss: 1.507 Test Acc: 0.466
Validation loss decreased (-0.427465 --> -0.465634).  Saving model ...
Epoch: 4 cost time: 1.1227631568908691
Epoch: 4, Steps: 8 | Train Loss: 0.559 Vali Loss: 1.437 Vali Acc: 0.458 Test Loss: 1.437 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0699338912963867
Epoch: 5, Steps: 8 | Train Loss: 0.273 Vali Loss: 1.452 Vali Acc: 0.504 Test Loss: 1.452 Test Acc: 0.504
Validation loss decreased (-0.465634 --> -0.503802).  Saving model ...
Epoch: 6 cost time: 1.3729040622711182
Epoch: 6, Steps: 8 | Train Loss: 0.098 Vali Loss: 1.467 Vali Acc: 0.504 Test Loss: 1.467 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2709436416625977
Epoch: 7, Steps: 8 | Train Loss: 0.033 Vali Loss: 1.495 Vali Acc: 0.534 Test Loss: 1.495 Test Acc: 0.534
Validation loss decreased (-0.503802 --> -0.534336).  Saving model ...
Epoch: 8 cost time: 1.6150662899017334
Epoch: 8, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.566 Vali Acc: 0.527 Test Loss: 1.566 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6845448017120361
Epoch: 9, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.595 Vali Acc: 0.542 Test Loss: 1.595 Test Acc: 0.542
Validation loss decreased (-0.534336 --> -0.541969).  Saving model ...
Epoch: 10 cost time: 1.4052622318267822
Epoch: 10, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.621 Vali Acc: 0.542 Test Loss: 1.621 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0730834007263184
Epoch: 11, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.641 Vali Acc: 0.542 Test Loss: 1.641 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.045104742050171
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.655 Vali Acc: 0.550 Test Loss: 1.655 Test Acc: 0.550
Validation loss decreased (-0.541969 --> -0.549602).  Saving model ...
Epoch: 13 cost time: 1.5279724597930908
Epoch: 13, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.670 Vali Acc: 0.550 Test Loss: 1.670 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3991878032684326
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.677 Vali Acc: 0.550 Test Loss: 1.677 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.6221287250518799
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.687 Vali Acc: 0.534 Test Loss: 1.687 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.260270595550537
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.693 Vali Acc: 0.527 Test Loss: 1.693 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.566427230834961
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.699 Vali Acc: 0.534 Test Loss: 1.699 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.5517897605895996
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.704 Vali Acc: 0.534 Test Loss: 1.704 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.6256487369537354
Epoch: 19, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.710 Vali Acc: 0.534 Test Loss: 1.710 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.558004379272461
Epoch: 20, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.715 Vali Acc: 0.534 Test Loss: 1.715 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.4449121952056885
Epoch: 21, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.719 Vali Acc: 0.534 Test Loss: 1.719 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.0985536575317383
Epoch: 22, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.724 Vali Acc: 0.534 Test Loss: 1.724 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps1799_str1799_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 54120965
model size : 221.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps1999_str500_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.9198217391967773
Epoch: 1, Steps: 8 | Train Loss: 1.586 Vali Loss: 1.552 Vali Acc: 0.420 Test Loss: 1.552 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 1.0478715896606445
Epoch: 2, Steps: 8 | Train Loss: 1.263 Vali Loss: 1.442 Vali Acc: 0.504 Test Loss: 1.442 Test Acc: 0.504
Validation loss decreased (-0.419832 --> -0.503802).  Saving model ...
Epoch: 3 cost time: 1.589750051498413
Epoch: 3, Steps: 8 | Train Loss: 0.867 Vali Loss: 1.340 Vali Acc: 0.527 Test Loss: 1.340 Test Acc: 0.527
Validation loss decreased (-0.503802 --> -0.526704).  Saving model ...
Epoch: 4 cost time: 1.5671584606170654
Epoch: 4, Steps: 8 | Train Loss: 0.437 Vali Loss: 1.320 Vali Acc: 0.565 Test Loss: 1.320 Test Acc: 0.565
Validation loss decreased (-0.526704 --> -0.564872).  Saving model ...
Epoch: 5 cost time: 1.5971848964691162
Epoch: 5, Steps: 8 | Train Loss: 0.171 Vali Loss: 1.394 Vali Acc: 0.519 Test Loss: 1.394 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2439565658569336
Epoch: 6, Steps: 8 | Train Loss: 0.049 Vali Loss: 1.544 Vali Acc: 0.489 Test Loss: 1.544 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9691557884216309
Epoch: 7, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.435 Vali Acc: 0.550 Test Loss: 1.435 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.1710572242736816
Epoch: 8, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.479 Vali Acc: 0.519 Test Loss: 1.479 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.9544918537139893
Epoch: 9, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.570 Vali Acc: 0.534 Test Loss: 1.570 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.700944185256958
Epoch: 10, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.600 Vali Acc: 0.550 Test Loss: 1.600 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.7084877490997314
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.649 Vali Acc: 0.557 Test Loss: 1.649 Test Acc: 0.557
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.6008546352386475
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.665 Vali Acc: 0.550 Test Loss: 1.665 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.9170289039611816
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.666 Vali Acc: 0.542 Test Loss: 1.666 Test Acc: 0.542
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.8997271060943604
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.663 Vali Acc: 0.550 Test Loss: 1.663 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps1999_str500_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5648854961832062
model parameter : 57009413
model size : 232.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps1999_str1000_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.178813934326172
Epoch: 1, Steps: 8 | Train Loss: 1.574 Vali Loss: 1.563 Vali Acc: 0.420 Test Loss: 1.563 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 1.4973666667938232
Epoch: 2, Steps: 8 | Train Loss: 1.298 Vali Loss: 1.577 Vali Acc: 0.382 Test Loss: 1.577 Test Acc: 0.382
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5629990100860596
Epoch: 3, Steps: 8 | Train Loss: 0.888 Vali Loss: 1.443 Vali Acc: 0.473 Test Loss: 1.443 Test Acc: 0.473
Validation loss decreased (-0.419832 --> -0.473268).  Saving model ...
Epoch: 4 cost time: 1.2621397972106934
Epoch: 4, Steps: 8 | Train Loss: 0.463 Vali Loss: 1.490 Vali Acc: 0.519 Test Loss: 1.490 Test Acc: 0.519
Validation loss decreased (-0.473268 --> -0.519069).  Saving model ...
Epoch: 5 cost time: 1.675489902496338
Epoch: 5, Steps: 8 | Train Loss: 0.191 Vali Loss: 1.531 Vali Acc: 0.534 Test Loss: 1.531 Test Acc: 0.534
Validation loss decreased (-0.519069 --> -0.534336).  Saving model ...
Epoch: 6 cost time: 1.6373481750488281
Epoch: 6, Steps: 8 | Train Loss: 0.067 Vali Loss: 1.584 Vali Acc: 0.496 Test Loss: 1.584 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.705390453338623
Epoch: 7, Steps: 8 | Train Loss: 0.022 Vali Loss: 1.500 Vali Acc: 0.496 Test Loss: 1.500 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.7774863243103027
Epoch: 8, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.571 Vali Acc: 0.511 Test Loss: 1.571 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.1965563297271729
Epoch: 9, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.702 Vali Acc: 0.511 Test Loss: 1.702 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.0436718463897705
Epoch: 10, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.720 Vali Acc: 0.511 Test Loss: 1.720 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.6608085632324219
Epoch: 11, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.724 Vali Acc: 0.511 Test Loss: 1.724 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.565791368484497
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.727 Vali Acc: 0.511 Test Loss: 1.727 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.5989892482757568
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.725 Vali Acc: 0.511 Test Loss: 1.725 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.826127052307129
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.732 Vali Acc: 0.511 Test Loss: 1.732 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.4136271476745605
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.737 Vali Acc: 0.511 Test Loss: 1.737 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps1999_str1000_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 56923397
model size : 231.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps1999_str1999_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.072423219680786
Epoch: 1, Steps: 8 | Train Loss: 1.535 Vali Loss: 1.535 Vali Acc: 0.420 Test Loss: 1.535 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 1.2617502212524414
Epoch: 2, Steps: 8 | Train Loss: 1.259 Vali Loss: 1.509 Vali Acc: 0.458 Test Loss: 1.509 Test Acc: 0.458
Validation loss decreased (-0.419832 --> -0.458000).  Saving model ...
Epoch: 3 cost time: 1.410149097442627
Epoch: 3, Steps: 8 | Train Loss: 0.900 Vali Loss: 1.516 Vali Acc: 0.450 Test Loss: 1.516 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7439029216766357
Epoch: 4, Steps: 8 | Train Loss: 0.564 Vali Loss: 1.526 Vali Acc: 0.489 Test Loss: 1.526 Test Acc: 0.489
Validation loss decreased (-0.458000 --> -0.488534).  Saving model ...
Epoch: 5 cost time: 1.4446375370025635
Epoch: 5, Steps: 8 | Train Loss: 0.263 Vali Loss: 1.563 Vali Acc: 0.473 Test Loss: 1.563 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.608964443206787
Epoch: 6, Steps: 8 | Train Loss: 0.116 Vali Loss: 1.559 Vali Acc: 0.504 Test Loss: 1.559 Test Acc: 0.504
Validation loss decreased (-0.488534 --> -0.503801).  Saving model ...
Epoch: 7 cost time: 1.1572258472442627
Epoch: 7, Steps: 8 | Train Loss: 0.039 Vali Loss: 1.673 Vali Acc: 0.489 Test Loss: 1.673 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6434881687164307
Epoch: 8, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.714 Vali Acc: 0.489 Test Loss: 1.714 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.6802878379821777
Epoch: 9, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.746 Vali Acc: 0.466 Test Loss: 1.746 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.6988554000854492
Epoch: 10, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.778 Vali Acc: 0.443 Test Loss: 1.778 Test Acc: 0.443
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.7745444774627686
Epoch: 11, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.812 Vali Acc: 0.443 Test Loss: 1.812 Test Acc: 0.443
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.582413911819458
Epoch: 12, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.833 Vali Acc: 0.443 Test Loss: 1.833 Test Acc: 0.443
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.5233569145202637
Epoch: 13, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.853 Vali Acc: 0.435 Test Loss: 1.853 Test Acc: 0.435
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.5372061729431152
Epoch: 14, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.889 Vali Acc: 0.450 Test Loss: 1.889 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.2655365467071533
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.918 Vali Acc: 0.466 Test Loss: 1.918 Test Acc: 0.466
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.3855481147766113
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.935 Vali Acc: 0.458 Test Loss: 1.935 Test Acc: 0.458
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps1999_str1999_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5038167938931297
model parameter : 56880389
model size : 231.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps2248_str562_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.616870403289795
Epoch: 1, Steps: 8 | Train Loss: 1.559 Vali Loss: 1.601 Vali Acc: 0.420 Test Loss: 1.601 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 1.5033917427062988
Epoch: 2, Steps: 8 | Train Loss: 1.308 Vali Loss: 1.492 Vali Acc: 0.427 Test Loss: 1.492 Test Acc: 0.427
Validation loss decreased (-0.419831 --> -0.427466).  Saving model ...
Epoch: 3 cost time: 1.1951525211334229
Epoch: 3, Steps: 8 | Train Loss: 0.875 Vali Loss: 1.338 Vali Acc: 0.496 Test Loss: 1.338 Test Acc: 0.496
Validation loss decreased (-0.427466 --> -0.496170).  Saving model ...
Epoch: 4 cost time: 1.1482517719268799
Epoch: 4, Steps: 8 | Train Loss: 0.449 Vali Loss: 1.419 Vali Acc: 0.504 Test Loss: 1.419 Test Acc: 0.504
Validation loss decreased (-0.496170 --> -0.503803).  Saving model ...
Epoch: 5 cost time: 1.583284616470337
Epoch: 5, Steps: 8 | Train Loss: 0.160 Vali Loss: 1.517 Vali Acc: 0.489 Test Loss: 1.517 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6112282276153564
Epoch: 6, Steps: 8 | Train Loss: 0.048 Vali Loss: 1.630 Vali Acc: 0.519 Test Loss: 1.630 Test Acc: 0.519
Validation loss decreased (-0.503803 --> -0.519068).  Saving model ...
Epoch: 7 cost time: 1.537050485610962
Epoch: 7, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.779 Vali Acc: 0.534 Test Loss: 1.779 Test Acc: 0.534
Validation loss decreased (-0.519068 --> -0.534333).  Saving model ...
Epoch: 8 cost time: 1.452303171157837
Epoch: 8, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.876 Vali Acc: 0.489 Test Loss: 1.876 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9793024063110352
Epoch: 9, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.933 Vali Acc: 0.496 Test Loss: 1.933 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.2359435558319092
Epoch: 10, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.966 Vali Acc: 0.496 Test Loss: 1.966 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.4218809604644775
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.018 Vali Acc: 0.511 Test Loss: 2.018 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.3374638557434082
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.041 Vali Acc: 0.519 Test Loss: 2.041 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.3577613830566406
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.041 Vali Acc: 0.511 Test Loss: 2.041 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.1103103160858154
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.048 Vali Acc: 0.504 Test Loss: 2.048 Test Acc: 0.504
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.357426643371582
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.059 Vali Acc: 0.504 Test Loss: 2.059 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.292487382888794
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.067 Vali Acc: 0.504 Test Loss: 2.067 Test Acc: 0.504
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.275367259979248
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.071 Vali Acc: 0.504 Test Loss: 2.071 Test Acc: 0.504
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps2248_str562_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 60435461
model size : 245.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps2248_str1124_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.075901508331299
Epoch: 1, Steps: 8 | Train Loss: 1.534 Vali Loss: 1.545 Vali Acc: 0.420 Test Loss: 1.545 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 1.4226009845733643
Epoch: 2, Steps: 8 | Train Loss: 1.249 Vali Loss: 1.426 Vali Acc: 0.458 Test Loss: 1.426 Test Acc: 0.458
Validation loss decreased (-0.419832 --> -0.458001).  Saving model ...
Epoch: 3 cost time: 1.5869910717010498
Epoch: 3, Steps: 8 | Train Loss: 0.888 Vali Loss: 1.434 Vali Acc: 0.427 Test Loss: 1.434 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3489773273468018
Epoch: 4, Steps: 8 | Train Loss: 0.495 Vali Loss: 1.504 Vali Acc: 0.427 Test Loss: 1.504 Test Acc: 0.427
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.3084533214569092
Epoch: 5, Steps: 8 | Train Loss: 0.211 Vali Loss: 1.500 Vali Acc: 0.466 Test Loss: 1.500 Test Acc: 0.466
Validation loss decreased (-0.458001 --> -0.465634).  Saving model ...
Epoch: 6 cost time: 1.240281581878662
Epoch: 6, Steps: 8 | Train Loss: 0.067 Vali Loss: 1.550 Vali Acc: 0.511 Test Loss: 1.550 Test Acc: 0.511
Validation loss decreased (-0.465634 --> -0.511435).  Saving model ...
Epoch: 7 cost time: 1.3442809581756592
Epoch: 7, Steps: 8 | Train Loss: 0.021 Vali Loss: 1.723 Vali Acc: 0.489 Test Loss: 1.723 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2412433624267578
Epoch: 8, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.749 Vali Acc: 0.504 Test Loss: 1.749 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.3133163452148438
Epoch: 9, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.777 Vali Acc: 0.527 Test Loss: 1.777 Test Acc: 0.527
Validation loss decreased (-0.511435 --> -0.526700).  Saving model ...
Epoch: 10 cost time: 1.3096816539764404
Epoch: 10, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.823 Vali Acc: 0.527 Test Loss: 1.823 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0379512310028076
Epoch: 11, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.873 Vali Acc: 0.519 Test Loss: 1.873 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.3602516651153564
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.908 Vali Acc: 0.511 Test Loss: 1.908 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.2775514125823975
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.931 Vali Acc: 0.511 Test Loss: 1.931 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.2133867740631104
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.943 Vali Acc: 0.511 Test Loss: 1.943 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.2725157737731934
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.953 Vali Acc: 0.511 Test Loss: 1.953 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.9751379489898682
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.959 Vali Acc: 0.504 Test Loss: 1.959 Test Acc: 0.504
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.183664083480835
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.970 Vali Acc: 0.511 Test Loss: 1.970 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.0367577075958252
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.981 Vali Acc: 0.511 Test Loss: 1.981 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.2154135704040527
Epoch: 19, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.993 Vali Acc: 0.504 Test Loss: 1.993 Test Acc: 0.504
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps2248_str1124_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 60360197
model size : 244.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps2248_str2248_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.531886100769043
Epoch: 1, Steps: 8 | Train Loss: 1.508 Vali Loss: 1.509 Vali Acc: 0.420 Test Loss: 1.509 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 1.1350245475769043
Epoch: 2, Steps: 8 | Train Loss: 1.289 Vali Loss: 1.492 Vali Acc: 0.473 Test Loss: 1.492 Test Acc: 0.473
Validation loss decreased (-0.419832 --> -0.473268).  Saving model ...
Epoch: 3 cost time: 1.110670804977417
Epoch: 3, Steps: 8 | Train Loss: 0.900 Vali Loss: 1.466 Vali Acc: 0.473 Test Loss: 1.466 Test Acc: 0.473
Validation loss decreased (-0.473268 --> -0.473268).  Saving model ...
Epoch: 4 cost time: 1.1536228656768799
Epoch: 4, Steps: 8 | Train Loss: 0.530 Vali Loss: 1.490 Vali Acc: 0.481 Test Loss: 1.490 Test Acc: 0.481
Validation loss decreased (-0.473268 --> -0.480901).  Saving model ...
Epoch: 5 cost time: 0.9447593688964844
Epoch: 5, Steps: 8 | Train Loss: 0.245 Vali Loss: 1.504 Vali Acc: 0.473 Test Loss: 1.504 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1020336151123047
Epoch: 6, Steps: 8 | Train Loss: 0.096 Vali Loss: 1.556 Vali Acc: 0.496 Test Loss: 1.556 Test Acc: 0.496
Validation loss decreased (-0.480901 --> -0.496168).  Saving model ...
Epoch: 7 cost time: 1.2128357887268066
Epoch: 7, Steps: 8 | Train Loss: 0.035 Vali Loss: 1.640 Vali Acc: 0.504 Test Loss: 1.640 Test Acc: 0.504
Validation loss decreased (-0.496168 --> -0.503800).  Saving model ...
Epoch: 8 cost time: 1.2304224967956543
Epoch: 8, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.713 Vali Acc: 0.511 Test Loss: 1.713 Test Acc: 0.511
Validation loss decreased (-0.503800 --> -0.511433).  Saving model ...
Epoch: 9 cost time: 1.1998662948608398
Epoch: 9, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.830 Vali Acc: 0.504 Test Loss: 1.830 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.404655933380127
Epoch: 10, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.884 Vali Acc: 0.511 Test Loss: 1.884 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.3891193866729736
Epoch: 11, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.884 Vali Acc: 0.511 Test Loss: 1.884 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.3286259174346924
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.895 Vali Acc: 0.511 Test Loss: 1.895 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.0876827239990234
Epoch: 13, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.909 Vali Acc: 0.511 Test Loss: 1.909 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.0917761325836182
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.917 Vali Acc: 0.511 Test Loss: 1.917 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.0983424186706543
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.928 Vali Acc: 0.511 Test Loss: 1.928 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.1210665702819824
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.953 Vali Acc: 0.511 Test Loss: 1.953 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.1321616172790527
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.976 Vali Acc: 0.511 Test Loss: 1.976 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.1121940612792969
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.992 Vali Acc: 0.511 Test Loss: 1.992 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps2248_str2248_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5114503816793893
model parameter : 60322565
model size : 244.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps2570_str643_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.7444584369659424
Epoch: 1, Steps: 8 | Train Loss: 1.555 Vali Loss: 1.546 Vali Acc: 0.420 Test Loss: 1.546 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 1.491678237915039
Epoch: 2, Steps: 8 | Train Loss: 1.209 Vali Loss: 1.450 Vali Acc: 0.481 Test Loss: 1.450 Test Acc: 0.481
Validation loss decreased (-0.419832 --> -0.480902).  Saving model ...
Epoch: 3 cost time: 1.0869977474212646
Epoch: 3, Steps: 8 | Train Loss: 0.740 Vali Loss: 1.393 Vali Acc: 0.511 Test Loss: 1.393 Test Acc: 0.511
Validation loss decreased (-0.480902 --> -0.511436).  Saving model ...
Epoch: 4 cost time: 1.5622062683105469
Epoch: 4, Steps: 8 | Train Loss: 0.371 Vali Loss: 1.364 Vali Acc: 0.550 Test Loss: 1.364 Test Acc: 0.550
Validation loss decreased (-0.511436 --> -0.549605).  Saving model ...
Epoch: 5 cost time: 1.248838186264038
Epoch: 5, Steps: 8 | Train Loss: 0.113 Vali Loss: 1.405 Vali Acc: 0.519 Test Loss: 1.405 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7182235717773438
Epoch: 6, Steps: 8 | Train Loss: 0.034 Vali Loss: 1.487 Vali Acc: 0.496 Test Loss: 1.487 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.8494701385498047
Epoch: 7, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.588 Vali Acc: 0.489 Test Loss: 1.588 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.7506139278411865
Epoch: 8, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.696 Vali Acc: 0.481 Test Loss: 1.696 Test Acc: 0.481
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.5879712104797363
Epoch: 9, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.750 Vali Acc: 0.511 Test Loss: 1.750 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.4420006275177002
Epoch: 10, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.719 Vali Acc: 0.519 Test Loss: 1.719 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.5288219451904297
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.712 Vali Acc: 0.527 Test Loss: 1.712 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.5449364185333252
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.721 Vali Acc: 0.527 Test Loss: 1.721 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.650787115097046
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.730 Vali Acc: 0.534 Test Loss: 1.730 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.8725306987762451
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.745 Vali Acc: 0.534 Test Loss: 1.745 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps2570_str643_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 64859909
model size : 262.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps2570_str1285_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.7068212032318115
Epoch: 1, Steps: 8 | Train Loss: 1.533 Vali Loss: 1.522 Vali Acc: 0.420 Test Loss: 1.522 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 1.7550690174102783
Epoch: 2, Steps: 8 | Train Loss: 1.250 Vali Loss: 1.514 Vali Acc: 0.450 Test Loss: 1.514 Test Acc: 0.450
Validation loss decreased (-0.419832 --> -0.450367).  Saving model ...
Epoch: 3 cost time: 1.4964308738708496
Epoch: 3, Steps: 8 | Train Loss: 0.823 Vali Loss: 1.486 Vali Acc: 0.481 Test Loss: 1.486 Test Acc: 0.481
Validation loss decreased (-0.450367 --> -0.480901).  Saving model ...
Epoch: 4 cost time: 1.0902485847473145
Epoch: 4, Steps: 8 | Train Loss: 0.450 Vali Loss: 1.415 Vali Acc: 0.489 Test Loss: 1.415 Test Acc: 0.489
Validation loss decreased (-0.480901 --> -0.488535).  Saving model ...
Epoch: 5 cost time: 1.5407211780548096
Epoch: 5, Steps: 8 | Train Loss: 0.167 Vali Loss: 1.374 Vali Acc: 0.489 Test Loss: 1.374 Test Acc: 0.489
Validation loss decreased (-0.488535 --> -0.488536).  Saving model ...
Epoch: 6 cost time: 1.4991447925567627
Epoch: 6, Steps: 8 | Train Loss: 0.050 Vali Loss: 1.512 Vali Acc: 0.504 Test Loss: 1.512 Test Acc: 0.504
Validation loss decreased (-0.488536 --> -0.503802).  Saving model ...
Epoch: 7 cost time: 1.5191833972930908
Epoch: 7, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.548 Vali Acc: 0.481 Test Loss: 1.548 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5648736953735352
Epoch: 8, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.623 Vali Acc: 0.481 Test Loss: 1.623 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.4801878929138184
Epoch: 9, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.718 Vali Acc: 0.496 Test Loss: 1.718 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.5683200359344482
Epoch: 10, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.780 Vali Acc: 0.496 Test Loss: 1.780 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.6310126781463623
Epoch: 11, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.794 Vali Acc: 0.504 Test Loss: 1.794 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.3612544536590576
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.793 Vali Acc: 0.511 Test Loss: 1.793 Test Acc: 0.511
Validation loss decreased (-0.503802 --> -0.511432).  Saving model ...
Epoch: 13 cost time: 1.930351734161377
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.792 Vali Acc: 0.511 Test Loss: 1.792 Test Acc: 0.511
Validation loss decreased (-0.511432 --> -0.511432).  Saving model ...
Epoch: 14 cost time: 1.304792881011963
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.791 Vali Acc: 0.511 Test Loss: 1.791 Test Acc: 0.511
Validation loss decreased (-0.511432 --> -0.511432).  Saving model ...
Epoch: 15 cost time: 1.6068618297576904
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.786 Vali Acc: 0.511 Test Loss: 1.786 Test Acc: 0.511
Validation loss decreased (-0.511432 --> -0.511433).  Saving model ...
Epoch: 16 cost time: 1.5184531211853027
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.785 Vali Acc: 0.511 Test Loss: 1.785 Test Acc: 0.511
Validation loss decreased (-0.511433 --> -0.511433).  Saving model ...
Epoch: 17 cost time: 1.534163236618042
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.791 Vali Acc: 0.511 Test Loss: 1.791 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.9047658443450928
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.803 Vali Acc: 0.511 Test Loss: 1.803 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.6991925239562988
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.814 Vali Acc: 0.511 Test Loss: 1.814 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.5050742626190186
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.822 Vali Acc: 0.511 Test Loss: 1.822 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.5858886241912842
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.829 Vali Acc: 0.511 Test Loss: 1.829 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.187187671661377
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.835 Vali Acc: 0.511 Test Loss: 1.835 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.4900422096252441
Epoch: 23, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.844 Vali Acc: 0.511 Test Loss: 1.844 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.564082145690918
Epoch: 24, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.851 Vali Acc: 0.511 Test Loss: 1.851 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.4840939044952393
Epoch: 25, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.855 Vali Acc: 0.511 Test Loss: 1.855 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.452066421508789
Epoch: 26, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.855 Vali Acc: 0.511 Test Loss: 1.855 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps2570_str1285_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5114503816793893
model parameter : 64795397
model size : 261.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps2570_str2570_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.5462300777435303
Epoch: 1, Steps: 8 | Train Loss: 1.561 Vali Loss: 1.495 Vali Acc: 0.412 Test Loss: 1.495 Test Acc: 0.412
Validation loss decreased (inf --> -0.412199).  Saving model ...
Epoch: 2 cost time: 1.482964277267456
Epoch: 2, Steps: 8 | Train Loss: 1.234 Vali Loss: 1.454 Vali Acc: 0.473 Test Loss: 1.454 Test Acc: 0.473
Validation loss decreased (-0.412199 --> -0.473268).  Saving model ...
Epoch: 3 cost time: 1.5667765140533447
Epoch: 3, Steps: 8 | Train Loss: 0.761 Vali Loss: 1.417 Vali Acc: 0.504 Test Loss: 1.417 Test Acc: 0.504
Validation loss decreased (-0.473268 --> -0.503803).  Saving model ...
Epoch: 4 cost time: 1.5676875114440918
Epoch: 4, Steps: 8 | Train Loss: 0.363 Vali Loss: 1.519 Vali Acc: 0.450 Test Loss: 1.519 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2404069900512695
Epoch: 5, Steps: 8 | Train Loss: 0.135 Vali Loss: 1.608 Vali Acc: 0.489 Test Loss: 1.608 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.5721156597137451
Epoch: 6, Steps: 8 | Train Loss: 0.042 Vali Loss: 1.633 Vali Acc: 0.466 Test Loss: 1.633 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.4437599182128906
Epoch: 7, Steps: 8 | Train Loss: 0.018 Vali Loss: 1.714 Vali Acc: 0.450 Test Loss: 1.714 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.5478577613830566
Epoch: 8, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.778 Vali Acc: 0.450 Test Loss: 1.778 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.4267985820770264
Epoch: 9, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.823 Vali Acc: 0.443 Test Loss: 1.823 Test Acc: 0.443
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.766296148300171
Epoch: 10, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.849 Vali Acc: 0.450 Test Loss: 1.849 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.7225594520568848
Epoch: 11, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.868 Vali Acc: 0.450 Test Loss: 1.868 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.6833064556121826
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.878 Vali Acc: 0.450 Test Loss: 1.878 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.4732139110565186
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.892 Vali Acc: 0.450 Test Loss: 1.892 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps2570_str2570_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5038167938931297
model parameter : 64763141
model size : 261.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps2998_str750_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.1763200759887695
Epoch: 1, Steps: 8 | Train Loss: 1.563 Vali Loss: 1.504 Vali Acc: 0.420 Test Loss: 1.504 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 1.9027082920074463
Epoch: 2, Steps: 8 | Train Loss: 1.183 Vali Loss: 1.394 Vali Acc: 0.504 Test Loss: 1.394 Test Acc: 0.504
Validation loss decreased (-0.419832 --> -0.503803).  Saving model ...
Epoch: 3 cost time: 1.883636236190796
Epoch: 3, Steps: 8 | Train Loss: 0.709 Vali Loss: 1.406 Vali Acc: 0.405 Test Loss: 1.406 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.0172111988067627
Epoch: 4, Steps: 8 | Train Loss: 0.294 Vali Loss: 1.432 Vali Acc: 0.481 Test Loss: 1.432 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.100647449493408
Epoch: 5, Steps: 8 | Train Loss: 0.090 Vali Loss: 1.558 Vali Acc: 0.466 Test Loss: 1.558 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.6176726818084717
Epoch: 6, Steps: 8 | Train Loss: 0.022 Vali Loss: 1.640 Vali Acc: 0.496 Test Loss: 1.640 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.639495611190796
Epoch: 7, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.702 Vali Acc: 0.489 Test Loss: 1.702 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.6780650615692139
Epoch: 8, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.755 Vali Acc: 0.481 Test Loss: 1.755 Test Acc: 0.481
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.7245900630950928
Epoch: 9, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.815 Vali Acc: 0.496 Test Loss: 1.815 Test Acc: 0.496
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.7017886638641357
Epoch: 10, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.849 Vali Acc: 0.496 Test Loss: 1.849 Test Acc: 0.496
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.6888518333435059
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.875 Vali Acc: 0.496 Test Loss: 1.875 Test Acc: 0.496
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.7052748203277588
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.895 Vali Acc: 0.489 Test Loss: 1.895 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps2998_str750_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5038167938931297
model parameter : 70755077
model size : 284.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps2998_str1499_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.2224035263061523
Epoch: 1, Steps: 8 | Train Loss: 1.527 Vali Loss: 1.529 Vali Acc: 0.420 Test Loss: 1.529 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 1.6901743412017822
Epoch: 2, Steps: 8 | Train Loss: 1.230 Vali Loss: 1.476 Vali Acc: 0.481 Test Loss: 1.476 Test Acc: 0.481
Validation loss decreased (-0.419832 --> -0.480901).  Saving model ...
Epoch: 3 cost time: 1.8097310066223145
Epoch: 3, Steps: 8 | Train Loss: 0.735 Vali Loss: 1.497 Vali Acc: 0.481 Test Loss: 1.497 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7868635654449463
Epoch: 4, Steps: 8 | Train Loss: 0.377 Vali Loss: 1.491 Vali Acc: 0.481 Test Loss: 1.491 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.9433419704437256
Epoch: 5, Steps: 8 | Train Loss: 0.120 Vali Loss: 1.511 Vali Acc: 0.519 Test Loss: 1.511 Test Acc: 0.519
Validation loss decreased (-0.480901 --> -0.519069).  Saving model ...
Epoch: 6 cost time: 1.8355214595794678
Epoch: 6, Steps: 8 | Train Loss: 0.036 Vali Loss: 1.557 Vali Acc: 0.489 Test Loss: 1.557 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.8030917644500732
Epoch: 7, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.545 Vali Acc: 0.481 Test Loss: 1.545 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.633676290512085
Epoch: 8, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.576 Vali Acc: 0.489 Test Loss: 1.576 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.6250660419464111
Epoch: 9, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.615 Vali Acc: 0.496 Test Loss: 1.615 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.7118885517120361
Epoch: 10, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.637 Vali Acc: 0.496 Test Loss: 1.637 Test Acc: 0.496
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.697336196899414
Epoch: 11, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.654 Vali Acc: 0.496 Test Loss: 1.654 Test Acc: 0.496
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.879145622253418
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.663 Vali Acc: 0.496 Test Loss: 1.663 Test Acc: 0.496
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.0379841327667236
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.677 Vali Acc: 0.496 Test Loss: 1.677 Test Acc: 0.496
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.0065228939056396
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.688 Vali Acc: 0.496 Test Loss: 1.688 Test Acc: 0.496
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.7276313304901123
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.698 Vali Acc: 0.496 Test Loss: 1.698 Test Acc: 0.496
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps2998_str1499_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 70701317
model size : 284.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps2998_str2998_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.947603940963745
Epoch: 1, Steps: 8 | Train Loss: 1.615 Vali Loss: 1.556 Vali Acc: 0.420 Test Loss: 1.556 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 1.323657751083374
Epoch: 2, Steps: 8 | Train Loss: 1.227 Vali Loss: 1.488 Vali Acc: 0.466 Test Loss: 1.488 Test Acc: 0.466
Validation loss decreased (-0.419832 --> -0.465634).  Saving model ...
Epoch: 3 cost time: 1.5550451278686523
Epoch: 3, Steps: 8 | Train Loss: 0.707 Vali Loss: 1.497 Vali Acc: 0.466 Test Loss: 1.497 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5554001331329346
Epoch: 4, Steps: 8 | Train Loss: 0.322 Vali Loss: 1.523 Vali Acc: 0.466 Test Loss: 1.523 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.5868570804595947
Epoch: 5, Steps: 8 | Train Loss: 0.119 Vali Loss: 1.597 Vali Acc: 0.458 Test Loss: 1.597 Test Acc: 0.458
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.6808323860168457
Epoch: 6, Steps: 8 | Train Loss: 0.036 Vali Loss: 1.678 Vali Acc: 0.481 Test Loss: 1.678 Test Acc: 0.481
Validation loss decreased (-0.465634 --> -0.480899).  Saving model ...
Epoch: 7 cost time: 1.576298475265503
Epoch: 7, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.720 Vali Acc: 0.466 Test Loss: 1.720 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5249748229980469
Epoch: 8, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.769 Vali Acc: 0.473 Test Loss: 1.769 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.555854082107544
Epoch: 9, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.805 Vali Acc: 0.473 Test Loss: 1.805 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.58241868019104
Epoch: 10, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.829 Vali Acc: 0.466 Test Loss: 1.829 Test Acc: 0.466
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.9289910793304443
Epoch: 11, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.848 Vali Acc: 0.458 Test Loss: 1.848 Test Acc: 0.458
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.8765909671783447
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.864 Vali Acc: 0.458 Test Loss: 1.864 Test Acc: 0.458
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.2417340278625488
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.876 Vali Acc: 0.466 Test Loss: 1.876 Test Acc: 0.466
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.9305334091186523
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.889 Vali Acc: 0.466 Test Loss: 1.889 Test Acc: 0.466
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.479299783706665
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.900 Vali Acc: 0.466 Test Loss: 1.900 Test Acc: 0.466
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.3687973022460938
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.909 Vali Acc: 0.466 Test Loss: 1.909 Test Acc: 0.466
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps2998_str2998_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.48091603053435117
model parameter : 70674437
model size : 284.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps3597_str900_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.4904706478118896
Epoch: 1, Steps: 8 | Train Loss: 1.734 Vali Loss: 1.557 Vali Acc: 0.412 Test Loss: 1.557 Test Acc: 0.412
Validation loss decreased (inf --> -0.412198).  Saving model ...
Epoch: 2 cost time: 1.8722140789031982
Epoch: 2, Steps: 8 | Train Loss: 1.201 Vali Loss: 1.534 Vali Acc: 0.466 Test Loss: 1.534 Test Acc: 0.466
Validation loss decreased (-0.412198 --> -0.465634).  Saving model ...
Epoch: 3 cost time: 1.8103890419006348
Epoch: 3, Steps: 8 | Train Loss: 0.622 Vali Loss: 1.426 Vali Acc: 0.496 Test Loss: 1.426 Test Acc: 0.496
Validation loss decreased (-0.465634 --> -0.496169).  Saving model ...
Epoch: 4 cost time: 1.825761079788208
Epoch: 4, Steps: 8 | Train Loss: 0.265 Vali Loss: 1.401 Vali Acc: 0.481 Test Loss: 1.401 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7633097171783447
Epoch: 5, Steps: 8 | Train Loss: 0.090 Vali Loss: 1.560 Vali Acc: 0.450 Test Loss: 1.560 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.9435124397277832
Epoch: 6, Steps: 8 | Train Loss: 0.026 Vali Loss: 1.595 Vali Acc: 0.466 Test Loss: 1.595 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.7162115573883057
Epoch: 7, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.608 Vali Acc: 0.466 Test Loss: 1.608 Test Acc: 0.466
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.2077932357788086
Epoch: 8, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.646 Vali Acc: 0.504 Test Loss: 1.646 Test Acc: 0.504
Validation loss decreased (-0.496169 --> -0.503800).  Saving model ...
Epoch: 9 cost time: 1.9395039081573486
Epoch: 9, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.677 Vali Acc: 0.519 Test Loss: 1.677 Test Acc: 0.519
Validation loss decreased (-0.503800 --> -0.519067).  Saving model ...
Epoch: 10 cost time: 1.562504529953003
Epoch: 10, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.704 Vali Acc: 0.527 Test Loss: 1.704 Test Acc: 0.527
Validation loss decreased (-0.519067 --> -0.526701).  Saving model ...
Epoch: 11 cost time: 2.0293965339660645
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.722 Vali Acc: 0.519 Test Loss: 1.722 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.1341569423675537
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.734 Vali Acc: 0.519 Test Loss: 1.734 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.7793216705322266
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.749 Vali Acc: 0.511 Test Loss: 1.749 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.7049639225006104
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.762 Vali Acc: 0.511 Test Loss: 1.762 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.8231639862060547
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.773 Vali Acc: 0.527 Test Loss: 1.773 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.238715648651123
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.780 Vali Acc: 0.527 Test Loss: 1.780 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.067300796508789
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.786 Vali Acc: 0.519 Test Loss: 1.786 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.937682867050171
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.794 Vali Acc: 0.519 Test Loss: 1.794 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.1476356983184814
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.799 Vali Acc: 0.527 Test Loss: 1.799 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.9894001483917236
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.802 Vali Acc: 0.534 Test Loss: 1.802 Test Acc: 0.534
Validation loss decreased (-0.526701 --> -0.534333).  Saving model ...
Epoch: 21 cost time: 1.9392716884613037
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.806 Vali Acc: 0.534 Test Loss: 1.806 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.7928531169891357
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.810 Vali Acc: 0.534 Test Loss: 1.810 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.9750890731811523
Epoch: 23, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.816 Vali Acc: 0.534 Test Loss: 1.816 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.0775723457336426
Epoch: 24, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.824 Vali Acc: 0.534 Test Loss: 1.824 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.0866785049438477
Epoch: 25, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.832 Vali Acc: 0.527 Test Loss: 1.832 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.0402932167053223
Epoch: 26, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.837 Vali Acc: 0.534 Test Loss: 1.837 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.8806712627410889
Epoch: 27, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.843 Vali Acc: 0.534 Test Loss: 1.843 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.666152000427246
Epoch: 28, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.849 Vali Acc: 0.534 Test Loss: 1.849 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.5688579082489014
Epoch: 29, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.854 Vali Acc: 0.534 Test Loss: 1.854 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.9311776161193848
Epoch: 30, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.858 Vali Acc: 0.527 Test Loss: 1.858 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps3597_str900_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 79014149
model size : 316.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps3597_str1799_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.6893980503082275
Epoch: 1, Steps: 8 | Train Loss: 1.571 Vali Loss: 1.537 Vali Acc: 0.420 Test Loss: 1.537 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 1.9480528831481934
Epoch: 2, Steps: 8 | Train Loss: 1.195 Vali Loss: 1.552 Vali Acc: 0.481 Test Loss: 1.552 Test Acc: 0.481
Validation loss decreased (-0.419832 --> -0.480901).  Saving model ...
Epoch: 3 cost time: 2.0830206871032715
Epoch: 3, Steps: 8 | Train Loss: 0.644 Vali Loss: 1.567 Vali Acc: 0.443 Test Loss: 1.567 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.256890296936035
Epoch: 4, Steps: 8 | Train Loss: 0.293 Vali Loss: 1.570 Vali Acc: 0.458 Test Loss: 1.570 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.073719024658203
Epoch: 5, Steps: 8 | Train Loss: 0.112 Vali Loss: 1.534 Vali Acc: 0.481 Test Loss: 1.534 Test Acc: 0.481
Validation loss decreased (-0.480901 --> -0.480901).  Saving model ...
Epoch: 6 cost time: 1.7580461502075195
Epoch: 6, Steps: 8 | Train Loss: 0.037 Vali Loss: 1.582 Vali Acc: 0.466 Test Loss: 1.582 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6919670104980469
Epoch: 7, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.650 Vali Acc: 0.466 Test Loss: 1.650 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.7267858982086182
Epoch: 8, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.691 Vali Acc: 0.458 Test Loss: 1.691 Test Acc: 0.458
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.758941888809204
Epoch: 9, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.719 Vali Acc: 0.458 Test Loss: 1.719 Test Acc: 0.458
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.7781097888946533
Epoch: 10, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.736 Vali Acc: 0.466 Test Loss: 1.736 Test Acc: 0.466
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.8547680377960205
Epoch: 11, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.752 Vali Acc: 0.466 Test Loss: 1.752 Test Acc: 0.466
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.567230224609375
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.766 Vali Acc: 0.466 Test Loss: 1.766 Test Acc: 0.466
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.9305737018585205
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.780 Vali Acc: 0.458 Test Loss: 1.780 Test Acc: 0.458
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.7060041427612305
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.793 Vali Acc: 0.458 Test Loss: 1.793 Test Acc: 0.458
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.1699166297912598
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.807 Vali Acc: 0.458 Test Loss: 1.807 Test Acc: 0.458
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps3597_str1799_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.48091603053435117
model parameter : 78971141
model size : 315.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps3597_str3597_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.654668092727661
Epoch: 1, Steps: 8 | Train Loss: 1.580 Vali Loss: 1.533 Vali Acc: 0.412 Test Loss: 1.533 Test Acc: 0.412
Validation loss decreased (inf --> -0.412198).  Saving model ...
Epoch: 2 cost time: 1.6314349174499512
Epoch: 2, Steps: 8 | Train Loss: 1.211 Vali Loss: 1.484 Vali Acc: 0.489 Test Loss: 1.484 Test Acc: 0.489
Validation loss decreased (-0.412198 --> -0.488535).  Saving model ...
Epoch: 3 cost time: 1.8142471313476562
Epoch: 3, Steps: 8 | Train Loss: 0.716 Vali Loss: 1.581 Vali Acc: 0.443 Test Loss: 1.581 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6624689102172852
Epoch: 4, Steps: 8 | Train Loss: 0.304 Vali Loss: 1.616 Vali Acc: 0.427 Test Loss: 1.616 Test Acc: 0.427
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.7721905708312988
Epoch: 5, Steps: 8 | Train Loss: 0.096 Vali Loss: 1.593 Vali Acc: 0.489 Test Loss: 1.593 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.8304049968719482
Epoch: 6, Steps: 8 | Train Loss: 0.030 Vali Loss: 1.640 Vali Acc: 0.481 Test Loss: 1.640 Test Acc: 0.481
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.3686511516571045
Epoch: 7, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.705 Vali Acc: 0.489 Test Loss: 1.705 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.6599957942962646
Epoch: 8, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.755 Vali Acc: 0.481 Test Loss: 1.755 Test Acc: 0.481
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.6889984607696533
Epoch: 9, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.793 Vali Acc: 0.458 Test Loss: 1.793 Test Acc: 0.458
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.9988653659820557
Epoch: 10, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.824 Vali Acc: 0.473 Test Loss: 1.824 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.982417345046997
Epoch: 11, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.855 Vali Acc: 0.473 Test Loss: 1.855 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.8623223304748535
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.874 Vali Acc: 0.473 Test Loss: 1.874 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el4_dm768_df768_ps3597_str3597_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.48854961832061067
model parameter : 78949637
model size : 315.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps720_str180_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.204885482788086
Epoch: 1, Steps: 8 | Train Loss: 1.668 Vali Loss: 1.576 Vali Acc: 0.420 Test Loss: 1.576 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 1.0508694648742676
Epoch: 2, Steps: 8 | Train Loss: 1.399 Vali Loss: 1.559 Vali Acc: 0.427 Test Loss: 1.559 Test Acc: 0.427
Validation loss decreased (-0.419832 --> -0.427465).  Saving model ...
Epoch: 3 cost time: 1.0436644554138184
Epoch: 3, Steps: 8 | Train Loss: 1.243 Vali Loss: 1.515 Vali Acc: 0.450 Test Loss: 1.515 Test Acc: 0.450
Validation loss decreased (-0.427465 --> -0.450367).  Saving model ...
Epoch: 4 cost time: 1.1275718212127686
Epoch: 4, Steps: 8 | Train Loss: 0.873 Vali Loss: 1.335 Vali Acc: 0.496 Test Loss: 1.335 Test Acc: 0.496
Validation loss decreased (-0.450367 --> -0.496170).  Saving model ...
Epoch: 5 cost time: 1.297133207321167
Epoch: 5, Steps: 8 | Train Loss: 0.556 Vali Loss: 1.476 Vali Acc: 0.534 Test Loss: 1.476 Test Acc: 0.534
Validation loss decreased (-0.496170 --> -0.534336).  Saving model ...
Epoch: 6 cost time: 1.1012017726898193
Epoch: 6, Steps: 8 | Train Loss: 0.216 Vali Loss: 1.321 Vali Acc: 0.519 Test Loss: 1.321 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.368260145187378
Epoch: 7, Steps: 8 | Train Loss: 0.065 Vali Loss: 1.715 Vali Acc: 0.565 Test Loss: 1.715 Test Acc: 0.565
Validation loss decreased (-0.534336 --> -0.564868).  Saving model ...
Epoch: 8 cost time: 1.0665154457092285
Epoch: 8, Steps: 8 | Train Loss: 0.032 Vali Loss: 1.764 Vali Acc: 0.573 Test Loss: 1.764 Test Acc: 0.573
Validation loss decreased (-0.564868 --> -0.572501).  Saving model ...
Epoch: 9 cost time: 1.117966651916504
Epoch: 9, Steps: 8 | Train Loss: 0.019 Vali Loss: 1.581 Vali Acc: 0.527 Test Loss: 1.581 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0176715850830078
Epoch: 10, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.525 Vali Acc: 0.618 Test Loss: 1.525 Test Acc: 0.618
Validation loss decreased (-0.572501 --> -0.618305).  Saving model ...
Epoch: 11 cost time: 1.1399648189544678
Epoch: 11, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.472 Vali Acc: 0.634 Test Loss: 1.472 Test Acc: 0.634
Validation loss decreased (-0.618305 --> -0.633573).  Saving model ...
Epoch: 12 cost time: 1.1356854438781738
Epoch: 12, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.681 Vali Acc: 0.618 Test Loss: 1.681 Test Acc: 0.618
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0670714378356934
Epoch: 13, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.551 Vali Acc: 0.649 Test Loss: 1.551 Test Acc: 0.649
Validation loss decreased (-0.633573 --> -0.648839).  Saving model ...
Epoch: 14 cost time: 1.2457311153411865
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.566 Vali Acc: 0.618 Test Loss: 1.566 Test Acc: 0.618
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0122253894805908
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.586 Vali Acc: 0.626 Test Loss: 1.586 Test Acc: 0.626
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.401747226715088
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.579 Vali Acc: 0.641 Test Loss: 1.579 Test Acc: 0.641
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.2340190410614014
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.597 Vali Acc: 0.618 Test Loss: 1.597 Test Acc: 0.618
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.3385496139526367
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.590 Vali Acc: 0.634 Test Loss: 1.590 Test Acc: 0.634
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.3566069602966309
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.584 Vali Acc: 0.641 Test Loss: 1.584 Test Acc: 0.641
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.4328327178955078
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.587 Vali Acc: 0.634 Test Loss: 1.587 Test Acc: 0.634
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.4348926544189453
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.583 Vali Acc: 0.641 Test Loss: 1.583 Test Acc: 0.641
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.455763339996338
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.580 Vali Acc: 0.641 Test Loss: 1.580 Test Acc: 0.641
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.2304046154022217
Epoch: 23, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.581 Vali Acc: 0.641 Test Loss: 1.581 Test Acc: 0.641
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps720_str180_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.648854961832061
model parameter : 32584709
model size : 138.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps720_str360_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.3350772857666016
Epoch: 1, Steps: 8 | Train Loss: 1.598 Vali Loss: 1.682 Vali Acc: 0.420 Test Loss: 1.682 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 0.8953325748443604
Epoch: 2, Steps: 8 | Train Loss: 1.456 Vali Loss: 1.529 Vali Acc: 0.359 Test Loss: 1.529 Test Acc: 0.359
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8082668781280518
Epoch: 3, Steps: 8 | Train Loss: 1.248 Vali Loss: 1.517 Vali Acc: 0.427 Test Loss: 1.517 Test Acc: 0.427
Validation loss decreased (-0.419831 --> -0.427466).  Saving model ...
Epoch: 4 cost time: 0.8800559043884277
Epoch: 4, Steps: 8 | Train Loss: 0.980 Vali Loss: 1.296 Vali Acc: 0.504 Test Loss: 1.296 Test Acc: 0.504
Validation loss decreased (-0.427466 --> -0.503804).  Saving model ...
Epoch: 5 cost time: 0.8750209808349609
Epoch: 5, Steps: 8 | Train Loss: 0.745 Vali Loss: 1.306 Vali Acc: 0.534 Test Loss: 1.306 Test Acc: 0.534
Validation loss decreased (-0.503804 --> -0.534338).  Saving model ...
Epoch: 6 cost time: 0.8912460803985596
Epoch: 6, Steps: 8 | Train Loss: 0.411 Vali Loss: 1.311 Vali Acc: 0.527 Test Loss: 1.311 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8171355724334717
Epoch: 7, Steps: 8 | Train Loss: 0.186 Vali Loss: 1.406 Vali Acc: 0.534 Test Loss: 1.406 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.8430476188659668
Epoch: 8, Steps: 8 | Train Loss: 0.053 Vali Loss: 1.447 Vali Acc: 0.588 Test Loss: 1.447 Test Acc: 0.588
Validation loss decreased (-0.534338 --> -0.587772).  Saving model ...
Epoch: 9 cost time: 0.8429169654846191
Epoch: 9, Steps: 8 | Train Loss: 0.019 Vali Loss: 1.391 Vali Acc: 0.595 Test Loss: 1.391 Test Acc: 0.595
Validation loss decreased (-0.587772 --> -0.595406).  Saving model ...
Epoch: 10 cost time: 0.7472891807556152
Epoch: 10, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.525 Vali Acc: 0.588 Test Loss: 1.525 Test Acc: 0.588
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.769202470779419
Epoch: 11, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.554 Vali Acc: 0.626 Test Loss: 1.554 Test Acc: 0.626
Validation loss decreased (-0.595406 --> -0.625939).  Saving model ...
Epoch: 12 cost time: 0.7325708866119385
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.561 Vali Acc: 0.626 Test Loss: 1.561 Test Acc: 0.626
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6681087017059326
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.588 Vali Acc: 0.618 Test Loss: 1.588 Test Acc: 0.618
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.7325232028961182
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.632 Vali Acc: 0.626 Test Loss: 1.632 Test Acc: 0.626
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.7040917873382568
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.649 Vali Acc: 0.634 Test Loss: 1.649 Test Acc: 0.634
Validation loss decreased (-0.625939 --> -0.633571).  Saving model ...
Epoch: 16 cost time: 0.9823808670043945
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.628 Vali Acc: 0.626 Test Loss: 1.628 Test Acc: 0.626
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9379532337188721
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.622 Vali Acc: 0.618 Test Loss: 1.622 Test Acc: 0.618
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.999422550201416
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.625 Vali Acc: 0.618 Test Loss: 1.625 Test Acc: 0.618
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.9043624401092529
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.625 Vali Acc: 0.618 Test Loss: 1.625 Test Acc: 0.618
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.8894956111907959
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.642 Vali Acc: 0.626 Test Loss: 1.642 Test Acc: 0.626
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.9673621654510498
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.648 Vali Acc: 0.626 Test Loss: 1.648 Test Acc: 0.626
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.9052743911743164
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.648 Vali Acc: 0.626 Test Loss: 1.648 Test Acc: 0.626
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.7193243503570557
Epoch: 23, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.647 Vali Acc: 0.618 Test Loss: 1.647 Test Acc: 0.618
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.6868937015533447
Epoch: 24, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.650 Vali Acc: 0.618 Test Loss: 1.650 Test Acc: 0.618
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.7783772945404053
Epoch: 25, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.655 Vali Acc: 0.626 Test Loss: 1.655 Test Acc: 0.626
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps720_str360_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6335877862595419
model parameter : 32326661
model size : 137.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps720_str720_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.0979127883911133
Epoch: 1, Steps: 8 | Train Loss: 1.601 Vali Loss: 1.609 Vali Acc: 0.420 Test Loss: 1.609 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 0.8647968769073486
Epoch: 2, Steps: 8 | Train Loss: 1.447 Vali Loss: 1.507 Vali Acc: 0.420 Test Loss: 1.507 Test Acc: 0.420
Validation loss decreased (-0.419831 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 0.8678898811340332
Epoch: 3, Steps: 8 | Train Loss: 1.164 Vali Loss: 1.470 Vali Acc: 0.489 Test Loss: 1.470 Test Acc: 0.489
Validation loss decreased (-0.419832 --> -0.488535).  Saving model ...
Epoch: 4 cost time: 0.7114837169647217
Epoch: 4, Steps: 8 | Train Loss: 0.976 Vali Loss: 1.483 Vali Acc: 0.489 Test Loss: 1.483 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9084429740905762
Epoch: 5, Steps: 8 | Train Loss: 0.710 Vali Loss: 1.419 Vali Acc: 0.519 Test Loss: 1.419 Test Acc: 0.519
Validation loss decreased (-0.488535 --> -0.519070).  Saving model ...
Epoch: 6 cost time: 0.9112472534179688
Epoch: 6, Steps: 8 | Train Loss: 0.432 Vali Loss: 1.437 Vali Acc: 0.534 Test Loss: 1.437 Test Acc: 0.534
Validation loss decreased (-0.519070 --> -0.534337).  Saving model ...
Epoch: 7 cost time: 1.0202980041503906
Epoch: 7, Steps: 8 | Train Loss: 0.221 Vali Loss: 1.452 Vali Acc: 0.504 Test Loss: 1.452 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9125139713287354
Epoch: 8, Steps: 8 | Train Loss: 0.087 Vali Loss: 1.498 Vali Acc: 0.504 Test Loss: 1.498 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9087333679199219
Epoch: 9, Steps: 8 | Train Loss: 0.029 Vali Loss: 1.602 Vali Acc: 0.481 Test Loss: 1.602 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.0930850505828857
Epoch: 10, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.681 Vali Acc: 0.519 Test Loss: 1.681 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.9437592029571533
Epoch: 11, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.712 Vali Acc: 0.550 Test Loss: 1.712 Test Acc: 0.550
Validation loss decreased (-0.534337 --> -0.549601).  Saving model ...
Epoch: 12 cost time: 0.7405519485473633
Epoch: 12, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.720 Vali Acc: 0.542 Test Loss: 1.720 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9503865242004395
Epoch: 13, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.695 Vali Acc: 0.527 Test Loss: 1.695 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9118955135345459
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.688 Vali Acc: 0.519 Test Loss: 1.688 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.8838293552398682
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.698 Vali Acc: 0.519 Test Loss: 1.698 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.87923264503479
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.713 Vali Acc: 0.527 Test Loss: 1.713 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.8734538555145264
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.720 Vali Acc: 0.534 Test Loss: 1.720 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.8313548564910889
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.730 Vali Acc: 0.534 Test Loss: 1.730 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.8489892482757568
Epoch: 19, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.742 Vali Acc: 0.527 Test Loss: 1.742 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.6984264850616455
Epoch: 20, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.760 Vali Acc: 0.542 Test Loss: 1.760 Test Acc: 0.542
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.9059960842132568
Epoch: 21, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.770 Vali Acc: 0.542 Test Loss: 1.770 Test Acc: 0.542
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps720_str720_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 32197637
model size : 137.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps750_str188_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.6471400260925293
Epoch: 1, Steps: 8 | Train Loss: 1.542 Vali Loss: 1.638 Vali Acc: 0.420 Test Loss: 1.638 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 1.1117684841156006
Epoch: 2, Steps: 8 | Train Loss: 1.448 Vali Loss: 1.532 Vali Acc: 0.420 Test Loss: 1.532 Test Acc: 0.420
Validation loss decreased (-0.419831 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 1.4358396530151367
Epoch: 3, Steps: 8 | Train Loss: 1.182 Vali Loss: 1.496 Vali Acc: 0.427 Test Loss: 1.496 Test Acc: 0.427
Validation loss decreased (-0.419832 --> -0.427466).  Saving model ...
Epoch: 4 cost time: 1.4113259315490723
Epoch: 4, Steps: 8 | Train Loss: 0.913 Vali Loss: 1.302 Vali Acc: 0.504 Test Loss: 1.302 Test Acc: 0.504
Validation loss decreased (-0.427466 --> -0.503804).  Saving model ...
Epoch: 5 cost time: 1.2069520950317383
Epoch: 5, Steps: 8 | Train Loss: 0.514 Vali Loss: 1.213 Vali Acc: 0.511 Test Loss: 1.213 Test Acc: 0.511
Validation loss decreased (-0.503804 --> -0.511438).  Saving model ...
Epoch: 6 cost time: 1.3806705474853516
Epoch: 6, Steps: 8 | Train Loss: 0.193 Vali Loss: 1.553 Vali Acc: 0.359 Test Loss: 1.553 Test Acc: 0.359
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.129615068435669
Epoch: 7, Steps: 8 | Train Loss: 0.056 Vali Loss: 1.219 Vali Acc: 0.565 Test Loss: 1.219 Test Acc: 0.565
Validation loss decreased (-0.511438 --> -0.564873).  Saving model ...
Epoch: 8 cost time: 1.2159264087677002
Epoch: 8, Steps: 8 | Train Loss: 0.018 Vali Loss: 2.084 Vali Acc: 0.534 Test Loss: 2.084 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.134772539138794
Epoch: 9, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.424 Vali Acc: 0.481 Test Loss: 1.424 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.2584481239318848
Epoch: 10, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.872 Vali Acc: 0.527 Test Loss: 1.872 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.1728203296661377
Epoch: 11, Steps: 8 | Train Loss: 0.004 Vali Loss: 2.001 Vali Acc: 0.511 Test Loss: 2.001 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.178675889968872
Epoch: 12, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.912 Vali Acc: 0.481 Test Loss: 1.912 Test Acc: 0.481
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.1877849102020264
Epoch: 13, Steps: 8 | Train Loss: 0.002 Vali Loss: 2.758 Vali Acc: 0.519 Test Loss: 2.758 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.0010998249053955
Epoch: 14, Steps: 8 | Train Loss: 0.002 Vali Loss: 2.293 Vali Acc: 0.489 Test Loss: 2.293 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.390092372894287
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.305 Vali Acc: 0.496 Test Loss: 2.305 Test Acc: 0.496
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.8784208297729492
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.416 Vali Acc: 0.496 Test Loss: 2.416 Test Acc: 0.496
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.1273865699768066
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.471 Vali Acc: 0.519 Test Loss: 2.471 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps750_str188_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5648854961832062
model parameter : 32977925
model size : 140.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps750_str375_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.5721497535705566
Epoch: 1, Steps: 8 | Train Loss: 1.573 Vali Loss: 1.681 Vali Acc: 0.420 Test Loss: 1.681 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 1.2258968353271484
Epoch: 2, Steps: 8 | Train Loss: 1.408 Vali Loss: 1.566 Vali Acc: 0.435 Test Loss: 1.566 Test Acc: 0.435
Validation loss decreased (-0.419831 --> -0.435099).  Saving model ...
Epoch: 3 cost time: 1.0596415996551514
Epoch: 3, Steps: 8 | Train Loss: 1.247 Vali Loss: 1.537 Vali Acc: 0.427 Test Loss: 1.537 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0038535594940186
Epoch: 4, Steps: 8 | Train Loss: 0.965 Vali Loss: 1.376 Vali Acc: 0.519 Test Loss: 1.376 Test Acc: 0.519
Validation loss decreased (-0.435099 --> -0.519070).  Saving model ...
Epoch: 5 cost time: 0.8836791515350342
Epoch: 5, Steps: 8 | Train Loss: 0.638 Vali Loss: 1.432 Vali Acc: 0.534 Test Loss: 1.432 Test Acc: 0.534
Validation loss decreased (-0.519070 --> -0.534337).  Saving model ...
Epoch: 6 cost time: 0.9802992343902588
Epoch: 6, Steps: 8 | Train Loss: 0.342 Vali Loss: 1.303 Vali Acc: 0.511 Test Loss: 1.303 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9557795524597168
Epoch: 7, Steps: 8 | Train Loss: 0.158 Vali Loss: 1.382 Vali Acc: 0.458 Test Loss: 1.382 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9833135604858398
Epoch: 8, Steps: 8 | Train Loss: 0.049 Vali Loss: 1.412 Vali Acc: 0.542 Test Loss: 1.412 Test Acc: 0.542
Validation loss decreased (-0.534337 --> -0.541971).  Saving model ...
Epoch: 9 cost time: 0.9276666641235352
Epoch: 9, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.567 Vali Acc: 0.504 Test Loss: 1.567 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9549071788787842
Epoch: 10, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.616 Vali Acc: 0.565 Test Loss: 1.616 Test Acc: 0.565
Validation loss decreased (-0.541971 --> -0.564869).  Saving model ...
Epoch: 11 cost time: 1.2077245712280273
Epoch: 11, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.549 Vali Acc: 0.511 Test Loss: 1.549 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9921860694885254
Epoch: 12, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.615 Vali Acc: 0.542 Test Loss: 1.615 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.7878637313842773
Epoch: 13, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.599 Vali Acc: 0.542 Test Loss: 1.599 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.9635171890258789
Epoch: 14, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.858 Vali Acc: 0.489 Test Loss: 1.858 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.9812769889831543
Epoch: 15, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.871 Vali Acc: 0.519 Test Loss: 1.871 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.9750640392303467
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.809 Vali Acc: 0.534 Test Loss: 1.809 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.9454152584075928
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.779 Vali Acc: 0.557 Test Loss: 1.779 Test Acc: 0.557
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.094404697418213
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.749 Vali Acc: 0.550 Test Loss: 1.749 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.0030250549316406
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.741 Vali Acc: 0.550 Test Loss: 1.741 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.9986763000488281
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.751 Vali Acc: 0.534 Test Loss: 1.751 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps750_str375_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5648854961832062
model parameter : 32730629
model size : 139.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps750_str750_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 1.9915900230407715
Epoch: 1, Steps: 8 | Train Loss: 1.569 Vali Loss: 1.642 Vali Acc: 0.420 Test Loss: 1.642 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 1.145256757736206
Epoch: 2, Steps: 8 | Train Loss: 1.398 Vali Loss: 1.517 Vali Acc: 0.420 Test Loss: 1.517 Test Acc: 0.420
Validation loss decreased (-0.419831 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 0.8520479202270508
Epoch: 3, Steps: 8 | Train Loss: 1.244 Vali Loss: 1.452 Vali Acc: 0.450 Test Loss: 1.452 Test Acc: 0.450
Validation loss decreased (-0.419832 --> -0.450367).  Saving model ...
Epoch: 4 cost time: 0.9011154174804688
Epoch: 4, Steps: 8 | Train Loss: 0.933 Vali Loss: 1.438 Vali Acc: 0.489 Test Loss: 1.438 Test Acc: 0.489
Validation loss decreased (-0.450367 --> -0.488535).  Saving model ...
Epoch: 5 cost time: 1.1427021026611328
Epoch: 5, Steps: 8 | Train Loss: 0.655 Vali Loss: 1.332 Vali Acc: 0.519 Test Loss: 1.332 Test Acc: 0.519
Validation loss decreased (-0.488535 --> -0.519071).  Saving model ...
Epoch: 6 cost time: 0.9355368614196777
Epoch: 6, Steps: 8 | Train Loss: 0.394 Vali Loss: 1.286 Vali Acc: 0.550 Test Loss: 1.286 Test Acc: 0.550
Validation loss decreased (-0.519071 --> -0.549605).  Saving model ...
Epoch: 7 cost time: 1.186678409576416
Epoch: 7, Steps: 8 | Train Loss: 0.166 Vali Loss: 1.309 Vali Acc: 0.504 Test Loss: 1.309 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7443661689758301
Epoch: 8, Steps: 8 | Train Loss: 0.061 Vali Loss: 1.423 Vali Acc: 0.542 Test Loss: 1.423 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8820927143096924
Epoch: 9, Steps: 8 | Train Loss: 0.018 Vali Loss: 1.510 Vali Acc: 0.550 Test Loss: 1.510 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.8975768089294434
Epoch: 10, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.460 Vali Acc: 0.565 Test Loss: 1.460 Test Acc: 0.565
Validation loss decreased (-0.549605 --> -0.564871).  Saving model ...
Epoch: 11 cost time: 0.863025426864624
Epoch: 11, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.534 Vali Acc: 0.542 Test Loss: 1.534 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8458981513977051
Epoch: 12, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.650 Vali Acc: 0.534 Test Loss: 1.650 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.8928365707397461
Epoch: 13, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.596 Vali Acc: 0.534 Test Loss: 1.596 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.7402744293212891
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.546 Vali Acc: 0.550 Test Loss: 1.546 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.8333673477172852
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.558 Vali Acc: 0.550 Test Loss: 1.558 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.882124662399292
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.585 Vali Acc: 0.550 Test Loss: 1.585 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.8672022819519043
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.603 Vali Acc: 0.550 Test Loss: 1.603 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.8411130905151367
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.622 Vali Acc: 0.534 Test Loss: 1.622 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.6789677143096924
Epoch: 19, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.638 Vali Acc: 0.534 Test Loss: 1.638 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.8527772426605225
Epoch: 20, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.653 Vali Acc: 0.542 Test Loss: 1.653 Test Acc: 0.542
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps750_str750_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5648854961832062
model parameter : 32606981
model size : 139.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps782_str196_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.3008832931518555
Epoch: 1, Steps: 8 | Train Loss: 1.560 Vali Loss: 1.616 Vali Acc: 0.420 Test Loss: 1.616 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 1.1227812767028809
Epoch: 2, Steps: 8 | Train Loss: 1.472 Vali Loss: 1.471 Vali Acc: 0.420 Test Loss: 1.471 Test Acc: 0.420
Validation loss decreased (-0.419831 --> -0.419833).  Saving model ...
Epoch: 3 cost time: 1.2847325801849365
Epoch: 3, Steps: 8 | Train Loss: 1.250 Vali Loss: 1.488 Vali Acc: 0.450 Test Loss: 1.488 Test Acc: 0.450
Validation loss decreased (-0.419833 --> -0.450367).  Saving model ...
Epoch: 4 cost time: 1.2682344913482666
Epoch: 4, Steps: 8 | Train Loss: 0.934 Vali Loss: 1.525 Vali Acc: 0.443 Test Loss: 1.525 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0561652183532715
Epoch: 5, Steps: 8 | Train Loss: 0.523 Vali Loss: 1.349 Vali Acc: 0.473 Test Loss: 1.349 Test Acc: 0.473
Validation loss decreased (-0.450367 --> -0.473269).  Saving model ...
Epoch: 6 cost time: 1.1320273876190186
Epoch: 6, Steps: 8 | Train Loss: 0.257 Vali Loss: 1.752 Vali Acc: 0.519 Test Loss: 1.752 Test Acc: 0.519
Validation loss decreased (-0.473269 --> -0.519066).  Saving model ...
Epoch: 7 cost time: 1.2782878875732422
Epoch: 7, Steps: 8 | Train Loss: 0.095 Vali Loss: 1.787 Vali Acc: 0.534 Test Loss: 1.787 Test Acc: 0.534
Validation loss decreased (-0.519066 --> -0.534333).  Saving model ...
Epoch: 8 cost time: 1.1620874404907227
Epoch: 8, Steps: 8 | Train Loss: 0.038 Vali Loss: 1.765 Vali Acc: 0.550 Test Loss: 1.765 Test Acc: 0.550
Validation loss decreased (-0.534333 --> -0.549601).  Saving model ...
Epoch: 9 cost time: 1.242231845855713
Epoch: 9, Steps: 8 | Train Loss: 0.023 Vali Loss: 1.497 Vali Acc: 0.466 Test Loss: 1.497 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0289206504821777
Epoch: 10, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.803 Vali Acc: 0.542 Test Loss: 1.803 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.358443260192871
Epoch: 11, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.846 Vali Acc: 0.458 Test Loss: 1.846 Test Acc: 0.458
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.505112886428833
Epoch: 12, Steps: 8 | Train Loss: 0.003 Vali Loss: 2.157 Vali Acc: 0.504 Test Loss: 2.157 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.4335741996765137
Epoch: 13, Steps: 8 | Train Loss: 0.002 Vali Loss: 2.177 Vali Acc: 0.527 Test Loss: 2.177 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.294208288192749
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.903 Vali Acc: 0.496 Test Loss: 1.903 Test Acc: 0.496
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.3314330577850342
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.870 Vali Acc: 0.473 Test Loss: 1.870 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.2274539470672607
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.920 Vali Acc: 0.473 Test Loss: 1.920 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.875849723815918
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.973 Vali Acc: 0.489 Test Loss: 1.973 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.1675679683685303
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.012 Vali Acc: 0.489 Test Loss: 2.012 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps782_str196_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 33398789
model size : 142.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps782_str391_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.476853847503662
Epoch: 1, Steps: 8 | Train Loss: 1.571 Vali Loss: 1.648 Vali Acc: 0.420 Test Loss: 1.648 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 1.0208773612976074
Epoch: 2, Steps: 8 | Train Loss: 1.390 Vali Loss: 1.571 Vali Acc: 0.420 Test Loss: 1.571 Test Acc: 0.420
Validation loss decreased (-0.419831 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 0.9567859172821045
Epoch: 3, Steps: 8 | Train Loss: 1.209 Vali Loss: 1.554 Vali Acc: 0.427 Test Loss: 1.554 Test Acc: 0.427
Validation loss decreased (-0.419832 --> -0.427465).  Saving model ...
Epoch: 4 cost time: 0.9884703159332275
Epoch: 4, Steps: 8 | Train Loss: 0.960 Vali Loss: 1.579 Vali Acc: 0.435 Test Loss: 1.579 Test Acc: 0.435
Validation loss decreased (-0.427465 --> -0.435099).  Saving model ...
Epoch: 5 cost time: 0.9420516490936279
Epoch: 5, Steps: 8 | Train Loss: 0.679 Vali Loss: 1.398 Vali Acc: 0.519 Test Loss: 1.398 Test Acc: 0.519
Validation loss decreased (-0.435099 --> -0.519070).  Saving model ...
Epoch: 6 cost time: 1.0532827377319336
Epoch: 6, Steps: 8 | Train Loss: 0.331 Vali Loss: 1.492 Vali Acc: 0.473 Test Loss: 1.492 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0198845863342285
Epoch: 7, Steps: 8 | Train Loss: 0.124 Vali Loss: 1.463 Vali Acc: 0.496 Test Loss: 1.463 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.060013771057129
Epoch: 8, Steps: 8 | Train Loss: 0.033 Vali Loss: 1.582 Vali Acc: 0.550 Test Loss: 1.582 Test Acc: 0.550
Validation loss decreased (-0.519070 --> -0.549603).  Saving model ...
Epoch: 9 cost time: 0.97369384765625
Epoch: 9, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.649 Vali Acc: 0.565 Test Loss: 1.649 Test Acc: 0.565
Validation loss decreased (-0.549603 --> -0.564869).  Saving model ...
Epoch: 10 cost time: 0.9943692684173584
Epoch: 10, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.795 Vali Acc: 0.573 Test Loss: 1.795 Test Acc: 0.573
Validation loss decreased (-0.564869 --> -0.572501).  Saving model ...
Epoch: 11 cost time: 1.0815825462341309
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.696 Vali Acc: 0.573 Test Loss: 1.696 Test Acc: 0.573
Validation loss decreased (-0.572501 --> -0.572502).  Saving model ...
Epoch: 12 cost time: 1.0496008396148682
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.672 Vali Acc: 0.565 Test Loss: 1.672 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9469068050384521
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.726 Vali Acc: 0.565 Test Loss: 1.726 Test Acc: 0.565
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9901926517486572
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.752 Vali Acc: 0.580 Test Loss: 1.752 Test Acc: 0.580
Validation loss decreased (-0.572502 --> -0.580135).  Saving model ...
Epoch: 15 cost time: 1.0696699619293213
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.758 Vali Acc: 0.580 Test Loss: 1.758 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7404110431671143
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.749 Vali Acc: 0.565 Test Loss: 1.749 Test Acc: 0.565
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9155313968658447
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.763 Vali Acc: 0.565 Test Loss: 1.763 Test Acc: 0.565
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.9697022438049316
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.769 Vali Acc: 0.565 Test Loss: 1.769 Test Acc: 0.565
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.1845848560333252
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.780 Vali Acc: 0.565 Test Loss: 1.780 Test Acc: 0.565
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.226273536682129
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.790 Vali Acc: 0.565 Test Loss: 1.790 Test Acc: 0.565
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.9596209526062012
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.798 Vali Acc: 0.565 Test Loss: 1.798 Test Acc: 0.565
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.9596478939056396
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.801 Vali Acc: 0.565 Test Loss: 1.801 Test Acc: 0.565
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.8306581974029541
Epoch: 23, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.800 Vali Acc: 0.573 Test Loss: 1.800 Test Acc: 0.573
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.0216224193572998
Epoch: 24, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.805 Vali Acc: 0.573 Test Loss: 1.805 Test Acc: 0.573
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps782_str391_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5801526717557252
model parameter : 33162245
model size : 141.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps782_str782_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.3037407398223877
Epoch: 1, Steps: 8 | Train Loss: 1.533 Vali Loss: 1.606 Vali Acc: 0.420 Test Loss: 1.606 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 1.0077340602874756
Epoch: 2, Steps: 8 | Train Loss: 1.401 Vali Loss: 1.538 Vali Acc: 0.420 Test Loss: 1.538 Test Acc: 0.420
Validation loss decreased (-0.419831 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 0.9964694976806641
Epoch: 3, Steps: 8 | Train Loss: 1.168 Vali Loss: 1.515 Vali Acc: 0.473 Test Loss: 1.515 Test Acc: 0.473
Validation loss decreased (-0.419832 --> -0.473267).  Saving model ...
Epoch: 4 cost time: 1.2788639068603516
Epoch: 4, Steps: 8 | Train Loss: 0.946 Vali Loss: 1.478 Vali Acc: 0.496 Test Loss: 1.478 Test Acc: 0.496
Validation loss decreased (-0.473267 --> -0.496168).  Saving model ...
Epoch: 5 cost time: 0.7705478668212891
Epoch: 5, Steps: 8 | Train Loss: 0.666 Vali Loss: 1.525 Vali Acc: 0.450 Test Loss: 1.525 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7743656635284424
Epoch: 6, Steps: 8 | Train Loss: 0.400 Vali Loss: 1.424 Vali Acc: 0.450 Test Loss: 1.424 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.7159614562988281
Epoch: 7, Steps: 8 | Train Loss: 0.206 Vali Loss: 1.458 Vali Acc: 0.466 Test Loss: 1.458 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.8038055896759033
Epoch: 8, Steps: 8 | Train Loss: 0.074 Vali Loss: 1.474 Vali Acc: 0.550 Test Loss: 1.474 Test Acc: 0.550
Validation loss decreased (-0.496168 --> -0.549604).  Saving model ...
Epoch: 9 cost time: 0.8678302764892578
Epoch: 9, Steps: 8 | Train Loss: 0.025 Vali Loss: 1.495 Vali Acc: 0.550 Test Loss: 1.495 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7258663177490234
Epoch: 10, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.597 Vali Acc: 0.542 Test Loss: 1.597 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8677530288696289
Epoch: 11, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.608 Vali Acc: 0.550 Test Loss: 1.608 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.8685452938079834
Epoch: 12, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.656 Vali Acc: 0.550 Test Loss: 1.656 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.8379359245300293
Epoch: 13, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.669 Vali Acc: 0.542 Test Loss: 1.669 Test Acc: 0.542
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.8796722888946533
Epoch: 14, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.670 Vali Acc: 0.527 Test Loss: 1.670 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.9189693927764893
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.664 Vali Acc: 0.527 Test Loss: 1.664 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.8021867275238037
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.653 Vali Acc: 0.527 Test Loss: 1.653 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.8738870620727539
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.650 Vali Acc: 0.534 Test Loss: 1.650 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.8490850925445557
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.657 Vali Acc: 0.534 Test Loss: 1.657 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps782_str782_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 33043973
model size : 140.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps818_str205_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.480482816696167
Epoch: 1, Steps: 8 | Train Loss: 1.577 Vali Loss: 1.654 Vali Acc: 0.420 Test Loss: 1.654 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 1.1884162425994873
Epoch: 2, Steps: 8 | Train Loss: 1.433 Vali Loss: 1.579 Vali Acc: 0.420 Test Loss: 1.579 Test Acc: 0.420
Validation loss decreased (-0.419831 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 0.9066238403320312
Epoch: 3, Steps: 8 | Train Loss: 1.123 Vali Loss: 1.529 Vali Acc: 0.458 Test Loss: 1.529 Test Acc: 0.458
Validation loss decreased (-0.419832 --> -0.458000).  Saving model ...
Epoch: 4 cost time: 1.1005077362060547
Epoch: 4, Steps: 8 | Train Loss: 0.834 Vali Loss: 1.409 Vali Acc: 0.466 Test Loss: 1.409 Test Acc: 0.466
Validation loss decreased (-0.458000 --> -0.465635).  Saving model ...
Epoch: 5 cost time: 1.0883500576019287
Epoch: 5, Steps: 8 | Train Loss: 0.580 Vali Loss: 1.327 Vali Acc: 0.519 Test Loss: 1.327 Test Acc: 0.519
Validation loss decreased (-0.465635 --> -0.519071).  Saving model ...
Epoch: 6 cost time: 1.1496880054473877
Epoch: 6, Steps: 8 | Train Loss: 0.257 Vali Loss: 1.540 Vali Acc: 0.527 Test Loss: 1.540 Test Acc: 0.527
Validation loss decreased (-0.519071 --> -0.526702).  Saving model ...
Epoch: 7 cost time: 1.103583574295044
Epoch: 7, Steps: 8 | Train Loss: 0.066 Vali Loss: 1.244 Vali Acc: 0.634 Test Loss: 1.244 Test Acc: 0.634
Validation loss decreased (-0.526702 --> -0.633575).  Saving model ...
Epoch: 8 cost time: 1.0996923446655273
Epoch: 8, Steps: 8 | Train Loss: 0.037 Vali Loss: 1.518 Vali Acc: 0.565 Test Loss: 1.518 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.164635419845581
Epoch: 9, Steps: 8 | Train Loss: 0.012 Vali Loss: 2.241 Vali Acc: 0.603 Test Loss: 2.241 Test Acc: 0.603
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.4628827571868896
Epoch: 10, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.835 Vali Acc: 0.580 Test Loss: 1.835 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.5092380046844482
Epoch: 11, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.981 Vali Acc: 0.565 Test Loss: 1.981 Test Acc: 0.565
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.2717108726501465
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.928 Vali Acc: 0.611 Test Loss: 1.928 Test Acc: 0.611
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.1910192966461182
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.921 Vali Acc: 0.565 Test Loss: 1.921 Test Acc: 0.565
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.0657806396484375
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.980 Vali Acc: 0.550 Test Loss: 1.980 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.134073257446289
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.010 Vali Acc: 0.557 Test Loss: 2.010 Test Acc: 0.557
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.9393520355224609
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.943 Vali Acc: 0.565 Test Loss: 1.943 Test Acc: 0.565
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.1238181591033936
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.901 Vali Acc: 0.557 Test Loss: 1.901 Test Acc: 0.557
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps818_str205_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6335877862595419
model parameter : 33874949
model size : 143.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps818_str409_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.058018922805786
Epoch: 1, Steps: 8 | Train Loss: 1.505 Vali Loss: 1.622 Vali Acc: 0.420 Test Loss: 1.622 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 1.006955862045288
Epoch: 2, Steps: 8 | Train Loss: 1.387 Vali Loss: 1.533 Vali Acc: 0.427 Test Loss: 1.533 Test Acc: 0.427
Validation loss decreased (-0.419831 --> -0.427466).  Saving model ...
Epoch: 3 cost time: 0.9026918411254883
Epoch: 3, Steps: 8 | Train Loss: 1.141 Vali Loss: 1.469 Vali Acc: 0.458 Test Loss: 1.469 Test Acc: 0.458
Validation loss decreased (-0.427466 --> -0.458001).  Saving model ...
Epoch: 4 cost time: 1.187302827835083
Epoch: 4, Steps: 8 | Train Loss: 0.876 Vali Loss: 1.276 Vali Acc: 0.542 Test Loss: 1.276 Test Acc: 0.542
Validation loss decreased (-0.458001 --> -0.541972).  Saving model ...
Epoch: 5 cost time: 1.0280861854553223
Epoch: 5, Steps: 8 | Train Loss: 0.538 Vali Loss: 1.247 Vali Acc: 0.473 Test Loss: 1.247 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9518687725067139
Epoch: 6, Steps: 8 | Train Loss: 0.301 Vali Loss: 1.192 Vali Acc: 0.527 Test Loss: 1.192 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.8664302825927734
Epoch: 7, Steps: 8 | Train Loss: 0.114 Vali Loss: 1.152 Vali Acc: 0.580 Test Loss: 1.152 Test Acc: 0.580
Validation loss decreased (-0.541972 --> -0.580141).  Saving model ...
Epoch: 8 cost time: 1.074491024017334
Epoch: 8, Steps: 8 | Train Loss: 0.034 Vali Loss: 1.435 Vali Acc: 0.542 Test Loss: 1.435 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9229879379272461
Epoch: 9, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.328 Vali Acc: 0.595 Test Loss: 1.328 Test Acc: 0.595
Validation loss decreased (-0.580141 --> -0.595407).  Saving model ...
Epoch: 10 cost time: 1.0290882587432861
Epoch: 10, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.449 Vali Acc: 0.580 Test Loss: 1.449 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0545454025268555
Epoch: 11, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.363 Vali Acc: 0.595 Test Loss: 1.363 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9868543148040771
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.433 Vali Acc: 0.588 Test Loss: 1.433 Test Acc: 0.588
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.310863733291626
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.529 Vali Acc: 0.557 Test Loss: 1.529 Test Acc: 0.557
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.9506123065948486
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.565 Vali Acc: 0.580 Test Loss: 1.565 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.9705522060394287
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.509 Vali Acc: 0.573 Test Loss: 1.509 Test Acc: 0.573
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.7532334327697754
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.476 Vali Acc: 0.565 Test Loss: 1.476 Test Acc: 0.565
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.9525609016418457
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.462 Vali Acc: 0.573 Test Loss: 1.462 Test Acc: 0.573
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.7778933048248291
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.473 Vali Acc: 0.573 Test Loss: 1.473 Test Acc: 0.573
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.2506914138793945
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.479 Vali Acc: 0.573 Test Loss: 1.479 Test Acc: 0.573
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps818_str409_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5954198473282443
model parameter : 33649157
model size : 143.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps818_str818_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.785905599594116
Epoch: 1, Steps: 8 | Train Loss: 1.512 Vali Loss: 1.519 Vali Acc: 0.420 Test Loss: 1.519 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 0.9905288219451904
Epoch: 2, Steps: 8 | Train Loss: 1.404 Vali Loss: 1.541 Vali Acc: 0.435 Test Loss: 1.541 Test Acc: 0.435
Validation loss decreased (-0.419832 --> -0.435099).  Saving model ...
Epoch: 3 cost time: 1.1121985912322998
Epoch: 3, Steps: 8 | Train Loss: 1.143 Vali Loss: 1.455 Vali Acc: 0.450 Test Loss: 1.455 Test Acc: 0.450
Validation loss decreased (-0.435099 --> -0.450367).  Saving model ...
Epoch: 4 cost time: 0.9889764785766602
Epoch: 4, Steps: 8 | Train Loss: 0.900 Vali Loss: 1.360 Vali Acc: 0.527 Test Loss: 1.360 Test Acc: 0.527
Validation loss decreased (-0.450367 --> -0.526704).  Saving model ...
Epoch: 5 cost time: 0.739377498626709
Epoch: 5, Steps: 8 | Train Loss: 0.567 Vali Loss: 1.310 Vali Acc: 0.557 Test Loss: 1.310 Test Acc: 0.557
Validation loss decreased (-0.526704 --> -0.557239).  Saving model ...
Epoch: 6 cost time: 1.1570158004760742
Epoch: 6, Steps: 8 | Train Loss: 0.328 Vali Loss: 1.330 Vali Acc: 0.565 Test Loss: 1.330 Test Acc: 0.565
Validation loss decreased (-0.557239 --> -0.564872).  Saving model ...
Epoch: 7 cost time: 0.9981701374053955
Epoch: 7, Steps: 8 | Train Loss: 0.147 Vali Loss: 1.304 Vali Acc: 0.511 Test Loss: 1.304 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.899024486541748
Epoch: 8, Steps: 8 | Train Loss: 0.053 Vali Loss: 1.431 Vali Acc: 0.534 Test Loss: 1.431 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9189841747283936
Epoch: 9, Steps: 8 | Train Loss: 0.019 Vali Loss: 1.480 Vali Acc: 0.527 Test Loss: 1.480 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.914276123046875
Epoch: 10, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.479 Vali Acc: 0.527 Test Loss: 1.479 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.7542304992675781
Epoch: 11, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.534 Vali Acc: 0.542 Test Loss: 1.534 Test Acc: 0.542
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.9286978244781494
Epoch: 12, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.596 Vali Acc: 0.557 Test Loss: 1.596 Test Acc: 0.557
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.8547227382659912
Epoch: 13, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.596 Vali Acc: 0.542 Test Loss: 1.596 Test Acc: 0.542
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.8823678493499756
Epoch: 14, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.595 Vali Acc: 0.542 Test Loss: 1.595 Test Acc: 0.542
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.8838093280792236
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.581 Vali Acc: 0.550 Test Loss: 1.581 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.953632116317749
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.582 Vali Acc: 0.557 Test Loss: 1.582 Test Acc: 0.557
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps818_str818_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5648854961832062
model parameter : 33536261
model size : 142.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps857_str215_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.303204298019409
Epoch: 1, Steps: 8 | Train Loss: 1.568 Vali Loss: 1.777 Vali Acc: 0.420 Test Loss: 1.777 Test Acc: 0.420
Validation loss decreased (inf --> -0.419830).  Saving model ...
Epoch: 2 cost time: 1.1566319465637207
Epoch: 2, Steps: 8 | Train Loss: 1.497 Vali Loss: 1.623 Vali Acc: 0.374 Test Loss: 1.623 Test Acc: 0.374
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8967676162719727
Epoch: 3, Steps: 8 | Train Loss: 1.216 Vali Loss: 1.565 Vali Acc: 0.420 Test Loss: 1.565 Test Acc: 0.420
Validation loss decreased (-0.419830 --> -0.419832).  Saving model ...
Epoch: 4 cost time: 1.3489632606506348
Epoch: 4, Steps: 8 | Train Loss: 0.956 Vali Loss: 1.393 Vali Acc: 0.504 Test Loss: 1.393 Test Acc: 0.504
Validation loss decreased (-0.419832 --> -0.503803).  Saving model ...
Epoch: 5 cost time: 1.096937894821167
Epoch: 5, Steps: 8 | Train Loss: 0.696 Vali Loss: 1.379 Vali Acc: 0.481 Test Loss: 1.379 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.029740571975708
Epoch: 6, Steps: 8 | Train Loss: 0.283 Vali Loss: 1.377 Vali Acc: 0.489 Test Loss: 1.377 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1782238483428955
Epoch: 7, Steps: 8 | Train Loss: 0.097 Vali Loss: 1.227 Vali Acc: 0.565 Test Loss: 1.227 Test Acc: 0.565
Validation loss decreased (-0.503803 --> -0.564873).  Saving model ...
Epoch: 8 cost time: 1.0844395160675049
Epoch: 8, Steps: 8 | Train Loss: 0.038 Vali Loss: 1.361 Vali Acc: 0.565 Test Loss: 1.361 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1012911796569824
Epoch: 9, Steps: 8 | Train Loss: 0.021 Vali Loss: 1.645 Vali Acc: 0.588 Test Loss: 1.645 Test Acc: 0.588
Validation loss decreased (-0.564873 --> -0.587770).  Saving model ...
Epoch: 10 cost time: 1.4163811206817627
Epoch: 10, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.577 Vali Acc: 0.496 Test Loss: 1.577 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4993617534637451
Epoch: 11, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.386 Vali Acc: 0.550 Test Loss: 1.386 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.5520856380462646
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.462 Vali Acc: 0.580 Test Loss: 1.462 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.483781099319458
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.430 Vali Acc: 0.557 Test Loss: 1.430 Test Acc: 0.557
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.1405909061431885
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.444 Vali Acc: 0.565 Test Loss: 1.444 Test Acc: 0.565
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.0551207065582275
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.487 Vali Acc: 0.565 Test Loss: 1.487 Test Acc: 0.565
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.3231430053710938
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.529 Vali Acc: 0.550 Test Loss: 1.529 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.1808562278747559
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.562 Vali Acc: 0.557 Test Loss: 1.562 Test Acc: 0.557
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.9978573322296143
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.581 Vali Acc: 0.557 Test Loss: 1.581 Test Acc: 0.557
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.1323697566986084
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.576 Vali Acc: 0.565 Test Loss: 1.576 Test Acc: 0.565
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps857_str215_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5877862595419847
model parameter : 34392581
model size : 145.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps857_str429_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.0479648113250732
Epoch: 1, Steps: 8 | Train Loss: 1.659 Vali Loss: 1.641 Vali Acc: 0.420 Test Loss: 1.641 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 0.804297685623169
Epoch: 2, Steps: 8 | Train Loss: 1.420 Vali Loss: 1.602 Vali Acc: 0.420 Test Loss: 1.602 Test Acc: 0.420
Validation loss decreased (-0.419831 --> -0.419831).  Saving model ...
Epoch: 3 cost time: 1.0197291374206543
Epoch: 3, Steps: 8 | Train Loss: 1.178 Vali Loss: 1.546 Vali Acc: 0.435 Test Loss: 1.546 Test Acc: 0.435
Validation loss decreased (-0.419831 --> -0.435099).  Saving model ...
Epoch: 4 cost time: 0.9741294384002686
Epoch: 4, Steps: 8 | Train Loss: 0.903 Vali Loss: 1.419 Vali Acc: 0.496 Test Loss: 1.419 Test Acc: 0.496
Validation loss decreased (-0.435099 --> -0.496169).  Saving model ...
Epoch: 5 cost time: 0.9215764999389648
Epoch: 5, Steps: 8 | Train Loss: 0.595 Vali Loss: 1.346 Vali Acc: 0.527 Test Loss: 1.346 Test Acc: 0.527
Validation loss decreased (-0.496169 --> -0.526704).  Saving model ...
Epoch: 6 cost time: 0.952477216720581
Epoch: 6, Steps: 8 | Train Loss: 0.346 Vali Loss: 1.303 Vali Acc: 0.519 Test Loss: 1.303 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.946483850479126
Epoch: 7, Steps: 8 | Train Loss: 0.137 Vali Loss: 1.446 Vali Acc: 0.534 Test Loss: 1.446 Test Acc: 0.534
Validation loss decreased (-0.526704 --> -0.534337).  Saving model ...
Epoch: 8 cost time: 1.3008637428283691
Epoch: 8, Steps: 8 | Train Loss: 0.047 Vali Loss: 1.343 Vali Acc: 0.504 Test Loss: 1.343 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9684317111968994
Epoch: 9, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.398 Vali Acc: 0.519 Test Loss: 1.398 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9291808605194092
Epoch: 10, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.513 Vali Acc: 0.542 Test Loss: 1.513 Test Acc: 0.542
Validation loss decreased (-0.534337 --> -0.541970).  Saving model ...
Epoch: 11 cost time: 1.142296314239502
Epoch: 11, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.448 Vali Acc: 0.527 Test Loss: 1.448 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0109448432922363
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.465 Vali Acc: 0.519 Test Loss: 1.465 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.058044195175171
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.501 Vali Acc: 0.519 Test Loss: 1.501 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.9522767066955566
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.529 Vali Acc: 0.519 Test Loss: 1.529 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.932884693145752
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.528 Vali Acc: 0.519 Test Loss: 1.528 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.8893187046051025
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.517 Vali Acc: 0.519 Test Loss: 1.517 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.9900088310241699
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.519 Vali Acc: 0.527 Test Loss: 1.519 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.0706367492675781
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.550 Vali Acc: 0.534 Test Loss: 1.550 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.9820737838745117
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.560 Vali Acc: 0.534 Test Loss: 1.560 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.076413869857788
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.556 Vali Acc: 0.534 Test Loss: 1.556 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps857_str429_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 34177541
model size : 145.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps857_str857_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.2089908123016357
Epoch: 1, Steps: 8 | Train Loss: 1.571 Vali Loss: 1.600 Vali Acc: 0.420 Test Loss: 1.600 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 0.7227401733398438
Epoch: 2, Steps: 8 | Train Loss: 1.405 Vali Loss: 1.514 Vali Acc: 0.427 Test Loss: 1.514 Test Acc: 0.427
Validation loss decreased (-0.419831 --> -0.427466).  Saving model ...
Epoch: 3 cost time: 0.7254998683929443
Epoch: 3, Steps: 8 | Train Loss: 1.182 Vali Loss: 1.469 Vali Acc: 0.435 Test Loss: 1.469 Test Acc: 0.435
Validation loss decreased (-0.427466 --> -0.435100).  Saving model ...
Epoch: 4 cost time: 0.8976037502288818
Epoch: 4, Steps: 8 | Train Loss: 0.933 Vali Loss: 1.401 Vali Acc: 0.519 Test Loss: 1.401 Test Acc: 0.519
Validation loss decreased (-0.435100 --> -0.519070).  Saving model ...
Epoch: 5 cost time: 0.7583434581756592
Epoch: 5, Steps: 8 | Train Loss: 0.618 Vali Loss: 1.373 Vali Acc: 0.519 Test Loss: 1.373 Test Acc: 0.519
Validation loss decreased (-0.519070 --> -0.519070).  Saving model ...
Epoch: 6 cost time: 1.1671438217163086
Epoch: 6, Steps: 8 | Train Loss: 0.347 Vali Loss: 1.351 Vali Acc: 0.481 Test Loss: 1.351 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0378916263580322
Epoch: 7, Steps: 8 | Train Loss: 0.172 Vali Loss: 1.434 Vali Acc: 0.542 Test Loss: 1.434 Test Acc: 0.542
Validation loss decreased (-0.519070 --> -0.541970).  Saving model ...
Epoch: 8 cost time: 0.8938493728637695
Epoch: 8, Steps: 8 | Train Loss: 0.063 Vali Loss: 1.474 Vali Acc: 0.496 Test Loss: 1.474 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7365033626556396
Epoch: 9, Steps: 8 | Train Loss: 0.024 Vali Loss: 1.562 Vali Acc: 0.481 Test Loss: 1.562 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.74053955078125
Epoch: 10, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.785 Vali Acc: 0.496 Test Loss: 1.785 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.7407689094543457
Epoch: 11, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.752 Vali Acc: 0.511 Test Loss: 1.752 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.8755903244018555
Epoch: 12, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.751 Vali Acc: 0.511 Test Loss: 1.751 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.7870290279388428
Epoch: 13, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.781 Vali Acc: 0.519 Test Loss: 1.781 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.7222456932067871
Epoch: 14, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.795 Vali Acc: 0.519 Test Loss: 1.795 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.8519964218139648
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.805 Vali Acc: 0.519 Test Loss: 1.805 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.0282573699951172
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.825 Vali Acc: 0.519 Test Loss: 1.825 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.7502150535583496
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.843 Vali Acc: 0.511 Test Loss: 1.843 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps857_str857_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 34070021
model size : 144.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps900_str225_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.2073707580566406
Epoch: 1, Steps: 8 | Train Loss: 1.653 Vali Loss: 1.782 Vali Acc: 0.420 Test Loss: 1.782 Test Acc: 0.420
Validation loss decreased (inf --> -0.419830).  Saving model ...
Epoch: 2 cost time: 1.0220801830291748
Epoch: 2, Steps: 8 | Train Loss: 1.425 Vali Loss: 1.526 Vali Acc: 0.427 Test Loss: 1.526 Test Acc: 0.427
Validation loss decreased (-0.419830 --> -0.427466).  Saving model ...
Epoch: 3 cost time: 1.2815191745758057
Epoch: 3, Steps: 8 | Train Loss: 1.194 Vali Loss: 1.501 Vali Acc: 0.427 Test Loss: 1.501 Test Acc: 0.427
Validation loss decreased (-0.427466 --> -0.427466).  Saving model ...
Epoch: 4 cost time: 1.0778672695159912
Epoch: 4, Steps: 8 | Train Loss: 0.840 Vali Loss: 1.511 Vali Acc: 0.496 Test Loss: 1.511 Test Acc: 0.496
Validation loss decreased (-0.427466 --> -0.496168).  Saving model ...
Epoch: 5 cost time: 1.0922791957855225
Epoch: 5, Steps: 8 | Train Loss: 0.454 Vali Loss: 1.319 Vali Acc: 0.466 Test Loss: 1.319 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.000849962234497
Epoch: 6, Steps: 8 | Train Loss: 0.147 Vali Loss: 1.443 Vali Acc: 0.550 Test Loss: 1.443 Test Acc: 0.550
Validation loss decreased (-0.496168 --> -0.549604).  Saving model ...
Epoch: 7 cost time: 1.3369903564453125
Epoch: 7, Steps: 8 | Train Loss: 0.042 Vali Loss: 1.897 Vali Acc: 0.534 Test Loss: 1.897 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0606069564819336
Epoch: 8, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.612 Vali Acc: 0.496 Test Loss: 1.612 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0827789306640625
Epoch: 9, Steps: 8 | Train Loss: 0.008 Vali Loss: 2.073 Vali Acc: 0.534 Test Loss: 2.073 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.0068011283874512
Epoch: 10, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.559 Vali Acc: 0.542 Test Loss: 1.559 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.0267999172210693
Epoch: 11, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.800 Vali Acc: 0.489 Test Loss: 1.800 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.9543557167053223
Epoch: 12, Steps: 8 | Train Loss: 0.004 Vali Loss: 2.026 Vali Acc: 0.511 Test Loss: 2.026 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.0546362400054932
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.805 Vali Acc: 0.504 Test Loss: 1.805 Test Acc: 0.504
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.9846277236938477
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.938 Vali Acc: 0.489 Test Loss: 1.938 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.0439836978912354
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.027 Vali Acc: 0.511 Test Loss: 2.027 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.0460748672485352
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.078 Vali Acc: 0.519 Test Loss: 2.078 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps900_str225_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 34965509
model size : 148.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps900_str450_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.3041563034057617
Epoch: 1, Steps: 8 | Train Loss: 1.549 Vali Loss: 1.692 Vali Acc: 0.420 Test Loss: 1.692 Test Acc: 0.420
Validation loss decreased (inf --> -0.419830).  Saving model ...
Epoch: 2 cost time: 0.8304872512817383
Epoch: 2, Steps: 8 | Train Loss: 1.435 Vali Loss: 1.506 Vali Acc: 0.427 Test Loss: 1.506 Test Acc: 0.427
Validation loss decreased (-0.419830 --> -0.427466).  Saving model ...
Epoch: 3 cost time: 0.7229177951812744
Epoch: 3, Steps: 8 | Train Loss: 1.115 Vali Loss: 1.499 Vali Acc: 0.458 Test Loss: 1.499 Test Acc: 0.458
Validation loss decreased (-0.427466 --> -0.458000).  Saving model ...
Epoch: 4 cost time: 0.8330676555633545
Epoch: 4, Steps: 8 | Train Loss: 0.841 Vali Loss: 1.352 Vali Acc: 0.527 Test Loss: 1.352 Test Acc: 0.527
Validation loss decreased (-0.458000 --> -0.526704).  Saving model ...
Epoch: 5 cost time: 0.8498010635375977
Epoch: 5, Steps: 8 | Train Loss: 0.517 Vali Loss: 1.341 Vali Acc: 0.534 Test Loss: 1.341 Test Acc: 0.534
Validation loss decreased (-0.526704 --> -0.534338).  Saving model ...
Epoch: 6 cost time: 1.0851705074310303
Epoch: 6, Steps: 8 | Train Loss: 0.246 Vali Loss: 1.283 Vali Acc: 0.542 Test Loss: 1.283 Test Acc: 0.542
Validation loss decreased (-0.534338 --> -0.541972).  Saving model ...
Epoch: 7 cost time: 0.9097344875335693
Epoch: 7, Steps: 8 | Train Loss: 0.077 Vali Loss: 1.428 Vali Acc: 0.527 Test Loss: 1.428 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8638103008270264
Epoch: 8, Steps: 8 | Train Loss: 0.031 Vali Loss: 1.497 Vali Acc: 0.519 Test Loss: 1.497 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.147092342376709
Epoch: 9, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.698 Vali Acc: 0.534 Test Loss: 1.698 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.8461282253265381
Epoch: 10, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.637 Vali Acc: 0.534 Test Loss: 1.637 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.8301360607147217
Epoch: 11, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.569 Vali Acc: 0.573 Test Loss: 1.569 Test Acc: 0.573
Validation loss decreased (-0.541972 --> -0.572503).  Saving model ...
Epoch: 12 cost time: 1.0896947383880615
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.605 Vali Acc: 0.542 Test Loss: 1.605 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8539438247680664
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.673 Vali Acc: 0.550 Test Loss: 1.673 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.8172621726989746
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.705 Vali Acc: 0.542 Test Loss: 1.705 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.890836238861084
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.716 Vali Acc: 0.550 Test Loss: 1.716 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.0595011711120605
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.708 Vali Acc: 0.534 Test Loss: 1.708 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.9135849475860596
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.696 Vali Acc: 0.542 Test Loss: 1.696 Test Acc: 0.542
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.9567937850952148
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.689 Vali Acc: 0.542 Test Loss: 1.689 Test Acc: 0.542
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.9350581169128418
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.681 Vali Acc: 0.550 Test Loss: 1.681 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.19850492477417
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.690 Vali Acc: 0.542 Test Loss: 1.690 Test Acc: 0.542
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.8721227645874023
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.704 Vali Acc: 0.542 Test Loss: 1.704 Test Acc: 0.542
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps900_str450_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5725190839694656
model parameter : 34761221
model size : 147.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps900_str900_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.278394937515259
Epoch: 1, Steps: 8 | Train Loss: 1.567 Vali Loss: 1.551 Vali Acc: 0.420 Test Loss: 1.551 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 0.8713278770446777
Epoch: 2, Steps: 8 | Train Loss: 1.384 Vali Loss: 1.571 Vali Acc: 0.420 Test Loss: 1.571 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7829031944274902
Epoch: 3, Steps: 8 | Train Loss: 1.161 Vali Loss: 1.537 Vali Acc: 0.458 Test Loss: 1.537 Test Acc: 0.458
Validation loss decreased (-0.419832 --> -0.458000).  Saving model ...
Epoch: 4 cost time: 0.8743553161621094
Epoch: 4, Steps: 8 | Train Loss: 0.862 Vali Loss: 1.475 Vali Acc: 0.496 Test Loss: 1.475 Test Acc: 0.496
Validation loss decreased (-0.458000 --> -0.496168).  Saving model ...
Epoch: 5 cost time: 0.8789410591125488
Epoch: 5, Steps: 8 | Train Loss: 0.634 Vali Loss: 1.446 Vali Acc: 0.534 Test Loss: 1.446 Test Acc: 0.534
Validation loss decreased (-0.496168 --> -0.534337).  Saving model ...
Epoch: 6 cost time: 0.9159331321716309
Epoch: 6, Steps: 8 | Train Loss: 0.351 Vali Loss: 1.410 Vali Acc: 0.473 Test Loss: 1.410 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9193568229675293
Epoch: 7, Steps: 8 | Train Loss: 0.156 Vali Loss: 1.401 Vali Acc: 0.504 Test Loss: 1.401 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9056510925292969
Epoch: 8, Steps: 8 | Train Loss: 0.045 Vali Loss: 1.501 Vali Acc: 0.534 Test Loss: 1.501 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.8939731121063232
Epoch: 9, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.555 Vali Acc: 0.504 Test Loss: 1.555 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.8828954696655273
Epoch: 10, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.613 Vali Acc: 0.481 Test Loss: 1.613 Test Acc: 0.481
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.8845944404602051
Epoch: 11, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.662 Vali Acc: 0.511 Test Loss: 1.662 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.8470287322998047
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.674 Vali Acc: 0.511 Test Loss: 1.674 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.9189755916595459
Epoch: 13, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.681 Vali Acc: 0.511 Test Loss: 1.681 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.8281452655792236
Epoch: 14, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.696 Vali Acc: 0.511 Test Loss: 1.696 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.203096866607666
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.716 Vali Acc: 0.511 Test Loss: 1.716 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps900_str900_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 34659077
model size : 146.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps947_str237_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.1837055683135986
Epoch: 1, Steps: 8 | Train Loss: 1.591 Vali Loss: 1.729 Vali Acc: 0.420 Test Loss: 1.729 Test Acc: 0.420
Validation loss decreased (inf --> -0.419830).  Saving model ...
Epoch: 2 cost time: 1.242563247680664
Epoch: 2, Steps: 8 | Train Loss: 1.471 Vali Loss: 1.501 Vali Acc: 0.489 Test Loss: 1.501 Test Acc: 0.489
Validation loss decreased (-0.419830 --> -0.488535).  Saving model ...
Epoch: 3 cost time: 1.0767982006072998
Epoch: 3, Steps: 8 | Train Loss: 1.222 Vali Loss: 1.545 Vali Acc: 0.427 Test Loss: 1.545 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9622528553009033
Epoch: 4, Steps: 8 | Train Loss: 0.955 Vali Loss: 1.311 Vali Acc: 0.481 Test Loss: 1.311 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.318690299987793
Epoch: 5, Steps: 8 | Train Loss: 0.665 Vali Loss: 1.202 Vali Acc: 0.489 Test Loss: 1.202 Test Acc: 0.489
Validation loss decreased (-0.488535 --> -0.488538).  Saving model ...
Epoch: 6 cost time: 1.0897679328918457
Epoch: 6, Steps: 8 | Train Loss: 0.291 Vali Loss: 1.472 Vali Acc: 0.557 Test Loss: 1.472 Test Acc: 0.557
Validation loss decreased (-0.488538 --> -0.557237).  Saving model ...
Epoch: 7 cost time: 1.1942481994628906
Epoch: 7, Steps: 8 | Train Loss: 0.100 Vali Loss: 1.317 Vali Acc: 0.550 Test Loss: 1.317 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0523886680603027
Epoch: 8, Steps: 8 | Train Loss: 0.023 Vali Loss: 1.458 Vali Acc: 0.595 Test Loss: 1.458 Test Acc: 0.595
Validation loss decreased (-0.557237 --> -0.595405).  Saving model ...
Epoch: 9 cost time: 1.4517600536346436
Epoch: 9, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.710 Vali Acc: 0.519 Test Loss: 1.710 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.312673807144165
Epoch: 10, Steps: 8 | Train Loss: 0.003 Vali Loss: 2.114 Vali Acc: 0.573 Test Loss: 2.114 Test Acc: 0.573
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.39237642288208
Epoch: 11, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.847 Vali Acc: 0.557 Test Loss: 1.847 Test Acc: 0.557
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.366760492324829
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.929 Vali Acc: 0.557 Test Loss: 1.929 Test Acc: 0.557
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.3268895149230957
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.064 Vali Acc: 0.618 Test Loss: 2.064 Test Acc: 0.618
Validation loss decreased (-0.595405 --> -0.618300).  Saving model ...
Epoch: 14 cost time: 1.1626636981964111
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.089 Vali Acc: 0.588 Test Loss: 2.089 Test Acc: 0.588
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8494293689727783
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.115 Vali Acc: 0.580 Test Loss: 2.115 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.0125846862792969
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.129 Vali Acc: 0.580 Test Loss: 2.129 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.9350306987762451
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.131 Vali Acc: 0.580 Test Loss: 2.131 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.0103394985198975
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.124 Vali Acc: 0.580 Test Loss: 2.124 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.058046579360962
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.120 Vali Acc: 0.580 Test Loss: 2.120 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.84670090675354
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.123 Vali Acc: 0.595 Test Loss: 2.123 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.955446720123291
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.128 Vali Acc: 0.603 Test Loss: 2.128 Test Acc: 0.603
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.0171229839324951
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.138 Vali Acc: 0.595 Test Loss: 2.138 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.371870517730713
Epoch: 23, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.149 Vali Acc: 0.588 Test Loss: 2.149 Test Acc: 0.588
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps947_str237_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6183206106870229
model parameter : 35593733
model size : 150.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps947_str474_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.184126377105713
Epoch: 1, Steps: 8 | Train Loss: 1.605 Vali Loss: 1.571 Vali Acc: 0.420 Test Loss: 1.571 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 0.9860336780548096
Epoch: 2, Steps: 8 | Train Loss: 1.410 Vali Loss: 1.451 Vali Acc: 0.427 Test Loss: 1.451 Test Acc: 0.427
Validation loss decreased (-0.419832 --> -0.427466).  Saving model ...
Epoch: 3 cost time: 0.9686336517333984
Epoch: 3, Steps: 8 | Train Loss: 1.134 Vali Loss: 1.393 Vali Acc: 0.519 Test Loss: 1.393 Test Acc: 0.519
Validation loss decreased (-0.427466 --> -0.519070).  Saving model ...
Epoch: 4 cost time: 1.1131958961486816
Epoch: 4, Steps: 8 | Train Loss: 0.847 Vali Loss: 1.343 Vali Acc: 0.481 Test Loss: 1.343 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9826035499572754
Epoch: 5, Steps: 8 | Train Loss: 0.560 Vali Loss: 1.273 Vali Acc: 0.511 Test Loss: 1.273 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1528677940368652
Epoch: 6, Steps: 8 | Train Loss: 0.283 Vali Loss: 1.242 Vali Acc: 0.557 Test Loss: 1.242 Test Acc: 0.557
Validation loss decreased (-0.519070 --> -0.557239).  Saving model ...
Epoch: 7 cost time: 1.0958712100982666
Epoch: 7, Steps: 8 | Train Loss: 0.116 Vali Loss: 1.279 Vali Acc: 0.519 Test Loss: 1.279 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9136731624603271
Epoch: 8, Steps: 8 | Train Loss: 0.042 Vali Loss: 1.278 Vali Acc: 0.504 Test Loss: 1.278 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9979732036590576
Epoch: 9, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.457 Vali Acc: 0.580 Test Loss: 1.457 Test Acc: 0.580
Validation loss decreased (-0.557239 --> -0.580138).  Saving model ...
Epoch: 10 cost time: 0.9395904541015625
Epoch: 10, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.407 Vali Acc: 0.573 Test Loss: 1.407 Test Acc: 0.573
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0093722343444824
Epoch: 11, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.405 Vali Acc: 0.557 Test Loss: 1.405 Test Acc: 0.557
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9904425144195557
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.413 Vali Acc: 0.565 Test Loss: 1.413 Test Acc: 0.565
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.0957269668579102
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.450 Vali Acc: 0.595 Test Loss: 1.450 Test Acc: 0.595
Validation loss decreased (-0.580138 --> -0.595405).  Saving model ...
Epoch: 14 cost time: 0.8750441074371338
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.470 Vali Acc: 0.580 Test Loss: 1.470 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9570984840393066
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.491 Vali Acc: 0.565 Test Loss: 1.491 Test Acc: 0.565
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9414412975311279
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.506 Vali Acc: 0.557 Test Loss: 1.506 Test Acc: 0.557
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.0004584789276123
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.523 Vali Acc: 0.557 Test Loss: 1.523 Test Acc: 0.557
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.1175026893615723
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.526 Vali Acc: 0.557 Test Loss: 1.526 Test Acc: 0.557
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.9765210151672363
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.527 Vali Acc: 0.557 Test Loss: 1.527 Test Acc: 0.557
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.0877761840820312
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.535 Vali Acc: 0.550 Test Loss: 1.535 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.9972805976867676
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.538 Vali Acc: 0.557 Test Loss: 1.538 Test Acc: 0.557
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.0108497142791748
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.542 Vali Acc: 0.557 Test Loss: 1.542 Test Acc: 0.557
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.0300261974334717
Epoch: 23, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.549 Vali Acc: 0.557 Test Loss: 1.549 Test Acc: 0.557
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps947_str474_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5954198473282443
model parameter : 35400197
model size : 149.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps947_str947_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.078265428543091
Epoch: 1, Steps: 8 | Train Loss: 1.650 Vali Loss: 1.554 Vali Acc: 0.420 Test Loss: 1.554 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 0.8933684825897217
Epoch: 2, Steps: 8 | Train Loss: 1.429 Vali Loss: 1.623 Vali Acc: 0.420 Test Loss: 1.623 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8657305240631104
Epoch: 3, Steps: 8 | Train Loss: 1.189 Vali Loss: 1.542 Vali Acc: 0.458 Test Loss: 1.542 Test Acc: 0.458
Validation loss decreased (-0.419832 --> -0.458000).  Saving model ...
Epoch: 4 cost time: 1.250349998474121
Epoch: 4, Steps: 8 | Train Loss: 0.942 Vali Loss: 1.479 Vali Acc: 0.557 Test Loss: 1.479 Test Acc: 0.557
Validation loss decreased (-0.458000 --> -0.557237).  Saving model ...
Epoch: 5 cost time: 1.003084659576416
Epoch: 5, Steps: 8 | Train Loss: 0.628 Vali Loss: 1.473 Vali Acc: 0.504 Test Loss: 1.473 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7066352367401123
Epoch: 6, Steps: 8 | Train Loss: 0.339 Vali Loss: 1.524 Vali Acc: 0.496 Test Loss: 1.524 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.2617440223693848
Epoch: 7, Steps: 8 | Train Loss: 0.137 Vali Loss: 1.674 Vali Acc: 0.527 Test Loss: 1.674 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.0281767845153809
Epoch: 8, Steps: 8 | Train Loss: 0.041 Vali Loss: 1.756 Vali Acc: 0.511 Test Loss: 1.756 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.011462688446045
Epoch: 9, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.861 Vali Acc: 0.489 Test Loss: 1.861 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.1157300472259521
Epoch: 10, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.880 Vali Acc: 0.473 Test Loss: 1.880 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.2007484436035156
Epoch: 11, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.881 Vali Acc: 0.496 Test Loss: 1.881 Test Acc: 0.496
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.9587507247924805
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.911 Vali Acc: 0.496 Test Loss: 1.911 Test Acc: 0.496
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.9587764739990234
Epoch: 13, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.953 Vali Acc: 0.496 Test Loss: 1.953 Test Acc: 0.496
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.8817737102508545
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.000 Vali Acc: 0.504 Test Loss: 2.000 Test Acc: 0.504
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps947_str947_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 35303429
model size : 149.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps1000_str250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.609351396560669
Epoch: 1, Steps: 8 | Train Loss: 1.686 Vali Loss: 1.637 Vali Acc: 0.420 Test Loss: 1.637 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 1.0987050533294678
Epoch: 2, Steps: 8 | Train Loss: 1.404 Vali Loss: 1.587 Vali Acc: 0.435 Test Loss: 1.587 Test Acc: 0.435
Validation loss decreased (-0.419831 --> -0.435099).  Saving model ...
Epoch: 3 cost time: 1.0665366649627686
Epoch: 3, Steps: 8 | Train Loss: 1.253 Vali Loss: 1.492 Vali Acc: 0.496 Test Loss: 1.492 Test Acc: 0.496
Validation loss decreased (-0.435099 --> -0.496168).  Saving model ...
Epoch: 4 cost time: 1.0806341171264648
Epoch: 4, Steps: 8 | Train Loss: 0.938 Vali Loss: 1.382 Vali Acc: 0.496 Test Loss: 1.382 Test Acc: 0.496
Validation loss decreased (-0.496168 --> -0.496169).  Saving model ...
Epoch: 5 cost time: 0.9995179176330566
Epoch: 5, Steps: 8 | Train Loss: 0.440 Vali Loss: 1.338 Vali Acc: 0.519 Test Loss: 1.338 Test Acc: 0.519
Validation loss decreased (-0.496169 --> -0.519071).  Saving model ...
Epoch: 6 cost time: 1.1044342517852783
Epoch: 6, Steps: 8 | Train Loss: 0.184 Vali Loss: 1.416 Vali Acc: 0.565 Test Loss: 1.416 Test Acc: 0.565
Validation loss decreased (-0.519071 --> -0.564871).  Saving model ...
Epoch: 7 cost time: 0.8536944389343262
Epoch: 7, Steps: 8 | Train Loss: 0.075 Vali Loss: 1.564 Vali Acc: 0.550 Test Loss: 1.564 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4212682247161865
Epoch: 8, Steps: 8 | Train Loss: 0.031 Vali Loss: 1.701 Vali Acc: 0.504 Test Loss: 1.701 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.92500901222229
Epoch: 9, Steps: 8 | Train Loss: 0.016 Vali Loss: 2.028 Vali Acc: 0.481 Test Loss: 2.028 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.0159716606140137
Epoch: 10, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.919 Vali Acc: 0.527 Test Loss: 1.919 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.3606560230255127
Epoch: 11, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.965 Vali Acc: 0.550 Test Loss: 1.965 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.8318808078765869
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.240 Vali Acc: 0.443 Test Loss: 2.240 Test Acc: 0.443
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.0348336696624756
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.239 Vali Acc: 0.466 Test Loss: 2.239 Test Acc: 0.466
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.4335410594940186
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.183 Vali Acc: 0.473 Test Loss: 2.183 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.0636916160583496
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.130 Vali Acc: 0.496 Test Loss: 2.130 Test Acc: 0.496
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.1285383701324463
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.064 Vali Acc: 0.519 Test Loss: 2.064 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps1000_str250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5648854961832062
model parameter : 36304901
model size : 153.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps1000_str500_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.3649702072143555
Epoch: 1, Steps: 8 | Train Loss: 1.553 Vali Loss: 1.656 Vali Acc: 0.420 Test Loss: 1.656 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 0.9107789993286133
Epoch: 2, Steps: 8 | Train Loss: 1.356 Vali Loss: 1.501 Vali Acc: 0.427 Test Loss: 1.501 Test Acc: 0.427
Validation loss decreased (-0.419831 --> -0.427466).  Saving model ...
Epoch: 3 cost time: 1.00905442237854
Epoch: 3, Steps: 8 | Train Loss: 1.101 Vali Loss: 1.469 Vali Acc: 0.435 Test Loss: 1.469 Test Acc: 0.435
Validation loss decreased (-0.427466 --> -0.435100).  Saving model ...
Epoch: 4 cost time: 1.0120995044708252
Epoch: 4, Steps: 8 | Train Loss: 0.826 Vali Loss: 1.303 Vali Acc: 0.550 Test Loss: 1.303 Test Acc: 0.550
Validation loss decreased (-0.435100 --> -0.549605).  Saving model ...
Epoch: 5 cost time: 0.9893167018890381
Epoch: 5, Steps: 8 | Train Loss: 0.553 Vali Loss: 1.341 Vali Acc: 0.496 Test Loss: 1.341 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8052864074707031
Epoch: 6, Steps: 8 | Train Loss: 0.262 Vali Loss: 1.351 Vali Acc: 0.443 Test Loss: 1.351 Test Acc: 0.443
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9121780395507812
Epoch: 7, Steps: 8 | Train Loss: 0.102 Vali Loss: 1.545 Vali Acc: 0.527 Test Loss: 1.545 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.9933333396911621
Epoch: 8, Steps: 8 | Train Loss: 0.033 Vali Loss: 1.399 Vali Acc: 0.489 Test Loss: 1.399 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.2442326545715332
Epoch: 9, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.558 Vali Acc: 0.504 Test Loss: 1.558 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.223700761795044
Epoch: 10, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.597 Vali Acc: 0.550 Test Loss: 1.597 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.8882277011871338
Epoch: 11, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.529 Vali Acc: 0.473 Test Loss: 1.529 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.7180664539337158
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.562 Vali Acc: 0.504 Test Loss: 1.562 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.0112113952636719
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.608 Vali Acc: 0.527 Test Loss: 1.608 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.2006731033325195
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.632 Vali Acc: 0.519 Test Loss: 1.632 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps1000_str500_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 36122117
model size : 152.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps1000_str1000_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.2033028602600098
Epoch: 1, Steps: 8 | Train Loss: 1.522 Vali Loss: 1.566 Vali Acc: 0.420 Test Loss: 1.566 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 0.8709621429443359
Epoch: 2, Steps: 8 | Train Loss: 1.353 Vali Loss: 1.525 Vali Acc: 0.420 Test Loss: 1.525 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 0.8483190536499023
Epoch: 3, Steps: 8 | Train Loss: 1.073 Vali Loss: 1.492 Vali Acc: 0.481 Test Loss: 1.492 Test Acc: 0.481
Validation loss decreased (-0.419832 --> -0.480901).  Saving model ...
Epoch: 4 cost time: 0.7448582649230957
Epoch: 4, Steps: 8 | Train Loss: 0.819 Vali Loss: 1.466 Vali Acc: 0.473 Test Loss: 1.466 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9476499557495117
Epoch: 5, Steps: 8 | Train Loss: 0.518 Vali Loss: 1.355 Vali Acc: 0.481 Test Loss: 1.355 Test Acc: 0.481
Validation loss decreased (-0.480901 --> -0.480902).  Saving model ...
Epoch: 6 cost time: 0.8862135410308838
Epoch: 6, Steps: 8 | Train Loss: 0.272 Vali Loss: 1.430 Vali Acc: 0.504 Test Loss: 1.430 Test Acc: 0.504
Validation loss decreased (-0.480902 --> -0.503802).  Saving model ...
Epoch: 7 cost time: 0.8517746925354004
Epoch: 7, Steps: 8 | Train Loss: 0.110 Vali Loss: 1.489 Vali Acc: 0.496 Test Loss: 1.489 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8520727157592773
Epoch: 8, Steps: 8 | Train Loss: 0.057 Vali Loss: 1.490 Vali Acc: 0.519 Test Loss: 1.490 Test Acc: 0.519
Validation loss decreased (-0.503802 --> -0.519069).  Saving model ...
Epoch: 9 cost time: 1.2281994819641113
Epoch: 9, Steps: 8 | Train Loss: 0.023 Vali Loss: 1.763 Vali Acc: 0.527 Test Loss: 1.763 Test Acc: 0.527
Validation loss decreased (-0.519069 --> -0.526700).  Saving model ...
Epoch: 10 cost time: 0.9480929374694824
Epoch: 10, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.632 Vali Acc: 0.565 Test Loss: 1.632 Test Acc: 0.565
Validation loss decreased (-0.526700 --> -0.564869).  Saving model ...
Epoch: 11 cost time: 0.8785834312438965
Epoch: 11, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.554 Vali Acc: 0.565 Test Loss: 1.554 Test Acc: 0.565
Validation loss decreased (-0.564869 --> -0.564870).  Saving model ...
Epoch: 12 cost time: 0.9250626564025879
Epoch: 12, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.576 Vali Acc: 0.573 Test Loss: 1.576 Test Acc: 0.573
Validation loss decreased (-0.564870 --> -0.572503).  Saving model ...
Epoch: 13 cost time: 0.9039278030395508
Epoch: 13, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.630 Vali Acc: 0.550 Test Loss: 1.630 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8122141361236572
Epoch: 14, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.651 Vali Acc: 0.550 Test Loss: 1.651 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8319504261016846
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.655 Vali Acc: 0.557 Test Loss: 1.655 Test Acc: 0.557
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.7772500514984131
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.656 Vali Acc: 0.557 Test Loss: 1.656 Test Acc: 0.557
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.8400228023529053
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.658 Vali Acc: 0.565 Test Loss: 1.658 Test Acc: 0.565
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.8464138507843018
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.655 Vali Acc: 0.557 Test Loss: 1.655 Test Acc: 0.557
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.8936977386474609
Epoch: 19, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.665 Vali Acc: 0.557 Test Loss: 1.665 Test Acc: 0.557
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.9012191295623779
Epoch: 20, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.672 Vali Acc: 0.557 Test Loss: 1.672 Test Acc: 0.557
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.8739922046661377
Epoch: 21, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.672 Vali Acc: 0.557 Test Loss: 1.672 Test Acc: 0.557
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.8877825736999512
Epoch: 22, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.673 Vali Acc: 0.557 Test Loss: 1.673 Test Acc: 0.557
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps1000_str1000_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5725190839694656
model parameter : 36030725
model size : 152.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps1058_str265_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.275301694869995
Epoch: 1, Steps: 8 | Train Loss: 1.694 Vali Loss: 1.598 Vali Acc: 0.420 Test Loss: 1.598 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 1.5311884880065918
Epoch: 2, Steps: 8 | Train Loss: 1.467 Vali Loss: 1.493 Vali Acc: 0.473 Test Loss: 1.493 Test Acc: 0.473
Validation loss decreased (-0.419831 --> -0.473268).  Saving model ...
Epoch: 3 cost time: 1.135413408279419
Epoch: 3, Steps: 8 | Train Loss: 1.183 Vali Loss: 1.506 Vali Acc: 0.473 Test Loss: 1.506 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0568997859954834
Epoch: 4, Steps: 8 | Train Loss: 0.828 Vali Loss: 1.351 Vali Acc: 0.511 Test Loss: 1.351 Test Acc: 0.511
Validation loss decreased (-0.473268 --> -0.511437).  Saving model ...
Epoch: 5 cost time: 1.609555959701538
Epoch: 5, Steps: 8 | Train Loss: 0.489 Vali Loss: 1.307 Vali Acc: 0.573 Test Loss: 1.307 Test Acc: 0.573
Validation loss decreased (-0.511437 --> -0.572506).  Saving model ...
Epoch: 6 cost time: 1.1628425121307373
Epoch: 6, Steps: 8 | Train Loss: 0.173 Vali Loss: 1.403 Vali Acc: 0.542 Test Loss: 1.403 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1605281829833984
Epoch: 7, Steps: 8 | Train Loss: 0.062 Vali Loss: 1.692 Vali Acc: 0.550 Test Loss: 1.692 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.0667331218719482
Epoch: 8, Steps: 8 | Train Loss: 0.021 Vali Loss: 1.382 Vali Acc: 0.534 Test Loss: 1.382 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.1268434524536133
Epoch: 9, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.605 Vali Acc: 0.603 Test Loss: 1.605 Test Acc: 0.603
Validation loss decreased (-0.572506 --> -0.603037).  Saving model ...
Epoch: 10 cost time: 1.0399415493011475
Epoch: 10, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.879 Vali Acc: 0.519 Test Loss: 1.879 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8804502487182617
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.787 Vali Acc: 0.550 Test Loss: 1.787 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.0754685401916504
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.716 Vali Acc: 0.565 Test Loss: 1.716 Test Acc: 0.565
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.0871758460998535
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.716 Vali Acc: 0.573 Test Loss: 1.716 Test Acc: 0.573
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.0843849182128906
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.726 Vali Acc: 0.573 Test Loss: 1.726 Test Acc: 0.573
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.0299062728881836
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.741 Vali Acc: 0.573 Test Loss: 1.741 Test Acc: 0.573
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.0455009937286377
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.760 Vali Acc: 0.573 Test Loss: 1.760 Test Acc: 0.573
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.0955748558044434
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.772 Vali Acc: 0.573 Test Loss: 1.772 Test Acc: 0.573
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.038853645324707
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.774 Vali Acc: 0.565 Test Loss: 1.774 Test Acc: 0.565
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.0797739028930664
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.791 Vali Acc: 0.565 Test Loss: 1.791 Test Acc: 0.565
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps1058_str265_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6030534351145038
model parameter : 37085189
model size : 156.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps1058_str529_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.5315937995910645
Epoch: 1, Steps: 8 | Train Loss: 1.612 Vali Loss: 1.680 Vali Acc: 0.420 Test Loss: 1.680 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 0.9779083728790283
Epoch: 2, Steps: 8 | Train Loss: 1.361 Vali Loss: 1.481 Vali Acc: 0.450 Test Loss: 1.481 Test Acc: 0.450
Validation loss decreased (-0.419831 --> -0.450367).  Saving model ...
Epoch: 3 cost time: 1.0683398246765137
Epoch: 3, Steps: 8 | Train Loss: 1.078 Vali Loss: 1.460 Vali Acc: 0.473 Test Loss: 1.460 Test Acc: 0.473
Validation loss decreased (-0.450367 --> -0.473268).  Saving model ...
Epoch: 4 cost time: 1.058959722518921
Epoch: 4, Steps: 8 | Train Loss: 0.793 Vali Loss: 1.333 Vali Acc: 0.519 Test Loss: 1.333 Test Acc: 0.519
Validation loss decreased (-0.473268 --> -0.519071).  Saving model ...
Epoch: 5 cost time: 1.1729035377502441
Epoch: 5, Steps: 8 | Train Loss: 0.478 Vali Loss: 1.378 Vali Acc: 0.504 Test Loss: 1.378 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.038475751876831
Epoch: 6, Steps: 8 | Train Loss: 0.233 Vali Loss: 1.366 Vali Acc: 0.527 Test Loss: 1.366 Test Acc: 0.527
Validation loss decreased (-0.519071 --> -0.526704).  Saving model ...
Epoch: 7 cost time: 1.037886619567871
Epoch: 7, Steps: 8 | Train Loss: 0.114 Vali Loss: 1.359 Vali Acc: 0.550 Test Loss: 1.359 Test Acc: 0.550
Validation loss decreased (-0.526704 --> -0.549605).  Saving model ...
Epoch: 8 cost time: 1.4275436401367188
Epoch: 8, Steps: 8 | Train Loss: 0.037 Vali Loss: 1.505 Vali Acc: 0.557 Test Loss: 1.505 Test Acc: 0.557
Validation loss decreased (-0.549605 --> -0.557237).  Saving model ...
Epoch: 9 cost time: 1.0692365169525146
Epoch: 9, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.658 Vali Acc: 0.504 Test Loss: 1.658 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0988333225250244
Epoch: 10, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.433 Vali Acc: 0.534 Test Loss: 1.433 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.362177848815918
Epoch: 11, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.436 Vali Acc: 0.550 Test Loss: 1.436 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.3334743976593018
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.532 Vali Acc: 0.573 Test Loss: 1.532 Test Acc: 0.573
Validation loss decreased (-0.557237 --> -0.572504).  Saving model ...
Epoch: 13 cost time: 1.029872179031372
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.532 Vali Acc: 0.573 Test Loss: 1.532 Test Acc: 0.573
Validation loss decreased (-0.572504 --> -0.572504).  Saving model ...
Epoch: 14 cost time: 1.0021154880523682
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.515 Vali Acc: 0.557 Test Loss: 1.515 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.054250955581665
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.508 Vali Acc: 0.550 Test Loss: 1.508 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9984824657440186
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.492 Vali Acc: 0.565 Test Loss: 1.492 Test Acc: 0.565
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.3717801570892334
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.485 Vali Acc: 0.565 Test Loss: 1.485 Test Acc: 0.565
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.02034330368042
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.486 Vali Acc: 0.565 Test Loss: 1.486 Test Acc: 0.565
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.8533344268798828
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.490 Vali Acc: 0.557 Test Loss: 1.490 Test Acc: 0.557
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.8734128475189209
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.501 Vali Acc: 0.557 Test Loss: 1.501 Test Acc: 0.557
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.7538015842437744
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.510 Vali Acc: 0.565 Test Loss: 1.510 Test Acc: 0.565
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.7809226512908936
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.513 Vali Acc: 0.565 Test Loss: 1.513 Test Acc: 0.565
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.7780323028564453
Epoch: 23, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.514 Vali Acc: 0.565 Test Loss: 1.514 Test Acc: 0.565
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps1058_str529_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5725190839694656
model parameter : 36913157
model size : 155.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps1058_str1058_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.5884249210357666
Epoch: 1, Steps: 8 | Train Loss: 1.619 Vali Loss: 1.557 Vali Acc: 0.420 Test Loss: 1.557 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 0.9713230133056641
Epoch: 2, Steps: 8 | Train Loss: 1.397 Vali Loss: 1.535 Vali Acc: 0.420 Test Loss: 1.535 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 0.8930399417877197
Epoch: 3, Steps: 8 | Train Loss: 1.092 Vali Loss: 1.508 Vali Acc: 0.450 Test Loss: 1.508 Test Acc: 0.450
Validation loss decreased (-0.419832 --> -0.450367).  Saving model ...
Epoch: 4 cost time: 1.0699050426483154
Epoch: 4, Steps: 8 | Train Loss: 0.867 Vali Loss: 1.522 Vali Acc: 0.489 Test Loss: 1.522 Test Acc: 0.489
Validation loss decreased (-0.450367 --> -0.488534).  Saving model ...
Epoch: 5 cost time: 0.8460721969604492
Epoch: 5, Steps: 8 | Train Loss: 0.595 Vali Loss: 1.514 Vali Acc: 0.489 Test Loss: 1.514 Test Acc: 0.489
Validation loss decreased (-0.488534 --> -0.488534).  Saving model ...
Epoch: 6 cost time: 0.9988768100738525
Epoch: 6, Steps: 8 | Train Loss: 0.323 Vali Loss: 1.529 Vali Acc: 0.511 Test Loss: 1.529 Test Acc: 0.511
Validation loss decreased (-0.488534 --> -0.511435).  Saving model ...
Epoch: 7 cost time: 1.013085126876831
Epoch: 7, Steps: 8 | Train Loss: 0.142 Vali Loss: 1.665 Vali Acc: 0.519 Test Loss: 1.665 Test Acc: 0.519
Validation loss decreased (-0.511435 --> -0.519067).  Saving model ...
Epoch: 8 cost time: 0.8178560733795166
Epoch: 8, Steps: 8 | Train Loss: 0.050 Vali Loss: 1.580 Vali Acc: 0.489 Test Loss: 1.580 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.800285816192627
Epoch: 9, Steps: 8 | Train Loss: 0.019 Vali Loss: 1.626 Vali Acc: 0.527 Test Loss: 1.626 Test Acc: 0.527
Validation loss decreased (-0.519067 --> -0.526701).  Saving model ...
Epoch: 10 cost time: 0.7746603488922119
Epoch: 10, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.653 Vali Acc: 0.542 Test Loss: 1.653 Test Acc: 0.542
Validation loss decreased (-0.526701 --> -0.541968).  Saving model ...
Epoch: 11 cost time: 1.0403611660003662
Epoch: 11, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.659 Vali Acc: 0.519 Test Loss: 1.659 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9449834823608398
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.672 Vali Acc: 0.534 Test Loss: 1.672 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9668161869049072
Epoch: 13, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.699 Vali Acc: 0.534 Test Loss: 1.699 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.0294826030731201
Epoch: 14, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.718 Vali Acc: 0.534 Test Loss: 1.718 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.9949076175689697
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.733 Vali Acc: 0.534 Test Loss: 1.733 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.9621188640594482
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.745 Vali Acc: 0.534 Test Loss: 1.745 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.3835220336914062
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.752 Vali Acc: 0.534 Test Loss: 1.752 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.9813802242279053
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.762 Vali Acc: 0.550 Test Loss: 1.762 Test Acc: 0.550
Validation loss decreased (-0.541968 --> -0.549601).  Saving model ...
Epoch: 19 cost time: 0.9966928958892822
Epoch: 19, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.773 Vali Acc: 0.550 Test Loss: 1.773 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.381662130355835
Epoch: 20, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.790 Vali Acc: 0.550 Test Loss: 1.790 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.9567379951477051
Epoch: 21, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.798 Vali Acc: 0.550 Test Loss: 1.798 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.9719574451446533
Epoch: 22, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.799 Vali Acc: 0.550 Test Loss: 1.799 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.8161675930023193
Epoch: 23, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.795 Vali Acc: 0.550 Test Loss: 1.795 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.0701160430908203
Epoch: 24, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.795 Vali Acc: 0.550 Test Loss: 1.795 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.9338984489440918
Epoch: 25, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.803 Vali Acc: 0.550 Test Loss: 1.803 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.9864375591278076
Epoch: 26, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.814 Vali Acc: 0.550 Test Loss: 1.814 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.817845344543457
Epoch: 27, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.823 Vali Acc: 0.542 Test Loss: 1.823 Test Acc: 0.542
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.9355452060699463
Epoch: 28, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.835 Vali Acc: 0.542 Test Loss: 1.835 Test Acc: 0.542
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps1058_str1058_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 36827141
model size : 155.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps1124_str281_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.417489528656006
Epoch: 1, Steps: 8 | Train Loss: 1.670 Vali Loss: 1.609 Vali Acc: 0.420 Test Loss: 1.609 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 0.8533527851104736
Epoch: 2, Steps: 8 | Train Loss: 1.403 Vali Loss: 1.545 Vali Acc: 0.427 Test Loss: 1.545 Test Acc: 0.427
Validation loss decreased (-0.419831 --> -0.427465).  Saving model ...
Epoch: 3 cost time: 1.0953245162963867
Epoch: 3, Steps: 8 | Train Loss: 1.137 Vali Loss: 1.476 Vali Acc: 0.450 Test Loss: 1.476 Test Acc: 0.450
Validation loss decreased (-0.427465 --> -0.450367).  Saving model ...
Epoch: 4 cost time: 1.2253832817077637
Epoch: 4, Steps: 8 | Train Loss: 0.850 Vali Loss: 1.336 Vali Acc: 0.542 Test Loss: 1.336 Test Acc: 0.542
Validation loss decreased (-0.450367 --> -0.541971).  Saving model ...
Epoch: 5 cost time: 1.1250231266021729
Epoch: 5, Steps: 8 | Train Loss: 0.489 Vali Loss: 1.268 Vali Acc: 0.557 Test Loss: 1.268 Test Acc: 0.557
Validation loss decreased (-0.541971 --> -0.557239).  Saving model ...
Epoch: 6 cost time: 1.5466516017913818
Epoch: 6, Steps: 8 | Train Loss: 0.256 Vali Loss: 1.283 Vali Acc: 0.542 Test Loss: 1.283 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3815183639526367
Epoch: 7, Steps: 8 | Train Loss: 0.054 Vali Loss: 1.560 Vali Acc: 0.580 Test Loss: 1.560 Test Acc: 0.580
Validation loss decreased (-0.557239 --> -0.580137).  Saving model ...
Epoch: 8 cost time: 0.9650523662567139
Epoch: 8, Steps: 8 | Train Loss: 0.028 Vali Loss: 1.492 Vali Acc: 0.519 Test Loss: 1.492 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0603041648864746
Epoch: 9, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.579 Vali Acc: 0.573 Test Loss: 1.579 Test Acc: 0.573
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9920132160186768
Epoch: 10, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.921 Vali Acc: 0.550 Test Loss: 1.921 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.1802408695220947
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.826 Vali Acc: 0.542 Test Loss: 1.826 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.2060701847076416
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.732 Vali Acc: 0.550 Test Loss: 1.732 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.5235145092010498
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.724 Vali Acc: 0.588 Test Loss: 1.724 Test Acc: 0.588
Validation loss decreased (-0.580137 --> -0.587769).  Saving model ...
Epoch: 14 cost time: 1.0324771404266357
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.796 Vali Acc: 0.573 Test Loss: 1.796 Test Acc: 0.573
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.140429973602295
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.857 Vali Acc: 0.580 Test Loss: 1.857 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.0999746322631836
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.866 Vali Acc: 0.580 Test Loss: 1.866 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.3271450996398926
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.860 Vali Acc: 0.573 Test Loss: 1.860 Test Acc: 0.573
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.4726753234863281
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.854 Vali Acc: 0.573 Test Loss: 1.854 Test Acc: 0.573
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.4315581321716309
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.848 Vali Acc: 0.580 Test Loss: 1.848 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.0569722652435303
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.857 Vali Acc: 0.580 Test Loss: 1.857 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.0180842876434326
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.863 Vali Acc: 0.580 Test Loss: 1.863 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.043473243713379
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.858 Vali Acc: 0.580 Test Loss: 1.858 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.9643819332122803
Epoch: 23, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.860 Vali Acc: 0.588 Test Loss: 1.860 Test Acc: 0.588
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps1124_str281_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5877862595419847
model parameter : 37981445
model size : 159.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps1124_str562_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.1394741535186768
Epoch: 1, Steps: 8 | Train Loss: 1.554 Vali Loss: 1.650 Vali Acc: 0.420 Test Loss: 1.650 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 1.3548717498779297
Epoch: 2, Steps: 8 | Train Loss: 1.345 Vali Loss: 1.542 Vali Acc: 0.420 Test Loss: 1.542 Test Acc: 0.420
Validation loss decreased (-0.419831 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 0.9188337326049805
Epoch: 3, Steps: 8 | Train Loss: 1.083 Vali Loss: 1.533 Vali Acc: 0.466 Test Loss: 1.533 Test Acc: 0.466
Validation loss decreased (-0.419832 --> -0.465634).  Saving model ...
Epoch: 4 cost time: 1.262347936630249
Epoch: 4, Steps: 8 | Train Loss: 0.759 Vali Loss: 1.534 Vali Acc: 0.496 Test Loss: 1.534 Test Acc: 0.496
Validation loss decreased (-0.465634 --> -0.496168).  Saving model ...
Epoch: 5 cost time: 1.0185797214508057
Epoch: 5, Steps: 8 | Train Loss: 0.449 Vali Loss: 1.491 Vali Acc: 0.450 Test Loss: 1.491 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2605259418487549
Epoch: 6, Steps: 8 | Train Loss: 0.176 Vali Loss: 1.522 Vali Acc: 0.504 Test Loss: 1.522 Test Acc: 0.504
Validation loss decreased (-0.496168 --> -0.503802).  Saving model ...
Epoch: 7 cost time: 0.932908296585083
Epoch: 7, Steps: 8 | Train Loss: 0.053 Vali Loss: 1.564 Vali Acc: 0.443 Test Loss: 1.564 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8976867198944092
Epoch: 8, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.716 Vali Acc: 0.481 Test Loss: 1.716 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0929064750671387
Epoch: 9, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.930 Vali Acc: 0.519 Test Loss: 1.930 Test Acc: 0.519
Validation loss decreased (-0.503802 --> -0.519065).  Saving model ...
Epoch: 10 cost time: 0.9455251693725586
Epoch: 10, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.620 Vali Acc: 0.473 Test Loss: 1.620 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2471754550933838
Epoch: 11, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.641 Vali Acc: 0.466 Test Loss: 1.641 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.0533616542816162
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.743 Vali Acc: 0.496 Test Loss: 1.743 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.0027122497558594
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.846 Vali Acc: 0.519 Test Loss: 1.846 Test Acc: 0.519
Validation loss decreased (-0.519065 --> -0.519066).  Saving model ...
Epoch: 14 cost time: 1.2071139812469482
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.853 Vali Acc: 0.534 Test Loss: 1.853 Test Acc: 0.534
Validation loss decreased (-0.519066 --> -0.534333).  Saving model ...
Epoch: 15 cost time: 1.1805479526519775
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.824 Vali Acc: 0.504 Test Loss: 1.824 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2307689189910889
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.796 Vali Acc: 0.504 Test Loss: 1.796 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.005781888961792
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.788 Vali Acc: 0.519 Test Loss: 1.788 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.8391685485839844
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.789 Vali Acc: 0.519 Test Loss: 1.789 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.1726586818695068
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.802 Vali Acc: 0.511 Test Loss: 1.802 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.9544708728790283
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.804 Vali Acc: 0.504 Test Loss: 1.804 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.7589447498321533
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.821 Vali Acc: 0.511 Test Loss: 1.821 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.930051326751709
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.847 Vali Acc: 0.511 Test Loss: 1.847 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.9052038192749023
Epoch: 23, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.863 Vali Acc: 0.504 Test Loss: 1.863 Test Acc: 0.504
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.9339666366577148
Epoch: 24, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.873 Vali Acc: 0.504 Test Loss: 1.873 Test Acc: 0.504
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps1124_str562_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 37820165
model size : 158.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps1124_str1124_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.3662333488464355
Epoch: 1, Steps: 8 | Train Loss: 1.514 Vali Loss: 1.613 Vali Acc: 0.420 Test Loss: 1.613 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 1.0276365280151367
Epoch: 2, Steps: 8 | Train Loss: 1.361 Vali Loss: 1.568 Vali Acc: 0.420 Test Loss: 1.568 Test Acc: 0.420
Validation loss decreased (-0.419831 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 1.0211219787597656
Epoch: 3, Steps: 8 | Train Loss: 1.131 Vali Loss: 1.471 Vali Acc: 0.496 Test Loss: 1.471 Test Acc: 0.496
Validation loss decreased (-0.419832 --> -0.496168).  Saving model ...
Epoch: 4 cost time: 0.9244005680084229
Epoch: 4, Steps: 8 | Train Loss: 0.836 Vali Loss: 1.426 Vali Acc: 0.466 Test Loss: 1.426 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9995720386505127
Epoch: 5, Steps: 8 | Train Loss: 0.585 Vali Loss: 1.408 Vali Acc: 0.557 Test Loss: 1.408 Test Acc: 0.557
Validation loss decreased (-0.496168 --> -0.557238).  Saving model ...
Epoch: 6 cost time: 0.8239336013793945
Epoch: 6, Steps: 8 | Train Loss: 0.316 Vali Loss: 1.393 Vali Acc: 0.466 Test Loss: 1.393 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9771475791931152
Epoch: 7, Steps: 8 | Train Loss: 0.143 Vali Loss: 1.484 Vali Acc: 0.542 Test Loss: 1.484 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.0379467010498047
Epoch: 8, Steps: 8 | Train Loss: 0.050 Vali Loss: 1.645 Vali Acc: 0.557 Test Loss: 1.645 Test Acc: 0.557
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.9165046215057373
Epoch: 9, Steps: 8 | Train Loss: 0.020 Vali Loss: 1.810 Vali Acc: 0.557 Test Loss: 1.810 Test Acc: 0.557
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.9060108661651611
Epoch: 10, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.858 Vali Acc: 0.557 Test Loss: 1.858 Test Acc: 0.557
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.9997248649597168
Epoch: 11, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.845 Vali Acc: 0.557 Test Loss: 1.845 Test Acc: 0.557
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.7906513214111328
Epoch: 12, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.829 Vali Acc: 0.557 Test Loss: 1.829 Test Acc: 0.557
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.907219409942627
Epoch: 13, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.845 Vali Acc: 0.557 Test Loss: 1.845 Test Acc: 0.557
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.8361139297485352
Epoch: 14, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.867 Vali Acc: 0.557 Test Loss: 1.867 Test Acc: 0.557
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.1416752338409424
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.873 Vali Acc: 0.557 Test Loss: 1.873 Test Acc: 0.557
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps1124_str1124_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 37739525
model size : 158.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps1199_str300_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.433323621749878
Epoch: 1, Steps: 8 | Train Loss: 1.526 Vali Loss: 1.612 Vali Acc: 0.420 Test Loss: 1.612 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 1.1186432838439941
Epoch: 2, Steps: 8 | Train Loss: 1.365 Vali Loss: 1.440 Vali Acc: 0.435 Test Loss: 1.440 Test Acc: 0.435
Validation loss decreased (-0.419831 --> -0.435100).  Saving model ...
Epoch: 3 cost time: 1.225987434387207
Epoch: 3, Steps: 8 | Train Loss: 1.014 Vali Loss: 1.422 Vali Acc: 0.473 Test Loss: 1.422 Test Acc: 0.473
Validation loss decreased (-0.435100 --> -0.473268).  Saving model ...
Epoch: 4 cost time: 1.2823913097381592
Epoch: 4, Steps: 8 | Train Loss: 0.682 Vali Loss: 1.419 Vali Acc: 0.511 Test Loss: 1.419 Test Acc: 0.511
Validation loss decreased (-0.473268 --> -0.511436).  Saving model ...
Epoch: 5 cost time: 1.5572996139526367
Epoch: 5, Steps: 8 | Train Loss: 0.283 Vali Loss: 1.310 Vali Acc: 0.519 Test Loss: 1.310 Test Acc: 0.519
Validation loss decreased (-0.511436 --> -0.519071).  Saving model ...
Epoch: 6 cost time: 1.0306816101074219
Epoch: 6, Steps: 8 | Train Loss: 0.107 Vali Loss: 1.379 Vali Acc: 0.534 Test Loss: 1.379 Test Acc: 0.534
Validation loss decreased (-0.519071 --> -0.534337).  Saving model ...
Epoch: 7 cost time: 1.4035773277282715
Epoch: 7, Steps: 8 | Train Loss: 0.028 Vali Loss: 1.399 Vali Acc: 0.527 Test Loss: 1.399 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4714641571044922
Epoch: 8, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.719 Vali Acc: 0.534 Test Loss: 1.719 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1104710102081299
Epoch: 9, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.411 Vali Acc: 0.557 Test Loss: 1.411 Test Acc: 0.557
Validation loss decreased (-0.534337 --> -0.557238).  Saving model ...
Epoch: 10 cost time: 1.1910052299499512
Epoch: 10, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.457 Vali Acc: 0.565 Test Loss: 1.457 Test Acc: 0.565
Validation loss decreased (-0.557238 --> -0.564871).  Saving model ...
Epoch: 11 cost time: 1.1553199291229248
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.627 Vali Acc: 0.557 Test Loss: 1.627 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.910860538482666
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.717 Vali Acc: 0.573 Test Loss: 1.717 Test Acc: 0.573
Validation loss decreased (-0.564871 --> -0.572502).  Saving model ...
Epoch: 13 cost time: 1.6497061252593994
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.723 Vali Acc: 0.557 Test Loss: 1.723 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4856812953948975
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.701 Vali Acc: 0.542 Test Loss: 1.701 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.4172685146331787
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.692 Vali Acc: 0.557 Test Loss: 1.692 Test Acc: 0.557
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.1686055660247803
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.698 Vali Acc: 0.565 Test Loss: 1.698 Test Acc: 0.565
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.2946043014526367
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.708 Vali Acc: 0.565 Test Loss: 1.708 Test Acc: 0.565
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.221200942993164
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.715 Vali Acc: 0.565 Test Loss: 1.715 Test Acc: 0.565
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.1595158576965332
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.720 Vali Acc: 0.557 Test Loss: 1.720 Test Acc: 0.557
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.9691324234008789
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.731 Vali Acc: 0.557 Test Loss: 1.731 Test Acc: 0.557
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.3282599449157715
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.746 Vali Acc: 0.565 Test Loss: 1.746 Test Acc: 0.565
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.3955507278442383
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.764 Vali Acc: 0.565 Test Loss: 1.764 Test Acc: 0.565
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps1199_str300_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5725190839694656
model parameter : 38991365
model size : 163.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps1199_str600_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.1371617317199707
Epoch: 1, Steps: 8 | Train Loss: 1.534 Vali Loss: 1.600 Vali Acc: 0.420 Test Loss: 1.600 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 0.9833426475524902
Epoch: 2, Steps: 8 | Train Loss: 1.365 Vali Loss: 1.578 Vali Acc: 0.435 Test Loss: 1.578 Test Acc: 0.435
Validation loss decreased (-0.419831 --> -0.435099).  Saving model ...
Epoch: 3 cost time: 1.0285732746124268
Epoch: 3, Steps: 8 | Train Loss: 1.065 Vali Loss: 1.498 Vali Acc: 0.504 Test Loss: 1.498 Test Acc: 0.504
Validation loss decreased (-0.435099 --> -0.503802).  Saving model ...
Epoch: 4 cost time: 0.828265905380249
Epoch: 4, Steps: 8 | Train Loss: 0.718 Vali Loss: 1.424 Vali Acc: 0.496 Test Loss: 1.424 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.039259672164917
Epoch: 5, Steps: 8 | Train Loss: 0.382 Vali Loss: 1.399 Vali Acc: 0.496 Test Loss: 1.399 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1703529357910156
Epoch: 6, Steps: 8 | Train Loss: 0.157 Vali Loss: 1.334 Vali Acc: 0.527 Test Loss: 1.334 Test Acc: 0.527
Validation loss decreased (-0.503802 --> -0.526704).  Saving model ...
Epoch: 7 cost time: 0.9311530590057373
Epoch: 7, Steps: 8 | Train Loss: 0.052 Vali Loss: 1.439 Vali Acc: 0.511 Test Loss: 1.439 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7932982444763184
Epoch: 8, Steps: 8 | Train Loss: 0.018 Vali Loss: 1.372 Vali Acc: 0.511 Test Loss: 1.372 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8627700805664062
Epoch: 9, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.387 Vali Acc: 0.527 Test Loss: 1.387 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.8541884422302246
Epoch: 10, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.452 Vali Acc: 0.534 Test Loss: 1.452 Test Acc: 0.534
Validation loss decreased (-0.526704 --> -0.534337).  Saving model ...
Epoch: 11 cost time: 0.7922003269195557
Epoch: 11, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.501 Vali Acc: 0.534 Test Loss: 1.501 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.762296199798584
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.535 Vali Acc: 0.534 Test Loss: 1.535 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.8010549545288086
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.558 Vali Acc: 0.550 Test Loss: 1.558 Test Acc: 0.550
Validation loss decreased (-0.534337 --> -0.549603).  Saving model ...
Epoch: 14 cost time: 0.9740581512451172
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.569 Vali Acc: 0.542 Test Loss: 1.569 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9183444976806641
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.580 Vali Acc: 0.550 Test Loss: 1.580 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7757172584533691
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.566 Vali Acc: 0.550 Test Loss: 1.566 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.9297506809234619
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.564 Vali Acc: 0.550 Test Loss: 1.564 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.952843427658081
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.577 Vali Acc: 0.557 Test Loss: 1.577 Test Acc: 0.557
Validation loss decreased (-0.549603 --> -0.557236).  Saving model ...
Epoch: 19 cost time: 0.9683985710144043
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.588 Vali Acc: 0.550 Test Loss: 1.588 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9693622589111328
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.592 Vali Acc: 0.557 Test Loss: 1.592 Test Acc: 0.557
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.8554003238677979
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.596 Vali Acc: 0.557 Test Loss: 1.596 Test Acc: 0.557
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.9254343509674072
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.603 Vali Acc: 0.550 Test Loss: 1.603 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.9307818412780762
Epoch: 23, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.609 Vali Acc: 0.550 Test Loss: 1.609 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.7902758121490479
Epoch: 24, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.627 Vali Acc: 0.550 Test Loss: 1.627 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.8044402599334717
Epoch: 25, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.643 Vali Acc: 0.542 Test Loss: 1.643 Test Acc: 0.542
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.9296150207519531
Epoch: 26, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.644 Vali Acc: 0.557 Test Loss: 1.644 Test Acc: 0.557
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.4818885326385498
Epoch: 27, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.641 Vali Acc: 0.565 Test Loss: 1.641 Test Acc: 0.565
Validation loss decreased (-0.557236 --> -0.564869).  Saving model ...
Epoch: 28 cost time: 1.073988437652588
Epoch: 28, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.640 Vali Acc: 0.565 Test Loss: 1.640 Test Acc: 0.565
Validation loss decreased (-0.564869 --> -0.564869).  Saving model ...
Epoch: 29 cost time: 0.8702905178070068
Epoch: 29, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.649 Vali Acc: 0.565 Test Loss: 1.649 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.9750397205352783
Epoch: 30, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.658 Vali Acc: 0.565 Test Loss: 1.658 Test Acc: 0.565
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.9625592231750488
Epoch: 31, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.661 Vali Acc: 0.557 Test Loss: 1.661 Test Acc: 0.557
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.0335609912872314
Epoch: 32, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.668 Vali Acc: 0.557 Test Loss: 1.668 Test Acc: 0.557
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.2947354316711426
Epoch: 33, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.674 Vali Acc: 0.557 Test Loss: 1.674 Test Acc: 0.557
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.3501923084259033
Epoch: 34, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.677 Vali Acc: 0.550 Test Loss: 1.677 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.9000823497772217
Epoch: 35, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.682 Vali Acc: 0.557 Test Loss: 1.682 Test Acc: 0.557
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.0087900161743164
Epoch: 36, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.678 Vali Acc: 0.550 Test Loss: 1.678 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.1157827377319336
Epoch: 37, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.676 Vali Acc: 0.557 Test Loss: 1.676 Test Acc: 0.557
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.2523157596588135
Epoch: 38, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.678 Vali Acc: 0.557 Test Loss: 1.678 Test Acc: 0.557
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps1199_str600_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5648854961832062
model parameter : 38840837
model size : 162.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps1199_str1199_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.09148907661438
Epoch: 1, Steps: 8 | Train Loss: 1.576 Vali Loss: 1.548 Vali Acc: 0.420 Test Loss: 1.548 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 0.9090619087219238
Epoch: 2, Steps: 8 | Train Loss: 1.339 Vali Loss: 1.505 Vali Acc: 0.420 Test Loss: 1.505 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 0.9185738563537598
Epoch: 3, Steps: 8 | Train Loss: 1.087 Vali Loss: 1.438 Vali Acc: 0.511 Test Loss: 1.438 Test Acc: 0.511
Validation loss decreased (-0.419832 --> -0.511436).  Saving model ...
Epoch: 4 cost time: 0.9812896251678467
Epoch: 4, Steps: 8 | Train Loss: 0.831 Vali Loss: 1.372 Vali Acc: 0.519 Test Loss: 1.372 Test Acc: 0.519
Validation loss decreased (-0.511436 --> -0.519070).  Saving model ...
Epoch: 5 cost time: 1.186164140701294
Epoch: 5, Steps: 8 | Train Loss: 0.545 Vali Loss: 1.385 Vali Acc: 0.519 Test Loss: 1.385 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.023512363433838
Epoch: 6, Steps: 8 | Train Loss: 0.249 Vali Loss: 1.336 Vali Acc: 0.527 Test Loss: 1.336 Test Acc: 0.527
Validation loss decreased (-0.519070 --> -0.526704).  Saving model ...
Epoch: 7 cost time: 1.0776090621948242
Epoch: 7, Steps: 8 | Train Loss: 0.092 Vali Loss: 1.422 Vali Acc: 0.550 Test Loss: 1.422 Test Acc: 0.550
Validation loss decreased (-0.526704 --> -0.549604).  Saving model ...
Epoch: 8 cost time: 1.0150251388549805
Epoch: 8, Steps: 8 | Train Loss: 0.026 Vali Loss: 1.391 Vali Acc: 0.565 Test Loss: 1.391 Test Acc: 0.565
Validation loss decreased (-0.549604 --> -0.564872).  Saving model ...
Epoch: 9 cost time: 1.3019495010375977
Epoch: 9, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.444 Vali Acc: 0.550 Test Loss: 1.444 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9613499641418457
Epoch: 10, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.523 Vali Acc: 0.557 Test Loss: 1.523 Test Acc: 0.557
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9666695594787598
Epoch: 11, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.566 Vali Acc: 0.550 Test Loss: 1.566 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.9688377380371094
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.589 Vali Acc: 0.542 Test Loss: 1.589 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.314683437347412
Epoch: 13, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.596 Vali Acc: 0.534 Test Loss: 1.596 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.9020266532897949
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.603 Vali Acc: 0.550 Test Loss: 1.603 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.9682495594024658
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.619 Vali Acc: 0.550 Test Loss: 1.619 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.9262053966522217
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.642 Vali Acc: 0.550 Test Loss: 1.642 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.008946418762207
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.662 Vali Acc: 0.557 Test Loss: 1.662 Test Acc: 0.557
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.8215436935424805
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.666 Vali Acc: 0.565 Test Loss: 1.666 Test Acc: 0.565
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps1199_str1199_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5648854961832062
model parameter : 38765573
model size : 162.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps1285_str322_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.7923197746276855
Epoch: 1, Steps: 8 | Train Loss: 1.536 Vali Loss: 1.616 Vali Acc: 0.420 Test Loss: 1.616 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 1.093177318572998
Epoch: 2, Steps: 8 | Train Loss: 1.345 Vali Loss: 1.500 Vali Acc: 0.443 Test Loss: 1.500 Test Acc: 0.443
Validation loss decreased (-0.419831 --> -0.442733).  Saving model ...
Epoch: 3 cost time: 1.4306375980377197
Epoch: 3, Steps: 8 | Train Loss: 1.029 Vali Loss: 1.454 Vali Acc: 0.481 Test Loss: 1.454 Test Acc: 0.481
Validation loss decreased (-0.442733 --> -0.480901).  Saving model ...
Epoch: 4 cost time: 1.09053635597229
Epoch: 4, Steps: 8 | Train Loss: 0.679 Vali Loss: 1.361 Vali Acc: 0.534 Test Loss: 1.361 Test Acc: 0.534
Validation loss decreased (-0.480901 --> -0.534338).  Saving model ...
Epoch: 5 cost time: 1.0219190120697021
Epoch: 5, Steps: 8 | Train Loss: 0.390 Vali Loss: 1.243 Vali Acc: 0.565 Test Loss: 1.243 Test Acc: 0.565
Validation loss decreased (-0.534338 --> -0.564873).  Saving model ...
Epoch: 6 cost time: 1.0541532039642334
Epoch: 6, Steps: 8 | Train Loss: 0.196 Vali Loss: 1.353 Vali Acc: 0.550 Test Loss: 1.353 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0855565071105957
Epoch: 7, Steps: 8 | Train Loss: 0.044 Vali Loss: 1.269 Vali Acc: 0.519 Test Loss: 1.269 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9901371002197266
Epoch: 8, Steps: 8 | Train Loss: 0.019 Vali Loss: 1.363 Vali Acc: 0.573 Test Loss: 1.363 Test Acc: 0.573
Validation loss decreased (-0.564873 --> -0.572505).  Saving model ...
Epoch: 9 cost time: 1.0355949401855469
Epoch: 9, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.355 Vali Acc: 0.550 Test Loss: 1.355 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0199646949768066
Epoch: 10, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.584 Vali Acc: 0.534 Test Loss: 1.584 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8469092845916748
Epoch: 11, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.473 Vali Acc: 0.565 Test Loss: 1.473 Test Acc: 0.565
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.8456883430480957
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.389 Vali Acc: 0.557 Test Loss: 1.389 Test Acc: 0.557
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.817570686340332
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.351 Vali Acc: 0.573 Test Loss: 1.351 Test Acc: 0.573
Validation loss decreased (-0.572505 --> -0.572506).  Saving model ...
Epoch: 14 cost time: 0.888930082321167
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.362 Vali Acc: 0.580 Test Loss: 1.362 Test Acc: 0.580
Validation loss decreased (-0.572506 --> -0.580139).  Saving model ...
Epoch: 15 cost time: 0.8512811660766602
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.385 Vali Acc: 0.580 Test Loss: 1.385 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8595693111419678
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.396 Vali Acc: 0.580 Test Loss: 1.396 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.8254585266113281
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.408 Vali Acc: 0.580 Test Loss: 1.408 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.8493480682373047
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.418 Vali Acc: 0.580 Test Loss: 1.418 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.1694250106811523
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.426 Vali Acc: 0.580 Test Loss: 1.426 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.1122157573699951
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.440 Vali Acc: 0.580 Test Loss: 1.440 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.1192128658294678
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.447 Vali Acc: 0.580 Test Loss: 1.447 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.117321252822876
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.454 Vali Acc: 0.573 Test Loss: 1.454 Test Acc: 0.573
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.1573693752288818
Epoch: 23, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.463 Vali Acc: 0.573 Test Loss: 1.463 Test Acc: 0.573
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.1041691303253174
Epoch: 24, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.464 Vali Acc: 0.595 Test Loss: 1.464 Test Acc: 0.595
Validation loss decreased (-0.580139 --> -0.595405).  Saving model ...
Epoch: 25 cost time: 1.3088431358337402
Epoch: 25, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.461 Vali Acc: 0.603 Test Loss: 1.461 Test Acc: 0.603
Validation loss decreased (-0.595405 --> -0.603039).  Saving model ...
Epoch: 26 cost time: 1.247957468032837
Epoch: 26, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.460 Vali Acc: 0.603 Test Loss: 1.460 Test Acc: 0.603
Validation loss decreased (-0.603039 --> -0.603039).  Saving model ...
Epoch: 27 cost time: 1.127058506011963
Epoch: 27, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.458 Vali Acc: 0.603 Test Loss: 1.458 Test Acc: 0.603
Validation loss decreased (-0.603039 --> -0.603039).  Saving model ...
Epoch: 28 cost time: 1.14601469039917
Epoch: 28, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.459 Vali Acc: 0.603 Test Loss: 1.459 Test Acc: 0.603
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.1032276153564453
Epoch: 29, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.463 Vali Acc: 0.603 Test Loss: 1.463 Test Acc: 0.603
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.106034755706787
Epoch: 30, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.467 Vali Acc: 0.603 Test Loss: 1.467 Test Acc: 0.603
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.1101465225219727
Epoch: 31, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.476 Vali Acc: 0.603 Test Loss: 1.476 Test Acc: 0.603
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.2321667671203613
Epoch: 32, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.483 Vali Acc: 0.603 Test Loss: 1.483 Test Acc: 0.603
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.1742441654205322
Epoch: 33, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.489 Vali Acc: 0.603 Test Loss: 1.489 Test Acc: 0.603
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.2563021183013916
Epoch: 34, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.489 Vali Acc: 0.603 Test Loss: 1.489 Test Acc: 0.603
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.5644993782043457
Epoch: 35, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.492 Vali Acc: 0.603 Test Loss: 1.492 Test Acc: 0.603
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.486943006515503
Epoch: 36, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.492 Vali Acc: 0.603 Test Loss: 1.492 Test Acc: 0.603
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.182779312133789
Epoch: 37, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.494 Vali Acc: 0.603 Test Loss: 1.494 Test Acc: 0.603
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps1285_str322_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6030534351145038
model parameter : 40158725
model size : 167.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps1285_str643_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.90226674079895
Epoch: 1, Steps: 8 | Train Loss: 1.556 Vali Loss: 1.603 Vali Acc: 0.420 Test Loss: 1.603 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 1.0555305480957031
Epoch: 2, Steps: 8 | Train Loss: 1.399 Vali Loss: 1.516 Vali Acc: 0.427 Test Loss: 1.516 Test Acc: 0.427
Validation loss decreased (-0.419831 --> -0.427466).  Saving model ...
Epoch: 3 cost time: 1.058504581451416
Epoch: 3, Steps: 8 | Train Loss: 1.106 Vali Loss: 1.484 Vali Acc: 0.473 Test Loss: 1.484 Test Acc: 0.473
Validation loss decreased (-0.427466 --> -0.473268).  Saving model ...
Epoch: 4 cost time: 1.0778684616088867
Epoch: 4, Steps: 8 | Train Loss: 0.786 Vali Loss: 1.405 Vali Acc: 0.504 Test Loss: 1.405 Test Acc: 0.504
Validation loss decreased (-0.473268 --> -0.503803).  Saving model ...
Epoch: 5 cost time: 1.051438808441162
Epoch: 5, Steps: 8 | Train Loss: 0.451 Vali Loss: 1.406 Vali Acc: 0.527 Test Loss: 1.406 Test Acc: 0.527
Validation loss decreased (-0.503803 --> -0.526704).  Saving model ...
Epoch: 6 cost time: 1.0917644500732422
Epoch: 6, Steps: 8 | Train Loss: 0.194 Vali Loss: 1.437 Vali Acc: 0.527 Test Loss: 1.437 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0776422023773193
Epoch: 7, Steps: 8 | Train Loss: 0.073 Vali Loss: 1.493 Vali Acc: 0.534 Test Loss: 1.493 Test Acc: 0.534
Validation loss decreased (-0.526704 --> -0.534336).  Saving model ...
Epoch: 8 cost time: 1.5547475814819336
Epoch: 8, Steps: 8 | Train Loss: 0.019 Vali Loss: 1.598 Vali Acc: 0.542 Test Loss: 1.598 Test Acc: 0.542
Validation loss decreased (-0.534336 --> -0.541969).  Saving model ...
Epoch: 9 cost time: 1.5140717029571533
Epoch: 9, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.670 Vali Acc: 0.550 Test Loss: 1.670 Test Acc: 0.550
Validation loss decreased (-0.541969 --> -0.549602).  Saving model ...
Epoch: 10 cost time: 1.4833214282989502
Epoch: 10, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.591 Vali Acc: 0.565 Test Loss: 1.591 Test Acc: 0.565
Validation loss decreased (-0.549602 --> -0.564870).  Saving model ...
Epoch: 11 cost time: 1.0728185176849365
Epoch: 11, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.588 Vali Acc: 0.565 Test Loss: 1.588 Test Acc: 0.565
Validation loss decreased (-0.564870 --> -0.564870).  Saving model ...
Epoch: 12 cost time: 1.4936652183532715
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.628 Vali Acc: 0.565 Test Loss: 1.628 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0078940391540527
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.691 Vali Acc: 0.565 Test Loss: 1.691 Test Acc: 0.565
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.0117852687835693
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.730 Vali Acc: 0.565 Test Loss: 1.730 Test Acc: 0.565
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.0268595218658447
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.742 Vali Acc: 0.565 Test Loss: 1.742 Test Acc: 0.565
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.0861687660217285
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.744 Vali Acc: 0.565 Test Loss: 1.744 Test Acc: 0.565
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.9516832828521729
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.737 Vali Acc: 0.557 Test Loss: 1.737 Test Acc: 0.557
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.1912918090820312
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.734 Vali Acc: 0.557 Test Loss: 1.734 Test Acc: 0.557
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.505894660949707
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.738 Vali Acc: 0.557 Test Loss: 1.738 Test Acc: 0.557
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.4329886436462402
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.749 Vali Acc: 0.557 Test Loss: 1.749 Test Acc: 0.557
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.1565887928009033
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.772 Vali Acc: 0.557 Test Loss: 1.772 Test Acc: 0.557
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps1285_str643_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5648854961832062
model parameter : 40018949
model size : 167.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps1285_str1285_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.490490436553955
Epoch: 1, Steps: 8 | Train Loss: 1.538 Vali Loss: 1.595 Vali Acc: 0.420 Test Loss: 1.595 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 1.1215953826904297
Epoch: 2, Steps: 8 | Train Loss: 1.319 Vali Loss: 1.532 Vali Acc: 0.450 Test Loss: 1.532 Test Acc: 0.450
Validation loss decreased (-0.419831 --> -0.450366).  Saving model ...
Epoch: 3 cost time: 1.0343875885009766
Epoch: 3, Steps: 8 | Train Loss: 1.046 Vali Loss: 1.518 Vali Acc: 0.466 Test Loss: 1.518 Test Acc: 0.466
Validation loss decreased (-0.450366 --> -0.465634).  Saving model ...
Epoch: 4 cost time: 1.0636863708496094
Epoch: 4, Steps: 8 | Train Loss: 0.742 Vali Loss: 1.441 Vali Acc: 0.511 Test Loss: 1.441 Test Acc: 0.511
Validation loss decreased (-0.465634 --> -0.511436).  Saving model ...
Epoch: 5 cost time: 1.0383193492889404
Epoch: 5, Steps: 8 | Train Loss: 0.437 Vali Loss: 1.334 Vali Acc: 0.481 Test Loss: 1.334 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9949595928192139
Epoch: 6, Steps: 8 | Train Loss: 0.218 Vali Loss: 1.394 Vali Acc: 0.489 Test Loss: 1.394 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9814660549163818
Epoch: 7, Steps: 8 | Train Loss: 0.085 Vali Loss: 1.476 Vali Acc: 0.466 Test Loss: 1.476 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.0314154624938965
Epoch: 8, Steps: 8 | Train Loss: 0.029 Vali Loss: 1.484 Vali Acc: 0.481 Test Loss: 1.484 Test Acc: 0.481
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.9947268962860107
Epoch: 9, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.611 Vali Acc: 0.481 Test Loss: 1.611 Test Acc: 0.481
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.2352750301361084
Epoch: 10, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.687 Vali Acc: 0.489 Test Loss: 1.687 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.9773406982421875
Epoch: 11, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.721 Vali Acc: 0.489 Test Loss: 1.721 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.3870692253112793
Epoch: 12, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.734 Vali Acc: 0.496 Test Loss: 1.734 Test Acc: 0.496
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.0230488777160645
Epoch: 13, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.753 Vali Acc: 0.496 Test Loss: 1.753 Test Acc: 0.496
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.9953432083129883
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.769 Vali Acc: 0.496 Test Loss: 1.769 Test Acc: 0.496
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps1285_str1285_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5114503816793893
model parameter : 39949061
model size : 167.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps1384_str346_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.7251129150390625
Epoch: 1, Steps: 8 | Train Loss: 1.521 Vali Loss: 1.562 Vali Acc: 0.420 Test Loss: 1.562 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 1.2432291507720947
Epoch: 2, Steps: 8 | Train Loss: 1.392 Vali Loss: 1.519 Vali Acc: 0.420 Test Loss: 1.519 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 1.1111643314361572
Epoch: 3, Steps: 8 | Train Loss: 1.117 Vali Loss: 1.413 Vali Acc: 0.489 Test Loss: 1.413 Test Acc: 0.489
Validation loss decreased (-0.419832 --> -0.488535).  Saving model ...
Epoch: 4 cost time: 1.058501958847046
Epoch: 4, Steps: 8 | Train Loss: 0.787 Vali Loss: 1.349 Vali Acc: 0.534 Test Loss: 1.349 Test Acc: 0.534
Validation loss decreased (-0.488535 --> -0.534338).  Saving model ...
Epoch: 5 cost time: 1.2949695587158203
Epoch: 5, Steps: 8 | Train Loss: 0.423 Vali Loss: 1.291 Vali Acc: 0.550 Test Loss: 1.291 Test Acc: 0.550
Validation loss decreased (-0.534338 --> -0.549605).  Saving model ...
Epoch: 6 cost time: 1.1866931915283203
Epoch: 6, Steps: 8 | Train Loss: 0.156 Vali Loss: 1.522 Vali Acc: 0.511 Test Loss: 1.522 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.198866367340088
Epoch: 7, Steps: 8 | Train Loss: 0.055 Vali Loss: 1.360 Vali Acc: 0.580 Test Loss: 1.360 Test Acc: 0.580
Validation loss decreased (-0.549605 --> -0.580139).  Saving model ...
Epoch: 8 cost time: 1.6003661155700684
Epoch: 8, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.344 Vali Acc: 0.580 Test Loss: 1.344 Test Acc: 0.580
Validation loss decreased (-0.580139 --> -0.580139).  Saving model ...
Epoch: 9 cost time: 1.1828620433807373
Epoch: 9, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.376 Vali Acc: 0.588 Test Loss: 1.376 Test Acc: 0.588
Validation loss decreased (-0.580139 --> -0.587772).  Saving model ...
Epoch: 10 cost time: 1.241288423538208
Epoch: 10, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.591 Vali Acc: 0.580 Test Loss: 1.591 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5503463745117188
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.526 Vali Acc: 0.588 Test Loss: 1.526 Test Acc: 0.588
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.4622933864593506
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.458 Vali Acc: 0.588 Test Loss: 1.458 Test Acc: 0.588
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.049527645111084
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.466 Vali Acc: 0.580 Test Loss: 1.466 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.0788965225219727
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.495 Vali Acc: 0.588 Test Loss: 1.495 Test Acc: 0.588
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.1179680824279785
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.508 Vali Acc: 0.595 Test Loss: 1.508 Test Acc: 0.595
Validation loss decreased (-0.587772 --> -0.595405).  Saving model ...
Epoch: 16 cost time: 1.071640968322754
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.529 Vali Acc: 0.611 Test Loss: 1.529 Test Acc: 0.611
Validation loss decreased (-0.595405 --> -0.610672).  Saving model ...
Epoch: 17 cost time: 1.0549657344818115
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.556 Vali Acc: 0.603 Test Loss: 1.556 Test Acc: 0.603
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9879696369171143
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.576 Vali Acc: 0.595 Test Loss: 1.576 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.0925099849700928
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.588 Vali Acc: 0.595 Test Loss: 1.588 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.0948598384857178
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.592 Vali Acc: 0.595 Test Loss: 1.592 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.4453036785125732
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.588 Vali Acc: 0.595 Test Loss: 1.588 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.2221193313598633
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.591 Vali Acc: 0.595 Test Loss: 1.591 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.067042589187622
Epoch: 23, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.593 Vali Acc: 0.595 Test Loss: 1.593 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.0692589282989502
Epoch: 24, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.595 Vali Acc: 0.595 Test Loss: 1.595 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.1630301475524902
Epoch: 25, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.597 Vali Acc: 0.595 Test Loss: 1.597 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.1752822399139404
Epoch: 26, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.604 Vali Acc: 0.595 Test Loss: 1.604 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps1384_str346_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6106870229007634
model parameter : 41505797
model size : 173.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps1384_str692_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.464974880218506
Epoch: 1, Steps: 8 | Train Loss: 1.531 Vali Loss: 1.539 Vali Acc: 0.420 Test Loss: 1.539 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 0.9060118198394775
Epoch: 2, Steps: 8 | Train Loss: 1.294 Vali Loss: 1.457 Vali Acc: 0.435 Test Loss: 1.457 Test Acc: 0.435
Validation loss decreased (-0.419832 --> -0.435100).  Saving model ...
Epoch: 3 cost time: 1.4356460571289062
Epoch: 3, Steps: 8 | Train Loss: 0.957 Vali Loss: 1.392 Vali Acc: 0.527 Test Loss: 1.392 Test Acc: 0.527
Validation loss decreased (-0.435100 --> -0.526704).  Saving model ...
Epoch: 4 cost time: 1.3495323657989502
Epoch: 4, Steps: 8 | Train Loss: 0.637 Vali Loss: 1.360 Vali Acc: 0.504 Test Loss: 1.360 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2684133052825928
Epoch: 5, Steps: 8 | Train Loss: 0.373 Vali Loss: 1.362 Vali Acc: 0.504 Test Loss: 1.362 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9465663433074951
Epoch: 6, Steps: 8 | Train Loss: 0.152 Vali Loss: 1.552 Vali Acc: 0.542 Test Loss: 1.552 Test Acc: 0.542
Validation loss decreased (-0.526704 --> -0.541969).  Saving model ...
Epoch: 7 cost time: 1.3596441745758057
Epoch: 7, Steps: 8 | Train Loss: 0.052 Vali Loss: 1.413 Vali Acc: 0.550 Test Loss: 1.413 Test Acc: 0.550
Validation loss decreased (-0.541969 --> -0.549604).  Saving model ...
Epoch: 8 cost time: 1.032571792602539
Epoch: 8, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.502 Vali Acc: 0.519 Test Loss: 1.502 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.981877326965332
Epoch: 9, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.558 Vali Acc: 0.534 Test Loss: 1.558 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9769937992095947
Epoch: 10, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.613 Vali Acc: 0.527 Test Loss: 1.613 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.9602475166320801
Epoch: 11, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.617 Vali Acc: 0.511 Test Loss: 1.617 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.0130252838134766
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.643 Vali Acc: 0.504 Test Loss: 1.643 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.966447114944458
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.667 Vali Acc: 0.504 Test Loss: 1.667 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.9791324138641357
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.691 Vali Acc: 0.504 Test Loss: 1.691 Test Acc: 0.504
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.9587750434875488
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.698 Vali Acc: 0.504 Test Loss: 1.698 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.978806734085083
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.700 Vali Acc: 0.504 Test Loss: 1.700 Test Acc: 0.504
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.0521836280822754
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.713 Vali Acc: 0.504 Test Loss: 1.713 Test Acc: 0.504
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps1384_str692_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 41376773
model size : 172.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps1384_str1384_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.7604525089263916
Epoch: 1, Steps: 8 | Train Loss: 1.553 Vali Loss: 1.620 Vali Acc: 0.420 Test Loss: 1.620 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 0.819333553314209
Epoch: 2, Steps: 8 | Train Loss: 1.364 Vali Loss: 1.506 Vali Acc: 0.427 Test Loss: 1.506 Test Acc: 0.427
Validation loss decreased (-0.419831 --> -0.427466).  Saving model ...
Epoch: 3 cost time: 1.2689101696014404
Epoch: 3, Steps: 8 | Train Loss: 1.008 Vali Loss: 1.431 Vali Acc: 0.489 Test Loss: 1.431 Test Acc: 0.489
Validation loss decreased (-0.427466 --> -0.488535).  Saving model ...
Epoch: 4 cost time: 1.050518274307251
Epoch: 4, Steps: 8 | Train Loss: 0.686 Vali Loss: 1.443 Vali Acc: 0.489 Test Loss: 1.443 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0372579097747803
Epoch: 5, Steps: 8 | Train Loss: 0.373 Vali Loss: 1.418 Vali Acc: 0.481 Test Loss: 1.418 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9302752017974854
Epoch: 6, Steps: 8 | Train Loss: 0.174 Vali Loss: 1.502 Vali Acc: 0.481 Test Loss: 1.502 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.937401294708252
Epoch: 7, Steps: 8 | Train Loss: 0.088 Vali Loss: 1.568 Vali Acc: 0.473 Test Loss: 1.568 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.9189252853393555
Epoch: 8, Steps: 8 | Train Loss: 0.024 Vali Loss: 1.716 Vali Acc: 0.496 Test Loss: 1.716 Test Acc: 0.496
Validation loss decreased (-0.488535 --> -0.496166).  Saving model ...
Epoch: 9 cost time: 1.0846359729766846
Epoch: 9, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.728 Vali Acc: 0.481 Test Loss: 1.728 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2402918338775635
Epoch: 10, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.707 Vali Acc: 0.496 Test Loss: 1.707 Test Acc: 0.496
Validation loss decreased (-0.496166 --> -0.496166).  Saving model ...
Epoch: 11 cost time: 0.963214635848999
Epoch: 11, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.772 Vali Acc: 0.511 Test Loss: 1.772 Test Acc: 0.511
Validation loss decreased (-0.496166 --> -0.511433).  Saving model ...
Epoch: 12 cost time: 0.9620475769042969
Epoch: 12, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.930 Vali Acc: 0.504 Test Loss: 1.930 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9303197860717773
Epoch: 13, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.920 Vali Acc: 0.489 Test Loss: 1.920 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9193339347839355
Epoch: 14, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.872 Vali Acc: 0.496 Test Loss: 1.872 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.8933537006378174
Epoch: 15, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.836 Vali Acc: 0.496 Test Loss: 1.836 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.9160037040710449
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.819 Vali Acc: 0.496 Test Loss: 1.819 Test Acc: 0.496
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.9824409484863281
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.831 Vali Acc: 0.496 Test Loss: 1.831 Test Acc: 0.496
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.2195525169372559
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.862 Vali Acc: 0.496 Test Loss: 1.862 Test Acc: 0.496
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.9500033855438232
Epoch: 19, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.887 Vali Acc: 0.504 Test Loss: 1.887 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.0004220008850098
Epoch: 20, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.911 Vali Acc: 0.504 Test Loss: 1.911 Test Acc: 0.504
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.2556512355804443
Epoch: 21, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.926 Vali Acc: 0.504 Test Loss: 1.926 Test Acc: 0.504
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps1384_str1384_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5114503816793893
model parameter : 41312261
model size : 172.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps1499_str375_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.7249462604522705
Epoch: 1, Steps: 8 | Train Loss: 1.593 Vali Loss: 1.615 Vali Acc: 0.420 Test Loss: 1.615 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 1.1442198753356934
Epoch: 2, Steps: 8 | Train Loss: 1.375 Vali Loss: 1.493 Vali Acc: 0.427 Test Loss: 1.493 Test Acc: 0.427
Validation loss decreased (-0.419831 --> -0.427466).  Saving model ...
Epoch: 3 cost time: 1.329622507095337
Epoch: 3, Steps: 8 | Train Loss: 1.052 Vali Loss: 1.408 Vali Acc: 0.481 Test Loss: 1.408 Test Acc: 0.481
Validation loss decreased (-0.427466 --> -0.480902).  Saving model ...
Epoch: 4 cost time: 1.3731789588928223
Epoch: 4, Steps: 8 | Train Loss: 0.705 Vali Loss: 1.357 Vali Acc: 0.542 Test Loss: 1.357 Test Acc: 0.542
Validation loss decreased (-0.480902 --> -0.541971).  Saving model ...
Epoch: 5 cost time: 1.4133086204528809
Epoch: 5, Steps: 8 | Train Loss: 0.320 Vali Loss: 1.302 Vali Acc: 0.527 Test Loss: 1.302 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.233931541442871
Epoch: 6, Steps: 8 | Train Loss: 0.117 Vali Loss: 1.546 Vali Acc: 0.466 Test Loss: 1.546 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.4284851551055908
Epoch: 7, Steps: 8 | Train Loss: 0.032 Vali Loss: 1.462 Vali Acc: 0.504 Test Loss: 1.462 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.6430141925811768
Epoch: 8, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.525 Vali Acc: 0.481 Test Loss: 1.525 Test Acc: 0.481
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.1674716472625732
Epoch: 9, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.609 Vali Acc: 0.542 Test Loss: 1.609 Test Acc: 0.542
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.2669460773468018
Epoch: 10, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.759 Vali Acc: 0.527 Test Loss: 1.759 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.4936656951904297
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.817 Vali Acc: 0.504 Test Loss: 1.817 Test Acc: 0.504
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.6449017524719238
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.809 Vali Acc: 0.511 Test Loss: 1.809 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.256281852722168
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.795 Vali Acc: 0.519 Test Loss: 1.795 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.2738800048828125
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.805 Vali Acc: 0.534 Test Loss: 1.805 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps1499_str375_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 43074053
model size : 178.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps1499_str750_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.4688754081726074
Epoch: 1, Steps: 8 | Train Loss: 1.550 Vali Loss: 1.590 Vali Acc: 0.420 Test Loss: 1.590 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 1.139185905456543
Epoch: 2, Steps: 8 | Train Loss: 1.310 Vali Loss: 1.502 Vali Acc: 0.427 Test Loss: 1.502 Test Acc: 0.427
Validation loss decreased (-0.419831 --> -0.427466).  Saving model ...
Epoch: 3 cost time: 1.1120960712432861
Epoch: 3, Steps: 8 | Train Loss: 1.058 Vali Loss: 1.405 Vali Acc: 0.496 Test Loss: 1.405 Test Acc: 0.496
Validation loss decreased (-0.427466 --> -0.496169).  Saving model ...
Epoch: 4 cost time: 1.1274914741516113
Epoch: 4, Steps: 8 | Train Loss: 0.712 Vali Loss: 1.294 Vali Acc: 0.519 Test Loss: 1.294 Test Acc: 0.519
Validation loss decreased (-0.496169 --> -0.519071).  Saving model ...
Epoch: 5 cost time: 1.5849528312683105
Epoch: 5, Steps: 8 | Train Loss: 0.372 Vali Loss: 1.348 Vali Acc: 0.534 Test Loss: 1.348 Test Acc: 0.534
Validation loss decreased (-0.519071 --> -0.534338).  Saving model ...
Epoch: 6 cost time: 0.983269214630127
Epoch: 6, Steps: 8 | Train Loss: 0.135 Vali Loss: 1.333 Vali Acc: 0.542 Test Loss: 1.333 Test Acc: 0.542
Validation loss decreased (-0.534338 --> -0.541971).  Saving model ...
Epoch: 7 cost time: 0.9109747409820557
Epoch: 7, Steps: 8 | Train Loss: 0.054 Vali Loss: 1.342 Vali Acc: 0.534 Test Loss: 1.342 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2836885452270508
Epoch: 8, Steps: 8 | Train Loss: 0.018 Vali Loss: 1.344 Vali Acc: 0.557 Test Loss: 1.344 Test Acc: 0.557
Validation loss decreased (-0.541971 --> -0.557238).  Saving model ...
Epoch: 9 cost time: 0.8833084106445312
Epoch: 9, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.358 Vali Acc: 0.565 Test Loss: 1.358 Test Acc: 0.565
Validation loss decreased (-0.557238 --> -0.564872).  Saving model ...
Epoch: 10 cost time: 1.0704407691955566
Epoch: 10, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.416 Vali Acc: 0.573 Test Loss: 1.416 Test Acc: 0.573
Validation loss decreased (-0.564872 --> -0.572505).  Saving model ...
Epoch: 11 cost time: 0.9138405323028564
Epoch: 11, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.468 Vali Acc: 0.565 Test Loss: 1.468 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1244723796844482
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.483 Vali Acc: 0.580 Test Loss: 1.483 Test Acc: 0.580
Validation loss decreased (-0.572505 --> -0.580138).  Saving model ...
Epoch: 13 cost time: 1.3878779411315918
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.480 Vali Acc: 0.565 Test Loss: 1.480 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.088261604309082
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.470 Vali Acc: 0.573 Test Loss: 1.470 Test Acc: 0.573
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.0295565128326416
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.461 Vali Acc: 0.565 Test Loss: 1.461 Test Acc: 0.565
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.0701768398284912
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.471 Vali Acc: 0.565 Test Loss: 1.471 Test Acc: 0.565
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.0923774242401123
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.477 Vali Acc: 0.565 Test Loss: 1.477 Test Acc: 0.565
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.5503017902374268
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.482 Vali Acc: 0.565 Test Loss: 1.482 Test Acc: 0.565
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.8990294933319092
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.492 Vali Acc: 0.565 Test Loss: 1.492 Test Acc: 0.565
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.0898771286010742
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.506 Vali Acc: 0.573 Test Loss: 1.506 Test Acc: 0.573
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.5121111869812012
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.519 Vali Acc: 0.565 Test Loss: 1.519 Test Acc: 0.565
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.546990156173706
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.524 Vali Acc: 0.573 Test Loss: 1.524 Test Acc: 0.573
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps1499_str750_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5801526717557252
model parameter : 42955781
model size : 178.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps1499_str1499_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.2703304290771484
Epoch: 1, Steps: 8 | Train Loss: 1.517 Vali Loss: 1.546 Vali Acc: 0.420 Test Loss: 1.546 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 0.994802713394165
Epoch: 2, Steps: 8 | Train Loss: 1.322 Vali Loss: 1.524 Vali Acc: 0.427 Test Loss: 1.524 Test Acc: 0.427
Validation loss decreased (-0.419832 --> -0.427466).  Saving model ...
Epoch: 3 cost time: 1.0010218620300293
Epoch: 3, Steps: 8 | Train Loss: 1.017 Vali Loss: 1.527 Vali Acc: 0.450 Test Loss: 1.527 Test Acc: 0.450
Validation loss decreased (-0.427466 --> -0.450366).  Saving model ...
Epoch: 4 cost time: 1.131589651107788
Epoch: 4, Steps: 8 | Train Loss: 0.656 Vali Loss: 1.488 Vali Acc: 0.504 Test Loss: 1.488 Test Acc: 0.504
Validation loss decreased (-0.450366 --> -0.503802).  Saving model ...
Epoch: 5 cost time: 1.1230130195617676
Epoch: 5, Steps: 8 | Train Loss: 0.372 Vali Loss: 1.513 Vali Acc: 0.496 Test Loss: 1.513 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.145655870437622
Epoch: 6, Steps: 8 | Train Loss: 0.164 Vali Loss: 1.499 Vali Acc: 0.519 Test Loss: 1.499 Test Acc: 0.519
Validation loss decreased (-0.503802 --> -0.519069).  Saving model ...
Epoch: 7 cost time: 1.2326533794403076
Epoch: 7, Steps: 8 | Train Loss: 0.056 Vali Loss: 1.535 Vali Acc: 0.496 Test Loss: 1.535 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1383275985717773
Epoch: 8, Steps: 8 | Train Loss: 0.023 Vali Loss: 1.550 Vali Acc: 0.481 Test Loss: 1.550 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.2211651802062988
Epoch: 9, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.599 Vali Acc: 0.489 Test Loss: 1.599 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.377314805984497
Epoch: 10, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.673 Vali Acc: 0.489 Test Loss: 1.673 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.067636489868164
Epoch: 11, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.728 Vali Acc: 0.489 Test Loss: 1.728 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.4899859428405762
Epoch: 12, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.746 Vali Acc: 0.473 Test Loss: 1.746 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.4196147918701172
Epoch: 13, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.758 Vali Acc: 0.466 Test Loss: 1.758 Test Acc: 0.466
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.129760980606079
Epoch: 14, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.777 Vali Acc: 0.466 Test Loss: 1.777 Test Acc: 0.466
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.2113502025604248
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.794 Vali Acc: 0.466 Test Loss: 1.794 Test Acc: 0.466
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.152994155883789
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.807 Vali Acc: 0.466 Test Loss: 1.807 Test Acc: 0.466
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps1499_str1499_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 42896645
model size : 178.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps1635_str409_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.3265221118927
Epoch: 1, Steps: 8 | Train Loss: 1.573 Vali Loss: 1.612 Vali Acc: 0.420 Test Loss: 1.612 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 1.1266839504241943
Epoch: 2, Steps: 8 | Train Loss: 1.368 Vali Loss: 1.603 Vali Acc: 0.427 Test Loss: 1.603 Test Acc: 0.427
Validation loss decreased (-0.419831 --> -0.427465).  Saving model ...
Epoch: 3 cost time: 1.1593835353851318
Epoch: 3, Steps: 8 | Train Loss: 1.038 Vali Loss: 1.482 Vali Acc: 0.489 Test Loss: 1.482 Test Acc: 0.489
Validation loss decreased (-0.427465 --> -0.488535).  Saving model ...
Epoch: 4 cost time: 0.9834260940551758
Epoch: 4, Steps: 8 | Train Loss: 0.635 Vali Loss: 1.444 Vali Acc: 0.489 Test Loss: 1.444 Test Acc: 0.489
Validation loss decreased (-0.488535 --> -0.488535).  Saving model ...
Epoch: 5 cost time: 1.226496934890747
Epoch: 5, Steps: 8 | Train Loss: 0.342 Vali Loss: 1.371 Vali Acc: 0.511 Test Loss: 1.371 Test Acc: 0.511
Validation loss decreased (-0.488535 --> -0.511437).  Saving model ...
Epoch: 6 cost time: 1.1461975574493408
Epoch: 6, Steps: 8 | Train Loss: 0.128 Vali Loss: 1.252 Vali Acc: 0.511 Test Loss: 1.252 Test Acc: 0.511
Validation loss decreased (-0.511437 --> -0.511438).  Saving model ...
Epoch: 7 cost time: 1.237858772277832
Epoch: 7, Steps: 8 | Train Loss: 0.030 Vali Loss: 1.521 Vali Acc: 0.550 Test Loss: 1.521 Test Acc: 0.550
Validation loss decreased (-0.511438 --> -0.549603).  Saving model ...
Epoch: 8 cost time: 1.1413824558258057
Epoch: 8, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.636 Vali Acc: 0.550 Test Loss: 1.636 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.186737298965454
Epoch: 9, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.926 Vali Acc: 0.557 Test Loss: 1.926 Test Acc: 0.557
Validation loss decreased (-0.549603 --> -0.557233).  Saving model ...
Epoch: 10 cost time: 1.308030366897583
Epoch: 10, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.851 Vali Acc: 0.542 Test Loss: 1.851 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.331728219985962
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.788 Vali Acc: 0.542 Test Loss: 1.788 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.369410753250122
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.779 Vali Acc: 0.542 Test Loss: 1.779 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.3535854816436768
Epoch: 13, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.781 Vali Acc: 0.534 Test Loss: 1.781 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.0328853130340576
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.805 Vali Acc: 0.534 Test Loss: 1.805 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.141923427581787
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.838 Vali Acc: 0.534 Test Loss: 1.838 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.2846462726593018
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.853 Vali Acc: 0.542 Test Loss: 1.853 Test Acc: 0.542
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.441399097442627
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.855 Vali Acc: 0.534 Test Loss: 1.855 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.1260194778442383
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.860 Vali Acc: 0.534 Test Loss: 1.860 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.3128738403320312
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.860 Vali Acc: 0.534 Test Loss: 1.860 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps1635_str409_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 44932613
model size : 186.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps1635_str818_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.2573375701904297
Epoch: 1, Steps: 8 | Train Loss: 1.510 Vali Loss: 1.640 Vali Acc: 0.420 Test Loss: 1.640 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 1.2905616760253906
Epoch: 2, Steps: 8 | Train Loss: 1.347 Vali Loss: 1.521 Vali Acc: 0.427 Test Loss: 1.521 Test Acc: 0.427
Validation loss decreased (-0.419831 --> -0.427466).  Saving model ...
Epoch: 3 cost time: 1.2673108577728271
Epoch: 3, Steps: 8 | Train Loss: 0.992 Vali Loss: 1.491 Vali Acc: 0.511 Test Loss: 1.491 Test Acc: 0.511
Validation loss decreased (-0.427466 --> -0.511435).  Saving model ...
Epoch: 4 cost time: 1.202676773071289
Epoch: 4, Steps: 8 | Train Loss: 0.640 Vali Loss: 1.454 Vali Acc: 0.527 Test Loss: 1.454 Test Acc: 0.527
Validation loss decreased (-0.511435 --> -0.526703).  Saving model ...
Epoch: 5 cost time: 1.1829197406768799
Epoch: 5, Steps: 8 | Train Loss: 0.321 Vali Loss: 1.375 Vali Acc: 0.519 Test Loss: 1.375 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9958970546722412
Epoch: 6, Steps: 8 | Train Loss: 0.131 Vali Loss: 1.481 Vali Acc: 0.550 Test Loss: 1.481 Test Acc: 0.550
Validation loss decreased (-0.526703 --> -0.549604).  Saving model ...
Epoch: 7 cost time: 1.2781784534454346
Epoch: 7, Steps: 8 | Train Loss: 0.038 Vali Loss: 1.603 Vali Acc: 0.527 Test Loss: 1.603 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1326327323913574
Epoch: 8, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.620 Vali Acc: 0.527 Test Loss: 1.620 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.052323818206787
Epoch: 9, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.600 Vali Acc: 0.534 Test Loss: 1.600 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.1153254508972168
Epoch: 10, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.631 Vali Acc: 0.534 Test Loss: 1.631 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.1521339416503906
Epoch: 11, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.697 Vali Acc: 0.542 Test Loss: 1.697 Test Acc: 0.542
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.1526925563812256
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.736 Vali Acc: 0.542 Test Loss: 1.736 Test Acc: 0.542
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.100125789642334
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.757 Vali Acc: 0.534 Test Loss: 1.757 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.306342601776123
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.768 Vali Acc: 0.542 Test Loss: 1.768 Test Acc: 0.542
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.9638638496398926
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.777 Vali Acc: 0.542 Test Loss: 1.777 Test Acc: 0.542
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.1024458408355713
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.777 Vali Acc: 0.542 Test Loss: 1.777 Test Acc: 0.542
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps1635_str818_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 44825093
model size : 185.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps1635_str1635_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.311548948287964
Epoch: 1, Steps: 8 | Train Loss: 1.592 Vali Loss: 1.571 Vali Acc: 0.420 Test Loss: 1.571 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 0.9872100353240967
Epoch: 2, Steps: 8 | Train Loss: 1.347 Vali Loss: 1.487 Vali Acc: 0.435 Test Loss: 1.487 Test Acc: 0.435
Validation loss decreased (-0.419832 --> -0.435100).  Saving model ...
Epoch: 3 cost time: 1.1682190895080566
Epoch: 3, Steps: 8 | Train Loss: 1.011 Vali Loss: 1.417 Vali Acc: 0.489 Test Loss: 1.417 Test Acc: 0.489
Validation loss decreased (-0.435100 --> -0.488535).  Saving model ...
Epoch: 4 cost time: 1.259774923324585
Epoch: 4, Steps: 8 | Train Loss: 0.689 Vali Loss: 1.365 Vali Acc: 0.534 Test Loss: 1.365 Test Acc: 0.534
Validation loss decreased (-0.488535 --> -0.534337).  Saving model ...
Epoch: 5 cost time: 1.3006417751312256
Epoch: 5, Steps: 8 | Train Loss: 0.376 Vali Loss: 1.445 Vali Acc: 0.519 Test Loss: 1.445 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2571372985839844
Epoch: 6, Steps: 8 | Train Loss: 0.162 Vali Loss: 1.485 Vali Acc: 0.466 Test Loss: 1.485 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1188151836395264
Epoch: 7, Steps: 8 | Train Loss: 0.062 Vali Loss: 1.607 Vali Acc: 0.496 Test Loss: 1.607 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.152116298675537
Epoch: 8, Steps: 8 | Train Loss: 0.025 Vali Loss: 1.761 Vali Acc: 0.511 Test Loss: 1.761 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.214857816696167
Epoch: 9, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.793 Vali Acc: 0.473 Test Loss: 1.793 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.9364027976989746
Epoch: 10, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.767 Vali Acc: 0.466 Test Loss: 1.767 Test Acc: 0.466
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.2726197242736816
Epoch: 11, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.796 Vali Acc: 0.473 Test Loss: 1.796 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.2687652111053467
Epoch: 12, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.842 Vali Acc: 0.481 Test Loss: 1.842 Test Acc: 0.481
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.1288232803344727
Epoch: 13, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.891 Vali Acc: 0.481 Test Loss: 1.891 Test Acc: 0.481
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.260979413986206
Epoch: 14, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.925 Vali Acc: 0.481 Test Loss: 1.925 Test Acc: 0.481
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps1635_str1635_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 44771333
model size : 185.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps1799_str450_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.565586805343628
Epoch: 1, Steps: 8 | Train Loss: 1.564 Vali Loss: 1.612 Vali Acc: 0.420 Test Loss: 1.612 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 1.2328460216522217
Epoch: 2, Steps: 8 | Train Loss: 1.347 Vali Loss: 1.503 Vali Acc: 0.466 Test Loss: 1.503 Test Acc: 0.466
Validation loss decreased (-0.419831 --> -0.465634).  Saving model ...
Epoch: 3 cost time: 1.1942296028137207
Epoch: 3, Steps: 8 | Train Loss: 0.986 Vali Loss: 1.422 Vali Acc: 0.496 Test Loss: 1.422 Test Acc: 0.496
Validation loss decreased (-0.465634 --> -0.496169).  Saving model ...
Epoch: 4 cost time: 1.1852130889892578
Epoch: 4, Steps: 8 | Train Loss: 0.590 Vali Loss: 1.378 Vali Acc: 0.504 Test Loss: 1.378 Test Acc: 0.504
Validation loss decreased (-0.496169 --> -0.503803).  Saving model ...
Epoch: 5 cost time: 1.153588056564331
Epoch: 5, Steps: 8 | Train Loss: 0.256 Vali Loss: 1.402 Vali Acc: 0.511 Test Loss: 1.402 Test Acc: 0.511
Validation loss decreased (-0.503803 --> -0.511436).  Saving model ...
Epoch: 6 cost time: 1.207444190979004
Epoch: 6, Steps: 8 | Train Loss: 0.070 Vali Loss: 1.381 Vali Acc: 0.511 Test Loss: 1.381 Test Acc: 0.511
Validation loss decreased (-0.511436 --> -0.511437).  Saving model ...
Epoch: 7 cost time: 1.2077984809875488
Epoch: 7, Steps: 8 | Train Loss: 0.022 Vali Loss: 1.546 Vali Acc: 0.511 Test Loss: 1.546 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1484816074371338
Epoch: 8, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.527 Vali Acc: 0.534 Test Loss: 1.527 Test Acc: 0.534
Validation loss decreased (-0.511437 --> -0.534336).  Saving model ...
Epoch: 9 cost time: 1.2207911014556885
Epoch: 9, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.495 Vali Acc: 0.527 Test Loss: 1.495 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8815281391143799
Epoch: 10, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.550 Vali Acc: 0.527 Test Loss: 1.550 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.231370210647583
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.583 Vali Acc: 0.534 Test Loss: 1.583 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.1760406494140625
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.596 Vali Acc: 0.534 Test Loss: 1.596 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.0975737571716309
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.594 Vali Acc: 0.534 Test Loss: 1.594 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.1730694770812988
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.596 Vali Acc: 0.534 Test Loss: 1.596 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.2015063762664795
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.596 Vali Acc: 0.542 Test Loss: 1.596 Test Acc: 0.542
Validation loss decreased (-0.534336 --> -0.541969).  Saving model ...
Epoch: 16 cost time: 1.1059105396270752
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.598 Vali Acc: 0.534 Test Loss: 1.598 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2219669818878174
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.607 Vali Acc: 0.534 Test Loss: 1.607 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.147195816040039
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.625 Vali Acc: 0.542 Test Loss: 1.625 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.1638836860656738
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.632 Vali Acc: 0.542 Test Loss: 1.632 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.135448694229126
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.640 Vali Acc: 0.542 Test Loss: 1.640 Test Acc: 0.542
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.25323486328125
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.647 Vali Acc: 0.542 Test Loss: 1.647 Test Acc: 0.542
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.4164297580718994
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.644 Vali Acc: 0.542 Test Loss: 1.644 Test Acc: 0.542
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.9830183982849121
Epoch: 23, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.651 Vali Acc: 0.542 Test Loss: 1.651 Test Acc: 0.542
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.2273995876312256
Epoch: 24, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.659 Vali Acc: 0.542 Test Loss: 1.659 Test Acc: 0.542
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.2111401557922363
Epoch: 25, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.661 Vali Acc: 0.542 Test Loss: 1.661 Test Acc: 0.542
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps1799_str450_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 47178245
model size : 194.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps1799_str900_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 1.9728977680206299
Epoch: 1, Steps: 8 | Train Loss: 1.631 Vali Loss: 1.564 Vali Acc: 0.427 Test Loss: 1.564 Test Acc: 0.427
Validation loss decreased (inf --> -0.427465).  Saving model ...
Epoch: 2 cost time: 0.8841147422790527
Epoch: 2, Steps: 8 | Train Loss: 1.341 Vali Loss: 1.530 Vali Acc: 0.427 Test Loss: 1.530 Test Acc: 0.427
Validation loss decreased (-0.427465 --> -0.427466).  Saving model ...
Epoch: 3 cost time: 1.1188678741455078
Epoch: 3, Steps: 8 | Train Loss: 1.005 Vali Loss: 1.418 Vali Acc: 0.519 Test Loss: 1.418 Test Acc: 0.519
Validation loss decreased (-0.427466 --> -0.519070).  Saving model ...
Epoch: 4 cost time: 1.0679733753204346
Epoch: 4, Steps: 8 | Train Loss: 0.610 Vali Loss: 1.373 Vali Acc: 0.542 Test Loss: 1.373 Test Acc: 0.542
Validation loss decreased (-0.519070 --> -0.541971).  Saving model ...
Epoch: 5 cost time: 1.0618059635162354
Epoch: 5, Steps: 8 | Train Loss: 0.302 Vali Loss: 1.405 Vali Acc: 0.565 Test Loss: 1.405 Test Acc: 0.565
Validation loss decreased (-0.541971 --> -0.564871).  Saving model ...
Epoch: 6 cost time: 1.091454029083252
Epoch: 6, Steps: 8 | Train Loss: 0.114 Vali Loss: 1.509 Vali Acc: 0.511 Test Loss: 1.509 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0941829681396484
Epoch: 7, Steps: 8 | Train Loss: 0.031 Vali Loss: 1.550 Vali Acc: 0.504 Test Loss: 1.550 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.0476233959197998
Epoch: 8, Steps: 8 | Train Loss: 0.011 Vali Loss: 1.602 Vali Acc: 0.511 Test Loss: 1.602 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.0823853015899658
Epoch: 9, Steps: 8 | Train Loss: 0.006 Vali Loss: 1.681 Vali Acc: 0.527 Test Loss: 1.681 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.908797025680542
Epoch: 10, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.728 Vali Acc: 0.527 Test Loss: 1.728 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.8887672424316406
Epoch: 11, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.761 Vali Acc: 0.542 Test Loss: 1.761 Test Acc: 0.542
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.044726848602295
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.770 Vali Acc: 0.550 Test Loss: 1.770 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.0704107284545898
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.779 Vali Acc: 0.542 Test Loss: 1.779 Test Acc: 0.542
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.0327534675598145
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.786 Vali Acc: 0.542 Test Loss: 1.786 Test Acc: 0.542
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.0443105697631836
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.795 Vali Acc: 0.542 Test Loss: 1.795 Test Acc: 0.542
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps1799_str900_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5648854961832062
model parameter : 47081477
model size : 194.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps1799_str1799_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.3652732372283936
Epoch: 1, Steps: 8 | Train Loss: 1.554 Vali Loss: 1.553 Vali Acc: 0.420 Test Loss: 1.553 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 0.9105253219604492
Epoch: 2, Steps: 8 | Train Loss: 1.326 Vali Loss: 1.550 Vali Acc: 0.420 Test Loss: 1.550 Test Acc: 0.420
Validation loss decreased (-0.419832 --> -0.419832).  Saving model ...
Epoch: 3 cost time: 1.141894817352295
Epoch: 3, Steps: 8 | Train Loss: 0.998 Vali Loss: 1.493 Vali Acc: 0.496 Test Loss: 1.493 Test Acc: 0.496
Validation loss decreased (-0.419832 --> -0.496168).  Saving model ...
Epoch: 4 cost time: 1.3225760459899902
Epoch: 4, Steps: 8 | Train Loss: 0.645 Vali Loss: 1.465 Vali Acc: 0.473 Test Loss: 1.465 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0345089435577393
Epoch: 5, Steps: 8 | Train Loss: 0.301 Vali Loss: 1.503 Vali Acc: 0.527 Test Loss: 1.503 Test Acc: 0.527
Validation loss decreased (-0.496168 --> -0.526703).  Saving model ...
Epoch: 6 cost time: 1.1666674613952637
Epoch: 6, Steps: 8 | Train Loss: 0.117 Vali Loss: 1.587 Vali Acc: 0.519 Test Loss: 1.587 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1751153469085693
Epoch: 7, Steps: 8 | Train Loss: 0.041 Vali Loss: 1.651 Vali Acc: 0.519 Test Loss: 1.651 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1334071159362793
Epoch: 8, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.710 Vali Acc: 0.542 Test Loss: 1.710 Test Acc: 0.542
Validation loss decreased (-0.526703 --> -0.541968).  Saving model ...
Epoch: 9 cost time: 1.1767933368682861
Epoch: 9, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.741 Vali Acc: 0.534 Test Loss: 1.741 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2864556312561035
Epoch: 10, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.768 Vali Acc: 0.519 Test Loss: 1.768 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.3288562297821045
Epoch: 11, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.787 Vali Acc: 0.519 Test Loss: 1.787 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.8953845500946045
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.803 Vali Acc: 0.519 Test Loss: 1.803 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.0426292419433594
Epoch: 13, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.820 Vali Acc: 0.527 Test Loss: 1.820 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.1255931854248047
Epoch: 14, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.826 Vali Acc: 0.527 Test Loss: 1.826 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.0020132064819336
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.828 Vali Acc: 0.527 Test Loss: 1.828 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.1949594020843506
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.831 Vali Acc: 0.527 Test Loss: 1.831 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.120340347290039
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.832 Vali Acc: 0.527 Test Loss: 1.832 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.1899948120117188
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.836 Vali Acc: 0.527 Test Loss: 1.836 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps1799_str1799_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 47033093
model size : 194.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps1999_str500_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.36037278175354
Epoch: 1, Steps: 8 | Train Loss: 1.609 Vali Loss: 1.560 Vali Acc: 0.420 Test Loss: 1.560 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 1.4001030921936035
Epoch: 2, Steps: 8 | Train Loss: 1.270 Vali Loss: 1.464 Vali Acc: 0.481 Test Loss: 1.464 Test Acc: 0.481
Validation loss decreased (-0.419832 --> -0.480901).  Saving model ...
Epoch: 3 cost time: 0.9811856746673584
Epoch: 3, Steps: 8 | Train Loss: 0.908 Vali Loss: 1.294 Vali Acc: 0.588 Test Loss: 1.294 Test Acc: 0.588
Validation loss decreased (-0.480901 --> -0.587773).  Saving model ...
Epoch: 4 cost time: 1.2333083152770996
Epoch: 4, Steps: 8 | Train Loss: 0.497 Vali Loss: 1.317 Vali Acc: 0.542 Test Loss: 1.317 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1862950325012207
Epoch: 5, Steps: 8 | Train Loss: 0.208 Vali Loss: 1.285 Vali Acc: 0.542 Test Loss: 1.285 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1135332584381104
Epoch: 6, Steps: 8 | Train Loss: 0.074 Vali Loss: 1.427 Vali Acc: 0.542 Test Loss: 1.427 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.9752333164215088
Epoch: 7, Steps: 8 | Train Loss: 0.020 Vali Loss: 1.472 Vali Acc: 0.573 Test Loss: 1.472 Test Acc: 0.573
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.3250582218170166
Epoch: 8, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.460 Vali Acc: 0.580 Test Loss: 1.460 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.2935209274291992
Epoch: 9, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.494 Vali Acc: 0.580 Test Loss: 1.494 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.1967029571533203
Epoch: 10, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.539 Vali Acc: 0.588 Test Loss: 1.539 Test Acc: 0.588
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.2223091125488281
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.585 Vali Acc: 0.580 Test Loss: 1.585 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.2106943130493164
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.613 Vali Acc: 0.580 Test Loss: 1.613 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.283487319946289
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.630 Vali Acc: 0.573 Test Loss: 1.630 Test Acc: 0.573
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps1999_str500_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5877862595419847
model parameter : 49921541
model size : 205.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps1999_str1000_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.498173236846924
Epoch: 1, Steps: 8 | Train Loss: 1.608 Vali Loss: 1.549 Vali Acc: 0.420 Test Loss: 1.549 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 1.1251401901245117
Epoch: 2, Steps: 8 | Train Loss: 1.331 Vali Loss: 1.517 Vali Acc: 0.443 Test Loss: 1.517 Test Acc: 0.443
Validation loss decreased (-0.419832 --> -0.442733).  Saving model ...
Epoch: 3 cost time: 1.1717491149902344
Epoch: 3, Steps: 8 | Train Loss: 0.877 Vali Loss: 1.410 Vali Acc: 0.511 Test Loss: 1.410 Test Acc: 0.511
Validation loss decreased (-0.442733 --> -0.511436).  Saving model ...
Epoch: 4 cost time: 1.0956788063049316
Epoch: 4, Steps: 8 | Train Loss: 0.523 Vali Loss: 1.361 Vali Acc: 0.527 Test Loss: 1.361 Test Acc: 0.527
Validation loss decreased (-0.511436 --> -0.526704).  Saving model ...
Epoch: 5 cost time: 1.168001413345337
Epoch: 5, Steps: 8 | Train Loss: 0.233 Vali Loss: 1.390 Vali Acc: 0.496 Test Loss: 1.390 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.264068365097046
Epoch: 6, Steps: 8 | Train Loss: 0.093 Vali Loss: 1.462 Vali Acc: 0.542 Test Loss: 1.462 Test Acc: 0.542
Validation loss decreased (-0.526704 --> -0.541970).  Saving model ...
Epoch: 7 cost time: 1.447126865386963
Epoch: 7, Steps: 8 | Train Loss: 0.030 Vali Loss: 1.461 Vali Acc: 0.511 Test Loss: 1.461 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1756196022033691
Epoch: 8, Steps: 8 | Train Loss: 0.012 Vali Loss: 1.524 Vali Acc: 0.504 Test Loss: 1.524 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1390161514282227
Epoch: 9, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.681 Vali Acc: 0.550 Test Loss: 1.681 Test Acc: 0.550
Validation loss decreased (-0.541970 --> -0.549602).  Saving model ...
Epoch: 10 cost time: 1.4890973567962646
Epoch: 10, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.717 Vali Acc: 0.534 Test Loss: 1.717 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2023003101348877
Epoch: 11, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.696 Vali Acc: 0.534 Test Loss: 1.696 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.3240540027618408
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.666 Vali Acc: 0.542 Test Loss: 1.666 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.1204314231872559
Epoch: 13, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.647 Vali Acc: 0.534 Test Loss: 1.647 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.487743854522705
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.651 Vali Acc: 0.534 Test Loss: 1.651 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.0029067993164062
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.658 Vali Acc: 0.527 Test Loss: 1.658 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.1990673542022705
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.664 Vali Acc: 0.527 Test Loss: 1.664 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.2624366283416748
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.676 Vali Acc: 0.527 Test Loss: 1.676 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.050896167755127
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.684 Vali Acc: 0.527 Test Loss: 1.684 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.0669360160827637
Epoch: 19, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.689 Vali Acc: 0.527 Test Loss: 1.689 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps1999_str1000_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 49835525
model size : 204.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps1999_str1999_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.6909821033477783
Epoch: 1, Steps: 8 | Train Loss: 1.527 Vali Loss: 1.550 Vali Acc: 0.420 Test Loss: 1.550 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 1.6339082717895508
Epoch: 2, Steps: 8 | Train Loss: 1.306 Vali Loss: 1.519 Vali Acc: 0.466 Test Loss: 1.519 Test Acc: 0.466
Validation loss decreased (-0.419832 --> -0.465634).  Saving model ...
Epoch: 3 cost time: 1.5566964149475098
Epoch: 3, Steps: 8 | Train Loss: 0.971 Vali Loss: 1.507 Vali Acc: 0.473 Test Loss: 1.507 Test Acc: 0.473
Validation loss decreased (-0.465634 --> -0.473267).  Saving model ...
Epoch: 4 cost time: 1.293792724609375
Epoch: 4, Steps: 8 | Train Loss: 0.602 Vali Loss: 1.534 Vali Acc: 0.496 Test Loss: 1.534 Test Acc: 0.496
Validation loss decreased (-0.473267 --> -0.496168).  Saving model ...
Epoch: 5 cost time: 1.0219600200653076
Epoch: 5, Steps: 8 | Train Loss: 0.270 Vali Loss: 1.532 Vali Acc: 0.504 Test Loss: 1.532 Test Acc: 0.504
Validation loss decreased (-0.496168 --> -0.503801).  Saving model ...
Epoch: 6 cost time: 1.3047995567321777
Epoch: 6, Steps: 8 | Train Loss: 0.112 Vali Loss: 1.594 Vali Acc: 0.481 Test Loss: 1.594 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3143234252929688
Epoch: 7, Steps: 8 | Train Loss: 0.039 Vali Loss: 1.703 Vali Acc: 0.496 Test Loss: 1.703 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2599353790283203
Epoch: 8, Steps: 8 | Train Loss: 0.016 Vali Loss: 1.747 Vali Acc: 0.504 Test Loss: 1.747 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.2847950458526611
Epoch: 9, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.765 Vali Acc: 0.511 Test Loss: 1.765 Test Acc: 0.511
Validation loss decreased (-0.503801 --> -0.511433).  Saving model ...
Epoch: 10 cost time: 1.0300872325897217
Epoch: 10, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.785 Vali Acc: 0.511 Test Loss: 1.785 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.327289342880249
Epoch: 11, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.809 Vali Acc: 0.504 Test Loss: 1.809 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.2930831909179688
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.830 Vali Acc: 0.504 Test Loss: 1.830 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.5151546001434326
Epoch: 13, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.853 Vali Acc: 0.511 Test Loss: 1.853 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.0942401885986328
Epoch: 14, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.874 Vali Acc: 0.511 Test Loss: 1.874 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.4206039905548096
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.889 Vali Acc: 0.511 Test Loss: 1.889 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.0643563270568848
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.903 Vali Acc: 0.511 Test Loss: 1.903 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.2939033508300781
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.916 Vali Acc: 0.511 Test Loss: 1.916 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.0773215293884277
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.925 Vali Acc: 0.511 Test Loss: 1.925 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.0089473724365234
Epoch: 19, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.938 Vali Acc: 0.511 Test Loss: 1.938 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps1999_str1999_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5114503816793893
model parameter : 49792517
model size : 204.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps2248_str562_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.669015407562256
Epoch: 1, Steps: 8 | Train Loss: 1.571 Vali Loss: 1.631 Vali Acc: 0.420 Test Loss: 1.631 Test Acc: 0.420
Validation loss decreased (inf --> -0.419831).  Saving model ...
Epoch: 2 cost time: 1.4201297760009766
Epoch: 2, Steps: 8 | Train Loss: 1.269 Vali Loss: 1.505 Vali Acc: 0.527 Test Loss: 1.505 Test Acc: 0.527
Validation loss decreased (-0.419831 --> -0.526703).  Saving model ...
Epoch: 3 cost time: 1.3201422691345215
Epoch: 3, Steps: 8 | Train Loss: 0.841 Vali Loss: 1.412 Vali Acc: 0.527 Test Loss: 1.412 Test Acc: 0.527
Validation loss decreased (-0.526703 --> -0.526703).  Saving model ...
Epoch: 4 cost time: 0.9851648807525635
Epoch: 4, Steps: 8 | Train Loss: 0.482 Vali Loss: 1.389 Vali Acc: 0.511 Test Loss: 1.389 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1205315589904785
Epoch: 5, Steps: 8 | Train Loss: 0.190 Vali Loss: 1.395 Vali Acc: 0.511 Test Loss: 1.395 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9416110515594482
Epoch: 6, Steps: 8 | Train Loss: 0.049 Vali Loss: 1.603 Vali Acc: 0.542 Test Loss: 1.603 Test Acc: 0.542
Validation loss decreased (-0.526703 --> -0.541969).  Saving model ...
Epoch: 7 cost time: 1.1935343742370605
Epoch: 7, Steps: 8 | Train Loss: 0.014 Vali Loss: 1.632 Vali Acc: 0.519 Test Loss: 1.632 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1989262104034424
Epoch: 8, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.562 Vali Acc: 0.504 Test Loss: 1.562 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1936678886413574
Epoch: 9, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.619 Vali Acc: 0.489 Test Loss: 1.619 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.338721513748169
Epoch: 10, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.716 Vali Acc: 0.557 Test Loss: 1.716 Test Acc: 0.557
Validation loss decreased (-0.541969 --> -0.557235).  Saving model ...
Epoch: 11 cost time: 1.1351385116577148
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.789 Vali Acc: 0.550 Test Loss: 1.789 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2450201511383057
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.797 Vali Acc: 0.550 Test Loss: 1.797 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.0572590827941895
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.799 Vali Acc: 0.557 Test Loss: 1.799 Test Acc: 0.557
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.1336429119110107
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.810 Vali Acc: 0.550 Test Loss: 1.810 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.3762085437774658
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.818 Vali Acc: 0.534 Test Loss: 1.818 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.14732027053833
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.825 Vali Acc: 0.534 Test Loss: 1.825 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.0932528972625732
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.821 Vali Acc: 0.511 Test Loss: 1.821 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.2038872241973877
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.829 Vali Acc: 0.511 Test Loss: 1.829 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.1330699920654297
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.834 Vali Acc: 0.519 Test Loss: 1.834 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.414736270904541
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.841 Vali Acc: 0.519 Test Loss: 1.841 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps2248_str562_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 53347589
model size : 218.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps2248_str1124_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.407118082046509
Epoch: 1, Steps: 8 | Train Loss: 1.529 Vali Loss: 1.573 Vali Acc: 0.420 Test Loss: 1.573 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 1.2188339233398438
Epoch: 2, Steps: 8 | Train Loss: 1.277 Vali Loss: 1.484 Vali Acc: 0.466 Test Loss: 1.484 Test Acc: 0.466
Validation loss decreased (-0.419832 --> -0.465634).  Saving model ...
Epoch: 3 cost time: 1.4734303951263428
Epoch: 3, Steps: 8 | Train Loss: 0.911 Vali Loss: 1.516 Vali Acc: 0.458 Test Loss: 1.516 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4136550426483154
Epoch: 4, Steps: 8 | Train Loss: 0.504 Vali Loss: 1.505 Vali Acc: 0.443 Test Loss: 1.505 Test Acc: 0.443
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.355834722518921
Epoch: 5, Steps: 8 | Train Loss: 0.237 Vali Loss: 1.576 Vali Acc: 0.473 Test Loss: 1.576 Test Acc: 0.473
Validation loss decreased (-0.465634 --> -0.473267).  Saving model ...
Epoch: 6 cost time: 1.2844488620758057
Epoch: 6, Steps: 8 | Train Loss: 0.093 Vali Loss: 1.646 Vali Acc: 0.511 Test Loss: 1.646 Test Acc: 0.511
Validation loss decreased (-0.473267 --> -0.511434).  Saving model ...
Epoch: 7 cost time: 1.215466022491455
Epoch: 7, Steps: 8 | Train Loss: 0.024 Vali Loss: 1.700 Vali Acc: 0.489 Test Loss: 1.700 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2296030521392822
Epoch: 8, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.750 Vali Acc: 0.473 Test Loss: 1.750 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1692490577697754
Epoch: 9, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.826 Vali Acc: 0.527 Test Loss: 1.826 Test Acc: 0.527
Validation loss decreased (-0.511434 --> -0.526699).  Saving model ...
Epoch: 10 cost time: 1.1363551616668701
Epoch: 10, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.878 Vali Acc: 0.527 Test Loss: 1.878 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0941941738128662
Epoch: 11, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.910 Vali Acc: 0.527 Test Loss: 1.910 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1511144638061523
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.926 Vali Acc: 0.519 Test Loss: 1.926 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.101705551147461
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.943 Vali Acc: 0.519 Test Loss: 1.943 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.1355926990509033
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.952 Vali Acc: 0.519 Test Loss: 1.952 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.1800472736358643
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.963 Vali Acc: 0.519 Test Loss: 1.963 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.1067280769348145
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.975 Vali Acc: 0.519 Test Loss: 1.975 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.3562743663787842
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.985 Vali Acc: 0.527 Test Loss: 1.985 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.1346752643585205
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.990 Vali Acc: 0.534 Test Loss: 1.990 Test Acc: 0.534
Validation loss decreased (-0.526699 --> -0.534331).  Saving model ...
Epoch: 19 cost time: 1.1765270233154297
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.996 Vali Acc: 0.534 Test Loss: 1.996 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1816389560699463
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.002 Vali Acc: 0.534 Test Loss: 2.002 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.20564866065979
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.016 Vali Acc: 0.534 Test Loss: 2.016 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.1498527526855469
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.029 Vali Acc: 0.534 Test Loss: 2.029 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.1393237113952637
Epoch: 23, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.040 Vali Acc: 0.534 Test Loss: 2.040 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.2211637496948242
Epoch: 24, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.050 Vali Acc: 0.527 Test Loss: 2.050 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.136594533920288
Epoch: 25, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.056 Vali Acc: 0.527 Test Loss: 2.056 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.1608123779296875
Epoch: 26, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.062 Vali Acc: 0.527 Test Loss: 2.062 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.3029770851135254
Epoch: 27, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.069 Vali Acc: 0.527 Test Loss: 2.069 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.3643882274627686
Epoch: 28, Steps: 8 | Train Loss: 0.000 Vali Loss: 2.076 Vali Acc: 0.527 Test Loss: 2.076 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps2248_str1124_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 53272325
model size : 217.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps2248_str2248_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.6622846126556396
Epoch: 1, Steps: 8 | Train Loss: 1.511 Vali Loss: 1.508 Vali Acc: 0.420 Test Loss: 1.508 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 1.1684019565582275
Epoch: 2, Steps: 8 | Train Loss: 1.242 Vali Loss: 1.487 Vali Acc: 0.443 Test Loss: 1.487 Test Acc: 0.443
Validation loss decreased (-0.419832 --> -0.442733).  Saving model ...
Epoch: 3 cost time: 1.171257734298706
Epoch: 3, Steps: 8 | Train Loss: 0.863 Vali Loss: 1.491 Vali Acc: 0.496 Test Loss: 1.491 Test Acc: 0.496
Validation loss decreased (-0.442733 --> -0.496168).  Saving model ...
Epoch: 4 cost time: 1.265559196472168
Epoch: 4, Steps: 8 | Train Loss: 0.502 Vali Loss: 1.548 Vali Acc: 0.511 Test Loss: 1.548 Test Acc: 0.511
Validation loss decreased (-0.496168 --> -0.511435).  Saving model ...
Epoch: 5 cost time: 1.2454571723937988
Epoch: 5, Steps: 8 | Train Loss: 0.246 Vali Loss: 1.576 Vali Acc: 0.504 Test Loss: 1.576 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.063633918762207
Epoch: 6, Steps: 8 | Train Loss: 0.093 Vali Loss: 1.633 Vali Acc: 0.511 Test Loss: 1.633 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.2372510433197021
Epoch: 7, Steps: 8 | Train Loss: 0.033 Vali Loss: 1.700 Vali Acc: 0.489 Test Loss: 1.700 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.3798727989196777
Epoch: 8, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.783 Vali Acc: 0.473 Test Loss: 1.783 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.2771365642547607
Epoch: 9, Steps: 8 | Train Loss: 0.008 Vali Loss: 1.889 Vali Acc: 0.466 Test Loss: 1.889 Test Acc: 0.466
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.1002366542816162
Epoch: 10, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.963 Vali Acc: 0.473 Test Loss: 1.963 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.37880539894104
Epoch: 11, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.995 Vali Acc: 0.481 Test Loss: 1.995 Test Acc: 0.481
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.274629831314087
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 2.016 Vali Acc: 0.481 Test Loss: 2.016 Test Acc: 0.481
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.162935495376587
Epoch: 13, Steps: 8 | Train Loss: 0.002 Vali Loss: 2.035 Vali Acc: 0.481 Test Loss: 2.035 Test Acc: 0.481
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.1194491386413574
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.051 Vali Acc: 0.489 Test Loss: 2.051 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps2248_str2248_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5114503816793893
model parameter : 53234693
model size : 217.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps2570_str643_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.4219810962677
Epoch: 1, Steps: 8 | Train Loss: 1.503 Vali Loss: 1.550 Vali Acc: 0.420 Test Loss: 1.550 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 1.4405405521392822
Epoch: 2, Steps: 8 | Train Loss: 1.177 Vali Loss: 1.435 Vali Acc: 0.473 Test Loss: 1.435 Test Acc: 0.473
Validation loss decreased (-0.419832 --> -0.473268).  Saving model ...
Epoch: 3 cost time: 1.3837907314300537
Epoch: 3, Steps: 8 | Train Loss: 0.776 Vali Loss: 1.370 Vali Acc: 0.527 Test Loss: 1.370 Test Acc: 0.527
Validation loss decreased (-0.473268 --> -0.526704).  Saving model ...
Epoch: 4 cost time: 1.6127030849456787
Epoch: 4, Steps: 8 | Train Loss: 0.372 Vali Loss: 1.323 Vali Acc: 0.557 Test Loss: 1.323 Test Acc: 0.557
Validation loss decreased (-0.526704 --> -0.557239).  Saving model ...
Epoch: 5 cost time: 1.4427742958068848
Epoch: 5, Steps: 8 | Train Loss: 0.159 Vali Loss: 1.463 Vali Acc: 0.542 Test Loss: 1.463 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.598771333694458
Epoch: 6, Steps: 8 | Train Loss: 0.039 Vali Loss: 1.514 Vali Acc: 0.481 Test Loss: 1.514 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.6795306205749512
Epoch: 7, Steps: 8 | Train Loss: 0.013 Vali Loss: 1.552 Vali Acc: 0.489 Test Loss: 1.552 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.4894325733184814
Epoch: 8, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.583 Vali Acc: 0.519 Test Loss: 1.583 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.3443970680236816
Epoch: 9, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.612 Vali Acc: 0.511 Test Loss: 1.612 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.3809823989868164
Epoch: 10, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.608 Vali Acc: 0.504 Test Loss: 1.608 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.199843168258667
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.609 Vali Acc: 0.504 Test Loss: 1.609 Test Acc: 0.504
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.4233665466308594
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.617 Vali Acc: 0.519 Test Loss: 1.617 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.4548580646514893
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.630 Vali Acc: 0.519 Test Loss: 1.630 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.4072229862213135
Epoch: 14, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.646 Vali Acc: 0.519 Test Loss: 1.646 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps2570_str643_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 57772037
model size : 235.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps2570_str1285_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.2230653762817383
Epoch: 1, Steps: 8 | Train Loss: 1.544 Vali Loss: 1.525 Vali Acc: 0.420 Test Loss: 1.525 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 1.4929096698760986
Epoch: 2, Steps: 8 | Train Loss: 1.249 Vali Loss: 1.485 Vali Acc: 0.443 Test Loss: 1.485 Test Acc: 0.443
Validation loss decreased (-0.419832 --> -0.442733).  Saving model ...
Epoch: 3 cost time: 1.7433445453643799
Epoch: 3, Steps: 8 | Train Loss: 0.854 Vali Loss: 1.417 Vali Acc: 0.511 Test Loss: 1.417 Test Acc: 0.511
Validation loss decreased (-0.442733 --> -0.511436).  Saving model ...
Epoch: 4 cost time: 1.5688097476959229
Epoch: 4, Steps: 8 | Train Loss: 0.474 Vali Loss: 1.418 Vali Acc: 0.527 Test Loss: 1.418 Test Acc: 0.527
Validation loss decreased (-0.511436 --> -0.526703).  Saving model ...
Epoch: 5 cost time: 1.5269205570220947
Epoch: 5, Steps: 8 | Train Loss: 0.184 Vali Loss: 1.384 Vali Acc: 0.496 Test Loss: 1.384 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5361967086791992
Epoch: 6, Steps: 8 | Train Loss: 0.062 Vali Loss: 1.513 Vali Acc: 0.496 Test Loss: 1.513 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.4067707061767578
Epoch: 7, Steps: 8 | Train Loss: 0.017 Vali Loss: 1.512 Vali Acc: 0.519 Test Loss: 1.512 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.4843921661376953
Epoch: 8, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.549 Vali Acc: 0.504 Test Loss: 1.549 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.6553137302398682
Epoch: 9, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.591 Vali Acc: 0.511 Test Loss: 1.591 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.3902778625488281
Epoch: 10, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.626 Vali Acc: 0.527 Test Loss: 1.626 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.5052423477172852
Epoch: 11, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.648 Vali Acc: 0.534 Test Loss: 1.648 Test Acc: 0.534
Validation loss decreased (-0.526703 --> -0.534335).  Saving model ...
Epoch: 12 cost time: 1.5105950832366943
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.662 Vali Acc: 0.534 Test Loss: 1.662 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5753865242004395
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.669 Vali Acc: 0.534 Test Loss: 1.669 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.6163244247436523
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.680 Vali Acc: 0.534 Test Loss: 1.680 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.7352604866027832
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.694 Vali Acc: 0.534 Test Loss: 1.694 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.5971524715423584
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.707 Vali Acc: 0.557 Test Loss: 1.707 Test Acc: 0.557
Validation loss decreased (-0.534335 --> -0.557235).  Saving model ...
Epoch: 17 cost time: 1.5034477710723877
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.714 Vali Acc: 0.557 Test Loss: 1.714 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.5209615230560303
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.720 Vali Acc: 0.557 Test Loss: 1.720 Test Acc: 0.557
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.43035888671875
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.722 Vali Acc: 0.557 Test Loss: 1.722 Test Acc: 0.557
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.4435982704162598
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.728 Vali Acc: 0.557 Test Loss: 1.728 Test Acc: 0.557
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.4204094409942627
Epoch: 21, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.738 Vali Acc: 0.557 Test Loss: 1.738 Test Acc: 0.557
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.3842852115631104
Epoch: 22, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.747 Vali Acc: 0.557 Test Loss: 1.747 Test Acc: 0.557
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.4131298065185547
Epoch: 23, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.759 Vali Acc: 0.557 Test Loss: 1.759 Test Acc: 0.557
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.3969953060150146
Epoch: 24, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.768 Vali Acc: 0.557 Test Loss: 1.768 Test Acc: 0.557
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.627765417098999
Epoch: 25, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.774 Vali Acc: 0.557 Test Loss: 1.774 Test Acc: 0.557
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.4546315670013428
Epoch: 26, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.780 Vali Acc: 0.557 Test Loss: 1.780 Test Acc: 0.557
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps2570_str1285_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 57707525
model size : 234.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps2570_str2570_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.1608235836029053
Epoch: 1, Steps: 8 | Train Loss: 1.573 Vali Loss: 1.505 Vali Acc: 0.412 Test Loss: 1.505 Test Acc: 0.412
Validation loss decreased (inf --> -0.412199).  Saving model ...
Epoch: 2 cost time: 1.0995559692382812
Epoch: 2, Steps: 8 | Train Loss: 1.233 Vali Loss: 1.451 Vali Acc: 0.496 Test Loss: 1.451 Test Acc: 0.496
Validation loss decreased (-0.412199 --> -0.496169).  Saving model ...
Epoch: 3 cost time: 1.1230251789093018
Epoch: 3, Steps: 8 | Train Loss: 0.808 Vali Loss: 1.465 Vali Acc: 0.504 Test Loss: 1.465 Test Acc: 0.504
Validation loss decreased (-0.496169 --> -0.503802).  Saving model ...
Epoch: 4 cost time: 1.5100138187408447
Epoch: 4, Steps: 8 | Train Loss: 0.432 Vali Loss: 1.563 Vali Acc: 0.435 Test Loss: 1.563 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5112230777740479
Epoch: 5, Steps: 8 | Train Loss: 0.179 Vali Loss: 1.665 Vali Acc: 0.496 Test Loss: 1.665 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.320991039276123
Epoch: 6, Steps: 8 | Train Loss: 0.058 Vali Loss: 1.752 Vali Acc: 0.504 Test Loss: 1.752 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.360212802886963
Epoch: 7, Steps: 8 | Train Loss: 0.021 Vali Loss: 1.810 Vali Acc: 0.519 Test Loss: 1.810 Test Acc: 0.519
Validation loss decreased (-0.503802 --> -0.519066).  Saving model ...
Epoch: 8 cost time: 1.2864179611206055
Epoch: 8, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.858 Vali Acc: 0.511 Test Loss: 1.858 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3734121322631836
Epoch: 9, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.897 Vali Acc: 0.496 Test Loss: 1.897 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.13570237159729
Epoch: 10, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.930 Vali Acc: 0.466 Test Loss: 1.930 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.4252619743347168
Epoch: 11, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.951 Vali Acc: 0.466 Test Loss: 1.951 Test Acc: 0.466
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.1224207878112793
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.969 Vali Acc: 0.473 Test Loss: 1.969 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.491889476776123
Epoch: 13, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.995 Vali Acc: 0.473 Test Loss: 1.995 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.4925858974456787
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.018 Vali Acc: 0.473 Test Loss: 2.018 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.512204885482788
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.036 Vali Acc: 0.473 Test Loss: 2.036 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.60746169090271
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.053 Vali Acc: 0.473 Test Loss: 2.053 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.497189998626709
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 2.065 Vali Acc: 0.473 Test Loss: 2.065 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps2570_str2570_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 57675269
model size : 234.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps2998_str750_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.7477447986602783
Epoch: 1, Steps: 8 | Train Loss: 1.560 Vali Loss: 1.527 Vali Acc: 0.420 Test Loss: 1.527 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 1.608591079711914
Epoch: 2, Steps: 8 | Train Loss: 1.196 Vali Loss: 1.384 Vali Acc: 0.527 Test Loss: 1.384 Test Acc: 0.527
Validation loss decreased (-0.419832 --> -0.526704).  Saving model ...
Epoch: 3 cost time: 1.6011056900024414
Epoch: 3, Steps: 8 | Train Loss: 0.736 Vali Loss: 1.426 Vali Acc: 0.397 Test Loss: 1.426 Test Acc: 0.397
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.336958408355713
Epoch: 4, Steps: 8 | Train Loss: 0.321 Vali Loss: 1.467 Vali Acc: 0.481 Test Loss: 1.467 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.5954346656799316
Epoch: 5, Steps: 8 | Train Loss: 0.104 Vali Loss: 1.492 Vali Acc: 0.496 Test Loss: 1.492 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.4890990257263184
Epoch: 6, Steps: 8 | Train Loss: 0.027 Vali Loss: 1.626 Vali Acc: 0.496 Test Loss: 1.626 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.5794007778167725
Epoch: 7, Steps: 8 | Train Loss: 0.010 Vali Loss: 1.685 Vali Acc: 0.489 Test Loss: 1.685 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.5385785102844238
Epoch: 8, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.750 Vali Acc: 0.466 Test Loss: 1.750 Test Acc: 0.466
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.8064565658569336
Epoch: 9, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.804 Vali Acc: 0.489 Test Loss: 1.804 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.7918472290039062
Epoch: 10, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.834 Vali Acc: 0.489 Test Loss: 1.834 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.5349516868591309
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.849 Vali Acc: 0.496 Test Loss: 1.849 Test Acc: 0.496
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.369330883026123
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.862 Vali Acc: 0.496 Test Loss: 1.862 Test Acc: 0.496
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps2998_str750_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 63667205
model size : 257.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps2998_str1499_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.6544432640075684
Epoch: 1, Steps: 8 | Train Loss: 1.571 Vali Loss: 1.543 Vali Acc: 0.420 Test Loss: 1.543 Test Acc: 0.420
Validation loss decreased (inf --> -0.419832).  Saving model ...
Epoch: 2 cost time: 1.6832304000854492
Epoch: 2, Steps: 8 | Train Loss: 1.257 Vali Loss: 1.493 Vali Acc: 0.473 Test Loss: 1.493 Test Acc: 0.473
Validation loss decreased (-0.419832 --> -0.473268).  Saving model ...
Epoch: 3 cost time: 1.1521644592285156
Epoch: 3, Steps: 8 | Train Loss: 0.777 Vali Loss: 1.547 Vali Acc: 0.450 Test Loss: 1.547 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4829120635986328
Epoch: 4, Steps: 8 | Train Loss: 0.404 Vali Loss: 1.533 Vali Acc: 0.481 Test Loss: 1.533 Test Acc: 0.481
Validation loss decreased (-0.473268 --> -0.480901).  Saving model ...
Epoch: 5 cost time: 1.5307085514068604
Epoch: 5, Steps: 8 | Train Loss: 0.156 Vali Loss: 1.625 Vali Acc: 0.504 Test Loss: 1.625 Test Acc: 0.504
Validation loss decreased (-0.480901 --> -0.503801).  Saving model ...
Epoch: 6 cost time: 1.8898518085479736
Epoch: 6, Steps: 8 | Train Loss: 0.048 Vali Loss: 1.622 Vali Acc: 0.527 Test Loss: 1.622 Test Acc: 0.527
Validation loss decreased (-0.503801 --> -0.526701).  Saving model ...
Epoch: 7 cost time: 1.7951788902282715
Epoch: 7, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.650 Vali Acc: 0.519 Test Loss: 1.650 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4698996543884277
Epoch: 8, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.665 Vali Acc: 0.511 Test Loss: 1.665 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.8144919872283936
Epoch: 9, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.699 Vali Acc: 0.527 Test Loss: 1.699 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.3758471012115479
Epoch: 10, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.723 Vali Acc: 0.519 Test Loss: 1.723 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.5356934070587158
Epoch: 11, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.755 Vali Acc: 0.511 Test Loss: 1.755 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.6952271461486816
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.777 Vali Acc: 0.511 Test Loss: 1.777 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.7282333374023438
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.794 Vali Acc: 0.511 Test Loss: 1.794 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.7966291904449463
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.809 Vali Acc: 0.511 Test Loss: 1.809 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.4675090312957764
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.819 Vali Acc: 0.511 Test Loss: 1.819 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.8118476867675781
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.826 Vali Acc: 0.511 Test Loss: 1.826 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps2998_str1499_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 63613445
model size : 257.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps2998_str2998_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.1216790676116943
Epoch: 1, Steps: 8 | Train Loss: 1.608 Vali Loss: 1.557 Vali Acc: 0.405 Test Loss: 1.557 Test Acc: 0.405
Validation loss decreased (inf --> -0.404565).  Saving model ...
Epoch: 2 cost time: 1.8004214763641357
Epoch: 2, Steps: 8 | Train Loss: 1.225 Vali Loss: 1.496 Vali Acc: 0.450 Test Loss: 1.496 Test Acc: 0.450
Validation loss decreased (-0.404565 --> -0.450367).  Saving model ...
Epoch: 3 cost time: 1.9429330825805664
Epoch: 3, Steps: 8 | Train Loss: 0.747 Vali Loss: 1.452 Vali Acc: 0.466 Test Loss: 1.452 Test Acc: 0.466
Validation loss decreased (-0.450367 --> -0.465634).  Saving model ...
Epoch: 4 cost time: 1.5843989849090576
Epoch: 4, Steps: 8 | Train Loss: 0.356 Vali Loss: 1.463 Vali Acc: 0.466 Test Loss: 1.463 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6243741512298584
Epoch: 5, Steps: 8 | Train Loss: 0.117 Vali Loss: 1.604 Vali Acc: 0.458 Test Loss: 1.604 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.706348180770874
Epoch: 6, Steps: 8 | Train Loss: 0.040 Vali Loss: 1.687 Vali Acc: 0.450 Test Loss: 1.687 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.7018022537231445
Epoch: 7, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.754 Vali Acc: 0.481 Test Loss: 1.754 Test Acc: 0.481
Validation loss decreased (-0.465634 --> -0.480898).  Saving model ...
Epoch: 8 cost time: 1.5685956478118896
Epoch: 8, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.790 Vali Acc: 0.481 Test Loss: 1.790 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.7922990322113037
Epoch: 9, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.809 Vali Acc: 0.496 Test Loss: 1.809 Test Acc: 0.496
Validation loss decreased (-0.480898 --> -0.496165).  Saving model ...
Epoch: 10 cost time: 1.8396108150482178
Epoch: 10, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.827 Vali Acc: 0.489 Test Loss: 1.827 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8677728176116943
Epoch: 11, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.851 Vali Acc: 0.489 Test Loss: 1.851 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.5320796966552734
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.869 Vali Acc: 0.489 Test Loss: 1.869 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.5430457592010498
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.884 Vali Acc: 0.489 Test Loss: 1.884 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.5523700714111328
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.901 Vali Acc: 0.489 Test Loss: 1.901 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.4661118984222412
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.914 Vali Acc: 0.489 Test Loss: 1.914 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.3587384223937988
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.923 Vali Acc: 0.481 Test Loss: 1.923 Test Acc: 0.481
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.5284740924835205
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.932 Vali Acc: 0.489 Test Loss: 1.932 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.1840121746063232
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.941 Vali Acc: 0.489 Test Loss: 1.941 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.2162845134735107
Epoch: 19, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.949 Vali Acc: 0.489 Test Loss: 1.949 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps2998_str2998_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.4961832061068702
model parameter : 63586565
model size : 257.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps3597_str900_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.714970588684082
Epoch: 1, Steps: 8 | Train Loss: 1.722 Vali Loss: 1.566 Vali Acc: 0.397 Test Loss: 1.566 Test Acc: 0.397
Validation loss decreased (inf --> -0.396931).  Saving model ...
Epoch: 2 cost time: 1.2431113719940186
Epoch: 2, Steps: 8 | Train Loss: 1.211 Vali Loss: 1.502 Vali Acc: 0.466 Test Loss: 1.502 Test Acc: 0.466
Validation loss decreased (-0.396931 --> -0.465634).  Saving model ...
Epoch: 3 cost time: 1.5888209342956543
Epoch: 3, Steps: 8 | Train Loss: 0.708 Vali Loss: 1.442 Vali Acc: 0.427 Test Loss: 1.442 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.924882173538208
Epoch: 4, Steps: 8 | Train Loss: 0.331 Vali Loss: 1.441 Vali Acc: 0.473 Test Loss: 1.441 Test Acc: 0.473
Validation loss decreased (-0.465634 --> -0.473268).  Saving model ...
Epoch: 5 cost time: 1.4318971633911133
Epoch: 5, Steps: 8 | Train Loss: 0.096 Vali Loss: 1.600 Vali Acc: 0.489 Test Loss: 1.600 Test Acc: 0.489
Validation loss decreased (-0.473268 --> -0.488534).  Saving model ...
Epoch: 6 cost time: 1.5403187274932861
Epoch: 6, Steps: 8 | Train Loss: 0.026 Vali Loss: 1.608 Vali Acc: 0.481 Test Loss: 1.608 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6954967975616455
Epoch: 7, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.594 Vali Acc: 0.473 Test Loss: 1.594 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.5241384506225586
Epoch: 8, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.641 Vali Acc: 0.489 Test Loss: 1.641 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.511092185974121
Epoch: 9, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.690 Vali Acc: 0.496 Test Loss: 1.690 Test Acc: 0.496
Validation loss decreased (-0.488534 --> -0.496166).  Saving model ...
Epoch: 10 cost time: 1.7504262924194336
Epoch: 10, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.721 Vali Acc: 0.489 Test Loss: 1.721 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7472891807556152
Epoch: 11, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.745 Vali Acc: 0.489 Test Loss: 1.745 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.5790553092956543
Epoch: 12, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.766 Vali Acc: 0.489 Test Loss: 1.766 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.7127478122711182
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.778 Vali Acc: 0.489 Test Loss: 1.778 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.323089361190796
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.794 Vali Acc: 0.489 Test Loss: 1.794 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.0193400382995605
Epoch: 15, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.811 Vali Acc: 0.489 Test Loss: 1.811 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.8420944213867188
Epoch: 16, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.825 Vali Acc: 0.489 Test Loss: 1.825 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.7558555603027344
Epoch: 17, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.840 Vali Acc: 0.489 Test Loss: 1.840 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.835160493850708
Epoch: 18, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.855 Vali Acc: 0.489 Test Loss: 1.855 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.9893512725830078
Epoch: 19, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.870 Vali Acc: 0.489 Test Loss: 1.870 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps3597_str900_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.4961832061068702
model parameter : 71926277
model size : 289.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps3597_str1799_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 2.7653095722198486
Epoch: 1, Steps: 8 | Train Loss: 1.592 Vali Loss: 1.534 Vali Acc: 0.427 Test Loss: 1.534 Test Acc: 0.427
Validation loss decreased (inf --> -0.427466).  Saving model ...
Epoch: 2 cost time: 1.5793640613555908
Epoch: 2, Steps: 8 | Train Loss: 1.206 Vali Loss: 1.501 Vali Acc: 0.443 Test Loss: 1.501 Test Acc: 0.443
Validation loss decreased (-0.427466 --> -0.442733).  Saving model ...
Epoch: 3 cost time: 1.3111388683319092
Epoch: 3, Steps: 8 | Train Loss: 0.701 Vali Loss: 1.553 Vali Acc: 0.458 Test Loss: 1.553 Test Acc: 0.458
Validation loss decreased (-0.442733 --> -0.458000).  Saving model ...
Epoch: 4 cost time: 1.5180785655975342
Epoch: 4, Steps: 8 | Train Loss: 0.314 Vali Loss: 1.627 Vali Acc: 0.435 Test Loss: 1.627 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.456573247909546
Epoch: 5, Steps: 8 | Train Loss: 0.114 Vali Loss: 1.588 Vali Acc: 0.466 Test Loss: 1.588 Test Acc: 0.466
Validation loss decreased (-0.458000 --> -0.465633).  Saving model ...
Epoch: 6 cost time: 1.8841280937194824
Epoch: 6, Steps: 8 | Train Loss: 0.034 Vali Loss: 1.658 Vali Acc: 0.473 Test Loss: 1.658 Test Acc: 0.473
Validation loss decreased (-0.465633 --> -0.473266).  Saving model ...
Epoch: 7 cost time: 1.525745153427124
Epoch: 7, Steps: 8 | Train Loss: 0.015 Vali Loss: 1.721 Vali Acc: 0.473 Test Loss: 1.721 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6683852672576904
Epoch: 8, Steps: 8 | Train Loss: 0.007 Vali Loss: 1.745 Vali Acc: 0.481 Test Loss: 1.745 Test Acc: 0.481
Validation loss decreased (-0.473266 --> -0.480899).  Saving model ...
Epoch: 9 cost time: 1.409064531326294
Epoch: 9, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.759 Vali Acc: 0.473 Test Loss: 1.759 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.34287691116333
Epoch: 10, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.785 Vali Acc: 0.489 Test Loss: 1.785 Test Acc: 0.489
Validation loss decreased (-0.480899 --> -0.488532).  Saving model ...
Epoch: 11 cost time: 1.6322100162506104
Epoch: 11, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.810 Vali Acc: 0.489 Test Loss: 1.810 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8232696056365967
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.826 Vali Acc: 0.489 Test Loss: 1.826 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.389592170715332
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.839 Vali Acc: 0.481 Test Loss: 1.839 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.7249786853790283
Epoch: 14, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.845 Vali Acc: 0.481 Test Loss: 1.845 Test Acc: 0.481
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.7161462306976318
Epoch: 15, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.850 Vali Acc: 0.481 Test Loss: 1.850 Test Acc: 0.481
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.9578959941864014
Epoch: 16, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.855 Vali Acc: 0.481 Test Loss: 1.855 Test Acc: 0.481
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.910961627960205
Epoch: 17, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.860 Vali Acc: 0.481 Test Loss: 1.860 Test Acc: 0.481
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.7412185668945312
Epoch: 18, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.868 Vali Acc: 0.473 Test Loss: 1.868 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.719527244567871
Epoch: 19, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.875 Vali Acc: 0.473 Test Loss: 1.875 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.4668934345245361
Epoch: 20, Steps: 8 | Train Loss: 0.000 Vali Loss: 1.878 Vali Acc: 0.473 Test Loss: 1.878 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps3597_str1799_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.48854961832061067
model parameter : 71883269
model size : 288.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps3597_str3597_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.109330177307129
Epoch: 1, Steps: 8 | Train Loss: 1.634 Vali Loss: 1.551 Vali Acc: 0.427 Test Loss: 1.551 Test Acc: 0.427
Validation loss decreased (inf --> -0.427465).  Saving model ...
Epoch: 2 cost time: 1.5898730754852295
Epoch: 2, Steps: 8 | Train Loss: 1.242 Vali Loss: 1.492 Vali Acc: 0.496 Test Loss: 1.492 Test Acc: 0.496
Validation loss decreased (-0.427465 --> -0.496168).  Saving model ...
Epoch: 3 cost time: 1.4582536220550537
Epoch: 3, Steps: 8 | Train Loss: 0.759 Vali Loss: 1.484 Vali Acc: 0.527 Test Loss: 1.484 Test Acc: 0.527
Validation loss decreased (-0.496168 --> -0.526703).  Saving model ...
Epoch: 4 cost time: 1.6772785186767578
Epoch: 4, Steps: 8 | Train Loss: 0.380 Vali Loss: 1.570 Vali Acc: 0.458 Test Loss: 1.570 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6431691646575928
Epoch: 5, Steps: 8 | Train Loss: 0.132 Vali Loss: 1.647 Vali Acc: 0.443 Test Loss: 1.647 Test Acc: 0.443
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.8881869316101074
Epoch: 6, Steps: 8 | Train Loss: 0.047 Vali Loss: 1.741 Vali Acc: 0.450 Test Loss: 1.741 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.6951231956481934
Epoch: 7, Steps: 8 | Train Loss: 0.020 Vali Loss: 1.812 Vali Acc: 0.450 Test Loss: 1.812 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.7542047500610352
Epoch: 8, Steps: 8 | Train Loss: 0.009 Vali Loss: 1.844 Vali Acc: 0.450 Test Loss: 1.844 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.7039744853973389
Epoch: 9, Steps: 8 | Train Loss: 0.005 Vali Loss: 1.878 Vali Acc: 0.473 Test Loss: 1.878 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.6454691886901855
Epoch: 10, Steps: 8 | Train Loss: 0.004 Vali Loss: 1.908 Vali Acc: 0.450 Test Loss: 1.908 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.8691089153289795
Epoch: 11, Steps: 8 | Train Loss: 0.003 Vali Loss: 1.929 Vali Acc: 0.450 Test Loss: 1.929 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.8724989891052246
Epoch: 12, Steps: 8 | Train Loss: 0.002 Vali Loss: 1.947 Vali Acc: 0.458 Test Loss: 1.947 Test Acc: 0.458
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.5746843814849854
Epoch: 13, Steps: 8 | Train Loss: 0.001 Vali Loss: 1.966 Vali Acc: 0.458 Test Loss: 1.966 Test Acc: 0.458
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_GPT4TS_UEA_ftM_sl17984_ll0_pl0_el3_dm768_df768_ps3597_str3597_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 71861765
model size : 288.80MB
