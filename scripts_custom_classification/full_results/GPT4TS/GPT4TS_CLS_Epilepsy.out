Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el6_dm768_df768_ps9_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.200489044189453
Epoch: 1, Steps: 9 | Train Loss: 1.450 Vali Loss: 1.293 Vali Acc: 0.384 Test Loss: 1.293 Test Acc: 0.384
Validation loss decreased (inf --> -0.384045).  Saving model ...
Epoch: 2 cost time: 2.5758883953094482
Epoch: 2, Steps: 9 | Train Loss: 1.213 Vali Loss: 1.013 Vali Acc: 0.638 Test Loss: 1.013 Test Acc: 0.638
Validation loss decreased (-0.384045 --> -0.637671).  Saving model ...
Epoch: 3 cost time: 2.3772363662719727
Epoch: 3, Steps: 9 | Train Loss: 0.902 Vali Loss: 0.887 Vali Acc: 0.645 Test Loss: 0.887 Test Acc: 0.645
Validation loss decreased (-0.637671 --> -0.644919).  Saving model ...
Epoch: 4 cost time: 2.7550814151763916
Epoch: 4, Steps: 9 | Train Loss: 0.652 Vali Loss: 0.754 Vali Acc: 0.688 Test Loss: 0.754 Test Acc: 0.688
Validation loss decreased (-0.644919 --> -0.688398).  Saving model ...
Epoch: 5 cost time: 1.9992449283599854
Epoch: 5, Steps: 9 | Train Loss: 0.461 Vali Loss: 0.640 Vali Acc: 0.725 Test Loss: 0.640 Test Acc: 0.725
Validation loss decreased (-0.688398 --> -0.724631).  Saving model ...
Epoch: 6 cost time: 2.7667510509490967
Epoch: 6, Steps: 9 | Train Loss: 0.320 Vali Loss: 0.881 Vali Acc: 0.638 Test Loss: 0.881 Test Acc: 0.638
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.113344669342041
Epoch: 7, Steps: 9 | Train Loss: 0.287 Vali Loss: 0.522 Vali Acc: 0.841 Test Loss: 0.522 Test Acc: 0.841
Validation loss decreased (-0.724631 --> -0.840574).  Saving model ...
Epoch: 8 cost time: 3.5699360370635986
Epoch: 8, Steps: 9 | Train Loss: 0.135 Vali Loss: 0.665 Vali Acc: 0.826 Test Loss: 0.665 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.78253436088562
Epoch: 9, Steps: 9 | Train Loss: 0.082 Vali Loss: 0.527 Vali Acc: 0.819 Test Loss: 0.527 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.4092776775360107
Epoch: 10, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.712 Vali Acc: 0.746 Test Loss: 0.712 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.385424852371216
Epoch: 11, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.606 Vali Acc: 0.812 Test Loss: 0.606 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.5033793449401855
Epoch: 12, Steps: 9 | Train Loss: 0.024 Vali Loss: 1.163 Vali Acc: 0.833 Test Loss: 1.163 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.650580406188965
Epoch: 13, Steps: 9 | Train Loss: 0.009 Vali Loss: 1.082 Vali Acc: 0.768 Test Loss: 1.082 Test Acc: 0.768
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.448305368423462
Epoch: 14, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.943 Vali Acc: 0.819 Test Loss: 0.943 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.807929515838623
Epoch: 15, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.957 Vali Acc: 0.812 Test Loss: 0.957 Test Acc: 0.812
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.835968255996704
Epoch: 16, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.881 Vali Acc: 0.812 Test Loss: 0.881 Test Acc: 0.812
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.188732147216797
Epoch: 17, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.333 Vali Acc: 0.826 Test Loss: 1.333 Test Acc: 0.826
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el6_dm768_df768_ps9_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8405797101449275
model parameter : 43744516
model size : 181.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el6_dm768_df768_ps9_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.4012439250946045
Epoch: 1, Steps: 9 | Train Loss: 1.436 Vali Loss: 1.297 Vali Acc: 0.435 Test Loss: 1.297 Test Acc: 0.435
Validation loss decreased (inf --> -0.434770).  Saving model ...
Epoch: 2 cost time: 2.6799309253692627
Epoch: 2, Steps: 9 | Train Loss: 1.219 Vali Loss: 1.103 Vali Acc: 0.616 Test Loss: 1.103 Test Acc: 0.616
Validation loss decreased (-0.434770 --> -0.615931).  Saving model ...
Epoch: 3 cost time: 2.4403417110443115
Epoch: 3, Steps: 9 | Train Loss: 0.999 Vali Loss: 0.928 Vali Acc: 0.667 Test Loss: 0.928 Test Acc: 0.667
Validation loss decreased (-0.615931 --> -0.666657).  Saving model ...
Epoch: 4 cost time: 1.1896493434906006
Epoch: 4, Steps: 9 | Train Loss: 0.801 Vali Loss: 0.787 Vali Acc: 0.696 Test Loss: 0.787 Test Acc: 0.696
Validation loss decreased (-0.666657 --> -0.695644).  Saving model ...
Epoch: 5 cost time: 1.3604698181152344
Epoch: 5, Steps: 9 | Train Loss: 0.594 Vali Loss: 0.722 Vali Acc: 0.681 Test Loss: 0.722 Test Acc: 0.681
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7589669227600098
Epoch: 6, Steps: 9 | Train Loss: 0.422 Vali Loss: 0.670 Vali Acc: 0.783 Test Loss: 0.670 Test Acc: 0.783
Validation loss decreased (-0.695644 --> -0.782602).  Saving model ...
Epoch: 7 cost time: 1.7927682399749756
Epoch: 7, Steps: 9 | Train Loss: 0.329 Vali Loss: 0.694 Vali Acc: 0.725 Test Loss: 0.694 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.209829568862915
Epoch: 8, Steps: 9 | Train Loss: 0.195 Vali Loss: 0.586 Vali Acc: 0.783 Test Loss: 0.586 Test Acc: 0.783
Validation loss decreased (-0.782602 --> -0.782603).  Saving model ...
Epoch: 9 cost time: 2.093825340270996
Epoch: 9, Steps: 9 | Train Loss: 0.129 Vali Loss: 0.719 Vali Acc: 0.819 Test Loss: 0.719 Test Acc: 0.819
Validation loss decreased (-0.782603 --> -0.818833).  Saving model ...
Epoch: 10 cost time: 2.333526849746704
Epoch: 10, Steps: 9 | Train Loss: 0.086 Vali Loss: 0.915 Vali Acc: 0.783 Test Loss: 0.915 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.6658754348754883
Epoch: 11, Steps: 9 | Train Loss: 0.053 Vali Loss: 0.801 Vali Acc: 0.812 Test Loss: 0.801 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.352498769760132
Epoch: 12, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.563 Vali Acc: 0.870 Test Loss: 0.563 Test Acc: 0.870
Validation loss decreased (-0.818833 --> -0.869560).  Saving model ...
Epoch: 13 cost time: 2.670013904571533
Epoch: 13, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.966 Vali Acc: 0.732 Test Loss: 0.966 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.1259045600891113
Epoch: 14, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.795 Vali Acc: 0.841 Test Loss: 0.795 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.037306070327759
Epoch: 15, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.842 Vali Acc: 0.819 Test Loss: 0.842 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.8359012603759766
Epoch: 16, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.594 Vali Acc: 0.870 Test Loss: 0.594 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.9949486255645752
Epoch: 17, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.733 Vali Acc: 0.855 Test Loss: 0.733 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.547382116317749
Epoch: 18, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.755 Vali Acc: 0.870 Test Loss: 0.755 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.0280134677886963
Epoch: 19, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.919 Vali Acc: 0.862 Test Loss: 0.919 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.0545384883880615
Epoch: 20, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.680 Vali Acc: 0.884 Test Loss: 0.680 Test Acc: 0.884
Validation loss decreased (-0.869560 --> -0.884051).  Saving model ...
Epoch: 21 cost time: 2.2845139503479004
Epoch: 21, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.875 Vali Acc: 0.833 Test Loss: 0.875 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.736067295074463
Epoch: 22, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.863 Vali Acc: 0.841 Test Loss: 0.863 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.6671926975250244
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.821 Vali Acc: 0.855 Test Loss: 0.821 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.3666610717773438
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.792 Vali Acc: 0.862 Test Loss: 0.792 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.7487633228302002
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.810 Vali Acc: 0.870 Test Loss: 0.810 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.099701166152954
Epoch: 26, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.827 Vali Acc: 0.870 Test Loss: 0.827 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.1076576709747314
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.811 Vali Acc: 0.884 Test Loss: 0.811 Test Acc: 0.884
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.507197141647339
Epoch: 28, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.815 Vali Acc: 0.877 Test Loss: 0.815 Test Acc: 0.877
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.1607162952423096
Epoch: 29, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.816 Vali Acc: 0.877 Test Loss: 0.816 Test Acc: 0.877
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 2.237070083618164
Epoch: 30, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.815 Vali Acc: 0.877 Test Loss: 0.815 Test Acc: 0.877
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el6_dm768_df768_ps9_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8840579710144928
model parameter : 43624708
model size : 181.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el6_dm768_df768_ps9_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.738095998764038
Epoch: 1, Steps: 9 | Train Loss: 1.421 Vali Loss: 1.349 Vali Acc: 0.319 Test Loss: 1.349 Test Acc: 0.319
Validation loss decreased (inf --> -0.318827).  Saving model ...
Epoch: 2 cost time: 1.9971210956573486
Epoch: 2, Steps: 9 | Train Loss: 1.329 Vali Loss: 1.202 Vali Acc: 0.478 Test Loss: 1.202 Test Acc: 0.478
Validation loss decreased (-0.318827 --> -0.478249).  Saving model ...
Epoch: 3 cost time: 1.613405466079712
Epoch: 3, Steps: 9 | Train Loss: 1.123 Vali Loss: 1.048 Vali Acc: 0.696 Test Loss: 1.048 Test Acc: 0.696
Validation loss decreased (-0.478249 --> -0.695642).  Saving model ...
Epoch: 4 cost time: 1.7051138877868652
Epoch: 4, Steps: 9 | Train Loss: 0.991 Vali Loss: 0.917 Vali Acc: 0.645 Test Loss: 0.917 Test Acc: 0.645
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4997780323028564
Epoch: 5, Steps: 9 | Train Loss: 0.800 Vali Loss: 0.810 Vali Acc: 0.717 Test Loss: 0.810 Test Acc: 0.717
Validation loss decreased (-0.695642 --> -0.717383).  Saving model ...
Epoch: 6 cost time: 1.353858232498169
Epoch: 6, Steps: 9 | Train Loss: 0.642 Vali Loss: 0.745 Vali Acc: 0.710 Test Loss: 0.745 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7035367488861084
Epoch: 7, Steps: 9 | Train Loss: 0.473 Vali Loss: 0.798 Vali Acc: 0.717 Test Loss: 0.798 Test Acc: 0.717
Validation loss decreased (-0.717383 --> -0.717383).  Saving model ...
Epoch: 8 cost time: 1.8637657165527344
Epoch: 8, Steps: 9 | Train Loss: 0.359 Vali Loss: 0.786 Vali Acc: 0.725 Test Loss: 0.786 Test Acc: 0.725
Validation loss decreased (-0.717383 --> -0.724630).  Saving model ...
Epoch: 9 cost time: 1.7859604358673096
Epoch: 9, Steps: 9 | Train Loss: 0.270 Vali Loss: 0.765 Vali Acc: 0.746 Test Loss: 0.765 Test Acc: 0.746
Validation loss decreased (-0.724630 --> -0.746369).  Saving model ...
Epoch: 10 cost time: 1.6271536350250244
Epoch: 10, Steps: 9 | Train Loss: 0.240 Vali Loss: 0.808 Vali Acc: 0.761 Test Loss: 0.808 Test Acc: 0.761
Validation loss decreased (-0.746369 --> -0.760861).  Saving model ...
Epoch: 11 cost time: 1.7002756595611572
Epoch: 11, Steps: 9 | Train Loss: 0.145 Vali Loss: 0.774 Vali Acc: 0.754 Test Loss: 0.774 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.7430400848388672
Epoch: 12, Steps: 9 | Train Loss: 0.131 Vali Loss: 0.831 Vali Acc: 0.790 Test Loss: 0.831 Test Acc: 0.790
Validation loss decreased (-0.760861 --> -0.789847).  Saving model ...
Epoch: 13 cost time: 1.5672929286956787
Epoch: 13, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.708 Vali Acc: 0.826 Test Loss: 0.708 Test Acc: 0.826
Validation loss decreased (-0.789847 --> -0.826080).  Saving model ...
Epoch: 14 cost time: 1.6615872383117676
Epoch: 14, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.818 Vali Acc: 0.804 Test Loss: 0.818 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3371765613555908
Epoch: 15, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.743 Vali Acc: 0.819 Test Loss: 0.743 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.173377513885498
Epoch: 16, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.880 Vali Acc: 0.826 Test Loss: 0.880 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.575345754623413
Epoch: 17, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.989 Vali Acc: 0.790 Test Loss: 0.989 Test Acc: 0.790
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.546027660369873
Epoch: 18, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.799 Vali Acc: 0.833 Test Loss: 0.799 Test Acc: 0.833
Validation loss decreased (-0.826080 --> -0.833325).  Saving model ...
Epoch: 19 cost time: 1.745415210723877
Epoch: 19, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.986 Vali Acc: 0.826 Test Loss: 0.986 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.5622456073760986
Epoch: 20, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.896 Vali Acc: 0.833 Test Loss: 0.896 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.915316104888916
Epoch: 21, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.916 Vali Acc: 0.841 Test Loss: 0.916 Test Acc: 0.841
Validation loss decreased (-0.833325 --> -0.840571).  Saving model ...
Epoch: 22 cost time: 1.8715834617614746
Epoch: 22, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.006 Vali Acc: 0.812 Test Loss: 1.006 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.598860263824463
Epoch: 23, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.771 Vali Acc: 0.826 Test Loss: 0.771 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.5417885780334473
Epoch: 24, Steps: 9 | Train Loss: 0.010 Vali Loss: 1.196 Vali Acc: 0.819 Test Loss: 1.196 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.9277398586273193
Epoch: 25, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.874 Vali Acc: 0.855 Test Loss: 0.874 Test Acc: 0.855
Validation loss decreased (-0.840571 --> -0.855064).  Saving model ...
Epoch: 26 cost time: 1.1430203914642334
Epoch: 26, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.932 Vali Acc: 0.826 Test Loss: 0.932 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.362626314163208
Epoch: 27, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.185 Vali Acc: 0.804 Test Loss: 1.185 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.339362621307373
Epoch: 28, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.927 Vali Acc: 0.826 Test Loss: 0.927 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.8371684551239014
Epoch: 29, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.827 Vali Acc: 0.855 Test Loss: 0.827 Test Acc: 0.855
Validation loss decreased (-0.855064 --> -0.855064).  Saving model ...
Epoch: 30 cost time: 1.6718616485595703
Epoch: 30, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.913 Vali Acc: 0.833 Test Loss: 0.913 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.5599052906036377
Epoch: 31, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.973 Vali Acc: 0.826 Test Loss: 0.973 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.783271312713623
Epoch: 32, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.026 Vali Acc: 0.826 Test Loss: 1.026 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.7190086841583252
Epoch: 33, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.021 Vali Acc: 0.826 Test Loss: 1.021 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 2.415907859802246
Epoch: 34, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.949 Vali Acc: 0.826 Test Loss: 0.949 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 2.1967368125915527
Epoch: 35, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.931 Vali Acc: 0.826 Test Loss: 0.931 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.7422151565551758
Epoch: 36, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.959 Vali Acc: 0.826 Test Loss: 0.959 Test Acc: 0.826
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 2.3479018211364746
Epoch: 37, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.996 Vali Acc: 0.833 Test Loss: 0.996 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.9348316192626953
Epoch: 38, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.002 Vali Acc: 0.833 Test Loss: 1.002 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.9627764225006104
Epoch: 39, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.002 Vali Acc: 0.833 Test Loss: 1.002 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el6_dm768_df768_ps9_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.855072463768116
model parameter : 43541764
model size : 180.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el6_dm768_df768_ps10_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.054342269897461
Epoch: 1, Steps: 9 | Train Loss: 1.446 Vali Loss: 1.351 Vali Acc: 0.341 Test Loss: 1.351 Test Acc: 0.341
Validation loss decreased (inf --> -0.340566).  Saving model ...
Epoch: 2 cost time: 2.6698193550109863
Epoch: 2, Steps: 9 | Train Loss: 1.234 Vali Loss: 1.147 Vali Acc: 0.428 Test Loss: 1.147 Test Acc: 0.428
Validation loss decreased (-0.340566 --> -0.427525).  Saving model ...
Epoch: 3 cost time: 2.8380825519561768
Epoch: 3, Steps: 9 | Train Loss: 0.958 Vali Loss: 1.062 Vali Acc: 0.529 Test Loss: 1.062 Test Acc: 0.529
Validation loss decreased (-0.427525 --> -0.528975).  Saving model ...
Epoch: 4 cost time: 2.6672980785369873
Epoch: 4, Steps: 9 | Train Loss: 0.740 Vali Loss: 0.838 Vali Acc: 0.594 Test Loss: 0.838 Test Acc: 0.594
Validation loss decreased (-0.528975 --> -0.594195).  Saving model ...
Epoch: 5 cost time: 3.2349984645843506
Epoch: 5, Steps: 9 | Train Loss: 0.567 Vali Loss: 0.735 Vali Acc: 0.681 Test Loss: 0.735 Test Acc: 0.681
Validation loss decreased (-0.594195 --> -0.681152).  Saving model ...
Epoch: 6 cost time: 3.0484323501586914
Epoch: 6, Steps: 9 | Train Loss: 0.333 Vali Loss: 0.649 Vali Acc: 0.783 Test Loss: 0.649 Test Acc: 0.783
Validation loss decreased (-0.681152 --> -0.782602).  Saving model ...
Epoch: 7 cost time: 2.817295789718628
Epoch: 7, Steps: 9 | Train Loss: 0.201 Vali Loss: 0.587 Vali Acc: 0.739 Test Loss: 0.587 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.33784818649292
Epoch: 8, Steps: 9 | Train Loss: 0.142 Vali Loss: 0.721 Vali Acc: 0.725 Test Loss: 0.721 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.613341808319092
Epoch: 9, Steps: 9 | Train Loss: 0.075 Vali Loss: 0.601 Vali Acc: 0.833 Test Loss: 0.601 Test Acc: 0.833
Validation loss decreased (-0.782602 --> -0.833327).  Saving model ...
Epoch: 10 cost time: 2.096616744995117
Epoch: 10, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.596 Vali Acc: 0.841 Test Loss: 0.596 Test Acc: 0.841
Validation loss decreased (-0.833327 --> -0.840574).  Saving model ...
Epoch: 11 cost time: 2.0169951915740967
Epoch: 11, Steps: 9 | Train Loss: 0.006 Vali Loss: 1.264 Vali Acc: 0.833 Test Loss: 1.264 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.1446352005004883
Epoch: 12, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.995 Vali Acc: 0.804 Test Loss: 0.995 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.1286046504974365
Epoch: 13, Steps: 9 | Train Loss: 0.011 Vali Loss: 1.313 Vali Acc: 0.819 Test Loss: 1.313 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.731245994567871
Epoch: 14, Steps: 9 | Train Loss: 0.027 Vali Loss: 1.459 Vali Acc: 0.761 Test Loss: 1.459 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.2696151733398438
Epoch: 15, Steps: 9 | Train Loss: 0.058 Vali Loss: 1.131 Vali Acc: 0.833 Test Loss: 1.131 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.9470164775848389
Epoch: 16, Steps: 9 | Train Loss: 0.053 Vali Loss: 1.340 Vali Acc: 0.725 Test Loss: 1.340 Test Acc: 0.725
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.1640310287475586
Epoch: 17, Steps: 9 | Train Loss: 0.042 Vali Loss: 2.709 Vali Acc: 0.783 Test Loss: 2.709 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.3301868438720703
Epoch: 18, Steps: 9 | Train Loss: 0.015 Vali Loss: 1.700 Vali Acc: 0.739 Test Loss: 1.700 Test Acc: 0.739
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.2596957683563232
Epoch: 19, Steps: 9 | Train Loss: 0.009 Vali Loss: 2.397 Vali Acc: 0.768 Test Loss: 2.397 Test Acc: 0.768
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.0900187492370605
Epoch: 20, Steps: 9 | Train Loss: 0.031 Vali Loss: 1.731 Vali Acc: 0.775 Test Loss: 1.731 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el6_dm768_df768_ps10_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8405797101449275
model parameter : 43751428
model size : 181.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el6_dm768_df768_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.1568684577941895
Epoch: 1, Steps: 9 | Train Loss: 1.408 Vali Loss: 1.361 Vali Acc: 0.297 Test Loss: 1.361 Test Acc: 0.297
Validation loss decreased (inf --> -0.297088).  Saving model ...
Epoch: 2 cost time: 2.2245867252349854
Epoch: 2, Steps: 9 | Train Loss: 1.270 Vali Loss: 1.209 Vali Acc: 0.442 Test Loss: 1.209 Test Acc: 0.442
Validation loss decreased (-0.297088 --> -0.442017).  Saving model ...
Epoch: 3 cost time: 1.9943327903747559
Epoch: 3, Steps: 9 | Train Loss: 1.126 Vali Loss: 1.070 Vali Acc: 0.587 Test Loss: 1.070 Test Acc: 0.587
Validation loss decreased (-0.442017 --> -0.586946).  Saving model ...
Epoch: 4 cost time: 1.709625244140625
Epoch: 4, Steps: 9 | Train Loss: 0.856 Vali Loss: 0.906 Vali Acc: 0.616 Test Loss: 0.906 Test Acc: 0.616
Validation loss decreased (-0.586946 --> -0.615933).  Saving model ...
Epoch: 5 cost time: 1.9642314910888672
Epoch: 5, Steps: 9 | Train Loss: 0.637 Vali Loss: 0.747 Vali Acc: 0.739 Test Loss: 0.747 Test Acc: 0.739
Validation loss decreased (-0.615933 --> -0.739123).  Saving model ...
Epoch: 6 cost time: 1.966766119003296
Epoch: 6, Steps: 9 | Train Loss: 0.437 Vali Loss: 0.662 Vali Acc: 0.732 Test Loss: 0.662 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.997567892074585
Epoch: 7, Steps: 9 | Train Loss: 0.298 Vali Loss: 0.591 Vali Acc: 0.725 Test Loss: 0.591 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.4855380058288574
Epoch: 8, Steps: 9 | Train Loss: 0.218 Vali Loss: 0.552 Vali Acc: 0.819 Test Loss: 0.552 Test Acc: 0.819
Validation loss decreased (-0.739123 --> -0.818835).  Saving model ...
Epoch: 9 cost time: 2.506669282913208
Epoch: 9, Steps: 9 | Train Loss: 0.105 Vali Loss: 0.855 Vali Acc: 0.833 Test Loss: 0.855 Test Acc: 0.833
Validation loss decreased (-0.818835 --> -0.833325).  Saving model ...
Epoch: 10 cost time: 2.7490594387054443
Epoch: 10, Steps: 9 | Train Loss: 0.113 Vali Loss: 0.541 Vali Acc: 0.870 Test Loss: 0.541 Test Acc: 0.870
Validation loss decreased (-0.833325 --> -0.869560).  Saving model ...
Epoch: 11 cost time: 2.249873638153076
Epoch: 11, Steps: 9 | Train Loss: 0.060 Vali Loss: 0.921 Vali Acc: 0.783 Test Loss: 0.921 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.319093704223633
Epoch: 12, Steps: 9 | Train Loss: 0.068 Vali Loss: 0.757 Vali Acc: 0.848 Test Loss: 0.757 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.5396337509155273
Epoch: 13, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.652 Vali Acc: 0.804 Test Loss: 0.652 Test Acc: 0.804
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.8407459259033203
Epoch: 14, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.945 Vali Acc: 0.826 Test Loss: 0.945 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.4284274578094482
Epoch: 15, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.907 Vali Acc: 0.848 Test Loss: 0.907 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.2150580883026123
Epoch: 16, Steps: 9 | Train Loss: 0.007 Vali Loss: 1.237 Vali Acc: 0.804 Test Loss: 1.237 Test Acc: 0.804
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.268763303756714
Epoch: 17, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.767 Vali Acc: 0.855 Test Loss: 0.767 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.470330238342285
Epoch: 18, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.209 Vali Acc: 0.826 Test Loss: 1.209 Test Acc: 0.826
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.2806248664855957
Epoch: 19, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.083 Vali Acc: 0.833 Test Loss: 1.083 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.8027031421661377
Epoch: 20, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.905 Vali Acc: 0.855 Test Loss: 0.905 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el6_dm768_df768_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8695652173913043
model parameter : 43631620
model size : 181.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el6_dm768_df768_ps10_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.581347703933716
Epoch: 1, Steps: 9 | Train Loss: 1.443 Vali Loss: 1.366 Vali Acc: 0.304 Test Loss: 1.366 Test Acc: 0.304
Validation loss decreased (inf --> -0.304334).  Saving model ...
Epoch: 2 cost time: 1.561385154724121
Epoch: 2, Steps: 9 | Train Loss: 1.310 Vali Loss: 1.248 Vali Acc: 0.413 Test Loss: 1.248 Test Acc: 0.413
Validation loss decreased (-0.304334 --> -0.413031).  Saving model ...
Epoch: 3 cost time: 1.4573204517364502
Epoch: 3, Steps: 9 | Train Loss: 1.171 Vali Loss: 1.151 Vali Acc: 0.601 Test Loss: 1.151 Test Acc: 0.601
Validation loss decreased (-0.413031 --> -0.601438).  Saving model ...
Epoch: 4 cost time: 1.996807336807251
Epoch: 4, Steps: 9 | Train Loss: 1.026 Vali Loss: 1.022 Vali Acc: 0.565 Test Loss: 1.022 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7293882369995117
Epoch: 5, Steps: 9 | Train Loss: 0.829 Vali Loss: 0.920 Vali Acc: 0.652 Test Loss: 0.920 Test Acc: 0.652
Validation loss decreased (-0.601438 --> -0.652165).  Saving model ...
Epoch: 6 cost time: 1.8728199005126953
Epoch: 6, Steps: 9 | Train Loss: 0.700 Vali Loss: 0.829 Vali Acc: 0.696 Test Loss: 0.829 Test Acc: 0.696
Validation loss decreased (-0.652165 --> -0.695644).  Saving model ...
Epoch: 7 cost time: 2.3141610622406006
Epoch: 7, Steps: 9 | Train Loss: 0.562 Vali Loss: 0.719 Vali Acc: 0.732 Test Loss: 0.719 Test Acc: 0.732
Validation loss decreased (-0.695644 --> -0.731877).  Saving model ...
Epoch: 8 cost time: 1.7717056274414062
Epoch: 8, Steps: 9 | Train Loss: 0.400 Vali Loss: 0.824 Vali Acc: 0.739 Test Loss: 0.824 Test Acc: 0.739
Validation loss decreased (-0.731877 --> -0.739122).  Saving model ...
Epoch: 9 cost time: 1.7569727897644043
Epoch: 9, Steps: 9 | Train Loss: 0.316 Vali Loss: 0.650 Vali Acc: 0.739 Test Loss: 0.650 Test Acc: 0.739
Validation loss decreased (-0.739122 --> -0.739124).  Saving model ...
Epoch: 10 cost time: 2.2529449462890625
Epoch: 10, Steps: 9 | Train Loss: 0.185 Vali Loss: 0.573 Vali Acc: 0.855 Test Loss: 0.573 Test Acc: 0.855
Validation loss decreased (-0.739124 --> -0.855067).  Saving model ...
Epoch: 11 cost time: 2.151397943496704
Epoch: 11, Steps: 9 | Train Loss: 0.133 Vali Loss: 0.680 Vali Acc: 0.819 Test Loss: 0.680 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.049783229827881
Epoch: 12, Steps: 9 | Train Loss: 0.078 Vali Loss: 0.612 Vali Acc: 0.826 Test Loss: 0.612 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.3158621788024902
Epoch: 13, Steps: 9 | Train Loss: 0.047 Vali Loss: 0.581 Vali Acc: 0.826 Test Loss: 0.581 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.1969313621520996
Epoch: 14, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.575 Vali Acc: 0.841 Test Loss: 0.575 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.8794612884521484
Epoch: 15, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.819 Vali Acc: 0.841 Test Loss: 0.819 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.904892921447754
Epoch: 16, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.571 Vali Acc: 0.848 Test Loss: 0.571 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.2172296047210693
Epoch: 17, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.769 Vali Acc: 0.855 Test Loss: 0.769 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.8362343311309814
Epoch: 18, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.669 Vali Acc: 0.862 Test Loss: 0.669 Test Acc: 0.862
Validation loss decreased (-0.855067 --> -0.862312).  Saving model ...
Epoch: 19 cost time: 1.55623197555542
Epoch: 19, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.705 Vali Acc: 0.855 Test Loss: 0.705 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.40425443649292
Epoch: 20, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.696 Vali Acc: 0.855 Test Loss: 0.696 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.2404894828796387
Epoch: 21, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.705 Vali Acc: 0.862 Test Loss: 0.705 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.2368407249450684
Epoch: 22, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.703 Vali Acc: 0.855 Test Loss: 0.703 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.7544188499450684
Epoch: 23, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.719 Vali Acc: 0.855 Test Loss: 0.719 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.341916799545288
Epoch: 24, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.773 Vali Acc: 0.848 Test Loss: 0.773 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.1240580081939697
Epoch: 25, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.764 Vali Acc: 0.848 Test Loss: 0.764 Test Acc: 0.848
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.7844667434692383
Epoch: 26, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.696 Vali Acc: 0.862 Test Loss: 0.696 Test Acc: 0.862
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.9086182117462158
Epoch: 27, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.723 Vali Acc: 0.862 Test Loss: 0.723 Test Acc: 0.862
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.553788661956787
Epoch: 28, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.738 Vali Acc: 0.862 Test Loss: 0.738 Test Acc: 0.862
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el6_dm768_df768_ps10_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8623188405797102
model parameter : 43539460
model size : 180.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el6_dm768_df768_ps11_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.287502765655518
Epoch: 1, Steps: 9 | Train Loss: 1.351 Vali Loss: 1.237 Vali Acc: 0.312 Test Loss: 1.237 Test Acc: 0.312
Validation loss decreased (inf --> -0.311582).  Saving model ...
Epoch: 2 cost time: 2.891461133956909
Epoch: 2, Steps: 9 | Train Loss: 1.116 Vali Loss: 1.020 Vali Acc: 0.514 Test Loss: 1.020 Test Acc: 0.514
Validation loss decreased (-0.311582 --> -0.514483).  Saving model ...
Epoch: 3 cost time: 2.8786730766296387
Epoch: 3, Steps: 9 | Train Loss: 0.857 Vali Loss: 0.884 Vali Acc: 0.616 Test Loss: 0.884 Test Acc: 0.616
Validation loss decreased (-0.514483 --> -0.615933).  Saving model ...
Epoch: 4 cost time: 2.810415744781494
Epoch: 4, Steps: 9 | Train Loss: 0.638 Vali Loss: 0.675 Vali Acc: 0.819 Test Loss: 0.675 Test Acc: 0.819
Validation loss decreased (-0.615933 --> -0.818834).  Saving model ...
Epoch: 5 cost time: 2.3793070316314697
Epoch: 5, Steps: 9 | Train Loss: 0.458 Vali Loss: 0.647 Vali Acc: 0.754 Test Loss: 0.647 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.8914499282836914
Epoch: 6, Steps: 9 | Train Loss: 0.320 Vali Loss: 0.699 Vali Acc: 0.696 Test Loss: 0.699 Test Acc: 0.696
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.0227015018463135
Epoch: 7, Steps: 9 | Train Loss: 0.209 Vali Loss: 0.733 Vali Acc: 0.790 Test Loss: 0.733 Test Acc: 0.790
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.8975625038146973
Epoch: 8, Steps: 9 | Train Loss: 0.154 Vali Loss: 0.439 Vali Acc: 0.848 Test Loss: 0.439 Test Acc: 0.848
Validation loss decreased (-0.818834 --> -0.847822).  Saving model ...
Epoch: 9 cost time: 2.8060519695281982
Epoch: 9, Steps: 9 | Train Loss: 0.101 Vali Loss: 0.841 Vali Acc: 0.717 Test Loss: 0.841 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.582916736602783
Epoch: 10, Steps: 9 | Train Loss: 0.081 Vali Loss: 0.385 Vali Acc: 0.870 Test Loss: 0.385 Test Acc: 0.870
Validation loss decreased (-0.847822 --> -0.869561).  Saving model ...
Epoch: 11 cost time: 2.5515341758728027
Epoch: 11, Steps: 9 | Train Loss: 0.116 Vali Loss: 0.939 Vali Acc: 0.826 Test Loss: 0.939 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.7952470779418945
Epoch: 12, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.501 Vali Acc: 0.855 Test Loss: 0.501 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.5822675228118896
Epoch: 13, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.865 Vali Acc: 0.833 Test Loss: 0.865 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.6825039386749268
Epoch: 14, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.876 Vali Acc: 0.841 Test Loss: 0.876 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.119032144546509
Epoch: 15, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.742 Vali Acc: 0.841 Test Loss: 0.742 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.9940576553344727
Epoch: 16, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.735 Vali Acc: 0.848 Test Loss: 0.735 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.2090046405792236
Epoch: 17, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.703 Vali Acc: 0.848 Test Loss: 0.703 Test Acc: 0.848
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.478241205215454
Epoch: 18, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.719 Vali Acc: 0.870 Test Loss: 0.719 Test Acc: 0.870
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.5142526626586914
Epoch: 19, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.780 Vali Acc: 0.848 Test Loss: 0.780 Test Acc: 0.848
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.434968948364258
Epoch: 20, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.685 Vali Acc: 0.862 Test Loss: 0.685 Test Acc: 0.862
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el6_dm768_df768_ps11_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8695652173913043
model parameter : 43758340
model size : 181.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el6_dm768_df768_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.097398281097412
Epoch: 1, Steps: 9 | Train Loss: 1.417 Vali Loss: 1.299 Vali Acc: 0.355 Test Loss: 1.299 Test Acc: 0.355
Validation loss decreased (inf --> -0.355059).  Saving model ...
Epoch: 2 cost time: 1.8220946788787842
Epoch: 2, Steps: 9 | Train Loss: 1.263 Vali Loss: 1.151 Vali Acc: 0.522 Test Loss: 1.151 Test Acc: 0.522
Validation loss decreased (-0.355059 --> -0.521728).  Saving model ...
Epoch: 3 cost time: 2.09494686126709
Epoch: 3, Steps: 9 | Train Loss: 1.021 Vali Loss: 1.002 Vali Acc: 0.529 Test Loss: 1.002 Test Acc: 0.529
Validation loss decreased (-0.521728 --> -0.528975).  Saving model ...
Epoch: 4 cost time: 2.138817310333252
Epoch: 4, Steps: 9 | Train Loss: 0.901 Vali Loss: 0.900 Vali Acc: 0.601 Test Loss: 0.900 Test Acc: 0.601
Validation loss decreased (-0.528975 --> -0.601440).  Saving model ...
Epoch: 5 cost time: 1.4715049266815186
Epoch: 5, Steps: 9 | Train Loss: 0.723 Vali Loss: 0.800 Vali Acc: 0.681 Test Loss: 0.800 Test Acc: 0.681
Validation loss decreased (-0.601440 --> -0.681151).  Saving model ...
Epoch: 6 cost time: 1.3266215324401855
Epoch: 6, Steps: 9 | Train Loss: 0.585 Vali Loss: 0.708 Vali Acc: 0.703 Test Loss: 0.708 Test Acc: 0.703
Validation loss decreased (-0.681151 --> -0.702891).  Saving model ...
Epoch: 7 cost time: 1.6555767059326172
Epoch: 7, Steps: 9 | Train Loss: 0.409 Vali Loss: 0.653 Vali Acc: 0.746 Test Loss: 0.653 Test Acc: 0.746
Validation loss decreased (-0.702891 --> -0.746370).  Saving model ...
Epoch: 8 cost time: 1.3028435707092285
Epoch: 8, Steps: 9 | Train Loss: 0.296 Vali Loss: 0.543 Vali Acc: 0.754 Test Loss: 0.543 Test Acc: 0.754
Validation loss decreased (-0.746370 --> -0.753618).  Saving model ...
Epoch: 9 cost time: 1.1530027389526367
Epoch: 9, Steps: 9 | Train Loss: 0.221 Vali Loss: 0.782 Vali Acc: 0.696 Test Loss: 0.782 Test Acc: 0.696
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0780351161956787
Epoch: 10, Steps: 9 | Train Loss: 0.095 Vali Loss: 0.691 Vali Acc: 0.790 Test Loss: 0.691 Test Acc: 0.790
Validation loss decreased (-0.753618 --> -0.789848).  Saving model ...
Epoch: 11 cost time: 1.337238073348999
Epoch: 11, Steps: 9 | Train Loss: 0.062 Vali Loss: 0.569 Vali Acc: 0.819 Test Loss: 0.569 Test Acc: 0.819
Validation loss decreased (-0.789848 --> -0.818835).  Saving model ...
Epoch: 12 cost time: 1.1189682483673096
Epoch: 12, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.787 Vali Acc: 0.812 Test Loss: 0.787 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9867167472839355
Epoch: 13, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.510 Vali Acc: 0.841 Test Loss: 0.510 Test Acc: 0.841
Validation loss decreased (-0.818835 --> -0.840575).  Saving model ...
Epoch: 14 cost time: 1.3358559608459473
Epoch: 14, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.649 Vali Acc: 0.790 Test Loss: 0.649 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.5789570808410645
Epoch: 15, Steps: 9 | Train Loss: 0.011 Vali Loss: 1.006 Vali Acc: 0.826 Test Loss: 1.006 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.237804651260376
Epoch: 16, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.604 Vali Acc: 0.819 Test Loss: 0.604 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.4057209491729736
Epoch: 17, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.898 Vali Acc: 0.826 Test Loss: 0.898 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.2680282592773438
Epoch: 18, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.821 Vali Acc: 0.841 Test Loss: 0.821 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.254199743270874
Epoch: 19, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.738 Vali Acc: 0.841 Test Loss: 0.738 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.7051589488983154
Epoch: 20, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.879 Vali Acc: 0.833 Test Loss: 0.879 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.4738237857818604
Epoch: 21, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.854 Vali Acc: 0.841 Test Loss: 0.854 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.3243579864501953
Epoch: 22, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.851 Vali Acc: 0.841 Test Loss: 0.851 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.7267639636993408
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.862 Vali Acc: 0.848 Test Loss: 0.862 Test Acc: 0.848
Validation loss decreased (-0.840575 --> -0.847817).  Saving model ...
Epoch: 24 cost time: 1.8629655838012695
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.860 Vali Acc: 0.848 Test Loss: 0.860 Test Acc: 0.848
Validation loss decreased (-0.847817 --> -0.847817).  Saving model ...
Epoch: 25 cost time: 1.5005569458007812
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.867 Vali Acc: 0.848 Test Loss: 0.867 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.53731369972229
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.866 Vali Acc: 0.848 Test Loss: 0.866 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.5331573486328125
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.882 Vali Acc: 0.848 Test Loss: 0.882 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.5953216552734375
Epoch: 28, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.873 Vali Acc: 0.848 Test Loss: 0.873 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.694204330444336
Epoch: 29, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.834 Vali Acc: 0.848 Test Loss: 0.834 Test Acc: 0.848
Validation loss decreased (-0.847817 --> -0.847818).  Saving model ...
Epoch: 30 cost time: 1.4569315910339355
Epoch: 30, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.909 Vali Acc: 0.855 Test Loss: 0.909 Test Acc: 0.855
Validation loss decreased (-0.847818 --> -0.855063).  Saving model ...
Epoch: 31 cost time: 1.7309823036193848
Epoch: 31, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.925 Vali Acc: 0.848 Test Loss: 0.925 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.6425182819366455
Epoch: 32, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.902 Vali Acc: 0.848 Test Loss: 0.902 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.4257123470306396
Epoch: 33, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.838 Vali Acc: 0.841 Test Loss: 0.838 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.6710128784179688
Epoch: 34, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.845 Vali Acc: 0.855 Test Loss: 0.845 Test Acc: 0.855
Validation loss decreased (-0.855063 --> -0.855064).  Saving model ...
Epoch: 35 cost time: 1.628164291381836
Epoch: 35, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.910 Vali Acc: 0.862 Test Loss: 0.910 Test Acc: 0.862
Validation loss decreased (-0.855064 --> -0.862310).  Saving model ...
Epoch: 36 cost time: 1.792755126953125
Epoch: 36, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.933 Vali Acc: 0.870 Test Loss: 0.933 Test Acc: 0.870
Validation loss decreased (-0.862310 --> -0.869556).  Saving model ...
Epoch: 37 cost time: 1.7363908290863037
Epoch: 37, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.919 Vali Acc: 0.862 Test Loss: 0.919 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.201744556427002
Epoch: 38, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.906 Vali Acc: 0.870 Test Loss: 0.906 Test Acc: 0.870
Validation loss decreased (-0.869556 --> -0.869556).  Saving model ...
Epoch: 39 cost time: 2.186523199081421
Epoch: 39, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.881 Vali Acc: 0.862 Test Loss: 0.881 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.4603822231292725
Epoch: 40, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.881 Vali Acc: 0.848 Test Loss: 0.881 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.6764442920684814
Epoch: 41, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.891 Vali Acc: 0.855 Test Loss: 0.891 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.6863703727722168
Epoch: 42, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.910 Vali Acc: 0.855 Test Loss: 0.910 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.6992125511169434
Epoch: 43, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.911 Vali Acc: 0.855 Test Loss: 0.911 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.5135142803192139
Epoch: 44, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.886 Vali Acc: 0.855 Test Loss: 0.886 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 1.6641225814819336
Epoch: 45, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.885 Vali Acc: 0.848 Test Loss: 0.885 Test Acc: 0.848
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 1.3340706825256348
Epoch: 46, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.898 Vali Acc: 0.848 Test Loss: 0.898 Test Acc: 0.848
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 2.1854755878448486
Epoch: 47, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.920 Vali Acc: 0.862 Test Loss: 0.920 Test Acc: 0.862
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 1.748117208480835
Epoch: 48, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.939 Vali Acc: 0.870 Test Loss: 0.939 Test Acc: 0.870
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el6_dm768_df768_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8695652173913043
model parameter : 43606276
model size : 181.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el6_dm768_df768_ps11_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.7317354679107666
Epoch: 1, Steps: 9 | Train Loss: 1.430 Vali Loss: 1.393 Vali Acc: 0.239 Test Loss: 1.393 Test Acc: 0.239
Validation loss decreased (inf --> -0.239117).  Saving model ...
Epoch: 2 cost time: 1.5040507316589355
Epoch: 2, Steps: 9 | Train Loss: 1.321 Vali Loss: 1.271 Vali Acc: 0.420 Test Loss: 1.271 Test Acc: 0.420
Validation loss decreased (-0.239117 --> -0.420277).  Saving model ...
Epoch: 3 cost time: 2.2600836753845215
Epoch: 3, Steps: 9 | Train Loss: 1.186 Vali Loss: 1.141 Vali Acc: 0.522 Test Loss: 1.141 Test Acc: 0.522
Validation loss decreased (-0.420277 --> -0.521728).  Saving model ...
Epoch: 4 cost time: 1.3800344467163086
Epoch: 4, Steps: 9 | Train Loss: 1.015 Vali Loss: 1.028 Vali Acc: 0.507 Test Loss: 1.028 Test Acc: 0.507
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5616428852081299
Epoch: 5, Steps: 9 | Train Loss: 0.879 Vali Loss: 0.934 Vali Acc: 0.616 Test Loss: 0.934 Test Acc: 0.616
Validation loss decreased (-0.521728 --> -0.615933).  Saving model ...
Epoch: 6 cost time: 1.0245163440704346
Epoch: 6, Steps: 9 | Train Loss: 0.730 Vali Loss: 0.796 Vali Acc: 0.652 Test Loss: 0.796 Test Acc: 0.652
Validation loss decreased (-0.615933 --> -0.652166).  Saving model ...
Epoch: 7 cost time: 1.3436205387115479
Epoch: 7, Steps: 9 | Train Loss: 0.601 Vali Loss: 0.706 Vali Acc: 0.725 Test Loss: 0.706 Test Acc: 0.725
Validation loss decreased (-0.652166 --> -0.724631).  Saving model ...
Epoch: 8 cost time: 1.6490552425384521
Epoch: 8, Steps: 9 | Train Loss: 0.485 Vali Loss: 0.669 Vali Acc: 0.732 Test Loss: 0.669 Test Acc: 0.732
Validation loss decreased (-0.724631 --> -0.731877).  Saving model ...
Epoch: 9 cost time: 1.7086515426635742
Epoch: 9, Steps: 9 | Train Loss: 0.417 Vali Loss: 0.634 Vali Acc: 0.746 Test Loss: 0.634 Test Acc: 0.746
Validation loss decreased (-0.731877 --> -0.746370).  Saving model ...
Epoch: 10 cost time: 1.4234552383422852
Epoch: 10, Steps: 9 | Train Loss: 0.293 Vali Loss: 0.615 Vali Acc: 0.768 Test Loss: 0.615 Test Acc: 0.768
Validation loss decreased (-0.746370 --> -0.768110).  Saving model ...
Epoch: 11 cost time: 1.5768499374389648
Epoch: 11, Steps: 9 | Train Loss: 0.187 Vali Loss: 0.539 Vali Acc: 0.768 Test Loss: 0.539 Test Acc: 0.768
Validation loss decreased (-0.768110 --> -0.768111).  Saving model ...
Epoch: 12 cost time: 1.3747005462646484
Epoch: 12, Steps: 9 | Train Loss: 0.139 Vali Loss: 0.649 Vali Acc: 0.775 Test Loss: 0.649 Test Acc: 0.775
Validation loss decreased (-0.768111 --> -0.775356).  Saving model ...
Epoch: 13 cost time: 1.4426801204681396
Epoch: 13, Steps: 9 | Train Loss: 0.077 Vali Loss: 0.546 Vali Acc: 0.812 Test Loss: 0.546 Test Acc: 0.812
Validation loss decreased (-0.775356 --> -0.811589).  Saving model ...
Epoch: 14 cost time: 1.4509341716766357
Epoch: 14, Steps: 9 | Train Loss: 0.053 Vali Loss: 0.593 Vali Acc: 0.790 Test Loss: 0.593 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.6305391788482666
Epoch: 15, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.935 Vali Acc: 0.746 Test Loss: 0.935 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.7008416652679443
Epoch: 16, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.580 Vali Acc: 0.797 Test Loss: 0.580 Test Acc: 0.797
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.3623695373535156
Epoch: 17, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.908 Vali Acc: 0.775 Test Loss: 0.908 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.5828149318695068
Epoch: 18, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.760 Vali Acc: 0.775 Test Loss: 0.760 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.5896308422088623
Epoch: 19, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.752 Vali Acc: 0.797 Test Loss: 0.752 Test Acc: 0.797
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.4729745388031006
Epoch: 20, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.907 Vali Acc: 0.790 Test Loss: 0.907 Test Acc: 0.790
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.5737316608428955
Epoch: 21, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.909 Vali Acc: 0.804 Test Loss: 0.909 Test Acc: 0.804
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.7267091274261475
Epoch: 22, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.757 Vali Acc: 0.819 Test Loss: 0.757 Test Acc: 0.819
Validation loss decreased (-0.811589 --> -0.818833).  Saving model ...
Epoch: 23 cost time: 1.8343596458435059
Epoch: 23, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.932 Vali Acc: 0.790 Test Loss: 0.932 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.504591703414917
Epoch: 24, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.854 Vali Acc: 0.783 Test Loss: 0.854 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.3881633281707764
Epoch: 25, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.848 Vali Acc: 0.790 Test Loss: 0.848 Test Acc: 0.790
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.1867690086364746
Epoch: 26, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.994 Vali Acc: 0.797 Test Loss: 0.994 Test Acc: 0.797
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.0062146186828613
Epoch: 27, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.894 Vali Acc: 0.804 Test Loss: 0.894 Test Acc: 0.804
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.086101770401001
Epoch: 28, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.852 Vali Acc: 0.804 Test Loss: 0.852 Test Acc: 0.804
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.1286437511444092
Epoch: 29, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.896 Vali Acc: 0.804 Test Loss: 0.896 Test Acc: 0.804
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.458923101425171
Epoch: 30, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.949 Vali Acc: 0.797 Test Loss: 0.949 Test Acc: 0.797
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.4030749797821045
Epoch: 31, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.965 Vali Acc: 0.790 Test Loss: 0.965 Test Acc: 0.790
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.4010844230651855
Epoch: 32, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.828 Vali Acc: 0.804 Test Loss: 0.828 Test Acc: 0.804
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el6_dm768_df768_ps11_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8188405797101449
model parameter : 43537156
model size : 180.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el6_dm768_df768_ps12_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.004279851913452
Epoch: 1, Steps: 9 | Train Loss: 1.457 Vali Loss: 1.286 Vali Acc: 0.543 Test Loss: 1.286 Test Acc: 0.543
Validation loss decreased (inf --> -0.543465).  Saving model ...
Epoch: 2 cost time: 2.544393301010132
Epoch: 2, Steps: 9 | Train Loss: 1.196 Vali Loss: 1.087 Vali Acc: 0.580 Test Loss: 1.087 Test Acc: 0.580
Validation loss decreased (-0.543465 --> -0.579699).  Saving model ...
Epoch: 3 cost time: 2.0493736267089844
Epoch: 3, Steps: 9 | Train Loss: 0.876 Vali Loss: 0.871 Vali Acc: 0.580 Test Loss: 0.871 Test Acc: 0.580
Validation loss decreased (-0.579699 --> -0.579701).  Saving model ...
Epoch: 4 cost time: 2.2581610679626465
Epoch: 4, Steps: 9 | Train Loss: 0.635 Vali Loss: 1.018 Vali Acc: 0.623 Test Loss: 1.018 Test Acc: 0.623
Validation loss decreased (-0.579701 --> -0.623178).  Saving model ...
Epoch: 5 cost time: 1.6623940467834473
Epoch: 5, Steps: 9 | Train Loss: 0.527 Vali Loss: 0.668 Vali Acc: 0.717 Test Loss: 0.668 Test Acc: 0.717
Validation loss decreased (-0.623178 --> -0.717385).  Saving model ...
Epoch: 6 cost time: 2.165271043777466
Epoch: 6, Steps: 9 | Train Loss: 0.397 Vali Loss: 0.882 Vali Acc: 0.681 Test Loss: 0.882 Test Acc: 0.681
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.2318179607391357
Epoch: 7, Steps: 9 | Train Loss: 0.262 Vali Loss: 0.525 Vali Acc: 0.841 Test Loss: 0.525 Test Acc: 0.841
Validation loss decreased (-0.717385 --> -0.840574).  Saving model ...
Epoch: 8 cost time: 2.36726713180542
Epoch: 8, Steps: 9 | Train Loss: 0.121 Vali Loss: 0.911 Vali Acc: 0.775 Test Loss: 0.911 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.859058141708374
Epoch: 9, Steps: 9 | Train Loss: 0.108 Vali Loss: 0.920 Vali Acc: 0.739 Test Loss: 0.920 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.8562538623809814
Epoch: 10, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.738 Vali Acc: 0.841 Test Loss: 0.738 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.714742660522461
Epoch: 11, Steps: 9 | Train Loss: 0.018 Vali Loss: 1.011 Vali Acc: 0.826 Test Loss: 1.011 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.5068657398223877
Epoch: 12, Steps: 9 | Train Loss: 0.020 Vali Loss: 1.036 Vali Acc: 0.812 Test Loss: 1.036 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.8431289196014404
Epoch: 13, Steps: 9 | Train Loss: 0.016 Vali Loss: 1.015 Vali Acc: 0.826 Test Loss: 1.015 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.891660451889038
Epoch: 14, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.977 Vali Acc: 0.848 Test Loss: 0.977 Test Acc: 0.848
Validation loss decreased (-0.840574 --> -0.847816).  Saving model ...
Epoch: 15 cost time: 2.5923233032226562
Epoch: 15, Steps: 9 | Train Loss: 0.006 Vali Loss: 1.238 Vali Acc: 0.848 Test Loss: 1.238 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.279740333557129
Epoch: 16, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.192 Vali Acc: 0.797 Test Loss: 1.192 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.1999876499176025
Epoch: 17, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.076 Vali Acc: 0.841 Test Loss: 1.076 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.2632105350494385
Epoch: 18, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.078 Vali Acc: 0.826 Test Loss: 1.078 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.706408977508545
Epoch: 19, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.032 Vali Acc: 0.848 Test Loss: 1.032 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.2088851928710938
Epoch: 20, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.063 Vali Acc: 0.848 Test Loss: 1.063 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.6239426136016846
Epoch: 21, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.091 Vali Acc: 0.855 Test Loss: 1.091 Test Acc: 0.855
Validation loss decreased (-0.847816 --> -0.855062).  Saving model ...
Epoch: 22 cost time: 2.404134750366211
Epoch: 22, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.128 Vali Acc: 0.848 Test Loss: 1.128 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.8835525512695312
Epoch: 23, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.141 Vali Acc: 0.841 Test Loss: 1.141 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.7910470962524414
Epoch: 24, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.136 Vali Acc: 0.848 Test Loss: 1.136 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.029789447784424
Epoch: 25, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.124 Vali Acc: 0.848 Test Loss: 1.124 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.8621985912323
Epoch: 26, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.124 Vali Acc: 0.848 Test Loss: 1.124 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.789098024368286
Epoch: 27, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.113 Vali Acc: 0.855 Test Loss: 1.113 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 3.1210169792175293
Epoch: 28, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.097 Vali Acc: 0.855 Test Loss: 1.097 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 3.0311970710754395
Epoch: 29, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.081 Vali Acc: 0.862 Test Loss: 1.081 Test Acc: 0.862
Validation loss decreased (-0.855062 --> -0.862308).  Saving model ...
Epoch: 30 cost time: 2.82413911819458
Epoch: 30, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.073 Vali Acc: 0.862 Test Loss: 1.073 Test Acc: 0.862
Validation loss decreased (-0.862308 --> -0.862308).  Saving model ...
Epoch: 31 cost time: 2.5001728534698486
Epoch: 31, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.064 Vali Acc: 0.862 Test Loss: 1.064 Test Acc: 0.862
Validation loss decreased (-0.862308 --> -0.862308).  Saving model ...
Epoch: 32 cost time: 2.4540045261383057
Epoch: 32, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.055 Vali Acc: 0.862 Test Loss: 1.055 Test Acc: 0.862
Validation loss decreased (-0.862308 --> -0.862308).  Saving model ...
Epoch: 33 cost time: 2.198188304901123
Epoch: 33, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.019 Vali Acc: 0.862 Test Loss: 1.019 Test Acc: 0.862
Validation loss decreased (-0.862308 --> -0.862309).  Saving model ...
Epoch: 34 cost time: 2.470836877822876
Epoch: 34, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.020 Vali Acc: 0.862 Test Loss: 1.020 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 2.5790154933929443
Epoch: 35, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.033 Vali Acc: 0.862 Test Loss: 1.033 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 2.937197208404541
Epoch: 36, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.045 Vali Acc: 0.862 Test Loss: 1.045 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 3.3126208782196045
Epoch: 37, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.051 Vali Acc: 0.870 Test Loss: 1.051 Test Acc: 0.870
Validation loss decreased (-0.862309 --> -0.869555).  Saving model ...
Epoch: 38 cost time: 3.102501630783081
Epoch: 38, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.053 Vali Acc: 0.862 Test Loss: 1.053 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 2.732943058013916
Epoch: 39, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.048 Vali Acc: 0.870 Test Loss: 1.048 Test Acc: 0.870
Validation loss decreased (-0.869555 --> -0.869555).  Saving model ...
Epoch: 40 cost time: 2.9024498462677
Epoch: 40, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.038 Vali Acc: 0.877 Test Loss: 1.038 Test Acc: 0.877
Validation loss decreased (-0.869555 --> -0.876801).  Saving model ...
Epoch: 41 cost time: 2.025280475616455
Epoch: 41, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.041 Vali Acc: 0.877 Test Loss: 1.041 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.5765974521636963
Epoch: 42, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.039 Vali Acc: 0.877 Test Loss: 1.039 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 2.0969696044921875
Epoch: 43, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.041 Vali Acc: 0.877 Test Loss: 1.041 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.9070496559143066
Epoch: 44, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.044 Vali Acc: 0.877 Test Loss: 1.044 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 2.3393609523773193
Epoch: 45, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.047 Vali Acc: 0.877 Test Loss: 1.047 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.459035873413086
Epoch: 46, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.049 Vali Acc: 0.877 Test Loss: 1.049 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.734546422958374
Epoch: 47, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.033 Vali Acc: 0.877 Test Loss: 1.033 Test Acc: 0.877
Validation loss decreased (-0.876801 --> -0.876801).  Saving model ...
Epoch: 48 cost time: 1.7899653911590576
Epoch: 48, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.039 Vali Acc: 0.877 Test Loss: 1.039 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 2.0253746509552
Epoch: 49, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.048 Vali Acc: 0.877 Test Loss: 1.048 Test Acc: 0.877
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.9563100337982178
Epoch: 50, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.087 Vali Acc: 0.870 Test Loss: 1.087 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el6_dm768_df768_ps12_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8768115942028986
model parameter : 43760644
model size : 181.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el6_dm768_df768_ps12_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.150113344192505
Epoch: 1, Steps: 9 | Train Loss: 1.398 Vali Loss: 1.350 Vali Acc: 0.312 Test Loss: 1.350 Test Acc: 0.312
Validation loss decreased (inf --> -0.311581).  Saving model ...
Epoch: 2 cost time: 1.7006258964538574
Epoch: 2, Steps: 9 | Train Loss: 1.258 Vali Loss: 1.171 Vali Acc: 0.442 Test Loss: 1.171 Test Acc: 0.442
Validation loss decreased (-0.311581 --> -0.442017).  Saving model ...
Epoch: 3 cost time: 1.5689444541931152
Epoch: 3, Steps: 9 | Train Loss: 1.101 Vali Loss: 1.038 Vali Acc: 0.645 Test Loss: 1.038 Test Acc: 0.645
Validation loss decreased (-0.442017 --> -0.644917).  Saving model ...
Epoch: 4 cost time: 1.7626211643218994
Epoch: 4, Steps: 9 | Train Loss: 0.887 Vali Loss: 0.891 Vali Acc: 0.630 Test Loss: 0.891 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5463337898254395
Epoch: 5, Steps: 9 | Train Loss: 0.744 Vali Loss: 0.808 Vali Acc: 0.681 Test Loss: 0.808 Test Acc: 0.681
Validation loss decreased (-0.644917 --> -0.681151).  Saving model ...
Epoch: 6 cost time: 1.249488115310669
Epoch: 6, Steps: 9 | Train Loss: 0.562 Vali Loss: 0.738 Vali Acc: 0.674 Test Loss: 0.738 Test Acc: 0.674
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.8005850315093994
Epoch: 7, Steps: 9 | Train Loss: 0.360 Vali Loss: 0.640 Vali Acc: 0.775 Test Loss: 0.640 Test Acc: 0.775
Validation loss decreased (-0.681151 --> -0.775356).  Saving model ...
Epoch: 8 cost time: 1.458810567855835
Epoch: 8, Steps: 9 | Train Loss: 0.274 Vali Loss: 0.927 Vali Acc: 0.674 Test Loss: 0.927 Test Acc: 0.674
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.119992971420288
Epoch: 9, Steps: 9 | Train Loss: 0.114 Vali Loss: 0.920 Vali Acc: 0.768 Test Loss: 0.920 Test Acc: 0.768
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.1542699337005615
Epoch: 10, Steps: 9 | Train Loss: 0.095 Vali Loss: 0.678 Vali Acc: 0.775 Test Loss: 0.678 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.2811493873596191
Epoch: 11, Steps: 9 | Train Loss: 0.065 Vali Loss: 1.127 Vali Acc: 0.739 Test Loss: 1.127 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.153681755065918
Epoch: 12, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.847 Vali Acc: 0.819 Test Loss: 0.847 Test Acc: 0.819
Validation loss decreased (-0.775356 --> -0.818832).  Saving model ...
Epoch: 13 cost time: 1.2647900581359863
Epoch: 13, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.923 Vali Acc: 0.804 Test Loss: 0.923 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.5774047374725342
Epoch: 14, Steps: 9 | Train Loss: 0.009 Vali Loss: 1.155 Vali Acc: 0.804 Test Loss: 1.155 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.3524985313415527
Epoch: 15, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.944 Vali Acc: 0.804 Test Loss: 0.944 Test Acc: 0.804
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.5082380771636963
Epoch: 16, Steps: 9 | Train Loss: 0.009 Vali Loss: 1.006 Vali Acc: 0.768 Test Loss: 1.006 Test Acc: 0.768
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.0265166759490967
Epoch: 17, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.942 Vali Acc: 0.804 Test Loss: 0.942 Test Acc: 0.804
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.3024957180023193
Epoch: 18, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.030 Vali Acc: 0.819 Test Loss: 1.030 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.214625358581543
Epoch: 19, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.996 Vali Acc: 0.812 Test Loss: 0.996 Test Acc: 0.812
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.3247661590576172
Epoch: 20, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.027 Vali Acc: 0.826 Test Loss: 1.027 Test Acc: 0.826
Validation loss decreased (-0.818832 --> -0.826077).  Saving model ...
Epoch: 21 cost time: 1.2131264209747314
Epoch: 21, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.209 Vali Acc: 0.783 Test Loss: 1.209 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.4988319873809814
Epoch: 22, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.933 Vali Acc: 0.819 Test Loss: 0.933 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.3170435428619385
Epoch: 23, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.926 Vali Acc: 0.819 Test Loss: 0.926 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.2636892795562744
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.881 Vali Acc: 0.819 Test Loss: 0.881 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.2141318321228027
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.939 Vali Acc: 0.812 Test Loss: 0.939 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.193690299987793
Epoch: 26, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.001 Vali Acc: 0.812 Test Loss: 1.001 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.9046499729156494
Epoch: 27, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.039 Vali Acc: 0.812 Test Loss: 1.039 Test Acc: 0.812
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.9369823932647705
Epoch: 28, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.020 Vali Acc: 0.812 Test Loss: 1.020 Test Acc: 0.812
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.0040762424468994
Epoch: 29, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.990 Vali Acc: 0.819 Test Loss: 0.990 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.1784605979919434
Epoch: 30, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.995 Vali Acc: 0.819 Test Loss: 0.995 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el6_dm768_df768_ps12_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8260869565217391
model parameter : 43613188
model size : 181.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el6_dm768_df768_ps12_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.1761040687561035
Epoch: 1, Steps: 9 | Train Loss: 1.448 Vali Loss: 1.397 Vali Acc: 0.225 Test Loss: 1.397 Test Acc: 0.225
Validation loss decreased (inf --> -0.224624).  Saving model ...
Epoch: 2 cost time: 1.8196399211883545
Epoch: 2, Steps: 9 | Train Loss: 1.365 Vali Loss: 1.284 Vali Acc: 0.471 Test Loss: 1.284 Test Acc: 0.471
Validation loss decreased (-0.224624 --> -0.471002).  Saving model ...
Epoch: 3 cost time: 2.128967761993408
Epoch: 3, Steps: 9 | Train Loss: 1.247 Vali Loss: 1.157 Vali Acc: 0.558 Test Loss: 1.157 Test Acc: 0.558
Validation loss decreased (-0.471002 --> -0.557959).  Saving model ...
Epoch: 4 cost time: 2.254411458969116
Epoch: 4, Steps: 9 | Train Loss: 1.102 Vali Loss: 1.044 Vali Acc: 0.601 Test Loss: 1.044 Test Acc: 0.601
Validation loss decreased (-0.557959 --> -0.601439).  Saving model ...
Epoch: 5 cost time: 1.871241807937622
Epoch: 5, Steps: 9 | Train Loss: 0.961 Vali Loss: 0.938 Vali Acc: 0.623 Test Loss: 0.938 Test Acc: 0.623
Validation loss decreased (-0.601439 --> -0.623179).  Saving model ...
Epoch: 6 cost time: 1.9983062744140625
Epoch: 6, Steps: 9 | Train Loss: 0.801 Vali Loss: 0.861 Vali Acc: 0.645 Test Loss: 0.861 Test Acc: 0.645
Validation loss decreased (-0.623179 --> -0.644919).  Saving model ...
Epoch: 7 cost time: 1.097672939300537
Epoch: 7, Steps: 9 | Train Loss: 0.625 Vali Loss: 0.766 Vali Acc: 0.696 Test Loss: 0.766 Test Acc: 0.696
Validation loss decreased (-0.644919 --> -0.695645).  Saving model ...
Epoch: 8 cost time: 1.932481050491333
Epoch: 8, Steps: 9 | Train Loss: 0.459 Vali Loss: 0.888 Vali Acc: 0.601 Test Loss: 0.888 Test Acc: 0.601
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6102991104125977
Epoch: 9, Steps: 9 | Train Loss: 0.466 Vali Loss: 0.710 Vali Acc: 0.746 Test Loss: 0.710 Test Acc: 0.746
Validation loss decreased (-0.695645 --> -0.746370).  Saving model ...
Epoch: 10 cost time: 2.0029995441436768
Epoch: 10, Steps: 9 | Train Loss: 0.271 Vali Loss: 0.817 Vali Acc: 0.717 Test Loss: 0.817 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.060481309890747
Epoch: 11, Steps: 9 | Train Loss: 0.202 Vali Loss: 0.744 Vali Acc: 0.703 Test Loss: 0.744 Test Acc: 0.703
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.0357580184936523
Epoch: 12, Steps: 9 | Train Loss: 0.108 Vali Loss: 0.935 Vali Acc: 0.746 Test Loss: 0.935 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.249617338180542
Epoch: 13, Steps: 9 | Train Loss: 0.074 Vali Loss: 0.680 Vali Acc: 0.754 Test Loss: 0.680 Test Acc: 0.754
Validation loss decreased (-0.746370 --> -0.753616).  Saving model ...
Epoch: 14 cost time: 1.739530086517334
Epoch: 14, Steps: 9 | Train Loss: 0.058 Vali Loss: 0.770 Vali Acc: 0.746 Test Loss: 0.770 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.7840464115142822
Epoch: 15, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.788 Vali Acc: 0.768 Test Loss: 0.788 Test Acc: 0.768
Validation loss decreased (-0.753616 --> -0.768108).  Saving model ...
Epoch: 16 cost time: 1.6936132907867432
Epoch: 16, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.759 Vali Acc: 0.812 Test Loss: 0.759 Test Acc: 0.812
Validation loss decreased (-0.768108 --> -0.811587).  Saving model ...
Epoch: 17 cost time: 1.5037078857421875
Epoch: 17, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.934 Vali Acc: 0.761 Test Loss: 0.934 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.1673245429992676
Epoch: 18, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.672 Vali Acc: 0.826 Test Loss: 0.672 Test Acc: 0.826
Validation loss decreased (-0.811587 --> -0.826080).  Saving model ...
Epoch: 19 cost time: 1.5964183807373047
Epoch: 19, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.804 Vali Acc: 0.775 Test Loss: 0.804 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.6315174102783203
Epoch: 20, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.867 Vali Acc: 0.768 Test Loss: 0.867 Test Acc: 0.768
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.5777616500854492
Epoch: 21, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.838 Vali Acc: 0.790 Test Loss: 0.838 Test Acc: 0.790
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.6959569454193115
Epoch: 22, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.790 Vali Acc: 0.797 Test Loss: 0.790 Test Acc: 0.797
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.7793645858764648
Epoch: 23, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.827 Vali Acc: 0.783 Test Loss: 0.827 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.9744811058044434
Epoch: 24, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.873 Vali Acc: 0.775 Test Loss: 0.873 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.6837377548217773
Epoch: 25, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.895 Vali Acc: 0.775 Test Loss: 0.895 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.2521793842315674
Epoch: 26, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.852 Vali Acc: 0.790 Test Loss: 0.852 Test Acc: 0.790
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.5650465488433838
Epoch: 27, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.787 Vali Acc: 0.797 Test Loss: 0.787 Test Acc: 0.797
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.987896203994751
Epoch: 28, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.822 Vali Acc: 0.797 Test Loss: 0.822 Test Acc: 0.797
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el6_dm768_df768_ps12_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8260869565217391
model parameter : 43539460
model size : 180.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el6_dm768_df768_ps13_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.126033782958984
Epoch: 1, Steps: 9 | Train Loss: 1.466 Vali Loss: 1.297 Vali Acc: 0.348 Test Loss: 1.297 Test Acc: 0.348
Validation loss decreased (inf --> -0.347813).  Saving model ...
Epoch: 2 cost time: 2.284505844116211
Epoch: 2, Steps: 9 | Train Loss: 1.297 Vali Loss: 1.104 Vali Acc: 0.580 Test Loss: 1.104 Test Acc: 0.580
Validation loss decreased (-0.347813 --> -0.579699).  Saving model ...
Epoch: 3 cost time: 2.7202582359313965
Epoch: 3, Steps: 9 | Train Loss: 1.003 Vali Loss: 0.920 Vali Acc: 0.667 Test Loss: 0.920 Test Acc: 0.667
Validation loss decreased (-0.579699 --> -0.666657).  Saving model ...
Epoch: 4 cost time: 2.340510606765747
Epoch: 4, Steps: 9 | Train Loss: 0.831 Vali Loss: 0.814 Vali Acc: 0.630 Test Loss: 0.814 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.399747610092163
Epoch: 5, Steps: 9 | Train Loss: 0.649 Vali Loss: 0.700 Vali Acc: 0.681 Test Loss: 0.700 Test Acc: 0.681
Validation loss decreased (-0.666657 --> -0.681152).  Saving model ...
Epoch: 6 cost time: 2.4354944229125977
Epoch: 6, Steps: 9 | Train Loss: 0.479 Vali Loss: 0.670 Vali Acc: 0.754 Test Loss: 0.670 Test Acc: 0.754
Validation loss decreased (-0.681152 --> -0.753616).  Saving model ...
Epoch: 7 cost time: 2.3480429649353027
Epoch: 7, Steps: 9 | Train Loss: 0.337 Vali Loss: 0.605 Vali Acc: 0.732 Test Loss: 0.605 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.708360195159912
Epoch: 8, Steps: 9 | Train Loss: 0.220 Vali Loss: 0.594 Vali Acc: 0.775 Test Loss: 0.594 Test Acc: 0.775
Validation loss decreased (-0.753616 --> -0.775356).  Saving model ...
Epoch: 9 cost time: 2.0378949642181396
Epoch: 9, Steps: 9 | Train Loss: 0.116 Vali Loss: 0.556 Vali Acc: 0.841 Test Loss: 0.556 Test Acc: 0.841
Validation loss decreased (-0.775356 --> -0.840574).  Saving model ...
Epoch: 10 cost time: 1.793156385421753
Epoch: 10, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.960 Vali Acc: 0.754 Test Loss: 0.960 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7509067058563232
Epoch: 11, Steps: 9 | Train Loss: 0.080 Vali Loss: 0.733 Vali Acc: 0.841 Test Loss: 0.733 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.9679522514343262
Epoch: 12, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.989 Vali Acc: 0.804 Test Loss: 0.989 Test Acc: 0.804
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.6203811168670654
Epoch: 13, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.704 Vali Acc: 0.848 Test Loss: 0.704 Test Acc: 0.848
Validation loss decreased (-0.840574 --> -0.847819).  Saving model ...
Epoch: 14 cost time: 2.1708626747131348
Epoch: 14, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.923 Vali Acc: 0.841 Test Loss: 0.923 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.569115400314331
Epoch: 15, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.695 Vali Acc: 0.862 Test Loss: 0.695 Test Acc: 0.862
Validation loss decreased (-0.847819 --> -0.862312).  Saving model ...
Epoch: 16 cost time: 1.9793486595153809
Epoch: 16, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.342 Vali Acc: 0.833 Test Loss: 1.342 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.8937337398529053
Epoch: 17, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.633 Vali Acc: 0.862 Test Loss: 0.633 Test Acc: 0.862
Validation loss decreased (-0.862312 --> -0.862313).  Saving model ...
Epoch: 18 cost time: 1.9123010635375977
Epoch: 18, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.080 Vali Acc: 0.819 Test Loss: 1.080 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.1818857192993164
Epoch: 19, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.309 Vali Acc: 0.754 Test Loss: 1.309 Test Acc: 0.754
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.0402915477752686
Epoch: 20, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.264 Vali Acc: 0.833 Test Loss: 1.264 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.325904130935669
Epoch: 21, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.125 Vali Acc: 0.826 Test Loss: 1.125 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.1865274906158447
Epoch: 22, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.322 Vali Acc: 0.819 Test Loss: 1.322 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.8216090202331543
Epoch: 23, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.204 Vali Acc: 0.833 Test Loss: 1.204 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.013988494873047
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.969 Vali Acc: 0.855 Test Loss: 0.969 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.7405602931976318
Epoch: 25, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.991 Vali Acc: 0.855 Test Loss: 0.991 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.9615485668182373
Epoch: 26, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.025 Vali Acc: 0.855 Test Loss: 1.025 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.4618744850158691
Epoch: 27, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.030 Vali Acc: 0.855 Test Loss: 1.030 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el6_dm768_df768_ps13_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8623188405797102
model parameter : 43693828
model size : 181.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el6_dm768_df768_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.579616069793701
Epoch: 1, Steps: 9 | Train Loss: 1.415 Vali Loss: 1.330 Vali Acc: 0.348 Test Loss: 1.330 Test Acc: 0.348
Validation loss decreased (inf --> -0.347813).  Saving model ...
Epoch: 2 cost time: 2.1257359981536865
Epoch: 2, Steps: 9 | Train Loss: 1.328 Vali Loss: 1.178 Vali Acc: 0.580 Test Loss: 1.178 Test Acc: 0.580
Validation loss decreased (-0.347813 --> -0.579698).  Saving model ...
Epoch: 3 cost time: 2.065359592437744
Epoch: 3, Steps: 9 | Train Loss: 1.136 Vali Loss: 1.029 Vali Acc: 0.601 Test Loss: 1.029 Test Acc: 0.601
Validation loss decreased (-0.579698 --> -0.601439).  Saving model ...
Epoch: 4 cost time: 1.1746127605438232
Epoch: 4, Steps: 9 | Train Loss: 0.982 Vali Loss: 0.897 Vali Acc: 0.659 Test Loss: 0.897 Test Acc: 0.659
Validation loss decreased (-0.601439 --> -0.659411).  Saving model ...
Epoch: 5 cost time: 1.6331617832183838
Epoch: 5, Steps: 9 | Train Loss: 0.771 Vali Loss: 0.813 Vali Acc: 0.667 Test Loss: 0.813 Test Acc: 0.667
Validation loss decreased (-0.659411 --> -0.666659).  Saving model ...
Epoch: 6 cost time: 1.746718168258667
Epoch: 6, Steps: 9 | Train Loss: 0.600 Vali Loss: 0.690 Vali Acc: 0.754 Test Loss: 0.690 Test Acc: 0.754
Validation loss decreased (-0.666659 --> -0.753616).  Saving model ...
Epoch: 7 cost time: 2.006103515625
Epoch: 7, Steps: 9 | Train Loss: 0.466 Vali Loss: 0.754 Vali Acc: 0.717 Test Loss: 0.754 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.0378551483154297
Epoch: 8, Steps: 9 | Train Loss: 0.327 Vali Loss: 0.600 Vali Acc: 0.710 Test Loss: 0.600 Test Acc: 0.710
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.735335111618042
Epoch: 9, Steps: 9 | Train Loss: 0.226 Vali Loss: 0.889 Vali Acc: 0.703 Test Loss: 0.889 Test Acc: 0.703
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.6673505306243896
Epoch: 10, Steps: 9 | Train Loss: 0.142 Vali Loss: 0.598 Vali Acc: 0.819 Test Loss: 0.598 Test Acc: 0.819
Validation loss decreased (-0.753616 --> -0.818835).  Saving model ...
Epoch: 11 cost time: 1.9885542392730713
Epoch: 11, Steps: 9 | Train Loss: 0.055 Vali Loss: 0.808 Vali Acc: 0.768 Test Loss: 0.808 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.156667709350586
Epoch: 12, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.696 Vali Acc: 0.812 Test Loss: 0.696 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.07199764251709
Epoch: 13, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.980 Vali Acc: 0.812 Test Loss: 0.980 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.993384599685669
Epoch: 14, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.734 Vali Acc: 0.826 Test Loss: 0.734 Test Acc: 0.826
Validation loss decreased (-0.818835 --> -0.826080).  Saving model ...
Epoch: 15 cost time: 1.7101337909698486
Epoch: 15, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.865 Vali Acc: 0.812 Test Loss: 0.865 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.440953016281128
Epoch: 16, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.839 Vali Acc: 0.812 Test Loss: 0.839 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.597825527191162
Epoch: 17, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.834 Vali Acc: 0.819 Test Loss: 0.834 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.7205989360809326
Epoch: 18, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.916 Vali Acc: 0.804 Test Loss: 0.916 Test Acc: 0.804
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.7712550163269043
Epoch: 19, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.999 Vali Acc: 0.804 Test Loss: 0.999 Test Acc: 0.804
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.860840082168579
Epoch: 20, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.654 Vali Acc: 0.870 Test Loss: 0.654 Test Acc: 0.870
Validation loss decreased (-0.826080 --> -0.869559).  Saving model ...
Epoch: 21 cost time: 2.0956814289093018
Epoch: 21, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.015 Vali Acc: 0.812 Test Loss: 1.015 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.8501787185668945
Epoch: 22, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.132 Vali Acc: 0.812 Test Loss: 1.132 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.1308743953704834
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.907 Vali Acc: 0.826 Test Loss: 0.907 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.8515195846557617
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.838 Vali Acc: 0.819 Test Loss: 0.838 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.296962261199951
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.851 Vali Acc: 0.819 Test Loss: 0.851 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.280846357345581
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.910 Vali Acc: 0.812 Test Loss: 0.910 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.9467239379882812
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.960 Vali Acc: 0.826 Test Loss: 0.960 Test Acc: 0.826
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.8353569507598877
Epoch: 28, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.925 Vali Acc: 0.819 Test Loss: 0.925 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.051872730255127
Epoch: 29, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.855 Vali Acc: 0.826 Test Loss: 0.855 Test Acc: 0.826
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.903792142868042
Epoch: 30, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.862 Vali Acc: 0.819 Test Loss: 0.862 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el6_dm768_df768_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8695652173913043
model parameter : 43597060
model size : 180.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el6_dm768_df768_ps13_str13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.6078736782073975
Epoch: 1, Steps: 9 | Train Loss: 1.486 Vali Loss: 1.443 Vali Acc: 0.167 Test Loss: 1.443 Test Acc: 0.167
Validation loss decreased (inf --> -0.166652).  Saving model ...
Epoch: 2 cost time: 1.4552199840545654
Epoch: 2, Steps: 9 | Train Loss: 1.380 Vali Loss: 1.310 Vali Acc: 0.348 Test Loss: 1.310 Test Acc: 0.348
Validation loss decreased (-0.166652 --> -0.347813).  Saving model ...
Epoch: 3 cost time: 1.3301970958709717
Epoch: 3, Steps: 9 | Train Loss: 1.247 Vali Loss: 1.190 Vali Acc: 0.572 Test Loss: 1.190 Test Acc: 0.572
Validation loss decreased (-0.347813 --> -0.572452).  Saving model ...
Epoch: 4 cost time: 1.0784687995910645
Epoch: 4, Steps: 9 | Train Loss: 1.108 Vali Loss: 1.073 Vali Acc: 0.587 Test Loss: 1.073 Test Acc: 0.587
Validation loss decreased (-0.572452 --> -0.586946).  Saving model ...
Epoch: 5 cost time: 1.0483129024505615
Epoch: 5, Steps: 9 | Train Loss: 0.974 Vali Loss: 0.974 Vali Acc: 0.645 Test Loss: 0.974 Test Acc: 0.645
Validation loss decreased (-0.586946 --> -0.644918).  Saving model ...
Epoch: 6 cost time: 1.3936092853546143
Epoch: 6, Steps: 9 | Train Loss: 0.829 Vali Loss: 0.889 Vali Acc: 0.659 Test Loss: 0.889 Test Acc: 0.659
Validation loss decreased (-0.644918 --> -0.659411).  Saving model ...
Epoch: 7 cost time: 1.3872768878936768
Epoch: 7, Steps: 9 | Train Loss: 0.670 Vali Loss: 0.773 Vali Acc: 0.681 Test Loss: 0.773 Test Acc: 0.681
Validation loss decreased (-0.659411 --> -0.681152).  Saving model ...
Epoch: 8 cost time: 1.0605034828186035
Epoch: 8, Steps: 9 | Train Loss: 0.527 Vali Loss: 0.789 Vali Acc: 0.645 Test Loss: 0.789 Test Acc: 0.645
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2286145687103271
Epoch: 9, Steps: 9 | Train Loss: 0.392 Vali Loss: 0.655 Vali Acc: 0.725 Test Loss: 0.655 Test Acc: 0.725
Validation loss decreased (-0.681152 --> -0.724631).  Saving model ...
Epoch: 10 cost time: 1.2378230094909668
Epoch: 10, Steps: 9 | Train Loss: 0.253 Vali Loss: 0.889 Vali Acc: 0.652 Test Loss: 0.889 Test Acc: 0.652
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1097636222839355
Epoch: 11, Steps: 9 | Train Loss: 0.207 Vali Loss: 0.627 Vali Acc: 0.783 Test Loss: 0.627 Test Acc: 0.783
Validation loss decreased (-0.724631 --> -0.782602).  Saving model ...
Epoch: 12 cost time: 1.2830419540405273
Epoch: 12, Steps: 9 | Train Loss: 0.149 Vali Loss: 0.879 Vali Acc: 0.710 Test Loss: 0.879 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.254812240600586
Epoch: 13, Steps: 9 | Train Loss: 0.105 Vali Loss: 0.621 Vali Acc: 0.804 Test Loss: 0.621 Test Acc: 0.804
Validation loss decreased (-0.782602 --> -0.804342).  Saving model ...
Epoch: 14 cost time: 1.3223676681518555
Epoch: 14, Steps: 9 | Train Loss: 0.059 Vali Loss: 0.726 Vali Acc: 0.746 Test Loss: 0.726 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1926443576812744
Epoch: 15, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.801 Vali Acc: 0.790 Test Loss: 0.801 Test Acc: 0.790
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.3725979328155518
Epoch: 16, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.771 Vali Acc: 0.775 Test Loss: 0.771 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.361004114151001
Epoch: 17, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.735 Vali Acc: 0.804 Test Loss: 0.735 Test Acc: 0.804
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.1050570011138916
Epoch: 18, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.798 Vali Acc: 0.761 Test Loss: 0.798 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.2017223834991455
Epoch: 19, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.946 Vali Acc: 0.761 Test Loss: 0.946 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.159012794494629
Epoch: 20, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.810 Vali Acc: 0.812 Test Loss: 0.810 Test Acc: 0.812
Validation loss decreased (-0.804342 --> -0.811586).  Saving model ...
Epoch: 21 cost time: 1.2144644260406494
Epoch: 21, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.960 Vali Acc: 0.797 Test Loss: 0.960 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2294507026672363
Epoch: 22, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.765 Vali Acc: 0.812 Test Loss: 0.765 Test Acc: 0.812
Validation loss decreased (-0.811586 --> -0.811587).  Saving model ...
Epoch: 23 cost time: 1.222749948501587
Epoch: 23, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.829 Vali Acc: 0.797 Test Loss: 0.829 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.1503982543945312
Epoch: 24, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.897 Vali Acc: 0.812 Test Loss: 0.897 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.1695330142974854
Epoch: 25, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.799 Vali Acc: 0.812 Test Loss: 0.799 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.2335457801818848
Epoch: 26, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.848 Vali Acc: 0.804 Test Loss: 0.848 Test Acc: 0.804
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.193098783493042
Epoch: 27, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.912 Vali Acc: 0.804 Test Loss: 0.912 Test Acc: 0.804
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.282412052154541
Epoch: 28, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.811 Vali Acc: 0.819 Test Loss: 0.811 Test Acc: 0.819
Validation loss decreased (-0.811587 --> -0.818832).  Saving model ...
Epoch: 29 cost time: 0.9632439613342285
Epoch: 29, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.826 Vali Acc: 0.812 Test Loss: 0.826 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.1323449611663818
Epoch: 30, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.838 Vali Acc: 0.804 Test Loss: 0.838 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.1661021709442139
Epoch: 31, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.858 Vali Acc: 0.804 Test Loss: 0.858 Test Acc: 0.804
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.0964162349700928
Epoch: 32, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.942 Vali Acc: 0.804 Test Loss: 0.942 Test Acc: 0.804
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.361001968383789
Epoch: 33, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.934 Vali Acc: 0.804 Test Loss: 0.934 Test Acc: 0.804
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.2521755695343018
Epoch: 34, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.896 Vali Acc: 0.812 Test Loss: 0.896 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.368044137954712
Epoch: 35, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.898 Vali Acc: 0.804 Test Loss: 0.898 Test Acc: 0.804
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.268718957901001
Epoch: 36, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.875 Vali Acc: 0.797 Test Loss: 0.875 Test Acc: 0.797
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.416046380996704
Epoch: 37, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.891 Vali Acc: 0.804 Test Loss: 0.891 Test Acc: 0.804
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.2982544898986816
Epoch: 38, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.931 Vali Acc: 0.804 Test Loss: 0.931 Test Acc: 0.804
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el6_dm768_df768_ps13_str13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8188405797101449
model parameter : 43537156
model size : 180.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el6_dm768_df768_ps14_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.475219249725342
Epoch: 1, Steps: 9 | Train Loss: 1.426 Vali Loss: 1.278 Vali Acc: 0.261 Test Loss: 1.278 Test Acc: 0.261
Validation loss decreased (inf --> -0.260857).  Saving model ...
Epoch: 2 cost time: 2.583117723464966
Epoch: 2, Steps: 9 | Train Loss: 1.238 Vali Loss: 1.072 Vali Acc: 0.580 Test Loss: 1.072 Test Acc: 0.580
Validation loss decreased (-0.260857 --> -0.579699).  Saving model ...
Epoch: 3 cost time: 2.2928645610809326
Epoch: 3, Steps: 9 | Train Loss: 0.906 Vali Loss: 0.832 Vali Acc: 0.732 Test Loss: 0.832 Test Acc: 0.732
Validation loss decreased (-0.579699 --> -0.731876).  Saving model ...
Epoch: 4 cost time: 2.748807668685913
Epoch: 4, Steps: 9 | Train Loss: 0.677 Vali Loss: 0.686 Vali Acc: 0.732 Test Loss: 0.686 Test Acc: 0.732
Validation loss decreased (-0.731876 --> -0.731877).  Saving model ...
Epoch: 5 cost time: 2.404649257659912
Epoch: 5, Steps: 9 | Train Loss: 0.488 Vali Loss: 0.675 Vali Acc: 0.696 Test Loss: 0.675 Test Acc: 0.696
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.1893227100372314
Epoch: 6, Steps: 9 | Train Loss: 0.343 Vali Loss: 0.525 Vali Acc: 0.790 Test Loss: 0.525 Test Acc: 0.790
Validation loss decreased (-0.731877 --> -0.789850).  Saving model ...
Epoch: 7 cost time: 2.7380247116088867
Epoch: 7, Steps: 9 | Train Loss: 0.224 Vali Loss: 0.788 Vali Acc: 0.710 Test Loss: 0.788 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.1883647441864014
Epoch: 8, Steps: 9 | Train Loss: 0.148 Vali Loss: 0.592 Vali Acc: 0.819 Test Loss: 0.592 Test Acc: 0.819
Validation loss decreased (-0.789850 --> -0.818835).  Saving model ...
Epoch: 9 cost time: 2.701024293899536
Epoch: 9, Steps: 9 | Train Loss: 0.089 Vali Loss: 0.685 Vali Acc: 0.746 Test Loss: 0.685 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.709495782852173
Epoch: 10, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.671 Vali Acc: 0.819 Test Loss: 0.671 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.6079745292663574
Epoch: 11, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.679 Vali Acc: 0.826 Test Loss: 0.679 Test Acc: 0.826
Validation loss decreased (-0.818835 --> -0.826080).  Saving model ...
Epoch: 12 cost time: 1.6789333820343018
Epoch: 12, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.865 Vali Acc: 0.833 Test Loss: 0.865 Test Acc: 0.833
Validation loss decreased (-0.826080 --> -0.833325).  Saving model ...
Epoch: 13 cost time: 2.327305316925049
Epoch: 13, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.587 Vali Acc: 0.870 Test Loss: 0.587 Test Acc: 0.870
Validation loss decreased (-0.833325 --> -0.869559).  Saving model ...
Epoch: 14 cost time: 2.6403486728668213
Epoch: 14, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.783 Vali Acc: 0.870 Test Loss: 0.783 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.9719374179840088
Epoch: 15, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.709 Vali Acc: 0.855 Test Loss: 0.709 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.0877740383148193
Epoch: 16, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.009 Vali Acc: 0.812 Test Loss: 1.009 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.5032174587249756
Epoch: 17, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.261 Vali Acc: 0.812 Test Loss: 1.261 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.1732847690582275
Epoch: 18, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.919 Vali Acc: 0.848 Test Loss: 0.919 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.3086869716644287
Epoch: 19, Steps: 9 | Train Loss: 0.005 Vali Loss: 1.562 Vali Acc: 0.812 Test Loss: 1.562 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.9458940029144287
Epoch: 20, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.078 Vali Acc: 0.833 Test Loss: 1.078 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.531479835510254
Epoch: 21, Steps: 9 | Train Loss: 0.005 Vali Loss: 1.117 Vali Acc: 0.833 Test Loss: 1.117 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.371187686920166
Epoch: 22, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.909 Vali Acc: 0.855 Test Loss: 0.909 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.173060178756714
Epoch: 23, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.294 Vali Acc: 0.848 Test Loss: 1.294 Test Acc: 0.848
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el6_dm768_df768_ps14_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8695652173913043
model parameter : 43700740
model size : 181.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el6_dm768_df768_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.63336443901062
Epoch: 1, Steps: 9 | Train Loss: 1.509 Vali Loss: 1.356 Vali Acc: 0.370 Test Loss: 1.356 Test Acc: 0.370
Validation loss decreased (inf --> -0.369552).  Saving model ...
Epoch: 2 cost time: 1.5190141201019287
Epoch: 2, Steps: 9 | Train Loss: 1.292 Vali Loss: 1.181 Vali Acc: 0.449 Test Loss: 1.181 Test Acc: 0.449
Validation loss decreased (-0.369552 --> -0.449264).  Saving model ...
Epoch: 3 cost time: 1.749324083328247
Epoch: 3, Steps: 9 | Train Loss: 1.104 Vali Loss: 1.015 Vali Acc: 0.645 Test Loss: 1.015 Test Acc: 0.645
Validation loss decreased (-0.449264 --> -0.644917).  Saving model ...
Epoch: 4 cost time: 1.8733384609222412
Epoch: 4, Steps: 9 | Train Loss: 0.888 Vali Loss: 0.874 Vali Acc: 0.667 Test Loss: 0.874 Test Acc: 0.667
Validation loss decreased (-0.644917 --> -0.666658).  Saving model ...
Epoch: 5 cost time: 2.3142664432525635
Epoch: 5, Steps: 9 | Train Loss: 0.751 Vali Loss: 0.782 Vali Acc: 0.703 Test Loss: 0.782 Test Acc: 0.703
Validation loss decreased (-0.666658 --> -0.702891).  Saving model ...
Epoch: 6 cost time: 2.155381679534912
Epoch: 6, Steps: 9 | Train Loss: 0.642 Vali Loss: 0.800 Vali Acc: 0.688 Test Loss: 0.800 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.086371660232544
Epoch: 7, Steps: 9 | Train Loss: 0.411 Vali Loss: 0.645 Vali Acc: 0.732 Test Loss: 0.645 Test Acc: 0.732
Validation loss decreased (-0.702891 --> -0.731878).  Saving model ...
Epoch: 8 cost time: 2.2647862434387207
Epoch: 8, Steps: 9 | Train Loss: 0.333 Vali Loss: 0.594 Vali Acc: 0.768 Test Loss: 0.594 Test Acc: 0.768
Validation loss decreased (-0.731878 --> -0.768110).  Saving model ...
Epoch: 9 cost time: 2.3227198123931885
Epoch: 9, Steps: 9 | Train Loss: 0.225 Vali Loss: 0.906 Vali Acc: 0.703 Test Loss: 0.906 Test Acc: 0.703
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.141066551208496
Epoch: 10, Steps: 9 | Train Loss: 0.124 Vali Loss: 0.650 Vali Acc: 0.841 Test Loss: 0.650 Test Acc: 0.841
Validation loss decreased (-0.768110 --> -0.840573).  Saving model ...
Epoch: 11 cost time: 2.342855453491211
Epoch: 11, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.641 Vali Acc: 0.833 Test Loss: 0.641 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8963367938995361
Epoch: 12, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.842 Vali Acc: 0.804 Test Loss: 0.842 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.048797130584717
Epoch: 13, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.722 Vali Acc: 0.833 Test Loss: 0.722 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.240936279296875
Epoch: 14, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.815 Vali Acc: 0.812 Test Loss: 0.815 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.2327053546905518
Epoch: 15, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.830 Vali Acc: 0.812 Test Loss: 0.830 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.851421594619751
Epoch: 16, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.747 Vali Acc: 0.855 Test Loss: 0.747 Test Acc: 0.855
Validation loss decreased (-0.840573 --> -0.855065).  Saving model ...
Epoch: 17 cost time: 1.745438575744629
Epoch: 17, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.896 Vali Acc: 0.826 Test Loss: 0.896 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.7413930892944336
Epoch: 18, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.969 Vali Acc: 0.826 Test Loss: 0.969 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.0515267848968506
Epoch: 19, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.865 Vali Acc: 0.841 Test Loss: 0.865 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.5527782440185547
Epoch: 20, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.943 Vali Acc: 0.826 Test Loss: 0.943 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.7370491027832031
Epoch: 21, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.940 Vali Acc: 0.826 Test Loss: 0.940 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.8576552867889404
Epoch: 22, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.861 Vali Acc: 0.855 Test Loss: 0.861 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.1427948474884033
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.866 Vali Acc: 0.855 Test Loss: 0.866 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.7569553852081299
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.912 Vali Acc: 0.841 Test Loss: 0.912 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.9984352588653564
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.951 Vali Acc: 0.826 Test Loss: 0.951 Test Acc: 0.826
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.956824779510498
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.853 Vali Acc: 0.841 Test Loss: 0.853 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el6_dm768_df768_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.855072463768116
model parameter : 43603972
model size : 181.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el6_dm768_df768_ps14_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.5581657886505127
Epoch: 1, Steps: 9 | Train Loss: 1.384 Vali Loss: 1.349 Vali Acc: 0.341 Test Loss: 1.349 Test Acc: 0.341
Validation loss decreased (inf --> -0.340566).  Saving model ...
Epoch: 2 cost time: 1.4694740772247314
Epoch: 2, Steps: 9 | Train Loss: 1.327 Vali Loss: 1.246 Vali Acc: 0.507 Test Loss: 1.246 Test Acc: 0.507
Validation loss decreased (-0.340566 --> -0.507234).  Saving model ...
Epoch: 3 cost time: 1.3497819900512695
Epoch: 3, Steps: 9 | Train Loss: 1.225 Vali Loss: 1.137 Vali Acc: 0.580 Test Loss: 1.137 Test Acc: 0.580
Validation loss decreased (-0.507234 --> -0.579699).  Saving model ...
Epoch: 4 cost time: 1.594153642654419
Epoch: 4, Steps: 9 | Train Loss: 1.061 Vali Loss: 1.064 Vali Acc: 0.572 Test Loss: 1.064 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.652303695678711
Epoch: 5, Steps: 9 | Train Loss: 0.939 Vali Loss: 0.917 Vali Acc: 0.659 Test Loss: 0.917 Test Acc: 0.659
Validation loss decreased (-0.579699 --> -0.659411).  Saving model ...
Epoch: 6 cost time: 1.381035327911377
Epoch: 6, Steps: 9 | Train Loss: 0.808 Vali Loss: 0.803 Vali Acc: 0.725 Test Loss: 0.803 Test Acc: 0.725
Validation loss decreased (-0.659411 --> -0.724630).  Saving model ...
Epoch: 7 cost time: 1.5912914276123047
Epoch: 7, Steps: 9 | Train Loss: 0.659 Vali Loss: 0.757 Vali Acc: 0.681 Test Loss: 0.757 Test Acc: 0.681
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4973642826080322
Epoch: 8, Steps: 9 | Train Loss: 0.519 Vali Loss: 0.690 Vali Acc: 0.732 Test Loss: 0.690 Test Acc: 0.732
Validation loss decreased (-0.724630 --> -0.731877).  Saving model ...
Epoch: 9 cost time: 1.526291847229004
Epoch: 9, Steps: 9 | Train Loss: 0.361 Vali Loss: 0.750 Vali Acc: 0.710 Test Loss: 0.750 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4951083660125732
Epoch: 10, Steps: 9 | Train Loss: 0.344 Vali Loss: 0.593 Vali Acc: 0.768 Test Loss: 0.593 Test Acc: 0.768
Validation loss decreased (-0.731877 --> -0.768110).  Saving model ...
Epoch: 11 cost time: 1.6853296756744385
Epoch: 11, Steps: 9 | Train Loss: 0.184 Vali Loss: 0.692 Vali Acc: 0.768 Test Loss: 0.692 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.6073062419891357
Epoch: 12, Steps: 9 | Train Loss: 0.138 Vali Loss: 0.652 Vali Acc: 0.804 Test Loss: 0.652 Test Acc: 0.804
Validation loss decreased (-0.768110 --> -0.804341).  Saving model ...
Epoch: 13 cost time: 1.7009212970733643
Epoch: 13, Steps: 9 | Train Loss: 0.082 Vali Loss: 0.806 Vali Acc: 0.732 Test Loss: 0.806 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.5984156131744385
Epoch: 14, Steps: 9 | Train Loss: 0.060 Vali Loss: 0.748 Vali Acc: 0.804 Test Loss: 0.748 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.2403597831726074
Epoch: 15, Steps: 9 | Train Loss: 0.047 Vali Loss: 0.597 Vali Acc: 0.819 Test Loss: 0.597 Test Acc: 0.819
Validation loss decreased (-0.804341 --> -0.818835).  Saving model ...
Epoch: 16 cost time: 1.2765958309173584
Epoch: 16, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.713 Vali Acc: 0.833 Test Loss: 0.713 Test Acc: 0.833
Validation loss decreased (-0.818835 --> -0.833326).  Saving model ...
Epoch: 17 cost time: 1.7475476264953613
Epoch: 17, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.710 Vali Acc: 0.826 Test Loss: 0.710 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.6133170127868652
Epoch: 18, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.819 Vali Acc: 0.812 Test Loss: 0.819 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.2628791332244873
Epoch: 19, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.712 Vali Acc: 0.833 Test Loss: 0.712 Test Acc: 0.833
Validation loss decreased (-0.833326 --> -0.833326).  Saving model ...
Epoch: 20 cost time: 1.6015751361846924
Epoch: 20, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.725 Vali Acc: 0.826 Test Loss: 0.725 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.2683281898498535
Epoch: 21, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.749 Vali Acc: 0.841 Test Loss: 0.749 Test Acc: 0.841
Validation loss decreased (-0.833326 --> -0.840572).  Saving model ...
Epoch: 22 cost time: 1.3783559799194336
Epoch: 22, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.616 Vali Acc: 0.819 Test Loss: 0.616 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.3953015804290771
Epoch: 23, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.784 Vali Acc: 0.826 Test Loss: 0.784 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.4172825813293457
Epoch: 24, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.884 Vali Acc: 0.819 Test Loss: 0.884 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.4369535446166992
Epoch: 25, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.856 Vali Acc: 0.833 Test Loss: 0.856 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.3252675533294678
Epoch: 26, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.863 Vali Acc: 0.833 Test Loss: 0.863 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.3788611888885498
Epoch: 27, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.863 Vali Acc: 0.826 Test Loss: 0.863 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.4575717449188232
Epoch: 28, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.806 Vali Acc: 0.826 Test Loss: 0.806 Test Acc: 0.826
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.1793997287750244
Epoch: 29, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.820 Vali Acc: 0.826 Test Loss: 0.820 Test Acc: 0.826
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.5917479991912842
Epoch: 30, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.834 Vali Acc: 0.833 Test Loss: 0.834 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.0986533164978027
Epoch: 31, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.850 Vali Acc: 0.826 Test Loss: 0.850 Test Acc: 0.826
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el6_dm768_df768_ps14_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8405797101449275
model parameter : 43539460
model size : 180.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el6_dm768_df768_ps15_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.757945775985718
Epoch: 1, Steps: 9 | Train Loss: 1.484 Vali Loss: 1.355 Vali Acc: 0.275 Test Loss: 1.355 Test Acc: 0.275
Validation loss decreased (inf --> -0.275349).  Saving model ...
Epoch: 2 cost time: 1.7601070404052734
Epoch: 2, Steps: 9 | Train Loss: 1.206 Vali Loss: 1.119 Vali Acc: 0.623 Test Loss: 1.119 Test Acc: 0.623
Validation loss decreased (-0.275349 --> -0.623177).  Saving model ...
Epoch: 3 cost time: 2.431161642074585
Epoch: 3, Steps: 9 | Train Loss: 1.008 Vali Loss: 0.947 Vali Acc: 0.609 Test Loss: 0.947 Test Acc: 0.609
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.5734682083129883
Epoch: 4, Steps: 9 | Train Loss: 0.819 Vali Loss: 0.803 Vali Acc: 0.717 Test Loss: 0.803 Test Acc: 0.717
Validation loss decreased (-0.623177 --> -0.717383).  Saving model ...
Epoch: 5 cost time: 2.482398271560669
Epoch: 5, Steps: 9 | Train Loss: 0.593 Vali Loss: 0.754 Vali Acc: 0.688 Test Loss: 0.754 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3802368640899658
Epoch: 6, Steps: 9 | Train Loss: 0.513 Vali Loss: 0.678 Vali Acc: 0.725 Test Loss: 0.678 Test Acc: 0.725
Validation loss decreased (-0.717383 --> -0.724631).  Saving model ...
Epoch: 7 cost time: 2.028245210647583
Epoch: 7, Steps: 9 | Train Loss: 0.284 Vali Loss: 0.755 Vali Acc: 0.761 Test Loss: 0.755 Test Acc: 0.761
Validation loss decreased (-0.724631 --> -0.760862).  Saving model ...
Epoch: 8 cost time: 1.850996494293213
Epoch: 8, Steps: 9 | Train Loss: 0.238 Vali Loss: 0.612 Vali Acc: 0.761 Test Loss: 0.612 Test Acc: 0.761
Validation loss decreased (-0.760862 --> -0.760863).  Saving model ...
Epoch: 9 cost time: 2.1091275215148926
Epoch: 9, Steps: 9 | Train Loss: 0.137 Vali Loss: 0.685 Vali Acc: 0.739 Test Loss: 0.685 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.2108471393585205
Epoch: 10, Steps: 9 | Train Loss: 0.072 Vali Loss: 0.545 Vali Acc: 0.841 Test Loss: 0.545 Test Acc: 0.841
Validation loss decreased (-0.760863 --> -0.840574).  Saving model ...
Epoch: 11 cost time: 2.5914158821105957
Epoch: 11, Steps: 9 | Train Loss: 0.047 Vali Loss: 1.040 Vali Acc: 0.804 Test Loss: 1.040 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.301558017730713
Epoch: 12, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.803 Vali Acc: 0.826 Test Loss: 0.803 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.322850227355957
Epoch: 13, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.867 Vali Acc: 0.848 Test Loss: 0.867 Test Acc: 0.848
Validation loss decreased (-0.840574 --> -0.847817).  Saving model ...
Epoch: 14 cost time: 2.633431911468506
Epoch: 14, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.896 Vali Acc: 0.841 Test Loss: 0.896 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.3445241451263428
Epoch: 15, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.117 Vali Acc: 0.826 Test Loss: 1.117 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.6405994892120361
Epoch: 16, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.105 Vali Acc: 0.833 Test Loss: 1.105 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.084512233734131
Epoch: 17, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.986 Vali Acc: 0.841 Test Loss: 0.986 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.7389094829559326
Epoch: 18, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.078 Vali Acc: 0.833 Test Loss: 1.078 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.9047913551330566
Epoch: 19, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.022 Vali Acc: 0.833 Test Loss: 1.022 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.280731678009033
Epoch: 20, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.976 Vali Acc: 0.841 Test Loss: 0.976 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.394756555557251
Epoch: 21, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.975 Vali Acc: 0.848 Test Loss: 0.975 Test Acc: 0.848
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.8071825504302979
Epoch: 22, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.005 Vali Acc: 0.848 Test Loss: 1.005 Test Acc: 0.848
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.1613097190856934
Epoch: 23, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.942 Vali Acc: 0.841 Test Loss: 0.942 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el6_dm768_df768_ps15_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8478260869565217
model parameter : 43703044
model size : 181.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el6_dm768_df768_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.084366083145142
Epoch: 1, Steps: 9 | Train Loss: 1.439 Vali Loss: 1.343 Vali Acc: 0.333 Test Loss: 1.343 Test Acc: 0.333
Validation loss decreased (inf --> -0.333320).  Saving model ...
Epoch: 2 cost time: 1.6257760524749756
Epoch: 2, Steps: 9 | Train Loss: 1.327 Vali Loss: 1.206 Vali Acc: 0.471 Test Loss: 1.206 Test Acc: 0.471
Validation loss decreased (-0.333320 --> -0.471002).  Saving model ...
Epoch: 3 cost time: 1.7559044361114502
Epoch: 3, Steps: 9 | Train Loss: 1.129 Vali Loss: 1.106 Vali Acc: 0.551 Test Loss: 1.106 Test Acc: 0.551
Validation loss decreased (-0.471002 --> -0.550714).  Saving model ...
Epoch: 4 cost time: 1.7495484352111816
Epoch: 4, Steps: 9 | Train Loss: 0.954 Vali Loss: 0.966 Vali Acc: 0.667 Test Loss: 0.966 Test Acc: 0.667
Validation loss decreased (-0.550714 --> -0.666657).  Saving model ...
Epoch: 5 cost time: 1.6007161140441895
Epoch: 5, Steps: 9 | Train Loss: 0.862 Vali Loss: 0.849 Vali Acc: 0.667 Test Loss: 0.849 Test Acc: 0.667
Validation loss decreased (-0.666657 --> -0.666658).  Saving model ...
Epoch: 6 cost time: 1.6771936416625977
Epoch: 6, Steps: 9 | Train Loss: 0.643 Vali Loss: 0.754 Vali Acc: 0.725 Test Loss: 0.754 Test Acc: 0.725
Validation loss decreased (-0.666658 --> -0.724630).  Saving model ...
Epoch: 7 cost time: 1.710796594619751
Epoch: 7, Steps: 9 | Train Loss: 0.475 Vali Loss: 0.698 Vali Acc: 0.703 Test Loss: 0.698 Test Acc: 0.703
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8182501792907715
Epoch: 8, Steps: 9 | Train Loss: 0.342 Vali Loss: 0.625 Vali Acc: 0.754 Test Loss: 0.625 Test Acc: 0.754
Validation loss decreased (-0.724630 --> -0.753617).  Saving model ...
Epoch: 9 cost time: 1.9136886596679688
Epoch: 9, Steps: 9 | Train Loss: 0.231 Vali Loss: 0.722 Vali Acc: 0.783 Test Loss: 0.722 Test Acc: 0.783
Validation loss decreased (-0.753617 --> -0.782601).  Saving model ...
Epoch: 10 cost time: 1.6907017230987549
Epoch: 10, Steps: 9 | Train Loss: 0.176 Vali Loss: 0.559 Vali Acc: 0.797 Test Loss: 0.559 Test Acc: 0.797
Validation loss decreased (-0.782601 --> -0.797096).  Saving model ...
Epoch: 11 cost time: 1.6771585941314697
Epoch: 11, Steps: 9 | Train Loss: 0.067 Vali Loss: 1.036 Vali Acc: 0.783 Test Loss: 1.036 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8494412899017334
Epoch: 12, Steps: 9 | Train Loss: 0.084 Vali Loss: 0.676 Vali Acc: 0.804 Test Loss: 0.676 Test Acc: 0.804
Validation loss decreased (-0.797096 --> -0.804341).  Saving model ...
Epoch: 13 cost time: 2.0781078338623047
Epoch: 13, Steps: 9 | Train Loss: 0.047 Vali Loss: 0.815 Vali Acc: 0.797 Test Loss: 0.815 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.2329392433166504
Epoch: 14, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.847 Vali Acc: 0.812 Test Loss: 0.847 Test Acc: 0.812
Validation loss decreased (-0.804341 --> -0.811586).  Saving model ...
Epoch: 15 cost time: 2.1645591259002686
Epoch: 15, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.801 Vali Acc: 0.804 Test Loss: 0.801 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.3044092655181885
Epoch: 16, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.846 Vali Acc: 0.826 Test Loss: 0.846 Test Acc: 0.826
Validation loss decreased (-0.811586 --> -0.826078).  Saving model ...
Epoch: 17 cost time: 1.7942466735839844
Epoch: 17, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.871 Vali Acc: 0.812 Test Loss: 0.871 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.8956971168518066
Epoch: 18, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.859 Vali Acc: 0.804 Test Loss: 0.859 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.7333970069885254
Epoch: 19, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.779 Vali Acc: 0.848 Test Loss: 0.779 Test Acc: 0.848
Validation loss decreased (-0.826078 --> -0.847818).  Saving model ...
Epoch: 20 cost time: 1.8643169403076172
Epoch: 20, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.866 Vali Acc: 0.819 Test Loss: 0.866 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.112966775894165
Epoch: 21, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.908 Vali Acc: 0.812 Test Loss: 0.908 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.0928823947906494
Epoch: 22, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.911 Vali Acc: 0.812 Test Loss: 0.911 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.9674170017242432
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.917 Vali Acc: 0.812 Test Loss: 0.917 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.0089786052703857
Epoch: 24, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.899 Vali Acc: 0.819 Test Loss: 0.899 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.9582209587097168
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.891 Vali Acc: 0.826 Test Loss: 0.891 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.094226121902466
Epoch: 26, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.891 Vali Acc: 0.812 Test Loss: 0.891 Test Acc: 0.812
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.6799871921539307
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.913 Vali Acc: 0.812 Test Loss: 0.913 Test Acc: 0.812
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.2324161529541016
Epoch: 28, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.916 Vali Acc: 0.812 Test Loss: 0.916 Test Acc: 0.812
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.9442577362060547
Epoch: 29, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.836 Vali Acc: 0.819 Test Loss: 0.836 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el6_dm768_df768_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8478260869565217
model parameter : 43592452
model size : 180.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el6_dm768_df768_ps15_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.5773251056671143
Epoch: 1, Steps: 9 | Train Loss: 1.412 Vali Loss: 1.348 Vali Acc: 0.268 Test Loss: 1.348 Test Acc: 0.268
Validation loss decreased (inf --> -0.268102).  Saving model ...
Epoch: 2 cost time: 1.4806268215179443
Epoch: 2, Steps: 9 | Train Loss: 1.317 Vali Loss: 1.275 Vali Acc: 0.442 Test Loss: 1.275 Test Acc: 0.442
Validation loss decreased (-0.268102 --> -0.442016).  Saving model ...
Epoch: 3 cost time: 1.188112735748291
Epoch: 3, Steps: 9 | Train Loss: 1.211 Vali Loss: 1.162 Vali Acc: 0.565 Test Loss: 1.162 Test Acc: 0.565
Validation loss decreased (-0.442016 --> -0.565206).  Saving model ...
Epoch: 4 cost time: 1.4039714336395264
Epoch: 4, Steps: 9 | Train Loss: 1.066 Vali Loss: 1.054 Vali Acc: 0.630 Test Loss: 1.054 Test Acc: 0.630
Validation loss decreased (-0.565206 --> -0.630424).  Saving model ...
Epoch: 5 cost time: 1.2880759239196777
Epoch: 5, Steps: 9 | Train Loss: 0.923 Vali Loss: 0.953 Vali Acc: 0.623 Test Loss: 0.953 Test Acc: 0.623
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2783055305480957
Epoch: 6, Steps: 9 | Train Loss: 0.776 Vali Loss: 0.898 Vali Acc: 0.638 Test Loss: 0.898 Test Acc: 0.638
Validation loss decreased (-0.630424 --> -0.637672).  Saving model ...
Epoch: 7 cost time: 0.993668794631958
Epoch: 7, Steps: 9 | Train Loss: 0.609 Vali Loss: 0.756 Vali Acc: 0.696 Test Loss: 0.756 Test Acc: 0.696
Validation loss decreased (-0.637672 --> -0.695645).  Saving model ...
Epoch: 8 cost time: 1.334989070892334
Epoch: 8, Steps: 9 | Train Loss: 0.458 Vali Loss: 0.694 Vali Acc: 0.681 Test Loss: 0.694 Test Acc: 0.681
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0292680263519287
Epoch: 9, Steps: 9 | Train Loss: 0.352 Vali Loss: 0.759 Vali Acc: 0.703 Test Loss: 0.759 Test Acc: 0.703
Validation loss decreased (-0.695645 --> -0.702891).  Saving model ...
Epoch: 10 cost time: 1.2975826263427734
Epoch: 10, Steps: 9 | Train Loss: 0.238 Vali Loss: 0.682 Vali Acc: 0.739 Test Loss: 0.682 Test Acc: 0.739
Validation loss decreased (-0.702891 --> -0.739124).  Saving model ...
Epoch: 11 cost time: 1.2438786029815674
Epoch: 11, Steps: 9 | Train Loss: 0.176 Vali Loss: 0.711 Vali Acc: 0.754 Test Loss: 0.711 Test Acc: 0.754
Validation loss decreased (-0.739124 --> -0.753616).  Saving model ...
Epoch: 12 cost time: 1.3167192935943604
Epoch: 12, Steps: 9 | Train Loss: 0.110 Vali Loss: 0.647 Vali Acc: 0.746 Test Loss: 0.647 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6905946731567383
Epoch: 13, Steps: 9 | Train Loss: 0.102 Vali Loss: 0.680 Vali Acc: 0.768 Test Loss: 0.680 Test Acc: 0.768
Validation loss decreased (-0.753616 --> -0.768109).  Saving model ...
Epoch: 14 cost time: 1.6926236152648926
Epoch: 14, Steps: 9 | Train Loss: 0.062 Vali Loss: 0.791 Vali Acc: 0.783 Test Loss: 0.791 Test Acc: 0.783
Validation loss decreased (-0.768109 --> -0.782601).  Saving model ...
Epoch: 15 cost time: 1.6364550590515137
Epoch: 15, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.757 Vali Acc: 0.725 Test Loss: 0.757 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.5478649139404297
Epoch: 16, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.863 Vali Acc: 0.783 Test Loss: 0.863 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.3743505477905273
Epoch: 17, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.830 Vali Acc: 0.797 Test Loss: 0.830 Test Acc: 0.797
Validation loss decreased (-0.782601 --> -0.797093).  Saving model ...
Epoch: 18 cost time: 1.3907811641693115
Epoch: 18, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.849 Vali Acc: 0.761 Test Loss: 0.849 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1892695426940918
Epoch: 19, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.926 Vali Acc: 0.804 Test Loss: 0.926 Test Acc: 0.804
Validation loss decreased (-0.797093 --> -0.804339).  Saving model ...
Epoch: 20 cost time: 1.2563555240631104
Epoch: 20, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.742 Vali Acc: 0.804 Test Loss: 0.742 Test Acc: 0.804
Validation loss decreased (-0.804339 --> -0.804340).  Saving model ...
Epoch: 21 cost time: 1.4916205406188965
Epoch: 21, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.896 Vali Acc: 0.804 Test Loss: 0.896 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.4045357704162598
Epoch: 22, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.890 Vali Acc: 0.797 Test Loss: 0.890 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.5352473258972168
Epoch: 23, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.770 Vali Acc: 0.819 Test Loss: 0.770 Test Acc: 0.819
Validation loss decreased (-0.804340 --> -0.818833).  Saving model ...
Epoch: 24 cost time: 1.523015022277832
Epoch: 24, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.931 Vali Acc: 0.797 Test Loss: 0.931 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.5602211952209473
Epoch: 25, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.973 Vali Acc: 0.797 Test Loss: 0.973 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.4716198444366455
Epoch: 26, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.845 Vali Acc: 0.812 Test Loss: 0.845 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.2931926250457764
Epoch: 27, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.844 Vali Acc: 0.812 Test Loss: 0.844 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.5269935131072998
Epoch: 28, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.957 Vali Acc: 0.797 Test Loss: 0.957 Test Acc: 0.797
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.3454780578613281
Epoch: 29, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.004 Vali Acc: 0.804 Test Loss: 1.004 Test Acc: 0.804
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.4620935916900635
Epoch: 30, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.944 Vali Acc: 0.819 Test Loss: 0.944 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.5125186443328857
Epoch: 31, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.890 Vali Acc: 0.819 Test Loss: 0.890 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.181072473526001
Epoch: 32, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.867 Vali Acc: 0.819 Test Loss: 0.867 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.3187861442565918
Epoch: 33, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.848 Vali Acc: 0.812 Test Loss: 0.848 Test Acc: 0.812
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el6_dm768_df768_ps15_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8188405797101449
model parameter : 43541764
model size : 180.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el6_dm768_df768_ps16_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.423639297485352
Epoch: 1, Steps: 9 | Train Loss: 1.428 Vali Loss: 1.308 Vali Acc: 0.304 Test Loss: 1.308 Test Acc: 0.304
Validation loss decreased (inf --> -0.304335).  Saving model ...
Epoch: 2 cost time: 2.1826539039611816
Epoch: 2, Steps: 9 | Train Loss: 1.213 Vali Loss: 1.095 Vali Acc: 0.623 Test Loss: 1.095 Test Acc: 0.623
Validation loss decreased (-0.304335 --> -0.623177).  Saving model ...
Epoch: 3 cost time: 2.24640154838562
Epoch: 3, Steps: 9 | Train Loss: 0.982 Vali Loss: 0.916 Vali Acc: 0.630 Test Loss: 0.916 Test Acc: 0.630
Validation loss decreased (-0.623177 --> -0.630426).  Saving model ...
Epoch: 4 cost time: 2.2457680702209473
Epoch: 4, Steps: 9 | Train Loss: 0.753 Vali Loss: 0.867 Vali Acc: 0.587 Test Loss: 0.867 Test Acc: 0.587
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.3313136100769043
Epoch: 5, Steps: 9 | Train Loss: 0.556 Vali Loss: 0.637 Vali Acc: 0.754 Test Loss: 0.637 Test Acc: 0.754
Validation loss decreased (-0.630426 --> -0.753617).  Saving model ...
Epoch: 6 cost time: 2.859496593475342
Epoch: 6, Steps: 9 | Train Loss: 0.387 Vali Loss: 0.797 Vali Acc: 0.667 Test Loss: 0.797 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.769634485244751
Epoch: 7, Steps: 9 | Train Loss: 0.288 Vali Loss: 0.516 Vali Acc: 0.775 Test Loss: 0.516 Test Acc: 0.775
Validation loss decreased (-0.753617 --> -0.775357).  Saving model ...
Epoch: 8 cost time: 2.517843723297119
Epoch: 8, Steps: 9 | Train Loss: 0.167 Vali Loss: 0.485 Vali Acc: 0.754 Test Loss: 0.485 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.5296096801757812
Epoch: 9, Steps: 9 | Train Loss: 0.114 Vali Loss: 0.788 Vali Acc: 0.812 Test Loss: 0.788 Test Acc: 0.812
Validation loss decreased (-0.775357 --> -0.811586).  Saving model ...
Epoch: 10 cost time: 2.8069489002227783
Epoch: 10, Steps: 9 | Train Loss: 0.062 Vali Loss: 0.701 Vali Acc: 0.812 Test Loss: 0.701 Test Acc: 0.812
Validation loss decreased (-0.811586 --> -0.811587).  Saving model ...
Epoch: 11 cost time: 2.512270927429199
Epoch: 11, Steps: 9 | Train Loss: 0.048 Vali Loss: 0.718 Vali Acc: 0.754 Test Loss: 0.718 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.3989410400390625
Epoch: 12, Steps: 9 | Train Loss: 0.066 Vali Loss: 0.833 Vali Acc: 0.841 Test Loss: 0.833 Test Acc: 0.841
Validation loss decreased (-0.811587 --> -0.840571).  Saving model ...
Epoch: 13 cost time: 2.2693662643432617
Epoch: 13, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.599 Vali Acc: 0.833 Test Loss: 0.599 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.26062273979187
Epoch: 14, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.680 Vali Acc: 0.826 Test Loss: 0.680 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.136256217956543
Epoch: 15, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.994 Vali Acc: 0.783 Test Loss: 0.994 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.2531912326812744
Epoch: 16, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.746 Vali Acc: 0.848 Test Loss: 0.746 Test Acc: 0.848
Validation loss decreased (-0.840571 --> -0.847819).  Saving model ...
Epoch: 17 cost time: 1.6708285808563232
Epoch: 17, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.640 Vali Acc: 0.870 Test Loss: 0.640 Test Acc: 0.870
Validation loss decreased (-0.847819 --> -0.869559).  Saving model ...
Epoch: 18 cost time: 1.4498825073242188
Epoch: 18, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.726 Vali Acc: 0.855 Test Loss: 0.726 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.9405360221862793
Epoch: 19, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.857 Vali Acc: 0.855 Test Loss: 0.857 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.1410977840423584
Epoch: 20, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.887 Vali Acc: 0.848 Test Loss: 0.887 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.9731762409210205
Epoch: 21, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.848 Vali Acc: 0.862 Test Loss: 0.848 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.6760666370391846
Epoch: 22, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.797 Vali Acc: 0.855 Test Loss: 0.797 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.446230411529541
Epoch: 23, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.778 Vali Acc: 0.862 Test Loss: 0.778 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.4902474880218506
Epoch: 24, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.777 Vali Acc: 0.862 Test Loss: 0.777 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.9807560443878174
Epoch: 25, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.780 Vali Acc: 0.862 Test Loss: 0.780 Test Acc: 0.862
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.7724955081939697
Epoch: 26, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.786 Vali Acc: 0.870 Test Loss: 0.786 Test Acc: 0.870
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.030499219894409
Epoch: 27, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.807 Vali Acc: 0.870 Test Loss: 0.807 Test Acc: 0.870
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el6_dm768_df768_ps16_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8695652173913043
model parameter : 43709956
model size : 181.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el6_dm768_df768_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.64056134223938
Epoch: 1, Steps: 9 | Train Loss: 1.381 Vali Loss: 1.279 Vali Acc: 0.391 Test Loss: 1.279 Test Acc: 0.391
Validation loss decreased (inf --> -0.391292).  Saving model ...
Epoch: 2 cost time: 1.6849331855773926
Epoch: 2, Steps: 9 | Train Loss: 1.234 Vali Loss: 1.146 Vali Acc: 0.536 Test Loss: 1.146 Test Acc: 0.536
Validation loss decreased (-0.391292 --> -0.536220).  Saving model ...
Epoch: 3 cost time: 2.1040003299713135
Epoch: 3, Steps: 9 | Train Loss: 1.103 Vali Loss: 1.003 Vali Acc: 0.601 Test Loss: 1.003 Test Acc: 0.601
Validation loss decreased (-0.536220 --> -0.601439).  Saving model ...
Epoch: 4 cost time: 1.711111307144165
Epoch: 4, Steps: 9 | Train Loss: 0.897 Vali Loss: 0.893 Vali Acc: 0.630 Test Loss: 0.893 Test Acc: 0.630
Validation loss decreased (-0.601439 --> -0.630426).  Saving model ...
Epoch: 5 cost time: 1.929300308227539
Epoch: 5, Steps: 9 | Train Loss: 0.745 Vali Loss: 0.808 Vali Acc: 0.667 Test Loss: 0.808 Test Acc: 0.667
Validation loss decreased (-0.630426 --> -0.666659).  Saving model ...
Epoch: 6 cost time: 2.139831304550171
Epoch: 6, Steps: 9 | Train Loss: 0.602 Vali Loss: 0.690 Vali Acc: 0.688 Test Loss: 0.690 Test Acc: 0.688
Validation loss decreased (-0.666659 --> -0.688399).  Saving model ...
Epoch: 7 cost time: 2.0476789474487305
Epoch: 7, Steps: 9 | Train Loss: 0.468 Vali Loss: 0.657 Vali Acc: 0.703 Test Loss: 0.657 Test Acc: 0.703
Validation loss decreased (-0.688399 --> -0.702892).  Saving model ...
Epoch: 8 cost time: 1.7576837539672852
Epoch: 8, Steps: 9 | Train Loss: 0.317 Vali Loss: 0.586 Vali Acc: 0.754 Test Loss: 0.586 Test Acc: 0.754
Validation loss decreased (-0.702892 --> -0.753617).  Saving model ...
Epoch: 9 cost time: 1.7833976745605469
Epoch: 9, Steps: 9 | Train Loss: 0.240 Vali Loss: 0.488 Vali Acc: 0.797 Test Loss: 0.488 Test Acc: 0.797
Validation loss decreased (-0.753617 --> -0.797097).  Saving model ...
Epoch: 10 cost time: 2.2445054054260254
Epoch: 10, Steps: 9 | Train Loss: 0.172 Vali Loss: 0.603 Vali Acc: 0.848 Test Loss: 0.603 Test Acc: 0.848
Validation loss decreased (-0.797097 --> -0.847820).  Saving model ...
Epoch: 11 cost time: 2.165379285812378
Epoch: 11, Steps: 9 | Train Loss: 0.089 Vali Loss: 0.489 Vali Acc: 0.833 Test Loss: 0.489 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.9503066539764404
Epoch: 12, Steps: 9 | Train Loss: 0.061 Vali Loss: 0.733 Vali Acc: 0.804 Test Loss: 0.733 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.7984263896942139
Epoch: 13, Steps: 9 | Train Loss: 0.079 Vali Loss: 0.730 Vali Acc: 0.797 Test Loss: 0.730 Test Acc: 0.797
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.9057338237762451
Epoch: 14, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.488 Vali Acc: 0.855 Test Loss: 0.488 Test Acc: 0.855
Validation loss decreased (-0.847820 --> -0.855068).  Saving model ...
Epoch: 15 cost time: 1.253969669342041
Epoch: 15, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.647 Vali Acc: 0.841 Test Loss: 0.647 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.199374198913574
Epoch: 16, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.577 Vali Acc: 0.848 Test Loss: 0.577 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.2026565074920654
Epoch: 17, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.748 Vali Acc: 0.826 Test Loss: 0.748 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.4975900650024414
Epoch: 18, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.723 Vali Acc: 0.841 Test Loss: 0.723 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.4718472957611084
Epoch: 19, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.815 Vali Acc: 0.833 Test Loss: 0.815 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.980250358581543
Epoch: 20, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.692 Vali Acc: 0.855 Test Loss: 0.692 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.371676206588745
Epoch: 21, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.817 Vali Acc: 0.833 Test Loss: 0.817 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.8143091201782227
Epoch: 22, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.795 Vali Acc: 0.855 Test Loss: 0.795 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.1337039470672607
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.770 Vali Acc: 0.855 Test Loss: 0.770 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.058769702911377
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.753 Vali Acc: 0.855 Test Loss: 0.753 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el6_dm768_df768_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.855072463768116
model parameter : 43599364
model size : 181.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el6_dm768_df768_ps16_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.468827724456787
Epoch: 1, Steps: 9 | Train Loss: 1.493 Vali Loss: 1.433 Vali Acc: 0.326 Test Loss: 1.433 Test Acc: 0.326
Validation loss decreased (inf --> -0.326073).  Saving model ...
Epoch: 2 cost time: 1.4870054721832275
Epoch: 2, Steps: 9 | Train Loss: 1.380 Vali Loss: 1.336 Vali Acc: 0.377 Test Loss: 1.336 Test Acc: 0.377
Validation loss decreased (-0.326073 --> -0.376798).  Saving model ...
Epoch: 3 cost time: 0.9697883129119873
Epoch: 3, Steps: 9 | Train Loss: 1.278 Vali Loss: 1.210 Vali Acc: 0.471 Test Loss: 1.210 Test Acc: 0.471
Validation loss decreased (-0.376798 --> -0.471002).  Saving model ...
Epoch: 4 cost time: 1.3776659965515137
Epoch: 4, Steps: 9 | Train Loss: 1.148 Vali Loss: 1.096 Vali Acc: 0.536 Test Loss: 1.096 Test Acc: 0.536
Validation loss decreased (-0.471002 --> -0.536221).  Saving model ...
Epoch: 5 cost time: 1.2634391784667969
Epoch: 5, Steps: 9 | Train Loss: 0.973 Vali Loss: 0.987 Vali Acc: 0.645 Test Loss: 0.987 Test Acc: 0.645
Validation loss decreased (-0.536221 --> -0.644918).  Saving model ...
Epoch: 6 cost time: 0.9588398933410645
Epoch: 6, Steps: 9 | Train Loss: 0.817 Vali Loss: 0.869 Vali Acc: 0.674 Test Loss: 0.869 Test Acc: 0.674
Validation loss decreased (-0.644918 --> -0.673904).  Saving model ...
Epoch: 7 cost time: 1.3373160362243652
Epoch: 7, Steps: 9 | Train Loss: 0.707 Vali Loss: 0.774 Vali Acc: 0.688 Test Loss: 0.774 Test Acc: 0.688
Validation loss decreased (-0.673904 --> -0.688398).  Saving model ...
Epoch: 8 cost time: 1.1588082313537598
Epoch: 8, Steps: 9 | Train Loss: 0.572 Vali Loss: 0.740 Vali Acc: 0.674 Test Loss: 0.740 Test Acc: 0.674
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.272620439529419
Epoch: 9, Steps: 9 | Train Loss: 0.432 Vali Loss: 0.619 Vali Acc: 0.717 Test Loss: 0.619 Test Acc: 0.717
Validation loss decreased (-0.688398 --> -0.717385).  Saving model ...
Epoch: 10 cost time: 1.0725257396697998
Epoch: 10, Steps: 9 | Train Loss: 0.334 Vali Loss: 0.636 Vali Acc: 0.746 Test Loss: 0.636 Test Acc: 0.746
Validation loss decreased (-0.717385 --> -0.746370).  Saving model ...
Epoch: 11 cost time: 1.377049446105957
Epoch: 11, Steps: 9 | Train Loss: 0.253 Vali Loss: 0.533 Vali Acc: 0.790 Test Loss: 0.533 Test Acc: 0.790
Validation loss decreased (-0.746370 --> -0.789850).  Saving model ...
Epoch: 12 cost time: 1.004523754119873
Epoch: 12, Steps: 9 | Train Loss: 0.161 Vali Loss: 0.608 Vali Acc: 0.761 Test Loss: 0.608 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1682534217834473
Epoch: 13, Steps: 9 | Train Loss: 0.127 Vali Loss: 0.600 Vali Acc: 0.819 Test Loss: 0.600 Test Acc: 0.819
Validation loss decreased (-0.789850 --> -0.818835).  Saving model ...
Epoch: 14 cost time: 1.2738220691680908
Epoch: 14, Steps: 9 | Train Loss: 0.070 Vali Loss: 0.638 Vali Acc: 0.797 Test Loss: 0.638 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1365735530853271
Epoch: 15, Steps: 9 | Train Loss: 0.048 Vali Loss: 0.792 Vali Acc: 0.775 Test Loss: 0.792 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.0641632080078125
Epoch: 16, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.638 Vali Acc: 0.804 Test Loss: 0.638 Test Acc: 0.804
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.1608049869537354
Epoch: 17, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.815 Vali Acc: 0.812 Test Loss: 0.815 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.1737573146820068
Epoch: 18, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.673 Vali Acc: 0.819 Test Loss: 0.673 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.2461133003234863
Epoch: 19, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.807 Vali Acc: 0.812 Test Loss: 0.807 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.0433650016784668
Epoch: 20, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.720 Vali Acc: 0.841 Test Loss: 0.720 Test Acc: 0.841
Validation loss decreased (-0.818835 --> -0.840573).  Saving model ...
Epoch: 21 cost time: 1.2458431720733643
Epoch: 21, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.733 Vali Acc: 0.841 Test Loss: 0.733 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.4289424419403076
Epoch: 22, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.825 Vali Acc: 0.804 Test Loss: 0.825 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.4726879596710205
Epoch: 23, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.744 Vali Acc: 0.826 Test Loss: 0.744 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.1060545444488525
Epoch: 24, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.965 Vali Acc: 0.819 Test Loss: 0.965 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.228496789932251
Epoch: 25, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.795 Vali Acc: 0.812 Test Loss: 0.795 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.263810634613037
Epoch: 26, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.870 Vali Acc: 0.812 Test Loss: 0.870 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.5544805526733398
Epoch: 27, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.952 Vali Acc: 0.812 Test Loss: 0.952 Test Acc: 0.812
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.3873369693756104
Epoch: 28, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.774 Vali Acc: 0.812 Test Loss: 0.774 Test Acc: 0.812
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.3654019832611084
Epoch: 29, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.760 Vali Acc: 0.819 Test Loss: 0.760 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.3848555088043213
Epoch: 30, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.800 Vali Acc: 0.812 Test Loss: 0.800 Test Acc: 0.812
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el6_dm768_df768_ps16_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8405797101449275
model parameter : 43544068
model size : 180.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el6_dm768_df768_ps18_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.178634881973267
Epoch: 1, Steps: 9 | Train Loss: 1.442 Vali Loss: 1.286 Vali Acc: 0.326 Test Loss: 1.286 Test Acc: 0.326
Validation loss decreased (inf --> -0.326074).  Saving model ...
Epoch: 2 cost time: 1.820143222808838
Epoch: 2, Steps: 9 | Train Loss: 1.242 Vali Loss: 1.129 Vali Acc: 0.543 Test Loss: 1.129 Test Acc: 0.543
Validation loss decreased (-0.326074 --> -0.543467).  Saving model ...
Epoch: 3 cost time: 1.8985416889190674
Epoch: 3, Steps: 9 | Train Loss: 0.967 Vali Loss: 0.952 Vali Acc: 0.551 Test Loss: 0.952 Test Acc: 0.551
Validation loss decreased (-0.543467 --> -0.550715).  Saving model ...
Epoch: 4 cost time: 2.3488452434539795
Epoch: 4, Steps: 9 | Train Loss: 0.780 Vali Loss: 0.966 Vali Acc: 0.652 Test Loss: 0.966 Test Acc: 0.652
Validation loss decreased (-0.550715 --> -0.652164).  Saving model ...
Epoch: 5 cost time: 2.0764994621276855
Epoch: 5, Steps: 9 | Train Loss: 0.708 Vali Loss: 0.744 Vali Acc: 0.696 Test Loss: 0.744 Test Acc: 0.696
Validation loss decreased (-0.652164 --> -0.695645).  Saving model ...
Epoch: 6 cost time: 2.5402286052703857
Epoch: 6, Steps: 9 | Train Loss: 0.555 Vali Loss: 0.803 Vali Acc: 0.674 Test Loss: 0.803 Test Acc: 0.674
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.3064117431640625
Epoch: 7, Steps: 9 | Train Loss: 0.363 Vali Loss: 0.579 Vali Acc: 0.819 Test Loss: 0.579 Test Acc: 0.819
Validation loss decreased (-0.695645 --> -0.818835).  Saving model ...
Epoch: 8 cost time: 1.8781723976135254
Epoch: 8, Steps: 9 | Train Loss: 0.274 Vali Loss: 0.876 Vali Acc: 0.703 Test Loss: 0.876 Test Acc: 0.703
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.3973405361175537
Epoch: 9, Steps: 9 | Train Loss: 0.170 Vali Loss: 0.513 Vali Acc: 0.877 Test Loss: 0.513 Test Acc: 0.877
Validation loss decreased (-0.818835 --> -0.876806).  Saving model ...
Epoch: 10 cost time: 2.1142611503601074
Epoch: 10, Steps: 9 | Train Loss: 0.096 Vali Loss: 0.679 Vali Acc: 0.790 Test Loss: 0.679 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.712050437927246
Epoch: 11, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.640 Vali Acc: 0.812 Test Loss: 0.640 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.2529728412628174
Epoch: 12, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.847 Vali Acc: 0.833 Test Loss: 0.847 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.839918851852417
Epoch: 13, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.815 Vali Acc: 0.848 Test Loss: 0.815 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.9180757999420166
Epoch: 14, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.737 Vali Acc: 0.855 Test Loss: 0.737 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.7831885814666748
Epoch: 15, Steps: 9 | Train Loss: 0.006 Vali Loss: 1.003 Vali Acc: 0.855 Test Loss: 1.003 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.6881294250488281
Epoch: 16, Steps: 9 | Train Loss: 0.005 Vali Loss: 1.027 Vali Acc: 0.841 Test Loss: 1.027 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.901278018951416
Epoch: 17, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.778 Vali Acc: 0.855 Test Loss: 0.778 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.5538716316223145
Epoch: 18, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.033 Vali Acc: 0.862 Test Loss: 1.033 Test Acc: 0.862
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.6055305004119873
Epoch: 19, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.057 Vali Acc: 0.862 Test Loss: 1.057 Test Acc: 0.862
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el6_dm768_df768_ps18_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8768115942028986
model parameter : 43677700
model size : 181.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el6_dm768_df768_ps18_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.855391263961792
Epoch: 1, Steps: 9 | Train Loss: 1.392 Vali Loss: 1.310 Vali Acc: 0.348 Test Loss: 1.310 Test Acc: 0.348
Validation loss decreased (inf --> -0.347813).  Saving model ...
Epoch: 2 cost time: 1.6317110061645508
Epoch: 2, Steps: 9 | Train Loss: 1.279 Vali Loss: 1.163 Vali Acc: 0.428 Test Loss: 1.163 Test Acc: 0.428
Validation loss decreased (-0.347813 --> -0.427525).  Saving model ...
Epoch: 3 cost time: 2.0268211364746094
Epoch: 3, Steps: 9 | Train Loss: 1.069 Vali Loss: 1.029 Vali Acc: 0.551 Test Loss: 1.029 Test Acc: 0.551
Validation loss decreased (-0.427525 --> -0.550714).  Saving model ...
Epoch: 4 cost time: 1.9474372863769531
Epoch: 4, Steps: 9 | Train Loss: 0.891 Vali Loss: 0.948 Vali Acc: 0.572 Test Loss: 0.948 Test Acc: 0.572
Validation loss decreased (-0.550714 --> -0.572454).  Saving model ...
Epoch: 5 cost time: 2.3957018852233887
Epoch: 5, Steps: 9 | Train Loss: 0.724 Vali Loss: 0.846 Vali Acc: 0.587 Test Loss: 0.846 Test Acc: 0.587
Validation loss decreased (-0.572454 --> -0.586948).  Saving model ...
Epoch: 6 cost time: 1.7547152042388916
Epoch: 6, Steps: 9 | Train Loss: 0.648 Vali Loss: 0.778 Vali Acc: 0.681 Test Loss: 0.778 Test Acc: 0.681
Validation loss decreased (-0.586948 --> -0.681152).  Saving model ...
Epoch: 7 cost time: 1.6920521259307861
Epoch: 7, Steps: 9 | Train Loss: 0.487 Vali Loss: 0.731 Vali Acc: 0.732 Test Loss: 0.731 Test Acc: 0.732
Validation loss decreased (-0.681152 --> -0.731877).  Saving model ...
Epoch: 8 cost time: 1.8233892917633057
Epoch: 8, Steps: 9 | Train Loss: 0.384 Vali Loss: 0.713 Vali Acc: 0.688 Test Loss: 0.713 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.247119426727295
Epoch: 9, Steps: 9 | Train Loss: 0.309 Vali Loss: 0.625 Vali Acc: 0.804 Test Loss: 0.625 Test Acc: 0.804
Validation loss decreased (-0.731877 --> -0.804342).  Saving model ...
Epoch: 10 cost time: 1.6951115131378174
Epoch: 10, Steps: 9 | Train Loss: 0.198 Vali Loss: 0.616 Vali Acc: 0.783 Test Loss: 0.616 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3836455345153809
Epoch: 11, Steps: 9 | Train Loss: 0.116 Vali Loss: 0.720 Vali Acc: 0.819 Test Loss: 0.720 Test Acc: 0.819
Validation loss decreased (-0.804342 --> -0.818833).  Saving model ...
Epoch: 12 cost time: 1.8213062286376953
Epoch: 12, Steps: 9 | Train Loss: 0.116 Vali Loss: 0.753 Vali Acc: 0.783 Test Loss: 0.753 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4529342651367188
Epoch: 13, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.634 Vali Acc: 0.804 Test Loss: 0.634 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.5424506664276123
Epoch: 14, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.826 Vali Acc: 0.790 Test Loss: 0.826 Test Acc: 0.790
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.3335673809051514
Epoch: 15, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.703 Vali Acc: 0.797 Test Loss: 0.703 Test Acc: 0.797
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.281766414642334
Epoch: 16, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.822 Vali Acc: 0.812 Test Loss: 0.822 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.3102188110351562
Epoch: 17, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.667 Vali Acc: 0.841 Test Loss: 0.667 Test Acc: 0.841
Validation loss decreased (-0.818833 --> -0.840573).  Saving model ...
Epoch: 18 cost time: 2.150517463684082
Epoch: 18, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.721 Vali Acc: 0.841 Test Loss: 0.721 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.006702184677124
Epoch: 19, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.829 Vali Acc: 0.819 Test Loss: 0.829 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.9062035083770752
Epoch: 20, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.728 Vali Acc: 0.841 Test Loss: 0.728 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.8564236164093018
Epoch: 21, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.724 Vali Acc: 0.841 Test Loss: 0.724 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.139200210571289
Epoch: 22, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.810 Vali Acc: 0.826 Test Loss: 0.810 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.171804666519165
Epoch: 23, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.866 Vali Acc: 0.826 Test Loss: 0.866 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.7008516788482666
Epoch: 24, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.832 Vali Acc: 0.826 Test Loss: 0.832 Test Acc: 0.826
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.8311336040496826
Epoch: 25, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.856 Vali Acc: 0.826 Test Loss: 0.856 Test Acc: 0.826
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.1936347484588623
Epoch: 26, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.851 Vali Acc: 0.826 Test Loss: 0.851 Test Acc: 0.826
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.9233973026275635
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.834 Vali Acc: 0.826 Test Loss: 0.834 Test Acc: 0.826
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el6_dm768_df768_ps18_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8405797101449275
model parameter : 43599364
model size : 181.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el6_dm768_df768_ps18_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.508077621459961
Epoch: 1, Steps: 9 | Train Loss: 1.483 Vali Loss: 1.380 Vali Acc: 0.261 Test Loss: 1.380 Test Acc: 0.261
Validation loss decreased (inf --> -0.260856).  Saving model ...
Epoch: 2 cost time: 1.0800809860229492
Epoch: 2, Steps: 9 | Train Loss: 1.351 Vali Loss: 1.289 Vali Acc: 0.341 Test Loss: 1.289 Test Acc: 0.341
Validation loss decreased (-0.260856 --> -0.340567).  Saving model ...
Epoch: 3 cost time: 1.2627472877502441
Epoch: 3, Steps: 9 | Train Loss: 1.252 Vali Loss: 1.190 Vali Acc: 0.442 Test Loss: 1.190 Test Acc: 0.442
Validation loss decreased (-0.340567 --> -0.442017).  Saving model ...
Epoch: 4 cost time: 1.0874717235565186
Epoch: 4, Steps: 9 | Train Loss: 1.150 Vali Loss: 1.084 Vali Acc: 0.493 Test Loss: 1.084 Test Acc: 0.493
Validation loss decreased (-0.442017 --> -0.492743).  Saving model ...
Epoch: 5 cost time: 1.1491539478302002
Epoch: 5, Steps: 9 | Train Loss: 0.997 Vali Loss: 0.994 Vali Acc: 0.543 Test Loss: 0.994 Test Acc: 0.543
Validation loss decreased (-0.492743 --> -0.543468).  Saving model ...
Epoch: 6 cost time: 1.0187387466430664
Epoch: 6, Steps: 9 | Train Loss: 0.866 Vali Loss: 0.941 Vali Acc: 0.536 Test Loss: 0.941 Test Acc: 0.536
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4928157329559326
Epoch: 7, Steps: 9 | Train Loss: 0.719 Vali Loss: 0.861 Vali Acc: 0.667 Test Loss: 0.861 Test Acc: 0.667
Validation loss decreased (-0.543468 --> -0.666658).  Saving model ...
Epoch: 8 cost time: 1.2656950950622559
Epoch: 8, Steps: 9 | Train Loss: 0.596 Vali Loss: 0.809 Vali Acc: 0.732 Test Loss: 0.809 Test Acc: 0.732
Validation loss decreased (-0.666658 --> -0.731876).  Saving model ...
Epoch: 9 cost time: 1.1623780727386475
Epoch: 9, Steps: 9 | Train Loss: 0.492 Vali Loss: 0.720 Vali Acc: 0.790 Test Loss: 0.720 Test Acc: 0.790
Validation loss decreased (-0.731876 --> -0.789848).  Saving model ...
Epoch: 10 cost time: 1.077867031097412
Epoch: 10, Steps: 9 | Train Loss: 0.406 Vali Loss: 0.720 Vali Acc: 0.746 Test Loss: 0.720 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2221221923828125
Epoch: 11, Steps: 9 | Train Loss: 0.308 Vali Loss: 0.653 Vali Acc: 0.783 Test Loss: 0.653 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.0475239753723145
Epoch: 12, Steps: 9 | Train Loss: 0.214 Vali Loss: 0.659 Vali Acc: 0.790 Test Loss: 0.659 Test Acc: 0.790
Validation loss decreased (-0.789848 --> -0.789848).  Saving model ...
Epoch: 13 cost time: 1.2357285022735596
Epoch: 13, Steps: 9 | Train Loss: 0.132 Vali Loss: 0.710 Vali Acc: 0.768 Test Loss: 0.710 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.5809073448181152
Epoch: 14, Steps: 9 | Train Loss: 0.076 Vali Loss: 0.735 Vali Acc: 0.775 Test Loss: 0.735 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.399768590927124
Epoch: 15, Steps: 9 | Train Loss: 0.059 Vali Loss: 0.745 Vali Acc: 0.783 Test Loss: 0.745 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.2284657955169678
Epoch: 16, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.741 Vali Acc: 0.775 Test Loss: 0.741 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.0606677532196045
Epoch: 17, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.725 Vali Acc: 0.761 Test Loss: 0.725 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.1917741298675537
Epoch: 18, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.870 Vali Acc: 0.775 Test Loss: 0.870 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.3688273429870605
Epoch: 19, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.788 Vali Acc: 0.768 Test Loss: 0.788 Test Acc: 0.768
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.233733892440796
Epoch: 20, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.861 Vali Acc: 0.768 Test Loss: 0.861 Test Acc: 0.768
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.3951637744903564
Epoch: 21, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.812 Vali Acc: 0.790 Test Loss: 0.812 Test Acc: 0.790
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.432187557220459
Epoch: 22, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.864 Vali Acc: 0.775 Test Loss: 0.864 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el6_dm768_df768_ps18_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.7898550724637681
model parameter : 43553284
model size : 180.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el6_dm768_df768_ps19_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.8635690212249756
Epoch: 1, Steps: 9 | Train Loss: 1.447 Vali Loss: 1.381 Vali Acc: 0.283 Test Loss: 1.381 Test Acc: 0.283
Validation loss decreased (inf --> -0.282595).  Saving model ...
Epoch: 2 cost time: 2.4187934398651123
Epoch: 2, Steps: 9 | Train Loss: 1.266 Vali Loss: 1.173 Vali Acc: 0.486 Test Loss: 1.173 Test Acc: 0.486
Validation loss decreased (-0.282595 --> -0.485496).  Saving model ...
Epoch: 3 cost time: 2.052184820175171
Epoch: 3, Steps: 9 | Train Loss: 1.063 Vali Loss: 1.026 Vali Acc: 0.514 Test Loss: 1.026 Test Acc: 0.514
Validation loss decreased (-0.485496 --> -0.514482).  Saving model ...
Epoch: 4 cost time: 1.8160173892974854
Epoch: 4, Steps: 9 | Train Loss: 0.805 Vali Loss: 0.866 Vali Acc: 0.652 Test Loss: 0.866 Test Acc: 0.652
Validation loss decreased (-0.514482 --> -0.652165).  Saving model ...
Epoch: 5 cost time: 2.0729217529296875
Epoch: 5, Steps: 9 | Train Loss: 0.667 Vali Loss: 0.827 Vali Acc: 0.674 Test Loss: 0.827 Test Acc: 0.674
Validation loss decreased (-0.652165 --> -0.673905).  Saving model ...
Epoch: 6 cost time: 2.0236196517944336
Epoch: 6, Steps: 9 | Train Loss: 0.564 Vali Loss: 0.615 Vali Acc: 0.768 Test Loss: 0.615 Test Acc: 0.768
Validation loss decreased (-0.673905 --> -0.768110).  Saving model ...
Epoch: 7 cost time: 2.133118152618408
Epoch: 7, Steps: 9 | Train Loss: 0.369 Vali Loss: 0.793 Vali Acc: 0.717 Test Loss: 0.793 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.230494976043701
Epoch: 8, Steps: 9 | Train Loss: 0.265 Vali Loss: 0.762 Vali Acc: 0.703 Test Loss: 0.762 Test Acc: 0.703
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.0711781978607178
Epoch: 9, Steps: 9 | Train Loss: 0.139 Vali Loss: 0.592 Vali Acc: 0.804 Test Loss: 0.592 Test Acc: 0.804
Validation loss decreased (-0.768110 --> -0.804342).  Saving model ...
Epoch: 10 cost time: 2.4447290897369385
Epoch: 10, Steps: 9 | Train Loss: 0.119 Vali Loss: 1.005 Vali Acc: 0.710 Test Loss: 1.005 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7227716445922852
Epoch: 11, Steps: 9 | Train Loss: 0.095 Vali Loss: 0.717 Vali Acc: 0.862 Test Loss: 0.717 Test Acc: 0.862
Validation loss decreased (-0.804342 --> -0.862312).  Saving model ...
Epoch: 12 cost time: 2.3784406185150146
Epoch: 12, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.825 Vali Acc: 0.783 Test Loss: 0.825 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.934208631515503
Epoch: 13, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.929 Vali Acc: 0.826 Test Loss: 0.929 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.7592291831970215
Epoch: 14, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.647 Vali Acc: 0.870 Test Loss: 0.647 Test Acc: 0.870
Validation loss decreased (-0.862312 --> -0.869559).  Saving model ...
Epoch: 15 cost time: 1.3473541736602783
Epoch: 15, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.886 Vali Acc: 0.833 Test Loss: 0.886 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.5038752555847168
Epoch: 16, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.735 Vali Acc: 0.870 Test Loss: 0.735 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.4266529083251953
Epoch: 17, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.986 Vali Acc: 0.833 Test Loss: 0.986 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.8622851371765137
Epoch: 18, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.732 Vali Acc: 0.848 Test Loss: 0.732 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.7744574546813965
Epoch: 19, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.973 Vali Acc: 0.833 Test Loss: 0.973 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.141240119934082
Epoch: 20, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.895 Vali Acc: 0.833 Test Loss: 0.895 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.7469966411590576
Epoch: 21, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.789 Vali Acc: 0.841 Test Loss: 0.789 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.5595741271972656
Epoch: 22, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.863 Vali Acc: 0.848 Test Loss: 0.863 Test Acc: 0.848
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.7423951625823975
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.856 Vali Acc: 0.855 Test Loss: 0.856 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.648787260055542
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.797 Vali Acc: 0.855 Test Loss: 0.797 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el6_dm768_df768_ps19_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8695652173913043
model parameter : 43684612
model size : 181.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el6_dm768_df768_ps19_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.954709529876709
Epoch: 1, Steps: 9 | Train Loss: 1.450 Vali Loss: 1.373 Vali Acc: 0.348 Test Loss: 1.373 Test Acc: 0.348
Validation loss decreased (inf --> -0.347812).  Saving model ...
Epoch: 2 cost time: 1.9473450183868408
Epoch: 2, Steps: 9 | Train Loss: 1.292 Vali Loss: 1.243 Vali Acc: 0.522 Test Loss: 1.243 Test Acc: 0.522
Validation loss decreased (-0.347812 --> -0.521727).  Saving model ...
Epoch: 3 cost time: 1.158616542816162
Epoch: 3, Steps: 9 | Train Loss: 1.167 Vali Loss: 1.105 Vali Acc: 0.609 Test Loss: 1.105 Test Acc: 0.609
Validation loss decreased (-0.521727 --> -0.608685).  Saving model ...
Epoch: 4 cost time: 1.9114415645599365
Epoch: 4, Steps: 9 | Train Loss: 0.995 Vali Loss: 0.961 Vali Acc: 0.652 Test Loss: 0.961 Test Acc: 0.652
Validation loss decreased (-0.608685 --> -0.652164).  Saving model ...
Epoch: 5 cost time: 1.4416520595550537
Epoch: 5, Steps: 9 | Train Loss: 0.837 Vali Loss: 0.856 Vali Acc: 0.652 Test Loss: 0.856 Test Acc: 0.652
Validation loss decreased (-0.652164 --> -0.652165).  Saving model ...
Epoch: 6 cost time: 1.877650499343872
Epoch: 6, Steps: 9 | Train Loss: 0.683 Vali Loss: 0.718 Vali Acc: 0.725 Test Loss: 0.718 Test Acc: 0.725
Validation loss decreased (-0.652165 --> -0.724630).  Saving model ...
Epoch: 7 cost time: 1.7353720664978027
Epoch: 7, Steps: 9 | Train Loss: 0.474 Vali Loss: 0.742 Vali Acc: 0.674 Test Loss: 0.742 Test Acc: 0.674
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4664745330810547
Epoch: 8, Steps: 9 | Train Loss: 0.361 Vali Loss: 0.695 Vali Acc: 0.754 Test Loss: 0.695 Test Acc: 0.754
Validation loss decreased (-0.724630 --> -0.753616).  Saving model ...
Epoch: 9 cost time: 1.7507505416870117
Epoch: 9, Steps: 9 | Train Loss: 0.272 Vali Loss: 0.734 Vali Acc: 0.746 Test Loss: 0.734 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7831618785858154
Epoch: 10, Steps: 9 | Train Loss: 0.198 Vali Loss: 0.706 Vali Acc: 0.797 Test Loss: 0.706 Test Acc: 0.797
Validation loss decreased (-0.753616 --> -0.797094).  Saving model ...
Epoch: 11 cost time: 1.5421414375305176
Epoch: 11, Steps: 9 | Train Loss: 0.106 Vali Loss: 0.714 Vali Acc: 0.826 Test Loss: 0.714 Test Acc: 0.826
Validation loss decreased (-0.797094 --> -0.826080).  Saving model ...
Epoch: 12 cost time: 1.581418514251709
Epoch: 12, Steps: 9 | Train Loss: 0.086 Vali Loss: 0.663 Vali Acc: 0.826 Test Loss: 0.663 Test Acc: 0.826
Validation loss decreased (-0.826080 --> -0.826080).  Saving model ...
Epoch: 13 cost time: 1.8330869674682617
Epoch: 13, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.745 Vali Acc: 0.819 Test Loss: 0.745 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.7557446956634521
Epoch: 14, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.742 Vali Acc: 0.833 Test Loss: 0.742 Test Acc: 0.833
Validation loss decreased (-0.826080 --> -0.833326).  Saving model ...
Epoch: 15 cost time: 1.7740302085876465
Epoch: 15, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.786 Vali Acc: 0.819 Test Loss: 0.786 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.7461180686950684
Epoch: 16, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.942 Vali Acc: 0.841 Test Loss: 0.942 Test Acc: 0.841
Validation loss decreased (-0.833326 --> -0.840570).  Saving model ...
Epoch: 17 cost time: 2.0886268615722656
Epoch: 17, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.802 Vali Acc: 0.833 Test Loss: 0.802 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.258317470550537
Epoch: 18, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.739 Vali Acc: 0.826 Test Loss: 0.739 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.5735597610473633
Epoch: 19, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.759 Vali Acc: 0.826 Test Loss: 0.759 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.3042042255401611
Epoch: 20, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.837 Vali Acc: 0.826 Test Loss: 0.837 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.3024508953094482
Epoch: 21, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.814 Vali Acc: 0.841 Test Loss: 0.814 Test Acc: 0.841
Validation loss decreased (-0.840570 --> -0.840572).  Saving model ...
Epoch: 22 cost time: 1.3994226455688477
Epoch: 22, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.790 Vali Acc: 0.841 Test Loss: 0.790 Test Acc: 0.841
Validation loss decreased (-0.840572 --> -0.840572).  Saving model ...
Epoch: 23 cost time: 1.4918906688690186
Epoch: 23, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.824 Vali Acc: 0.826 Test Loss: 0.824 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.6378443241119385
Epoch: 24, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.885 Vali Acc: 0.826 Test Loss: 0.885 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.5263798236846924
Epoch: 25, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.895 Vali Acc: 0.833 Test Loss: 0.895 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.2893352508544922
Epoch: 26, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.872 Vali Acc: 0.833 Test Loss: 0.872 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.5117108821868896
Epoch: 27, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.842 Vali Acc: 0.826 Test Loss: 0.842 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.4682950973510742
Epoch: 28, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.866 Vali Acc: 0.833 Test Loss: 0.866 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.847747564315796
Epoch: 29, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.862 Vali Acc: 0.826 Test Loss: 0.862 Test Acc: 0.826
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.4598643779754639
Epoch: 30, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.879 Vali Acc: 0.826 Test Loss: 0.879 Test Acc: 0.826
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.3146822452545166
Epoch: 31, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.888 Vali Acc: 0.826 Test Loss: 0.888 Test Acc: 0.826
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.6293554306030273
Epoch: 32, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.861 Vali Acc: 0.833 Test Loss: 0.861 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el6_dm768_df768_ps19_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8405797101449275
model parameter : 43597060
model size : 180.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el6_dm768_df768_ps19_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.5443532466888428
Epoch: 1, Steps: 9 | Train Loss: 1.435 Vali Loss: 1.380 Vali Acc: 0.246 Test Loss: 1.380 Test Acc: 0.246
Validation loss decreased (inf --> -0.246363).  Saving model ...
Epoch: 2 cost time: 1.0874948501586914
Epoch: 2, Steps: 9 | Train Loss: 1.323 Vali Loss: 1.303 Vali Acc: 0.399 Test Loss: 1.303 Test Acc: 0.399
Validation loss decreased (-0.246363 --> -0.398538).  Saving model ...
Epoch: 3 cost time: 0.7157731056213379
Epoch: 3, Steps: 9 | Train Loss: 1.220 Vali Loss: 1.213 Vali Acc: 0.486 Test Loss: 1.213 Test Acc: 0.486
Validation loss decreased (-0.398538 --> -0.485495).  Saving model ...
Epoch: 4 cost time: 0.91304612159729
Epoch: 4, Steps: 9 | Train Loss: 1.091 Vali Loss: 1.113 Vali Acc: 0.558 Test Loss: 1.113 Test Acc: 0.558
Validation loss decreased (-0.485495 --> -0.557960).  Saving model ...
Epoch: 5 cost time: 1.111478567123413
Epoch: 5, Steps: 9 | Train Loss: 0.988 Vali Loss: 1.024 Vali Acc: 0.616 Test Loss: 1.024 Test Acc: 0.616
Validation loss decreased (-0.557960 --> -0.615932).  Saving model ...
Epoch: 6 cost time: 0.920619010925293
Epoch: 6, Steps: 9 | Train Loss: 0.875 Vali Loss: 0.928 Vali Acc: 0.587 Test Loss: 0.928 Test Acc: 0.587
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9734325408935547
Epoch: 7, Steps: 9 | Train Loss: 0.688 Vali Loss: 0.838 Vali Acc: 0.645 Test Loss: 0.838 Test Acc: 0.645
Validation loss decreased (-0.615932 --> -0.644919).  Saving model ...
Epoch: 8 cost time: 1.0470848083496094
Epoch: 8, Steps: 9 | Train Loss: 0.533 Vali Loss: 0.749 Vali Acc: 0.696 Test Loss: 0.749 Test Acc: 0.696
Validation loss decreased (-0.644919 --> -0.695645).  Saving model ...
Epoch: 9 cost time: 1.0445823669433594
Epoch: 9, Steps: 9 | Train Loss: 0.453 Vali Loss: 0.715 Vali Acc: 0.717 Test Loss: 0.715 Test Acc: 0.717
Validation loss decreased (-0.695645 --> -0.717384).  Saving model ...
Epoch: 10 cost time: 1.001722812652588
Epoch: 10, Steps: 9 | Train Loss: 0.327 Vali Loss: 0.619 Vali Acc: 0.768 Test Loss: 0.619 Test Acc: 0.768
Validation loss decreased (-0.717384 --> -0.768110).  Saving model ...
Epoch: 11 cost time: 0.963068962097168
Epoch: 11, Steps: 9 | Train Loss: 0.220 Vali Loss: 0.598 Vali Acc: 0.783 Test Loss: 0.598 Test Acc: 0.783
Validation loss decreased (-0.768110 --> -0.782603).  Saving model ...
Epoch: 12 cost time: 1.0416154861450195
Epoch: 12, Steps: 9 | Train Loss: 0.156 Vali Loss: 0.623 Vali Acc: 0.790 Test Loss: 0.623 Test Acc: 0.790
Validation loss decreased (-0.782603 --> -0.789849).  Saving model ...
Epoch: 13 cost time: 1.1387219429016113
Epoch: 13, Steps: 9 | Train Loss: 0.111 Vali Loss: 0.537 Vali Acc: 0.804 Test Loss: 0.537 Test Acc: 0.804
Validation loss decreased (-0.789849 --> -0.804342).  Saving model ...
Epoch: 14 cost time: 1.5224084854125977
Epoch: 14, Steps: 9 | Train Loss: 0.071 Vali Loss: 0.589 Vali Acc: 0.804 Test Loss: 0.589 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3527188301086426
Epoch: 15, Steps: 9 | Train Loss: 0.055 Vali Loss: 0.666 Vali Acc: 0.819 Test Loss: 0.666 Test Acc: 0.819
Validation loss decreased (-0.804342 --> -0.818834).  Saving model ...
Epoch: 16 cost time: 1.3594598770141602
Epoch: 16, Steps: 9 | Train Loss: 0.061 Vali Loss: 0.598 Vali Acc: 0.812 Test Loss: 0.598 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2562263011932373
Epoch: 17, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.601 Vali Acc: 0.819 Test Loss: 0.601 Test Acc: 0.819
Validation loss decreased (-0.818834 --> -0.818835).  Saving model ...
Epoch: 18 cost time: 1.2295193672180176
Epoch: 18, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.672 Vali Acc: 0.804 Test Loss: 0.672 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1970531940460205
Epoch: 19, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.752 Vali Acc: 0.804 Test Loss: 0.752 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.289214849472046
Epoch: 20, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.739 Vali Acc: 0.819 Test Loss: 0.739 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.6063063144683838
Epoch: 21, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.689 Vali Acc: 0.826 Test Loss: 0.689 Test Acc: 0.826
Validation loss decreased (-0.818835 --> -0.826080).  Saving model ...
Epoch: 22 cost time: 1.4253525733947754
Epoch: 22, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.625 Vali Acc: 0.819 Test Loss: 0.625 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.4781477451324463
Epoch: 23, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.641 Vali Acc: 0.826 Test Loss: 0.641 Test Acc: 0.826
Validation loss decreased (-0.826080 --> -0.826081).  Saving model ...
Epoch: 24 cost time: 1.1526880264282227
Epoch: 24, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.699 Vali Acc: 0.812 Test Loss: 0.699 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.1110713481903076
Epoch: 25, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.792 Vali Acc: 0.819 Test Loss: 0.792 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.2079200744628906
Epoch: 26, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.770 Vali Acc: 0.812 Test Loss: 0.770 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.242737054824829
Epoch: 27, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.720 Vali Acc: 0.819 Test Loss: 0.720 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.338465929031372
Epoch: 28, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.720 Vali Acc: 0.826 Test Loss: 0.720 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.3613228797912598
Epoch: 29, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.740 Vali Acc: 0.826 Test Loss: 0.740 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.1507830619812012
Epoch: 30, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.716 Vali Acc: 0.826 Test Loss: 0.716 Test Acc: 0.826
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.2550878524780273
Epoch: 31, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.739 Vali Acc: 0.833 Test Loss: 0.739 Test Acc: 0.833
Validation loss decreased (-0.826081 --> -0.833326).  Saving model ...
Epoch: 32 cost time: 1.361994743347168
Epoch: 32, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.810 Vali Acc: 0.826 Test Loss: 0.810 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.180736780166626
Epoch: 33, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.826 Vali Acc: 0.826 Test Loss: 0.826 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.1930887699127197
Epoch: 34, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.756 Vali Acc: 0.826 Test Loss: 0.756 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.2488584518432617
Epoch: 35, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.750 Vali Acc: 0.826 Test Loss: 0.750 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.2561378479003906
Epoch: 36, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.766 Vali Acc: 0.826 Test Loss: 0.766 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.2524077892303467
Epoch: 37, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.782 Vali Acc: 0.826 Test Loss: 0.782 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.0558156967163086
Epoch: 38, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.808 Vali Acc: 0.819 Test Loss: 0.808 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.24027419090271
Epoch: 39, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.816 Vali Acc: 0.819 Test Loss: 0.816 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.5388965606689453
Epoch: 40, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.813 Vali Acc: 0.826 Test Loss: 0.813 Test Acc: 0.826
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.3964464664459229
Epoch: 41, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.773 Vali Acc: 0.833 Test Loss: 0.773 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el6_dm768_df768_ps19_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8333333333333334
model parameter : 43555588
model size : 180.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el6_dm768_df768_ps21_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.8574297428131104
Epoch: 1, Steps: 9 | Train Loss: 1.473 Vali Loss: 1.338 Vali Acc: 0.370 Test Loss: 1.338 Test Acc: 0.370
Validation loss decreased (inf --> -0.369552).  Saving model ...
Epoch: 2 cost time: 1.7092204093933105
Epoch: 2, Steps: 9 | Train Loss: 1.280 Vali Loss: 1.168 Vali Acc: 0.500 Test Loss: 1.168 Test Acc: 0.500
Validation loss decreased (-0.369552 --> -0.499988).  Saving model ...
Epoch: 3 cost time: 1.0663871765136719
Epoch: 3, Steps: 9 | Train Loss: 1.068 Vali Loss: 0.977 Vali Acc: 0.652 Test Loss: 0.977 Test Acc: 0.652
Validation loss decreased (-0.499988 --> -0.652164).  Saving model ...
Epoch: 4 cost time: 1.6114094257354736
Epoch: 4, Steps: 9 | Train Loss: 0.822 Vali Loss: 0.834 Vali Acc: 0.645 Test Loss: 0.834 Test Acc: 0.645
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4823999404907227
Epoch: 5, Steps: 9 | Train Loss: 0.683 Vali Loss: 0.754 Vali Acc: 0.688 Test Loss: 0.754 Test Acc: 0.688
Validation loss decreased (-0.652164 --> -0.688398).  Saving model ...
Epoch: 6 cost time: 1.724611520767212
Epoch: 6, Steps: 9 | Train Loss: 0.469 Vali Loss: 0.588 Vali Acc: 0.746 Test Loss: 0.588 Test Acc: 0.746
Validation loss decreased (-0.688398 --> -0.746371).  Saving model ...
Epoch: 7 cost time: 2.1631228923797607
Epoch: 7, Steps: 9 | Train Loss: 0.304 Vali Loss: 0.792 Vali Acc: 0.630 Test Loss: 0.792 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.180680274963379
Epoch: 8, Steps: 9 | Train Loss: 0.240 Vali Loss: 0.544 Vali Acc: 0.812 Test Loss: 0.544 Test Acc: 0.812
Validation loss decreased (-0.746371 --> -0.811589).  Saving model ...
Epoch: 9 cost time: 1.4892709255218506
Epoch: 9, Steps: 9 | Train Loss: 0.142 Vali Loss: 0.807 Vali Acc: 0.812 Test Loss: 0.807 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.292130947113037
Epoch: 10, Steps: 9 | Train Loss: 0.091 Vali Loss: 0.755 Vali Acc: 0.790 Test Loss: 0.755 Test Acc: 0.790
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.5080180168151855
Epoch: 11, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.715 Vali Acc: 0.804 Test Loss: 0.715 Test Acc: 0.804
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.9395880699157715
Epoch: 12, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.936 Vali Acc: 0.783 Test Loss: 0.936 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.3948030471801758
Epoch: 13, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.903 Vali Acc: 0.775 Test Loss: 0.903 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.590672492980957
Epoch: 14, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.617 Vali Acc: 0.841 Test Loss: 0.617 Test Acc: 0.841
Validation loss decreased (-0.811589 --> -0.840574).  Saving model ...
Epoch: 15 cost time: 1.881213903427124
Epoch: 15, Steps: 9 | Train Loss: 0.016 Vali Loss: 1.233 Vali Acc: 0.775 Test Loss: 1.233 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.9129664897918701
Epoch: 16, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.937 Vali Acc: 0.833 Test Loss: 0.937 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.969228744506836
Epoch: 17, Steps: 9 | Train Loss: 0.005 Vali Loss: 1.017 Vali Acc: 0.826 Test Loss: 1.017 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.1200711727142334
Epoch: 18, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.000 Vali Acc: 0.812 Test Loss: 1.000 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.011453151702881
Epoch: 19, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.940 Vali Acc: 0.833 Test Loss: 0.940 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.7026524543762207
Epoch: 20, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.925 Vali Acc: 0.833 Test Loss: 0.925 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.933255672454834
Epoch: 21, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.815 Vali Acc: 0.833 Test Loss: 0.815 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.9213027954101562
Epoch: 22, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.840 Vali Acc: 0.833 Test Loss: 0.840 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.8373990058898926
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.949 Vali Acc: 0.826 Test Loss: 0.949 Test Acc: 0.826
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.6765236854553223
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.935 Vali Acc: 0.826 Test Loss: 0.935 Test Acc: 0.826
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el6_dm768_df768_ps21_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8405797101449275
model parameter : 43666180
model size : 181.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el6_dm768_df768_ps21_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.473990440368652
Epoch: 1, Steps: 9 | Train Loss: 1.477 Vali Loss: 1.339 Vali Acc: 0.413 Test Loss: 1.339 Test Acc: 0.413
Validation loss decreased (inf --> -0.413030).  Saving model ...
Epoch: 2 cost time: 1.5829360485076904
Epoch: 2, Steps: 9 | Train Loss: 1.296 Vali Loss: 1.248 Vali Acc: 0.471 Test Loss: 1.248 Test Acc: 0.471
Validation loss decreased (-0.413030 --> -0.471002).  Saving model ...
Epoch: 3 cost time: 1.3281872272491455
Epoch: 3, Steps: 9 | Train Loss: 1.187 Vali Loss: 1.104 Vali Acc: 0.652 Test Loss: 1.104 Test Acc: 0.652
Validation loss decreased (-0.471002 --> -0.652163).  Saving model ...
Epoch: 4 cost time: 1.540041446685791
Epoch: 4, Steps: 9 | Train Loss: 1.013 Vali Loss: 0.968 Vali Acc: 0.645 Test Loss: 0.968 Test Acc: 0.645
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4969441890716553
Epoch: 5, Steps: 9 | Train Loss: 0.823 Vali Loss: 0.844 Vali Acc: 0.638 Test Loss: 0.844 Test Acc: 0.638
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.8267183303833008
Epoch: 6, Steps: 9 | Train Loss: 0.665 Vali Loss: 0.730 Vali Acc: 0.667 Test Loss: 0.730 Test Acc: 0.667
Validation loss decreased (-0.652163 --> -0.666659).  Saving model ...
Epoch: 7 cost time: 1.3691420555114746
Epoch: 7, Steps: 9 | Train Loss: 0.462 Vali Loss: 0.656 Vali Acc: 0.703 Test Loss: 0.656 Test Acc: 0.703
Validation loss decreased (-0.666659 --> -0.702892).  Saving model ...
Epoch: 8 cost time: 1.7797205448150635
Epoch: 8, Steps: 9 | Train Loss: 0.359 Vali Loss: 0.682 Vali Acc: 0.732 Test Loss: 0.682 Test Acc: 0.732
Validation loss decreased (-0.702892 --> -0.731877).  Saving model ...
Epoch: 9 cost time: 1.417691707611084
Epoch: 9, Steps: 9 | Train Loss: 0.313 Vali Loss: 0.644 Vali Acc: 0.804 Test Loss: 0.644 Test Acc: 0.804
Validation loss decreased (-0.731877 --> -0.804341).  Saving model ...
Epoch: 10 cost time: 1.126246452331543
Epoch: 10, Steps: 9 | Train Loss: 0.231 Vali Loss: 0.797 Vali Acc: 0.768 Test Loss: 0.797 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1857712268829346
Epoch: 11, Steps: 9 | Train Loss: 0.179 Vali Loss: 0.602 Vali Acc: 0.754 Test Loss: 0.602 Test Acc: 0.754
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.2674098014831543
Epoch: 12, Steps: 9 | Train Loss: 0.116 Vali Loss: 0.992 Vali Acc: 0.768 Test Loss: 0.992 Test Acc: 0.768
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.3199338912963867
Epoch: 13, Steps: 9 | Train Loss: 0.096 Vali Loss: 0.763 Vali Acc: 0.804 Test Loss: 0.763 Test Acc: 0.804
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.324101448059082
Epoch: 14, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.803 Vali Acc: 0.812 Test Loss: 0.803 Test Acc: 0.812
Validation loss decreased (-0.804341 --> -0.811586).  Saving model ...
Epoch: 15 cost time: 1.5513248443603516
Epoch: 15, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.700 Vali Acc: 0.812 Test Loss: 0.700 Test Acc: 0.812
Validation loss decreased (-0.811586 --> -0.811587).  Saving model ...
Epoch: 16 cost time: 1.8579964637756348
Epoch: 16, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.831 Vali Acc: 0.797 Test Loss: 0.831 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.7145156860351562
Epoch: 17, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.810 Vali Acc: 0.797 Test Loss: 0.810 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.013550043106079
Epoch: 18, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.852 Vali Acc: 0.812 Test Loss: 0.852 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.0828940868377686
Epoch: 19, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.755 Vali Acc: 0.819 Test Loss: 0.755 Test Acc: 0.819
Validation loss decreased (-0.811587 --> -0.818833).  Saving model ...
Epoch: 20 cost time: 1.894371747970581
Epoch: 20, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.764 Vali Acc: 0.819 Test Loss: 0.764 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.9869475364685059
Epoch: 21, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.837 Vali Acc: 0.812 Test Loss: 0.837 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.182373046875
Epoch: 22, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.759 Vali Acc: 0.826 Test Loss: 0.759 Test Acc: 0.826
Validation loss decreased (-0.818833 --> -0.826079).  Saving model ...
Epoch: 23 cost time: 2.1140146255493164
Epoch: 23, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.759 Vali Acc: 0.826 Test Loss: 0.759 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.0127925872802734
Epoch: 24, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.827 Vali Acc: 0.819 Test Loss: 0.827 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.165262222290039
Epoch: 25, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.846 Vali Acc: 0.819 Test Loss: 0.846 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.4552133083343506
Epoch: 26, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.851 Vali Acc: 0.812 Test Loss: 0.851 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.3482959270477295
Epoch: 27, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.847 Vali Acc: 0.812 Test Loss: 0.847 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.9108214378356934
Epoch: 28, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.814 Vali Acc: 0.826 Test Loss: 0.814 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.6548478603363037
Epoch: 29, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.818 Vali Acc: 0.819 Test Loss: 0.818 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.8000881671905518
Epoch: 30, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.853 Vali Acc: 0.819 Test Loss: 0.853 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.8776154518127441
Epoch: 31, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.861 Vali Acc: 0.812 Test Loss: 0.861 Test Acc: 0.812
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 2.2903895378112793
Epoch: 32, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.853 Vali Acc: 0.826 Test Loss: 0.853 Test Acc: 0.826
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el6_dm768_df768_ps21_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8260869565217391
model parameter : 43601668
model size : 181.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el6_dm768_df768_ps21_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.290313720703125
Epoch: 1, Steps: 9 | Train Loss: 1.424 Vali Loss: 1.367 Vali Acc: 0.283 Test Loss: 1.367 Test Acc: 0.283
Validation loss decreased (inf --> -0.282595).  Saving model ...
Epoch: 2 cost time: 1.1285293102264404
Epoch: 2, Steps: 9 | Train Loss: 1.332 Vali Loss: 1.268 Vali Acc: 0.478 Test Loss: 1.268 Test Acc: 0.478
Validation loss decreased (-0.282595 --> -0.478248).  Saving model ...
Epoch: 3 cost time: 1.3416988849639893
Epoch: 3, Steps: 9 | Train Loss: 1.241 Vali Loss: 1.174 Vali Acc: 0.580 Test Loss: 1.174 Test Acc: 0.580
Validation loss decreased (-0.478248 --> -0.579698).  Saving model ...
Epoch: 4 cost time: 1.3501198291778564
Epoch: 4, Steps: 9 | Train Loss: 1.137 Vali Loss: 1.056 Vali Acc: 0.667 Test Loss: 1.056 Test Acc: 0.667
Validation loss decreased (-0.579698 --> -0.666656).  Saving model ...
Epoch: 5 cost time: 1.038259506225586
Epoch: 5, Steps: 9 | Train Loss: 0.970 Vali Loss: 0.979 Vali Acc: 0.609 Test Loss: 0.979 Test Acc: 0.609
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1690037250518799
Epoch: 6, Steps: 9 | Train Loss: 0.830 Vali Loss: 0.858 Vali Acc: 0.659 Test Loss: 0.858 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1188371181488037
Epoch: 7, Steps: 9 | Train Loss: 0.691 Vali Loss: 0.772 Vali Acc: 0.674 Test Loss: 0.772 Test Acc: 0.674
Validation loss decreased (-0.666656 --> -0.673905).  Saving model ...
Epoch: 8 cost time: 1.2083239555358887
Epoch: 8, Steps: 9 | Train Loss: 0.569 Vali Loss: 0.751 Vali Acc: 0.696 Test Loss: 0.751 Test Acc: 0.696
Validation loss decreased (-0.673905 --> -0.695645).  Saving model ...
Epoch: 9 cost time: 0.9994418621063232
Epoch: 9, Steps: 9 | Train Loss: 0.451 Vali Loss: 0.670 Vali Acc: 0.696 Test Loss: 0.670 Test Acc: 0.696
Validation loss decreased (-0.695645 --> -0.695645).  Saving model ...
Epoch: 10 cost time: 0.9888043403625488
Epoch: 10, Steps: 9 | Train Loss: 0.352 Vali Loss: 0.712 Vali Acc: 0.732 Test Loss: 0.712 Test Acc: 0.732
Validation loss decreased (-0.695645 --> -0.731877).  Saving model ...
Epoch: 11 cost time: 1.164632797241211
Epoch: 11, Steps: 9 | Train Loss: 0.246 Vali Loss: 0.692 Vali Acc: 0.768 Test Loss: 0.692 Test Acc: 0.768
Validation loss decreased (-0.731877 --> -0.768109).  Saving model ...
Epoch: 12 cost time: 1.078352928161621
Epoch: 12, Steps: 9 | Train Loss: 0.216 Vali Loss: 0.765 Vali Acc: 0.754 Test Loss: 0.765 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1401617527008057
Epoch: 13, Steps: 9 | Train Loss: 0.127 Vali Loss: 0.676 Vali Acc: 0.790 Test Loss: 0.676 Test Acc: 0.790
Validation loss decreased (-0.768109 --> -0.789848).  Saving model ...
Epoch: 14 cost time: 1.1374988555908203
Epoch: 14, Steps: 9 | Train Loss: 0.086 Vali Loss: 0.647 Vali Acc: 0.790 Test Loss: 0.647 Test Acc: 0.790
Validation loss decreased (-0.789848 --> -0.789849).  Saving model ...
Epoch: 15 cost time: 0.985816478729248
Epoch: 15, Steps: 9 | Train Loss: 0.062 Vali Loss: 0.717 Vali Acc: 0.783 Test Loss: 0.717 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9845995903015137
Epoch: 16, Steps: 9 | Train Loss: 0.062 Vali Loss: 0.662 Vali Acc: 0.804 Test Loss: 0.662 Test Acc: 0.804
Validation loss decreased (-0.789849 --> -0.804341).  Saving model ...
Epoch: 17 cost time: 1.1393487453460693
Epoch: 17, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.784 Vali Acc: 0.790 Test Loss: 0.784 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1660759449005127
Epoch: 18, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.692 Vali Acc: 0.812 Test Loss: 0.692 Test Acc: 0.812
Validation loss decreased (-0.804341 --> -0.811587).  Saving model ...
Epoch: 19 cost time: 0.9474148750305176
Epoch: 19, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.681 Vali Acc: 0.826 Test Loss: 0.681 Test Acc: 0.826
Validation loss decreased (-0.811587 --> -0.826080).  Saving model ...
Epoch: 20 cost time: 0.6959631443023682
Epoch: 20, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.723 Vali Acc: 0.804 Test Loss: 0.723 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7878844738006592
Epoch: 21, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.732 Vali Acc: 0.819 Test Loss: 0.732 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.7570431232452393
Epoch: 22, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.703 Vali Acc: 0.819 Test Loss: 0.703 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.6988768577575684
Epoch: 23, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.810 Vali Acc: 0.819 Test Loss: 0.810 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.0609049797058105
Epoch: 24, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.760 Vali Acc: 0.833 Test Loss: 0.760 Test Acc: 0.833
Validation loss decreased (-0.826080 --> -0.833326).  Saving model ...
Epoch: 25 cost time: 1.003159761428833
Epoch: 25, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.807 Vali Acc: 0.833 Test Loss: 0.807 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.1180167198181152
Epoch: 26, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.803 Vali Acc: 0.826 Test Loss: 0.803 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.0579438209533691
Epoch: 27, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.840 Vali Acc: 0.826 Test Loss: 0.840 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.2030353546142578
Epoch: 28, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.783 Vali Acc: 0.826 Test Loss: 0.783 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.0612478256225586
Epoch: 29, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.812 Vali Acc: 0.826 Test Loss: 0.812 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.1769087314605713
Epoch: 30, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.795 Vali Acc: 0.826 Test Loss: 0.795 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.9871194362640381
Epoch: 31, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.798 Vali Acc: 0.826 Test Loss: 0.798 Test Acc: 0.826
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.2282521724700928
Epoch: 32, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.829 Vali Acc: 0.826 Test Loss: 0.829 Test Acc: 0.826
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.1543304920196533
Epoch: 33, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.828 Vali Acc: 0.833 Test Loss: 0.828 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.3111979961395264
Epoch: 34, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.835 Vali Acc: 0.833 Test Loss: 0.835 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el6_dm768_df768_ps21_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8333333333333334
model parameter : 43564804
model size : 180.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el6_dm768_df768_ps23_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.63236141204834
Epoch: 1, Steps: 9 | Train Loss: 1.486 Vali Loss: 1.340 Vali Acc: 0.312 Test Loss: 1.340 Test Acc: 0.312
Validation loss decreased (inf --> -0.311581).  Saving model ...
Epoch: 2 cost time: 1.7954576015472412
Epoch: 2, Steps: 9 | Train Loss: 1.217 Vali Loss: 1.173 Vali Acc: 0.428 Test Loss: 1.173 Test Acc: 0.428
Validation loss decreased (-0.311581 --> -0.427525).  Saving model ...
Epoch: 3 cost time: 1.825019121170044
Epoch: 3, Steps: 9 | Train Loss: 1.062 Vali Loss: 0.977 Vali Acc: 0.594 Test Loss: 0.977 Test Acc: 0.594
Validation loss decreased (-0.427525 --> -0.594193).  Saving model ...
Epoch: 4 cost time: 1.9178693294525146
Epoch: 4, Steps: 9 | Train Loss: 0.809 Vali Loss: 0.874 Vali Acc: 0.667 Test Loss: 0.874 Test Acc: 0.667
Validation loss decreased (-0.594193 --> -0.666658).  Saving model ...
Epoch: 5 cost time: 1.8638286590576172
Epoch: 5, Steps: 9 | Train Loss: 0.674 Vali Loss: 0.718 Vali Acc: 0.674 Test Loss: 0.718 Test Acc: 0.674
Validation loss decreased (-0.666658 --> -0.673906).  Saving model ...
Epoch: 6 cost time: 2.11183500289917
Epoch: 6, Steps: 9 | Train Loss: 0.501 Vali Loss: 0.574 Vali Acc: 0.783 Test Loss: 0.574 Test Acc: 0.783
Validation loss decreased (-0.673906 --> -0.782603).  Saving model ...
Epoch: 7 cost time: 2.076289176940918
Epoch: 7, Steps: 9 | Train Loss: 0.308 Vali Loss: 0.568 Vali Acc: 0.768 Test Loss: 0.568 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.011587142944336
Epoch: 8, Steps: 9 | Train Loss: 0.223 Vali Loss: 0.511 Vali Acc: 0.812 Test Loss: 0.511 Test Acc: 0.812
Validation loss decreased (-0.782603 --> -0.811589).  Saving model ...
Epoch: 9 cost time: 1.863147258758545
Epoch: 9, Steps: 9 | Train Loss: 0.163 Vali Loss: 0.877 Vali Acc: 0.754 Test Loss: 0.877 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7525484561920166
Epoch: 10, Steps: 9 | Train Loss: 0.107 Vali Loss: 0.562 Vali Acc: 0.819 Test Loss: 0.562 Test Acc: 0.819
Validation loss decreased (-0.811589 --> -0.818835).  Saving model ...
Epoch: 11 cost time: 1.6763107776641846
Epoch: 11, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.775 Vali Acc: 0.797 Test Loss: 0.775 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.61149001121521
Epoch: 12, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.668 Vali Acc: 0.819 Test Loss: 0.668 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.4523746967315674
Epoch: 13, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.662 Vali Acc: 0.833 Test Loss: 0.662 Test Acc: 0.833
Validation loss decreased (-0.818835 --> -0.833327).  Saving model ...
Epoch: 14 cost time: 1.7990999221801758
Epoch: 14, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.737 Vali Acc: 0.826 Test Loss: 0.737 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4475419521331787
Epoch: 15, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.801 Vali Acc: 0.797 Test Loss: 0.801 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.3300316333770752
Epoch: 16, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.751 Vali Acc: 0.797 Test Loss: 0.751 Test Acc: 0.797
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.3723032474517822
Epoch: 17, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.831 Vali Acc: 0.819 Test Loss: 0.831 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.2090198993682861
Epoch: 18, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.944 Vali Acc: 0.826 Test Loss: 0.944 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.6915473937988281
Epoch: 19, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.875 Vali Acc: 0.841 Test Loss: 0.875 Test Acc: 0.841
Validation loss decreased (-0.833327 --> -0.840571).  Saving model ...
Epoch: 20 cost time: 1.109975814819336
Epoch: 20, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.713 Vali Acc: 0.855 Test Loss: 0.713 Test Acc: 0.855
Validation loss decreased (-0.840571 --> -0.855065).  Saving model ...
Epoch: 21 cost time: 1.4073481559753418
Epoch: 21, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.779 Vali Acc: 0.833 Test Loss: 0.779 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.4017329216003418
Epoch: 22, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.741 Vali Acc: 0.841 Test Loss: 0.741 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.3271028995513916
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.682 Vali Acc: 0.848 Test Loss: 0.682 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.204704761505127
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.768 Vali Acc: 0.841 Test Loss: 0.768 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.0417869091033936
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.812 Vali Acc: 0.833 Test Loss: 0.812 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.045107364654541
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.779 Vali Acc: 0.826 Test Loss: 0.779 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.018486738204956
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.743 Vali Acc: 0.826 Test Loss: 0.743 Test Acc: 0.826
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.7886416912078857
Epoch: 28, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.796 Vali Acc: 0.841 Test Loss: 0.796 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.8853514194488525
Epoch: 29, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.805 Vali Acc: 0.841 Test Loss: 0.805 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.705986738204956
Epoch: 30, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.765 Vali Acc: 0.841 Test Loss: 0.765 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el6_dm768_df768_ps23_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.855072463768116
model parameter : 43680004
model size : 181.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el6_dm768_df768_ps23_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.3799333572387695
Epoch: 1, Steps: 9 | Train Loss: 1.499 Vali Loss: 1.378 Vali Acc: 0.333 Test Loss: 1.378 Test Acc: 0.333
Validation loss decreased (inf --> -0.333320).  Saving model ...
Epoch: 2 cost time: 1.437960147857666
Epoch: 2, Steps: 9 | Train Loss: 1.305 Vali Loss: 1.250 Vali Acc: 0.471 Test Loss: 1.250 Test Acc: 0.471
Validation loss decreased (-0.333320 --> -0.471002).  Saving model ...
Epoch: 3 cost time: 1.8243381977081299
Epoch: 3, Steps: 9 | Train Loss: 1.162 Vali Loss: 1.125 Vali Acc: 0.616 Test Loss: 1.125 Test Acc: 0.616
Validation loss decreased (-0.471002 --> -0.615931).  Saving model ...
Epoch: 4 cost time: 1.5130033493041992
Epoch: 4, Steps: 9 | Train Loss: 1.012 Vali Loss: 0.986 Vali Acc: 0.616 Test Loss: 0.986 Test Acc: 0.616
Validation loss decreased (-0.615931 --> -0.615932).  Saving model ...
Epoch: 5 cost time: 1.9176990985870361
Epoch: 5, Steps: 9 | Train Loss: 0.798 Vali Loss: 0.888 Vali Acc: 0.667 Test Loss: 0.888 Test Acc: 0.667
Validation loss decreased (-0.615932 --> -0.666658).  Saving model ...
Epoch: 6 cost time: 1.7259879112243652
Epoch: 6, Steps: 9 | Train Loss: 0.672 Vali Loss: 0.824 Vali Acc: 0.681 Test Loss: 0.824 Test Acc: 0.681
Validation loss decreased (-0.666658 --> -0.681151).  Saving model ...
Epoch: 7 cost time: 1.6152150630950928
Epoch: 7, Steps: 9 | Train Loss: 0.533 Vali Loss: 0.706 Vali Acc: 0.732 Test Loss: 0.706 Test Acc: 0.732
Validation loss decreased (-0.681151 --> -0.731877).  Saving model ...
Epoch: 8 cost time: 1.5627944469451904
Epoch: 8, Steps: 9 | Train Loss: 0.431 Vali Loss: 0.741 Vali Acc: 0.732 Test Loss: 0.741 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4664156436920166
Epoch: 9, Steps: 9 | Train Loss: 0.307 Vali Loss: 0.582 Vali Acc: 0.790 Test Loss: 0.582 Test Acc: 0.790
Validation loss decreased (-0.731877 --> -0.789849).  Saving model ...
Epoch: 10 cost time: 1.5597565174102783
Epoch: 10, Steps: 9 | Train Loss: 0.263 Vali Loss: 0.717 Vali Acc: 0.746 Test Loss: 0.717 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4924449920654297
Epoch: 11, Steps: 9 | Train Loss: 0.146 Vali Loss: 0.563 Vali Acc: 0.826 Test Loss: 0.563 Test Acc: 0.826
Validation loss decreased (-0.789849 --> -0.826081).  Saving model ...
Epoch: 12 cost time: 1.7109835147857666
Epoch: 12, Steps: 9 | Train Loss: 0.087 Vali Loss: 0.709 Vali Acc: 0.783 Test Loss: 0.709 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6600556373596191
Epoch: 13, Steps: 9 | Train Loss: 0.051 Vali Loss: 0.761 Vali Acc: 0.804 Test Loss: 0.761 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.5679593086242676
Epoch: 14, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.755 Vali Acc: 0.804 Test Loss: 0.755 Test Acc: 0.804
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.5607154369354248
Epoch: 15, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.794 Vali Acc: 0.819 Test Loss: 0.794 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.4745736122131348
Epoch: 16, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.773 Vali Acc: 0.833 Test Loss: 0.773 Test Acc: 0.833
Validation loss decreased (-0.826081 --> -0.833326).  Saving model ...
Epoch: 17 cost time: 1.578120231628418
Epoch: 17, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.877 Vali Acc: 0.812 Test Loss: 0.877 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.5186138153076172
Epoch: 18, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.797 Vali Acc: 0.812 Test Loss: 0.797 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.5071446895599365
Epoch: 19, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.816 Vali Acc: 0.833 Test Loss: 0.816 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.874429702758789
Epoch: 20, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.781 Vali Acc: 0.826 Test Loss: 0.781 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.3682920932769775
Epoch: 21, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.795 Vali Acc: 0.841 Test Loss: 0.795 Test Acc: 0.841
Validation loss decreased (-0.833326 --> -0.840572).  Saving model ...
Epoch: 22 cost time: 1.700601577758789
Epoch: 22, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.843 Vali Acc: 0.833 Test Loss: 0.843 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.3629858493804932
Epoch: 23, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.857 Vali Acc: 0.841 Test Loss: 0.857 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.1703555583953857
Epoch: 24, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.814 Vali Acc: 0.841 Test Loss: 0.814 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.544250249862671
Epoch: 25, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.851 Vali Acc: 0.826 Test Loss: 0.851 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.1311180591583252
Epoch: 26, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.784 Vali Acc: 0.855 Test Loss: 0.784 Test Acc: 0.855
Validation loss decreased (-0.840572 --> -0.855065).  Saving model ...
Epoch: 27 cost time: 1.3568181991577148
Epoch: 27, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.846 Vali Acc: 0.841 Test Loss: 0.846 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.579453468322754
Epoch: 28, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.989 Vali Acc: 0.833 Test Loss: 0.989 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.6276018619537354
Epoch: 29, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.949 Vali Acc: 0.826 Test Loss: 0.949 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.4605731964111328
Epoch: 30, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.865 Vali Acc: 0.826 Test Loss: 0.865 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.6491703987121582
Epoch: 31, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.864 Vali Acc: 0.833 Test Loss: 0.864 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.9032089710235596
Epoch: 32, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.919 Vali Acc: 0.819 Test Loss: 0.919 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.6121840476989746
Epoch: 33, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.923 Vali Acc: 0.819 Test Loss: 0.923 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.4064421653747559
Epoch: 34, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.930 Vali Acc: 0.819 Test Loss: 0.930 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.9131882190704346
Epoch: 35, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.934 Vali Acc: 0.826 Test Loss: 0.934 Test Acc: 0.826
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 2.357895612716675
Epoch: 36, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.914 Vali Acc: 0.833 Test Loss: 0.914 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el6_dm768_df768_ps23_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.855072463768116
model parameter : 43610884
model size : 181.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el6_dm768_df768_ps23_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.2075371742248535
Epoch: 1, Steps: 9 | Train Loss: 1.450 Vali Loss: 1.385 Vali Acc: 0.225 Test Loss: 1.385 Test Acc: 0.225
Validation loss decreased (inf --> -0.224624).  Saving model ...
Epoch: 2 cost time: 1.024261474609375
Epoch: 2, Steps: 9 | Train Loss: 1.344 Vali Loss: 1.314 Vali Acc: 0.464 Test Loss: 1.314 Test Acc: 0.464
Validation loss decreased (-0.224624 --> -0.463755).  Saving model ...
Epoch: 3 cost time: 1.0924279689788818
Epoch: 3, Steps: 9 | Train Loss: 1.281 Vali Loss: 1.225 Vali Acc: 0.522 Test Loss: 1.225 Test Acc: 0.522
Validation loss decreased (-0.463755 --> -0.521727).  Saving model ...
Epoch: 4 cost time: 1.0565485954284668
Epoch: 4, Steps: 9 | Train Loss: 1.150 Vali Loss: 1.117 Vali Acc: 0.543 Test Loss: 1.117 Test Acc: 0.543
Validation loss decreased (-0.521727 --> -0.543467).  Saving model ...
Epoch: 5 cost time: 1.1401231288909912
Epoch: 5, Steps: 9 | Train Loss: 1.006 Vali Loss: 1.010 Vali Acc: 0.623 Test Loss: 1.010 Test Acc: 0.623
Validation loss decreased (-0.543467 --> -0.623178).  Saving model ...
Epoch: 6 cost time: 1.3352019786834717
Epoch: 6, Steps: 9 | Train Loss: 0.856 Vali Loss: 0.907 Vali Acc: 0.645 Test Loss: 0.907 Test Acc: 0.645
Validation loss decreased (-0.623178 --> -0.644918).  Saving model ...
Epoch: 7 cost time: 1.089301586151123
Epoch: 7, Steps: 9 | Train Loss: 0.695 Vali Loss: 0.822 Vali Acc: 0.645 Test Loss: 0.822 Test Acc: 0.645
Validation loss decreased (-0.644918 --> -0.644919).  Saving model ...
Epoch: 8 cost time: 1.0980079174041748
Epoch: 8, Steps: 9 | Train Loss: 0.588 Vali Loss: 0.788 Vali Acc: 0.710 Test Loss: 0.788 Test Acc: 0.710
Validation loss decreased (-0.644919 --> -0.710137).  Saving model ...
Epoch: 9 cost time: 0.928612470626831
Epoch: 9, Steps: 9 | Train Loss: 0.496 Vali Loss: 0.762 Vali Acc: 0.725 Test Loss: 0.762 Test Acc: 0.725
Validation loss decreased (-0.710137 --> -0.724630).  Saving model ...
Epoch: 10 cost time: 1.0967073440551758
Epoch: 10, Steps: 9 | Train Loss: 0.411 Vali Loss: 0.680 Vali Acc: 0.739 Test Loss: 0.680 Test Acc: 0.739
Validation loss decreased (-0.724630 --> -0.739124).  Saving model ...
Epoch: 11 cost time: 1.0194928646087646
Epoch: 11, Steps: 9 | Train Loss: 0.328 Vali Loss: 0.633 Vali Acc: 0.761 Test Loss: 0.633 Test Acc: 0.761
Validation loss decreased (-0.739124 --> -0.760863).  Saving model ...
Epoch: 12 cost time: 1.090700387954712
Epoch: 12, Steps: 9 | Train Loss: 0.212 Vali Loss: 0.649 Vali Acc: 0.768 Test Loss: 0.649 Test Acc: 0.768
Validation loss decreased (-0.760863 --> -0.768109).  Saving model ...
Epoch: 13 cost time: 0.9825758934020996
Epoch: 13, Steps: 9 | Train Loss: 0.182 Vali Loss: 0.611 Vali Acc: 0.768 Test Loss: 0.611 Test Acc: 0.768
Validation loss decreased (-0.768109 --> -0.768110).  Saving model ...
Epoch: 14 cost time: 1.0157649517059326
Epoch: 14, Steps: 9 | Train Loss: 0.124 Vali Loss: 0.717 Vali Acc: 0.768 Test Loss: 0.717 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0804922580718994
Epoch: 15, Steps: 9 | Train Loss: 0.079 Vali Loss: 0.672 Vali Acc: 0.768 Test Loss: 0.672 Test Acc: 0.768
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.114448070526123
Epoch: 16, Steps: 9 | Train Loss: 0.058 Vali Loss: 0.609 Vali Acc: 0.783 Test Loss: 0.609 Test Acc: 0.783
Validation loss decreased (-0.768110 --> -0.782603).  Saving model ...
Epoch: 17 cost time: 0.9450891017913818
Epoch: 17, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.704 Vali Acc: 0.797 Test Loss: 0.704 Test Acc: 0.797
Validation loss decreased (-0.782603 --> -0.797094).  Saving model ...
Epoch: 18 cost time: 1.1098542213439941
Epoch: 18, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.738 Vali Acc: 0.804 Test Loss: 0.738 Test Acc: 0.804
Validation loss decreased (-0.797094 --> -0.804340).  Saving model ...
Epoch: 19 cost time: 1.1157402992248535
Epoch: 19, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.690 Vali Acc: 0.790 Test Loss: 0.690 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9706611633300781
Epoch: 20, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.730 Vali Acc: 0.775 Test Loss: 0.730 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.066906452178955
Epoch: 21, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.694 Vali Acc: 0.804 Test Loss: 0.694 Test Acc: 0.804
Validation loss decreased (-0.804340 --> -0.804341).  Saving model ...
Epoch: 22 cost time: 0.9404017925262451
Epoch: 22, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.673 Vali Acc: 0.804 Test Loss: 0.673 Test Acc: 0.804
Validation loss decreased (-0.804341 --> -0.804341).  Saving model ...
Epoch: 23 cost time: 1.0647125244140625
Epoch: 23, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.813 Vali Acc: 0.797 Test Loss: 0.813 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.2099413871765137
Epoch: 24, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.767 Vali Acc: 0.804 Test Loss: 0.767 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.058727741241455
Epoch: 25, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.870 Vali Acc: 0.797 Test Loss: 0.870 Test Acc: 0.797
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.2308342456817627
Epoch: 26, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.802 Vali Acc: 0.797 Test Loss: 0.802 Test Acc: 0.797
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.2194876670837402
Epoch: 27, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.748 Vali Acc: 0.804 Test Loss: 0.748 Test Acc: 0.804
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.0792343616485596
Epoch: 28, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.797 Vali Acc: 0.790 Test Loss: 0.797 Test Acc: 0.790
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.2810804843902588
Epoch: 29, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.867 Vali Acc: 0.797 Test Loss: 0.867 Test Acc: 0.797
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.1274056434631348
Epoch: 30, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.809 Vali Acc: 0.797 Test Loss: 0.809 Test Acc: 0.797
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.0448977947235107
Epoch: 31, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.773 Vali Acc: 0.812 Test Loss: 0.773 Test Acc: 0.812
Validation loss decreased (-0.804341 --> -0.811586).  Saving model ...
Epoch: 32 cost time: 1.1459832191467285
Epoch: 32, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.774 Vali Acc: 0.812 Test Loss: 0.774 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.109837532043457
Epoch: 33, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.817 Vali Acc: 0.804 Test Loss: 0.817 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.2212467193603516
Epoch: 34, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.858 Vali Acc: 0.797 Test Loss: 0.858 Test Acc: 0.797
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.3005964756011963
Epoch: 35, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.857 Vali Acc: 0.797 Test Loss: 0.857 Test Acc: 0.797
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.9999744892120361
Epoch: 36, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.840 Vali Acc: 0.797 Test Loss: 0.840 Test Acc: 0.797
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.3667213916778564
Epoch: 37, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.811 Vali Acc: 0.804 Test Loss: 0.811 Test Acc: 0.804
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.2170772552490234
Epoch: 38, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.812 Vali Acc: 0.797 Test Loss: 0.812 Test Acc: 0.797
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.0646893978118896
Epoch: 39, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.808 Vali Acc: 0.797 Test Loss: 0.808 Test Acc: 0.797
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.0397722721099854
Epoch: 40, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.825 Vali Acc: 0.797 Test Loss: 0.825 Test Acc: 0.797
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.0885918140411377
Epoch: 41, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.813 Vali Acc: 0.812 Test Loss: 0.813 Test Acc: 0.812
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el6_dm768_df768_ps23_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8115942028985508
model parameter : 43574020
model size : 180.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el6_dm768_df768_ps26_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.333045959472656
Epoch: 1, Steps: 9 | Train Loss: 1.367 Vali Loss: 1.337 Vali Acc: 0.319 Test Loss: 1.337 Test Acc: 0.319
Validation loss decreased (inf --> -0.318827).  Saving model ...
Epoch: 2 cost time: 1.7301254272460938
Epoch: 2, Steps: 9 | Train Loss: 1.232 Vali Loss: 1.185 Vali Acc: 0.507 Test Loss: 1.185 Test Acc: 0.507
Validation loss decreased (-0.318827 --> -0.507235).  Saving model ...
Epoch: 3 cost time: 1.4420278072357178
Epoch: 3, Steps: 9 | Train Loss: 1.091 Vali Loss: 1.026 Vali Acc: 0.558 Test Loss: 1.026 Test Acc: 0.558
Validation loss decreased (-0.507235 --> -0.557961).  Saving model ...
Epoch: 4 cost time: 2.004413366317749
Epoch: 4, Steps: 9 | Train Loss: 0.869 Vali Loss: 0.887 Vali Acc: 0.659 Test Loss: 0.887 Test Acc: 0.659
Validation loss decreased (-0.557961 --> -0.659411).  Saving model ...
Epoch: 5 cost time: 1.466322898864746
Epoch: 5, Steps: 9 | Train Loss: 0.705 Vali Loss: 0.743 Vali Acc: 0.696 Test Loss: 0.743 Test Acc: 0.696
Validation loss decreased (-0.659411 --> -0.695645).  Saving model ...
Epoch: 6 cost time: 1.9226493835449219
Epoch: 6, Steps: 9 | Train Loss: 0.515 Vali Loss: 0.645 Vali Acc: 0.746 Test Loss: 0.645 Test Acc: 0.746
Validation loss decreased (-0.695645 --> -0.746370).  Saving model ...
Epoch: 7 cost time: 1.7671222686767578
Epoch: 7, Steps: 9 | Train Loss: 0.425 Vali Loss: 0.560 Vali Acc: 0.761 Test Loss: 0.560 Test Acc: 0.761
Validation loss decreased (-0.746370 --> -0.760864).  Saving model ...
Epoch: 8 cost time: 2.1175997257232666
Epoch: 8, Steps: 9 | Train Loss: 0.261 Vali Loss: 0.614 Vali Acc: 0.775 Test Loss: 0.614 Test Acc: 0.775
Validation loss decreased (-0.760864 --> -0.775356).  Saving model ...
Epoch: 9 cost time: 1.8430590629577637
Epoch: 9, Steps: 9 | Train Loss: 0.144 Vali Loss: 0.485 Vali Acc: 0.841 Test Loss: 0.485 Test Acc: 0.841
Validation loss decreased (-0.775356 --> -0.840575).  Saving model ...
Epoch: 10 cost time: 1.8080174922943115
Epoch: 10, Steps: 9 | Train Loss: 0.101 Vali Loss: 0.666 Vali Acc: 0.775 Test Loss: 0.666 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.564741849899292
Epoch: 11, Steps: 9 | Train Loss: 0.065 Vali Loss: 0.581 Vali Acc: 0.819 Test Loss: 0.581 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.5768115520477295
Epoch: 12, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.639 Vali Acc: 0.826 Test Loss: 0.639 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.4204111099243164
Epoch: 13, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.574 Vali Acc: 0.877 Test Loss: 0.574 Test Acc: 0.877
Validation loss decreased (-0.840575 --> -0.876806).  Saving model ...
Epoch: 14 cost time: 1.6824257373809814
Epoch: 14, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.898 Vali Acc: 0.833 Test Loss: 0.898 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.425051212310791
Epoch: 15, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.762 Vali Acc: 0.804 Test Loss: 0.762 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.040269374847412
Epoch: 16, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.798 Vali Acc: 0.848 Test Loss: 0.798 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.7322258949279785
Epoch: 17, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.614 Vali Acc: 0.877 Test Loss: 0.614 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.4153313636779785
Epoch: 18, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.778 Vali Acc: 0.855 Test Loss: 0.778 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.6797308921813965
Epoch: 19, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.954 Vali Acc: 0.848 Test Loss: 0.954 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.7558741569519043
Epoch: 20, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.657 Vali Acc: 0.884 Test Loss: 0.657 Test Acc: 0.884
Validation loss decreased (-0.876806 --> -0.884051).  Saving model ...
Epoch: 21 cost time: 1.7510287761688232
Epoch: 21, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.729 Vali Acc: 0.877 Test Loss: 0.729 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.694014549255371
Epoch: 22, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.761 Vali Acc: 0.870 Test Loss: 0.761 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.723724126815796
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.695 Vali Acc: 0.877 Test Loss: 0.695 Test Acc: 0.877
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.8356177806854248
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.719 Vali Acc: 0.877 Test Loss: 0.719 Test Acc: 0.877
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.7139368057250977
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.774 Vali Acc: 0.870 Test Loss: 0.774 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.2373144626617432
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.772 Vali Acc: 0.877 Test Loss: 0.772 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.6086788177490234
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.772 Vali Acc: 0.870 Test Loss: 0.772 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.7537696361541748
Epoch: 28, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.807 Vali Acc: 0.877 Test Loss: 0.807 Test Acc: 0.877
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.5271985530853271
Epoch: 29, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.804 Vali Acc: 0.870 Test Loss: 0.804 Test Acc: 0.870
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.347529411315918
Epoch: 30, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.788 Vali Acc: 0.870 Test Loss: 0.788 Test Acc: 0.870
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el6_dm768_df768_ps26_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8840579710144928
model parameter : 43677700
model size : 181.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el6_dm768_df768_ps26_str13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.4771902561187744
Epoch: 1, Steps: 9 | Train Loss: 1.507 Vali Loss: 1.368 Vali Acc: 0.312 Test Loss: 1.368 Test Acc: 0.312
Validation loss decreased (inf --> -0.311581).  Saving model ...
Epoch: 2 cost time: 1.2585899829864502
Epoch: 2, Steps: 9 | Train Loss: 1.362 Vali Loss: 1.314 Vali Acc: 0.333 Test Loss: 1.314 Test Acc: 0.333
Validation loss decreased (-0.311581 --> -0.333320).  Saving model ...
Epoch: 3 cost time: 1.200549840927124
Epoch: 3, Steps: 9 | Train Loss: 1.222 Vali Loss: 1.198 Vali Acc: 0.326 Test Loss: 1.198 Test Acc: 0.326
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1369819641113281
Epoch: 4, Steps: 9 | Train Loss: 1.079 Vali Loss: 1.071 Vali Acc: 0.572 Test Loss: 1.071 Test Acc: 0.572
Validation loss decreased (-0.333320 --> -0.572453).  Saving model ...
Epoch: 5 cost time: 1.0060229301452637
Epoch: 5, Steps: 9 | Train Loss: 0.935 Vali Loss: 1.014 Vali Acc: 0.638 Test Loss: 1.014 Test Acc: 0.638
Validation loss decreased (-0.572453 --> -0.637671).  Saving model ...
Epoch: 6 cost time: 1.083850622177124
Epoch: 6, Steps: 9 | Train Loss: 0.798 Vali Loss: 0.891 Vali Acc: 0.645 Test Loss: 0.891 Test Acc: 0.645
Validation loss decreased (-0.637671 --> -0.644919).  Saving model ...
Epoch: 7 cost time: 1.46384596824646
Epoch: 7, Steps: 9 | Train Loss: 0.645 Vali Loss: 0.876 Vali Acc: 0.652 Test Loss: 0.876 Test Acc: 0.652
Validation loss decreased (-0.644919 --> -0.652165).  Saving model ...
Epoch: 8 cost time: 1.451627254486084
Epoch: 8, Steps: 9 | Train Loss: 0.498 Vali Loss: 0.669 Vali Acc: 0.703 Test Loss: 0.669 Test Acc: 0.703
Validation loss decreased (-0.652165 --> -0.702892).  Saving model ...
Epoch: 9 cost time: 1.539083480834961
Epoch: 9, Steps: 9 | Train Loss: 0.329 Vali Loss: 0.746 Vali Acc: 0.667 Test Loss: 0.746 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.319715976715088
Epoch: 10, Steps: 9 | Train Loss: 0.249 Vali Loss: 0.608 Vali Acc: 0.797 Test Loss: 0.608 Test Acc: 0.797
Validation loss decreased (-0.702892 --> -0.797095).  Saving model ...
Epoch: 11 cost time: 1.4093289375305176
Epoch: 11, Steps: 9 | Train Loss: 0.164 Vali Loss: 0.665 Vali Acc: 0.761 Test Loss: 0.665 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1558783054351807
Epoch: 12, Steps: 9 | Train Loss: 0.116 Vali Loss: 0.710 Vali Acc: 0.783 Test Loss: 0.710 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1515586376190186
Epoch: 13, Steps: 9 | Train Loss: 0.096 Vali Loss: 0.570 Vali Acc: 0.804 Test Loss: 0.570 Test Acc: 0.804
Validation loss decreased (-0.797095 --> -0.804342).  Saving model ...
Epoch: 14 cost time: 0.9488518238067627
Epoch: 14, Steps: 9 | Train Loss: 0.059 Vali Loss: 0.724 Vali Acc: 0.819 Test Loss: 0.724 Test Acc: 0.819
Validation loss decreased (-0.804342 --> -0.818833).  Saving model ...
Epoch: 15 cost time: 1.1378357410430908
Epoch: 15, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.649 Vali Acc: 0.812 Test Loss: 0.649 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.718663215637207
Epoch: 16, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.710 Vali Acc: 0.826 Test Loss: 0.710 Test Acc: 0.826
Validation loss decreased (-0.818833 --> -0.826080).  Saving model ...
Epoch: 17 cost time: 1.4872462749481201
Epoch: 17, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.649 Vali Acc: 0.833 Test Loss: 0.649 Test Acc: 0.833
Validation loss decreased (-0.826080 --> -0.833327).  Saving model ...
Epoch: 18 cost time: 1.341723918914795
Epoch: 18, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.829 Vali Acc: 0.812 Test Loss: 0.829 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.574995994567871
Epoch: 19, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.726 Vali Acc: 0.833 Test Loss: 0.726 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.233544111251831
Epoch: 20, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.652 Vali Acc: 0.833 Test Loss: 0.652 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.3029594421386719
Epoch: 21, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.715 Vali Acc: 0.819 Test Loss: 0.715 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.524695873260498
Epoch: 22, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.829 Vali Acc: 0.812 Test Loss: 0.829 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.508239984512329
Epoch: 23, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.767 Vali Acc: 0.826 Test Loss: 0.767 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.153573989868164
Epoch: 24, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.735 Vali Acc: 0.826 Test Loss: 0.735 Test Acc: 0.826
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.1971993446350098
Epoch: 25, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.820 Vali Acc: 0.819 Test Loss: 0.820 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.0728847980499268
Epoch: 26, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.782 Vali Acc: 0.826 Test Loss: 0.782 Test Acc: 0.826
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.2857108116149902
Epoch: 27, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.816 Vali Acc: 0.826 Test Loss: 0.816 Test Acc: 0.826
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el6_dm768_df768_ps26_str13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8333333333333334
model parameter : 43622404
model size : 181.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el6_dm768_df768_ps26_str26_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.3797783851623535
Epoch: 1, Steps: 9 | Train Loss: 1.496 Vali Loss: 1.391 Vali Acc: 0.275 Test Loss: 1.391 Test Acc: 0.275
Validation loss decreased (inf --> -0.275348).  Saving model ...
Epoch: 2 cost time: 1.04777193069458
Epoch: 2, Steps: 9 | Train Loss: 1.369 Vali Loss: 1.314 Vali Acc: 0.449 Test Loss: 1.314 Test Acc: 0.449
Validation loss decreased (-0.275348 --> -0.449262).  Saving model ...
Epoch: 3 cost time: 1.1782164573669434
Epoch: 3, Steps: 9 | Train Loss: 1.253 Vali Loss: 1.237 Vali Acc: 0.514 Test Loss: 1.237 Test Acc: 0.514
Validation loss decreased (-0.449262 --> -0.514480).  Saving model ...
Epoch: 4 cost time: 1.0819213390350342
Epoch: 4, Steps: 9 | Train Loss: 1.153 Vali Loss: 1.145 Vali Acc: 0.580 Test Loss: 1.145 Test Acc: 0.580
Validation loss decreased (-0.514480 --> -0.579699).  Saving model ...
Epoch: 5 cost time: 0.9782891273498535
Epoch: 5, Steps: 9 | Train Loss: 1.045 Vali Loss: 1.057 Vali Acc: 0.587 Test Loss: 1.057 Test Acc: 0.587
Validation loss decreased (-0.579699 --> -0.586946).  Saving model ...
Epoch: 6 cost time: 1.1175367832183838
Epoch: 6, Steps: 9 | Train Loss: 0.905 Vali Loss: 0.997 Vali Acc: 0.616 Test Loss: 0.997 Test Acc: 0.616
Validation loss decreased (-0.586946 --> -0.615932).  Saving model ...
Epoch: 7 cost time: 1.203627347946167
Epoch: 7, Steps: 9 | Train Loss: 0.758 Vali Loss: 0.912 Vali Acc: 0.645 Test Loss: 0.912 Test Acc: 0.645
Validation loss decreased (-0.615932 --> -0.644918).  Saving model ...
Epoch: 8 cost time: 0.9828071594238281
Epoch: 8, Steps: 9 | Train Loss: 0.626 Vali Loss: 0.881 Vali Acc: 0.638 Test Loss: 0.881 Test Acc: 0.638
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1228647232055664
Epoch: 9, Steps: 9 | Train Loss: 0.502 Vali Loss: 0.807 Vali Acc: 0.696 Test Loss: 0.807 Test Acc: 0.696
Validation loss decreased (-0.644918 --> -0.695644).  Saving model ...
Epoch: 10 cost time: 0.9169340133666992
Epoch: 10, Steps: 9 | Train Loss: 0.396 Vali Loss: 0.751 Vali Acc: 0.696 Test Loss: 0.751 Test Acc: 0.696
Validation loss decreased (-0.695644 --> -0.695645).  Saving model ...
Epoch: 11 cost time: 0.9915928840637207
Epoch: 11, Steps: 9 | Train Loss: 0.318 Vali Loss: 0.713 Vali Acc: 0.732 Test Loss: 0.713 Test Acc: 0.732
Validation loss decreased (-0.695645 --> -0.731877).  Saving model ...
Epoch: 12 cost time: 1.0659098625183105
Epoch: 12, Steps: 9 | Train Loss: 0.201 Vali Loss: 0.796 Vali Acc: 0.725 Test Loss: 0.796 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.069239616394043
Epoch: 13, Steps: 9 | Train Loss: 0.187 Vali Loss: 0.728 Vali Acc: 0.761 Test Loss: 0.728 Test Acc: 0.761
Validation loss decreased (-0.731877 --> -0.760862).  Saving model ...
Epoch: 14 cost time: 1.274339199066162
Epoch: 14, Steps: 9 | Train Loss: 0.130 Vali Loss: 0.753 Vali Acc: 0.732 Test Loss: 0.753 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2105598449707031
Epoch: 15, Steps: 9 | Train Loss: 0.084 Vali Loss: 0.733 Vali Acc: 0.768 Test Loss: 0.733 Test Acc: 0.768
Validation loss decreased (-0.760862 --> -0.768109).  Saving model ...
Epoch: 16 cost time: 1.107823371887207
Epoch: 16, Steps: 9 | Train Loss: 0.076 Vali Loss: 0.716 Vali Acc: 0.768 Test Loss: 0.716 Test Acc: 0.768
Validation loss decreased (-0.768109 --> -0.768109).  Saving model ...
Epoch: 17 cost time: 1.2337985038757324
Epoch: 17, Steps: 9 | Train Loss: 0.053 Vali Loss: 0.806 Vali Acc: 0.761 Test Loss: 0.806 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0303058624267578
Epoch: 18, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.751 Vali Acc: 0.783 Test Loss: 0.751 Test Acc: 0.783
Validation loss decreased (-0.768109 --> -0.782601).  Saving model ...
Epoch: 19 cost time: 1.0273518562316895
Epoch: 19, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.800 Vali Acc: 0.790 Test Loss: 0.800 Test Acc: 0.790
Validation loss decreased (-0.782601 --> -0.789847).  Saving model ...
Epoch: 20 cost time: 1.1320178508758545
Epoch: 20, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.905 Vali Acc: 0.768 Test Loss: 0.905 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.328209638595581
Epoch: 21, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.740 Vali Acc: 0.790 Test Loss: 0.740 Test Acc: 0.790
Validation loss decreased (-0.789847 --> -0.789848).  Saving model ...
Epoch: 22 cost time: 1.4853408336639404
Epoch: 22, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.810 Vali Acc: 0.783 Test Loss: 0.810 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.4083218574523926
Epoch: 23, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.869 Vali Acc: 0.797 Test Loss: 0.869 Test Acc: 0.797
Validation loss decreased (-0.789848 --> -0.797093).  Saving model ...
Epoch: 24 cost time: 1.210442304611206
Epoch: 24, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.898 Vali Acc: 0.790 Test Loss: 0.898 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.998009443283081
Epoch: 25, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.825 Vali Acc: 0.797 Test Loss: 0.825 Test Acc: 0.797
Validation loss decreased (-0.797093 --> -0.797093).  Saving model ...
Epoch: 26 cost time: 1.2044272422790527
Epoch: 26, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.860 Vali Acc: 0.804 Test Loss: 0.860 Test Acc: 0.804
Validation loss decreased (-0.797093 --> -0.804339).  Saving model ...
Epoch: 27 cost time: 1.2417433261871338
Epoch: 27, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.891 Vali Acc: 0.812 Test Loss: 0.891 Test Acc: 0.812
Validation loss decreased (-0.804339 --> -0.811585).  Saving model ...
Epoch: 28 cost time: 1.5711593627929688
Epoch: 28, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.950 Vali Acc: 0.797 Test Loss: 0.950 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.2717101573944092
Epoch: 29, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.962 Vali Acc: 0.804 Test Loss: 0.962 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.3163015842437744
Epoch: 30, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.964 Vali Acc: 0.797 Test Loss: 0.964 Test Acc: 0.797
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.0894408226013184
Epoch: 31, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.946 Vali Acc: 0.804 Test Loss: 0.946 Test Acc: 0.804
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.2441506385803223
Epoch: 32, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.851 Vali Acc: 0.812 Test Loss: 0.851 Test Acc: 0.812
Validation loss decreased (-0.811585 --> -0.811586).  Saving model ...
Epoch: 33 cost time: 1.3289132118225098
Epoch: 33, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.864 Vali Acc: 0.812 Test Loss: 0.864 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.1473536491394043
Epoch: 34, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.948 Vali Acc: 0.804 Test Loss: 0.948 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.1515452861785889
Epoch: 35, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.994 Vali Acc: 0.812 Test Loss: 0.994 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.1965701580047607
Epoch: 36, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.987 Vali Acc: 0.812 Test Loss: 0.987 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.2046444416046143
Epoch: 37, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.931 Vali Acc: 0.812 Test Loss: 0.931 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.346773386001587
Epoch: 38, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.983 Vali Acc: 0.812 Test Loss: 0.983 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.2257862091064453
Epoch: 39, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.049 Vali Acc: 0.804 Test Loss: 1.049 Test Acc: 0.804
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.9914572238922119
Epoch: 40, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.063 Vali Acc: 0.804 Test Loss: 1.063 Test Acc: 0.804
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.1122398376464844
Epoch: 41, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.005 Vali Acc: 0.812 Test Loss: 1.005 Test Acc: 0.812
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.253941535949707
Epoch: 42, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.999 Vali Acc: 0.812 Test Loss: 0.999 Test Acc: 0.812
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el6_dm768_df768_ps26_str26_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8115942028985508
model parameter : 43590148
model size : 180.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el6_dm768_df768_ps30_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.289762020111084
Epoch: 1, Steps: 9 | Train Loss: 1.466 Vali Loss: 1.375 Vali Acc: 0.297 Test Loss: 1.375 Test Acc: 0.297
Validation loss decreased (inf --> -0.297088).  Saving model ...
Epoch: 2 cost time: 2.1192665100097656
Epoch: 2, Steps: 9 | Train Loss: 1.299 Vali Loss: 1.212 Vali Acc: 0.435 Test Loss: 1.212 Test Acc: 0.435
Validation loss decreased (-0.297088 --> -0.434770).  Saving model ...
Epoch: 3 cost time: 1.6313128471374512
Epoch: 3, Steps: 9 | Train Loss: 1.116 Vali Loss: 1.061 Vali Acc: 0.580 Test Loss: 1.061 Test Acc: 0.580
Validation loss decreased (-0.434770 --> -0.579700).  Saving model ...
Epoch: 4 cost time: 2.0176196098327637
Epoch: 4, Steps: 9 | Train Loss: 0.937 Vali Loss: 0.924 Vali Acc: 0.638 Test Loss: 0.924 Test Acc: 0.638
Validation loss decreased (-0.579700 --> -0.637672).  Saving model ...
Epoch: 5 cost time: 2.0872802734375
Epoch: 5, Steps: 9 | Train Loss: 0.785 Vali Loss: 0.816 Vali Acc: 0.652 Test Loss: 0.816 Test Acc: 0.652
Validation loss decreased (-0.637672 --> -0.652166).  Saving model ...
Epoch: 6 cost time: 1.7519917488098145
Epoch: 6, Steps: 9 | Train Loss: 0.548 Vali Loss: 0.695 Vali Acc: 0.681 Test Loss: 0.695 Test Acc: 0.681
Validation loss decreased (-0.652166 --> -0.681152).  Saving model ...
Epoch: 7 cost time: 1.833953857421875
Epoch: 7, Steps: 9 | Train Loss: 0.412 Vali Loss: 0.591 Vali Acc: 0.754 Test Loss: 0.591 Test Acc: 0.754
Validation loss decreased (-0.681152 --> -0.753617).  Saving model ...
Epoch: 8 cost time: 2.0069878101348877
Epoch: 8, Steps: 9 | Train Loss: 0.301 Vali Loss: 0.597 Vali Acc: 0.732 Test Loss: 0.597 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4997045993804932
Epoch: 9, Steps: 9 | Train Loss: 0.173 Vali Loss: 0.730 Vali Acc: 0.797 Test Loss: 0.730 Test Acc: 0.797
Validation loss decreased (-0.753617 --> -0.797094).  Saving model ...
Epoch: 10 cost time: 2.2591636180877686
Epoch: 10, Steps: 9 | Train Loss: 0.121 Vali Loss: 0.481 Vali Acc: 0.819 Test Loss: 0.481 Test Acc: 0.819
Validation loss decreased (-0.797094 --> -0.818836).  Saving model ...
Epoch: 11 cost time: 1.0225048065185547
Epoch: 11, Steps: 9 | Train Loss: 0.106 Vali Loss: 0.869 Vali Acc: 0.790 Test Loss: 0.869 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.7268075942993164
Epoch: 12, Steps: 9 | Train Loss: 0.067 Vali Loss: 0.659 Vali Acc: 0.819 Test Loss: 0.659 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.718196153640747
Epoch: 13, Steps: 9 | Train Loss: 0.058 Vali Loss: 0.800 Vali Acc: 0.804 Test Loss: 0.800 Test Acc: 0.804
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.2253503799438477
Epoch: 14, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.860 Vali Acc: 0.775 Test Loss: 0.860 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.1092073917388916
Epoch: 15, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.780 Vali Acc: 0.826 Test Loss: 0.780 Test Acc: 0.826
Validation loss decreased (-0.818836 --> -0.826079).  Saving model ...
Epoch: 16 cost time: 1.4696080684661865
Epoch: 16, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.914 Vali Acc: 0.768 Test Loss: 0.914 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.6862938404083252
Epoch: 17, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.817 Vali Acc: 0.775 Test Loss: 0.817 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.0303752422332764
Epoch: 18, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.775 Vali Acc: 0.826 Test Loss: 0.775 Test Acc: 0.826
Validation loss decreased (-0.826079 --> -0.826079).  Saving model ...
Epoch: 19 cost time: 1.7913317680358887
Epoch: 19, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.853 Vali Acc: 0.797 Test Loss: 0.853 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.7180368900299072
Epoch: 20, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.792 Vali Acc: 0.826 Test Loss: 0.792 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.5691545009613037
Epoch: 21, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.813 Vali Acc: 0.826 Test Loss: 0.813 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.6953105926513672
Epoch: 22, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.773 Vali Acc: 0.848 Test Loss: 0.773 Test Acc: 0.848
Validation loss decreased (-0.826079 --> -0.847818).  Saving model ...
Epoch: 23 cost time: 1.8125519752502441
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.846 Vali Acc: 0.841 Test Loss: 0.846 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.5661985874176025
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.882 Vali Acc: 0.819 Test Loss: 0.882 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.762932538986206
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.868 Vali Acc: 0.819 Test Loss: 0.868 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.5249669551849365
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.819 Vali Acc: 0.826 Test Loss: 0.819 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.0067250728607178
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.797 Vali Acc: 0.833 Test Loss: 0.797 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.8985531330108643
Epoch: 28, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.849 Vali Acc: 0.819 Test Loss: 0.849 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.7974095344543457
Epoch: 29, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.931 Vali Acc: 0.790 Test Loss: 0.931 Test Acc: 0.790
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.2205166816711426
Epoch: 30, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.926 Vali Acc: 0.812 Test Loss: 0.926 Test Acc: 0.812
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.4730172157287598
Epoch: 31, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.864 Vali Acc: 0.819 Test Loss: 0.864 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.3330013751983643
Epoch: 32, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.792 Vali Acc: 0.848 Test Loss: 0.792 Test Acc: 0.848
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el6_dm768_df768_ps30_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8478260869565217
model parameter : 43691524
model size : 181.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el6_dm768_df768_ps30_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.9157238006591797
Epoch: 1, Steps: 9 | Train Loss: 1.433 Vali Loss: 1.413 Vali Acc: 0.181 Test Loss: 1.413 Test Acc: 0.181
Validation loss decreased (inf --> -0.181145).  Saving model ...
Epoch: 2 cost time: 1.2839453220367432
Epoch: 2, Steps: 9 | Train Loss: 1.338 Vali Loss: 1.309 Vali Acc: 0.399 Test Loss: 1.309 Test Acc: 0.399
Validation loss decreased (-0.181145 --> -0.398538).  Saving model ...
Epoch: 3 cost time: 1.0534424781799316
Epoch: 3, Steps: 9 | Train Loss: 1.204 Vali Loss: 1.217 Vali Acc: 0.449 Test Loss: 1.217 Test Acc: 0.449
Validation loss decreased (-0.398538 --> -0.449263).  Saving model ...
Epoch: 4 cost time: 1.5655009746551514
Epoch: 4, Steps: 9 | Train Loss: 1.120 Vali Loss: 1.129 Vali Acc: 0.449 Test Loss: 1.129 Test Acc: 0.449
Validation loss decreased (-0.449263 --> -0.449264).  Saving model ...
Epoch: 5 cost time: 1.370556354522705
Epoch: 5, Steps: 9 | Train Loss: 0.964 Vali Loss: 1.024 Vali Acc: 0.551 Test Loss: 1.024 Test Acc: 0.551
Validation loss decreased (-0.449264 --> -0.550714).  Saving model ...
Epoch: 6 cost time: 1.6777124404907227
Epoch: 6, Steps: 9 | Train Loss: 0.865 Vali Loss: 0.922 Vali Acc: 0.630 Test Loss: 0.922 Test Acc: 0.630
Validation loss decreased (-0.550714 --> -0.630426).  Saving model ...
Epoch: 7 cost time: 1.4239568710327148
Epoch: 7, Steps: 9 | Train Loss: 0.725 Vali Loss: 0.809 Vali Acc: 0.638 Test Loss: 0.809 Test Acc: 0.638
Validation loss decreased (-0.630426 --> -0.637673).  Saving model ...
Epoch: 8 cost time: 1.4936230182647705
Epoch: 8, Steps: 9 | Train Loss: 0.529 Vali Loss: 0.714 Vali Acc: 0.681 Test Loss: 0.714 Test Acc: 0.681
Validation loss decreased (-0.637673 --> -0.681152).  Saving model ...
Epoch: 9 cost time: 1.228499174118042
Epoch: 9, Steps: 9 | Train Loss: 0.425 Vali Loss: 0.604 Vali Acc: 0.710 Test Loss: 0.604 Test Acc: 0.710
Validation loss decreased (-0.681152 --> -0.710139).  Saving model ...
Epoch: 10 cost time: 1.2938830852508545
Epoch: 10, Steps: 9 | Train Loss: 0.287 Vali Loss: 0.504 Vali Acc: 0.768 Test Loss: 0.504 Test Acc: 0.768
Validation loss decreased (-0.710139 --> -0.768111).  Saving model ...
Epoch: 11 cost time: 1.4149727821350098
Epoch: 11, Steps: 9 | Train Loss: 0.197 Vali Loss: 0.666 Vali Acc: 0.775 Test Loss: 0.666 Test Acc: 0.775
Validation loss decreased (-0.768111 --> -0.775356).  Saving model ...
Epoch: 12 cost time: 1.3202645778656006
Epoch: 12, Steps: 9 | Train Loss: 0.147 Vali Loss: 0.490 Vali Acc: 0.841 Test Loss: 0.490 Test Acc: 0.841
Validation loss decreased (-0.775356 --> -0.840575).  Saving model ...
Epoch: 13 cost time: 1.5223803520202637
Epoch: 13, Steps: 9 | Train Loss: 0.096 Vali Loss: 0.642 Vali Acc: 0.790 Test Loss: 0.642 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3706552982330322
Epoch: 14, Steps: 9 | Train Loss: 0.069 Vali Loss: 0.686 Vali Acc: 0.804 Test Loss: 0.686 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.17753005027771
Epoch: 15, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.655 Vali Acc: 0.819 Test Loss: 0.655 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.2005198001861572
Epoch: 16, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.649 Vali Acc: 0.812 Test Loss: 0.649 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.0341627597808838
Epoch: 17, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.695 Vali Acc: 0.819 Test Loss: 0.695 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.3640713691711426
Epoch: 18, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.710 Vali Acc: 0.804 Test Loss: 0.710 Test Acc: 0.804
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.711869239807129
Epoch: 19, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.625 Vali Acc: 0.855 Test Loss: 0.625 Test Acc: 0.855
Validation loss decreased (-0.840575 --> -0.855066).  Saving model ...
Epoch: 20 cost time: 1.6121203899383545
Epoch: 20, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.715 Vali Acc: 0.855 Test Loss: 0.715 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.3338119983673096
Epoch: 21, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.716 Vali Acc: 0.826 Test Loss: 0.716 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.5553698539733887
Epoch: 22, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.735 Vali Acc: 0.819 Test Loss: 0.735 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.3187811374664307
Epoch: 23, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.778 Vali Acc: 0.826 Test Loss: 0.778 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.2499618530273438
Epoch: 24, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.795 Vali Acc: 0.819 Test Loss: 0.795 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.7076878547668457
Epoch: 25, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.733 Vali Acc: 0.848 Test Loss: 0.733 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.3592743873596191
Epoch: 26, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.737 Vali Acc: 0.841 Test Loss: 0.737 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.4404265880584717
Epoch: 27, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.823 Vali Acc: 0.833 Test Loss: 0.823 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.6670653820037842
Epoch: 28, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.811 Vali Acc: 0.855 Test Loss: 0.811 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.3769590854644775
Epoch: 29, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.767 Vali Acc: 0.855 Test Loss: 0.767 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el6_dm768_df768_ps30_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.855072463768116
model parameter : 43640836
model size : 181.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el6_dm768_df768_ps30_str30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.729449510574341
Epoch: 1, Steps: 9 | Train Loss: 1.410 Vali Loss: 1.375 Vali Acc: 0.341 Test Loss: 1.375 Test Acc: 0.341
Validation loss decreased (inf --> -0.340566).  Saving model ...
Epoch: 2 cost time: 1.1013908386230469
Epoch: 2, Steps: 9 | Train Loss: 1.348 Vali Loss: 1.324 Vali Acc: 0.355 Test Loss: 1.324 Test Acc: 0.355
Validation loss decreased (-0.340566 --> -0.355059).  Saving model ...
Epoch: 3 cost time: 1.0135557651519775
Epoch: 3, Steps: 9 | Train Loss: 1.247 Vali Loss: 1.263 Vali Acc: 0.333 Test Loss: 1.263 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1572997570037842
Epoch: 4, Steps: 9 | Train Loss: 1.187 Vali Loss: 1.169 Vali Acc: 0.580 Test Loss: 1.169 Test Acc: 0.580
Validation loss decreased (-0.355059 --> -0.579698).  Saving model ...
Epoch: 5 cost time: 1.1003303527832031
Epoch: 5, Steps: 9 | Train Loss: 1.055 Vali Loss: 1.063 Vali Acc: 0.609 Test Loss: 1.063 Test Acc: 0.609
Validation loss decreased (-0.579698 --> -0.608685).  Saving model ...
Epoch: 6 cost time: 1.1238703727722168
Epoch: 6, Steps: 9 | Train Loss: 0.930 Vali Loss: 0.962 Vali Acc: 0.594 Test Loss: 0.962 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9525070190429688
Epoch: 7, Steps: 9 | Train Loss: 0.812 Vali Loss: 0.866 Vali Acc: 0.609 Test Loss: 0.866 Test Acc: 0.609
Validation loss decreased (-0.608685 --> -0.608687).  Saving model ...
Epoch: 8 cost time: 1.0835144519805908
Epoch: 8, Steps: 9 | Train Loss: 0.692 Vali Loss: 0.804 Vali Acc: 0.638 Test Loss: 0.804 Test Acc: 0.638
Validation loss decreased (-0.608687 --> -0.637673).  Saving model ...
Epoch: 9 cost time: 1.0111336708068848
Epoch: 9, Steps: 9 | Train Loss: 0.578 Vali Loss: 0.736 Vali Acc: 0.667 Test Loss: 0.736 Test Acc: 0.667
Validation loss decreased (-0.637673 --> -0.666659).  Saving model ...
Epoch: 10 cost time: 1.1114776134490967
Epoch: 10, Steps: 9 | Train Loss: 0.510 Vali Loss: 0.706 Vali Acc: 0.681 Test Loss: 0.706 Test Acc: 0.681
Validation loss decreased (-0.666659 --> -0.681152).  Saving model ...
Epoch: 11 cost time: 1.0447540283203125
Epoch: 11, Steps: 9 | Train Loss: 0.396 Vali Loss: 0.732 Vali Acc: 0.652 Test Loss: 0.732 Test Acc: 0.652
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2293152809143066
Epoch: 12, Steps: 9 | Train Loss: 0.313 Vali Loss: 0.648 Vali Acc: 0.739 Test Loss: 0.648 Test Acc: 0.739
Validation loss decreased (-0.681152 --> -0.739124).  Saving model ...
Epoch: 13 cost time: 1.1029322147369385
Epoch: 13, Steps: 9 | Train Loss: 0.222 Vali Loss: 0.653 Vali Acc: 0.739 Test Loss: 0.653 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0734972953796387
Epoch: 14, Steps: 9 | Train Loss: 0.183 Vali Loss: 0.626 Vali Acc: 0.739 Test Loss: 0.626 Test Acc: 0.739
Validation loss decreased (-0.739124 --> -0.739124).  Saving model ...
Epoch: 15 cost time: 1.0209174156188965
Epoch: 15, Steps: 9 | Train Loss: 0.115 Vali Loss: 0.649 Vali Acc: 0.739 Test Loss: 0.649 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.168787956237793
Epoch: 16, Steps: 9 | Train Loss: 0.094 Vali Loss: 0.588 Vali Acc: 0.761 Test Loss: 0.588 Test Acc: 0.761
Validation loss decreased (-0.739124 --> -0.760864).  Saving model ...
Epoch: 17 cost time: 0.8024382591247559
Epoch: 17, Steps: 9 | Train Loss: 0.089 Vali Loss: 0.614 Vali Acc: 0.797 Test Loss: 0.614 Test Acc: 0.797
Validation loss decreased (-0.760864 --> -0.797095).  Saving model ...
Epoch: 18 cost time: 1.0559406280517578
Epoch: 18, Steps: 9 | Train Loss: 0.053 Vali Loss: 0.658 Vali Acc: 0.746 Test Loss: 0.658 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2258696556091309
Epoch: 19, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.715 Vali Acc: 0.768 Test Loss: 0.715 Test Acc: 0.768
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.0327162742614746
Epoch: 20, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.663 Vali Acc: 0.783 Test Loss: 0.663 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.9289698600769043
Epoch: 21, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.716 Vali Acc: 0.768 Test Loss: 0.716 Test Acc: 0.768
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.001406192779541
Epoch: 22, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.703 Vali Acc: 0.797 Test Loss: 0.703 Test Acc: 0.797
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.0199329853057861
Epoch: 23, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.703 Vali Acc: 0.797 Test Loss: 0.703 Test Acc: 0.797
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.135728359222412
Epoch: 24, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.690 Vali Acc: 0.797 Test Loss: 0.690 Test Acc: 0.797
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.0057320594787598
Epoch: 25, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.723 Vali Acc: 0.783 Test Loss: 0.723 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.134190559387207
Epoch: 26, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.745 Vali Acc: 0.804 Test Loss: 0.745 Test Acc: 0.804
Validation loss decreased (-0.797095 --> -0.804340).  Saving model ...
Epoch: 27 cost time: 0.9810938835144043
Epoch: 27, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.708 Vali Acc: 0.797 Test Loss: 0.708 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.2074601650238037
Epoch: 28, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.717 Vali Acc: 0.812 Test Loss: 0.717 Test Acc: 0.812
Validation loss decreased (-0.804340 --> -0.811587).  Saving model ...
Epoch: 29 cost time: 1.0026805400848389
Epoch: 29, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.737 Vali Acc: 0.797 Test Loss: 0.737 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.0874090194702148
Epoch: 30, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.768 Vali Acc: 0.804 Test Loss: 0.768 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.920750617980957
Epoch: 31, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.780 Vali Acc: 0.804 Test Loss: 0.780 Test Acc: 0.804
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.9152696132659912
Epoch: 32, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.794 Vali Acc: 0.804 Test Loss: 0.794 Test Acc: 0.804
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.063474416732788
Epoch: 33, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.802 Vali Acc: 0.804 Test Loss: 0.802 Test Acc: 0.804
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.079895257949829
Epoch: 34, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.820 Vali Acc: 0.797 Test Loss: 0.820 Test Acc: 0.797
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.0038108825683594
Epoch: 35, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.837 Vali Acc: 0.790 Test Loss: 0.837 Test Acc: 0.790
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.1300156116485596
Epoch: 36, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.837 Vali Acc: 0.790 Test Loss: 0.837 Test Acc: 0.790
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.1732125282287598
Epoch: 37, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.866 Vali Acc: 0.797 Test Loss: 0.866 Test Acc: 0.797
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.037886142730713
Epoch: 38, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.905 Vali Acc: 0.783 Test Loss: 0.905 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el6_dm768_df768_ps30_str30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8115942028985508
model parameter : 43613188
model size : 181.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el6_dm768_df768_ps35_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.941451072692871
Epoch: 1, Steps: 9 | Train Loss: 1.488 Vali Loss: 1.371 Vali Acc: 0.297 Test Loss: 1.371 Test Acc: 0.297
Validation loss decreased (inf --> -0.297088).  Saving model ...
Epoch: 2 cost time: 1.6171784400939941
Epoch: 2, Steps: 9 | Train Loss: 1.299 Vali Loss: 1.258 Vali Acc: 0.355 Test Loss: 1.258 Test Acc: 0.355
Validation loss decreased (-0.297088 --> -0.355060).  Saving model ...
Epoch: 3 cost time: 2.086273193359375
Epoch: 3, Steps: 9 | Train Loss: 1.142 Vali Loss: 1.112 Vali Acc: 0.587 Test Loss: 1.112 Test Acc: 0.587
Validation loss decreased (-0.355060 --> -0.586945).  Saving model ...
Epoch: 4 cost time: 1.384458065032959
Epoch: 4, Steps: 9 | Train Loss: 0.974 Vali Loss: 1.014 Vali Acc: 0.594 Test Loss: 1.014 Test Acc: 0.594
Validation loss decreased (-0.586945 --> -0.594193).  Saving model ...
Epoch: 5 cost time: 1.8499150276184082
Epoch: 5, Steps: 9 | Train Loss: 0.773 Vali Loss: 0.881 Vali Acc: 0.667 Test Loss: 0.881 Test Acc: 0.667
Validation loss decreased (-0.594193 --> -0.666658).  Saving model ...
Epoch: 6 cost time: 1.0746655464172363
Epoch: 6, Steps: 9 | Train Loss: 0.620 Vali Loss: 0.744 Vali Acc: 0.739 Test Loss: 0.744 Test Acc: 0.739
Validation loss decreased (-0.666658 --> -0.739123).  Saving model ...
Epoch: 7 cost time: 1.167104959487915
Epoch: 7, Steps: 9 | Train Loss: 0.455 Vali Loss: 0.661 Vali Acc: 0.732 Test Loss: 0.661 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3761155605316162
Epoch: 8, Steps: 9 | Train Loss: 0.322 Vali Loss: 0.591 Vali Acc: 0.812 Test Loss: 0.591 Test Acc: 0.812
Validation loss decreased (-0.739123 --> -0.811588).  Saving model ...
Epoch: 9 cost time: 1.1033048629760742
Epoch: 9, Steps: 9 | Train Loss: 0.189 Vali Loss: 0.613 Vali Acc: 0.797 Test Loss: 0.613 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2190933227539062
Epoch: 10, Steps: 9 | Train Loss: 0.153 Vali Loss: 0.823 Vali Acc: 0.790 Test Loss: 0.823 Test Acc: 0.790
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.9735593795776367
Epoch: 11, Steps: 9 | Train Loss: 0.099 Vali Loss: 0.753 Vali Acc: 0.775 Test Loss: 0.753 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.5070362091064453
Epoch: 12, Steps: 9 | Train Loss: 0.083 Vali Loss: 0.733 Vali Acc: 0.804 Test Loss: 0.733 Test Acc: 0.804
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.7149150371551514
Epoch: 13, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.773 Vali Acc: 0.783 Test Loss: 0.773 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.638585090637207
Epoch: 14, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.791 Vali Acc: 0.826 Test Loss: 0.791 Test Acc: 0.826
Validation loss decreased (-0.811588 --> -0.826079).  Saving model ...
Epoch: 15 cost time: 1.1832339763641357
Epoch: 15, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.922 Vali Acc: 0.783 Test Loss: 0.922 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.200141429901123
Epoch: 16, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.768 Vali Acc: 0.833 Test Loss: 0.768 Test Acc: 0.833
Validation loss decreased (-0.826079 --> -0.833326).  Saving model ...
Epoch: 17 cost time: 1.5126595497131348
Epoch: 17, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.932 Vali Acc: 0.819 Test Loss: 0.932 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.5430598258972168
Epoch: 18, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.798 Vali Acc: 0.833 Test Loss: 0.798 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.6856918334960938
Epoch: 19, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.938 Vali Acc: 0.833 Test Loss: 0.938 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.221752643585205
Epoch: 20, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.006 Vali Acc: 0.812 Test Loss: 1.006 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.6217293739318848
Epoch: 21, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.942 Vali Acc: 0.797 Test Loss: 0.942 Test Acc: 0.797
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.667924404144287
Epoch: 22, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.959 Vali Acc: 0.797 Test Loss: 0.959 Test Acc: 0.797
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.455186128616333
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.950 Vali Acc: 0.812 Test Loss: 0.950 Test Acc: 0.812
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.9860901832580566
Epoch: 24, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.985 Vali Acc: 0.812 Test Loss: 0.985 Test Acc: 0.812
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.260493278503418
Epoch: 25, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.979 Vali Acc: 0.812 Test Loss: 0.979 Test Acc: 0.812
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.4081566333770752
Epoch: 26, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.025 Vali Acc: 0.819 Test Loss: 1.025 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el6_dm768_df768_ps35_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8333333333333334
model parameter : 43712260
model size : 181.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el6_dm768_df768_ps35_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.507370948791504
Epoch: 1, Steps: 9 | Train Loss: 1.456 Vali Loss: 1.380 Vali Acc: 0.312 Test Loss: 1.380 Test Acc: 0.312
Validation loss decreased (inf --> -0.311580).  Saving model ...
Epoch: 2 cost time: 1.3920166492462158
Epoch: 2, Steps: 9 | Train Loss: 1.361 Vali Loss: 1.290 Vali Acc: 0.420 Test Loss: 1.290 Test Acc: 0.420
Validation loss decreased (-0.311580 --> -0.420277).  Saving model ...
Epoch: 3 cost time: 1.3912129402160645
Epoch: 3, Steps: 9 | Train Loss: 1.241 Vali Loss: 1.188 Vali Acc: 0.543 Test Loss: 1.188 Test Acc: 0.543
Validation loss decreased (-0.420277 --> -0.543466).  Saving model ...
Epoch: 4 cost time: 1.076432704925537
Epoch: 4, Steps: 9 | Train Loss: 1.104 Vali Loss: 1.079 Vali Acc: 0.580 Test Loss: 1.079 Test Acc: 0.580
Validation loss decreased (-0.543466 --> -0.579699).  Saving model ...
Epoch: 5 cost time: 1.3938865661621094
Epoch: 5, Steps: 9 | Train Loss: 0.959 Vali Loss: 0.965 Vali Acc: 0.623 Test Loss: 0.965 Test Acc: 0.623
Validation loss decreased (-0.579699 --> -0.623179).  Saving model ...
Epoch: 6 cost time: 1.2817988395690918
Epoch: 6, Steps: 9 | Train Loss: 0.811 Vali Loss: 0.865 Vali Acc: 0.652 Test Loss: 0.865 Test Acc: 0.652
Validation loss decreased (-0.623179 --> -0.652165).  Saving model ...
Epoch: 7 cost time: 1.4066011905670166
Epoch: 7, Steps: 9 | Train Loss: 0.662 Vali Loss: 0.811 Vali Acc: 0.638 Test Loss: 0.811 Test Acc: 0.638
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.469264268875122
Epoch: 8, Steps: 9 | Train Loss: 0.572 Vali Loss: 0.741 Vali Acc: 0.703 Test Loss: 0.741 Test Acc: 0.703
Validation loss decreased (-0.652165 --> -0.702891).  Saving model ...
Epoch: 9 cost time: 1.0998854637145996
Epoch: 9, Steps: 9 | Train Loss: 0.432 Vali Loss: 0.667 Vali Acc: 0.739 Test Loss: 0.667 Test Acc: 0.739
Validation loss decreased (-0.702891 --> -0.739124).  Saving model ...
Epoch: 10 cost time: 1.0426876544952393
Epoch: 10, Steps: 9 | Train Loss: 0.312 Vali Loss: 0.643 Vali Acc: 0.739 Test Loss: 0.643 Test Acc: 0.739
Validation loss decreased (-0.739124 --> -0.739124).  Saving model ...
Epoch: 11 cost time: 1.5550172328948975
Epoch: 11, Steps: 9 | Train Loss: 0.248 Vali Loss: 0.618 Vali Acc: 0.775 Test Loss: 0.618 Test Acc: 0.775
Validation loss decreased (-0.739124 --> -0.775356).  Saving model ...
Epoch: 12 cost time: 1.2439136505126953
Epoch: 12, Steps: 9 | Train Loss: 0.143 Vali Loss: 0.704 Vali Acc: 0.761 Test Loss: 0.704 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2167799472808838
Epoch: 13, Steps: 9 | Train Loss: 0.098 Vali Loss: 0.681 Vali Acc: 0.804 Test Loss: 0.681 Test Acc: 0.804
Validation loss decreased (-0.775356 --> -0.804341).  Saving model ...
Epoch: 14 cost time: 1.441040277481079
Epoch: 14, Steps: 9 | Train Loss: 0.073 Vali Loss: 0.732 Vali Acc: 0.790 Test Loss: 0.732 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.6867585182189941
Epoch: 15, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.907 Vali Acc: 0.754 Test Loss: 0.907 Test Acc: 0.754
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.2197282314300537
Epoch: 16, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.856 Vali Acc: 0.768 Test Loss: 0.856 Test Acc: 0.768
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.7242224216461182
Epoch: 17, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.775 Vali Acc: 0.790 Test Loss: 0.775 Test Acc: 0.790
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.0810811519622803
Epoch: 18, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.837 Vali Acc: 0.790 Test Loss: 0.837 Test Acc: 0.790
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.2656042575836182
Epoch: 19, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.866 Vali Acc: 0.783 Test Loss: 0.866 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.0284397602081299
Epoch: 20, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.848 Vali Acc: 0.783 Test Loss: 0.848 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.1685519218444824
Epoch: 21, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.900 Vali Acc: 0.775 Test Loss: 0.900 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.9858157634735107
Epoch: 22, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.852 Vali Acc: 0.804 Test Loss: 0.852 Test Acc: 0.804
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.109025478363037
Epoch: 23, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.944 Vali Acc: 0.797 Test Loss: 0.944 Test Acc: 0.797
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el6_dm768_df768_ps35_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8043478260869565
model parameter : 43666180
model size : 181.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el6_dm768_df768_ps35_str35_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.532693386077881
Epoch: 1, Steps: 9 | Train Loss: 1.457 Vali Loss: 1.424 Vali Acc: 0.275 Test Loss: 1.424 Test Acc: 0.275
Validation loss decreased (inf --> -0.275348).  Saving model ...
Epoch: 2 cost time: 1.221107006072998
Epoch: 2, Steps: 9 | Train Loss: 1.329 Vali Loss: 1.348 Vali Acc: 0.319 Test Loss: 1.348 Test Acc: 0.319
Validation loss decreased (-0.275348 --> -0.318827).  Saving model ...
Epoch: 3 cost time: 1.1412196159362793
Epoch: 3, Steps: 9 | Train Loss: 1.261 Vali Loss: 1.278 Vali Acc: 0.413 Test Loss: 1.278 Test Acc: 0.413
Validation loss decreased (-0.318827 --> -0.413031).  Saving model ...
Epoch: 4 cost time: 1.2595996856689453
Epoch: 4, Steps: 9 | Train Loss: 1.196 Vali Loss: 1.190 Vali Acc: 0.478 Test Loss: 1.190 Test Acc: 0.478
Validation loss decreased (-0.413031 --> -0.478249).  Saving model ...
Epoch: 5 cost time: 1.3030922412872314
Epoch: 5, Steps: 9 | Train Loss: 1.072 Vali Loss: 1.091 Vali Acc: 0.601 Test Loss: 1.091 Test Acc: 0.601
Validation loss decreased (-0.478249 --> -0.601438).  Saving model ...
Epoch: 6 cost time: 1.2649550437927246
Epoch: 6, Steps: 9 | Train Loss: 0.958 Vali Loss: 0.977 Vali Acc: 0.572 Test Loss: 0.977 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2544841766357422
Epoch: 7, Steps: 9 | Train Loss: 0.812 Vali Loss: 0.880 Vali Acc: 0.630 Test Loss: 0.880 Test Acc: 0.630
Validation loss decreased (-0.601438 --> -0.630426).  Saving model ...
Epoch: 8 cost time: 1.1712791919708252
Epoch: 8, Steps: 9 | Train Loss: 0.667 Vali Loss: 0.814 Vali Acc: 0.652 Test Loss: 0.814 Test Acc: 0.652
Validation loss decreased (-0.630426 --> -0.652166).  Saving model ...
Epoch: 9 cost time: 1.081233024597168
Epoch: 9, Steps: 9 | Train Loss: 0.592 Vali Loss: 0.759 Vali Acc: 0.674 Test Loss: 0.759 Test Acc: 0.674
Validation loss decreased (-0.652166 --> -0.673905).  Saving model ...
Epoch: 10 cost time: 1.2605924606323242
Epoch: 10, Steps: 9 | Train Loss: 0.454 Vali Loss: 0.757 Vali Acc: 0.659 Test Loss: 0.757 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1301467418670654
Epoch: 11, Steps: 9 | Train Loss: 0.395 Vali Loss: 0.750 Vali Acc: 0.674 Test Loss: 0.750 Test Acc: 0.674
Validation loss decreased (-0.673905 --> -0.673906).  Saving model ...
Epoch: 12 cost time: 1.180382251739502
Epoch: 12, Steps: 9 | Train Loss: 0.295 Vali Loss: 0.681 Vali Acc: 0.746 Test Loss: 0.681 Test Acc: 0.746
Validation loss decreased (-0.673906 --> -0.746370).  Saving model ...
Epoch: 13 cost time: 1.0854907035827637
Epoch: 13, Steps: 9 | Train Loss: 0.257 Vali Loss: 0.697 Vali Acc: 0.732 Test Loss: 0.697 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2632193565368652
Epoch: 14, Steps: 9 | Train Loss: 0.178 Vali Loss: 0.668 Vali Acc: 0.754 Test Loss: 0.668 Test Acc: 0.754
Validation loss decreased (-0.746370 --> -0.753617).  Saving model ...
Epoch: 15 cost time: 1.0025761127471924
Epoch: 15, Steps: 9 | Train Loss: 0.136 Vali Loss: 0.791 Vali Acc: 0.732 Test Loss: 0.791 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0414271354675293
Epoch: 16, Steps: 9 | Train Loss: 0.105 Vali Loss: 0.717 Vali Acc: 0.717 Test Loss: 0.717 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.0332658290863037
Epoch: 17, Steps: 9 | Train Loss: 0.080 Vali Loss: 0.772 Vali Acc: 0.754 Test Loss: 0.772 Test Acc: 0.754
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.0415685176849365
Epoch: 18, Steps: 9 | Train Loss: 0.067 Vali Loss: 0.825 Vali Acc: 0.739 Test Loss: 0.825 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.0024781227111816
Epoch: 19, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.825 Vali Acc: 0.725 Test Loss: 0.825 Test Acc: 0.725
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.237109661102295
Epoch: 20, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.874 Vali Acc: 0.732 Test Loss: 0.874 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.2091999053955078
Epoch: 21, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.727 Vali Acc: 0.768 Test Loss: 0.727 Test Acc: 0.768
Validation loss decreased (-0.753617 --> -0.768109).  Saving model ...
Epoch: 22 cost time: 1.422882080078125
Epoch: 22, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.828 Vali Acc: 0.775 Test Loss: 0.828 Test Acc: 0.775
Validation loss decreased (-0.768109 --> -0.775354).  Saving model ...
Epoch: 23 cost time: 1.1132302284240723
Epoch: 23, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.927 Vali Acc: 0.754 Test Loss: 0.927 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.082061767578125
Epoch: 24, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.874 Vali Acc: 0.768 Test Loss: 0.874 Test Acc: 0.768
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.9592359066009521
Epoch: 25, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.839 Vali Acc: 0.790 Test Loss: 0.839 Test Acc: 0.790
Validation loss decreased (-0.775354 --> -0.789847).  Saving model ...
Epoch: 26 cost time: 1.1308929920196533
Epoch: 26, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.864 Vali Acc: 0.783 Test Loss: 0.864 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9692881107330322
Epoch: 27, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.921 Vali Acc: 0.775 Test Loss: 0.921 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.9607105255126953
Epoch: 28, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.962 Vali Acc: 0.768 Test Loss: 0.962 Test Acc: 0.768
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.0932278633117676
Epoch: 29, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.962 Vali Acc: 0.761 Test Loss: 0.962 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.9552304744720459
Epoch: 30, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.919 Vali Acc: 0.783 Test Loss: 0.919 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.9715762138366699
Epoch: 31, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.922 Vali Acc: 0.790 Test Loss: 0.922 Test Acc: 0.790
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.8813788890838623
Epoch: 32, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.917 Vali Acc: 0.797 Test Loss: 0.917 Test Acc: 0.797
Validation loss decreased (-0.789847 --> -0.797092).  Saving model ...
Epoch: 33 cost time: 1.1115748882293701
Epoch: 33, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.928 Vali Acc: 0.783 Test Loss: 0.928 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.0235602855682373
Epoch: 34, Steps: 9 | Train Loss: 0.006 Vali Loss: 1.002 Vali Acc: 0.761 Test Loss: 1.002 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.127922534942627
Epoch: 35, Steps: 9 | Train Loss: 0.005 Vali Loss: 1.050 Vali Acc: 0.754 Test Loss: 1.050 Test Acc: 0.754
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.1856675148010254
Epoch: 36, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.004 Vali Acc: 0.761 Test Loss: 1.004 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.0919184684753418
Epoch: 37, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.989 Vali Acc: 0.761 Test Loss: 0.989 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.062770128250122
Epoch: 38, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.993 Vali Acc: 0.761 Test Loss: 0.993 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.080277919769287
Epoch: 39, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.977 Vali Acc: 0.768 Test Loss: 0.977 Test Acc: 0.768
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.0059497356414795
Epoch: 40, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.996 Vali Acc: 0.768 Test Loss: 0.996 Test Acc: 0.768
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.8096129894256592
Epoch: 41, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.034 Vali Acc: 0.768 Test Loss: 1.034 Test Acc: 0.768
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.100951910018921
Epoch: 42, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.058 Vali Acc: 0.761 Test Loss: 1.058 Test Acc: 0.761
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el6_dm768_df768_ps35_str35_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.7971014492753623
model parameter : 43643140
model size : 181.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el6_dm768_df768_ps42_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.797222137451172
Epoch: 1, Steps: 9 | Train Loss: 1.491 Vali Loss: 1.429 Vali Acc: 0.203 Test Loss: 1.429 Test Acc: 0.203
Validation loss decreased (inf --> -0.202884).  Saving model ...
Epoch: 2 cost time: 1.046675443649292
Epoch: 2, Steps: 9 | Train Loss: 1.371 Vali Loss: 1.267 Vali Acc: 0.551 Test Loss: 1.267 Test Acc: 0.551
Validation loss decreased (-0.202884 --> -0.550712).  Saving model ...
Epoch: 3 cost time: 1.020108938217163
Epoch: 3, Steps: 9 | Train Loss: 1.214 Vali Loss: 1.141 Vali Acc: 0.609 Test Loss: 1.141 Test Acc: 0.609
Validation loss decreased (-0.550712 --> -0.608684).  Saving model ...
Epoch: 4 cost time: 1.490206003189087
Epoch: 4, Steps: 9 | Train Loss: 1.076 Vali Loss: 1.030 Vali Acc: 0.630 Test Loss: 1.030 Test Acc: 0.630
Validation loss decreased (-0.608684 --> -0.630424).  Saving model ...
Epoch: 5 cost time: 1.330658197402954
Epoch: 5, Steps: 9 | Train Loss: 0.927 Vali Loss: 0.889 Vali Acc: 0.681 Test Loss: 0.889 Test Acc: 0.681
Validation loss decreased (-0.630424 --> -0.681151).  Saving model ...
Epoch: 6 cost time: 1.5549018383026123
Epoch: 6, Steps: 9 | Train Loss: 0.704 Vali Loss: 0.791 Vali Acc: 0.732 Test Loss: 0.791 Test Acc: 0.732
Validation loss decreased (-0.681151 --> -0.731876).  Saving model ...
Epoch: 7 cost time: 1.136091709136963
Epoch: 7, Steps: 9 | Train Loss: 0.554 Vali Loss: 0.696 Vali Acc: 0.768 Test Loss: 0.696 Test Acc: 0.768
Validation loss decreased (-0.731876 --> -0.768109).  Saving model ...
Epoch: 8 cost time: 1.3263978958129883
Epoch: 8, Steps: 9 | Train Loss: 0.438 Vali Loss: 0.727 Vali Acc: 0.710 Test Loss: 0.727 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2489800453186035
Epoch: 9, Steps: 9 | Train Loss: 0.296 Vali Loss: 0.619 Vali Acc: 0.797 Test Loss: 0.619 Test Acc: 0.797
Validation loss decreased (-0.768109 --> -0.797095).  Saving model ...
Epoch: 10 cost time: 1.204052448272705
Epoch: 10, Steps: 9 | Train Loss: 0.217 Vali Loss: 0.682 Vali Acc: 0.739 Test Loss: 0.682 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1416475772857666
Epoch: 11, Steps: 9 | Train Loss: 0.130 Vali Loss: 0.618 Vali Acc: 0.812 Test Loss: 0.618 Test Acc: 0.812
Validation loss decreased (-0.797095 --> -0.811588).  Saving model ...
Epoch: 12 cost time: 1.3888061046600342
Epoch: 12, Steps: 9 | Train Loss: 0.068 Vali Loss: 0.833 Vali Acc: 0.768 Test Loss: 0.833 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2570147514343262
Epoch: 13, Steps: 9 | Train Loss: 0.058 Vali Loss: 0.794 Vali Acc: 0.790 Test Loss: 0.794 Test Acc: 0.790
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.3358392715454102
Epoch: 14, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.854 Vali Acc: 0.797 Test Loss: 0.854 Test Acc: 0.797
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.3394582271575928
Epoch: 15, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.798 Vali Acc: 0.797 Test Loss: 0.798 Test Acc: 0.797
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.1512823104858398
Epoch: 16, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.812 Vali Acc: 0.812 Test Loss: 0.812 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.2380270957946777
Epoch: 17, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.856 Vali Acc: 0.804 Test Loss: 0.856 Test Acc: 0.804
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.2696759700775146
Epoch: 18, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.794 Vali Acc: 0.812 Test Loss: 0.794 Test Acc: 0.812
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.0597362518310547
Epoch: 19, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.852 Vali Acc: 0.804 Test Loss: 0.852 Test Acc: 0.804
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.3065874576568604
Epoch: 20, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.895 Vali Acc: 0.804 Test Loss: 0.895 Test Acc: 0.804
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.0218710899353027
Epoch: 21, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.911 Vali Acc: 0.804 Test Loss: 0.911 Test Acc: 0.804
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el6_dm768_df768_ps42_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8115942028985508
model parameter : 43737604
model size : 181.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el6_dm768_df768_ps42_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.2429518699645996
Epoch: 1, Steps: 9 | Train Loss: 1.387 Vali Loss: 1.341 Vali Acc: 0.341 Test Loss: 1.341 Test Acc: 0.341
Validation loss decreased (inf --> -0.340566).  Saving model ...
Epoch: 2 cost time: 1.000110387802124
Epoch: 2, Steps: 9 | Train Loss: 1.298 Vali Loss: 1.264 Vali Acc: 0.457 Test Loss: 1.264 Test Acc: 0.457
Validation loss decreased (-0.340566 --> -0.456509).  Saving model ...
Epoch: 3 cost time: 1.2800772190093994
Epoch: 3, Steps: 9 | Train Loss: 1.172 Vali Loss: 1.171 Vali Acc: 0.580 Test Loss: 1.171 Test Acc: 0.580
Validation loss decreased (-0.456509 --> -0.579698).  Saving model ...
Epoch: 4 cost time: 1.1621730327606201
Epoch: 4, Steps: 9 | Train Loss: 1.070 Vali Loss: 1.055 Vali Acc: 0.667 Test Loss: 1.055 Test Acc: 0.667
Validation loss decreased (-0.579698 --> -0.666656).  Saving model ...
Epoch: 5 cost time: 1.0979499816894531
Epoch: 5, Steps: 9 | Train Loss: 0.931 Vali Loss: 0.919 Vali Acc: 0.681 Test Loss: 0.919 Test Acc: 0.681
Validation loss decreased (-0.666656 --> -0.681150).  Saving model ...
Epoch: 6 cost time: 1.1725265979766846
Epoch: 6, Steps: 9 | Train Loss: 0.807 Vali Loss: 0.820 Vali Acc: 0.688 Test Loss: 0.820 Test Acc: 0.688
Validation loss decreased (-0.681150 --> -0.688398).  Saving model ...
Epoch: 7 cost time: 1.0542676448822021
Epoch: 7, Steps: 9 | Train Loss: 0.618 Vali Loss: 0.700 Vali Acc: 0.746 Test Loss: 0.700 Test Acc: 0.746
Validation loss decreased (-0.688398 --> -0.746370).  Saving model ...
Epoch: 8 cost time: 1.096923828125
Epoch: 8, Steps: 9 | Train Loss: 0.487 Vali Loss: 0.679 Vali Acc: 0.768 Test Loss: 0.679 Test Acc: 0.768
Validation loss decreased (-0.746370 --> -0.768109).  Saving model ...
Epoch: 9 cost time: 1.07142972946167
Epoch: 9, Steps: 9 | Train Loss: 0.368 Vali Loss: 0.605 Vali Acc: 0.790 Test Loss: 0.605 Test Acc: 0.790
Validation loss decreased (-0.768109 --> -0.789849).  Saving model ...
Epoch: 10 cost time: 1.0380864143371582
Epoch: 10, Steps: 9 | Train Loss: 0.278 Vali Loss: 0.570 Vali Acc: 0.812 Test Loss: 0.570 Test Acc: 0.812
Validation loss decreased (-0.789849 --> -0.811589).  Saving model ...
Epoch: 11 cost time: 1.251791000366211
Epoch: 11, Steps: 9 | Train Loss: 0.225 Vali Loss: 0.637 Vali Acc: 0.775 Test Loss: 0.637 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8786587715148926
Epoch: 12, Steps: 9 | Train Loss: 0.142 Vali Loss: 0.667 Vali Acc: 0.797 Test Loss: 0.667 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1065306663513184
Epoch: 13, Steps: 9 | Train Loss: 0.120 Vali Loss: 0.563 Vali Acc: 0.797 Test Loss: 0.563 Test Acc: 0.797
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.3738682270050049
Epoch: 14, Steps: 9 | Train Loss: 0.067 Vali Loss: 0.583 Vali Acc: 0.819 Test Loss: 0.583 Test Acc: 0.819
Validation loss decreased (-0.811589 --> -0.818835).  Saving model ...
Epoch: 15 cost time: 0.9437391757965088
Epoch: 15, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.644 Vali Acc: 0.804 Test Loss: 0.644 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0552606582641602
Epoch: 16, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.657 Vali Acc: 0.812 Test Loss: 0.657 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.0089809894561768
Epoch: 17, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.685 Vali Acc: 0.804 Test Loss: 0.685 Test Acc: 0.804
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.2170021533966064
Epoch: 18, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.698 Vali Acc: 0.804 Test Loss: 0.698 Test Acc: 0.804
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.320199728012085
Epoch: 19, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.689 Vali Acc: 0.804 Test Loss: 0.689 Test Acc: 0.804
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.0438323020935059
Epoch: 20, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.710 Vali Acc: 0.819 Test Loss: 0.710 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.0884230136871338
Epoch: 21, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.698 Vali Acc: 0.804 Test Loss: 0.698 Test Acc: 0.804
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.067620038986206
Epoch: 22, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.723 Vali Acc: 0.797 Test Loss: 0.723 Test Acc: 0.797
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.9409737586975098
Epoch: 23, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.743 Vali Acc: 0.797 Test Loss: 0.743 Test Acc: 0.797
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.114084243774414
Epoch: 24, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.787 Vali Acc: 0.812 Test Loss: 0.787 Test Acc: 0.812
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el6_dm768_df768_ps42_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8188405797101449
model parameter : 43705348
model size : 181.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el6_dm768_df768_ps42_str42_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.7058589458465576
Epoch: 1, Steps: 9 | Train Loss: 1.456 Vali Loss: 1.428 Vali Acc: 0.167 Test Loss: 1.428 Test Acc: 0.167
Validation loss decreased (inf --> -0.166652).  Saving model ...
Epoch: 2 cost time: 1.1328396797180176
Epoch: 2, Steps: 9 | Train Loss: 1.382 Vali Loss: 1.337 Vali Acc: 0.290 Test Loss: 1.337 Test Acc: 0.290
Validation loss decreased (-0.166652 --> -0.289842).  Saving model ...
Epoch: 3 cost time: 1.2341439723968506
Epoch: 3, Steps: 9 | Train Loss: 1.303 Vali Loss: 1.233 Vali Acc: 0.370 Test Loss: 1.233 Test Acc: 0.370
Validation loss decreased (-0.289842 --> -0.369553).  Saving model ...
Epoch: 4 cost time: 0.967848539352417
Epoch: 4, Steps: 9 | Train Loss: 1.198 Vali Loss: 1.153 Vali Acc: 0.435 Test Loss: 1.153 Test Acc: 0.435
Validation loss decreased (-0.369553 --> -0.434771).  Saving model ...
Epoch: 5 cost time: 1.0791583061218262
Epoch: 5, Steps: 9 | Train Loss: 1.101 Vali Loss: 1.075 Vali Acc: 0.522 Test Loss: 1.075 Test Acc: 0.522
Validation loss decreased (-0.434771 --> -0.521728).  Saving model ...
Epoch: 6 cost time: 0.9799542427062988
Epoch: 6, Steps: 9 | Train Loss: 0.986 Vali Loss: 1.011 Vali Acc: 0.529 Test Loss: 1.011 Test Acc: 0.529
Validation loss decreased (-0.521728 --> -0.528975).  Saving model ...
Epoch: 7 cost time: 1.251903772354126
Epoch: 7, Steps: 9 | Train Loss: 0.861 Vali Loss: 0.967 Vali Acc: 0.543 Test Loss: 0.967 Test Acc: 0.543
Validation loss decreased (-0.528975 --> -0.543469).  Saving model ...
Epoch: 8 cost time: 1.309901237487793
Epoch: 8, Steps: 9 | Train Loss: 0.740 Vali Loss: 0.913 Vali Acc: 0.587 Test Loss: 0.913 Test Acc: 0.587
Validation loss decreased (-0.543469 --> -0.586947).  Saving model ...
Epoch: 9 cost time: 1.256296157836914
Epoch: 9, Steps: 9 | Train Loss: 0.626 Vali Loss: 0.880 Vali Acc: 0.630 Test Loss: 0.880 Test Acc: 0.630
Validation loss decreased (-0.586947 --> -0.630426).  Saving model ...
Epoch: 10 cost time: 0.9638035297393799
Epoch: 10, Steps: 9 | Train Loss: 0.523 Vali Loss: 0.775 Vali Acc: 0.710 Test Loss: 0.775 Test Acc: 0.710
Validation loss decreased (-0.630426 --> -0.710137).  Saving model ...
Epoch: 11 cost time: 1.2667458057403564
Epoch: 11, Steps: 9 | Train Loss: 0.407 Vali Loss: 0.775 Vali Acc: 0.703 Test Loss: 0.775 Test Acc: 0.703
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1868195533752441
Epoch: 12, Steps: 9 | Train Loss: 0.311 Vali Loss: 0.668 Vali Acc: 0.725 Test Loss: 0.668 Test Acc: 0.725
Validation loss decreased (-0.710137 --> -0.724631).  Saving model ...
Epoch: 13 cost time: 1.3939855098724365
Epoch: 13, Steps: 9 | Train Loss: 0.245 Vali Loss: 0.707 Vali Acc: 0.768 Test Loss: 0.707 Test Acc: 0.768
Validation loss decreased (-0.724631 --> -0.768109).  Saving model ...
Epoch: 14 cost time: 1.0889983177185059
Epoch: 14, Steps: 9 | Train Loss: 0.178 Vali Loss: 0.700 Vali Acc: 0.754 Test Loss: 0.700 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2725694179534912
Epoch: 15, Steps: 9 | Train Loss: 0.129 Vali Loss: 0.800 Vali Acc: 0.725 Test Loss: 0.800 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.200087070465088
Epoch: 16, Steps: 9 | Train Loss: 0.102 Vali Loss: 0.693 Vali Acc: 0.746 Test Loss: 0.693 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.116926670074463
Epoch: 17, Steps: 9 | Train Loss: 0.077 Vali Loss: 0.786 Vali Acc: 0.783 Test Loss: 0.786 Test Acc: 0.783
Validation loss decreased (-0.768109 --> -0.782601).  Saving model ...
Epoch: 18 cost time: 0.9070134162902832
Epoch: 18, Steps: 9 | Train Loss: 0.055 Vali Loss: 0.763 Vali Acc: 0.790 Test Loss: 0.763 Test Acc: 0.790
Validation loss decreased (-0.782601 --> -0.789847).  Saving model ...
Epoch: 19 cost time: 1.019557237625122
Epoch: 19, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.752 Vali Acc: 0.783 Test Loss: 0.752 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9349627494812012
Epoch: 20, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.825 Vali Acc: 0.761 Test Loss: 0.825 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.8880255222320557
Epoch: 21, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.850 Vali Acc: 0.775 Test Loss: 0.850 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.0847363471984863
Epoch: 22, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.817 Vali Acc: 0.775 Test Loss: 0.817 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.0140979290008545
Epoch: 23, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.807 Vali Acc: 0.775 Test Loss: 0.807 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.8712985515594482
Epoch: 24, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.895 Vali Acc: 0.768 Test Loss: 0.895 Test Acc: 0.768
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.0549252033233643
Epoch: 25, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.890 Vali Acc: 0.775 Test Loss: 0.890 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.9429266452789307
Epoch: 26, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.834 Vali Acc: 0.797 Test Loss: 0.834 Test Acc: 0.797
Validation loss decreased (-0.789847 --> -0.797093).  Saving model ...
Epoch: 27 cost time: 1.0738191604614258
Epoch: 27, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.848 Vali Acc: 0.797 Test Loss: 0.848 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.1773388385772705
Epoch: 28, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.906 Vali Acc: 0.783 Test Loss: 0.906 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.1216254234313965
Epoch: 29, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.923 Vali Acc: 0.790 Test Loss: 0.923 Test Acc: 0.790
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.7939326763153076
Epoch: 30, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.916 Vali Acc: 0.790 Test Loss: 0.916 Test Acc: 0.790
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.9130628108978271
Epoch: 31, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.900 Vali Acc: 0.790 Test Loss: 0.900 Test Acc: 0.790
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.9162473678588867
Epoch: 32, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.897 Vali Acc: 0.790 Test Loss: 0.897 Test Acc: 0.790
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.9797224998474121
Epoch: 33, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.910 Vali Acc: 0.790 Test Loss: 0.910 Test Acc: 0.790
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.8496215343475342
Epoch: 34, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.925 Vali Acc: 0.790 Test Loss: 0.925 Test Acc: 0.790
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.2155778408050537
Epoch: 35, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.932 Vali Acc: 0.783 Test Loss: 0.932 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.1908659934997559
Epoch: 36, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.942 Vali Acc: 0.775 Test Loss: 0.942 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el6_dm768_df768_ps42_str42_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.7971014492753623
model parameter : 43686916
model size : 181.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el5_dm768_df768_ps9_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.095800399780273
Epoch: 1, Steps: 9 | Train Loss: 1.458 Vali Loss: 1.295 Vali Acc: 0.384 Test Loss: 1.295 Test Acc: 0.384
Validation loss decreased (inf --> -0.384045).  Saving model ...
Epoch: 2 cost time: 1.6278178691864014
Epoch: 2, Steps: 9 | Train Loss: 1.224 Vali Loss: 1.015 Vali Acc: 0.645 Test Loss: 1.015 Test Acc: 0.645
Validation loss decreased (-0.384045 --> -0.644917).  Saving model ...
Epoch: 3 cost time: 2.3901925086975098
Epoch: 3, Steps: 9 | Train Loss: 0.902 Vali Loss: 0.875 Vali Acc: 0.659 Test Loss: 0.875 Test Acc: 0.659
Validation loss decreased (-0.644917 --> -0.659412).  Saving model ...
Epoch: 4 cost time: 2.0121638774871826
Epoch: 4, Steps: 9 | Train Loss: 0.621 Vali Loss: 0.711 Vali Acc: 0.710 Test Loss: 0.711 Test Acc: 0.710
Validation loss decreased (-0.659412 --> -0.710138).  Saving model ...
Epoch: 5 cost time: 1.9140901565551758
Epoch: 5, Steps: 9 | Train Loss: 0.430 Vali Loss: 0.645 Vali Acc: 0.717 Test Loss: 0.645 Test Acc: 0.717
Validation loss decreased (-0.710138 --> -0.717385).  Saving model ...
Epoch: 6 cost time: 2.1388680934906006
Epoch: 6, Steps: 9 | Train Loss: 0.290 Vali Loss: 0.897 Vali Acc: 0.630 Test Loss: 0.897 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.222025156021118
Epoch: 7, Steps: 9 | Train Loss: 0.291 Vali Loss: 0.544 Vali Acc: 0.855 Test Loss: 0.544 Test Acc: 0.855
Validation loss decreased (-0.717385 --> -0.855067).  Saving model ...
Epoch: 8 cost time: 2.4218783378601074
Epoch: 8, Steps: 9 | Train Loss: 0.110 Vali Loss: 0.715 Vali Acc: 0.790 Test Loss: 0.715 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.1481566429138184
Epoch: 9, Steps: 9 | Train Loss: 0.090 Vali Loss: 0.516 Vali Acc: 0.855 Test Loss: 0.516 Test Acc: 0.855
Validation loss decreased (-0.855067 --> -0.855067).  Saving model ...
Epoch: 10 cost time: 2.2110252380371094
Epoch: 10, Steps: 9 | Train Loss: 0.063 Vali Loss: 0.718 Vali Acc: 0.754 Test Loss: 0.718 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.161954879760742
Epoch: 11, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.807 Vali Acc: 0.761 Test Loss: 0.807 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.4955480098724365
Epoch: 12, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.964 Vali Acc: 0.833 Test Loss: 0.964 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.1377289295196533
Epoch: 13, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.987 Vali Acc: 0.819 Test Loss: 0.987 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.831890821456909
Epoch: 14, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.777 Vali Acc: 0.862 Test Loss: 0.777 Test Acc: 0.862
Validation loss decreased (-0.855067 --> -0.862311).  Saving model ...
Epoch: 15 cost time: 2.624999761581421
Epoch: 15, Steps: 9 | Train Loss: 0.022 Vali Loss: 1.821 Vali Acc: 0.768 Test Loss: 1.821 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.4288692474365234
Epoch: 16, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.812 Vali Acc: 0.804 Test Loss: 0.812 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.601592540740967
Epoch: 17, Steps: 9 | Train Loss: 0.006 Vali Loss: 1.548 Vali Acc: 0.783 Test Loss: 1.548 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.213261365890503
Epoch: 18, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.319 Vali Acc: 0.841 Test Loss: 1.319 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.5617835521697998
Epoch: 19, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.988 Vali Acc: 0.855 Test Loss: 0.988 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.3228731155395508
Epoch: 20, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.145 Vali Acc: 0.833 Test Loss: 1.145 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.6027235984802246
Epoch: 21, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.739 Vali Acc: 0.754 Test Loss: 1.739 Test Acc: 0.754
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.541827917098999
Epoch: 22, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.087 Vali Acc: 0.826 Test Loss: 1.087 Test Acc: 0.826
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.0012545585632324
Epoch: 23, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.915 Vali Acc: 0.848 Test Loss: 0.915 Test Acc: 0.848
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.282106876373291
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.951 Vali Acc: 0.833 Test Loss: 0.951 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el5_dm768_df768_ps9_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8623188405797102
model parameter : 36656644
model size : 154.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el5_dm768_df768_ps9_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.5612499713897705
Epoch: 1, Steps: 9 | Train Loss: 1.399 Vali Loss: 1.297 Vali Acc: 0.449 Test Loss: 1.297 Test Acc: 0.449
Validation loss decreased (inf --> -0.449262).  Saving model ...
Epoch: 2 cost time: 2.0519590377807617
Epoch: 2, Steps: 9 | Train Loss: 1.246 Vali Loss: 1.088 Vali Acc: 0.638 Test Loss: 1.088 Test Acc: 0.638
Validation loss decreased (-0.449262 --> -0.637670).  Saving model ...
Epoch: 3 cost time: 1.451995611190796
Epoch: 3, Steps: 9 | Train Loss: 0.994 Vali Loss: 0.910 Vali Acc: 0.681 Test Loss: 0.910 Test Acc: 0.681
Validation loss decreased (-0.637670 --> -0.681150).  Saving model ...
Epoch: 4 cost time: 1.7740647792816162
Epoch: 4, Steps: 9 | Train Loss: 0.756 Vali Loss: 0.774 Vali Acc: 0.710 Test Loss: 0.774 Test Acc: 0.710
Validation loss decreased (-0.681150 --> -0.710137).  Saving model ...
Epoch: 5 cost time: 1.7213118076324463
Epoch: 5, Steps: 9 | Train Loss: 0.547 Vali Loss: 0.726 Vali Acc: 0.652 Test Loss: 0.726 Test Acc: 0.652
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7350730895996094
Epoch: 6, Steps: 9 | Train Loss: 0.403 Vali Loss: 0.705 Vali Acc: 0.768 Test Loss: 0.705 Test Acc: 0.768
Validation loss decreased (-0.710137 --> -0.768109).  Saving model ...
Epoch: 7 cost time: 1.6366722583770752
Epoch: 7, Steps: 9 | Train Loss: 0.325 Vali Loss: 0.761 Vali Acc: 0.710 Test Loss: 0.761 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.0234265327453613
Epoch: 8, Steps: 9 | Train Loss: 0.192 Vali Loss: 0.577 Vali Acc: 0.768 Test Loss: 0.577 Test Acc: 0.768
Validation loss decreased (-0.768109 --> -0.768110).  Saving model ...
Epoch: 9 cost time: 1.3759574890136719
Epoch: 9, Steps: 9 | Train Loss: 0.178 Vali Loss: 0.844 Vali Acc: 0.819 Test Loss: 0.844 Test Acc: 0.819
Validation loss decreased (-0.768110 --> -0.818832).  Saving model ...
Epoch: 10 cost time: 1.2511589527130127
Epoch: 10, Steps: 9 | Train Loss: 0.087 Vali Loss: 0.710 Vali Acc: 0.812 Test Loss: 0.710 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.9257116317749023
Epoch: 11, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.896 Vali Acc: 0.804 Test Loss: 0.896 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.459535837173462
Epoch: 12, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.564 Vali Acc: 0.877 Test Loss: 0.564 Test Acc: 0.877
Validation loss decreased (-0.818832 --> -0.876806).  Saving model ...
Epoch: 13 cost time: 2.4904375076293945
Epoch: 13, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.816 Vali Acc: 0.841 Test Loss: 0.816 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.293583631515503
Epoch: 14, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.777 Vali Acc: 0.812 Test Loss: 0.777 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.0461034774780273
Epoch: 15, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.762 Vali Acc: 0.819 Test Loss: 0.762 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.3338429927825928
Epoch: 16, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.725 Vali Acc: 0.833 Test Loss: 0.725 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.1113669872283936
Epoch: 17, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.824 Vali Acc: 0.841 Test Loss: 0.824 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.5538527965545654
Epoch: 18, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.704 Vali Acc: 0.855 Test Loss: 0.704 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.7955610752105713
Epoch: 19, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.757 Vali Acc: 0.862 Test Loss: 0.757 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.1642699241638184
Epoch: 20, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.799 Vali Acc: 0.841 Test Loss: 0.799 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.809908390045166
Epoch: 21, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.855 Vali Acc: 0.841 Test Loss: 0.855 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.8188743591308594
Epoch: 22, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.849 Vali Acc: 0.855 Test Loss: 0.849 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el5_dm768_df768_ps9_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8768115942028986
model parameter : 36536836
model size : 154.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el5_dm768_df768_ps9_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.598509788513184
Epoch: 1, Steps: 9 | Train Loss: 1.400 Vali Loss: 1.350 Vali Acc: 0.348 Test Loss: 1.350 Test Acc: 0.348
Validation loss decreased (inf --> -0.347813).  Saving model ...
Epoch: 2 cost time: 2.250370740890503
Epoch: 2, Steps: 9 | Train Loss: 1.295 Vali Loss: 1.195 Vali Acc: 0.536 Test Loss: 1.195 Test Acc: 0.536
Validation loss decreased (-0.347813 --> -0.536220).  Saving model ...
Epoch: 3 cost time: 2.0670716762542725
Epoch: 3, Steps: 9 | Train Loss: 1.137 Vali Loss: 1.037 Vali Acc: 0.688 Test Loss: 1.037 Test Acc: 0.688
Validation loss decreased (-0.536220 --> -0.688395).  Saving model ...
Epoch: 4 cost time: 2.1023452281951904
Epoch: 4, Steps: 9 | Train Loss: 0.983 Vali Loss: 0.913 Vali Acc: 0.667 Test Loss: 0.913 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.383730411529541
Epoch: 5, Steps: 9 | Train Loss: 0.795 Vali Loss: 0.808 Vali Acc: 0.710 Test Loss: 0.808 Test Acc: 0.710
Validation loss decreased (-0.688395 --> -0.710137).  Saving model ...
Epoch: 6 cost time: 2.546354293823242
Epoch: 6, Steps: 9 | Train Loss: 0.631 Vali Loss: 0.725 Vali Acc: 0.725 Test Loss: 0.725 Test Acc: 0.725
Validation loss decreased (-0.710137 --> -0.724630).  Saving model ...
Epoch: 7 cost time: 1.8574731349945068
Epoch: 7, Steps: 9 | Train Loss: 0.505 Vali Loss: 0.747 Vali Acc: 0.717 Test Loss: 0.747 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6463983058929443
Epoch: 8, Steps: 9 | Train Loss: 0.387 Vali Loss: 0.789 Vali Acc: 0.746 Test Loss: 0.789 Test Acc: 0.746
Validation loss decreased (-0.724630 --> -0.746369).  Saving model ...
Epoch: 9 cost time: 1.4841938018798828
Epoch: 9, Steps: 9 | Train Loss: 0.269 Vali Loss: 0.753 Vali Acc: 0.746 Test Loss: 0.753 Test Acc: 0.746
Validation loss decreased (-0.746369 --> -0.746369).  Saving model ...
Epoch: 10 cost time: 1.2934308052062988
Epoch: 10, Steps: 9 | Train Loss: 0.234 Vali Loss: 0.701 Vali Acc: 0.797 Test Loss: 0.701 Test Acc: 0.797
Validation loss decreased (-0.746369 --> -0.797094).  Saving model ...
Epoch: 11 cost time: 1.6274676322937012
Epoch: 11, Steps: 9 | Train Loss: 0.160 Vali Loss: 0.828 Vali Acc: 0.783 Test Loss: 0.828 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.231163501739502
Epoch: 12, Steps: 9 | Train Loss: 0.090 Vali Loss: 0.747 Vali Acc: 0.812 Test Loss: 0.747 Test Acc: 0.812
Validation loss decreased (-0.797094 --> -0.811587).  Saving model ...
Epoch: 13 cost time: 1.7523577213287354
Epoch: 13, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.608 Vali Acc: 0.812 Test Loss: 0.608 Test Acc: 0.812
Validation loss decreased (-0.811587 --> -0.811588).  Saving model ...
Epoch: 14 cost time: 1.6191534996032715
Epoch: 14, Steps: 9 | Train Loss: 0.051 Vali Loss: 1.012 Vali Acc: 0.812 Test Loss: 1.012 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3459186553955078
Epoch: 15, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.665 Vali Acc: 0.833 Test Loss: 0.665 Test Acc: 0.833
Validation loss decreased (-0.811588 --> -0.833327).  Saving model ...
Epoch: 16 cost time: 1.2339718341827393
Epoch: 16, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.880 Vali Acc: 0.819 Test Loss: 0.880 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2353591918945312
Epoch: 17, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.693 Vali Acc: 0.812 Test Loss: 0.693 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9456658363342285
Epoch: 18, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.773 Vali Acc: 0.819 Test Loss: 0.773 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.2768700122833252
Epoch: 19, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.904 Vali Acc: 0.812 Test Loss: 0.904 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.3122456073760986
Epoch: 20, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.737 Vali Acc: 0.826 Test Loss: 0.737 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.190899133682251
Epoch: 21, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.705 Vali Acc: 0.819 Test Loss: 0.705 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.3139965534210205
Epoch: 22, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.022 Vali Acc: 0.812 Test Loss: 1.022 Test Acc: 0.812
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.148005247116089
Epoch: 23, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.001 Vali Acc: 0.819 Test Loss: 1.001 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.6429972648620605
Epoch: 24, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.844 Vali Acc: 0.819 Test Loss: 0.844 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.220616340637207
Epoch: 25, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.879 Vali Acc: 0.819 Test Loss: 0.879 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el5_dm768_df768_ps9_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8333333333333334
model parameter : 36453892
model size : 153.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el5_dm768_df768_ps10_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.432720899581909
Epoch: 1, Steps: 9 | Train Loss: 1.457 Vali Loss: 1.348 Vali Acc: 0.355 Test Loss: 1.348 Test Acc: 0.355
Validation loss decreased (inf --> -0.355059).  Saving model ...
Epoch: 2 cost time: 1.4764869213104248
Epoch: 2, Steps: 9 | Train Loss: 1.232 Vali Loss: 1.139 Vali Acc: 0.435 Test Loss: 1.139 Test Acc: 0.435
Validation loss decreased (-0.355059 --> -0.434771).  Saving model ...
Epoch: 3 cost time: 2.228832244873047
Epoch: 3, Steps: 9 | Train Loss: 0.932 Vali Loss: 1.041 Vali Acc: 0.543 Test Loss: 1.041 Test Acc: 0.543
Validation loss decreased (-0.434771 --> -0.543468).  Saving model ...
Epoch: 4 cost time: 2.9787230491638184
Epoch: 4, Steps: 9 | Train Loss: 0.728 Vali Loss: 0.819 Vali Acc: 0.638 Test Loss: 0.819 Test Acc: 0.638
Validation loss decreased (-0.543468 --> -0.637673).  Saving model ...
Epoch: 5 cost time: 2.2526979446411133
Epoch: 5, Steps: 9 | Train Loss: 0.529 Vali Loss: 0.705 Vali Acc: 0.710 Test Loss: 0.705 Test Acc: 0.710
Validation loss decreased (-0.637673 --> -0.710138).  Saving model ...
Epoch: 6 cost time: 1.990372896194458
Epoch: 6, Steps: 9 | Train Loss: 0.329 Vali Loss: 0.628 Vali Acc: 0.761 Test Loss: 0.628 Test Acc: 0.761
Validation loss decreased (-0.710138 --> -0.760863).  Saving model ...
Epoch: 7 cost time: 2.1634764671325684
Epoch: 7, Steps: 9 | Train Loss: 0.200 Vali Loss: 0.544 Vali Acc: 0.775 Test Loss: 0.544 Test Acc: 0.775
Validation loss decreased (-0.760863 --> -0.775357).  Saving model ...
Epoch: 8 cost time: 2.3494861125946045
Epoch: 8, Steps: 9 | Train Loss: 0.149 Vali Loss: 0.625 Vali Acc: 0.768 Test Loss: 0.625 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.0501179695129395
Epoch: 9, Steps: 9 | Train Loss: 0.065 Vali Loss: 0.605 Vali Acc: 0.841 Test Loss: 0.605 Test Acc: 0.841
Validation loss decreased (-0.775357 --> -0.840574).  Saving model ...
Epoch: 10 cost time: 2.55491304397583
Epoch: 10, Steps: 9 | Train Loss: 0.029 Vali Loss: 1.147 Vali Acc: 0.703 Test Loss: 1.147 Test Acc: 0.703
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.657965660095215
Epoch: 11, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.997 Vali Acc: 0.804 Test Loss: 0.997 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.671116590499878
Epoch: 12, Steps: 9 | Train Loss: 0.013 Vali Loss: 1.625 Vali Acc: 0.688 Test Loss: 1.625 Test Acc: 0.688
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.3056719303131104
Epoch: 13, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.748 Vali Acc: 0.812 Test Loss: 0.748 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.6145238876342773
Epoch: 14, Steps: 9 | Train Loss: 0.040 Vali Loss: 2.125 Vali Acc: 0.783 Test Loss: 2.125 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.7949604988098145
Epoch: 15, Steps: 9 | Train Loss: 0.023 Vali Loss: 1.119 Vali Acc: 0.775 Test Loss: 1.119 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.332575798034668
Epoch: 16, Steps: 9 | Train Loss: 0.014 Vali Loss: 1.510 Vali Acc: 0.812 Test Loss: 1.510 Test Acc: 0.812
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.422809362411499
Epoch: 17, Steps: 9 | Train Loss: 0.010 Vali Loss: 1.422 Vali Acc: 0.833 Test Loss: 1.422 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.7244987487792969
Epoch: 18, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.951 Vali Acc: 0.826 Test Loss: 0.951 Test Acc: 0.826
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.3673901557922363
Epoch: 19, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.514 Vali Acc: 0.833 Test Loss: 1.514 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el5_dm768_df768_ps10_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8405797101449275
model parameter : 36663556
model size : 154.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el5_dm768_df768_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.6061208248138428
Epoch: 1, Steps: 9 | Train Loss: 1.413 Vali Loss: 1.350 Vali Acc: 0.304 Test Loss: 1.350 Test Acc: 0.304
Validation loss decreased (inf --> -0.304334).  Saving model ...
Epoch: 2 cost time: 1.2874782085418701
Epoch: 2, Steps: 9 | Train Loss: 1.248 Vali Loss: 1.202 Vali Acc: 0.478 Test Loss: 1.202 Test Acc: 0.478
Validation loss decreased (-0.304334 --> -0.478249).  Saving model ...
Epoch: 3 cost time: 1.4741630554199219
Epoch: 3, Steps: 9 | Train Loss: 1.097 Vali Loss: 1.061 Vali Acc: 0.572 Test Loss: 1.061 Test Acc: 0.572
Validation loss decreased (-0.478249 --> -0.572453).  Saving model ...
Epoch: 4 cost time: 1.4245283603668213
Epoch: 4, Steps: 9 | Train Loss: 0.812 Vali Loss: 0.886 Vali Acc: 0.609 Test Loss: 0.886 Test Acc: 0.609
Validation loss decreased (-0.572453 --> -0.608687).  Saving model ...
Epoch: 5 cost time: 1.2856707572937012
Epoch: 5, Steps: 9 | Train Loss: 0.632 Vali Loss: 0.730 Vali Acc: 0.732 Test Loss: 0.730 Test Acc: 0.732
Validation loss decreased (-0.608687 --> -0.731877).  Saving model ...
Epoch: 6 cost time: 1.4581763744354248
Epoch: 6, Steps: 9 | Train Loss: 0.442 Vali Loss: 0.650 Vali Acc: 0.746 Test Loss: 0.650 Test Acc: 0.746
Validation loss decreased (-0.731877 --> -0.746370).  Saving model ...
Epoch: 7 cost time: 1.336918592453003
Epoch: 7, Steps: 9 | Train Loss: 0.294 Vali Loss: 0.593 Vali Acc: 0.746 Test Loss: 0.593 Test Acc: 0.746
Validation loss decreased (-0.746370 --> -0.746371).  Saving model ...
Epoch: 8 cost time: 1.566420078277588
Epoch: 8, Steps: 9 | Train Loss: 0.223 Vali Loss: 0.543 Vali Acc: 0.819 Test Loss: 0.543 Test Acc: 0.819
Validation loss decreased (-0.746371 --> -0.818835).  Saving model ...
Epoch: 9 cost time: 1.4215927124023438
Epoch: 9, Steps: 9 | Train Loss: 0.140 Vali Loss: 0.762 Vali Acc: 0.819 Test Loss: 0.762 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.9908411502838135
Epoch: 10, Steps: 9 | Train Loss: 0.086 Vali Loss: 0.605 Vali Acc: 0.797 Test Loss: 0.605 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.6680855751037598
Epoch: 11, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.672 Vali Acc: 0.870 Test Loss: 0.672 Test Acc: 0.870
Validation loss decreased (-0.818835 --> -0.869559).  Saving model ...
Epoch: 12 cost time: 1.2628083229064941
Epoch: 12, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.841 Vali Acc: 0.841 Test Loss: 0.841 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.837259292602539
Epoch: 13, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.650 Vali Acc: 0.841 Test Loss: 0.650 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.711141586303711
Epoch: 14, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.875 Vali Acc: 0.848 Test Loss: 0.875 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.3726894855499268
Epoch: 15, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.813 Vali Acc: 0.862 Test Loss: 0.813 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.3356654644012451
Epoch: 16, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.880 Vali Acc: 0.841 Test Loss: 0.880 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.9775972366333008
Epoch: 17, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.805 Vali Acc: 0.855 Test Loss: 0.805 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.826310634613037
Epoch: 18, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.741 Vali Acc: 0.855 Test Loss: 0.741 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.4704840183258057
Epoch: 19, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.788 Vali Acc: 0.862 Test Loss: 0.788 Test Acc: 0.862
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.734220266342163
Epoch: 20, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.813 Vali Acc: 0.862 Test Loss: 0.813 Test Acc: 0.862
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.8312678337097168
Epoch: 21, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.865 Vali Acc: 0.855 Test Loss: 0.865 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el5_dm768_df768_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8695652173913043
model parameter : 36543748
model size : 154.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el5_dm768_df768_ps10_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.6754150390625
Epoch: 1, Steps: 9 | Train Loss: 1.421 Vali Loss: 1.363 Vali Acc: 0.304 Test Loss: 1.363 Test Acc: 0.304
Validation loss decreased (inf --> -0.304334).  Saving model ...
Epoch: 2 cost time: 1.2120115756988525
Epoch: 2, Steps: 9 | Train Loss: 1.315 Vali Loss: 1.244 Vali Acc: 0.406 Test Loss: 1.244 Test Acc: 0.406
Validation loss decreased (-0.304334 --> -0.405785).  Saving model ...
Epoch: 3 cost time: 1.3037636280059814
Epoch: 3, Steps: 9 | Train Loss: 1.167 Vali Loss: 1.152 Vali Acc: 0.623 Test Loss: 1.152 Test Acc: 0.623
Validation loss decreased (-0.405785 --> -0.623177).  Saving model ...
Epoch: 4 cost time: 1.370223045349121
Epoch: 4, Steps: 9 | Train Loss: 1.011 Vali Loss: 1.019 Vali Acc: 0.580 Test Loss: 1.019 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3519039154052734
Epoch: 5, Steps: 9 | Train Loss: 0.818 Vali Loss: 0.915 Vali Acc: 0.587 Test Loss: 0.915 Test Acc: 0.587
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.281769037246704
Epoch: 6, Steps: 9 | Train Loss: 0.672 Vali Loss: 0.832 Vali Acc: 0.696 Test Loss: 0.832 Test Acc: 0.696
Validation loss decreased (-0.623177 --> -0.695644).  Saving model ...
Epoch: 7 cost time: 1.184009075164795
Epoch: 7, Steps: 9 | Train Loss: 0.533 Vali Loss: 0.710 Vali Acc: 0.768 Test Loss: 0.710 Test Acc: 0.768
Validation loss decreased (-0.695644 --> -0.768109).  Saving model ...
Epoch: 8 cost time: 1.008392572402954
Epoch: 8, Steps: 9 | Train Loss: 0.378 Vali Loss: 0.741 Vali Acc: 0.761 Test Loss: 0.741 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4145886898040771
Epoch: 9, Steps: 9 | Train Loss: 0.259 Vali Loss: 0.608 Vali Acc: 0.819 Test Loss: 0.608 Test Acc: 0.819
Validation loss decreased (-0.768109 --> -0.818834).  Saving model ...
Epoch: 10 cost time: 1.7837934494018555
Epoch: 10, Steps: 9 | Train Loss: 0.196 Vali Loss: 0.615 Vali Acc: 0.848 Test Loss: 0.615 Test Acc: 0.848
Validation loss decreased (-0.818834 --> -0.847820).  Saving model ...
Epoch: 11 cost time: 1.5267977714538574
Epoch: 11, Steps: 9 | Train Loss: 0.128 Vali Loss: 0.615 Vali Acc: 0.841 Test Loss: 0.615 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3056354522705078
Epoch: 12, Steps: 9 | Train Loss: 0.069 Vali Loss: 0.606 Vali Acc: 0.812 Test Loss: 0.606 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.3911025524139404
Epoch: 13, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.824 Vali Acc: 0.790 Test Loss: 0.824 Test Acc: 0.790
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.006941795349121
Epoch: 14, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.683 Vali Acc: 0.833 Test Loss: 0.683 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.7114009857177734
Epoch: 15, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.708 Vali Acc: 0.826 Test Loss: 0.708 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.4376320838928223
Epoch: 16, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.763 Vali Acc: 0.819 Test Loss: 0.763 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.8544807434082031
Epoch: 17, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.702 Vali Acc: 0.826 Test Loss: 0.702 Test Acc: 0.826
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.5378434658050537
Epoch: 18, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.792 Vali Acc: 0.819 Test Loss: 0.792 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.938345193862915
Epoch: 19, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.765 Vali Acc: 0.833 Test Loss: 0.765 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.1225800514221191
Epoch: 20, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.754 Vali Acc: 0.826 Test Loss: 0.754 Test Acc: 0.826
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el5_dm768_df768_ps10_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8478260869565217
model parameter : 36451588
model size : 153.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el5_dm768_df768_ps11_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.319796323776245
Epoch: 1, Steps: 9 | Train Loss: 1.343 Vali Loss: 1.225 Vali Acc: 0.319 Test Loss: 1.225 Test Acc: 0.319
Validation loss decreased (inf --> -0.318828).  Saving model ...
Epoch: 2 cost time: 1.937027931213379
Epoch: 2, Steps: 9 | Train Loss: 1.064 Vali Loss: 1.012 Vali Acc: 0.536 Test Loss: 1.012 Test Acc: 0.536
Validation loss decreased (-0.318828 --> -0.536222).  Saving model ...
Epoch: 3 cost time: 1.7796080112457275
Epoch: 3, Steps: 9 | Train Loss: 0.832 Vali Loss: 0.863 Vali Acc: 0.630 Test Loss: 0.863 Test Acc: 0.630
Validation loss decreased (-0.536222 --> -0.630426).  Saving model ...
Epoch: 4 cost time: 2.1636881828308105
Epoch: 4, Steps: 9 | Train Loss: 0.630 Vali Loss: 0.673 Vali Acc: 0.783 Test Loss: 0.673 Test Acc: 0.783
Validation loss decreased (-0.630426 --> -0.782602).  Saving model ...
Epoch: 5 cost time: 1.846350908279419
Epoch: 5, Steps: 9 | Train Loss: 0.427 Vali Loss: 0.674 Vali Acc: 0.710 Test Loss: 0.674 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3625829219818115
Epoch: 6, Steps: 9 | Train Loss: 0.299 Vali Loss: 0.594 Vali Acc: 0.746 Test Loss: 0.594 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.5077941417694092
Epoch: 7, Steps: 9 | Train Loss: 0.165 Vali Loss: 0.857 Vali Acc: 0.739 Test Loss: 0.857 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.730851411819458
Epoch: 8, Steps: 9 | Train Loss: 0.153 Vali Loss: 0.553 Vali Acc: 0.812 Test Loss: 0.553 Test Acc: 0.812
Validation loss decreased (-0.782602 --> -0.811589).  Saving model ...
Epoch: 9 cost time: 2.603403091430664
Epoch: 9, Steps: 9 | Train Loss: 0.148 Vali Loss: 0.841 Vali Acc: 0.681 Test Loss: 0.841 Test Acc: 0.681
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.9358282089233398
Epoch: 10, Steps: 9 | Train Loss: 0.053 Vali Loss: 0.481 Vali Acc: 0.833 Test Loss: 0.481 Test Acc: 0.833
Validation loss decreased (-0.811589 --> -0.833329).  Saving model ...
Epoch: 11 cost time: 2.33571195602417
Epoch: 11, Steps: 9 | Train Loss: 0.078 Vali Loss: 0.760 Vali Acc: 0.841 Test Loss: 0.760 Test Acc: 0.841
Validation loss decreased (-0.833329 --> -0.840572).  Saving model ...
Epoch: 12 cost time: 2.045628786087036
Epoch: 12, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.759 Vali Acc: 0.826 Test Loss: 0.759 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.0053517818450928
Epoch: 13, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.437 Vali Acc: 0.884 Test Loss: 0.437 Test Acc: 0.884
Validation loss decreased (-0.840572 --> -0.884054).  Saving model ...
Epoch: 14 cost time: 1.9884309768676758
Epoch: 14, Steps: 9 | Train Loss: 0.005 Vali Loss: 1.011 Vali Acc: 0.819 Test Loss: 1.011 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.6729018688201904
Epoch: 15, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.684 Vali Acc: 0.819 Test Loss: 0.684 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.8595390319824219
Epoch: 16, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.728 Vali Acc: 0.819 Test Loss: 0.728 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.82328200340271
Epoch: 17, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.807 Vali Acc: 0.833 Test Loss: 0.807 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.970531940460205
Epoch: 18, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.725 Vali Acc: 0.855 Test Loss: 0.725 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.2864928245544434
Epoch: 19, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.701 Vali Acc: 0.862 Test Loss: 0.701 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.2983758449554443
Epoch: 20, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.744 Vali Acc: 0.855 Test Loss: 0.744 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.734083652496338
Epoch: 21, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.790 Vali Acc: 0.855 Test Loss: 0.790 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.9728567600250244
Epoch: 22, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.822 Vali Acc: 0.855 Test Loss: 0.822 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.257711887359619
Epoch: 23, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.826 Vali Acc: 0.855 Test Loss: 0.826 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el5_dm768_df768_ps11_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8840579710144928
model parameter : 36670468
model size : 154.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el5_dm768_df768_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.9427950382232666
Epoch: 1, Steps: 9 | Train Loss: 1.413 Vali Loss: 1.293 Vali Acc: 0.355 Test Loss: 1.293 Test Acc: 0.355
Validation loss decreased (inf --> -0.355060).  Saving model ...
Epoch: 2 cost time: 2.091456413269043
Epoch: 2, Steps: 9 | Train Loss: 1.277 Vali Loss: 1.147 Vali Acc: 0.514 Test Loss: 1.147 Test Acc: 0.514
Validation loss decreased (-0.355060 --> -0.514481).  Saving model ...
Epoch: 3 cost time: 1.623642921447754
Epoch: 3, Steps: 9 | Train Loss: 1.021 Vali Loss: 1.001 Vali Acc: 0.514 Test Loss: 1.001 Test Acc: 0.514
Validation loss decreased (-0.514481 --> -0.514483).  Saving model ...
Epoch: 4 cost time: 1.2955501079559326
Epoch: 4, Steps: 9 | Train Loss: 0.874 Vali Loss: 0.897 Vali Acc: 0.609 Test Loss: 0.897 Test Acc: 0.609
Validation loss decreased (-0.514483 --> -0.608687).  Saving model ...
Epoch: 5 cost time: 1.2759814262390137
Epoch: 5, Steps: 9 | Train Loss: 0.712 Vali Loss: 0.798 Vali Acc: 0.674 Test Loss: 0.798 Test Acc: 0.674
Validation loss decreased (-0.608687 --> -0.673905).  Saving model ...
Epoch: 6 cost time: 1.5264222621917725
Epoch: 6, Steps: 9 | Train Loss: 0.570 Vali Loss: 0.687 Vali Acc: 0.710 Test Loss: 0.687 Test Acc: 0.710
Validation loss decreased (-0.673905 --> -0.710138).  Saving model ...
Epoch: 7 cost time: 1.4647316932678223
Epoch: 7, Steps: 9 | Train Loss: 0.394 Vali Loss: 0.626 Vali Acc: 0.761 Test Loss: 0.626 Test Acc: 0.761
Validation loss decreased (-0.710138 --> -0.760863).  Saving model ...
Epoch: 8 cost time: 1.3379969596862793
Epoch: 8, Steps: 9 | Train Loss: 0.285 Vali Loss: 0.567 Vali Acc: 0.746 Test Loss: 0.567 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5725593566894531
Epoch: 9, Steps: 9 | Train Loss: 0.234 Vali Loss: 0.872 Vali Acc: 0.703 Test Loss: 0.872 Test Acc: 0.703
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.7362234592437744
Epoch: 10, Steps: 9 | Train Loss: 0.118 Vali Loss: 0.578 Vali Acc: 0.812 Test Loss: 0.578 Test Acc: 0.812
Validation loss decreased (-0.760863 --> -0.811588).  Saving model ...
Epoch: 11 cost time: 1.5084459781646729
Epoch: 11, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.544 Vali Acc: 0.812 Test Loss: 0.544 Test Acc: 0.812
Validation loss decreased (-0.811588 --> -0.811589).  Saving model ...
Epoch: 12 cost time: 1.0687949657440186
Epoch: 12, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.947 Vali Acc: 0.790 Test Loss: 0.947 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2979345321655273
Epoch: 13, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.946 Vali Acc: 0.775 Test Loss: 0.946 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.596846580505371
Epoch: 14, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.721 Vali Acc: 0.833 Test Loss: 0.721 Test Acc: 0.833
Validation loss decreased (-0.811589 --> -0.833326).  Saving model ...
Epoch: 15 cost time: 1.8802886009216309
Epoch: 15, Steps: 9 | Train Loss: 0.019 Vali Loss: 1.000 Vali Acc: 0.790 Test Loss: 1.000 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.7361490726470947
Epoch: 16, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.662 Vali Acc: 0.848 Test Loss: 0.662 Test Acc: 0.848
Validation loss decreased (-0.833326 --> -0.847819).  Saving model ...
Epoch: 17 cost time: 1.9717788696289062
Epoch: 17, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.969 Vali Acc: 0.812 Test Loss: 0.969 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.933638572692871
Epoch: 18, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.843 Vali Acc: 0.819 Test Loss: 0.843 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.1272146701812744
Epoch: 19, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.831 Vali Acc: 0.841 Test Loss: 0.831 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.1362783908843994
Epoch: 20, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.886 Vali Acc: 0.819 Test Loss: 0.886 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.497549057006836
Epoch: 21, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.903 Vali Acc: 0.819 Test Loss: 0.903 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.9357268810272217
Epoch: 22, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.889 Vali Acc: 0.826 Test Loss: 0.889 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.954667329788208
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.827 Vali Acc: 0.848 Test Loss: 0.827 Test Acc: 0.848
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.7075021266937256
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.823 Vali Acc: 0.848 Test Loss: 0.823 Test Acc: 0.848
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.0309462547302246
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.062 Vali Acc: 0.804 Test Loss: 1.062 Test Acc: 0.804
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.122648239135742
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.866 Vali Acc: 0.855 Test Loss: 0.866 Test Acc: 0.855
Validation loss decreased (-0.847819 --> -0.855064).  Saving model ...
Epoch: 27 cost time: 1.9105045795440674
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.880 Vali Acc: 0.855 Test Loss: 0.880 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.7309606075286865
Epoch: 28, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.990 Vali Acc: 0.819 Test Loss: 0.990 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.8124265670776367
Epoch: 29, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.940 Vali Acc: 0.826 Test Loss: 0.940 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.9590423107147217
Epoch: 30, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.862 Vali Acc: 0.862 Test Loss: 0.862 Test Acc: 0.862
Validation loss decreased (-0.855064 --> -0.862310).  Saving model ...
Epoch: 31 cost time: 1.5296123027801514
Epoch: 31, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.842 Vali Acc: 0.855 Test Loss: 0.842 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.848301649093628
Epoch: 32, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.879 Vali Acc: 0.862 Test Loss: 0.879 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.5171194076538086
Epoch: 33, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.917 Vali Acc: 0.855 Test Loss: 0.917 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 2.4050486087799072
Epoch: 34, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.949 Vali Acc: 0.848 Test Loss: 0.949 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.5652120113372803
Epoch: 35, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.940 Vali Acc: 0.855 Test Loss: 0.940 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.3642256259918213
Epoch: 36, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.922 Vali Acc: 0.862 Test Loss: 0.922 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.7998418807983398
Epoch: 37, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.913 Vali Acc: 0.862 Test Loss: 0.913 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 2.086249589920044
Epoch: 38, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.909 Vali Acc: 0.862 Test Loss: 0.909 Test Acc: 0.862
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.870910406112671
Epoch: 39, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.904 Vali Acc: 0.855 Test Loss: 0.904 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 2.2796225547790527
Epoch: 40, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.914 Vali Acc: 0.855 Test Loss: 0.914 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el5_dm768_df768_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8623188405797102
model parameter : 36518404
model size : 153.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el5_dm768_df768_ps11_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.943420171737671
Epoch: 1, Steps: 9 | Train Loss: 1.454 Vali Loss: 1.391 Vali Acc: 0.246 Test Loss: 1.391 Test Acc: 0.246
Validation loss decreased (inf --> -0.246363).  Saving model ...
Epoch: 2 cost time: 1.6961617469787598
Epoch: 2, Steps: 9 | Train Loss: 1.322 Vali Loss: 1.265 Vali Acc: 0.435 Test Loss: 1.265 Test Acc: 0.435
Validation loss decreased (-0.246363 --> -0.434770).  Saving model ...
Epoch: 3 cost time: 1.7104358673095703
Epoch: 3, Steps: 9 | Train Loss: 1.187 Vali Loss: 1.128 Vali Acc: 0.522 Test Loss: 1.128 Test Acc: 0.522
Validation loss decreased (-0.434770 --> -0.521728).  Saving model ...
Epoch: 4 cost time: 1.29166579246521
Epoch: 4, Steps: 9 | Train Loss: 1.014 Vali Loss: 1.016 Vali Acc: 0.536 Test Loss: 1.016 Test Acc: 0.536
Validation loss decreased (-0.521728 --> -0.536222).  Saving model ...
Epoch: 5 cost time: 1.2504208087921143
Epoch: 5, Steps: 9 | Train Loss: 0.885 Vali Loss: 0.943 Vali Acc: 0.638 Test Loss: 0.943 Test Acc: 0.638
Validation loss decreased (-0.536222 --> -0.637672).  Saving model ...
Epoch: 6 cost time: 1.636929988861084
Epoch: 6, Steps: 9 | Train Loss: 0.730 Vali Loss: 0.810 Vali Acc: 0.652 Test Loss: 0.810 Test Acc: 0.652
Validation loss decreased (-0.637672 --> -0.652166).  Saving model ...
Epoch: 7 cost time: 1.0843133926391602
Epoch: 7, Steps: 9 | Train Loss: 0.623 Vali Loss: 0.719 Vali Acc: 0.696 Test Loss: 0.719 Test Acc: 0.696
Validation loss decreased (-0.652166 --> -0.695645).  Saving model ...
Epoch: 8 cost time: 1.1094987392425537
Epoch: 8, Steps: 9 | Train Loss: 0.473 Vali Loss: 0.619 Vali Acc: 0.739 Test Loss: 0.619 Test Acc: 0.739
Validation loss decreased (-0.695645 --> -0.739124).  Saving model ...
Epoch: 9 cost time: 1.402224063873291
Epoch: 9, Steps: 9 | Train Loss: 0.345 Vali Loss: 0.681 Vali Acc: 0.725 Test Loss: 0.681 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4293458461761475
Epoch: 10, Steps: 9 | Train Loss: 0.273 Vali Loss: 0.556 Vali Acc: 0.783 Test Loss: 0.556 Test Acc: 0.783
Validation loss decreased (-0.739124 --> -0.782603).  Saving model ...
Epoch: 11 cost time: 1.6022298336029053
Epoch: 11, Steps: 9 | Train Loss: 0.213 Vali Loss: 0.635 Vali Acc: 0.754 Test Loss: 0.635 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.7780475616455078
Epoch: 12, Steps: 9 | Train Loss: 0.117 Vali Loss: 0.580 Vali Acc: 0.826 Test Loss: 0.580 Test Acc: 0.826
Validation loss decreased (-0.782603 --> -0.826081).  Saving model ...
Epoch: 13 cost time: 1.7559118270874023
Epoch: 13, Steps: 9 | Train Loss: 0.086 Vali Loss: 0.601 Vali Acc: 0.804 Test Loss: 0.601 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2855355739593506
Epoch: 14, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.621 Vali Acc: 0.790 Test Loss: 0.621 Test Acc: 0.790
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.1739628314971924
Epoch: 15, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.752 Vali Acc: 0.783 Test Loss: 0.752 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.6416044235229492
Epoch: 16, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.619 Vali Acc: 0.790 Test Loss: 0.619 Test Acc: 0.790
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.9955697059631348
Epoch: 17, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.857 Vali Acc: 0.768 Test Loss: 0.857 Test Acc: 0.768
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.9350194931030273
Epoch: 18, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.720 Vali Acc: 0.790 Test Loss: 0.720 Test Acc: 0.790
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.0482394695281982
Epoch: 19, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.635 Vali Acc: 0.783 Test Loss: 0.635 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.8904297351837158
Epoch: 20, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.751 Vali Acc: 0.783 Test Loss: 0.751 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.8419020175933838
Epoch: 21, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.799 Vali Acc: 0.804 Test Loss: 0.799 Test Acc: 0.804
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.7965340614318848
Epoch: 22, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.930 Vali Acc: 0.790 Test Loss: 0.930 Test Acc: 0.790
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el5_dm768_df768_ps11_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8260869565217391
model parameter : 36449284
model size : 153.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el5_dm768_df768_ps12_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.68502402305603
Epoch: 1, Steps: 9 | Train Loss: 1.471 Vali Loss: 1.288 Vali Acc: 0.478 Test Loss: 1.288 Test Acc: 0.478
Validation loss decreased (inf --> -0.478248).  Saving model ...
Epoch: 2 cost time: 2.7269644737243652
Epoch: 2, Steps: 9 | Train Loss: 1.192 Vali Loss: 1.084 Vali Acc: 0.580 Test Loss: 1.084 Test Acc: 0.580
Validation loss decreased (-0.478248 --> -0.579699).  Saving model ...
Epoch: 3 cost time: 2.6519253253936768
Epoch: 3, Steps: 9 | Train Loss: 0.879 Vali Loss: 0.876 Vali Acc: 0.594 Test Loss: 0.876 Test Acc: 0.594
Validation loss decreased (-0.579699 --> -0.594194).  Saving model ...
Epoch: 4 cost time: 2.410982131958008
Epoch: 4, Steps: 9 | Train Loss: 0.640 Vali Loss: 1.091 Vali Acc: 0.587 Test Loss: 1.091 Test Acc: 0.587
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.0954694747924805
Epoch: 5, Steps: 9 | Train Loss: 0.615 Vali Loss: 0.696 Vali Acc: 0.688 Test Loss: 0.696 Test Acc: 0.688
Validation loss decreased (-0.594194 --> -0.688399).  Saving model ...
Epoch: 6 cost time: 2.7567715644836426
Epoch: 6, Steps: 9 | Train Loss: 0.429 Vali Loss: 0.925 Vali Acc: 0.652 Test Loss: 0.925 Test Acc: 0.652
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.6761739253997803
Epoch: 7, Steps: 9 | Train Loss: 0.222 Vali Loss: 0.506 Vali Acc: 0.812 Test Loss: 0.506 Test Acc: 0.812
Validation loss decreased (-0.688399 --> -0.811589).  Saving model ...
Epoch: 8 cost time: 2.354433536529541
Epoch: 8, Steps: 9 | Train Loss: 0.131 Vali Loss: 0.915 Vali Acc: 0.732 Test Loss: 0.915 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.2171669006347656
Epoch: 9, Steps: 9 | Train Loss: 0.121 Vali Loss: 0.691 Vali Acc: 0.812 Test Loss: 0.691 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.977168083190918
Epoch: 10, Steps: 9 | Train Loss: 0.057 Vali Loss: 0.701 Vali Acc: 0.870 Test Loss: 0.701 Test Acc: 0.870
Validation loss decreased (-0.811589 --> -0.869558).  Saving model ...
Epoch: 11 cost time: 2.4399616718292236
Epoch: 11, Steps: 9 | Train Loss: 0.017 Vali Loss: 1.096 Vali Acc: 0.717 Test Loss: 1.096 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.3452906608581543
Epoch: 12, Steps: 9 | Train Loss: 0.010 Vali Loss: 1.236 Vali Acc: 0.855 Test Loss: 1.236 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.3936820030212402
Epoch: 13, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.790 Vali Acc: 0.862 Test Loss: 0.790 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.420825958251953
Epoch: 14, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.896 Vali Acc: 0.855 Test Loss: 0.896 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.814577102661133
Epoch: 15, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.208 Vali Acc: 0.826 Test Loss: 1.208 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.7741620540618896
Epoch: 16, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.033 Vali Acc: 0.848 Test Loss: 1.033 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.7578444480895996
Epoch: 17, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.945 Vali Acc: 0.870 Test Loss: 0.945 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.1580123901367188
Epoch: 18, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.949 Vali Acc: 0.804 Test Loss: 0.949 Test Acc: 0.804
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.388105869293213
Epoch: 19, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.755 Vali Acc: 0.862 Test Loss: 0.755 Test Acc: 0.862
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.2175188064575195
Epoch: 20, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.812 Vali Acc: 0.870 Test Loss: 0.812 Test Acc: 0.870
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el5_dm768_df768_ps12_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8695652173913043
model parameter : 36672772
model size : 154.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el5_dm768_df768_ps12_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.736161947250366
Epoch: 1, Steps: 9 | Train Loss: 1.397 Vali Loss: 1.350 Vali Acc: 0.312 Test Loss: 1.350 Test Acc: 0.312
Validation loss decreased (inf --> -0.311581).  Saving model ...
Epoch: 2 cost time: 1.8812038898468018
Epoch: 2, Steps: 9 | Train Loss: 1.243 Vali Loss: 1.158 Vali Acc: 0.514 Test Loss: 1.158 Test Acc: 0.514
Validation loss decreased (-0.311581 --> -0.514481).  Saving model ...
Epoch: 3 cost time: 1.4353306293487549
Epoch: 3, Steps: 9 | Train Loss: 1.067 Vali Loss: 1.020 Vali Acc: 0.652 Test Loss: 1.020 Test Acc: 0.652
Validation loss decreased (-0.514481 --> -0.652164).  Saving model ...
Epoch: 4 cost time: 1.7470672130584717
Epoch: 4, Steps: 9 | Train Loss: 0.874 Vali Loss: 0.886 Vali Acc: 0.645 Test Loss: 0.886 Test Acc: 0.645
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3470783233642578
Epoch: 5, Steps: 9 | Train Loss: 0.726 Vali Loss: 0.806 Vali Acc: 0.674 Test Loss: 0.806 Test Acc: 0.674
Validation loss decreased (-0.652164 --> -0.673905).  Saving model ...
Epoch: 6 cost time: 2.41206955909729
Epoch: 6, Steps: 9 | Train Loss: 0.533 Vali Loss: 0.710 Vali Acc: 0.696 Test Loss: 0.710 Test Acc: 0.696
Validation loss decreased (-0.673905 --> -0.695645).  Saving model ...
Epoch: 7 cost time: 2.349229574203491
Epoch: 7, Steps: 9 | Train Loss: 0.360 Vali Loss: 0.644 Vali Acc: 0.746 Test Loss: 0.644 Test Acc: 0.746
Validation loss decreased (-0.695645 --> -0.746370).  Saving model ...
Epoch: 8 cost time: 1.9518101215362549
Epoch: 8, Steps: 9 | Train Loss: 0.253 Vali Loss: 0.758 Vali Acc: 0.717 Test Loss: 0.758 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8609671592712402
Epoch: 9, Steps: 9 | Train Loss: 0.140 Vali Loss: 0.939 Vali Acc: 0.761 Test Loss: 0.939 Test Acc: 0.761
Validation loss decreased (-0.746370 --> -0.760860).  Saving model ...
Epoch: 10 cost time: 2.2769007682800293
Epoch: 10, Steps: 9 | Train Loss: 0.073 Vali Loss: 0.642 Vali Acc: 0.761 Test Loss: 0.642 Test Acc: 0.761
Validation loss decreased (-0.760860 --> -0.760863).  Saving model ...
Epoch: 11 cost time: 2.390624761581421
Epoch: 11, Steps: 9 | Train Loss: 0.063 Vali Loss: 1.041 Vali Acc: 0.725 Test Loss: 1.041 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.9195234775543213
Epoch: 12, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.883 Vali Acc: 0.804 Test Loss: 0.883 Test Acc: 0.804
Validation loss decreased (-0.760863 --> -0.804339).  Saving model ...
Epoch: 13 cost time: 2.7366716861724854
Epoch: 13, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.965 Vali Acc: 0.754 Test Loss: 0.965 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.1269688606262207
Epoch: 14, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.988 Vali Acc: 0.804 Test Loss: 0.988 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.1116578578948975
Epoch: 15, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.866 Vali Acc: 0.812 Test Loss: 0.866 Test Acc: 0.812
Validation loss decreased (-0.804339 --> -0.811586).  Saving model ...
Epoch: 16 cost time: 2.656022787094116
Epoch: 16, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.844 Vali Acc: 0.833 Test Loss: 0.844 Test Acc: 0.833
Validation loss decreased (-0.811586 --> -0.833325).  Saving model ...
Epoch: 17 cost time: 2.3807458877563477
Epoch: 17, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.207 Vali Acc: 0.790 Test Loss: 1.207 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.2155823707580566
Epoch: 18, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.797 Vali Acc: 0.826 Test Loss: 0.797 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.563490629196167
Epoch: 19, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.854 Vali Acc: 0.833 Test Loss: 0.854 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.642670154571533
Epoch: 20, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.013 Vali Acc: 0.804 Test Loss: 1.013 Test Acc: 0.804
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.0443902015686035
Epoch: 21, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.060 Vali Acc: 0.804 Test Loss: 1.060 Test Acc: 0.804
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.4589884281158447
Epoch: 22, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.997 Vali Acc: 0.797 Test Loss: 0.997 Test Acc: 0.797
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.8068628311157227
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.034 Vali Acc: 0.812 Test Loss: 1.034 Test Acc: 0.812
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 3.0171875953674316
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.924 Vali Acc: 0.841 Test Loss: 0.924 Test Acc: 0.841
Validation loss decreased (-0.833325 --> -0.840570).  Saving model ...
Epoch: 25 cost time: 2.9472062587738037
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.930 Vali Acc: 0.833 Test Loss: 0.930 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.6324470043182373
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.048 Vali Acc: 0.812 Test Loss: 1.048 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.348090887069702
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.038 Vali Acc: 0.804 Test Loss: 1.038 Test Acc: 0.804
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.7414541244506836
Epoch: 28, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.001 Vali Acc: 0.819 Test Loss: 1.001 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.159574270248413
Epoch: 29, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.998 Vali Acc: 0.819 Test Loss: 0.998 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.1677708625793457
Epoch: 30, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.988 Vali Acc: 0.819 Test Loss: 0.988 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 2.4926466941833496
Epoch: 31, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.982 Vali Acc: 0.826 Test Loss: 0.982 Test Acc: 0.826
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.5452382564544678
Epoch: 32, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.991 Vali Acc: 0.819 Test Loss: 0.991 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.698455572128296
Epoch: 33, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.019 Vali Acc: 0.804 Test Loss: 1.019 Test Acc: 0.804
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.6158866882324219
Epoch: 34, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.046 Vali Acc: 0.812 Test Loss: 1.046 Test Acc: 0.812
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el5_dm768_df768_ps12_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8405797101449275
model parameter : 36525316
model size : 154.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el5_dm768_df768_ps12_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.6290957927703857
Epoch: 1, Steps: 9 | Train Loss: 1.461 Vali Loss: 1.399 Vali Acc: 0.232 Test Loss: 1.399 Test Acc: 0.232
Validation loss decreased (inf --> -0.231870).  Saving model ...
Epoch: 2 cost time: 1.954254150390625
Epoch: 2, Steps: 9 | Train Loss: 1.342 Vali Loss: 1.279 Vali Acc: 0.464 Test Loss: 1.279 Test Acc: 0.464
Validation loss decreased (-0.231870 --> -0.463755).  Saving model ...
Epoch: 3 cost time: 1.1216392517089844
Epoch: 3, Steps: 9 | Train Loss: 1.214 Vali Loss: 1.149 Vali Acc: 0.572 Test Loss: 1.149 Test Acc: 0.572
Validation loss decreased (-0.463755 --> -0.572452).  Saving model ...
Epoch: 4 cost time: 1.3745057582855225
Epoch: 4, Steps: 9 | Train Loss: 1.066 Vali Loss: 1.032 Vali Acc: 0.601 Test Loss: 1.032 Test Acc: 0.601
Validation loss decreased (-0.572452 --> -0.601439).  Saving model ...
Epoch: 5 cost time: 2.272604465484619
Epoch: 5, Steps: 9 | Train Loss: 0.950 Vali Loss: 0.928 Vali Acc: 0.659 Test Loss: 0.928 Test Acc: 0.659
Validation loss decreased (-0.601439 --> -0.659411).  Saving model ...
Epoch: 6 cost time: 1.641958236694336
Epoch: 6, Steps: 9 | Train Loss: 0.781 Vali Loss: 0.883 Vali Acc: 0.630 Test Loss: 0.883 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5989909172058105
Epoch: 7, Steps: 9 | Train Loss: 0.642 Vali Loss: 0.761 Vali Acc: 0.696 Test Loss: 0.761 Test Acc: 0.696
Validation loss decreased (-0.659411 --> -0.695645).  Saving model ...
Epoch: 8 cost time: 1.5957934856414795
Epoch: 8, Steps: 9 | Train Loss: 0.463 Vali Loss: 0.839 Vali Acc: 0.645 Test Loss: 0.839 Test Acc: 0.645
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.9153110980987549
Epoch: 9, Steps: 9 | Train Loss: 0.421 Vali Loss: 0.734 Vali Acc: 0.703 Test Loss: 0.734 Test Acc: 0.703
Validation loss decreased (-0.695645 --> -0.702891).  Saving model ...
Epoch: 10 cost time: 1.6930105686187744
Epoch: 10, Steps: 9 | Train Loss: 0.266 Vali Loss: 0.865 Vali Acc: 0.696 Test Loss: 0.865 Test Acc: 0.696
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5900602340698242
Epoch: 11, Steps: 9 | Train Loss: 0.227 Vali Loss: 0.748 Vali Acc: 0.674 Test Loss: 0.748 Test Acc: 0.674
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.4115891456604004
Epoch: 12, Steps: 9 | Train Loss: 0.138 Vali Loss: 0.947 Vali Acc: 0.761 Test Loss: 0.947 Test Acc: 0.761
Validation loss decreased (-0.702891 --> -0.760860).  Saving model ...
Epoch: 13 cost time: 1.703718900680542
Epoch: 13, Steps: 9 | Train Loss: 0.092 Vali Loss: 0.762 Vali Acc: 0.746 Test Loss: 0.762 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.193511962890625
Epoch: 14, Steps: 9 | Train Loss: 0.063 Vali Loss: 0.768 Vali Acc: 0.768 Test Loss: 0.768 Test Acc: 0.768
Validation loss decreased (-0.760860 --> -0.768108).  Saving model ...
Epoch: 15 cost time: 1.917426586151123
Epoch: 15, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.769 Vali Acc: 0.768 Test Loss: 0.769 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.3022470474243164
Epoch: 16, Steps: 9 | Train Loss: 0.034 Vali Loss: 1.117 Vali Acc: 0.725 Test Loss: 1.117 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.6925480365753174
Epoch: 17, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.653 Vali Acc: 0.826 Test Loss: 0.653 Test Acc: 0.826
Validation loss decreased (-0.768108 --> -0.826080).  Saving model ...
Epoch: 18 cost time: 1.7505824565887451
Epoch: 18, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.875 Vali Acc: 0.804 Test Loss: 0.875 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.1689248085021973
Epoch: 19, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.863 Vali Acc: 0.775 Test Loss: 0.863 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.1847879886627197
Epoch: 20, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.764 Vali Acc: 0.797 Test Loss: 0.764 Test Acc: 0.797
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.166492462158203
Epoch: 21, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.854 Vali Acc: 0.804 Test Loss: 0.854 Test Acc: 0.804
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.227046012878418
Epoch: 22, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.884 Vali Acc: 0.790 Test Loss: 0.884 Test Acc: 0.790
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.1061737537384033
Epoch: 23, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.821 Vali Acc: 0.783 Test Loss: 0.821 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.9419095516204834
Epoch: 24, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.846 Vali Acc: 0.790 Test Loss: 0.846 Test Acc: 0.790
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.9464302062988281
Epoch: 25, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.831 Vali Acc: 0.783 Test Loss: 0.831 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.289804458618164
Epoch: 26, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.822 Vali Acc: 0.804 Test Loss: 0.822 Test Acc: 0.804
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.5671818256378174
Epoch: 27, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.850 Vali Acc: 0.790 Test Loss: 0.850 Test Acc: 0.790
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el5_dm768_df768_ps12_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8260869565217391
model parameter : 36451588
model size : 153.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el5_dm768_df768_ps13_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.9018213748931885
Epoch: 1, Steps: 9 | Train Loss: 1.453 Vali Loss: 1.287 Vali Acc: 0.391 Test Loss: 1.287 Test Acc: 0.391
Validation loss decreased (inf --> -0.391291).  Saving model ...
Epoch: 2 cost time: 2.431417942047119
Epoch: 2, Steps: 9 | Train Loss: 1.283 Vali Loss: 1.095 Vali Acc: 0.580 Test Loss: 1.095 Test Acc: 0.580
Validation loss decreased (-0.391291 --> -0.579699).  Saving model ...
Epoch: 3 cost time: 2.452425956726074
Epoch: 3, Steps: 9 | Train Loss: 0.978 Vali Loss: 0.905 Vali Acc: 0.703 Test Loss: 0.905 Test Acc: 0.703
Validation loss decreased (-0.579699 --> -0.702889).  Saving model ...
Epoch: 4 cost time: 2.5560858249664307
Epoch: 4, Steps: 9 | Train Loss: 0.786 Vali Loss: 0.784 Vali Acc: 0.674 Test Loss: 0.784 Test Acc: 0.674
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.6518125534057617
Epoch: 5, Steps: 9 | Train Loss: 0.632 Vali Loss: 0.714 Vali Acc: 0.674 Test Loss: 0.714 Test Acc: 0.674
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.559309720993042
Epoch: 6, Steps: 9 | Train Loss: 0.467 Vali Loss: 0.698 Vali Acc: 0.754 Test Loss: 0.698 Test Acc: 0.754
Validation loss decreased (-0.702889 --> -0.753616).  Saving model ...
Epoch: 7 cost time: 2.108858823776245
Epoch: 7, Steps: 9 | Train Loss: 0.305 Vali Loss: 0.541 Vali Acc: 0.775 Test Loss: 0.541 Test Acc: 0.775
Validation loss decreased (-0.753616 --> -0.775357).  Saving model ...
Epoch: 8 cost time: 1.8524274826049805
Epoch: 8, Steps: 9 | Train Loss: 0.204 Vali Loss: 0.583 Vali Acc: 0.804 Test Loss: 0.583 Test Acc: 0.804
Validation loss decreased (-0.775357 --> -0.804342).  Saving model ...
Epoch: 9 cost time: 2.0705230236053467
Epoch: 9, Steps: 9 | Train Loss: 0.089 Vali Loss: 0.693 Vali Acc: 0.754 Test Loss: 0.693 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.5174875259399414
Epoch: 10, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.679 Vali Acc: 0.812 Test Loss: 0.679 Test Acc: 0.812
Validation loss decreased (-0.804342 --> -0.811587).  Saving model ...
Epoch: 11 cost time: 2.102006435394287
Epoch: 11, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.717 Vali Acc: 0.841 Test Loss: 0.717 Test Acc: 0.841
Validation loss decreased (-0.811587 --> -0.840573).  Saving model ...
Epoch: 12 cost time: 2.2775304317474365
Epoch: 12, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.458 Vali Acc: 0.884 Test Loss: 0.458 Test Acc: 0.884
Validation loss decreased (-0.840573 --> -0.884053).  Saving model ...
Epoch: 13 cost time: 1.9068801403045654
Epoch: 13, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.856 Vali Acc: 0.826 Test Loss: 0.856 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.789243221282959
Epoch: 14, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.601 Vali Acc: 0.855 Test Loss: 0.601 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.3378190994262695
Epoch: 15, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.953 Vali Acc: 0.826 Test Loss: 0.953 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.191058397293091
Epoch: 16, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.724 Vali Acc: 0.841 Test Loss: 0.724 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.472994327545166
Epoch: 17, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.554 Vali Acc: 0.891 Test Loss: 0.554 Test Acc: 0.891
Validation loss decreased (-0.884053 --> -0.891299).  Saving model ...
Epoch: 18 cost time: 1.991800308227539
Epoch: 18, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.758 Vali Acc: 0.841 Test Loss: 0.758 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.9887292385101318
Epoch: 19, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.816 Vali Acc: 0.841 Test Loss: 0.816 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.9088666439056396
Epoch: 20, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.784 Vali Acc: 0.848 Test Loss: 0.784 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.180953025817871
Epoch: 21, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.831 Vali Acc: 0.848 Test Loss: 0.831 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.3758087158203125
Epoch: 22, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.902 Vali Acc: 0.841 Test Loss: 0.902 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.9415438175201416
Epoch: 23, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.892 Vali Acc: 0.855 Test Loss: 0.892 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.5966007709503174
Epoch: 24, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.843 Vali Acc: 0.862 Test Loss: 0.843 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.4006967544555664
Epoch: 25, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.840 Vali Acc: 0.848 Test Loss: 0.840 Test Acc: 0.848
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.888502836227417
Epoch: 26, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.852 Vali Acc: 0.855 Test Loss: 0.852 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.5543675422668457
Epoch: 27, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.872 Vali Acc: 0.855 Test Loss: 0.872 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el5_dm768_df768_ps13_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8913043478260869
model parameter : 36605956
model size : 154.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el5_dm768_df768_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.2057788372039795
Epoch: 1, Steps: 9 | Train Loss: 1.439 Vali Loss: 1.328 Vali Acc: 0.406 Test Loss: 1.328 Test Acc: 0.406
Validation loss decreased (inf --> -0.405784).  Saving model ...
Epoch: 2 cost time: 1.5742812156677246
Epoch: 2, Steps: 9 | Train Loss: 1.315 Vali Loss: 1.169 Vali Acc: 0.580 Test Loss: 1.169 Test Acc: 0.580
Validation loss decreased (-0.405784 --> -0.579698).  Saving model ...
Epoch: 3 cost time: 2.1738600730895996
Epoch: 3, Steps: 9 | Train Loss: 1.116 Vali Loss: 1.023 Vali Acc: 0.609 Test Loss: 1.023 Test Acc: 0.609
Validation loss decreased (-0.579698 --> -0.608685).  Saving model ...
Epoch: 4 cost time: 2.4288408756256104
Epoch: 4, Steps: 9 | Train Loss: 0.965 Vali Loss: 0.900 Vali Acc: 0.667 Test Loss: 0.900 Test Acc: 0.667
Validation loss decreased (-0.608685 --> -0.666658).  Saving model ...
Epoch: 5 cost time: 2.394470453262329
Epoch: 5, Steps: 9 | Train Loss: 0.756 Vali Loss: 0.809 Vali Acc: 0.667 Test Loss: 0.809 Test Acc: 0.667
Validation loss decreased (-0.666658 --> -0.666659).  Saving model ...
Epoch: 6 cost time: 1.9977214336395264
Epoch: 6, Steps: 9 | Train Loss: 0.570 Vali Loss: 0.698 Vali Acc: 0.725 Test Loss: 0.698 Test Acc: 0.725
Validation loss decreased (-0.666659 --> -0.724631).  Saving model ...
Epoch: 7 cost time: 2.393001079559326
Epoch: 7, Steps: 9 | Train Loss: 0.470 Vali Loss: 0.746 Vali Acc: 0.710 Test Loss: 0.746 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.0186214447021484
Epoch: 8, Steps: 9 | Train Loss: 0.333 Vali Loss: 0.615 Vali Acc: 0.725 Test Loss: 0.615 Test Acc: 0.725
Validation loss decreased (-0.724631 --> -0.724632).  Saving model ...
Epoch: 9 cost time: 2.2061171531677246
Epoch: 9, Steps: 9 | Train Loss: 0.242 Vali Loss: 0.852 Vali Acc: 0.725 Test Loss: 0.852 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.4119458198547363
Epoch: 10, Steps: 9 | Train Loss: 0.150 Vali Loss: 0.549 Vali Acc: 0.812 Test Loss: 0.549 Test Acc: 0.812
Validation loss decreased (-0.724632 --> -0.811589).  Saving model ...
Epoch: 11 cost time: 1.9448914527893066
Epoch: 11, Steps: 9 | Train Loss: 0.091 Vali Loss: 0.686 Vali Acc: 0.797 Test Loss: 0.686 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.6195037364959717
Epoch: 12, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.752 Vali Acc: 0.819 Test Loss: 0.752 Test Acc: 0.819
Validation loss decreased (-0.811589 --> -0.818833).  Saving model ...
Epoch: 13 cost time: 1.8577773571014404
Epoch: 13, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.705 Vali Acc: 0.826 Test Loss: 0.705 Test Acc: 0.826
Validation loss decreased (-0.818833 --> -0.826080).  Saving model ...
Epoch: 14 cost time: 1.7459452152252197
Epoch: 14, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.680 Vali Acc: 0.826 Test Loss: 0.680 Test Acc: 0.826
Validation loss decreased (-0.826080 --> -0.826080).  Saving model ...
Epoch: 15 cost time: 1.833144187927246
Epoch: 15, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.850 Vali Acc: 0.812 Test Loss: 0.850 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.350766897201538
Epoch: 16, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.638 Vali Acc: 0.855 Test Loss: 0.638 Test Acc: 0.855
Validation loss decreased (-0.826080 --> -0.855066).  Saving model ...
Epoch: 17 cost time: 2.315211534500122
Epoch: 17, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.074 Vali Acc: 0.797 Test Loss: 1.074 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.9418182373046875
Epoch: 18, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.905 Vali Acc: 0.826 Test Loss: 0.905 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.018012523651123
Epoch: 19, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.866 Vali Acc: 0.833 Test Loss: 0.866 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.282517671585083
Epoch: 20, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.922 Vali Acc: 0.819 Test Loss: 0.922 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.7824454307556152
Epoch: 21, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.898 Vali Acc: 0.812 Test Loss: 0.898 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.8833885192871094
Epoch: 22, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.855 Vali Acc: 0.812 Test Loss: 0.855 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.2393665313720703
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.878 Vali Acc: 0.819 Test Loss: 0.878 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.6137080192565918
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.929 Vali Acc: 0.812 Test Loss: 0.929 Test Acc: 0.812
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.8268659114837646
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.982 Vali Acc: 0.819 Test Loss: 0.982 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.6755938529968262
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.964 Vali Acc: 0.826 Test Loss: 0.964 Test Acc: 0.826
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el5_dm768_df768_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.855072463768116
model parameter : 36509188
model size : 153.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el5_dm768_df768_ps13_str13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.0462377071380615
Epoch: 1, Steps: 9 | Train Loss: 1.503 Vali Loss: 1.441 Vali Acc: 0.159 Test Loss: 1.441 Test Acc: 0.159
Validation loss decreased (inf --> -0.159406).  Saving model ...
Epoch: 2 cost time: 1.4258077144622803
Epoch: 2, Steps: 9 | Train Loss: 1.359 Vali Loss: 1.303 Vali Acc: 0.348 Test Loss: 1.303 Test Acc: 0.348
Validation loss decreased (-0.159406 --> -0.347813).  Saving model ...
Epoch: 3 cost time: 1.3366854190826416
Epoch: 3, Steps: 9 | Train Loss: 1.269 Vali Loss: 1.181 Vali Acc: 0.580 Test Loss: 1.181 Test Acc: 0.580
Validation loss decreased (-0.347813 --> -0.579698).  Saving model ...
Epoch: 4 cost time: 1.5332815647125244
Epoch: 4, Steps: 9 | Train Loss: 1.086 Vali Loss: 1.066 Vali Acc: 0.580 Test Loss: 1.066 Test Acc: 0.580
Validation loss decreased (-0.579698 --> -0.579699).  Saving model ...
Epoch: 5 cost time: 1.1948399543762207
Epoch: 5, Steps: 9 | Train Loss: 0.969 Vali Loss: 0.972 Vali Acc: 0.609 Test Loss: 0.972 Test Acc: 0.609
Validation loss decreased (-0.579699 --> -0.608686).  Saving model ...
Epoch: 6 cost time: 1.304474115371704
Epoch: 6, Steps: 9 | Train Loss: 0.826 Vali Loss: 0.887 Vali Acc: 0.623 Test Loss: 0.887 Test Acc: 0.623
Validation loss decreased (-0.608686 --> -0.623180).  Saving model ...
Epoch: 7 cost time: 1.6273221969604492
Epoch: 7, Steps: 9 | Train Loss: 0.688 Vali Loss: 0.825 Vali Acc: 0.659 Test Loss: 0.825 Test Acc: 0.659
Validation loss decreased (-0.623180 --> -0.659412).  Saving model ...
Epoch: 8 cost time: 1.2326946258544922
Epoch: 8, Steps: 9 | Train Loss: 0.530 Vali Loss: 0.748 Vali Acc: 0.681 Test Loss: 0.748 Test Acc: 0.681
Validation loss decreased (-0.659412 --> -0.681152).  Saving model ...
Epoch: 9 cost time: 1.2408103942871094
Epoch: 9, Steps: 9 | Train Loss: 0.421 Vali Loss: 0.783 Vali Acc: 0.645 Test Loss: 0.783 Test Acc: 0.645
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1472961902618408
Epoch: 10, Steps: 9 | Train Loss: 0.296 Vali Loss: 0.961 Vali Acc: 0.659 Test Loss: 0.961 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.970440149307251
Epoch: 11, Steps: 9 | Train Loss: 0.197 Vali Loss: 0.568 Vali Acc: 0.790 Test Loss: 0.568 Test Acc: 0.790
Validation loss decreased (-0.681152 --> -0.789849).  Saving model ...
Epoch: 12 cost time: 1.3930754661560059
Epoch: 12, Steps: 9 | Train Loss: 0.136 Vali Loss: 0.959 Vali Acc: 0.681 Test Loss: 0.959 Test Acc: 0.681
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.391063928604126
Epoch: 13, Steps: 9 | Train Loss: 0.135 Vali Loss: 0.676 Vali Acc: 0.783 Test Loss: 0.676 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.2966735363006592
Epoch: 14, Steps: 9 | Train Loss: 0.073 Vali Loss: 0.609 Vali Acc: 0.797 Test Loss: 0.609 Test Acc: 0.797
Validation loss decreased (-0.789849 --> -0.797095).  Saving model ...
Epoch: 15 cost time: 1.7269909381866455
Epoch: 15, Steps: 9 | Train Loss: 0.048 Vali Loss: 0.803 Vali Acc: 0.746 Test Loss: 0.803 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.5104186534881592
Epoch: 16, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.702 Vali Acc: 0.783 Test Loss: 0.702 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.3775207996368408
Epoch: 17, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.693 Vali Acc: 0.812 Test Loss: 0.693 Test Acc: 0.812
Validation loss decreased (-0.797095 --> -0.811587).  Saving model ...
Epoch: 18 cost time: 1.3184993267059326
Epoch: 18, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.856 Vali Acc: 0.754 Test Loss: 0.856 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.7174749374389648
Epoch: 19, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.927 Vali Acc: 0.804 Test Loss: 0.927 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.3885564804077148
Epoch: 20, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.949 Vali Acc: 0.775 Test Loss: 0.949 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.6416985988616943
Epoch: 21, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.770 Vali Acc: 0.797 Test Loss: 0.770 Test Acc: 0.797
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.2263214588165283
Epoch: 22, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.814 Vali Acc: 0.812 Test Loss: 0.814 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.130903720855713
Epoch: 23, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.921 Vali Acc: 0.804 Test Loss: 0.921 Test Acc: 0.804
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.7701706886291504
Epoch: 24, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.736 Vali Acc: 0.819 Test Loss: 0.736 Test Acc: 0.819
Validation loss decreased (-0.811587 --> -0.818833).  Saving model ...
Epoch: 25 cost time: 1.079411268234253
Epoch: 25, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.794 Vali Acc: 0.833 Test Loss: 0.794 Test Acc: 0.833
Validation loss decreased (-0.818833 --> -0.833325).  Saving model ...
Epoch: 26 cost time: 1.2917463779449463
Epoch: 26, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.933 Vali Acc: 0.812 Test Loss: 0.933 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.3092360496520996
Epoch: 27, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.785 Vali Acc: 0.819 Test Loss: 0.785 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.293562650680542
Epoch: 28, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.842 Vali Acc: 0.812 Test Loss: 0.842 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.2620718479156494
Epoch: 29, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.865 Vali Acc: 0.819 Test Loss: 0.865 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.4943625926971436
Epoch: 30, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.783 Vali Acc: 0.841 Test Loss: 0.783 Test Acc: 0.841
Validation loss decreased (-0.833325 --> -0.840572).  Saving model ...
Epoch: 31 cost time: 1.5580518245697021
Epoch: 31, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.801 Vali Acc: 0.819 Test Loss: 0.801 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.2911748886108398
Epoch: 32, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.838 Vali Acc: 0.826 Test Loss: 0.838 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.6436305046081543
Epoch: 33, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.873 Vali Acc: 0.819 Test Loss: 0.873 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.5309898853302002
Epoch: 34, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.809 Vali Acc: 0.826 Test Loss: 0.809 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.5802257061004639
Epoch: 35, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.818 Vali Acc: 0.819 Test Loss: 0.818 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.36916184425354
Epoch: 36, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.865 Vali Acc: 0.812 Test Loss: 0.865 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.5937457084655762
Epoch: 37, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.896 Vali Acc: 0.826 Test Loss: 0.896 Test Acc: 0.826
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.5817883014678955
Epoch: 38, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.868 Vali Acc: 0.826 Test Loss: 0.868 Test Acc: 0.826
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.4550840854644775
Epoch: 39, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.857 Vali Acc: 0.826 Test Loss: 0.857 Test Acc: 0.826
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.0344610214233398
Epoch: 40, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.897 Vali Acc: 0.826 Test Loss: 0.897 Test Acc: 0.826
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el5_dm768_df768_ps13_str13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8405797101449275
model parameter : 36449284
model size : 153.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el5_dm768_df768_ps14_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.839498281478882
Epoch: 1, Steps: 9 | Train Loss: 1.414 Vali Loss: 1.278 Vali Acc: 0.254 Test Loss: 1.278 Test Acc: 0.254
Validation loss decreased (inf --> -0.253610).  Saving model ...
Epoch: 2 cost time: 2.1661362648010254
Epoch: 2, Steps: 9 | Train Loss: 1.228 Vali Loss: 1.071 Vali Acc: 0.565 Test Loss: 1.071 Test Acc: 0.565
Validation loss decreased (-0.253610 --> -0.565207).  Saving model ...
Epoch: 3 cost time: 2.385204315185547
Epoch: 3, Steps: 9 | Train Loss: 0.924 Vali Loss: 0.827 Vali Acc: 0.703 Test Loss: 0.827 Test Acc: 0.703
Validation loss decreased (-0.565207 --> -0.702890).  Saving model ...
Epoch: 4 cost time: 2.680056571960449
Epoch: 4, Steps: 9 | Train Loss: 0.683 Vali Loss: 0.681 Vali Acc: 0.732 Test Loss: 0.681 Test Acc: 0.732
Validation loss decreased (-0.702890 --> -0.731877).  Saving model ...
Epoch: 5 cost time: 2.1732661724090576
Epoch: 5, Steps: 9 | Train Loss: 0.484 Vali Loss: 0.670 Vali Acc: 0.696 Test Loss: 0.670 Test Acc: 0.696
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.9595284461975098
Epoch: 6, Steps: 9 | Train Loss: 0.334 Vali Loss: 0.503 Vali Acc: 0.790 Test Loss: 0.503 Test Acc: 0.790
Validation loss decreased (-0.731877 --> -0.789850).  Saving model ...
Epoch: 7 cost time: 1.8557450771331787
Epoch: 7, Steps: 9 | Train Loss: 0.233 Vali Loss: 0.906 Vali Acc: 0.696 Test Loss: 0.906 Test Acc: 0.696
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.9838824272155762
Epoch: 8, Steps: 9 | Train Loss: 0.144 Vali Loss: 0.524 Vali Acc: 0.848 Test Loss: 0.524 Test Acc: 0.848
Validation loss decreased (-0.789850 --> -0.847821).  Saving model ...
Epoch: 9 cost time: 2.619187831878662
Epoch: 9, Steps: 9 | Train Loss: 0.095 Vali Loss: 0.878 Vali Acc: 0.725 Test Loss: 0.878 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.7046151161193848
Epoch: 10, Steps: 9 | Train Loss: 0.070 Vali Loss: 0.665 Vali Acc: 0.833 Test Loss: 0.665 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.3338358402252197
Epoch: 11, Steps: 9 | Train Loss: 0.052 Vali Loss: 0.629 Vali Acc: 0.812 Test Loss: 0.629 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.2882790565490723
Epoch: 12, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.713 Vali Acc: 0.833 Test Loss: 0.713 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.3120479583740234
Epoch: 13, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.860 Vali Acc: 0.819 Test Loss: 0.860 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.9651856422424316
Epoch: 14, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.795 Vali Acc: 0.826 Test Loss: 0.795 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.8492045402526855
Epoch: 15, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.662 Vali Acc: 0.855 Test Loss: 0.662 Test Acc: 0.855
Validation loss decreased (-0.847821 --> -0.855066).  Saving model ...
Epoch: 16 cost time: 2.700927257537842
Epoch: 16, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.898 Vali Acc: 0.812 Test Loss: 0.898 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.075985908508301
Epoch: 17, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.843 Vali Acc: 0.855 Test Loss: 0.843 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.8624234199523926
Epoch: 18, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.778 Vali Acc: 0.870 Test Loss: 0.778 Test Acc: 0.870
Validation loss decreased (-0.855066 --> -0.869557).  Saving model ...
Epoch: 19 cost time: 2.8562309741973877
Epoch: 19, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.701 Vali Acc: 0.884 Test Loss: 0.701 Test Acc: 0.884
Validation loss decreased (-0.869557 --> -0.884051).  Saving model ...
Epoch: 20 cost time: 2.3742923736572266
Epoch: 20, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.861 Vali Acc: 0.841 Test Loss: 0.861 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.480558156967163
Epoch: 21, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.951 Vali Acc: 0.833 Test Loss: 0.951 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.09897518157959
Epoch: 22, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.680 Vali Acc: 0.884 Test Loss: 0.680 Test Acc: 0.884
Validation loss decreased (-0.884051 --> -0.884051).  Saving model ...
Epoch: 23 cost time: 2.187195062637329
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.747 Vali Acc: 0.870 Test Loss: 0.747 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.424988269805908
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.843 Vali Acc: 0.862 Test Loss: 0.843 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.365506887435913
Epoch: 25, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.910 Vali Acc: 0.862 Test Loss: 0.910 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.5781359672546387
Epoch: 26, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.890 Vali Acc: 0.855 Test Loss: 0.890 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.230801582336426
Epoch: 27, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.860 Vali Acc: 0.862 Test Loss: 0.860 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.488741874694824
Epoch: 28, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.849 Vali Acc: 0.862 Test Loss: 0.849 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 2.4051296710968018
Epoch: 29, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.826 Vali Acc: 0.870 Test Loss: 0.826 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 2.5162882804870605
Epoch: 30, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.842 Vali Acc: 0.870 Test Loss: 0.842 Test Acc: 0.870
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 2.1583709716796875
Epoch: 31, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.872 Vali Acc: 0.862 Test Loss: 0.872 Test Acc: 0.862
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 2.6026790142059326
Epoch: 32, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.877 Vali Acc: 0.862 Test Loss: 0.877 Test Acc: 0.862
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el5_dm768_df768_ps14_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8840579710144928
model parameter : 36612868
model size : 154.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el5_dm768_df768_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.3299801349639893
Epoch: 1, Steps: 9 | Train Loss: 1.500 Vali Loss: 1.349 Vali Acc: 0.362 Test Loss: 1.349 Test Acc: 0.362
Validation loss decreased (inf --> -0.362305).  Saving model ...
Epoch: 2 cost time: 2.210491895675659
Epoch: 2, Steps: 9 | Train Loss: 1.279 Vali Loss: 1.157 Vali Acc: 0.464 Test Loss: 1.157 Test Acc: 0.464
Validation loss decreased (-0.362305 --> -0.463757).  Saving model ...
Epoch: 3 cost time: 1.7355377674102783
Epoch: 3, Steps: 9 | Train Loss: 1.092 Vali Loss: 0.988 Vali Acc: 0.638 Test Loss: 0.988 Test Acc: 0.638
Validation loss decreased (-0.463757 --> -0.637671).  Saving model ...
Epoch: 4 cost time: 1.5649440288543701
Epoch: 4, Steps: 9 | Train Loss: 0.892 Vali Loss: 0.854 Vali Acc: 0.681 Test Loss: 0.854 Test Acc: 0.681
Validation loss decreased (-0.637671 --> -0.681151).  Saving model ...
Epoch: 5 cost time: 1.8175122737884521
Epoch: 5, Steps: 9 | Train Loss: 0.731 Vali Loss: 0.772 Vali Acc: 0.703 Test Loss: 0.772 Test Acc: 0.703
Validation loss decreased (-0.681151 --> -0.702891).  Saving model ...
Epoch: 6 cost time: 1.278585433959961
Epoch: 6, Steps: 9 | Train Loss: 0.610 Vali Loss: 0.793 Vali Acc: 0.681 Test Loss: 0.793 Test Acc: 0.681
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.270484209060669
Epoch: 7, Steps: 9 | Train Loss: 0.402 Vali Loss: 0.606 Vali Acc: 0.754 Test Loss: 0.606 Test Acc: 0.754
Validation loss decreased (-0.702891 --> -0.753617).  Saving model ...
Epoch: 8 cost time: 0.9298686981201172
Epoch: 8, Steps: 9 | Train Loss: 0.289 Vali Loss: 0.588 Vali Acc: 0.761 Test Loss: 0.588 Test Acc: 0.761
Validation loss decreased (-0.753617 --> -0.760864).  Saving model ...
Epoch: 9 cost time: 2.1430671215057373
Epoch: 9, Steps: 9 | Train Loss: 0.225 Vali Loss: 0.793 Vali Acc: 0.681 Test Loss: 0.793 Test Acc: 0.681
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.8205068111419678
Epoch: 10, Steps: 9 | Train Loss: 0.124 Vali Loss: 0.827 Vali Acc: 0.833 Test Loss: 0.827 Test Acc: 0.833
Validation loss decreased (-0.760864 --> -0.833325).  Saving model ...
Epoch: 11 cost time: 1.7013390064239502
Epoch: 11, Steps: 9 | Train Loss: 0.080 Vali Loss: 0.774 Vali Acc: 0.739 Test Loss: 0.774 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.329355001449585
Epoch: 12, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.885 Vali Acc: 0.783 Test Loss: 0.885 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.6753418445587158
Epoch: 13, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.724 Vali Acc: 0.826 Test Loss: 0.724 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.614375114440918
Epoch: 14, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.764 Vali Acc: 0.790 Test Loss: 0.764 Test Acc: 0.790
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.354368209838867
Epoch: 15, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.770 Vali Acc: 0.833 Test Loss: 0.770 Test Acc: 0.833
Validation loss decreased (-0.833325 --> -0.833326).  Saving model ...
Epoch: 16 cost time: 2.0337860584259033
Epoch: 16, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.776 Vali Acc: 0.812 Test Loss: 0.776 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.3851287364959717
Epoch: 17, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.730 Vali Acc: 0.833 Test Loss: 0.730 Test Acc: 0.833
Validation loss decreased (-0.833326 --> -0.833326).  Saving model ...
Epoch: 18 cost time: 2.4615461826324463
Epoch: 18, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.953 Vali Acc: 0.819 Test Loss: 0.953 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.1840858459472656
Epoch: 19, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.865 Vali Acc: 0.826 Test Loss: 0.865 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.4216127395629883
Epoch: 20, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.763 Vali Acc: 0.841 Test Loss: 0.763 Test Acc: 0.841
Validation loss decreased (-0.833326 --> -0.840572).  Saving model ...
Epoch: 21 cost time: 2.189042329788208
Epoch: 21, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.832 Vali Acc: 0.833 Test Loss: 0.832 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.5558059215545654
Epoch: 22, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.852 Vali Acc: 0.833 Test Loss: 0.852 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.3472206592559814
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.814 Vali Acc: 0.833 Test Loss: 0.814 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.1371610164642334
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.783 Vali Acc: 0.855 Test Loss: 0.783 Test Acc: 0.855
Validation loss decreased (-0.840572 --> -0.855065).  Saving model ...
Epoch: 25 cost time: 1.9980762004852295
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.797 Vali Acc: 0.841 Test Loss: 0.797 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.9761161804199219
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.816 Vali Acc: 0.841 Test Loss: 0.816 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.0276310443878174
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.839 Vali Acc: 0.833 Test Loss: 0.839 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.102731943130493
Epoch: 28, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.868 Vali Acc: 0.833 Test Loss: 0.868 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.2823150157928467
Epoch: 29, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.847 Vali Acc: 0.833 Test Loss: 0.847 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.6511006355285645
Epoch: 30, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.835 Vali Acc: 0.841 Test Loss: 0.835 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 2.1268296241760254
Epoch: 31, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.839 Vali Acc: 0.841 Test Loss: 0.839 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 2.1664912700653076
Epoch: 32, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.787 Vali Acc: 0.855 Test Loss: 0.787 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 2.241649866104126
Epoch: 33, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.813 Vali Acc: 0.855 Test Loss: 0.813 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 2.3304009437561035
Epoch: 34, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.877 Vali Acc: 0.833 Test Loss: 0.877 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el5_dm768_df768_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.855072463768116
model parameter : 36516100
model size : 153.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el5_dm768_df768_ps14_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.5078699588775635
Epoch: 1, Steps: 9 | Train Loss: 1.405 Vali Loss: 1.350 Vali Acc: 0.333 Test Loss: 1.350 Test Acc: 0.333
Validation loss decreased (inf --> -0.333320).  Saving model ...
Epoch: 2 cost time: 1.5088918209075928
Epoch: 2, Steps: 9 | Train Loss: 1.307 Vali Loss: 1.240 Vali Acc: 0.486 Test Loss: 1.240 Test Acc: 0.486
Validation loss decreased (-0.333320 --> -0.485495).  Saving model ...
Epoch: 3 cost time: 1.436636209487915
Epoch: 3, Steps: 9 | Train Loss: 1.205 Vali Loss: 1.126 Vali Acc: 0.572 Test Loss: 1.126 Test Acc: 0.572
Validation loss decreased (-0.485495 --> -0.572453).  Saving model ...
Epoch: 4 cost time: 1.191418170928955
Epoch: 4, Steps: 9 | Train Loss: 1.062 Vali Loss: 1.045 Vali Acc: 0.609 Test Loss: 1.045 Test Acc: 0.609
Validation loss decreased (-0.572453 --> -0.608685).  Saving model ...
Epoch: 5 cost time: 1.5252573490142822
Epoch: 5, Steps: 9 | Train Loss: 0.930 Vali Loss: 0.909 Vali Acc: 0.674 Test Loss: 0.909 Test Acc: 0.674
Validation loss decreased (-0.608685 --> -0.673904).  Saving model ...
Epoch: 6 cost time: 1.5285089015960693
Epoch: 6, Steps: 9 | Train Loss: 0.835 Vali Loss: 0.795 Vali Acc: 0.732 Test Loss: 0.795 Test Acc: 0.732
Validation loss decreased (-0.673904 --> -0.731876).  Saving model ...
Epoch: 7 cost time: 1.5514426231384277
Epoch: 7, Steps: 9 | Train Loss: 0.622 Vali Loss: 0.762 Vali Acc: 0.688 Test Loss: 0.762 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6317756175994873
Epoch: 8, Steps: 9 | Train Loss: 0.507 Vali Loss: 0.684 Vali Acc: 0.732 Test Loss: 0.684 Test Acc: 0.732
Validation loss decreased (-0.731876 --> -0.731877).  Saving model ...
Epoch: 9 cost time: 1.593287706375122
Epoch: 9, Steps: 9 | Train Loss: 0.370 Vali Loss: 0.729 Vali Acc: 0.703 Test Loss: 0.729 Test Acc: 0.703
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3617825508117676
Epoch: 10, Steps: 9 | Train Loss: 0.318 Vali Loss: 0.576 Vali Acc: 0.775 Test Loss: 0.576 Test Acc: 0.775
Validation loss decreased (-0.731877 --> -0.775357).  Saving model ...
Epoch: 11 cost time: 1.429349660873413
Epoch: 11, Steps: 9 | Train Loss: 0.214 Vali Loss: 0.714 Vali Acc: 0.739 Test Loss: 0.714 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2938570976257324
Epoch: 12, Steps: 9 | Train Loss: 0.146 Vali Loss: 0.627 Vali Acc: 0.768 Test Loss: 0.627 Test Acc: 0.768
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.4695725440979004
Epoch: 13, Steps: 9 | Train Loss: 0.095 Vali Loss: 0.768 Vali Acc: 0.768 Test Loss: 0.768 Test Acc: 0.768
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.659954309463501
Epoch: 14, Steps: 9 | Train Loss: 0.055 Vali Loss: 0.715 Vali Acc: 0.783 Test Loss: 0.715 Test Acc: 0.783
Validation loss decreased (-0.775357 --> -0.782602).  Saving model ...
Epoch: 15 cost time: 1.365586757659912
Epoch: 15, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.703 Vali Acc: 0.804 Test Loss: 0.703 Test Acc: 0.804
Validation loss decreased (-0.782602 --> -0.804341).  Saving model ...
Epoch: 16 cost time: 1.0753328800201416
Epoch: 16, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.760 Vali Acc: 0.790 Test Loss: 0.760 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.5494105815887451
Epoch: 17, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.673 Vali Acc: 0.790 Test Loss: 0.673 Test Acc: 0.790
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.1915485858917236
Epoch: 18, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.689 Vali Acc: 0.841 Test Loss: 0.689 Test Acc: 0.841
Validation loss decreased (-0.804341 --> -0.840573).  Saving model ...
Epoch: 19 cost time: 1.1580734252929688
Epoch: 19, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.880 Vali Acc: 0.797 Test Loss: 0.880 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0191528797149658
Epoch: 20, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.531 Vali Acc: 0.819 Test Loss: 0.531 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.1896157264709473
Epoch: 21, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.858 Vali Acc: 0.812 Test Loss: 0.858 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.6539387702941895
Epoch: 22, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.751 Vali Acc: 0.812 Test Loss: 0.751 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.2837610244750977
Epoch: 23, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.886 Vali Acc: 0.797 Test Loss: 0.886 Test Acc: 0.797
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.6420283317565918
Epoch: 24, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.742 Vali Acc: 0.833 Test Loss: 0.742 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.4359009265899658
Epoch: 25, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.777 Vali Acc: 0.833 Test Loss: 0.777 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.572479248046875
Epoch: 26, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.780 Vali Acc: 0.833 Test Loss: 0.780 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.3380765914916992
Epoch: 27, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.758 Vali Acc: 0.819 Test Loss: 0.758 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.5411319732666016
Epoch: 28, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.777 Vali Acc: 0.833 Test Loss: 0.777 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el5_dm768_df768_ps14_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8405797101449275
model parameter : 36451588
model size : 153.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el5_dm768_df768_ps15_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 5.104693651199341
Epoch: 1, Steps: 9 | Train Loss: 1.464 Vali Loss: 1.346 Vali Acc: 0.326 Test Loss: 1.346 Test Acc: 0.326
Validation loss decreased (inf --> -0.326073).  Saving model ...
Epoch: 2 cost time: 2.5327224731445312
Epoch: 2, Steps: 9 | Train Loss: 1.200 Vali Loss: 1.115 Vali Acc: 0.623 Test Loss: 1.115 Test Acc: 0.623
Validation loss decreased (-0.326073 --> -0.623177).  Saving model ...
Epoch: 3 cost time: 2.846712827682495
Epoch: 3, Steps: 9 | Train Loss: 0.977 Vali Loss: 0.945 Vali Acc: 0.580 Test Loss: 0.945 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.6024951934814453
Epoch: 4, Steps: 9 | Train Loss: 0.760 Vali Loss: 0.796 Vali Acc: 0.739 Test Loss: 0.796 Test Acc: 0.739
Validation loss decreased (-0.623177 --> -0.739122).  Saving model ...
Epoch: 5 cost time: 2.44826078414917
Epoch: 5, Steps: 9 | Train Loss: 0.581 Vali Loss: 0.731 Vali Acc: 0.710 Test Loss: 0.731 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.5497071743011475
Epoch: 6, Steps: 9 | Train Loss: 0.449 Vali Loss: 0.728 Vali Acc: 0.703 Test Loss: 0.728 Test Acc: 0.703
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.4259164333343506
Epoch: 7, Steps: 9 | Train Loss: 0.318 Vali Loss: 0.718 Vali Acc: 0.725 Test Loss: 0.718 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.1942155361175537
Epoch: 8, Steps: 9 | Train Loss: 0.307 Vali Loss: 0.665 Vali Acc: 0.761 Test Loss: 0.665 Test Acc: 0.761
Validation loss decreased (-0.739122 --> -0.760863).  Saving model ...
Epoch: 9 cost time: 2.023022174835205
Epoch: 9, Steps: 9 | Train Loss: 0.162 Vali Loss: 0.596 Vali Acc: 0.819 Test Loss: 0.596 Test Acc: 0.819
Validation loss decreased (-0.760863 --> -0.818835).  Saving model ...
Epoch: 10 cost time: 2.338407516479492
Epoch: 10, Steps: 9 | Train Loss: 0.110 Vali Loss: 0.595 Vali Acc: 0.790 Test Loss: 0.595 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.9842519760131836
Epoch: 11, Steps: 9 | Train Loss: 0.104 Vali Loss: 0.916 Vali Acc: 0.812 Test Loss: 0.916 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.3993136882781982
Epoch: 12, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.805 Vali Acc: 0.855 Test Loss: 0.805 Test Acc: 0.855
Validation loss decreased (-0.818835 --> -0.855064).  Saving model ...
Epoch: 13 cost time: 2.8729264736175537
Epoch: 13, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.804 Vali Acc: 0.819 Test Loss: 0.804 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.615658760070801
Epoch: 14, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.669 Vali Acc: 0.819 Test Loss: 0.669 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.619830369949341
Epoch: 15, Steps: 9 | Train Loss: 0.018 Vali Loss: 1.145 Vali Acc: 0.797 Test Loss: 1.145 Test Acc: 0.797
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.0795509815216064
Epoch: 16, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.784 Vali Acc: 0.797 Test Loss: 0.784 Test Acc: 0.797
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.173341989517212
Epoch: 17, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.122 Vali Acc: 0.812 Test Loss: 1.122 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.1641602516174316
Epoch: 18, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.224 Vali Acc: 0.819 Test Loss: 1.224 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.6905088424682617
Epoch: 19, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.330 Vali Acc: 0.783 Test Loss: 1.330 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.174717903137207
Epoch: 20, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.915 Vali Acc: 0.848 Test Loss: 0.915 Test Acc: 0.848
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.8680109977722168
Epoch: 21, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.882 Vali Acc: 0.848 Test Loss: 0.882 Test Acc: 0.848
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.9964120388031006
Epoch: 22, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.950 Vali Acc: 0.841 Test Loss: 0.950 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el5_dm768_df768_ps15_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.855072463768116
model parameter : 36615172
model size : 154.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el5_dm768_df768_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.463812828063965
Epoch: 1, Steps: 9 | Train Loss: 1.429 Vali Loss: 1.339 Vali Acc: 0.319 Test Loss: 1.339 Test Acc: 0.319
Validation loss decreased (inf --> -0.318827).  Saving model ...
Epoch: 2 cost time: 1.8813340663909912
Epoch: 2, Steps: 9 | Train Loss: 1.324 Vali Loss: 1.194 Vali Acc: 0.514 Test Loss: 1.194 Test Acc: 0.514
Validation loss decreased (-0.318827 --> -0.514481).  Saving model ...
Epoch: 3 cost time: 1.974090576171875
Epoch: 3, Steps: 9 | Train Loss: 1.120 Vali Loss: 1.093 Vali Acc: 0.572 Test Loss: 1.093 Test Acc: 0.572
Validation loss decreased (-0.514481 --> -0.572453).  Saving model ...
Epoch: 4 cost time: 1.8086209297180176
Epoch: 4, Steps: 9 | Train Loss: 0.952 Vali Loss: 0.954 Vali Acc: 0.674 Test Loss: 0.954 Test Acc: 0.674
Validation loss decreased (-0.572453 --> -0.673903).  Saving model ...
Epoch: 5 cost time: 2.5359692573547363
Epoch: 5, Steps: 9 | Train Loss: 0.801 Vali Loss: 0.830 Vali Acc: 0.630 Test Loss: 0.830 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.810225486755371
Epoch: 6, Steps: 9 | Train Loss: 0.612 Vali Loss: 0.744 Vali Acc: 0.725 Test Loss: 0.744 Test Acc: 0.725
Validation loss decreased (-0.673903 --> -0.724630).  Saving model ...
Epoch: 7 cost time: 1.7922284603118896
Epoch: 7, Steps: 9 | Train Loss: 0.461 Vali Loss: 0.670 Vali Acc: 0.732 Test Loss: 0.670 Test Acc: 0.732
Validation loss decreased (-0.724630 --> -0.731877).  Saving model ...
Epoch: 8 cost time: 1.8628172874450684
Epoch: 8, Steps: 9 | Train Loss: 0.331 Vali Loss: 0.644 Vali Acc: 0.732 Test Loss: 0.644 Test Acc: 0.732
Validation loss decreased (-0.731877 --> -0.731878).  Saving model ...
Epoch: 9 cost time: 1.1111977100372314
Epoch: 9, Steps: 9 | Train Loss: 0.225 Vali Loss: 0.803 Vali Acc: 0.775 Test Loss: 0.803 Test Acc: 0.775
Validation loss decreased (-0.731878 --> -0.775354).  Saving model ...
Epoch: 10 cost time: 1.9123766422271729
Epoch: 10, Steps: 9 | Train Loss: 0.181 Vali Loss: 0.573 Vali Acc: 0.775 Test Loss: 0.573 Test Acc: 0.775
Validation loss decreased (-0.775354 --> -0.775357).  Saving model ...
Epoch: 11 cost time: 2.2386457920074463
Epoch: 11, Steps: 9 | Train Loss: 0.087 Vali Loss: 0.858 Vali Acc: 0.797 Test Loss: 0.858 Test Acc: 0.797
Validation loss decreased (-0.775357 --> -0.797093).  Saving model ...
Epoch: 12 cost time: 2.443730592727661
Epoch: 12, Steps: 9 | Train Loss: 0.077 Vali Loss: 0.690 Vali Acc: 0.812 Test Loss: 0.690 Test Acc: 0.812
Validation loss decreased (-0.797093 --> -0.811587).  Saving model ...
Epoch: 13 cost time: 1.691270351409912
Epoch: 13, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.709 Vali Acc: 0.826 Test Loss: 0.709 Test Acc: 0.826
Validation loss decreased (-0.811587 --> -0.826080).  Saving model ...
Epoch: 14 cost time: 1.9409549236297607
Epoch: 14, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.710 Vali Acc: 0.826 Test Loss: 0.710 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.9262123107910156
Epoch: 15, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.771 Vali Acc: 0.819 Test Loss: 0.771 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.642803192138672
Epoch: 16, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.652 Vali Acc: 0.841 Test Loss: 0.652 Test Acc: 0.841
Validation loss decreased (-0.826080 --> -0.840573).  Saving model ...
Epoch: 17 cost time: 2.3784754276275635
Epoch: 17, Steps: 9 | Train Loss: 0.008 Vali Loss: 1.045 Vali Acc: 0.826 Test Loss: 1.045 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.456817626953125
Epoch: 18, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.564 Vali Acc: 0.855 Test Loss: 0.564 Test Acc: 0.855
Validation loss decreased (-0.840573 --> -0.855067).  Saving model ...
Epoch: 19 cost time: 2.4438881874084473
Epoch: 19, Steps: 9 | Train Loss: 0.007 Vali Loss: 1.006 Vali Acc: 0.841 Test Loss: 1.006 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.349431037902832
Epoch: 20, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.737 Vali Acc: 0.841 Test Loss: 0.737 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.6409244537353516
Epoch: 21, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.664 Vali Acc: 0.841 Test Loss: 0.664 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.2888782024383545
Epoch: 22, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.930 Vali Acc: 0.848 Test Loss: 0.930 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.445441484451294
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.972 Vali Acc: 0.848 Test Loss: 0.972 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.97048020362854
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.879 Vali Acc: 0.848 Test Loss: 0.879 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.8872134685516357
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.909 Vali Acc: 0.855 Test Loss: 0.909 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.000838279724121
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.927 Vali Acc: 0.848 Test Loss: 0.927 Test Acc: 0.848
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.5795857906341553
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.912 Vali Acc: 0.848 Test Loss: 0.912 Test Acc: 0.848
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.9694876670837402
Epoch: 28, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.908 Vali Acc: 0.848 Test Loss: 0.908 Test Acc: 0.848
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el5_dm768_df768_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.855072463768116
model parameter : 36504580
model size : 153.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el5_dm768_df768_ps15_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.7793827056884766
Epoch: 1, Steps: 9 | Train Loss: 1.393 Vali Loss: 1.346 Vali Acc: 0.290 Test Loss: 1.346 Test Acc: 0.290
Validation loss decreased (inf --> -0.289842).  Saving model ...
Epoch: 2 cost time: 1.6659190654754639
Epoch: 2, Steps: 9 | Train Loss: 1.330 Vali Loss: 1.270 Vali Acc: 0.442 Test Loss: 1.270 Test Acc: 0.442
Validation loss decreased (-0.289842 --> -0.442016).  Saving model ...
Epoch: 3 cost time: 1.1025114059448242
Epoch: 3, Steps: 9 | Train Loss: 1.184 Vali Loss: 1.160 Vali Acc: 0.551 Test Loss: 1.160 Test Acc: 0.551
Validation loss decreased (-0.442016 --> -0.550713).  Saving model ...
Epoch: 4 cost time: 1.2887763977050781
Epoch: 4, Steps: 9 | Train Loss: 1.082 Vali Loss: 1.055 Vali Acc: 0.616 Test Loss: 1.055 Test Acc: 0.616
Validation loss decreased (-0.550713 --> -0.615931).  Saving model ...
Epoch: 5 cost time: 1.2664456367492676
Epoch: 5, Steps: 9 | Train Loss: 0.930 Vali Loss: 0.953 Vali Acc: 0.601 Test Loss: 0.953 Test Acc: 0.601
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1882259845733643
Epoch: 6, Steps: 9 | Train Loss: 0.752 Vali Loss: 0.912 Vali Acc: 0.630 Test Loss: 0.912 Test Acc: 0.630
Validation loss decreased (-0.615931 --> -0.630426).  Saving model ...
Epoch: 7 cost time: 1.381767749786377
Epoch: 7, Steps: 9 | Train Loss: 0.638 Vali Loss: 0.771 Vali Acc: 0.696 Test Loss: 0.771 Test Acc: 0.696
Validation loss decreased (-0.630426 --> -0.695644).  Saving model ...
Epoch: 8 cost time: 1.5120201110839844
Epoch: 8, Steps: 9 | Train Loss: 0.484 Vali Loss: 0.734 Vali Acc: 0.659 Test Loss: 0.734 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2707817554473877
Epoch: 9, Steps: 9 | Train Loss: 0.373 Vali Loss: 0.708 Vali Acc: 0.732 Test Loss: 0.708 Test Acc: 0.732
Validation loss decreased (-0.695644 --> -0.731877).  Saving model ...
Epoch: 10 cost time: 1.5180919170379639
Epoch: 10, Steps: 9 | Train Loss: 0.259 Vali Loss: 0.640 Vali Acc: 0.746 Test Loss: 0.640 Test Acc: 0.746
Validation loss decreased (-0.731877 --> -0.746370).  Saving model ...
Epoch: 11 cost time: 1.216637372970581
Epoch: 11, Steps: 9 | Train Loss: 0.181 Vali Loss: 0.695 Vali Acc: 0.754 Test Loss: 0.695 Test Acc: 0.754
Validation loss decreased (-0.746370 --> -0.753616).  Saving model ...
Epoch: 12 cost time: 1.0776355266571045
Epoch: 12, Steps: 9 | Train Loss: 0.133 Vali Loss: 0.651 Vali Acc: 0.746 Test Loss: 0.651 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2442245483398438
Epoch: 13, Steps: 9 | Train Loss: 0.088 Vali Loss: 0.596 Vali Acc: 0.783 Test Loss: 0.596 Test Acc: 0.783
Validation loss decreased (-0.753616 --> -0.782603).  Saving model ...
Epoch: 14 cost time: 1.0425479412078857
Epoch: 14, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.795 Vali Acc: 0.775 Test Loss: 0.795 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9329128265380859
Epoch: 15, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.718 Vali Acc: 0.790 Test Loss: 0.718 Test Acc: 0.790
Validation loss decreased (-0.782603 --> -0.789848).  Saving model ...
Epoch: 16 cost time: 1.1233935356140137
Epoch: 16, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.857 Vali Acc: 0.790 Test Loss: 0.857 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9324319362640381
Epoch: 17, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.721 Vali Acc: 0.797 Test Loss: 0.721 Test Acc: 0.797
Validation loss decreased (-0.789848 --> -0.797094).  Saving model ...
Epoch: 18 cost time: 1.0053977966308594
Epoch: 18, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.856 Vali Acc: 0.783 Test Loss: 0.856 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2509198188781738
Epoch: 19, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.810 Vali Acc: 0.797 Test Loss: 0.810 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.3206093311309814
Epoch: 20, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.798 Vali Acc: 0.797 Test Loss: 0.798 Test Acc: 0.797
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.4365425109863281
Epoch: 21, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.876 Vali Acc: 0.797 Test Loss: 0.876 Test Acc: 0.797
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.2529969215393066
Epoch: 22, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.783 Vali Acc: 0.819 Test Loss: 0.783 Test Acc: 0.819
Validation loss decreased (-0.797094 --> -0.818833).  Saving model ...
Epoch: 23 cost time: 1.2077581882476807
Epoch: 23, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.800 Vali Acc: 0.797 Test Loss: 0.800 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.3451957702636719
Epoch: 24, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.815 Vali Acc: 0.797 Test Loss: 0.815 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.2533652782440186
Epoch: 25, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.846 Vali Acc: 0.819 Test Loss: 0.846 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.4842162132263184
Epoch: 26, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.851 Vali Acc: 0.812 Test Loss: 0.851 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.326296329498291
Epoch: 27, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.878 Vali Acc: 0.812 Test Loss: 0.878 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.297295093536377
Epoch: 28, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.902 Vali Acc: 0.819 Test Loss: 0.902 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.557264804840088
Epoch: 29, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.847 Vali Acc: 0.812 Test Loss: 0.847 Test Acc: 0.812
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.162205457687378
Epoch: 30, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.870 Vali Acc: 0.804 Test Loss: 0.870 Test Acc: 0.804
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.2156519889831543
Epoch: 31, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.879 Vali Acc: 0.812 Test Loss: 0.879 Test Acc: 0.812
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.3446857929229736
Epoch: 32, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.876 Vali Acc: 0.812 Test Loss: 0.876 Test Acc: 0.812
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el5_dm768_df768_ps15_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8188405797101449
model parameter : 36453892
model size : 153.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el5_dm768_df768_ps16_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.569222450256348
Epoch: 1, Steps: 9 | Train Loss: 1.408 Vali Loss: 1.306 Vali Acc: 0.290 Test Loss: 1.306 Test Acc: 0.290
Validation loss decreased (inf --> -0.289842).  Saving model ...
Epoch: 2 cost time: 2.4546315670013428
Epoch: 2, Steps: 9 | Train Loss: 1.196 Vali Loss: 1.085 Vali Acc: 0.616 Test Loss: 1.085 Test Acc: 0.616
Validation loss decreased (-0.289842 --> -0.615931).  Saving model ...
Epoch: 3 cost time: 2.454698324203491
Epoch: 3, Steps: 9 | Train Loss: 0.964 Vali Loss: 0.904 Vali Acc: 0.616 Test Loss: 0.904 Test Acc: 0.616
Validation loss decreased (-0.615931 --> -0.615933).  Saving model ...
Epoch: 4 cost time: 2.3216474056243896
Epoch: 4, Steps: 9 | Train Loss: 0.735 Vali Loss: 0.885 Vali Acc: 0.587 Test Loss: 0.885 Test Acc: 0.587
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.0011231899261475
Epoch: 5, Steps: 9 | Train Loss: 0.575 Vali Loss: 0.634 Vali Acc: 0.739 Test Loss: 0.634 Test Acc: 0.739
Validation loss decreased (-0.615933 --> -0.739124).  Saving model ...
Epoch: 6 cost time: 2.4201507568359375
Epoch: 6, Steps: 9 | Train Loss: 0.386 Vali Loss: 0.716 Vali Acc: 0.674 Test Loss: 0.716 Test Acc: 0.674
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6251306533813477
Epoch: 7, Steps: 9 | Train Loss: 0.291 Vali Loss: 0.499 Vali Acc: 0.826 Test Loss: 0.499 Test Acc: 0.826
Validation loss decreased (-0.739124 --> -0.826082).  Saving model ...
Epoch: 8 cost time: 2.1481220722198486
Epoch: 8, Steps: 9 | Train Loss: 0.183 Vali Loss: 0.497 Vali Acc: 0.790 Test Loss: 0.497 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.095486640930176
Epoch: 9, Steps: 9 | Train Loss: 0.112 Vali Loss: 0.673 Vali Acc: 0.812 Test Loss: 0.673 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.9800570011138916
Epoch: 10, Steps: 9 | Train Loss: 0.067 Vali Loss: 0.573 Vali Acc: 0.841 Test Loss: 0.573 Test Acc: 0.841
Validation loss decreased (-0.826082 --> -0.840574).  Saving model ...
Epoch: 11 cost time: 2.7604029178619385
Epoch: 11, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.761 Vali Acc: 0.746 Test Loss: 0.761 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.009748697280884
Epoch: 12, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.805 Vali Acc: 0.833 Test Loss: 0.805 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.7870163917541504
Epoch: 13, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.756 Vali Acc: 0.833 Test Loss: 0.756 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.141291379928589
Epoch: 14, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.969 Vali Acc: 0.812 Test Loss: 0.969 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.352970838546753
Epoch: 15, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.746 Vali Acc: 0.855 Test Loss: 0.746 Test Acc: 0.855
Validation loss decreased (-0.840574 --> -0.855065).  Saving model ...
Epoch: 16 cost time: 1.6562142372131348
Epoch: 16, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.930 Vali Acc: 0.819 Test Loss: 0.930 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.8262355327606201
Epoch: 17, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.973 Vali Acc: 0.826 Test Loss: 0.973 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.6949462890625
Epoch: 18, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.835 Vali Acc: 0.855 Test Loss: 0.835 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.170086622238159
Epoch: 19, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.930 Vali Acc: 0.819 Test Loss: 0.930 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.6272714138031006
Epoch: 20, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.957 Vali Acc: 0.826 Test Loss: 0.957 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.431565523147583
Epoch: 21, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.873 Vali Acc: 0.841 Test Loss: 0.873 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.7377936840057373
Epoch: 22, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.772 Vali Acc: 0.848 Test Loss: 0.772 Test Acc: 0.848
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.107544422149658
Epoch: 23, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.808 Vali Acc: 0.848 Test Loss: 0.808 Test Acc: 0.848
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.8700902462005615
Epoch: 24, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.877 Vali Acc: 0.848 Test Loss: 0.877 Test Acc: 0.848
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.7116851806640625
Epoch: 25, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.881 Vali Acc: 0.848 Test Loss: 0.881 Test Acc: 0.848
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el5_dm768_df768_ps16_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.855072463768116
model parameter : 36622084
model size : 154.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el5_dm768_df768_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.122490406036377
Epoch: 1, Steps: 9 | Train Loss: 1.365 Vali Loss: 1.270 Vali Acc: 0.413 Test Loss: 1.270 Test Acc: 0.413
Validation loss decreased (inf --> -0.413031).  Saving model ...
Epoch: 2 cost time: 1.4232699871063232
Epoch: 2, Steps: 9 | Train Loss: 1.232 Vali Loss: 1.140 Vali Acc: 0.507 Test Loss: 1.140 Test Acc: 0.507
Validation loss decreased (-0.413031 --> -0.507235).  Saving model ...
Epoch: 3 cost time: 1.8843300342559814
Epoch: 3, Steps: 9 | Train Loss: 1.082 Vali Loss: 0.993 Vali Acc: 0.601 Test Loss: 0.993 Test Acc: 0.601
Validation loss decreased (-0.507235 --> -0.601439).  Saving model ...
Epoch: 4 cost time: 2.0055110454559326
Epoch: 4, Steps: 9 | Train Loss: 0.906 Vali Loss: 0.888 Vali Acc: 0.638 Test Loss: 0.888 Test Acc: 0.638
Validation loss decreased (-0.601439 --> -0.637672).  Saving model ...
Epoch: 5 cost time: 1.61582350730896
Epoch: 5, Steps: 9 | Train Loss: 0.759 Vali Loss: 0.809 Vali Acc: 0.659 Test Loss: 0.809 Test Acc: 0.659
Validation loss decreased (-0.637672 --> -0.659412).  Saving model ...
Epoch: 6 cost time: 2.079500198364258
Epoch: 6, Steps: 9 | Train Loss: 0.591 Vali Loss: 0.694 Vali Acc: 0.688 Test Loss: 0.694 Test Acc: 0.688
Validation loss decreased (-0.659412 --> -0.688399).  Saving model ...
Epoch: 7 cost time: 1.8963901996612549
Epoch: 7, Steps: 9 | Train Loss: 0.430 Vali Loss: 0.700 Vali Acc: 0.674 Test Loss: 0.700 Test Acc: 0.674
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.028059720993042
Epoch: 8, Steps: 9 | Train Loss: 0.328 Vali Loss: 0.542 Vali Acc: 0.775 Test Loss: 0.542 Test Acc: 0.775
Validation loss decreased (-0.688399 --> -0.775357).  Saving model ...
Epoch: 9 cost time: 1.8528532981872559
Epoch: 9, Steps: 9 | Train Loss: 0.264 Vali Loss: 0.498 Vali Acc: 0.804 Test Loss: 0.498 Test Acc: 0.804
Validation loss decreased (-0.775357 --> -0.804343).  Saving model ...
Epoch: 10 cost time: 1.6250193119049072
Epoch: 10, Steps: 9 | Train Loss: 0.128 Vali Loss: 0.546 Vali Acc: 0.833 Test Loss: 0.546 Test Acc: 0.833
Validation loss decreased (-0.804343 --> -0.833328).  Saving model ...
Epoch: 11 cost time: 1.4943768978118896
Epoch: 11, Steps: 9 | Train Loss: 0.104 Vali Loss: 0.576 Vali Acc: 0.826 Test Loss: 0.576 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.026965379714966
Epoch: 12, Steps: 9 | Train Loss: 0.065 Vali Loss: 0.599 Vali Acc: 0.833 Test Loss: 0.599 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.498854160308838
Epoch: 13, Steps: 9 | Train Loss: 0.064 Vali Loss: 0.739 Vali Acc: 0.812 Test Loss: 0.739 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.3994874954223633
Epoch: 14, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.546 Vali Acc: 0.833 Test Loss: 0.546 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.919635534286499
Epoch: 15, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.818 Vali Acc: 0.819 Test Loss: 0.818 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.2880752086639404
Epoch: 16, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.723 Vali Acc: 0.819 Test Loss: 0.723 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.0115795135498047
Epoch: 17, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.798 Vali Acc: 0.841 Test Loss: 0.798 Test Acc: 0.841
Validation loss decreased (-0.833328 --> -0.840572).  Saving model ...
Epoch: 18 cost time: 2.358799457550049
Epoch: 18, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.851 Vali Acc: 0.826 Test Loss: 0.851 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.967836856842041
Epoch: 19, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.834 Vali Acc: 0.819 Test Loss: 0.834 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.784101963043213
Epoch: 20, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.615 Vali Acc: 0.848 Test Loss: 0.615 Test Acc: 0.848
Validation loss decreased (-0.840572 --> -0.847820).  Saving model ...
Epoch: 21 cost time: 1.420116901397705
Epoch: 21, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.657 Vali Acc: 0.848 Test Loss: 0.657 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.8013083934783936
Epoch: 22, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.778 Vali Acc: 0.833 Test Loss: 0.778 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.7549769878387451
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.832 Vali Acc: 0.833 Test Loss: 0.832 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.4298601150512695
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.859 Vali Acc: 0.826 Test Loss: 0.859 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.738696575164795
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.834 Vali Acc: 0.826 Test Loss: 0.834 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.8285768032073975
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.768 Vali Acc: 0.833 Test Loss: 0.768 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.504737138748169
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.758 Vali Acc: 0.833 Test Loss: 0.758 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.3300435543060303
Epoch: 28, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.779 Vali Acc: 0.833 Test Loss: 0.779 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.8745312690734863
Epoch: 29, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.767 Vali Acc: 0.841 Test Loss: 0.767 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.4678659439086914
Epoch: 30, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.778 Vali Acc: 0.841 Test Loss: 0.778 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el5_dm768_df768_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8478260869565217
model parameter : 36511492
model size : 153.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el5_dm768_df768_ps16_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.8032686710357666
Epoch: 1, Steps: 9 | Train Loss: 1.493 Vali Loss: 1.438 Vali Acc: 0.297 Test Loss: 1.438 Test Acc: 0.297
Validation loss decreased (inf --> -0.297087).  Saving model ...
Epoch: 2 cost time: 1.2945377826690674
Epoch: 2, Steps: 9 | Train Loss: 1.378 Vali Loss: 1.335 Vali Acc: 0.377 Test Loss: 1.335 Test Acc: 0.377
Validation loss decreased (-0.297087 --> -0.376798).  Saving model ...
Epoch: 3 cost time: 1.451392650604248
Epoch: 3, Steps: 9 | Train Loss: 1.257 Vali Loss: 1.203 Vali Acc: 0.478 Test Loss: 1.203 Test Acc: 0.478
Validation loss decreased (-0.376798 --> -0.478249).  Saving model ...
Epoch: 4 cost time: 1.271198034286499
Epoch: 4, Steps: 9 | Train Loss: 1.118 Vali Loss: 1.087 Vali Acc: 0.529 Test Loss: 1.087 Test Acc: 0.529
Validation loss decreased (-0.478249 --> -0.528975).  Saving model ...
Epoch: 5 cost time: 1.2114017009735107
Epoch: 5, Steps: 9 | Train Loss: 0.946 Vali Loss: 0.970 Vali Acc: 0.652 Test Loss: 0.970 Test Acc: 0.652
Validation loss decreased (-0.528975 --> -0.652164).  Saving model ...
Epoch: 6 cost time: 0.9479560852050781
Epoch: 6, Steps: 9 | Train Loss: 0.826 Vali Loss: 0.857 Vali Acc: 0.667 Test Loss: 0.857 Test Acc: 0.667
Validation loss decreased (-0.652164 --> -0.666658).  Saving model ...
Epoch: 7 cost time: 1.1516087055206299
Epoch: 7, Steps: 9 | Train Loss: 0.689 Vali Loss: 0.760 Vali Acc: 0.681 Test Loss: 0.760 Test Acc: 0.681
Validation loss decreased (-0.666658 --> -0.681152).  Saving model ...
Epoch: 8 cost time: 1.3941357135772705
Epoch: 8, Steps: 9 | Train Loss: 0.585 Vali Loss: 0.722 Vali Acc: 0.681 Test Loss: 0.722 Test Acc: 0.681
Validation loss decreased (-0.681152 --> -0.681152).  Saving model ...
Epoch: 9 cost time: 1.326545000076294
Epoch: 9, Steps: 9 | Train Loss: 0.411 Vali Loss: 0.653 Vali Acc: 0.703 Test Loss: 0.653 Test Acc: 0.703
Validation loss decreased (-0.681152 --> -0.702892).  Saving model ...
Epoch: 10 cost time: 1.4526081085205078
Epoch: 10, Steps: 9 | Train Loss: 0.333 Vali Loss: 0.704 Vali Acc: 0.739 Test Loss: 0.704 Test Acc: 0.739
Validation loss decreased (-0.702892 --> -0.739123).  Saving model ...
Epoch: 11 cost time: 1.1318817138671875
Epoch: 11, Steps: 9 | Train Loss: 0.253 Vali Loss: 0.608 Vali Acc: 0.775 Test Loss: 0.608 Test Acc: 0.775
Validation loss decreased (-0.739123 --> -0.775356).  Saving model ...
Epoch: 12 cost time: 1.0572419166564941
Epoch: 12, Steps: 9 | Train Loss: 0.172 Vali Loss: 0.632 Vali Acc: 0.761 Test Loss: 0.632 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9546282291412354
Epoch: 13, Steps: 9 | Train Loss: 0.114 Vali Loss: 0.581 Vali Acc: 0.819 Test Loss: 0.581 Test Acc: 0.819
Validation loss decreased (-0.775356 --> -0.818835).  Saving model ...
Epoch: 14 cost time: 1.0875389575958252
Epoch: 14, Steps: 9 | Train Loss: 0.075 Vali Loss: 0.647 Vali Acc: 0.761 Test Loss: 0.647 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.100801944732666
Epoch: 15, Steps: 9 | Train Loss: 0.075 Vali Loss: 0.716 Vali Acc: 0.775 Test Loss: 0.716 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.0810494422912598
Epoch: 16, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.722 Vali Acc: 0.761 Test Loss: 0.722 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.0944435596466064
Epoch: 17, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.734 Vali Acc: 0.812 Test Loss: 0.734 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.5686163902282715
Epoch: 18, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.716 Vali Acc: 0.812 Test Loss: 0.716 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.170107364654541
Epoch: 19, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.743 Vali Acc: 0.797 Test Loss: 0.743 Test Acc: 0.797
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.5637614727020264
Epoch: 20, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.854 Vali Acc: 0.790 Test Loss: 0.854 Test Acc: 0.790
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.2655127048492432
Epoch: 21, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.707 Vali Acc: 0.812 Test Loss: 0.707 Test Acc: 0.812
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.494065284729004
Epoch: 22, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.699 Vali Acc: 0.819 Test Loss: 0.699 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.3263955116271973
Epoch: 23, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.783 Vali Acc: 0.812 Test Loss: 0.783 Test Acc: 0.812
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el5_dm768_df768_ps16_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8188405797101449
model parameter : 36456196
model size : 153.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el5_dm768_df768_ps18_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.522883653640747
Epoch: 1, Steps: 9 | Train Loss: 1.442 Vali Loss: 1.274 Vali Acc: 0.391 Test Loss: 1.274 Test Acc: 0.391
Validation loss decreased (inf --> -0.391292).  Saving model ...
Epoch: 2 cost time: 1.8498358726501465
Epoch: 2, Steps: 9 | Train Loss: 1.194 Vali Loss: 1.114 Vali Acc: 0.558 Test Loss: 1.114 Test Acc: 0.558
Validation loss decreased (-0.391292 --> -0.557960).  Saving model ...
Epoch: 3 cost time: 1.7815520763397217
Epoch: 3, Steps: 9 | Train Loss: 0.969 Vali Loss: 0.949 Vali Acc: 0.572 Test Loss: 0.949 Test Acc: 0.572
Validation loss decreased (-0.557960 --> -0.572454).  Saving model ...
Epoch: 4 cost time: 1.5504422187805176
Epoch: 4, Steps: 9 | Train Loss: 0.798 Vali Loss: 0.934 Vali Acc: 0.645 Test Loss: 0.934 Test Acc: 0.645
Validation loss decreased (-0.572454 --> -0.644918).  Saving model ...
Epoch: 5 cost time: 1.7037353515625
Epoch: 5, Steps: 9 | Train Loss: 0.699 Vali Loss: 0.739 Vali Acc: 0.696 Test Loss: 0.739 Test Acc: 0.696
Validation loss decreased (-0.644918 --> -0.695645).  Saving model ...
Epoch: 6 cost time: 1.9197173118591309
Epoch: 6, Steps: 9 | Train Loss: 0.583 Vali Loss: 0.789 Vali Acc: 0.667 Test Loss: 0.789 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.8537185192108154
Epoch: 7, Steps: 9 | Train Loss: 0.372 Vali Loss: 0.628 Vali Acc: 0.826 Test Loss: 0.628 Test Acc: 0.826
Validation loss decreased (-0.695645 --> -0.826081).  Saving model ...
Epoch: 8 cost time: 1.8575518131256104
Epoch: 8, Steps: 9 | Train Loss: 0.274 Vali Loss: 0.804 Vali Acc: 0.696 Test Loss: 0.804 Test Acc: 0.696
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.9855701923370361
Epoch: 9, Steps: 9 | Train Loss: 0.202 Vali Loss: 0.534 Vali Acc: 0.855 Test Loss: 0.534 Test Acc: 0.855
Validation loss decreased (-0.826081 --> -0.855067).  Saving model ...
Epoch: 10 cost time: 1.410844326019287
Epoch: 10, Steps: 9 | Train Loss: 0.122 Vali Loss: 0.730 Vali Acc: 0.826 Test Loss: 0.730 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.160466194152832
Epoch: 11, Steps: 9 | Train Loss: 0.047 Vali Loss: 0.868 Vali Acc: 0.804 Test Loss: 0.868 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.0518972873687744
Epoch: 12, Steps: 9 | Train Loss: 0.027 Vali Loss: 1.010 Vali Acc: 0.841 Test Loss: 1.010 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.2592201232910156
Epoch: 13, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.704 Vali Acc: 0.826 Test Loss: 0.704 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.8719089031219482
Epoch: 14, Steps: 9 | Train Loss: 0.010 Vali Loss: 1.025 Vali Acc: 0.841 Test Loss: 1.025 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.9962503910064697
Epoch: 15, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.762 Vali Acc: 0.819 Test Loss: 0.762 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.3492858409881592
Epoch: 16, Steps: 9 | Train Loss: 0.006 Vali Loss: 1.329 Vali Acc: 0.812 Test Loss: 1.329 Test Acc: 0.812
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.4363658428192139
Epoch: 17, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.037 Vali Acc: 0.848 Test Loss: 1.037 Test Acc: 0.848
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.2292208671569824
Epoch: 18, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.978 Vali Acc: 0.841 Test Loss: 0.978 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.8496015071868896
Epoch: 19, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.993 Vali Acc: 0.833 Test Loss: 0.993 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el5_dm768_df768_ps18_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.855072463768116
model parameter : 36589828
model size : 154.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el5_dm768_df768_ps18_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.00486421585083
Epoch: 1, Steps: 9 | Train Loss: 1.406 Vali Loss: 1.300 Vali Acc: 0.362 Test Loss: 1.300 Test Acc: 0.362
Validation loss decreased (inf --> -0.362306).  Saving model ...
Epoch: 2 cost time: 2.2277894020080566
Epoch: 2, Steps: 9 | Train Loss: 1.238 Vali Loss: 1.150 Vali Acc: 0.435 Test Loss: 1.150 Test Acc: 0.435
Validation loss decreased (-0.362306 --> -0.434771).  Saving model ...
Epoch: 3 cost time: 1.6474311351776123
Epoch: 3, Steps: 9 | Train Loss: 1.075 Vali Loss: 1.019 Vali Acc: 0.601 Test Loss: 1.019 Test Acc: 0.601
Validation loss decreased (-0.434771 --> -0.601439).  Saving model ...
Epoch: 4 cost time: 1.8257536888122559
Epoch: 4, Steps: 9 | Train Loss: 0.875 Vali Loss: 0.920 Vali Acc: 0.630 Test Loss: 0.920 Test Acc: 0.630
Validation loss decreased (-0.601439 --> -0.630426).  Saving model ...
Epoch: 5 cost time: 2.064607620239258
Epoch: 5, Steps: 9 | Train Loss: 0.750 Vali Loss: 0.822 Vali Acc: 0.645 Test Loss: 0.822 Test Acc: 0.645
Validation loss decreased (-0.630426 --> -0.644919).  Saving model ...
Epoch: 6 cost time: 1.3853652477264404
Epoch: 6, Steps: 9 | Train Loss: 0.639 Vali Loss: 0.765 Vali Acc: 0.696 Test Loss: 0.765 Test Acc: 0.696
Validation loss decreased (-0.644919 --> -0.695645).  Saving model ...
Epoch: 7 cost time: 1.6741447448730469
Epoch: 7, Steps: 9 | Train Loss: 0.518 Vali Loss: 0.705 Vali Acc: 0.739 Test Loss: 0.705 Test Acc: 0.739
Validation loss decreased (-0.695645 --> -0.739123).  Saving model ...
Epoch: 8 cost time: 1.9073045253753662
Epoch: 8, Steps: 9 | Train Loss: 0.402 Vali Loss: 0.688 Vali Acc: 0.732 Test Loss: 0.688 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3813087940216064
Epoch: 9, Steps: 9 | Train Loss: 0.308 Vali Loss: 0.612 Vali Acc: 0.812 Test Loss: 0.612 Test Acc: 0.812
Validation loss decreased (-0.739123 --> -0.811588).  Saving model ...
Epoch: 10 cost time: 1.5921485424041748
Epoch: 10, Steps: 9 | Train Loss: 0.244 Vali Loss: 0.718 Vali Acc: 0.717 Test Loss: 0.718 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.370856523513794
Epoch: 11, Steps: 9 | Train Loss: 0.195 Vali Loss: 0.707 Vali Acc: 0.783 Test Loss: 0.707 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.7547259330749512
Epoch: 12, Steps: 9 | Train Loss: 0.120 Vali Loss: 0.693 Vali Acc: 0.775 Test Loss: 0.693 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.4847278594970703
Epoch: 13, Steps: 9 | Train Loss: 0.062 Vali Loss: 0.788 Vali Acc: 0.826 Test Loss: 0.788 Test Acc: 0.826
Validation loss decreased (-0.811588 --> -0.826079).  Saving model ...
Epoch: 14 cost time: 1.3184664249420166
Epoch: 14, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.772 Vali Acc: 0.812 Test Loss: 0.772 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4727740287780762
Epoch: 15, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.666 Vali Acc: 0.833 Test Loss: 0.666 Test Acc: 0.833
Validation loss decreased (-0.826079 --> -0.833327).  Saving model ...
Epoch: 16 cost time: 1.4627432823181152
Epoch: 16, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.825 Vali Acc: 0.826 Test Loss: 0.825 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0936825275421143
Epoch: 17, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.743 Vali Acc: 0.819 Test Loss: 0.743 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.3696846961975098
Epoch: 18, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.895 Vali Acc: 0.819 Test Loss: 0.895 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.5013971328735352
Epoch: 19, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.940 Vali Acc: 0.819 Test Loss: 0.940 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.8084681034088135
Epoch: 20, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.960 Vali Acc: 0.826 Test Loss: 0.960 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.6952838897705078
Epoch: 21, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.881 Vali Acc: 0.826 Test Loss: 0.881 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.7892215251922607
Epoch: 22, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.839 Vali Acc: 0.833 Test Loss: 0.839 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.072279214859009
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.862 Vali Acc: 0.826 Test Loss: 0.862 Test Acc: 0.826
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.4961168766021729
Epoch: 24, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.872 Vali Acc: 0.833 Test Loss: 0.872 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.4902575016021729
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.875 Vali Acc: 0.833 Test Loss: 0.875 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el5_dm768_df768_ps18_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8333333333333334
model parameter : 36511492
model size : 153.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el5_dm768_df768_ps18_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.363654613494873
Epoch: 1, Steps: 9 | Train Loss: 1.482 Vali Loss: 1.379 Vali Acc: 0.290 Test Loss: 1.379 Test Acc: 0.290
Validation loss decreased (inf --> -0.289841).  Saving model ...
Epoch: 2 cost time: 1.181793212890625
Epoch: 2, Steps: 9 | Train Loss: 1.353 Vali Loss: 1.281 Vali Acc: 0.370 Test Loss: 1.281 Test Acc: 0.370
Validation loss decreased (-0.289841 --> -0.369552).  Saving model ...
Epoch: 3 cost time: 1.1163218021392822
Epoch: 3, Steps: 9 | Train Loss: 1.232 Vali Loss: 1.180 Vali Acc: 0.420 Test Loss: 1.180 Test Acc: 0.420
Validation loss decreased (-0.369552 --> -0.420278).  Saving model ...
Epoch: 4 cost time: 1.1324195861816406
Epoch: 4, Steps: 9 | Train Loss: 1.132 Vali Loss: 1.076 Vali Acc: 0.507 Test Loss: 1.076 Test Acc: 0.507
Validation loss decreased (-0.420278 --> -0.507236).  Saving model ...
Epoch: 5 cost time: 1.0395424365997314
Epoch: 5, Steps: 9 | Train Loss: 0.971 Vali Loss: 0.985 Vali Acc: 0.543 Test Loss: 0.985 Test Acc: 0.543
Validation loss decreased (-0.507236 --> -0.543468).  Saving model ...
Epoch: 6 cost time: 1.0491971969604492
Epoch: 6, Steps: 9 | Train Loss: 0.832 Vali Loss: 0.936 Vali Acc: 0.551 Test Loss: 0.936 Test Acc: 0.551
Validation loss decreased (-0.543468 --> -0.550715).  Saving model ...
Epoch: 7 cost time: 1.0743227005004883
Epoch: 7, Steps: 9 | Train Loss: 0.708 Vali Loss: 0.865 Vali Acc: 0.696 Test Loss: 0.865 Test Acc: 0.696
Validation loss decreased (-0.550715 --> -0.695644).  Saving model ...
Epoch: 8 cost time: 1.323702335357666
Epoch: 8, Steps: 9 | Train Loss: 0.566 Vali Loss: 0.773 Vali Acc: 0.761 Test Loss: 0.773 Test Acc: 0.761
Validation loss decreased (-0.695644 --> -0.760862).  Saving model ...
Epoch: 9 cost time: 1.1118226051330566
Epoch: 9, Steps: 9 | Train Loss: 0.458 Vali Loss: 0.724 Vali Acc: 0.783 Test Loss: 0.724 Test Acc: 0.783
Validation loss decreased (-0.760862 --> -0.782601).  Saving model ...
Epoch: 10 cost time: 1.1357123851776123
Epoch: 10, Steps: 9 | Train Loss: 0.370 Vali Loss: 0.654 Vali Acc: 0.775 Test Loss: 0.654 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.443925380706787
Epoch: 11, Steps: 9 | Train Loss: 0.259 Vali Loss: 0.674 Vali Acc: 0.768 Test Loss: 0.674 Test Acc: 0.768
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.2127716541290283
Epoch: 12, Steps: 9 | Train Loss: 0.190 Vali Loss: 0.623 Vali Acc: 0.754 Test Loss: 0.623 Test Acc: 0.754
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.332536220550537
Epoch: 13, Steps: 9 | Train Loss: 0.133 Vali Loss: 0.841 Vali Acc: 0.754 Test Loss: 0.841 Test Acc: 0.754
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.06205415725708
Epoch: 14, Steps: 9 | Train Loss: 0.078 Vali Loss: 0.731 Vali Acc: 0.746 Test Loss: 0.731 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.2250125408172607
Epoch: 15, Steps: 9 | Train Loss: 0.068 Vali Loss: 0.697 Vali Acc: 0.790 Test Loss: 0.697 Test Acc: 0.790
Validation loss decreased (-0.782601 --> -0.789848).  Saving model ...
Epoch: 16 cost time: 0.9505810737609863
Epoch: 16, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.712 Vali Acc: 0.797 Test Loss: 0.712 Test Acc: 0.797
Validation loss decreased (-0.789848 --> -0.797094).  Saving model ...
Epoch: 17 cost time: 1.1658837795257568
Epoch: 17, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.860 Vali Acc: 0.768 Test Loss: 0.860 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2240674495697021
Epoch: 18, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.834 Vali Acc: 0.783 Test Loss: 0.834 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.0842759609222412
Epoch: 19, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.808 Vali Acc: 0.812 Test Loss: 0.808 Test Acc: 0.812
Validation loss decreased (-0.797094 --> -0.811586).  Saving model ...
Epoch: 20 cost time: 1.1457765102386475
Epoch: 20, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.855 Vali Acc: 0.783 Test Loss: 0.855 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.249312400817871
Epoch: 21, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.881 Vali Acc: 0.783 Test Loss: 0.881 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.2396659851074219
Epoch: 22, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.836 Vali Acc: 0.783 Test Loss: 0.836 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.1343915462493896
Epoch: 23, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.820 Vali Acc: 0.797 Test Loss: 0.820 Test Acc: 0.797
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.3380143642425537
Epoch: 24, Steps: 9 | Train Loss: 0.008 Vali Loss: 1.000 Vali Acc: 0.797 Test Loss: 1.000 Test Acc: 0.797
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.2752430438995361
Epoch: 25, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.959 Vali Acc: 0.790 Test Loss: 0.959 Test Acc: 0.790
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.228710651397705
Epoch: 26, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.876 Vali Acc: 0.790 Test Loss: 0.876 Test Acc: 0.790
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.1540398597717285
Epoch: 27, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.943 Vali Acc: 0.804 Test Loss: 0.943 Test Acc: 0.804
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.9879775047302246
Epoch: 28, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.944 Vali Acc: 0.797 Test Loss: 0.944 Test Acc: 0.797
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.10760498046875
Epoch: 29, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.908 Vali Acc: 0.797 Test Loss: 0.908 Test Acc: 0.797
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el5_dm768_df768_ps18_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8115942028985508
model parameter : 36465412
model size : 153.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el5_dm768_df768_ps19_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.909395217895508
Epoch: 1, Steps: 9 | Train Loss: 1.463 Vali Loss: 1.391 Vali Acc: 0.261 Test Loss: 1.391 Test Acc: 0.261
Validation loss decreased (inf --> -0.260856).  Saving model ...
Epoch: 2 cost time: 1.8772881031036377
Epoch: 2, Steps: 9 | Train Loss: 1.271 Vali Loss: 1.174 Vali Acc: 0.486 Test Loss: 1.174 Test Acc: 0.486
Validation loss decreased (-0.260856 --> -0.485496).  Saving model ...
Epoch: 3 cost time: 1.6336219310760498
Epoch: 3, Steps: 9 | Train Loss: 1.055 Vali Loss: 1.023 Vali Acc: 0.500 Test Loss: 1.023 Test Acc: 0.500
Validation loss decreased (-0.485496 --> -0.499990).  Saving model ...
Epoch: 4 cost time: 1.8934881687164307
Epoch: 4, Steps: 9 | Train Loss: 0.793 Vali Loss: 0.859 Vali Acc: 0.659 Test Loss: 0.859 Test Acc: 0.659
Validation loss decreased (-0.499990 --> -0.659412).  Saving model ...
Epoch: 5 cost time: 1.844414472579956
Epoch: 5, Steps: 9 | Train Loss: 0.623 Vali Loss: 0.775 Vali Acc: 0.717 Test Loss: 0.775 Test Acc: 0.717
Validation loss decreased (-0.659412 --> -0.717384).  Saving model ...
Epoch: 6 cost time: 1.5169942378997803
Epoch: 6, Steps: 9 | Train Loss: 0.512 Vali Loss: 0.651 Vali Acc: 0.732 Test Loss: 0.651 Test Acc: 0.732
Validation loss decreased (-0.717384 --> -0.731878).  Saving model ...
Epoch: 7 cost time: 2.0198047161102295
Epoch: 7, Steps: 9 | Train Loss: 0.309 Vali Loss: 0.817 Vali Acc: 0.739 Test Loss: 0.817 Test Acc: 0.739
Validation loss decreased (-0.731878 --> -0.739122).  Saving model ...
Epoch: 8 cost time: 1.5234534740447998
Epoch: 8, Steps: 9 | Train Loss: 0.236 Vali Loss: 0.749 Vali Acc: 0.725 Test Loss: 0.749 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.386441707611084
Epoch: 9, Steps: 9 | Train Loss: 0.132 Vali Loss: 0.629 Vali Acc: 0.841 Test Loss: 0.629 Test Acc: 0.841
Validation loss decreased (-0.739122 --> -0.840573).  Saving model ...
Epoch: 10 cost time: 1.717151165008545
Epoch: 10, Steps: 9 | Train Loss: 0.055 Vali Loss: 0.690 Vali Acc: 0.783 Test Loss: 0.690 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8785440921783447
Epoch: 11, Steps: 9 | Train Loss: 0.077 Vali Loss: 0.773 Vali Acc: 0.841 Test Loss: 0.773 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.8155570030212402
Epoch: 12, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.868 Vali Acc: 0.761 Test Loss: 0.868 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.6602392196655273
Epoch: 13, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.878 Vali Acc: 0.841 Test Loss: 0.878 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.8106591701507568
Epoch: 14, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.685 Vali Acc: 0.841 Test Loss: 0.685 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.6548962593078613
Epoch: 15, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.816 Vali Acc: 0.841 Test Loss: 0.816 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.0848066806793213
Epoch: 16, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.860 Vali Acc: 0.804 Test Loss: 0.860 Test Acc: 0.804
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.7290568351745605
Epoch: 17, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.794 Vali Acc: 0.826 Test Loss: 0.794 Test Acc: 0.826
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.7289531230926514
Epoch: 18, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.877 Vali Acc: 0.826 Test Loss: 0.877 Test Acc: 0.826
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.3190667629241943
Epoch: 19, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.875 Vali Acc: 0.833 Test Loss: 0.875 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el5_dm768_df768_ps19_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8405797101449275
model parameter : 36596740
model size : 154.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el5_dm768_df768_ps19_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.7026920318603516
Epoch: 1, Steps: 9 | Train Loss: 1.461 Vali Loss: 1.369 Vali Acc: 0.355 Test Loss: 1.369 Test Acc: 0.355
Validation loss decreased (inf --> -0.355059).  Saving model ...
Epoch: 2 cost time: 1.808532476425171
Epoch: 2, Steps: 9 | Train Loss: 1.324 Vali Loss: 1.236 Vali Acc: 0.514 Test Loss: 1.236 Test Acc: 0.514
Validation loss decreased (-0.355059 --> -0.514480).  Saving model ...
Epoch: 3 cost time: 1.8742408752441406
Epoch: 3, Steps: 9 | Train Loss: 1.150 Vali Loss: 1.091 Vali Acc: 0.616 Test Loss: 1.091 Test Acc: 0.616
Validation loss decreased (-0.514480 --> -0.615931).  Saving model ...
Epoch: 4 cost time: 1.7031278610229492
Epoch: 4, Steps: 9 | Train Loss: 1.000 Vali Loss: 0.947 Vali Acc: 0.659 Test Loss: 0.947 Test Acc: 0.659
Validation loss decreased (-0.615931 --> -0.659411).  Saving model ...
Epoch: 5 cost time: 1.3206336498260498
Epoch: 5, Steps: 9 | Train Loss: 0.837 Vali Loss: 0.836 Vali Acc: 0.681 Test Loss: 0.836 Test Acc: 0.681
Validation loss decreased (-0.659411 --> -0.681151).  Saving model ...
Epoch: 6 cost time: 1.1751830577850342
Epoch: 6, Steps: 9 | Train Loss: 0.625 Vali Loss: 0.709 Vali Acc: 0.725 Test Loss: 0.709 Test Acc: 0.725
Validation loss decreased (-0.681151 --> -0.724631).  Saving model ...
Epoch: 7 cost time: 1.1697266101837158
Epoch: 7, Steps: 9 | Train Loss: 0.514 Vali Loss: 0.727 Vali Acc: 0.710 Test Loss: 0.727 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5182619094848633
Epoch: 8, Steps: 9 | Train Loss: 0.399 Vali Loss: 0.681 Vali Acc: 0.732 Test Loss: 0.681 Test Acc: 0.732
Validation loss decreased (-0.724631 --> -0.731877).  Saving model ...
Epoch: 9 cost time: 1.3162312507629395
Epoch: 9, Steps: 9 | Train Loss: 0.292 Vali Loss: 0.672 Vali Acc: 0.783 Test Loss: 0.672 Test Acc: 0.783
Validation loss decreased (-0.731877 --> -0.782602).  Saving model ...
Epoch: 10 cost time: 1.3395426273345947
Epoch: 10, Steps: 9 | Train Loss: 0.190 Vali Loss: 0.741 Vali Acc: 0.783 Test Loss: 0.741 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6387786865234375
Epoch: 11, Steps: 9 | Train Loss: 0.136 Vali Loss: 0.599 Vali Acc: 0.862 Test Loss: 0.599 Test Acc: 0.862
Validation loss decreased (-0.782602 --> -0.862313).  Saving model ...
Epoch: 12 cost time: 1.663395643234253
Epoch: 12, Steps: 9 | Train Loss: 0.069 Vali Loss: 0.729 Vali Acc: 0.783 Test Loss: 0.729 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.8113293647766113
Epoch: 13, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.700 Vali Acc: 0.841 Test Loss: 0.700 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.9195499420166016
Epoch: 14, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.575 Vali Acc: 0.826 Test Loss: 0.575 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.7791898250579834
Epoch: 15, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.812 Vali Acc: 0.848 Test Loss: 0.812 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.4145524501800537
Epoch: 16, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.667 Vali Acc: 0.855 Test Loss: 0.667 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.545166254043579
Epoch: 17, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.603 Vali Acc: 0.855 Test Loss: 0.603 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.5626578330993652
Epoch: 18, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.772 Vali Acc: 0.848 Test Loss: 0.772 Test Acc: 0.848
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.5185489654541016
Epoch: 19, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.866 Vali Acc: 0.848 Test Loss: 0.866 Test Acc: 0.848
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.5028915405273438
Epoch: 20, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.877 Vali Acc: 0.833 Test Loss: 0.877 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.3478076457977295
Epoch: 21, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.734 Vali Acc: 0.841 Test Loss: 0.734 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el5_dm768_df768_ps19_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8623188405797102
model parameter : 36509188
model size : 153.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el5_dm768_df768_ps19_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.160139322280884
Epoch: 1, Steps: 9 | Train Loss: 1.428 Vali Loss: 1.382 Vali Acc: 0.225 Test Loss: 1.382 Test Acc: 0.225
Validation loss decreased (inf --> -0.224624).  Saving model ...
Epoch: 2 cost time: 1.231180191040039
Epoch: 2, Steps: 9 | Train Loss: 1.346 Vali Loss: 1.300 Vali Acc: 0.406 Test Loss: 1.300 Test Acc: 0.406
Validation loss decreased (-0.224624 --> -0.405784).  Saving model ...
Epoch: 3 cost time: 1.2265334129333496
Epoch: 3, Steps: 9 | Train Loss: 1.227 Vali Loss: 1.210 Vali Acc: 0.522 Test Loss: 1.210 Test Acc: 0.522
Validation loss decreased (-0.405784 --> -0.521727).  Saving model ...
Epoch: 4 cost time: 1.2735693454742432
Epoch: 4, Steps: 9 | Train Loss: 1.088 Vali Loss: 1.109 Vali Acc: 0.565 Test Loss: 1.109 Test Acc: 0.565
Validation loss decreased (-0.521727 --> -0.565206).  Saving model ...
Epoch: 5 cost time: 1.294008493423462
Epoch: 5, Steps: 9 | Train Loss: 0.976 Vali Loss: 1.018 Vali Acc: 0.623 Test Loss: 1.018 Test Acc: 0.623
Validation loss decreased (-0.565206 --> -0.623178).  Saving model ...
Epoch: 6 cost time: 1.176572322845459
Epoch: 6, Steps: 9 | Train Loss: 0.853 Vali Loss: 0.918 Vali Acc: 0.572 Test Loss: 0.918 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.038804292678833
Epoch: 7, Steps: 9 | Train Loss: 0.669 Vali Loss: 0.842 Vali Acc: 0.652 Test Loss: 0.842 Test Acc: 0.652
Validation loss decreased (-0.623178 --> -0.652165).  Saving model ...
Epoch: 8 cost time: 1.2790160179138184
Epoch: 8, Steps: 9 | Train Loss: 0.564 Vali Loss: 0.760 Vali Acc: 0.696 Test Loss: 0.760 Test Acc: 0.696
Validation loss decreased (-0.652165 --> -0.695645).  Saving model ...
Epoch: 9 cost time: 1.3190057277679443
Epoch: 9, Steps: 9 | Train Loss: 0.443 Vali Loss: 0.726 Vali Acc: 0.717 Test Loss: 0.726 Test Acc: 0.717
Validation loss decreased (-0.695645 --> -0.717384).  Saving model ...
Epoch: 10 cost time: 1.1312856674194336
Epoch: 10, Steps: 9 | Train Loss: 0.349 Vali Loss: 0.622 Vali Acc: 0.775 Test Loss: 0.622 Test Acc: 0.775
Validation loss decreased (-0.717384 --> -0.775356).  Saving model ...
Epoch: 11 cost time: 1.2730603218078613
Epoch: 11, Steps: 9 | Train Loss: 0.254 Vali Loss: 0.617 Vali Acc: 0.768 Test Loss: 0.617 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2882859706878662
Epoch: 12, Steps: 9 | Train Loss: 0.166 Vali Loss: 0.672 Vali Acc: 0.797 Test Loss: 0.672 Test Acc: 0.797
Validation loss decreased (-0.775356 --> -0.797095).  Saving model ...
Epoch: 13 cost time: 1.5183706283569336
Epoch: 13, Steps: 9 | Train Loss: 0.126 Vali Loss: 0.581 Vali Acc: 0.819 Test Loss: 0.581 Test Acc: 0.819
Validation loss decreased (-0.797095 --> -0.818835).  Saving model ...
Epoch: 14 cost time: 1.1716558933258057
Epoch: 14, Steps: 9 | Train Loss: 0.080 Vali Loss: 0.603 Vali Acc: 0.819 Test Loss: 0.603 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0352990627288818
Epoch: 15, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.654 Vali Acc: 0.804 Test Loss: 0.654 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.3563053607940674
Epoch: 16, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.551 Vali Acc: 0.833 Test Loss: 0.551 Test Acc: 0.833
Validation loss decreased (-0.818835 --> -0.833328).  Saving model ...
Epoch: 17 cost time: 1.124380111694336
Epoch: 17, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.645 Vali Acc: 0.797 Test Loss: 0.645 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.293501377105713
Epoch: 18, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.684 Vali Acc: 0.804 Test Loss: 0.684 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.4280915260314941
Epoch: 19, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.777 Vali Acc: 0.819 Test Loss: 0.777 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.1574454307556152
Epoch: 20, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.662 Vali Acc: 0.819 Test Loss: 0.662 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.0909416675567627
Epoch: 21, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.647 Vali Acc: 0.833 Test Loss: 0.647 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.0493707656860352
Epoch: 22, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.725 Vali Acc: 0.819 Test Loss: 0.725 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.1907076835632324
Epoch: 23, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.762 Vali Acc: 0.826 Test Loss: 0.762 Test Acc: 0.826
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.0590260028839111
Epoch: 24, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.765 Vali Acc: 0.826 Test Loss: 0.765 Test Acc: 0.826
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.203310251235962
Epoch: 25, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.725 Vali Acc: 0.833 Test Loss: 0.725 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.3042340278625488
Epoch: 26, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.734 Vali Acc: 0.826 Test Loss: 0.734 Test Acc: 0.826
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el5_dm768_df768_ps19_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8333333333333334
model parameter : 36467716
model size : 153.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el5_dm768_df768_ps21_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.99298357963562
Epoch: 1, Steps: 9 | Train Loss: 1.501 Vali Loss: 1.334 Vali Acc: 0.355 Test Loss: 1.334 Test Acc: 0.355
Validation loss decreased (inf --> -0.355059).  Saving model ...
Epoch: 2 cost time: 2.035693883895874
Epoch: 2, Steps: 9 | Train Loss: 1.284 Vali Loss: 1.163 Vali Acc: 0.486 Test Loss: 1.163 Test Acc: 0.486
Validation loss decreased (-0.355059 --> -0.485496).  Saving model ...
Epoch: 3 cost time: 1.8669183254241943
Epoch: 3, Steps: 9 | Train Loss: 1.062 Vali Loss: 0.979 Vali Acc: 0.638 Test Loss: 0.979 Test Acc: 0.638
Validation loss decreased (-0.485496 --> -0.637671).  Saving model ...
Epoch: 4 cost time: 1.5084121227264404
Epoch: 4, Steps: 9 | Train Loss: 0.830 Vali Loss: 0.837 Vali Acc: 0.638 Test Loss: 0.837 Test Acc: 0.638
Validation loss decreased (-0.637671 --> -0.637673).  Saving model ...
Epoch: 5 cost time: 1.1575860977172852
Epoch: 5, Steps: 9 | Train Loss: 0.688 Vali Loss: 0.814 Vali Acc: 0.659 Test Loss: 0.814 Test Acc: 0.659
Validation loss decreased (-0.637673 --> -0.659412).  Saving model ...
Epoch: 6 cost time: 1.72810959815979
Epoch: 6, Steps: 9 | Train Loss: 0.490 Vali Loss: 0.596 Vali Acc: 0.746 Test Loss: 0.596 Test Acc: 0.746
Validation loss decreased (-0.659412 --> -0.746371).  Saving model ...
Epoch: 7 cost time: 1.7414679527282715
Epoch: 7, Steps: 9 | Train Loss: 0.308 Vali Loss: 0.775 Vali Acc: 0.652 Test Loss: 0.775 Test Acc: 0.652
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5125629901885986
Epoch: 8, Steps: 9 | Train Loss: 0.243 Vali Loss: 0.527 Vali Acc: 0.804 Test Loss: 0.527 Test Acc: 0.804
Validation loss decreased (-0.746371 --> -0.804343).  Saving model ...
Epoch: 9 cost time: 1.4406659603118896
Epoch: 9, Steps: 9 | Train Loss: 0.121 Vali Loss: 0.752 Vali Acc: 0.797 Test Loss: 0.752 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.511064052581787
Epoch: 10, Steps: 9 | Train Loss: 0.079 Vali Loss: 0.612 Vali Acc: 0.812 Test Loss: 0.612 Test Acc: 0.812
Validation loss decreased (-0.804343 --> -0.811588).  Saving model ...
Epoch: 11 cost time: 1.6771342754364014
Epoch: 11, Steps: 9 | Train Loss: 0.062 Vali Loss: 0.651 Vali Acc: 0.812 Test Loss: 0.651 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4322912693023682
Epoch: 12, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.888 Vali Acc: 0.826 Test Loss: 0.888 Test Acc: 0.826
Validation loss decreased (-0.811588 --> -0.826078).  Saving model ...
Epoch: 13 cost time: 2.0915367603302
Epoch: 13, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.931 Vali Acc: 0.833 Test Loss: 0.931 Test Acc: 0.833
Validation loss decreased (-0.826078 --> -0.833324).  Saving model ...
Epoch: 14 cost time: 1.9643924236297607
Epoch: 14, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.727 Vali Acc: 0.855 Test Loss: 0.727 Test Acc: 0.855
Validation loss decreased (-0.833324 --> -0.855065).  Saving model ...
Epoch: 15 cost time: 1.8159852027893066
Epoch: 15, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.778 Vali Acc: 0.855 Test Loss: 0.778 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.675675392150879
Epoch: 16, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.809 Vali Acc: 0.848 Test Loss: 0.809 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.8495631217956543
Epoch: 17, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.765 Vali Acc: 0.855 Test Loss: 0.765 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.8966429233551025
Epoch: 18, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.751 Vali Acc: 0.862 Test Loss: 0.751 Test Acc: 0.862
Validation loss decreased (-0.855065 --> -0.862311).  Saving model ...
Epoch: 19 cost time: 1.6467597484588623
Epoch: 19, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.795 Vali Acc: 0.855 Test Loss: 0.795 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.9041690826416016
Epoch: 20, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.764 Vali Acc: 0.862 Test Loss: 0.764 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.7280781269073486
Epoch: 21, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.778 Vali Acc: 0.862 Test Loss: 0.778 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.617603063583374
Epoch: 22, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.834 Vali Acc: 0.862 Test Loss: 0.834 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.6872267723083496
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.864 Vali Acc: 0.862 Test Loss: 0.864 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.533534049987793
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.793 Vali Acc: 0.862 Test Loss: 0.793 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.9616618156433105
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.795 Vali Acc: 0.862 Test Loss: 0.795 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.056288719177246
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.875 Vali Acc: 0.855 Test Loss: 0.875 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.903843641281128
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.854 Vali Acc: 0.855 Test Loss: 0.854 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.8394696712493896
Epoch: 28, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.746 Vali Acc: 0.862 Test Loss: 0.746 Test Acc: 0.862
Validation loss decreased (-0.862311 --> -0.862311).  Saving model ...
Epoch: 29 cost time: 1.6723172664642334
Epoch: 29, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.774 Vali Acc: 0.862 Test Loss: 0.774 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.7118151187896729
Epoch: 30, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.889 Vali Acc: 0.848 Test Loss: 0.889 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.4446847438812256
Epoch: 31, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.876 Vali Acc: 0.848 Test Loss: 0.876 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.7203550338745117
Epoch: 32, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.829 Vali Acc: 0.855 Test Loss: 0.829 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.8751699924468994
Epoch: 33, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.802 Vali Acc: 0.855 Test Loss: 0.802 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.787308931350708
Epoch: 34, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.808 Vali Acc: 0.862 Test Loss: 0.808 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.629544734954834
Epoch: 35, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.799 Vali Acc: 0.862 Test Loss: 0.799 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.5130763053894043
Epoch: 36, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.822 Vali Acc: 0.862 Test Loss: 0.822 Test Acc: 0.862
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.5867714881896973
Epoch: 37, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.857 Vali Acc: 0.848 Test Loss: 0.857 Test Acc: 0.848
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.6407482624053955
Epoch: 38, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.868 Vali Acc: 0.848 Test Loss: 0.868 Test Acc: 0.848
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el5_dm768_df768_ps21_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8623188405797102
model parameter : 36578308
model size : 154.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el5_dm768_df768_ps21_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.057579517364502
Epoch: 1, Steps: 9 | Train Loss: 1.479 Vali Loss: 1.334 Vali Acc: 0.413 Test Loss: 1.334 Test Acc: 0.413
Validation loss decreased (inf --> -0.413030).  Saving model ...
Epoch: 2 cost time: 1.9457919597625732
Epoch: 2, Steps: 9 | Train Loss: 1.318 Vali Loss: 1.239 Vali Acc: 0.507 Test Loss: 1.239 Test Acc: 0.507
Validation loss decreased (-0.413030 --> -0.507234).  Saving model ...
Epoch: 3 cost time: 1.7406225204467773
Epoch: 3, Steps: 9 | Train Loss: 1.165 Vali Loss: 1.091 Vali Acc: 0.638 Test Loss: 1.091 Test Acc: 0.638
Validation loss decreased (-0.507234 --> -0.637670).  Saving model ...
Epoch: 4 cost time: 1.637622594833374
Epoch: 4, Steps: 9 | Train Loss: 0.995 Vali Loss: 0.947 Vali Acc: 0.630 Test Loss: 0.947 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6955554485321045
Epoch: 5, Steps: 9 | Train Loss: 0.795 Vali Loss: 0.838 Vali Acc: 0.652 Test Loss: 0.838 Test Acc: 0.652
Validation loss decreased (-0.637670 --> -0.652166).  Saving model ...
Epoch: 6 cost time: 1.4487717151641846
Epoch: 6, Steps: 9 | Train Loss: 0.631 Vali Loss: 0.729 Vali Acc: 0.659 Test Loss: 0.729 Test Acc: 0.659
Validation loss decreased (-0.652166 --> -0.659413).  Saving model ...
Epoch: 7 cost time: 1.5315730571746826
Epoch: 7, Steps: 9 | Train Loss: 0.466 Vali Loss: 0.677 Vali Acc: 0.681 Test Loss: 0.677 Test Acc: 0.681
Validation loss decreased (-0.659413 --> -0.681153).  Saving model ...
Epoch: 8 cost time: 1.4126651287078857
Epoch: 8, Steps: 9 | Train Loss: 0.333 Vali Loss: 0.642 Vali Acc: 0.732 Test Loss: 0.642 Test Acc: 0.732
Validation loss decreased (-0.681153 --> -0.731878).  Saving model ...
Epoch: 9 cost time: 1.6080453395843506
Epoch: 9, Steps: 9 | Train Loss: 0.260 Vali Loss: 0.612 Vali Acc: 0.775 Test Loss: 0.612 Test Acc: 0.775
Validation loss decreased (-0.731878 --> -0.775356).  Saving model ...
Epoch: 10 cost time: 1.4703764915466309
Epoch: 10, Steps: 9 | Train Loss: 0.192 Vali Loss: 0.820 Vali Acc: 0.739 Test Loss: 0.820 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5081188678741455
Epoch: 11, Steps: 9 | Train Loss: 0.158 Vali Loss: 0.615 Vali Acc: 0.754 Test Loss: 0.615 Test Acc: 0.754
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.6302454471588135
Epoch: 12, Steps: 9 | Train Loss: 0.102 Vali Loss: 0.912 Vali Acc: 0.754 Test Loss: 0.912 Test Acc: 0.754
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.3294219970703125
Epoch: 13, Steps: 9 | Train Loss: 0.082 Vali Loss: 0.661 Vali Acc: 0.768 Test Loss: 0.661 Test Acc: 0.768
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.4383316040039062
Epoch: 14, Steps: 9 | Train Loss: 0.044 Vali Loss: 1.107 Vali Acc: 0.761 Test Loss: 1.107 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.3740267753601074
Epoch: 15, Steps: 9 | Train Loss: 0.069 Vali Loss: 0.675 Vali Acc: 0.775 Test Loss: 0.675 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.3126308917999268
Epoch: 16, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.793 Vali Acc: 0.797 Test Loss: 0.793 Test Acc: 0.797
Validation loss decreased (-0.775356 --> -0.797094).  Saving model ...
Epoch: 17 cost time: 1.4972889423370361
Epoch: 17, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.743 Vali Acc: 0.826 Test Loss: 0.743 Test Acc: 0.826
Validation loss decreased (-0.797094 --> -0.826080).  Saving model ...
Epoch: 18 cost time: 1.4026877880096436
Epoch: 18, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.817 Vali Acc: 0.833 Test Loss: 0.817 Test Acc: 0.833
Validation loss decreased (-0.826080 --> -0.833325).  Saving model ...
Epoch: 19 cost time: 1.3283960819244385
Epoch: 19, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.884 Vali Acc: 0.812 Test Loss: 0.884 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.3445804119110107
Epoch: 20, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.849 Vali Acc: 0.826 Test Loss: 0.849 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.6663424968719482
Epoch: 21, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.834 Vali Acc: 0.826 Test Loss: 0.834 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.6844813823699951
Epoch: 22, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.823 Vali Acc: 0.819 Test Loss: 0.823 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.858466625213623
Epoch: 23, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.852 Vali Acc: 0.819 Test Loss: 0.852 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.6107745170593262
Epoch: 24, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.873 Vali Acc: 0.819 Test Loss: 0.873 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.7409613132476807
Epoch: 25, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.859 Vali Acc: 0.833 Test Loss: 0.859 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.4494972229003906
Epoch: 26, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.939 Vali Acc: 0.826 Test Loss: 0.939 Test Acc: 0.826
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.42948317527771
Epoch: 27, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.891 Vali Acc: 0.833 Test Loss: 0.891 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.691807508468628
Epoch: 28, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.849 Vali Acc: 0.833 Test Loss: 0.849 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el5_dm768_df768_ps21_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8333333333333334
model parameter : 36513796
model size : 153.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el5_dm768_df768_ps21_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.228860378265381
Epoch: 1, Steps: 9 | Train Loss: 1.437 Vali Loss: 1.362 Vali Acc: 0.297 Test Loss: 1.362 Test Acc: 0.297
Validation loss decreased (inf --> -0.297088).  Saving model ...
Epoch: 2 cost time: 1.2741103172302246
Epoch: 2, Steps: 9 | Train Loss: 1.321 Vali Loss: 1.260 Vali Acc: 0.486 Test Loss: 1.260 Test Acc: 0.486
Validation loss decreased (-0.297088 --> -0.485495).  Saving model ...
Epoch: 3 cost time: 1.1179823875427246
Epoch: 3, Steps: 9 | Train Loss: 1.222 Vali Loss: 1.167 Vali Acc: 0.565 Test Loss: 1.167 Test Acc: 0.565
Validation loss decreased (-0.485495 --> -0.565206).  Saving model ...
Epoch: 4 cost time: 0.8651142120361328
Epoch: 4, Steps: 9 | Train Loss: 1.095 Vali Loss: 1.041 Vali Acc: 0.659 Test Loss: 1.041 Test Acc: 0.659
Validation loss decreased (-0.565206 --> -0.659410).  Saving model ...
Epoch: 5 cost time: 0.9184863567352295
Epoch: 5, Steps: 9 | Train Loss: 0.941 Vali Loss: 0.955 Vali Acc: 0.623 Test Loss: 0.955 Test Acc: 0.623
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.039194107055664
Epoch: 6, Steps: 9 | Train Loss: 0.799 Vali Loss: 0.839 Vali Acc: 0.659 Test Loss: 0.839 Test Acc: 0.659
Validation loss decreased (-0.659410 --> -0.659412).  Saving model ...
Epoch: 7 cost time: 0.9500594139099121
Epoch: 7, Steps: 9 | Train Loss: 0.674 Vali Loss: 0.757 Vali Acc: 0.674 Test Loss: 0.757 Test Acc: 0.674
Validation loss decreased (-0.659412 --> -0.673905).  Saving model ...
Epoch: 8 cost time: 0.8908908367156982
Epoch: 8, Steps: 9 | Train Loss: 0.522 Vali Loss: 0.740 Vali Acc: 0.674 Test Loss: 0.740 Test Acc: 0.674
Validation loss decreased (-0.673905 --> -0.673906).  Saving model ...
Epoch: 9 cost time: 1.0812890529632568
Epoch: 9, Steps: 9 | Train Loss: 0.425 Vali Loss: 0.690 Vali Acc: 0.688 Test Loss: 0.690 Test Acc: 0.688
Validation loss decreased (-0.673906 --> -0.688399).  Saving model ...
Epoch: 10 cost time: 1.047095537185669
Epoch: 10, Steps: 9 | Train Loss: 0.374 Vali Loss: 0.658 Vali Acc: 0.761 Test Loss: 0.658 Test Acc: 0.761
Validation loss decreased (-0.688399 --> -0.760863).  Saving model ...
Epoch: 11 cost time: 0.9945764541625977
Epoch: 11, Steps: 9 | Train Loss: 0.231 Vali Loss: 0.686 Vali Acc: 0.761 Test Loss: 0.686 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0830607414245605
Epoch: 12, Steps: 9 | Train Loss: 0.174 Vali Loss: 0.656 Vali Acc: 0.783 Test Loss: 0.656 Test Acc: 0.783
Validation loss decreased (-0.760863 --> -0.782602).  Saving model ...
Epoch: 13 cost time: 1.0232117176055908
Epoch: 13, Steps: 9 | Train Loss: 0.148 Vali Loss: 0.617 Vali Acc: 0.797 Test Loss: 0.617 Test Acc: 0.797
Validation loss decreased (-0.782602 --> -0.797095).  Saving model ...
Epoch: 14 cost time: 1.0968375205993652
Epoch: 14, Steps: 9 | Train Loss: 0.106 Vali Loss: 0.617 Vali Acc: 0.826 Test Loss: 0.617 Test Acc: 0.826
Validation loss decreased (-0.797095 --> -0.826081).  Saving model ...
Epoch: 15 cost time: 0.9671411514282227
Epoch: 15, Steps: 9 | Train Loss: 0.064 Vali Loss: 0.708 Vali Acc: 0.819 Test Loss: 0.708 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0851976871490479
Epoch: 16, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.639 Vali Acc: 0.826 Test Loss: 0.639 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.1486289501190186
Epoch: 17, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.779 Vali Acc: 0.804 Test Loss: 0.779 Test Acc: 0.804
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.1956140995025635
Epoch: 18, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.732 Vali Acc: 0.833 Test Loss: 0.732 Test Acc: 0.833
Validation loss decreased (-0.826081 --> -0.833326).  Saving model ...
Epoch: 19 cost time: 1.0982158184051514
Epoch: 19, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.725 Vali Acc: 0.826 Test Loss: 0.725 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1471073627471924
Epoch: 20, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.738 Vali Acc: 0.833 Test Loss: 0.738 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.0990204811096191
Epoch: 21, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.821 Vali Acc: 0.812 Test Loss: 0.821 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.128967046737671
Epoch: 22, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.854 Vali Acc: 0.833 Test Loss: 0.854 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.0118303298950195
Epoch: 23, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.781 Vali Acc: 0.826 Test Loss: 0.781 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.9823026657104492
Epoch: 24, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.763 Vali Acc: 0.826 Test Loss: 0.763 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.1180212497711182
Epoch: 25, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.770 Vali Acc: 0.826 Test Loss: 0.770 Test Acc: 0.826
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.0657179355621338
Epoch: 26, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.788 Vali Acc: 0.833 Test Loss: 0.788 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.2077245712280273
Epoch: 27, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.811 Vali Acc: 0.826 Test Loss: 0.811 Test Acc: 0.826
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.0925180912017822
Epoch: 28, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.804 Vali Acc: 0.826 Test Loss: 0.804 Test Acc: 0.826
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el5_dm768_df768_ps21_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8333333333333334
model parameter : 36476932
model size : 153.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el5_dm768_df768_ps23_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.759876012802124
Epoch: 1, Steps: 9 | Train Loss: 1.479 Vali Loss: 1.331 Vali Acc: 0.348 Test Loss: 1.331 Test Acc: 0.348
Validation loss decreased (inf --> -0.347813).  Saving model ...
Epoch: 2 cost time: 1.7790346145629883
Epoch: 2, Steps: 9 | Train Loss: 1.238 Vali Loss: 1.173 Vali Acc: 0.420 Test Loss: 1.173 Test Acc: 0.420
Validation loss decreased (-0.347813 --> -0.420278).  Saving model ...
Epoch: 3 cost time: 1.9189414978027344
Epoch: 3, Steps: 9 | Train Loss: 1.051 Vali Loss: 0.976 Vali Acc: 0.609 Test Loss: 0.976 Test Acc: 0.609
Validation loss decreased (-0.420278 --> -0.608686).  Saving model ...
Epoch: 4 cost time: 1.742816686630249
Epoch: 4, Steps: 9 | Train Loss: 0.789 Vali Loss: 0.868 Vali Acc: 0.659 Test Loss: 0.868 Test Acc: 0.659
Validation loss decreased (-0.608686 --> -0.659412).  Saving model ...
Epoch: 5 cost time: 1.7509000301361084
Epoch: 5, Steps: 9 | Train Loss: 0.675 Vali Loss: 0.710 Vali Acc: 0.717 Test Loss: 0.710 Test Acc: 0.717
Validation loss decreased (-0.659412 --> -0.717384).  Saving model ...
Epoch: 6 cost time: 1.4189352989196777
Epoch: 6, Steps: 9 | Train Loss: 0.484 Vali Loss: 0.591 Vali Acc: 0.761 Test Loss: 0.591 Test Acc: 0.761
Validation loss decreased (-0.717384 --> -0.760864).  Saving model ...
Epoch: 7 cost time: 1.6027989387512207
Epoch: 7, Steps: 9 | Train Loss: 0.329 Vali Loss: 0.541 Vali Acc: 0.783 Test Loss: 0.541 Test Acc: 0.783
Validation loss decreased (-0.760864 --> -0.782603).  Saving model ...
Epoch: 8 cost time: 1.946378469467163
Epoch: 8, Steps: 9 | Train Loss: 0.228 Vali Loss: 0.560 Vali Acc: 0.812 Test Loss: 0.560 Test Acc: 0.812
Validation loss decreased (-0.782603 --> -0.811589).  Saving model ...
Epoch: 9 cost time: 1.7549455165863037
Epoch: 9, Steps: 9 | Train Loss: 0.164 Vali Loss: 0.681 Vali Acc: 0.797 Test Loss: 0.681 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7080883979797363
Epoch: 10, Steps: 9 | Train Loss: 0.099 Vali Loss: 0.898 Vali Acc: 0.790 Test Loss: 0.898 Test Acc: 0.790
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.0996694564819336
Epoch: 11, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.683 Vali Acc: 0.790 Test Loss: 0.683 Test Acc: 0.790
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.6053040027618408
Epoch: 12, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.823 Vali Acc: 0.826 Test Loss: 0.823 Test Acc: 0.826
Validation loss decreased (-0.811589 --> -0.826079).  Saving model ...
Epoch: 13 cost time: 1.8441851139068604
Epoch: 13, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.690 Vali Acc: 0.848 Test Loss: 0.690 Test Acc: 0.848
Validation loss decreased (-0.826079 --> -0.847819).  Saving model ...
Epoch: 14 cost time: 1.5102925300598145
Epoch: 14, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.742 Vali Acc: 0.833 Test Loss: 0.742 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4238548278808594
Epoch: 15, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.760 Vali Acc: 0.826 Test Loss: 0.760 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.520690679550171
Epoch: 16, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.958 Vali Acc: 0.819 Test Loss: 0.958 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.8234713077545166
Epoch: 17, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.910 Vali Acc: 0.833 Test Loss: 0.910 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.714827299118042
Epoch: 18, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.980 Vali Acc: 0.819 Test Loss: 0.980 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.7117619514465332
Epoch: 19, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.792 Vali Acc: 0.855 Test Loss: 0.792 Test Acc: 0.855
Validation loss decreased (-0.847819 --> -0.855065).  Saving model ...
Epoch: 20 cost time: 1.7352263927459717
Epoch: 20, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.741 Vali Acc: 0.855 Test Loss: 0.741 Test Acc: 0.855
Validation loss decreased (-0.855065 --> -0.855065).  Saving model ...
Epoch: 21 cost time: 1.3708462715148926
Epoch: 21, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.861 Vali Acc: 0.848 Test Loss: 0.861 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.5600180625915527
Epoch: 22, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.881 Vali Acc: 0.841 Test Loss: 0.881 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.587860107421875
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.802 Vali Acc: 0.862 Test Loss: 0.802 Test Acc: 0.862
Validation loss decreased (-0.855065 --> -0.862311).  Saving model ...
Epoch: 24 cost time: 1.7494733333587646
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.762 Vali Acc: 0.855 Test Loss: 0.762 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.6250243186950684
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.761 Vali Acc: 0.855 Test Loss: 0.761 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.154813528060913
Epoch: 26, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.806 Vali Acc: 0.848 Test Loss: 0.806 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.9051554203033447
Epoch: 27, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.831 Vali Acc: 0.855 Test Loss: 0.831 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.5719497203826904
Epoch: 28, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.833 Vali Acc: 0.848 Test Loss: 0.833 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.5904886722564697
Epoch: 29, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.833 Vali Acc: 0.848 Test Loss: 0.833 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 2.013709783554077
Epoch: 30, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.811 Vali Acc: 0.848 Test Loss: 0.811 Test Acc: 0.848
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.8902029991149902
Epoch: 31, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.803 Vali Acc: 0.855 Test Loss: 0.803 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.8332009315490723
Epoch: 32, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.821 Vali Acc: 0.848 Test Loss: 0.821 Test Acc: 0.848
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.9033682346343994
Epoch: 33, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.871 Vali Acc: 0.855 Test Loss: 0.871 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el5_dm768_df768_ps23_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8623188405797102
model parameter : 36592132
model size : 154.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el5_dm768_df768_ps23_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.5259125232696533
Epoch: 1, Steps: 9 | Train Loss: 1.490 Vali Loss: 1.373 Vali Acc: 0.333 Test Loss: 1.373 Test Acc: 0.333
Validation loss decreased (inf --> -0.333320).  Saving model ...
Epoch: 2 cost time: 1.5025827884674072
Epoch: 2, Steps: 9 | Train Loss: 1.295 Vali Loss: 1.236 Vali Acc: 0.507 Test Loss: 1.236 Test Acc: 0.507
Validation loss decreased (-0.333320 --> -0.507234).  Saving model ...
Epoch: 3 cost time: 1.7190439701080322
Epoch: 3, Steps: 9 | Train Loss: 1.153 Vali Loss: 1.108 Vali Acc: 0.638 Test Loss: 1.108 Test Acc: 0.638
Validation loss decreased (-0.507234 --> -0.637670).  Saving model ...
Epoch: 4 cost time: 1.4915940761566162
Epoch: 4, Steps: 9 | Train Loss: 0.994 Vali Loss: 0.976 Vali Acc: 0.630 Test Loss: 0.976 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4358444213867188
Epoch: 5, Steps: 9 | Train Loss: 0.813 Vali Loss: 0.894 Vali Acc: 0.645 Test Loss: 0.894 Test Acc: 0.645
Validation loss decreased (-0.637670 --> -0.644919).  Saving model ...
Epoch: 6 cost time: 1.3166978359222412
Epoch: 6, Steps: 9 | Train Loss: 0.666 Vali Loss: 0.831 Vali Acc: 0.674 Test Loss: 0.831 Test Acc: 0.674
Validation loss decreased (-0.644919 --> -0.673905).  Saving model ...
Epoch: 7 cost time: 1.5193493366241455
Epoch: 7, Steps: 9 | Train Loss: 0.521 Vali Loss: 0.731 Vali Acc: 0.717 Test Loss: 0.731 Test Acc: 0.717
Validation loss decreased (-0.673905 --> -0.717384).  Saving model ...
Epoch: 8 cost time: 0.957388162612915
Epoch: 8, Steps: 9 | Train Loss: 0.432 Vali Loss: 0.747 Vali Acc: 0.717 Test Loss: 0.747 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0654487609863281
Epoch: 9, Steps: 9 | Train Loss: 0.307 Vali Loss: 0.584 Vali Acc: 0.797 Test Loss: 0.584 Test Acc: 0.797
Validation loss decreased (-0.717384 --> -0.797096).  Saving model ...
Epoch: 10 cost time: 1.533139705657959
Epoch: 10, Steps: 9 | Train Loss: 0.212 Vali Loss: 0.737 Vali Acc: 0.790 Test Loss: 0.737 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5975334644317627
Epoch: 11, Steps: 9 | Train Loss: 0.170 Vali Loss: 0.578 Vali Acc: 0.833 Test Loss: 0.578 Test Acc: 0.833
Validation loss decreased (-0.797096 --> -0.833328).  Saving model ...
Epoch: 12 cost time: 1.0330629348754883
Epoch: 12, Steps: 9 | Train Loss: 0.099 Vali Loss: 0.742 Vali Acc: 0.790 Test Loss: 0.742 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0808947086334229
Epoch: 13, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.708 Vali Acc: 0.804 Test Loss: 0.708 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.4272100925445557
Epoch: 14, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.908 Vali Acc: 0.783 Test Loss: 0.908 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.2522192001342773
Epoch: 15, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.782 Vali Acc: 0.797 Test Loss: 0.782 Test Acc: 0.797
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.6989426612854004
Epoch: 16, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.812 Vali Acc: 0.833 Test Loss: 0.812 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.4107282161712646
Epoch: 17, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.960 Vali Acc: 0.804 Test Loss: 0.960 Test Acc: 0.804
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.4293968677520752
Epoch: 18, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.756 Vali Acc: 0.826 Test Loss: 0.756 Test Acc: 0.826
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.5538890361785889
Epoch: 19, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.809 Vali Acc: 0.833 Test Loss: 0.809 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.6957910060882568
Epoch: 20, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.937 Vali Acc: 0.812 Test Loss: 0.937 Test Acc: 0.812
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.3961498737335205
Epoch: 21, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.822 Vali Acc: 0.819 Test Loss: 0.822 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el5_dm768_df768_ps23_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8333333333333334
model parameter : 36523012
model size : 154.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el5_dm768_df768_ps23_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.817828893661499
Epoch: 1, Steps: 9 | Train Loss: 1.456 Vali Loss: 1.386 Vali Acc: 0.239 Test Loss: 1.386 Test Acc: 0.239
Validation loss decreased (inf --> -0.239117).  Saving model ...
Epoch: 2 cost time: 1.054569959640503
Epoch: 2, Steps: 9 | Train Loss: 1.376 Vali Loss: 1.312 Vali Acc: 0.478 Test Loss: 1.312 Test Acc: 0.478
Validation loss decreased (-0.239117 --> -0.478248).  Saving model ...
Epoch: 3 cost time: 1.120185375213623
Epoch: 3, Steps: 9 | Train Loss: 1.240 Vali Loss: 1.216 Vali Acc: 0.536 Test Loss: 1.216 Test Acc: 0.536
Validation loss decreased (-0.478248 --> -0.536220).  Saving model ...
Epoch: 4 cost time: 0.9724090099334717
Epoch: 4, Steps: 9 | Train Loss: 1.160 Vali Loss: 1.111 Vali Acc: 0.522 Test Loss: 1.111 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0565576553344727
Epoch: 5, Steps: 9 | Train Loss: 1.003 Vali Loss: 1.006 Vali Acc: 0.630 Test Loss: 1.006 Test Acc: 0.630
Validation loss decreased (-0.536220 --> -0.630425).  Saving model ...
Epoch: 6 cost time: 1.04123854637146
Epoch: 6, Steps: 9 | Train Loss: 0.851 Vali Loss: 0.914 Vali Acc: 0.667 Test Loss: 0.914 Test Acc: 0.667
Validation loss decreased (-0.630425 --> -0.666658).  Saving model ...
Epoch: 7 cost time: 1.2237837314605713
Epoch: 7, Steps: 9 | Train Loss: 0.726 Vali Loss: 0.803 Vali Acc: 0.638 Test Loss: 0.803 Test Acc: 0.638
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0026752948760986
Epoch: 8, Steps: 9 | Train Loss: 0.578 Vali Loss: 0.762 Vali Acc: 0.674 Test Loss: 0.762 Test Acc: 0.674
Validation loss decreased (-0.666658 --> -0.673905).  Saving model ...
Epoch: 9 cost time: 1.0915842056274414
Epoch: 9, Steps: 9 | Train Loss: 0.479 Vali Loss: 0.730 Vali Acc: 0.746 Test Loss: 0.730 Test Acc: 0.746
Validation loss decreased (-0.673905 --> -0.746370).  Saving model ...
Epoch: 10 cost time: 1.126802921295166
Epoch: 10, Steps: 9 | Train Loss: 0.402 Vali Loss: 0.674 Vali Acc: 0.775 Test Loss: 0.674 Test Acc: 0.775
Validation loss decreased (-0.746370 --> -0.775356).  Saving model ...
Epoch: 11 cost time: 1.1849513053894043
Epoch: 11, Steps: 9 | Train Loss: 0.290 Vali Loss: 0.656 Vali Acc: 0.768 Test Loss: 0.656 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.065476655960083
Epoch: 12, Steps: 9 | Train Loss: 0.238 Vali Loss: 0.659 Vali Acc: 0.775 Test Loss: 0.659 Test Acc: 0.775
Validation loss decreased (-0.775356 --> -0.775356).  Saving model ...
Epoch: 13 cost time: 1.0666172504425049
Epoch: 13, Steps: 9 | Train Loss: 0.210 Vali Loss: 0.648 Vali Acc: 0.768 Test Loss: 0.648 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1452789306640625
Epoch: 14, Steps: 9 | Train Loss: 0.115 Vali Loss: 0.726 Vali Acc: 0.783 Test Loss: 0.726 Test Acc: 0.783
Validation loss decreased (-0.775356 --> -0.782601).  Saving model ...
Epoch: 15 cost time: 1.0331993103027344
Epoch: 15, Steps: 9 | Train Loss: 0.086 Vali Loss: 0.633 Vali Acc: 0.790 Test Loss: 0.633 Test Acc: 0.790
Validation loss decreased (-0.782601 --> -0.789849).  Saving model ...
Epoch: 16 cost time: 0.9835588932037354
Epoch: 16, Steps: 9 | Train Loss: 0.062 Vali Loss: 0.697 Vali Acc: 0.783 Test Loss: 0.697 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0445306301116943
Epoch: 17, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.648 Vali Acc: 0.797 Test Loss: 0.648 Test Acc: 0.797
Validation loss decreased (-0.789849 --> -0.797095).  Saving model ...
Epoch: 18 cost time: 0.9912035465240479
Epoch: 18, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.698 Vali Acc: 0.790 Test Loss: 0.698 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0809719562530518
Epoch: 19, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.615 Vali Acc: 0.812 Test Loss: 0.615 Test Acc: 0.812
Validation loss decreased (-0.797095 --> -0.811588).  Saving model ...
Epoch: 20 cost time: 1.0761618614196777
Epoch: 20, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.734 Vali Acc: 0.812 Test Loss: 0.734 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.326026201248169
Epoch: 21, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.698 Vali Acc: 0.804 Test Loss: 0.698 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.1225860118865967
Epoch: 22, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.702 Vali Acc: 0.812 Test Loss: 0.702 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.095292091369629
Epoch: 23, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.799 Vali Acc: 0.797 Test Loss: 0.799 Test Acc: 0.797
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.9436073303222656
Epoch: 24, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.769 Vali Acc: 0.804 Test Loss: 0.769 Test Acc: 0.804
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.0980818271636963
Epoch: 25, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.769 Vali Acc: 0.804 Test Loss: 0.769 Test Acc: 0.804
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.3363902568817139
Epoch: 26, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.823 Vali Acc: 0.804 Test Loss: 0.823 Test Acc: 0.804
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.0431928634643555
Epoch: 27, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.784 Vali Acc: 0.812 Test Loss: 0.784 Test Acc: 0.812
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.9666128158569336
Epoch: 28, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.737 Vali Acc: 0.812 Test Loss: 0.737 Test Acc: 0.812
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.1317894458770752
Epoch: 29, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.789 Vali Acc: 0.812 Test Loss: 0.789 Test Acc: 0.812
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el5_dm768_df768_ps23_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8115942028985508
model parameter : 36486148
model size : 153.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el5_dm768_df768_ps26_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.526861667633057
Epoch: 1, Steps: 9 | Train Loss: 1.382 Vali Loss: 1.334 Vali Acc: 0.370 Test Loss: 1.334 Test Acc: 0.370
Validation loss decreased (inf --> -0.369552).  Saving model ...
Epoch: 2 cost time: 1.392024278640747
Epoch: 2, Steps: 9 | Train Loss: 1.213 Vali Loss: 1.177 Vali Acc: 0.558 Test Loss: 1.177 Test Acc: 0.558
Validation loss decreased (-0.369552 --> -0.557959).  Saving model ...
Epoch: 3 cost time: 1.6993319988250732
Epoch: 3, Steps: 9 | Train Loss: 1.073 Vali Loss: 1.014 Vali Acc: 0.572 Test Loss: 1.014 Test Acc: 0.572
Validation loss decreased (-0.557959 --> -0.572454).  Saving model ...
Epoch: 4 cost time: 1.9563851356506348
Epoch: 4, Steps: 9 | Train Loss: 0.844 Vali Loss: 0.865 Vali Acc: 0.681 Test Loss: 0.865 Test Acc: 0.681
Validation loss decreased (-0.572454 --> -0.681151).  Saving model ...
Epoch: 5 cost time: 1.2905724048614502
Epoch: 5, Steps: 9 | Train Loss: 0.711 Vali Loss: 0.747 Vali Acc: 0.703 Test Loss: 0.747 Test Acc: 0.703
Validation loss decreased (-0.681151 --> -0.702891).  Saving model ...
Epoch: 6 cost time: 1.6181919574737549
Epoch: 6, Steps: 9 | Train Loss: 0.539 Vali Loss: 0.649 Vali Acc: 0.746 Test Loss: 0.649 Test Acc: 0.746
Validation loss decreased (-0.702891 --> -0.746370).  Saving model ...
Epoch: 7 cost time: 1.309108018875122
Epoch: 7, Steps: 9 | Train Loss: 0.400 Vali Loss: 0.527 Vali Acc: 0.768 Test Loss: 0.527 Test Acc: 0.768
Validation loss decreased (-0.746370 --> -0.768111).  Saving model ...
Epoch: 8 cost time: 1.2681143283843994
Epoch: 8, Steps: 9 | Train Loss: 0.254 Vali Loss: 0.602 Vali Acc: 0.783 Test Loss: 0.602 Test Acc: 0.783
Validation loss decreased (-0.768111 --> -0.782603).  Saving model ...
Epoch: 9 cost time: 1.642667531967163
Epoch: 9, Steps: 9 | Train Loss: 0.154 Vali Loss: 0.440 Vali Acc: 0.841 Test Loss: 0.440 Test Acc: 0.841
Validation loss decreased (-0.782603 --> -0.840575).  Saving model ...
Epoch: 10 cost time: 1.2812118530273438
Epoch: 10, Steps: 9 | Train Loss: 0.119 Vali Loss: 0.651 Vali Acc: 0.812 Test Loss: 0.651 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4918336868286133
Epoch: 11, Steps: 9 | Train Loss: 0.060 Vali Loss: 0.638 Vali Acc: 0.804 Test Loss: 0.638 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.5472984313964844
Epoch: 12, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.521 Vali Acc: 0.855 Test Loss: 0.521 Test Acc: 0.855
Validation loss decreased (-0.840575 --> -0.855067).  Saving model ...
Epoch: 13 cost time: 1.4631526470184326
Epoch: 13, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.893 Vali Acc: 0.812 Test Loss: 0.893 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3458168506622314
Epoch: 14, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.620 Vali Acc: 0.862 Test Loss: 0.620 Test Acc: 0.862
Validation loss decreased (-0.855067 --> -0.862313).  Saving model ...
Epoch: 15 cost time: 1.5259485244750977
Epoch: 15, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.980 Vali Acc: 0.783 Test Loss: 0.980 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.4519834518432617
Epoch: 16, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.480 Vali Acc: 0.877 Test Loss: 0.480 Test Acc: 0.877
Validation loss decreased (-0.862313 --> -0.876807).  Saving model ...
Epoch: 17 cost time: 1.5925021171569824
Epoch: 17, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.820 Vali Acc: 0.819 Test Loss: 0.820 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.7347960472106934
Epoch: 18, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.696 Vali Acc: 0.833 Test Loss: 0.696 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.4093551635742188
Epoch: 19, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.745 Vali Acc: 0.848 Test Loss: 0.745 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.8024883270263672
Epoch: 20, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.824 Vali Acc: 0.826 Test Loss: 0.824 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.8953142166137695
Epoch: 21, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.798 Vali Acc: 0.841 Test Loss: 0.798 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.7566721439361572
Epoch: 22, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.747 Vali Acc: 0.848 Test Loss: 0.747 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.7976937294006348
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.720 Vali Acc: 0.848 Test Loss: 0.720 Test Acc: 0.848
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.0942461490631104
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.744 Vali Acc: 0.848 Test Loss: 0.744 Test Acc: 0.848
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.307384967803955
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.745 Vali Acc: 0.855 Test Loss: 0.745 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.7195534706115723
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.754 Vali Acc: 0.862 Test Loss: 0.754 Test Acc: 0.862
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el5_dm768_df768_ps26_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8768115942028986
model parameter : 36589828
model size : 154.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el5_dm768_df768_ps26_str13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.2837071418762207
Epoch: 1, Steps: 9 | Train Loss: 1.491 Vali Loss: 1.363 Vali Acc: 0.362 Test Loss: 1.363 Test Acc: 0.362
Validation loss decreased (inf --> -0.362305).  Saving model ...
Epoch: 2 cost time: 1.237260103225708
Epoch: 2, Steps: 9 | Train Loss: 1.342 Vali Loss: 1.305 Vali Acc: 0.341 Test Loss: 1.305 Test Acc: 0.341
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0703692436218262
Epoch: 3, Steps: 9 | Train Loss: 1.238 Vali Loss: 1.190 Vali Acc: 0.326 Test Loss: 1.190 Test Acc: 0.326
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.2588427066802979
Epoch: 4, Steps: 9 | Train Loss: 1.083 Vali Loss: 1.063 Vali Acc: 0.601 Test Loss: 1.063 Test Acc: 0.601
Validation loss decreased (-0.362305 --> -0.601439).  Saving model ...
Epoch: 5 cost time: 1.1208465099334717
Epoch: 5, Steps: 9 | Train Loss: 0.898 Vali Loss: 0.998 Vali Acc: 0.638 Test Loss: 0.998 Test Acc: 0.638
Validation loss decreased (-0.601439 --> -0.637671).  Saving model ...
Epoch: 6 cost time: 1.2690913677215576
Epoch: 6, Steps: 9 | Train Loss: 0.750 Vali Loss: 0.880 Vali Acc: 0.638 Test Loss: 0.880 Test Acc: 0.638
Validation loss decreased (-0.637671 --> -0.637672).  Saving model ...
Epoch: 7 cost time: 1.4087281227111816
Epoch: 7, Steps: 9 | Train Loss: 0.635 Vali Loss: 0.875 Vali Acc: 0.645 Test Loss: 0.875 Test Acc: 0.645
Validation loss decreased (-0.637672 --> -0.644919).  Saving model ...
Epoch: 8 cost time: 1.114820957183838
Epoch: 8, Steps: 9 | Train Loss: 0.458 Vali Loss: 0.665 Vali Acc: 0.710 Test Loss: 0.665 Test Acc: 0.710
Validation loss decreased (-0.644919 --> -0.710138).  Saving model ...
Epoch: 9 cost time: 1.1754837036132812
Epoch: 9, Steps: 9 | Train Loss: 0.310 Vali Loss: 0.637 Vali Acc: 0.761 Test Loss: 0.637 Test Acc: 0.761
Validation loss decreased (-0.710138 --> -0.760863).  Saving model ...
Epoch: 10 cost time: 1.148606300354004
Epoch: 10, Steps: 9 | Train Loss: 0.221 Vali Loss: 0.652 Vali Acc: 0.804 Test Loss: 0.652 Test Acc: 0.804
Validation loss decreased (-0.760863 --> -0.804341).  Saving model ...
Epoch: 11 cost time: 1.1396009922027588
Epoch: 11, Steps: 9 | Train Loss: 0.154 Vali Loss: 0.644 Vali Acc: 0.804 Test Loss: 0.644 Test Acc: 0.804
Validation loss decreased (-0.804341 --> -0.804341).  Saving model ...
Epoch: 12 cost time: 1.285360336303711
Epoch: 12, Steps: 9 | Train Loss: 0.107 Vali Loss: 0.776 Vali Acc: 0.804 Test Loss: 0.776 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2443060874938965
Epoch: 13, Steps: 9 | Train Loss: 0.071 Vali Loss: 0.605 Vali Acc: 0.819 Test Loss: 0.605 Test Acc: 0.819
Validation loss decreased (-0.804341 --> -0.818835).  Saving model ...
Epoch: 14 cost time: 1.0181443691253662
Epoch: 14, Steps: 9 | Train Loss: 0.053 Vali Loss: 0.664 Vali Acc: 0.841 Test Loss: 0.664 Test Acc: 0.841
Validation loss decreased (-0.818835 --> -0.840573).  Saving model ...
Epoch: 15 cost time: 0.9743573665618896
Epoch: 15, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.779 Vali Acc: 0.819 Test Loss: 0.779 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0759027004241943
Epoch: 16, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.793 Vali Acc: 0.761 Test Loss: 0.793 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.3105177879333496
Epoch: 17, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.727 Vali Acc: 0.833 Test Loss: 0.727 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.0429449081420898
Epoch: 18, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.628 Vali Acc: 0.826 Test Loss: 0.628 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.8585853576660156
Epoch: 19, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.804 Vali Acc: 0.790 Test Loss: 0.804 Test Acc: 0.790
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.7921390533447266
Epoch: 20, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.756 Vali Acc: 0.833 Test Loss: 0.756 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.9365830421447754
Epoch: 21, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.761 Vali Acc: 0.819 Test Loss: 0.761 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.0142786502838135
Epoch: 22, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.821 Vali Acc: 0.819 Test Loss: 0.821 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.0698966979980469
Epoch: 23, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.843 Vali Acc: 0.841 Test Loss: 0.843 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.3158013820648193
Epoch: 24, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.787 Vali Acc: 0.841 Test Loss: 0.787 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el5_dm768_df768_ps26_str13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8405797101449275
model parameter : 36534532
model size : 154.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el5_dm768_df768_ps26_str26_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.0176799297332764
Epoch: 1, Steps: 9 | Train Loss: 1.492 Vali Loss: 1.389 Vali Acc: 0.268 Test Loss: 1.389 Test Acc: 0.268
Validation loss decreased (inf --> -0.268102).  Saving model ...
Epoch: 2 cost time: 0.8083646297454834
Epoch: 2, Steps: 9 | Train Loss: 1.364 Vali Loss: 1.309 Vali Acc: 0.442 Test Loss: 1.309 Test Acc: 0.442
Validation loss decreased (-0.268102 --> -0.442016).  Saving model ...
Epoch: 3 cost time: 0.8819255828857422
Epoch: 3, Steps: 9 | Train Loss: 1.250 Vali Loss: 1.225 Vali Acc: 0.529 Test Loss: 1.225 Test Acc: 0.529
Validation loss decreased (-0.442016 --> -0.528973).  Saving model ...
Epoch: 4 cost time: 0.9063122272491455
Epoch: 4, Steps: 9 | Train Loss: 1.175 Vali Loss: 1.129 Vali Acc: 0.594 Test Loss: 1.129 Test Acc: 0.594
Validation loss decreased (-0.528973 --> -0.594192).  Saving model ...
Epoch: 5 cost time: 0.8337459564208984
Epoch: 5, Steps: 9 | Train Loss: 1.016 Vali Loss: 1.038 Vali Acc: 0.587 Test Loss: 1.038 Test Acc: 0.587
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9718079566955566
Epoch: 6, Steps: 9 | Train Loss: 0.897 Vali Loss: 0.969 Vali Acc: 0.638 Test Loss: 0.969 Test Acc: 0.638
Validation loss decreased (-0.594192 --> -0.637671).  Saving model ...
Epoch: 7 cost time: 0.9827384948730469
Epoch: 7, Steps: 9 | Train Loss: 0.740 Vali Loss: 0.878 Vali Acc: 0.652 Test Loss: 0.878 Test Acc: 0.652
Validation loss decreased (-0.637671 --> -0.652165).  Saving model ...
Epoch: 8 cost time: 0.9178481101989746
Epoch: 8, Steps: 9 | Train Loss: 0.627 Vali Loss: 0.842 Vali Acc: 0.645 Test Loss: 0.842 Test Acc: 0.645
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0618083477020264
Epoch: 9, Steps: 9 | Train Loss: 0.498 Vali Loss: 0.831 Vali Acc: 0.645 Test Loss: 0.831 Test Acc: 0.645
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8988471031188965
Epoch: 10, Steps: 9 | Train Loss: 0.369 Vali Loss: 0.729 Vali Acc: 0.732 Test Loss: 0.729 Test Acc: 0.732
Validation loss decreased (-0.652165 --> -0.731877).  Saving model ...
Epoch: 11 cost time: 0.9733164310455322
Epoch: 11, Steps: 9 | Train Loss: 0.304 Vali Loss: 0.755 Vali Acc: 0.739 Test Loss: 0.755 Test Acc: 0.739
Validation loss decreased (-0.731877 --> -0.739123).  Saving model ...
Epoch: 12 cost time: 1.2001025676727295
Epoch: 12, Steps: 9 | Train Loss: 0.230 Vali Loss: 0.735 Vali Acc: 0.710 Test Loss: 0.735 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.006411075592041
Epoch: 13, Steps: 9 | Train Loss: 0.171 Vali Loss: 0.754 Vali Acc: 0.746 Test Loss: 0.754 Test Acc: 0.746
Validation loss decreased (-0.739123 --> -0.746369).  Saving model ...
Epoch: 14 cost time: 0.8846697807312012
Epoch: 14, Steps: 9 | Train Loss: 0.124 Vali Loss: 0.746 Vali Acc: 0.754 Test Loss: 0.746 Test Acc: 0.754
Validation loss decreased (-0.746369 --> -0.753616).  Saving model ...
Epoch: 15 cost time: 0.9750978946685791
Epoch: 15, Steps: 9 | Train Loss: 0.073 Vali Loss: 0.712 Vali Acc: 0.761 Test Loss: 0.712 Test Acc: 0.761
Validation loss decreased (-0.753616 --> -0.760862).  Saving model ...
Epoch: 16 cost time: 1.067115068435669
Epoch: 16, Steps: 9 | Train Loss: 0.062 Vali Loss: 0.754 Vali Acc: 0.746 Test Loss: 0.754 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.4514880180358887
Epoch: 17, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.704 Vali Acc: 0.775 Test Loss: 0.704 Test Acc: 0.775
Validation loss decreased (-0.760862 --> -0.775355).  Saving model ...
Epoch: 18 cost time: 0.9740023612976074
Epoch: 18, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.858 Vali Acc: 0.768 Test Loss: 0.858 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1713120937347412
Epoch: 19, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.813 Vali Acc: 0.768 Test Loss: 0.813 Test Acc: 0.768
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.1152427196502686
Epoch: 20, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.844 Vali Acc: 0.783 Test Loss: 0.844 Test Acc: 0.783
Validation loss decreased (-0.775355 --> -0.782600).  Saving model ...
Epoch: 21 cost time: 1.1217246055603027
Epoch: 21, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.912 Vali Acc: 0.790 Test Loss: 0.912 Test Acc: 0.790
Validation loss decreased (-0.782600 --> -0.789846).  Saving model ...
Epoch: 22 cost time: 1.1072216033935547
Epoch: 22, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.887 Vali Acc: 0.797 Test Loss: 0.887 Test Acc: 0.797
Validation loss decreased (-0.789846 --> -0.797093).  Saving model ...
Epoch: 23 cost time: 1.2213056087493896
Epoch: 23, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.870 Vali Acc: 0.790 Test Loss: 0.870 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.2288823127746582
Epoch: 24, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.887 Vali Acc: 0.797 Test Loss: 0.887 Test Acc: 0.797
Validation loss decreased (-0.797093 --> -0.797093).  Saving model ...
Epoch: 25 cost time: 1.048304557800293
Epoch: 25, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.909 Vali Acc: 0.804 Test Loss: 0.909 Test Acc: 0.804
Validation loss decreased (-0.797093 --> -0.804339).  Saving model ...
Epoch: 26 cost time: 0.984459400177002
Epoch: 26, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.861 Vali Acc: 0.804 Test Loss: 0.861 Test Acc: 0.804
Validation loss decreased (-0.804339 --> -0.804339).  Saving model ...
Epoch: 27 cost time: 0.907905101776123
Epoch: 27, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.848 Vali Acc: 0.797 Test Loss: 0.848 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.0111644268035889
Epoch: 28, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.871 Vali Acc: 0.797 Test Loss: 0.871 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.1419167518615723
Epoch: 29, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.963 Vali Acc: 0.804 Test Loss: 0.963 Test Acc: 0.804
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.0427072048187256
Epoch: 30, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.909 Vali Acc: 0.812 Test Loss: 0.909 Test Acc: 0.812
Validation loss decreased (-0.804339 --> -0.811585).  Saving model ...
Epoch: 31 cost time: 1.373931646347046
Epoch: 31, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.840 Vali Acc: 0.812 Test Loss: 0.840 Test Acc: 0.812
Validation loss decreased (-0.811585 --> -0.811586).  Saving model ...
Epoch: 32 cost time: 1.1183855533599854
Epoch: 32, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.852 Vali Acc: 0.819 Test Loss: 0.852 Test Acc: 0.819
Validation loss decreased (-0.811586 --> -0.818832).  Saving model ...
Epoch: 33 cost time: 1.1778059005737305
Epoch: 33, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.923 Vali Acc: 0.819 Test Loss: 0.923 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.930534839630127
Epoch: 34, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.909 Vali Acc: 0.812 Test Loss: 0.909 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.9191436767578125
Epoch: 35, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.903 Vali Acc: 0.797 Test Loss: 0.903 Test Acc: 0.797
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.7204568386077881
Epoch: 36, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.928 Vali Acc: 0.797 Test Loss: 0.928 Test Acc: 0.797
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.9550056457519531
Epoch: 37, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.884 Vali Acc: 0.797 Test Loss: 0.884 Test Acc: 0.797
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.8847897052764893
Epoch: 38, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.899 Vali Acc: 0.797 Test Loss: 0.899 Test Acc: 0.797
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.9445414543151855
Epoch: 39, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.960 Vali Acc: 0.797 Test Loss: 0.960 Test Acc: 0.797
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.8728656768798828
Epoch: 40, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.003 Vali Acc: 0.804 Test Loss: 1.003 Test Acc: 0.804
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.4090466499328613
Epoch: 41, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.977 Vali Acc: 0.804 Test Loss: 0.977 Test Acc: 0.804
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.0145790576934814
Epoch: 42, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.924 Vali Acc: 0.797 Test Loss: 0.924 Test Acc: 0.797
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el5_dm768_df768_ps26_str26_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8188405797101449
model parameter : 36502276
model size : 153.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el5_dm768_df768_ps30_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.5460150241851807
Epoch: 1, Steps: 9 | Train Loss: 1.471 Vali Loss: 1.378 Vali Acc: 0.268 Test Loss: 1.378 Test Acc: 0.268
Validation loss decreased (inf --> -0.268102).  Saving model ...
Epoch: 2 cost time: 1.3756756782531738
Epoch: 2, Steps: 9 | Train Loss: 1.280 Vali Loss: 1.205 Vali Acc: 0.449 Test Loss: 1.205 Test Acc: 0.449
Validation loss decreased (-0.268102 --> -0.449263).  Saving model ...
Epoch: 3 cost time: 1.1909267902374268
Epoch: 3, Steps: 9 | Train Loss: 1.090 Vali Loss: 1.052 Vali Acc: 0.616 Test Loss: 1.052 Test Acc: 0.616
Validation loss decreased (-0.449263 --> -0.615932).  Saving model ...
Epoch: 4 cost time: 1.3142638206481934
Epoch: 4, Steps: 9 | Train Loss: 0.940 Vali Loss: 0.918 Vali Acc: 0.630 Test Loss: 0.918 Test Acc: 0.630
Validation loss decreased (-0.615932 --> -0.630426).  Saving model ...
Epoch: 5 cost time: 1.2670629024505615
Epoch: 5, Steps: 9 | Train Loss: 0.779 Vali Loss: 0.815 Vali Acc: 0.659 Test Loss: 0.815 Test Acc: 0.659
Validation loss decreased (-0.630426 --> -0.659412).  Saving model ...
Epoch: 6 cost time: 1.6362197399139404
Epoch: 6, Steps: 9 | Train Loss: 0.566 Vali Loss: 0.689 Vali Acc: 0.688 Test Loss: 0.689 Test Acc: 0.688
Validation loss decreased (-0.659412 --> -0.688399).  Saving model ...
Epoch: 7 cost time: 1.4916424751281738
Epoch: 7, Steps: 9 | Train Loss: 0.425 Vali Loss: 0.601 Vali Acc: 0.754 Test Loss: 0.601 Test Acc: 0.754
Validation loss decreased (-0.688399 --> -0.753617).  Saving model ...
Epoch: 8 cost time: 1.339003562927246
Epoch: 8, Steps: 9 | Train Loss: 0.290 Vali Loss: 0.646 Vali Acc: 0.696 Test Loss: 0.646 Test Acc: 0.696
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5291109085083008
Epoch: 9, Steps: 9 | Train Loss: 0.158 Vali Loss: 0.878 Vali Acc: 0.775 Test Loss: 0.878 Test Acc: 0.775
Validation loss decreased (-0.753617 --> -0.775354).  Saving model ...
Epoch: 10 cost time: 1.5516290664672852
Epoch: 10, Steps: 9 | Train Loss: 0.170 Vali Loss: 0.485 Vali Acc: 0.819 Test Loss: 0.485 Test Acc: 0.819
Validation loss decreased (-0.775354 --> -0.818836).  Saving model ...
Epoch: 11 cost time: 1.190504789352417
Epoch: 11, Steps: 9 | Train Loss: 0.072 Vali Loss: 0.790 Vali Acc: 0.797 Test Loss: 0.790 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8773293495178223
Epoch: 12, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.601 Vali Acc: 0.819 Test Loss: 0.601 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.6262168884277344
Epoch: 13, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.694 Vali Acc: 0.812 Test Loss: 0.694 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.2148480415344238
Epoch: 14, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.889 Vali Acc: 0.804 Test Loss: 0.889 Test Acc: 0.804
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.8041179180145264
Epoch: 15, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.616 Vali Acc: 0.855 Test Loss: 0.616 Test Acc: 0.855
Validation loss decreased (-0.818836 --> -0.855066).  Saving model ...
Epoch: 16 cost time: 1.8111016750335693
Epoch: 16, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.707 Vali Acc: 0.819 Test Loss: 0.707 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2075347900390625
Epoch: 17, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.730 Vali Acc: 0.819 Test Loss: 0.730 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.2481868267059326
Epoch: 18, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.723 Vali Acc: 0.819 Test Loss: 0.723 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.4494149684906006
Epoch: 19, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.802 Vali Acc: 0.833 Test Loss: 0.802 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.779240369796753
Epoch: 20, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.831 Vali Acc: 0.833 Test Loss: 0.831 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.9655299186706543
Epoch: 21, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.777 Vali Acc: 0.833 Test Loss: 0.777 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.7700743675231934
Epoch: 22, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.735 Vali Acc: 0.833 Test Loss: 0.735 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.4266443252563477
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.764 Vali Acc: 0.833 Test Loss: 0.764 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.6139307022094727
Epoch: 24, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.765 Vali Acc: 0.841 Test Loss: 0.765 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.5631341934204102
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.787 Vali Acc: 0.841 Test Loss: 0.787 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el5_dm768_df768_ps30_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.855072463768116
model parameter : 36603652
model size : 154.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el5_dm768_df768_ps30_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.447986364364624
Epoch: 1, Steps: 9 | Train Loss: 1.414 Vali Loss: 1.410 Vali Acc: 0.181 Test Loss: 1.410 Test Acc: 0.181
Validation loss decreased (inf --> -0.181145).  Saving model ...
Epoch: 2 cost time: 1.2141060829162598
Epoch: 2, Steps: 9 | Train Loss: 1.325 Vali Loss: 1.307 Vali Acc: 0.406 Test Loss: 1.307 Test Acc: 0.406
Validation loss decreased (-0.181145 --> -0.405784).  Saving model ...
Epoch: 3 cost time: 0.9552469253540039
Epoch: 3, Steps: 9 | Train Loss: 1.222 Vali Loss: 1.219 Vali Acc: 0.457 Test Loss: 1.219 Test Acc: 0.457
Validation loss decreased (-0.405784 --> -0.456510).  Saving model ...
Epoch: 4 cost time: 1.0967047214508057
Epoch: 4, Steps: 9 | Train Loss: 1.108 Vali Loss: 1.132 Vali Acc: 0.449 Test Loss: 1.132 Test Acc: 0.449
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1241183280944824
Epoch: 5, Steps: 9 | Train Loss: 0.962 Vali Loss: 1.028 Vali Acc: 0.522 Test Loss: 1.028 Test Acc: 0.522
Validation loss decreased (-0.456510 --> -0.521729).  Saving model ...
Epoch: 6 cost time: 0.9767947196960449
Epoch: 6, Steps: 9 | Train Loss: 0.875 Vali Loss: 0.912 Vali Acc: 0.623 Test Loss: 0.912 Test Acc: 0.623
Validation loss decreased (-0.521729 --> -0.623179).  Saving model ...
Epoch: 7 cost time: 1.2887518405914307
Epoch: 7, Steps: 9 | Train Loss: 0.689 Vali Loss: 0.814 Vali Acc: 0.638 Test Loss: 0.814 Test Acc: 0.638
Validation loss decreased (-0.623179 --> -0.637673).  Saving model ...
Epoch: 8 cost time: 1.2874677181243896
Epoch: 8, Steps: 9 | Train Loss: 0.538 Vali Loss: 0.713 Vali Acc: 0.681 Test Loss: 0.713 Test Acc: 0.681
Validation loss decreased (-0.637673 --> -0.681152).  Saving model ...
Epoch: 9 cost time: 1.158294439315796
Epoch: 9, Steps: 9 | Train Loss: 0.375 Vali Loss: 0.676 Vali Acc: 0.674 Test Loss: 0.676 Test Acc: 0.674
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1006255149841309
Epoch: 10, Steps: 9 | Train Loss: 0.271 Vali Loss: 0.513 Vali Acc: 0.790 Test Loss: 0.513 Test Acc: 0.790
Validation loss decreased (-0.681152 --> -0.789850).  Saving model ...
Epoch: 11 cost time: 1.0519483089447021
Epoch: 11, Steps: 9 | Train Loss: 0.231 Vali Loss: 0.740 Vali Acc: 0.732 Test Loss: 0.740 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2424492835998535
Epoch: 12, Steps: 9 | Train Loss: 0.130 Vali Loss: 0.527 Vali Acc: 0.819 Test Loss: 0.527 Test Acc: 0.819
Validation loss decreased (-0.789850 --> -0.818835).  Saving model ...
Epoch: 13 cost time: 1.0586929321289062
Epoch: 13, Steps: 9 | Train Loss: 0.091 Vali Loss: 0.615 Vali Acc: 0.819 Test Loss: 0.615 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.130871057510376
Epoch: 14, Steps: 9 | Train Loss: 0.071 Vali Loss: 0.682 Vali Acc: 0.797 Test Loss: 0.682 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.209336519241333
Epoch: 15, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.653 Vali Acc: 0.841 Test Loss: 0.653 Test Acc: 0.841
Validation loss decreased (-0.818835 --> -0.840573).  Saving model ...
Epoch: 16 cost time: 1.1093435287475586
Epoch: 16, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.710 Vali Acc: 0.790 Test Loss: 0.710 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0792899131774902
Epoch: 17, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.676 Vali Acc: 0.819 Test Loss: 0.676 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.4029991626739502
Epoch: 18, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.692 Vali Acc: 0.848 Test Loss: 0.692 Test Acc: 0.848
Validation loss decreased (-0.840573 --> -0.847819).  Saving model ...
Epoch: 19 cost time: 0.8974106311798096
Epoch: 19, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.715 Vali Acc: 0.812 Test Loss: 0.715 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8656919002532959
Epoch: 20, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.728 Vali Acc: 0.855 Test Loss: 0.728 Test Acc: 0.855
Validation loss decreased (-0.847819 --> -0.855065).  Saving model ...
Epoch: 21 cost time: 1.130275011062622
Epoch: 21, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.748 Vali Acc: 0.848 Test Loss: 0.748 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9226388931274414
Epoch: 22, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.774 Vali Acc: 0.826 Test Loss: 0.774 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.0249078273773193
Epoch: 23, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.742 Vali Acc: 0.848 Test Loss: 0.742 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.4141228199005127
Epoch: 24, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.776 Vali Acc: 0.848 Test Loss: 0.776 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.2551295757293701
Epoch: 25, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.818 Vali Acc: 0.826 Test Loss: 0.818 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.043806791305542
Epoch: 26, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.791 Vali Acc: 0.855 Test Loss: 0.791 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.0014243125915527
Epoch: 27, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.813 Vali Acc: 0.833 Test Loss: 0.813 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.470275640487671
Epoch: 28, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.822 Vali Acc: 0.841 Test Loss: 0.822 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.196751594543457
Epoch: 29, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.803 Vali Acc: 0.848 Test Loss: 0.803 Test Acc: 0.848
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.305027723312378
Epoch: 30, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.790 Vali Acc: 0.848 Test Loss: 0.790 Test Acc: 0.848
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el5_dm768_df768_ps30_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.855072463768116
model parameter : 36552964
model size : 154.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el5_dm768_df768_ps30_str30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.101390838623047
Epoch: 1, Steps: 9 | Train Loss: 1.418 Vali Loss: 1.374 Vali Acc: 0.341 Test Loss: 1.374 Test Acc: 0.341
Validation loss decreased (inf --> -0.340566).  Saving model ...
Epoch: 2 cost time: 0.9569005966186523
Epoch: 2, Steps: 9 | Train Loss: 1.356 Vali Loss: 1.325 Vali Acc: 0.348 Test Loss: 1.325 Test Acc: 0.348
Validation loss decreased (-0.340566 --> -0.347813).  Saving model ...
Epoch: 3 cost time: 0.8708958625793457
Epoch: 3, Steps: 9 | Train Loss: 1.255 Vali Loss: 1.260 Vali Acc: 0.348 Test Loss: 1.260 Test Acc: 0.348
Validation loss decreased (-0.347813 --> -0.347813).  Saving model ...
Epoch: 4 cost time: 0.9593968391418457
Epoch: 4, Steps: 9 | Train Loss: 1.156 Vali Loss: 1.168 Vali Acc: 0.580 Test Loss: 1.168 Test Acc: 0.580
Validation loss decreased (-0.347813 --> -0.579698).  Saving model ...
Epoch: 5 cost time: 0.9535577297210693
Epoch: 5, Steps: 9 | Train Loss: 1.062 Vali Loss: 1.065 Vali Acc: 0.601 Test Loss: 1.065 Test Acc: 0.601
Validation loss decreased (-0.579698 --> -0.601439).  Saving model ...
Epoch: 6 cost time: 0.9914078712463379
Epoch: 6, Steps: 9 | Train Loss: 0.939 Vali Loss: 0.963 Vali Acc: 0.580 Test Loss: 0.963 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8987154960632324
Epoch: 7, Steps: 9 | Train Loss: 0.790 Vali Loss: 0.867 Vali Acc: 0.601 Test Loss: 0.867 Test Acc: 0.601
Validation loss decreased (-0.601439 --> -0.601441).  Saving model ...
Epoch: 8 cost time: 1.075559377670288
Epoch: 8, Steps: 9 | Train Loss: 0.691 Vali Loss: 0.796 Vali Acc: 0.630 Test Loss: 0.796 Test Acc: 0.630
Validation loss decreased (-0.601441 --> -0.630427).  Saving model ...
Epoch: 9 cost time: 0.899540901184082
Epoch: 9, Steps: 9 | Train Loss: 0.562 Vali Loss: 0.750 Vali Acc: 0.659 Test Loss: 0.750 Test Acc: 0.659
Validation loss decreased (-0.630427 --> -0.659413).  Saving model ...
Epoch: 10 cost time: 0.89023756980896
Epoch: 10, Steps: 9 | Train Loss: 0.459 Vali Loss: 0.725 Vali Acc: 0.638 Test Loss: 0.725 Test Acc: 0.638
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0828373432159424
Epoch: 11, Steps: 9 | Train Loss: 0.414 Vali Loss: 0.771 Vali Acc: 0.645 Test Loss: 0.771 Test Acc: 0.645
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.0465471744537354
Epoch: 12, Steps: 9 | Train Loss: 0.330 Vali Loss: 0.678 Vali Acc: 0.732 Test Loss: 0.678 Test Acc: 0.732
Validation loss decreased (-0.659413 --> -0.731877).  Saving model ...
Epoch: 13 cost time: 1.0248265266418457
Epoch: 13, Steps: 9 | Train Loss: 0.239 Vali Loss: 0.629 Vali Acc: 0.739 Test Loss: 0.629 Test Acc: 0.739
Validation loss decreased (-0.731877 --> -0.739124).  Saving model ...
Epoch: 14 cost time: 1.2307751178741455
Epoch: 14, Steps: 9 | Train Loss: 0.194 Vali Loss: 0.685 Vali Acc: 0.732 Test Loss: 0.685 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1346187591552734
Epoch: 15, Steps: 9 | Train Loss: 0.166 Vali Loss: 0.608 Vali Acc: 0.754 Test Loss: 0.608 Test Acc: 0.754
Validation loss decreased (-0.739124 --> -0.753617).  Saving model ...
Epoch: 16 cost time: 1.0102527141571045
Epoch: 16, Steps: 9 | Train Loss: 0.111 Vali Loss: 0.744 Vali Acc: 0.710 Test Loss: 0.744 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9861044883728027
Epoch: 17, Steps: 9 | Train Loss: 0.096 Vali Loss: 0.609 Vali Acc: 0.783 Test Loss: 0.609 Test Acc: 0.783
Validation loss decreased (-0.753617 --> -0.782603).  Saving model ...
Epoch: 18 cost time: 1.0540904998779297
Epoch: 18, Steps: 9 | Train Loss: 0.048 Vali Loss: 0.682 Vali Acc: 0.754 Test Loss: 0.682 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9733269214630127
Epoch: 19, Steps: 9 | Train Loss: 0.047 Vali Loss: 0.695 Vali Acc: 0.768 Test Loss: 0.695 Test Acc: 0.768
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.870962381362915
Epoch: 20, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.615 Vali Acc: 0.783 Test Loss: 0.615 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.8589861392974854
Epoch: 21, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.690 Vali Acc: 0.775 Test Loss: 0.690 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.9991004467010498
Epoch: 22, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.756 Vali Acc: 0.783 Test Loss: 0.756 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.0246267318725586
Epoch: 23, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.698 Vali Acc: 0.739 Test Loss: 0.698 Test Acc: 0.739
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.9285871982574463
Epoch: 24, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.643 Vali Acc: 0.768 Test Loss: 0.643 Test Acc: 0.768
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.0105669498443604
Epoch: 25, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.721 Vali Acc: 0.804 Test Loss: 0.721 Test Acc: 0.804
Validation loss decreased (-0.782603 --> -0.804341).  Saving model ...
Epoch: 26 cost time: 1.0639736652374268
Epoch: 26, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.757 Vali Acc: 0.797 Test Loss: 0.757 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.1186835765838623
Epoch: 27, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.717 Vali Acc: 0.761 Test Loss: 0.717 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.0769414901733398
Epoch: 28, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.747 Vali Acc: 0.761 Test Loss: 0.747 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.1324195861816406
Epoch: 29, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.788 Vali Acc: 0.775 Test Loss: 0.788 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.001258134841919
Epoch: 30, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.800 Vali Acc: 0.761 Test Loss: 0.800 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.0052971839904785
Epoch: 31, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.789 Vali Acc: 0.761 Test Loss: 0.789 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.004612684249878
Epoch: 32, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.774 Vali Acc: 0.783 Test Loss: 0.774 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.1385295391082764
Epoch: 33, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.778 Vali Acc: 0.790 Test Loss: 0.778 Test Acc: 0.790
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.113600730895996
Epoch: 34, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.767 Vali Acc: 0.797 Test Loss: 0.767 Test Acc: 0.797
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.1519224643707275
Epoch: 35, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.748 Vali Acc: 0.797 Test Loss: 0.748 Test Acc: 0.797
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el5_dm768_df768_ps30_str30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8043478260869565
model parameter : 36525316
model size : 154.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el5_dm768_df768_ps35_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.5597610473632812
Epoch: 1, Steps: 9 | Train Loss: 1.496 Vali Loss: 1.372 Vali Acc: 0.290 Test Loss: 1.372 Test Acc: 0.290
Validation loss decreased (inf --> -0.289841).  Saving model ...
Epoch: 2 cost time: 1.5900027751922607
Epoch: 2, Steps: 9 | Train Loss: 1.295 Vali Loss: 1.253 Vali Acc: 0.341 Test Loss: 1.253 Test Acc: 0.341
Validation loss decreased (-0.289841 --> -0.340567).  Saving model ...
Epoch: 3 cost time: 1.8876478672027588
Epoch: 3, Steps: 9 | Train Loss: 1.106 Vali Loss: 1.112 Vali Acc: 0.630 Test Loss: 1.112 Test Acc: 0.630
Validation loss decreased (-0.340567 --> -0.630424).  Saving model ...
Epoch: 4 cost time: 1.8217101097106934
Epoch: 4, Steps: 9 | Train Loss: 0.958 Vali Loss: 0.995 Vali Acc: 0.601 Test Loss: 0.995 Test Acc: 0.601
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6825687885284424
Epoch: 5, Steps: 9 | Train Loss: 0.787 Vali Loss: 0.866 Vali Acc: 0.659 Test Loss: 0.866 Test Acc: 0.659
Validation loss decreased (-0.630424 --> -0.659412).  Saving model ...
Epoch: 6 cost time: 1.585916519165039
Epoch: 6, Steps: 9 | Train Loss: 0.612 Vali Loss: 0.719 Vali Acc: 0.746 Test Loss: 0.719 Test Acc: 0.746
Validation loss decreased (-0.659412 --> -0.746370).  Saving model ...
Epoch: 7 cost time: 1.4133496284484863
Epoch: 7, Steps: 9 | Train Loss: 0.466 Vali Loss: 0.675 Vali Acc: 0.703 Test Loss: 0.675 Test Acc: 0.703
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2469992637634277
Epoch: 8, Steps: 9 | Train Loss: 0.314 Vali Loss: 0.584 Vali Acc: 0.826 Test Loss: 0.584 Test Acc: 0.826
Validation loss decreased (-0.746370 --> -0.826081).  Saving model ...
Epoch: 9 cost time: 1.519944429397583
Epoch: 9, Steps: 9 | Train Loss: 0.199 Vali Loss: 0.594 Vali Acc: 0.812 Test Loss: 0.594 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7453136444091797
Epoch: 10, Steps: 9 | Train Loss: 0.153 Vali Loss: 0.875 Vali Acc: 0.783 Test Loss: 0.875 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.5354390144348145
Epoch: 11, Steps: 9 | Train Loss: 0.123 Vali Loss: 0.623 Vali Acc: 0.819 Test Loss: 0.623 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.7239820957183838
Epoch: 12, Steps: 9 | Train Loss: 0.069 Vali Loss: 0.629 Vali Acc: 0.819 Test Loss: 0.629 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.928565502166748
Epoch: 13, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.837 Vali Acc: 0.804 Test Loss: 0.837 Test Acc: 0.804
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.3378162384033203
Epoch: 14, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.638 Vali Acc: 0.826 Test Loss: 0.638 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.8955175876617432
Epoch: 15, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.917 Vali Acc: 0.797 Test Loss: 0.917 Test Acc: 0.797
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.6087231636047363
Epoch: 16, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.831 Vali Acc: 0.833 Test Loss: 0.831 Test Acc: 0.833
Validation loss decreased (-0.826081 --> -0.833325).  Saving model ...
Epoch: 17 cost time: 1.4010400772094727
Epoch: 17, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.847 Vali Acc: 0.804 Test Loss: 0.847 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1967461109161377
Epoch: 18, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.824 Vali Acc: 0.826 Test Loss: 0.824 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.2905523777008057
Epoch: 19, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.936 Vali Acc: 0.812 Test Loss: 0.936 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.2091598510742188
Epoch: 20, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.930 Vali Acc: 0.812 Test Loss: 0.930 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.183603286743164
Epoch: 21, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.891 Vali Acc: 0.819 Test Loss: 0.891 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.1318957805633545
Epoch: 22, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.955 Vali Acc: 0.812 Test Loss: 0.955 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.488671064376831
Epoch: 23, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.005 Vali Acc: 0.812 Test Loss: 1.005 Test Acc: 0.812
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.8438804149627686
Epoch: 24, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.981 Vali Acc: 0.819 Test Loss: 0.981 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.6466381549835205
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.933 Vali Acc: 0.833 Test Loss: 0.933 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.7819867134094238
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.940 Vali Acc: 0.841 Test Loss: 0.940 Test Acc: 0.841
Validation loss decreased (-0.833325 --> -0.840570).  Saving model ...
Epoch: 27 cost time: 1.469280481338501
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.977 Vali Acc: 0.826 Test Loss: 0.977 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.4244022369384766
Epoch: 28, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.006 Vali Acc: 0.826 Test Loss: 1.006 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.3535714149475098
Epoch: 29, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.988 Vali Acc: 0.826 Test Loss: 0.988 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.4021382331848145
Epoch: 30, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.966 Vali Acc: 0.826 Test Loss: 0.966 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.2259306907653809
Epoch: 31, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.971 Vali Acc: 0.819 Test Loss: 0.971 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.290583848953247
Epoch: 32, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.000 Vali Acc: 0.819 Test Loss: 1.000 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.1075749397277832
Epoch: 33, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.020 Vali Acc: 0.826 Test Loss: 1.020 Test Acc: 0.826
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.6295185089111328
Epoch: 34, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.006 Vali Acc: 0.826 Test Loss: 1.006 Test Acc: 0.826
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.31357741355896
Epoch: 35, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.994 Vali Acc: 0.833 Test Loss: 0.994 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.510265588760376
Epoch: 36, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.014 Vali Acc: 0.833 Test Loss: 1.014 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el5_dm768_df768_ps35_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8405797101449275
model parameter : 36624388
model size : 154.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el5_dm768_df768_ps35_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.9067134857177734
Epoch: 1, Steps: 9 | Train Loss: 1.469 Vali Loss: 1.380 Vali Acc: 0.290 Test Loss: 1.380 Test Acc: 0.290
Validation loss decreased (inf --> -0.289841).  Saving model ...
Epoch: 2 cost time: 1.2292144298553467
Epoch: 2, Steps: 9 | Train Loss: 1.341 Vali Loss: 1.287 Vali Acc: 0.391 Test Loss: 1.287 Test Acc: 0.391
Validation loss decreased (-0.289841 --> -0.391291).  Saving model ...
Epoch: 3 cost time: 1.4627816677093506
Epoch: 3, Steps: 9 | Train Loss: 1.238 Vali Loss: 1.181 Vali Acc: 0.558 Test Loss: 1.181 Test Acc: 0.558
Validation loss decreased (-0.391291 --> -0.557959).  Saving model ...
Epoch: 4 cost time: 1.361159324645996
Epoch: 4, Steps: 9 | Train Loss: 1.118 Vali Loss: 1.075 Vali Acc: 0.572 Test Loss: 1.075 Test Acc: 0.572
Validation loss decreased (-0.557959 --> -0.572453).  Saving model ...
Epoch: 5 cost time: 1.0943055152893066
Epoch: 5, Steps: 9 | Train Loss: 0.964 Vali Loss: 0.964 Vali Acc: 0.630 Test Loss: 0.964 Test Acc: 0.630
Validation loss decreased (-0.572453 --> -0.630425).  Saving model ...
Epoch: 6 cost time: 1.2391130924224854
Epoch: 6, Steps: 9 | Train Loss: 0.791 Vali Loss: 0.859 Vali Acc: 0.667 Test Loss: 0.859 Test Acc: 0.667
Validation loss decreased (-0.630425 --> -0.666658).  Saving model ...
Epoch: 7 cost time: 1.4481678009033203
Epoch: 7, Steps: 9 | Train Loss: 0.682 Vali Loss: 0.800 Vali Acc: 0.681 Test Loss: 0.800 Test Acc: 0.681
Validation loss decreased (-0.666658 --> -0.681151).  Saving model ...
Epoch: 8 cost time: 1.0581822395324707
Epoch: 8, Steps: 9 | Train Loss: 0.528 Vali Loss: 0.710 Vali Acc: 0.725 Test Loss: 0.710 Test Acc: 0.725
Validation loss decreased (-0.681151 --> -0.724631).  Saving model ...
Epoch: 9 cost time: 1.168208360671997
Epoch: 9, Steps: 9 | Train Loss: 0.444 Vali Loss: 0.698 Vali Acc: 0.732 Test Loss: 0.698 Test Acc: 0.732
Validation loss decreased (-0.724631 --> -0.731877).  Saving model ...
Epoch: 10 cost time: 1.1771345138549805
Epoch: 10, Steps: 9 | Train Loss: 0.310 Vali Loss: 0.636 Vali Acc: 0.775 Test Loss: 0.636 Test Acc: 0.775
Validation loss decreased (-0.731877 --> -0.775356).  Saving model ...
Epoch: 11 cost time: 1.3482062816619873
Epoch: 11, Steps: 9 | Train Loss: 0.211 Vali Loss: 0.568 Vali Acc: 0.804 Test Loss: 0.568 Test Acc: 0.804
Validation loss decreased (-0.775356 --> -0.804342).  Saving model ...
Epoch: 12 cost time: 1.2852563858032227
Epoch: 12, Steps: 9 | Train Loss: 0.146 Vali Loss: 0.787 Vali Acc: 0.761 Test Loss: 0.787 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.245945930480957
Epoch: 13, Steps: 9 | Train Loss: 0.087 Vali Loss: 0.743 Vali Acc: 0.797 Test Loss: 0.743 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.263674020767212
Epoch: 14, Steps: 9 | Train Loss: 0.052 Vali Loss: 0.791 Vali Acc: 0.768 Test Loss: 0.791 Test Acc: 0.768
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.252807378768921
Epoch: 15, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.786 Vali Acc: 0.797 Test Loss: 0.786 Test Acc: 0.797
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.3280746936798096
Epoch: 16, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.892 Vali Acc: 0.761 Test Loss: 0.892 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.263145923614502
Epoch: 17, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.821 Vali Acc: 0.775 Test Loss: 0.821 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.3880033493041992
Epoch: 18, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.846 Vali Acc: 0.783 Test Loss: 0.846 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.1995220184326172
Epoch: 19, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.894 Vali Acc: 0.775 Test Loss: 0.894 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.1822898387908936
Epoch: 20, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.928 Vali Acc: 0.790 Test Loss: 0.928 Test Acc: 0.790
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.9680771827697754
Epoch: 21, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.911 Vali Acc: 0.775 Test Loss: 0.911 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el5_dm768_df768_ps35_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8043478260869565
model parameter : 36578308
model size : 154.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el5_dm768_df768_ps35_str35_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.7397212982177734
Epoch: 1, Steps: 9 | Train Loss: 1.455 Vali Loss: 1.428 Vali Acc: 0.275 Test Loss: 1.428 Test Acc: 0.275
Validation loss decreased (inf --> -0.275348).  Saving model ...
Epoch: 2 cost time: 1.0528230667114258
Epoch: 2, Steps: 9 | Train Loss: 1.352 Vali Loss: 1.343 Vali Acc: 0.319 Test Loss: 1.343 Test Acc: 0.319
Validation loss decreased (-0.275348 --> -0.318827).  Saving model ...
Epoch: 3 cost time: 0.8504290580749512
Epoch: 3, Steps: 9 | Train Loss: 1.283 Vali Loss: 1.267 Vali Acc: 0.420 Test Loss: 1.267 Test Acc: 0.420
Validation loss decreased (-0.318827 --> -0.420277).  Saving model ...
Epoch: 4 cost time: 0.8497505187988281
Epoch: 4, Steps: 9 | Train Loss: 1.177 Vali Loss: 1.179 Vali Acc: 0.486 Test Loss: 1.179 Test Acc: 0.486
Validation loss decreased (-0.420277 --> -0.485495).  Saving model ...
Epoch: 5 cost time: 0.9028141498565674
Epoch: 5, Steps: 9 | Train Loss: 1.071 Vali Loss: 1.078 Vali Acc: 0.580 Test Loss: 1.078 Test Acc: 0.580
Validation loss decreased (-0.485495 --> -0.579699).  Saving model ...
Epoch: 6 cost time: 0.9713349342346191
Epoch: 6, Steps: 9 | Train Loss: 0.933 Vali Loss: 0.963 Vali Acc: 0.587 Test Loss: 0.963 Test Acc: 0.587
Validation loss decreased (-0.579699 --> -0.586947).  Saving model ...
Epoch: 7 cost time: 1.0360257625579834
Epoch: 7, Steps: 9 | Train Loss: 0.782 Vali Loss: 0.865 Vali Acc: 0.623 Test Loss: 0.865 Test Acc: 0.623
Validation loss decreased (-0.586947 --> -0.623180).  Saving model ...
Epoch: 8 cost time: 0.9464025497436523
Epoch: 8, Steps: 9 | Train Loss: 0.642 Vali Loss: 0.806 Vali Acc: 0.638 Test Loss: 0.806 Test Acc: 0.638
Validation loss decreased (-0.623180 --> -0.637673).  Saving model ...
Epoch: 9 cost time: 0.9901723861694336
Epoch: 9, Steps: 9 | Train Loss: 0.579 Vali Loss: 0.762 Vali Acc: 0.667 Test Loss: 0.762 Test Acc: 0.667
Validation loss decreased (-0.637673 --> -0.666659).  Saving model ...
Epoch: 10 cost time: 0.8994810581207275
Epoch: 10, Steps: 9 | Train Loss: 0.481 Vali Loss: 0.750 Vali Acc: 0.638 Test Loss: 0.750 Test Acc: 0.638
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.086411952972412
Epoch: 11, Steps: 9 | Train Loss: 0.374 Vali Loss: 0.679 Vali Acc: 0.681 Test Loss: 0.679 Test Acc: 0.681
Validation loss decreased (-0.666659 --> -0.681153).  Saving model ...
Epoch: 12 cost time: 1.03678560256958
Epoch: 12, Steps: 9 | Train Loss: 0.299 Vali Loss: 0.676 Vali Acc: 0.696 Test Loss: 0.676 Test Acc: 0.696
Validation loss decreased (-0.681153 --> -0.695645).  Saving model ...
Epoch: 13 cost time: 0.98818039894104
Epoch: 13, Steps: 9 | Train Loss: 0.246 Vali Loss: 0.719 Vali Acc: 0.696 Test Loss: 0.719 Test Acc: 0.696
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8482499122619629
Epoch: 14, Steps: 9 | Train Loss: 0.192 Vali Loss: 0.683 Vali Acc: 0.746 Test Loss: 0.683 Test Acc: 0.746
Validation loss decreased (-0.695645 --> -0.746370).  Saving model ...
Epoch: 15 cost time: 0.9901127815246582
Epoch: 15, Steps: 9 | Train Loss: 0.156 Vali Loss: 0.735 Vali Acc: 0.725 Test Loss: 0.735 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0132086277008057
Epoch: 16, Steps: 9 | Train Loss: 0.104 Vali Loss: 0.642 Vali Acc: 0.783 Test Loss: 0.642 Test Acc: 0.783
Validation loss decreased (-0.746370 --> -0.782602).  Saving model ...
Epoch: 17 cost time: 1.0302238464355469
Epoch: 17, Steps: 9 | Train Loss: 0.113 Vali Loss: 0.759 Vali Acc: 0.746 Test Loss: 0.759 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0852556228637695
Epoch: 18, Steps: 9 | Train Loss: 0.077 Vali Loss: 0.780 Vali Acc: 0.754 Test Loss: 0.780 Test Acc: 0.754
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.1499884128570557
Epoch: 19, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.682 Vali Acc: 0.775 Test Loss: 0.682 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.2076945304870605
Epoch: 20, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.843 Vali Acc: 0.761 Test Loss: 0.843 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.031353235244751
Epoch: 21, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.758 Vali Acc: 0.783 Test Loss: 0.758 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.2654471397399902
Epoch: 22, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.809 Vali Acc: 0.775 Test Loss: 0.809 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.9316184520721436
Epoch: 23, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.945 Vali Acc: 0.761 Test Loss: 0.945 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.089963674545288
Epoch: 24, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.888 Vali Acc: 0.775 Test Loss: 0.888 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.0771710872650146
Epoch: 25, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.869 Vali Acc: 0.783 Test Loss: 0.869 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.0634644031524658
Epoch: 26, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.885 Vali Acc: 0.768 Test Loss: 0.885 Test Acc: 0.768
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el5_dm768_df768_ps35_str35_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.782608695652174
model parameter : 36555268
model size : 154.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el5_dm768_df768_ps42_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.3746135234832764
Epoch: 1, Steps: 9 | Train Loss: 1.477 Vali Loss: 1.433 Vali Acc: 0.196 Test Loss: 1.433 Test Acc: 0.196
Validation loss decreased (inf --> -0.195638).  Saving model ...
Epoch: 2 cost time: 1.2666685581207275
Epoch: 2, Steps: 9 | Train Loss: 1.365 Vali Loss: 1.262 Vali Acc: 0.529 Test Loss: 1.262 Test Acc: 0.529
Validation loss decreased (-0.195638 --> -0.528973).  Saving model ...
Epoch: 3 cost time: 1.2982072830200195
Epoch: 3, Steps: 9 | Train Loss: 1.196 Vali Loss: 1.126 Vali Acc: 0.609 Test Loss: 1.126 Test Acc: 0.609
Validation loss decreased (-0.528973 --> -0.608684).  Saving model ...
Epoch: 4 cost time: 1.431203842163086
Epoch: 4, Steps: 9 | Train Loss: 1.049 Vali Loss: 1.013 Vali Acc: 0.630 Test Loss: 1.013 Test Acc: 0.630
Validation loss decreased (-0.608684 --> -0.630425).  Saving model ...
Epoch: 5 cost time: 1.4697880744934082
Epoch: 5, Steps: 9 | Train Loss: 0.881 Vali Loss: 0.870 Vali Acc: 0.681 Test Loss: 0.870 Test Acc: 0.681
Validation loss decreased (-0.630425 --> -0.681151).  Saving model ...
Epoch: 6 cost time: 1.58601975440979
Epoch: 6, Steps: 9 | Train Loss: 0.707 Vali Loss: 0.771 Vali Acc: 0.725 Test Loss: 0.771 Test Acc: 0.725
Validation loss decreased (-0.681151 --> -0.724630).  Saving model ...
Epoch: 7 cost time: 1.4201784133911133
Epoch: 7, Steps: 9 | Train Loss: 0.572 Vali Loss: 0.690 Vali Acc: 0.746 Test Loss: 0.690 Test Acc: 0.746
Validation loss decreased (-0.724630 --> -0.746370).  Saving model ...
Epoch: 8 cost time: 1.460815668106079
Epoch: 8, Steps: 9 | Train Loss: 0.394 Vali Loss: 0.650 Vali Acc: 0.717 Test Loss: 0.650 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2602808475494385
Epoch: 9, Steps: 9 | Train Loss: 0.294 Vali Loss: 0.589 Vali Acc: 0.797 Test Loss: 0.589 Test Acc: 0.797
Validation loss decreased (-0.746370 --> -0.797096).  Saving model ...
Epoch: 10 cost time: 1.488900899887085
Epoch: 10, Steps: 9 | Train Loss: 0.206 Vali Loss: 0.672 Vali Acc: 0.761 Test Loss: 0.672 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.13932466506958
Epoch: 11, Steps: 9 | Train Loss: 0.118 Vali Loss: 0.639 Vali Acc: 0.783 Test Loss: 0.639 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1691968441009521
Epoch: 12, Steps: 9 | Train Loss: 0.092 Vali Loss: 0.828 Vali Acc: 0.768 Test Loss: 0.828 Test Acc: 0.768
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.1652531623840332
Epoch: 13, Steps: 9 | Train Loss: 0.055 Vali Loss: 0.761 Vali Acc: 0.797 Test Loss: 0.761 Test Acc: 0.797
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.1748011112213135
Epoch: 14, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.808 Vali Acc: 0.783 Test Loss: 0.808 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.389082431793213
Epoch: 15, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.724 Vali Acc: 0.790 Test Loss: 0.724 Test Acc: 0.790
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.1304430961608887
Epoch: 16, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.743 Vali Acc: 0.804 Test Loss: 0.743 Test Acc: 0.804
Validation loss decreased (-0.797096 --> -0.804340).  Saving model ...
Epoch: 17 cost time: 1.3362207412719727
Epoch: 17, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.745 Vali Acc: 0.797 Test Loss: 0.745 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.371164321899414
Epoch: 18, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.842 Vali Acc: 0.790 Test Loss: 0.842 Test Acc: 0.790
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.3789992332458496
Epoch: 19, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.854 Vali Acc: 0.790 Test Loss: 0.854 Test Acc: 0.790
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.4414293766021729
Epoch: 20, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.862 Vali Acc: 0.790 Test Loss: 0.862 Test Acc: 0.790
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.312993049621582
Epoch: 21, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.865 Vali Acc: 0.797 Test Loss: 0.865 Test Acc: 0.797
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.304696798324585
Epoch: 22, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.882 Vali Acc: 0.797 Test Loss: 0.882 Test Acc: 0.797
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.5568926334381104
Epoch: 23, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.916 Vali Acc: 0.804 Test Loss: 0.916 Test Acc: 0.804
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.6355197429656982
Epoch: 24, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.925 Vali Acc: 0.804 Test Loss: 0.925 Test Acc: 0.804
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.26344633102417
Epoch: 25, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.916 Vali Acc: 0.797 Test Loss: 0.916 Test Acc: 0.797
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.1720964908599854
Epoch: 26, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.909 Vali Acc: 0.797 Test Loss: 0.909 Test Acc: 0.797
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el5_dm768_df768_ps42_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8043478260869565
model parameter : 36649732
model size : 154.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el5_dm768_df768_ps42_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.8717336654663086
Epoch: 1, Steps: 9 | Train Loss: 1.393 Vali Loss: 1.341 Vali Acc: 0.312 Test Loss: 1.341 Test Acc: 0.312
Validation loss decreased (inf --> -0.311581).  Saving model ...
Epoch: 2 cost time: 1.1067063808441162
Epoch: 2, Steps: 9 | Train Loss: 1.304 Vali Loss: 1.259 Vali Acc: 0.449 Test Loss: 1.259 Test Acc: 0.449
Validation loss decreased (-0.311581 --> -0.449263).  Saving model ...
Epoch: 3 cost time: 1.1254565715789795
Epoch: 3, Steps: 9 | Train Loss: 1.205 Vali Loss: 1.166 Vali Acc: 0.580 Test Loss: 1.166 Test Acc: 0.580
Validation loss decreased (-0.449263 --> -0.579698).  Saving model ...
Epoch: 4 cost time: 1.2011127471923828
Epoch: 4, Steps: 9 | Train Loss: 1.070 Vali Loss: 1.048 Vali Acc: 0.667 Test Loss: 1.048 Test Acc: 0.667
Validation loss decreased (-0.579698 --> -0.666656).  Saving model ...
Epoch: 5 cost time: 0.893700361251831
Epoch: 5, Steps: 9 | Train Loss: 0.921 Vali Loss: 0.915 Vali Acc: 0.696 Test Loss: 0.915 Test Acc: 0.696
Validation loss decreased (-0.666656 --> -0.695643).  Saving model ...
Epoch: 6 cost time: 1.0487592220306396
Epoch: 6, Steps: 9 | Train Loss: 0.779 Vali Loss: 0.820 Vali Acc: 0.703 Test Loss: 0.820 Test Acc: 0.703
Validation loss decreased (-0.695643 --> -0.702890).  Saving model ...
Epoch: 7 cost time: 0.9255199432373047
Epoch: 7, Steps: 9 | Train Loss: 0.621 Vali Loss: 0.701 Vali Acc: 0.754 Test Loss: 0.701 Test Acc: 0.754
Validation loss decreased (-0.702890 --> -0.753616).  Saving model ...
Epoch: 8 cost time: 1.1970710754394531
Epoch: 8, Steps: 9 | Train Loss: 0.458 Vali Loss: 0.675 Vali Acc: 0.739 Test Loss: 0.675 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2006895542144775
Epoch: 9, Steps: 9 | Train Loss: 0.361 Vali Loss: 0.618 Vali Acc: 0.790 Test Loss: 0.618 Test Acc: 0.790
Validation loss decreased (-0.753616 --> -0.789849).  Saving model ...
Epoch: 10 cost time: 1.1304266452789307
Epoch: 10, Steps: 9 | Train Loss: 0.254 Vali Loss: 0.572 Vali Acc: 0.790 Test Loss: 0.572 Test Acc: 0.790
Validation loss decreased (-0.789849 --> -0.789849).  Saving model ...
Epoch: 11 cost time: 1.0501604080200195
Epoch: 11, Steps: 9 | Train Loss: 0.186 Vali Loss: 0.645 Vali Acc: 0.775 Test Loss: 0.645 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.914813756942749
Epoch: 12, Steps: 9 | Train Loss: 0.139 Vali Loss: 0.660 Vali Acc: 0.783 Test Loss: 0.660 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.2008771896362305
Epoch: 13, Steps: 9 | Train Loss: 0.118 Vali Loss: 0.633 Vali Acc: 0.790 Test Loss: 0.633 Test Acc: 0.790
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.223059892654419
Epoch: 14, Steps: 9 | Train Loss: 0.063 Vali Loss: 0.700 Vali Acc: 0.775 Test Loss: 0.700 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.2728300094604492
Epoch: 15, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.696 Vali Acc: 0.812 Test Loss: 0.696 Test Acc: 0.812
Validation loss decreased (-0.789849 --> -0.811587).  Saving model ...
Epoch: 16 cost time: 0.9889154434204102
Epoch: 16, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.608 Vali Acc: 0.797 Test Loss: 0.608 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0378074645996094
Epoch: 17, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.738 Vali Acc: 0.804 Test Loss: 0.738 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.0604467391967773
Epoch: 18, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.774 Vali Acc: 0.812 Test Loss: 0.774 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.0958642959594727
Epoch: 19, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.817 Vali Acc: 0.790 Test Loss: 0.817 Test Acc: 0.790
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.0259087085723877
Epoch: 20, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.825 Vali Acc: 0.804 Test Loss: 0.825 Test Acc: 0.804
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.1135668754577637
Epoch: 21, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.752 Vali Acc: 0.812 Test Loss: 0.752 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.1302101612091064
Epoch: 22, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.765 Vali Acc: 0.812 Test Loss: 0.765 Test Acc: 0.812
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.2357373237609863
Epoch: 23, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.788 Vali Acc: 0.819 Test Loss: 0.788 Test Acc: 0.819
Validation loss decreased (-0.811587 --> -0.818833).  Saving model ...
Epoch: 24 cost time: 1.020761251449585
Epoch: 24, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.824 Vali Acc: 0.812 Test Loss: 0.824 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.073507308959961
Epoch: 25, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.857 Vali Acc: 0.812 Test Loss: 0.857 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.1715517044067383
Epoch: 26, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.839 Vali Acc: 0.804 Test Loss: 0.839 Test Acc: 0.804
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.987576961517334
Epoch: 27, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.819 Vali Acc: 0.797 Test Loss: 0.819 Test Acc: 0.797
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.9335315227508545
Epoch: 28, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.852 Vali Acc: 0.819 Test Loss: 0.852 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.0569615364074707
Epoch: 29, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.907 Vali Acc: 0.819 Test Loss: 0.907 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.0578525066375732
Epoch: 30, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.895 Vali Acc: 0.812 Test Loss: 0.895 Test Acc: 0.812
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.9427328109741211
Epoch: 31, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.850 Vali Acc: 0.812 Test Loss: 0.850 Test Acc: 0.812
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.0313060283660889
Epoch: 32, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.842 Vali Acc: 0.812 Test Loss: 0.842 Test Acc: 0.812
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.0439915657043457
Epoch: 33, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.867 Vali Acc: 0.812 Test Loss: 0.867 Test Acc: 0.812
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el5_dm768_df768_ps42_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8188405797101449
model parameter : 36617476
model size : 154.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el5_dm768_df768_ps42_str42_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.511265516281128
Epoch: 1, Steps: 9 | Train Loss: 1.465 Vali Loss: 1.434 Vali Acc: 0.152 Test Loss: 1.434 Test Acc: 0.152
Validation loss decreased (inf --> -0.152160).  Saving model ...
Epoch: 2 cost time: 1.0488839149475098
Epoch: 2, Steps: 9 | Train Loss: 1.392 Vali Loss: 1.339 Vali Acc: 0.290 Test Loss: 1.339 Test Acc: 0.290
Validation loss decreased (-0.152160 --> -0.289842).  Saving model ...
Epoch: 3 cost time: 1.1359102725982666
Epoch: 3, Steps: 9 | Train Loss: 1.312 Vali Loss: 1.234 Vali Acc: 0.362 Test Loss: 1.234 Test Acc: 0.362
Validation loss decreased (-0.289842 --> -0.362307).  Saving model ...
Epoch: 4 cost time: 1.0054340362548828
Epoch: 4, Steps: 9 | Train Loss: 1.204 Vali Loss: 1.156 Vali Acc: 0.435 Test Loss: 1.156 Test Acc: 0.435
Validation loss decreased (-0.362307 --> -0.434771).  Saving model ...
Epoch: 5 cost time: 1.190467119216919
Epoch: 5, Steps: 9 | Train Loss: 1.079 Vali Loss: 1.083 Vali Acc: 0.514 Test Loss: 1.083 Test Acc: 0.514
Validation loss decreased (-0.434771 --> -0.514482).  Saving model ...
Epoch: 6 cost time: 1.0914690494537354
Epoch: 6, Steps: 9 | Train Loss: 0.977 Vali Loss: 1.015 Vali Acc: 0.529 Test Loss: 1.015 Test Acc: 0.529
Validation loss decreased (-0.514482 --> -0.528975).  Saving model ...
Epoch: 7 cost time: 1.1161525249481201
Epoch: 7, Steps: 9 | Train Loss: 0.895 Vali Loss: 0.968 Vali Acc: 0.529 Test Loss: 0.968 Test Acc: 0.529
Validation loss decreased (-0.528975 --> -0.528976).  Saving model ...
Epoch: 8 cost time: 0.9821035861968994
Epoch: 8, Steps: 9 | Train Loss: 0.721 Vali Loss: 0.931 Vali Acc: 0.543 Test Loss: 0.931 Test Acc: 0.543
Validation loss decreased (-0.528976 --> -0.543469).  Saving model ...
Epoch: 9 cost time: 0.9912910461425781
Epoch: 9, Steps: 9 | Train Loss: 0.617 Vali Loss: 0.895 Vali Acc: 0.638 Test Loss: 0.895 Test Acc: 0.638
Validation loss decreased (-0.543469 --> -0.637672).  Saving model ...
Epoch: 10 cost time: 1.0479049682617188
Epoch: 10, Steps: 9 | Train Loss: 0.520 Vali Loss: 0.793 Vali Acc: 0.732 Test Loss: 0.793 Test Acc: 0.732
Validation loss decreased (-0.637672 --> -0.731876).  Saving model ...
Epoch: 11 cost time: 0.847949743270874
Epoch: 11, Steps: 9 | Train Loss: 0.442 Vali Loss: 0.758 Vali Acc: 0.725 Test Loss: 0.758 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9543135166168213
Epoch: 12, Steps: 9 | Train Loss: 0.329 Vali Loss: 0.719 Vali Acc: 0.710 Test Loss: 0.719 Test Acc: 0.710
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9514577388763428
Epoch: 13, Steps: 9 | Train Loss: 0.249 Vali Loss: 0.751 Vali Acc: 0.754 Test Loss: 0.751 Test Acc: 0.754
Validation loss decreased (-0.731876 --> -0.753616).  Saving model ...
Epoch: 14 cost time: 1.250842571258545
Epoch: 14, Steps: 9 | Train Loss: 0.193 Vali Loss: 0.726 Vali Acc: 0.754 Test Loss: 0.726 Test Acc: 0.754
Validation loss decreased (-0.753616 --> -0.753616).  Saving model ...
Epoch: 15 cost time: 0.956465482711792
Epoch: 15, Steps: 9 | Train Loss: 0.135 Vali Loss: 0.781 Vali Acc: 0.746 Test Loss: 0.781 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1102814674377441
Epoch: 16, Steps: 9 | Train Loss: 0.084 Vali Loss: 0.797 Vali Acc: 0.754 Test Loss: 0.797 Test Acc: 0.754
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.1732871532440186
Epoch: 17, Steps: 9 | Train Loss: 0.060 Vali Loss: 0.735 Vali Acc: 0.768 Test Loss: 0.735 Test Acc: 0.768
Validation loss decreased (-0.753616 --> -0.768109).  Saving model ...
Epoch: 18 cost time: 0.9855685234069824
Epoch: 18, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.759 Vali Acc: 0.783 Test Loss: 0.759 Test Acc: 0.783
Validation loss decreased (-0.768109 --> -0.782601).  Saving model ...
Epoch: 19 cost time: 0.8570878505706787
Epoch: 19, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.786 Vali Acc: 0.783 Test Loss: 0.786 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1122519969940186
Epoch: 20, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.789 Vali Acc: 0.783 Test Loss: 0.789 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.298811912536621
Epoch: 21, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.868 Vali Acc: 0.775 Test Loss: 0.868 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.9965908527374268
Epoch: 22, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.857 Vali Acc: 0.775 Test Loss: 0.857 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.0383074283599854
Epoch: 23, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.820 Vali Acc: 0.783 Test Loss: 0.820 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.145129680633545
Epoch: 24, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.840 Vali Acc: 0.783 Test Loss: 0.840 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.1978776454925537
Epoch: 25, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.878 Vali Acc: 0.790 Test Loss: 0.878 Test Acc: 0.790
Validation loss decreased (-0.782601 --> -0.789846).  Saving model ...
Epoch: 26 cost time: 1.1923267841339111
Epoch: 26, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.880 Vali Acc: 0.797 Test Loss: 0.880 Test Acc: 0.797
Validation loss decreased (-0.789846 --> -0.797093).  Saving model ...
Epoch: 27 cost time: 1.053694725036621
Epoch: 27, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.868 Vali Acc: 0.790 Test Loss: 0.868 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.1659297943115234
Epoch: 28, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.869 Vali Acc: 0.797 Test Loss: 0.869 Test Acc: 0.797
Validation loss decreased (-0.797093 --> -0.797093).  Saving model ...
Epoch: 29 cost time: 1.4094483852386475
Epoch: 29, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.887 Vali Acc: 0.797 Test Loss: 0.887 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.3299968242645264
Epoch: 30, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.918 Vali Acc: 0.797 Test Loss: 0.918 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.1357035636901855
Epoch: 31, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.932 Vali Acc: 0.790 Test Loss: 0.932 Test Acc: 0.790
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.8795921802520752
Epoch: 32, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.928 Vali Acc: 0.783 Test Loss: 0.928 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.3609466552734375
Epoch: 33, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.922 Vali Acc: 0.790 Test Loss: 0.922 Test Acc: 0.790
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.070270299911499
Epoch: 34, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.917 Vali Acc: 0.790 Test Loss: 0.917 Test Acc: 0.790
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.885507345199585
Epoch: 35, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.915 Vali Acc: 0.790 Test Loss: 0.915 Test Acc: 0.790
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.0673716068267822
Epoch: 36, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.917 Vali Acc: 0.790 Test Loss: 0.917 Test Acc: 0.790
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.0334086418151855
Epoch: 37, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.923 Vali Acc: 0.790 Test Loss: 0.923 Test Acc: 0.790
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.2456557750701904
Epoch: 38, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.922 Vali Acc: 0.790 Test Loss: 0.922 Test Acc: 0.790
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el5_dm768_df768_ps42_str42_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.7971014492753623
model parameter : 36599044
model size : 154.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el4_dm768_df768_ps9_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.387694597244263
Epoch: 1, Steps: 9 | Train Loss: 1.460 Vali Loss: 1.290 Vali Acc: 0.384 Test Loss: 1.290 Test Acc: 0.384
Validation loss decreased (inf --> -0.384045).  Saving model ...
Epoch: 2 cost time: 1.6991164684295654
Epoch: 2, Steps: 9 | Train Loss: 1.185 Vali Loss: 1.007 Vali Acc: 0.674 Test Loss: 1.007 Test Acc: 0.674
Validation loss decreased (-0.384045 --> -0.673903).  Saving model ...
Epoch: 3 cost time: 2.0088789463043213
Epoch: 3, Steps: 9 | Train Loss: 0.891 Vali Loss: 0.850 Vali Acc: 0.703 Test Loss: 0.850 Test Acc: 0.703
Validation loss decreased (-0.673903 --> -0.702890).  Saving model ...
Epoch: 4 cost time: 2.330357074737549
Epoch: 4, Steps: 9 | Train Loss: 0.620 Vali Loss: 0.699 Vali Acc: 0.725 Test Loss: 0.699 Test Acc: 0.725
Validation loss decreased (-0.702890 --> -0.724631).  Saving model ...
Epoch: 5 cost time: 1.8447017669677734
Epoch: 5, Steps: 9 | Train Loss: 0.455 Vali Loss: 0.587 Vali Acc: 0.768 Test Loss: 0.587 Test Acc: 0.768
Validation loss decreased (-0.724631 --> -0.768110).  Saving model ...
Epoch: 6 cost time: 2.002034902572632
Epoch: 6, Steps: 9 | Train Loss: 0.311 Vali Loss: 0.775 Vali Acc: 0.674 Test Loss: 0.775 Test Acc: 0.674
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.243776559829712
Epoch: 7, Steps: 9 | Train Loss: 0.239 Vali Loss: 0.558 Vali Acc: 0.804 Test Loss: 0.558 Test Acc: 0.804
Validation loss decreased (-0.768110 --> -0.804342).  Saving model ...
Epoch: 8 cost time: 1.9260175228118896
Epoch: 8, Steps: 9 | Train Loss: 0.141 Vali Loss: 0.635 Vali Acc: 0.819 Test Loss: 0.635 Test Acc: 0.819
Validation loss decreased (-0.804342 --> -0.818834).  Saving model ...
Epoch: 9 cost time: 1.9307327270507812
Epoch: 9, Steps: 9 | Train Loss: 0.123 Vali Loss: 0.580 Vali Acc: 0.797 Test Loss: 0.580 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.8163559436798096
Epoch: 10, Steps: 9 | Train Loss: 0.074 Vali Loss: 0.719 Vali Acc: 0.768 Test Loss: 0.719 Test Acc: 0.768
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.12813138961792
Epoch: 11, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.833 Vali Acc: 0.754 Test Loss: 0.833 Test Acc: 0.754
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.9030375480651855
Epoch: 12, Steps: 9 | Train Loss: 0.047 Vali Loss: 0.718 Vali Acc: 0.855 Test Loss: 0.718 Test Acc: 0.855
Validation loss decreased (-0.818834 --> -0.855065).  Saving model ...
Epoch: 13 cost time: 1.7487843036651611
Epoch: 13, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.938 Vali Acc: 0.681 Test Loss: 0.938 Test Acc: 0.681
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.9154822826385498
Epoch: 14, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.915 Vali Acc: 0.848 Test Loss: 0.915 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.5102791786193848
Epoch: 15, Steps: 9 | Train Loss: 0.021 Vali Loss: 1.336 Vali Acc: 0.812 Test Loss: 1.336 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.7835414409637451
Epoch: 16, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.195 Vali Acc: 0.855 Test Loss: 1.195 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.9093177318572998
Epoch: 17, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.622 Vali Acc: 0.826 Test Loss: 1.622 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.0317771434783936
Epoch: 18, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.479 Vali Acc: 0.797 Test Loss: 1.479 Test Acc: 0.797
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.9150376319885254
Epoch: 19, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.249 Vali Acc: 0.819 Test Loss: 1.249 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.010934829711914
Epoch: 20, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.154 Vali Acc: 0.819 Test Loss: 1.154 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.2025392055511475
Epoch: 21, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.116 Vali Acc: 0.833 Test Loss: 1.116 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.8940112590789795
Epoch: 22, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.149 Vali Acc: 0.819 Test Loss: 1.149 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el4_dm768_df768_ps9_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.855072463768116
model parameter : 29568772
model size : 127.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el4_dm768_df768_ps9_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.427624464035034
Epoch: 1, Steps: 9 | Train Loss: 1.404 Vali Loss: 1.292 Vali Acc: 0.406 Test Loss: 1.292 Test Acc: 0.406
Validation loss decreased (inf --> -0.405784).  Saving model ...
Epoch: 2 cost time: 1.306941032409668
Epoch: 2, Steps: 9 | Train Loss: 1.212 Vali Loss: 1.082 Vali Acc: 0.623 Test Loss: 1.082 Test Acc: 0.623
Validation loss decreased (-0.405784 --> -0.623178).  Saving model ...
Epoch: 3 cost time: 1.7324204444885254
Epoch: 3, Steps: 9 | Train Loss: 0.982 Vali Loss: 0.898 Vali Acc: 0.667 Test Loss: 0.898 Test Acc: 0.667
Validation loss decreased (-0.623178 --> -0.666658).  Saving model ...
Epoch: 4 cost time: 1.7239329814910889
Epoch: 4, Steps: 9 | Train Loss: 0.751 Vali Loss: 0.771 Vali Acc: 0.688 Test Loss: 0.771 Test Acc: 0.688
Validation loss decreased (-0.666658 --> -0.688398).  Saving model ...
Epoch: 5 cost time: 1.5605847835540771
Epoch: 5, Steps: 9 | Train Loss: 0.569 Vali Loss: 0.700 Vali Acc: 0.710 Test Loss: 0.700 Test Acc: 0.710
Validation loss decreased (-0.688398 --> -0.710138).  Saving model ...
Epoch: 6 cost time: 1.4639127254486084
Epoch: 6, Steps: 9 | Train Loss: 0.391 Vali Loss: 0.705 Vali Acc: 0.754 Test Loss: 0.705 Test Acc: 0.754
Validation loss decreased (-0.710138 --> -0.753616).  Saving model ...
Epoch: 7 cost time: 1.2254152297973633
Epoch: 7, Steps: 9 | Train Loss: 0.341 Vali Loss: 0.757 Vali Acc: 0.674 Test Loss: 0.757 Test Acc: 0.674
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7895050048828125
Epoch: 8, Steps: 9 | Train Loss: 0.220 Vali Loss: 0.629 Vali Acc: 0.797 Test Loss: 0.629 Test Acc: 0.797
Validation loss decreased (-0.753616 --> -0.797095).  Saving model ...
Epoch: 9 cost time: 1.3820137977600098
Epoch: 9, Steps: 9 | Train Loss: 0.176 Vali Loss: 0.759 Vali Acc: 0.804 Test Loss: 0.759 Test Acc: 0.804
Validation loss decreased (-0.797095 --> -0.804340).  Saving model ...
Epoch: 10 cost time: 1.6681573390960693
Epoch: 10, Steps: 9 | Train Loss: 0.105 Vali Loss: 0.751 Vali Acc: 0.833 Test Loss: 0.751 Test Acc: 0.833
Validation loss decreased (-0.804340 --> -0.833326).  Saving model ...
Epoch: 11 cost time: 1.7490437030792236
Epoch: 11, Steps: 9 | Train Loss: 0.052 Vali Loss: 0.879 Vali Acc: 0.797 Test Loss: 0.879 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.566007137298584
Epoch: 12, Steps: 9 | Train Loss: 0.055 Vali Loss: 0.495 Vali Acc: 0.855 Test Loss: 0.495 Test Acc: 0.855
Validation loss decreased (-0.833326 --> -0.855068).  Saving model ...
Epoch: 13 cost time: 1.8595733642578125
Epoch: 13, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.760 Vali Acc: 0.826 Test Loss: 0.760 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.7612109184265137
Epoch: 14, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.845 Vali Acc: 0.841 Test Loss: 0.845 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.6355400085449219
Epoch: 15, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.659 Vali Acc: 0.833 Test Loss: 0.659 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.5252606868743896
Epoch: 16, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.818 Vali Acc: 0.819 Test Loss: 0.818 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.6746339797973633
Epoch: 17, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.730 Vali Acc: 0.841 Test Loss: 0.730 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.4599552154541016
Epoch: 18, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.780 Vali Acc: 0.826 Test Loss: 0.780 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.3322093486785889
Epoch: 19, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.067 Vali Acc: 0.841 Test Loss: 1.067 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.660336971282959
Epoch: 20, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.613 Vali Acc: 0.841 Test Loss: 0.613 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.5051391124725342
Epoch: 21, Steps: 9 | Train Loss: 0.010 Vali Loss: 1.074 Vali Acc: 0.819 Test Loss: 1.074 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.3692882061004639
Epoch: 22, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.828 Vali Acc: 0.848 Test Loss: 0.828 Test Acc: 0.848
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el4_dm768_df768_ps9_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.855072463768116
model parameter : 29448964
model size : 127.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el4_dm768_df768_ps9_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.089056968688965
Epoch: 1, Steps: 9 | Train Loss: 1.429 Vali Loss: 1.341 Vali Acc: 0.384 Test Loss: 1.341 Test Acc: 0.384
Validation loss decreased (inf --> -0.384045).  Saving model ...
Epoch: 2 cost time: 1.420987606048584
Epoch: 2, Steps: 9 | Train Loss: 1.294 Vali Loss: 1.181 Vali Acc: 0.514 Test Loss: 1.181 Test Acc: 0.514
Validation loss decreased (-0.384045 --> -0.514481).  Saving model ...
Epoch: 3 cost time: 1.3850769996643066
Epoch: 3, Steps: 9 | Train Loss: 1.128 Vali Loss: 1.026 Vali Acc: 0.696 Test Loss: 1.026 Test Acc: 0.696
Validation loss decreased (-0.514481 --> -0.695642).  Saving model ...
Epoch: 4 cost time: 1.7330656051635742
Epoch: 4, Steps: 9 | Train Loss: 0.978 Vali Loss: 0.905 Vali Acc: 0.667 Test Loss: 0.905 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.551283836364746
Epoch: 5, Steps: 9 | Train Loss: 0.776 Vali Loss: 0.803 Vali Acc: 0.717 Test Loss: 0.803 Test Acc: 0.717
Validation loss decreased (-0.695642 --> -0.717383).  Saving model ...
Epoch: 6 cost time: 1.4672389030456543
Epoch: 6, Steps: 9 | Train Loss: 0.615 Vali Loss: 0.758 Vali Acc: 0.674 Test Loss: 0.758 Test Acc: 0.674
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2991230487823486
Epoch: 7, Steps: 9 | Train Loss: 0.503 Vali Loss: 0.734 Vali Acc: 0.717 Test Loss: 0.734 Test Acc: 0.717
Validation loss decreased (-0.717383 --> -0.717384).  Saving model ...
Epoch: 8 cost time: 1.559788465499878
Epoch: 8, Steps: 9 | Train Loss: 0.401 Vali Loss: 0.741 Vali Acc: 0.732 Test Loss: 0.741 Test Acc: 0.732
Validation loss decreased (-0.717384 --> -0.731877).  Saving model ...
Epoch: 9 cost time: 1.4035358428955078
Epoch: 9, Steps: 9 | Train Loss: 0.280 Vali Loss: 0.809 Vali Acc: 0.725 Test Loss: 0.809 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.350731611251831
Epoch: 10, Steps: 9 | Train Loss: 0.234 Vali Loss: 0.626 Vali Acc: 0.804 Test Loss: 0.626 Test Acc: 0.804
Validation loss decreased (-0.731877 --> -0.804342).  Saving model ...
Epoch: 11 cost time: 1.4331495761871338
Epoch: 11, Steps: 9 | Train Loss: 0.117 Vali Loss: 0.845 Vali Acc: 0.746 Test Loss: 0.845 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2639234066009521
Epoch: 12, Steps: 9 | Train Loss: 0.133 Vali Loss: 0.813 Vali Acc: 0.783 Test Loss: 0.813 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9439780712127686
Epoch: 13, Steps: 9 | Train Loss: 0.058 Vali Loss: 0.705 Vali Acc: 0.819 Test Loss: 0.705 Test Acc: 0.819
Validation loss decreased (-0.804342 --> -0.818834).  Saving model ...
Epoch: 14 cost time: 1.1685669422149658
Epoch: 14, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.943 Vali Acc: 0.797 Test Loss: 0.943 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9029414653778076
Epoch: 15, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.680 Vali Acc: 0.833 Test Loss: 0.680 Test Acc: 0.833
Validation loss decreased (-0.818834 --> -0.833327).  Saving model ...
Epoch: 16 cost time: 1.189392328262329
Epoch: 16, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.927 Vali Acc: 0.812 Test Loss: 0.927 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.251103401184082
Epoch: 17, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.681 Vali Acc: 0.841 Test Loss: 0.681 Test Acc: 0.841
Validation loss decreased (-0.833327 --> -0.840573).  Saving model ...
Epoch: 18 cost time: 1.3307452201843262
Epoch: 18, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.844 Vali Acc: 0.826 Test Loss: 0.844 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1974637508392334
Epoch: 19, Steps: 9 | Train Loss: 0.009 Vali Loss: 1.119 Vali Acc: 0.754 Test Loss: 1.119 Test Acc: 0.754
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.1600017547607422
Epoch: 20, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.815 Vali Acc: 0.848 Test Loss: 0.815 Test Acc: 0.848
Validation loss decreased (-0.840573 --> -0.847818).  Saving model ...
Epoch: 21 cost time: 1.309732437133789
Epoch: 21, Steps: 9 | Train Loss: 0.008 Vali Loss: 1.053 Vali Acc: 0.819 Test Loss: 1.053 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.5152709484100342
Epoch: 22, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.962 Vali Acc: 0.833 Test Loss: 0.962 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.3923320770263672
Epoch: 23, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.852 Vali Acc: 0.841 Test Loss: 0.852 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.4036781787872314
Epoch: 24, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.895 Vali Acc: 0.826 Test Loss: 0.895 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.417898178100586
Epoch: 25, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.064 Vali Acc: 0.833 Test Loss: 1.064 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.218301773071289
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.031 Vali Acc: 0.833 Test Loss: 1.031 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.418975591659546
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.995 Vali Acc: 0.833 Test Loss: 0.995 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.3570289611816406
Epoch: 28, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.001 Vali Acc: 0.826 Test Loss: 1.001 Test Acc: 0.826
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.3186640739440918
Epoch: 29, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.969 Vali Acc: 0.819 Test Loss: 0.969 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.1727650165557861
Epoch: 30, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.969 Vali Acc: 0.819 Test Loss: 0.969 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el4_dm768_df768_ps9_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8478260869565217
model parameter : 29366020
model size : 126.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el4_dm768_df768_ps10_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.4845268726348877
Epoch: 1, Steps: 9 | Train Loss: 1.426 Vali Loss: 1.353 Vali Acc: 0.319 Test Loss: 1.353 Test Acc: 0.319
Validation loss decreased (inf --> -0.318827).  Saving model ...
Epoch: 2 cost time: 1.3092424869537354
Epoch: 2, Steps: 9 | Train Loss: 1.208 Vali Loss: 1.132 Vali Acc: 0.435 Test Loss: 1.132 Test Acc: 0.435
Validation loss decreased (-0.318827 --> -0.434771).  Saving model ...
Epoch: 3 cost time: 1.3169338703155518
Epoch: 3, Steps: 9 | Train Loss: 0.909 Vali Loss: 1.034 Vali Acc: 0.543 Test Loss: 1.034 Test Acc: 0.543
Validation loss decreased (-0.434771 --> -0.543468).  Saving model ...
Epoch: 4 cost time: 1.6816020011901855
Epoch: 4, Steps: 9 | Train Loss: 0.706 Vali Loss: 0.790 Vali Acc: 0.667 Test Loss: 0.790 Test Acc: 0.667
Validation loss decreased (-0.543468 --> -0.666659).  Saving model ...
Epoch: 5 cost time: 1.8928961753845215
Epoch: 5, Steps: 9 | Train Loss: 0.530 Vali Loss: 0.693 Vali Acc: 0.703 Test Loss: 0.693 Test Acc: 0.703
Validation loss decreased (-0.666659 --> -0.702892).  Saving model ...
Epoch: 6 cost time: 1.923266887664795
Epoch: 6, Steps: 9 | Train Loss: 0.341 Vali Loss: 0.648 Vali Acc: 0.739 Test Loss: 0.648 Test Acc: 0.739
Validation loss decreased (-0.702892 --> -0.739124).  Saving model ...
Epoch: 7 cost time: 1.460428237915039
Epoch: 7, Steps: 9 | Train Loss: 0.213 Vali Loss: 0.772 Vali Acc: 0.630 Test Loss: 0.772 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.536261796951294
Epoch: 8, Steps: 9 | Train Loss: 0.183 Vali Loss: 0.574 Vali Acc: 0.790 Test Loss: 0.574 Test Acc: 0.790
Validation loss decreased (-0.739124 --> -0.789849).  Saving model ...
Epoch: 9 cost time: 1.3035318851470947
Epoch: 9, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.673 Vali Acc: 0.826 Test Loss: 0.673 Test Acc: 0.826
Validation loss decreased (-0.789849 --> -0.826080).  Saving model ...
Epoch: 10 cost time: 1.3400638103485107
Epoch: 10, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.827 Vali Acc: 0.783 Test Loss: 0.827 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.9586594104766846
Epoch: 11, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.921 Vali Acc: 0.775 Test Loss: 0.921 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.6831409931182861
Epoch: 12, Steps: 9 | Train Loss: 0.008 Vali Loss: 1.029 Vali Acc: 0.841 Test Loss: 1.029 Test Acc: 0.841
Validation loss decreased (-0.826080 --> -0.840569).  Saving model ...
Epoch: 13 cost time: 1.629669189453125
Epoch: 13, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.602 Vali Acc: 0.826 Test Loss: 0.602 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.8711349964141846
Epoch: 14, Steps: 9 | Train Loss: 0.021 Vali Loss: 2.399 Vali Acc: 0.768 Test Loss: 2.399 Test Acc: 0.768
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.6818797588348389
Epoch: 15, Steps: 9 | Train Loss: 0.009 Vali Loss: 1.174 Vali Acc: 0.783 Test Loss: 1.174 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.867220401763916
Epoch: 16, Steps: 9 | Train Loss: 0.012 Vali Loss: 1.408 Vali Acc: 0.754 Test Loss: 1.408 Test Acc: 0.754
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.0285260677337646
Epoch: 17, Steps: 9 | Train Loss: 0.010 Vali Loss: 1.060 Vali Acc: 0.841 Test Loss: 1.060 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.6961519718170166
Epoch: 18, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.980 Vali Acc: 0.746 Test Loss: 1.980 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.8462800979614258
Epoch: 19, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.484 Vali Acc: 0.826 Test Loss: 1.484 Test Acc: 0.826
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.6977019309997559
Epoch: 20, Steps: 9 | Train Loss: 0.009 Vali Loss: 1.793 Vali Acc: 0.768 Test Loss: 1.793 Test Acc: 0.768
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.2112433910369873
Epoch: 21, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.959 Vali Acc: 0.848 Test Loss: 0.959 Test Acc: 0.848
Validation loss decreased (-0.840569 --> -0.847816).  Saving model ...
Epoch: 22 cost time: 1.6957643032073975
Epoch: 22, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.953 Vali Acc: 0.804 Test Loss: 1.953 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.9025142192840576
Epoch: 23, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.785 Vali Acc: 0.819 Test Loss: 1.785 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.658278226852417
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.226 Vali Acc: 0.833 Test Loss: 1.226 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.937103033065796
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.211 Vali Acc: 0.862 Test Loss: 1.211 Test Acc: 0.862
Validation loss decreased (-0.847816 --> -0.862307).  Saving model ...
Epoch: 26 cost time: 1.899930715560913
Epoch: 26, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.349 Vali Acc: 0.841 Test Loss: 1.349 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.8800735473632812
Epoch: 27, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.295 Vali Acc: 0.848 Test Loss: 1.295 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.2523436546325684
Epoch: 28, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.278 Vali Acc: 0.841 Test Loss: 1.278 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.1720194816589355
Epoch: 29, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.285 Vali Acc: 0.833 Test Loss: 1.285 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.9104251861572266
Epoch: 30, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.295 Vali Acc: 0.841 Test Loss: 1.295 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.8710060119628906
Epoch: 31, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.308 Vali Acc: 0.841 Test Loss: 1.308 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.845533847808838
Epoch: 32, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.319 Vali Acc: 0.841 Test Loss: 1.319 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 2.025055408477783
Epoch: 33, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.326 Vali Acc: 0.841 Test Loss: 1.326 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.842540979385376
Epoch: 34, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.327 Vali Acc: 0.841 Test Loss: 1.327 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 2.1171133518218994
Epoch: 35, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.330 Vali Acc: 0.848 Test Loss: 1.330 Test Acc: 0.848
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el4_dm768_df768_ps10_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8623188405797102
model parameter : 29575684
model size : 127.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el4_dm768_df768_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.5030810832977295
Epoch: 1, Steps: 9 | Train Loss: 1.412 Vali Loss: 1.348 Vali Acc: 0.377 Test Loss: 1.348 Test Acc: 0.377
Validation loss decreased (inf --> -0.376798).  Saving model ...
Epoch: 2 cost time: 1.777791976928711
Epoch: 2, Steps: 9 | Train Loss: 1.256 Vali Loss: 1.198 Vali Acc: 0.471 Test Loss: 1.198 Test Acc: 0.471
Validation loss decreased (-0.376798 --> -0.471003).  Saving model ...
Epoch: 3 cost time: 1.5141503810882568
Epoch: 3, Steps: 9 | Train Loss: 1.072 Vali Loss: 1.044 Vali Acc: 0.594 Test Loss: 1.044 Test Acc: 0.594
Validation loss decreased (-0.471003 --> -0.594192).  Saving model ...
Epoch: 4 cost time: 1.3348474502563477
Epoch: 4, Steps: 9 | Train Loss: 0.837 Vali Loss: 0.887 Vali Acc: 0.616 Test Loss: 0.887 Test Acc: 0.616
Validation loss decreased (-0.594192 --> -0.615933).  Saving model ...
Epoch: 5 cost time: 1.712813138961792
Epoch: 5, Steps: 9 | Train Loss: 0.628 Vali Loss: 0.718 Vali Acc: 0.746 Test Loss: 0.718 Test Acc: 0.746
Validation loss decreased (-0.615933 --> -0.746370).  Saving model ...
Epoch: 6 cost time: 1.608368158340454
Epoch: 6, Steps: 9 | Train Loss: 0.470 Vali Loss: 0.640 Vali Acc: 0.746 Test Loss: 0.640 Test Acc: 0.746
Validation loss decreased (-0.746370 --> -0.746370).  Saving model ...
Epoch: 7 cost time: 1.7409958839416504
Epoch: 7, Steps: 9 | Train Loss: 0.306 Vali Loss: 0.630 Vali Acc: 0.710 Test Loss: 0.630 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3636255264282227
Epoch: 8, Steps: 9 | Train Loss: 0.209 Vali Loss: 0.508 Vali Acc: 0.841 Test Loss: 0.508 Test Acc: 0.841
Validation loss decreased (-0.746370 --> -0.840575).  Saving model ...
Epoch: 9 cost time: 1.458488941192627
Epoch: 9, Steps: 9 | Train Loss: 0.126 Vali Loss: 0.700 Vali Acc: 0.819 Test Loss: 0.700 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.803678274154663
Epoch: 10, Steps: 9 | Train Loss: 0.081 Vali Loss: 0.585 Vali Acc: 0.855 Test Loss: 0.585 Test Acc: 0.855
Validation loss decreased (-0.840575 --> -0.855067).  Saving model ...
Epoch: 11 cost time: 1.3164677619934082
Epoch: 11, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.542 Vali Acc: 0.862 Test Loss: 0.542 Test Acc: 0.862
Validation loss decreased (-0.855067 --> -0.862313).  Saving model ...
Epoch: 12 cost time: 1.3998138904571533
Epoch: 12, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.820 Vali Acc: 0.833 Test Loss: 0.820 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5608367919921875
Epoch: 13, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.618 Vali Acc: 0.848 Test Loss: 0.618 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.5512189865112305
Epoch: 14, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.981 Vali Acc: 0.841 Test Loss: 0.981 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.8327083587646484
Epoch: 15, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.759 Vali Acc: 0.855 Test Loss: 0.759 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.100369930267334
Epoch: 16, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.904 Vali Acc: 0.841 Test Loss: 0.904 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.5803956985473633
Epoch: 17, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.974 Vali Acc: 0.841 Test Loss: 0.974 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.808617353439331
Epoch: 18, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.801 Vali Acc: 0.848 Test Loss: 0.801 Test Acc: 0.848
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.4985020160675049
Epoch: 19, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.897 Vali Acc: 0.841 Test Loss: 0.897 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.577765941619873
Epoch: 20, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.888 Vali Acc: 0.848 Test Loss: 0.888 Test Acc: 0.848
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.240173578262329
Epoch: 21, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.861 Vali Acc: 0.855 Test Loss: 0.861 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el4_dm768_df768_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8623188405797102
model parameter : 29455876
model size : 127.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el4_dm768_df768_ps10_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.836331844329834
Epoch: 1, Steps: 9 | Train Loss: 1.439 Vali Loss: 1.362 Vali Acc: 0.312 Test Loss: 1.362 Test Acc: 0.312
Validation loss decreased (inf --> -0.311581).  Saving model ...
Epoch: 2 cost time: 1.5972135066986084
Epoch: 2, Steps: 9 | Train Loss: 1.289 Vali Loss: 1.242 Vali Acc: 0.399 Test Loss: 1.242 Test Acc: 0.399
Validation loss decreased (-0.311581 --> -0.398538).  Saving model ...
Epoch: 3 cost time: 1.3951454162597656
Epoch: 3, Steps: 9 | Train Loss: 1.167 Vali Loss: 1.149 Vali Acc: 0.601 Test Loss: 1.149 Test Acc: 0.601
Validation loss decreased (-0.398538 --> -0.601438).  Saving model ...
Epoch: 4 cost time: 1.2279820442199707
Epoch: 4, Steps: 9 | Train Loss: 0.988 Vali Loss: 1.011 Vali Acc: 0.514 Test Loss: 1.011 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.594412088394165
Epoch: 5, Steps: 9 | Train Loss: 0.814 Vali Loss: 0.911 Vali Acc: 0.630 Test Loss: 0.911 Test Acc: 0.630
Validation loss decreased (-0.601438 --> -0.630426).  Saving model ...
Epoch: 6 cost time: 1.3932876586914062
Epoch: 6, Steps: 9 | Train Loss: 0.669 Vali Loss: 0.810 Vali Acc: 0.688 Test Loss: 0.810 Test Acc: 0.688
Validation loss decreased (-0.630426 --> -0.688398).  Saving model ...
Epoch: 7 cost time: 1.4322564601898193
Epoch: 7, Steps: 9 | Train Loss: 0.525 Vali Loss: 0.703 Vali Acc: 0.761 Test Loss: 0.703 Test Acc: 0.761
Validation loss decreased (-0.688398 --> -0.760863).  Saving model ...
Epoch: 8 cost time: 1.5845167636871338
Epoch: 8, Steps: 9 | Train Loss: 0.360 Vali Loss: 0.752 Vali Acc: 0.775 Test Loss: 0.752 Test Acc: 0.775
Validation loss decreased (-0.760863 --> -0.775355).  Saving model ...
Epoch: 9 cost time: 1.248047113418579
Epoch: 9, Steps: 9 | Train Loss: 0.295 Vali Loss: 0.607 Vali Acc: 0.797 Test Loss: 0.607 Test Acc: 0.797
Validation loss decreased (-0.775355 --> -0.797095).  Saving model ...
Epoch: 10 cost time: 1.6310765743255615
Epoch: 10, Steps: 9 | Train Loss: 0.169 Vali Loss: 0.553 Vali Acc: 0.855 Test Loss: 0.553 Test Acc: 0.855
Validation loss decreased (-0.797095 --> -0.855067).  Saving model ...
Epoch: 11 cost time: 1.5022220611572266
Epoch: 11, Steps: 9 | Train Loss: 0.116 Vali Loss: 0.699 Vali Acc: 0.812 Test Loss: 0.699 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5587236881256104
Epoch: 12, Steps: 9 | Train Loss: 0.059 Vali Loss: 0.549 Vali Acc: 0.819 Test Loss: 0.549 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.9957637786865234
Epoch: 13, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.635 Vali Acc: 0.841 Test Loss: 0.635 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.8024678230285645
Epoch: 14, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.750 Vali Acc: 0.812 Test Loss: 0.750 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.6678202152252197
Epoch: 15, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.665 Vali Acc: 0.848 Test Loss: 0.665 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.4304389953613281
Epoch: 16, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.760 Vali Acc: 0.812 Test Loss: 0.760 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.4326424598693848
Epoch: 17, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.742 Vali Acc: 0.819 Test Loss: 0.742 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.6056606769561768
Epoch: 18, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.761 Vali Acc: 0.841 Test Loss: 0.761 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.4526965618133545
Epoch: 19, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.743 Vali Acc: 0.841 Test Loss: 0.743 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.4788775444030762
Epoch: 20, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.904 Vali Acc: 0.819 Test Loss: 0.904 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el4_dm768_df768_ps10_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.855072463768116
model parameter : 29363716
model size : 126.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el4_dm768_df768_ps11_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.067265272140503
Epoch: 1, Steps: 9 | Train Loss: 1.317 Vali Loss: 1.222 Vali Acc: 0.341 Test Loss: 1.222 Test Acc: 0.341
Validation loss decreased (inf --> -0.340567).  Saving model ...
Epoch: 2 cost time: 1.5056617259979248
Epoch: 2, Steps: 9 | Train Loss: 1.058 Vali Loss: 1.006 Vali Acc: 0.551 Test Loss: 1.006 Test Acc: 0.551
Validation loss decreased (-0.340567 --> -0.550715).  Saving model ...
Epoch: 3 cost time: 1.660621166229248
Epoch: 3, Steps: 9 | Train Loss: 0.816 Vali Loss: 0.862 Vali Acc: 0.616 Test Loss: 0.862 Test Acc: 0.616
Validation loss decreased (-0.550715 --> -0.615933).  Saving model ...
Epoch: 4 cost time: 2.0642714500427246
Epoch: 4, Steps: 9 | Train Loss: 0.636 Vali Loss: 0.662 Vali Acc: 0.790 Test Loss: 0.662 Test Acc: 0.790
Validation loss decreased (-0.615933 --> -0.789848).  Saving model ...
Epoch: 5 cost time: 1.9612526893615723
Epoch: 5, Steps: 9 | Train Loss: 0.456 Vali Loss: 0.599 Vali Acc: 0.761 Test Loss: 0.599 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7260894775390625
Epoch: 6, Steps: 9 | Train Loss: 0.318 Vali Loss: 0.577 Vali Acc: 0.746 Test Loss: 0.577 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.7885653972625732
Epoch: 7, Steps: 9 | Train Loss: 0.173 Vali Loss: 0.860 Vali Acc: 0.739 Test Loss: 0.860 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.9377532005310059
Epoch: 8, Steps: 9 | Train Loss: 0.198 Vali Loss: 0.430 Vali Acc: 0.855 Test Loss: 0.430 Test Acc: 0.855
Validation loss decreased (-0.789848 --> -0.855068).  Saving model ...
Epoch: 9 cost time: 1.7480204105377197
Epoch: 9, Steps: 9 | Train Loss: 0.123 Vali Loss: 0.515 Vali Acc: 0.804 Test Loss: 0.515 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.794703722000122
Epoch: 10, Steps: 9 | Train Loss: 0.057 Vali Loss: 0.455 Vali Acc: 0.870 Test Loss: 0.455 Test Acc: 0.870
Validation loss decreased (-0.855068 --> -0.869561).  Saving model ...
Epoch: 11 cost time: 1.7436046600341797
Epoch: 11, Steps: 9 | Train Loss: 0.053 Vali Loss: 0.784 Vali Acc: 0.833 Test Loss: 0.784 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.6812469959259033
Epoch: 12, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.703 Vali Acc: 0.833 Test Loss: 0.703 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1644623279571533
Epoch: 13, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.459 Vali Acc: 0.870 Test Loss: 0.459 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.7316019535064697
Epoch: 14, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.517 Vali Acc: 0.891 Test Loss: 0.517 Test Acc: 0.891
Validation loss decreased (-0.869561 --> -0.891299).  Saving model ...
Epoch: 15 cost time: 1.6072454452514648
Epoch: 15, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.815 Vali Acc: 0.848 Test Loss: 0.815 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.7016611099243164
Epoch: 16, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.698 Vali Acc: 0.862 Test Loss: 0.698 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.665985107421875
Epoch: 17, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.640 Vali Acc: 0.870 Test Loss: 0.640 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.9626076221466064
Epoch: 18, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.631 Vali Acc: 0.862 Test Loss: 0.631 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.287338972091675
Epoch: 19, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.621 Vali Acc: 0.862 Test Loss: 0.621 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.7072007656097412
Epoch: 20, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.628 Vali Acc: 0.870 Test Loss: 0.628 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.141118049621582
Epoch: 21, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.638 Vali Acc: 0.877 Test Loss: 0.638 Test Acc: 0.877
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.1076395511627197
Epoch: 22, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.649 Vali Acc: 0.877 Test Loss: 0.649 Test Acc: 0.877
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.373791456222534
Epoch: 23, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.750 Vali Acc: 0.855 Test Loss: 0.750 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.4341795444488525
Epoch: 24, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.745 Vali Acc: 0.870 Test Loss: 0.745 Test Acc: 0.870
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el4_dm768_df768_ps11_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8913043478260869
model parameter : 29582596
model size : 127.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el4_dm768_df768_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.138447523117065
Epoch: 1, Steps: 9 | Train Loss: 1.432 Vali Loss: 1.288 Vali Acc: 0.341 Test Loss: 1.288 Test Acc: 0.341
Validation loss decreased (inf --> -0.340567).  Saving model ...
Epoch: 2 cost time: 1.709613561630249
Epoch: 2, Steps: 9 | Train Loss: 1.261 Vali Loss: 1.125 Vali Acc: 0.551 Test Loss: 1.125 Test Acc: 0.551
Validation loss decreased (-0.340567 --> -0.550713).  Saving model ...
Epoch: 3 cost time: 1.503788948059082
Epoch: 3, Steps: 9 | Train Loss: 1.001 Vali Loss: 0.979 Vali Acc: 0.536 Test Loss: 0.979 Test Acc: 0.536
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8099825382232666
Epoch: 4, Steps: 9 | Train Loss: 0.876 Vali Loss: 0.891 Vali Acc: 0.609 Test Loss: 0.891 Test Acc: 0.609
Validation loss decreased (-0.550713 --> -0.608687).  Saving model ...
Epoch: 5 cost time: 1.9585649967193604
Epoch: 5, Steps: 9 | Train Loss: 0.708 Vali Loss: 0.801 Vali Acc: 0.674 Test Loss: 0.801 Test Acc: 0.674
Validation loss decreased (-0.608687 --> -0.673905).  Saving model ...
Epoch: 6 cost time: 1.9440608024597168
Epoch: 6, Steps: 9 | Train Loss: 0.534 Vali Loss: 0.701 Vali Acc: 0.703 Test Loss: 0.701 Test Acc: 0.703
Validation loss decreased (-0.673905 --> -0.702892).  Saving model ...
Epoch: 7 cost time: 1.5546700954437256
Epoch: 7, Steps: 9 | Train Loss: 0.402 Vali Loss: 0.639 Vali Acc: 0.739 Test Loss: 0.639 Test Acc: 0.739
Validation loss decreased (-0.702892 --> -0.739124).  Saving model ...
Epoch: 8 cost time: 1.4338245391845703
Epoch: 8, Steps: 9 | Train Loss: 0.294 Vali Loss: 0.581 Vali Acc: 0.717 Test Loss: 0.581 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2275090217590332
Epoch: 9, Steps: 9 | Train Loss: 0.234 Vali Loss: 0.800 Vali Acc: 0.739 Test Loss: 0.800 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.3593697547912598
Epoch: 10, Steps: 9 | Train Loss: 0.121 Vali Loss: 0.707 Vali Acc: 0.812 Test Loss: 0.707 Test Acc: 0.812
Validation loss decreased (-0.739124 --> -0.811587).  Saving model ...
Epoch: 11 cost time: 1.4538381099700928
Epoch: 11, Steps: 9 | Train Loss: 0.096 Vali Loss: 0.539 Vali Acc: 0.790 Test Loss: 0.539 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.407069444656372
Epoch: 12, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.809 Vali Acc: 0.812 Test Loss: 0.809 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.4363982677459717
Epoch: 13, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.968 Vali Acc: 0.790 Test Loss: 0.968 Test Acc: 0.790
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.5426812171936035
Epoch: 14, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.616 Vali Acc: 0.804 Test Loss: 0.616 Test Acc: 0.804
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.2337806224822998
Epoch: 15, Steps: 9 | Train Loss: 0.016 Vali Loss: 1.065 Vali Acc: 0.812 Test Loss: 1.065 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.1478285789489746
Epoch: 16, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.797 Vali Acc: 0.819 Test Loss: 0.797 Test Acc: 0.819
Validation loss decreased (-0.811587 --> -0.818833).  Saving model ...
Epoch: 17 cost time: 1.0999531745910645
Epoch: 17, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.847 Vali Acc: 0.812 Test Loss: 0.847 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.3138628005981445
Epoch: 18, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.977 Vali Acc: 0.833 Test Loss: 0.977 Test Acc: 0.833
Validation loss decreased (-0.818833 --> -0.833324).  Saving model ...
Epoch: 19 cost time: 1.2805709838867188
Epoch: 19, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.892 Vali Acc: 0.855 Test Loss: 0.892 Test Acc: 0.855
Validation loss decreased (-0.833324 --> -0.855064).  Saving model ...
Epoch: 20 cost time: 1.2777059078216553
Epoch: 20, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.856 Vali Acc: 0.841 Test Loss: 0.856 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.4666168689727783
Epoch: 21, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.880 Vali Acc: 0.848 Test Loss: 0.880 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.1127276420593262
Epoch: 22, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.903 Vali Acc: 0.848 Test Loss: 0.903 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.235961675643921
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.945 Vali Acc: 0.855 Test Loss: 0.945 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.1323676109313965
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.879 Vali Acc: 0.870 Test Loss: 0.879 Test Acc: 0.870
Validation loss decreased (-0.855064 --> -0.869556).  Saving model ...
Epoch: 25 cost time: 1.3987865447998047
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.844 Vali Acc: 0.848 Test Loss: 0.844 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.1721773147583008
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.848 Vali Acc: 0.848 Test Loss: 0.848 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.1916699409484863
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.900 Vali Acc: 0.862 Test Loss: 0.900 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.8615922927856445
Epoch: 28, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.920 Vali Acc: 0.862 Test Loss: 0.920 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.0210962295532227
Epoch: 29, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.919 Vali Acc: 0.862 Test Loss: 0.919 Test Acc: 0.862
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.7807905673980713
Epoch: 30, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.907 Vali Acc: 0.862 Test Loss: 0.907 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.8048417568206787
Epoch: 31, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.900 Vali Acc: 0.862 Test Loss: 0.900 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.9700198173522949
Epoch: 32, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.907 Vali Acc: 0.862 Test Loss: 0.907 Test Acc: 0.862
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.9065866470336914
Epoch: 33, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.926 Vali Acc: 0.855 Test Loss: 0.926 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.5055217742919922
Epoch: 34, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.964 Vali Acc: 0.862 Test Loss: 0.964 Test Acc: 0.862
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el4_dm768_df768_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8695652173913043
model parameter : 29430532
model size : 126.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el4_dm768_df768_ps11_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.4638473987579346
Epoch: 1, Steps: 9 | Train Loss: 1.418 Vali Loss: 1.389 Vali Acc: 0.261 Test Loss: 1.389 Test Acc: 0.261
Validation loss decreased (inf --> -0.260856).  Saving model ...
Epoch: 2 cost time: 1.049023151397705
Epoch: 2, Steps: 9 | Train Loss: 1.323 Vali Loss: 1.257 Vali Acc: 0.442 Test Loss: 1.257 Test Acc: 0.442
Validation loss decreased (-0.260856 --> -0.442016).  Saving model ...
Epoch: 3 cost time: 1.48933744430542
Epoch: 3, Steps: 9 | Train Loss: 1.138 Vali Loss: 1.120 Vali Acc: 0.551 Test Loss: 1.120 Test Acc: 0.551
Validation loss decreased (-0.442016 --> -0.550713).  Saving model ...
Epoch: 4 cost time: 1.4797401428222656
Epoch: 4, Steps: 9 | Train Loss: 1.016 Vali Loss: 1.007 Vali Acc: 0.543 Test Loss: 1.007 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4886484146118164
Epoch: 5, Steps: 9 | Train Loss: 0.857 Vali Loss: 0.923 Vali Acc: 0.601 Test Loss: 0.923 Test Acc: 0.601
Validation loss decreased (-0.550713 --> -0.601440).  Saving model ...
Epoch: 6 cost time: 1.6905641555786133
Epoch: 6, Steps: 9 | Train Loss: 0.726 Vali Loss: 0.797 Vali Acc: 0.630 Test Loss: 0.797 Test Acc: 0.630
Validation loss decreased (-0.601440 --> -0.630427).  Saving model ...
Epoch: 7 cost time: 1.548471212387085
Epoch: 7, Steps: 9 | Train Loss: 0.621 Vali Loss: 0.741 Vali Acc: 0.681 Test Loss: 0.741 Test Acc: 0.681
Validation loss decreased (-0.630427 --> -0.681152).  Saving model ...
Epoch: 8 cost time: 1.4998643398284912
Epoch: 8, Steps: 9 | Train Loss: 0.516 Vali Loss: 0.623 Vali Acc: 0.717 Test Loss: 0.623 Test Acc: 0.717
Validation loss decreased (-0.681152 --> -0.717385).  Saving model ...
Epoch: 9 cost time: 1.2841315269470215
Epoch: 9, Steps: 9 | Train Loss: 0.346 Vali Loss: 0.660 Vali Acc: 0.732 Test Loss: 0.660 Test Acc: 0.732
Validation loss decreased (-0.717385 --> -0.731877).  Saving model ...
Epoch: 10 cost time: 1.3330881595611572
Epoch: 10, Steps: 9 | Train Loss: 0.317 Vali Loss: 0.604 Vali Acc: 0.775 Test Loss: 0.604 Test Acc: 0.775
Validation loss decreased (-0.731877 --> -0.775356).  Saving model ...
Epoch: 11 cost time: 1.5035896301269531
Epoch: 11, Steps: 9 | Train Loss: 0.194 Vali Loss: 0.492 Vali Acc: 0.812 Test Loss: 0.492 Test Acc: 0.812
Validation loss decreased (-0.775356 --> -0.811589).  Saving model ...
Epoch: 12 cost time: 1.6923308372497559
Epoch: 12, Steps: 9 | Train Loss: 0.136 Vali Loss: 0.610 Vali Acc: 0.804 Test Loss: 0.610 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5463242530822754
Epoch: 13, Steps: 9 | Train Loss: 0.097 Vali Loss: 0.527 Vali Acc: 0.826 Test Loss: 0.527 Test Acc: 0.826
Validation loss decreased (-0.811589 --> -0.826082).  Saving model ...
Epoch: 14 cost time: 1.6933274269104004
Epoch: 14, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.564 Vali Acc: 0.812 Test Loss: 0.564 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.6646497249603271
Epoch: 15, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.736 Vali Acc: 0.754 Test Loss: 0.736 Test Acc: 0.754
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.4184536933898926
Epoch: 16, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.575 Vali Acc: 0.797 Test Loss: 0.575 Test Acc: 0.797
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.6036152839660645
Epoch: 17, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.875 Vali Acc: 0.790 Test Loss: 0.875 Test Acc: 0.790
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.5390701293945312
Epoch: 18, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.604 Vali Acc: 0.812 Test Loss: 0.604 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.2686741352081299
Epoch: 19, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.739 Vali Acc: 0.833 Test Loss: 0.739 Test Acc: 0.833
Validation loss decreased (-0.826082 --> -0.833326).  Saving model ...
Epoch: 20 cost time: 1.1777281761169434
Epoch: 20, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.710 Vali Acc: 0.804 Test Loss: 0.710 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.1585209369659424
Epoch: 21, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.724 Vali Acc: 0.797 Test Loss: 0.724 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.2033038139343262
Epoch: 22, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.783 Vali Acc: 0.812 Test Loss: 0.783 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.4690372943878174
Epoch: 23, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.805 Vali Acc: 0.819 Test Loss: 0.805 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.2352628707885742
Epoch: 24, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.776 Vali Acc: 0.826 Test Loss: 0.776 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.201131820678711
Epoch: 25, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.767 Vali Acc: 0.826 Test Loss: 0.767 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.4625649452209473
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.814 Vali Acc: 0.783 Test Loss: 0.814 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.1544711589813232
Epoch: 27, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.815 Vali Acc: 0.812 Test Loss: 0.815 Test Acc: 0.812
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.2736554145812988
Epoch: 28, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.765 Vali Acc: 0.833 Test Loss: 0.765 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.2010860443115234
Epoch: 29, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.779 Vali Acc: 0.812 Test Loss: 0.779 Test Acc: 0.812
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el4_dm768_df768_ps11_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8333333333333334
model parameter : 29361412
model size : 126.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el4_dm768_df768_ps12_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.6445538997650146
Epoch: 1, Steps: 9 | Train Loss: 1.426 Vali Loss: 1.279 Vali Acc: 0.486 Test Loss: 1.279 Test Acc: 0.486
Validation loss decreased (inf --> -0.485494).  Saving model ...
Epoch: 2 cost time: 1.4959344863891602
Epoch: 2, Steps: 9 | Train Loss: 1.203 Vali Loss: 1.079 Vali Acc: 0.572 Test Loss: 1.079 Test Acc: 0.572
Validation loss decreased (-0.485494 --> -0.572453).  Saving model ...
Epoch: 3 cost time: 1.750450849533081
Epoch: 3, Steps: 9 | Train Loss: 0.863 Vali Loss: 0.851 Vali Acc: 0.594 Test Loss: 0.851 Test Acc: 0.594
Validation loss decreased (-0.572453 --> -0.594194).  Saving model ...
Epoch: 4 cost time: 1.8846197128295898
Epoch: 4, Steps: 9 | Train Loss: 0.623 Vali Loss: 1.032 Vali Acc: 0.601 Test Loss: 1.032 Test Acc: 0.601
Validation loss decreased (-0.594194 --> -0.601439).  Saving model ...
Epoch: 5 cost time: 1.7502796649932861
Epoch: 5, Steps: 9 | Train Loss: 0.548 Vali Loss: 0.697 Vali Acc: 0.674 Test Loss: 0.697 Test Acc: 0.674
Validation loss decreased (-0.601439 --> -0.673906).  Saving model ...
Epoch: 6 cost time: 1.8009791374206543
Epoch: 6, Steps: 9 | Train Loss: 0.412 Vali Loss: 1.082 Vali Acc: 0.623 Test Loss: 1.082 Test Acc: 0.623
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6102643013000488
Epoch: 7, Steps: 9 | Train Loss: 0.244 Vali Loss: 0.459 Vali Acc: 0.848 Test Loss: 0.459 Test Acc: 0.848
Validation loss decreased (-0.673906 --> -0.847821).  Saving model ...
Epoch: 8 cost time: 1.3800928592681885
Epoch: 8, Steps: 9 | Train Loss: 0.116 Vali Loss: 0.936 Vali Acc: 0.775 Test Loss: 0.936 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1871898174285889
Epoch: 9, Steps: 9 | Train Loss: 0.094 Vali Loss: 0.975 Vali Acc: 0.696 Test Loss: 0.975 Test Acc: 0.696
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.890376329421997
Epoch: 10, Steps: 9 | Train Loss: 0.057 Vali Loss: 0.672 Vali Acc: 0.848 Test Loss: 0.672 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.23699688911438
Epoch: 11, Steps: 9 | Train Loss: 0.034 Vali Loss: 1.239 Vali Acc: 0.739 Test Loss: 1.239 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.8605709075927734
Epoch: 12, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.801 Vali Acc: 0.826 Test Loss: 0.801 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.4569664001464844
Epoch: 13, Steps: 9 | Train Loss: 0.008 Vali Loss: 1.023 Vali Acc: 0.855 Test Loss: 1.023 Test Acc: 0.855
Validation loss decreased (-0.847821 --> -0.855062).  Saving model ...
Epoch: 14 cost time: 2.168802261352539
Epoch: 14, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.764 Vali Acc: 0.877 Test Loss: 0.764 Test Acc: 0.877
Validation loss decreased (-0.855062 --> -0.876804).  Saving model ...
Epoch: 15 cost time: 2.4391026496887207
Epoch: 15, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.102 Vali Acc: 0.819 Test Loss: 1.102 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.121511459350586
Epoch: 16, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.074 Vali Acc: 0.833 Test Loss: 1.074 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.0129077434539795
Epoch: 17, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.911 Vali Acc: 0.841 Test Loss: 0.911 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.4440183639526367
Epoch: 18, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.829 Vali Acc: 0.870 Test Loss: 0.829 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.867729663848877
Epoch: 19, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.898 Vali Acc: 0.855 Test Loss: 0.898 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.0267333984375
Epoch: 20, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.958 Vali Acc: 0.848 Test Loss: 0.958 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.1645758152008057
Epoch: 21, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.956 Vali Acc: 0.848 Test Loss: 0.956 Test Acc: 0.848
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.8407645225524902
Epoch: 22, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.935 Vali Acc: 0.848 Test Loss: 0.935 Test Acc: 0.848
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.8927955627441406
Epoch: 23, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.927 Vali Acc: 0.862 Test Loss: 0.927 Test Acc: 0.862
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.9136691093444824
Epoch: 24, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.927 Vali Acc: 0.855 Test Loss: 0.927 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el4_dm768_df768_ps12_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8768115942028986
model parameter : 29584900
model size : 127.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el4_dm768_df768_ps12_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.1004838943481445
Epoch: 1, Steps: 9 | Train Loss: 1.435 Vali Loss: 1.359 Vali Acc: 0.290 Test Loss: 1.359 Test Acc: 0.290
Validation loss decreased (inf --> -0.289841).  Saving model ...
Epoch: 2 cost time: 1.757152795791626
Epoch: 2, Steps: 9 | Train Loss: 1.232 Vali Loss: 1.150 Vali Acc: 0.500 Test Loss: 1.150 Test Acc: 0.500
Validation loss decreased (-0.289841 --> -0.499988).  Saving model ...
Epoch: 3 cost time: 1.4110043048858643
Epoch: 3, Steps: 9 | Train Loss: 1.025 Vali Loss: 1.007 Vali Acc: 0.616 Test Loss: 1.007 Test Acc: 0.616
Validation loss decreased (-0.499988 --> -0.615932).  Saving model ...
Epoch: 4 cost time: 1.2167627811431885
Epoch: 4, Steps: 9 | Train Loss: 0.846 Vali Loss: 0.862 Vali Acc: 0.667 Test Loss: 0.862 Test Acc: 0.667
Validation loss decreased (-0.615932 --> -0.666658).  Saving model ...
Epoch: 5 cost time: 1.1932792663574219
Epoch: 5, Steps: 9 | Train Loss: 0.670 Vali Loss: 0.790 Vali Acc: 0.717 Test Loss: 0.790 Test Acc: 0.717
Validation loss decreased (-0.666658 --> -0.717383).  Saving model ...
Epoch: 6 cost time: 1.1786935329437256
Epoch: 6, Steps: 9 | Train Loss: 0.526 Vali Loss: 0.712 Vali Acc: 0.696 Test Loss: 0.712 Test Acc: 0.696
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.255112648010254
Epoch: 7, Steps: 9 | Train Loss: 0.356 Vali Loss: 0.659 Vali Acc: 0.754 Test Loss: 0.659 Test Acc: 0.754
Validation loss decreased (-0.717383 --> -0.753617).  Saving model ...
Epoch: 8 cost time: 1.352632761001587
Epoch: 8, Steps: 9 | Train Loss: 0.261 Vali Loss: 0.747 Vali Acc: 0.725 Test Loss: 0.747 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8569207191467285
Epoch: 9, Steps: 9 | Train Loss: 0.138 Vali Loss: 0.761 Vali Acc: 0.783 Test Loss: 0.761 Test Acc: 0.783
Validation loss decreased (-0.753617 --> -0.782601).  Saving model ...
Epoch: 10 cost time: 1.8263404369354248
Epoch: 10, Steps: 9 | Train Loss: 0.079 Vali Loss: 0.744 Vali Acc: 0.790 Test Loss: 0.744 Test Acc: 0.790
Validation loss decreased (-0.782601 --> -0.789848).  Saving model ...
Epoch: 11 cost time: 1.4262375831604004
Epoch: 11, Steps: 9 | Train Loss: 0.040 Vali Loss: 1.074 Vali Acc: 0.710 Test Loss: 1.074 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4386529922485352
Epoch: 12, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.834 Vali Acc: 0.804 Test Loss: 0.834 Test Acc: 0.804
Validation loss decreased (-0.789848 --> -0.804339).  Saving model ...
Epoch: 13 cost time: 1.2869668006896973
Epoch: 13, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.932 Vali Acc: 0.754 Test Loss: 0.932 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4335319995880127
Epoch: 14, Steps: 9 | Train Loss: 0.006 Vali Loss: 1.085 Vali Acc: 0.790 Test Loss: 1.085 Test Acc: 0.790
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.3885114192962646
Epoch: 15, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.922 Vali Acc: 0.804 Test Loss: 0.922 Test Acc: 0.804
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.272522211074829
Epoch: 16, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.886 Vali Acc: 0.783 Test Loss: 0.886 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.0948550701141357
Epoch: 17, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.941 Vali Acc: 0.790 Test Loss: 0.941 Test Acc: 0.790
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.1547672748565674
Epoch: 18, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.885 Vali Acc: 0.797 Test Loss: 0.885 Test Acc: 0.797
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.2879087924957275
Epoch: 19, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.865 Vali Acc: 0.804 Test Loss: 0.865 Test Acc: 0.804
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.318624496459961
Epoch: 20, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.967 Vali Acc: 0.790 Test Loss: 0.967 Test Acc: 0.790
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.33943772315979
Epoch: 21, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.776 Vali Acc: 0.826 Test Loss: 0.776 Test Acc: 0.826
Validation loss decreased (-0.804339 --> -0.826079).  Saving model ...
Epoch: 22 cost time: 1.2082126140594482
Epoch: 22, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.035 Vali Acc: 0.797 Test Loss: 1.035 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.4105322360992432
Epoch: 23, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.081 Vali Acc: 0.797 Test Loss: 1.081 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.6826438903808594
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.693 Vali Acc: 0.841 Test Loss: 0.693 Test Acc: 0.841
Validation loss decreased (-0.826079 --> -0.840573).  Saving model ...
Epoch: 25 cost time: 1.3317914009094238
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.930 Vali Acc: 0.804 Test Loss: 0.930 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.4559619426727295
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.054 Vali Acc: 0.797 Test Loss: 1.054 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.0989232063293457
Epoch: 27, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.007 Vali Acc: 0.804 Test Loss: 1.007 Test Acc: 0.804
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.3731002807617188
Epoch: 28, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.955 Vali Acc: 0.804 Test Loss: 0.955 Test Acc: 0.804
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.0706360340118408
Epoch: 29, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.917 Vali Acc: 0.812 Test Loss: 0.917 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.353811264038086
Epoch: 30, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.948 Vali Acc: 0.797 Test Loss: 0.948 Test Acc: 0.797
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.535125732421875
Epoch: 31, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.949 Vali Acc: 0.797 Test Loss: 0.949 Test Acc: 0.797
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.300215721130371
Epoch: 32, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.974 Vali Acc: 0.797 Test Loss: 0.974 Test Acc: 0.797
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.3915858268737793
Epoch: 33, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.994 Vali Acc: 0.804 Test Loss: 0.994 Test Acc: 0.804
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.344743013381958
Epoch: 34, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.998 Vali Acc: 0.797 Test Loss: 0.998 Test Acc: 0.797
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el4_dm768_df768_ps12_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8405797101449275
model parameter : 29437444
model size : 126.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el4_dm768_df768_ps12_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.53635835647583
Epoch: 1, Steps: 9 | Train Loss: 1.452 Vali Loss: 1.399 Vali Acc: 0.225 Test Loss: 1.399 Test Acc: 0.225
Validation loss decreased (inf --> -0.224624).  Saving model ...
Epoch: 2 cost time: 1.2315421104431152
Epoch: 2, Steps: 9 | Train Loss: 1.377 Vali Loss: 1.277 Vali Acc: 0.457 Test Loss: 1.277 Test Acc: 0.457
Validation loss decreased (-0.224624 --> -0.456509).  Saving model ...
Epoch: 3 cost time: 1.394200086593628
Epoch: 3, Steps: 9 | Train Loss: 1.220 Vali Loss: 1.142 Vali Acc: 0.558 Test Loss: 1.142 Test Acc: 0.558
Validation loss decreased (-0.456509 --> -0.557960).  Saving model ...
Epoch: 4 cost time: 1.2105515003204346
Epoch: 4, Steps: 9 | Train Loss: 1.095 Vali Loss: 1.040 Vali Acc: 0.623 Test Loss: 1.040 Test Acc: 0.623
Validation loss decreased (-0.557960 --> -0.623178).  Saving model ...
Epoch: 5 cost time: 1.2188632488250732
Epoch: 5, Steps: 9 | Train Loss: 0.945 Vali Loss: 0.927 Vali Acc: 0.652 Test Loss: 0.927 Test Acc: 0.652
Validation loss decreased (-0.623178 --> -0.652165).  Saving model ...
Epoch: 6 cost time: 1.3649225234985352
Epoch: 6, Steps: 9 | Train Loss: 0.804 Vali Loss: 0.881 Vali Acc: 0.623 Test Loss: 0.881 Test Acc: 0.623
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2123489379882812
Epoch: 7, Steps: 9 | Train Loss: 0.676 Vali Loss: 0.767 Vali Acc: 0.696 Test Loss: 0.767 Test Acc: 0.696
Validation loss decreased (-0.652165 --> -0.695645).  Saving model ...
Epoch: 8 cost time: 1.264777421951294
Epoch: 8, Steps: 9 | Train Loss: 0.486 Vali Loss: 0.846 Vali Acc: 0.616 Test Loss: 0.846 Test Acc: 0.616
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.9060494899749756
Epoch: 9, Steps: 9 | Train Loss: 0.456 Vali Loss: 0.693 Vali Acc: 0.739 Test Loss: 0.693 Test Acc: 0.739
Validation loss decreased (-0.695645 --> -0.739124).  Saving model ...
Epoch: 10 cost time: 1.2802252769470215
Epoch: 10, Steps: 9 | Train Loss: 0.276 Vali Loss: 0.797 Vali Acc: 0.703 Test Loss: 0.797 Test Acc: 0.703
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4021718502044678
Epoch: 11, Steps: 9 | Train Loss: 0.190 Vali Loss: 0.666 Vali Acc: 0.717 Test Loss: 0.666 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.7529582977294922
Epoch: 12, Steps: 9 | Train Loss: 0.145 Vali Loss: 0.793 Vali Acc: 0.761 Test Loss: 0.793 Test Acc: 0.761
Validation loss decreased (-0.739124 --> -0.760862).  Saving model ...
Epoch: 13 cost time: 1.785733938217163
Epoch: 13, Steps: 9 | Train Loss: 0.063 Vali Loss: 0.687 Vali Acc: 0.768 Test Loss: 0.687 Test Acc: 0.768
Validation loss decreased (-0.760862 --> -0.768109).  Saving model ...
Epoch: 14 cost time: 2.160888433456421
Epoch: 14, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.693 Vali Acc: 0.761 Test Loss: 0.693 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.602245807647705
Epoch: 15, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.809 Vali Acc: 0.775 Test Loss: 0.809 Test Acc: 0.775
Validation loss decreased (-0.768109 --> -0.775354).  Saving model ...
Epoch: 16 cost time: 1.5575718879699707
Epoch: 16, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.788 Vali Acc: 0.725 Test Loss: 0.788 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1961138248443604
Epoch: 17, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.823 Vali Acc: 0.797 Test Loss: 0.823 Test Acc: 0.797
Validation loss decreased (-0.775354 --> -0.797093).  Saving model ...
Epoch: 18 cost time: 1.549926519393921
Epoch: 18, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.766 Vali Acc: 0.783 Test Loss: 0.766 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2116010189056396
Epoch: 19, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.730 Vali Acc: 0.804 Test Loss: 0.730 Test Acc: 0.804
Validation loss decreased (-0.797093 --> -0.804341).  Saving model ...
Epoch: 20 cost time: 1.350334882736206
Epoch: 20, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.855 Vali Acc: 0.797 Test Loss: 0.855 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.2894554138183594
Epoch: 21, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.838 Vali Acc: 0.797 Test Loss: 0.838 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.1455740928649902
Epoch: 22, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.783 Vali Acc: 0.804 Test Loss: 0.783 Test Acc: 0.804
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.131819248199463
Epoch: 23, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.772 Vali Acc: 0.804 Test Loss: 0.772 Test Acc: 0.804
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.3037912845611572
Epoch: 24, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.854 Vali Acc: 0.790 Test Loss: 0.854 Test Acc: 0.790
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.145397663116455
Epoch: 25, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.821 Vali Acc: 0.797 Test Loss: 0.821 Test Acc: 0.797
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.0918996334075928
Epoch: 26, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.776 Vali Acc: 0.819 Test Loss: 0.776 Test Acc: 0.819
Validation loss decreased (-0.804341 --> -0.818833).  Saving model ...
Epoch: 27 cost time: 1.2278549671173096
Epoch: 27, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.812 Vali Acc: 0.797 Test Loss: 0.812 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.7303564548492432
Epoch: 28, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.859 Vali Acc: 0.790 Test Loss: 0.859 Test Acc: 0.790
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.4514305591583252
Epoch: 29, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.874 Vali Acc: 0.797 Test Loss: 0.874 Test Acc: 0.797
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.3385207653045654
Epoch: 30, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.887 Vali Acc: 0.790 Test Loss: 0.887 Test Acc: 0.790
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.2877602577209473
Epoch: 31, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.885 Vali Acc: 0.783 Test Loss: 0.885 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.421968698501587
Epoch: 32, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.865 Vali Acc: 0.797 Test Loss: 0.865 Test Acc: 0.797
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.7262046337127686
Epoch: 33, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.828 Vali Acc: 0.812 Test Loss: 0.828 Test Acc: 0.812
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.3886220455169678
Epoch: 34, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.883 Vali Acc: 0.804 Test Loss: 0.883 Test Acc: 0.804
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.5039279460906982
Epoch: 35, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.911 Vali Acc: 0.804 Test Loss: 0.911 Test Acc: 0.804
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.0318055152893066
Epoch: 36, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.899 Vali Acc: 0.804 Test Loss: 0.899 Test Acc: 0.804
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el4_dm768_df768_ps12_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8188405797101449
model parameter : 29363716
model size : 126.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el4_dm768_df768_ps13_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 4.004388093948364
Epoch: 1, Steps: 9 | Train Loss: 1.444 Vali Loss: 1.284 Vali Acc: 0.377 Test Loss: 1.284 Test Acc: 0.377
Validation loss decreased (inf --> -0.376799).  Saving model ...
Epoch: 2 cost time: 1.5722153186798096
Epoch: 2, Steps: 9 | Train Loss: 1.251 Vali Loss: 1.072 Vali Acc: 0.587 Test Loss: 1.072 Test Acc: 0.587
Validation loss decreased (-0.376799 --> -0.586946).  Saving model ...
Epoch: 3 cost time: 1.411614179611206
Epoch: 3, Steps: 9 | Train Loss: 0.961 Vali Loss: 0.890 Vali Acc: 0.703 Test Loss: 0.890 Test Acc: 0.703
Validation loss decreased (-0.586946 --> -0.702890).  Saving model ...
Epoch: 4 cost time: 1.3512346744537354
Epoch: 4, Steps: 9 | Train Loss: 0.755 Vali Loss: 0.776 Vali Acc: 0.659 Test Loss: 0.776 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.0491552352905273
Epoch: 5, Steps: 9 | Train Loss: 0.600 Vali Loss: 0.719 Vali Acc: 0.659 Test Loss: 0.719 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.5700054168701172
Epoch: 6, Steps: 9 | Train Loss: 0.451 Vali Loss: 0.681 Vali Acc: 0.754 Test Loss: 0.681 Test Acc: 0.754
Validation loss decreased (-0.702890 --> -0.753616).  Saving model ...
Epoch: 7 cost time: 1.7253837585449219
Epoch: 7, Steps: 9 | Train Loss: 0.307 Vali Loss: 0.541 Vali Acc: 0.826 Test Loss: 0.541 Test Acc: 0.826
Validation loss decreased (-0.753616 --> -0.826082).  Saving model ...
Epoch: 8 cost time: 1.7672922611236572
Epoch: 8, Steps: 9 | Train Loss: 0.174 Vali Loss: 0.589 Vali Acc: 0.797 Test Loss: 0.589 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.2305071353912354
Epoch: 9, Steps: 9 | Train Loss: 0.102 Vali Loss: 0.629 Vali Acc: 0.804 Test Loss: 0.629 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.0230751037597656
Epoch: 10, Steps: 9 | Train Loss: 0.052 Vali Loss: 0.753 Vali Acc: 0.775 Test Loss: 0.753 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.0376367568969727
Epoch: 11, Steps: 9 | Train Loss: 0.048 Vali Loss: 0.707 Vali Acc: 0.870 Test Loss: 0.707 Test Acc: 0.870
Validation loss decreased (-0.826082 --> -0.869558).  Saving model ...
Epoch: 12 cost time: 2.2205941677093506
Epoch: 12, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.716 Vali Acc: 0.804 Test Loss: 0.716 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.133774757385254
Epoch: 13, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.968 Vali Acc: 0.841 Test Loss: 0.968 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.13065242767334
Epoch: 14, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.410 Vali Acc: 0.870 Test Loss: 0.410 Test Acc: 0.870
Validation loss decreased (-0.869558 --> -0.869561).  Saving model ...
Epoch: 15 cost time: 1.85233736038208
Epoch: 15, Steps: 9 | Train Loss: 0.013 Vali Loss: 1.206 Vali Acc: 0.804 Test Loss: 1.206 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.057800769805908
Epoch: 16, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.076 Vali Acc: 0.804 Test Loss: 1.076 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.9492824077606201
Epoch: 17, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.132 Vali Acc: 0.812 Test Loss: 1.132 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.684875726699829
Epoch: 18, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.869 Vali Acc: 0.848 Test Loss: 0.869 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.880882740020752
Epoch: 19, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.816 Vali Acc: 0.855 Test Loss: 0.816 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.6524477005004883
Epoch: 20, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.816 Vali Acc: 0.855 Test Loss: 0.816 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.4516003131866455
Epoch: 21, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.867 Vali Acc: 0.848 Test Loss: 0.867 Test Acc: 0.848
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.820641279220581
Epoch: 22, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.970 Vali Acc: 0.848 Test Loss: 0.970 Test Acc: 0.848
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.7020068168640137
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.958 Vali Acc: 0.841 Test Loss: 0.958 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.6297228336334229
Epoch: 24, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.004 Vali Acc: 0.841 Test Loss: 1.004 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el4_dm768_df768_ps13_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8695652173913043
model parameter : 29518084
model size : 127.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el4_dm768_df768_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.825533628463745
Epoch: 1, Steps: 9 | Train Loss: 1.429 Vali Loss: 1.327 Vali Acc: 0.399 Test Loss: 1.327 Test Acc: 0.399
Validation loss decreased (inf --> -0.398537).  Saving model ...
Epoch: 2 cost time: 1.3500523567199707
Epoch: 2, Steps: 9 | Train Loss: 1.311 Vali Loss: 1.169 Vali Acc: 0.522 Test Loss: 1.169 Test Acc: 0.522
Validation loss decreased (-0.398537 --> -0.521727).  Saving model ...
Epoch: 3 cost time: 1.0260300636291504
Epoch: 3, Steps: 9 | Train Loss: 1.105 Vali Loss: 1.016 Vali Acc: 0.601 Test Loss: 1.016 Test Acc: 0.601
Validation loss decreased (-0.521727 --> -0.601439).  Saving model ...
Epoch: 4 cost time: 1.6778178215026855
Epoch: 4, Steps: 9 | Train Loss: 0.955 Vali Loss: 0.893 Vali Acc: 0.681 Test Loss: 0.893 Test Acc: 0.681
Validation loss decreased (-0.601439 --> -0.681150).  Saving model ...
Epoch: 5 cost time: 1.2234971523284912
Epoch: 5, Steps: 9 | Train Loss: 0.755 Vali Loss: 0.797 Vali Acc: 0.667 Test Loss: 0.797 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3040885925292969
Epoch: 6, Steps: 9 | Train Loss: 0.561 Vali Loss: 0.684 Vali Acc: 0.746 Test Loss: 0.684 Test Acc: 0.746
Validation loss decreased (-0.681150 --> -0.746370).  Saving model ...
Epoch: 7 cost time: 1.2157235145568848
Epoch: 7, Steps: 9 | Train Loss: 0.471 Vali Loss: 0.770 Vali Acc: 0.696 Test Loss: 0.770 Test Acc: 0.696
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2253639698028564
Epoch: 8, Steps: 9 | Train Loss: 0.329 Vali Loss: 0.562 Vali Acc: 0.710 Test Loss: 0.562 Test Acc: 0.710
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8868238925933838
Epoch: 9, Steps: 9 | Train Loss: 0.235 Vali Loss: 0.849 Vali Acc: 0.688 Test Loss: 0.849 Test Acc: 0.688
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.6613824367523193
Epoch: 10, Steps: 9 | Train Loss: 0.147 Vali Loss: 0.532 Vali Acc: 0.862 Test Loss: 0.532 Test Acc: 0.862
Validation loss decreased (-0.746370 --> -0.862314).  Saving model ...
Epoch: 11 cost time: 1.437781572341919
Epoch: 11, Steps: 9 | Train Loss: 0.080 Vali Loss: 0.579 Vali Acc: 0.848 Test Loss: 0.579 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3623006343841553
Epoch: 12, Steps: 9 | Train Loss: 0.047 Vali Loss: 0.713 Vali Acc: 0.833 Test Loss: 0.713 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.8506660461425781
Epoch: 13, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.745 Vali Acc: 0.833 Test Loss: 0.745 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.2800281047821045
Epoch: 14, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.809 Vali Acc: 0.804 Test Loss: 0.809 Test Acc: 0.804
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.3975954055786133
Epoch: 15, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.667 Vali Acc: 0.833 Test Loss: 0.667 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.486793041229248
Epoch: 16, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.748 Vali Acc: 0.826 Test Loss: 0.748 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.5400094985961914
Epoch: 17, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.785 Vali Acc: 0.833 Test Loss: 0.785 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.347780704498291
Epoch: 18, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.834 Vali Acc: 0.819 Test Loss: 0.834 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.2570030689239502
Epoch: 19, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.752 Vali Acc: 0.833 Test Loss: 0.752 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.0580837726593018
Epoch: 20, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.768 Vali Acc: 0.833 Test Loss: 0.768 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el4_dm768_df768_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8623188405797102
model parameter : 29421316
model size : 126.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el4_dm768_df768_ps13_str13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.9019687175750732
Epoch: 1, Steps: 9 | Train Loss: 1.482 Vali Loss: 1.444 Vali Acc: 0.167 Test Loss: 1.444 Test Acc: 0.167
Validation loss decreased (inf --> -0.166652).  Saving model ...
Epoch: 2 cost time: 1.2622628211975098
Epoch: 2, Steps: 9 | Train Loss: 1.383 Vali Loss: 1.305 Vali Acc: 0.333 Test Loss: 1.305 Test Acc: 0.333
Validation loss decreased (-0.166652 --> -0.333320).  Saving model ...
Epoch: 3 cost time: 1.2459690570831299
Epoch: 3, Steps: 9 | Train Loss: 1.254 Vali Loss: 1.182 Vali Acc: 0.572 Test Loss: 1.182 Test Acc: 0.572
Validation loss decreased (-0.333320 --> -0.572452).  Saving model ...
Epoch: 4 cost time: 1.3958847522735596
Epoch: 4, Steps: 9 | Train Loss: 1.107 Vali Loss: 1.068 Vali Acc: 0.587 Test Loss: 1.068 Test Acc: 0.587
Validation loss decreased (-0.572452 --> -0.586946).  Saving model ...
Epoch: 5 cost time: 1.0937066078186035
Epoch: 5, Steps: 9 | Train Loss: 0.949 Vali Loss: 0.961 Vali Acc: 0.630 Test Loss: 0.961 Test Acc: 0.630
Validation loss decreased (-0.586946 --> -0.630425).  Saving model ...
Epoch: 6 cost time: 1.185631275177002
Epoch: 6, Steps: 9 | Train Loss: 0.829 Vali Loss: 0.880 Vali Acc: 0.645 Test Loss: 0.880 Test Acc: 0.645
Validation loss decreased (-0.630425 --> -0.644919).  Saving model ...
Epoch: 7 cost time: 1.2203004360198975
Epoch: 7, Steps: 9 | Train Loss: 0.655 Vali Loss: 0.799 Vali Acc: 0.645 Test Loss: 0.799 Test Acc: 0.645
Validation loss decreased (-0.644919 --> -0.644920).  Saving model ...
Epoch: 8 cost time: 1.2455008029937744
Epoch: 8, Steps: 9 | Train Loss: 0.526 Vali Loss: 0.764 Vali Acc: 0.652 Test Loss: 0.764 Test Acc: 0.652
Validation loss decreased (-0.644920 --> -0.652166).  Saving model ...
Epoch: 9 cost time: 1.035761833190918
Epoch: 9, Steps: 9 | Train Loss: 0.426 Vali Loss: 0.726 Vali Acc: 0.667 Test Loss: 0.726 Test Acc: 0.667
Validation loss decreased (-0.652166 --> -0.666659).  Saving model ...
Epoch: 10 cost time: 1.3406357765197754
Epoch: 10, Steps: 9 | Train Loss: 0.297 Vali Loss: 0.836 Vali Acc: 0.652 Test Loss: 0.836 Test Acc: 0.652
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1970183849334717
Epoch: 11, Steps: 9 | Train Loss: 0.239 Vali Loss: 0.678 Vali Acc: 0.725 Test Loss: 0.678 Test Acc: 0.725
Validation loss decreased (-0.666659 --> -0.724631).  Saving model ...
Epoch: 12 cost time: 1.2481024265289307
Epoch: 12, Steps: 9 | Train Loss: 0.156 Vali Loss: 0.740 Vali Acc: 0.746 Test Loss: 0.740 Test Acc: 0.746
Validation loss decreased (-0.724631 --> -0.746369).  Saving model ...
Epoch: 13 cost time: 1.0077106952667236
Epoch: 13, Steps: 9 | Train Loss: 0.082 Vali Loss: 0.786 Vali Acc: 0.746 Test Loss: 0.786 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4049558639526367
Epoch: 14, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.663 Vali Acc: 0.775 Test Loss: 0.663 Test Acc: 0.775
Validation loss decreased (-0.746369 --> -0.775356).  Saving model ...
Epoch: 15 cost time: 1.0984365940093994
Epoch: 15, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.900 Vali Acc: 0.754 Test Loss: 0.900 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0745372772216797
Epoch: 16, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.788 Vali Acc: 0.768 Test Loss: 0.788 Test Acc: 0.768
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.5112366676330566
Epoch: 17, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.818 Vali Acc: 0.812 Test Loss: 0.818 Test Acc: 0.812
Validation loss decreased (-0.775356 --> -0.811586).  Saving model ...
Epoch: 18 cost time: 1.113006591796875
Epoch: 18, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.975 Vali Acc: 0.746 Test Loss: 0.975 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.041487455368042
Epoch: 19, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.754 Vali Acc: 0.797 Test Loss: 0.754 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9798460006713867
Epoch: 20, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.814 Vali Acc: 0.790 Test Loss: 0.814 Test Acc: 0.790
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.946221113204956
Epoch: 21, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.842 Vali Acc: 0.783 Test Loss: 0.842 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.2314724922180176
Epoch: 22, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.874 Vali Acc: 0.783 Test Loss: 0.874 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.9451141357421875
Epoch: 23, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.809 Vali Acc: 0.790 Test Loss: 0.809 Test Acc: 0.790
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.271653175354004
Epoch: 24, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.805 Vali Acc: 0.797 Test Loss: 0.805 Test Acc: 0.797
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.1695406436920166
Epoch: 25, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.823 Vali Acc: 0.797 Test Loss: 0.823 Test Acc: 0.797
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.1183741092681885
Epoch: 26, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.783 Vali Acc: 0.790 Test Loss: 0.783 Test Acc: 0.790
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.2969791889190674
Epoch: 27, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.838 Vali Acc: 0.797 Test Loss: 0.838 Test Acc: 0.797
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el4_dm768_df768_ps13_str13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8115942028985508
model parameter : 29361412
model size : 126.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el4_dm768_df768_ps14_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.944988250732422
Epoch: 1, Steps: 9 | Train Loss: 1.416 Vali Loss: 1.258 Vali Acc: 0.297 Test Loss: 1.258 Test Acc: 0.297
Validation loss decreased (inf --> -0.297089).  Saving model ...
Epoch: 2 cost time: 1.612969160079956
Epoch: 2, Steps: 9 | Train Loss: 1.248 Vali Loss: 1.042 Vali Acc: 0.587 Test Loss: 1.042 Test Acc: 0.587
Validation loss decreased (-0.297089 --> -0.586946).  Saving model ...
Epoch: 3 cost time: 1.520725965499878
Epoch: 3, Steps: 9 | Train Loss: 0.877 Vali Loss: 0.805 Vali Acc: 0.739 Test Loss: 0.805 Test Acc: 0.739
Validation loss decreased (-0.586946 --> -0.739122).  Saving model ...
Epoch: 4 cost time: 1.3421008586883545
Epoch: 4, Steps: 9 | Train Loss: 0.678 Vali Loss: 0.683 Vali Acc: 0.739 Test Loss: 0.683 Test Acc: 0.739
Validation loss decreased (-0.739122 --> -0.739124).  Saving model ...
Epoch: 5 cost time: 1.7616591453552246
Epoch: 5, Steps: 9 | Train Loss: 0.488 Vali Loss: 0.653 Vali Acc: 0.710 Test Loss: 0.653 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.75650954246521
Epoch: 6, Steps: 9 | Train Loss: 0.347 Vali Loss: 0.496 Vali Acc: 0.819 Test Loss: 0.496 Test Acc: 0.819
Validation loss decreased (-0.739124 --> -0.818836).  Saving model ...
Epoch: 7 cost time: 1.739499807357788
Epoch: 7, Steps: 9 | Train Loss: 0.229 Vali Loss: 0.725 Vali Acc: 0.725 Test Loss: 0.725 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5886998176574707
Epoch: 8, Steps: 9 | Train Loss: 0.154 Vali Loss: 0.502 Vali Acc: 0.848 Test Loss: 0.502 Test Acc: 0.848
Validation loss decreased (-0.818836 --> -0.847821).  Saving model ...
Epoch: 9 cost time: 1.9775564670562744
Epoch: 9, Steps: 9 | Train Loss: 0.120 Vali Loss: 0.885 Vali Acc: 0.725 Test Loss: 0.885 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.157036542892456
Epoch: 10, Steps: 9 | Train Loss: 0.085 Vali Loss: 0.539 Vali Acc: 0.877 Test Loss: 0.539 Test Acc: 0.877
Validation loss decreased (-0.847821 --> -0.876806).  Saving model ...
Epoch: 11 cost time: 1.9793801307678223
Epoch: 11, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.493 Vali Acc: 0.862 Test Loss: 0.493 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.1007027626037598
Epoch: 12, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.737 Vali Acc: 0.841 Test Loss: 0.737 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.2097718715667725
Epoch: 13, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.804 Vali Acc: 0.848 Test Loss: 0.804 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.9889514446258545
Epoch: 14, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.887 Vali Acc: 0.848 Test Loss: 0.887 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.0340070724487305
Epoch: 15, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.702 Vali Acc: 0.877 Test Loss: 0.702 Test Acc: 0.877
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.1265547275543213
Epoch: 16, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.998 Vali Acc: 0.812 Test Loss: 0.998 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.6742653846740723
Epoch: 17, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.943 Vali Acc: 0.862 Test Loss: 0.943 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.9368996620178223
Epoch: 18, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.868 Vali Acc: 0.862 Test Loss: 0.868 Test Acc: 0.862
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.0668141841888428
Epoch: 19, Steps: 9 | Train Loss: 0.006 Vali Loss: 1.424 Vali Acc: 0.783 Test Loss: 1.424 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.8287761211395264
Epoch: 20, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.651 Vali Acc: 0.884 Test Loss: 0.651 Test Acc: 0.884
Validation loss decreased (-0.876806 --> -0.884051).  Saving model ...
Epoch: 21 cost time: 1.723836898803711
Epoch: 21, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.978 Vali Acc: 0.877 Test Loss: 0.978 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.8187954425811768
Epoch: 22, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.814 Vali Acc: 0.841 Test Loss: 0.814 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.8677775859832764
Epoch: 23, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.034 Vali Acc: 0.862 Test Loss: 1.034 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.8246064186096191
Epoch: 24, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.341 Vali Acc: 0.848 Test Loss: 1.341 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.8991656303405762
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.287 Vali Acc: 0.848 Test Loss: 1.287 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.80928373336792
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.926 Vali Acc: 0.855 Test Loss: 0.926 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.7171506881713867
Epoch: 27, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.816 Vali Acc: 0.877 Test Loss: 0.816 Test Acc: 0.877
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.743453025817871
Epoch: 28, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.930 Vali Acc: 0.855 Test Loss: 0.930 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.387824535369873
Epoch: 29, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.224 Vali Acc: 0.855 Test Loss: 1.224 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.5807430744171143
Epoch: 30, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.318 Vali Acc: 0.855 Test Loss: 1.318 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el4_dm768_df768_ps14_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8840579710144928
model parameter : 29524996
model size : 127.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el4_dm768_df768_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.7177045345306396
Epoch: 1, Steps: 9 | Train Loss: 1.504 Vali Loss: 1.344 Vali Acc: 0.384 Test Loss: 1.344 Test Acc: 0.384
Validation loss decreased (inf --> -0.384045).  Saving model ...
Epoch: 2 cost time: 1.6728222370147705
Epoch: 2, Steps: 9 | Train Loss: 1.261 Vali Loss: 1.157 Vali Acc: 0.464 Test Loss: 1.157 Test Acc: 0.464
Validation loss decreased (-0.384045 --> -0.463757).  Saving model ...
Epoch: 3 cost time: 1.3841676712036133
Epoch: 3, Steps: 9 | Train Loss: 1.089 Vali Loss: 0.993 Vali Acc: 0.667 Test Loss: 0.993 Test Acc: 0.667
Validation loss decreased (-0.463757 --> -0.666657).  Saving model ...
Epoch: 4 cost time: 1.576528549194336
Epoch: 4, Steps: 9 | Train Loss: 0.863 Vali Loss: 0.851 Vali Acc: 0.681 Test Loss: 0.851 Test Acc: 0.681
Validation loss decreased (-0.666657 --> -0.681151).  Saving model ...
Epoch: 5 cost time: 1.2755012512207031
Epoch: 5, Steps: 9 | Train Loss: 0.704 Vali Loss: 0.766 Vali Acc: 0.703 Test Loss: 0.766 Test Acc: 0.703
Validation loss decreased (-0.681151 --> -0.702891).  Saving model ...
Epoch: 6 cost time: 1.3454627990722656
Epoch: 6, Steps: 9 | Train Loss: 0.593 Vali Loss: 0.759 Vali Acc: 0.681 Test Loss: 0.759 Test Acc: 0.681
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0625360012054443
Epoch: 7, Steps: 9 | Train Loss: 0.388 Vali Loss: 0.618 Vali Acc: 0.746 Test Loss: 0.618 Test Acc: 0.746
Validation loss decreased (-0.702891 --> -0.746371).  Saving model ...
Epoch: 8 cost time: 1.4321210384368896
Epoch: 8, Steps: 9 | Train Loss: 0.281 Vali Loss: 0.624 Vali Acc: 0.775 Test Loss: 0.624 Test Acc: 0.775
Validation loss decreased (-0.746371 --> -0.775356).  Saving model ...
Epoch: 9 cost time: 1.474341630935669
Epoch: 9, Steps: 9 | Train Loss: 0.177 Vali Loss: 0.592 Vali Acc: 0.790 Test Loss: 0.592 Test Acc: 0.790
Validation loss decreased (-0.775356 --> -0.789849).  Saving model ...
Epoch: 10 cost time: 1.5682718753814697
Epoch: 10, Steps: 9 | Train Loss: 0.112 Vali Loss: 0.741 Vali Acc: 0.812 Test Loss: 0.741 Test Acc: 0.812
Validation loss decreased (-0.789849 --> -0.811587).  Saving model ...
Epoch: 11 cost time: 1.464449405670166
Epoch: 11, Steps: 9 | Train Loss: 0.058 Vali Loss: 0.927 Vali Acc: 0.746 Test Loss: 0.927 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.6770567893981934
Epoch: 12, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.745 Vali Acc: 0.804 Test Loss: 0.745 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.705355167388916
Epoch: 13, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.660 Vali Acc: 0.841 Test Loss: 0.660 Test Acc: 0.841
Validation loss decreased (-0.811587 --> -0.840573).  Saving model ...
Epoch: 14 cost time: 2.008549451828003
Epoch: 14, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.872 Vali Acc: 0.826 Test Loss: 0.872 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4951703548431396
Epoch: 15, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.796 Vali Acc: 0.841 Test Loss: 0.796 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.3078408241271973
Epoch: 16, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.939 Vali Acc: 0.812 Test Loss: 0.939 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.6971869468688965
Epoch: 17, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.727 Vali Acc: 0.848 Test Loss: 0.727 Test Acc: 0.848
Validation loss decreased (-0.840573 --> -0.847819).  Saving model ...
Epoch: 18 cost time: 1.7403061389923096
Epoch: 18, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.793 Vali Acc: 0.841 Test Loss: 0.793 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.3156323432922363
Epoch: 19, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.935 Vali Acc: 0.812 Test Loss: 0.935 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.576897144317627
Epoch: 20, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.768 Vali Acc: 0.841 Test Loss: 0.768 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.6007874011993408
Epoch: 21, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.775 Vali Acc: 0.848 Test Loss: 0.775 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.8044071197509766
Epoch: 22, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.877 Vali Acc: 0.833 Test Loss: 0.877 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.6875004768371582
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.852 Vali Acc: 0.833 Test Loss: 0.852 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.8856401443481445
Epoch: 24, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.797 Vali Acc: 0.841 Test Loss: 0.797 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.5695674419403076
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.869 Vali Acc: 0.848 Test Loss: 0.869 Test Acc: 0.848
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.4962775707244873
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.918 Vali Acc: 0.833 Test Loss: 0.918 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.713961124420166
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.893 Vali Acc: 0.848 Test Loss: 0.893 Test Acc: 0.848
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el4_dm768_df768_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8478260869565217
model parameter : 29428228
model size : 126.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el4_dm768_df768_ps14_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.1528964042663574
Epoch: 1, Steps: 9 | Train Loss: 1.408 Vali Loss: 1.349 Vali Acc: 0.341 Test Loss: 1.349 Test Acc: 0.341
Validation loss decreased (inf --> -0.340566).  Saving model ...
Epoch: 2 cost time: 0.9121203422546387
Epoch: 2, Steps: 9 | Train Loss: 1.282 Vali Loss: 1.232 Vali Acc: 0.514 Test Loss: 1.232 Test Acc: 0.514
Validation loss decreased (-0.340566 --> -0.514480).  Saving model ...
Epoch: 3 cost time: 1.105034589767456
Epoch: 3, Steps: 9 | Train Loss: 1.200 Vali Loss: 1.114 Vali Acc: 0.580 Test Loss: 1.114 Test Acc: 0.580
Validation loss decreased (-0.514480 --> -0.579699).  Saving model ...
Epoch: 4 cost time: 1.1271507740020752
Epoch: 4, Steps: 9 | Train Loss: 1.026 Vali Loss: 1.037 Vali Acc: 0.638 Test Loss: 1.037 Test Acc: 0.638
Validation loss decreased (-0.579699 --> -0.637671).  Saving model ...
Epoch: 5 cost time: 1.243805170059204
Epoch: 5, Steps: 9 | Train Loss: 0.883 Vali Loss: 0.902 Vali Acc: 0.659 Test Loss: 0.902 Test Acc: 0.659
Validation loss decreased (-0.637671 --> -0.659411).  Saving model ...
Epoch: 6 cost time: 1.148888111114502
Epoch: 6, Steps: 9 | Train Loss: 0.764 Vali Loss: 0.798 Vali Acc: 0.696 Test Loss: 0.798 Test Acc: 0.696
Validation loss decreased (-0.659411 --> -0.695644).  Saving model ...
Epoch: 7 cost time: 1.1354141235351562
Epoch: 7, Steps: 9 | Train Loss: 0.634 Vali Loss: 0.757 Vali Acc: 0.681 Test Loss: 0.757 Test Acc: 0.681
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0527269840240479
Epoch: 8, Steps: 9 | Train Loss: 0.516 Vali Loss: 0.709 Vali Acc: 0.732 Test Loss: 0.709 Test Acc: 0.732
Validation loss decreased (-0.695644 --> -0.731877).  Saving model ...
Epoch: 9 cost time: 1.1888723373413086
Epoch: 9, Steps: 9 | Train Loss: 0.359 Vali Loss: 0.774 Vali Acc: 0.710 Test Loss: 0.774 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3232700824737549
Epoch: 10, Steps: 9 | Train Loss: 0.309 Vali Loss: 0.609 Vali Acc: 0.761 Test Loss: 0.609 Test Acc: 0.761
Validation loss decreased (-0.731877 --> -0.760863).  Saving model ...
Epoch: 11 cost time: 1.3342831134796143
Epoch: 11, Steps: 9 | Train Loss: 0.189 Vali Loss: 0.820 Vali Acc: 0.717 Test Loss: 0.820 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0960760116577148
Epoch: 12, Steps: 9 | Train Loss: 0.155 Vali Loss: 0.561 Vali Acc: 0.790 Test Loss: 0.561 Test Acc: 0.790
Validation loss decreased (-0.760863 --> -0.789849).  Saving model ...
Epoch: 13 cost time: 1.576310634613037
Epoch: 13, Steps: 9 | Train Loss: 0.095 Vali Loss: 0.772 Vali Acc: 0.746 Test Loss: 0.772 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1834697723388672
Epoch: 14, Steps: 9 | Train Loss: 0.051 Vali Loss: 0.730 Vali Acc: 0.797 Test Loss: 0.730 Test Acc: 0.797
Validation loss decreased (-0.789849 --> -0.797094).  Saving model ...
Epoch: 15 cost time: 1.063657283782959
Epoch: 15, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.697 Vali Acc: 0.790 Test Loss: 0.697 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2687263488769531
Epoch: 16, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.821 Vali Acc: 0.797 Test Loss: 0.821 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.1452577114105225
Epoch: 17, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.716 Vali Acc: 0.812 Test Loss: 0.716 Test Acc: 0.812
Validation loss decreased (-0.797094 --> -0.811587).  Saving model ...
Epoch: 18 cost time: 1.1609177589416504
Epoch: 18, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.808 Vali Acc: 0.790 Test Loss: 0.808 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.397458791732788
Epoch: 19, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.816 Vali Acc: 0.804 Test Loss: 0.816 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.1418683528900146
Epoch: 20, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.726 Vali Acc: 0.819 Test Loss: 0.726 Test Acc: 0.819
Validation loss decreased (-0.811587 --> -0.818833).  Saving model ...
Epoch: 21 cost time: 1.0885684490203857
Epoch: 21, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.780 Vali Acc: 0.819 Test Loss: 0.780 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.19162917137146
Epoch: 22, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.808 Vali Acc: 0.804 Test Loss: 0.808 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.2639381885528564
Epoch: 23, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.822 Vali Acc: 0.804 Test Loss: 0.822 Test Acc: 0.804
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.1371581554412842
Epoch: 24, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.843 Vali Acc: 0.804 Test Loss: 0.843 Test Acc: 0.804
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.2490119934082031
Epoch: 25, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.819 Vali Acc: 0.804 Test Loss: 0.819 Test Acc: 0.804
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.1361706256866455
Epoch: 26, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.787 Vali Acc: 0.812 Test Loss: 0.787 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.2401938438415527
Epoch: 27, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.829 Vali Acc: 0.804 Test Loss: 0.829 Test Acc: 0.804
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.179445505142212
Epoch: 28, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.822 Vali Acc: 0.804 Test Loss: 0.822 Test Acc: 0.804
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.9828548431396484
Epoch: 29, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.833 Vali Acc: 0.812 Test Loss: 0.833 Test Acc: 0.812
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.1917009353637695
Epoch: 30, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.847 Vali Acc: 0.812 Test Loss: 0.847 Test Acc: 0.812
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el4_dm768_df768_ps14_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8188405797101449
model parameter : 29363716
model size : 126.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el4_dm768_df768_ps15_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.5449295043945312
Epoch: 1, Steps: 9 | Train Loss: 1.479 Vali Loss: 1.343 Vali Acc: 0.319 Test Loss: 1.343 Test Acc: 0.319
Validation loss decreased (inf --> -0.318827).  Saving model ...
Epoch: 2 cost time: 1.532569408416748
Epoch: 2, Steps: 9 | Train Loss: 1.212 Vali Loss: 1.106 Vali Acc: 0.616 Test Loss: 1.106 Test Acc: 0.616
Validation loss decreased (-0.318827 --> -0.615931).  Saving model ...
Epoch: 3 cost time: 1.7074618339538574
Epoch: 3, Steps: 9 | Train Loss: 0.978 Vali Loss: 0.927 Vali Acc: 0.616 Test Loss: 0.927 Test Acc: 0.616
Validation loss decreased (-0.615931 --> -0.615933).  Saving model ...
Epoch: 4 cost time: 1.6095948219299316
Epoch: 4, Steps: 9 | Train Loss: 0.790 Vali Loss: 0.788 Vali Acc: 0.717 Test Loss: 0.788 Test Acc: 0.717
Validation loss decreased (-0.615933 --> -0.717383).  Saving model ...
Epoch: 5 cost time: 1.4599673748016357
Epoch: 5, Steps: 9 | Train Loss: 0.572 Vali Loss: 0.750 Vali Acc: 0.681 Test Loss: 0.750 Test Acc: 0.681
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3290951251983643
Epoch: 6, Steps: 9 | Train Loss: 0.462 Vali Loss: 0.679 Vali Acc: 0.732 Test Loss: 0.679 Test Acc: 0.732
Validation loss decreased (-0.717383 --> -0.731877).  Saving model ...
Epoch: 7 cost time: 1.7524726390838623
Epoch: 7, Steps: 9 | Train Loss: 0.263 Vali Loss: 0.750 Vali Acc: 0.746 Test Loss: 0.750 Test Acc: 0.746
Validation loss decreased (-0.731877 --> -0.746369).  Saving model ...
Epoch: 8 cost time: 1.6531085968017578
Epoch: 8, Steps: 9 | Train Loss: 0.243 Vali Loss: 0.582 Vali Acc: 0.783 Test Loss: 0.582 Test Acc: 0.783
Validation loss decreased (-0.746369 --> -0.782603).  Saving model ...
Epoch: 9 cost time: 1.5651092529296875
Epoch: 9, Steps: 9 | Train Loss: 0.222 Vali Loss: 0.568 Vali Acc: 0.797 Test Loss: 0.568 Test Acc: 0.797
Validation loss decreased (-0.782603 --> -0.797096).  Saving model ...
Epoch: 10 cost time: 1.850846290588379
Epoch: 10, Steps: 9 | Train Loss: 0.062 Vali Loss: 0.614 Vali Acc: 0.783 Test Loss: 0.614 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5545625686645508
Epoch: 11, Steps: 9 | Train Loss: 0.075 Vali Loss: 0.793 Vali Acc: 0.833 Test Loss: 0.793 Test Acc: 0.833
Validation loss decreased (-0.797096 --> -0.833325).  Saving model ...
Epoch: 12 cost time: 2.06203293800354
Epoch: 12, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.923 Vali Acc: 0.812 Test Loss: 0.923 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4432053565979004
Epoch: 13, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.955 Vali Acc: 0.819 Test Loss: 0.955 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.9661962985992432
Epoch: 14, Steps: 9 | Train Loss: 0.031 Vali Loss: 1.013 Vali Acc: 0.790 Test Loss: 1.013 Test Acc: 0.790
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.9135582447052002
Epoch: 15, Steps: 9 | Train Loss: 0.006 Vali Loss: 1.025 Vali Acc: 0.841 Test Loss: 1.025 Test Acc: 0.841
Validation loss decreased (-0.833325 --> -0.840569).  Saving model ...
Epoch: 16 cost time: 1.8741052150726318
Epoch: 16, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.100 Vali Acc: 0.746 Test Loss: 1.100 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.8452997207641602
Epoch: 17, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.832 Vali Acc: 0.855 Test Loss: 0.832 Test Acc: 0.855
Validation loss decreased (-0.840569 --> -0.855064).  Saving model ...
Epoch: 18 cost time: 1.8674461841583252
Epoch: 18, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.698 Vali Acc: 0.833 Test Loss: 0.698 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.1558098793029785
Epoch: 19, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.922 Vali Acc: 0.862 Test Loss: 0.922 Test Acc: 0.862
Validation loss decreased (-0.855064 --> -0.862310).  Saving model ...
Epoch: 20 cost time: 2.0930228233337402
Epoch: 20, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.113 Vali Acc: 0.826 Test Loss: 1.113 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.915309190750122
Epoch: 21, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.926 Vali Acc: 0.855 Test Loss: 0.926 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.1355559825897217
Epoch: 22, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.878 Vali Acc: 0.855 Test Loss: 0.878 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.125917911529541
Epoch: 23, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.892 Vali Acc: 0.841 Test Loss: 0.892 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.1412136554718018
Epoch: 24, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.931 Vali Acc: 0.848 Test Loss: 0.931 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.9398071765899658
Epoch: 25, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.948 Vali Acc: 0.848 Test Loss: 0.948 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.328479528427124
Epoch: 26, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.943 Vali Acc: 0.848 Test Loss: 0.943 Test Acc: 0.848
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.6248619556427002
Epoch: 27, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.971 Vali Acc: 0.833 Test Loss: 0.971 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.5366520881652832
Epoch: 28, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.009 Vali Acc: 0.833 Test Loss: 1.009 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.5671634674072266
Epoch: 29, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.996 Vali Acc: 0.833 Test Loss: 0.996 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el4_dm768_df768_ps15_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8623188405797102
model parameter : 29527300
model size : 127.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el4_dm768_df768_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.3586323261260986
Epoch: 1, Steps: 9 | Train Loss: 1.418 Vali Loss: 1.336 Vali Acc: 0.326 Test Loss: 1.336 Test Acc: 0.326
Validation loss decreased (inf --> -0.326074).  Saving model ...
Epoch: 2 cost time: 1.480339527130127
Epoch: 2, Steps: 9 | Train Loss: 1.312 Vali Loss: 1.191 Vali Acc: 0.478 Test Loss: 1.191 Test Acc: 0.478
Validation loss decreased (-0.326074 --> -0.478249).  Saving model ...
Epoch: 3 cost time: 1.6453309059143066
Epoch: 3, Steps: 9 | Train Loss: 1.150 Vali Loss: 1.094 Vali Acc: 0.551 Test Loss: 1.094 Test Acc: 0.551
Validation loss decreased (-0.478249 --> -0.550714).  Saving model ...
Epoch: 4 cost time: 1.4870944023132324
Epoch: 4, Steps: 9 | Train Loss: 0.933 Vali Loss: 0.949 Vali Acc: 0.674 Test Loss: 0.949 Test Acc: 0.674
Validation loss decreased (-0.550714 --> -0.673904).  Saving model ...
Epoch: 5 cost time: 1.541639804840088
Epoch: 5, Steps: 9 | Train Loss: 0.800 Vali Loss: 0.833 Vali Acc: 0.659 Test Loss: 0.833 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.390028715133667
Epoch: 6, Steps: 9 | Train Loss: 0.642 Vali Loss: 0.745 Vali Acc: 0.703 Test Loss: 0.745 Test Acc: 0.703
Validation loss decreased (-0.673904 --> -0.702891).  Saving model ...
Epoch: 7 cost time: 1.2841072082519531
Epoch: 7, Steps: 9 | Train Loss: 0.483 Vali Loss: 0.656 Vali Acc: 0.739 Test Loss: 0.656 Test Acc: 0.739
Validation loss decreased (-0.702891 --> -0.739124).  Saving model ...
Epoch: 8 cost time: 1.633873701095581
Epoch: 8, Steps: 9 | Train Loss: 0.344 Vali Loss: 0.603 Vali Acc: 0.725 Test Loss: 0.603 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9189841747283936
Epoch: 9, Steps: 9 | Train Loss: 0.257 Vali Loss: 0.805 Vali Acc: 0.761 Test Loss: 0.805 Test Acc: 0.761
Validation loss decreased (-0.739124 --> -0.760862).  Saving model ...
Epoch: 10 cost time: 1.2911221981048584
Epoch: 10, Steps: 9 | Train Loss: 0.223 Vali Loss: 0.551 Vali Acc: 0.783 Test Loss: 0.551 Test Acc: 0.783
Validation loss decreased (-0.760862 --> -0.782603).  Saving model ...
Epoch: 11 cost time: 1.2758944034576416
Epoch: 11, Steps: 9 | Train Loss: 0.103 Vali Loss: 0.763 Vali Acc: 0.783 Test Loss: 0.763 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.04079270362854
Epoch: 12, Steps: 9 | Train Loss: 0.058 Vali Loss: 0.725 Vali Acc: 0.833 Test Loss: 0.725 Test Acc: 0.833
Validation loss decreased (-0.782603 --> -0.833326).  Saving model ...
Epoch: 13 cost time: 1.0321426391601562
Epoch: 13, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.734 Vali Acc: 0.826 Test Loss: 0.734 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3038277626037598
Epoch: 14, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.759 Vali Acc: 0.833 Test Loss: 0.759 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.2280161380767822
Epoch: 15, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.782 Vali Acc: 0.826 Test Loss: 0.782 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.9445688724517822
Epoch: 16, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.960 Vali Acc: 0.819 Test Loss: 0.960 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.4310412406921387
Epoch: 17, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.769 Vali Acc: 0.833 Test Loss: 0.769 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.8992891311645508
Epoch: 18, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.871 Vali Acc: 0.812 Test Loss: 0.871 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.9295506477355957
Epoch: 19, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.895 Vali Acc: 0.826 Test Loss: 0.895 Test Acc: 0.826
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.8417036533355713
Epoch: 20, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.908 Vali Acc: 0.833 Test Loss: 0.908 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.9648189544677734
Epoch: 21, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.863 Vali Acc: 0.833 Test Loss: 0.863 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.2537753582000732
Epoch: 22, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.865 Vali Acc: 0.826 Test Loss: 0.865 Test Acc: 0.826
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el4_dm768_df768_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8333333333333334
model parameter : 29416708
model size : 126.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el4_dm768_df768_ps15_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.967789649963379
Epoch: 1, Steps: 9 | Train Loss: 1.399 Vali Loss: 1.347 Vali Acc: 0.283 Test Loss: 1.347 Test Acc: 0.283
Validation loss decreased (inf --> -0.282595).  Saving model ...
Epoch: 2 cost time: 0.9683911800384521
Epoch: 2, Steps: 9 | Train Loss: 1.311 Vali Loss: 1.269 Vali Acc: 0.449 Test Loss: 1.269 Test Acc: 0.449
Validation loss decreased (-0.282595 --> -0.449263).  Saving model ...
Epoch: 3 cost time: 1.0736653804779053
Epoch: 3, Steps: 9 | Train Loss: 1.160 Vali Loss: 1.157 Vali Acc: 0.565 Test Loss: 1.157 Test Acc: 0.565
Validation loss decreased (-0.449263 --> -0.565206).  Saving model ...
Epoch: 4 cost time: 1.120957851409912
Epoch: 4, Steps: 9 | Train Loss: 1.067 Vali Loss: 1.051 Vali Acc: 0.601 Test Loss: 1.051 Test Acc: 0.601
Validation loss decreased (-0.565206 --> -0.601439).  Saving model ...
Epoch: 5 cost time: 1.2747342586517334
Epoch: 5, Steps: 9 | Train Loss: 0.930 Vali Loss: 0.943 Vali Acc: 0.638 Test Loss: 0.943 Test Acc: 0.638
Validation loss decreased (-0.601439 --> -0.637672).  Saving model ...
Epoch: 6 cost time: 1.1079602241516113
Epoch: 6, Steps: 9 | Train Loss: 0.765 Vali Loss: 0.902 Vali Acc: 0.623 Test Loss: 0.902 Test Acc: 0.623
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.240117073059082
Epoch: 7, Steps: 9 | Train Loss: 0.647 Vali Loss: 0.773 Vali Acc: 0.696 Test Loss: 0.773 Test Acc: 0.696
Validation loss decreased (-0.637672 --> -0.695644).  Saving model ...
Epoch: 8 cost time: 0.861748218536377
Epoch: 8, Steps: 9 | Train Loss: 0.478 Vali Loss: 0.702 Vali Acc: 0.674 Test Loss: 0.702 Test Acc: 0.674
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.045426607131958
Epoch: 9, Steps: 9 | Train Loss: 0.396 Vali Loss: 0.743 Vali Acc: 0.717 Test Loss: 0.743 Test Acc: 0.717
Validation loss decreased (-0.695644 --> -0.717384).  Saving model ...
Epoch: 10 cost time: 1.1756935119628906
Epoch: 10, Steps: 9 | Train Loss: 0.274 Vali Loss: 0.617 Vali Acc: 0.739 Test Loss: 0.617 Test Acc: 0.739
Validation loss decreased (-0.717384 --> -0.739124).  Saving model ...
Epoch: 11 cost time: 1.0032494068145752
Epoch: 11, Steps: 9 | Train Loss: 0.200 Vali Loss: 0.673 Vali Acc: 0.739 Test Loss: 0.673 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2010157108306885
Epoch: 12, Steps: 9 | Train Loss: 0.155 Vali Loss: 0.660 Vali Acc: 0.754 Test Loss: 0.660 Test Acc: 0.754
Validation loss decreased (-0.739124 --> -0.753617).  Saving model ...
Epoch: 13 cost time: 0.9484336376190186
Epoch: 13, Steps: 9 | Train Loss: 0.082 Vali Loss: 0.618 Vali Acc: 0.790 Test Loss: 0.618 Test Acc: 0.790
Validation loss decreased (-0.753617 --> -0.789849).  Saving model ...
Epoch: 14 cost time: 1.0942678451538086
Epoch: 14, Steps: 9 | Train Loss: 0.061 Vali Loss: 0.756 Vali Acc: 0.775 Test Loss: 0.756 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9258506298065186
Epoch: 15, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.812 Vali Acc: 0.739 Test Loss: 0.812 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9572188854217529
Epoch: 16, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.611 Vali Acc: 0.783 Test Loss: 0.611 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.0297565460205078
Epoch: 17, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.844 Vali Acc: 0.783 Test Loss: 0.844 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.0625064373016357
Epoch: 18, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.671 Vali Acc: 0.804 Test Loss: 0.671 Test Acc: 0.804
Validation loss decreased (-0.789849 --> -0.804341).  Saving model ...
Epoch: 19 cost time: 1.1189451217651367
Epoch: 19, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.702 Vali Acc: 0.812 Test Loss: 0.702 Test Acc: 0.812
Validation loss decreased (-0.804341 --> -0.811587).  Saving model ...
Epoch: 20 cost time: 0.9591941833496094
Epoch: 20, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.874 Vali Acc: 0.804 Test Loss: 0.874 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.2298214435577393
Epoch: 21, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.809 Vali Acc: 0.790 Test Loss: 0.809 Test Acc: 0.790
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.1017637252807617
Epoch: 22, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.783 Vali Acc: 0.790 Test Loss: 0.783 Test Acc: 0.790
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.9808640480041504
Epoch: 23, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.778 Vali Acc: 0.790 Test Loss: 0.778 Test Acc: 0.790
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.119706153869629
Epoch: 24, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.786 Vali Acc: 0.790 Test Loss: 0.786 Test Acc: 0.790
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.8435428142547607
Epoch: 25, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.832 Vali Acc: 0.797 Test Loss: 0.832 Test Acc: 0.797
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.8984615802764893
Epoch: 26, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.813 Vali Acc: 0.812 Test Loss: 0.813 Test Acc: 0.812
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.8461377620697021
Epoch: 27, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.815 Vali Acc: 0.804 Test Loss: 0.815 Test Acc: 0.804
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.9875967502593994
Epoch: 28, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.814 Vali Acc: 0.797 Test Loss: 0.814 Test Acc: 0.797
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.0971696376800537
Epoch: 29, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.794 Vali Acc: 0.812 Test Loss: 0.794 Test Acc: 0.812
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el4_dm768_df768_ps15_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8115942028985508
model parameter : 29366020
model size : 126.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el4_dm768_df768_ps16_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.5484161376953125
Epoch: 1, Steps: 9 | Train Loss: 1.423 Vali Loss: 1.300 Vali Acc: 0.304 Test Loss: 1.300 Test Acc: 0.304
Validation loss decreased (inf --> -0.304335).  Saving model ...
Epoch: 2 cost time: 1.1326777935028076
Epoch: 2, Steps: 9 | Train Loss: 1.190 Vali Loss: 1.073 Vali Acc: 0.623 Test Loss: 1.073 Test Acc: 0.623
Validation loss decreased (-0.304335 --> -0.623178).  Saving model ...
Epoch: 3 cost time: 1.1019783020019531
Epoch: 3, Steps: 9 | Train Loss: 0.938 Vali Loss: 0.900 Vali Acc: 0.616 Test Loss: 0.900 Test Acc: 0.616
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3342645168304443
Epoch: 4, Steps: 9 | Train Loss: 0.729 Vali Loss: 0.845 Vali Acc: 0.616 Test Loss: 0.845 Test Acc: 0.616
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2833600044250488
Epoch: 5, Steps: 9 | Train Loss: 0.556 Vali Loss: 0.635 Vali Acc: 0.725 Test Loss: 0.635 Test Acc: 0.725
Validation loss decreased (-0.623178 --> -0.724631).  Saving model ...
Epoch: 6 cost time: 1.5528359413146973
Epoch: 6, Steps: 9 | Train Loss: 0.369 Vali Loss: 0.782 Vali Acc: 0.652 Test Loss: 0.782 Test Acc: 0.652
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6630980968475342
Epoch: 7, Steps: 9 | Train Loss: 0.271 Vali Loss: 0.498 Vali Acc: 0.804 Test Loss: 0.498 Test Acc: 0.804
Validation loss decreased (-0.724631 --> -0.804343).  Saving model ...
Epoch: 8 cost time: 1.474367618560791
Epoch: 8, Steps: 9 | Train Loss: 0.184 Vali Loss: 0.447 Vali Acc: 0.804 Test Loss: 0.447 Test Acc: 0.804
Validation loss decreased (-0.804343 --> -0.804343).  Saving model ...
Epoch: 9 cost time: 1.6674365997314453
Epoch: 9, Steps: 9 | Train Loss: 0.118 Vali Loss: 0.514 Vali Acc: 0.804 Test Loss: 0.514 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.816493034362793
Epoch: 10, Steps: 9 | Train Loss: 0.072 Vali Loss: 0.545 Vali Acc: 0.833 Test Loss: 0.545 Test Acc: 0.833
Validation loss decreased (-0.804343 --> -0.833328).  Saving model ...
Epoch: 11 cost time: 1.8343262672424316
Epoch: 11, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.721 Vali Acc: 0.797 Test Loss: 0.721 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.7998006343841553
Epoch: 12, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.697 Vali Acc: 0.783 Test Loss: 0.697 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.8548977375030518
Epoch: 13, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.951 Vali Acc: 0.804 Test Loss: 0.951 Test Acc: 0.804
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.6952879428863525
Epoch: 14, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.675 Vali Acc: 0.855 Test Loss: 0.675 Test Acc: 0.855
Validation loss decreased (-0.833328 --> -0.855066).  Saving model ...
Epoch: 15 cost time: 2.1648941040039062
Epoch: 15, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.817 Vali Acc: 0.848 Test Loss: 0.817 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.8390552997589111
Epoch: 16, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.488 Vali Acc: 0.899 Test Loss: 0.488 Test Acc: 0.899
Validation loss decreased (-0.855066 --> -0.898546).  Saving model ...
Epoch: 17 cost time: 2.147351026535034
Epoch: 17, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.897 Vali Acc: 0.855 Test Loss: 0.897 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.9331111907958984
Epoch: 18, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.933 Vali Acc: 0.855 Test Loss: 0.933 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.7055625915527344
Epoch: 19, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.853 Vali Acc: 0.848 Test Loss: 0.853 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.9353208541870117
Epoch: 20, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.771 Vali Acc: 0.833 Test Loss: 0.771 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.6805486679077148
Epoch: 21, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.781 Vali Acc: 0.819 Test Loss: 0.781 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.425779104232788
Epoch: 22, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.821 Vali Acc: 0.841 Test Loss: 0.821 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.5447375774383545
Epoch: 23, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.854 Vali Acc: 0.862 Test Loss: 0.854 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.5087738037109375
Epoch: 24, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.850 Vali Acc: 0.855 Test Loss: 0.850 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.671726942062378
Epoch: 25, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.836 Vali Acc: 0.855 Test Loss: 0.836 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.7166762351989746
Epoch: 26, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.824 Vali Acc: 0.862 Test Loss: 0.824 Test Acc: 0.862
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el4_dm768_df768_ps16_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8985507246376812
model parameter : 29534212
model size : 127.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el4_dm768_df768_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.6718671321868896
Epoch: 1, Steps: 9 | Train Loss: 1.384 Vali Loss: 1.268 Vali Acc: 0.420 Test Loss: 1.268 Test Acc: 0.420
Validation loss decreased (inf --> -0.420277).  Saving model ...
Epoch: 2 cost time: 1.2367236614227295
Epoch: 2, Steps: 9 | Train Loss: 1.220 Vali Loss: 1.129 Vali Acc: 0.558 Test Loss: 1.129 Test Acc: 0.558
Validation loss decreased (-0.420277 --> -0.557960).  Saving model ...
Epoch: 3 cost time: 1.3822908401489258
Epoch: 3, Steps: 9 | Train Loss: 1.068 Vali Loss: 0.983 Vali Acc: 0.594 Test Loss: 0.983 Test Acc: 0.594
Validation loss decreased (-0.557960 --> -0.594193).  Saving model ...
Epoch: 4 cost time: 1.257291555404663
Epoch: 4, Steps: 9 | Train Loss: 0.900 Vali Loss: 0.875 Vali Acc: 0.623 Test Loss: 0.875 Test Acc: 0.623
Validation loss decreased (-0.594193 --> -0.623180).  Saving model ...
Epoch: 5 cost time: 1.0316734313964844
Epoch: 5, Steps: 9 | Train Loss: 0.712 Vali Loss: 0.786 Vali Acc: 0.667 Test Loss: 0.786 Test Acc: 0.667
Validation loss decreased (-0.623180 --> -0.666659).  Saving model ...
Epoch: 6 cost time: 1.448091745376587
Epoch: 6, Steps: 9 | Train Loss: 0.574 Vali Loss: 0.675 Vali Acc: 0.688 Test Loss: 0.675 Test Acc: 0.688
Validation loss decreased (-0.666659 --> -0.688399).  Saving model ...
Epoch: 7 cost time: 1.4984288215637207
Epoch: 7, Steps: 9 | Train Loss: 0.439 Vali Loss: 0.652 Vali Acc: 0.710 Test Loss: 0.652 Test Acc: 0.710
Validation loss decreased (-0.688399 --> -0.710138).  Saving model ...
Epoch: 8 cost time: 1.4497487545013428
Epoch: 8, Steps: 9 | Train Loss: 0.358 Vali Loss: 0.549 Vali Acc: 0.754 Test Loss: 0.549 Test Acc: 0.754
Validation loss decreased (-0.710138 --> -0.753618).  Saving model ...
Epoch: 9 cost time: 1.388066053390503
Epoch: 9, Steps: 9 | Train Loss: 0.239 Vali Loss: 0.551 Vali Acc: 0.775 Test Loss: 0.551 Test Acc: 0.775
Validation loss decreased (-0.753618 --> -0.775357).  Saving model ...
Epoch: 10 cost time: 1.6906299591064453
Epoch: 10, Steps: 9 | Train Loss: 0.169 Vali Loss: 0.509 Vali Acc: 0.819 Test Loss: 0.509 Test Acc: 0.819
Validation loss decreased (-0.775357 --> -0.818835).  Saving model ...
Epoch: 11 cost time: 1.3604683876037598
Epoch: 11, Steps: 9 | Train Loss: 0.101 Vali Loss: 0.471 Vali Acc: 0.833 Test Loss: 0.471 Test Acc: 0.833
Validation loss decreased (-0.818835 --> -0.833329).  Saving model ...
Epoch: 12 cost time: 1.0562520027160645
Epoch: 12, Steps: 9 | Train Loss: 0.064 Vali Loss: 0.743 Vali Acc: 0.790 Test Loss: 0.743 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.047086477279663
Epoch: 13, Steps: 9 | Train Loss: 0.077 Vali Loss: 0.644 Vali Acc: 0.812 Test Loss: 0.644 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.5459949970245361
Epoch: 14, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.682 Vali Acc: 0.804 Test Loss: 0.682 Test Acc: 0.804
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.2234301567077637
Epoch: 15, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.704 Vali Acc: 0.833 Test Loss: 0.704 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.1782855987548828
Epoch: 16, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.699 Vali Acc: 0.841 Test Loss: 0.699 Test Acc: 0.841
Validation loss decreased (-0.833329 --> -0.840573).  Saving model ...
Epoch: 17 cost time: 1.2499735355377197
Epoch: 17, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.919 Vali Acc: 0.819 Test Loss: 0.919 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.4305775165557861
Epoch: 18, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.628 Vali Acc: 0.848 Test Loss: 0.628 Test Acc: 0.848
Validation loss decreased (-0.840573 --> -0.847820).  Saving model ...
Epoch: 19 cost time: 1.3781521320343018
Epoch: 19, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.825 Vali Acc: 0.819 Test Loss: 0.825 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.6791114807128906
Epoch: 20, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.866 Vali Acc: 0.848 Test Loss: 0.866 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.0873606204986572
Epoch: 21, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.911 Vali Acc: 0.841 Test Loss: 0.911 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.134394645690918
Epoch: 22, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.846 Vali Acc: 0.833 Test Loss: 0.846 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.9196224212646484
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.756 Vali Acc: 0.855 Test Loss: 0.756 Test Acc: 0.855
Validation loss decreased (-0.847820 --> -0.855065).  Saving model ...
Epoch: 24 cost time: 1.1558728218078613
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.753 Vali Acc: 0.855 Test Loss: 0.753 Test Acc: 0.855
Validation loss decreased (-0.855065 --> -0.855065).  Saving model ...
Epoch: 25 cost time: 1.2624311447143555
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.787 Vali Acc: 0.848 Test Loss: 0.787 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.2494337558746338
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.808 Vali Acc: 0.848 Test Loss: 0.808 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.075709581375122
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.828 Vali Acc: 0.848 Test Loss: 0.828 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.268897533416748
Epoch: 28, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.820 Vali Acc: 0.841 Test Loss: 0.820 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.4546575546264648
Epoch: 29, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.827 Vali Acc: 0.841 Test Loss: 0.827 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.4998643398284912
Epoch: 30, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.848 Vali Acc: 0.841 Test Loss: 0.848 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.421903133392334
Epoch: 31, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.847 Vali Acc: 0.841 Test Loss: 0.847 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.435046672821045
Epoch: 32, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.833 Vali Acc: 0.848 Test Loss: 0.833 Test Acc: 0.848
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.6601457595825195
Epoch: 33, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.821 Vali Acc: 0.862 Test Loss: 0.821 Test Acc: 0.862
Validation loss decreased (-0.855065 --> -0.862311).  Saving model ...
Epoch: 34 cost time: 1.608342170715332
Epoch: 34, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.829 Vali Acc: 0.862 Test Loss: 0.829 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.2594385147094727
Epoch: 35, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.893 Vali Acc: 0.848 Test Loss: 0.893 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.819148302078247
Epoch: 36, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.907 Vali Acc: 0.848 Test Loss: 0.907 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.4692537784576416
Epoch: 37, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.888 Vali Acc: 0.848 Test Loss: 0.888 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.506317377090454
Epoch: 38, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.861 Vali Acc: 0.848 Test Loss: 0.861 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.615967035293579
Epoch: 39, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.859 Vali Acc: 0.848 Test Loss: 0.859 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.413851022720337
Epoch: 40, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.873 Vali Acc: 0.848 Test Loss: 0.873 Test Acc: 0.848
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.1964349746704102
Epoch: 41, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.866 Vali Acc: 0.848 Test Loss: 0.866 Test Acc: 0.848
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.4590435028076172
Epoch: 42, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.852 Vali Acc: 0.848 Test Loss: 0.852 Test Acc: 0.848
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 1.2382421493530273
Epoch: 43, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.853 Vali Acc: 0.848 Test Loss: 0.853 Test Acc: 0.848
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el4_dm768_df768_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8623188405797102
model parameter : 29423620
model size : 126.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el4_dm768_df768_ps16_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.31124210357666
Epoch: 1, Steps: 9 | Train Loss: 1.485 Vali Loss: 1.436 Vali Acc: 0.312 Test Loss: 1.436 Test Acc: 0.312
Validation loss decreased (inf --> -0.311580).  Saving model ...
Epoch: 2 cost time: 1.0450832843780518
Epoch: 2, Steps: 9 | Train Loss: 1.381 Vali Loss: 1.331 Vali Acc: 0.326 Test Loss: 1.331 Test Acc: 0.326
Validation loss decreased (-0.311580 --> -0.326074).  Saving model ...
Epoch: 3 cost time: 1.0332512855529785
Epoch: 3, Steps: 9 | Train Loss: 1.245 Vali Loss: 1.197 Vali Acc: 0.500 Test Loss: 1.197 Test Acc: 0.500
Validation loss decreased (-0.326074 --> -0.499988).  Saving model ...
Epoch: 4 cost time: 0.978813648223877
Epoch: 4, Steps: 9 | Train Loss: 1.103 Vali Loss: 1.078 Vali Acc: 0.580 Test Loss: 1.078 Test Acc: 0.580
Validation loss decreased (-0.499988 --> -0.579699).  Saving model ...
Epoch: 5 cost time: 1.2509665489196777
Epoch: 5, Steps: 9 | Train Loss: 0.942 Vali Loss: 0.966 Vali Acc: 0.645 Test Loss: 0.966 Test Acc: 0.645
Validation loss decreased (-0.579699 --> -0.644918).  Saving model ...
Epoch: 6 cost time: 1.0497992038726807
Epoch: 6, Steps: 9 | Train Loss: 0.828 Vali Loss: 0.857 Vali Acc: 0.681 Test Loss: 0.857 Test Acc: 0.681
Validation loss decreased (-0.644918 --> -0.681151).  Saving model ...
Epoch: 7 cost time: 1.0591790676116943
Epoch: 7, Steps: 9 | Train Loss: 0.669 Vali Loss: 0.761 Vali Acc: 0.674 Test Loss: 0.761 Test Acc: 0.674
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9180641174316406
Epoch: 8, Steps: 9 | Train Loss: 0.573 Vali Loss: 0.729 Vali Acc: 0.674 Test Loss: 0.729 Test Acc: 0.674
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1521995067596436
Epoch: 9, Steps: 9 | Train Loss: 0.443 Vali Loss: 0.643 Vali Acc: 0.703 Test Loss: 0.643 Test Acc: 0.703
Validation loss decreased (-0.681151 --> -0.702892).  Saving model ...
Epoch: 10 cost time: 0.986126184463501
Epoch: 10, Steps: 9 | Train Loss: 0.349 Vali Loss: 0.664 Vali Acc: 0.732 Test Loss: 0.664 Test Acc: 0.732
Validation loss decreased (-0.702892 --> -0.731877).  Saving model ...
Epoch: 11 cost time: 1.2751681804656982
Epoch: 11, Steps: 9 | Train Loss: 0.234 Vali Loss: 0.545 Vali Acc: 0.783 Test Loss: 0.545 Test Acc: 0.783
Validation loss decreased (-0.731877 --> -0.782603).  Saving model ...
Epoch: 12 cost time: 1.0230844020843506
Epoch: 12, Steps: 9 | Train Loss: 0.175 Vali Loss: 0.648 Vali Acc: 0.783 Test Loss: 0.648 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0524876117706299
Epoch: 13, Steps: 9 | Train Loss: 0.134 Vali Loss: 0.590 Vali Acc: 0.797 Test Loss: 0.590 Test Acc: 0.797
Validation loss decreased (-0.782603 --> -0.797096).  Saving model ...
Epoch: 14 cost time: 1.060122013092041
Epoch: 14, Steps: 9 | Train Loss: 0.090 Vali Loss: 0.665 Vali Acc: 0.790 Test Loss: 0.665 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0141386985778809
Epoch: 15, Steps: 9 | Train Loss: 0.071 Vali Loss: 0.888 Vali Acc: 0.790 Test Loss: 0.888 Test Acc: 0.790
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.014425277709961
Epoch: 16, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.608 Vali Acc: 0.797 Test Loss: 0.608 Test Acc: 0.797
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.0549404621124268
Epoch: 17, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.899 Vali Acc: 0.826 Test Loss: 0.899 Test Acc: 0.826
Validation loss decreased (-0.797096 --> -0.826078).  Saving model ...
Epoch: 18 cost time: 1.280200719833374
Epoch: 18, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.801 Vali Acc: 0.833 Test Loss: 0.801 Test Acc: 0.833
Validation loss decreased (-0.826078 --> -0.833325).  Saving model ...
Epoch: 19 cost time: 1.0060875415802002
Epoch: 19, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.748 Vali Acc: 0.790 Test Loss: 0.748 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9729611873626709
Epoch: 20, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.963 Vali Acc: 0.804 Test Loss: 0.963 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.9633848667144775
Epoch: 21, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.852 Vali Acc: 0.819 Test Loss: 0.852 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.2139012813568115
Epoch: 22, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.828 Vali Acc: 0.812 Test Loss: 0.828 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.1081106662750244
Epoch: 23, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.811 Vali Acc: 0.826 Test Loss: 0.811 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.2441229820251465
Epoch: 24, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.847 Vali Acc: 0.833 Test Loss: 0.847 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.0582163333892822
Epoch: 25, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.856 Vali Acc: 0.833 Test Loss: 0.856 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.332960844039917
Epoch: 26, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.870 Vali Acc: 0.833 Test Loss: 0.870 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.1149954795837402
Epoch: 27, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.874 Vali Acc: 0.833 Test Loss: 0.874 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.189925193786621
Epoch: 28, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.856 Vali Acc: 0.833 Test Loss: 0.856 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el4_dm768_df768_ps16_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8333333333333334
model parameter : 29368324
model size : 126.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el4_dm768_df768_ps18_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.8513236045837402
Epoch: 1, Steps: 9 | Train Loss: 1.412 Vali Loss: 1.270 Vali Acc: 0.428 Test Loss: 1.270 Test Acc: 0.428
Validation loss decreased (inf --> -0.427524).  Saving model ...
Epoch: 2 cost time: 1.3464570045471191
Epoch: 2, Steps: 9 | Train Loss: 1.210 Vali Loss: 1.102 Vali Acc: 0.551 Test Loss: 1.102 Test Acc: 0.551
Validation loss decreased (-0.427524 --> -0.550714).  Saving model ...
Epoch: 3 cost time: 1.2904913425445557
Epoch: 3, Steps: 9 | Train Loss: 0.989 Vali Loss: 0.930 Vali Acc: 0.594 Test Loss: 0.930 Test Acc: 0.594
Validation loss decreased (-0.550714 --> -0.594194).  Saving model ...
Epoch: 4 cost time: 1.38869047164917
Epoch: 4, Steps: 9 | Train Loss: 0.778 Vali Loss: 0.952 Vali Acc: 0.659 Test Loss: 0.952 Test Acc: 0.659
Validation loss decreased (-0.594194 --> -0.659411).  Saving model ...
Epoch: 5 cost time: 1.4443542957305908
Epoch: 5, Steps: 9 | Train Loss: 0.685 Vali Loss: 0.740 Vali Acc: 0.710 Test Loss: 0.740 Test Acc: 0.710
Validation loss decreased (-0.659411 --> -0.710138).  Saving model ...
Epoch: 6 cost time: 1.3916609287261963
Epoch: 6, Steps: 9 | Train Loss: 0.542 Vali Loss: 0.876 Vali Acc: 0.645 Test Loss: 0.876 Test Acc: 0.645
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.717327356338501
Epoch: 7, Steps: 9 | Train Loss: 0.373 Vali Loss: 0.572 Vali Acc: 0.848 Test Loss: 0.572 Test Acc: 0.848
Validation loss decreased (-0.710138 --> -0.847820).  Saving model ...
Epoch: 8 cost time: 1.8211565017700195
Epoch: 8, Steps: 9 | Train Loss: 0.269 Vali Loss: 0.818 Vali Acc: 0.688 Test Loss: 0.818 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.275165319442749
Epoch: 9, Steps: 9 | Train Loss: 0.197 Vali Loss: 0.470 Vali Acc: 0.870 Test Loss: 0.470 Test Acc: 0.870
Validation loss decreased (-0.847820 --> -0.869561).  Saving model ...
Epoch: 10 cost time: 1.5446999073028564
Epoch: 10, Steps: 9 | Train Loss: 0.111 Vali Loss: 0.573 Vali Acc: 0.826 Test Loss: 0.573 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.734480381011963
Epoch: 11, Steps: 9 | Train Loss: 0.057 Vali Loss: 0.598 Vali Acc: 0.848 Test Loss: 0.598 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.4022221565246582
Epoch: 12, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.763 Vali Acc: 0.841 Test Loss: 0.763 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.4909584522247314
Epoch: 13, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.680 Vali Acc: 0.841 Test Loss: 0.680 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.4930803775787354
Epoch: 14, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.657 Vali Acc: 0.855 Test Loss: 0.657 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.3962202072143555
Epoch: 15, Steps: 9 | Train Loss: 0.015 Vali Loss: 1.264 Vali Acc: 0.841 Test Loss: 1.264 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.8555829524993896
Epoch: 16, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.975 Vali Acc: 0.848 Test Loss: 0.975 Test Acc: 0.848
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.4830842018127441
Epoch: 17, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.398 Vali Acc: 0.833 Test Loss: 1.398 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.6364755630493164
Epoch: 18, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.959 Vali Acc: 0.855 Test Loss: 0.959 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.171111822128296
Epoch: 19, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.866 Vali Acc: 0.848 Test Loss: 0.866 Test Acc: 0.848
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el4_dm768_df768_ps18_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8695652173913043
model parameter : 29501956
model size : 127.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el4_dm768_df768_ps18_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.5707197189331055
Epoch: 1, Steps: 9 | Train Loss: 1.411 Vali Loss: 1.300 Vali Acc: 0.362 Test Loss: 1.300 Test Acc: 0.362
Validation loss decreased (inf --> -0.362306).  Saving model ...
Epoch: 2 cost time: 1.3132514953613281
Epoch: 2, Steps: 9 | Train Loss: 1.261 Vali Loss: 1.146 Vali Acc: 0.464 Test Loss: 1.146 Test Acc: 0.464
Validation loss decreased (-0.362306 --> -0.463757).  Saving model ...
Epoch: 3 cost time: 1.405655860900879
Epoch: 3, Steps: 9 | Train Loss: 1.065 Vali Loss: 1.024 Vali Acc: 0.572 Test Loss: 1.024 Test Acc: 0.572
Validation loss decreased (-0.463757 --> -0.572454).  Saving model ...
Epoch: 4 cost time: 1.3240351676940918
Epoch: 4, Steps: 9 | Train Loss: 0.851 Vali Loss: 0.938 Vali Acc: 0.638 Test Loss: 0.938 Test Acc: 0.638
Validation loss decreased (-0.572454 --> -0.637672).  Saving model ...
Epoch: 5 cost time: 1.2924439907073975
Epoch: 5, Steps: 9 | Train Loss: 0.729 Vali Loss: 0.836 Vali Acc: 0.638 Test Loss: 0.836 Test Acc: 0.638
Validation loss decreased (-0.637672 --> -0.637673).  Saving model ...
Epoch: 6 cost time: 1.2250745296478271
Epoch: 6, Steps: 9 | Train Loss: 0.662 Vali Loss: 0.784 Vali Acc: 0.696 Test Loss: 0.784 Test Acc: 0.696
Validation loss decreased (-0.637673 --> -0.695644).  Saving model ...
Epoch: 7 cost time: 1.1311461925506592
Epoch: 7, Steps: 9 | Train Loss: 0.520 Vali Loss: 0.697 Vali Acc: 0.746 Test Loss: 0.697 Test Acc: 0.746
Validation loss decreased (-0.695644 --> -0.746370).  Saving model ...
Epoch: 8 cost time: 0.8437495231628418
Epoch: 8, Steps: 9 | Train Loss: 0.393 Vali Loss: 0.706 Vali Acc: 0.681 Test Loss: 0.706 Test Acc: 0.681
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1200976371765137
Epoch: 9, Steps: 9 | Train Loss: 0.301 Vali Loss: 0.588 Vali Acc: 0.819 Test Loss: 0.588 Test Acc: 0.819
Validation loss decreased (-0.746370 --> -0.818835).  Saving model ...
Epoch: 10 cost time: 1.047835350036621
Epoch: 10, Steps: 9 | Train Loss: 0.223 Vali Loss: 0.676 Vali Acc: 0.761 Test Loss: 0.676 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1438026428222656
Epoch: 11, Steps: 9 | Train Loss: 0.174 Vali Loss: 0.649 Vali Acc: 0.826 Test Loss: 0.649 Test Acc: 0.826
Validation loss decreased (-0.818835 --> -0.826080).  Saving model ...
Epoch: 12 cost time: 1.2604246139526367
Epoch: 12, Steps: 9 | Train Loss: 0.098 Vali Loss: 0.709 Vali Acc: 0.775 Test Loss: 0.709 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5690650939941406
Epoch: 13, Steps: 9 | Train Loss: 0.059 Vali Loss: 0.682 Vali Acc: 0.797 Test Loss: 0.682 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.3880789279937744
Epoch: 14, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.623 Vali Acc: 0.833 Test Loss: 0.623 Test Acc: 0.833
Validation loss decreased (-0.826080 --> -0.833327).  Saving model ...
Epoch: 15 cost time: 1.5039644241333008
Epoch: 15, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.858 Vali Acc: 0.812 Test Loss: 0.858 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.3737645149230957
Epoch: 16, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.731 Vali Acc: 0.841 Test Loss: 0.731 Test Acc: 0.841
Validation loss decreased (-0.833327 --> -0.840572).  Saving model ...
Epoch: 17 cost time: 1.3964755535125732
Epoch: 17, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.840 Vali Acc: 0.841 Test Loss: 0.840 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.035369634628296
Epoch: 18, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.801 Vali Acc: 0.841 Test Loss: 0.801 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.678816556930542
Epoch: 19, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.892 Vali Acc: 0.833 Test Loss: 0.892 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.0677504539489746
Epoch: 20, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.844 Vali Acc: 0.841 Test Loss: 0.844 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.5647313594818115
Epoch: 21, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.808 Vali Acc: 0.833 Test Loss: 0.808 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.5630886554718018
Epoch: 22, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.841 Vali Acc: 0.812 Test Loss: 0.841 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.2418553829193115
Epoch: 23, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.974 Vali Acc: 0.826 Test Loss: 0.974 Test Acc: 0.826
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.8133785724639893
Epoch: 24, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.850 Vali Acc: 0.833 Test Loss: 0.850 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.3512883186340332
Epoch: 25, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.823 Vali Acc: 0.848 Test Loss: 0.823 Test Acc: 0.848
Validation loss decreased (-0.840572 --> -0.847818).  Saving model ...
Epoch: 26 cost time: 1.827333688735962
Epoch: 26, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.938 Vali Acc: 0.833 Test Loss: 0.938 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.5258781909942627
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.947 Vali Acc: 0.826 Test Loss: 0.947 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.4125096797943115
Epoch: 28, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.905 Vali Acc: 0.833 Test Loss: 0.905 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.858612298965454
Epoch: 29, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.849 Vali Acc: 0.833 Test Loss: 0.849 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.9588191509246826
Epoch: 30, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.848 Vali Acc: 0.833 Test Loss: 0.848 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.2113456726074219
Epoch: 31, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.860 Vali Acc: 0.833 Test Loss: 0.860 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.377070665359497
Epoch: 32, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.865 Vali Acc: 0.833 Test Loss: 0.865 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.3546321392059326
Epoch: 33, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.883 Vali Acc: 0.833 Test Loss: 0.883 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.3492472171783447
Epoch: 34, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.922 Vali Acc: 0.833 Test Loss: 0.922 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.4671013355255127
Epoch: 35, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.925 Vali Acc: 0.833 Test Loss: 0.925 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el4_dm768_df768_ps18_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8478260869565217
model parameter : 29423620
model size : 126.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el4_dm768_df768_ps18_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.095839500427246
Epoch: 1, Steps: 9 | Train Loss: 1.503 Vali Loss: 1.379 Vali Acc: 0.283 Test Loss: 1.379 Test Acc: 0.283
Validation loss decreased (inf --> -0.282595).  Saving model ...
Epoch: 2 cost time: 0.8826255798339844
Epoch: 2, Steps: 9 | Train Loss: 1.356 Vali Loss: 1.277 Vali Acc: 0.362 Test Loss: 1.277 Test Acc: 0.362
Validation loss decreased (-0.282595 --> -0.362306).  Saving model ...
Epoch: 3 cost time: 1.1265263557434082
Epoch: 3, Steps: 9 | Train Loss: 1.237 Vali Loss: 1.175 Vali Acc: 0.420 Test Loss: 1.175 Test Acc: 0.420
Validation loss decreased (-0.362306 --> -0.420278).  Saving model ...
Epoch: 4 cost time: 0.9701943397521973
Epoch: 4, Steps: 9 | Train Loss: 1.103 Vali Loss: 1.064 Vali Acc: 0.507 Test Loss: 1.064 Test Acc: 0.507
Validation loss decreased (-0.420278 --> -0.507236).  Saving model ...
Epoch: 5 cost time: 1.0177803039550781
Epoch: 5, Steps: 9 | Train Loss: 0.959 Vali Loss: 0.970 Vali Acc: 0.652 Test Loss: 0.970 Test Acc: 0.652
Validation loss decreased (-0.507236 --> -0.652164).  Saving model ...
Epoch: 6 cost time: 1.1647419929504395
Epoch: 6, Steps: 9 | Train Loss: 0.822 Vali Loss: 0.909 Vali Acc: 0.652 Test Loss: 0.909 Test Acc: 0.652
Validation loss decreased (-0.652164 --> -0.652165).  Saving model ...
Epoch: 7 cost time: 1.2359721660614014
Epoch: 7, Steps: 9 | Train Loss: 0.698 Vali Loss: 0.836 Vali Acc: 0.688 Test Loss: 0.836 Test Acc: 0.688
Validation loss decreased (-0.652165 --> -0.688397).  Saving model ...
Epoch: 8 cost time: 1.1626341342926025
Epoch: 8, Steps: 9 | Train Loss: 0.581 Vali Loss: 0.817 Vali Acc: 0.717 Test Loss: 0.817 Test Acc: 0.717
Validation loss decreased (-0.688397 --> -0.717383).  Saving model ...
Epoch: 9 cost time: 1.105189323425293
Epoch: 9, Steps: 9 | Train Loss: 0.476 Vali Loss: 0.707 Vali Acc: 0.768 Test Loss: 0.707 Test Acc: 0.768
Validation loss decreased (-0.717383 --> -0.768109).  Saving model ...
Epoch: 10 cost time: 0.9715931415557861
Epoch: 10, Steps: 9 | Train Loss: 0.405 Vali Loss: 0.765 Vali Acc: 0.761 Test Loss: 0.765 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9300248622894287
Epoch: 11, Steps: 9 | Train Loss: 0.283 Vali Loss: 0.644 Vali Acc: 0.754 Test Loss: 0.644 Test Acc: 0.754
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9793546199798584
Epoch: 12, Steps: 9 | Train Loss: 0.221 Vali Loss: 0.709 Vali Acc: 0.775 Test Loss: 0.709 Test Acc: 0.775
Validation loss decreased (-0.768109 --> -0.775355).  Saving model ...
Epoch: 13 cost time: 0.9844620227813721
Epoch: 13, Steps: 9 | Train Loss: 0.134 Vali Loss: 0.688 Vali Acc: 0.775 Test Loss: 0.688 Test Acc: 0.775
Validation loss decreased (-0.775355 --> -0.775355).  Saving model ...
Epoch: 14 cost time: 0.9732739925384521
Epoch: 14, Steps: 9 | Train Loss: 0.086 Vali Loss: 0.774 Vali Acc: 0.790 Test Loss: 0.774 Test Acc: 0.790
Validation loss decreased (-0.775355 --> -0.789847).  Saving model ...
Epoch: 15 cost time: 1.031611680984497
Epoch: 15, Steps: 9 | Train Loss: 0.060 Vali Loss: 0.652 Vali Acc: 0.783 Test Loss: 0.652 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.993154764175415
Epoch: 16, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.777 Vali Acc: 0.775 Test Loss: 0.777 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.1218960285186768
Epoch: 17, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.753 Vali Acc: 0.797 Test Loss: 0.753 Test Acc: 0.797
Validation loss decreased (-0.789847 --> -0.797094).  Saving model ...
Epoch: 18 cost time: 0.9153661727905273
Epoch: 18, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.850 Vali Acc: 0.768 Test Loss: 0.850 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0122275352478027
Epoch: 19, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.801 Vali Acc: 0.804 Test Loss: 0.801 Test Acc: 0.804
Validation loss decreased (-0.797094 --> -0.804340).  Saving model ...
Epoch: 20 cost time: 1.1307921409606934
Epoch: 20, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.876 Vali Acc: 0.812 Test Loss: 0.876 Test Acc: 0.812
Validation loss decreased (-0.804340 --> -0.811585).  Saving model ...
Epoch: 21 cost time: 1.0906460285186768
Epoch: 21, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.797 Vali Acc: 0.783 Test Loss: 0.797 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.196106195449829
Epoch: 22, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.776 Vali Acc: 0.797 Test Loss: 0.776 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.9490458965301514
Epoch: 23, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.902 Vali Acc: 0.819 Test Loss: 0.902 Test Acc: 0.819
Validation loss decreased (-0.811585 --> -0.818832).  Saving model ...
Epoch: 24 cost time: 0.8422718048095703
Epoch: 24, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.952 Vali Acc: 0.812 Test Loss: 0.952 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0823917388916016
Epoch: 25, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.894 Vali Acc: 0.812 Test Loss: 0.894 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.9623017311096191
Epoch: 26, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.861 Vali Acc: 0.812 Test Loss: 0.861 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.0320146083831787
Epoch: 27, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.938 Vali Acc: 0.819 Test Loss: 0.938 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.9670872688293457
Epoch: 28, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.959 Vali Acc: 0.819 Test Loss: 0.959 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.1948294639587402
Epoch: 29, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.867 Vali Acc: 0.812 Test Loss: 0.867 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.1395986080169678
Epoch: 30, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.858 Vali Acc: 0.812 Test Loss: 0.858 Test Acc: 0.812
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.04052734375
Epoch: 31, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.931 Vali Acc: 0.804 Test Loss: 0.931 Test Acc: 0.804
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.0537021160125732
Epoch: 32, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.972 Vali Acc: 0.812 Test Loss: 0.972 Test Acc: 0.812
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.9930098056793213
Epoch: 33, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.957 Vali Acc: 0.812 Test Loss: 0.957 Test Acc: 0.812
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el4_dm768_df768_ps18_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8188405797101449
model parameter : 29377540
model size : 126.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el4_dm768_df768_ps19_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.3757665157318115
Epoch: 1, Steps: 9 | Train Loss: 1.429 Vali Loss: 1.380 Vali Acc: 0.275 Test Loss: 1.380 Test Acc: 0.275
Validation loss decreased (inf --> -0.275349).  Saving model ...
Epoch: 2 cost time: 1.994157314300537
Epoch: 2, Steps: 9 | Train Loss: 1.272 Vali Loss: 1.161 Vali Acc: 0.493 Test Loss: 1.161 Test Acc: 0.493
Validation loss decreased (-0.275349 --> -0.492742).  Saving model ...
Epoch: 3 cost time: 1.5619754791259766
Epoch: 3, Steps: 9 | Train Loss: 1.028 Vali Loss: 1.017 Vali Acc: 0.514 Test Loss: 1.017 Test Acc: 0.514
Validation loss decreased (-0.492742 --> -0.514483).  Saving model ...
Epoch: 4 cost time: 1.1064097881317139
Epoch: 4, Steps: 9 | Train Loss: 0.790 Vali Loss: 0.848 Vali Acc: 0.674 Test Loss: 0.848 Test Acc: 0.674
Validation loss decreased (-0.514483 --> -0.673905).  Saving model ...
Epoch: 5 cost time: 1.2811317443847656
Epoch: 5, Steps: 9 | Train Loss: 0.624 Vali Loss: 0.771 Vali Acc: 0.710 Test Loss: 0.771 Test Acc: 0.710
Validation loss decreased (-0.673905 --> -0.710137).  Saving model ...
Epoch: 6 cost time: 1.3158154487609863
Epoch: 6, Steps: 9 | Train Loss: 0.512 Vali Loss: 0.628 Vali Acc: 0.754 Test Loss: 0.628 Test Acc: 0.754
Validation loss decreased (-0.710137 --> -0.753617).  Saving model ...
Epoch: 7 cost time: 1.4208831787109375
Epoch: 7, Steps: 9 | Train Loss: 0.304 Vali Loss: 0.795 Vali Acc: 0.739 Test Loss: 0.795 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.9111461639404297
Epoch: 8, Steps: 9 | Train Loss: 0.226 Vali Loss: 0.593 Vali Acc: 0.768 Test Loss: 0.593 Test Acc: 0.768
Validation loss decreased (-0.753617 --> -0.768110).  Saving model ...
Epoch: 9 cost time: 1.9508371353149414
Epoch: 9, Steps: 9 | Train Loss: 0.095 Vali Loss: 0.721 Vali Acc: 0.768 Test Loss: 0.721 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6004652976989746
Epoch: 10, Steps: 9 | Train Loss: 0.081 Vali Loss: 0.822 Vali Acc: 0.783 Test Loss: 0.822 Test Acc: 0.783
Validation loss decreased (-0.768110 --> -0.782600).  Saving model ...
Epoch: 11 cost time: 1.476858139038086
Epoch: 11, Steps: 9 | Train Loss: 0.088 Vali Loss: 0.837 Vali Acc: 0.797 Test Loss: 0.837 Test Acc: 0.797
Validation loss decreased (-0.782600 --> -0.797093).  Saving model ...
Epoch: 12 cost time: 1.5970220565795898
Epoch: 12, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.683 Vali Acc: 0.775 Test Loss: 0.683 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4598159790039062
Epoch: 13, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.935 Vali Acc: 0.804 Test Loss: 0.935 Test Acc: 0.804
Validation loss decreased (-0.797093 --> -0.804338).  Saving model ...
Epoch: 14 cost time: 1.507524013519287
Epoch: 14, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.752 Vali Acc: 0.826 Test Loss: 0.752 Test Acc: 0.826
Validation loss decreased (-0.804338 --> -0.826079).  Saving model ...
Epoch: 15 cost time: 1.3596673011779785
Epoch: 15, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.866 Vali Acc: 0.833 Test Loss: 0.866 Test Acc: 0.833
Validation loss decreased (-0.826079 --> -0.833325).  Saving model ...
Epoch: 16 cost time: 1.3655118942260742
Epoch: 16, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.894 Vali Acc: 0.812 Test Loss: 0.894 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.5552232265472412
Epoch: 17, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.818 Vali Acc: 0.841 Test Loss: 0.818 Test Acc: 0.841
Validation loss decreased (-0.833325 --> -0.840572).  Saving model ...
Epoch: 18 cost time: 1.702880620956421
Epoch: 18, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.830 Vali Acc: 0.826 Test Loss: 0.830 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.5424649715423584
Epoch: 19, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.818 Vali Acc: 0.841 Test Loss: 0.818 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.4927277565002441
Epoch: 20, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.851 Vali Acc: 0.833 Test Loss: 0.851 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.267918586730957
Epoch: 21, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.866 Vali Acc: 0.826 Test Loss: 0.866 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.4903626441955566
Epoch: 22, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.848 Vali Acc: 0.848 Test Loss: 0.848 Test Acc: 0.848
Validation loss decreased (-0.840572 --> -0.847818).  Saving model ...
Epoch: 23 cost time: 1.395157814025879
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.836 Vali Acc: 0.841 Test Loss: 0.836 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.7814593315124512
Epoch: 24, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.832 Vali Acc: 0.848 Test Loss: 0.832 Test Acc: 0.848
Validation loss decreased (-0.847818 --> -0.847818).  Saving model ...
Epoch: 25 cost time: 1.4361402988433838
Epoch: 25, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.823 Vali Acc: 0.848 Test Loss: 0.823 Test Acc: 0.848
Validation loss decreased (-0.847818 --> -0.847818).  Saving model ...
Epoch: 26 cost time: 1.3963325023651123
Epoch: 26, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.834 Vali Acc: 0.848 Test Loss: 0.834 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.5006461143493652
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.841 Vali Acc: 0.848 Test Loss: 0.841 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.7216029167175293
Epoch: 28, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.875 Vali Acc: 0.833 Test Loss: 0.875 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.3247966766357422
Epoch: 29, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.884 Vali Acc: 0.833 Test Loss: 0.884 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.4468817710876465
Epoch: 30, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.881 Vali Acc: 0.833 Test Loss: 0.881 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.1223983764648438
Epoch: 31, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.895 Vali Acc: 0.826 Test Loss: 0.895 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.2008554935455322
Epoch: 32, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.876 Vali Acc: 0.833 Test Loss: 0.876 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.4232068061828613
Epoch: 33, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.878 Vali Acc: 0.833 Test Loss: 0.878 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.2484190464019775
Epoch: 34, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.905 Vali Acc: 0.826 Test Loss: 0.905 Test Acc: 0.826
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.3363406658172607
Epoch: 35, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.883 Vali Acc: 0.833 Test Loss: 0.883 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el4_dm768_df768_ps19_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8478260869565217
model parameter : 29508868
model size : 127.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el4_dm768_df768_ps19_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.81320858001709
Epoch: 1, Steps: 9 | Train Loss: 1.456 Vali Loss: 1.366 Vali Acc: 0.370 Test Loss: 1.366 Test Acc: 0.370
Validation loss decreased (inf --> -0.369552).  Saving model ...
Epoch: 2 cost time: 0.9451899528503418
Epoch: 2, Steps: 9 | Train Loss: 1.306 Vali Loss: 1.232 Vali Acc: 0.522 Test Loss: 1.232 Test Acc: 0.522
Validation loss decreased (-0.369552 --> -0.521727).  Saving model ...
Epoch: 3 cost time: 1.3897223472595215
Epoch: 3, Steps: 9 | Train Loss: 1.169 Vali Loss: 1.098 Vali Acc: 0.580 Test Loss: 1.098 Test Acc: 0.580
Validation loss decreased (-0.521727 --> -0.579699).  Saving model ...
Epoch: 4 cost time: 1.5749552249908447
Epoch: 4, Steps: 9 | Train Loss: 0.996 Vali Loss: 0.947 Vali Acc: 0.659 Test Loss: 0.947 Test Acc: 0.659
Validation loss decreased (-0.579699 --> -0.659411).  Saving model ...
Epoch: 5 cost time: 1.2746915817260742
Epoch: 5, Steps: 9 | Train Loss: 0.848 Vali Loss: 0.856 Vali Acc: 0.645 Test Loss: 0.856 Test Acc: 0.645
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8980264663696289
Epoch: 6, Steps: 9 | Train Loss: 0.694 Vali Loss: 0.755 Vali Acc: 0.696 Test Loss: 0.755 Test Acc: 0.696
Validation loss decreased (-0.659411 --> -0.695645).  Saving model ...
Epoch: 7 cost time: 1.0709798336029053
Epoch: 7, Steps: 9 | Train Loss: 0.550 Vali Loss: 0.734 Vali Acc: 0.696 Test Loss: 0.734 Test Acc: 0.696
Validation loss decreased (-0.695645 --> -0.695645).  Saving model ...
Epoch: 8 cost time: 1.1550250053405762
Epoch: 8, Steps: 9 | Train Loss: 0.399 Vali Loss: 0.704 Vali Acc: 0.732 Test Loss: 0.704 Test Acc: 0.732
Validation loss decreased (-0.695645 --> -0.731877).  Saving model ...
Epoch: 9 cost time: 1.4657902717590332
Epoch: 9, Steps: 9 | Train Loss: 0.303 Vali Loss: 0.683 Vali Acc: 0.739 Test Loss: 0.683 Test Acc: 0.739
Validation loss decreased (-0.731877 --> -0.739124).  Saving model ...
Epoch: 10 cost time: 1.2874531745910645
Epoch: 10, Steps: 9 | Train Loss: 0.210 Vali Loss: 0.656 Vali Acc: 0.797 Test Loss: 0.656 Test Acc: 0.797
Validation loss decreased (-0.739124 --> -0.797095).  Saving model ...
Epoch: 11 cost time: 1.712174415588379
Epoch: 11, Steps: 9 | Train Loss: 0.117 Vali Loss: 0.669 Vali Acc: 0.841 Test Loss: 0.669 Test Acc: 0.841
Validation loss decreased (-0.797095 --> -0.840573).  Saving model ...
Epoch: 12 cost time: 1.4518630504608154
Epoch: 12, Steps: 9 | Train Loss: 0.103 Vali Loss: 0.565 Vali Acc: 0.855 Test Loss: 0.565 Test Acc: 0.855
Validation loss decreased (-0.840573 --> -0.855067).  Saving model ...
Epoch: 13 cost time: 1.899686574935913
Epoch: 13, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.713 Vali Acc: 0.841 Test Loss: 0.713 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1513853073120117
Epoch: 14, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.595 Vali Acc: 0.841 Test Loss: 0.595 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.339996337890625
Epoch: 15, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.876 Vali Acc: 0.833 Test Loss: 0.876 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.209397792816162
Epoch: 16, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.747 Vali Acc: 0.841 Test Loss: 0.747 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.2947287559509277
Epoch: 17, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.792 Vali Acc: 0.833 Test Loss: 0.792 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.4366998672485352
Epoch: 18, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.844 Vali Acc: 0.833 Test Loss: 0.844 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.3355960845947266
Epoch: 19, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.788 Vali Acc: 0.833 Test Loss: 0.788 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.024204969406128
Epoch: 20, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.774 Vali Acc: 0.841 Test Loss: 0.774 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.609670639038086
Epoch: 21, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.747 Vali Acc: 0.833 Test Loss: 0.747 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.7093744277954102
Epoch: 22, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.750 Vali Acc: 0.812 Test Loss: 0.750 Test Acc: 0.812
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el4_dm768_df768_ps19_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.855072463768116
model parameter : 29421316
model size : 126.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el4_dm768_df768_ps19_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.9319331645965576
Epoch: 1, Steps: 9 | Train Loss: 1.476 Vali Loss: 1.377 Vali Acc: 0.261 Test Loss: 1.377 Test Acc: 0.261
Validation loss decreased (inf --> -0.260856).  Saving model ...
Epoch: 2 cost time: 0.9988954067230225
Epoch: 2, Steps: 9 | Train Loss: 1.345 Vali Loss: 1.295 Vali Acc: 0.420 Test Loss: 1.295 Test Acc: 0.420
Validation loss decreased (-0.260856 --> -0.420277).  Saving model ...
Epoch: 3 cost time: 0.9417626857757568
Epoch: 3, Steps: 9 | Train Loss: 1.202 Vali Loss: 1.202 Vali Acc: 0.464 Test Loss: 1.202 Test Acc: 0.464
Validation loss decreased (-0.420277 --> -0.463756).  Saving model ...
Epoch: 4 cost time: 0.8599112033843994
Epoch: 4, Steps: 9 | Train Loss: 1.113 Vali Loss: 1.097 Vali Acc: 0.601 Test Loss: 1.097 Test Acc: 0.601
Validation loss decreased (-0.463756 --> -0.601438).  Saving model ...
Epoch: 5 cost time: 1.0209898948669434
Epoch: 5, Steps: 9 | Train Loss: 0.964 Vali Loss: 1.007 Vali Acc: 0.630 Test Loss: 1.007 Test Acc: 0.630
Validation loss decreased (-0.601438 --> -0.630425).  Saving model ...
Epoch: 6 cost time: 1.159085988998413
Epoch: 6, Steps: 9 | Train Loss: 0.856 Vali Loss: 0.909 Vali Acc: 0.609 Test Loss: 0.909 Test Acc: 0.609
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9654839038848877
Epoch: 7, Steps: 9 | Train Loss: 0.731 Vali Loss: 0.833 Vali Acc: 0.688 Test Loss: 0.833 Test Acc: 0.688
Validation loss decreased (-0.630425 --> -0.688397).  Saving model ...
Epoch: 8 cost time: 0.8757369518280029
Epoch: 8, Steps: 9 | Train Loss: 0.579 Vali Loss: 0.753 Vali Acc: 0.674 Test Loss: 0.753 Test Acc: 0.674
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0819029808044434
Epoch: 9, Steps: 9 | Train Loss: 0.497 Vali Loss: 0.696 Vali Acc: 0.739 Test Loss: 0.696 Test Acc: 0.739
Validation loss decreased (-0.688397 --> -0.739123).  Saving model ...
Epoch: 10 cost time: 1.1235606670379639
Epoch: 10, Steps: 9 | Train Loss: 0.368 Vali Loss: 0.729 Vali Acc: 0.732 Test Loss: 0.729 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0815808773040771
Epoch: 11, Steps: 9 | Train Loss: 0.262 Vali Loss: 0.590 Vali Acc: 0.775 Test Loss: 0.590 Test Acc: 0.775
Validation loss decreased (-0.739123 --> -0.775356).  Saving model ...
Epoch: 12 cost time: 0.8157355785369873
Epoch: 12, Steps: 9 | Train Loss: 0.218 Vali Loss: 0.663 Vali Acc: 0.754 Test Loss: 0.663 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8642501831054688
Epoch: 13, Steps: 9 | Train Loss: 0.139 Vali Loss: 0.573 Vali Acc: 0.826 Test Loss: 0.573 Test Acc: 0.826
Validation loss decreased (-0.775356 --> -0.826081).  Saving model ...
Epoch: 14 cost time: 1.072730302810669
Epoch: 14, Steps: 9 | Train Loss: 0.102 Vali Loss: 0.670 Vali Acc: 0.775 Test Loss: 0.670 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9859030246734619
Epoch: 15, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.679 Vali Acc: 0.775 Test Loss: 0.679 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.078312635421753
Epoch: 16, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.666 Vali Acc: 0.812 Test Loss: 0.666 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.8235287666320801
Epoch: 17, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.660 Vali Acc: 0.797 Test Loss: 0.660 Test Acc: 0.797
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.8405523300170898
Epoch: 18, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.662 Vali Acc: 0.812 Test Loss: 0.662 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.0230553150177002
Epoch: 19, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.763 Vali Acc: 0.819 Test Loss: 0.763 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.0161478519439697
Epoch: 20, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.784 Vali Acc: 0.819 Test Loss: 0.784 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.9654629230499268
Epoch: 21, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.668 Vali Acc: 0.826 Test Loss: 0.668 Test Acc: 0.826
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.13785719871521
Epoch: 22, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.716 Vali Acc: 0.819 Test Loss: 0.716 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.0804657936096191
Epoch: 23, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.743 Vali Acc: 0.826 Test Loss: 0.743 Test Acc: 0.826
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el4_dm768_df768_ps19_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8260869565217391
model parameter : 29379844
model size : 126.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el4_dm768_df768_ps21_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.8203866481781006
Epoch: 1, Steps: 9 | Train Loss: 1.508 Vali Loss: 1.329 Vali Acc: 0.362 Test Loss: 1.329 Test Acc: 0.362
Validation loss decreased (inf --> -0.362306).  Saving model ...
Epoch: 2 cost time: 1.3221421241760254
Epoch: 2, Steps: 9 | Train Loss: 1.256 Vali Loss: 1.150 Vali Acc: 0.464 Test Loss: 1.150 Test Acc: 0.464
Validation loss decreased (-0.362306 --> -0.463757).  Saving model ...
Epoch: 3 cost time: 1.6219894886016846
Epoch: 3, Steps: 9 | Train Loss: 1.045 Vali Loss: 0.964 Vali Acc: 0.630 Test Loss: 0.964 Test Acc: 0.630
Validation loss decreased (-0.463757 --> -0.630425).  Saving model ...
Epoch: 4 cost time: 1.174081802368164
Epoch: 4, Steps: 9 | Train Loss: 0.825 Vali Loss: 0.812 Vali Acc: 0.652 Test Loss: 0.812 Test Acc: 0.652
Validation loss decreased (-0.630425 --> -0.652166).  Saving model ...
Epoch: 5 cost time: 1.2106399536132812
Epoch: 5, Steps: 9 | Train Loss: 0.677 Vali Loss: 0.744 Vali Acc: 0.667 Test Loss: 0.744 Test Acc: 0.667
Validation loss decreased (-0.652166 --> -0.666659).  Saving model ...
Epoch: 6 cost time: 1.1578810214996338
Epoch: 6, Steps: 9 | Train Loss: 0.467 Vali Loss: 0.600 Vali Acc: 0.732 Test Loss: 0.600 Test Acc: 0.732
Validation loss decreased (-0.666659 --> -0.731878).  Saving model ...
Epoch: 7 cost time: 1.4275832176208496
Epoch: 7, Steps: 9 | Train Loss: 0.297 Vali Loss: 0.726 Vali Acc: 0.667 Test Loss: 0.726 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3553495407104492
Epoch: 8, Steps: 9 | Train Loss: 0.236 Vali Loss: 0.575 Vali Acc: 0.775 Test Loss: 0.575 Test Acc: 0.775
Validation loss decreased (-0.731878 --> -0.775357).  Saving model ...
Epoch: 9 cost time: 1.4723076820373535
Epoch: 9, Steps: 9 | Train Loss: 0.156 Vali Loss: 0.704 Vali Acc: 0.812 Test Loss: 0.704 Test Acc: 0.812
Validation loss decreased (-0.775357 --> -0.811587).  Saving model ...
Epoch: 10 cost time: 1.6589229106903076
Epoch: 10, Steps: 9 | Train Loss: 0.078 Vali Loss: 0.648 Vali Acc: 0.804 Test Loss: 0.648 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5584137439727783
Epoch: 11, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.736 Vali Acc: 0.819 Test Loss: 0.736 Test Acc: 0.819
Validation loss decreased (-0.811587 --> -0.818833).  Saving model ...
Epoch: 12 cost time: 1.5267016887664795
Epoch: 12, Steps: 9 | Train Loss: 0.043 Vali Loss: 1.098 Vali Acc: 0.739 Test Loss: 1.098 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.479156732559204
Epoch: 13, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.837 Vali Acc: 0.841 Test Loss: 0.837 Test Acc: 0.841
Validation loss decreased (-0.818833 --> -0.840571).  Saving model ...
Epoch: 14 cost time: 1.5174310207366943
Epoch: 14, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.739 Vali Acc: 0.855 Test Loss: 0.739 Test Acc: 0.855
Validation loss decreased (-0.840571 --> -0.855065).  Saving model ...
Epoch: 15 cost time: 1.3511707782745361
Epoch: 15, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.739 Vali Acc: 0.848 Test Loss: 0.739 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.195868968963623
Epoch: 16, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.754 Vali Acc: 0.826 Test Loss: 0.754 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.3532257080078125
Epoch: 17, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.800 Vali Acc: 0.833 Test Loss: 0.800 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.3562872409820557
Epoch: 18, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.807 Vali Acc: 0.841 Test Loss: 0.807 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.2584736347198486
Epoch: 19, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.760 Vali Acc: 0.841 Test Loss: 0.760 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.2411737442016602
Epoch: 20, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.708 Vali Acc: 0.870 Test Loss: 0.708 Test Acc: 0.870
Validation loss decreased (-0.855065 --> -0.869558).  Saving model ...
Epoch: 21 cost time: 1.4228522777557373
Epoch: 21, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.832 Vali Acc: 0.841 Test Loss: 0.832 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.8678429126739502
Epoch: 22, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.942 Vali Acc: 0.841 Test Loss: 0.942 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.6251945495605469
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.890 Vali Acc: 0.848 Test Loss: 0.890 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.410703420639038
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.826 Vali Acc: 0.848 Test Loss: 0.826 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.7575600147247314
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.819 Vali Acc: 0.848 Test Loss: 0.819 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.3541581630706787
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.826 Vali Acc: 0.848 Test Loss: 0.826 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.2911248207092285
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.821 Vali Acc: 0.848 Test Loss: 0.821 Test Acc: 0.848
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.9851443767547607
Epoch: 28, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.849 Vali Acc: 0.848 Test Loss: 0.849 Test Acc: 0.848
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.0696213245391846
Epoch: 29, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.831 Vali Acc: 0.848 Test Loss: 0.831 Test Acc: 0.848
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.3842127323150635
Epoch: 30, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.845 Vali Acc: 0.848 Test Loss: 0.845 Test Acc: 0.848
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el4_dm768_df768_ps21_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8695652173913043
model parameter : 29490436
model size : 127.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el4_dm768_df768_ps21_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.987287998199463
Epoch: 1, Steps: 9 | Train Loss: 1.455 Vali Loss: 1.331 Vali Acc: 0.391 Test Loss: 1.331 Test Acc: 0.391
Validation loss decreased (inf --> -0.391291).  Saving model ...
Epoch: 2 cost time: 1.1670560836791992
Epoch: 2, Steps: 9 | Train Loss: 1.345 Vali Loss: 1.237 Vali Acc: 0.514 Test Loss: 1.237 Test Acc: 0.514
Validation loss decreased (-0.391291 --> -0.514480).  Saving model ...
Epoch: 3 cost time: 1.2885713577270508
Epoch: 3, Steps: 9 | Train Loss: 1.185 Vali Loss: 1.088 Vali Acc: 0.609 Test Loss: 1.088 Test Acc: 0.609
Validation loss decreased (-0.514480 --> -0.608685).  Saving model ...
Epoch: 4 cost time: 1.4083378314971924
Epoch: 4, Steps: 9 | Train Loss: 0.998 Vali Loss: 0.958 Vali Acc: 0.630 Test Loss: 0.958 Test Acc: 0.630
Validation loss decreased (-0.608685 --> -0.630425).  Saving model ...
Epoch: 5 cost time: 1.4522340297698975
Epoch: 5, Steps: 9 | Train Loss: 0.826 Vali Loss: 0.832 Vali Acc: 0.645 Test Loss: 0.832 Test Acc: 0.645
Validation loss decreased (-0.630425 --> -0.644919).  Saving model ...
Epoch: 6 cost time: 1.6498804092407227
Epoch: 6, Steps: 9 | Train Loss: 0.623 Vali Loss: 0.728 Vali Acc: 0.667 Test Loss: 0.728 Test Acc: 0.667
Validation loss decreased (-0.644919 --> -0.666659).  Saving model ...
Epoch: 7 cost time: 1.484011173248291
Epoch: 7, Steps: 9 | Train Loss: 0.524 Vali Loss: 0.675 Vali Acc: 0.688 Test Loss: 0.675 Test Acc: 0.688
Validation loss decreased (-0.666659 --> -0.688399).  Saving model ...
Epoch: 8 cost time: 1.6132140159606934
Epoch: 8, Steps: 9 | Train Loss: 0.380 Vali Loss: 0.569 Vali Acc: 0.761 Test Loss: 0.569 Test Acc: 0.761
Validation loss decreased (-0.688399 --> -0.760864).  Saving model ...
Epoch: 9 cost time: 1.4661920070648193
Epoch: 9, Steps: 9 | Train Loss: 0.246 Vali Loss: 0.674 Vali Acc: 0.739 Test Loss: 0.674 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9305891990661621
Epoch: 10, Steps: 9 | Train Loss: 0.191 Vali Loss: 0.686 Vali Acc: 0.761 Test Loss: 0.686 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9656193256378174
Epoch: 11, Steps: 9 | Train Loss: 0.155 Vali Loss: 0.638 Vali Acc: 0.754 Test Loss: 0.638 Test Acc: 0.754
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.0386652946472168
Epoch: 12, Steps: 9 | Train Loss: 0.092 Vali Loss: 0.874 Vali Acc: 0.768 Test Loss: 0.874 Test Acc: 0.768
Validation loss decreased (-0.760864 --> -0.768107).  Saving model ...
Epoch: 13 cost time: 1.1099534034729004
Epoch: 13, Steps: 9 | Train Loss: 0.078 Vali Loss: 0.632 Vali Acc: 0.819 Test Loss: 0.632 Test Acc: 0.819
Validation loss decreased (-0.768107 --> -0.818834).  Saving model ...
Epoch: 14 cost time: 1.3054354190826416
Epoch: 14, Steps: 9 | Train Loss: 0.046 Vali Loss: 1.058 Vali Acc: 0.783 Test Loss: 1.058 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.296346664428711
Epoch: 15, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.583 Vali Acc: 0.848 Test Loss: 0.583 Test Acc: 0.848
Validation loss decreased (-0.818834 --> -0.847820).  Saving model ...
Epoch: 16 cost time: 1.234997272491455
Epoch: 16, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.884 Vali Acc: 0.783 Test Loss: 0.884 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2184429168701172
Epoch: 17, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.830 Vali Acc: 0.804 Test Loss: 0.830 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.0913066864013672
Epoch: 18, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.808 Vali Acc: 0.826 Test Loss: 0.808 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.080805778503418
Epoch: 19, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.751 Vali Acc: 0.848 Test Loss: 0.751 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.0576555728912354
Epoch: 20, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.783 Vali Acc: 0.833 Test Loss: 0.783 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.9684805870056152
Epoch: 21, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.829 Vali Acc: 0.833 Test Loss: 0.829 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.0782909393310547
Epoch: 22, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.806 Vali Acc: 0.841 Test Loss: 0.806 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.1081159114837646
Epoch: 23, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.847 Vali Acc: 0.819 Test Loss: 0.847 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.2207467555999756
Epoch: 24, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.821 Vali Acc: 0.848 Test Loss: 0.821 Test Acc: 0.848
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.4642891883850098
Epoch: 25, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.843 Vali Acc: 0.841 Test Loss: 0.843 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el4_dm768_df768_ps21_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8478260869565217
model parameter : 29425924
model size : 126.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el4_dm768_df768_ps21_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.283087730407715
Epoch: 1, Steps: 9 | Train Loss: 1.422 Vali Loss: 1.355 Vali Acc: 0.297 Test Loss: 1.355 Test Acc: 0.297
Validation loss decreased (inf --> -0.297088).  Saving model ...
Epoch: 2 cost time: 1.1736867427825928
Epoch: 2, Steps: 9 | Train Loss: 1.304 Vali Loss: 1.255 Vali Acc: 0.500 Test Loss: 1.255 Test Acc: 0.500
Validation loss decreased (-0.297088 --> -0.499987).  Saving model ...
Epoch: 3 cost time: 0.9228978157043457
Epoch: 3, Steps: 9 | Train Loss: 1.237 Vali Loss: 1.160 Vali Acc: 0.587 Test Loss: 1.160 Test Acc: 0.587
Validation loss decreased (-0.499987 --> -0.586945).  Saving model ...
Epoch: 4 cost time: 0.9166107177734375
Epoch: 4, Steps: 9 | Train Loss: 1.112 Vali Loss: 1.038 Vali Acc: 0.667 Test Loss: 1.038 Test Acc: 0.667
Validation loss decreased (-0.586945 --> -0.666656).  Saving model ...
Epoch: 5 cost time: 1.131601333618164
Epoch: 5, Steps: 9 | Train Loss: 0.958 Vali Loss: 0.960 Vali Acc: 0.616 Test Loss: 0.960 Test Acc: 0.616
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.102616786956787
Epoch: 6, Steps: 9 | Train Loss: 0.802 Vali Loss: 0.855 Vali Acc: 0.659 Test Loss: 0.855 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.0471100807189941
Epoch: 7, Steps: 9 | Train Loss: 0.705 Vali Loss: 0.773 Vali Acc: 0.688 Test Loss: 0.773 Test Acc: 0.688
Validation loss decreased (-0.666656 --> -0.688398).  Saving model ...
Epoch: 8 cost time: 1.075122356414795
Epoch: 8, Steps: 9 | Train Loss: 0.575 Vali Loss: 0.740 Vali Acc: 0.681 Test Loss: 0.740 Test Acc: 0.681
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0449182987213135
Epoch: 9, Steps: 9 | Train Loss: 0.440 Vali Loss: 0.673 Vali Acc: 0.717 Test Loss: 0.673 Test Acc: 0.717
Validation loss decreased (-0.688398 --> -0.717385).  Saving model ...
Epoch: 10 cost time: 1.0251731872558594
Epoch: 10, Steps: 9 | Train Loss: 0.325 Vali Loss: 0.699 Vali Acc: 0.732 Test Loss: 0.699 Test Acc: 0.732
Validation loss decreased (-0.717385 --> -0.731877).  Saving model ...
Epoch: 11 cost time: 1.0605852603912354
Epoch: 11, Steps: 9 | Train Loss: 0.264 Vali Loss: 0.643 Vali Acc: 0.790 Test Loss: 0.643 Test Acc: 0.790
Validation loss decreased (-0.731877 --> -0.789849).  Saving model ...
Epoch: 12 cost time: 1.1323909759521484
Epoch: 12, Steps: 9 | Train Loss: 0.166 Vali Loss: 0.696 Vali Acc: 0.761 Test Loss: 0.696 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0787956714630127
Epoch: 13, Steps: 9 | Train Loss: 0.164 Vali Loss: 0.664 Vali Acc: 0.775 Test Loss: 0.664 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9820938110351562
Epoch: 14, Steps: 9 | Train Loss: 0.092 Vali Loss: 0.778 Vali Acc: 0.783 Test Loss: 0.778 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.9595284461975098
Epoch: 15, Steps: 9 | Train Loss: 0.073 Vali Loss: 0.718 Vali Acc: 0.790 Test Loss: 0.718 Test Acc: 0.790
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.0730369091033936
Epoch: 16, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.748 Vali Acc: 0.804 Test Loss: 0.748 Test Acc: 0.804
Validation loss decreased (-0.789849 --> -0.804340).  Saving model ...
Epoch: 17 cost time: 1.2329025268554688
Epoch: 17, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.805 Vali Acc: 0.761 Test Loss: 0.805 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2142753601074219
Epoch: 18, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.842 Vali Acc: 0.819 Test Loss: 0.842 Test Acc: 0.819
Validation loss decreased (-0.804340 --> -0.818832).  Saving model ...
Epoch: 19 cost time: 1.1510186195373535
Epoch: 19, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.780 Vali Acc: 0.804 Test Loss: 0.780 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0784735679626465
Epoch: 20, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.780 Vali Acc: 0.819 Test Loss: 0.780 Test Acc: 0.819
Validation loss decreased (-0.818832 --> -0.818833).  Saving model ...
Epoch: 21 cost time: 0.9270367622375488
Epoch: 21, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.882 Vali Acc: 0.819 Test Loss: 0.882 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0710008144378662
Epoch: 22, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.827 Vali Acc: 0.804 Test Loss: 0.827 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.1541364192962646
Epoch: 23, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.838 Vali Acc: 0.804 Test Loss: 0.838 Test Acc: 0.804
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.1957223415374756
Epoch: 24, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.791 Vali Acc: 0.819 Test Loss: 0.791 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.101787805557251
Epoch: 25, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.790 Vali Acc: 0.812 Test Loss: 0.790 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.016935110092163
Epoch: 26, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.840 Vali Acc: 0.804 Test Loss: 0.840 Test Acc: 0.804
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.1844336986541748
Epoch: 27, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.840 Vali Acc: 0.804 Test Loss: 0.840 Test Acc: 0.804
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.0105020999908447
Epoch: 28, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.816 Vali Acc: 0.812 Test Loss: 0.816 Test Acc: 0.812
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.0393972396850586
Epoch: 29, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.860 Vali Acc: 0.819 Test Loss: 0.860 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.1787171363830566
Epoch: 30, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.921 Vali Acc: 0.819 Test Loss: 0.921 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el4_dm768_df768_ps21_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8188405797101449
model parameter : 29389060
model size : 126.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el4_dm768_df768_ps23_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.7496585845947266
Epoch: 1, Steps: 9 | Train Loss: 1.466 Vali Loss: 1.329 Vali Acc: 0.355 Test Loss: 1.329 Test Acc: 0.355
Validation loss decreased (inf --> -0.355059).  Saving model ...
Epoch: 2 cost time: 1.0030548572540283
Epoch: 2, Steps: 9 | Train Loss: 1.213 Vali Loss: 1.154 Vali Acc: 0.428 Test Loss: 1.154 Test Acc: 0.428
Validation loss decreased (-0.355059 --> -0.427525).  Saving model ...
Epoch: 3 cost time: 1.2948634624481201
Epoch: 3, Steps: 9 | Train Loss: 0.999 Vali Loss: 0.956 Vali Acc: 0.609 Test Loss: 0.956 Test Acc: 0.609
Validation loss decreased (-0.427525 --> -0.608686).  Saving model ...
Epoch: 4 cost time: 1.3554279804229736
Epoch: 4, Steps: 9 | Train Loss: 0.803 Vali Loss: 0.859 Vali Acc: 0.659 Test Loss: 0.859 Test Acc: 0.659
Validation loss decreased (-0.608686 --> -0.659412).  Saving model ...
Epoch: 5 cost time: 1.2797720432281494
Epoch: 5, Steps: 9 | Train Loss: 0.651 Vali Loss: 0.696 Vali Acc: 0.725 Test Loss: 0.696 Test Acc: 0.725
Validation loss decreased (-0.659412 --> -0.724631).  Saving model ...
Epoch: 6 cost time: 1.3609366416931152
Epoch: 6, Steps: 9 | Train Loss: 0.476 Vali Loss: 0.581 Vali Acc: 0.775 Test Loss: 0.581 Test Acc: 0.775
Validation loss decreased (-0.724631 --> -0.775357).  Saving model ...
Epoch: 7 cost time: 1.6609320640563965
Epoch: 7, Steps: 9 | Train Loss: 0.306 Vali Loss: 0.596 Vali Acc: 0.746 Test Loss: 0.596 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.080078363418579
Epoch: 8, Steps: 9 | Train Loss: 0.217 Vali Loss: 0.525 Vali Acc: 0.812 Test Loss: 0.525 Test Acc: 0.812
Validation loss decreased (-0.775357 --> -0.811589).  Saving model ...
Epoch: 9 cost time: 1.3845491409301758
Epoch: 9, Steps: 9 | Train Loss: 0.160 Vali Loss: 0.616 Vali Acc: 0.804 Test Loss: 0.616 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2539536952972412
Epoch: 10, Steps: 9 | Train Loss: 0.085 Vali Loss: 0.811 Vali Acc: 0.790 Test Loss: 0.811 Test Acc: 0.790
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.1642720699310303
Epoch: 11, Steps: 9 | Train Loss: 0.065 Vali Loss: 0.636 Vali Acc: 0.790 Test Loss: 0.636 Test Acc: 0.790
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.5383174419403076
Epoch: 12, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.977 Vali Acc: 0.768 Test Loss: 0.977 Test Acc: 0.768
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.3905878067016602
Epoch: 13, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.801 Vali Acc: 0.833 Test Loss: 0.801 Test Acc: 0.833
Validation loss decreased (-0.811589 --> -0.833325).  Saving model ...
Epoch: 14 cost time: 1.4890851974487305
Epoch: 14, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.768 Vali Acc: 0.833 Test Loss: 0.768 Test Acc: 0.833
Validation loss decreased (-0.833325 --> -0.833326).  Saving model ...
Epoch: 15 cost time: 1.268129587173462
Epoch: 15, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.937 Vali Acc: 0.804 Test Loss: 0.937 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2017481327056885
Epoch: 16, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.918 Vali Acc: 0.833 Test Loss: 0.918 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.499817132949829
Epoch: 17, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.041 Vali Acc: 0.833 Test Loss: 1.041 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.1616740226745605
Epoch: 18, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.908 Vali Acc: 0.841 Test Loss: 0.908 Test Acc: 0.841
Validation loss decreased (-0.833326 --> -0.840571).  Saving model ...
Epoch: 19 cost time: 1.3476896286010742
Epoch: 19, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.864 Vali Acc: 0.848 Test Loss: 0.864 Test Acc: 0.848
Validation loss decreased (-0.840571 --> -0.847817).  Saving model ...
Epoch: 20 cost time: 1.2826101779937744
Epoch: 20, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.844 Vali Acc: 0.841 Test Loss: 0.844 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.1023330688476562
Epoch: 21, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.853 Vali Acc: 0.848 Test Loss: 0.853 Test Acc: 0.848
Validation loss decreased (-0.847817 --> -0.847818).  Saving model ...
Epoch: 22 cost time: 1.183091640472412
Epoch: 22, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.871 Vali Acc: 0.848 Test Loss: 0.871 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.4645442962646484
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.889 Vali Acc: 0.841 Test Loss: 0.889 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.1209852695465088
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.916 Vali Acc: 0.833 Test Loss: 0.916 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.279184103012085
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.933 Vali Acc: 0.833 Test Loss: 0.933 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.4318833351135254
Epoch: 26, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.941 Vali Acc: 0.841 Test Loss: 0.941 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.0102207660675049
Epoch: 27, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.910 Vali Acc: 0.841 Test Loss: 0.910 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.0462760925292969
Epoch: 28, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.884 Vali Acc: 0.841 Test Loss: 0.884 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.5022022724151611
Epoch: 29, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.870 Vali Acc: 0.841 Test Loss: 0.870 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.9465014934539795
Epoch: 30, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.842 Vali Acc: 0.841 Test Loss: 0.842 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.5065674781799316
Epoch: 31, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.891 Vali Acc: 0.841 Test Loss: 0.891 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el4_dm768_df768_ps23_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8478260869565217
model parameter : 29504260
model size : 127.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el4_dm768_df768_ps23_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.417203187942505
Epoch: 1, Steps: 9 | Train Loss: 1.486 Vali Loss: 1.372 Vali Acc: 0.341 Test Loss: 1.372 Test Acc: 0.341
Validation loss decreased (inf --> -0.340566).  Saving model ...
Epoch: 2 cost time: 1.0155420303344727
Epoch: 2, Steps: 9 | Train Loss: 1.293 Vali Loss: 1.233 Vali Acc: 0.486 Test Loss: 1.233 Test Acc: 0.486
Validation loss decreased (-0.340566 --> -0.485495).  Saving model ...
Epoch: 3 cost time: 1.113870620727539
Epoch: 3, Steps: 9 | Train Loss: 1.155 Vali Loss: 1.104 Vali Acc: 0.609 Test Loss: 1.104 Test Acc: 0.609
Validation loss decreased (-0.485495 --> -0.608685).  Saving model ...
Epoch: 4 cost time: 1.0982427597045898
Epoch: 4, Steps: 9 | Train Loss: 0.978 Vali Loss: 0.972 Vali Acc: 0.645 Test Loss: 0.972 Test Acc: 0.645
Validation loss decreased (-0.608685 --> -0.644918).  Saving model ...
Epoch: 5 cost time: 1.0806884765625
Epoch: 5, Steps: 9 | Train Loss: 0.794 Vali Loss: 0.871 Vali Acc: 0.674 Test Loss: 0.871 Test Acc: 0.674
Validation loss decreased (-0.644918 --> -0.673904).  Saving model ...
Epoch: 6 cost time: 1.098118782043457
Epoch: 6, Steps: 9 | Train Loss: 0.674 Vali Loss: 0.836 Vali Acc: 0.667 Test Loss: 0.836 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.105175495147705
Epoch: 7, Steps: 9 | Train Loss: 0.529 Vali Loss: 0.718 Vali Acc: 0.732 Test Loss: 0.718 Test Acc: 0.732
Validation loss decreased (-0.673904 --> -0.731877).  Saving model ...
Epoch: 8 cost time: 1.062265157699585
Epoch: 8, Steps: 9 | Train Loss: 0.433 Vali Loss: 0.743 Vali Acc: 0.725 Test Loss: 0.743 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8794207572937012
Epoch: 9, Steps: 9 | Train Loss: 0.317 Vali Loss: 0.582 Vali Acc: 0.797 Test Loss: 0.582 Test Acc: 0.797
Validation loss decreased (-0.731877 --> -0.797096).  Saving model ...
Epoch: 10 cost time: 1.4284191131591797
Epoch: 10, Steps: 9 | Train Loss: 0.228 Vali Loss: 0.654 Vali Acc: 0.797 Test Loss: 0.654 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.37388014793396
Epoch: 11, Steps: 9 | Train Loss: 0.151 Vali Loss: 0.570 Vali Acc: 0.826 Test Loss: 0.570 Test Acc: 0.826
Validation loss decreased (-0.797096 --> -0.826081).  Saving model ...
Epoch: 12 cost time: 1.4123046398162842
Epoch: 12, Steps: 9 | Train Loss: 0.091 Vali Loss: 0.630 Vali Acc: 0.833 Test Loss: 0.630 Test Acc: 0.833
Validation loss decreased (-0.826081 --> -0.833327).  Saving model ...
Epoch: 13 cost time: 1.5208899974822998
Epoch: 13, Steps: 9 | Train Loss: 0.057 Vali Loss: 0.809 Vali Acc: 0.797 Test Loss: 0.809 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3648762702941895
Epoch: 14, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.782 Vali Acc: 0.833 Test Loss: 0.782 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.6181812286376953
Epoch: 15, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.734 Vali Acc: 0.841 Test Loss: 0.734 Test Acc: 0.841
Validation loss decreased (-0.833327 --> -0.840572).  Saving model ...
Epoch: 16 cost time: 1.251377820968628
Epoch: 16, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.765 Vali Acc: 0.812 Test Loss: 0.765 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3663501739501953
Epoch: 17, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.848 Vali Acc: 0.826 Test Loss: 0.848 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.7652075290679932
Epoch: 18, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.771 Vali Acc: 0.833 Test Loss: 0.771 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.4666533470153809
Epoch: 19, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.743 Vali Acc: 0.819 Test Loss: 0.743 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.1772549152374268
Epoch: 20, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.752 Vali Acc: 0.841 Test Loss: 0.752 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.6017215251922607
Epoch: 21, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.815 Vali Acc: 0.833 Test Loss: 0.815 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.600398063659668
Epoch: 22, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.834 Vali Acc: 0.833 Test Loss: 0.834 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.1908214092254639
Epoch: 23, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.852 Vali Acc: 0.819 Test Loss: 0.852 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.1366417407989502
Epoch: 24, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.845 Vali Acc: 0.819 Test Loss: 0.845 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.122805118560791
Epoch: 25, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.836 Vali Acc: 0.833 Test Loss: 0.836 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el4_dm768_df768_ps23_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8405797101449275
model parameter : 29435140
model size : 126.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el4_dm768_df768_ps23_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.63283634185791
Epoch: 1, Steps: 9 | Train Loss: 1.457 Vali Loss: 1.384 Vali Acc: 0.246 Test Loss: 1.384 Test Acc: 0.246
Validation loss decreased (inf --> -0.246363).  Saving model ...
Epoch: 2 cost time: 0.8993263244628906
Epoch: 2, Steps: 9 | Train Loss: 1.355 Vali Loss: 1.312 Vali Acc: 0.457 Test Loss: 1.312 Test Acc: 0.457
Validation loss decreased (-0.246363 --> -0.456509).  Saving model ...
Epoch: 3 cost time: 1.0814285278320312
Epoch: 3, Steps: 9 | Train Loss: 1.276 Vali Loss: 1.214 Vali Acc: 0.529 Test Loss: 1.214 Test Acc: 0.529
Validation loss decreased (-0.456509 --> -0.528973).  Saving model ...
Epoch: 4 cost time: 0.9152166843414307
Epoch: 4, Steps: 9 | Train Loss: 1.149 Vali Loss: 1.108 Vali Acc: 0.522 Test Loss: 1.108 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0673646926879883
Epoch: 5, Steps: 9 | Train Loss: 0.999 Vali Loss: 1.004 Vali Acc: 0.630 Test Loss: 1.004 Test Acc: 0.630
Validation loss decreased (-0.528973 --> -0.630425).  Saving model ...
Epoch: 6 cost time: 0.8595991134643555
Epoch: 6, Steps: 9 | Train Loss: 0.885 Vali Loss: 0.931 Vali Acc: 0.638 Test Loss: 0.931 Test Acc: 0.638
Validation loss decreased (-0.630425 --> -0.637672).  Saving model ...
Epoch: 7 cost time: 0.911036491394043
Epoch: 7, Steps: 9 | Train Loss: 0.725 Vali Loss: 0.838 Vali Acc: 0.630 Test Loss: 0.838 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.735095739364624
Epoch: 8, Steps: 9 | Train Loss: 0.602 Vali Loss: 0.780 Vali Acc: 0.674 Test Loss: 0.780 Test Acc: 0.674
Validation loss decreased (-0.637672 --> -0.673905).  Saving model ...
Epoch: 9 cost time: 0.9552178382873535
Epoch: 9, Steps: 9 | Train Loss: 0.496 Vali Loss: 0.735 Vali Acc: 0.732 Test Loss: 0.735 Test Acc: 0.732
Validation loss decreased (-0.673905 --> -0.731877).  Saving model ...
Epoch: 10 cost time: 0.9981470108032227
Epoch: 10, Steps: 9 | Train Loss: 0.433 Vali Loss: 0.647 Vali Acc: 0.739 Test Loss: 0.647 Test Acc: 0.739
Validation loss decreased (-0.731877 --> -0.739124).  Saving model ...
Epoch: 11 cost time: 0.9905693531036377
Epoch: 11, Steps: 9 | Train Loss: 0.308 Vali Loss: 0.680 Vali Acc: 0.768 Test Loss: 0.680 Test Acc: 0.768
Validation loss decreased (-0.739124 --> -0.768109).  Saving model ...
Epoch: 12 cost time: 0.8687803745269775
Epoch: 12, Steps: 9 | Train Loss: 0.232 Vali Loss: 0.684 Vali Acc: 0.768 Test Loss: 0.684 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9464452266693115
Epoch: 13, Steps: 9 | Train Loss: 0.165 Vali Loss: 0.665 Vali Acc: 0.768 Test Loss: 0.665 Test Acc: 0.768
Validation loss decreased (-0.768109 --> -0.768109).  Saving model ...
Epoch: 14 cost time: 0.8680744171142578
Epoch: 14, Steps: 9 | Train Loss: 0.110 Vali Loss: 0.675 Vali Acc: 0.768 Test Loss: 0.675 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9398791790008545
Epoch: 15, Steps: 9 | Train Loss: 0.069 Vali Loss: 0.672 Vali Acc: 0.775 Test Loss: 0.672 Test Acc: 0.775
Validation loss decreased (-0.768109 --> -0.775356).  Saving model ...
Epoch: 16 cost time: 0.8147644996643066
Epoch: 16, Steps: 9 | Train Loss: 0.052 Vali Loss: 0.764 Vali Acc: 0.768 Test Loss: 0.764 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9743854999542236
Epoch: 17, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.685 Vali Acc: 0.797 Test Loss: 0.685 Test Acc: 0.797
Validation loss decreased (-0.775356 --> -0.797095).  Saving model ...
Epoch: 18 cost time: 1.0120952129364014
Epoch: 18, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.776 Vali Acc: 0.797 Test Loss: 0.776 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9432961940765381
Epoch: 19, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.715 Vali Acc: 0.797 Test Loss: 0.715 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.0465054512023926
Epoch: 20, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.733 Vali Acc: 0.790 Test Loss: 0.733 Test Acc: 0.790
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.0642552375793457
Epoch: 21, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.755 Vali Acc: 0.797 Test Loss: 0.755 Test Acc: 0.797
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.9079301357269287
Epoch: 22, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.762 Vali Acc: 0.790 Test Loss: 0.762 Test Acc: 0.790
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.0335805416107178
Epoch: 23, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.778 Vali Acc: 0.797 Test Loss: 0.778 Test Acc: 0.797
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.0156199932098389
Epoch: 24, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.786 Vali Acc: 0.797 Test Loss: 0.786 Test Acc: 0.797
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.8875081539154053
Epoch: 25, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.775 Vali Acc: 0.797 Test Loss: 0.775 Test Acc: 0.797
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.8415870666503906
Epoch: 26, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.789 Vali Acc: 0.797 Test Loss: 0.789 Test Acc: 0.797
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.7163846492767334
Epoch: 27, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.786 Vali Acc: 0.797 Test Loss: 0.786 Test Acc: 0.797
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el4_dm768_df768_ps23_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.7971014492753623
model parameter : 29398276
model size : 126.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el4_dm768_df768_ps26_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.665647268295288
Epoch: 1, Steps: 9 | Train Loss: 1.364 Vali Loss: 1.330 Vali Acc: 0.362 Test Loss: 1.330 Test Acc: 0.362
Validation loss decreased (inf --> -0.362306).  Saving model ...
Epoch: 2 cost time: 1.8664138317108154
Epoch: 2, Steps: 9 | Train Loss: 1.234 Vali Loss: 1.171 Vali Acc: 0.587 Test Loss: 1.171 Test Acc: 0.587
Validation loss decreased (-0.362306 --> -0.586945).  Saving model ...
Epoch: 3 cost time: 1.67008376121521
Epoch: 3, Steps: 9 | Train Loss: 1.067 Vali Loss: 0.999 Vali Acc: 0.587 Test Loss: 0.999 Test Acc: 0.587
Validation loss decreased (-0.586945 --> -0.586947).  Saving model ...
Epoch: 4 cost time: 1.3766350746154785
Epoch: 4, Steps: 9 | Train Loss: 0.851 Vali Loss: 0.857 Vali Acc: 0.652 Test Loss: 0.857 Test Acc: 0.652
Validation loss decreased (-0.586947 --> -0.652165).  Saving model ...
Epoch: 5 cost time: 1.2743642330169678
Epoch: 5, Steps: 9 | Train Loss: 0.700 Vali Loss: 0.727 Vali Acc: 0.717 Test Loss: 0.727 Test Acc: 0.717
Validation loss decreased (-0.652165 --> -0.717384).  Saving model ...
Epoch: 6 cost time: 1.4406793117523193
Epoch: 6, Steps: 9 | Train Loss: 0.529 Vali Loss: 0.664 Vali Acc: 0.732 Test Loss: 0.664 Test Acc: 0.732
Validation loss decreased (-0.717384 --> -0.731877).  Saving model ...
Epoch: 7 cost time: 1.4206945896148682
Epoch: 7, Steps: 9 | Train Loss: 0.423 Vali Loss: 0.573 Vali Acc: 0.739 Test Loss: 0.573 Test Acc: 0.739
Validation loss decreased (-0.731877 --> -0.739125).  Saving model ...
Epoch: 8 cost time: 1.4472386837005615
Epoch: 8, Steps: 9 | Train Loss: 0.272 Vali Loss: 0.655 Vali Acc: 0.761 Test Loss: 0.655 Test Acc: 0.761
Validation loss decreased (-0.739125 --> -0.760863).  Saving model ...
Epoch: 9 cost time: 1.3231687545776367
Epoch: 9, Steps: 9 | Train Loss: 0.171 Vali Loss: 0.412 Vali Acc: 0.841 Test Loss: 0.412 Test Acc: 0.841
Validation loss decreased (-0.760863 --> -0.840576).  Saving model ...
Epoch: 10 cost time: 1.4317562580108643
Epoch: 10, Steps: 9 | Train Loss: 0.121 Vali Loss: 0.530 Vali Acc: 0.819 Test Loss: 0.530 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.358076810836792
Epoch: 11, Steps: 9 | Train Loss: 0.071 Vali Loss: 0.661 Vali Acc: 0.790 Test Loss: 0.661 Test Acc: 0.790
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.3542282581329346
Epoch: 12, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.597 Vali Acc: 0.841 Test Loss: 0.597 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.339911699295044
Epoch: 13, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.597 Vali Acc: 0.833 Test Loss: 0.597 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.4155619144439697
Epoch: 14, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.778 Vali Acc: 0.826 Test Loss: 0.778 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.2454397678375244
Epoch: 15, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.610 Vali Acc: 0.841 Test Loss: 0.610 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.5819592475891113
Epoch: 16, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.904 Vali Acc: 0.812 Test Loss: 0.904 Test Acc: 0.812
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.3231303691864014
Epoch: 17, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.710 Vali Acc: 0.826 Test Loss: 0.710 Test Acc: 0.826
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.2576677799224854
Epoch: 18, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.682 Vali Acc: 0.833 Test Loss: 0.682 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.3334574699401855
Epoch: 19, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.729 Vali Acc: 0.826 Test Loss: 0.729 Test Acc: 0.826
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el4_dm768_df768_ps26_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8405797101449275
model parameter : 29501956
model size : 127.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el4_dm768_df768_ps26_str13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.122772216796875
Epoch: 1, Steps: 9 | Train Loss: 1.496 Vali Loss: 1.361 Vali Acc: 0.384 Test Loss: 1.361 Test Acc: 0.384
Validation loss decreased (inf --> -0.384044).  Saving model ...
Epoch: 2 cost time: 0.9596936702728271
Epoch: 2, Steps: 9 | Train Loss: 1.351 Vali Loss: 1.305 Vali Acc: 0.348 Test Loss: 1.305 Test Acc: 0.348
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0952374935150146
Epoch: 3, Steps: 9 | Train Loss: 1.229 Vali Loss: 1.179 Vali Acc: 0.377 Test Loss: 1.179 Test Acc: 0.377
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.2633249759674072
Epoch: 4, Steps: 9 | Train Loss: 1.095 Vali Loss: 1.057 Vali Acc: 0.609 Test Loss: 1.057 Test Acc: 0.609
Validation loss decreased (-0.384044 --> -0.608685).  Saving model ...
Epoch: 5 cost time: 1.2673842906951904
Epoch: 5, Steps: 9 | Train Loss: 0.920 Vali Loss: 1.004 Vali Acc: 0.630 Test Loss: 1.004 Test Acc: 0.630
Validation loss decreased (-0.608685 --> -0.630425).  Saving model ...
Epoch: 6 cost time: 1.2594153881072998
Epoch: 6, Steps: 9 | Train Loss: 0.802 Vali Loss: 0.869 Vali Acc: 0.652 Test Loss: 0.869 Test Acc: 0.652
Validation loss decreased (-0.630425 --> -0.652165).  Saving model ...
Epoch: 7 cost time: 1.0208680629730225
Epoch: 7, Steps: 9 | Train Loss: 0.640 Vali Loss: 0.851 Vali Acc: 0.638 Test Loss: 0.851 Test Acc: 0.638
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.055971384048462
Epoch: 8, Steps: 9 | Train Loss: 0.476 Vali Loss: 0.692 Vali Acc: 0.688 Test Loss: 0.692 Test Acc: 0.688
Validation loss decreased (-0.652165 --> -0.688399).  Saving model ...
Epoch: 9 cost time: 1.2880935668945312
Epoch: 9, Steps: 9 | Train Loss: 0.353 Vali Loss: 0.662 Vali Acc: 0.725 Test Loss: 0.662 Test Acc: 0.725
Validation loss decreased (-0.688399 --> -0.724631).  Saving model ...
Epoch: 10 cost time: 1.0172834396362305
Epoch: 10, Steps: 9 | Train Loss: 0.237 Vali Loss: 0.657 Vali Acc: 0.783 Test Loss: 0.657 Test Acc: 0.783
Validation loss decreased (-0.724631 --> -0.782602).  Saving model ...
Epoch: 11 cost time: 1.138988733291626
Epoch: 11, Steps: 9 | Train Loss: 0.189 Vali Loss: 0.573 Vali Acc: 0.833 Test Loss: 0.573 Test Acc: 0.833
Validation loss decreased (-0.782602 --> -0.833328).  Saving model ...
Epoch: 12 cost time: 1.1615192890167236
Epoch: 12, Steps: 9 | Train Loss: 0.114 Vali Loss: 0.687 Vali Acc: 0.790 Test Loss: 0.687 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0247247219085693
Epoch: 13, Steps: 9 | Train Loss: 0.081 Vali Loss: 0.601 Vali Acc: 0.826 Test Loss: 0.601 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9109659194946289
Epoch: 14, Steps: 9 | Train Loss: 0.047 Vali Loss: 0.662 Vali Acc: 0.812 Test Loss: 0.662 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.193601131439209
Epoch: 15, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.621 Vali Acc: 0.819 Test Loss: 0.621 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.9346647262573242
Epoch: 16, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.759 Vali Acc: 0.819 Test Loss: 0.759 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.196214199066162
Epoch: 17, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.659 Vali Acc: 0.826 Test Loss: 0.659 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.209700584411621
Epoch: 18, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.689 Vali Acc: 0.819 Test Loss: 0.689 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.9619238376617432
Epoch: 19, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.699 Vali Acc: 0.841 Test Loss: 0.699 Test Acc: 0.841
Validation loss decreased (-0.833328 --> -0.840573).  Saving model ...
Epoch: 20 cost time: 1.2311148643493652
Epoch: 20, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.642 Vali Acc: 0.819 Test Loss: 0.642 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.2164514064788818
Epoch: 21, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.804 Vali Acc: 0.804 Test Loss: 0.804 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.1035494804382324
Epoch: 22, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.822 Vali Acc: 0.804 Test Loss: 0.822 Test Acc: 0.804
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.006728172302246
Epoch: 23, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.799 Vali Acc: 0.826 Test Loss: 0.799 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.130143404006958
Epoch: 24, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.774 Vali Acc: 0.819 Test Loss: 0.774 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.1775333881378174
Epoch: 25, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.802 Vali Acc: 0.819 Test Loss: 0.802 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.9879519939422607
Epoch: 26, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.874 Vali Acc: 0.812 Test Loss: 0.874 Test Acc: 0.812
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.9115967750549316
Epoch: 27, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.888 Vali Acc: 0.819 Test Loss: 0.888 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.8901207447052002
Epoch: 28, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.843 Vali Acc: 0.833 Test Loss: 0.843 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.0574662685394287
Epoch: 29, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.829 Vali Acc: 0.819 Test Loss: 0.829 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el4_dm768_df768_ps26_str13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8405797101449275
model parameter : 29446660
model size : 127.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el4_dm768_df768_ps26_str26_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.8476266860961914
Epoch: 1, Steps: 9 | Train Loss: 1.504 Vali Loss: 1.394 Vali Acc: 0.254 Test Loss: 1.394 Test Acc: 0.254
Validation loss decreased (inf --> -0.253609).  Saving model ...
Epoch: 2 cost time: 1.127671241760254
Epoch: 2, Steps: 9 | Train Loss: 1.368 Vali Loss: 1.313 Vali Acc: 0.435 Test Loss: 1.313 Test Acc: 0.435
Validation loss decreased (-0.253609 --> -0.434769).  Saving model ...
Epoch: 3 cost time: 1.078540325164795
Epoch: 3, Steps: 9 | Train Loss: 1.275 Vali Loss: 1.230 Vali Acc: 0.522 Test Loss: 1.230 Test Acc: 0.522
Validation loss decreased (-0.434769 --> -0.521727).  Saving model ...
Epoch: 4 cost time: 1.1255886554718018
Epoch: 4, Steps: 9 | Train Loss: 1.127 Vali Loss: 1.138 Vali Acc: 0.572 Test Loss: 1.138 Test Acc: 0.572
Validation loss decreased (-0.521727 --> -0.572452).  Saving model ...
Epoch: 5 cost time: 1.0620241165161133
Epoch: 5, Steps: 9 | Train Loss: 1.007 Vali Loss: 1.053 Vali Acc: 0.587 Test Loss: 1.053 Test Acc: 0.587
Validation loss decreased (-0.572452 --> -0.586946).  Saving model ...
Epoch: 6 cost time: 1.0389447212219238
Epoch: 6, Steps: 9 | Train Loss: 0.867 Vali Loss: 1.000 Vali Acc: 0.623 Test Loss: 1.000 Test Acc: 0.623
Validation loss decreased (-0.586946 --> -0.623178).  Saving model ...
Epoch: 7 cost time: 0.8938512802124023
Epoch: 7, Steps: 9 | Train Loss: 0.738 Vali Loss: 0.912 Vali Acc: 0.645 Test Loss: 0.912 Test Acc: 0.645
Validation loss decreased (-0.623178 --> -0.644918).  Saving model ...
Epoch: 8 cost time: 0.950995922088623
Epoch: 8, Steps: 9 | Train Loss: 0.645 Vali Loss: 0.870 Vali Acc: 0.645 Test Loss: 0.870 Test Acc: 0.645
Validation loss decreased (-0.644918 --> -0.644919).  Saving model ...
Epoch: 9 cost time: 1.0133147239685059
Epoch: 9, Steps: 9 | Train Loss: 0.503 Vali Loss: 0.857 Vali Acc: 0.681 Test Loss: 0.857 Test Acc: 0.681
Validation loss decreased (-0.644919 --> -0.681151).  Saving model ...
Epoch: 10 cost time: 1.0209379196166992
Epoch: 10, Steps: 9 | Train Loss: 0.410 Vali Loss: 0.752 Vali Acc: 0.725 Test Loss: 0.752 Test Acc: 0.725
Validation loss decreased (-0.681151 --> -0.724630).  Saving model ...
Epoch: 11 cost time: 0.9758410453796387
Epoch: 11, Steps: 9 | Train Loss: 0.329 Vali Loss: 0.740 Vali Acc: 0.739 Test Loss: 0.740 Test Acc: 0.739
Validation loss decreased (-0.724630 --> -0.739123).  Saving model ...
Epoch: 12 cost time: 0.930952787399292
Epoch: 12, Steps: 9 | Train Loss: 0.235 Vali Loss: 0.729 Vali Acc: 0.717 Test Loss: 0.729 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2210187911987305
Epoch: 13, Steps: 9 | Train Loss: 0.185 Vali Loss: 0.788 Vali Acc: 0.725 Test Loss: 0.788 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9835207462310791
Epoch: 14, Steps: 9 | Train Loss: 0.152 Vali Loss: 0.704 Vali Acc: 0.739 Test Loss: 0.704 Test Acc: 0.739
Validation loss decreased (-0.739123 --> -0.739123).  Saving model ...
Epoch: 15 cost time: 1.2329318523406982
Epoch: 15, Steps: 9 | Train Loss: 0.075 Vali Loss: 0.708 Vali Acc: 0.768 Test Loss: 0.708 Test Acc: 0.768
Validation loss decreased (-0.739123 --> -0.768109).  Saving model ...
Epoch: 16 cost time: 0.9393162727355957
Epoch: 16, Steps: 9 | Train Loss: 0.063 Vali Loss: 0.820 Vali Acc: 0.739 Test Loss: 0.820 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8510475158691406
Epoch: 17, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.730 Vali Acc: 0.768 Test Loss: 0.730 Test Acc: 0.768
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.053818702697754
Epoch: 18, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.814 Vali Acc: 0.783 Test Loss: 0.814 Test Acc: 0.783
Validation loss decreased (-0.768109 --> -0.782601).  Saving model ...
Epoch: 19 cost time: 1.1320321559906006
Epoch: 19, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.840 Vali Acc: 0.768 Test Loss: 0.840 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8544356822967529
Epoch: 20, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.864 Vali Acc: 0.768 Test Loss: 0.864 Test Acc: 0.768
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.0837817192077637
Epoch: 21, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.787 Vali Acc: 0.768 Test Loss: 0.787 Test Acc: 0.768
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.044632911682129
Epoch: 22, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.885 Vali Acc: 0.790 Test Loss: 0.885 Test Acc: 0.790
Validation loss decreased (-0.782601 --> -0.789846).  Saving model ...
Epoch: 23 cost time: 0.9597988128662109
Epoch: 23, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.956 Vali Acc: 0.790 Test Loss: 0.956 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9788918495178223
Epoch: 24, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.840 Vali Acc: 0.783 Test Loss: 0.840 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.8718397617340088
Epoch: 25, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.860 Vali Acc: 0.783 Test Loss: 0.860 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.2346141338348389
Epoch: 26, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.921 Vali Acc: 0.783 Test Loss: 0.921 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.8706111907958984
Epoch: 27, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.879 Vali Acc: 0.797 Test Loss: 0.879 Test Acc: 0.797
Validation loss decreased (-0.789846 --> -0.797093).  Saving model ...
Epoch: 28 cost time: 0.8142685890197754
Epoch: 28, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.891 Vali Acc: 0.783 Test Loss: 0.891 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.9576785564422607
Epoch: 29, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.908 Vali Acc: 0.783 Test Loss: 0.908 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.0574114322662354
Epoch: 30, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.929 Vali Acc: 0.790 Test Loss: 0.929 Test Acc: 0.790
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.0721232891082764
Epoch: 31, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.889 Vali Acc: 0.790 Test Loss: 0.889 Test Acc: 0.790
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.8636627197265625
Epoch: 32, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.922 Vali Acc: 0.797 Test Loss: 0.922 Test Acc: 0.797
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.7708587646484375
Epoch: 33, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.946 Vali Acc: 0.790 Test Loss: 0.946 Test Acc: 0.790
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.6971056461334229
Epoch: 34, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.978 Vali Acc: 0.790 Test Loss: 0.978 Test Acc: 0.790
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.8066198825836182
Epoch: 35, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.966 Vali Acc: 0.790 Test Loss: 0.966 Test Acc: 0.790
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.8312578201293945
Epoch: 36, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.972 Vali Acc: 0.790 Test Loss: 0.972 Test Acc: 0.790
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.9155936241149902
Epoch: 37, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.975 Vali Acc: 0.790 Test Loss: 0.975 Test Acc: 0.790
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el4_dm768_df768_ps26_str26_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.7971014492753623
model parameter : 29414404
model size : 126.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el4_dm768_df768_ps30_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.5216524600982666
Epoch: 1, Steps: 9 | Train Loss: 1.493 Vali Loss: 1.370 Vali Acc: 0.326 Test Loss: 1.370 Test Acc: 0.326
Validation loss decreased (inf --> -0.326073).  Saving model ...
Epoch: 2 cost time: 1.3440146446228027
Epoch: 2, Steps: 9 | Train Loss: 1.293 Vali Loss: 1.193 Vali Acc: 0.464 Test Loss: 1.193 Test Acc: 0.464
Validation loss decreased (-0.326073 --> -0.463756).  Saving model ...
Epoch: 3 cost time: 0.9002597332000732
Epoch: 3, Steps: 9 | Train Loss: 1.103 Vali Loss: 1.035 Vali Acc: 0.616 Test Loss: 1.035 Test Acc: 0.616
Validation loss decreased (-0.463756 --> -0.615932).  Saving model ...
Epoch: 4 cost time: 1.310455560684204
Epoch: 4, Steps: 9 | Train Loss: 0.908 Vali Loss: 0.901 Vali Acc: 0.659 Test Loss: 0.901 Test Acc: 0.659
Validation loss decreased (-0.615932 --> -0.659411).  Saving model ...
Epoch: 5 cost time: 1.638216257095337
Epoch: 5, Steps: 9 | Train Loss: 0.748 Vali Loss: 0.830 Vali Acc: 0.667 Test Loss: 0.830 Test Acc: 0.667
Validation loss decreased (-0.659411 --> -0.666658).  Saving model ...
Epoch: 6 cost time: 1.266895055770874
Epoch: 6, Steps: 9 | Train Loss: 0.526 Vali Loss: 0.676 Vali Acc: 0.710 Test Loss: 0.676 Test Acc: 0.710
Validation loss decreased (-0.666658 --> -0.710138).  Saving model ...
Epoch: 7 cost time: 1.5591421127319336
Epoch: 7, Steps: 9 | Train Loss: 0.409 Vali Loss: 0.585 Vali Acc: 0.746 Test Loss: 0.585 Test Acc: 0.746
Validation loss decreased (-0.710138 --> -0.746371).  Saving model ...
Epoch: 8 cost time: 1.2438716888427734
Epoch: 8, Steps: 9 | Train Loss: 0.255 Vali Loss: 0.580 Vali Acc: 0.775 Test Loss: 0.580 Test Acc: 0.775
Validation loss decreased (-0.746371 --> -0.775357).  Saving model ...
Epoch: 9 cost time: 1.138559103012085
Epoch: 9, Steps: 9 | Train Loss: 0.167 Vali Loss: 0.914 Vali Acc: 0.746 Test Loss: 0.914 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5858798027038574
Epoch: 10, Steps: 9 | Train Loss: 0.172 Vali Loss: 0.550 Vali Acc: 0.775 Test Loss: 0.550 Test Acc: 0.775
Validation loss decreased (-0.775357 --> -0.775357).  Saving model ...
Epoch: 11 cost time: 1.2548491954803467
Epoch: 11, Steps: 9 | Train Loss: 0.114 Vali Loss: 0.895 Vali Acc: 0.775 Test Loss: 0.895 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.165846347808838
Epoch: 12, Steps: 9 | Train Loss: 0.052 Vali Loss: 0.700 Vali Acc: 0.797 Test Loss: 0.700 Test Acc: 0.797
Validation loss decreased (-0.775357 --> -0.797094).  Saving model ...
Epoch: 13 cost time: 1.4936375617980957
Epoch: 13, Steps: 9 | Train Loss: 0.048 Vali Loss: 0.670 Vali Acc: 0.812 Test Loss: 0.670 Test Acc: 0.812
Validation loss decreased (-0.797094 --> -0.811588).  Saving model ...
Epoch: 14 cost time: 1.4385993480682373
Epoch: 14, Steps: 9 | Train Loss: 0.025 Vali Loss: 1.029 Vali Acc: 0.754 Test Loss: 1.029 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.8801867961883545
Epoch: 15, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.787 Vali Acc: 0.812 Test Loss: 0.787 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.4757425785064697
Epoch: 16, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.814 Vali Acc: 0.804 Test Loss: 0.814 Test Acc: 0.804
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.2713043689727783
Epoch: 17, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.993 Vali Acc: 0.812 Test Loss: 0.993 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.6207349300384521
Epoch: 18, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.855 Vali Acc: 0.804 Test Loss: 0.855 Test Acc: 0.804
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.453535795211792
Epoch: 19, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.822 Vali Acc: 0.826 Test Loss: 0.822 Test Acc: 0.826
Validation loss decreased (-0.811588 --> -0.826079).  Saving model ...
Epoch: 20 cost time: 1.2633020877838135
Epoch: 20, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.804 Vali Acc: 0.819 Test Loss: 0.804 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.612316370010376
Epoch: 21, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.797 Vali Acc: 0.819 Test Loss: 0.797 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.7304210662841797
Epoch: 22, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.822 Vali Acc: 0.819 Test Loss: 0.822 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.4981634616851807
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.861 Vali Acc: 0.812 Test Loss: 0.861 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.4148797988891602
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.872 Vali Acc: 0.812 Test Loss: 0.872 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.435490608215332
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.879 Vali Acc: 0.812 Test Loss: 0.879 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.3652446269989014
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.880 Vali Acc: 0.819 Test Loss: 0.880 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.6936664581298828
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.869 Vali Acc: 0.826 Test Loss: 0.869 Test Acc: 0.826
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.6916823387145996
Epoch: 28, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.877 Vali Acc: 0.819 Test Loss: 0.877 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.2689368724822998
Epoch: 29, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.871 Vali Acc: 0.819 Test Loss: 0.871 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el4_dm768_df768_ps30_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8260869565217391
model parameter : 29515780
model size : 127.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el4_dm768_df768_ps30_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.291278600692749
Epoch: 1, Steps: 9 | Train Loss: 1.433 Vali Loss: 1.408 Vali Acc: 0.159 Test Loss: 1.408 Test Acc: 0.159
Validation loss decreased (inf --> -0.159406).  Saving model ...
Epoch: 2 cost time: 0.9738273620605469
Epoch: 2, Steps: 9 | Train Loss: 1.301 Vali Loss: 1.301 Vali Acc: 0.420 Test Loss: 1.301 Test Acc: 0.420
Validation loss decreased (-0.159406 --> -0.420277).  Saving model ...
Epoch: 3 cost time: 1.0419971942901611
Epoch: 3, Steps: 9 | Train Loss: 1.226 Vali Loss: 1.207 Vali Acc: 0.464 Test Loss: 1.207 Test Acc: 0.464
Validation loss decreased (-0.420277 --> -0.463756).  Saving model ...
Epoch: 4 cost time: 1.0481228828430176
Epoch: 4, Steps: 9 | Train Loss: 1.120 Vali Loss: 1.126 Vali Acc: 0.464 Test Loss: 1.126 Test Acc: 0.464
Validation loss decreased (-0.463756 --> -0.463757).  Saving model ...
Epoch: 5 cost time: 1.1636550426483154
Epoch: 5, Steps: 9 | Train Loss: 0.959 Vali Loss: 1.013 Vali Acc: 0.551 Test Loss: 1.013 Test Acc: 0.551
Validation loss decreased (-0.463757 --> -0.550715).  Saving model ...
Epoch: 6 cost time: 1.1346983909606934
Epoch: 6, Steps: 9 | Train Loss: 0.851 Vali Loss: 0.922 Vali Acc: 0.630 Test Loss: 0.922 Test Acc: 0.630
Validation loss decreased (-0.550715 --> -0.630426).  Saving model ...
Epoch: 7 cost time: 1.4448652267456055
Epoch: 7, Steps: 9 | Train Loss: 0.682 Vali Loss: 0.817 Vali Acc: 0.616 Test Loss: 0.817 Test Acc: 0.616
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.118300437927246
Epoch: 8, Steps: 9 | Train Loss: 0.515 Vali Loss: 0.708 Vali Acc: 0.667 Test Loss: 0.708 Test Acc: 0.667
Validation loss decreased (-0.630426 --> -0.666660).  Saving model ...
Epoch: 9 cost time: 1.2439968585968018
Epoch: 9, Steps: 9 | Train Loss: 0.391 Vali Loss: 0.623 Vali Acc: 0.696 Test Loss: 0.623 Test Acc: 0.696
Validation loss decreased (-0.666660 --> -0.695646).  Saving model ...
Epoch: 10 cost time: 1.019883632659912
Epoch: 10, Steps: 9 | Train Loss: 0.250 Vali Loss: 0.545 Vali Acc: 0.790 Test Loss: 0.545 Test Acc: 0.790
Validation loss decreased (-0.695646 --> -0.789850).  Saving model ...
Epoch: 11 cost time: 1.330416202545166
Epoch: 11, Steps: 9 | Train Loss: 0.215 Vali Loss: 0.604 Vali Acc: 0.804 Test Loss: 0.604 Test Acc: 0.804
Validation loss decreased (-0.789850 --> -0.804342).  Saving model ...
Epoch: 12 cost time: 1.0324454307556152
Epoch: 12, Steps: 9 | Train Loss: 0.130 Vali Loss: 0.586 Vali Acc: 0.826 Test Loss: 0.586 Test Acc: 0.826
Validation loss decreased (-0.804342 --> -0.826081).  Saving model ...
Epoch: 13 cost time: 1.1155667304992676
Epoch: 13, Steps: 9 | Train Loss: 0.089 Vali Loss: 0.633 Vali Acc: 0.790 Test Loss: 0.633 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1807892322540283
Epoch: 14, Steps: 9 | Train Loss: 0.069 Vali Loss: 0.715 Vali Acc: 0.790 Test Loss: 0.715 Test Acc: 0.790
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.2720074653625488
Epoch: 15, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.607 Vali Acc: 0.783 Test Loss: 0.607 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.0856084823608398
Epoch: 16, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.653 Vali Acc: 0.812 Test Loss: 0.653 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.0218079090118408
Epoch: 17, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.748 Vali Acc: 0.804 Test Loss: 0.748 Test Acc: 0.804
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.3209607601165771
Epoch: 18, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.680 Vali Acc: 0.804 Test Loss: 0.680 Test Acc: 0.804
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.3911464214324951
Epoch: 19, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.620 Vali Acc: 0.841 Test Loss: 0.620 Test Acc: 0.841
Validation loss decreased (-0.826081 --> -0.840574).  Saving model ...
Epoch: 20 cost time: 1.219639539718628
Epoch: 20, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.720 Vali Acc: 0.841 Test Loss: 0.720 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.2740144729614258
Epoch: 21, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.729 Vali Acc: 0.833 Test Loss: 0.729 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.468583345413208
Epoch: 22, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.727 Vali Acc: 0.841 Test Loss: 0.727 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.3426997661590576
Epoch: 23, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.685 Vali Acc: 0.848 Test Loss: 0.685 Test Acc: 0.848
Validation loss decreased (-0.840574 --> -0.847819).  Saving model ...
Epoch: 24 cost time: 1.0210916996002197
Epoch: 24, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.716 Vali Acc: 0.855 Test Loss: 0.716 Test Acc: 0.855
Validation loss decreased (-0.847819 --> -0.855065).  Saving model ...
Epoch: 25 cost time: 1.3025703430175781
Epoch: 25, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.746 Vali Acc: 0.848 Test Loss: 0.746 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.5151762962341309
Epoch: 26, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.746 Vali Acc: 0.855 Test Loss: 0.746 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.2061398029327393
Epoch: 27, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.787 Vali Acc: 0.826 Test Loss: 0.787 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.0071990489959717
Epoch: 28, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.769 Vali Acc: 0.841 Test Loss: 0.769 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.476940631866455
Epoch: 29, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.760 Vali Acc: 0.870 Test Loss: 0.760 Test Acc: 0.870
Validation loss decreased (-0.855065 --> -0.869558).  Saving model ...
Epoch: 30 cost time: 1.171818733215332
Epoch: 30, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.800 Vali Acc: 0.855 Test Loss: 0.800 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.1316957473754883
Epoch: 31, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.850 Vali Acc: 0.848 Test Loss: 0.850 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.0339908599853516
Epoch: 32, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.830 Vali Acc: 0.862 Test Loss: 0.830 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.1903893947601318
Epoch: 33, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.807 Vali Acc: 0.862 Test Loss: 0.807 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.1569364070892334
Epoch: 34, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.800 Vali Acc: 0.855 Test Loss: 0.800 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.0593843460083008
Epoch: 35, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.781 Vali Acc: 0.862 Test Loss: 0.781 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.918637752532959
Epoch: 36, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.800 Vali Acc: 0.862 Test Loss: 0.800 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.2306673526763916
Epoch: 37, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.804 Vali Acc: 0.848 Test Loss: 0.804 Test Acc: 0.848
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.2486722469329834
Epoch: 38, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.780 Vali Acc: 0.855 Test Loss: 0.780 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.1649012565612793
Epoch: 39, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.770 Vali Acc: 0.870 Test Loss: 0.770 Test Acc: 0.870
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el4_dm768_df768_ps30_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8695652173913043
model parameter : 29465092
model size : 127.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el4_dm768_df768_ps30_str30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.527045965194702
Epoch: 1, Steps: 9 | Train Loss: 1.412 Vali Loss: 1.374 Vali Acc: 0.341 Test Loss: 1.374 Test Acc: 0.341
Validation loss decreased (inf --> -0.340566).  Saving model ...
Epoch: 2 cost time: 0.9426345825195312
Epoch: 2, Steps: 9 | Train Loss: 1.343 Vali Loss: 1.322 Vali Acc: 0.355 Test Loss: 1.322 Test Acc: 0.355
Validation loss decreased (-0.340566 --> -0.355059).  Saving model ...
Epoch: 3 cost time: 0.9645874500274658
Epoch: 3, Steps: 9 | Train Loss: 1.262 Vali Loss: 1.258 Vali Acc: 0.341 Test Loss: 1.258 Test Acc: 0.341
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9084148406982422
Epoch: 4, Steps: 9 | Train Loss: 1.166 Vali Loss: 1.168 Vali Acc: 0.616 Test Loss: 1.168 Test Acc: 0.616
Validation loss decreased (-0.355059 --> -0.615930).  Saving model ...
Epoch: 5 cost time: 1.0801689624786377
Epoch: 5, Steps: 9 | Train Loss: 1.076 Vali Loss: 1.068 Vali Acc: 0.609 Test Loss: 1.068 Test Acc: 0.609
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9237473011016846
Epoch: 6, Steps: 9 | Train Loss: 0.946 Vali Loss: 0.969 Vali Acc: 0.601 Test Loss: 0.969 Test Acc: 0.601
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9794399738311768
Epoch: 7, Steps: 9 | Train Loss: 0.794 Vali Loss: 0.873 Vali Acc: 0.601 Test Loss: 0.873 Test Acc: 0.601
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.0261492729187012
Epoch: 8, Steps: 9 | Train Loss: 0.678 Vali Loss: 0.823 Vali Acc: 0.630 Test Loss: 0.823 Test Acc: 0.630
Validation loss decreased (-0.615930 --> -0.630427).  Saving model ...
Epoch: 9 cost time: 1.162405252456665
Epoch: 9, Steps: 9 | Train Loss: 0.572 Vali Loss: 0.767 Vali Acc: 0.652 Test Loss: 0.767 Test Acc: 0.652
Validation loss decreased (-0.630427 --> -0.652166).  Saving model ...
Epoch: 10 cost time: 1.2119057178497314
Epoch: 10, Steps: 9 | Train Loss: 0.474 Vali Loss: 0.745 Vali Acc: 0.652 Test Loss: 0.745 Test Acc: 0.652
Validation loss decreased (-0.652166 --> -0.652166).  Saving model ...
Epoch: 11 cost time: 1.246446132659912
Epoch: 11, Steps: 9 | Train Loss: 0.406 Vali Loss: 0.744 Vali Acc: 0.659 Test Loss: 0.744 Test Acc: 0.659
Validation loss decreased (-0.652166 --> -0.659413).  Saving model ...
Epoch: 12 cost time: 1.2153186798095703
Epoch: 12, Steps: 9 | Train Loss: 0.327 Vali Loss: 0.715 Vali Acc: 0.717 Test Loss: 0.715 Test Acc: 0.717
Validation loss decreased (-0.659413 --> -0.717384).  Saving model ...
Epoch: 13 cost time: 0.955815315246582
Epoch: 13, Steps: 9 | Train Loss: 0.237 Vali Loss: 0.667 Vali Acc: 0.725 Test Loss: 0.667 Test Acc: 0.725
Validation loss decreased (-0.717384 --> -0.724631).  Saving model ...
Epoch: 14 cost time: 1.0691487789154053
Epoch: 14, Steps: 9 | Train Loss: 0.174 Vali Loss: 0.686 Vali Acc: 0.732 Test Loss: 0.686 Test Acc: 0.732
Validation loss decreased (-0.724631 --> -0.731877).  Saving model ...
Epoch: 15 cost time: 1.016756296157837
Epoch: 15, Steps: 9 | Train Loss: 0.129 Vali Loss: 0.711 Vali Acc: 0.746 Test Loss: 0.711 Test Acc: 0.746
Validation loss decreased (-0.731877 --> -0.746370).  Saving model ...
Epoch: 16 cost time: 1.225557804107666
Epoch: 16, Steps: 9 | Train Loss: 0.101 Vali Loss: 0.728 Vali Acc: 0.754 Test Loss: 0.728 Test Acc: 0.754
Validation loss decreased (-0.746370 --> -0.753616).  Saving model ...
Epoch: 17 cost time: 1.1095445156097412
Epoch: 17, Steps: 9 | Train Loss: 0.079 Vali Loss: 0.677 Vali Acc: 0.775 Test Loss: 0.677 Test Acc: 0.775
Validation loss decreased (-0.753616 --> -0.775356).  Saving model ...
Epoch: 18 cost time: 1.0603702068328857
Epoch: 18, Steps: 9 | Train Loss: 0.061 Vali Loss: 0.668 Vali Acc: 0.775 Test Loss: 0.668 Test Acc: 0.775
Validation loss decreased (-0.775356 --> -0.775356).  Saving model ...
Epoch: 19 cost time: 1.1492528915405273
Epoch: 19, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.742 Vali Acc: 0.768 Test Loss: 0.742 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1684050559997559
Epoch: 20, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.717 Vali Acc: 0.790 Test Loss: 0.717 Test Acc: 0.790
Validation loss decreased (-0.775356 --> -0.789848).  Saving model ...
Epoch: 21 cost time: 1.0241007804870605
Epoch: 21, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.803 Vali Acc: 0.754 Test Loss: 0.803 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.1405465602874756
Epoch: 22, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.818 Vali Acc: 0.768 Test Loss: 0.818 Test Acc: 0.768
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.0363492965698242
Epoch: 23, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.747 Vali Acc: 0.790 Test Loss: 0.747 Test Acc: 0.790
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.8973333835601807
Epoch: 24, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.715 Vali Acc: 0.804 Test Loss: 0.715 Test Acc: 0.804
Validation loss decreased (-0.789848 --> -0.804341).  Saving model ...
Epoch: 25 cost time: 1.026681661605835
Epoch: 25, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.736 Vali Acc: 0.783 Test Loss: 0.736 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.8859715461730957
Epoch: 26, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.776 Vali Acc: 0.775 Test Loss: 0.776 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.9350385665893555
Epoch: 27, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.789 Vali Acc: 0.790 Test Loss: 0.789 Test Acc: 0.790
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.8813481330871582
Epoch: 28, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.794 Vali Acc: 0.790 Test Loss: 0.794 Test Acc: 0.790
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.8738172054290771
Epoch: 29, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.781 Vali Acc: 0.790 Test Loss: 0.781 Test Acc: 0.790
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.0127205848693848
Epoch: 30, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.765 Vali Acc: 0.790 Test Loss: 0.765 Test Acc: 0.790
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.9634778499603271
Epoch: 31, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.765 Vali Acc: 0.790 Test Loss: 0.765 Test Acc: 0.790
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.8513381481170654
Epoch: 32, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.780 Vali Acc: 0.797 Test Loss: 0.780 Test Acc: 0.797
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.0266692638397217
Epoch: 33, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.784 Vali Acc: 0.797 Test Loss: 0.784 Test Acc: 0.797
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.9971153736114502
Epoch: 34, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.787 Vali Acc: 0.804 Test Loss: 0.787 Test Acc: 0.804
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el4_dm768_df768_ps30_str30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8043478260869565
model parameter : 29437444
model size : 126.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el4_dm768_df768_ps35_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.1126177310943604
Epoch: 1, Steps: 9 | Train Loss: 1.502 Vali Loss: 1.371 Vali Acc: 0.297 Test Loss: 1.371 Test Acc: 0.297
Validation loss decreased (inf --> -0.297088).  Saving model ...
Epoch: 2 cost time: 1.7367627620697021
Epoch: 2, Steps: 9 | Train Loss: 1.294 Vali Loss: 1.249 Vali Acc: 0.370 Test Loss: 1.249 Test Acc: 0.370
Validation loss decreased (-0.297088 --> -0.369553).  Saving model ...
Epoch: 3 cost time: 1.7439968585968018
Epoch: 3, Steps: 9 | Train Loss: 1.109 Vali Loss: 1.101 Vali Acc: 0.623 Test Loss: 1.101 Test Acc: 0.623
Validation loss decreased (-0.369553 --> -0.623177).  Saving model ...
Epoch: 4 cost time: 1.609440565109253
Epoch: 4, Steps: 9 | Train Loss: 0.936 Vali Loss: 0.992 Vali Acc: 0.601 Test Loss: 0.992 Test Acc: 0.601
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.153468132019043
Epoch: 5, Steps: 9 | Train Loss: 0.779 Vali Loss: 0.853 Vali Acc: 0.688 Test Loss: 0.853 Test Acc: 0.688
Validation loss decreased (-0.623177 --> -0.688397).  Saving model ...
Epoch: 6 cost time: 1.3329579830169678
Epoch: 6, Steps: 9 | Train Loss: 0.596 Vali Loss: 0.729 Vali Acc: 0.739 Test Loss: 0.729 Test Acc: 0.739
Validation loss decreased (-0.688397 --> -0.739123).  Saving model ...
Epoch: 7 cost time: 1.1798996925354004
Epoch: 7, Steps: 9 | Train Loss: 0.482 Vali Loss: 0.681 Vali Acc: 0.703 Test Loss: 0.681 Test Acc: 0.703
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.219583511352539
Epoch: 8, Steps: 9 | Train Loss: 0.333 Vali Loss: 0.584 Vali Acc: 0.826 Test Loss: 0.584 Test Acc: 0.826
Validation loss decreased (-0.739123 --> -0.826081).  Saving model ...
Epoch: 9 cost time: 1.3925740718841553
Epoch: 9, Steps: 9 | Train Loss: 0.219 Vali Loss: 0.581 Vali Acc: 0.819 Test Loss: 0.581 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.135829210281372
Epoch: 10, Steps: 9 | Train Loss: 0.161 Vali Loss: 0.793 Vali Acc: 0.783 Test Loss: 0.793 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.311744213104248
Epoch: 11, Steps: 9 | Train Loss: 0.111 Vali Loss: 0.613 Vali Acc: 0.812 Test Loss: 0.613 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.4463062286376953
Epoch: 12, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.757 Vali Acc: 0.797 Test Loss: 0.757 Test Acc: 0.797
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.3434898853302002
Epoch: 13, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.826 Vali Acc: 0.790 Test Loss: 0.826 Test Acc: 0.790
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.3740348815917969
Epoch: 14, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.645 Vali Acc: 0.833 Test Loss: 0.645 Test Acc: 0.833
Validation loss decreased (-0.826081 --> -0.833327).  Saving model ...
Epoch: 15 cost time: 1.140476942062378
Epoch: 15, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.953 Vali Acc: 0.797 Test Loss: 0.953 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.281651258468628
Epoch: 16, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.737 Vali Acc: 0.848 Test Loss: 0.737 Test Acc: 0.848
Validation loss decreased (-0.833327 --> -0.847819).  Saving model ...
Epoch: 17 cost time: 0.9576990604400635
Epoch: 17, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.881 Vali Acc: 0.812 Test Loss: 0.881 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9980506896972656
Epoch: 18, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.820 Vali Acc: 0.848 Test Loss: 0.820 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.047074794769287
Epoch: 19, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.887 Vali Acc: 0.841 Test Loss: 0.887 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.0402424335479736
Epoch: 20, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.940 Vali Acc: 0.833 Test Loss: 0.940 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.6876931190490723
Epoch: 21, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.897 Vali Acc: 0.841 Test Loss: 0.897 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.1964259147644043
Epoch: 22, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.881 Vali Acc: 0.848 Test Loss: 0.881 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.4994735717773438
Epoch: 23, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.913 Vali Acc: 0.841 Test Loss: 0.913 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.3156790733337402
Epoch: 24, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.925 Vali Acc: 0.841 Test Loss: 0.925 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.1473069190979004
Epoch: 25, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.919 Vali Acc: 0.833 Test Loss: 0.919 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.1540601253509521
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.143 Vali Acc: 0.819 Test Loss: 1.143 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el4_dm768_df768_ps35_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8478260869565217
model parameter : 29536516
model size : 127.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el4_dm768_df768_ps35_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.8634917736053467
Epoch: 1, Steps: 9 | Train Loss: 1.463 Vali Loss: 1.383 Vali Acc: 0.297 Test Loss: 1.383 Test Acc: 0.297
Validation loss decreased (inf --> -0.297088).  Saving model ...
Epoch: 2 cost time: 0.8311834335327148
Epoch: 2, Steps: 9 | Train Loss: 1.346 Vali Loss: 1.283 Vali Acc: 0.413 Test Loss: 1.283 Test Acc: 0.413
Validation loss decreased (-0.297088 --> -0.413031).  Saving model ...
Epoch: 3 cost time: 1.0251402854919434
Epoch: 3, Steps: 9 | Train Loss: 1.226 Vali Loss: 1.173 Vali Acc: 0.587 Test Loss: 1.173 Test Acc: 0.587
Validation loss decreased (-0.413031 --> -0.586945).  Saving model ...
Epoch: 4 cost time: 0.8265130519866943
Epoch: 4, Steps: 9 | Train Loss: 1.116 Vali Loss: 1.068 Vali Acc: 0.565 Test Loss: 1.068 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8204741477966309
Epoch: 5, Steps: 9 | Train Loss: 0.959 Vali Loss: 0.963 Vali Acc: 0.623 Test Loss: 0.963 Test Acc: 0.623
Validation loss decreased (-0.586945 --> -0.623179).  Saving model ...
Epoch: 6 cost time: 0.9051156044006348
Epoch: 6, Steps: 9 | Train Loss: 0.804 Vali Loss: 0.866 Vali Acc: 0.688 Test Loss: 0.866 Test Acc: 0.688
Validation loss decreased (-0.623179 --> -0.688397).  Saving model ...
Epoch: 7 cost time: 0.9490628242492676
Epoch: 7, Steps: 9 | Train Loss: 0.681 Vali Loss: 0.792 Vali Acc: 0.696 Test Loss: 0.792 Test Acc: 0.696
Validation loss decreased (-0.688397 --> -0.695644).  Saving model ...
Epoch: 8 cost time: 0.8686120510101318
Epoch: 8, Steps: 9 | Train Loss: 0.563 Vali Loss: 0.739 Vali Acc: 0.696 Test Loss: 0.739 Test Acc: 0.696
Validation loss decreased (-0.695644 --> -0.695645).  Saving model ...
Epoch: 9 cost time: 1.0562982559204102
Epoch: 9, Steps: 9 | Train Loss: 0.434 Vali Loss: 0.728 Vali Acc: 0.725 Test Loss: 0.728 Test Acc: 0.725
Validation loss decreased (-0.695645 --> -0.724630).  Saving model ...
Epoch: 10 cost time: 0.9933567047119141
Epoch: 10, Steps: 9 | Train Loss: 0.321 Vali Loss: 0.632 Vali Acc: 0.761 Test Loss: 0.632 Test Acc: 0.761
Validation loss decreased (-0.724630 --> -0.760863).  Saving model ...
Epoch: 11 cost time: 0.7750296592712402
Epoch: 11, Steps: 9 | Train Loss: 0.258 Vali Loss: 0.610 Vali Acc: 0.775 Test Loss: 0.610 Test Acc: 0.775
Validation loss decreased (-0.760863 --> -0.775356).  Saving model ...
Epoch: 12 cost time: 0.709503173828125
Epoch: 12, Steps: 9 | Train Loss: 0.166 Vali Loss: 0.740 Vali Acc: 0.761 Test Loss: 0.740 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9160912036895752
Epoch: 13, Steps: 9 | Train Loss: 0.099 Vali Loss: 0.729 Vali Acc: 0.790 Test Loss: 0.729 Test Acc: 0.790
Validation loss decreased (-0.775356 --> -0.789848).  Saving model ...
Epoch: 14 cost time: 0.9927093982696533
Epoch: 14, Steps: 9 | Train Loss: 0.069 Vali Loss: 0.707 Vali Acc: 0.768 Test Loss: 0.707 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0059456825256348
Epoch: 15, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.867 Vali Acc: 0.761 Test Loss: 0.867 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9235880374908447
Epoch: 16, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.782 Vali Acc: 0.797 Test Loss: 0.782 Test Acc: 0.797
Validation loss decreased (-0.789848 --> -0.797094).  Saving model ...
Epoch: 17 cost time: 0.9579718112945557
Epoch: 17, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.855 Vali Acc: 0.761 Test Loss: 0.855 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8700473308563232
Epoch: 18, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.851 Vali Acc: 0.754 Test Loss: 0.851 Test Acc: 0.754
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.0025053024291992
Epoch: 19, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.853 Vali Acc: 0.797 Test Loss: 0.853 Test Acc: 0.797
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.7630672454833984
Epoch: 20, Steps: 9 | Train Loss: 0.011 Vali Loss: 1.004 Vali Acc: 0.761 Test Loss: 1.004 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.0830862522125244
Epoch: 21, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.913 Vali Acc: 0.775 Test Loss: 0.913 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.3982441425323486
Epoch: 22, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.840 Vali Acc: 0.804 Test Loss: 0.840 Test Acc: 0.804
Validation loss decreased (-0.797094 --> -0.804339).  Saving model ...
Epoch: 23 cost time: 1.0138497352600098
Epoch: 23, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.917 Vali Acc: 0.797 Test Loss: 0.917 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.0955333709716797
Epoch: 24, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.940 Vali Acc: 0.804 Test Loss: 0.940 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.0124070644378662
Epoch: 25, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.946 Vali Acc: 0.790 Test Loss: 0.946 Test Acc: 0.790
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.177213430404663
Epoch: 26, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.947 Vali Acc: 0.797 Test Loss: 0.947 Test Acc: 0.797
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.9163734912872314
Epoch: 27, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.979 Vali Acc: 0.790 Test Loss: 0.979 Test Acc: 0.790
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.1732425689697266
Epoch: 28, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.991 Vali Acc: 0.797 Test Loss: 0.991 Test Acc: 0.797
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.8129603862762451
Epoch: 29, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.988 Vali Acc: 0.797 Test Loss: 0.988 Test Acc: 0.797
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.8930423259735107
Epoch: 30, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.965 Vali Acc: 0.797 Test Loss: 0.965 Test Acc: 0.797
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.8907966613769531
Epoch: 31, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.981 Vali Acc: 0.790 Test Loss: 0.981 Test Acc: 0.790
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.9966628551483154
Epoch: 32, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.030 Vali Acc: 0.790 Test Loss: 1.030 Test Acc: 0.790
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el4_dm768_df768_ps35_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8043478260869565
model parameter : 29490436
model size : 127.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el4_dm768_df768_ps35_str35_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.9340641498565674
Epoch: 1, Steps: 9 | Train Loss: 1.451 Vali Loss: 1.424 Vali Acc: 0.283 Test Loss: 1.424 Test Acc: 0.283
Validation loss decreased (inf --> -0.282594).  Saving model ...
Epoch: 2 cost time: 0.7048461437225342
Epoch: 2, Steps: 9 | Train Loss: 1.361 Vali Loss: 1.340 Vali Acc: 0.326 Test Loss: 1.340 Test Acc: 0.326
Validation loss decreased (-0.282594 --> -0.326074).  Saving model ...
Epoch: 3 cost time: 1.027897834777832
Epoch: 3, Steps: 9 | Train Loss: 1.238 Vali Loss: 1.262 Vali Acc: 0.449 Test Loss: 1.262 Test Acc: 0.449
Validation loss decreased (-0.326074 --> -0.449263).  Saving model ...
Epoch: 4 cost time: 0.8866689205169678
Epoch: 4, Steps: 9 | Train Loss: 1.177 Vali Loss: 1.174 Vali Acc: 0.500 Test Loss: 1.174 Test Acc: 0.500
Validation loss decreased (-0.449263 --> -0.499988).  Saving model ...
Epoch: 5 cost time: 0.9765608310699463
Epoch: 5, Steps: 9 | Train Loss: 1.054 Vali Loss: 1.081 Vali Acc: 0.587 Test Loss: 1.081 Test Acc: 0.587
Validation loss decreased (-0.499988 --> -0.586946).  Saving model ...
Epoch: 6 cost time: 1.143789529800415
Epoch: 6, Steps: 9 | Train Loss: 0.945 Vali Loss: 0.977 Vali Acc: 0.587 Test Loss: 0.977 Test Acc: 0.587
Validation loss decreased (-0.586946 --> -0.586947).  Saving model ...
Epoch: 7 cost time: 0.9414443969726562
Epoch: 7, Steps: 9 | Train Loss: 0.806 Vali Loss: 0.875 Vali Acc: 0.623 Test Loss: 0.875 Test Acc: 0.623
Validation loss decreased (-0.586947 --> -0.623180).  Saving model ...
Epoch: 8 cost time: 0.7987716197967529
Epoch: 8, Steps: 9 | Train Loss: 0.686 Vali Loss: 0.822 Vali Acc: 0.652 Test Loss: 0.822 Test Acc: 0.652
Validation loss decreased (-0.623180 --> -0.652166).  Saving model ...
Epoch: 9 cost time: 0.8970086574554443
Epoch: 9, Steps: 9 | Train Loss: 0.626 Vali Loss: 0.764 Vali Acc: 0.652 Test Loss: 0.764 Test Acc: 0.652
Validation loss decreased (-0.652166 --> -0.652166).  Saving model ...
Epoch: 10 cost time: 1.0096654891967773
Epoch: 10, Steps: 9 | Train Loss: 0.490 Vali Loss: 0.722 Vali Acc: 0.667 Test Loss: 0.722 Test Acc: 0.667
Validation loss decreased (-0.652166 --> -0.666659).  Saving model ...
Epoch: 11 cost time: 0.780303955078125
Epoch: 11, Steps: 9 | Train Loss: 0.391 Vali Loss: 0.711 Vali Acc: 0.688 Test Loss: 0.711 Test Acc: 0.688
Validation loss decreased (-0.666659 --> -0.688399).  Saving model ...
Epoch: 12 cost time: 0.9525599479675293
Epoch: 12, Steps: 9 | Train Loss: 0.292 Vali Loss: 0.672 Vali Acc: 0.710 Test Loss: 0.672 Test Acc: 0.710
Validation loss decreased (-0.688399 --> -0.710138).  Saving model ...
Epoch: 13 cost time: 1.0475404262542725
Epoch: 13, Steps: 9 | Train Loss: 0.217 Vali Loss: 0.647 Vali Acc: 0.717 Test Loss: 0.647 Test Acc: 0.717
Validation loss decreased (-0.710138 --> -0.717385).  Saving model ...
Epoch: 14 cost time: 1.1036524772644043
Epoch: 14, Steps: 9 | Train Loss: 0.176 Vali Loss: 0.736 Vali Acc: 0.754 Test Loss: 0.736 Test Acc: 0.754
Validation loss decreased (-0.717385 --> -0.753616).  Saving model ...
Epoch: 15 cost time: 1.1686267852783203
Epoch: 15, Steps: 9 | Train Loss: 0.150 Vali Loss: 0.719 Vali Acc: 0.732 Test Loss: 0.719 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9469175338745117
Epoch: 16, Steps: 9 | Train Loss: 0.104 Vali Loss: 0.707 Vali Acc: 0.732 Test Loss: 0.707 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7708299160003662
Epoch: 17, Steps: 9 | Train Loss: 0.088 Vali Loss: 0.737 Vali Acc: 0.761 Test Loss: 0.737 Test Acc: 0.761
Validation loss decreased (-0.753616 --> -0.760862).  Saving model ...
Epoch: 18 cost time: 0.9361560344696045
Epoch: 18, Steps: 9 | Train Loss: 0.067 Vali Loss: 0.814 Vali Acc: 0.746 Test Loss: 0.814 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9978265762329102
Epoch: 19, Steps: 9 | Train Loss: 0.048 Vali Loss: 0.817 Vali Acc: 0.768 Test Loss: 0.817 Test Acc: 0.768
Validation loss decreased (-0.760862 --> -0.768108).  Saving model ...
Epoch: 20 cost time: 0.9505472183227539
Epoch: 20, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.870 Vali Acc: 0.775 Test Loss: 0.870 Test Acc: 0.775
Validation loss decreased (-0.768108 --> -0.775354).  Saving model ...
Epoch: 21 cost time: 1.1495020389556885
Epoch: 21, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.778 Vali Acc: 0.775 Test Loss: 0.778 Test Acc: 0.775
Validation loss decreased (-0.775354 --> -0.775355).  Saving model ...
Epoch: 22 cost time: 0.9694328308105469
Epoch: 22, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.848 Vali Acc: 0.768 Test Loss: 0.848 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7903013229370117
Epoch: 23, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.876 Vali Acc: 0.768 Test Loss: 0.876 Test Acc: 0.768
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.2335090637207031
Epoch: 24, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.912 Vali Acc: 0.761 Test Loss: 0.912 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.097109079360962
Epoch: 25, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.854 Vali Acc: 0.775 Test Loss: 0.854 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.9503605365753174
Epoch: 26, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.891 Vali Acc: 0.768 Test Loss: 0.891 Test Acc: 0.768
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.9016544818878174
Epoch: 27, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.933 Vali Acc: 0.768 Test Loss: 0.933 Test Acc: 0.768
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.0651440620422363
Epoch: 28, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.920 Vali Acc: 0.768 Test Loss: 0.920 Test Acc: 0.768
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.022672176361084
Epoch: 29, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.928 Vali Acc: 0.768 Test Loss: 0.928 Test Acc: 0.768
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.9470031261444092
Epoch: 30, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.954 Vali Acc: 0.761 Test Loss: 0.954 Test Acc: 0.761
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.8088016510009766
Epoch: 31, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.956 Vali Acc: 0.761 Test Loss: 0.956 Test Acc: 0.761
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el4_dm768_df768_ps35_str35_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.7753623188405797
model parameter : 29467396
model size : 127.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el4_dm768_df768_ps42_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.951864242553711
Epoch: 1, Steps: 9 | Train Loss: 1.493 Vali Loss: 1.426 Vali Acc: 0.196 Test Loss: 1.426 Test Acc: 0.196
Validation loss decreased (inf --> -0.195638).  Saving model ...
Epoch: 2 cost time: 0.8938114643096924
Epoch: 2, Steps: 9 | Train Loss: 1.335 Vali Loss: 1.255 Vali Acc: 0.529 Test Loss: 1.255 Test Acc: 0.529
Validation loss decreased (-0.195638 --> -0.528973).  Saving model ...
Epoch: 3 cost time: 1.0930705070495605
Epoch: 3, Steps: 9 | Train Loss: 1.207 Vali Loss: 1.115 Vali Acc: 0.623 Test Loss: 1.115 Test Acc: 0.623
Validation loss decreased (-0.528973 --> -0.623177).  Saving model ...
Epoch: 4 cost time: 1.2290682792663574
Epoch: 4, Steps: 9 | Train Loss: 1.047 Vali Loss: 1.007 Vali Acc: 0.609 Test Loss: 1.007 Test Acc: 0.609
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0477147102355957
Epoch: 5, Steps: 9 | Train Loss: 0.885 Vali Loss: 0.863 Vali Acc: 0.696 Test Loss: 0.863 Test Acc: 0.696
Validation loss decreased (-0.623177 --> -0.695644).  Saving model ...
Epoch: 6 cost time: 1.0714454650878906
Epoch: 6, Steps: 9 | Train Loss: 0.697 Vali Loss: 0.767 Vali Acc: 0.703 Test Loss: 0.767 Test Acc: 0.703
Validation loss decreased (-0.695644 --> -0.702891).  Saving model ...
Epoch: 7 cost time: 1.3048560619354248
Epoch: 7, Steps: 9 | Train Loss: 0.533 Vali Loss: 0.686 Vali Acc: 0.775 Test Loss: 0.686 Test Acc: 0.775
Validation loss decreased (-0.702891 --> -0.775355).  Saving model ...
Epoch: 8 cost time: 1.2152175903320312
Epoch: 8, Steps: 9 | Train Loss: 0.415 Vali Loss: 0.673 Vali Acc: 0.725 Test Loss: 0.673 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.059760332107544
Epoch: 9, Steps: 9 | Train Loss: 0.295 Vali Loss: 0.649 Vali Acc: 0.804 Test Loss: 0.649 Test Acc: 0.804
Validation loss decreased (-0.775355 --> -0.804341).  Saving model ...
Epoch: 10 cost time: 0.9743943214416504
Epoch: 10, Steps: 9 | Train Loss: 0.198 Vali Loss: 0.702 Vali Acc: 0.754 Test Loss: 0.702 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1770844459533691
Epoch: 11, Steps: 9 | Train Loss: 0.113 Vali Loss: 0.638 Vali Acc: 0.812 Test Loss: 0.638 Test Acc: 0.812
Validation loss decreased (-0.804341 --> -0.811588).  Saving model ...
Epoch: 12 cost time: 1.1129961013793945
Epoch: 12, Steps: 9 | Train Loss: 0.086 Vali Loss: 0.789 Vali Acc: 0.761 Test Loss: 0.789 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9839506149291992
Epoch: 13, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.764 Vali Acc: 0.783 Test Loss: 0.764 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.8693692684173584
Epoch: 14, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.964 Vali Acc: 0.783 Test Loss: 0.964 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.0376977920532227
Epoch: 15, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.854 Vali Acc: 0.775 Test Loss: 0.854 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.9560122489929199
Epoch: 16, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.890 Vali Acc: 0.768 Test Loss: 0.890 Test Acc: 0.768
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.0441312789916992
Epoch: 17, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.874 Vali Acc: 0.768 Test Loss: 0.874 Test Acc: 0.768
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.9065568447113037
Epoch: 18, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.989 Vali Acc: 0.797 Test Loss: 0.989 Test Acc: 0.797
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.9220855236053467
Epoch: 19, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.864 Vali Acc: 0.812 Test Loss: 0.864 Test Acc: 0.812
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.8895823955535889
Epoch: 20, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.930 Vali Acc: 0.783 Test Loss: 0.930 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.0251150131225586
Epoch: 21, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.916 Vali Acc: 0.797 Test Loss: 0.916 Test Acc: 0.797
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el4_dm768_df768_ps42_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8115942028985508
model parameter : 29561860
model size : 127.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el4_dm768_df768_ps42_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.768156051635742
Epoch: 1, Steps: 9 | Train Loss: 1.390 Vali Loss: 1.338 Vali Acc: 0.355 Test Loss: 1.338 Test Acc: 0.355
Validation loss decreased (inf --> -0.355059).  Saving model ...
Epoch: 2 cost time: 0.7841975688934326
Epoch: 2, Steps: 9 | Train Loss: 1.313 Vali Loss: 1.258 Vali Acc: 0.442 Test Loss: 1.258 Test Acc: 0.442
Validation loss decreased (-0.355059 --> -0.442016).  Saving model ...
Epoch: 3 cost time: 0.7820653915405273
Epoch: 3, Steps: 9 | Train Loss: 1.176 Vali Loss: 1.165 Vali Acc: 0.572 Test Loss: 1.165 Test Acc: 0.572
Validation loss decreased (-0.442016 --> -0.572452).  Saving model ...
Epoch: 4 cost time: 0.8940706253051758
Epoch: 4, Steps: 9 | Train Loss: 1.065 Vali Loss: 1.048 Vali Acc: 0.674 Test Loss: 1.048 Test Acc: 0.674
Validation loss decreased (-0.572452 --> -0.673903).  Saving model ...
Epoch: 5 cost time: 0.8897597789764404
Epoch: 5, Steps: 9 | Train Loss: 0.918 Vali Loss: 0.917 Vali Acc: 0.696 Test Loss: 0.917 Test Acc: 0.696
Validation loss decreased (-0.673903 --> -0.695643).  Saving model ...
Epoch: 6 cost time: 0.9556381702423096
Epoch: 6, Steps: 9 | Train Loss: 0.795 Vali Loss: 0.815 Vali Acc: 0.703 Test Loss: 0.815 Test Acc: 0.703
Validation loss decreased (-0.695643 --> -0.702890).  Saving model ...
Epoch: 7 cost time: 1.1632933616638184
Epoch: 7, Steps: 9 | Train Loss: 0.634 Vali Loss: 0.699 Vali Acc: 0.761 Test Loss: 0.699 Test Acc: 0.761
Validation loss decreased (-0.702890 --> -0.760863).  Saving model ...
Epoch: 8 cost time: 1.1159653663635254
Epoch: 8, Steps: 9 | Train Loss: 0.509 Vali Loss: 0.697 Vali Acc: 0.725 Test Loss: 0.697 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8792483806610107
Epoch: 9, Steps: 9 | Train Loss: 0.392 Vali Loss: 0.602 Vali Acc: 0.790 Test Loss: 0.602 Test Acc: 0.790
Validation loss decreased (-0.760863 --> -0.789849).  Saving model ...
Epoch: 10 cost time: 0.7910501956939697
Epoch: 10, Steps: 9 | Train Loss: 0.283 Vali Loss: 0.611 Vali Acc: 0.804 Test Loss: 0.611 Test Acc: 0.804
Validation loss decreased (-0.789849 --> -0.804342).  Saving model ...
Epoch: 11 cost time: 0.8121399879455566
Epoch: 11, Steps: 9 | Train Loss: 0.227 Vali Loss: 0.566 Vali Acc: 0.797 Test Loss: 0.566 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9024584293365479
Epoch: 12, Steps: 9 | Train Loss: 0.153 Vali Loss: 0.653 Vali Acc: 0.804 Test Loss: 0.653 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.8903768062591553
Epoch: 13, Steps: 9 | Train Loss: 0.121 Vali Loss: 0.598 Vali Acc: 0.797 Test Loss: 0.598 Test Acc: 0.797
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.9501128196716309
Epoch: 14, Steps: 9 | Train Loss: 0.088 Vali Loss: 0.610 Vali Acc: 0.797 Test Loss: 0.610 Test Acc: 0.797
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.718102216720581
Epoch: 15, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.627 Vali Acc: 0.797 Test Loss: 0.627 Test Acc: 0.797
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.7891523838043213
Epoch: 16, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.696 Vali Acc: 0.804 Test Loss: 0.696 Test Acc: 0.804
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.0170586109161377
Epoch: 17, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.708 Vali Acc: 0.797 Test Loss: 0.708 Test Acc: 0.797
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.0913314819335938
Epoch: 18, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.755 Vali Acc: 0.804 Test Loss: 0.755 Test Acc: 0.804
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.83717942237854
Epoch: 19, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.735 Vali Acc: 0.819 Test Loss: 0.735 Test Acc: 0.819
Validation loss decreased (-0.804342 --> -0.818833).  Saving model ...
Epoch: 20 cost time: 0.8688533306121826
Epoch: 20, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.745 Vali Acc: 0.826 Test Loss: 0.745 Test Acc: 0.826
Validation loss decreased (-0.818833 --> -0.826080).  Saving model ...
Epoch: 21 cost time: 0.9685018062591553
Epoch: 21, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.728 Vali Acc: 0.790 Test Loss: 0.728 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.910078763961792
Epoch: 22, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.819 Vali Acc: 0.797 Test Loss: 0.819 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.2264792919158936
Epoch: 23, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.751 Vali Acc: 0.812 Test Loss: 0.751 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.0101919174194336
Epoch: 24, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.742 Vali Acc: 0.804 Test Loss: 0.742 Test Acc: 0.804
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.9855430126190186
Epoch: 25, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.772 Vali Acc: 0.812 Test Loss: 0.772 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.9732275009155273
Epoch: 26, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.783 Vali Acc: 0.804 Test Loss: 0.783 Test Acc: 0.804
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.9142401218414307
Epoch: 27, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.789 Vali Acc: 0.804 Test Loss: 0.789 Test Acc: 0.804
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.2936394214630127
Epoch: 28, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.815 Vali Acc: 0.812 Test Loss: 0.815 Test Acc: 0.812
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.9435913562774658
Epoch: 29, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.845 Vali Acc: 0.812 Test Loss: 0.845 Test Acc: 0.812
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.0473873615264893
Epoch: 30, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.846 Vali Acc: 0.812 Test Loss: 0.846 Test Acc: 0.812
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el4_dm768_df768_ps42_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8260869565217391
model parameter : 29529604
model size : 127.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el4_dm768_df768_ps42_str42_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.847808599472046
Epoch: 1, Steps: 9 | Train Loss: 1.468 Vali Loss: 1.430 Vali Acc: 0.196 Test Loss: 1.430 Test Acc: 0.196
Validation loss decreased (inf --> -0.195638).  Saving model ...
Epoch: 2 cost time: 0.7752225399017334
Epoch: 2, Steps: 9 | Train Loss: 1.381 Vali Loss: 1.333 Vali Acc: 0.297 Test Loss: 1.333 Test Acc: 0.297
Validation loss decreased (-0.195638 --> -0.297088).  Saving model ...
Epoch: 3 cost time: 0.7114949226379395
Epoch: 3, Steps: 9 | Train Loss: 1.289 Vali Loss: 1.229 Vali Acc: 0.399 Test Loss: 1.229 Test Acc: 0.399
Validation loss decreased (-0.297088 --> -0.398538).  Saving model ...
Epoch: 4 cost time: 0.8669140338897705
Epoch: 4, Steps: 9 | Train Loss: 1.198 Vali Loss: 1.150 Vali Acc: 0.428 Test Loss: 1.150 Test Acc: 0.428
Validation loss decreased (-0.398538 --> -0.427525).  Saving model ...
Epoch: 5 cost time: 0.8580994606018066
Epoch: 5, Steps: 9 | Train Loss: 1.090 Vali Loss: 1.071 Vali Acc: 0.507 Test Loss: 1.071 Test Acc: 0.507
Validation loss decreased (-0.427525 --> -0.507236).  Saving model ...
Epoch: 6 cost time: 0.7991864681243896
Epoch: 6, Steps: 9 | Train Loss: 1.008 Vali Loss: 1.004 Vali Acc: 0.529 Test Loss: 1.004 Test Acc: 0.529
Validation loss decreased (-0.507236 --> -0.528975).  Saving model ...
Epoch: 7 cost time: 1.0387909412384033
Epoch: 7, Steps: 9 | Train Loss: 0.880 Vali Loss: 0.964 Vali Acc: 0.572 Test Loss: 0.964 Test Acc: 0.572
Validation loss decreased (-0.528975 --> -0.572454).  Saving model ...
Epoch: 8 cost time: 0.9884626865386963
Epoch: 8, Steps: 9 | Train Loss: 0.724 Vali Loss: 0.916 Vali Acc: 0.594 Test Loss: 0.916 Test Acc: 0.594
Validation loss decreased (-0.572454 --> -0.594194).  Saving model ...
Epoch: 9 cost time: 0.8984007835388184
Epoch: 9, Steps: 9 | Train Loss: 0.601 Vali Loss: 0.876 Vali Acc: 0.659 Test Loss: 0.876 Test Acc: 0.659
Validation loss decreased (-0.594194 --> -0.659412).  Saving model ...
Epoch: 10 cost time: 0.9626755714416504
Epoch: 10, Steps: 9 | Train Loss: 0.514 Vali Loss: 0.800 Vali Acc: 0.732 Test Loss: 0.800 Test Acc: 0.732
Validation loss decreased (-0.659412 --> -0.731876).  Saving model ...
Epoch: 11 cost time: 0.9760067462921143
Epoch: 11, Steps: 9 | Train Loss: 0.418 Vali Loss: 0.777 Vali Acc: 0.674 Test Loss: 0.777 Test Acc: 0.674
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7971644401550293
Epoch: 12, Steps: 9 | Train Loss: 0.336 Vali Loss: 0.690 Vali Acc: 0.703 Test Loss: 0.690 Test Acc: 0.703
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9659342765808105
Epoch: 13, Steps: 9 | Train Loss: 0.225 Vali Loss: 0.733 Vali Acc: 0.746 Test Loss: 0.733 Test Acc: 0.746
Validation loss decreased (-0.731876 --> -0.746369).  Saving model ...
Epoch: 14 cost time: 1.0672850608825684
Epoch: 14, Steps: 9 | Train Loss: 0.155 Vali Loss: 0.723 Vali Acc: 0.746 Test Loss: 0.723 Test Acc: 0.746
Validation loss decreased (-0.746369 --> -0.746370).  Saving model ...
Epoch: 15 cost time: 0.8648741245269775
Epoch: 15, Steps: 9 | Train Loss: 0.132 Vali Loss: 0.783 Vali Acc: 0.739 Test Loss: 0.783 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8574604988098145
Epoch: 16, Steps: 9 | Train Loss: 0.093 Vali Loss: 0.689 Vali Acc: 0.775 Test Loss: 0.689 Test Acc: 0.775
Validation loss decreased (-0.746370 --> -0.775355).  Saving model ...
Epoch: 17 cost time: 0.880016565322876
Epoch: 17, Steps: 9 | Train Loss: 0.078 Vali Loss: 0.709 Vali Acc: 0.790 Test Loss: 0.709 Test Acc: 0.790
Validation loss decreased (-0.775355 --> -0.789848).  Saving model ...
Epoch: 18 cost time: 0.9182941913604736
Epoch: 18, Steps: 9 | Train Loss: 0.047 Vali Loss: 0.751 Vali Acc: 0.761 Test Loss: 0.751 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8159177303314209
Epoch: 19, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.751 Vali Acc: 0.761 Test Loss: 0.751 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9444119930267334
Epoch: 20, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.774 Vali Acc: 0.783 Test Loss: 0.774 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.90321946144104
Epoch: 21, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.814 Vali Acc: 0.768 Test Loss: 0.814 Test Acc: 0.768
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.7553386688232422
Epoch: 22, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.817 Vali Acc: 0.790 Test Loss: 0.817 Test Acc: 0.790
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.7104675769805908
Epoch: 23, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.845 Vali Acc: 0.790 Test Loss: 0.845 Test Acc: 0.790
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.9896337985992432
Epoch: 24, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.839 Vali Acc: 0.790 Test Loss: 0.839 Test Acc: 0.790
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.0423362255096436
Epoch: 25, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.804 Vali Acc: 0.797 Test Loss: 0.804 Test Acc: 0.797
Validation loss decreased (-0.789848 --> -0.797093).  Saving model ...
Epoch: 26 cost time: 0.9273180961608887
Epoch: 26, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.828 Vali Acc: 0.797 Test Loss: 0.828 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.0583884716033936
Epoch: 27, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.882 Vali Acc: 0.790 Test Loss: 0.882 Test Acc: 0.790
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.8603177070617676
Epoch: 28, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.901 Vali Acc: 0.790 Test Loss: 0.901 Test Acc: 0.790
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.0642173290252686
Epoch: 29, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.890 Vali Acc: 0.797 Test Loss: 0.890 Test Acc: 0.797
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.9514596462249756
Epoch: 30, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.885 Vali Acc: 0.797 Test Loss: 0.885 Test Acc: 0.797
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.0075230598449707
Epoch: 31, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.909 Vali Acc: 0.790 Test Loss: 0.909 Test Acc: 0.790
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.9747178554534912
Epoch: 32, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.916 Vali Acc: 0.790 Test Loss: 0.916 Test Acc: 0.790
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.9953653812408447
Epoch: 33, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.916 Vali Acc: 0.790 Test Loss: 0.916 Test Acc: 0.790
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.0681226253509521
Epoch: 34, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.933 Vali Acc: 0.790 Test Loss: 0.933 Test Acc: 0.790
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.9887754917144775
Epoch: 35, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.934 Vali Acc: 0.790 Test Loss: 0.934 Test Acc: 0.790
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el4_dm768_df768_ps42_str42_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.7971014492753623
model parameter : 29511172
model size : 127.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el3_dm768_df768_ps9_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.841705560684204
Epoch: 1, Steps: 9 | Train Loss: 1.460 Vali Loss: 1.283 Vali Acc: 0.370 Test Loss: 1.283 Test Acc: 0.370
Validation loss decreased (inf --> -0.369552).  Saving model ...
Epoch: 2 cost time: 1.4885203838348389
Epoch: 2, Steps: 9 | Train Loss: 1.181 Vali Loss: 1.025 Vali Acc: 0.667 Test Loss: 1.025 Test Acc: 0.667
Validation loss decreased (-0.369552 --> -0.666656).  Saving model ...
Epoch: 3 cost time: 1.3069489002227783
Epoch: 3, Steps: 9 | Train Loss: 0.903 Vali Loss: 0.897 Vali Acc: 0.580 Test Loss: 0.897 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4002354145050049
Epoch: 4, Steps: 9 | Train Loss: 0.619 Vali Loss: 0.783 Vali Acc: 0.652 Test Loss: 0.783 Test Acc: 0.652
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.3378973007202148
Epoch: 5, Steps: 9 | Train Loss: 0.476 Vali Loss: 0.704 Vali Acc: 0.696 Test Loss: 0.704 Test Acc: 0.696
Validation loss decreased (-0.666656 --> -0.695645).  Saving model ...
Epoch: 6 cost time: 1.3067893981933594
Epoch: 6, Steps: 9 | Train Loss: 0.308 Vali Loss: 0.946 Vali Acc: 0.580 Test Loss: 0.946 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1983563899993896
Epoch: 7, Steps: 9 | Train Loss: 0.314 Vali Loss: 0.593 Vali Acc: 0.703 Test Loss: 0.593 Test Acc: 0.703
Validation loss decreased (-0.695645 --> -0.702893).  Saving model ...
Epoch: 8 cost time: 1.35837721824646
Epoch: 8, Steps: 9 | Train Loss: 0.205 Vali Loss: 1.120 Vali Acc: 0.688 Test Loss: 1.120 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4015541076660156
Epoch: 9, Steps: 9 | Train Loss: 0.209 Vali Loss: 0.552 Vali Acc: 0.812 Test Loss: 0.552 Test Acc: 0.812
Validation loss decreased (-0.702893 --> -0.811589).  Saving model ...
Epoch: 10 cost time: 1.790123701095581
Epoch: 10, Steps: 9 | Train Loss: 0.138 Vali Loss: 0.609 Vali Acc: 0.739 Test Loss: 0.609 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1455390453338623
Epoch: 11, Steps: 9 | Train Loss: 0.069 Vali Loss: 1.041 Vali Acc: 0.754 Test Loss: 1.041 Test Acc: 0.754
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.698533296585083
Epoch: 12, Steps: 9 | Train Loss: 0.050 Vali Loss: 1.062 Vali Acc: 0.833 Test Loss: 1.062 Test Acc: 0.833
Validation loss decreased (-0.811589 --> -0.833323).  Saving model ...
Epoch: 13 cost time: 1.293360710144043
Epoch: 13, Steps: 9 | Train Loss: 0.027 Vali Loss: 1.066 Vali Acc: 0.739 Test Loss: 1.066 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3750417232513428
Epoch: 14, Steps: 9 | Train Loss: 0.035 Vali Loss: 1.051 Vali Acc: 0.833 Test Loss: 1.051 Test Acc: 0.833
Validation loss decreased (-0.833323 --> -0.833323).  Saving model ...
Epoch: 15 cost time: 1.5367941856384277
Epoch: 15, Steps: 9 | Train Loss: 0.009 Vali Loss: 1.169 Vali Acc: 0.826 Test Loss: 1.169 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.8350210189819336
Epoch: 16, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.083 Vali Acc: 0.848 Test Loss: 1.083 Test Acc: 0.848
Validation loss decreased (-0.833323 --> -0.847815).  Saving model ...
Epoch: 17 cost time: 1.4848392009735107
Epoch: 17, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.123 Vali Acc: 0.855 Test Loss: 1.123 Test Acc: 0.855
Validation loss decreased (-0.847815 --> -0.855061).  Saving model ...
Epoch: 18 cost time: 1.441194772720337
Epoch: 18, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.240 Vali Acc: 0.841 Test Loss: 1.240 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1220674514770508
Epoch: 19, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.220 Vali Acc: 0.841 Test Loss: 1.220 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.1002650260925293
Epoch: 20, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.054 Vali Acc: 0.833 Test Loss: 1.054 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.4753267765045166
Epoch: 21, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.003 Vali Acc: 0.841 Test Loss: 1.003 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.3847949504852295
Epoch: 22, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.015 Vali Acc: 0.841 Test Loss: 1.015 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.0998425483703613
Epoch: 23, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.058 Vali Acc: 0.841 Test Loss: 1.058 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.3031883239746094
Epoch: 24, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.003 Vali Acc: 0.862 Test Loss: 1.003 Test Acc: 0.862
Validation loss decreased (-0.855061 --> -0.862309).  Saving model ...
Epoch: 25 cost time: 1.3003604412078857
Epoch: 25, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.961 Vali Acc: 0.855 Test Loss: 0.961 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.9396753311157227
Epoch: 26, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.969 Vali Acc: 0.855 Test Loss: 0.969 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.223895788192749
Epoch: 27, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.011 Vali Acc: 0.855 Test Loss: 1.011 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.6137399673461914
Epoch: 28, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.054 Vali Acc: 0.862 Test Loss: 1.054 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.6314330101013184
Epoch: 29, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.067 Vali Acc: 0.848 Test Loss: 1.067 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.12007737159729
Epoch: 30, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.057 Vali Acc: 0.841 Test Loss: 1.057 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.5112075805664062
Epoch: 31, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.958 Vali Acc: 0.862 Test Loss: 0.958 Test Acc: 0.862
Validation loss decreased (-0.862309 --> -0.862309).  Saving model ...
Epoch: 32 cost time: 1.675368070602417
Epoch: 32, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.930 Vali Acc: 0.877 Test Loss: 0.930 Test Acc: 0.877
Validation loss decreased (-0.862309 --> -0.876802).  Saving model ...
Epoch: 33 cost time: 1.3094286918640137
Epoch: 33, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.943 Vali Acc: 0.862 Test Loss: 0.943 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.2195076942443848
Epoch: 34, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.959 Vali Acc: 0.855 Test Loss: 0.959 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.2687444686889648
Epoch: 35, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.983 Vali Acc: 0.855 Test Loss: 0.983 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.5194652080535889
Epoch: 36, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.998 Vali Acc: 0.855 Test Loss: 0.998 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.2508761882781982
Epoch: 37, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.013 Vali Acc: 0.855 Test Loss: 1.013 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.667342185974121
Epoch: 38, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.013 Vali Acc: 0.848 Test Loss: 1.013 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.109285593032837
Epoch: 39, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.012 Vali Acc: 0.848 Test Loss: 1.012 Test Acc: 0.848
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.443572759628296
Epoch: 40, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.019 Vali Acc: 0.848 Test Loss: 1.019 Test Acc: 0.848
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.6593060493469238
Epoch: 41, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.028 Vali Acc: 0.855 Test Loss: 1.028 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.4913239479064941
Epoch: 42, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.040 Vali Acc: 0.848 Test Loss: 1.040 Test Acc: 0.848
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el3_dm768_df768_ps9_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8768115942028986
model parameter : 22480900
model size : 100.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el3_dm768_df768_ps9_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.3573174476623535
Epoch: 1, Steps: 9 | Train Loss: 1.434 Vali Loss: 1.293 Vali Acc: 0.413 Test Loss: 1.293 Test Acc: 0.413
Validation loss decreased (inf --> -0.413031).  Saving model ...
Epoch: 2 cost time: 1.225839376449585
Epoch: 2, Steps: 9 | Train Loss: 1.217 Vali Loss: 1.104 Vali Acc: 0.601 Test Loss: 1.104 Test Acc: 0.601
Validation loss decreased (-0.413031 --> -0.601438).  Saving model ...
Epoch: 3 cost time: 1.1774728298187256
Epoch: 3, Steps: 9 | Train Loss: 0.973 Vali Loss: 0.932 Vali Acc: 0.659 Test Loss: 0.932 Test Acc: 0.659
Validation loss decreased (-0.601438 --> -0.659411).  Saving model ...
Epoch: 4 cost time: 1.15511155128479
Epoch: 4, Steps: 9 | Train Loss: 0.787 Vali Loss: 0.802 Vali Acc: 0.681 Test Loss: 0.802 Test Acc: 0.681
Validation loss decreased (-0.659411 --> -0.681151).  Saving model ...
Epoch: 5 cost time: 1.1779978275299072
Epoch: 5, Steps: 9 | Train Loss: 0.632 Vali Loss: 0.751 Vali Acc: 0.645 Test Loss: 0.751 Test Acc: 0.645
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0687177181243896
Epoch: 6, Steps: 9 | Train Loss: 0.451 Vali Loss: 0.679 Vali Acc: 0.732 Test Loss: 0.679 Test Acc: 0.732
Validation loss decreased (-0.681151 --> -0.731877).  Saving model ...
Epoch: 7 cost time: 1.1698188781738281
Epoch: 7, Steps: 9 | Train Loss: 0.357 Vali Loss: 0.764 Vali Acc: 0.667 Test Loss: 0.764 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.193910837173462
Epoch: 8, Steps: 9 | Train Loss: 0.268 Vali Loss: 0.618 Vali Acc: 0.732 Test Loss: 0.618 Test Acc: 0.732
Validation loss decreased (-0.731877 --> -0.731878).  Saving model ...
Epoch: 9 cost time: 1.1077094078063965
Epoch: 9, Steps: 9 | Train Loss: 0.195 Vali Loss: 0.730 Vali Acc: 0.797 Test Loss: 0.730 Test Acc: 0.797
Validation loss decreased (-0.731878 --> -0.797094).  Saving model ...
Epoch: 10 cost time: 1.3487343788146973
Epoch: 10, Steps: 9 | Train Loss: 0.100 Vali Loss: 0.747 Vali Acc: 0.819 Test Loss: 0.747 Test Acc: 0.819
Validation loss decreased (-0.797094 --> -0.818833).  Saving model ...
Epoch: 11 cost time: 1.0764353275299072
Epoch: 11, Steps: 9 | Train Loss: 0.065 Vali Loss: 0.964 Vali Acc: 0.696 Test Loss: 0.964 Test Acc: 0.696
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1542799472808838
Epoch: 12, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.747 Vali Acc: 0.819 Test Loss: 0.747 Test Acc: 0.819
Validation loss decreased (-0.818833 --> -0.818833).  Saving model ...
Epoch: 13 cost time: 1.3312687873840332
Epoch: 13, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.814 Vali Acc: 0.768 Test Loss: 0.814 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8395264148712158
Epoch: 14, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.735 Vali Acc: 0.826 Test Loss: 0.735 Test Acc: 0.826
Validation loss decreased (-0.818833 --> -0.826080).  Saving model ...
Epoch: 15 cost time: 1.0795347690582275
Epoch: 15, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.787 Vali Acc: 0.833 Test Loss: 0.787 Test Acc: 0.833
Validation loss decreased (-0.826080 --> -0.833325).  Saving model ...
Epoch: 16 cost time: 1.1399171352386475
Epoch: 16, Steps: 9 | Train Loss: 0.008 Vali Loss: 1.010 Vali Acc: 0.819 Test Loss: 1.010 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.122093677520752
Epoch: 17, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.650 Vali Acc: 0.877 Test Loss: 0.650 Test Acc: 0.877
Validation loss decreased (-0.833325 --> -0.876805).  Saving model ...
Epoch: 18 cost time: 1.2338078022003174
Epoch: 18, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.062 Vali Acc: 0.804 Test Loss: 1.062 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.3216617107391357
Epoch: 19, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.798 Vali Acc: 0.826 Test Loss: 0.798 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.1511857509613037
Epoch: 20, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.764 Vali Acc: 0.848 Test Loss: 0.764 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.172457218170166
Epoch: 21, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.047 Vali Acc: 0.812 Test Loss: 1.047 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.0463981628417969
Epoch: 22, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.000 Vali Acc: 0.804 Test Loss: 1.000 Test Acc: 0.804
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.1742451190948486
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.749 Vali Acc: 0.862 Test Loss: 0.749 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.1433148384094238
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.741 Vali Acc: 0.833 Test Loss: 0.741 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.9065277576446533
Epoch: 25, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.792 Vali Acc: 0.819 Test Loss: 0.792 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.2305209636688232
Epoch: 26, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.823 Vali Acc: 0.819 Test Loss: 0.823 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.1323647499084473
Epoch: 27, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.838 Vali Acc: 0.826 Test Loss: 0.838 Test Acc: 0.826
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el3_dm768_df768_ps9_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8768115942028986
model parameter : 22361092
model size : 99.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el3_dm768_df768_ps9_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.8500940799713135
Epoch: 1, Steps: 9 | Train Loss: 1.400 Vali Loss: 1.336 Vali Acc: 0.413 Test Loss: 1.336 Test Acc: 0.413
Validation loss decreased (inf --> -0.413030).  Saving model ...
Epoch: 2 cost time: 1.3539602756500244
Epoch: 2, Steps: 9 | Train Loss: 1.309 Vali Loss: 1.189 Vali Acc: 0.565 Test Loss: 1.189 Test Acc: 0.565
Validation loss decreased (-0.413030 --> -0.565206).  Saving model ...
Epoch: 3 cost time: 1.122288703918457
Epoch: 3, Steps: 9 | Train Loss: 1.123 Vali Loss: 1.058 Vali Acc: 0.652 Test Loss: 1.058 Test Acc: 0.652
Validation loss decreased (-0.565206 --> -0.652163).  Saving model ...
Epoch: 4 cost time: 1.2195587158203125
Epoch: 4, Steps: 9 | Train Loss: 0.985 Vali Loss: 0.958 Vali Acc: 0.645 Test Loss: 0.958 Test Acc: 0.645
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9105298519134521
Epoch: 5, Steps: 9 | Train Loss: 0.828 Vali Loss: 0.865 Vali Acc: 0.696 Test Loss: 0.865 Test Acc: 0.696
Validation loss decreased (-0.652163 --> -0.695644).  Saving model ...
Epoch: 6 cost time: 1.1108016967773438
Epoch: 6, Steps: 9 | Train Loss: 0.681 Vali Loss: 0.785 Vali Acc: 0.667 Test Loss: 0.785 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8743927478790283
Epoch: 7, Steps: 9 | Train Loss: 0.551 Vali Loss: 0.748 Vali Acc: 0.703 Test Loss: 0.748 Test Acc: 0.703
Validation loss decreased (-0.695644 --> -0.702891).  Saving model ...
Epoch: 8 cost time: 1.3388314247131348
Epoch: 8, Steps: 9 | Train Loss: 0.451 Vali Loss: 0.766 Vali Acc: 0.703 Test Loss: 0.766 Test Acc: 0.703
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.958916187286377
Epoch: 9, Steps: 9 | Train Loss: 0.322 Vali Loss: 0.778 Vali Acc: 0.696 Test Loss: 0.778 Test Acc: 0.696
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.484687089920044
Epoch: 10, Steps: 9 | Train Loss: 0.281 Vali Loss: 0.765 Vali Acc: 0.761 Test Loss: 0.765 Test Acc: 0.761
Validation loss decreased (-0.702891 --> -0.760862).  Saving model ...
Epoch: 11 cost time: 1.1180200576782227
Epoch: 11, Steps: 9 | Train Loss: 0.159 Vali Loss: 0.715 Vali Acc: 0.768 Test Loss: 0.715 Test Acc: 0.768
Validation loss decreased (-0.760862 --> -0.768109).  Saving model ...
Epoch: 12 cost time: 0.8653850555419922
Epoch: 12, Steps: 9 | Train Loss: 0.111 Vali Loss: 0.740 Vali Acc: 0.819 Test Loss: 0.740 Test Acc: 0.819
Validation loss decreased (-0.768109 --> -0.818833).  Saving model ...
Epoch: 13 cost time: 1.3960907459259033
Epoch: 13, Steps: 9 | Train Loss: 0.065 Vali Loss: 0.810 Vali Acc: 0.768 Test Loss: 0.810 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4489407539367676
Epoch: 14, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.840 Vali Acc: 0.812 Test Loss: 0.840 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.4877445697784424
Epoch: 15, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.720 Vali Acc: 0.812 Test Loss: 0.720 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.1873035430908203
Epoch: 16, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.889 Vali Acc: 0.804 Test Loss: 0.889 Test Acc: 0.804
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.4973597526550293
Epoch: 17, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.723 Vali Acc: 0.826 Test Loss: 0.723 Test Acc: 0.826
Validation loss decreased (-0.818833 --> -0.826080).  Saving model ...
Epoch: 18 cost time: 1.6280276775360107
Epoch: 18, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.772 Vali Acc: 0.812 Test Loss: 0.772 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.310157299041748
Epoch: 19, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.699 Vali Acc: 0.826 Test Loss: 0.699 Test Acc: 0.826
Validation loss decreased (-0.826080 --> -0.826080).  Saving model ...
Epoch: 20 cost time: 1.7757275104522705
Epoch: 20, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.740 Vali Acc: 0.826 Test Loss: 0.740 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.3485352993011475
Epoch: 21, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.839 Vali Acc: 0.812 Test Loss: 0.839 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.5400900840759277
Epoch: 22, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.864 Vali Acc: 0.819 Test Loss: 0.864 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.1396830081939697
Epoch: 23, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.761 Vali Acc: 0.812 Test Loss: 0.761 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.4947223663330078
Epoch: 24, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.769 Vali Acc: 0.826 Test Loss: 0.769 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.8939731121063232
Epoch: 25, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.806 Vali Acc: 0.812 Test Loss: 0.806 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.2296369075775146
Epoch: 26, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.810 Vali Acc: 0.812 Test Loss: 0.810 Test Acc: 0.812
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.2825226783752441
Epoch: 27, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.824 Vali Acc: 0.819 Test Loss: 0.824 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.2149531841278076
Epoch: 28, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.846 Vali Acc: 0.812 Test Loss: 0.846 Test Acc: 0.812
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.517089605331421
Epoch: 29, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.840 Vali Acc: 0.819 Test Loss: 0.840 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el3_dm768_df768_ps9_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8260869565217391
model parameter : 22278148
model size : 99.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el3_dm768_df768_ps10_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.3873958587646484
Epoch: 1, Steps: 9 | Train Loss: 1.474 Vali Loss: 1.350 Vali Acc: 0.355 Test Loss: 1.350 Test Acc: 0.355
Validation loss decreased (inf --> -0.355059).  Saving model ...
Epoch: 2 cost time: 1.883411169052124
Epoch: 2, Steps: 9 | Train Loss: 1.233 Vali Loss: 1.148 Vali Acc: 0.413 Test Loss: 1.148 Test Acc: 0.413
Validation loss decreased (-0.355059 --> -0.413032).  Saving model ...
Epoch: 3 cost time: 1.8268849849700928
Epoch: 3, Steps: 9 | Train Loss: 0.950 Vali Loss: 1.051 Vali Acc: 0.493 Test Loss: 1.051 Test Acc: 0.493
Validation loss decreased (-0.413032 --> -0.492743).  Saving model ...
Epoch: 4 cost time: 1.4089341163635254
Epoch: 4, Steps: 9 | Train Loss: 0.711 Vali Loss: 0.816 Vali Acc: 0.638 Test Loss: 0.816 Test Acc: 0.638
Validation loss decreased (-0.492743 --> -0.637673).  Saving model ...
Epoch: 5 cost time: 1.6477537155151367
Epoch: 5, Steps: 9 | Train Loss: 0.553 Vali Loss: 0.893 Vali Acc: 0.594 Test Loss: 0.893 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.4794061183929443
Epoch: 6, Steps: 9 | Train Loss: 0.381 Vali Loss: 0.602 Vali Acc: 0.797 Test Loss: 0.602 Test Acc: 0.797
Validation loss decreased (-0.637673 --> -0.797095).  Saving model ...
Epoch: 7 cost time: 1.6743969917297363
Epoch: 7, Steps: 9 | Train Loss: 0.230 Vali Loss: 0.524 Vali Acc: 0.797 Test Loss: 0.524 Test Acc: 0.797
Validation loss decreased (-0.797095 --> -0.797096).  Saving model ...
Epoch: 8 cost time: 1.765204668045044
Epoch: 8, Steps: 9 | Train Loss: 0.196 Vali Loss: 0.738 Vali Acc: 0.696 Test Loss: 0.738 Test Acc: 0.696
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.250723123550415
Epoch: 9, Steps: 9 | Train Loss: 0.095 Vali Loss: 0.755 Vali Acc: 0.775 Test Loss: 0.755 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.4380245208740234
Epoch: 10, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.675 Vali Acc: 0.783 Test Loss: 0.675 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.1599364280700684
Epoch: 11, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.807 Vali Acc: 0.841 Test Loss: 0.807 Test Acc: 0.841
Validation loss decreased (-0.797096 --> -0.840572).  Saving model ...
Epoch: 12 cost time: 1.3373205661773682
Epoch: 12, Steps: 9 | Train Loss: 0.006 Vali Loss: 1.419 Vali Acc: 0.812 Test Loss: 1.419 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1191487312316895
Epoch: 13, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.838 Vali Acc: 0.768 Test Loss: 0.838 Test Acc: 0.768
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.0945136547088623
Epoch: 14, Steps: 9 | Train Loss: 0.026 Vali Loss: 2.472 Vali Acc: 0.775 Test Loss: 2.472 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.1719377040863037
Epoch: 15, Steps: 9 | Train Loss: 0.023 Vali Loss: 1.052 Vali Acc: 0.761 Test Loss: 1.052 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.035118818283081
Epoch: 16, Steps: 9 | Train Loss: 0.010 Vali Loss: 1.520 Vali Acc: 0.797 Test Loss: 1.520 Test Acc: 0.797
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.0593960285186768
Epoch: 17, Steps: 9 | Train Loss: 0.019 Vali Loss: 1.563 Vali Acc: 0.783 Test Loss: 1.563 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.940758228302002
Epoch: 18, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.352 Vali Acc: 0.826 Test Loss: 1.352 Test Acc: 0.826
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.9062156677246094
Epoch: 19, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.131 Vali Acc: 0.848 Test Loss: 1.131 Test Acc: 0.848
Validation loss decreased (-0.840572 --> -0.847815).  Saving model ...
Epoch: 20 cost time: 1.4463739395141602
Epoch: 20, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.087 Vali Acc: 0.848 Test Loss: 1.087 Test Acc: 0.848
Validation loss decreased (-0.847815 --> -0.847815).  Saving model ...
Epoch: 21 cost time: 1.136279821395874
Epoch: 21, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.200 Vali Acc: 0.848 Test Loss: 1.200 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.296668529510498
Epoch: 22, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.198 Vali Acc: 0.855 Test Loss: 1.198 Test Acc: 0.855
Validation loss decreased (-0.847815 --> -0.855060).  Saving model ...
Epoch: 23 cost time: 1.304771900177002
Epoch: 23, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.169 Vali Acc: 0.848 Test Loss: 1.169 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.6311800479888916
Epoch: 24, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.175 Vali Acc: 0.848 Test Loss: 1.175 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.3818767070770264
Epoch: 25, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.191 Vali Acc: 0.848 Test Loss: 1.191 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.3571162223815918
Epoch: 26, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.209 Vali Acc: 0.848 Test Loss: 1.209 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.2867136001586914
Epoch: 27, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.219 Vali Acc: 0.848 Test Loss: 1.219 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.3290574550628662
Epoch: 28, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.227 Vali Acc: 0.848 Test Loss: 1.227 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.3193275928497314
Epoch: 29, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.237 Vali Acc: 0.848 Test Loss: 1.237 Test Acc: 0.848
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.3833229541778564
Epoch: 30, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.249 Vali Acc: 0.848 Test Loss: 1.249 Test Acc: 0.848
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.5714645385742188
Epoch: 31, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.258 Vali Acc: 0.848 Test Loss: 1.258 Test Acc: 0.848
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.5271408557891846
Epoch: 32, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.251 Vali Acc: 0.848 Test Loss: 1.251 Test Acc: 0.848
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el3_dm768_df768_ps10_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.855072463768116
model parameter : 22487812
model size : 100.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el3_dm768_df768_ps10_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.5002167224884033
Epoch: 1, Steps: 9 | Train Loss: 1.425 Vali Loss: 1.352 Vali Acc: 0.304 Test Loss: 1.352 Test Acc: 0.304
Validation loss decreased (inf --> -0.304334).  Saving model ...
Epoch: 2 cost time: 1.3814921379089355
Epoch: 2, Steps: 9 | Train Loss: 1.256 Vali Loss: 1.201 Vali Acc: 0.464 Test Loss: 1.201 Test Acc: 0.464
Validation loss decreased (-0.304334 --> -0.463756).  Saving model ...
Epoch: 3 cost time: 1.3261690139770508
Epoch: 3, Steps: 9 | Train Loss: 1.099 Vali Loss: 1.077 Vali Acc: 0.558 Test Loss: 1.077 Test Acc: 0.558
Validation loss decreased (-0.463756 --> -0.557960).  Saving model ...
Epoch: 4 cost time: 1.1813647747039795
Epoch: 4, Steps: 9 | Train Loss: 0.815 Vali Loss: 0.921 Vali Acc: 0.572 Test Loss: 0.921 Test Acc: 0.572
Validation loss decreased (-0.557960 --> -0.572455).  Saving model ...
Epoch: 5 cost time: 1.1696505546569824
Epoch: 5, Steps: 9 | Train Loss: 0.641 Vali Loss: 0.750 Vali Acc: 0.739 Test Loss: 0.750 Test Acc: 0.739
Validation loss decreased (-0.572455 --> -0.739123).  Saving model ...
Epoch: 6 cost time: 1.6624870300292969
Epoch: 6, Steps: 9 | Train Loss: 0.483 Vali Loss: 0.705 Vali Acc: 0.688 Test Loss: 0.705 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.211181640625
Epoch: 7, Steps: 9 | Train Loss: 0.346 Vali Loss: 0.599 Vali Acc: 0.717 Test Loss: 0.599 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.612877368927002
Epoch: 8, Steps: 9 | Train Loss: 0.277 Vali Loss: 0.605 Vali Acc: 0.819 Test Loss: 0.605 Test Acc: 0.819
Validation loss decreased (-0.739123 --> -0.818835).  Saving model ...
Epoch: 9 cost time: 1.6182115077972412
Epoch: 9, Steps: 9 | Train Loss: 0.219 Vali Loss: 0.598 Vali Acc: 0.754 Test Loss: 0.598 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.442490816116333
Epoch: 10, Steps: 9 | Train Loss: 0.097 Vali Loss: 0.571 Vali Acc: 0.855 Test Loss: 0.571 Test Acc: 0.855
Validation loss decreased (-0.818835 --> -0.855067).  Saving model ...
Epoch: 11 cost time: 1.6899864673614502
Epoch: 11, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.555 Vali Acc: 0.848 Test Loss: 0.555 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1369597911834717
Epoch: 12, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.514 Vali Acc: 0.862 Test Loss: 0.514 Test Acc: 0.862
Validation loss decreased (-0.855067 --> -0.862314).  Saving model ...
Epoch: 13 cost time: 1.5170905590057373
Epoch: 13, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.953 Vali Acc: 0.826 Test Loss: 0.953 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2932422161102295
Epoch: 14, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.544 Vali Acc: 0.877 Test Loss: 0.544 Test Acc: 0.877
Validation loss decreased (-0.862314 --> -0.876806).  Saving model ...
Epoch: 15 cost time: 1.1549654006958008
Epoch: 15, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.962 Vali Acc: 0.812 Test Loss: 0.962 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1745946407318115
Epoch: 16, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.782 Vali Acc: 0.862 Test Loss: 0.782 Test Acc: 0.862
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.535205602645874
Epoch: 17, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.801 Vali Acc: 0.848 Test Loss: 0.801 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.436615228652954
Epoch: 18, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.776 Vali Acc: 0.855 Test Loss: 0.776 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.4910526275634766
Epoch: 19, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.727 Vali Acc: 0.870 Test Loss: 0.727 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.731593370437622
Epoch: 20, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.753 Vali Acc: 0.870 Test Loss: 0.753 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.7960591316223145
Epoch: 21, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.795 Vali Acc: 0.855 Test Loss: 0.795 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.4771902561187744
Epoch: 22, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.786 Vali Acc: 0.862 Test Loss: 0.786 Test Acc: 0.862
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.8411173820495605
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.824 Vali Acc: 0.855 Test Loss: 0.824 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.0368523597717285
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.864 Vali Acc: 0.848 Test Loss: 0.864 Test Acc: 0.848
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el3_dm768_df768_ps10_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8768115942028986
model parameter : 22368004
model size : 99.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el3_dm768_df768_ps10_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.4870221614837646
Epoch: 1, Steps: 9 | Train Loss: 1.460 Vali Loss: 1.358 Vali Acc: 0.312 Test Loss: 1.358 Test Acc: 0.312
Validation loss decreased (inf --> -0.311581).  Saving model ...
Epoch: 2 cost time: 1.2694730758666992
Epoch: 2, Steps: 9 | Train Loss: 1.301 Vali Loss: 1.245 Vali Acc: 0.413 Test Loss: 1.245 Test Acc: 0.413
Validation loss decreased (-0.311581 --> -0.413031).  Saving model ...
Epoch: 3 cost time: 1.2896974086761475
Epoch: 3, Steps: 9 | Train Loss: 1.134 Vali Loss: 1.143 Vali Acc: 0.623 Test Loss: 1.143 Test Acc: 0.623
Validation loss decreased (-0.413031 --> -0.623177).  Saving model ...
Epoch: 4 cost time: 1.1186602115631104
Epoch: 4, Steps: 9 | Train Loss: 0.979 Vali Loss: 1.023 Vali Acc: 0.594 Test Loss: 1.023 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3242101669311523
Epoch: 5, Steps: 9 | Train Loss: 0.825 Vali Loss: 0.928 Vali Acc: 0.659 Test Loss: 0.928 Test Acc: 0.659
Validation loss decreased (-0.623177 --> -0.659411).  Saving model ...
Epoch: 6 cost time: 0.9590985774993896
Epoch: 6, Steps: 9 | Train Loss: 0.703 Vali Loss: 0.846 Vali Acc: 0.681 Test Loss: 0.846 Test Acc: 0.681
Validation loss decreased (-0.659411 --> -0.681151).  Saving model ...
Epoch: 7 cost time: 1.1569855213165283
Epoch: 7, Steps: 9 | Train Loss: 0.577 Vali Loss: 0.739 Vali Acc: 0.732 Test Loss: 0.739 Test Acc: 0.732
Validation loss decreased (-0.681151 --> -0.731877).  Saving model ...
Epoch: 8 cost time: 1.4970598220825195
Epoch: 8, Steps: 9 | Train Loss: 0.436 Vali Loss: 0.676 Vali Acc: 0.783 Test Loss: 0.676 Test Acc: 0.783
Validation loss decreased (-0.731877 --> -0.782602).  Saving model ...
Epoch: 9 cost time: 1.5948820114135742
Epoch: 9, Steps: 9 | Train Loss: 0.318 Vali Loss: 0.613 Vali Acc: 0.797 Test Loss: 0.613 Test Acc: 0.797
Validation loss decreased (-0.782602 --> -0.797095).  Saving model ...
Epoch: 10 cost time: 1.3135449886322021
Epoch: 10, Steps: 9 | Train Loss: 0.206 Vali Loss: 0.634 Vali Acc: 0.804 Test Loss: 0.634 Test Acc: 0.804
Validation loss decreased (-0.797095 --> -0.804341).  Saving model ...
Epoch: 11 cost time: 1.2076399326324463
Epoch: 11, Steps: 9 | Train Loss: 0.146 Vali Loss: 0.609 Vali Acc: 0.812 Test Loss: 0.609 Test Acc: 0.812
Validation loss decreased (-0.804341 --> -0.811588).  Saving model ...
Epoch: 12 cost time: 1.3563575744628906
Epoch: 12, Steps: 9 | Train Loss: 0.073 Vali Loss: 0.664 Vali Acc: 0.790 Test Loss: 0.664 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9135396480560303
Epoch: 13, Steps: 9 | Train Loss: 0.055 Vali Loss: 0.633 Vali Acc: 0.804 Test Loss: 0.633 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.3014655113220215
Epoch: 14, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.625 Vali Acc: 0.826 Test Loss: 0.625 Test Acc: 0.826
Validation loss decreased (-0.811588 --> -0.826081).  Saving model ...
Epoch: 15 cost time: 1.151909589767456
Epoch: 15, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.675 Vali Acc: 0.819 Test Loss: 0.675 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0124201774597168
Epoch: 16, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.620 Vali Acc: 0.833 Test Loss: 0.620 Test Acc: 0.833
Validation loss decreased (-0.826081 --> -0.833327).  Saving model ...
Epoch: 17 cost time: 1.4167513847351074
Epoch: 17, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.711 Vali Acc: 0.833 Test Loss: 0.711 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1629652976989746
Epoch: 18, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.767 Vali Acc: 0.833 Test Loss: 0.767 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.2842497825622559
Epoch: 19, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.728 Vali Acc: 0.826 Test Loss: 0.728 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.0600295066833496
Epoch: 20, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.730 Vali Acc: 0.833 Test Loss: 0.730 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.1217854022979736
Epoch: 21, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.724 Vali Acc: 0.833 Test Loss: 0.724 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.1101067066192627
Epoch: 22, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.728 Vali Acc: 0.841 Test Loss: 0.728 Test Acc: 0.841
Validation loss decreased (-0.833327 --> -0.840572).  Saving model ...
Epoch: 23 cost time: 1.2244107723236084
Epoch: 23, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.728 Vali Acc: 0.833 Test Loss: 0.728 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.280534267425537
Epoch: 24, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.764 Vali Acc: 0.841 Test Loss: 0.764 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.1361215114593506
Epoch: 25, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.773 Vali Acc: 0.841 Test Loss: 0.773 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.0542240142822266
Epoch: 26, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.772 Vali Acc: 0.841 Test Loss: 0.772 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.0390334129333496
Epoch: 27, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.730 Vali Acc: 0.833 Test Loss: 0.730 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.0726664066314697
Epoch: 28, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.760 Vali Acc: 0.841 Test Loss: 0.760 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.1579363346099854
Epoch: 29, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.793 Vali Acc: 0.841 Test Loss: 0.793 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.1207990646362305
Epoch: 30, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.783 Vali Acc: 0.841 Test Loss: 0.783 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.1388859748840332
Epoch: 31, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.759 Vali Acc: 0.841 Test Loss: 0.759 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.181147575378418
Epoch: 32, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.790 Vali Acc: 0.841 Test Loss: 0.790 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el3_dm768_df768_ps10_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8405797101449275
model parameter : 22275844
model size : 99.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el3_dm768_df768_ps11_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.2165772914886475
Epoch: 1, Steps: 9 | Train Loss: 1.323 Vali Loss: 1.216 Vali Acc: 0.312 Test Loss: 1.216 Test Acc: 0.312
Validation loss decreased (inf --> -0.311582).  Saving model ...
Epoch: 2 cost time: 1.406207799911499
Epoch: 2, Steps: 9 | Train Loss: 1.083 Vali Loss: 1.002 Vali Acc: 0.572 Test Loss: 1.002 Test Acc: 0.572
Validation loss decreased (-0.311582 --> -0.572454).  Saving model ...
Epoch: 3 cost time: 1.4773743152618408
Epoch: 3, Steps: 9 | Train Loss: 0.837 Vali Loss: 0.900 Vali Acc: 0.594 Test Loss: 0.900 Test Acc: 0.594
Validation loss decreased (-0.572454 --> -0.594194).  Saving model ...
Epoch: 4 cost time: 1.5870659351348877
Epoch: 4, Steps: 9 | Train Loss: 0.656 Vali Loss: 0.693 Vali Acc: 0.746 Test Loss: 0.693 Test Acc: 0.746
Validation loss decreased (-0.594194 --> -0.746370).  Saving model ...
Epoch: 5 cost time: 1.235198974609375
Epoch: 5, Steps: 9 | Train Loss: 0.458 Vali Loss: 0.723 Vali Acc: 0.688 Test Loss: 0.723 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.387906789779663
Epoch: 6, Steps: 9 | Train Loss: 0.358 Vali Loss: 0.624 Vali Acc: 0.710 Test Loss: 0.624 Test Acc: 0.710
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.407397985458374
Epoch: 7, Steps: 9 | Train Loss: 0.223 Vali Loss: 0.720 Vali Acc: 0.768 Test Loss: 0.720 Test Acc: 0.768
Validation loss decreased (-0.746370 --> -0.768109).  Saving model ...
Epoch: 8 cost time: 1.216214656829834
Epoch: 8, Steps: 9 | Train Loss: 0.187 Vali Loss: 0.642 Vali Acc: 0.746 Test Loss: 0.642 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3159468173980713
Epoch: 9, Steps: 9 | Train Loss: 0.108 Vali Loss: 0.624 Vali Acc: 0.768 Test Loss: 0.624 Test Acc: 0.768
Validation loss decreased (-0.768109 --> -0.768110).  Saving model ...
Epoch: 10 cost time: 1.371748924255371
Epoch: 10, Steps: 9 | Train Loss: 0.061 Vali Loss: 0.341 Vali Acc: 0.877 Test Loss: 0.341 Test Acc: 0.877
Validation loss decreased (-0.768110 --> -0.876808).  Saving model ...
Epoch: 11 cost time: 1.678370714187622
Epoch: 11, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.871 Vali Acc: 0.841 Test Loss: 0.871 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3158321380615234
Epoch: 12, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.622 Vali Acc: 0.833 Test Loss: 0.622 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1197881698608398
Epoch: 13, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.863 Vali Acc: 0.841 Test Loss: 0.863 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.218583583831787
Epoch: 14, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.755 Vali Acc: 0.862 Test Loss: 0.755 Test Acc: 0.862
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.1415209770202637
Epoch: 15, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.105 Vali Acc: 0.819 Test Loss: 1.105 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.7910950183868408
Epoch: 16, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.628 Vali Acc: 0.841 Test Loss: 0.628 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.2327332496643066
Epoch: 17, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.042 Vali Acc: 0.826 Test Loss: 1.042 Test Acc: 0.826
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.587632656097412
Epoch: 18, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.698 Vali Acc: 0.877 Test Loss: 0.698 Test Acc: 0.877
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.4031243324279785
Epoch: 19, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.662 Vali Acc: 0.848 Test Loss: 0.662 Test Acc: 0.848
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.1834592819213867
Epoch: 20, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.762 Vali Acc: 0.862 Test Loss: 0.762 Test Acc: 0.862
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el3_dm768_df768_ps11_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8768115942028986
model parameter : 22494724
model size : 100.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el3_dm768_df768_ps11_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.1418027877807617
Epoch: 1, Steps: 9 | Train Loss: 1.418 Vali Loss: 1.282 Vali Acc: 0.384 Test Loss: 1.282 Test Acc: 0.384
Validation loss decreased (inf --> -0.384045).  Saving model ...
Epoch: 2 cost time: 1.3906328678131104
Epoch: 2, Steps: 9 | Train Loss: 1.259 Vali Loss: 1.125 Vali Acc: 0.580 Test Loss: 1.125 Test Acc: 0.580
Validation loss decreased (-0.384045 --> -0.579699).  Saving model ...
Epoch: 3 cost time: 1.2283337116241455
Epoch: 3, Steps: 9 | Train Loss: 0.984 Vali Loss: 1.002 Vali Acc: 0.486 Test Loss: 1.002 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3217198848724365
Epoch: 4, Steps: 9 | Train Loss: 0.901 Vali Loss: 0.923 Vali Acc: 0.630 Test Loss: 0.923 Test Acc: 0.630
Validation loss decreased (-0.579699 --> -0.630426).  Saving model ...
Epoch: 5 cost time: 1.0991466045379639
Epoch: 5, Steps: 9 | Train Loss: 0.718 Vali Loss: 0.786 Vali Acc: 0.674 Test Loss: 0.786 Test Acc: 0.674
Validation loss decreased (-0.630426 --> -0.673905).  Saving model ...
Epoch: 6 cost time: 1.138399600982666
Epoch: 6, Steps: 9 | Train Loss: 0.549 Vali Loss: 0.741 Vali Acc: 0.659 Test Loss: 0.741 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.488720178604126
Epoch: 7, Steps: 9 | Train Loss: 0.469 Vali Loss: 0.668 Vali Acc: 0.703 Test Loss: 0.668 Test Acc: 0.703
Validation loss decreased (-0.673905 --> -0.702892).  Saving model ...
Epoch: 8 cost time: 1.2465684413909912
Epoch: 8, Steps: 9 | Train Loss: 0.361 Vali Loss: 0.627 Vali Acc: 0.710 Test Loss: 0.627 Test Acc: 0.710
Validation loss decreased (-0.702892 --> -0.710139).  Saving model ...
Epoch: 9 cost time: 1.4973995685577393
Epoch: 9, Steps: 9 | Train Loss: 0.265 Vali Loss: 0.761 Vali Acc: 0.703 Test Loss: 0.761 Test Acc: 0.703
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3820440769195557
Epoch: 10, Steps: 9 | Train Loss: 0.133 Vali Loss: 0.623 Vali Acc: 0.804 Test Loss: 0.623 Test Acc: 0.804
Validation loss decreased (-0.710139 --> -0.804342).  Saving model ...
Epoch: 11 cost time: 1.416980266571045
Epoch: 11, Steps: 9 | Train Loss: 0.083 Vali Loss: 0.548 Vali Acc: 0.797 Test Loss: 0.548 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1010096073150635
Epoch: 12, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.728 Vali Acc: 0.797 Test Loss: 0.728 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.3951873779296875
Epoch: 13, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.837 Vali Acc: 0.804 Test Loss: 0.837 Test Acc: 0.804
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.1201694011688232
Epoch: 14, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.683 Vali Acc: 0.790 Test Loss: 0.683 Test Acc: 0.790
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.302765130996704
Epoch: 15, Steps: 9 | Train Loss: 0.014 Vali Loss: 1.112 Vali Acc: 0.804 Test Loss: 1.112 Test Acc: 0.804
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.5921757221221924
Epoch: 16, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.754 Vali Acc: 0.804 Test Loss: 0.754 Test Acc: 0.804
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.1552879810333252
Epoch: 17, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.764 Vali Acc: 0.819 Test Loss: 0.764 Test Acc: 0.819
Validation loss decreased (-0.804342 --> -0.818833).  Saving model ...
Epoch: 18 cost time: 1.6434552669525146
Epoch: 18, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.832 Vali Acc: 0.812 Test Loss: 0.832 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.3660788536071777
Epoch: 19, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.741 Vali Acc: 0.833 Test Loss: 0.741 Test Acc: 0.833
Validation loss decreased (-0.818833 --> -0.833326).  Saving model ...
Epoch: 20 cost time: 1.49312424659729
Epoch: 20, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.760 Vali Acc: 0.826 Test Loss: 0.760 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0213394165039062
Epoch: 21, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.839 Vali Acc: 0.826 Test Loss: 0.839 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.4504692554473877
Epoch: 22, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.870 Vali Acc: 0.833 Test Loss: 0.870 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.1369152069091797
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.859 Vali Acc: 0.833 Test Loss: 0.859 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.3458786010742188
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.828 Vali Acc: 0.826 Test Loss: 0.828 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.1385889053344727
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.798 Vali Acc: 0.826 Test Loss: 0.798 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.4820177555084229
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.800 Vali Acc: 0.826 Test Loss: 0.800 Test Acc: 0.826
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.1315572261810303
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.833 Vali Acc: 0.826 Test Loss: 0.833 Test Acc: 0.826
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.5266127586364746
Epoch: 28, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.875 Vali Acc: 0.841 Test Loss: 0.875 Test Acc: 0.841
Validation loss decreased (-0.833326 --> -0.840571).  Saving model ...
Epoch: 29 cost time: 1.0853955745697021
Epoch: 29, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.887 Vali Acc: 0.841 Test Loss: 0.887 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.4196243286132812
Epoch: 30, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.854 Vali Acc: 0.826 Test Loss: 0.854 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.0786316394805908
Epoch: 31, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.835 Vali Acc: 0.833 Test Loss: 0.835 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.466045618057251
Epoch: 32, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.846 Vali Acc: 0.833 Test Loss: 0.846 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.183966875076294
Epoch: 33, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.873 Vali Acc: 0.833 Test Loss: 0.873 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.43418550491333
Epoch: 34, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.906 Vali Acc: 0.833 Test Loss: 0.906 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.3194375038146973
Epoch: 35, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.888 Vali Acc: 0.833 Test Loss: 0.888 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.1335525512695312
Epoch: 36, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.868 Vali Acc: 0.833 Test Loss: 0.868 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.373809576034546
Epoch: 37, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.874 Vali Acc: 0.841 Test Loss: 0.874 Test Acc: 0.841
Validation loss decreased (-0.840571 --> -0.840571).  Saving model ...
Epoch: 38 cost time: 1.2457056045532227
Epoch: 38, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.892 Vali Acc: 0.841 Test Loss: 0.892 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.0786840915679932
Epoch: 39, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.886 Vali Acc: 0.841 Test Loss: 0.886 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.11458158493042
Epoch: 40, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.889 Vali Acc: 0.841 Test Loss: 0.889 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.2305431365966797
Epoch: 41, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.893 Vali Acc: 0.841 Test Loss: 0.893 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.1296565532684326
Epoch: 42, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.910 Vali Acc: 0.833 Test Loss: 0.910 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.030768871307373
Epoch: 43, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.922 Vali Acc: 0.833 Test Loss: 0.922 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.1299500465393066
Epoch: 44, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.906 Vali Acc: 0.833 Test Loss: 0.906 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 1.016169548034668
Epoch: 45, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.911 Vali Acc: 0.833 Test Loss: 0.911 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 1.125262975692749
Epoch: 46, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.937 Vali Acc: 0.833 Test Loss: 0.937 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 1.0385138988494873
Epoch: 47, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.951 Vali Acc: 0.833 Test Loss: 0.951 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el3_dm768_df768_ps11_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8405797101449275
model parameter : 22342660
model size : 99.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el3_dm768_df768_ps11_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.9069228172302246
Epoch: 1, Steps: 9 | Train Loss: 1.438 Vali Loss: 1.390 Vali Acc: 0.232 Test Loss: 1.390 Test Acc: 0.232
Validation loss decreased (inf --> -0.231870).  Saving model ...
Epoch: 2 cost time: 0.9384069442749023
Epoch: 2, Steps: 9 | Train Loss: 1.314 Vali Loss: 1.260 Vali Acc: 0.478 Test Loss: 1.260 Test Acc: 0.478
Validation loss decreased (-0.231870 --> -0.478248).  Saving model ...
Epoch: 3 cost time: 0.7049951553344727
Epoch: 3, Steps: 9 | Train Loss: 1.174 Vali Loss: 1.129 Vali Acc: 0.551 Test Loss: 1.129 Test Acc: 0.551
Validation loss decreased (-0.478248 --> -0.550713).  Saving model ...
Epoch: 4 cost time: 1.287379503250122
Epoch: 4, Steps: 9 | Train Loss: 1.020 Vali Loss: 1.020 Vali Acc: 0.551 Test Loss: 1.020 Test Acc: 0.551
Validation loss decreased (-0.550713 --> -0.550714).  Saving model ...
Epoch: 5 cost time: 0.8782551288604736
Epoch: 5, Steps: 9 | Train Loss: 0.877 Vali Loss: 0.950 Vali Acc: 0.652 Test Loss: 0.950 Test Acc: 0.652
Validation loss decreased (-0.550714 --> -0.652164).  Saving model ...
Epoch: 6 cost time: 0.8992972373962402
Epoch: 6, Steps: 9 | Train Loss: 0.730 Vali Loss: 0.841 Vali Acc: 0.630 Test Loss: 0.841 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8923144340515137
Epoch: 7, Steps: 9 | Train Loss: 0.657 Vali Loss: 0.779 Vali Acc: 0.674 Test Loss: 0.779 Test Acc: 0.674
Validation loss decreased (-0.652164 --> -0.673905).  Saving model ...
Epoch: 8 cost time: 0.8962986469268799
Epoch: 8, Steps: 9 | Train Loss: 0.523 Vali Loss: 0.686 Vali Acc: 0.703 Test Loss: 0.686 Test Acc: 0.703
Validation loss decreased (-0.673905 --> -0.702892).  Saving model ...
Epoch: 9 cost time: 0.7652537822723389
Epoch: 9, Steps: 9 | Train Loss: 0.426 Vali Loss: 0.701 Vali Acc: 0.703 Test Loss: 0.701 Test Acc: 0.703
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8749876022338867
Epoch: 10, Steps: 9 | Train Loss: 0.371 Vali Loss: 0.575 Vali Acc: 0.775 Test Loss: 0.575 Test Acc: 0.775
Validation loss decreased (-0.702892 --> -0.775357).  Saving model ...
Epoch: 11 cost time: 1.182215929031372
Epoch: 11, Steps: 9 | Train Loss: 0.233 Vali Loss: 0.528 Vali Acc: 0.775 Test Loss: 0.528 Test Acc: 0.775
Validation loss decreased (-0.775357 --> -0.775357).  Saving model ...
Epoch: 12 cost time: 1.4338712692260742
Epoch: 12, Steps: 9 | Train Loss: 0.181 Vali Loss: 0.649 Vali Acc: 0.746 Test Loss: 0.649 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.203042984008789
Epoch: 13, Steps: 9 | Train Loss: 0.126 Vali Loss: 0.556 Vali Acc: 0.826 Test Loss: 0.556 Test Acc: 0.826
Validation loss decreased (-0.775357 --> -0.826081).  Saving model ...
Epoch: 14 cost time: 1.2820532321929932
Epoch: 14, Steps: 9 | Train Loss: 0.067 Vali Loss: 0.812 Vali Acc: 0.725 Test Loss: 0.812 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.012514352798462
Epoch: 15, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.676 Vali Acc: 0.819 Test Loss: 0.676 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.0787584781646729
Epoch: 16, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.692 Vali Acc: 0.768 Test Loss: 0.692 Test Acc: 0.768
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.1350915431976318
Epoch: 17, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.838 Vali Acc: 0.797 Test Loss: 0.838 Test Acc: 0.797
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.4927260875701904
Epoch: 18, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.700 Vali Acc: 0.812 Test Loss: 0.700 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.033897876739502
Epoch: 19, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.710 Vali Acc: 0.819 Test Loss: 0.710 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.219127893447876
Epoch: 20, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.756 Vali Acc: 0.812 Test Loss: 0.756 Test Acc: 0.812
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.3608040809631348
Epoch: 21, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.789 Vali Acc: 0.819 Test Loss: 0.789 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.9519953727722168
Epoch: 22, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.822 Vali Acc: 0.812 Test Loss: 0.822 Test Acc: 0.812
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.2639226913452148
Epoch: 23, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.766 Vali Acc: 0.819 Test Loss: 0.766 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el3_dm768_df768_ps11_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8260869565217391
model parameter : 22273540
model size : 99.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el3_dm768_df768_ps12_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.66314959526062
Epoch: 1, Steps: 9 | Train Loss: 1.483 Vali Loss: 1.282 Vali Acc: 0.457 Test Loss: 1.282 Test Acc: 0.457
Validation loss decreased (inf --> -0.456509).  Saving model ...
Epoch: 2 cost time: 1.2184712886810303
Epoch: 2, Steps: 9 | Train Loss: 1.164 Vali Loss: 1.076 Vali Acc: 0.587 Test Loss: 1.076 Test Acc: 0.587
Validation loss decreased (-0.456509 --> -0.586946).  Saving model ...
Epoch: 3 cost time: 1.1832332611083984
Epoch: 3, Steps: 9 | Train Loss: 0.881 Vali Loss: 0.849 Vali Acc: 0.623 Test Loss: 0.849 Test Acc: 0.623
Validation loss decreased (-0.586946 --> -0.623180).  Saving model ...
Epoch: 4 cost time: 1.0051071643829346
Epoch: 4, Steps: 9 | Train Loss: 0.616 Vali Loss: 1.057 Vali Acc: 0.543 Test Loss: 1.057 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8596670627593994
Epoch: 5, Steps: 9 | Train Loss: 0.589 Vali Loss: 0.835 Vali Acc: 0.572 Test Loss: 0.835 Test Acc: 0.572
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1733012199401855
Epoch: 6, Steps: 9 | Train Loss: 0.450 Vali Loss: 0.828 Vali Acc: 0.674 Test Loss: 0.828 Test Acc: 0.674
Validation loss decreased (-0.623180 --> -0.673905).  Saving model ...
Epoch: 7 cost time: 1.1084144115447998
Epoch: 7, Steps: 9 | Train Loss: 0.253 Vali Loss: 0.491 Vali Acc: 0.819 Test Loss: 0.491 Test Acc: 0.819
Validation loss decreased (-0.673905 --> -0.818836).  Saving model ...
Epoch: 8 cost time: 1.0787031650543213
Epoch: 8, Steps: 9 | Train Loss: 0.124 Vali Loss: 0.859 Vali Acc: 0.725 Test Loss: 0.859 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2085027694702148
Epoch: 9, Steps: 9 | Train Loss: 0.136 Vali Loss: 0.581 Vali Acc: 0.783 Test Loss: 0.581 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.2820017337799072
Epoch: 10, Steps: 9 | Train Loss: 0.056 Vali Loss: 0.706 Vali Acc: 0.812 Test Loss: 0.706 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.3073513507843018
Epoch: 11, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.877 Vali Acc: 0.804 Test Loss: 0.877 Test Acc: 0.804
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.147390604019165
Epoch: 12, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.987 Vali Acc: 0.812 Test Loss: 0.987 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.8031682968139648
Epoch: 13, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.875 Vali Acc: 0.848 Test Loss: 0.875 Test Acc: 0.848
Validation loss decreased (-0.818836 --> -0.847817).  Saving model ...
Epoch: 14 cost time: 1.099647045135498
Epoch: 14, Steps: 9 | Train Loss: 0.005 Vali Loss: 1.065 Vali Acc: 0.826 Test Loss: 1.065 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.5836575031280518
Epoch: 15, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.158 Vali Acc: 0.819 Test Loss: 1.158 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.202578067779541
Epoch: 16, Steps: 9 | Train Loss: 0.000 Vali Loss: 1.019 Vali Acc: 0.862 Test Loss: 1.019 Test Acc: 0.862
Validation loss decreased (-0.847817 --> -0.862309).  Saving model ...
Epoch: 17 cost time: 1.430145025253296
Epoch: 17, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.971 Vali Acc: 0.870 Test Loss: 0.971 Test Acc: 0.870
Validation loss decreased (-0.862309 --> -0.869556).  Saving model ...
Epoch: 18 cost time: 1.724801778793335
Epoch: 18, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.992 Vali Acc: 0.862 Test Loss: 0.992 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.8108584880828857
Epoch: 19, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.950 Vali Acc: 0.870 Test Loss: 0.950 Test Acc: 0.870
Validation loss decreased (-0.869556 --> -0.869556).  Saving model ...
Epoch: 20 cost time: 1.5229849815368652
Epoch: 20, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.891 Vali Acc: 0.877 Test Loss: 0.891 Test Acc: 0.877
Validation loss decreased (-0.869556 --> -0.876803).  Saving model ...
Epoch: 21 cost time: 1.7958581447601318
Epoch: 21, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.926 Vali Acc: 0.870 Test Loss: 0.926 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.9131643772125244
Epoch: 22, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.967 Vali Acc: 0.855 Test Loss: 0.967 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.6122939586639404
Epoch: 23, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.999 Vali Acc: 0.841 Test Loss: 0.999 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.5154392719268799
Epoch: 24, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.983 Vali Acc: 0.848 Test Loss: 0.983 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.1378679275512695
Epoch: 25, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.965 Vali Acc: 0.855 Test Loss: 0.965 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.6832795143127441
Epoch: 26, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.950 Vali Acc: 0.862 Test Loss: 0.950 Test Acc: 0.862
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.4326670169830322
Epoch: 27, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.942 Vali Acc: 0.862 Test Loss: 0.942 Test Acc: 0.862
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.6067793369293213
Epoch: 28, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.954 Vali Acc: 0.862 Test Loss: 0.954 Test Acc: 0.862
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.3570477962493896
Epoch: 29, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.963 Vali Acc: 0.862 Test Loss: 0.963 Test Acc: 0.862
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.4614100456237793
Epoch: 30, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.962 Vali Acc: 0.862 Test Loss: 0.962 Test Acc: 0.862
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el3_dm768_df768_ps12_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8768115942028986
model parameter : 22497028
model size : 100.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el3_dm768_df768_ps12_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.9882423877716064
Epoch: 1, Steps: 9 | Train Loss: 1.427 Vali Loss: 1.347 Vali Acc: 0.319 Test Loss: 1.347 Test Acc: 0.319
Validation loss decreased (inf --> -0.318827).  Saving model ...
Epoch: 2 cost time: 1.174525260925293
Epoch: 2, Steps: 9 | Train Loss: 1.278 Vali Loss: 1.156 Vali Acc: 0.464 Test Loss: 1.156 Test Acc: 0.464
Validation loss decreased (-0.318827 --> -0.463757).  Saving model ...
Epoch: 3 cost time: 1.347487449645996
Epoch: 3, Steps: 9 | Train Loss: 1.028 Vali Loss: 1.027 Vali Acc: 0.616 Test Loss: 1.027 Test Acc: 0.616
Validation loss decreased (-0.463757 --> -0.615932).  Saving model ...
Epoch: 4 cost time: 0.9582324028015137
Epoch: 4, Steps: 9 | Train Loss: 0.858 Vali Loss: 0.914 Vali Acc: 0.645 Test Loss: 0.914 Test Acc: 0.645
Validation loss decreased (-0.615932 --> -0.644918).  Saving model ...
Epoch: 5 cost time: 0.9272127151489258
Epoch: 5, Steps: 9 | Train Loss: 0.720 Vali Loss: 0.843 Vali Acc: 0.659 Test Loss: 0.843 Test Acc: 0.659
Validation loss decreased (-0.644918 --> -0.659412).  Saving model ...
Epoch: 6 cost time: 0.9072959423065186
Epoch: 6, Steps: 9 | Train Loss: 0.567 Vali Loss: 0.781 Vali Acc: 0.674 Test Loss: 0.781 Test Acc: 0.674
Validation loss decreased (-0.659412 --> -0.673905).  Saving model ...
Epoch: 7 cost time: 0.9453480243682861
Epoch: 7, Steps: 9 | Train Loss: 0.390 Vali Loss: 0.686 Vali Acc: 0.775 Test Loss: 0.686 Test Acc: 0.775
Validation loss decreased (-0.673905 --> -0.775355).  Saving model ...
Epoch: 8 cost time: 0.9632751941680908
Epoch: 8, Steps: 9 | Train Loss: 0.323 Vali Loss: 0.739 Vali Acc: 0.703 Test Loss: 0.739 Test Acc: 0.703
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8942146301269531
Epoch: 9, Steps: 9 | Train Loss: 0.164 Vali Loss: 0.756 Vali Acc: 0.790 Test Loss: 0.756 Test Acc: 0.790
Validation loss decreased (-0.775355 --> -0.789848).  Saving model ...
Epoch: 10 cost time: 1.3100683689117432
Epoch: 10, Steps: 9 | Train Loss: 0.121 Vali Loss: 0.786 Vali Acc: 0.746 Test Loss: 0.786 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0332043170928955
Epoch: 11, Steps: 9 | Train Loss: 0.058 Vali Loss: 1.049 Vali Acc: 0.804 Test Loss: 1.049 Test Acc: 0.804
Validation loss decreased (-0.789848 --> -0.804337).  Saving model ...
Epoch: 12 cost time: 1.2206907272338867
Epoch: 12, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.664 Vali Acc: 0.812 Test Loss: 0.664 Test Acc: 0.812
Validation loss decreased (-0.804337 --> -0.811588).  Saving model ...
Epoch: 13 cost time: 1.0269742012023926
Epoch: 13, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.785 Vali Acc: 0.797 Test Loss: 0.785 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2195837497711182
Epoch: 14, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.788 Vali Acc: 0.790 Test Loss: 0.788 Test Acc: 0.790
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.1892051696777344
Epoch: 15, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.782 Vali Acc: 0.804 Test Loss: 0.782 Test Acc: 0.804
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.1860508918762207
Epoch: 16, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.901 Vali Acc: 0.783 Test Loss: 0.901 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.143101453781128
Epoch: 17, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.869 Vali Acc: 0.783 Test Loss: 0.869 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.0335471630096436
Epoch: 18, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.783 Vali Acc: 0.812 Test Loss: 0.783 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.0415980815887451
Epoch: 19, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.918 Vali Acc: 0.804 Test Loss: 0.918 Test Acc: 0.804
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.261018991470337
Epoch: 20, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.888 Vali Acc: 0.812 Test Loss: 0.888 Test Acc: 0.812
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.2550983428955078
Epoch: 21, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.880 Vali Acc: 0.812 Test Loss: 0.880 Test Acc: 0.812
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.208432912826538
Epoch: 22, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.836 Vali Acc: 0.812 Test Loss: 0.836 Test Acc: 0.812
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el3_dm768_df768_ps12_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8115942028985508
model parameter : 22349572
model size : 99.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el3_dm768_df768_ps12_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.0850908756256104
Epoch: 1, Steps: 9 | Train Loss: 1.485 Vali Loss: 1.399 Vali Acc: 0.268 Test Loss: 1.399 Test Acc: 0.268
Validation loss decreased (inf --> -0.268102).  Saving model ...
Epoch: 2 cost time: 0.9669160842895508
Epoch: 2, Steps: 9 | Train Loss: 1.394 Vali Loss: 1.285 Vali Acc: 0.428 Test Loss: 1.285 Test Acc: 0.428
Validation loss decreased (-0.268102 --> -0.427523).  Saving model ...
Epoch: 3 cost time: 0.8703179359436035
Epoch: 3, Steps: 9 | Train Loss: 1.248 Vali Loss: 1.154 Vali Acc: 0.572 Test Loss: 1.154 Test Acc: 0.572
Validation loss decreased (-0.427523 --> -0.572452).  Saving model ...
Epoch: 4 cost time: 0.8313560485839844
Epoch: 4, Steps: 9 | Train Loss: 1.051 Vali Loss: 1.054 Vali Acc: 0.580 Test Loss: 1.054 Test Acc: 0.580
Validation loss decreased (-0.572452 --> -0.579700).  Saving model ...
Epoch: 5 cost time: 0.7313034534454346
Epoch: 5, Steps: 9 | Train Loss: 0.960 Vali Loss: 0.940 Vali Acc: 0.645 Test Loss: 0.940 Test Acc: 0.645
Validation loss decreased (-0.579700 --> -0.644918).  Saving model ...
Epoch: 6 cost time: 0.8495266437530518
Epoch: 6, Steps: 9 | Train Loss: 0.783 Vali Loss: 0.898 Vali Acc: 0.623 Test Loss: 0.898 Test Acc: 0.623
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9151272773742676
Epoch: 7, Steps: 9 | Train Loss: 0.650 Vali Loss: 0.793 Vali Acc: 0.681 Test Loss: 0.793 Test Acc: 0.681
Validation loss decreased (-0.644918 --> -0.681151).  Saving model ...
Epoch: 8 cost time: 0.8585407733917236
Epoch: 8, Steps: 9 | Train Loss: 0.524 Vali Loss: 0.830 Vali Acc: 0.601 Test Loss: 0.830 Test Acc: 0.601
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.026071310043335
Epoch: 9, Steps: 9 | Train Loss: 0.484 Vali Loss: 0.737 Vali Acc: 0.681 Test Loss: 0.737 Test Acc: 0.681
Validation loss decreased (-0.681151 --> -0.681152).  Saving model ...
Epoch: 10 cost time: 1.0639636516571045
Epoch: 10, Steps: 9 | Train Loss: 0.332 Vali Loss: 0.710 Vali Acc: 0.717 Test Loss: 0.710 Test Acc: 0.717
Validation loss decreased (-0.681152 --> -0.717384).  Saving model ...
Epoch: 11 cost time: 1.2173435688018799
Epoch: 11, Steps: 9 | Train Loss: 0.237 Vali Loss: 0.716 Vali Acc: 0.732 Test Loss: 0.716 Test Acc: 0.732
Validation loss decreased (-0.717384 --> -0.731877).  Saving model ...
Epoch: 12 cost time: 0.9638705253601074
Epoch: 12, Steps: 9 | Train Loss: 0.133 Vali Loss: 0.772 Vali Acc: 0.754 Test Loss: 0.772 Test Acc: 0.754
Validation loss decreased (-0.731877 --> -0.753615).  Saving model ...
Epoch: 13 cost time: 1.083749771118164
Epoch: 13, Steps: 9 | Train Loss: 0.069 Vali Loss: 0.780 Vali Acc: 0.783 Test Loss: 0.780 Test Acc: 0.783
Validation loss decreased (-0.753615 --> -0.782601).  Saving model ...
Epoch: 14 cost time: 1.188119649887085
Epoch: 14, Steps: 9 | Train Loss: 0.052 Vali Loss: 0.669 Vali Acc: 0.797 Test Loss: 0.669 Test Acc: 0.797
Validation loss decreased (-0.782601 --> -0.797095).  Saving model ...
Epoch: 15 cost time: 0.9692394733428955
Epoch: 15, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.835 Vali Acc: 0.783 Test Loss: 0.835 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.4627010822296143
Epoch: 16, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.772 Vali Acc: 0.746 Test Loss: 0.772 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9294357299804688
Epoch: 17, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.786 Vali Acc: 0.812 Test Loss: 0.786 Test Acc: 0.812
Validation loss decreased (-0.797095 --> -0.811586).  Saving model ...
Epoch: 18 cost time: 1.0774481296539307
Epoch: 18, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.710 Vali Acc: 0.819 Test Loss: 0.710 Test Acc: 0.819
Validation loss decreased (-0.811586 --> -0.818833).  Saving model ...
Epoch: 19 cost time: 1.1813883781433105
Epoch: 19, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.782 Vali Acc: 0.812 Test Loss: 0.782 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.40201997756958
Epoch: 20, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.896 Vali Acc: 0.797 Test Loss: 0.896 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.2363612651824951
Epoch: 21, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.734 Vali Acc: 0.819 Test Loss: 0.734 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.1328973770141602
Epoch: 22, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.840 Vali Acc: 0.804 Test Loss: 0.840 Test Acc: 0.804
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.047001838684082
Epoch: 23, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.812 Vali Acc: 0.819 Test Loss: 0.812 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.1594083309173584
Epoch: 24, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.836 Vali Acc: 0.804 Test Loss: 0.836 Test Acc: 0.804
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.2390058040618896
Epoch: 25, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.811 Vali Acc: 0.819 Test Loss: 0.811 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.9031908512115479
Epoch: 26, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.807 Vali Acc: 0.819 Test Loss: 0.807 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.9792697429656982
Epoch: 27, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.843 Vali Acc: 0.804 Test Loss: 0.843 Test Acc: 0.804
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.0050439834594727
Epoch: 28, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.844 Vali Acc: 0.804 Test Loss: 0.844 Test Acc: 0.804
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el3_dm768_df768_ps12_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8188405797101449
model parameter : 22275844
model size : 99.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el3_dm768_df768_ps13_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.1165008544921875
Epoch: 1, Steps: 9 | Train Loss: 1.444 Vali Loss: 1.276 Vali Acc: 0.370 Test Loss: 1.276 Test Acc: 0.370
Validation loss decreased (inf --> -0.369552).  Saving model ...
Epoch: 2 cost time: 1.2851231098175049
Epoch: 2, Steps: 9 | Train Loss: 1.263 Vali Loss: 1.082 Vali Acc: 0.594 Test Loss: 1.082 Test Acc: 0.594
Validation loss decreased (-0.369552 --> -0.594192).  Saving model ...
Epoch: 3 cost time: 1.2392172813415527
Epoch: 3, Steps: 9 | Train Loss: 0.990 Vali Loss: 0.925 Vali Acc: 0.630 Test Loss: 0.925 Test Acc: 0.630
Validation loss decreased (-0.594192 --> -0.630426).  Saving model ...
Epoch: 4 cost time: 1.0988779067993164
Epoch: 4, Steps: 9 | Train Loss: 0.773 Vali Loss: 0.827 Vali Acc: 0.623 Test Loss: 0.827 Test Acc: 0.623
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.088498830795288
Epoch: 5, Steps: 9 | Train Loss: 0.641 Vali Loss: 0.825 Vali Acc: 0.594 Test Loss: 0.825 Test Acc: 0.594
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1829230785369873
Epoch: 6, Steps: 9 | Train Loss: 0.486 Vali Loss: 0.708 Vali Acc: 0.688 Test Loss: 0.708 Test Acc: 0.688
Validation loss decreased (-0.630426 --> -0.688399).  Saving model ...
Epoch: 7 cost time: 1.0176167488098145
Epoch: 7, Steps: 9 | Train Loss: 0.322 Vali Loss: 0.579 Vali Acc: 0.768 Test Loss: 0.579 Test Acc: 0.768
Validation loss decreased (-0.688399 --> -0.768110).  Saving model ...
Epoch: 8 cost time: 1.2605125904083252
Epoch: 8, Steps: 9 | Train Loss: 0.211 Vali Loss: 0.821 Vali Acc: 0.645 Test Loss: 0.821 Test Acc: 0.645
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.181171178817749
Epoch: 9, Steps: 9 | Train Loss: 0.141 Vali Loss: 0.581 Vali Acc: 0.804 Test Loss: 0.581 Test Acc: 0.804
Validation loss decreased (-0.768110 --> -0.804342).  Saving model ...
Epoch: 10 cost time: 0.9760558605194092
Epoch: 10, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.812 Vali Acc: 0.783 Test Loss: 0.812 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9756827354431152
Epoch: 11, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.635 Vali Acc: 0.848 Test Loss: 0.635 Test Acc: 0.848
Validation loss decreased (-0.804342 --> -0.847820).  Saving model ...
Epoch: 12 cost time: 0.7992620468139648
Epoch: 12, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.561 Vali Acc: 0.855 Test Loss: 0.561 Test Acc: 0.855
Validation loss decreased (-0.847820 --> -0.855067).  Saving model ...
Epoch: 13 cost time: 0.8454248905181885
Epoch: 13, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.788 Vali Acc: 0.841 Test Loss: 0.788 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0614211559295654
Epoch: 14, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.581 Vali Acc: 0.819 Test Loss: 0.581 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.0607059001922607
Epoch: 15, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.884 Vali Acc: 0.804 Test Loss: 0.884 Test Acc: 0.804
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.8880846500396729
Epoch: 16, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.674 Vali Acc: 0.826 Test Loss: 0.674 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.194223165512085
Epoch: 17, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.774 Vali Acc: 0.826 Test Loss: 0.774 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.286841869354248
Epoch: 18, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.736 Vali Acc: 0.848 Test Loss: 0.736 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.998570442199707
Epoch: 19, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.686 Vali Acc: 0.855 Test Loss: 0.686 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.977780818939209
Epoch: 20, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.101 Vali Acc: 0.819 Test Loss: 1.101 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.1859815120697021
Epoch: 21, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.705 Vali Acc: 0.841 Test Loss: 0.705 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.2281887531280518
Epoch: 22, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.651 Vali Acc: 0.848 Test Loss: 0.651 Test Acc: 0.848
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el3_dm768_df768_ps13_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.855072463768116
model parameter : 22430212
model size : 100.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el3_dm768_df768_ps13_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.590355157852173
Epoch: 1, Steps: 9 | Train Loss: 1.473 Vali Loss: 1.323 Vali Acc: 0.406 Test Loss: 1.323 Test Acc: 0.406
Validation loss decreased (inf --> -0.405784).  Saving model ...
Epoch: 2 cost time: 0.832496166229248
Epoch: 2, Steps: 9 | Train Loss: 1.314 Vali Loss: 1.172 Vali Acc: 0.580 Test Loss: 1.172 Test Acc: 0.580
Validation loss decreased (-0.405784 --> -0.579698).  Saving model ...
Epoch: 3 cost time: 1.0814735889434814
Epoch: 3, Steps: 9 | Train Loss: 1.116 Vali Loss: 1.022 Vali Acc: 0.623 Test Loss: 1.022 Test Acc: 0.623
Validation loss decreased (-0.579698 --> -0.623178).  Saving model ...
Epoch: 4 cost time: 0.9762942790985107
Epoch: 4, Steps: 9 | Train Loss: 0.962 Vali Loss: 0.904 Vali Acc: 0.674 Test Loss: 0.904 Test Acc: 0.674
Validation loss decreased (-0.623178 --> -0.673904).  Saving model ...
Epoch: 5 cost time: 1.3301477432250977
Epoch: 5, Steps: 9 | Train Loss: 0.780 Vali Loss: 0.869 Vali Acc: 0.609 Test Loss: 0.869 Test Acc: 0.609
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3300633430480957
Epoch: 6, Steps: 9 | Train Loss: 0.600 Vali Loss: 0.715 Vali Acc: 0.732 Test Loss: 0.715 Test Acc: 0.732
Validation loss decreased (-0.673904 --> -0.731877).  Saving model ...
Epoch: 7 cost time: 1.1068904399871826
Epoch: 7, Steps: 9 | Train Loss: 0.519 Vali Loss: 0.799 Vali Acc: 0.674 Test Loss: 0.799 Test Acc: 0.674
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3493859767913818
Epoch: 8, Steps: 9 | Train Loss: 0.395 Vali Loss: 0.632 Vali Acc: 0.739 Test Loss: 0.632 Test Acc: 0.739
Validation loss decreased (-0.731877 --> -0.739124).  Saving model ...
Epoch: 9 cost time: 1.10866117477417
Epoch: 9, Steps: 9 | Train Loss: 0.272 Vali Loss: 0.930 Vali Acc: 0.688 Test Loss: 0.930 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0827505588531494
Epoch: 10, Steps: 9 | Train Loss: 0.192 Vali Loss: 0.564 Vali Acc: 0.783 Test Loss: 0.564 Test Acc: 0.783
Validation loss decreased (-0.739124 --> -0.782603).  Saving model ...
Epoch: 11 cost time: 1.0892212390899658
Epoch: 11, Steps: 9 | Train Loss: 0.096 Vali Loss: 0.633 Vali Acc: 0.819 Test Loss: 0.633 Test Acc: 0.819
Validation loss decreased (-0.782603 --> -0.818834).  Saving model ...
Epoch: 12 cost time: 0.9552929401397705
Epoch: 12, Steps: 9 | Train Loss: 0.045 Vali Loss: 0.813 Vali Acc: 0.819 Test Loss: 0.813 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4067444801330566
Epoch: 13, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.813 Vali Acc: 0.783 Test Loss: 0.813 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.1730411052703857
Epoch: 14, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.739 Vali Acc: 0.833 Test Loss: 0.739 Test Acc: 0.833
Validation loss decreased (-0.818834 --> -0.833326).  Saving model ...
Epoch: 15 cost time: 0.9593439102172852
Epoch: 15, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.656 Vali Acc: 0.833 Test Loss: 0.656 Test Acc: 0.833
Validation loss decreased (-0.833326 --> -0.833327).  Saving model ...
Epoch: 16 cost time: 0.9291229248046875
Epoch: 16, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.709 Vali Acc: 0.826 Test Loss: 0.709 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1431825160980225
Epoch: 17, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.709 Vali Acc: 0.833 Test Loss: 0.709 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.115682601928711
Epoch: 18, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.704 Vali Acc: 0.833 Test Loss: 0.704 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.412693977355957
Epoch: 19, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.724 Vali Acc: 0.826 Test Loss: 0.724 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.2804510593414307
Epoch: 20, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.733 Vali Acc: 0.826 Test Loss: 0.733 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.3546504974365234
Epoch: 21, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.789 Vali Acc: 0.819 Test Loss: 0.789 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.123579978942871
Epoch: 22, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.717 Vali Acc: 0.826 Test Loss: 0.717 Test Acc: 0.826
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.359539270401001
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.743 Vali Acc: 0.826 Test Loss: 0.743 Test Acc: 0.826
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.290562629699707
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.780 Vali Acc: 0.819 Test Loss: 0.780 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.1440420150756836
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.787 Vali Acc: 0.819 Test Loss: 0.787 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el3_dm768_df768_ps13_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8333333333333334
model parameter : 22333444
model size : 99.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el3_dm768_df768_ps13_str13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.710376262664795
Epoch: 1, Steps: 9 | Train Loss: 1.535 Vali Loss: 1.457 Vali Acc: 0.181 Test Loss: 1.457 Test Acc: 0.181
Validation loss decreased (inf --> -0.181145).  Saving model ...
Epoch: 2 cost time: 0.9189624786376953
Epoch: 2, Steps: 9 | Train Loss: 1.401 Vali Loss: 1.315 Vali Acc: 0.377 Test Loss: 1.315 Test Acc: 0.377
Validation loss decreased (-0.181145 --> -0.376798).  Saving model ...
Epoch: 3 cost time: 0.8503048419952393
Epoch: 3, Steps: 9 | Train Loss: 1.279 Vali Loss: 1.205 Vali Acc: 0.551 Test Loss: 1.205 Test Acc: 0.551
Validation loss decreased (-0.376798 --> -0.550713).  Saving model ...
Epoch: 4 cost time: 0.9567434787750244
Epoch: 4, Steps: 9 | Train Loss: 1.108 Vali Loss: 1.104 Vali Acc: 0.551 Test Loss: 1.104 Test Acc: 0.551
Validation loss decreased (-0.550713 --> -0.550714).  Saving model ...
Epoch: 5 cost time: 0.906728982925415
Epoch: 5, Steps: 9 | Train Loss: 0.961 Vali Loss: 1.009 Vali Acc: 0.594 Test Loss: 1.009 Test Acc: 0.594
Validation loss decreased (-0.550714 --> -0.594193).  Saving model ...
Epoch: 6 cost time: 0.9178564548492432
Epoch: 6, Steps: 9 | Train Loss: 0.829 Vali Loss: 0.955 Vali Acc: 0.609 Test Loss: 0.955 Test Acc: 0.609
Validation loss decreased (-0.594193 --> -0.608686).  Saving model ...
Epoch: 7 cost time: 0.6106045246124268
Epoch: 7, Steps: 9 | Train Loss: 0.680 Vali Loss: 0.853 Vali Acc: 0.638 Test Loss: 0.853 Test Acc: 0.638
Validation loss decreased (-0.608686 --> -0.637673).  Saving model ...
Epoch: 8 cost time: 0.8092062473297119
Epoch: 8, Steps: 9 | Train Loss: 0.575 Vali Loss: 0.860 Vali Acc: 0.623 Test Loss: 0.860 Test Acc: 0.623
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7849369049072266
Epoch: 9, Steps: 9 | Train Loss: 0.424 Vali Loss: 0.751 Vali Acc: 0.652 Test Loss: 0.751 Test Acc: 0.652
Validation loss decreased (-0.637673 --> -0.652166).  Saving model ...
Epoch: 10 cost time: 0.8634874820709229
Epoch: 10, Steps: 9 | Train Loss: 0.360 Vali Loss: 0.869 Vali Acc: 0.645 Test Loss: 0.869 Test Acc: 0.645
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7924191951751709
Epoch: 11, Steps: 9 | Train Loss: 0.241 Vali Loss: 0.669 Vali Acc: 0.768 Test Loss: 0.669 Test Acc: 0.768
Validation loss decreased (-0.652166 --> -0.768109).  Saving model ...
Epoch: 12 cost time: 0.725445032119751
Epoch: 12, Steps: 9 | Train Loss: 0.164 Vali Loss: 0.827 Vali Acc: 0.703 Test Loss: 0.827 Test Acc: 0.703
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8505682945251465
Epoch: 13, Steps: 9 | Train Loss: 0.104 Vali Loss: 0.708 Vali Acc: 0.768 Test Loss: 0.708 Test Acc: 0.768
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9221560955047607
Epoch: 14, Steps: 9 | Train Loss: 0.068 Vali Loss: 0.712 Vali Acc: 0.725 Test Loss: 0.712 Test Acc: 0.725
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.951228141784668
Epoch: 15, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.757 Vali Acc: 0.804 Test Loss: 0.757 Test Acc: 0.804
Validation loss decreased (-0.768109 --> -0.804340).  Saving model ...
Epoch: 16 cost time: 0.8067996501922607
Epoch: 16, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.688 Vali Acc: 0.746 Test Loss: 0.688 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8885095119476318
Epoch: 17, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.757 Vali Acc: 0.812 Test Loss: 0.757 Test Acc: 0.812
Validation loss decreased (-0.804340 --> -0.811587).  Saving model ...
Epoch: 18 cost time: 0.8432679176330566
Epoch: 18, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.708 Vali Acc: 0.746 Test Loss: 0.708 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8012216091156006
Epoch: 19, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.696 Vali Acc: 0.797 Test Loss: 0.696 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.967376708984375
Epoch: 20, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.860 Vali Acc: 0.783 Test Loss: 0.860 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.0956299304962158
Epoch: 21, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.747 Vali Acc: 0.804 Test Loss: 0.747 Test Acc: 0.804
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.041250467300415
Epoch: 22, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.765 Vali Acc: 0.797 Test Loss: 0.765 Test Acc: 0.797
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.8907830715179443
Epoch: 23, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.801 Vali Acc: 0.797 Test Loss: 0.801 Test Acc: 0.797
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.9348897933959961
Epoch: 24, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.797 Vali Acc: 0.804 Test Loss: 0.797 Test Acc: 0.804
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.9403932094573975
Epoch: 25, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.762 Vali Acc: 0.804 Test Loss: 0.762 Test Acc: 0.804
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.125793218612671
Epoch: 26, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.785 Vali Acc: 0.804 Test Loss: 0.785 Test Acc: 0.804
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.7855465412139893
Epoch: 27, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.797 Vali Acc: 0.804 Test Loss: 0.797 Test Acc: 0.804
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el3_dm768_df768_ps13_str13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8115942028985508
model parameter : 22273540
model size : 99.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el3_dm768_df768_ps14_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.465026617050171
Epoch: 1, Steps: 9 | Train Loss: 1.447 Vali Loss: 1.256 Vali Acc: 0.355 Test Loss: 1.256 Test Acc: 0.355
Validation loss decreased (inf --> -0.355060).  Saving model ...
Epoch: 2 cost time: 1.09218168258667
Epoch: 2, Steps: 9 | Train Loss: 1.222 Vali Loss: 1.021 Vali Acc: 0.594 Test Loss: 1.021 Test Acc: 0.594
Validation loss decreased (-0.355060 --> -0.594193).  Saving model ...
Epoch: 3 cost time: 1.1013438701629639
Epoch: 3, Steps: 9 | Train Loss: 0.934 Vali Loss: 0.807 Vali Acc: 0.717 Test Loss: 0.807 Test Acc: 0.717
Validation loss decreased (-0.594193 --> -0.717383).  Saving model ...
Epoch: 4 cost time: 1.044762134552002
Epoch: 4, Steps: 9 | Train Loss: 0.729 Vali Loss: 0.725 Vali Acc: 0.710 Test Loss: 0.725 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7385654449462891
Epoch: 5, Steps: 9 | Train Loss: 0.503 Vali Loss: 0.831 Vali Acc: 0.572 Test Loss: 0.831 Test Acc: 0.572
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.891608715057373
Epoch: 6, Steps: 9 | Train Loss: 0.377 Vali Loss: 0.520 Vali Acc: 0.804 Test Loss: 0.520 Test Acc: 0.804
Validation loss decreased (-0.717383 --> -0.804343).  Saving model ...
Epoch: 7 cost time: 1.2548694610595703
Epoch: 7, Steps: 9 | Train Loss: 0.274 Vali Loss: 0.932 Vali Acc: 0.630 Test Loss: 0.932 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1888418197631836
Epoch: 8, Steps: 9 | Train Loss: 0.262 Vali Loss: 0.484 Vali Acc: 0.804 Test Loss: 0.484 Test Acc: 0.804
Validation loss decreased (-0.804343 --> -0.804343).  Saving model ...
Epoch: 9 cost time: 1.2806396484375
Epoch: 9, Steps: 9 | Train Loss: 0.148 Vali Loss: 0.725 Vali Acc: 0.754 Test Loss: 0.725 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3186440467834473
Epoch: 10, Steps: 9 | Train Loss: 0.077 Vali Loss: 0.426 Vali Acc: 0.855 Test Loss: 0.426 Test Acc: 0.855
Validation loss decreased (-0.804343 --> -0.855068).  Saving model ...
Epoch: 11 cost time: 1.1296093463897705
Epoch: 11, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.621 Vali Acc: 0.797 Test Loss: 0.621 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3758838176727295
Epoch: 12, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.771 Vali Acc: 0.833 Test Loss: 0.771 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.2291834354400635
Epoch: 13, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.819 Vali Acc: 0.826 Test Loss: 0.819 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.2289559841156006
Epoch: 14, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.746 Vali Acc: 0.841 Test Loss: 0.746 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.3314459323883057
Epoch: 15, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.805 Vali Acc: 0.855 Test Loss: 0.805 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.4845094680786133
Epoch: 16, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.822 Vali Acc: 0.848 Test Loss: 0.822 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.7503697872161865
Epoch: 17, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.907 Vali Acc: 0.841 Test Loss: 0.907 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.4237060546875
Epoch: 18, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.052 Vali Acc: 0.848 Test Loss: 1.052 Test Acc: 0.848
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.559602975845337
Epoch: 19, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.943 Vali Acc: 0.812 Test Loss: 0.943 Test Acc: 0.812
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.4591667652130127
Epoch: 20, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.025 Vali Acc: 0.848 Test Loss: 1.025 Test Acc: 0.848
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el3_dm768_df768_ps14_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.855072463768116
model parameter : 22437124
model size : 100.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el3_dm768_df768_ps14_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.7286665439605713
Epoch: 1, Steps: 9 | Train Loss: 1.492 Vali Loss: 1.349 Vali Acc: 0.370 Test Loss: 1.349 Test Acc: 0.370
Validation loss decreased (inf --> -0.369552).  Saving model ...
Epoch: 2 cost time: 1.2619612216949463
Epoch: 2, Steps: 9 | Train Loss: 1.279 Vali Loss: 1.151 Vali Acc: 0.507 Test Loss: 1.151 Test Acc: 0.507
Validation loss decreased (-0.369552 --> -0.507235).  Saving model ...
Epoch: 3 cost time: 1.3336105346679688
Epoch: 3, Steps: 9 | Train Loss: 1.061 Vali Loss: 0.999 Vali Acc: 0.652 Test Loss: 0.999 Test Acc: 0.652
Validation loss decreased (-0.507235 --> -0.652164).  Saving model ...
Epoch: 4 cost time: 1.3487403392791748
Epoch: 4, Steps: 9 | Train Loss: 0.882 Vali Loss: 0.871 Vali Acc: 0.681 Test Loss: 0.871 Test Acc: 0.681
Validation loss decreased (-0.652164 --> -0.681151).  Saving model ...
Epoch: 5 cost time: 1.1247508525848389
Epoch: 5, Steps: 9 | Train Loss: 0.741 Vali Loss: 0.788 Vali Acc: 0.696 Test Loss: 0.788 Test Acc: 0.696
Validation loss decreased (-0.681151 --> -0.695644).  Saving model ...
Epoch: 6 cost time: 0.8575074672698975
Epoch: 6, Steps: 9 | Train Loss: 0.657 Vali Loss: 0.813 Vali Acc: 0.652 Test Loss: 0.813 Test Acc: 0.652
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1240479946136475
Epoch: 7, Steps: 9 | Train Loss: 0.463 Vali Loss: 0.617 Vali Acc: 0.739 Test Loss: 0.617 Test Acc: 0.739
Validation loss decreased (-0.695644 --> -0.739124).  Saving model ...
Epoch: 8 cost time: 1.1131892204284668
Epoch: 8, Steps: 9 | Train Loss: 0.362 Vali Loss: 0.632 Vali Acc: 0.746 Test Loss: 0.632 Test Acc: 0.746
Validation loss decreased (-0.739124 --> -0.746370).  Saving model ...
Epoch: 9 cost time: 1.2401094436645508
Epoch: 9, Steps: 9 | Train Loss: 0.229 Vali Loss: 0.683 Vali Acc: 0.739 Test Loss: 0.683 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1024675369262695
Epoch: 10, Steps: 9 | Train Loss: 0.123 Vali Loss: 0.636 Vali Acc: 0.819 Test Loss: 0.636 Test Acc: 0.819
Validation loss decreased (-0.746370 --> -0.818834).  Saving model ...
Epoch: 11 cost time: 1.3539235591888428
Epoch: 11, Steps: 9 | Train Loss: 0.087 Vali Loss: 0.914 Vali Acc: 0.739 Test Loss: 0.914 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.181217908859253
Epoch: 12, Steps: 9 | Train Loss: 0.047 Vali Loss: 0.731 Vali Acc: 0.812 Test Loss: 0.731 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.080611228942871
Epoch: 13, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.592 Vali Acc: 0.841 Test Loss: 0.592 Test Acc: 0.841
Validation loss decreased (-0.818834 --> -0.840574).  Saving model ...
Epoch: 14 cost time: 1.4468672275543213
Epoch: 14, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.819 Vali Acc: 0.819 Test Loss: 0.819 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9370558261871338
Epoch: 15, Steps: 9 | Train Loss: 0.012 Vali Loss: 1.032 Vali Acc: 0.819 Test Loss: 1.032 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.0275123119354248
Epoch: 16, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.747 Vali Acc: 0.833 Test Loss: 0.747 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.7826845645904541
Epoch: 17, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.844 Vali Acc: 0.826 Test Loss: 0.844 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.1849572658538818
Epoch: 18, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.034 Vali Acc: 0.812 Test Loss: 1.034 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.1087470054626465
Epoch: 19, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.837 Vali Acc: 0.848 Test Loss: 0.837 Test Acc: 0.848
Validation loss decreased (-0.840574 --> -0.847818).  Saving model ...
Epoch: 20 cost time: 1.1985499858856201
Epoch: 20, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.779 Vali Acc: 0.841 Test Loss: 0.779 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0227608680725098
Epoch: 21, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.785 Vali Acc: 0.833 Test Loss: 0.785 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.165165662765503
Epoch: 22, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.784 Vali Acc: 0.848 Test Loss: 0.784 Test Acc: 0.848
Validation loss decreased (-0.847818 --> -0.847818).  Saving model ...
Epoch: 23 cost time: 1.1771934032440186
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.783 Vali Acc: 0.841 Test Loss: 0.783 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.1035652160644531
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.811 Vali Acc: 0.841 Test Loss: 0.811 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.886375904083252
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.824 Vali Acc: 0.841 Test Loss: 0.824 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.082956314086914
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.813 Vali Acc: 0.841 Test Loss: 0.813 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.185102939605713
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.820 Vali Acc: 0.841 Test Loss: 0.820 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.2751901149749756
Epoch: 28, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.841 Vali Acc: 0.841 Test Loss: 0.841 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.3197021484375
Epoch: 29, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.841 Vali Acc: 0.841 Test Loss: 0.841 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.195976972579956
Epoch: 30, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.821 Vali Acc: 0.848 Test Loss: 0.821 Test Acc: 0.848
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.1377050876617432
Epoch: 31, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.817 Vali Acc: 0.848 Test Loss: 0.817 Test Acc: 0.848
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.1234910488128662
Epoch: 32, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.816 Vali Acc: 0.848 Test Loss: 0.816 Test Acc: 0.848
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el3_dm768_df768_ps14_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8478260869565217
model parameter : 22340356
model size : 99.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el3_dm768_df768_ps14_str14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.7900004386901855
Epoch: 1, Steps: 9 | Train Loss: 1.409 Vali Loss: 1.345 Vali Acc: 0.319 Test Loss: 1.345 Test Acc: 0.319
Validation loss decreased (inf --> -0.318827).  Saving model ...
Epoch: 2 cost time: 0.9982385635375977
Epoch: 2, Steps: 9 | Train Loss: 1.289 Vali Loss: 1.233 Vali Acc: 0.543 Test Loss: 1.233 Test Acc: 0.543
Validation loss decreased (-0.318827 --> -0.543466).  Saving model ...
Epoch: 3 cost time: 0.7646663188934326
Epoch: 3, Steps: 9 | Train Loss: 1.194 Vali Loss: 1.130 Vali Acc: 0.609 Test Loss: 1.130 Test Acc: 0.609
Validation loss decreased (-0.543466 --> -0.608684).  Saving model ...
Epoch: 4 cost time: 0.8420588970184326
Epoch: 4, Steps: 9 | Train Loss: 1.049 Vali Loss: 1.060 Vali Acc: 0.587 Test Loss: 1.060 Test Acc: 0.587
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8716917037963867
Epoch: 5, Steps: 9 | Train Loss: 0.910 Vali Loss: 0.921 Vali Acc: 0.696 Test Loss: 0.921 Test Acc: 0.696
Validation loss decreased (-0.608684 --> -0.695643).  Saving model ...
Epoch: 6 cost time: 0.9286956787109375
Epoch: 6, Steps: 9 | Train Loss: 0.826 Vali Loss: 0.837 Vali Acc: 0.703 Test Loss: 0.837 Test Acc: 0.703
Validation loss decreased (-0.695643 --> -0.702890).  Saving model ...
Epoch: 7 cost time: 0.8982222080230713
Epoch: 7, Steps: 9 | Train Loss: 0.648 Vali Loss: 0.790 Vali Acc: 0.681 Test Loss: 0.790 Test Acc: 0.681
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8903610706329346
Epoch: 8, Steps: 9 | Train Loss: 0.554 Vali Loss: 0.751 Vali Acc: 0.717 Test Loss: 0.751 Test Acc: 0.717
Validation loss decreased (-0.702890 --> -0.717384).  Saving model ...
Epoch: 9 cost time: 0.8922374248504639
Epoch: 9, Steps: 9 | Train Loss: 0.483 Vali Loss: 0.721 Vali Acc: 0.725 Test Loss: 0.721 Test Acc: 0.725
Validation loss decreased (-0.717384 --> -0.724630).  Saving model ...
Epoch: 10 cost time: 0.8874807357788086
Epoch: 10, Steps: 9 | Train Loss: 0.422 Vali Loss: 0.604 Vali Acc: 0.761 Test Loss: 0.604 Test Acc: 0.761
Validation loss decreased (-0.724630 --> -0.760864).  Saving model ...
Epoch: 11 cost time: 0.91628098487854
Epoch: 11, Steps: 9 | Train Loss: 0.276 Vali Loss: 0.721 Vali Acc: 0.696 Test Loss: 0.721 Test Acc: 0.696
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1450011730194092
Epoch: 12, Steps: 9 | Train Loss: 0.168 Vali Loss: 0.588 Vali Acc: 0.797 Test Loss: 0.588 Test Acc: 0.797
Validation loss decreased (-0.760864 --> -0.797096).  Saving model ...
Epoch: 13 cost time: 1.0607144832611084
Epoch: 13, Steps: 9 | Train Loss: 0.123 Vali Loss: 0.758 Vali Acc: 0.754 Test Loss: 0.758 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.019195556640625
Epoch: 14, Steps: 9 | Train Loss: 0.063 Vali Loss: 0.750 Vali Acc: 0.812 Test Loss: 0.750 Test Acc: 0.812
Validation loss decreased (-0.797096 --> -0.811587).  Saving model ...
Epoch: 15 cost time: 0.8475015163421631
Epoch: 15, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.676 Vali Acc: 0.812 Test Loss: 0.676 Test Acc: 0.812
Validation loss decreased (-0.811587 --> -0.811587).  Saving model ...
Epoch: 16 cost time: 0.9170379638671875
Epoch: 16, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.730 Vali Acc: 0.797 Test Loss: 0.730 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.951866865158081
Epoch: 17, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.708 Vali Acc: 0.797 Test Loss: 0.708 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.8779041767120361
Epoch: 18, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.761 Vali Acc: 0.797 Test Loss: 0.761 Test Acc: 0.797
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.0275356769561768
Epoch: 19, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.708 Vali Acc: 0.812 Test Loss: 0.708 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.0044379234313965
Epoch: 20, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.710 Vali Acc: 0.819 Test Loss: 0.710 Test Acc: 0.819
Validation loss decreased (-0.811587 --> -0.818833).  Saving model ...
Epoch: 21 cost time: 0.8548233509063721
Epoch: 21, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.730 Vali Acc: 0.812 Test Loss: 0.730 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8731632232666016
Epoch: 22, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.720 Vali Acc: 0.812 Test Loss: 0.720 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.9101583957672119
Epoch: 23, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.795 Vali Acc: 0.812 Test Loss: 0.795 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.0944647789001465
Epoch: 24, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.780 Vali Acc: 0.812 Test Loss: 0.780 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.883758544921875
Epoch: 25, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.777 Vali Acc: 0.812 Test Loss: 0.777 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.958559513092041
Epoch: 26, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.827 Vali Acc: 0.812 Test Loss: 0.827 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.9984171390533447
Epoch: 27, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.806 Vali Acc: 0.812 Test Loss: 0.806 Test Acc: 0.812
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.9597654342651367
Epoch: 28, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.791 Vali Acc: 0.812 Test Loss: 0.791 Test Acc: 0.812
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.982114315032959
Epoch: 29, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.808 Vali Acc: 0.812 Test Loss: 0.808 Test Acc: 0.812
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.018301010131836
Epoch: 30, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.839 Vali Acc: 0.812 Test Loss: 0.839 Test Acc: 0.812
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el3_dm768_df768_ps14_str14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8188405797101449
model parameter : 22275844
model size : 99.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el3_dm768_df768_ps15_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.8021206855773926
Epoch: 1, Steps: 9 | Train Loss: 1.484 Vali Loss: 1.339 Vali Acc: 0.297 Test Loss: 1.339 Test Acc: 0.297
Validation loss decreased (inf --> -0.297088).  Saving model ...
Epoch: 2 cost time: 1.5571880340576172
Epoch: 2, Steps: 9 | Train Loss: 1.230 Vali Loss: 1.118 Vali Acc: 0.601 Test Loss: 1.118 Test Acc: 0.601
Validation loss decreased (-0.297088 --> -0.601438).  Saving model ...
Epoch: 3 cost time: 1.2000091075897217
Epoch: 3, Steps: 9 | Train Loss: 1.001 Vali Loss: 0.966 Vali Acc: 0.558 Test Loss: 0.966 Test Acc: 0.558
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5794916152954102
Epoch: 4, Steps: 9 | Train Loss: 0.751 Vali Loss: 0.798 Vali Acc: 0.739 Test Loss: 0.798 Test Acc: 0.739
Validation loss decreased (-0.601438 --> -0.739122).  Saving model ...
Epoch: 5 cost time: 1.4533016681671143
Epoch: 5, Steps: 9 | Train Loss: 0.583 Vali Loss: 0.856 Vali Acc: 0.609 Test Loss: 0.856 Test Acc: 0.609
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7852258682250977
Epoch: 6, Steps: 9 | Train Loss: 0.488 Vali Loss: 0.727 Vali Acc: 0.703 Test Loss: 0.727 Test Acc: 0.703
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.2305662631988525
Epoch: 7, Steps: 9 | Train Loss: 0.393 Vali Loss: 0.639 Vali Acc: 0.768 Test Loss: 0.639 Test Acc: 0.768
Validation loss decreased (-0.739122 --> -0.768110).  Saving model ...
Epoch: 8 cost time: 1.4448127746582031
Epoch: 8, Steps: 9 | Train Loss: 0.277 Vali Loss: 0.621 Vali Acc: 0.783 Test Loss: 0.621 Test Acc: 0.783
Validation loss decreased (-0.768110 --> -0.782602).  Saving model ...
Epoch: 9 cost time: 1.254026174545288
Epoch: 9, Steps: 9 | Train Loss: 0.185 Vali Loss: 0.716 Vali Acc: 0.775 Test Loss: 0.716 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4092435836791992
Epoch: 10, Steps: 9 | Train Loss: 0.089 Vali Loss: 0.474 Vali Acc: 0.848 Test Loss: 0.474 Test Acc: 0.848
Validation loss decreased (-0.782602 --> -0.847821).  Saving model ...
Epoch: 11 cost time: 0.9965472221374512
Epoch: 11, Steps: 9 | Train Loss: 0.127 Vali Loss: 0.715 Vali Acc: 0.797 Test Loss: 0.715 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4614918231964111
Epoch: 12, Steps: 9 | Train Loss: 0.047 Vali Loss: 0.932 Vali Acc: 0.804 Test Loss: 0.932 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1642110347747803
Epoch: 13, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.799 Vali Acc: 0.826 Test Loss: 0.799 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.143002986907959
Epoch: 14, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.970 Vali Acc: 0.826 Test Loss: 0.970 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.3662171363830566
Epoch: 15, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.015 Vali Acc: 0.833 Test Loss: 1.015 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.4334559440612793
Epoch: 16, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.795 Vali Acc: 0.841 Test Loss: 0.795 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.3091001510620117
Epoch: 17, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.773 Vali Acc: 0.848 Test Loss: 0.773 Test Acc: 0.848
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.313368558883667
Epoch: 18, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.863 Vali Acc: 0.833 Test Loss: 0.863 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.4844491481781006
Epoch: 19, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.843 Vali Acc: 0.826 Test Loss: 0.843 Test Acc: 0.826
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.4267666339874268
Epoch: 20, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.850 Vali Acc: 0.826 Test Loss: 0.850 Test Acc: 0.826
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el3_dm768_df768_ps15_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8478260869565217
model parameter : 22439428
model size : 100.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el3_dm768_df768_ps15_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.139420747756958
Epoch: 1, Steps: 9 | Train Loss: 1.412 Vali Loss: 1.338 Vali Acc: 0.312 Test Loss: 1.338 Test Acc: 0.312
Validation loss decreased (inf --> -0.311581).  Saving model ...
Epoch: 2 cost time: 0.8331518173217773
Epoch: 2, Steps: 9 | Train Loss: 1.388 Vali Loss: 1.194 Vali Acc: 0.500 Test Loss: 1.194 Test Acc: 0.500
Validation loss decreased (-0.311581 --> -0.499988).  Saving model ...
Epoch: 3 cost time: 1.0950560569763184
Epoch: 3, Steps: 9 | Train Loss: 1.111 Vali Loss: 1.123 Vali Acc: 0.493 Test Loss: 1.123 Test Acc: 0.493
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2707905769348145
Epoch: 4, Steps: 9 | Train Loss: 0.922 Vali Loss: 0.958 Vali Acc: 0.681 Test Loss: 0.958 Test Acc: 0.681
Validation loss decreased (-0.499988 --> -0.681150).  Saving model ...
Epoch: 5 cost time: 0.9369170665740967
Epoch: 5, Steps: 9 | Train Loss: 0.794 Vali Loss: 0.891 Vali Acc: 0.594 Test Loss: 0.891 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9538726806640625
Epoch: 6, Steps: 9 | Train Loss: 0.659 Vali Loss: 0.770 Vali Acc: 0.703 Test Loss: 0.770 Test Acc: 0.703
Validation loss decreased (-0.681150 --> -0.702891).  Saving model ...
Epoch: 7 cost time: 0.9214706420898438
Epoch: 7, Steps: 9 | Train Loss: 0.522 Vali Loss: 0.758 Vali Acc: 0.638 Test Loss: 0.758 Test Acc: 0.638
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9590706825256348
Epoch: 8, Steps: 9 | Train Loss: 0.390 Vali Loss: 0.650 Vali Acc: 0.717 Test Loss: 0.650 Test Acc: 0.717
Validation loss decreased (-0.702891 --> -0.717385).  Saving model ...
Epoch: 9 cost time: 0.8789727687835693
Epoch: 9, Steps: 9 | Train Loss: 0.290 Vali Loss: 0.741 Vali Acc: 0.783 Test Loss: 0.741 Test Acc: 0.783
Validation loss decreased (-0.717385 --> -0.782601).  Saving model ...
Epoch: 10 cost time: 1.029339075088501
Epoch: 10, Steps: 9 | Train Loss: 0.201 Vali Loss: 0.555 Vali Acc: 0.797 Test Loss: 0.555 Test Acc: 0.797
Validation loss decreased (-0.782601 --> -0.797096).  Saving model ...
Epoch: 11 cost time: 0.8842751979827881
Epoch: 11, Steps: 9 | Train Loss: 0.100 Vali Loss: 0.833 Vali Acc: 0.768 Test Loss: 0.833 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1753108501434326
Epoch: 12, Steps: 9 | Train Loss: 0.073 Vali Loss: 0.661 Vali Acc: 0.819 Test Loss: 0.661 Test Acc: 0.819
Validation loss decreased (-0.797096 --> -0.818834).  Saving model ...
Epoch: 13 cost time: 1.0858709812164307
Epoch: 13, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.714 Vali Acc: 0.790 Test Loss: 0.714 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4588778018951416
Epoch: 14, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.732 Vali Acc: 0.833 Test Loss: 0.732 Test Acc: 0.833
Validation loss decreased (-0.818834 --> -0.833326).  Saving model ...
Epoch: 15 cost time: 1.4073896408081055
Epoch: 15, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.695 Vali Acc: 0.797 Test Loss: 0.695 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1469247341156006
Epoch: 16, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.770 Vali Acc: 0.819 Test Loss: 0.770 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.4058940410614014
Epoch: 17, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.775 Vali Acc: 0.812 Test Loss: 0.775 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.4094891548156738
Epoch: 18, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.815 Vali Acc: 0.826 Test Loss: 0.815 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.2399654388427734
Epoch: 19, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.792 Vali Acc: 0.819 Test Loss: 0.792 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.357231855392456
Epoch: 20, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.779 Vali Acc: 0.819 Test Loss: 0.779 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.363647222518921
Epoch: 21, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.820 Vali Acc: 0.819 Test Loss: 0.820 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.460608959197998
Epoch: 22, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.825 Vali Acc: 0.819 Test Loss: 0.825 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.067028284072876
Epoch: 23, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.771 Vali Acc: 0.819 Test Loss: 0.771 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.1264026165008545
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.794 Vali Acc: 0.819 Test Loss: 0.794 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el3_dm768_df768_ps15_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8333333333333334
model parameter : 22328836
model size : 99.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el3_dm768_df768_ps15_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.1422483921051025
Epoch: 1, Steps: 9 | Train Loss: 1.432 Vali Loss: 1.348 Vali Acc: 0.275 Test Loss: 1.348 Test Acc: 0.275
Validation loss decreased (inf --> -0.275349).  Saving model ...
Epoch: 2 cost time: 0.9754810333251953
Epoch: 2, Steps: 9 | Train Loss: 1.290 Vali Loss: 1.277 Vali Acc: 0.442 Test Loss: 1.277 Test Acc: 0.442
Validation loss decreased (-0.275349 --> -0.442016).  Saving model ...
Epoch: 3 cost time: 0.9290897846221924
Epoch: 3, Steps: 9 | Train Loss: 1.174 Vali Loss: 1.166 Vali Acc: 0.500 Test Loss: 1.166 Test Acc: 0.500
Validation loss decreased (-0.442016 --> -0.499988).  Saving model ...
Epoch: 4 cost time: 1.0824763774871826
Epoch: 4, Steps: 9 | Train Loss: 1.054 Vali Loss: 1.067 Vali Acc: 0.601 Test Loss: 1.067 Test Acc: 0.601
Validation loss decreased (-0.499988 --> -0.601439).  Saving model ...
Epoch: 5 cost time: 1.0736472606658936
Epoch: 5, Steps: 9 | Train Loss: 0.918 Vali Loss: 0.973 Vali Acc: 0.601 Test Loss: 0.973 Test Acc: 0.601
Validation loss decreased (-0.601439 --> -0.601440).  Saving model ...
Epoch: 6 cost time: 0.9738810062408447
Epoch: 6, Steps: 9 | Train Loss: 0.774 Vali Loss: 0.936 Vali Acc: 0.623 Test Loss: 0.936 Test Acc: 0.623
Validation loss decreased (-0.601440 --> -0.623179).  Saving model ...
Epoch: 7 cost time: 0.894406795501709
Epoch: 7, Steps: 9 | Train Loss: 0.680 Vali Loss: 0.795 Vali Acc: 0.667 Test Loss: 0.795 Test Acc: 0.667
Validation loss decreased (-0.623179 --> -0.666659).  Saving model ...
Epoch: 8 cost time: 0.8827235698699951
Epoch: 8, Steps: 9 | Train Loss: 0.497 Vali Loss: 0.728 Vali Acc: 0.681 Test Loss: 0.728 Test Acc: 0.681
Validation loss decreased (-0.666659 --> -0.681152).  Saving model ...
Epoch: 9 cost time: 0.942694902420044
Epoch: 9, Steps: 9 | Train Loss: 0.411 Vali Loss: 0.717 Vali Acc: 0.725 Test Loss: 0.717 Test Acc: 0.725
Validation loss decreased (-0.681152 --> -0.724631).  Saving model ...
Epoch: 10 cost time: 1.0428690910339355
Epoch: 10, Steps: 9 | Train Loss: 0.327 Vali Loss: 0.634 Vali Acc: 0.732 Test Loss: 0.634 Test Acc: 0.732
Validation loss decreased (-0.724631 --> -0.731878).  Saving model ...
Epoch: 11 cost time: 0.9491543769836426
Epoch: 11, Steps: 9 | Train Loss: 0.227 Vali Loss: 0.728 Vali Acc: 0.754 Test Loss: 0.728 Test Acc: 0.754
Validation loss decreased (-0.731878 --> -0.753616).  Saving model ...
Epoch: 12 cost time: 0.9553170204162598
Epoch: 12, Steps: 9 | Train Loss: 0.160 Vali Loss: 0.641 Vali Acc: 0.725 Test Loss: 0.641 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8803145885467529
Epoch: 13, Steps: 9 | Train Loss: 0.118 Vali Loss: 0.619 Vali Acc: 0.783 Test Loss: 0.619 Test Acc: 0.783
Validation loss decreased (-0.753616 --> -0.782603).  Saving model ...
Epoch: 14 cost time: 0.8879227638244629
Epoch: 14, Steps: 9 | Train Loss: 0.074 Vali Loss: 0.712 Vali Acc: 0.761 Test Loss: 0.712 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9179089069366455
Epoch: 15, Steps: 9 | Train Loss: 0.051 Vali Loss: 0.864 Vali Acc: 0.775 Test Loss: 0.864 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9594953060150146
Epoch: 16, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.650 Vali Acc: 0.797 Test Loss: 0.650 Test Acc: 0.797
Validation loss decreased (-0.782603 --> -0.797095).  Saving model ...
Epoch: 17 cost time: 1.007657766342163
Epoch: 17, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.740 Vali Acc: 0.790 Test Loss: 0.740 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9003894329071045
Epoch: 18, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.696 Vali Acc: 0.797 Test Loss: 0.696 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.1193995475769043
Epoch: 19, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.804 Vali Acc: 0.804 Test Loss: 0.804 Test Acc: 0.804
Validation loss decreased (-0.797095 --> -0.804340).  Saving model ...
Epoch: 20 cost time: 0.8659970760345459
Epoch: 20, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.731 Vali Acc: 0.819 Test Loss: 0.731 Test Acc: 0.819
Validation loss decreased (-0.804340 --> -0.818833).  Saving model ...
Epoch: 21 cost time: 0.8645360469818115
Epoch: 21, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.824 Vali Acc: 0.812 Test Loss: 0.824 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0346794128417969
Epoch: 22, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.755 Vali Acc: 0.812 Test Loss: 0.755 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.964085578918457
Epoch: 23, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.736 Vali Acc: 0.826 Test Loss: 0.736 Test Acc: 0.826
Validation loss decreased (-0.818833 --> -0.826080).  Saving model ...
Epoch: 24 cost time: 0.847383975982666
Epoch: 24, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.812 Vali Acc: 0.826 Test Loss: 0.812 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0331697463989258
Epoch: 25, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.822 Vali Acc: 0.841 Test Loss: 0.822 Test Acc: 0.841
Validation loss decreased (-0.826080 --> -0.840571).  Saving model ...
Epoch: 26 cost time: 1.107717752456665
Epoch: 26, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.808 Vali Acc: 0.841 Test Loss: 0.808 Test Acc: 0.841
Validation loss decreased (-0.840571 --> -0.840572).  Saving model ...
Epoch: 27 cost time: 0.854332447052002
Epoch: 27, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.824 Vali Acc: 0.833 Test Loss: 0.824 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.8652446269989014
Epoch: 28, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.836 Vali Acc: 0.833 Test Loss: 0.836 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.8720734119415283
Epoch: 29, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.781 Vali Acc: 0.826 Test Loss: 0.781 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.9232308864593506
Epoch: 30, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.831 Vali Acc: 0.833 Test Loss: 0.831 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.797476053237915
Epoch: 31, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.814 Vali Acc: 0.833 Test Loss: 0.814 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.9523661136627197
Epoch: 32, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.805 Vali Acc: 0.833 Test Loss: 0.805 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.6933319568634033
Epoch: 33, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.813 Vali Acc: 0.833 Test Loss: 0.813 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.950934648513794
Epoch: 34, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.800 Vali Acc: 0.833 Test Loss: 0.800 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.0526854991912842
Epoch: 35, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.818 Vali Acc: 0.841 Test Loss: 0.818 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.9850630760192871
Epoch: 36, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.830 Vali Acc: 0.833 Test Loss: 0.830 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el3_dm768_df768_ps15_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8405797101449275
model parameter : 22278148
model size : 99.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el3_dm768_df768_ps16_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.1583259105682373
Epoch: 1, Steps: 9 | Train Loss: 1.427 Vali Loss: 1.289 Vali Acc: 0.326 Test Loss: 1.289 Test Acc: 0.326
Validation loss decreased (inf --> -0.326074).  Saving model ...
Epoch: 2 cost time: 1.4263720512390137
Epoch: 2, Steps: 9 | Train Loss: 1.204 Vali Loss: 1.114 Vali Acc: 0.536 Test Loss: 1.114 Test Acc: 0.536
Validation loss decreased (-0.326074 --> -0.536221).  Saving model ...
Epoch: 3 cost time: 1.402799367904663
Epoch: 3, Steps: 9 | Train Loss: 0.975 Vali Loss: 0.907 Vali Acc: 0.630 Test Loss: 0.907 Test Acc: 0.630
Validation loss decreased (-0.536221 --> -0.630426).  Saving model ...
Epoch: 4 cost time: 1.2848267555236816
Epoch: 4, Steps: 9 | Train Loss: 0.723 Vali Loss: 0.996 Vali Acc: 0.558 Test Loss: 0.996 Test Acc: 0.558
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5126986503601074
Epoch: 5, Steps: 9 | Train Loss: 0.559 Vali Loss: 0.682 Vali Acc: 0.681 Test Loss: 0.682 Test Acc: 0.681
Validation loss decreased (-0.630426 --> -0.681153).  Saving model ...
Epoch: 6 cost time: 1.343855619430542
Epoch: 6, Steps: 9 | Train Loss: 0.392 Vali Loss: 0.767 Vali Acc: 0.645 Test Loss: 0.767 Test Acc: 0.645
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3724322319030762
Epoch: 7, Steps: 9 | Train Loss: 0.339 Vali Loss: 0.540 Vali Acc: 0.761 Test Loss: 0.540 Test Acc: 0.761
Validation loss decreased (-0.681153 --> -0.760864).  Saving model ...
Epoch: 8 cost time: 1.3851594924926758
Epoch: 8, Steps: 9 | Train Loss: 0.186 Vali Loss: 0.564 Vali Acc: 0.732 Test Loss: 0.564 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3505597114562988
Epoch: 9, Steps: 9 | Train Loss: 0.145 Vali Loss: 0.500 Vali Acc: 0.804 Test Loss: 0.500 Test Acc: 0.804
Validation loss decreased (-0.760864 --> -0.804343).  Saving model ...
Epoch: 10 cost time: 1.3999600410461426
Epoch: 10, Steps: 9 | Train Loss: 0.086 Vali Loss: 0.682 Vali Acc: 0.804 Test Loss: 0.682 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3103606700897217
Epoch: 11, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.635 Vali Acc: 0.841 Test Loss: 0.635 Test Acc: 0.841
Validation loss decreased (-0.804343 --> -0.840573).  Saving model ...
Epoch: 12 cost time: 1.4148504734039307
Epoch: 12, Steps: 9 | Train Loss: 0.051 Vali Loss: 0.471 Vali Acc: 0.877 Test Loss: 0.471 Test Acc: 0.877
Validation loss decreased (-0.840573 --> -0.876807).  Saving model ...
Epoch: 13 cost time: 1.3500611782073975
Epoch: 13, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.710 Vali Acc: 0.841 Test Loss: 0.710 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.5533921718597412
Epoch: 14, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.957 Vali Acc: 0.819 Test Loss: 0.957 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.4265739917755127
Epoch: 15, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.603 Vali Acc: 0.870 Test Loss: 0.603 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.3380625247955322
Epoch: 16, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.871 Vali Acc: 0.841 Test Loss: 0.871 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.5552852153778076
Epoch: 17, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.072 Vali Acc: 0.833 Test Loss: 1.072 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.3934111595153809
Epoch: 18, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.835 Vali Acc: 0.855 Test Loss: 0.835 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.4668240547180176
Epoch: 19, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.762 Vali Acc: 0.884 Test Loss: 0.762 Test Acc: 0.884
Validation loss decreased (-0.876807 --> -0.884050).  Saving model ...
Epoch: 20 cost time: 1.3703489303588867
Epoch: 20, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.811 Vali Acc: 0.862 Test Loss: 0.811 Test Acc: 0.862
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.4226384162902832
Epoch: 21, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.866 Vali Acc: 0.855 Test Loss: 0.866 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.614689826965332
Epoch: 22, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.844 Vali Acc: 0.855 Test Loss: 0.844 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.3304784297943115
Epoch: 23, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.864 Vali Acc: 0.855 Test Loss: 0.864 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.5552103519439697
Epoch: 24, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.865 Vali Acc: 0.855 Test Loss: 0.865 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.3597006797790527
Epoch: 25, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.848 Vali Acc: 0.855 Test Loss: 0.848 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.3651511669158936
Epoch: 26, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.825 Vali Acc: 0.855 Test Loss: 0.825 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.4519274234771729
Epoch: 27, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.821 Vali Acc: 0.855 Test Loss: 0.821 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.4762804508209229
Epoch: 28, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.827 Vali Acc: 0.855 Test Loss: 0.827 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.7388532161712646
Epoch: 29, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.835 Vali Acc: 0.855 Test Loss: 0.835 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el3_dm768_df768_ps16_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8840579710144928
model parameter : 22446340
model size : 100.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el3_dm768_df768_ps16_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.409208059310913
Epoch: 1, Steps: 9 | Train Loss: 1.414 Vali Loss: 1.261 Vali Acc: 0.406 Test Loss: 1.261 Test Acc: 0.406
Validation loss decreased (inf --> -0.405784).  Saving model ...
Epoch: 2 cost time: 1.3090150356292725
Epoch: 2, Steps: 9 | Train Loss: 1.227 Vali Loss: 1.125 Vali Acc: 0.529 Test Loss: 1.125 Test Acc: 0.529
Validation loss decreased (-0.405784 --> -0.528974).  Saving model ...
Epoch: 3 cost time: 0.9803967475891113
Epoch: 3, Steps: 9 | Train Loss: 1.082 Vali Loss: 1.000 Vali Acc: 0.572 Test Loss: 1.000 Test Acc: 0.572
Validation loss decreased (-0.528974 --> -0.572454).  Saving model ...
Epoch: 4 cost time: 1.1631159782409668
Epoch: 4, Steps: 9 | Train Loss: 0.885 Vali Loss: 0.916 Vali Acc: 0.623 Test Loss: 0.916 Test Acc: 0.623
Validation loss decreased (-0.572454 --> -0.623179).  Saving model ...
Epoch: 5 cost time: 1.2132015228271484
Epoch: 5, Steps: 9 | Train Loss: 0.731 Vali Loss: 0.829 Vali Acc: 0.681 Test Loss: 0.829 Test Acc: 0.681
Validation loss decreased (-0.623179 --> -0.681151).  Saving model ...
Epoch: 6 cost time: 1.2617864608764648
Epoch: 6, Steps: 9 | Train Loss: 0.581 Vali Loss: 0.735 Vali Acc: 0.688 Test Loss: 0.735 Test Acc: 0.688
Validation loss decreased (-0.681151 --> -0.688398).  Saving model ...
Epoch: 7 cost time: 1.215296745300293
Epoch: 7, Steps: 9 | Train Loss: 0.474 Vali Loss: 0.732 Vali Acc: 0.688 Test Loss: 0.732 Test Acc: 0.688
Validation loss decreased (-0.688398 --> -0.688398).  Saving model ...
Epoch: 8 cost time: 1.13175630569458
Epoch: 8, Steps: 9 | Train Loss: 0.390 Vali Loss: 0.607 Vali Acc: 0.710 Test Loss: 0.607 Test Acc: 0.710
Validation loss decreased (-0.688398 --> -0.710139).  Saving model ...
Epoch: 9 cost time: 0.9774062633514404
Epoch: 9, Steps: 9 | Train Loss: 0.277 Vali Loss: 0.647 Vali Acc: 0.732 Test Loss: 0.647 Test Acc: 0.732
Validation loss decreased (-0.710139 --> -0.731878).  Saving model ...
Epoch: 10 cost time: 0.8444743156433105
Epoch: 10, Steps: 9 | Train Loss: 0.190 Vali Loss: 0.541 Vali Acc: 0.797 Test Loss: 0.541 Test Acc: 0.797
Validation loss decreased (-0.731878 --> -0.797096).  Saving model ...
Epoch: 11 cost time: 0.9541993141174316
Epoch: 11, Steps: 9 | Train Loss: 0.119 Vali Loss: 0.589 Vali Acc: 0.804 Test Loss: 0.589 Test Acc: 0.804
Validation loss decreased (-0.797096 --> -0.804342).  Saving model ...
Epoch: 12 cost time: 1.0548169612884521
Epoch: 12, Steps: 9 | Train Loss: 0.079 Vali Loss: 0.656 Vali Acc: 0.812 Test Loss: 0.656 Test Acc: 0.812
Validation loss decreased (-0.804342 --> -0.811588).  Saving model ...
Epoch: 13 cost time: 1.059950828552246
Epoch: 13, Steps: 9 | Train Loss: 0.063 Vali Loss: 0.678 Vali Acc: 0.812 Test Loss: 0.678 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0974657535552979
Epoch: 14, Steps: 9 | Train Loss: 0.034 Vali Loss: 0.718 Vali Acc: 0.804 Test Loss: 0.718 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.298187017440796
Epoch: 15, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.674 Vali Acc: 0.833 Test Loss: 0.674 Test Acc: 0.833
Validation loss decreased (-0.811588 --> -0.833327).  Saving model ...
Epoch: 16 cost time: 1.242884874343872
Epoch: 16, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.660 Vali Acc: 0.848 Test Loss: 0.660 Test Acc: 0.848
Validation loss decreased (-0.833327 --> -0.847819).  Saving model ...
Epoch: 17 cost time: 1.2356197834014893
Epoch: 17, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.761 Vali Acc: 0.833 Test Loss: 0.761 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1592586040496826
Epoch: 18, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.571 Vali Acc: 0.862 Test Loss: 0.571 Test Acc: 0.862
Validation loss decreased (-0.847819 --> -0.862313).  Saving model ...
Epoch: 19 cost time: 0.9571855068206787
Epoch: 19, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.728 Vali Acc: 0.833 Test Loss: 0.728 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.938133716583252
Epoch: 20, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.725 Vali Acc: 0.855 Test Loss: 0.725 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.9873878955841064
Epoch: 21, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.736 Vali Acc: 0.862 Test Loss: 0.736 Test Acc: 0.862
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.0261874198913574
Epoch: 22, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.745 Vali Acc: 0.833 Test Loss: 0.745 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.058056116104126
Epoch: 23, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.720 Vali Acc: 0.848 Test Loss: 0.720 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.054626703262329
Epoch: 24, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.716 Vali Acc: 0.855 Test Loss: 0.716 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.0475480556488037
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.750 Vali Acc: 0.855 Test Loss: 0.750 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.144895315170288
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.767 Vali Acc: 0.855 Test Loss: 0.767 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.0427958965301514
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.752 Vali Acc: 0.855 Test Loss: 0.752 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.1620380878448486
Epoch: 28, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.731 Vali Acc: 0.855 Test Loss: 0.731 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el3_dm768_df768_ps16_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8623188405797102
model parameter : 22335748
model size : 99.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el3_dm768_df768_ps16_str16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.132827043533325
Epoch: 1, Steps: 9 | Train Loss: 1.501 Vali Loss: 1.440 Vali Acc: 0.254 Test Loss: 1.440 Test Acc: 0.254
Validation loss decreased (inf --> -0.253609).  Saving model ...
Epoch: 2 cost time: 0.9801023006439209
Epoch: 2, Steps: 9 | Train Loss: 1.374 Vali Loss: 1.342 Vali Acc: 0.333 Test Loss: 1.342 Test Acc: 0.333
Validation loss decreased (-0.253609 --> -0.333320).  Saving model ...
Epoch: 3 cost time: 0.8799941539764404
Epoch: 3, Steps: 9 | Train Loss: 1.238 Vali Loss: 1.216 Vali Acc: 0.478 Test Loss: 1.216 Test Acc: 0.478
Validation loss decreased (-0.333320 --> -0.478249).  Saving model ...
Epoch: 4 cost time: 0.903846263885498
Epoch: 4, Steps: 9 | Train Loss: 1.133 Vali Loss: 1.108 Vali Acc: 0.551 Test Loss: 1.108 Test Acc: 0.551
Validation loss decreased (-0.478249 --> -0.550714).  Saving model ...
Epoch: 5 cost time: 0.8805675506591797
Epoch: 5, Steps: 9 | Train Loss: 0.965 Vali Loss: 1.022 Vali Acc: 0.638 Test Loss: 1.022 Test Acc: 0.638
Validation loss decreased (-0.550714 --> -0.637671).  Saving model ...
Epoch: 6 cost time: 1.026068925857544
Epoch: 6, Steps: 9 | Train Loss: 0.827 Vali Loss: 0.913 Vali Acc: 0.630 Test Loss: 0.913 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7629799842834473
Epoch: 7, Steps: 9 | Train Loss: 0.738 Vali Loss: 0.828 Vali Acc: 0.674 Test Loss: 0.828 Test Acc: 0.674
Validation loss decreased (-0.637671 --> -0.673905).  Saving model ...
Epoch: 8 cost time: 0.959815502166748
Epoch: 8, Steps: 9 | Train Loss: 0.646 Vali Loss: 0.784 Vali Acc: 0.667 Test Loss: 0.784 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.964005708694458
Epoch: 9, Steps: 9 | Train Loss: 0.495 Vali Loss: 0.681 Vali Acc: 0.696 Test Loss: 0.681 Test Acc: 0.696
Validation loss decreased (-0.673905 --> -0.695645).  Saving model ...
Epoch: 10 cost time: 1.0393905639648438
Epoch: 10, Steps: 9 | Train Loss: 0.380 Vali Loss: 0.672 Vali Acc: 0.703 Test Loss: 0.672 Test Acc: 0.703
Validation loss decreased (-0.695645 --> -0.702892).  Saving model ...
Epoch: 11 cost time: 0.9821252822875977
Epoch: 11, Steps: 9 | Train Loss: 0.264 Vali Loss: 0.557 Vali Acc: 0.775 Test Loss: 0.557 Test Acc: 0.775
Validation loss decreased (-0.702892 --> -0.775357).  Saving model ...
Epoch: 12 cost time: 1.0183079242706299
Epoch: 12, Steps: 9 | Train Loss: 0.181 Vali Loss: 0.600 Vali Acc: 0.783 Test Loss: 0.600 Test Acc: 0.783
Validation loss decreased (-0.775357 --> -0.782603).  Saving model ...
Epoch: 13 cost time: 1.0361194610595703
Epoch: 13, Steps: 9 | Train Loss: 0.118 Vali Loss: 0.650 Vali Acc: 0.804 Test Loss: 0.650 Test Acc: 0.804
Validation loss decreased (-0.782603 --> -0.804341).  Saving model ...
Epoch: 14 cost time: 0.9452791213989258
Epoch: 14, Steps: 9 | Train Loss: 0.085 Vali Loss: 0.653 Vali Acc: 0.797 Test Loss: 0.653 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8807673454284668
Epoch: 15, Steps: 9 | Train Loss: 0.060 Vali Loss: 0.802 Vali Acc: 0.783 Test Loss: 0.802 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.8950014114379883
Epoch: 16, Steps: 9 | Train Loss: 0.035 Vali Loss: 0.622 Vali Acc: 0.797 Test Loss: 0.622 Test Acc: 0.797
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.8921632766723633
Epoch: 17, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.809 Vali Acc: 0.819 Test Loss: 0.809 Test Acc: 0.819
Validation loss decreased (-0.804341 --> -0.818832).  Saving model ...
Epoch: 18 cost time: 0.964996337890625
Epoch: 18, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.766 Vali Acc: 0.804 Test Loss: 0.766 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9470465183258057
Epoch: 19, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.834 Vali Acc: 0.797 Test Loss: 0.834 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8286879062652588
Epoch: 20, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.723 Vali Acc: 0.804 Test Loss: 0.723 Test Acc: 0.804
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.8563704490661621
Epoch: 21, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.795 Vali Acc: 0.812 Test Loss: 0.795 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.9035873413085938
Epoch: 22, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.819 Vali Acc: 0.812 Test Loss: 0.819 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.992506742477417
Epoch: 23, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.818 Vali Acc: 0.819 Test Loss: 0.818 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.8702373504638672
Epoch: 24, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.850 Vali Acc: 0.804 Test Loss: 0.850 Test Acc: 0.804
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.7539222240447998
Epoch: 25, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.787 Vali Acc: 0.812 Test Loss: 0.787 Test Acc: 0.812
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.9028463363647461
Epoch: 26, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.795 Vali Acc: 0.819 Test Loss: 0.795 Test Acc: 0.819
Validation loss decreased (-0.818832 --> -0.818833).  Saving model ...
Epoch: 27 cost time: 0.9003293514251709
Epoch: 27, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.830 Vali Acc: 0.812 Test Loss: 0.830 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.7550270557403564
Epoch: 28, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.809 Vali Acc: 0.819 Test Loss: 0.809 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.8543133735656738
Epoch: 29, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.836 Vali Acc: 0.819 Test Loss: 0.836 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.0798718929290771
Epoch: 30, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.844 Vali Acc: 0.804 Test Loss: 0.844 Test Acc: 0.804
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.0528020858764648
Epoch: 31, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.859 Vali Acc: 0.812 Test Loss: 0.859 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.9099442958831787
Epoch: 32, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.852 Vali Acc: 0.826 Test Loss: 0.852 Test Acc: 0.826
Validation loss decreased (-0.818833 --> -0.826078).  Saving model ...
Epoch: 33 cost time: 1.032745361328125
Epoch: 33, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.857 Vali Acc: 0.826 Test Loss: 0.857 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.1804466247558594
Epoch: 34, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.832 Vali Acc: 0.833 Test Loss: 0.832 Test Acc: 0.833
Validation loss decreased (-0.826078 --> -0.833325).  Saving model ...
Epoch: 35 cost time: 0.7695088386535645
Epoch: 35, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.828 Vali Acc: 0.812 Test Loss: 0.828 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.9573976993560791
Epoch: 36, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.860 Vali Acc: 0.812 Test Loss: 0.860 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.0427947044372559
Epoch: 37, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.847 Vali Acc: 0.812 Test Loss: 0.847 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.1035621166229248
Epoch: 38, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.881 Vali Acc: 0.819 Test Loss: 0.881 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.9345417022705078
Epoch: 39, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.863 Vali Acc: 0.826 Test Loss: 0.863 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.7978880405426025
Epoch: 40, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.902 Vali Acc: 0.804 Test Loss: 0.902 Test Acc: 0.804
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.917771577835083
Epoch: 41, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.908 Vali Acc: 0.812 Test Loss: 0.908 Test Acc: 0.812
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.9465224742889404
Epoch: 42, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.889 Vali Acc: 0.819 Test Loss: 0.889 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.9187197685241699
Epoch: 43, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.879 Vali Acc: 0.833 Test Loss: 0.879 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.8394498825073242
Epoch: 44, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.889 Vali Acc: 0.826 Test Loss: 0.889 Test Acc: 0.826
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el3_dm768_df768_ps16_str16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8333333333333334
model parameter : 22280452
model size : 99.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el3_dm768_df768_ps18_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.348569393157959
Epoch: 1, Steps: 9 | Train Loss: 1.510 Vali Loss: 1.264 Vali Acc: 0.471 Test Loss: 1.264 Test Acc: 0.471
Validation loss decreased (inf --> -0.471002).  Saving model ...
Epoch: 2 cost time: 1.0846483707427979
Epoch: 2, Steps: 9 | Train Loss: 1.209 Vali Loss: 1.120 Vali Acc: 0.565 Test Loss: 1.120 Test Acc: 0.565
Validation loss decreased (-0.471002 --> -0.565206).  Saving model ...
Epoch: 3 cost time: 1.2984552383422852
Epoch: 3, Steps: 9 | Train Loss: 0.932 Vali Loss: 0.942 Vali Acc: 0.601 Test Loss: 0.942 Test Acc: 0.601
Validation loss decreased (-0.565206 --> -0.601440).  Saving model ...
Epoch: 4 cost time: 1.1450140476226807
Epoch: 4, Steps: 9 | Train Loss: 0.815 Vali Loss: 0.909 Vali Acc: 0.616 Test Loss: 0.909 Test Acc: 0.616
Validation loss decreased (-0.601440 --> -0.615933).  Saving model ...
Epoch: 5 cost time: 1.0073397159576416
Epoch: 5, Steps: 9 | Train Loss: 0.694 Vali Loss: 0.752 Vali Acc: 0.696 Test Loss: 0.752 Test Acc: 0.696
Validation loss decreased (-0.615933 --> -0.695645).  Saving model ...
Epoch: 6 cost time: 1.1183550357818604
Epoch: 6, Steps: 9 | Train Loss: 0.593 Vali Loss: 0.794 Vali Acc: 0.667 Test Loss: 0.794 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0735831260681152
Epoch: 7, Steps: 9 | Train Loss: 0.391 Vali Loss: 0.666 Vali Acc: 0.775 Test Loss: 0.666 Test Acc: 0.775
Validation loss decreased (-0.695645 --> -0.775356).  Saving model ...
Epoch: 8 cost time: 1.1629002094268799
Epoch: 8, Steps: 9 | Train Loss: 0.310 Vali Loss: 0.710 Vali Acc: 0.710 Test Loss: 0.710 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2055890560150146
Epoch: 9, Steps: 9 | Train Loss: 0.257 Vali Loss: 0.508 Vali Acc: 0.804 Test Loss: 0.508 Test Acc: 0.804
Validation loss decreased (-0.775356 --> -0.804343).  Saving model ...
Epoch: 10 cost time: 1.113016128540039
Epoch: 10, Steps: 9 | Train Loss: 0.127 Vali Loss: 0.733 Vali Acc: 0.797 Test Loss: 0.733 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.138878345489502
Epoch: 11, Steps: 9 | Train Loss: 0.076 Vali Loss: 0.631 Vali Acc: 0.812 Test Loss: 0.631 Test Acc: 0.812
Validation loss decreased (-0.804343 --> -0.811588).  Saving model ...
Epoch: 12 cost time: 1.1921117305755615
Epoch: 12, Steps: 9 | Train Loss: 0.042 Vali Loss: 0.839 Vali Acc: 0.812 Test Loss: 0.839 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.228785514831543
Epoch: 13, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.643 Vali Acc: 0.855 Test Loss: 0.643 Test Acc: 0.855
Validation loss decreased (-0.811588 --> -0.855066).  Saving model ...
Epoch: 14 cost time: 1.209115743637085
Epoch: 14, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.850 Vali Acc: 0.841 Test Loss: 0.850 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0630428791046143
Epoch: 15, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.816 Vali Acc: 0.848 Test Loss: 0.816 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.2682933807373047
Epoch: 16, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.782 Vali Acc: 0.841 Test Loss: 0.782 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.0677754878997803
Epoch: 17, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.846 Vali Acc: 0.841 Test Loss: 0.846 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.1502363681793213
Epoch: 18, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.980 Vali Acc: 0.819 Test Loss: 0.980 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.0824005603790283
Epoch: 19, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.833 Vali Acc: 0.855 Test Loss: 0.833 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.133239984512329
Epoch: 20, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.858 Vali Acc: 0.848 Test Loss: 0.858 Test Acc: 0.848
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.3564705848693848
Epoch: 21, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.961 Vali Acc: 0.841 Test Loss: 0.961 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.297530174255371
Epoch: 22, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.883 Vali Acc: 0.855 Test Loss: 0.883 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.2138409614562988
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.902 Vali Acc: 0.862 Test Loss: 0.902 Test Acc: 0.862
Validation loss decreased (-0.855066 --> -0.862310).  Saving model ...
Epoch: 24 cost time: 1.372044563293457
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.021 Vali Acc: 0.855 Test Loss: 1.021 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.252201795578003
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 1.027 Vali Acc: 0.855 Test Loss: 1.027 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.1836113929748535
Epoch: 26, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.945 Vali Acc: 0.855 Test Loss: 0.945 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.9479193687438965
Epoch: 27, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.875 Vali Acc: 0.855 Test Loss: 0.875 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.3379004001617432
Epoch: 28, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.905 Vali Acc: 0.848 Test Loss: 0.905 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.238278865814209
Epoch: 29, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.927 Vali Acc: 0.848 Test Loss: 0.927 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.2684016227722168
Epoch: 30, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.930 Vali Acc: 0.848 Test Loss: 0.930 Test Acc: 0.848
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.297799825668335
Epoch: 31, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.926 Vali Acc: 0.848 Test Loss: 0.926 Test Acc: 0.848
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.510878086090088
Epoch: 32, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.938 Vali Acc: 0.848 Test Loss: 0.938 Test Acc: 0.848
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.4224400520324707
Epoch: 33, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.954 Vali Acc: 0.848 Test Loss: 0.954 Test Acc: 0.848
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el3_dm768_df768_ps18_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8623188405797102
model parameter : 22414084
model size : 100.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el3_dm768_df768_ps18_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.2370152473449707
Epoch: 1, Steps: 9 | Train Loss: 1.448 Vali Loss: 1.284 Vali Acc: 0.355 Test Loss: 1.284 Test Acc: 0.355
Validation loss decreased (inf --> -0.355060).  Saving model ...
Epoch: 2 cost time: 1.202408790588379
Epoch: 2, Steps: 9 | Train Loss: 1.262 Vali Loss: 1.131 Vali Acc: 0.471 Test Loss: 1.131 Test Acc: 0.471
Validation loss decreased (-0.355060 --> -0.471003).  Saving model ...
Epoch: 3 cost time: 1.1009128093719482
Epoch: 3, Steps: 9 | Train Loss: 1.050 Vali Loss: 1.029 Vali Acc: 0.558 Test Loss: 1.029 Test Acc: 0.558
Validation loss decreased (-0.471003 --> -0.557961).  Saving model ...
Epoch: 4 cost time: 1.2115652561187744
Epoch: 4, Steps: 9 | Train Loss: 0.883 Vali Loss: 0.962 Vali Acc: 0.609 Test Loss: 0.962 Test Acc: 0.609
Validation loss decreased (-0.557961 --> -0.608686).  Saving model ...
Epoch: 5 cost time: 1.2778632640838623
Epoch: 5, Steps: 9 | Train Loss: 0.782 Vali Loss: 0.847 Vali Acc: 0.667 Test Loss: 0.847 Test Acc: 0.667
Validation loss decreased (-0.608686 --> -0.666658).  Saving model ...
Epoch: 6 cost time: 1.3936336040496826
Epoch: 6, Steps: 9 | Train Loss: 0.662 Vali Loss: 0.799 Vali Acc: 0.710 Test Loss: 0.799 Test Acc: 0.710
Validation loss decreased (-0.666658 --> -0.710137).  Saving model ...
Epoch: 7 cost time: 1.187885046005249
Epoch: 7, Steps: 9 | Train Loss: 0.573 Vali Loss: 0.749 Vali Acc: 0.710 Test Loss: 0.749 Test Acc: 0.710
Validation loss decreased (-0.710137 --> -0.710137).  Saving model ...
Epoch: 8 cost time: 1.2519865036010742
Epoch: 8, Steps: 9 | Train Loss: 0.452 Vali Loss: 0.702 Vali Acc: 0.674 Test Loss: 0.702 Test Acc: 0.674
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0995235443115234
Epoch: 9, Steps: 9 | Train Loss: 0.345 Vali Loss: 0.714 Vali Acc: 0.732 Test Loss: 0.714 Test Acc: 0.732
Validation loss decreased (-0.710137 --> -0.731877).  Saving model ...
Epoch: 10 cost time: 0.9657776355743408
Epoch: 10, Steps: 9 | Train Loss: 0.282 Vali Loss: 0.706 Vali Acc: 0.710 Test Loss: 0.706 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0175440311431885
Epoch: 11, Steps: 9 | Train Loss: 0.232 Vali Loss: 0.649 Vali Acc: 0.804 Test Loss: 0.649 Test Acc: 0.804
Validation loss decreased (-0.731877 --> -0.804341).  Saving model ...
Epoch: 12 cost time: 1.3549442291259766
Epoch: 12, Steps: 9 | Train Loss: 0.121 Vali Loss: 0.685 Vali Acc: 0.746 Test Loss: 0.685 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3719089031219482
Epoch: 13, Steps: 9 | Train Loss: 0.068 Vali Loss: 0.765 Vali Acc: 0.826 Test Loss: 0.765 Test Acc: 0.826
Validation loss decreased (-0.804341 --> -0.826079).  Saving model ...
Epoch: 14 cost time: 1.4895896911621094
Epoch: 14, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.854 Vali Acc: 0.754 Test Loss: 0.854 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.266813039779663
Epoch: 15, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.682 Vali Acc: 0.841 Test Loss: 0.682 Test Acc: 0.841
Validation loss decreased (-0.826079 --> -0.840573).  Saving model ...
Epoch: 16 cost time: 1.239861011505127
Epoch: 16, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.818 Vali Acc: 0.826 Test Loss: 0.818 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1661136150360107
Epoch: 17, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.918 Vali Acc: 0.775 Test Loss: 0.918 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.1740856170654297
Epoch: 18, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.791 Vali Acc: 0.841 Test Loss: 0.791 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.2655291557312012
Epoch: 19, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.825 Vali Acc: 0.826 Test Loss: 0.825 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.0321602821350098
Epoch: 20, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.864 Vali Acc: 0.819 Test Loss: 0.864 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.0647838115692139
Epoch: 21, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.825 Vali Acc: 0.841 Test Loss: 0.825 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.533522129058838
Epoch: 22, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.850 Vali Acc: 0.826 Test Loss: 0.850 Test Acc: 0.826
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.0454623699188232
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.903 Vali Acc: 0.819 Test Loss: 0.903 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.1035265922546387
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.928 Vali Acc: 0.819 Test Loss: 0.928 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.3408489227294922
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.891 Vali Acc: 0.826 Test Loss: 0.891 Test Acc: 0.826
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el3_dm768_df768_ps18_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8405797101449275
model parameter : 22335748
model size : 99.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el3_dm768_df768_ps18_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.0410890579223633
Epoch: 1, Steps: 9 | Train Loss: 1.495 Vali Loss: 1.386 Vali Acc: 0.225 Test Loss: 1.386 Test Acc: 0.225
Validation loss decreased (inf --> -0.224624).  Saving model ...
Epoch: 2 cost time: 0.8308742046356201
Epoch: 2, Steps: 9 | Train Loss: 1.381 Vali Loss: 1.285 Vali Acc: 0.341 Test Loss: 1.285 Test Acc: 0.341
Validation loss decreased (-0.224624 --> -0.340567).  Saving model ...
Epoch: 3 cost time: 1.0621411800384521
Epoch: 3, Steps: 9 | Train Loss: 1.250 Vali Loss: 1.185 Vali Acc: 0.399 Test Loss: 1.185 Test Acc: 0.399
Validation loss decreased (-0.340567 --> -0.398539).  Saving model ...
Epoch: 4 cost time: 0.8533124923706055
Epoch: 4, Steps: 9 | Train Loss: 1.112 Vali Loss: 1.081 Vali Acc: 0.493 Test Loss: 1.081 Test Acc: 0.493
Validation loss decreased (-0.398539 --> -0.492743).  Saving model ...
Epoch: 5 cost time: 0.85318922996521
Epoch: 5, Steps: 9 | Train Loss: 0.983 Vali Loss: 1.004 Vali Acc: 0.529 Test Loss: 1.004 Test Acc: 0.529
Validation loss decreased (-0.492743 --> -0.528975).  Saving model ...
Epoch: 6 cost time: 0.9146575927734375
Epoch: 6, Steps: 9 | Train Loss: 0.865 Vali Loss: 0.925 Vali Acc: 0.609 Test Loss: 0.925 Test Acc: 0.609
Validation loss decreased (-0.528975 --> -0.608686).  Saving model ...
Epoch: 7 cost time: 0.8096010684967041
Epoch: 7, Steps: 9 | Train Loss: 0.753 Vali Loss: 0.874 Vali Acc: 0.674 Test Loss: 0.874 Test Acc: 0.674
Validation loss decreased (-0.608686 --> -0.673904).  Saving model ...
Epoch: 8 cost time: 0.9403300285339355
Epoch: 8, Steps: 9 | Train Loss: 0.636 Vali Loss: 0.785 Vali Acc: 0.710 Test Loss: 0.785 Test Acc: 0.710
Validation loss decreased (-0.673904 --> -0.710137).  Saving model ...
Epoch: 9 cost time: 0.9095277786254883
Epoch: 9, Steps: 9 | Train Loss: 0.556 Vali Loss: 0.769 Vali Acc: 0.761 Test Loss: 0.769 Test Acc: 0.761
Validation loss decreased (-0.710137 --> -0.760862).  Saving model ...
Epoch: 10 cost time: 0.8497512340545654
Epoch: 10, Steps: 9 | Train Loss: 0.443 Vali Loss: 0.712 Vali Acc: 0.710 Test Loss: 0.712 Test Acc: 0.710
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9849123954772949
Epoch: 11, Steps: 9 | Train Loss: 0.348 Vali Loss: 0.633 Vali Acc: 0.775 Test Loss: 0.633 Test Acc: 0.775
Validation loss decreased (-0.760862 --> -0.775356).  Saving model ...
Epoch: 12 cost time: 1.1801955699920654
Epoch: 12, Steps: 9 | Train Loss: 0.265 Vali Loss: 0.562 Vali Acc: 0.797 Test Loss: 0.562 Test Acc: 0.797
Validation loss decreased (-0.775356 --> -0.797096).  Saving model ...
Epoch: 13 cost time: 0.9727098941802979
Epoch: 13, Steps: 9 | Train Loss: 0.151 Vali Loss: 0.711 Vali Acc: 0.768 Test Loss: 0.711 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9941136837005615
Epoch: 14, Steps: 9 | Train Loss: 0.092 Vali Loss: 0.696 Vali Acc: 0.804 Test Loss: 0.696 Test Acc: 0.804
Validation loss decreased (-0.797096 --> -0.804341).  Saving model ...
Epoch: 15 cost time: 1.002152919769287
Epoch: 15, Steps: 9 | Train Loss: 0.067 Vali Loss: 0.725 Vali Acc: 0.790 Test Loss: 0.725 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0677847862243652
Epoch: 16, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.674 Vali Acc: 0.804 Test Loss: 0.674 Test Acc: 0.804
Validation loss decreased (-0.804341 --> -0.804341).  Saving model ...
Epoch: 17 cost time: 1.0564143657684326
Epoch: 17, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.762 Vali Acc: 0.797 Test Loss: 0.762 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9969587326049805
Epoch: 18, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.773 Vali Acc: 0.783 Test Loss: 0.773 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.8709721565246582
Epoch: 19, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.703 Vali Acc: 0.804 Test Loss: 0.703 Test Acc: 0.804
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.087822675704956
Epoch: 20, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.769 Vali Acc: 0.797 Test Loss: 0.769 Test Acc: 0.797
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.0977354049682617
Epoch: 21, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.800 Vali Acc: 0.790 Test Loss: 0.800 Test Acc: 0.790
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.9317824840545654
Epoch: 22, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.777 Vali Acc: 0.812 Test Loss: 0.777 Test Acc: 0.812
Validation loss decreased (-0.804341 --> -0.811586).  Saving model ...
Epoch: 23 cost time: 0.9861752986907959
Epoch: 23, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.866 Vali Acc: 0.812 Test Loss: 0.866 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.0600175857543945
Epoch: 24, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.847 Vali Acc: 0.804 Test Loss: 0.847 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.9260094165802002
Epoch: 25, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.829 Vali Acc: 0.797 Test Loss: 0.829 Test Acc: 0.797
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.0040650367736816
Epoch: 26, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.850 Vali Acc: 0.804 Test Loss: 0.850 Test Acc: 0.804
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.0206246376037598
Epoch: 27, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.910 Vali Acc: 0.804 Test Loss: 0.910 Test Acc: 0.804
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.1283583641052246
Epoch: 28, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.894 Vali Acc: 0.812 Test Loss: 0.894 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.9334578514099121
Epoch: 29, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.866 Vali Acc: 0.804 Test Loss: 0.866 Test Acc: 0.804
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.8532252311706543
Epoch: 30, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.859 Vali Acc: 0.812 Test Loss: 0.859 Test Acc: 0.812
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.907062292098999
Epoch: 31, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.872 Vali Acc: 0.804 Test Loss: 0.872 Test Acc: 0.804
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.8567090034484863
Epoch: 32, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.885 Vali Acc: 0.804 Test Loss: 0.885 Test Acc: 0.804
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el3_dm768_df768_ps18_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8115942028985508
model parameter : 22289668
model size : 99.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el3_dm768_df768_ps19_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.4445629119873047
Epoch: 1, Steps: 9 | Train Loss: 1.397 Vali Loss: 1.367 Vali Acc: 0.254 Test Loss: 1.367 Test Acc: 0.254
Validation loss decreased (inf --> -0.253610).  Saving model ...
Epoch: 2 cost time: 1.1336612701416016
Epoch: 2, Steps: 9 | Train Loss: 1.228 Vali Loss: 1.175 Vali Acc: 0.500 Test Loss: 1.175 Test Acc: 0.500
Validation loss decreased (-0.253610 --> -0.499988).  Saving model ...
Epoch: 3 cost time: 1.0218837261199951
Epoch: 3, Steps: 9 | Train Loss: 1.000 Vali Loss: 1.014 Vali Acc: 0.558 Test Loss: 1.014 Test Acc: 0.558
Validation loss decreased (-0.499988 --> -0.557961).  Saving model ...
Epoch: 4 cost time: 1.0124845504760742
Epoch: 4, Steps: 9 | Train Loss: 0.737 Vali Loss: 0.872 Vali Acc: 0.667 Test Loss: 0.872 Test Acc: 0.667
Validation loss decreased (-0.557961 --> -0.666658).  Saving model ...
Epoch: 5 cost time: 0.8107924461364746
Epoch: 5, Steps: 9 | Train Loss: 0.619 Vali Loss: 0.807 Vali Acc: 0.674 Test Loss: 0.807 Test Acc: 0.674
Validation loss decreased (-0.666658 --> -0.673905).  Saving model ...
Epoch: 6 cost time: 1.0445311069488525
Epoch: 6, Steps: 9 | Train Loss: 0.515 Vali Loss: 0.671 Vali Acc: 0.739 Test Loss: 0.671 Test Acc: 0.739
Validation loss decreased (-0.673905 --> -0.739124).  Saving model ...
Epoch: 7 cost time: 1.0152184963226318
Epoch: 7, Steps: 9 | Train Loss: 0.311 Vali Loss: 0.749 Vali Acc: 0.725 Test Loss: 0.749 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2465102672576904
Epoch: 8, Steps: 9 | Train Loss: 0.240 Vali Loss: 0.752 Vali Acc: 0.717 Test Loss: 0.752 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.085324764251709
Epoch: 9, Steps: 9 | Train Loss: 0.155 Vali Loss: 0.644 Vali Acc: 0.761 Test Loss: 0.644 Test Acc: 0.761
Validation loss decreased (-0.739124 --> -0.760863).  Saving model ...
Epoch: 10 cost time: 0.9773595333099365
Epoch: 10, Steps: 9 | Train Loss: 0.148 Vali Loss: 0.856 Vali Acc: 0.783 Test Loss: 0.856 Test Acc: 0.783
Validation loss decreased (-0.760863 --> -0.782600).  Saving model ...
Epoch: 11 cost time: 0.9932858943939209
Epoch: 11, Steps: 9 | Train Loss: 0.058 Vali Loss: 0.751 Vali Acc: 0.797 Test Loss: 0.751 Test Acc: 0.797
Validation loss decreased (-0.782600 --> -0.797094).  Saving model ...
Epoch: 12 cost time: 1.1809451580047607
Epoch: 12, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.866 Vali Acc: 0.797 Test Loss: 0.866 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9967997074127197
Epoch: 13, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.852 Vali Acc: 0.819 Test Loss: 0.852 Test Acc: 0.819
Validation loss decreased (-0.797094 --> -0.818832).  Saving model ...
Epoch: 14 cost time: 1.2486140727996826
Epoch: 14, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.767 Vali Acc: 0.819 Test Loss: 0.767 Test Acc: 0.819
Validation loss decreased (-0.818832 --> -0.818833).  Saving model ...
Epoch: 15 cost time: 1.2871816158294678
Epoch: 15, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.744 Vali Acc: 0.833 Test Loss: 0.744 Test Acc: 0.833
Validation loss decreased (-0.818833 --> -0.833326).  Saving model ...
Epoch: 16 cost time: 1.2027454376220703
Epoch: 16, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.783 Vali Acc: 0.826 Test Loss: 0.783 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3033852577209473
Epoch: 17, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.841 Vali Acc: 0.819 Test Loss: 0.841 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.0428688526153564
Epoch: 18, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.863 Vali Acc: 0.833 Test Loss: 0.863 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.1287765502929688
Epoch: 19, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.858 Vali Acc: 0.833 Test Loss: 0.858 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.0218822956085205
Epoch: 20, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.876 Vali Acc: 0.833 Test Loss: 0.876 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.1211602687835693
Epoch: 21, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.837 Vali Acc: 0.819 Test Loss: 0.837 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.1901240348815918
Epoch: 22, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.856 Vali Acc: 0.819 Test Loss: 0.856 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.23545241355896
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.867 Vali Acc: 0.819 Test Loss: 0.867 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.1420619487762451
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.860 Vali Acc: 0.826 Test Loss: 0.860 Test Acc: 0.826
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.9779868125915527
Epoch: 25, Steps: 9 | Train Loss: 0.000 Vali Loss: 0.833 Vali Acc: 0.826 Test Loss: 0.833 Test Acc: 0.826
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el3_dm768_df768_ps19_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8333333333333334
model parameter : 22420996
model size : 100.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el3_dm768_df768_ps19_str10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.4815433025360107
Epoch: 1, Steps: 9 | Train Loss: 1.445 Vali Loss: 1.356 Vali Acc: 0.333 Test Loss: 1.356 Test Acc: 0.333
Validation loss decreased (inf --> -0.333320).  Saving model ...
Epoch: 2 cost time: 0.9230794906616211
Epoch: 2, Steps: 9 | Train Loss: 1.317 Vali Loss: 1.232 Vali Acc: 0.522 Test Loss: 1.232 Test Acc: 0.522
Validation loss decreased (-0.333320 --> -0.521727).  Saving model ...
Epoch: 3 cost time: 0.9826638698577881
Epoch: 3, Steps: 9 | Train Loss: 1.162 Vali Loss: 1.099 Vali Acc: 0.594 Test Loss: 1.099 Test Acc: 0.594
Validation loss decreased (-0.521727 --> -0.594192).  Saving model ...
Epoch: 4 cost time: 1.056586503982544
Epoch: 4, Steps: 9 | Train Loss: 0.979 Vali Loss: 0.970 Vali Acc: 0.638 Test Loss: 0.970 Test Acc: 0.638
Validation loss decreased (-0.594192 --> -0.637671).  Saving model ...
Epoch: 5 cost time: 0.945307731628418
Epoch: 5, Steps: 9 | Train Loss: 0.789 Vali Loss: 0.885 Vali Acc: 0.667 Test Loss: 0.885 Test Acc: 0.667
Validation loss decreased (-0.637671 --> -0.666658).  Saving model ...
Epoch: 6 cost time: 0.8608055114746094
Epoch: 6, Steps: 9 | Train Loss: 0.703 Vali Loss: 0.778 Vali Acc: 0.696 Test Loss: 0.778 Test Acc: 0.696
Validation loss decreased (-0.666658 --> -0.695644).  Saving model ...
Epoch: 7 cost time: 0.9572262763977051
Epoch: 7, Steps: 9 | Train Loss: 0.550 Vali Loss: 0.775 Vali Acc: 0.688 Test Loss: 0.775 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0886366367340088
Epoch: 8, Steps: 9 | Train Loss: 0.458 Vali Loss: 0.693 Vali Acc: 0.688 Test Loss: 0.693 Test Acc: 0.688
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1638479232788086
Epoch: 9, Steps: 9 | Train Loss: 0.299 Vali Loss: 0.697 Vali Acc: 0.739 Test Loss: 0.697 Test Acc: 0.739
Validation loss decreased (-0.695644 --> -0.739123).  Saving model ...
Epoch: 10 cost time: 1.0453753471374512
Epoch: 10, Steps: 9 | Train Loss: 0.221 Vali Loss: 0.689 Vali Acc: 0.775 Test Loss: 0.689 Test Acc: 0.775
Validation loss decreased (-0.739123 --> -0.775355).  Saving model ...
Epoch: 11 cost time: 1.20147705078125
Epoch: 11, Steps: 9 | Train Loss: 0.152 Vali Loss: 0.763 Vali Acc: 0.783 Test Loss: 0.763 Test Acc: 0.783
Validation loss decreased (-0.775355 --> -0.782601).  Saving model ...
Epoch: 12 cost time: 1.0831732749938965
Epoch: 12, Steps: 9 | Train Loss: 0.097 Vali Loss: 0.659 Vali Acc: 0.775 Test Loss: 0.659 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3396873474121094
Epoch: 13, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.739 Vali Acc: 0.797 Test Loss: 0.739 Test Acc: 0.797
Validation loss decreased (-0.782601 --> -0.797094).  Saving model ...
Epoch: 14 cost time: 1.2238013744354248
Epoch: 14, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.687 Vali Acc: 0.783 Test Loss: 0.687 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.335897445678711
Epoch: 15, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.840 Vali Acc: 0.797 Test Loss: 0.840 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.0389492511749268
Epoch: 16, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.769 Vali Acc: 0.833 Test Loss: 0.769 Test Acc: 0.833
Validation loss decreased (-0.797094 --> -0.833326).  Saving model ...
Epoch: 17 cost time: 1.2610623836517334
Epoch: 17, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.734 Vali Acc: 0.826 Test Loss: 0.734 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0287387371063232
Epoch: 18, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.933 Vali Acc: 0.812 Test Loss: 0.933 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.1286811828613281
Epoch: 19, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.792 Vali Acc: 0.826 Test Loss: 0.792 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.4635577201843262
Epoch: 20, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.823 Vali Acc: 0.812 Test Loss: 0.823 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.128204584121704
Epoch: 21, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.797 Vali Acc: 0.819 Test Loss: 0.797 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.3218135833740234
Epoch: 22, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.779 Vali Acc: 0.826 Test Loss: 0.779 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.4478216171264648
Epoch: 23, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.804 Vali Acc: 0.833 Test Loss: 0.804 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.2547528743743896
Epoch: 24, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.829 Vali Acc: 0.833 Test Loss: 0.829 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.2646937370300293
Epoch: 25, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.861 Vali Acc: 0.833 Test Loss: 0.861 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.2687005996704102
Epoch: 26, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.819 Vali Acc: 0.826 Test Loss: 0.819 Test Acc: 0.826
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el3_dm768_df768_ps19_str10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8333333333333334
model parameter : 22333444
model size : 99.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el3_dm768_df768_ps19_str19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.3504817485809326
Epoch: 1, Steps: 9 | Train Loss: 1.475 Vali Loss: 1.383 Vali Acc: 0.239 Test Loss: 1.383 Test Acc: 0.239
Validation loss decreased (inf --> -0.239117).  Saving model ...
Epoch: 2 cost time: 0.9595863819122314
Epoch: 2, Steps: 9 | Train Loss: 1.324 Vali Loss: 1.299 Vali Acc: 0.391 Test Loss: 1.299 Test Acc: 0.391
Validation loss decreased (-0.239117 --> -0.391291).  Saving model ...
Epoch: 3 cost time: 0.9597206115722656
Epoch: 3, Steps: 9 | Train Loss: 1.229 Vali Loss: 1.212 Vali Acc: 0.514 Test Loss: 1.212 Test Acc: 0.514
Validation loss decreased (-0.391291 --> -0.514481).  Saving model ...
Epoch: 4 cost time: 1.0182733535766602
Epoch: 4, Steps: 9 | Train Loss: 1.093 Vali Loss: 1.118 Vali Acc: 0.536 Test Loss: 1.118 Test Acc: 0.536
Validation loss decreased (-0.514481 --> -0.536221).  Saving model ...
Epoch: 5 cost time: 1.0891048908233643
Epoch: 5, Steps: 9 | Train Loss: 0.959 Vali Loss: 1.029 Vali Acc: 0.638 Test Loss: 1.029 Test Acc: 0.638
Validation loss decreased (-0.536221 --> -0.637671).  Saving model ...
Epoch: 6 cost time: 1.1280956268310547
Epoch: 6, Steps: 9 | Train Loss: 0.882 Vali Loss: 0.952 Vali Acc: 0.609 Test Loss: 0.952 Test Acc: 0.609
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0093348026275635
Epoch: 7, Steps: 9 | Train Loss: 0.740 Vali Loss: 0.849 Vali Acc: 0.652 Test Loss: 0.849 Test Acc: 0.652
Validation loss decreased (-0.637671 --> -0.652165).  Saving model ...
Epoch: 8 cost time: 0.8266053199768066
Epoch: 8, Steps: 9 | Train Loss: 0.618 Vali Loss: 0.813 Vali Acc: 0.688 Test Loss: 0.813 Test Acc: 0.688
Validation loss decreased (-0.652165 --> -0.688398).  Saving model ...
Epoch: 9 cost time: 0.9521090984344482
Epoch: 9, Steps: 9 | Train Loss: 0.583 Vali Loss: 0.703 Vali Acc: 0.732 Test Loss: 0.703 Test Acc: 0.732
Validation loss decreased (-0.688398 --> -0.731877).  Saving model ...
Epoch: 10 cost time: 0.8471224308013916
Epoch: 10, Steps: 9 | Train Loss: 0.395 Vali Loss: 0.751 Vali Acc: 0.681 Test Loss: 0.751 Test Acc: 0.681
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9783854484558105
Epoch: 11, Steps: 9 | Train Loss: 0.316 Vali Loss: 0.614 Vali Acc: 0.790 Test Loss: 0.614 Test Acc: 0.790
Validation loss decreased (-0.731877 --> -0.789849).  Saving model ...
Epoch: 12 cost time: 1.0064969062805176
Epoch: 12, Steps: 9 | Train Loss: 0.220 Vali Loss: 0.653 Vali Acc: 0.768 Test Loss: 0.653 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.933384895324707
Epoch: 13, Steps: 9 | Train Loss: 0.142 Vali Loss: 0.625 Vali Acc: 0.790 Test Loss: 0.625 Test Acc: 0.790
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.8676180839538574
Epoch: 14, Steps: 9 | Train Loss: 0.108 Vali Loss: 0.638 Vali Acc: 0.819 Test Loss: 0.638 Test Acc: 0.819
Validation loss decreased (-0.789849 --> -0.818834).  Saving model ...
Epoch: 15 cost time: 0.9637482166290283
Epoch: 15, Steps: 9 | Train Loss: 0.059 Vali Loss: 0.667 Vali Acc: 0.768 Test Loss: 0.667 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8927900791168213
Epoch: 16, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.613 Vali Acc: 0.819 Test Loss: 0.613 Test Acc: 0.819
Validation loss decreased (-0.818834 --> -0.818834).  Saving model ...
Epoch: 17 cost time: 0.8688321113586426
Epoch: 17, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.648 Vali Acc: 0.804 Test Loss: 0.648 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8363370895385742
Epoch: 18, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.659 Vali Acc: 0.819 Test Loss: 0.659 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.8321163654327393
Epoch: 19, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.680 Vali Acc: 0.812 Test Loss: 0.680 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.8424496650695801
Epoch: 20, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.645 Vali Acc: 0.812 Test Loss: 0.645 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.945336103439331
Epoch: 21, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.720 Vali Acc: 0.804 Test Loss: 0.720 Test Acc: 0.804
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.0544929504394531
Epoch: 22, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.681 Vali Acc: 0.812 Test Loss: 0.681 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.9859704971313477
Epoch: 23, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.707 Vali Acc: 0.819 Test Loss: 0.707 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.8684287071228027
Epoch: 24, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.763 Vali Acc: 0.819 Test Loss: 0.763 Test Acc: 0.819
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.6667351722717285
Epoch: 25, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.756 Vali Acc: 0.819 Test Loss: 0.756 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.9175183773040771
Epoch: 26, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.711 Vali Acc: 0.819 Test Loss: 0.711 Test Acc: 0.819
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el3_dm768_df768_ps19_str19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8188405797101449
model parameter : 22291972
model size : 99.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el3_dm768_df768_ps21_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.1404013633728027
Epoch: 1, Steps: 9 | Train Loss: 1.480 Vali Loss: 1.324 Vali Acc: 0.362 Test Loss: 1.324 Test Acc: 0.362
Validation loss decreased (inf --> -0.362306).  Saving model ...
Epoch: 2 cost time: 1.169428825378418
Epoch: 2, Steps: 9 | Train Loss: 1.262 Vali Loss: 1.160 Vali Acc: 0.507 Test Loss: 1.160 Test Acc: 0.507
Validation loss decreased (-0.362306 --> -0.507235).  Saving model ...
Epoch: 3 cost time: 1.0300850868225098
Epoch: 3, Steps: 9 | Train Loss: 1.041 Vali Loss: 1.001 Vali Acc: 0.616 Test Loss: 1.001 Test Acc: 0.616
Validation loss decreased (-0.507235 --> -0.615932).  Saving model ...
Epoch: 4 cost time: 1.0760719776153564
Epoch: 4, Steps: 9 | Train Loss: 0.825 Vali Loss: 0.876 Vali Acc: 0.616 Test Loss: 0.876 Test Acc: 0.616
Validation loss decreased (-0.615932 --> -0.615933).  Saving model ...
Epoch: 5 cost time: 0.9318904876708984
Epoch: 5, Steps: 9 | Train Loss: 0.689 Vali Loss: 0.796 Vali Acc: 0.638 Test Loss: 0.796 Test Acc: 0.638
Validation loss decreased (-0.615933 --> -0.637673).  Saving model ...
Epoch: 6 cost time: 0.8868541717529297
Epoch: 6, Steps: 9 | Train Loss: 0.532 Vali Loss: 0.634 Vali Acc: 0.703 Test Loss: 0.634 Test Acc: 0.703
Validation loss decreased (-0.637673 --> -0.702892).  Saving model ...
Epoch: 7 cost time: 0.94783616065979
Epoch: 7, Steps: 9 | Train Loss: 0.374 Vali Loss: 0.831 Vali Acc: 0.601 Test Loss: 0.831 Test Acc: 0.601
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0056850910186768
Epoch: 8, Steps: 9 | Train Loss: 0.308 Vali Loss: 0.566 Vali Acc: 0.768 Test Loss: 0.566 Test Acc: 0.768
Validation loss decreased (-0.702892 --> -0.768110).  Saving model ...
Epoch: 9 cost time: 1.1840629577636719
Epoch: 9, Steps: 9 | Train Loss: 0.179 Vali Loss: 0.598 Vali Acc: 0.754 Test Loss: 0.598 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9653711318969727
Epoch: 10, Steps: 9 | Train Loss: 0.112 Vali Loss: 0.593 Vali Acc: 0.790 Test Loss: 0.593 Test Acc: 0.790
Validation loss decreased (-0.768110 --> -0.789849).  Saving model ...
Epoch: 11 cost time: 1.2068243026733398
Epoch: 11, Steps: 9 | Train Loss: 0.054 Vali Loss: 0.591 Vali Acc: 0.804 Test Loss: 0.591 Test Acc: 0.804
Validation loss decreased (-0.789849 --> -0.804342).  Saving model ...
Epoch: 12 cost time: 1.1409144401550293
Epoch: 12, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.864 Vali Acc: 0.804 Test Loss: 0.864 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2598366737365723
Epoch: 13, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.748 Vali Acc: 0.819 Test Loss: 0.748 Test Acc: 0.819
Validation loss decreased (-0.804342 --> -0.818833).  Saving model ...
Epoch: 14 cost time: 1.1914739608764648
Epoch: 14, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.680 Vali Acc: 0.812 Test Loss: 0.680 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.144806146621704
Epoch: 15, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.747 Vali Acc: 0.819 Test Loss: 0.747 Test Acc: 0.819
Validation loss decreased (-0.818833 --> -0.818833).  Saving model ...
Epoch: 16 cost time: 1.2526395320892334
Epoch: 16, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.727 Vali Acc: 0.862 Test Loss: 0.727 Test Acc: 0.862
Validation loss decreased (-0.818833 --> -0.862312).  Saving model ...
Epoch: 17 cost time: 1.1205029487609863
Epoch: 17, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.754 Vali Acc: 0.848 Test Loss: 0.754 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1849687099456787
Epoch: 18, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.772 Vali Acc: 0.841 Test Loss: 0.772 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.310197353363037
Epoch: 19, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.816 Vali Acc: 0.841 Test Loss: 0.816 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.1223466396331787
Epoch: 20, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.811 Vali Acc: 0.855 Test Loss: 0.811 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.1254303455352783
Epoch: 21, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.787 Vali Acc: 0.855 Test Loss: 0.787 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.1972639560699463
Epoch: 22, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.793 Vali Acc: 0.841 Test Loss: 0.793 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.1508829593658447
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.789 Vali Acc: 0.841 Test Loss: 0.789 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.2340567111968994
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.766 Vali Acc: 0.855 Test Loss: 0.766 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.1755776405334473
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.815 Vali Acc: 0.848 Test Loss: 0.815 Test Acc: 0.848
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.1955516338348389
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.861 Vali Acc: 0.841 Test Loss: 0.861 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el3_dm768_df768_ps21_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8623188405797102
model parameter : 22402564
model size : 100.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el3_dm768_df768_ps21_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.102670669555664
Epoch: 1, Steps: 9 | Train Loss: 1.503 Vali Loss: 1.323 Vali Acc: 0.420 Test Loss: 1.323 Test Acc: 0.420
Validation loss decreased (inf --> -0.420277).  Saving model ...
Epoch: 2 cost time: 1.0738680362701416
Epoch: 2, Steps: 9 | Train Loss: 1.331 Vali Loss: 1.234 Vali Acc: 0.486 Test Loss: 1.234 Test Acc: 0.486
Validation loss decreased (-0.420277 --> -0.485495).  Saving model ...
Epoch: 3 cost time: 1.092085599899292
Epoch: 3, Steps: 9 | Train Loss: 1.183 Vali Loss: 1.096 Vali Acc: 0.609 Test Loss: 1.096 Test Acc: 0.609
Validation loss decreased (-0.485495 --> -0.608685).  Saving model ...
Epoch: 4 cost time: 0.9497115612030029
Epoch: 4, Steps: 9 | Train Loss: 0.967 Vali Loss: 0.974 Vali Acc: 0.609 Test Loss: 0.974 Test Acc: 0.609
Validation loss decreased (-0.608685 --> -0.608686).  Saving model ...
Epoch: 5 cost time: 1.096217393875122
Epoch: 5, Steps: 9 | Train Loss: 0.844 Vali Loss: 0.871 Vali Acc: 0.645 Test Loss: 0.871 Test Acc: 0.645
Validation loss decreased (-0.608686 --> -0.644919).  Saving model ...
Epoch: 6 cost time: 1.2690339088439941
Epoch: 6, Steps: 9 | Train Loss: 0.683 Vali Loss: 0.795 Vali Acc: 0.659 Test Loss: 0.795 Test Acc: 0.659
Validation loss decreased (-0.644919 --> -0.659412).  Saving model ...
Epoch: 7 cost time: 1.0716190338134766
Epoch: 7, Steps: 9 | Train Loss: 0.568 Vali Loss: 0.725 Vali Acc: 0.674 Test Loss: 0.725 Test Acc: 0.674
Validation loss decreased (-0.659412 --> -0.673906).  Saving model ...
Epoch: 8 cost time: 0.9376285076141357
Epoch: 8, Steps: 9 | Train Loss: 0.444 Vali Loss: 0.657 Vali Acc: 0.696 Test Loss: 0.657 Test Acc: 0.696
Validation loss decreased (-0.673906 --> -0.695646).  Saving model ...
Epoch: 9 cost time: 0.9463150501251221
Epoch: 9, Steps: 9 | Train Loss: 0.331 Vali Loss: 0.640 Vali Acc: 0.754 Test Loss: 0.640 Test Acc: 0.754
Validation loss decreased (-0.695646 --> -0.753617).  Saving model ...
Epoch: 10 cost time: 0.7426357269287109
Epoch: 10, Steps: 9 | Train Loss: 0.256 Vali Loss: 0.677 Vali Acc: 0.783 Test Loss: 0.677 Test Acc: 0.783
Validation loss decreased (-0.753617 --> -0.782602).  Saving model ...
Epoch: 11 cost time: 0.8937945365905762
Epoch: 11, Steps: 9 | Train Loss: 0.161 Vali Loss: 0.622 Vali Acc: 0.754 Test Loss: 0.622 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9228942394256592
Epoch: 12, Steps: 9 | Train Loss: 0.106 Vali Loss: 0.819 Vali Acc: 0.754 Test Loss: 0.819 Test Acc: 0.754
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.8610227108001709
Epoch: 13, Steps: 9 | Train Loss: 0.053 Vali Loss: 0.645 Vali Acc: 0.812 Test Loss: 0.645 Test Acc: 0.812
Validation loss decreased (-0.782602 --> -0.811588).  Saving model ...
Epoch: 14 cost time: 0.9364895820617676
Epoch: 14, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.873 Vali Acc: 0.797 Test Loss: 0.873 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8512828350067139
Epoch: 15, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.686 Vali Acc: 0.819 Test Loss: 0.686 Test Acc: 0.819
Validation loss decreased (-0.811588 --> -0.818834).  Saving model ...
Epoch: 16 cost time: 0.9322249889373779
Epoch: 16, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.734 Vali Acc: 0.804 Test Loss: 0.734 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1320393085479736
Epoch: 17, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.773 Vali Acc: 0.819 Test Loss: 0.773 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.970529317855835
Epoch: 18, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.809 Vali Acc: 0.812 Test Loss: 0.809 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.9307518005371094
Epoch: 19, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.695 Vali Acc: 0.833 Test Loss: 0.695 Test Acc: 0.833
Validation loss decreased (-0.818834 --> -0.833326).  Saving model ...
Epoch: 20 cost time: 0.8996360301971436
Epoch: 20, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.794 Vali Acc: 0.841 Test Loss: 0.794 Test Acc: 0.841
Validation loss decreased (-0.833326 --> -0.840572).  Saving model ...
Epoch: 21 cost time: 0.9129583835601807
Epoch: 21, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.828 Vali Acc: 0.826 Test Loss: 0.828 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9058248996734619
Epoch: 22, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.775 Vali Acc: 0.833 Test Loss: 0.775 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.7994034290313721
Epoch: 23, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.805 Vali Acc: 0.841 Test Loss: 0.805 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.9004471302032471
Epoch: 24, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.841 Vali Acc: 0.841 Test Loss: 0.841 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.806795597076416
Epoch: 25, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.805 Vali Acc: 0.841 Test Loss: 0.805 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.9991269111633301
Epoch: 26, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.808 Vali Acc: 0.841 Test Loss: 0.808 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.951770544052124
Epoch: 27, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.841 Vali Acc: 0.841 Test Loss: 0.841 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.0059068202972412
Epoch: 28, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.873 Vali Acc: 0.841 Test Loss: 0.873 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.0562329292297363
Epoch: 29, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.875 Vali Acc: 0.841 Test Loss: 0.875 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.9669759273529053
Epoch: 30, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.814 Vali Acc: 0.833 Test Loss: 0.814 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el3_dm768_df768_ps21_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8405797101449275
model parameter : 22338052
model size : 99.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el3_dm768_df768_ps21_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.693223714828491
Epoch: 1, Steps: 9 | Train Loss: 1.406 Vali Loss: 1.353 Vali Acc: 0.297 Test Loss: 1.353 Test Acc: 0.297
Validation loss decreased (inf --> -0.297088).  Saving model ...
Epoch: 2 cost time: 0.8343298435211182
Epoch: 2, Steps: 9 | Train Loss: 1.308 Vali Loss: 1.258 Vali Acc: 0.471 Test Loss: 1.258 Test Acc: 0.471
Validation loss decreased (-0.297088 --> -0.471002).  Saving model ...
Epoch: 3 cost time: 0.8580639362335205
Epoch: 3, Steps: 9 | Train Loss: 1.233 Vali Loss: 1.168 Vali Acc: 0.609 Test Loss: 1.168 Test Acc: 0.609
Validation loss decreased (-0.471002 --> -0.608684).  Saving model ...
Epoch: 4 cost time: 0.841876745223999
Epoch: 4, Steps: 9 | Train Loss: 1.083 Vali Loss: 1.057 Vali Acc: 0.616 Test Loss: 1.057 Test Acc: 0.616
Validation loss decreased (-0.608684 --> -0.615931).  Saving model ...
Epoch: 5 cost time: 0.936281681060791
Epoch: 5, Steps: 9 | Train Loss: 0.998 Vali Loss: 1.002 Vali Acc: 0.601 Test Loss: 1.002 Test Acc: 0.601
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7441995143890381
Epoch: 6, Steps: 9 | Train Loss: 0.839 Vali Loss: 0.892 Vali Acc: 0.638 Test Loss: 0.892 Test Acc: 0.638
Validation loss decreased (-0.615931 --> -0.637672).  Saving model ...
Epoch: 7 cost time: 0.8048229217529297
Epoch: 7, Steps: 9 | Train Loss: 0.740 Vali Loss: 0.808 Vali Acc: 0.667 Test Loss: 0.808 Test Acc: 0.667
Validation loss decreased (-0.637672 --> -0.666659).  Saving model ...
Epoch: 8 cost time: 0.8491909503936768
Epoch: 8, Steps: 9 | Train Loss: 0.626 Vali Loss: 0.793 Vali Acc: 0.674 Test Loss: 0.793 Test Acc: 0.674
Validation loss decreased (-0.666659 --> -0.673905).  Saving model ...
Epoch: 9 cost time: 1.028942584991455
Epoch: 9, Steps: 9 | Train Loss: 0.528 Vali Loss: 0.735 Vali Acc: 0.688 Test Loss: 0.735 Test Acc: 0.688
Validation loss decreased (-0.673905 --> -0.688398).  Saving model ...
Epoch: 10 cost time: 0.9711463451385498
Epoch: 10, Steps: 9 | Train Loss: 0.400 Vali Loss: 0.720 Vali Acc: 0.710 Test Loss: 0.720 Test Acc: 0.710
Validation loss decreased (-0.688398 --> -0.710138).  Saving model ...
Epoch: 11 cost time: 0.8980388641357422
Epoch: 11, Steps: 9 | Train Loss: 0.335 Vali Loss: 0.671 Vali Acc: 0.739 Test Loss: 0.671 Test Acc: 0.739
Validation loss decreased (-0.710138 --> -0.739124).  Saving model ...
Epoch: 12 cost time: 0.927614688873291
Epoch: 12, Steps: 9 | Train Loss: 0.233 Vali Loss: 0.778 Vali Acc: 0.761 Test Loss: 0.778 Test Acc: 0.761
Validation loss decreased (-0.739124 --> -0.760862).  Saving model ...
Epoch: 13 cost time: 0.8735625743865967
Epoch: 13, Steps: 9 | Train Loss: 0.164 Vali Loss: 0.566 Vali Acc: 0.804 Test Loss: 0.566 Test Acc: 0.804
Validation loss decreased (-0.760862 --> -0.804342).  Saving model ...
Epoch: 14 cost time: 0.8911070823669434
Epoch: 14, Steps: 9 | Train Loss: 0.122 Vali Loss: 0.785 Vali Acc: 0.797 Test Loss: 0.785 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.774580717086792
Epoch: 15, Steps: 9 | Train Loss: 0.084 Vali Loss: 0.606 Vali Acc: 0.804 Test Loss: 0.606 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7039844989776611
Epoch: 16, Steps: 9 | Train Loss: 0.062 Vali Loss: 0.781 Vali Acc: 0.812 Test Loss: 0.781 Test Acc: 0.812
Validation loss decreased (-0.804342 --> -0.811586).  Saving model ...
Epoch: 17 cost time: 0.901644229888916
Epoch: 17, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.739 Vali Acc: 0.761 Test Loss: 0.739 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8977363109588623
Epoch: 18, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.865 Vali Acc: 0.797 Test Loss: 0.865 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.8331894874572754
Epoch: 19, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.754 Vali Acc: 0.812 Test Loss: 0.754 Test Acc: 0.812
Validation loss decreased (-0.811586 --> -0.811587).  Saving model ...
Epoch: 20 cost time: 0.7983007431030273
Epoch: 20, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.723 Vali Acc: 0.826 Test Loss: 0.723 Test Acc: 0.826
Validation loss decreased (-0.811587 --> -0.826080).  Saving model ...
Epoch: 21 cost time: 0.7896080017089844
Epoch: 21, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.818 Vali Acc: 0.826 Test Loss: 0.818 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8169794082641602
Epoch: 22, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.829 Vali Acc: 0.819 Test Loss: 0.829 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.8854553699493408
Epoch: 23, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.812 Vali Acc: 0.819 Test Loss: 0.812 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.8960580825805664
Epoch: 24, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.831 Vali Acc: 0.819 Test Loss: 0.831 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.806365966796875
Epoch: 25, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.856 Vali Acc: 0.833 Test Loss: 0.856 Test Acc: 0.833
Validation loss decreased (-0.826080 --> -0.833325).  Saving model ...
Epoch: 26 cost time: 0.7827358245849609
Epoch: 26, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.821 Vali Acc: 0.833 Test Loss: 0.821 Test Acc: 0.833
Validation loss decreased (-0.833325 --> -0.833325).  Saving model ...
Epoch: 27 cost time: 0.8096966743469238
Epoch: 27, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.852 Vali Acc: 0.826 Test Loss: 0.852 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.0370497703552246
Epoch: 28, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.846 Vali Acc: 0.826 Test Loss: 0.846 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.9355697631835938
Epoch: 29, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.834 Vali Acc: 0.826 Test Loss: 0.834 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.8305847644805908
Epoch: 30, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.814 Vali Acc: 0.833 Test Loss: 0.814 Test Acc: 0.833
Validation loss decreased (-0.833325 --> -0.833325).  Saving model ...
Epoch: 31 cost time: 0.8272240161895752
Epoch: 31, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.836 Vali Acc: 0.833 Test Loss: 0.836 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.8637464046478271
Epoch: 32, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.858 Vali Acc: 0.826 Test Loss: 0.858 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.8018519878387451
Epoch: 33, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.826 Vali Acc: 0.833 Test Loss: 0.826 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.9233932495117188
Epoch: 34, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.847 Vali Acc: 0.833 Test Loss: 0.847 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.9188272953033447
Epoch: 35, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.876 Vali Acc: 0.833 Test Loss: 0.876 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.8319363594055176
Epoch: 36, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.863 Vali Acc: 0.833 Test Loss: 0.863 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.8690521717071533
Epoch: 37, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.878 Vali Acc: 0.826 Test Loss: 0.878 Test Acc: 0.826
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.8536281585693359
Epoch: 38, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.916 Vali Acc: 0.833 Test Loss: 0.916 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.9032702445983887
Epoch: 39, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.915 Vali Acc: 0.833 Test Loss: 0.915 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.8553597927093506
Epoch: 40, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.925 Vali Acc: 0.833 Test Loss: 0.925 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el3_dm768_df768_ps21_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8333333333333334
model parameter : 22301188
model size : 99.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el3_dm768_df768_ps23_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.2389137744903564
Epoch: 1, Steps: 9 | Train Loss: 1.480 Vali Loss: 1.327 Vali Acc: 0.391 Test Loss: 1.327 Test Acc: 0.391
Validation loss decreased (inf --> -0.391291).  Saving model ...
Epoch: 2 cost time: 1.0287022590637207
Epoch: 2, Steps: 9 | Train Loss: 1.240 Vali Loss: 1.145 Vali Acc: 0.558 Test Loss: 1.145 Test Acc: 0.558
Validation loss decreased (-0.391291 --> -0.557960).  Saving model ...
Epoch: 3 cost time: 0.8010411262512207
Epoch: 3, Steps: 9 | Train Loss: 1.047 Vali Loss: 0.980 Vali Acc: 0.638 Test Loss: 0.980 Test Acc: 0.638
Validation loss decreased (-0.557960 --> -0.637671).  Saving model ...
Epoch: 4 cost time: 0.8263845443725586
Epoch: 4, Steps: 9 | Train Loss: 0.776 Vali Loss: 0.926 Vali Acc: 0.659 Test Loss: 0.926 Test Acc: 0.659
Validation loss decreased (-0.637671 --> -0.659411).  Saving model ...
Epoch: 5 cost time: 1.1003777980804443
Epoch: 5, Steps: 9 | Train Loss: 0.664 Vali Loss: 0.792 Vali Acc: 0.630 Test Loss: 0.792 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.202742576599121
Epoch: 6, Steps: 9 | Train Loss: 0.576 Vali Loss: 0.715 Vali Acc: 0.667 Test Loss: 0.715 Test Acc: 0.667
Validation loss decreased (-0.659411 --> -0.666660).  Saving model ...
Epoch: 7 cost time: 1.002957820892334
Epoch: 7, Steps: 9 | Train Loss: 0.368 Vali Loss: 0.637 Vali Acc: 0.710 Test Loss: 0.637 Test Acc: 0.710
Validation loss decreased (-0.666660 --> -0.710139).  Saving model ...
Epoch: 8 cost time: 0.9782991409301758
Epoch: 8, Steps: 9 | Train Loss: 0.272 Vali Loss: 0.559 Vali Acc: 0.761 Test Loss: 0.559 Test Acc: 0.761
Validation loss decreased (-0.710139 --> -0.760864).  Saving model ...
Epoch: 9 cost time: 1.0967440605163574
Epoch: 9, Steps: 9 | Train Loss: 0.225 Vali Loss: 0.800 Vali Acc: 0.746 Test Loss: 0.800 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0189213752746582
Epoch: 10, Steps: 9 | Train Loss: 0.133 Vali Loss: 0.618 Vali Acc: 0.790 Test Loss: 0.618 Test Acc: 0.790
Validation loss decreased (-0.760864 --> -0.789849).  Saving model ...
Epoch: 11 cost time: 1.082568883895874
Epoch: 11, Steps: 9 | Train Loss: 0.096 Vali Loss: 0.685 Vali Acc: 0.790 Test Loss: 0.685 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9777746200561523
Epoch: 12, Steps: 9 | Train Loss: 0.049 Vali Loss: 0.594 Vali Acc: 0.848 Test Loss: 0.594 Test Acc: 0.848
Validation loss decreased (-0.789849 --> -0.847820).  Saving model ...
Epoch: 13 cost time: 0.9409523010253906
Epoch: 13, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.850 Vali Acc: 0.812 Test Loss: 0.850 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9976534843444824
Epoch: 14, Steps: 9 | Train Loss: 0.053 Vali Loss: 0.778 Vali Acc: 0.833 Test Loss: 0.778 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.210904598236084
Epoch: 15, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.915 Vali Acc: 0.833 Test Loss: 0.915 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.9767169952392578
Epoch: 16, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.964 Vali Acc: 0.826 Test Loss: 0.964 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.9714155197143555
Epoch: 17, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.881 Vali Acc: 0.848 Test Loss: 0.881 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.1664464473724365
Epoch: 18, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.979 Vali Acc: 0.826 Test Loss: 0.979 Test Acc: 0.826
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.1154279708862305
Epoch: 19, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.945 Vali Acc: 0.841 Test Loss: 0.945 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.1888489723205566
Epoch: 20, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.855 Vali Acc: 0.841 Test Loss: 0.855 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.2012670040130615
Epoch: 21, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.853 Vali Acc: 0.841 Test Loss: 0.853 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.113720417022705
Epoch: 22, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.858 Vali Acc: 0.841 Test Loss: 0.858 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el3_dm768_df768_ps23_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8478260869565217
model parameter : 22416388
model size : 100.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el3_dm768_df768_ps23_str12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.067815065383911
Epoch: 1, Steps: 9 | Train Loss: 1.467 Vali Loss: 1.358 Vali Acc: 0.341 Test Loss: 1.358 Test Acc: 0.341
Validation loss decreased (inf --> -0.340566).  Saving model ...
Epoch: 2 cost time: 1.108642339706421
Epoch: 2, Steps: 9 | Train Loss: 1.332 Vali Loss: 1.234 Vali Acc: 0.536 Test Loss: 1.234 Test Acc: 0.536
Validation loss decreased (-0.340566 --> -0.536220).  Saving model ...
Epoch: 3 cost time: 0.9414341449737549
Epoch: 3, Steps: 9 | Train Loss: 1.114 Vali Loss: 1.128 Vali Acc: 0.580 Test Loss: 1.128 Test Acc: 0.580
Validation loss decreased (-0.536220 --> -0.579699).  Saving model ...
Epoch: 4 cost time: 1.0689294338226318
Epoch: 4, Steps: 9 | Train Loss: 1.003 Vali Loss: 0.992 Vali Acc: 0.645 Test Loss: 0.992 Test Acc: 0.645
Validation loss decreased (-0.579699 --> -0.644918).  Saving model ...
Epoch: 5 cost time: 0.9419333934783936
Epoch: 5, Steps: 9 | Train Loss: 0.825 Vali Loss: 0.951 Vali Acc: 0.601 Test Loss: 0.951 Test Acc: 0.601
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8630642890930176
Epoch: 6, Steps: 9 | Train Loss: 0.696 Vali Loss: 0.846 Vali Acc: 0.667 Test Loss: 0.846 Test Acc: 0.667
Validation loss decreased (-0.644918 --> -0.666658).  Saving model ...
Epoch: 7 cost time: 1.005051851272583
Epoch: 7, Steps: 9 | Train Loss: 0.553 Vali Loss: 0.829 Vali Acc: 0.674 Test Loss: 0.829 Test Acc: 0.674
Validation loss decreased (-0.666658 --> -0.673905).  Saving model ...
Epoch: 8 cost time: 0.9742977619171143
Epoch: 8, Steps: 9 | Train Loss: 0.505 Vali Loss: 0.772 Vali Acc: 0.681 Test Loss: 0.772 Test Acc: 0.681
Validation loss decreased (-0.673905 --> -0.681152).  Saving model ...
Epoch: 9 cost time: 0.8929088115692139
Epoch: 9, Steps: 9 | Train Loss: 0.382 Vali Loss: 0.633 Vali Acc: 0.754 Test Loss: 0.633 Test Acc: 0.754
Validation loss decreased (-0.681152 --> -0.753617).  Saving model ...
Epoch: 10 cost time: 1.0809502601623535
Epoch: 10, Steps: 9 | Train Loss: 0.267 Vali Loss: 0.710 Vali Acc: 0.761 Test Loss: 0.710 Test Acc: 0.761
Validation loss decreased (-0.753617 --> -0.760862).  Saving model ...
Epoch: 11 cost time: 1.1001262664794922
Epoch: 11, Steps: 9 | Train Loss: 0.177 Vali Loss: 0.641 Vali Acc: 0.783 Test Loss: 0.641 Test Acc: 0.783
Validation loss decreased (-0.760862 --> -0.782602).  Saving model ...
Epoch: 12 cost time: 1.2201991081237793
Epoch: 12, Steps: 9 | Train Loss: 0.125 Vali Loss: 0.708 Vali Acc: 0.812 Test Loss: 0.708 Test Acc: 0.812
Validation loss decreased (-0.782602 --> -0.811587).  Saving model ...
Epoch: 13 cost time: 0.8393216133117676
Epoch: 13, Steps: 9 | Train Loss: 0.091 Vali Loss: 0.784 Vali Acc: 0.790 Test Loss: 0.784 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9677739143371582
Epoch: 14, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.820 Vali Acc: 0.833 Test Loss: 0.820 Test Acc: 0.833
Validation loss decreased (-0.811587 --> -0.833325).  Saving model ...
Epoch: 15 cost time: 1.1427040100097656
Epoch: 15, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.714 Vali Acc: 0.819 Test Loss: 0.714 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.025219202041626
Epoch: 16, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.830 Vali Acc: 0.804 Test Loss: 0.830 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.215346097946167
Epoch: 17, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.760 Vali Acc: 0.819 Test Loss: 0.760 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.2173993587493896
Epoch: 18, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.806 Vali Acc: 0.812 Test Loss: 0.806 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.0754296779632568
Epoch: 19, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.926 Vali Acc: 0.833 Test Loss: 0.926 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.9814667701721191
Epoch: 20, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.813 Vali Acc: 0.833 Test Loss: 0.813 Test Acc: 0.833
Validation loss decreased (-0.833325 --> -0.833325).  Saving model ...
Epoch: 21 cost time: 1.1613235473632812
Epoch: 21, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.804 Vali Acc: 0.833 Test Loss: 0.804 Test Acc: 0.833
Validation loss decreased (-0.833325 --> -0.833325).  Saving model ...
Epoch: 22 cost time: 0.833949089050293
Epoch: 22, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.874 Vali Acc: 0.819 Test Loss: 0.874 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9861016273498535
Epoch: 23, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.840 Vali Acc: 0.841 Test Loss: 0.840 Test Acc: 0.841
Validation loss decreased (-0.833325 --> -0.840571).  Saving model ...
Epoch: 24 cost time: 1.0003831386566162
Epoch: 24, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.849 Vali Acc: 0.841 Test Loss: 0.849 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6827490329742432
Epoch: 25, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.879 Vali Acc: 0.826 Test Loss: 0.879 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.8723669052124023
Epoch: 26, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.882 Vali Acc: 0.819 Test Loss: 0.882 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.8187494277954102
Epoch: 27, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.884 Vali Acc: 0.826 Test Loss: 0.884 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.8182220458984375
Epoch: 28, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.889 Vali Acc: 0.826 Test Loss: 0.889 Test Acc: 0.826
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.7199623584747314
Epoch: 29, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.900 Vali Acc: 0.833 Test Loss: 0.900 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.9325058460235596
Epoch: 30, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.896 Vali Acc: 0.841 Test Loss: 0.896 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.9047465324401855
Epoch: 31, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.893 Vali Acc: 0.841 Test Loss: 0.893 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.9091484546661377
Epoch: 32, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.894 Vali Acc: 0.841 Test Loss: 0.894 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.0145015716552734
Epoch: 33, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.865 Vali Acc: 0.833 Test Loss: 0.865 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el3_dm768_df768_ps23_str12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8405797101449275
model parameter : 22347268
model size : 99.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el3_dm768_df768_ps23_str23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.7220470905303955
Epoch: 1, Steps: 9 | Train Loss: 1.468 Vali Loss: 1.389 Vali Acc: 0.239 Test Loss: 1.389 Test Acc: 0.239
Validation loss decreased (inf --> -0.239117).  Saving model ...
Epoch: 2 cost time: 0.763239860534668
Epoch: 2, Steps: 9 | Train Loss: 1.357 Vali Loss: 1.319 Vali Acc: 0.420 Test Loss: 1.319 Test Acc: 0.420
Validation loss decreased (-0.239117 --> -0.420277).  Saving model ...
Epoch: 3 cost time: 0.7071139812469482
Epoch: 3, Steps: 9 | Train Loss: 1.234 Vali Loss: 1.232 Vali Acc: 0.486 Test Loss: 1.232 Test Acc: 0.486
Validation loss decreased (-0.420277 --> -0.485495).  Saving model ...
Epoch: 4 cost time: 0.7798464298248291
Epoch: 4, Steps: 9 | Train Loss: 1.130 Vali Loss: 1.127 Vali Acc: 0.543 Test Loss: 1.127 Test Acc: 0.543
Validation loss decreased (-0.485495 --> -0.543467).  Saving model ...
Epoch: 5 cost time: 0.7862915992736816
Epoch: 5, Steps: 9 | Train Loss: 0.996 Vali Loss: 1.032 Vali Acc: 0.609 Test Loss: 1.032 Test Acc: 0.609
Validation loss decreased (-0.543467 --> -0.608685).  Saving model ...
Epoch: 6 cost time: 0.7675464153289795
Epoch: 6, Steps: 9 | Train Loss: 0.884 Vali Loss: 0.962 Vali Acc: 0.645 Test Loss: 0.962 Test Acc: 0.645
Validation loss decreased (-0.608685 --> -0.644918).  Saving model ...
Epoch: 7 cost time: 0.7927772998809814
Epoch: 7, Steps: 9 | Train Loss: 0.753 Vali Loss: 0.854 Vali Acc: 0.630 Test Loss: 0.854 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8068804740905762
Epoch: 8, Steps: 9 | Train Loss: 0.648 Vali Loss: 0.801 Vali Acc: 0.645 Test Loss: 0.801 Test Acc: 0.645
Validation loss decreased (-0.644918 --> -0.644920).  Saving model ...
Epoch: 9 cost time: 0.638878345489502
Epoch: 9, Steps: 9 | Train Loss: 0.576 Vali Loss: 0.752 Vali Acc: 0.717 Test Loss: 0.752 Test Acc: 0.717
Validation loss decreased (-0.644920 --> -0.717384).  Saving model ...
Epoch: 10 cost time: 0.6926796436309814
Epoch: 10, Steps: 9 | Train Loss: 0.473 Vali Loss: 0.672 Vali Acc: 0.768 Test Loss: 0.672 Test Acc: 0.768
Validation loss decreased (-0.717384 --> -0.768109).  Saving model ...
Epoch: 11 cost time: 0.7539191246032715
Epoch: 11, Steps: 9 | Train Loss: 0.391 Vali Loss: 0.632 Vali Acc: 0.746 Test Loss: 0.632 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8257951736450195
Epoch: 12, Steps: 9 | Train Loss: 0.285 Vali Loss: 0.629 Vali Acc: 0.790 Test Loss: 0.629 Test Acc: 0.790
Validation loss decreased (-0.768109 --> -0.789849).  Saving model ...
Epoch: 13 cost time: 0.6915280818939209
Epoch: 13, Steps: 9 | Train Loss: 0.211 Vali Loss: 0.629 Vali Acc: 0.754 Test Loss: 0.629 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6920793056488037
Epoch: 14, Steps: 9 | Train Loss: 0.150 Vali Loss: 0.700 Vali Acc: 0.790 Test Loss: 0.700 Test Acc: 0.790
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.770479679107666
Epoch: 15, Steps: 9 | Train Loss: 0.091 Vali Loss: 0.667 Vali Acc: 0.775 Test Loss: 0.667 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.8264269828796387
Epoch: 16, Steps: 9 | Train Loss: 0.057 Vali Loss: 0.719 Vali Acc: 0.783 Test Loss: 0.719 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.7916073799133301
Epoch: 17, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.724 Vali Acc: 0.775 Test Loss: 0.724 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.7118480205535889
Epoch: 18, Steps: 9 | Train Loss: 0.028 Vali Loss: 0.682 Vali Acc: 0.775 Test Loss: 0.682 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.792489767074585
Epoch: 19, Steps: 9 | Train Loss: 0.027 Vali Loss: 0.710 Vali Acc: 0.775 Test Loss: 0.710 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.7860400676727295
Epoch: 20, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.765 Vali Acc: 0.783 Test Loss: 0.765 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.8834116458892822
Epoch: 21, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.725 Vali Acc: 0.783 Test Loss: 0.725 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.7049727439880371
Epoch: 22, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.720 Vali Acc: 0.797 Test Loss: 0.720 Test Acc: 0.797
Validation loss decreased (-0.789849 --> -0.797094).  Saving model ...
Epoch: 23 cost time: 0.7726197242736816
Epoch: 23, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.764 Vali Acc: 0.797 Test Loss: 0.764 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.7521109580993652
Epoch: 24, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.784 Vali Acc: 0.783 Test Loss: 0.784 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.7862834930419922
Epoch: 25, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.757 Vali Acc: 0.790 Test Loss: 0.757 Test Acc: 0.790
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.8203191757202148
Epoch: 26, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.746 Vali Acc: 0.797 Test Loss: 0.746 Test Acc: 0.797
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.84865403175354
Epoch: 27, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.741 Vali Acc: 0.804 Test Loss: 0.741 Test Acc: 0.804
Validation loss decreased (-0.797094 --> -0.804340).  Saving model ...
Epoch: 28 cost time: 0.7519686222076416
Epoch: 28, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.772 Vali Acc: 0.797 Test Loss: 0.772 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.822789192199707
Epoch: 29, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.829 Vali Acc: 0.797 Test Loss: 0.829 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.8570935726165771
Epoch: 30, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.813 Vali Acc: 0.797 Test Loss: 0.813 Test Acc: 0.797
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.8425164222717285
Epoch: 31, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.800 Vali Acc: 0.797 Test Loss: 0.800 Test Acc: 0.797
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.857109546661377
Epoch: 32, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.783 Vali Acc: 0.797 Test Loss: 0.783 Test Acc: 0.797
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.7920751571655273
Epoch: 33, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.782 Vali Acc: 0.812 Test Loss: 0.782 Test Acc: 0.812
Validation loss decreased (-0.804340 --> -0.811586).  Saving model ...
Epoch: 34 cost time: 0.9063570499420166
Epoch: 34, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.789 Vali Acc: 0.812 Test Loss: 0.789 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.8734381198883057
Epoch: 35, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.792 Vali Acc: 0.804 Test Loss: 0.792 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.794532299041748
Epoch: 36, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.828 Vali Acc: 0.797 Test Loss: 0.828 Test Acc: 0.797
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.9391448497772217
Epoch: 37, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.816 Vali Acc: 0.797 Test Loss: 0.816 Test Acc: 0.797
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.683830738067627
Epoch: 38, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.833 Vali Acc: 0.797 Test Loss: 0.833 Test Acc: 0.797
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.8761861324310303
Epoch: 39, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.862 Vali Acc: 0.790 Test Loss: 0.862 Test Acc: 0.790
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.7479419708251953
Epoch: 40, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.883 Vali Acc: 0.804 Test Loss: 0.883 Test Acc: 0.804
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.6861186027526855
Epoch: 41, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.880 Vali Acc: 0.804 Test Loss: 0.880 Test Acc: 0.804
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.7818863391876221
Epoch: 42, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.868 Vali Acc: 0.804 Test Loss: 0.868 Test Acc: 0.804
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 0.6784298419952393
Epoch: 43, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.863 Vali Acc: 0.804 Test Loss: 0.863 Test Acc: 0.804
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el3_dm768_df768_ps23_str23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8115942028985508
model parameter : 22310404
model size : 99.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el3_dm768_df768_ps26_str7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.9049875736236572
Epoch: 1, Steps: 9 | Train Loss: 1.380 Vali Loss: 1.335 Vali Acc: 0.355 Test Loss: 1.335 Test Acc: 0.355
Validation loss decreased (inf --> -0.355059).  Saving model ...
Epoch: 2 cost time: 0.9754290580749512
Epoch: 2, Steps: 9 | Train Loss: 1.240 Vali Loss: 1.192 Vali Acc: 0.551 Test Loss: 1.192 Test Acc: 0.551
Validation loss decreased (-0.355059 --> -0.550713).  Saving model ...
Epoch: 3 cost time: 0.9707551002502441
Epoch: 3, Steps: 9 | Train Loss: 1.050 Vali Loss: 1.034 Vali Acc: 0.558 Test Loss: 1.034 Test Acc: 0.558
Validation loss decreased (-0.550713 --> -0.557961).  Saving model ...
Epoch: 4 cost time: 0.9487574100494385
Epoch: 4, Steps: 9 | Train Loss: 0.894 Vali Loss: 0.920 Vali Acc: 0.623 Test Loss: 0.920 Test Acc: 0.623
Validation loss decreased (-0.557961 --> -0.623179).  Saving model ...
Epoch: 5 cost time: 0.9625506401062012
Epoch: 5, Steps: 9 | Train Loss: 0.703 Vali Loss: 0.778 Vali Acc: 0.710 Test Loss: 0.778 Test Acc: 0.710
Validation loss decreased (-0.623179 --> -0.710137).  Saving model ...
Epoch: 6 cost time: 1.2594757080078125
Epoch: 6, Steps: 9 | Train Loss: 0.562 Vali Loss: 0.705 Vali Acc: 0.710 Test Loss: 0.705 Test Acc: 0.710
Validation loss decreased (-0.710137 --> -0.710138).  Saving model ...
Epoch: 7 cost time: 1.4455466270446777
Epoch: 7, Steps: 9 | Train Loss: 0.468 Vali Loss: 0.626 Vali Acc: 0.732 Test Loss: 0.626 Test Acc: 0.732
Validation loss decreased (-0.710138 --> -0.731878).  Saving model ...
Epoch: 8 cost time: 1.0418243408203125
Epoch: 8, Steps: 9 | Train Loss: 0.308 Vali Loss: 0.593 Vali Acc: 0.754 Test Loss: 0.593 Test Acc: 0.754
Validation loss decreased (-0.731878 --> -0.753617).  Saving model ...
Epoch: 9 cost time: 1.2458384037017822
Epoch: 9, Steps: 9 | Train Loss: 0.211 Vali Loss: 0.436 Vali Acc: 0.833 Test Loss: 0.436 Test Acc: 0.833
Validation loss decreased (-0.753617 --> -0.833329).  Saving model ...
Epoch: 10 cost time: 0.8729848861694336
Epoch: 10, Steps: 9 | Train Loss: 0.138 Vali Loss: 0.708 Vali Acc: 0.797 Test Loss: 0.708 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8795685768127441
Epoch: 11, Steps: 9 | Train Loss: 0.086 Vali Loss: 0.610 Vali Acc: 0.812 Test Loss: 0.610 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1583642959594727
Epoch: 12, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.435 Vali Acc: 0.848 Test Loss: 0.435 Test Acc: 0.848
Validation loss decreased (-0.833329 --> -0.847822).  Saving model ...
Epoch: 13 cost time: 0.9265003204345703
Epoch: 13, Steps: 9 | Train Loss: 0.049 Vali Loss: 1.069 Vali Acc: 0.790 Test Loss: 1.069 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.318572998046875
Epoch: 14, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.638 Vali Acc: 0.833 Test Loss: 0.638 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.1245408058166504
Epoch: 15, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.785 Vali Acc: 0.826 Test Loss: 0.785 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.9333522319793701
Epoch: 16, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.663 Vali Acc: 0.841 Test Loss: 0.663 Test Acc: 0.841
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.102992057800293
Epoch: 17, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.681 Vali Acc: 0.841 Test Loss: 0.681 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.9705193042755127
Epoch: 18, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.731 Vali Acc: 0.841 Test Loss: 0.731 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.9002747535705566
Epoch: 19, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.717 Vali Acc: 0.841 Test Loss: 0.717 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.1045098304748535
Epoch: 20, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.722 Vali Acc: 0.833 Test Loss: 0.722 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.9069674015045166
Epoch: 21, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.697 Vali Acc: 0.841 Test Loss: 0.697 Test Acc: 0.841
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.9696650505065918
Epoch: 22, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.697 Vali Acc: 0.833 Test Loss: 0.697 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el3_dm768_df768_ps26_str7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8478260869565217
model parameter : 22414084
model size : 100.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el3_dm768_df768_ps26_str13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.792938709259033
Epoch: 1, Steps: 9 | Train Loss: 1.495 Vali Loss: 1.352 Vali Acc: 0.391 Test Loss: 1.352 Test Acc: 0.391
Validation loss decreased (inf --> -0.391291).  Saving model ...
Epoch: 2 cost time: 0.788060188293457
Epoch: 2, Steps: 9 | Train Loss: 1.369 Vali Loss: 1.304 Vali Acc: 0.326 Test Loss: 1.304 Test Acc: 0.326
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9148955345153809
Epoch: 3, Steps: 9 | Train Loss: 1.237 Vali Loss: 1.195 Vali Acc: 0.304 Test Loss: 1.195 Test Acc: 0.304
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6871259212493896
Epoch: 4, Steps: 9 | Train Loss: 1.116 Vali Loss: 1.075 Vali Acc: 0.587 Test Loss: 1.075 Test Acc: 0.587
Validation loss decreased (-0.391291 --> -0.586946).  Saving model ...
Epoch: 5 cost time: 0.8167343139648438
Epoch: 5, Steps: 9 | Train Loss: 0.908 Vali Loss: 1.029 Vali Acc: 0.609 Test Loss: 1.029 Test Acc: 0.609
Validation loss decreased (-0.586946 --> -0.608685).  Saving model ...
Epoch: 6 cost time: 0.8218135833740234
Epoch: 6, Steps: 9 | Train Loss: 0.799 Vali Loss: 0.909 Vali Acc: 0.616 Test Loss: 0.909 Test Acc: 0.616
Validation loss decreased (-0.608685 --> -0.615933).  Saving model ...
Epoch: 7 cost time: 0.8658430576324463
Epoch: 7, Steps: 9 | Train Loss: 0.640 Vali Loss: 0.862 Vali Acc: 0.659 Test Loss: 0.862 Test Acc: 0.659
Validation loss decreased (-0.615933 --> -0.659412).  Saving model ...
Epoch: 8 cost time: 0.8643367290496826
Epoch: 8, Steps: 9 | Train Loss: 0.517 Vali Loss: 0.730 Vali Acc: 0.688 Test Loss: 0.730 Test Acc: 0.688
Validation loss decreased (-0.659412 --> -0.688398).  Saving model ...
Epoch: 9 cost time: 0.7613604068756104
Epoch: 9, Steps: 9 | Train Loss: 0.432 Vali Loss: 0.705 Vali Acc: 0.703 Test Loss: 0.705 Test Acc: 0.703
Validation loss decreased (-0.688398 --> -0.702892).  Saving model ...
Epoch: 10 cost time: 0.7466394901275635
Epoch: 10, Steps: 9 | Train Loss: 0.271 Vali Loss: 0.606 Vali Acc: 0.739 Test Loss: 0.606 Test Acc: 0.739
Validation loss decreased (-0.702892 --> -0.739124).  Saving model ...
Epoch: 11 cost time: 0.775219202041626
Epoch: 11, Steps: 9 | Train Loss: 0.198 Vali Loss: 0.618 Vali Acc: 0.804 Test Loss: 0.618 Test Acc: 0.804
Validation loss decreased (-0.739124 --> -0.804342).  Saving model ...
Epoch: 12 cost time: 0.7896866798400879
Epoch: 12, Steps: 9 | Train Loss: 0.145 Vali Loss: 0.692 Vali Acc: 0.790 Test Loss: 0.692 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6911334991455078
Epoch: 13, Steps: 9 | Train Loss: 0.102 Vali Loss: 0.656 Vali Acc: 0.775 Test Loss: 0.656 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.7964780330657959
Epoch: 14, Steps: 9 | Train Loss: 0.066 Vali Loss: 0.615 Vali Acc: 0.841 Test Loss: 0.615 Test Acc: 0.841
Validation loss decreased (-0.804342 --> -0.840574).  Saving model ...
Epoch: 15 cost time: 0.761127233505249
Epoch: 15, Steps: 9 | Train Loss: 0.038 Vali Loss: 0.659 Vali Acc: 0.812 Test Loss: 0.659 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8242635726928711
Epoch: 16, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.760 Vali Acc: 0.797 Test Loss: 0.760 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.8240489959716797
Epoch: 17, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.766 Vali Acc: 0.819 Test Loss: 0.766 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.8267908096313477
Epoch: 18, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.732 Vali Acc: 0.812 Test Loss: 0.732 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.779435396194458
Epoch: 19, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.744 Vali Acc: 0.797 Test Loss: 0.744 Test Acc: 0.797
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.7784998416900635
Epoch: 20, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.741 Vali Acc: 0.819 Test Loss: 0.741 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.8170974254608154
Epoch: 21, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.769 Vali Acc: 0.819 Test Loss: 0.769 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.0703349113464355
Epoch: 22, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.817 Vali Acc: 0.804 Test Loss: 0.817 Test Acc: 0.804
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.8482553958892822
Epoch: 23, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.809 Vali Acc: 0.826 Test Loss: 0.809 Test Acc: 0.826
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.8994126319885254
Epoch: 24, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.768 Vali Acc: 0.812 Test Loss: 0.768 Test Acc: 0.812
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el3_dm768_df768_ps26_str13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8405797101449275
model parameter : 22358788
model size : 99.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el3_dm768_df768_ps26_str26_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.992997884750366
Epoch: 1, Steps: 9 | Train Loss: 1.485 Vali Loss: 1.405 Vali Acc: 0.232 Test Loss: 1.405 Test Acc: 0.232
Validation loss decreased (inf --> -0.231870).  Saving model ...
Epoch: 2 cost time: 0.7976689338684082
Epoch: 2, Steps: 9 | Train Loss: 1.373 Vali Loss: 1.324 Vali Acc: 0.348 Test Loss: 1.324 Test Acc: 0.348
Validation loss decreased (-0.231870 --> -0.347813).  Saving model ...
Epoch: 3 cost time: 0.8537583351135254
Epoch: 3, Steps: 9 | Train Loss: 1.293 Vali Loss: 1.242 Vali Acc: 0.486 Test Loss: 1.242 Test Acc: 0.486
Validation loss decreased (-0.347813 --> -0.485495).  Saving model ...
Epoch: 4 cost time: 0.8179569244384766
Epoch: 4, Steps: 9 | Train Loss: 1.126 Vali Loss: 1.156 Vali Acc: 0.580 Test Loss: 1.156 Test Acc: 0.580
Validation loss decreased (-0.485495 --> -0.579699).  Saving model ...
Epoch: 5 cost time: 0.884803295135498
Epoch: 5, Steps: 9 | Train Loss: 1.060 Vali Loss: 1.073 Vali Acc: 0.616 Test Loss: 1.073 Test Acc: 0.616
Validation loss decreased (-0.579699 --> -0.615931).  Saving model ...
Epoch: 6 cost time: 0.7764568328857422
Epoch: 6, Steps: 9 | Train Loss: 0.885 Vali Loss: 1.005 Vali Acc: 0.623 Test Loss: 1.005 Test Acc: 0.623
Validation loss decreased (-0.615931 --> -0.623178).  Saving model ...
Epoch: 7 cost time: 0.830585241317749
Epoch: 7, Steps: 9 | Train Loss: 0.771 Vali Loss: 0.914 Vali Acc: 0.638 Test Loss: 0.914 Test Acc: 0.638
Validation loss decreased (-0.623178 --> -0.637672).  Saving model ...
Epoch: 8 cost time: 0.8685882091522217
Epoch: 8, Steps: 9 | Train Loss: 0.662 Vali Loss: 0.853 Vali Acc: 0.667 Test Loss: 0.853 Test Acc: 0.667
Validation loss decreased (-0.637672 --> -0.666658).  Saving model ...
Epoch: 9 cost time: 0.860187292098999
Epoch: 9, Steps: 9 | Train Loss: 0.564 Vali Loss: 0.814 Vali Acc: 0.674 Test Loss: 0.814 Test Acc: 0.674
Validation loss decreased (-0.666658 --> -0.673905).  Saving model ...
Epoch: 10 cost time: 0.9494976997375488
Epoch: 10, Steps: 9 | Train Loss: 0.465 Vali Loss: 0.738 Vali Acc: 0.688 Test Loss: 0.738 Test Acc: 0.688
Validation loss decreased (-0.673905 --> -0.688398).  Saving model ...
Epoch: 11 cost time: 0.7944304943084717
Epoch: 11, Steps: 9 | Train Loss: 0.375 Vali Loss: 0.719 Vali Acc: 0.754 Test Loss: 0.719 Test Acc: 0.754
Validation loss decreased (-0.688398 --> -0.753616).  Saving model ...
Epoch: 12 cost time: 0.8884546756744385
Epoch: 12, Steps: 9 | Train Loss: 0.279 Vali Loss: 0.698 Vali Acc: 0.739 Test Loss: 0.698 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9473109245300293
Epoch: 13, Steps: 9 | Train Loss: 0.227 Vali Loss: 0.700 Vali Acc: 0.768 Test Loss: 0.700 Test Acc: 0.768
Validation loss decreased (-0.753616 --> -0.768109).  Saving model ...
Epoch: 14 cost time: 0.920264482498169
Epoch: 14, Steps: 9 | Train Loss: 0.148 Vali Loss: 0.706 Vali Acc: 0.739 Test Loss: 0.706 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7893886566162109
Epoch: 15, Steps: 9 | Train Loss: 0.103 Vali Loss: 0.667 Vali Acc: 0.768 Test Loss: 0.667 Test Acc: 0.768
Validation loss decreased (-0.768109 --> -0.768109).  Saving model ...
Epoch: 16 cost time: 0.7651536464691162
Epoch: 16, Steps: 9 | Train Loss: 0.065 Vali Loss: 0.801 Vali Acc: 0.768 Test Loss: 0.801 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8772351741790771
Epoch: 17, Steps: 9 | Train Loss: 0.046 Vali Loss: 0.758 Vali Acc: 0.775 Test Loss: 0.758 Test Acc: 0.775
Validation loss decreased (-0.768109 --> -0.775355).  Saving model ...
Epoch: 18 cost time: 0.7518143653869629
Epoch: 18, Steps: 9 | Train Loss: 0.033 Vali Loss: 0.794 Vali Acc: 0.775 Test Loss: 0.794 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7794723510742188
Epoch: 19, Steps: 9 | Train Loss: 0.036 Vali Loss: 0.756 Vali Acc: 0.775 Test Loss: 0.756 Test Acc: 0.775
Validation loss decreased (-0.775355 --> -0.775355).  Saving model ...
Epoch: 20 cost time: 0.8251721858978271
Epoch: 20, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.777 Vali Acc: 0.804 Test Loss: 0.777 Test Acc: 0.804
Validation loss decreased (-0.775355 --> -0.804340).  Saving model ...
Epoch: 21 cost time: 0.9466745853424072
Epoch: 21, Steps: 9 | Train Loss: 0.018 Vali Loss: 0.870 Vali Acc: 0.797 Test Loss: 0.870 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8248991966247559
Epoch: 22, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.853 Vali Acc: 0.790 Test Loss: 0.853 Test Acc: 0.790
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.7958102226257324
Epoch: 23, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.871 Vali Acc: 0.797 Test Loss: 0.871 Test Acc: 0.797
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.8185975551605225
Epoch: 24, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.874 Vali Acc: 0.804 Test Loss: 0.874 Test Acc: 0.804
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.8672096729278564
Epoch: 25, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.878 Vali Acc: 0.804 Test Loss: 0.878 Test Acc: 0.804
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.7424275875091553
Epoch: 26, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.918 Vali Acc: 0.797 Test Loss: 0.918 Test Acc: 0.797
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.7345244884490967
Epoch: 27, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.899 Vali Acc: 0.797 Test Loss: 0.899 Test Acc: 0.797
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.9165604114532471
Epoch: 28, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.842 Vali Acc: 0.804 Test Loss: 0.842 Test Acc: 0.804
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.8521511554718018
Epoch: 29, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.868 Vali Acc: 0.812 Test Loss: 0.868 Test Acc: 0.812
Validation loss decreased (-0.804340 --> -0.811586).  Saving model ...
Epoch: 30 cost time: 0.8114542961120605
Epoch: 30, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.930 Vali Acc: 0.804 Test Loss: 0.930 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.8792159557342529
Epoch: 31, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.913 Vali Acc: 0.812 Test Loss: 0.913 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.7412736415863037
Epoch: 32, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.938 Vali Acc: 0.812 Test Loss: 0.938 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.8529653549194336
Epoch: 33, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.933 Vali Acc: 0.804 Test Loss: 0.933 Test Acc: 0.804
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.8750011920928955
Epoch: 34, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.908 Vali Acc: 0.812 Test Loss: 0.908 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.9227073192596436
Epoch: 35, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.934 Vali Acc: 0.804 Test Loss: 0.934 Test Acc: 0.804
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.8623251914978027
Epoch: 36, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.988 Vali Acc: 0.804 Test Loss: 0.988 Test Acc: 0.804
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.7261216640472412
Epoch: 37, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.996 Vali Acc: 0.797 Test Loss: 0.996 Test Acc: 0.797
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.7505815029144287
Epoch: 38, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.992 Vali Acc: 0.804 Test Loss: 0.992 Test Acc: 0.804
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.7930784225463867
Epoch: 39, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.987 Vali Acc: 0.804 Test Loss: 0.987 Test Acc: 0.804
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el3_dm768_df768_ps26_str26_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8115942028985508
model parameter : 22326532
model size : 99.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el3_dm768_df768_ps30_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.562018394470215
Epoch: 1, Steps: 9 | Train Loss: 1.463 Vali Loss: 1.368 Vali Acc: 0.355 Test Loss: 1.368 Test Acc: 0.355
Validation loss decreased (inf --> -0.355059).  Saving model ...
Epoch: 2 cost time: 1.1153514385223389
Epoch: 2, Steps: 9 | Train Loss: 1.287 Vali Loss: 1.192 Vali Acc: 0.471 Test Loss: 1.192 Test Acc: 0.471
Validation loss decreased (-0.355059 --> -0.471003).  Saving model ...
Epoch: 3 cost time: 1.106630563735962
Epoch: 3, Steps: 9 | Train Loss: 1.115 Vali Loss: 1.065 Vali Acc: 0.623 Test Loss: 1.065 Test Acc: 0.623
Validation loss decreased (-0.471003 --> -0.623178).  Saving model ...
Epoch: 4 cost time: 0.9978783130645752
Epoch: 4, Steps: 9 | Train Loss: 0.945 Vali Loss: 0.947 Vali Acc: 0.623 Test Loss: 0.947 Test Acc: 0.623
Validation loss decreased (-0.623178 --> -0.623179).  Saving model ...
Epoch: 5 cost time: 1.0000073909759521
Epoch: 5, Steps: 9 | Train Loss: 0.777 Vali Loss: 0.860 Vali Acc: 0.659 Test Loss: 0.860 Test Acc: 0.659
Validation loss decreased (-0.623179 --> -0.659412).  Saving model ...
Epoch: 6 cost time: 0.8973662853240967
Epoch: 6, Steps: 9 | Train Loss: 0.606 Vali Loss: 0.747 Vali Acc: 0.681 Test Loss: 0.747 Test Acc: 0.681
Validation loss decreased (-0.659412 --> -0.681152).  Saving model ...
Epoch: 7 cost time: 0.7716488838195801
Epoch: 7, Steps: 9 | Train Loss: 0.455 Vali Loss: 0.678 Vali Acc: 0.710 Test Loss: 0.678 Test Acc: 0.710
Validation loss decreased (-0.681152 --> -0.710138).  Saving model ...
Epoch: 8 cost time: 1.274749755859375
Epoch: 8, Steps: 9 | Train Loss: 0.326 Vali Loss: 0.603 Vali Acc: 0.725 Test Loss: 0.603 Test Acc: 0.725
Validation loss decreased (-0.710138 --> -0.724632).  Saving model ...
Epoch: 9 cost time: 1.1456289291381836
Epoch: 9, Steps: 9 | Train Loss: 0.251 Vali Loss: 0.721 Vali Acc: 0.754 Test Loss: 0.721 Test Acc: 0.754
Validation loss decreased (-0.724632 --> -0.753616).  Saving model ...
Epoch: 10 cost time: 1.183645486831665
Epoch: 10, Steps: 9 | Train Loss: 0.188 Vali Loss: 0.597 Vali Acc: 0.703 Test Loss: 0.597 Test Acc: 0.703
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0689265727996826
Epoch: 11, Steps: 9 | Train Loss: 0.121 Vali Loss: 0.845 Vali Acc: 0.761 Test Loss: 0.845 Test Acc: 0.761
Validation loss decreased (-0.753616 --> -0.760861).  Saving model ...
Epoch: 12 cost time: 1.154071569442749
Epoch: 12, Steps: 9 | Train Loss: 0.086 Vali Loss: 0.643 Vali Acc: 0.812 Test Loss: 0.643 Test Acc: 0.812
Validation loss decreased (-0.760861 --> -0.811588).  Saving model ...
Epoch: 13 cost time: 1.004967212677002
Epoch: 13, Steps: 9 | Train Loss: 0.053 Vali Loss: 0.631 Vali Acc: 0.819 Test Loss: 0.631 Test Acc: 0.819
Validation loss decreased (-0.811588 --> -0.818834).  Saving model ...
Epoch: 14 cost time: 0.966681957244873
Epoch: 14, Steps: 9 | Train Loss: 0.031 Vali Loss: 1.040 Vali Acc: 0.783 Test Loss: 1.040 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.96885085105896
Epoch: 15, Steps: 9 | Train Loss: 0.039 Vali Loss: 0.684 Vali Acc: 0.841 Test Loss: 0.684 Test Acc: 0.841
Validation loss decreased (-0.818834 --> -0.840573).  Saving model ...
Epoch: 16 cost time: 0.9027247428894043
Epoch: 16, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.799 Vali Acc: 0.804 Test Loss: 0.799 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0704529285430908
Epoch: 17, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.667 Vali Acc: 0.826 Test Loss: 0.667 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.4143085479736328
Epoch: 18, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.737 Vali Acc: 0.826 Test Loss: 0.737 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.0939569473266602
Epoch: 19, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.863 Vali Acc: 0.833 Test Loss: 0.863 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.155348777770996
Epoch: 20, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.770 Vali Acc: 0.841 Test Loss: 0.770 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.4326939582824707
Epoch: 21, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.728 Vali Acc: 0.833 Test Loss: 0.728 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.3337650299072266
Epoch: 22, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.770 Vali Acc: 0.833 Test Loss: 0.770 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.2955067157745361
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.826 Vali Acc: 0.841 Test Loss: 0.826 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.2594678401947021
Epoch: 24, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.788 Vali Acc: 0.848 Test Loss: 0.788 Test Acc: 0.848
Validation loss decreased (-0.840573 --> -0.847818).  Saving model ...
Epoch: 25 cost time: 1.181530237197876
Epoch: 25, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.769 Vali Acc: 0.848 Test Loss: 0.769 Test Acc: 0.848
Validation loss decreased (-0.847818 --> -0.847818).  Saving model ...
Epoch: 26 cost time: 0.9803431034088135
Epoch: 26, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.773 Vali Acc: 0.848 Test Loss: 0.773 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.001363754272461
Epoch: 27, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.811 Vali Acc: 0.848 Test Loss: 0.811 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.363006353378296
Epoch: 28, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.812 Vali Acc: 0.848 Test Loss: 0.812 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.86562180519104
Epoch: 29, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.790 Vali Acc: 0.848 Test Loss: 0.790 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.9728083610534668
Epoch: 30, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.810 Vali Acc: 0.848 Test Loss: 0.810 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.0889432430267334
Epoch: 31, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.818 Vali Acc: 0.848 Test Loss: 0.818 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.1758625507354736
Epoch: 32, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.818 Vali Acc: 0.848 Test Loss: 0.818 Test Acc: 0.848
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.0463976860046387
Epoch: 33, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.805 Vali Acc: 0.848 Test Loss: 0.805 Test Acc: 0.848
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.9900872707366943
Epoch: 34, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.813 Vali Acc: 0.848 Test Loss: 0.813 Test Acc: 0.848
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.0039169788360596
Epoch: 35, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.842 Vali Acc: 0.848 Test Loss: 0.842 Test Acc: 0.848
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el3_dm768_df768_ps30_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8478260869565217
model parameter : 22427908
model size : 100.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el3_dm768_df768_ps30_str15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.896901845932007
Epoch: 1, Steps: 9 | Train Loss: 1.420 Vali Loss: 1.411 Vali Acc: 0.174 Test Loss: 1.411 Test Acc: 0.174
Validation loss decreased (inf --> -0.173899).  Saving model ...
Epoch: 2 cost time: 0.7362520694732666
Epoch: 2, Steps: 9 | Train Loss: 1.287 Vali Loss: 1.313 Vali Acc: 0.399 Test Loss: 1.313 Test Acc: 0.399
Validation loss decreased (-0.173899 --> -0.398538).  Saving model ...
Epoch: 3 cost time: 0.8136491775512695
Epoch: 3, Steps: 9 | Train Loss: 1.269 Vali Loss: 1.228 Vali Acc: 0.428 Test Loss: 1.228 Test Acc: 0.428
Validation loss decreased (-0.398538 --> -0.427524).  Saving model ...
Epoch: 4 cost time: 0.7056872844696045
Epoch: 4, Steps: 9 | Train Loss: 1.126 Vali Loss: 1.148 Vali Acc: 0.457 Test Loss: 1.148 Test Acc: 0.457
Validation loss decreased (-0.427524 --> -0.456510).  Saving model ...
Epoch: 5 cost time: 0.7761030197143555
Epoch: 5, Steps: 9 | Train Loss: 0.961 Vali Loss: 1.055 Vali Acc: 0.478 Test Loss: 1.055 Test Acc: 0.478
Validation loss decreased (-0.456510 --> -0.478250).  Saving model ...
Epoch: 6 cost time: 0.792151927947998
Epoch: 6, Steps: 9 | Train Loss: 0.906 Vali Loss: 0.981 Vali Acc: 0.601 Test Loss: 0.981 Test Acc: 0.601
Validation loss decreased (-0.478250 --> -0.601439).  Saving model ...
Epoch: 7 cost time: 0.8271701335906982
Epoch: 7, Steps: 9 | Train Loss: 0.733 Vali Loss: 0.884 Vali Acc: 0.558 Test Loss: 0.884 Test Acc: 0.558
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.717266321182251
Epoch: 8, Steps: 9 | Train Loss: 0.594 Vali Loss: 0.849 Vali Acc: 0.630 Test Loss: 0.849 Test Acc: 0.630
Validation loss decreased (-0.601439 --> -0.630426).  Saving model ...
Epoch: 9 cost time: 0.7883107662200928
Epoch: 9, Steps: 9 | Train Loss: 0.460 Vali Loss: 0.650 Vali Acc: 0.688 Test Loss: 0.650 Test Acc: 0.688
Validation loss decreased (-0.630426 --> -0.688399).  Saving model ...
Epoch: 10 cost time: 0.6639273166656494
Epoch: 10, Steps: 9 | Train Loss: 0.343 Vali Loss: 0.652 Vali Acc: 0.717 Test Loss: 0.652 Test Acc: 0.717
Validation loss decreased (-0.688399 --> -0.717385).  Saving model ...
Epoch: 11 cost time: 0.7638938426971436
Epoch: 11, Steps: 9 | Train Loss: 0.244 Vali Loss: 0.577 Vali Acc: 0.775 Test Loss: 0.577 Test Acc: 0.775
Validation loss decreased (-0.717385 --> -0.775357).  Saving model ...
Epoch: 12 cost time: 0.7195854187011719
Epoch: 12, Steps: 9 | Train Loss: 0.150 Vali Loss: 0.652 Vali Acc: 0.768 Test Loss: 0.652 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7026882171630859
Epoch: 13, Steps: 9 | Train Loss: 0.124 Vali Loss: 0.655 Vali Acc: 0.775 Test Loss: 0.655 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.8309488296508789
Epoch: 14, Steps: 9 | Train Loss: 0.090 Vali Loss: 0.728 Vali Acc: 0.783 Test Loss: 0.728 Test Acc: 0.783
Validation loss decreased (-0.775357 --> -0.782601).  Saving model ...
Epoch: 15 cost time: 0.7696232795715332
Epoch: 15, Steps: 9 | Train Loss: 0.050 Vali Loss: 0.640 Vali Acc: 0.775 Test Loss: 0.640 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0522589683532715
Epoch: 16, Steps: 9 | Train Loss: 0.032 Vali Loss: 0.696 Vali Acc: 0.797 Test Loss: 0.696 Test Acc: 0.797
Validation loss decreased (-0.782601 --> -0.797094).  Saving model ...
Epoch: 17 cost time: 0.8271944522857666
Epoch: 17, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.785 Vali Acc: 0.804 Test Loss: 0.785 Test Acc: 0.804
Validation loss decreased (-0.797094 --> -0.804340).  Saving model ...
Epoch: 18 cost time: 0.7559454441070557
Epoch: 18, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.734 Vali Acc: 0.804 Test Loss: 0.734 Test Acc: 0.804
Validation loss decreased (-0.804340 --> -0.804340).  Saving model ...
Epoch: 19 cost time: 0.8462142944335938
Epoch: 19, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.727 Vali Acc: 0.812 Test Loss: 0.727 Test Acc: 0.812
Validation loss decreased (-0.804340 --> -0.811587).  Saving model ...
Epoch: 20 cost time: 0.8089165687561035
Epoch: 20, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.757 Vali Acc: 0.819 Test Loss: 0.757 Test Acc: 0.819
Validation loss decreased (-0.811587 --> -0.818833).  Saving model ...
Epoch: 21 cost time: 0.8350832462310791
Epoch: 21, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.726 Vali Acc: 0.826 Test Loss: 0.726 Test Acc: 0.826
Validation loss decreased (-0.818833 --> -0.826080).  Saving model ...
Epoch: 22 cost time: 0.7711188793182373
Epoch: 22, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.780 Vali Acc: 0.804 Test Loss: 0.780 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6586155891418457
Epoch: 23, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.759 Vali Acc: 0.812 Test Loss: 0.759 Test Acc: 0.812
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.8343174457550049
Epoch: 24, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.762 Vali Acc: 0.833 Test Loss: 0.762 Test Acc: 0.833
Validation loss decreased (-0.826080 --> -0.833326).  Saving model ...
Epoch: 25 cost time: 0.8406214714050293
Epoch: 25, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.786 Vali Acc: 0.841 Test Loss: 0.786 Test Acc: 0.841
Validation loss decreased (-0.833326 --> -0.840572).  Saving model ...
Epoch: 26 cost time: 0.7558426856994629
Epoch: 26, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.734 Vali Acc: 0.848 Test Loss: 0.734 Test Acc: 0.848
Validation loss decreased (-0.840572 --> -0.847819).  Saving model ...
Epoch: 27 cost time: 0.8115108013153076
Epoch: 27, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.775 Vali Acc: 0.833 Test Loss: 0.775 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.7934551239013672
Epoch: 28, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.839 Vali Acc: 0.833 Test Loss: 0.839 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.9849538803100586
Epoch: 29, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.798 Vali Acc: 0.848 Test Loss: 0.798 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.83829665184021
Epoch: 30, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.798 Vali Acc: 0.848 Test Loss: 0.798 Test Acc: 0.848
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.7578296661376953
Epoch: 31, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.794 Vali Acc: 0.841 Test Loss: 0.794 Test Acc: 0.841
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.7568004131317139
Epoch: 32, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.801 Vali Acc: 0.848 Test Loss: 0.801 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.9139053821563721
Epoch: 33, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.816 Vali Acc: 0.848 Test Loss: 0.816 Test Acc: 0.848
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.0041701793670654
Epoch: 34, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.837 Vali Acc: 0.848 Test Loss: 0.837 Test Acc: 0.848
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.898735523223877
Epoch: 35, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.829 Vali Acc: 0.848 Test Loss: 0.829 Test Acc: 0.848
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.7968435287475586
Epoch: 36, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.858 Vali Acc: 0.841 Test Loss: 0.858 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el3_dm768_df768_ps30_str15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8478260869565217
model parameter : 22377220
model size : 100.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el3_dm768_df768_ps30_str30_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.085324764251709
Epoch: 1, Steps: 9 | Train Loss: 1.482 Vali Loss: 1.376 Vali Acc: 0.341 Test Loss: 1.376 Test Acc: 0.341
Validation loss decreased (inf --> -0.340566).  Saving model ...
Epoch: 2 cost time: 0.9202382564544678
Epoch: 2, Steps: 9 | Train Loss: 1.325 Vali Loss: 1.327 Vali Acc: 0.362 Test Loss: 1.327 Test Acc: 0.362
Validation loss decreased (-0.340566 --> -0.362306).  Saving model ...
Epoch: 3 cost time: 0.7284700870513916
Epoch: 3, Steps: 9 | Train Loss: 1.289 Vali Loss: 1.264 Vali Acc: 0.399 Test Loss: 1.264 Test Acc: 0.399
Validation loss decreased (-0.362306 --> -0.398538).  Saving model ...
Epoch: 4 cost time: 0.9052391052246094
Epoch: 4, Steps: 9 | Train Loss: 1.192 Vali Loss: 1.189 Vali Acc: 0.587 Test Loss: 1.189 Test Acc: 0.587
Validation loss decreased (-0.398538 --> -0.586945).  Saving model ...
Epoch: 5 cost time: 0.7548060417175293
Epoch: 5, Steps: 9 | Train Loss: 1.086 Vali Loss: 1.107 Vali Acc: 0.601 Test Loss: 1.107 Test Acc: 0.601
Validation loss decreased (-0.586945 --> -0.601438).  Saving model ...
Epoch: 6 cost time: 0.7189631462097168
Epoch: 6, Steps: 9 | Train Loss: 0.951 Vali Loss: 1.023 Vali Acc: 0.587 Test Loss: 1.023 Test Acc: 0.587
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8465752601623535
Epoch: 7, Steps: 9 | Train Loss: 0.866 Vali Loss: 0.937 Vali Acc: 0.601 Test Loss: 0.937 Test Acc: 0.601
Validation loss decreased (-0.601438 --> -0.601440).  Saving model ...
Epoch: 8 cost time: 0.7760329246520996
Epoch: 8, Steps: 9 | Train Loss: 0.755 Vali Loss: 0.872 Vali Acc: 0.638 Test Loss: 0.872 Test Acc: 0.638
Validation loss decreased (-0.601440 --> -0.637672).  Saving model ...
Epoch: 9 cost time: 0.8066668510437012
Epoch: 9, Steps: 9 | Train Loss: 0.658 Vali Loss: 0.794 Vali Acc: 0.652 Test Loss: 0.794 Test Acc: 0.652
Validation loss decreased (-0.637672 --> -0.652166).  Saving model ...
Epoch: 10 cost time: 0.8424077033996582
Epoch: 10, Steps: 9 | Train Loss: 0.554 Vali Loss: 0.779 Vali Acc: 0.638 Test Loss: 0.779 Test Acc: 0.638
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0476038455963135
Epoch: 11, Steps: 9 | Train Loss: 0.448 Vali Loss: 0.760 Vali Acc: 0.645 Test Loss: 0.760 Test Acc: 0.645
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.8815915584564209
Epoch: 12, Steps: 9 | Train Loss: 0.363 Vali Loss: 0.708 Vali Acc: 0.717 Test Loss: 0.708 Test Acc: 0.717
Validation loss decreased (-0.652166 --> -0.717384).  Saving model ...
Epoch: 13 cost time: 0.7906725406646729
Epoch: 13, Steps: 9 | Train Loss: 0.302 Vali Loss: 0.691 Vali Acc: 0.696 Test Loss: 0.691 Test Acc: 0.696
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7668659687042236
Epoch: 14, Steps: 9 | Train Loss: 0.221 Vali Loss: 0.671 Vali Acc: 0.739 Test Loss: 0.671 Test Acc: 0.739
Validation loss decreased (-0.717384 --> -0.739124).  Saving model ...
Epoch: 15 cost time: 0.8195912837982178
Epoch: 15, Steps: 9 | Train Loss: 0.151 Vali Loss: 0.719 Vali Acc: 0.746 Test Loss: 0.719 Test Acc: 0.746
Validation loss decreased (-0.739124 --> -0.746370).  Saving model ...
Epoch: 16 cost time: 0.8829517364501953
Epoch: 16, Steps: 9 | Train Loss: 0.127 Vali Loss: 0.639 Vali Acc: 0.761 Test Loss: 0.639 Test Acc: 0.761
Validation loss decreased (-0.746370 --> -0.760863).  Saving model ...
Epoch: 17 cost time: 0.8866536617279053
Epoch: 17, Steps: 9 | Train Loss: 0.100 Vali Loss: 0.695 Vali Acc: 0.775 Test Loss: 0.695 Test Acc: 0.775
Validation loss decreased (-0.760863 --> -0.775355).  Saving model ...
Epoch: 18 cost time: 0.9618494510650635
Epoch: 18, Steps: 9 | Train Loss: 0.055 Vali Loss: 0.663 Vali Acc: 0.761 Test Loss: 0.663 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8383946418762207
Epoch: 19, Steps: 9 | Train Loss: 0.044 Vali Loss: 0.671 Vali Acc: 0.761 Test Loss: 0.671 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8428530693054199
Epoch: 20, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.693 Vali Acc: 0.797 Test Loss: 0.693 Test Acc: 0.797
Validation loss decreased (-0.775355 --> -0.797095).  Saving model ...
Epoch: 21 cost time: 0.8500304222106934
Epoch: 21, Steps: 9 | Train Loss: 0.026 Vali Loss: 0.694 Vali Acc: 0.783 Test Loss: 0.694 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8046238422393799
Epoch: 22, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.691 Vali Acc: 0.775 Test Loss: 0.691 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.7829985618591309
Epoch: 23, Steps: 9 | Train Loss: 0.019 Vali Loss: 0.672 Vali Acc: 0.797 Test Loss: 0.672 Test Acc: 0.797
Validation loss decreased (-0.797095 --> -0.797095).  Saving model ...
Epoch: 24 cost time: 0.8839945793151855
Epoch: 24, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.714 Vali Acc: 0.790 Test Loss: 0.714 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9401788711547852
Epoch: 25, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.748 Vali Acc: 0.790 Test Loss: 0.748 Test Acc: 0.790
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.8125119209289551
Epoch: 26, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.723 Vali Acc: 0.819 Test Loss: 0.723 Test Acc: 0.819
Validation loss decreased (-0.797095 --> -0.818833).  Saving model ...
Epoch: 27 cost time: 0.8347256183624268
Epoch: 27, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.691 Vali Acc: 0.804 Test Loss: 0.691 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.7787880897521973
Epoch: 28, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.692 Vali Acc: 0.826 Test Loss: 0.692 Test Acc: 0.826
Validation loss decreased (-0.818833 --> -0.826080).  Saving model ...
Epoch: 29 cost time: 0.8481636047363281
Epoch: 29, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.720 Vali Acc: 0.819 Test Loss: 0.720 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.0390760898590088
Epoch: 30, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.728 Vali Acc: 0.819 Test Loss: 0.728 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.9290354251861572
Epoch: 31, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.739 Vali Acc: 0.812 Test Loss: 0.739 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.9380228519439697
Epoch: 32, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.763 Vali Acc: 0.804 Test Loss: 0.763 Test Acc: 0.804
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.8474977016448975
Epoch: 33, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.779 Vali Acc: 0.797 Test Loss: 0.779 Test Acc: 0.797
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.9674460887908936
Epoch: 34, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.735 Vali Acc: 0.819 Test Loss: 0.735 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.8854331970214844
Epoch: 35, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.744 Vali Acc: 0.819 Test Loss: 0.744 Test Acc: 0.819
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.9559390544891357
Epoch: 36, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.782 Vali Acc: 0.826 Test Loss: 0.782 Test Acc: 0.826
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.7639024257659912
Epoch: 37, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.791 Vali Acc: 0.819 Test Loss: 0.791 Test Acc: 0.819
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 0.7602357864379883
Epoch: 38, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.769 Vali Acc: 0.826 Test Loss: 0.769 Test Acc: 0.826
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el3_dm768_df768_ps30_str30_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8260869565217391
model parameter : 22349572
model size : 99.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el3_dm768_df768_ps35_str9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.0923044681549072
Epoch: 1, Steps: 9 | Train Loss: 1.473 Vali Loss: 1.363 Vali Acc: 0.297 Test Loss: 1.363 Test Acc: 0.297
Validation loss decreased (inf --> -0.297088).  Saving model ...
Epoch: 2 cost time: 0.9781277179718018
Epoch: 2, Steps: 9 | Train Loss: 1.311 Vali Loss: 1.242 Vali Acc: 0.399 Test Loss: 1.242 Test Acc: 0.399
Validation loss decreased (-0.297088 --> -0.398538).  Saving model ...
Epoch: 3 cost time: 1.164499044418335
Epoch: 3, Steps: 9 | Train Loss: 1.096 Vali Loss: 1.112 Vali Acc: 0.580 Test Loss: 1.112 Test Acc: 0.580
Validation loss decreased (-0.398538 --> -0.579699).  Saving model ...
Epoch: 4 cost time: 1.1643495559692383
Epoch: 4, Steps: 9 | Train Loss: 0.938 Vali Loss: 1.026 Vali Acc: 0.652 Test Loss: 1.026 Test Acc: 0.652
Validation loss decreased (-0.579699 --> -0.652164).  Saving model ...
Epoch: 5 cost time: 1.1510353088378906
Epoch: 5, Steps: 9 | Train Loss: 0.823 Vali Loss: 0.901 Vali Acc: 0.659 Test Loss: 0.901 Test Acc: 0.659
Validation loss decreased (-0.652164 --> -0.659411).  Saving model ...
Epoch: 6 cost time: 1.1543238162994385
Epoch: 6, Steps: 9 | Train Loss: 0.638 Vali Loss: 0.796 Vali Acc: 0.674 Test Loss: 0.796 Test Acc: 0.674
Validation loss decreased (-0.659411 --> -0.673905).  Saving model ...
Epoch: 7 cost time: 1.2379217147827148
Epoch: 7, Steps: 9 | Train Loss: 0.520 Vali Loss: 0.742 Vali Acc: 0.638 Test Loss: 0.742 Test Acc: 0.638
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9197597503662109
Epoch: 8, Steps: 9 | Train Loss: 0.373 Vali Loss: 0.631 Vali Acc: 0.761 Test Loss: 0.631 Test Acc: 0.761
Validation loss decreased (-0.673905 --> -0.760863).  Saving model ...
Epoch: 9 cost time: 0.9822430610656738
Epoch: 9, Steps: 9 | Train Loss: 0.247 Vali Loss: 0.643 Vali Acc: 0.754 Test Loss: 0.643 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3607463836669922
Epoch: 10, Steps: 9 | Train Loss: 0.186 Vali Loss: 0.738 Vali Acc: 0.775 Test Loss: 0.738 Test Acc: 0.775
Validation loss decreased (-0.760863 --> -0.775355).  Saving model ...
Epoch: 11 cost time: 1.1154100894927979
Epoch: 11, Steps: 9 | Train Loss: 0.091 Vali Loss: 0.682 Vali Acc: 0.812 Test Loss: 0.682 Test Acc: 0.812
Validation loss decreased (-0.775355 --> -0.811587).  Saving model ...
Epoch: 12 cost time: 1.1218469142913818
Epoch: 12, Steps: 9 | Train Loss: 0.075 Vali Loss: 0.664 Vali Acc: 0.812 Test Loss: 0.664 Test Acc: 0.812
Validation loss decreased (-0.811587 --> -0.811588).  Saving model ...
Epoch: 13 cost time: 0.9085159301757812
Epoch: 13, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.686 Vali Acc: 0.833 Test Loss: 0.686 Test Acc: 0.833
Validation loss decreased (-0.811588 --> -0.833326).  Saving model ...
Epoch: 14 cost time: 0.8769190311431885
Epoch: 14, Steps: 9 | Train Loss: 0.022 Vali Loss: 0.940 Vali Acc: 0.812 Test Loss: 0.940 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9556958675384521
Epoch: 15, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.897 Vali Acc: 0.797 Test Loss: 0.897 Test Acc: 0.797
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9896869659423828
Epoch: 16, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.932 Vali Acc: 0.812 Test Loss: 0.932 Test Acc: 0.812
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.0059840679168701
Epoch: 17, Steps: 9 | Train Loss: 0.008 Vali Loss: 1.005 Vali Acc: 0.812 Test Loss: 1.005 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.049208641052246
Epoch: 18, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.811 Vali Acc: 0.819 Test Loss: 0.811 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.0667145252227783
Epoch: 19, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.988 Vali Acc: 0.812 Test Loss: 0.988 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.045821189880371
Epoch: 20, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.043 Vali Acc: 0.812 Test Loss: 1.043 Test Acc: 0.812
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.0756494998931885
Epoch: 21, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.018 Vali Acc: 0.812 Test Loss: 1.018 Test Acc: 0.812
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.1107349395751953
Epoch: 22, Steps: 9 | Train Loss: 0.002 Vali Loss: 1.010 Vali Acc: 0.804 Test Loss: 1.010 Test Acc: 0.804
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.0228066444396973
Epoch: 23, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.992 Vali Acc: 0.812 Test Loss: 0.992 Test Acc: 0.812
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el3_dm768_df768_ps35_str9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8333333333333334
model parameter : 22448644
model size : 100.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el3_dm768_df768_ps35_str18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.352020263671875
Epoch: 1, Steps: 9 | Train Loss: 1.524 Vali Loss: 1.388 Vali Acc: 0.304 Test Loss: 1.388 Test Acc: 0.304
Validation loss decreased (inf --> -0.304334).  Saving model ...
Epoch: 2 cost time: 0.9803860187530518
Epoch: 2, Steps: 9 | Train Loss: 1.429 Vali Loss: 1.299 Vali Acc: 0.355 Test Loss: 1.299 Test Acc: 0.355
Validation loss decreased (-0.304334 --> -0.355059).  Saving model ...
Epoch: 3 cost time: 0.7095553874969482
Epoch: 3, Steps: 9 | Train Loss: 1.247 Vali Loss: 1.197 Vali Acc: 0.507 Test Loss: 1.197 Test Acc: 0.507
Validation loss decreased (-0.355059 --> -0.507234).  Saving model ...
Epoch: 4 cost time: 0.8812487125396729
Epoch: 4, Steps: 9 | Train Loss: 1.144 Vali Loss: 1.098 Vali Acc: 0.565 Test Loss: 1.098 Test Acc: 0.565
Validation loss decreased (-0.507234 --> -0.565206).  Saving model ...
Epoch: 5 cost time: 0.8273286819458008
Epoch: 5, Steps: 9 | Train Loss: 0.987 Vali Loss: 1.003 Vali Acc: 0.609 Test Loss: 1.003 Test Acc: 0.609
Validation loss decreased (-0.565206 --> -0.608686).  Saving model ...
Epoch: 6 cost time: 0.8459475040435791
Epoch: 6, Steps: 9 | Train Loss: 0.805 Vali Loss: 0.916 Vali Acc: 0.674 Test Loss: 0.916 Test Acc: 0.674
Validation loss decreased (-0.608686 --> -0.673904).  Saving model ...
Epoch: 7 cost time: 0.7226395606994629
Epoch: 7, Steps: 9 | Train Loss: 0.737 Vali Loss: 0.827 Vali Acc: 0.652 Test Loss: 0.827 Test Acc: 0.652
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7812602519989014
Epoch: 8, Steps: 9 | Train Loss: 0.608 Vali Loss: 0.757 Vali Acc: 0.688 Test Loss: 0.757 Test Acc: 0.688
Validation loss decreased (-0.673904 --> -0.688398).  Saving model ...
Epoch: 9 cost time: 1.0155541896820068
Epoch: 9, Steps: 9 | Train Loss: 0.502 Vali Loss: 0.719 Vali Acc: 0.696 Test Loss: 0.719 Test Acc: 0.696
Validation loss decreased (-0.688398 --> -0.695645).  Saving model ...
Epoch: 10 cost time: 0.6650180816650391
Epoch: 10, Steps: 9 | Train Loss: 0.367 Vali Loss: 0.678 Vali Acc: 0.725 Test Loss: 0.678 Test Acc: 0.725
Validation loss decreased (-0.695645 --> -0.724631).  Saving model ...
Epoch: 11 cost time: 0.7552626132965088
Epoch: 11, Steps: 9 | Train Loss: 0.301 Vali Loss: 0.635 Vali Acc: 0.754 Test Loss: 0.635 Test Acc: 0.754
Validation loss decreased (-0.724631 --> -0.753617).  Saving model ...
Epoch: 12 cost time: 0.8021795749664307
Epoch: 12, Steps: 9 | Train Loss: 0.197 Vali Loss: 0.738 Vali Acc: 0.775 Test Loss: 0.738 Test Acc: 0.775
Validation loss decreased (-0.753617 --> -0.775355).  Saving model ...
Epoch: 13 cost time: 0.7891194820404053
Epoch: 13, Steps: 9 | Train Loss: 0.113 Vali Loss: 0.701 Vali Acc: 0.783 Test Loss: 0.701 Test Acc: 0.783
Validation loss decreased (-0.775355 --> -0.782602).  Saving model ...
Epoch: 14 cost time: 0.8503010272979736
Epoch: 14, Steps: 9 | Train Loss: 0.074 Vali Loss: 0.802 Vali Acc: 0.761 Test Loss: 0.802 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7436003684997559
Epoch: 15, Steps: 9 | Train Loss: 0.055 Vali Loss: 0.914 Vali Acc: 0.754 Test Loss: 0.914 Test Acc: 0.754
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.8349814414978027
Epoch: 16, Steps: 9 | Train Loss: 0.031 Vali Loss: 0.830 Vali Acc: 0.783 Test Loss: 0.830 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.7198629379272461
Epoch: 17, Steps: 9 | Train Loss: 0.021 Vali Loss: 0.949 Vali Acc: 0.761 Test Loss: 0.949 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.7712562084197998
Epoch: 18, Steps: 9 | Train Loss: 0.014 Vali Loss: 0.934 Vali Acc: 0.768 Test Loss: 0.934 Test Acc: 0.768
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.7859609127044678
Epoch: 19, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.849 Vali Acc: 0.775 Test Loss: 0.849 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.6071317195892334
Epoch: 20, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.981 Vali Acc: 0.768 Test Loss: 0.981 Test Acc: 0.768
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.8437902927398682
Epoch: 21, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.955 Vali Acc: 0.768 Test Loss: 0.955 Test Acc: 0.768
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.8710145950317383
Epoch: 22, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.923 Vali Acc: 0.783 Test Loss: 0.923 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.6889872550964355
Epoch: 23, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.999 Vali Acc: 0.768 Test Loss: 0.999 Test Acc: 0.768
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el3_dm768_df768_ps35_str18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.782608695652174
model parameter : 22402564
model size : 100.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el3_dm768_df768_ps35_str35_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.976465940475464
Epoch: 1, Steps: 9 | Train Loss: 1.443 Vali Loss: 1.431 Vali Acc: 0.283 Test Loss: 1.431 Test Acc: 0.283
Validation loss decreased (inf --> -0.282594).  Saving model ...
Epoch: 2 cost time: 0.7660632133483887
Epoch: 2, Steps: 9 | Train Loss: 1.365 Vali Loss: 1.343 Vali Acc: 0.312 Test Loss: 1.343 Test Acc: 0.312
Validation loss decreased (-0.282594 --> -0.311581).  Saving model ...
Epoch: 3 cost time: 0.8294389247894287
Epoch: 3, Steps: 9 | Train Loss: 1.250 Vali Loss: 1.264 Vali Acc: 0.486 Test Loss: 1.264 Test Acc: 0.486
Validation loss decreased (-0.311581 --> -0.485495).  Saving model ...
Epoch: 4 cost time: 0.7636764049530029
Epoch: 4, Steps: 9 | Train Loss: 1.146 Vali Loss: 1.179 Vali Acc: 0.543 Test Loss: 1.179 Test Acc: 0.543
Validation loss decreased (-0.485495 --> -0.543466).  Saving model ...
Epoch: 5 cost time: 0.6593925952911377
Epoch: 5, Steps: 9 | Train Loss: 1.052 Vali Loss: 1.101 Vali Acc: 0.609 Test Loss: 1.101 Test Acc: 0.609
Validation loss decreased (-0.543466 --> -0.608685).  Saving model ...
Epoch: 6 cost time: 0.6657571792602539
Epoch: 6, Steps: 9 | Train Loss: 0.930 Vali Loss: 1.003 Vali Acc: 0.616 Test Loss: 1.003 Test Acc: 0.616
Validation loss decreased (-0.608685 --> -0.615932).  Saving model ...
Epoch: 7 cost time: 0.9174978733062744
Epoch: 7, Steps: 9 | Train Loss: 0.855 Vali Loss: 0.908 Vali Acc: 0.652 Test Loss: 0.908 Test Acc: 0.652
Validation loss decreased (-0.615932 --> -0.652165).  Saving model ...
Epoch: 8 cost time: 0.6091077327728271
Epoch: 8, Steps: 9 | Train Loss: 0.712 Vali Loss: 0.837 Vali Acc: 0.638 Test Loss: 0.837 Test Acc: 0.638
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8364801406860352
Epoch: 9, Steps: 9 | Train Loss: 0.664 Vali Loss: 0.802 Vali Acc: 0.674 Test Loss: 0.802 Test Acc: 0.674
Validation loss decreased (-0.652165 --> -0.673905).  Saving model ...
Epoch: 10 cost time: 0.7627828121185303
Epoch: 10, Steps: 9 | Train Loss: 0.495 Vali Loss: 0.760 Vali Acc: 0.674 Test Loss: 0.760 Test Acc: 0.674
Validation loss decreased (-0.673905 --> -0.673905).  Saving model ...
Epoch: 11 cost time: 0.6948373317718506
Epoch: 11, Steps: 9 | Train Loss: 0.421 Vali Loss: 0.732 Vali Acc: 0.696 Test Loss: 0.732 Test Acc: 0.696
Validation loss decreased (-0.673905 --> -0.695645).  Saving model ...
Epoch: 12 cost time: 0.7212777137756348
Epoch: 12, Steps: 9 | Train Loss: 0.324 Vali Loss: 0.770 Vali Acc: 0.703 Test Loss: 0.770 Test Acc: 0.703
Validation loss decreased (-0.695645 --> -0.702891).  Saving model ...
Epoch: 13 cost time: 0.8027517795562744
Epoch: 13, Steps: 9 | Train Loss: 0.272 Vali Loss: 0.724 Vali Acc: 0.717 Test Loss: 0.724 Test Acc: 0.717
Validation loss decreased (-0.702891 --> -0.717384).  Saving model ...
Epoch: 14 cost time: 0.8253259658813477
Epoch: 14, Steps: 9 | Train Loss: 0.176 Vali Loss: 0.762 Vali Acc: 0.696 Test Loss: 0.762 Test Acc: 0.696
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6843397617340088
Epoch: 15, Steps: 9 | Train Loss: 0.146 Vali Loss: 0.782 Vali Acc: 0.732 Test Loss: 0.782 Test Acc: 0.732
Validation loss decreased (-0.717384 --> -0.731876).  Saving model ...
Epoch: 16 cost time: 0.72524094581604
Epoch: 16, Steps: 9 | Train Loss: 0.104 Vali Loss: 0.687 Vali Acc: 0.746 Test Loss: 0.687 Test Acc: 0.746
Validation loss decreased (-0.731876 --> -0.746370).  Saving model ...
Epoch: 17 cost time: 0.7366788387298584
Epoch: 17, Steps: 9 | Train Loss: 0.080 Vali Loss: 0.808 Vali Acc: 0.761 Test Loss: 0.808 Test Acc: 0.761
Validation loss decreased (-0.746370 --> -0.760861).  Saving model ...
Epoch: 18 cost time: 0.8500990867614746
Epoch: 18, Steps: 9 | Train Loss: 0.062 Vali Loss: 0.839 Vali Acc: 0.746 Test Loss: 0.839 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7599308490753174
Epoch: 19, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.788 Vali Acc: 0.761 Test Loss: 0.788 Test Acc: 0.761
Validation loss decreased (-0.760861 --> -0.760862).  Saving model ...
Epoch: 20 cost time: 0.6915526390075684
Epoch: 20, Steps: 9 | Train Loss: 0.040 Vali Loss: 0.942 Vali Acc: 0.754 Test Loss: 0.942 Test Acc: 0.754
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8501682281494141
Epoch: 21, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.880 Vali Acc: 0.754 Test Loss: 0.880 Test Acc: 0.754
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.8179495334625244
Epoch: 22, Steps: 9 | Train Loss: 0.024 Vali Loss: 0.848 Vali Acc: 0.761 Test Loss: 0.848 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.8621196746826172
Epoch: 23, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.883 Vali Acc: 0.768 Test Loss: 0.883 Test Acc: 0.768
Validation loss decreased (-0.760862 --> -0.768107).  Saving model ...
Epoch: 24 cost time: 0.7236387729644775
Epoch: 24, Steps: 9 | Train Loss: 0.015 Vali Loss: 0.911 Vali Acc: 0.761 Test Loss: 0.911 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7867965698242188
Epoch: 25, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.925 Vali Acc: 0.761 Test Loss: 0.925 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.8863763809204102
Epoch: 26, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.896 Vali Acc: 0.761 Test Loss: 0.896 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.9360806941986084
Epoch: 27, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.915 Vali Acc: 0.761 Test Loss: 0.915 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.6773221492767334
Epoch: 28, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.958 Vali Acc: 0.754 Test Loss: 0.958 Test Acc: 0.754
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.7735292911529541
Epoch: 29, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.974 Vali Acc: 0.761 Test Loss: 0.974 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.6857316493988037
Epoch: 30, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.966 Vali Acc: 0.761 Test Loss: 0.966 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.9074711799621582
Epoch: 31, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.970 Vali Acc: 0.768 Test Loss: 0.970 Test Acc: 0.768
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.7383818626403809
Epoch: 32, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.981 Vali Acc: 0.761 Test Loss: 0.981 Test Acc: 0.761
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.8205716609954834
Epoch: 33, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.969 Vali Acc: 0.775 Test Loss: 0.969 Test Acc: 0.775
Validation loss decreased (-0.768107 --> -0.775353).  Saving model ...
Epoch: 34 cost time: 0.8428757190704346
Epoch: 34, Steps: 9 | Train Loss: 0.006 Vali Loss: 1.003 Vali Acc: 0.768 Test Loss: 1.003 Test Acc: 0.768
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.8418903350830078
Epoch: 35, Steps: 9 | Train Loss: 0.005 Vali Loss: 1.032 Vali Acc: 0.768 Test Loss: 1.032 Test Acc: 0.768
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.8321483135223389
Epoch: 36, Steps: 9 | Train Loss: 0.005 Vali Loss: 1.006 Vali Acc: 0.761 Test Loss: 1.006 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.9219827651977539
Epoch: 37, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.978 Vali Acc: 0.768 Test Loss: 0.978 Test Acc: 0.768
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.9335675239562988
Epoch: 38, Steps: 9 | Train Loss: 0.005 Vali Loss: 1.005 Vali Acc: 0.761 Test Loss: 1.005 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.8698432445526123
Epoch: 39, Steps: 9 | Train Loss: 0.004 Vali Loss: 1.042 Vali Acc: 0.761 Test Loss: 1.042 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.7230453491210938
Epoch: 40, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.037 Vali Acc: 0.761 Test Loss: 1.037 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.8135535717010498
Epoch: 41, Steps: 9 | Train Loss: 0.003 Vali Loss: 1.012 Vali Acc: 0.761 Test Loss: 1.012 Test Acc: 0.761
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.0140666961669922
Epoch: 42, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.991 Vali Acc: 0.775 Test Loss: 0.991 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 1.1370291709899902
Epoch: 43, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.991 Vali Acc: 0.768 Test Loss: 0.991 Test Acc: 0.768
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el3_dm768_df768_ps35_str35_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.7753623188405797
model parameter : 22379524
model size : 100.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el3_dm768_df768_ps42_str11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.789262056350708
Epoch: 1, Steps: 9 | Train Loss: 1.514 Vali Loss: 1.420 Vali Acc: 0.159 Test Loss: 1.420 Test Acc: 0.159
Validation loss decreased (inf --> -0.159406).  Saving model ...
Epoch: 2 cost time: 1.0236387252807617
Epoch: 2, Steps: 9 | Train Loss: 1.333 Vali Loss: 1.255 Vali Acc: 0.558 Test Loss: 1.255 Test Acc: 0.558
Validation loss decreased (-0.159406 --> -0.557958).  Saving model ...
Epoch: 3 cost time: 0.8847010135650635
Epoch: 3, Steps: 9 | Train Loss: 1.205 Vali Loss: 1.122 Vali Acc: 0.623 Test Loss: 1.122 Test Acc: 0.623
Validation loss decreased (-0.557958 --> -0.623177).  Saving model ...
Epoch: 4 cost time: 1.0112602710723877
Epoch: 4, Steps: 9 | Train Loss: 1.030 Vali Loss: 1.037 Vali Acc: 0.601 Test Loss: 1.037 Test Acc: 0.601
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8934731483459473
Epoch: 5, Steps: 9 | Train Loss: 0.900 Vali Loss: 0.905 Vali Acc: 0.688 Test Loss: 0.905 Test Acc: 0.688
Validation loss decreased (-0.623177 --> -0.688397).  Saving model ...
Epoch: 6 cost time: 0.9999814033508301
Epoch: 6, Steps: 9 | Train Loss: 0.716 Vali Loss: 0.802 Vali Acc: 0.696 Test Loss: 0.802 Test Acc: 0.696
Validation loss decreased (-0.688397 --> -0.695644).  Saving model ...
Epoch: 7 cost time: 0.8515679836273193
Epoch: 7, Steps: 9 | Train Loss: 0.575 Vali Loss: 0.714 Vali Acc: 0.681 Test Loss: 0.714 Test Acc: 0.681
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8419256210327148
Epoch: 8, Steps: 9 | Train Loss: 0.461 Vali Loss: 0.689 Vali Acc: 0.681 Test Loss: 0.689 Test Acc: 0.681
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8647701740264893
Epoch: 9, Steps: 9 | Train Loss: 0.339 Vali Loss: 0.614 Vali Acc: 0.790 Test Loss: 0.614 Test Acc: 0.790
Validation loss decreased (-0.695644 --> -0.789849).  Saving model ...
Epoch: 10 cost time: 0.9564962387084961
Epoch: 10, Steps: 9 | Train Loss: 0.236 Vali Loss: 0.621 Vali Acc: 0.739 Test Loss: 0.621 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9251532554626465
Epoch: 11, Steps: 9 | Train Loss: 0.178 Vali Loss: 0.648 Vali Acc: 0.746 Test Loss: 0.648 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.076772928237915
Epoch: 12, Steps: 9 | Train Loss: 0.113 Vali Loss: 0.852 Vali Acc: 0.761 Test Loss: 0.852 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.8757050037384033
Epoch: 13, Steps: 9 | Train Loss: 0.088 Vali Loss: 0.724 Vali Acc: 0.739 Test Loss: 0.724 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.9720678329467773
Epoch: 14, Steps: 9 | Train Loss: 0.052 Vali Loss: 0.875 Vali Acc: 0.783 Test Loss: 0.875 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.8652608394622803
Epoch: 15, Steps: 9 | Train Loss: 0.025 Vali Loss: 0.714 Vali Acc: 0.797 Test Loss: 0.714 Test Acc: 0.797
Validation loss decreased (-0.789849 --> -0.797094).  Saving model ...
Epoch: 16 cost time: 0.9029433727264404
Epoch: 16, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.991 Vali Acc: 0.783 Test Loss: 0.991 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.104402780532837
Epoch: 17, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.919 Vali Acc: 0.790 Test Loss: 0.919 Test Acc: 0.790
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9295320510864258
Epoch: 18, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.919 Vali Acc: 0.804 Test Loss: 0.919 Test Acc: 0.804
Validation loss decreased (-0.797094 --> -0.804339).  Saving model ...
Epoch: 19 cost time: 0.9059014320373535
Epoch: 19, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.948 Vali Acc: 0.797 Test Loss: 0.948 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9064860343933105
Epoch: 20, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.893 Vali Acc: 0.804 Test Loss: 0.893 Test Acc: 0.804
Validation loss decreased (-0.804339 --> -0.804339).  Saving model ...
Epoch: 21 cost time: 0.9730494022369385
Epoch: 21, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.865 Vali Acc: 0.797 Test Loss: 0.865 Test Acc: 0.797
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8336753845214844
Epoch: 22, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.882 Vali Acc: 0.804 Test Loss: 0.882 Test Acc: 0.804
Validation loss decreased (-0.804339 --> -0.804339).  Saving model ...
Epoch: 23 cost time: 0.9653713703155518
Epoch: 23, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.926 Vali Acc: 0.812 Test Loss: 0.926 Test Acc: 0.812
Validation loss decreased (-0.804339 --> -0.811585).  Saving model ...
Epoch: 24 cost time: 0.8976593017578125
Epoch: 24, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.902 Vali Acc: 0.812 Test Loss: 0.902 Test Acc: 0.812
Validation loss decreased (-0.811585 --> -0.811585).  Saving model ...
Epoch: 25 cost time: 0.9539391994476318
Epoch: 25, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.876 Vali Acc: 0.812 Test Loss: 0.876 Test Acc: 0.812
Validation loss decreased (-0.811585 --> -0.811585).  Saving model ...
Epoch: 26 cost time: 0.7821433544158936
Epoch: 26, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.919 Vali Acc: 0.804 Test Loss: 0.919 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.7970383167266846
Epoch: 27, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.926 Vali Acc: 0.790 Test Loss: 0.926 Test Acc: 0.790
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.9561796188354492
Epoch: 28, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.927 Vali Acc: 0.797 Test Loss: 0.927 Test Acc: 0.797
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.7423183917999268
Epoch: 29, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.921 Vali Acc: 0.804 Test Loss: 0.921 Test Acc: 0.804
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.8459956645965576
Epoch: 30, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.906 Vali Acc: 0.804 Test Loss: 0.906 Test Acc: 0.804
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.047952651977539
Epoch: 31, Steps: 9 | Train Loss: 0.002 Vali Loss: 0.909 Vali Acc: 0.804 Test Loss: 0.909 Test Acc: 0.804
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.9581263065338135
Epoch: 32, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.940 Vali Acc: 0.812 Test Loss: 0.940 Test Acc: 0.812
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.8316154479980469
Epoch: 33, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.979 Vali Acc: 0.804 Test Loss: 0.979 Test Acc: 0.804
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.7617971897125244
Epoch: 34, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.994 Vali Acc: 0.804 Test Loss: 0.994 Test Acc: 0.804
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.9963738918304443
Epoch: 35, Steps: 9 | Train Loss: 0.001 Vali Loss: 0.983 Vali Acc: 0.812 Test Loss: 0.983 Test Acc: 0.812
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el3_dm768_df768_ps42_str11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8115942028985508
model parameter : 22473988
model size : 100.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el3_dm768_df768_ps42_str21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 3.039525032043457
Epoch: 1, Steps: 9 | Train Loss: 1.392 Vali Loss: 1.338 Vali Acc: 0.304 Test Loss: 1.338 Test Acc: 0.304
Validation loss decreased (inf --> -0.304334).  Saving model ...
Epoch: 2 cost time: 0.725104570388794
Epoch: 2, Steps: 9 | Train Loss: 1.305 Vali Loss: 1.262 Vali Acc: 0.449 Test Loss: 1.262 Test Acc: 0.449
Validation loss decreased (-0.304334 --> -0.449263).  Saving model ...
Epoch: 3 cost time: 0.8645460605621338
Epoch: 3, Steps: 9 | Train Loss: 1.211 Vali Loss: 1.175 Vali Acc: 0.514 Test Loss: 1.175 Test Acc: 0.514
Validation loss decreased (-0.449263 --> -0.514481).  Saving model ...
Epoch: 4 cost time: 0.7074551582336426
Epoch: 4, Steps: 9 | Train Loss: 1.065 Vali Loss: 1.062 Vali Acc: 0.645 Test Loss: 1.062 Test Acc: 0.645
Validation loss decreased (-0.514481 --> -0.644917).  Saving model ...
Epoch: 5 cost time: 0.8631441593170166
Epoch: 5, Steps: 9 | Train Loss: 0.922 Vali Loss: 0.944 Vali Acc: 0.688 Test Loss: 0.944 Test Acc: 0.688
Validation loss decreased (-0.644917 --> -0.688396).  Saving model ...
Epoch: 6 cost time: 0.7582216262817383
Epoch: 6, Steps: 9 | Train Loss: 0.833 Vali Loss: 0.847 Vali Acc: 0.659 Test Loss: 0.847 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7874505519866943
Epoch: 7, Steps: 9 | Train Loss: 0.679 Vali Loss: 0.737 Vali Acc: 0.725 Test Loss: 0.737 Test Acc: 0.725
Validation loss decreased (-0.688396 --> -0.724630).  Saving model ...
Epoch: 8 cost time: 0.6767194271087646
Epoch: 8, Steps: 9 | Train Loss: 0.522 Vali Loss: 0.709 Vali Acc: 0.717 Test Loss: 0.709 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8410201072692871
Epoch: 9, Steps: 9 | Train Loss: 0.391 Vali Loss: 0.636 Vali Acc: 0.754 Test Loss: 0.636 Test Acc: 0.754
Validation loss decreased (-0.724630 --> -0.753617).  Saving model ...
Epoch: 10 cost time: 0.9273302555084229
Epoch: 10, Steps: 9 | Train Loss: 0.345 Vali Loss: 0.619 Vali Acc: 0.790 Test Loss: 0.619 Test Acc: 0.790
Validation loss decreased (-0.753617 --> -0.789849).  Saving model ...
Epoch: 11 cost time: 0.7927823066711426
Epoch: 11, Steps: 9 | Train Loss: 0.253 Vali Loss: 0.569 Vali Acc: 0.797 Test Loss: 0.569 Test Acc: 0.797
Validation loss decreased (-0.789849 --> -0.797096).  Saving model ...
Epoch: 12 cost time: 0.919572114944458
Epoch: 12, Steps: 9 | Train Loss: 0.185 Vali Loss: 0.628 Vali Acc: 0.783 Test Loss: 0.628 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8114712238311768
Epoch: 13, Steps: 9 | Train Loss: 0.114 Vali Loss: 0.600 Vali Acc: 0.783 Test Loss: 0.600 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.6957347393035889
Epoch: 14, Steps: 9 | Train Loss: 0.089 Vali Loss: 0.641 Vali Acc: 0.783 Test Loss: 0.641 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.7334816455841064
Epoch: 15, Steps: 9 | Train Loss: 0.059 Vali Loss: 0.651 Vali Acc: 0.804 Test Loss: 0.651 Test Acc: 0.804
Validation loss decreased (-0.797096 --> -0.804341).  Saving model ...
Epoch: 16 cost time: 0.8624446392059326
Epoch: 16, Steps: 9 | Train Loss: 0.043 Vali Loss: 0.633 Vali Acc: 0.790 Test Loss: 0.633 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8155226707458496
Epoch: 17, Steps: 9 | Train Loss: 0.030 Vali Loss: 0.700 Vali Acc: 0.804 Test Loss: 0.700 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7716512680053711
Epoch: 18, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.720 Vali Acc: 0.804 Test Loss: 0.720 Test Acc: 0.804
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.7929365634918213
Epoch: 19, Steps: 9 | Train Loss: 0.017 Vali Loss: 0.721 Vali Acc: 0.804 Test Loss: 0.721 Test Acc: 0.804
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.8483328819274902
Epoch: 20, Steps: 9 | Train Loss: 0.013 Vali Loss: 0.777 Vali Acc: 0.797 Test Loss: 0.777 Test Acc: 0.797
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.7869434356689453
Epoch: 21, Steps: 9 | Train Loss: 0.011 Vali Loss: 0.759 Vali Acc: 0.804 Test Loss: 0.759 Test Acc: 0.804
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.786759614944458
Epoch: 22, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.764 Vali Acc: 0.812 Test Loss: 0.764 Test Acc: 0.812
Validation loss decreased (-0.804341 --> -0.811587).  Saving model ...
Epoch: 23 cost time: 0.8308620452880859
Epoch: 23, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.705 Vali Acc: 0.819 Test Loss: 0.705 Test Acc: 0.819
Validation loss decreased (-0.811587 --> -0.818834).  Saving model ...
Epoch: 24 cost time: 0.7300853729248047
Epoch: 24, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.737 Vali Acc: 0.812 Test Loss: 0.737 Test Acc: 0.812
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.77762770652771
Epoch: 25, Steps: 9 | Train Loss: 0.009 Vali Loss: 0.807 Vali Acc: 0.804 Test Loss: 0.807 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.7616086006164551
Epoch: 26, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.795 Vali Acc: 0.797 Test Loss: 0.795 Test Acc: 0.797
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.8391017913818359
Epoch: 27, Steps: 9 | Train Loss: 0.005 Vali Loss: 0.791 Vali Acc: 0.812 Test Loss: 0.791 Test Acc: 0.812
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.8485360145568848
Epoch: 28, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.805 Vali Acc: 0.812 Test Loss: 0.805 Test Acc: 0.812
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.8220374584197998
Epoch: 29, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.804 Vali Acc: 0.812 Test Loss: 0.804 Test Acc: 0.812
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.6530389785766602
Epoch: 30, Steps: 9 | Train Loss: 0.004 Vali Loss: 0.840 Vali Acc: 0.812 Test Loss: 0.840 Test Acc: 0.812
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.6729757785797119
Epoch: 31, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.834 Vali Acc: 0.812 Test Loss: 0.834 Test Acc: 0.812
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.767380952835083
Epoch: 32, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.827 Vali Acc: 0.812 Test Loss: 0.827 Test Acc: 0.812
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.9171340465545654
Epoch: 33, Steps: 9 | Train Loss: 0.003 Vali Loss: 0.821 Vali Acc: 0.812 Test Loss: 0.821 Test Acc: 0.812
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el3_dm768_df768_ps42_str21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.8188405797101449
model parameter : 22441732
model size : 100.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Epilepsy        Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Epilepsy
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

137
138
>>>>>>>start training : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el3_dm768_df768_ps42_str42_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
137
138
138
Epoch: 1 cost time: 2.656677722930908
Epoch: 1, Steps: 9 | Train Loss: 1.484 Vali Loss: 1.440 Vali Acc: 0.159 Test Loss: 1.440 Test Acc: 0.159
Validation loss decreased (inf --> -0.159406).  Saving model ...
Epoch: 2 cost time: 0.7016823291778564
Epoch: 2, Steps: 9 | Train Loss: 1.428 Vali Loss: 1.348 Vali Acc: 0.283 Test Loss: 1.348 Test Acc: 0.283
Validation loss decreased (-0.159406 --> -0.282595).  Saving model ...
Epoch: 3 cost time: 0.7356135845184326
Epoch: 3, Steps: 9 | Train Loss: 1.328 Vali Loss: 1.240 Vali Acc: 0.377 Test Loss: 1.240 Test Acc: 0.377
Validation loss decreased (-0.282595 --> -0.376799).  Saving model ...
Epoch: 4 cost time: 0.7476067543029785
Epoch: 4, Steps: 9 | Train Loss: 1.193 Vali Loss: 1.157 Vali Acc: 0.420 Test Loss: 1.157 Test Acc: 0.420
Validation loss decreased (-0.376799 --> -0.420278).  Saving model ...
Epoch: 5 cost time: 0.6590573787689209
Epoch: 5, Steps: 9 | Train Loss: 1.080 Vali Loss: 1.081 Vali Acc: 0.507 Test Loss: 1.081 Test Acc: 0.507
Validation loss decreased (-0.420278 --> -0.507236).  Saving model ...
Epoch: 6 cost time: 0.6281223297119141
Epoch: 6, Steps: 9 | Train Loss: 0.973 Vali Loss: 1.009 Vali Acc: 0.522 Test Loss: 1.009 Test Acc: 0.522
Validation loss decreased (-0.507236 --> -0.521729).  Saving model ...
Epoch: 7 cost time: 0.854118824005127
Epoch: 7, Steps: 9 | Train Loss: 0.885 Vali Loss: 0.957 Vali Acc: 0.522 Test Loss: 0.957 Test Acc: 0.522
Validation loss decreased (-0.521729 --> -0.521730).  Saving model ...
Epoch: 8 cost time: 0.8486800193786621
Epoch: 8, Steps: 9 | Train Loss: 0.779 Vali Loss: 0.912 Vali Acc: 0.601 Test Loss: 0.912 Test Acc: 0.601
Validation loss decreased (-0.521730 --> -0.601440).  Saving model ...
Epoch: 9 cost time: 0.6626811027526855
Epoch: 9, Steps: 9 | Train Loss: 0.656 Vali Loss: 0.896 Vali Acc: 0.623 Test Loss: 0.896 Test Acc: 0.623
Validation loss decreased (-0.601440 --> -0.623179).  Saving model ...
Epoch: 10 cost time: 0.775850772857666
Epoch: 10, Steps: 9 | Train Loss: 0.557 Vali Loss: 0.807 Vali Acc: 0.688 Test Loss: 0.807 Test Acc: 0.688
Validation loss decreased (-0.623179 --> -0.688398).  Saving model ...
Epoch: 11 cost time: 0.7246925830841064
Epoch: 11, Steps: 9 | Train Loss: 0.449 Vali Loss: 0.797 Vali Acc: 0.688 Test Loss: 0.797 Test Acc: 0.688
Validation loss decreased (-0.688398 --> -0.688398).  Saving model ...
Epoch: 12 cost time: 0.6744356155395508
Epoch: 12, Steps: 9 | Train Loss: 0.372 Vali Loss: 0.735 Vali Acc: 0.703 Test Loss: 0.735 Test Acc: 0.703
Validation loss decreased (-0.688398 --> -0.702891).  Saving model ...
Epoch: 13 cost time: 0.756746768951416
Epoch: 13, Steps: 9 | Train Loss: 0.268 Vali Loss: 0.690 Vali Acc: 0.754 Test Loss: 0.690 Test Acc: 0.754
Validation loss decreased (-0.702891 --> -0.753616).  Saving model ...
Epoch: 14 cost time: 0.7022347450256348
Epoch: 14, Steps: 9 | Train Loss: 0.230 Vali Loss: 0.684 Vali Acc: 0.746 Test Loss: 0.684 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6695866584777832
Epoch: 15, Steps: 9 | Train Loss: 0.146 Vali Loss: 0.728 Vali Acc: 0.739 Test Loss: 0.728 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.728428840637207
Epoch: 16, Steps: 9 | Train Loss: 0.101 Vali Loss: 0.735 Vali Acc: 0.761 Test Loss: 0.735 Test Acc: 0.761
Validation loss decreased (-0.753616 --> -0.760862).  Saving model ...
Epoch: 17 cost time: 0.7473480701446533
Epoch: 17, Steps: 9 | Train Loss: 0.074 Vali Loss: 0.724 Vali Acc: 0.790 Test Loss: 0.724 Test Acc: 0.790
Validation loss decreased (-0.760862 --> -0.789848).  Saving model ...
Epoch: 18 cost time: 0.772773027420044
Epoch: 18, Steps: 9 | Train Loss: 0.058 Vali Loss: 0.716 Vali Acc: 0.761 Test Loss: 0.716 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7319724559783936
Epoch: 19, Steps: 9 | Train Loss: 0.041 Vali Loss: 0.742 Vali Acc: 0.783 Test Loss: 0.742 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.7595491409301758
Epoch: 20, Steps: 9 | Train Loss: 0.037 Vali Loss: 0.755 Vali Acc: 0.768 Test Loss: 0.755 Test Acc: 0.768
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.6330218315124512
Epoch: 21, Steps: 9 | Train Loss: 0.029 Vali Loss: 0.796 Vali Acc: 0.754 Test Loss: 0.796 Test Acc: 0.754
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.6903183460235596
Epoch: 22, Steps: 9 | Train Loss: 0.023 Vali Loss: 0.787 Vali Acc: 0.775 Test Loss: 0.787 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.8162684440612793
Epoch: 23, Steps: 9 | Train Loss: 0.020 Vali Loss: 0.797 Vali Acc: 0.797 Test Loss: 0.797 Test Acc: 0.797
Validation loss decreased (-0.789848 --> -0.797093).  Saving model ...
Epoch: 24 cost time: 0.8892030715942383
Epoch: 24, Steps: 9 | Train Loss: 0.016 Vali Loss: 0.798 Vali Acc: 0.790 Test Loss: 0.798 Test Acc: 0.790
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8362574577331543
Epoch: 25, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.822 Vali Acc: 0.790 Test Loss: 0.822 Test Acc: 0.790
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.5311064720153809
Epoch: 26, Steps: 9 | Train Loss: 0.012 Vali Loss: 0.816 Vali Acc: 0.790 Test Loss: 0.816 Test Acc: 0.790
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.6377429962158203
Epoch: 27, Steps: 9 | Train Loss: 0.010 Vali Loss: 0.818 Vali Acc: 0.790 Test Loss: 0.818 Test Acc: 0.790
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.7846803665161133
Epoch: 28, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.830 Vali Acc: 0.783 Test Loss: 0.830 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.6735813617706299
Epoch: 29, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.844 Vali Acc: 0.783 Test Loss: 0.844 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.7335827350616455
Epoch: 30, Steps: 9 | Train Loss: 0.008 Vali Loss: 0.860 Vali Acc: 0.783 Test Loss: 0.860 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.8210792541503906
Epoch: 31, Steps: 9 | Train Loss: 0.007 Vali Loss: 0.855 Vali Acc: 0.783 Test Loss: 0.855 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.6992628574371338
Epoch: 32, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.879 Vali Acc: 0.783 Test Loss: 0.879 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.8125729560852051
Epoch: 33, Steps: 9 | Train Loss: 0.006 Vali Loss: 0.907 Vali Acc: 0.790 Test Loss: 0.907 Test Acc: 0.790
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Epilepsy_GPT4TS_UEA_ftM_sl206_ll0_pl0_el3_dm768_df768_ps42_str42_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
138
test shape: torch.Size([138, 4]) torch.Size([138, 1])
accuracy:0.7971014492753623
model parameter : 22423300
model size : 100.20MB
