Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el6_dm768_df768_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1830840
	speed: 0.0788s/iter; left time: 598.8744s
Epoch: 1 cost time: 11.259690046310425
Epoch: 1, Steps: 154 | Train Loss: 2.141 Vali Loss: 2.271 Vali Acc: 0.320 Test Loss: 2.271 Test Acc: 0.320
Validation loss decreased (inf --> -0.319523).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.6918620
	speed: 0.2339s/iter; left time: 1742.1905s
Epoch: 2 cost time: 15.26496696472168
Epoch: 2, Steps: 154 | Train Loss: 2.089 Vali Loss: 2.471 Vali Acc: 0.325 Test Loss: 2.471 Test Acc: 0.325
Validation loss decreased (-0.319523 --> -0.324793).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.1371014
	speed: 0.3385s/iter; left time: 2468.5509s
Epoch: 3 cost time: 13.265178680419922
Epoch: 3, Steps: 154 | Train Loss: 2.033 Vali Loss: 2.357 Vali Acc: 0.330 Test Loss: 2.357 Test Acc: 0.330
Validation loss decreased (-0.324793 --> -0.329660).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.6807277
	speed: 0.3193s/iter; left time: 2279.4319s
Epoch: 4 cost time: 7.709899187088013
Epoch: 4, Steps: 154 | Train Loss: 1.920 Vali Loss: 2.745 Vali Acc: 0.331 Test Loss: 2.745 Test Acc: 0.331
Validation loss decreased (-0.329660 --> -0.331278).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.5939931
	speed: 0.4422s/iter; left time: 3088.5682s
Epoch: 5 cost time: 22.81415343284607
Epoch: 5, Steps: 154 | Train Loss: 1.919 Vali Loss: 2.365 Vali Acc: 0.335 Test Loss: 2.365 Test Acc: 0.335
Validation loss decreased (-0.331278 --> -0.334526).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.1695485
	speed: 0.3939s/iter; left time: 2690.5753s
Epoch: 6 cost time: 18.403900623321533
Epoch: 6, Steps: 154 | Train Loss: 1.801 Vali Loss: 2.996 Vali Acc: 0.338 Test Loss: 2.996 Test Acc: 0.338
Validation loss decreased (-0.334526 --> -0.337764).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.2379730
	speed: 0.4127s/iter; left time: 2755.7934s
Epoch: 7 cost time: 18.25853180885315
Epoch: 7, Steps: 154 | Train Loss: 1.748 Vali Loss: 2.918 Vali Acc: 0.347 Test Loss: 2.918 Test Acc: 0.347
Validation loss decreased (-0.337764 --> -0.347092).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.7906387
	speed: 0.3245s/iter; left time: 2116.4590s
Epoch: 8 cost time: 11.641412258148193
Epoch: 8, Steps: 154 | Train Loss: 1.714 Vali Loss: 3.266 Vali Acc: 0.347 Test Loss: 3.266 Test Acc: 0.347
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.7510961
	speed: 0.2840s/iter; left time: 1809.0187s
Epoch: 9 cost time: 15.63092565536499
Epoch: 9, Steps: 154 | Train Loss: 1.655 Vali Loss: 3.336 Vali Acc: 0.103 Test Loss: 3.336 Test Acc: 0.103
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.8477297
	speed: 0.2890s/iter; left time: 1795.9601s
Epoch: 10 cost time: 11.025229930877686
Epoch: 10, Steps: 154 | Train Loss: 1.578 Vali Loss: 3.592 Vali Acc: 0.196 Test Loss: 3.592 Test Acc: 0.196
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.0337501
	speed: 0.2318s/iter; left time: 1404.6726s
Epoch: 11 cost time: 13.924243688583374
Epoch: 11, Steps: 154 | Train Loss: 1.527 Vali Loss: 3.541 Vali Acc: 0.194 Test Loss: 3.541 Test Acc: 0.194
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 1.8533702
	speed: 0.3377s/iter; left time: 1994.7546s
Epoch: 12 cost time: 19.792052507400513
Epoch: 12, Steps: 154 | Train Loss: 1.481 Vali Loss: 3.802 Vali Acc: 0.194 Test Loss: 3.802 Test Acc: 0.194
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 1.0505538
	speed: 0.3823s/iter; left time: 2199.6414s
Epoch: 13 cost time: 18.865296840667725
Epoch: 13, Steps: 154 | Train Loss: 1.483 Vali Loss: 3.848 Vali Acc: 0.363 Test Loss: 3.848 Test Acc: 0.363
Validation loss decreased (-0.347092 --> -0.363303).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.3197892
	speed: 0.2957s/iter; left time: 1655.7735s
Epoch: 14 cost time: 13.899784326553345
Epoch: 14, Steps: 154 | Train Loss: 1.437 Vali Loss: 3.690 Vali Acc: 0.369 Test Loss: 3.690 Test Acc: 0.369
Validation loss decreased (-0.363303 --> -0.369387).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.7107735
	speed: 0.3830s/iter; left time: 2085.6624s
Epoch: 15 cost time: 14.942188262939453
Epoch: 15, Steps: 154 | Train Loss: 1.377 Vali Loss: 4.622 Vali Acc: 0.180 Test Loss: 4.622 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 1.1674892
	speed: 0.2907s/iter; left time: 1537.9866s
Epoch: 16 cost time: 18.35418200492859
Epoch: 16, Steps: 154 | Train Loss: 1.359 Vali Loss: 4.496 Vali Acc: 0.172 Test Loss: 4.496 Test Acc: 0.172
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 1.5629517
	speed: 0.3411s/iter; left time: 1752.1892s
Epoch: 17 cost time: 15.62864351272583
Epoch: 17, Steps: 154 | Train Loss: 1.337 Vali Loss: 5.337 Vali Acc: 0.204 Test Loss: 5.337 Test Acc: 0.204
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 1.2166915
	speed: 0.2573s/iter; left time: 1282.0578s
Epoch: 18 cost time: 14.879241228103638
Epoch: 18, Steps: 154 | Train Loss: 1.257 Vali Loss: 5.861 Vali Acc: 0.130 Test Loss: 5.861 Test Acc: 0.130
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 1.6132531
	speed: 0.3069s/iter; left time: 1481.7967s
Epoch: 19 cost time: 11.787713289260864
Epoch: 19, Steps: 154 | Train Loss: 1.270 Vali Loss: 6.751 Vali Acc: 0.080 Test Loss: 6.751 Test Acc: 0.080
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 1.0078478
	speed: 0.2979s/iter; left time: 1392.8321s
Epoch: 20 cost time: 19.03478193283081
Epoch: 20, Steps: 154 | Train Loss: 1.197 Vali Loss: 6.717 Vali Acc: 0.139 Test Loss: 6.717 Test Acc: 0.139
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 1.3277617
	speed: 0.4128s/iter; left time: 1866.4415s
Epoch: 21 cost time: 23.552573442459106
Epoch: 21, Steps: 154 | Train Loss: 1.178 Vali Loss: 5.123 Vali Acc: 0.191 Test Loss: 5.123 Test Acc: 0.191
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.7108864
	speed: 0.4136s/iter; left time: 1806.2374s
Epoch: 22 cost time: 19.01440167427063
Epoch: 22, Steps: 154 | Train Loss: 1.186 Vali Loss: 8.028 Vali Acc: 0.079 Test Loss: 8.028 Test Acc: 0.079
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 1.5201340
	speed: 0.2883s/iter; left time: 1214.6004s
Epoch: 23 cost time: 17.13163709640503
Epoch: 23, Steps: 154 | Train Loss: 1.159 Vali Loss: 9.531 Vali Acc: 0.082 Test Loss: 9.531 Test Acc: 0.082
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.7083932
	speed: 0.3218s/iter; left time: 1306.0756s
Epoch: 24 cost time: 16.48277997970581
Epoch: 24, Steps: 154 | Train Loss: 1.148 Vali Loss: 6.661 Vali Acc: 0.119 Test Loss: 6.661 Test Acc: 0.119
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el6_dm768_df768_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.36942416869424166
model parameter : 43843598
model size : 181.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el6_dm768_df768_ps2_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1292651
	speed: 0.1104s/iter; left time: 839.2868s
Epoch: 1 cost time: 16.16922664642334
Epoch: 1, Steps: 154 | Train Loss: 2.141 Vali Loss: 2.197 Vali Acc: 0.135 Test Loss: 2.197 Test Acc: 0.135
Validation loss decreased (inf --> -0.135420).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.7590160
	speed: 0.2666s/iter; left time: 1985.5522s
Epoch: 2 cost time: 14.896804571151733
Epoch: 2, Steps: 154 | Train Loss: 2.047 Vali Loss: 2.332 Vali Acc: 0.324 Test Loss: 2.332 Test Acc: 0.324
Validation loss decreased (-0.135420 --> -0.323983).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.6626681
	speed: 0.2440s/iter; left time: 1779.2597s
Epoch: 3 cost time: 7.631045818328857
Epoch: 3, Steps: 154 | Train Loss: 1.975 Vali Loss: 2.231 Vali Acc: 0.331 Test Loss: 2.231 Test Acc: 0.331
Validation loss decreased (-0.323983 --> -0.330878).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.1618016
	speed: 0.2686s/iter; left time: 1917.2771s
Epoch: 4 cost time: 7.505962610244751
Epoch: 4, Steps: 154 | Train Loss: 1.896 Vali Loss: 2.380 Vali Acc: 0.336 Test Loss: 2.380 Test Acc: 0.336
Validation loss decreased (-0.330878 --> -0.335743).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.8874692
	speed: 0.2078s/iter; left time: 1451.6138s
Epoch: 5 cost time: 8.263126373291016
Epoch: 5, Steps: 154 | Train Loss: 1.824 Vali Loss: 2.482 Vali Acc: 0.324 Test Loss: 2.482 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.5468566
	speed: 0.1631s/iter; left time: 1114.3920s
Epoch: 6 cost time: 10.543084859848022
Epoch: 6, Steps: 154 | Train Loss: 1.784 Vali Loss: 2.960 Vali Acc: 0.092 Test Loss: 2.960 Test Acc: 0.092
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 2.3668509
	speed: 0.1783s/iter; left time: 1190.4768s
Epoch: 7 cost time: 7.768010139465332
Epoch: 7, Steps: 154 | Train Loss: 1.745 Vali Loss: 2.963 Vali Acc: 0.343 Test Loss: 2.963 Test Acc: 0.343
Validation loss decreased (-0.335743 --> -0.342631).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.6376700
	speed: 0.2326s/iter; left time: 1517.3945s
Epoch: 8 cost time: 8.940659761428833
Epoch: 8, Steps: 154 | Train Loss: 1.685 Vali Loss: 3.007 Vali Acc: 0.177 Test Loss: 3.007 Test Acc: 0.177
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.5532641
	speed: 0.1882s/iter; left time: 1198.9412s
Epoch: 9 cost time: 10.700335502624512
Epoch: 9, Steps: 154 | Train Loss: 1.633 Vali Loss: 3.445 Vali Acc: 0.109 Test Loss: 3.445 Test Acc: 0.109
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.8543830
	speed: 0.2317s/iter; left time: 1440.2353s
Epoch: 10 cost time: 12.813697576522827
Epoch: 10, Steps: 154 | Train Loss: 1.603 Vali Loss: 3.275 Vali Acc: 0.181 Test Loss: 3.275 Test Acc: 0.181
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.8147827
	speed: 0.2467s/iter; left time: 1495.3094s
Epoch: 11 cost time: 11.609901905059814
Epoch: 11, Steps: 154 | Train Loss: 1.546 Vali Loss: 3.904 Vali Acc: 0.182 Test Loss: 3.904 Test Acc: 0.182
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 1.4239833
	speed: 0.1660s/iter; left time: 980.2811s
Epoch: 12 cost time: 7.997462511062622
Epoch: 12, Steps: 154 | Train Loss: 1.485 Vali Loss: 3.940 Vali Acc: 0.098 Test Loss: 3.940 Test Acc: 0.098
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 1.2828163
	speed: 0.1901s/iter; left time: 1093.6310s
Epoch: 13 cost time: 5.493019342422485
Epoch: 13, Steps: 154 | Train Loss: 1.487 Vali Loss: 4.004 Vali Acc: 0.051 Test Loss: 4.004 Test Acc: 0.051
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 1.6231847
	speed: 0.1938s/iter; left time: 1084.9204s
Epoch: 14 cost time: 12.67443585395813
Epoch: 14, Steps: 154 | Train Loss: 1.426 Vali Loss: 4.554 Vali Acc: 0.172 Test Loss: 4.554 Test Acc: 0.172
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 1.6983792
	speed: 0.2548s/iter; left time: 1387.1401s
Epoch: 15 cost time: 10.274353265762329
Epoch: 15, Steps: 154 | Train Loss: 1.415 Vali Loss: 4.198 Vali Acc: 0.052 Test Loss: 4.198 Test Acc: 0.052
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.8997185
	speed: 0.1734s/iter; left time: 917.6716s
Epoch: 16 cost time: 8.542983770370483
Epoch: 16, Steps: 154 | Train Loss: 1.365 Vali Loss: 3.472 Vali Acc: 0.188 Test Loss: 3.472 Test Acc: 0.188
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 1.7994558
	speed: 0.2119s/iter; left time: 1088.4134s
Epoch: 17 cost time: 15.427859544754028
Epoch: 17, Steps: 154 | Train Loss: 1.340 Vali Loss: 5.064 Vali Acc: 0.078 Test Loss: 5.064 Test Acc: 0.078
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el6_dm768_df768_ps2_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3426601784266018
model parameter : 43634702
model size : 181.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el6_dm768_df768_ps3_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.5833819
	speed: 0.1223s/iter; left time: 929.7188s
Epoch: 1 cost time: 17.7146954536438
Epoch: 1, Steps: 154 | Train Loss: 2.181 Vali Loss: 2.210 Vali Acc: 0.320 Test Loss: 2.210 Test Acc: 0.320
Validation loss decreased (inf --> -0.320335).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0618136
	speed: 0.2489s/iter; left time: 1853.3146s
Epoch: 2 cost time: 10.833633184432983
Epoch: 2, Steps: 154 | Train Loss: 2.097 Vali Loss: 2.488 Vali Acc: 0.321 Test Loss: 2.488 Test Acc: 0.321
Validation loss decreased (-0.320335 --> -0.320737).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.2486706
	speed: 0.2909s/iter; left time: 2121.8854s
Epoch: 3 cost time: 15.76471757888794
Epoch: 3, Steps: 154 | Train Loss: 2.023 Vali Loss: 2.475 Vali Acc: 0.325 Test Loss: 2.475 Test Acc: 0.325
Validation loss decreased (-0.320737 --> -0.325198).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.9954933
	speed: 0.4011s/iter; left time: 2863.6208s
Epoch: 4 cost time: 8.697083473205566
Epoch: 4, Steps: 154 | Train Loss: 1.944 Vali Loss: 2.464 Vali Acc: 0.334 Test Loss: 2.464 Test Acc: 0.334
Validation loss decreased (-0.325198 --> -0.334120).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.9460915
	speed: 0.2838s/iter; left time: 1982.1498s
Epoch: 5 cost time: 12.50907850265503
Epoch: 5, Steps: 154 | Train Loss: 1.859 Vali Loss: 2.637 Vali Acc: 0.339 Test Loss: 2.637 Test Acc: 0.339
Validation loss decreased (-0.334120 --> -0.338579).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.8561358
	speed: 0.3561s/iter; left time: 2432.6512s
Epoch: 6 cost time: 16.67883586883545
Epoch: 6, Steps: 154 | Train Loss: 1.775 Vali Loss: 2.777 Vali Acc: 0.357 Test Loss: 2.777 Test Acc: 0.357
Validation loss decreased (-0.338579 --> -0.357231).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.5541419
	speed: 0.3312s/iter; left time: 2211.1314s
Epoch: 7 cost time: 12.70802116394043
Epoch: 7, Steps: 154 | Train Loss: 1.682 Vali Loss: 2.749 Vali Acc: 0.351 Test Loss: 2.749 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.2404807
	speed: 0.1873s/iter; left time: 1221.9499s
Epoch: 8 cost time: 10.992007732391357
Epoch: 8, Steps: 154 | Train Loss: 1.624 Vali Loss: 3.077 Vali Acc: 0.191 Test Loss: 3.077 Test Acc: 0.191
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.3218789
	speed: 0.2324s/iter; left time: 1479.9218s
Epoch: 9 cost time: 12.742165327072144
Epoch: 9, Steps: 154 | Train Loss: 1.552 Vali Loss: 3.621 Vali Acc: 0.181 Test Loss: 3.621 Test Acc: 0.181
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.2947088
	speed: 0.1998s/iter; left time: 1241.6138s
Epoch: 10 cost time: 13.748518228530884
Epoch: 10, Steps: 154 | Train Loss: 1.493 Vali Loss: 3.113 Vali Acc: 0.371 Test Loss: 3.113 Test Acc: 0.371
Validation loss decreased (-0.357231 --> -0.371015).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.4149628
	speed: 0.3508s/iter; left time: 2126.3493s
Epoch: 11 cost time: 11.87746286392212
Epoch: 11, Steps: 154 | Train Loss: 1.430 Vali Loss: 4.203 Vali Acc: 0.197 Test Loss: 4.203 Test Acc: 0.197
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.3504530
	speed: 0.2397s/iter; left time: 1416.0682s
Epoch: 12 cost time: 11.382755279541016
Epoch: 12, Steps: 154 | Train Loss: 1.424 Vali Loss: 3.755 Vali Acc: 0.206 Test Loss: 3.755 Test Acc: 0.206
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.7888559
	speed: 0.2460s/iter; left time: 1414.9704s
Epoch: 13 cost time: 13.438806533813477
Epoch: 13, Steps: 154 | Train Loss: 1.402 Vali Loss: 4.235 Vali Acc: 0.199 Test Loss: 4.235 Test Acc: 0.199
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 1.7645830
	speed: 0.2707s/iter; left time: 1515.8574s
Epoch: 14 cost time: 14.639103889465332
Epoch: 14, Steps: 154 | Train Loss: 1.421 Vali Loss: 4.473 Vali Acc: 0.111 Test Loss: 4.473 Test Acc: 0.111
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.6954379
	speed: 0.3044s/iter; left time: 1657.3558s
Epoch: 15 cost time: 18.28223180770874
Epoch: 15, Steps: 154 | Train Loss: 1.328 Vali Loss: 4.710 Vali Acc: 0.093 Test Loss: 4.710 Test Acc: 0.093
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 1.1706990
	speed: 0.3608s/iter; left time: 1909.1593s
Epoch: 16 cost time: 19.573310136795044
Epoch: 16, Steps: 154 | Train Loss: 1.320 Vali Loss: 4.744 Vali Acc: 0.083 Test Loss: 4.744 Test Acc: 0.083
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 1.7563366
	speed: 0.2433s/iter; left time: 1249.7998s
Epoch: 17 cost time: 10.852662086486816
Epoch: 17, Steps: 154 | Train Loss: 1.266 Vali Loss: 5.232 Vali Acc: 0.077 Test Loss: 5.232 Test Acc: 0.077
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 1.4038876
	speed: 0.2698s/iter; left time: 1344.3516s
Epoch: 18 cost time: 11.71737003326416
Epoch: 18, Steps: 154 | Train Loss: 1.239 Vali Loss: 6.265 Vali Acc: 0.077 Test Loss: 6.265 Test Acc: 0.077
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.5950297
	speed: 0.2314s/iter; left time: 1117.5244s
Epoch: 19 cost time: 14.022282123565674
Epoch: 19, Steps: 154 | Train Loss: 1.190 Vali Loss: 7.132 Vali Acc: 0.077 Test Loss: 7.132 Test Acc: 0.077
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 1.3924820
	speed: 0.3558s/iter; left time: 1663.5807s
Epoch: 20 cost time: 19.817654848098755
Epoch: 20, Steps: 154 | Train Loss: 1.161 Vali Loss: 5.572 Vali Acc: 0.093 Test Loss: 5.572 Test Acc: 0.093
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el6_dm768_df768_ps3_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3710462287104623
model parameter : 43845134
model size : 181.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el6_dm768_df768_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.7742357
	speed: 0.1166s/iter; left time: 886.3347s
Epoch: 1 cost time: 15.79263687133789
Epoch: 1, Steps: 154 | Train Loss: 2.116 Vali Loss: 2.457 Vali Acc: 0.317 Test Loss: 2.457 Test Acc: 0.317
Validation loss decreased (inf --> -0.316683).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.3357866
	speed: 0.2665s/iter; left time: 1984.5055s
Epoch: 2 cost time: 14.803222894668579
Epoch: 2, Steps: 154 | Train Loss: 2.057 Vali Loss: 2.274 Vali Acc: 0.326 Test Loss: 2.274 Test Acc: 0.326
Validation loss decreased (-0.316683 --> -0.326417).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.3815489
	speed: 0.2834s/iter; left time: 2067.1378s
Epoch: 3 cost time: 10.445882081985474
Epoch: 3, Steps: 154 | Train Loss: 2.001 Vali Loss: 2.233 Vali Acc: 0.338 Test Loss: 2.233 Test Acc: 0.338
Validation loss decreased (-0.326417 --> -0.338177).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.0846920
	speed: 0.2393s/iter; left time: 1708.4934s
Epoch: 4 cost time: 9.257368326187134
Epoch: 4, Steps: 154 | Train Loss: 1.904 Vali Loss: 2.496 Vali Acc: 0.335 Test Loss: 2.496 Test Acc: 0.335
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.6056472
	speed: 0.1779s/iter; left time: 1242.5453s
Epoch: 5 cost time: 5.910366773605347
Epoch: 5, Steps: 154 | Train Loss: 1.837 Vali Loss: 2.287 Vali Acc: 0.340 Test Loss: 2.287 Test Acc: 0.340
Validation loss decreased (-0.338177 --> -0.340204).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.2157965
	speed: 0.3164s/iter; left time: 2161.3657s
Epoch: 6 cost time: 13.273130416870117
Epoch: 6, Steps: 154 | Train Loss: 1.765 Vali Loss: 2.707 Vali Acc: 0.352 Test Loss: 2.707 Test Acc: 0.352
Validation loss decreased (-0.340204 --> -0.351960).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.1656499
	speed: 0.2897s/iter; left time: 1934.0960s
Epoch: 7 cost time: 9.715137481689453
Epoch: 7, Steps: 154 | Train Loss: 1.664 Vali Loss: 2.878 Vali Acc: 0.185 Test Loss: 2.878 Test Acc: 0.185
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.2897785
	speed: 0.1809s/iter; left time: 1180.1228s
Epoch: 8 cost time: 8.960261583328247
Epoch: 8, Steps: 154 | Train Loss: 1.581 Vali Loss: 2.751 Vali Acc: 0.182 Test Loss: 2.751 Test Acc: 0.182
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.4981971
	speed: 0.2229s/iter; left time: 1419.8297s
Epoch: 9 cost time: 11.900346517562866
Epoch: 9, Steps: 154 | Train Loss: 1.593 Vali Loss: 2.951 Vali Acc: 0.358 Test Loss: 2.951 Test Acc: 0.358
Validation loss decreased (-0.351960 --> -0.357635).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.4799829
	speed: 0.3072s/iter; left time: 1909.5299s
Epoch: 10 cost time: 11.317323923110962
Epoch: 10, Steps: 154 | Train Loss: 1.505 Vali Loss: 3.297 Vali Acc: 0.188 Test Loss: 3.297 Test Acc: 0.188
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.5426487
	speed: 0.2499s/iter; left time: 1514.8738s
Epoch: 11 cost time: 13.299999713897705
Epoch: 11, Steps: 154 | Train Loss: 1.474 Vali Loss: 3.235 Vali Acc: 0.363 Test Loss: 3.235 Test Acc: 0.363
Validation loss decreased (-0.357635 --> -0.362498).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.4299788
	speed: 0.2773s/iter; left time: 1638.3010s
Epoch: 12 cost time: 7.882524013519287
Epoch: 12, Steps: 154 | Train Loss: 1.447 Vali Loss: 3.526 Vali Acc: 0.190 Test Loss: 3.526 Test Acc: 0.190
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.5945667
	speed: 0.1976s/iter; left time: 1137.0353s
Epoch: 13 cost time: 8.47848629951477
Epoch: 13, Steps: 154 | Train Loss: 1.386 Vali Loss: 3.501 Vali Acc: 0.114 Test Loss: 3.501 Test Acc: 0.114
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.8765885
	speed: 0.1467s/iter; left time: 821.6203s
Epoch: 14 cost time: 11.163509130477905
Epoch: 14, Steps: 154 | Train Loss: 1.338 Vali Loss: 4.475 Vali Acc: 0.190 Test Loss: 4.475 Test Acc: 0.190
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 1.2332902
	speed: 0.2010s/iter; left time: 1094.4645s
Epoch: 15 cost time: 6.746866464614868
Epoch: 15, Steps: 154 | Train Loss: 1.356 Vali Loss: 3.921 Vali Acc: 0.146 Test Loss: 3.921 Test Acc: 0.146
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 1.4741955
	speed: 0.1637s/iter; left time: 866.1521s
Epoch: 16 cost time: 6.187225341796875
Epoch: 16, Steps: 154 | Train Loss: 1.335 Vali Loss: 3.977 Vali Acc: 0.090 Test Loss: 3.977 Test Acc: 0.090
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 1.2185644
	speed: 0.1652s/iter; left time: 848.8221s
Epoch: 17 cost time: 9.994942665100098
Epoch: 17, Steps: 154 | Train Loss: 1.285 Vali Loss: 4.298 Vali Acc: 0.079 Test Loss: 4.298 Test Acc: 0.079
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.8230913
	speed: 0.1218s/iter; left time: 606.9740s
Epoch: 18 cost time: 4.717913627624512
Epoch: 18, Steps: 154 | Train Loss: 1.249 Vali Loss: 3.904 Vali Acc: 0.213 Test Loss: 3.904 Test Acc: 0.213
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 1.2808750
	speed: 0.1498s/iter; left time: 723.5003s
Epoch: 19 cost time: 12.596666812896729
Epoch: 19, Steps: 154 | Train Loss: 1.221 Vali Loss: 4.905 Vali Acc: 0.077 Test Loss: 4.905 Test Acc: 0.077
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.9584997
	speed: 0.2394s/iter; left time: 1119.0770s
Epoch: 20 cost time: 11.782759428024292
Epoch: 20, Steps: 154 | Train Loss: 1.228 Vali Loss: 4.254 Vali Acc: 0.135 Test Loss: 4.254 Test Acc: 0.135
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 1.7301109
	speed: 0.2531s/iter; left time: 1144.1394s
Epoch: 21 cost time: 12.175388097763062
Epoch: 21, Steps: 154 | Train Loss: 1.231 Vali Loss: 4.747 Vali Acc: 0.185 Test Loss: 4.747 Test Acc: 0.185
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el6_dm768_df768_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.36253041362530414
model parameter : 43636238
model size : 181.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el6_dm768_df768_ps3_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.5302386
	speed: 0.0476s/iter; left time: 361.6432s
Epoch: 1 cost time: 6.226712703704834
Epoch: 1, Steps: 154 | Train Loss: 2.125 Vali Loss: 2.199 Vali Acc: 0.323 Test Loss: 2.199 Test Acc: 0.323
Validation loss decreased (inf --> -0.322768).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.7576770
	speed: 0.1506s/iter; left time: 1121.4324s
Epoch: 2 cost time: 7.316891431808472
Epoch: 2, Steps: 154 | Train Loss: 2.034 Vali Loss: 2.285 Vali Acc: 0.165 Test Loss: 2.285 Test Acc: 0.165
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.9735998
	speed: 0.1410s/iter; left time: 1028.6469s
Epoch: 3 cost time: 7.449766159057617
Epoch: 3, Steps: 154 | Train Loss: 1.983 Vali Loss: 2.313 Vali Acc: 0.323 Test Loss: 2.313 Test Acc: 0.323
Validation loss decreased (-0.322768 --> -0.323172).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.7040558
	speed: 0.2560s/iter; left time: 1827.8462s
Epoch: 4 cost time: 8.752638101577759
Epoch: 4, Steps: 154 | Train Loss: 1.915 Vali Loss: 2.410 Vali Acc: 0.329 Test Loss: 2.410 Test Acc: 0.329
Validation loss decreased (-0.323172 --> -0.328849).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.6200945
	speed: 0.2870s/iter; left time: 2004.6493s
Epoch: 5 cost time: 6.790248394012451
Epoch: 5, Steps: 154 | Train Loss: 1.836 Vali Loss: 2.627 Vali Acc: 0.336 Test Loss: 2.627 Test Acc: 0.336
Validation loss decreased (-0.328849 --> -0.335740).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.4453877
	speed: 0.2875s/iter; left time: 1963.9587s
Epoch: 6 cost time: 6.368291854858398
Epoch: 6, Steps: 154 | Train Loss: 1.766 Vali Loss: 2.698 Vali Acc: 0.336 Test Loss: 2.698 Test Acc: 0.336
Validation loss decreased (-0.335740 --> -0.336145).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.5583595
	speed: 0.2430s/iter; left time: 1622.3186s
Epoch: 7 cost time: 9.742961883544922
Epoch: 7, Steps: 154 | Train Loss: 1.705 Vali Loss: 2.630 Vali Acc: 0.360 Test Loss: 2.630 Test Acc: 0.360
Validation loss decreased (-0.336145 --> -0.360071).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.1273320
	speed: 0.3411s/iter; left time: 2224.9579s
Epoch: 8 cost time: 8.843464136123657
Epoch: 8, Steps: 154 | Train Loss: 1.654 Vali Loss: 3.286 Vali Acc: 0.100 Test Loss: 3.286 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.5220226
	speed: 0.1464s/iter; left time: 932.2777s
Epoch: 9 cost time: 5.385409593582153
Epoch: 9, Steps: 154 | Train Loss: 1.607 Vali Loss: 3.028 Vali Acc: 0.180 Test Loss: 3.028 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 2.0952373
	speed: 0.1592s/iter; left time: 989.3044s
Epoch: 10 cost time: 6.917909383773804
Epoch: 10, Steps: 154 | Train Loss: 1.581 Vali Loss: 3.263 Vali Acc: 0.179 Test Loss: 3.263 Test Acc: 0.179
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.6025637
	speed: 0.1858s/iter; left time: 1126.1983s
Epoch: 11 cost time: 7.698667764663696
Epoch: 11, Steps: 154 | Train Loss: 1.540 Vali Loss: 3.142 Vali Acc: 0.202 Test Loss: 3.142 Test Acc: 0.202
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 1.4686517
	speed: 0.1875s/iter; left time: 1107.3390s
Epoch: 12 cost time: 6.506166696548462
Epoch: 12, Steps: 154 | Train Loss: 1.513 Vali Loss: 3.976 Vali Acc: 0.099 Test Loss: 3.976 Test Acc: 0.099
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.9873509
	speed: 0.1667s/iter; left time: 959.1145s
Epoch: 13 cost time: 7.3969151973724365
Epoch: 13, Steps: 154 | Train Loss: 1.495 Vali Loss: 3.957 Vali Acc: 0.098 Test Loss: 3.957 Test Acc: 0.098
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 1.2074797
	speed: 0.1516s/iter; left time: 848.8947s
Epoch: 14 cost time: 5.07501482963562
Epoch: 14, Steps: 154 | Train Loss: 1.438 Vali Loss: 4.641 Vali Acc: 0.072 Test Loss: 4.641 Test Acc: 0.072
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 1.2010746
	speed: 0.1336s/iter; left time: 727.3569s
Epoch: 15 cost time: 5.012587070465088
Epoch: 15, Steps: 154 | Train Loss: 1.418 Vali Loss: 4.224 Vali Acc: 0.059 Test Loss: 4.224 Test Acc: 0.059
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 1.8136714
	speed: 0.1646s/iter; left time: 870.9213s
Epoch: 16 cost time: 7.518172264099121
Epoch: 16, Steps: 154 | Train Loss: 1.402 Vali Loss: 4.747 Vali Acc: 0.082 Test Loss: 4.747 Test Acc: 0.082
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 1.8571644
	speed: 0.1393s/iter; left time: 715.5999s
Epoch: 17 cost time: 7.5182154178619385
Epoch: 17, Steps: 154 | Train Loss: 1.391 Vali Loss: 4.072 Vali Acc: 0.081 Test Loss: 4.072 Test Acc: 0.081
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el6_dm768_df768_ps3_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.36009732360097324
model parameter : 43574798
model size : 180.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el6_dm768_df768_ps4_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.8037467
	speed: 0.0464s/iter; left time: 352.8018s
Epoch: 1 cost time: 6.1709885597229
Epoch: 1, Steps: 154 | Train Loss: 2.211 Vali Loss: 2.189 Vali Acc: 0.328 Test Loss: 2.189 Test Acc: 0.328
Validation loss decreased (inf --> -0.328040).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.6139553
	speed: 0.1700s/iter; left time: 1265.8992s
Epoch: 2 cost time: 13.528606414794922
Epoch: 2, Steps: 154 | Train Loss: 2.097 Vali Loss: 2.284 Vali Acc: 0.175 Test Loss: 2.284 Test Acc: 0.175
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 2.0005715
	speed: 0.1846s/iter; left time: 1346.1036s
Epoch: 3 cost time: 9.983422040939331
Epoch: 3, Steps: 154 | Train Loss: 2.018 Vali Loss: 2.762 Vali Acc: 0.324 Test Loss: 2.762 Test Acc: 0.324
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 1.8938280
	speed: 0.2158s/iter; left time: 1540.8774s
Epoch: 4 cost time: 15.425395727157593
Epoch: 4, Steps: 154 | Train Loss: 1.939 Vali Loss: 2.749 Vali Acc: 0.330 Test Loss: 2.749 Test Acc: 0.330
Validation loss decreased (-0.328040 --> -0.330062).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.1135466
	speed: 0.3295s/iter; left time: 2301.3999s
Epoch: 5 cost time: 14.577889919281006
Epoch: 5, Steps: 154 | Train Loss: 1.839 Vali Loss: 2.800 Vali Acc: 0.335 Test Loss: 2.800 Test Acc: 0.335
Validation loss decreased (-0.330062 --> -0.334927).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.6551843
	speed: 0.2545s/iter; left time: 1738.3379s
Epoch: 6 cost time: 8.449588775634766
Epoch: 6, Steps: 154 | Train Loss: 1.764 Vali Loss: 3.002 Vali Acc: 0.180 Test Loss: 3.002 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.8516896
	speed: 0.2853s/iter; left time: 1905.2174s
Epoch: 7 cost time: 16.150861024856567
Epoch: 7, Steps: 154 | Train Loss: 1.748 Vali Loss: 2.826 Vali Acc: 0.339 Test Loss: 2.826 Test Acc: 0.339
Validation loss decreased (-0.334927 --> -0.338577).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.6413163
	speed: 0.4101s/iter; left time: 2674.9339s
Epoch: 8 cost time: 18.733412742614746
Epoch: 8, Steps: 154 | Train Loss: 1.609 Vali Loss: 3.149 Vali Acc: 0.358 Test Loss: 3.149 Test Acc: 0.358
Validation loss decreased (-0.338577 --> -0.358444).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.5103565
	speed: 0.4011s/iter; left time: 2554.4614s
Epoch: 9 cost time: 14.986932039260864
Epoch: 9, Steps: 154 | Train Loss: 1.544 Vali Loss: 3.205 Vali Acc: 0.112 Test Loss: 3.205 Test Acc: 0.112
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.5747621
	speed: 0.2660s/iter; left time: 1653.3117s
Epoch: 10 cost time: 12.759343147277832
Epoch: 10, Steps: 154 | Train Loss: 1.520 Vali Loss: 3.148 Vali Acc: 0.364 Test Loss: 3.148 Test Acc: 0.364
Validation loss decreased (-0.358444 --> -0.363715).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.2117326
	speed: 0.3867s/iter; left time: 2343.9562s
Epoch: 11 cost time: 16.617432594299316
Epoch: 11, Steps: 154 | Train Loss: 1.471 Vali Loss: 3.647 Vali Acc: 0.199 Test Loss: 3.647 Test Acc: 0.199
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.0393274
	speed: 0.3016s/iter; left time: 1781.6480s
Epoch: 12 cost time: 16.450629949569702
Epoch: 12, Steps: 154 | Train Loss: 1.434 Vali Loss: 4.383 Vali Acc: 0.101 Test Loss: 4.383 Test Acc: 0.101
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.1177418
	speed: 0.2644s/iter; left time: 1521.0270s
Epoch: 13 cost time: 14.333661079406738
Epoch: 13, Steps: 154 | Train Loss: 1.395 Vali Loss: 3.750 Vali Acc: 0.172 Test Loss: 3.750 Test Acc: 0.172
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 1.2719476
	speed: 0.3123s/iter; left time: 1748.3398s
Epoch: 14 cost time: 16.751822471618652
Epoch: 14, Steps: 154 | Train Loss: 1.365 Vali Loss: 3.868 Vali Acc: 0.064 Test Loss: 3.868 Test Acc: 0.064
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 2.0132935
	speed: 0.3340s/iter; left time: 1818.6431s
Epoch: 15 cost time: 16.37863326072693
Epoch: 15, Steps: 154 | Train Loss: 1.323 Vali Loss: 4.441 Vali Acc: 0.100 Test Loss: 4.441 Test Acc: 0.100
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 1.3970656
	speed: 0.2964s/iter; left time: 1568.2354s
Epoch: 16 cost time: 18.19400906562805
Epoch: 16, Steps: 154 | Train Loss: 1.308 Vali Loss: 4.847 Vali Acc: 0.122 Test Loss: 4.847 Test Acc: 0.122
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 1.8632914
	speed: 0.3206s/iter; left time: 1647.0045s
Epoch: 17 cost time: 15.24967336654663
Epoch: 17, Steps: 154 | Train Loss: 1.300 Vali Loss: 4.447 Vali Acc: 0.128 Test Loss: 4.447 Test Acc: 0.128
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.9327741
	speed: 0.3006s/iter; left time: 1497.8107s
Epoch: 18 cost time: 11.183787822723389
Epoch: 18, Steps: 154 | Train Loss: 1.220 Vali Loss: 4.785 Vali Acc: 0.101 Test Loss: 4.785 Test Acc: 0.101
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 1.1722592
	speed: 0.2483s/iter; left time: 1198.8675s
Epoch: 19 cost time: 16.136934995651245
Epoch: 19, Steps: 154 | Train Loss: 1.200 Vali Loss: 4.463 Vali Acc: 0.090 Test Loss: 4.463 Test Acc: 0.090
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.7705135
	speed: 0.2636s/iter; left time: 1232.2179s
Epoch: 20 cost time: 10.170430183410645
Epoch: 20, Steps: 154 | Train Loss: 1.213 Vali Loss: 4.740 Vali Acc: 0.079 Test Loss: 4.740 Test Acc: 0.079
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el6_dm768_df768_ps4_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3637469586374696
model parameter : 43846670
model size : 181.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el6_dm768_df768_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.6306769
	speed: 0.0834s/iter; left time: 634.2856s
Epoch: 1 cost time: 11.88331413269043
Epoch: 1, Steps: 154 | Train Loss: 2.125 Vali Loss: 2.296 Vali Acc: 0.319 Test Loss: 2.296 Test Acc: 0.319
Validation loss decreased (inf --> -0.318712).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8206253
	speed: 0.2384s/iter; left time: 1775.1650s
Epoch: 2 cost time: 11.475181341171265
Epoch: 2, Steps: 154 | Train Loss: 2.041 Vali Loss: 2.117 Vali Acc: 0.324 Test Loss: 2.117 Test Acc: 0.324
Validation loss decreased (-0.318712 --> -0.323580).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.1780312
	speed: 0.3328s/iter; left time: 2426.9917s
Epoch: 3 cost time: 14.617361307144165
Epoch: 3, Steps: 154 | Train Loss: 1.976 Vali Loss: 2.294 Vali Acc: 0.328 Test Loss: 2.294 Test Acc: 0.328
Validation loss decreased (-0.323580 --> -0.327633).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.9188602
	speed: 0.2990s/iter; left time: 2134.6865s
Epoch: 4 cost time: 11.357077836990356
Epoch: 4, Steps: 154 | Train Loss: 1.900 Vali Loss: 2.493 Vali Acc: 0.326 Test Loss: 2.493 Test Acc: 0.326
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 2.1394823
	speed: 0.1876s/iter; left time: 1310.1997s
Epoch: 5 cost time: 9.47113585472107
Epoch: 5, Steps: 154 | Train Loss: 1.834 Vali Loss: 2.429 Vali Acc: 0.332 Test Loss: 2.429 Test Acc: 0.332
Validation loss decreased (-0.327633 --> -0.332092).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.7739344
	speed: 0.4367s/iter; left time: 2983.2117s
Epoch: 6 cost time: 13.073947668075562
Epoch: 6, Steps: 154 | Train Loss: 1.737 Vali Loss: 2.698 Vali Acc: 0.337 Test Loss: 2.698 Test Acc: 0.337
Validation loss decreased (-0.332092 --> -0.336956).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.9197325
	speed: 0.2893s/iter; left time: 1931.5103s
Epoch: 7 cost time: 16.99174427986145
Epoch: 7, Steps: 154 | Train Loss: 1.686 Vali Loss: 2.506 Vali Acc: 0.358 Test Loss: 2.506 Test Acc: 0.358
Validation loss decreased (-0.336956 --> -0.357639).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.0406008
	speed: 0.3493s/iter; left time: 2278.7917s
Epoch: 8 cost time: 15.469815015792847
Epoch: 8, Steps: 154 | Train Loss: 1.608 Vali Loss: 3.393 Vali Acc: 0.122 Test Loss: 3.393 Test Acc: 0.122
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.8562384
	speed: 0.2482s/iter; left time: 1580.7977s
Epoch: 9 cost time: 10.793740510940552
Epoch: 9, Steps: 154 | Train Loss: 1.563 Vali Loss: 3.460 Vali Acc: 0.095 Test Loss: 3.460 Test Acc: 0.095
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.4745584
	speed: 0.2156s/iter; left time: 1339.9257s
Epoch: 10 cost time: 13.471944093704224
Epoch: 10, Steps: 154 | Train Loss: 1.510 Vali Loss: 3.785 Vali Acc: 0.157 Test Loss: 3.785 Test Acc: 0.157
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.6390691
	speed: 0.2587s/iter; left time: 1567.6982s
Epoch: 11 cost time: 11.443912744522095
Epoch: 11, Steps: 154 | Train Loss: 1.473 Vali Loss: 4.033 Vali Acc: 0.104 Test Loss: 4.033 Test Acc: 0.104
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 1.3169599
	speed: 0.2421s/iter; left time: 1430.1787s
Epoch: 12 cost time: 13.444477558135986
Epoch: 12, Steps: 154 | Train Loss: 1.406 Vali Loss: 3.777 Vali Acc: 0.111 Test Loss: 3.777 Test Acc: 0.111
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.9998837
	speed: 0.2000s/iter; left time: 1150.6394s
Epoch: 13 cost time: 7.591531753540039
Epoch: 13, Steps: 154 | Train Loss: 1.366 Vali Loss: 4.006 Vali Acc: 0.132 Test Loss: 4.006 Test Acc: 0.132
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 1.4450012
	speed: 0.1697s/iter; left time: 950.2915s
Epoch: 14 cost time: 8.842635154724121
Epoch: 14, Steps: 154 | Train Loss: 1.361 Vali Loss: 4.441 Vali Acc: 0.071 Test Loss: 4.441 Test Acc: 0.071
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 1.4178286
	speed: 0.2475s/iter; left time: 1347.5426s
Epoch: 15 cost time: 13.611128091812134
Epoch: 15, Steps: 154 | Train Loss: 1.308 Vali Loss: 3.908 Vali Acc: 0.171 Test Loss: 3.908 Test Acc: 0.171
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.9156508
	speed: 0.2252s/iter; left time: 1191.4547s
Epoch: 16 cost time: 9.921031951904297
Epoch: 16, Steps: 154 | Train Loss: 1.278 Vali Loss: 4.093 Vali Acc: 0.207 Test Loss: 4.093 Test Acc: 0.207
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 1.2166502
	speed: 0.2133s/iter; left time: 1095.9311s
Epoch: 17 cost time: 13.869900703430176
Epoch: 17, Steps: 154 | Train Loss: 1.225 Vali Loss: 4.717 Vali Acc: 0.088 Test Loss: 4.717 Test Acc: 0.088
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el6_dm768_df768_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.35766423357664234
model parameter : 43650062
model size : 181.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el6_dm768_df768_ps4_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.8316782
	speed: 0.0581s/iter; left time: 441.8440s
Epoch: 1 cost time: 8.274209976196289
Epoch: 1, Steps: 154 | Train Loss: 2.122 Vali Loss: 2.184 Vali Acc: 0.318 Test Loss: 2.184 Test Acc: 0.318
Validation loss decreased (inf --> -0.318307).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0171752
	speed: 0.1296s/iter; left time: 964.8342s
Epoch: 2 cost time: 4.997859239578247
Epoch: 2, Steps: 154 | Train Loss: 2.031 Vali Loss: 2.157 Vali Acc: 0.328 Test Loss: 2.157 Test Acc: 0.328
Validation loss decreased (-0.318307 --> -0.328040).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.1023526
	speed: 0.1098s/iter; left time: 800.9071s
Epoch: 3 cost time: 5.341413974761963
Epoch: 3, Steps: 154 | Train Loss: 1.964 Vali Loss: 2.203 Vali Acc: 0.324 Test Loss: 2.203 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 2.1160808
	speed: 0.1389s/iter; left time: 991.5953s
Epoch: 4 cost time: 7.063881874084473
Epoch: 4, Steps: 154 | Train Loss: 1.905 Vali Loss: 2.680 Vali Acc: 0.326 Test Loss: 2.680 Test Acc: 0.326
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 1.5641773
	speed: 0.1330s/iter; left time: 929.0303s
Epoch: 5 cost time: 5.0567286014556885
Epoch: 5, Steps: 154 | Train Loss: 1.815 Vali Loss: 2.619 Vali Acc: 0.330 Test Loss: 2.619 Test Acc: 0.330
Validation loss decreased (-0.328040 --> -0.329658).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.8355942
	speed: 0.1835s/iter; left time: 1253.5589s
Epoch: 6 cost time: 3.971257448196411
Epoch: 6, Steps: 154 | Train Loss: 1.747 Vali Loss: 2.629 Vali Acc: 0.341 Test Loss: 2.629 Test Acc: 0.341
Validation loss decreased (-0.329658 --> -0.340606).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.2866280
	speed: 0.1608s/iter; left time: 1073.5933s
Epoch: 7 cost time: 4.567232847213745
Epoch: 7, Steps: 154 | Train Loss: 1.692 Vali Loss: 2.542 Vali Acc: 0.346 Test Loss: 2.542 Test Acc: 0.346
Validation loss decreased (-0.340606 --> -0.345879).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.4768337
	speed: 0.1632s/iter; left time: 1064.2977s
Epoch: 8 cost time: 4.154419660568237
Epoch: 8, Steps: 154 | Train Loss: 1.623 Vali Loss: 2.882 Vali Acc: 0.342 Test Loss: 2.882 Test Acc: 0.342
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.1798258
	speed: 0.1213s/iter; left time: 772.3338s
Epoch: 9 cost time: 7.1782097816467285
Epoch: 9, Steps: 154 | Train Loss: 1.585 Vali Loss: 2.707 Vali Acc: 0.345 Test Loss: 2.707 Test Acc: 0.345
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.3701890
	speed: 0.1485s/iter; left time: 923.0528s
Epoch: 10 cost time: 5.466317653656006
Epoch: 10, Steps: 154 | Train Loss: 1.539 Vali Loss: 2.915 Vali Acc: 0.358 Test Loss: 2.915 Test Acc: 0.358
Validation loss decreased (-0.345879 --> -0.357635).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.7071023
	speed: 0.1741s/iter; left time: 1055.2924s
Epoch: 11 cost time: 6.659752368927002
Epoch: 11, Steps: 154 | Train Loss: 1.469 Vali Loss: 3.127 Vali Acc: 0.187 Test Loss: 3.127 Test Acc: 0.187
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.4664825
	speed: 0.1162s/iter; left time: 686.3869s
Epoch: 12 cost time: 5.4316489696502686
Epoch: 12, Steps: 154 | Train Loss: 1.447 Vali Loss: 3.525 Vali Acc: 0.190 Test Loss: 3.525 Test Acc: 0.190
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.9331800
	speed: 0.1221s/iter; left time: 702.2150s
Epoch: 13 cost time: 5.31904935836792
Epoch: 13, Steps: 154 | Train Loss: 1.432 Vali Loss: 4.170 Vali Acc: 0.109 Test Loss: 4.170 Test Acc: 0.109
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 1.1336960
	speed: 0.1061s/iter; left time: 594.2776s
Epoch: 14 cost time: 5.137322187423706
Epoch: 14, Steps: 154 | Train Loss: 1.413 Vali Loss: 3.470 Vali Acc: 0.111 Test Loss: 3.470 Test Acc: 0.111
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 1.3068526
	speed: 0.1326s/iter; left time: 722.0803s
Epoch: 15 cost time: 5.177761793136597
Epoch: 15, Steps: 154 | Train Loss: 1.357 Vali Loss: 4.111 Vali Acc: 0.103 Test Loss: 4.111 Test Acc: 0.103
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 1.6652787
	speed: 0.1089s/iter; left time: 576.1302s
Epoch: 16 cost time: 5.287934064865112
Epoch: 16, Steps: 154 | Train Loss: 1.339 Vali Loss: 3.385 Vali Acc: 0.190 Test Loss: 3.385 Test Acc: 0.190
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 1.2790509
	speed: 0.1181s/iter; left time: 606.7788s
Epoch: 17 cost time: 3.993481397628784
Epoch: 17, Steps: 154 | Train Loss: 1.330 Vali Loss: 3.596 Vali Acc: 0.196 Test Loss: 3.596 Test Acc: 0.196
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 1.5718617
	speed: 0.0938s/iter; left time: 467.4204s
Epoch: 18 cost time: 4.39612340927124
Epoch: 18, Steps: 154 | Train Loss: 1.300 Vali Loss: 3.906 Vali Acc: 0.184 Test Loss: 3.906 Test Acc: 0.184
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 1.1587088
	speed: 0.1153s/iter; left time: 556.9178s
Epoch: 19 cost time: 5.5709240436553955
Epoch: 19, Steps: 154 | Train Loss: 1.258 Vali Loss: 3.785 Vali Acc: 0.165 Test Loss: 3.785 Test Acc: 0.165
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 1.3441591
	speed: 0.1269s/iter; left time: 593.4420s
Epoch: 20 cost time: 4.974966287612915
Epoch: 20, Steps: 154 | Train Loss: 1.244 Vali Loss: 4.255 Vali Acc: 0.069 Test Loss: 4.255 Test Acc: 0.069
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el6_dm768_df768_ps4_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.35766423357664234
model parameter : 43551758
model size : 180.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el6_dm768_df768_ps5_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9861339
	speed: 0.0700s/iter; left time: 532.1543s
Epoch: 1 cost time: 9.704700469970703
Epoch: 1, Steps: 154 | Train Loss: 2.124 Vali Loss: 2.280 Vali Acc: 0.320 Test Loss: 2.280 Test Acc: 0.320
Validation loss decreased (inf --> -0.320334).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.5326742
	speed: 0.2337s/iter; left time: 1740.6763s
Epoch: 2 cost time: 11.798558235168457
Epoch: 2, Steps: 154 | Train Loss: 2.027 Vali Loss: 2.281 Vali Acc: 0.326 Test Loss: 2.281 Test Acc: 0.326
Validation loss decreased (-0.320334 --> -0.325606).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.1279244
	speed: 0.2498s/iter; left time: 1822.1330s
Epoch: 3 cost time: 11.585067987442017
Epoch: 3, Steps: 154 | Train Loss: 1.943 Vali Loss: 2.331 Vali Acc: 0.334 Test Loss: 2.331 Test Acc: 0.334
Validation loss decreased (-0.325606 --> -0.333716).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.3461850
	speed: 0.2457s/iter; left time: 1754.1263s
Epoch: 4 cost time: 8.114741086959839
Epoch: 4, Steps: 154 | Train Loss: 1.849 Vali Loss: 2.609 Vali Acc: 0.328 Test Loss: 2.609 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.5884855
	speed: 0.1854s/iter; left time: 1295.2116s
Epoch: 5 cost time: 10.68051266670227
Epoch: 5, Steps: 154 | Train Loss: 1.757 Vali Loss: 2.787 Vali Acc: 0.342 Test Loss: 2.787 Test Acc: 0.342
Validation loss decreased (-0.333716 --> -0.341821).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.5340436
	speed: 0.3032s/iter; left time: 2071.2977s
Epoch: 6 cost time: 12.114245414733887
Epoch: 6, Steps: 154 | Train Loss: 1.707 Vali Loss: 2.847 Vali Acc: 0.355 Test Loss: 2.847 Test Acc: 0.355
Validation loss decreased (-0.341821 --> -0.354797).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.7575936
	speed: 0.3337s/iter; left time: 2228.3143s
Epoch: 7 cost time: 12.83348298072815
Epoch: 7, Steps: 154 | Train Loss: 1.645 Vali Loss: 3.118 Vali Acc: 0.228 Test Loss: 3.118 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.6914369
	speed: 0.2429s/iter; left time: 1584.1908s
Epoch: 8 cost time: 13.086464405059814
Epoch: 8, Steps: 154 | Train Loss: 1.585 Vali Loss: 3.569 Vali Acc: 0.100 Test Loss: 3.569 Test Acc: 0.100
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.4556509
	speed: 0.2594s/iter; left time: 1652.2428s
Epoch: 9 cost time: 13.228880643844604
Epoch: 9, Steps: 154 | Train Loss: 1.554 Vali Loss: 3.711 Vali Acc: 0.101 Test Loss: 3.711 Test Acc: 0.101
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.2271549
	speed: 0.2243s/iter; left time: 1393.8035s
Epoch: 10 cost time: 9.174611568450928
Epoch: 10, Steps: 154 | Train Loss: 1.503 Vali Loss: 3.605 Vali Acc: 0.189 Test Loss: 3.605 Test Acc: 0.189
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 1.3362483
	speed: 0.1871s/iter; left time: 1134.1314s
Epoch: 11 cost time: 9.547659158706665
Epoch: 11, Steps: 154 | Train Loss: 1.484 Vali Loss: 4.491 Vali Acc: 0.191 Test Loss: 4.491 Test Acc: 0.191
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 2.1929333
	speed: 0.2103s/iter; left time: 1242.0078s
Epoch: 12 cost time: 10.151442766189575
Epoch: 12, Steps: 154 | Train Loss: 1.420 Vali Loss: 4.076 Vali Acc: 0.109 Test Loss: 4.076 Test Acc: 0.109
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.9543435
	speed: 0.2413s/iter; left time: 1388.0446s
Epoch: 13 cost time: 9.688429355621338
Epoch: 13, Steps: 154 | Train Loss: 1.379 Vali Loss: 4.308 Vali Acc: 0.182 Test Loss: 4.308 Test Acc: 0.182
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 1.1771847
	speed: 0.1923s/iter; left time: 1076.5869s
Epoch: 14 cost time: 9.726674318313599
Epoch: 14, Steps: 154 | Train Loss: 1.361 Vali Loss: 4.061 Vali Acc: 0.125 Test Loss: 4.061 Test Acc: 0.125
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 1.0763373
	speed: 0.1642s/iter; left time: 894.2096s
Epoch: 15 cost time: 7.675857067108154
Epoch: 15, Steps: 154 | Train Loss: 1.322 Vali Loss: 4.382 Vali Acc: 0.194 Test Loss: 4.382 Test Acc: 0.194
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 1.1552439
	speed: 0.1829s/iter; left time: 967.4843s
Epoch: 16 cost time: 9.375077486038208
Epoch: 16, Steps: 154 | Train Loss: 1.321 Vali Loss: 5.017 Vali Acc: 0.193 Test Loss: 5.017 Test Acc: 0.193
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el6_dm768_df768_ps5_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3548256285482563
model parameter : 43651598
model size : 181.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el6_dm768_df768_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1577842
	speed: 0.0566s/iter; left time: 430.5739s
Epoch: 1 cost time: 8.58274507522583
Epoch: 1, Steps: 154 | Train Loss: 2.121 Vali Loss: 2.335 Vali Acc: 0.327 Test Loss: 2.335 Test Acc: 0.327
Validation loss decreased (inf --> -0.327227).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.1894290
	speed: 0.1555s/iter; left time: 1158.0059s
Epoch: 2 cost time: 4.44767689704895
Epoch: 2, Steps: 154 | Train Loss: 2.036 Vali Loss: 2.389 Vali Acc: 0.322 Test Loss: 2.389 Test Acc: 0.322
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.9087644
	speed: 0.1232s/iter; left time: 898.8386s
Epoch: 3 cost time: 4.296147584915161
Epoch: 3, Steps: 154 | Train Loss: 1.928 Vali Loss: 2.319 Vali Acc: 0.338 Test Loss: 2.319 Test Acc: 0.338
Validation loss decreased (-0.327227 --> -0.338176).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.7526814
	speed: 0.1607s/iter; left time: 1147.0427s
Epoch: 4 cost time: 5.791479110717773
Epoch: 4, Steps: 154 | Train Loss: 1.811 Vali Loss: 2.424 Vali Acc: 0.331 Test Loss: 2.424 Test Acc: 0.331
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.5797940
	speed: 0.1993s/iter; left time: 1391.8451s
Epoch: 5 cost time: 8.41593313217163
Epoch: 5, Steps: 154 | Train Loss: 1.750 Vali Loss: 2.626 Vali Acc: 0.339 Test Loss: 2.626 Test Acc: 0.339
Validation loss decreased (-0.338176 --> -0.339390).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.3252864
	speed: 0.2070s/iter; left time: 1414.0479s
Epoch: 6 cost time: 6.561097860336304
Epoch: 6, Steps: 154 | Train Loss: 1.702 Vali Loss: 2.543 Vali Acc: 0.349 Test Loss: 2.543 Test Acc: 0.349
Validation loss decreased (-0.339390 --> -0.349123).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.8478829
	speed: 0.1987s/iter; left time: 1326.6352s
Epoch: 7 cost time: 9.320948839187622
Epoch: 7, Steps: 154 | Train Loss: 1.619 Vali Loss: 3.080 Vali Acc: 0.087 Test Loss: 3.080 Test Acc: 0.087
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.6430397
	speed: 0.1700s/iter; left time: 1109.0705s
Epoch: 8 cost time: 6.342450380325317
Epoch: 8, Steps: 154 | Train Loss: 1.607 Vali Loss: 3.011 Vali Acc: 0.178 Test Loss: 3.011 Test Acc: 0.178
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.4478699
	speed: 0.1230s/iter; left time: 783.6348s
Epoch: 9 cost time: 4.607340097427368
Epoch: 9, Steps: 154 | Train Loss: 1.533 Vali Loss: 3.354 Vali Acc: 0.169 Test Loss: 3.354 Test Acc: 0.169
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.4681952
	speed: 0.1281s/iter; left time: 796.3848s
Epoch: 10 cost time: 5.189896583557129
Epoch: 10, Steps: 154 | Train Loss: 1.538 Vali Loss: 4.010 Vali Acc: 0.052 Test Loss: 4.010 Test Acc: 0.052
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 1.2267838
	speed: 0.1492s/iter; left time: 904.2858s
Epoch: 11 cost time: 4.994816541671753
Epoch: 11, Steps: 154 | Train Loss: 1.502 Vali Loss: 3.677 Vali Acc: 0.133 Test Loss: 3.677 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 1.2799631
	speed: 0.1220s/iter; left time: 720.6795s
Epoch: 12 cost time: 6.190150499343872
Epoch: 12, Steps: 154 | Train Loss: 1.464 Vali Loss: 3.694 Vali Acc: 0.184 Test Loss: 3.694 Test Acc: 0.184
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 1.1718304
	speed: 0.1431s/iter; left time: 823.4213s
Epoch: 13 cost time: 7.382091999053955
Epoch: 13, Steps: 154 | Train Loss: 1.402 Vali Loss: 4.700 Vali Acc: 0.101 Test Loss: 4.700 Test Acc: 0.101
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 1.1301944
	speed: 0.1539s/iter; left time: 861.6441s
Epoch: 14 cost time: 4.984268665313721
Epoch: 14, Steps: 154 | Train Loss: 1.400 Vali Loss: 4.292 Vali Acc: 0.102 Test Loss: 4.292 Test Acc: 0.102
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 1.5485997
	speed: 0.1593s/iter; left time: 867.1311s
Epoch: 15 cost time: 7.045073747634888
Epoch: 15, Steps: 154 | Train Loss: 1.373 Vali Loss: 5.208 Vali Acc: 0.053 Test Loss: 5.208 Test Acc: 0.053
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 1.2891023
	speed: 0.1520s/iter; left time: 804.1355s
Epoch: 16 cost time: 5.963902711868286
Epoch: 16, Steps: 154 | Train Loss: 1.346 Vali Loss: 5.675 Vali Acc: 0.155 Test Loss: 5.675 Test Acc: 0.155
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el6_dm768_df768_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3491484184914842
model parameter : 43590158
model size : 180.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el6_dm768_df768_ps5_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0680273
	speed: 0.0446s/iter; left time: 338.9078s
Epoch: 1 cost time: 5.852444648742676
Epoch: 1, Steps: 154 | Train Loss: 2.130 Vali Loss: 2.135 Vali Acc: 0.321 Test Loss: 2.135 Test Acc: 0.321
Validation loss decreased (inf --> -0.320741).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.2085531
	speed: 0.1003s/iter; left time: 747.0752s
Epoch: 2 cost time: 5.029790639877319
Epoch: 2, Steps: 154 | Train Loss: 2.027 Vali Loss: 2.152 Vali Acc: 0.321 Test Loss: 2.152 Test Acc: 0.321
Validation loss decreased (-0.320741 --> -0.321146).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.1411145
	speed: 0.2136s/iter; left time: 1558.1341s
Epoch: 3 cost time: 4.452152967453003
Epoch: 3, Steps: 154 | Train Loss: 1.967 Vali Loss: 2.458 Vali Acc: 0.321 Test Loss: 2.458 Test Acc: 0.321
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.5792164
	speed: 0.0895s/iter; left time: 638.6654s
Epoch: 4 cost time: 3.782559871673584
Epoch: 4, Steps: 154 | Train Loss: 1.894 Vali Loss: 2.414 Vali Acc: 0.326 Test Loss: 2.414 Test Acc: 0.326
Validation loss decreased (-0.321146 --> -0.326415).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.4600534
	speed: 0.2202s/iter; left time: 1538.3576s
Epoch: 5 cost time: 5.4547882080078125
Epoch: 5, Steps: 154 | Train Loss: 1.799 Vali Loss: 2.470 Vali Acc: 0.332 Test Loss: 2.470 Test Acc: 0.332
Validation loss decreased (-0.326415 --> -0.332092).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.5847168
	speed: 0.2375s/iter; left time: 1622.0287s
Epoch: 6 cost time: 6.121480226516724
Epoch: 6, Steps: 154 | Train Loss: 1.740 Vali Loss: 2.710 Vali Acc: 0.363 Test Loss: 2.710 Test Acc: 0.363
Validation loss decreased (-0.332092 --> -0.362909).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.2629689
	speed: 0.1339s/iter; left time: 893.8368s
Epoch: 7 cost time: 5.638323545455933
Epoch: 7, Steps: 154 | Train Loss: 1.667 Vali Loss: 2.770 Vali Acc: 0.174 Test Loss: 2.770 Test Acc: 0.174
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.6257421
	speed: 0.1202s/iter; left time: 784.3673s
Epoch: 8 cost time: 6.16631007194519
Epoch: 8, Steps: 154 | Train Loss: 1.630 Vali Loss: 3.317 Vali Acc: 0.178 Test Loss: 3.317 Test Acc: 0.178
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.9704974
	speed: 0.1434s/iter; left time: 913.2483s
Epoch: 9 cost time: 6.029297351837158
Epoch: 9, Steps: 154 | Train Loss: 1.589 Vali Loss: 2.815 Vali Acc: 0.180 Test Loss: 2.815 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.1431350
	speed: 0.0941s/iter; left time: 584.9884s
Epoch: 10 cost time: 4.340506553649902
Epoch: 10, Steps: 154 | Train Loss: 1.541 Vali Loss: 3.581 Vali Acc: 0.089 Test Loss: 3.581 Test Acc: 0.089
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 1.3270698
	speed: 0.1285s/iter; left time: 779.0305s
Epoch: 11 cost time: 5.8631768226623535
Epoch: 11, Steps: 154 | Train Loss: 1.511 Vali Loss: 3.999 Vali Acc: 0.097 Test Loss: 3.999 Test Acc: 0.097
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 1.3122003
	speed: 0.1048s/iter; left time: 619.1028s
Epoch: 12 cost time: 5.466800928115845
Epoch: 12, Steps: 154 | Train Loss: 1.484 Vali Loss: 3.757 Vali Acc: 0.177 Test Loss: 3.757 Test Acc: 0.177
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 1.6971318
	speed: 0.1181s/iter; left time: 679.5512s
Epoch: 13 cost time: 7.446980714797974
Epoch: 13, Steps: 154 | Train Loss: 1.433 Vali Loss: 5.458 Vali Acc: 0.051 Test Loss: 5.458 Test Acc: 0.051
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 1.5921862
	speed: 0.1483s/iter; left time: 830.1773s
Epoch: 14 cost time: 6.326676607131958
Epoch: 14, Steps: 154 | Train Loss: 1.419 Vali Loss: 4.528 Vali Acc: 0.159 Test Loss: 4.528 Test Acc: 0.159
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 1.2782992
	speed: 0.1594s/iter; left time: 867.8592s
Epoch: 15 cost time: 6.801345348358154
Epoch: 15, Steps: 154 | Train Loss: 1.384 Vali Loss: 4.522 Vali Acc: 0.098 Test Loss: 4.522 Test Acc: 0.098
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 1.5178478
	speed: 0.1310s/iter; left time: 693.2793s
Epoch: 16 cost time: 5.2265753746032715
Epoch: 16, Steps: 154 | Train Loss: 1.359 Vali Loss: 5.050 Vali Acc: 0.180 Test Loss: 5.050 Test Acc: 0.180
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el6_dm768_df768_ps5_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3629359286293593
model parameter : 43541006
model size : 180.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el6_dm768_df768_ps6_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2820721
	speed: 0.0632s/iter; left time: 480.7596s
Epoch: 1 cost time: 8.046584606170654
Epoch: 1, Steps: 154 | Train Loss: 2.117 Vali Loss: 2.234 Vali Acc: 0.160 Test Loss: 2.234 Test Acc: 0.160
Validation loss decreased (inf --> -0.159751).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9527943
	speed: 0.1561s/iter; left time: 1162.6535s
Epoch: 2 cost time: 10.038609266281128
Epoch: 2, Steps: 154 | Train Loss: 2.024 Vali Loss: 2.411 Vali Acc: 0.320 Test Loss: 2.411 Test Acc: 0.320
Validation loss decreased (-0.159751 --> -0.320333).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9254700
	speed: 0.2301s/iter; left time: 1678.1969s
Epoch: 3 cost time: 12.51157021522522
Epoch: 3, Steps: 154 | Train Loss: 1.970 Vali Loss: 2.228 Vali Acc: 0.324 Test Loss: 2.228 Test Acc: 0.324
Validation loss decreased (-0.320333 --> -0.323984).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.6281263
	speed: 0.3139s/iter; left time: 2241.0778s
Epoch: 4 cost time: 7.462298154830933
Epoch: 4, Steps: 154 | Train Loss: 1.852 Vali Loss: 2.660 Vali Acc: 0.350 Test Loss: 2.660 Test Acc: 0.350
Validation loss decreased (-0.323984 --> -0.349527).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.6332313
	speed: 0.2456s/iter; left time: 1715.3188s
Epoch: 5 cost time: 10.445588827133179
Epoch: 5, Steps: 154 | Train Loss: 1.760 Vali Loss: 3.005 Vali Acc: 0.337 Test Loss: 3.005 Test Acc: 0.337
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.3428738
	speed: 0.1831s/iter; left time: 1250.6224s
Epoch: 6 cost time: 6.285633325576782
Epoch: 6, Steps: 154 | Train Loss: 1.686 Vali Loss: 3.462 Vali Acc: 0.161 Test Loss: 3.462 Test Acc: 0.161
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.6820955
	speed: 0.2010s/iter; left time: 1342.1453s
Epoch: 7 cost time: 14.817208290100098
Epoch: 7, Steps: 154 | Train Loss: 1.617 Vali Loss: 3.862 Vali Acc: 0.177 Test Loss: 3.862 Test Acc: 0.177
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 1.3237482
	speed: 0.2259s/iter; left time: 1473.6631s
Epoch: 8 cost time: 12.841812133789062
Epoch: 8, Steps: 154 | Train Loss: 1.587 Vali Loss: 3.918 Vali Acc: 0.182 Test Loss: 3.918 Test Acc: 0.182
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 1.6562493
	speed: 0.2648s/iter; left time: 1686.8205s
Epoch: 9 cost time: 13.106556415557861
Epoch: 9, Steps: 154 | Train Loss: 1.530 Vali Loss: 4.386 Vali Acc: 0.174 Test Loss: 4.386 Test Acc: 0.174
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 1.1427969
	speed: 0.2776s/iter; left time: 1725.4750s
Epoch: 10 cost time: 12.588182210922241
Epoch: 10, Steps: 154 | Train Loss: 1.459 Vali Loss: 5.034 Vali Acc: 0.181 Test Loss: 5.034 Test Acc: 0.181
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 1.3225015
	speed: 0.1616s/iter; left time: 979.7292s
Epoch: 11 cost time: 8.212260484695435
Epoch: 11, Steps: 154 | Train Loss: 1.429 Vali Loss: 5.060 Vali Acc: 0.049 Test Loss: 5.060 Test Acc: 0.049
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 1.4056432
	speed: 0.2164s/iter; left time: 1278.2012s
Epoch: 12 cost time: 12.538596630096436
Epoch: 12, Steps: 154 | Train Loss: 1.395 Vali Loss: 4.669 Vali Acc: 0.184 Test Loss: 4.669 Test Acc: 0.184
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 1.3119439
	speed: 0.2543s/iter; left time: 1463.1623s
Epoch: 13 cost time: 13.237289905548096
Epoch: 13, Steps: 154 | Train Loss: 1.343 Vali Loss: 5.753 Vali Acc: 0.061 Test Loss: 5.753 Test Acc: 0.061
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 1.3089380
	speed: 0.2009s/iter; left time: 1124.5670s
Epoch: 14 cost time: 9.067726135253906
Epoch: 14, Steps: 154 | Train Loss: 1.342 Vali Loss: 4.986 Vali Acc: 0.161 Test Loss: 4.986 Test Acc: 0.161
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el6_dm768_df768_ps6_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3495539334955393
model parameter : 43665422
model size : 181.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el6_dm768_df768_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 3.0062547
	speed: 0.0635s/iter; left time: 482.2957s
Epoch: 1 cost time: 8.826738357543945
Epoch: 1, Steps: 154 | Train Loss: 2.145 Vali Loss: 2.126 Vali Acc: 0.319 Test Loss: 2.126 Test Acc: 0.319
Validation loss decreased (inf --> -0.319119).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.5574270
	speed: 0.1735s/iter; left time: 1291.9244s
Epoch: 2 cost time: 6.219188213348389
Epoch: 2, Steps: 154 | Train Loss: 2.038 Vali Loss: 2.112 Vali Acc: 0.327 Test Loss: 2.112 Test Acc: 0.327
Validation loss decreased (-0.319119 --> -0.326824).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9535071
	speed: 0.2921s/iter; left time: 2130.0934s
Epoch: 3 cost time: 9.662507057189941
Epoch: 3, Steps: 154 | Train Loss: 1.956 Vali Loss: 2.342 Vali Acc: 0.324 Test Loss: 2.342 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.7493321
	speed: 0.2131s/iter; left time: 1521.6225s
Epoch: 4 cost time: 10.00013780593872
Epoch: 4, Steps: 154 | Train Loss: 1.863 Vali Loss: 2.521 Vali Acc: 0.327 Test Loss: 2.521 Test Acc: 0.327
Validation loss decreased (-0.326824 --> -0.327225).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.6670951
	speed: 0.2248s/iter; left time: 1570.2777s
Epoch: 5 cost time: 5.316391944885254
Epoch: 5, Steps: 154 | Train Loss: 1.798 Vali Loss: 2.766 Vali Acc: 0.339 Test Loss: 2.766 Test Acc: 0.339
Validation loss decreased (-0.327225 --> -0.339388).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.2928643
	speed: 0.2325s/iter; left time: 1588.4349s
Epoch: 6 cost time: 8.182970762252808
Epoch: 6, Steps: 154 | Train Loss: 1.716 Vali Loss: 2.815 Vali Acc: 0.336 Test Loss: 2.815 Test Acc: 0.336
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.7525464
	speed: 0.1693s/iter; left time: 1130.6209s
Epoch: 7 cost time: 8.595441579818726
Epoch: 7, Steps: 154 | Train Loss: 1.653 Vali Loss: 3.343 Vali Acc: 0.352 Test Loss: 3.343 Test Acc: 0.352
Validation loss decreased (-0.339388 --> -0.351954).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.1862237
	speed: 0.2748s/iter; left time: 1792.6083s
Epoch: 8 cost time: 6.7069902420043945
Epoch: 8, Steps: 154 | Train Loss: 1.581 Vali Loss: 3.896 Vali Acc: 0.086 Test Loss: 3.896 Test Acc: 0.086
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.5643322
	speed: 0.1889s/iter; left time: 1203.3419s
Epoch: 9 cost time: 7.714401721954346
Epoch: 9, Steps: 154 | Train Loss: 1.534 Vali Loss: 3.896 Vali Acc: 0.102 Test Loss: 3.896 Test Acc: 0.102
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.4174252
	speed: 0.1766s/iter; left time: 1097.5232s
Epoch: 10 cost time: 8.768974542617798
Epoch: 10, Steps: 154 | Train Loss: 1.481 Vali Loss: 3.946 Vali Acc: 0.187 Test Loss: 3.946 Test Acc: 0.187
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.6836178
	speed: 0.1754s/iter; left time: 1063.0030s
Epoch: 11 cost time: 7.222955942153931
Epoch: 11, Steps: 154 | Train Loss: 1.467 Vali Loss: 4.432 Vali Acc: 0.185 Test Loss: 4.432 Test Acc: 0.185
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 1.1245127
	speed: 0.1883s/iter; left time: 1112.3069s
Epoch: 12 cost time: 8.678139448165894
Epoch: 12, Steps: 154 | Train Loss: 1.415 Vali Loss: 4.494 Vali Acc: 0.178 Test Loss: 4.494 Test Acc: 0.178
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 1.2055115
	speed: 0.1602s/iter; left time: 921.5993s
Epoch: 13 cost time: 6.265430450439453
Epoch: 13, Steps: 154 | Train Loss: 1.388 Vali Loss: 4.008 Vali Acc: 0.150 Test Loss: 4.008 Test Acc: 0.150
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.7331659
	speed: 0.1517s/iter; left time: 849.1974s
Epoch: 14 cost time: 7.556778907775879
Epoch: 14, Steps: 154 | Train Loss: 1.349 Vali Loss: 4.196 Vali Acc: 0.099 Test Loss: 4.196 Test Acc: 0.099
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 1.2963477
	speed: 0.1740s/iter; left time: 947.2025s
Epoch: 15 cost time: 8.60097050666809
Epoch: 15, Steps: 154 | Train Loss: 1.334 Vali Loss: 5.103 Vali Acc: 0.196 Test Loss: 5.103 Test Acc: 0.196
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 1.0148815
	speed: 0.2304s/iter; left time: 1219.1771s
Epoch: 16 cost time: 8.181972026824951
Epoch: 16, Steps: 154 | Train Loss: 1.313 Vali Loss: 4.989 Vali Acc: 0.178 Test Loss: 4.989 Test Acc: 0.178
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 1.5375409
	speed: 0.1675s/iter; left time: 860.6795s
Epoch: 17 cost time: 9.001402854919434
Epoch: 17, Steps: 154 | Train Loss: 1.262 Vali Loss: 4.854 Vali Acc: 0.060 Test Loss: 4.854 Test Acc: 0.060
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el6_dm768_df768_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3519870235198702
model parameter : 43603982
model size : 181.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el6_dm768_df768_ps6_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.3392050
	speed: 0.0682s/iter; left time: 518.3213s
Epoch: 1 cost time: 9.214243173599243
Epoch: 1, Steps: 154 | Train Loss: 2.142 Vali Loss: 2.185 Vali Acc: 0.320 Test Loss: 2.185 Test Acc: 0.320
Validation loss decreased (inf --> -0.319929).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8200166
	speed: 0.1699s/iter; left time: 1265.1456s
Epoch: 2 cost time: 7.45699143409729
Epoch: 2, Steps: 154 | Train Loss: 2.028 Vali Loss: 2.138 Vali Acc: 0.322 Test Loss: 2.138 Test Acc: 0.322
Validation loss decreased (-0.319929 --> -0.322363).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.0032239
	speed: 0.1668s/iter; left time: 1216.5698s
Epoch: 3 cost time: 5.6552863121032715
Epoch: 3, Steps: 154 | Train Loss: 1.968 Vali Loss: 2.177 Vali Acc: 0.323 Test Loss: 2.177 Test Acc: 0.323
Validation loss decreased (-0.322363 --> -0.323174).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.8174417
	speed: 0.1358s/iter; left time: 969.7622s
Epoch: 4 cost time: 4.599038124084473
Epoch: 4, Steps: 154 | Train Loss: 1.896 Vali Loss: 2.240 Vali Acc: 0.328 Test Loss: 2.240 Test Acc: 0.328
Validation loss decreased (-0.323174 --> -0.328039).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.7464424
	speed: 0.1936s/iter; left time: 1352.5460s
Epoch: 5 cost time: 7.8649582862854
Epoch: 5, Steps: 154 | Train Loss: 1.835 Vali Loss: 2.438 Vali Acc: 0.339 Test Loss: 2.438 Test Acc: 0.339
Validation loss decreased (-0.328039 --> -0.338581).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.7573817
	speed: 0.2493s/iter; left time: 1703.0792s
Epoch: 6 cost time: 8.988545179367065
Epoch: 6, Steps: 154 | Train Loss: 1.762 Vali Loss: 2.450 Vali Acc: 0.334 Test Loss: 2.450 Test Acc: 0.334
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.3005873
	speed: 0.1574s/iter; left time: 1050.9836s
Epoch: 7 cost time: 5.426279544830322
Epoch: 7, Steps: 154 | Train Loss: 1.673 Vali Loss: 2.704 Vali Acc: 0.352 Test Loss: 2.704 Test Acc: 0.352
Validation loss decreased (-0.338581 --> -0.352366).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.1902944
	speed: 0.2238s/iter; left time: 1460.0453s
Epoch: 8 cost time: 8.15267276763916
Epoch: 8, Steps: 154 | Train Loss: 1.632 Vali Loss: 2.680 Vali Acc: 0.203 Test Loss: 2.680 Test Acc: 0.203
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 2.0503907
	speed: 0.1923s/iter; left time: 1224.6904s
Epoch: 9 cost time: 8.439964771270752
Epoch: 9, Steps: 154 | Train Loss: 1.572 Vali Loss: 3.037 Vali Acc: 0.341 Test Loss: 3.037 Test Acc: 0.341
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.9192548
	speed: 0.1691s/iter; left time: 1050.8291s
Epoch: 10 cost time: 8.268287658691406
Epoch: 10, Steps: 154 | Train Loss: 1.529 Vali Loss: 3.029 Vali Acc: 0.346 Test Loss: 3.029 Test Acc: 0.346
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.4785610
	speed: 0.1989s/iter; left time: 1205.6476s
Epoch: 11 cost time: 8.956008672714233
Epoch: 11, Steps: 154 | Train Loss: 1.503 Vali Loss: 3.360 Vali Acc: 0.094 Test Loss: 3.360 Test Acc: 0.094
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 1.5351332
	speed: 0.1106s/iter; left time: 653.1104s
Epoch: 12 cost time: 4.988392114639282
Epoch: 12, Steps: 154 | Train Loss: 1.470 Vali Loss: 3.481 Vali Acc: 0.116 Test Loss: 3.481 Test Acc: 0.116
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 1.1291727
	speed: 0.1720s/iter; left time: 989.7547s
Epoch: 13 cost time: 8.75949764251709
Epoch: 13, Steps: 154 | Train Loss: 1.424 Vali Loss: 4.167 Vali Acc: 0.180 Test Loss: 4.167 Test Acc: 0.180
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 1.3307117
	speed: 0.1459s/iter; left time: 817.0134s
Epoch: 14 cost time: 7.244926929473877
Epoch: 14, Steps: 154 | Train Loss: 1.407 Vali Loss: 3.690 Vali Acc: 0.184 Test Loss: 3.690 Test Acc: 0.184
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 1.6399472
	speed: 0.2044s/iter; left time: 1112.8229s
Epoch: 15 cost time: 9.169031620025635
Epoch: 15, Steps: 154 | Train Loss: 1.378 Vali Loss: 4.276 Vali Acc: 0.186 Test Loss: 4.276 Test Acc: 0.186
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 1.4825746
	speed: 0.2147s/iter; left time: 1135.7606s
Epoch: 16 cost time: 10.269975900650024
Epoch: 16, Steps: 154 | Train Loss: 1.339 Vali Loss: 4.169 Vali Acc: 0.164 Test Loss: 4.169 Test Acc: 0.164
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 1.4074311
	speed: 0.1761s/iter; left time: 904.6166s
Epoch: 17 cost time: 8.04031229019165
Epoch: 17, Steps: 154 | Train Loss: 1.329 Vali Loss: 4.411 Vali Acc: 0.180 Test Loss: 4.411 Test Acc: 0.180
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el6_dm768_df768_ps6_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3523925385239254
model parameter : 43542542
model size : 180.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el6_dm768_df768_ps8_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0426152
	speed: 0.1127s/iter; left time: 856.6920s
Epoch: 1 cost time: 15.615064144134521
Epoch: 1, Steps: 154 | Train Loss: 2.135 Vali Loss: 2.169 Vali Acc: 0.320 Test Loss: 2.169 Test Acc: 0.320
Validation loss decreased (inf --> -0.319930).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.7493085
	speed: 0.2949s/iter; left time: 2196.4573s
Epoch: 2 cost time: 12.617984056472778
Epoch: 2, Steps: 154 | Train Loss: 2.024 Vali Loss: 2.258 Vali Acc: 0.326 Test Loss: 2.258 Test Acc: 0.326
Validation loss decreased (-0.319930 --> -0.326011).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.3568366
	speed: 0.3453s/iter; left time: 2518.1727s
Epoch: 3 cost time: 15.705250024795532
Epoch: 3, Steps: 154 | Train Loss: 1.967 Vali Loss: 2.189 Vali Acc: 0.327 Test Loss: 2.189 Test Acc: 0.327
Validation loss decreased (-0.326011 --> -0.327229).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.7379421
	speed: 0.3860s/iter; left time: 2755.8419s
Epoch: 4 cost time: 13.858231782913208
Epoch: 4, Steps: 154 | Train Loss: 1.865 Vali Loss: 2.474 Vali Acc: 0.330 Test Loss: 2.474 Test Acc: 0.330
Validation loss decreased (-0.327229 --> -0.330064).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.8417147
	speed: 0.3554s/iter; left time: 2482.8116s
Epoch: 5 cost time: 12.684847354888916
Epoch: 5, Steps: 154 | Train Loss: 1.797 Vali Loss: 2.478 Vali Acc: 0.337 Test Loss: 2.478 Test Acc: 0.337
Validation loss decreased (-0.330064 --> -0.336958).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.0216007
	speed: 0.3458s/iter; left time: 2362.1431s
Epoch: 6 cost time: 13.793449401855469
Epoch: 6, Steps: 154 | Train Loss: 1.719 Vali Loss: 3.506 Vali Acc: 0.100 Test Loss: 3.506 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.9536707
	speed: 0.2585s/iter; left time: 1725.8203s
Epoch: 7 cost time: 11.154118299484253
Epoch: 7, Steps: 154 | Train Loss: 1.631 Vali Loss: 3.572 Vali Acc: 0.174 Test Loss: 3.572 Test Acc: 0.174
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.9939648
	speed: 0.2516s/iter; left time: 1640.8667s
Epoch: 8 cost time: 11.898173093795776
Epoch: 8, Steps: 154 | Train Loss: 1.590 Vali Loss: 3.466 Vali Acc: 0.182 Test Loss: 3.466 Test Acc: 0.182
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 1.2417955
	speed: 0.2613s/iter; left time: 1664.3061s
Epoch: 9 cost time: 9.676106452941895
Epoch: 9, Steps: 154 | Train Loss: 1.525 Vali Loss: 4.031 Vali Acc: 0.173 Test Loss: 4.031 Test Acc: 0.173
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 1.2866105
	speed: 0.2714s/iter; left time: 1686.4429s
Epoch: 10 cost time: 12.201595544815063
Epoch: 10, Steps: 154 | Train Loss: 1.463 Vali Loss: 4.300 Vali Acc: 0.107 Test Loss: 4.300 Test Acc: 0.107
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 1.2807026
	speed: 0.2531s/iter; left time: 1533.8358s
Epoch: 11 cost time: 8.401743412017822
Epoch: 11, Steps: 154 | Train Loss: 1.431 Vali Loss: 3.849 Vali Acc: 0.106 Test Loss: 3.849 Test Acc: 0.106
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 1.0821536
	speed: 0.2031s/iter; left time: 1199.9288s
Epoch: 12 cost time: 8.822321891784668
Epoch: 12, Steps: 154 | Train Loss: 1.375 Vali Loss: 4.623 Vali Acc: 0.098 Test Loss: 4.623 Test Acc: 0.098
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 1.7297846
	speed: 0.2910s/iter; left time: 1674.3072s
Epoch: 13 cost time: 12.818594932556152
Epoch: 13, Steps: 154 | Train Loss: 1.350 Vali Loss: 4.498 Vali Acc: 0.104 Test Loss: 4.498 Test Acc: 0.104
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 1.5862454
	speed: 0.2096s/iter; left time: 1173.3403s
Epoch: 14 cost time: 9.561081886291504
Epoch: 14, Steps: 154 | Train Loss: 1.292 Vali Loss: 4.654 Vali Acc: 0.197 Test Loss: 4.654 Test Acc: 0.197
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 1.6384913
	speed: 0.2435s/iter; left time: 1325.6000s
Epoch: 15 cost time: 11.559835195541382
Epoch: 15, Steps: 154 | Train Loss: 1.247 Vali Loss: 4.519 Vali Acc: 0.136 Test Loss: 4.519 Test Acc: 0.136
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el6_dm768_df768_ps8_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.33698296836982966
model parameter : 43680782
model size : 181.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el6_dm768_df768_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.3081641
	speed: 0.0567s/iter; left time: 430.8368s
Epoch: 1 cost time: 8.181812047958374
Epoch: 1, Steps: 154 | Train Loss: 2.123 Vali Loss: 2.193 Vali Acc: 0.317 Test Loss: 2.193 Test Acc: 0.317
Validation loss decreased (inf --> -0.316685).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.2464278
	speed: 0.1076s/iter; left time: 801.0030s
Epoch: 2 cost time: 4.853693246841431
Epoch: 2, Steps: 154 | Train Loss: 2.010 Vali Loss: 2.432 Vali Acc: 0.323 Test Loss: 2.432 Test Acc: 0.323
Validation loss decreased (-0.316685 --> -0.322766).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.0211730
	speed: 0.2145s/iter; left time: 1564.1808s
Epoch: 3 cost time: 7.5289247035980225
Epoch: 3, Steps: 154 | Train Loss: 1.939 Vali Loss: 2.338 Vali Acc: 0.324 Test Loss: 2.338 Test Acc: 0.324
Validation loss decreased (-0.322766 --> -0.323578).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.5915425
	speed: 0.2898s/iter; left time: 2069.0702s
Epoch: 4 cost time: 4.618929147720337
Epoch: 4, Steps: 154 | Train Loss: 1.839 Vali Loss: 2.447 Vali Acc: 0.335 Test Loss: 2.447 Test Acc: 0.335
Validation loss decreased (-0.323578 --> -0.334931).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.6910614
	speed: 0.1699s/iter; left time: 1186.4218s
Epoch: 5 cost time: 6.383159399032593
Epoch: 5, Steps: 154 | Train Loss: 1.788 Vali Loss: 2.540 Vali Acc: 0.170 Test Loss: 2.540 Test Acc: 0.170
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 2.1009007
	speed: 0.1704s/iter; left time: 1163.9036s
Epoch: 6 cost time: 8.262104988098145
Epoch: 6, Steps: 154 | Train Loss: 1.701 Vali Loss: 2.708 Vali Acc: 0.165 Test Loss: 2.708 Test Acc: 0.165
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.6071078
	speed: 0.1779s/iter; left time: 1187.7988s
Epoch: 7 cost time: 7.377894878387451
Epoch: 7, Steps: 154 | Train Loss: 1.626 Vali Loss: 2.968 Vali Acc: 0.171 Test Loss: 2.968 Test Acc: 0.171
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 1.7527082
	speed: 0.1652s/iter; left time: 1077.4120s
Epoch: 8 cost time: 7.354822635650635
Epoch: 8, Steps: 154 | Train Loss: 1.583 Vali Loss: 3.261 Vali Acc: 0.176 Test Loss: 3.261 Test Acc: 0.176
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 1.7715422
	speed: 0.1615s/iter; left time: 1028.7357s
Epoch: 9 cost time: 5.436103820800781
Epoch: 9, Steps: 154 | Train Loss: 1.530 Vali Loss: 3.074 Vali Acc: 0.189 Test Loss: 3.074 Test Acc: 0.189
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 1.5144247
	speed: 0.0918s/iter; left time: 570.4703s
Epoch: 10 cost time: 4.698681831359863
Epoch: 10, Steps: 154 | Train Loss: 1.503 Vali Loss: 3.355 Vali Acc: 0.103 Test Loss: 3.355 Test Acc: 0.103
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 1.6129073
	speed: 0.1444s/iter; left time: 875.2819s
Epoch: 11 cost time: 7.085299968719482
Epoch: 11, Steps: 154 | Train Loss: 1.458 Vali Loss: 4.159 Vali Acc: 0.081 Test Loss: 4.159 Test Acc: 0.081
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 1.6890477
	speed: 0.1391s/iter; left time: 821.5063s
Epoch: 12 cost time: 5.676336050033569
Epoch: 12, Steps: 154 | Train Loss: 1.409 Vali Loss: 3.605 Vali Acc: 0.186 Test Loss: 3.605 Test Acc: 0.186
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 1.6077116
	speed: 0.1407s/iter; left time: 809.4156s
Epoch: 13 cost time: 6.312666416168213
Epoch: 13, Steps: 154 | Train Loss: 1.383 Vali Loss: 4.430 Vali Acc: 0.059 Test Loss: 4.430 Test Acc: 0.059
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 1.0787998
	speed: 0.1555s/iter; left time: 870.8533s
Epoch: 14 cost time: 7.881513833999634
Epoch: 14, Steps: 154 | Train Loss: 1.326 Vali Loss: 4.408 Vali Acc: 0.107 Test Loss: 4.408 Test Acc: 0.107
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el6_dm768_df768_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.33495539334955393
model parameter : 43594766
model size : 180.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           6                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el6_dm768_df768_ps8_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.3432889
	speed: 0.0510s/iter; left time: 387.8106s
Epoch: 1 cost time: 7.630733966827393
Epoch: 1, Steps: 154 | Train Loss: 2.162 Vali Loss: 2.163 Vali Acc: 0.318 Test Loss: 2.163 Test Acc: 0.318
Validation loss decreased (inf --> -0.317497).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.6923178
	speed: 0.1448s/iter; left time: 1078.1398s
Epoch: 2 cost time: 5.879299879074097
Epoch: 2, Steps: 154 | Train Loss: 2.018 Vali Loss: 2.143 Vali Acc: 0.320 Test Loss: 2.143 Test Acc: 0.320
Validation loss decreased (-0.317497 --> -0.319524).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9921443
	speed: 0.2611s/iter; left time: 1904.4426s
Epoch: 3 cost time: 5.865274429321289
Epoch: 3, Steps: 154 | Train Loss: 1.955 Vali Loss: 2.208 Vali Acc: 0.332 Test Loss: 2.208 Test Acc: 0.332
Validation loss decreased (-0.319524 --> -0.332095).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.5432162
	speed: 0.2375s/iter; left time: 1695.4358s
Epoch: 4 cost time: 7.063559293746948
Epoch: 4, Steps: 154 | Train Loss: 1.857 Vali Loss: 2.384 Vali Acc: 0.333 Test Loss: 2.384 Test Acc: 0.333
Validation loss decreased (-0.332095 --> -0.333309).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.8540742
	speed: 0.2188s/iter; left time: 1528.3141s
Epoch: 5 cost time: 5.077746629714966
Epoch: 5, Steps: 154 | Train Loss: 1.770 Vali Loss: 2.478 Vali Acc: 0.340 Test Loss: 2.478 Test Acc: 0.340
Validation loss decreased (-0.333309 --> -0.340202).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.7798885
	speed: 0.1765s/iter; left time: 1205.6316s
Epoch: 6 cost time: 7.263303995132446
Epoch: 6, Steps: 154 | Train Loss: 1.710 Vali Loss: 2.359 Vali Acc: 0.339 Test Loss: 2.359 Test Acc: 0.339
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 2.3214607
	speed: 0.1365s/iter; left time: 911.4943s
Epoch: 7 cost time: 6.11787748336792
Epoch: 7, Steps: 154 | Train Loss: 1.635 Vali Loss: 2.450 Vali Acc: 0.342 Test Loss: 2.450 Test Acc: 0.342
Validation loss decreased (-0.340202 --> -0.342230).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.4517115
	speed: 0.2250s/iter; left time: 1467.8432s
Epoch: 8 cost time: 7.7019548416137695
Epoch: 8, Steps: 154 | Train Loss: 1.589 Vali Loss: 2.740 Vali Acc: 0.169 Test Loss: 2.740 Test Acc: 0.169
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.0295922
	speed: 0.1694s/iter; left time: 1078.8599s
Epoch: 9 cost time: 8.069459915161133
Epoch: 9, Steps: 154 | Train Loss: 1.529 Vali Loss: 2.818 Vali Acc: 0.180 Test Loss: 2.818 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.2432454
	speed: 0.1578s/iter; left time: 980.4553s
Epoch: 10 cost time: 5.57924485206604
Epoch: 10, Steps: 154 | Train Loss: 1.507 Vali Loss: 3.004 Vali Acc: 0.171 Test Loss: 3.004 Test Acc: 0.171
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.2381169
	speed: 0.1267s/iter; left time: 767.6737s
Epoch: 11 cost time: 5.503567457199097
Epoch: 11, Steps: 154 | Train Loss: 1.468 Vali Loss: 3.044 Vali Acc: 0.132 Test Loss: 3.044 Test Acc: 0.132
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 1.7848474
	speed: 0.1007s/iter; left time: 594.6892s
Epoch: 12 cost time: 5.2130749225616455
Epoch: 12, Steps: 154 | Train Loss: 1.446 Vali Loss: 3.331 Vali Acc: 0.099 Test Loss: 3.331 Test Acc: 0.099
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 1.4505136
	speed: 0.1396s/iter; left time: 803.2496s
Epoch: 13 cost time: 6.897177696228027
Epoch: 13, Steps: 154 | Train Loss: 1.408 Vali Loss: 3.578 Vali Acc: 0.100 Test Loss: 3.578 Test Acc: 0.100
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 1.3459299
	speed: 0.1434s/iter; left time: 802.9465s
Epoch: 14 cost time: 5.745484352111816
Epoch: 14, Steps: 154 | Train Loss: 1.395 Vali Loss: 3.621 Vali Acc: 0.184 Test Loss: 3.621 Test Acc: 0.184
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.8736317
	speed: 0.1366s/iter; left time: 743.6809s
Epoch: 15 cost time: 5.239047527313232
Epoch: 15, Steps: 154 | Train Loss: 1.355 Vali Loss: 3.435 Vali Acc: 0.182 Test Loss: 3.435 Test Acc: 0.182
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 1.4955899
	speed: 0.1569s/iter; left time: 830.3488s
Epoch: 16 cost time: 7.249983072280884
Epoch: 16, Steps: 154 | Train Loss: 1.328 Vali Loss: 4.713 Vali Acc: 0.059 Test Loss: 4.713 Test Acc: 0.059
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 1.1997399
	speed: 0.1582s/iter; left time: 812.5449s
Epoch: 17 cost time: 6.0505406856536865
Epoch: 17, Steps: 154 | Train Loss: 1.336 Vali Loss: 4.473 Vali Acc: 0.100 Test Loss: 4.473 Test Acc: 0.100
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el6_dm768_df768_ps8_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3422546634225466
model parameter : 43545614
model size : 180.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el5_dm768_df768_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2575543
	speed: 0.1228s/iter; left time: 933.0797s
Epoch: 1 cost time: 19.74861478805542
Epoch: 1, Steps: 154 | Train Loss: 2.138 Vali Loss: 2.292 Vali Acc: 0.319 Test Loss: 2.292 Test Acc: 0.319
Validation loss decreased (inf --> -0.318712).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.7905273
	speed: 0.3477s/iter; left time: 2589.3982s
Epoch: 2 cost time: 16.58089804649353
Epoch: 2, Steps: 154 | Train Loss: 2.095 Vali Loss: 2.485 Vali Acc: 0.326 Test Loss: 2.485 Test Acc: 0.326
Validation loss decreased (-0.318712 --> -0.326415).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.0743659
	speed: 0.2715s/iter; left time: 1980.1830s
Epoch: 3 cost time: 9.491632461547852
Epoch: 3, Steps: 154 | Train Loss: 2.036 Vali Loss: 2.318 Vali Acc: 0.331 Test Loss: 2.318 Test Acc: 0.331
Validation loss decreased (-0.326415 --> -0.330877).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.6711124
	speed: 0.2135s/iter; left time: 1524.0994s
Epoch: 4 cost time: 10.583709955215454
Epoch: 4, Steps: 154 | Train Loss: 1.939 Vali Loss: 2.709 Vali Acc: 0.330 Test Loss: 2.709 Test Acc: 0.330
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.6014050
	speed: 0.2130s/iter; left time: 1487.6800s
Epoch: 5 cost time: 10.332587957382202
Epoch: 5, Steps: 154 | Train Loss: 1.914 Vali Loss: 2.526 Vali Acc: 0.333 Test Loss: 2.526 Test Acc: 0.333
Validation loss decreased (-0.330877 --> -0.333308).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.2669754
	speed: 0.2307s/iter; left time: 1575.8698s
Epoch: 6 cost time: 10.786947965621948
Epoch: 6, Steps: 154 | Train Loss: 1.789 Vali Loss: 2.886 Vali Acc: 0.337 Test Loss: 2.886 Test Acc: 0.337
Validation loss decreased (-0.333308 --> -0.337360).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.2833972
	speed: 0.2594s/iter; left time: 1731.7933s
Epoch: 7 cost time: 14.788194179534912
Epoch: 7, Steps: 154 | Train Loss: 1.715 Vali Loss: 2.829 Vali Acc: 0.350 Test Loss: 2.829 Test Acc: 0.350
Validation loss decreased (-0.337360 --> -0.349931).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.7412077
	speed: 0.2804s/iter; left time: 1829.2584s
Epoch: 8 cost time: 10.50264286994934
Epoch: 8, Steps: 154 | Train Loss: 1.636 Vali Loss: 3.008 Vali Acc: 0.359 Test Loss: 3.008 Test Acc: 0.359
Validation loss decreased (-0.349931 --> -0.359256).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.5559169
	speed: 0.2634s/iter; left time: 1677.7820s
Epoch: 9 cost time: 16.41574192047119
Epoch: 9, Steps: 154 | Train Loss: 1.597 Vali Loss: 3.322 Vali Acc: 0.097 Test Loss: 3.322 Test Acc: 0.097
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.7356291
	speed: 0.2960s/iter; left time: 1839.3838s
Epoch: 10 cost time: 14.248028993606567
Epoch: 10, Steps: 154 | Train Loss: 1.548 Vali Loss: 3.119 Vali Acc: 0.195 Test Loss: 3.119 Test Acc: 0.195
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.1931772
	speed: 0.3035s/iter; left time: 1839.4955s
Epoch: 11 cost time: 14.378243207931519
Epoch: 11, Steps: 154 | Train Loss: 1.447 Vali Loss: 3.574 Vali Acc: 0.191 Test Loss: 3.574 Test Acc: 0.191
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 2.1493845
	speed: 0.2004s/iter; left time: 1183.8894s
Epoch: 12 cost time: 8.189270257949829
Epoch: 12, Steps: 154 | Train Loss: 1.426 Vali Loss: 4.852 Vali Acc: 0.195 Test Loss: 4.852 Test Acc: 0.195
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 1.1592039
	speed: 0.2063s/iter; left time: 1186.8287s
Epoch: 13 cost time: 11.721168041229248
Epoch: 13, Steps: 154 | Train Loss: 1.438 Vali Loss: 3.697 Vali Acc: 0.207 Test Loss: 3.697 Test Acc: 0.207
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 1.2270710
	speed: 0.2173s/iter; left time: 1216.7815s
Epoch: 14 cost time: 14.428443431854248
Epoch: 14, Steps: 154 | Train Loss: 1.399 Vali Loss: 3.724 Vali Acc: 0.251 Test Loss: 3.724 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 1.6772268
	speed: 0.2956s/iter; left time: 1609.2724s
Epoch: 15 cost time: 15.757606267929077
Epoch: 15, Steps: 154 | Train Loss: 1.308 Vali Loss: 6.557 Vali Acc: 0.070 Test Loss: 6.557 Test Acc: 0.070
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 1.1879976
	speed: 0.2801s/iter; left time: 1482.2156s
Epoch: 16 cost time: 13.98672366142273
Epoch: 16, Steps: 154 | Train Loss: 1.304 Vali Loss: 5.216 Vali Acc: 0.079 Test Loss: 5.216 Test Acc: 0.079
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 1.6188418
	speed: 0.2090s/iter; left time: 1073.6741s
Epoch: 17 cost time: 9.113306999206543
Epoch: 17, Steps: 154 | Train Loss: 1.263 Vali Loss: 6.090 Vali Acc: 0.084 Test Loss: 6.090 Test Acc: 0.084
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 1.2357306
	speed: 0.2333s/iter; left time: 1162.5960s
Epoch: 18 cost time: 10.798646688461304
Epoch: 18, Steps: 154 | Train Loss: 1.231 Vali Loss: 8.174 Vali Acc: 0.081 Test Loss: 8.174 Test Acc: 0.081
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el5_dm768_df768_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.35928629359286296
model parameter : 36755726
model size : 154.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el5_dm768_df768_ps2_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2109334
	speed: 0.0990s/iter; left time: 752.8133s
Epoch: 1 cost time: 14.892555952072144
Epoch: 1, Steps: 154 | Train Loss: 2.138 Vali Loss: 2.208 Vali Acc: 0.136 Test Loss: 2.208 Test Acc: 0.136
Validation loss decreased (inf --> -0.135825).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.7819710
	speed: 0.2674s/iter; left time: 1991.2955s
Epoch: 2 cost time: 12.12814974784851
Epoch: 2, Steps: 154 | Train Loss: 2.056 Vali Loss: 2.334 Vali Acc: 0.323 Test Loss: 2.334 Test Acc: 0.323
Validation loss decreased (-0.135825 --> -0.323172).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.8038497
	speed: 0.2523s/iter; left time: 1839.8499s
Epoch: 3 cost time: 11.24683928489685
Epoch: 3, Steps: 154 | Train Loss: 1.995 Vali Loss: 2.238 Vali Acc: 0.176 Test Loss: 2.238 Test Acc: 0.176
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 2.1448400
	speed: 0.2249s/iter; left time: 1605.8801s
Epoch: 4 cost time: 13.507739782333374
Epoch: 4, Steps: 154 | Train Loss: 1.929 Vali Loss: 2.343 Vali Acc: 0.280 Test Loss: 2.343 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 1.7636542
	speed: 0.2193s/iter; left time: 1531.9915s
Epoch: 5 cost time: 12.27384066581726
Epoch: 5, Steps: 154 | Train Loss: 1.839 Vali Loss: 2.642 Vali Acc: 0.167 Test Loss: 2.642 Test Acc: 0.167
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 1.5339173
	speed: 0.2496s/iter; left time: 1704.7337s
Epoch: 6 cost time: 11.75660228729248
Epoch: 6, Steps: 154 | Train Loss: 1.798 Vali Loss: 2.958 Vali Acc: 0.304 Test Loss: 2.958 Test Acc: 0.304
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 2.3424647
	speed: 0.2515s/iter; left time: 1679.4211s
Epoch: 7 cost time: 13.344919204711914
Epoch: 7, Steps: 154 | Train Loss: 1.758 Vali Loss: 2.968 Vali Acc: 0.336 Test Loss: 2.968 Test Acc: 0.336
Validation loss decreased (-0.323172 --> -0.335737).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.7738389
	speed: 0.2847s/iter; left time: 1857.2525s
Epoch: 8 cost time: 10.64764404296875
Epoch: 8, Steps: 154 | Train Loss: 1.692 Vali Loss: 3.099 Vali Acc: 0.174 Test Loss: 3.099 Test Acc: 0.174
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.7187530
	speed: 0.1516s/iter; left time: 965.2315s
Epoch: 9 cost time: 6.389194011688232
Epoch: 9, Steps: 154 | Train Loss: 1.621 Vali Loss: 3.585 Vali Acc: 0.088 Test Loss: 3.585 Test Acc: 0.088
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.8086748
	speed: 0.1933s/iter; left time: 1201.2619s
Epoch: 10 cost time: 10.357474088668823
Epoch: 10, Steps: 154 | Train Loss: 1.593 Vali Loss: 3.375 Vali Acc: 0.181 Test Loss: 3.375 Test Acc: 0.181
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.8802997
	speed: 0.2262s/iter; left time: 1371.2353s
Epoch: 11 cost time: 7.613775014877319
Epoch: 11, Steps: 154 | Train Loss: 1.546 Vali Loss: 3.943 Vali Acc: 0.096 Test Loss: 3.943 Test Acc: 0.096
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 1.5036480
	speed: 0.1596s/iter; left time: 943.0370s
Epoch: 12 cost time: 10.383713245391846
Epoch: 12, Steps: 154 | Train Loss: 1.507 Vali Loss: 4.018 Vali Acc: 0.105 Test Loss: 4.018 Test Acc: 0.105
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 1.5143892
	speed: 0.1924s/iter; left time: 1106.7263s
Epoch: 13 cost time: 14.491084337234497
Epoch: 13, Steps: 154 | Train Loss: 1.457 Vali Loss: 4.252 Vali Acc: 0.055 Test Loss: 4.252 Test Acc: 0.055
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 1.7603918
	speed: 0.3014s/iter; left time: 1687.7939s
Epoch: 14 cost time: 13.99676775932312
Epoch: 14, Steps: 154 | Train Loss: 1.428 Vali Loss: 4.281 Vali Acc: 0.106 Test Loss: 4.281 Test Acc: 0.106
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 1.5124493
	speed: 0.2848s/iter; left time: 1550.6185s
Epoch: 15 cost time: 17.04523205757141
Epoch: 15, Steps: 154 | Train Loss: 1.398 Vali Loss: 4.129 Vali Acc: 0.054 Test Loss: 4.129 Test Acc: 0.054
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.7649904
	speed: 0.2815s/iter; left time: 1489.3872s
Epoch: 16 cost time: 11.740008354187012
Epoch: 16, Steps: 154 | Train Loss: 1.392 Vali Loss: 3.538 Vali Acc: 0.299 Test Loss: 3.538 Test Acc: 0.299
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 1.7241466
	speed: 0.2131s/iter; left time: 1094.6497s
Epoch: 17 cost time: 12.381789445877075
Epoch: 17, Steps: 154 | Train Loss: 1.341 Vali Loss: 4.545 Vali Acc: 0.187 Test Loss: 4.545 Test Acc: 0.187
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el5_dm768_df768_ps2_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3357664233576642
model parameter : 36546830
model size : 154.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el5_dm768_df768_ps3_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.6896265
	speed: 0.1382s/iter; left time: 1050.5073s
Epoch: 1 cost time: 19.8176007270813
Epoch: 1, Steps: 154 | Train Loss: 2.187 Vali Loss: 2.211 Vali Acc: 0.320 Test Loss: 2.211 Test Acc: 0.320
Validation loss decreased (inf --> -0.319929).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.1571906
	speed: 0.3370s/iter; left time: 2509.6547s
Epoch: 2 cost time: 16.999083042144775
Epoch: 2, Steps: 154 | Train Loss: 2.094 Vali Loss: 2.543 Vali Acc: 0.321 Test Loss: 2.543 Test Acc: 0.321
Validation loss decreased (-0.319929 --> -0.321142).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.2599730
	speed: 0.3370s/iter; left time: 2457.4929s
Epoch: 3 cost time: 16.709678888320923
Epoch: 3, Steps: 154 | Train Loss: 2.029 Vali Loss: 2.539 Vali Acc: 0.327 Test Loss: 2.539 Test Acc: 0.327
Validation loss decreased (-0.321142 --> -0.326820).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.8813516
	speed: 0.3140s/iter; left time: 2241.4627s
Epoch: 4 cost time: 12.177334308624268
Epoch: 4, Steps: 154 | Train Loss: 1.946 Vali Loss: 2.563 Vali Acc: 0.328 Test Loss: 2.563 Test Acc: 0.328
Validation loss decreased (-0.326820 --> -0.328036).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.9319957
	speed: 0.3245s/iter; left time: 2266.7118s
Epoch: 5 cost time: 14.401472330093384
Epoch: 5, Steps: 154 | Train Loss: 1.854 Vali Loss: 2.701 Vali Acc: 0.341 Test Loss: 2.701 Test Acc: 0.341
Validation loss decreased (-0.328036 --> -0.341011).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.8973532
	speed: 0.2310s/iter; left time: 1578.1576s
Epoch: 6 cost time: 8.185909986495972
Epoch: 6, Steps: 154 | Train Loss: 1.775 Vali Loss: 2.932 Vali Acc: 0.350 Test Loss: 2.932 Test Acc: 0.350
Validation loss decreased (-0.341011 --> -0.349525).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.4550877
	speed: 0.2977s/iter; left time: 1987.7674s
Epoch: 7 cost time: 13.569795846939087
Epoch: 7, Steps: 154 | Train Loss: 1.676 Vali Loss: 2.782 Vali Acc: 0.349 Test Loss: 2.782 Test Acc: 0.349
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.2935117
	speed: 0.2783s/iter; left time: 1815.4228s
Epoch: 8 cost time: 10.510854244232178
Epoch: 8, Steps: 154 | Train Loss: 1.630 Vali Loss: 3.101 Vali Acc: 0.367 Test Loss: 3.101 Test Acc: 0.367
Validation loss decreased (-0.349525 --> -0.367366).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.3712499
	speed: 0.2530s/iter; left time: 1611.1121s
Epoch: 9 cost time: 10.931804656982422
Epoch: 9, Steps: 154 | Train Loss: 1.576 Vali Loss: 4.129 Vali Acc: 0.188 Test Loss: 4.129 Test Acc: 0.188
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.2102430
	speed: 0.2353s/iter; left time: 1462.3037s
Epoch: 10 cost time: 13.77093243598938
Epoch: 10, Steps: 154 | Train Loss: 1.499 Vali Loss: 3.318 Vali Acc: 0.198 Test Loss: 3.318 Test Acc: 0.198
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.6771294
	speed: 0.2702s/iter; left time: 1637.8674s
Epoch: 11 cost time: 14.143473148345947
Epoch: 11, Steps: 154 | Train Loss: 1.467 Vali Loss: 4.320 Vali Acc: 0.201 Test Loss: 4.320 Test Acc: 0.201
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 1.0395657
	speed: 0.2999s/iter; left time: 1771.5211s
Epoch: 12 cost time: 14.74552607536316
Epoch: 12, Steps: 154 | Train Loss: 1.416 Vali Loss: 4.121 Vali Acc: 0.203 Test Loss: 4.121 Test Acc: 0.203
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.9394181
	speed: 0.2550s/iter; left time: 1467.2865s
Epoch: 13 cost time: 9.84739899635315
Epoch: 13, Steps: 154 | Train Loss: 1.406 Vali Loss: 4.516 Vali Acc: 0.191 Test Loss: 4.516 Test Acc: 0.191
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 1.4628967
	speed: 0.2995s/iter; left time: 1677.0454s
Epoch: 14 cost time: 15.182968139648438
Epoch: 14, Steps: 154 | Train Loss: 1.363 Vali Loss: 4.760 Vali Acc: 0.119 Test Loss: 4.760 Test Acc: 0.119
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.9229469
	speed: 0.2779s/iter; left time: 1513.2830s
Epoch: 15 cost time: 14.005003929138184
Epoch: 15, Steps: 154 | Train Loss: 1.312 Vali Loss: 5.025 Vali Acc: 0.093 Test Loss: 5.025 Test Acc: 0.093
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 1.2543160
	speed: 0.2604s/iter; left time: 1377.7189s
Epoch: 16 cost time: 11.985859870910645
Epoch: 16, Steps: 154 | Train Loss: 1.294 Vali Loss: 5.604 Vali Acc: 0.081 Test Loss: 5.604 Test Acc: 0.081
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 1.6305103
	speed: 0.2105s/iter; left time: 1081.1744s
Epoch: 17 cost time: 9.596049070358276
Epoch: 17, Steps: 154 | Train Loss: 1.233 Vali Loss: 4.841 Vali Acc: 0.086 Test Loss: 4.841 Test Acc: 0.086
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 1.5435578
	speed: 0.2342s/iter; left time: 1167.2219s
Epoch: 18 cost time: 12.512064218521118
Epoch: 18, Steps: 154 | Train Loss: 1.233 Vali Loss: 7.366 Vali Acc: 0.070 Test Loss: 7.366 Test Acc: 0.070
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el5_dm768_df768_ps3_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.36739659367396593
model parameter : 36757262
model size : 154.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el5_dm768_df768_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.7704048
	speed: 0.0792s/iter; left time: 602.0984s
Epoch: 1 cost time: 11.171712636947632
Epoch: 1, Steps: 154 | Train Loss: 2.117 Vali Loss: 2.423 Vali Acc: 0.317 Test Loss: 2.423 Test Acc: 0.317
Validation loss decreased (inf --> -0.316683).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.2631509
	speed: 0.2836s/iter; left time: 2111.7185s
Epoch: 2 cost time: 14.828496217727661
Epoch: 2, Steps: 154 | Train Loss: 2.057 Vali Loss: 2.294 Vali Acc: 0.326 Test Loss: 2.294 Test Acc: 0.326
Validation loss decreased (-0.316683 --> -0.326011).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.3214977
	speed: 0.3034s/iter; left time: 2212.7613s
Epoch: 3 cost time: 14.49785852432251
Epoch: 3, Steps: 154 | Train Loss: 2.012 Vali Loss: 2.223 Vali Acc: 0.328 Test Loss: 2.223 Test Acc: 0.328
Validation loss decreased (-0.326011 --> -0.328445).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.9714289
	speed: 0.2938s/iter; left time: 2097.1048s
Epoch: 4 cost time: 12.171342134475708
Epoch: 4, Steps: 154 | Train Loss: 1.895 Vali Loss: 2.474 Vali Acc: 0.338 Test Loss: 2.474 Test Acc: 0.338
Validation loss decreased (-0.328445 --> -0.337769).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.6699572
	speed: 0.2773s/iter; left time: 1936.7192s
Epoch: 5 cost time: 11.257550716400146
Epoch: 5, Steps: 154 | Train Loss: 1.841 Vali Loss: 2.292 Vali Acc: 0.344 Test Loss: 2.292 Test Acc: 0.344
Validation loss decreased (-0.337769 --> -0.343854).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.1828845
	speed: 0.1813s/iter; left time: 1238.7023s
Epoch: 6 cost time: 4.99957013130188
Epoch: 6, Steps: 154 | Train Loss: 1.763 Vali Loss: 2.708 Vali Acc: 0.173 Test Loss: 2.708 Test Acc: 0.173
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.1181328
	speed: 0.1274s/iter; left time: 850.9057s
Epoch: 7 cost time: 6.367353916168213
Epoch: 7, Steps: 154 | Train Loss: 1.701 Vali Loss: 2.874 Vali Acc: 0.178 Test Loss: 2.874 Test Acc: 0.178
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.1954659
	speed: 0.1608s/iter; left time: 1048.6573s
Epoch: 8 cost time: 7.468463897705078
Epoch: 8, Steps: 154 | Train Loss: 1.606 Vali Loss: 2.822 Vali Acc: 0.181 Test Loss: 2.822 Test Acc: 0.181
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 1.4149343
	speed: 0.1487s/iter; left time: 946.8972s
Epoch: 9 cost time: 7.5432703495025635
Epoch: 9, Steps: 154 | Train Loss: 1.637 Vali Loss: 2.980 Vali Acc: 0.133 Test Loss: 2.980 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 1.6652122
	speed: 0.1052s/iter; left time: 654.0508s
Epoch: 10 cost time: 6.792680740356445
Epoch: 10, Steps: 154 | Train Loss: 1.549 Vali Loss: 3.487 Vali Acc: 0.192 Test Loss: 3.487 Test Acc: 0.192
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 1.6434494
	speed: 0.1788s/iter; left time: 1083.9879s
Epoch: 11 cost time: 4.996578931808472
Epoch: 11, Steps: 154 | Train Loss: 1.518 Vali Loss: 3.096 Vali Acc: 0.334 Test Loss: 3.096 Test Acc: 0.334
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 1.0696359
	speed: 0.1693s/iter; left time: 1000.3052s
Epoch: 12 cost time: 8.263749599456787
Epoch: 12, Steps: 154 | Train Loss: 1.470 Vali Loss: 4.400 Vali Acc: 0.189 Test Loss: 4.400 Test Acc: 0.189
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 1.5653580
	speed: 0.1994s/iter; left time: 1147.0320s
Epoch: 13 cost time: 11.476067781448364
Epoch: 13, Steps: 154 | Train Loss: 1.430 Vali Loss: 3.846 Vali Acc: 0.184 Test Loss: 3.846 Test Acc: 0.184
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.9675385
	speed: 0.2436s/iter; left time: 1363.8703s
Epoch: 14 cost time: 11.822458505630493
Epoch: 14, Steps: 154 | Train Loss: 1.423 Vali Loss: 4.660 Vali Acc: 0.197 Test Loss: 4.660 Test Acc: 0.197
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 1.6944305
	speed: 0.1569s/iter; left time: 854.2576s
Epoch: 15 cost time: 7.898033142089844
Epoch: 15, Steps: 154 | Train Loss: 1.381 Vali Loss: 4.352 Vali Acc: 0.172 Test Loss: 4.352 Test Acc: 0.172
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el5_dm768_df768_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.34387672343876724
model parameter : 36548366
model size : 154.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el5_dm768_df768_ps3_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.4875840
	speed: 0.0751s/iter; left time: 570.5854s
Epoch: 1 cost time: 9.848155975341797
Epoch: 1, Steps: 154 | Train Loss: 2.126 Vali Loss: 2.193 Vali Acc: 0.324 Test Loss: 2.193 Test Acc: 0.324
Validation loss decreased (inf --> -0.323579).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8222219
	speed: 0.1041s/iter; left time: 775.0511s
Epoch: 2 cost time: 3.790512800216675
Epoch: 2, Steps: 154 | Train Loss: 2.038 Vali Loss: 2.305 Vali Acc: 0.165 Test Loss: 2.305 Test Acc: 0.165
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.9359016
	speed: 0.1470s/iter; left time: 1071.7958s
Epoch: 3 cost time: 8.500895500183105
Epoch: 3, Steps: 154 | Train Loss: 1.975 Vali Loss: 2.333 Vali Acc: 0.322 Test Loss: 2.333 Test Acc: 0.322
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 1.6961955
	speed: 0.1899s/iter; left time: 1356.0140s
Epoch: 4 cost time: 6.615599632263184
Epoch: 4, Steps: 154 | Train Loss: 1.907 Vali Loss: 2.482 Vali Acc: 0.328 Test Loss: 2.482 Test Acc: 0.328
Validation loss decreased (-0.323579 --> -0.328037).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.5516371
	speed: 0.1948s/iter; left time: 1360.3681s
Epoch: 5 cost time: 9.422330379486084
Epoch: 5, Steps: 154 | Train Loss: 1.826 Vali Loss: 2.569 Vali Acc: 0.334 Test Loss: 2.569 Test Acc: 0.334
Validation loss decreased (-0.328037 --> -0.333713).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.4135214
	speed: 0.2348s/iter; left time: 1603.9504s
Epoch: 6 cost time: 8.340391159057617
Epoch: 6, Steps: 154 | Train Loss: 1.754 Vali Loss: 2.706 Vali Acc: 0.356 Test Loss: 2.706 Test Acc: 0.356
Validation loss decreased (-0.333713 --> -0.355610).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.3625031
	speed: 0.2276s/iter; left time: 1519.6788s
Epoch: 7 cost time: 8.597092866897583
Epoch: 7, Steps: 154 | Train Loss: 1.690 Vali Loss: 2.625 Vali Acc: 0.356 Test Loss: 2.625 Test Acc: 0.356
Validation loss decreased (-0.355610 --> -0.356421).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.9857594
	speed: 0.1574s/iter; left time: 1026.5651s
Epoch: 8 cost time: 4.896613836288452
Epoch: 8, Steps: 154 | Train Loss: 1.664 Vali Loss: 2.840 Vali Acc: 0.099 Test Loss: 2.840 Test Acc: 0.099
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.3880240
	speed: 0.1143s/iter; left time: 727.8188s
Epoch: 9 cost time: 4.6390228271484375
Epoch: 9, Steps: 154 | Train Loss: 1.623 Vali Loss: 2.726 Vali Acc: 0.192 Test Loss: 2.726 Test Acc: 0.192
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 2.0358679
	speed: 0.1164s/iter; left time: 723.6309s
Epoch: 10 cost time: 6.7159624099731445
Epoch: 10, Steps: 154 | Train Loss: 1.589 Vali Loss: 3.130 Vali Acc: 0.165 Test Loss: 3.130 Test Acc: 0.165
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.6388350
	speed: 0.1615s/iter; left time: 978.7318s
Epoch: 11 cost time: 7.123273134231567
Epoch: 11, Steps: 154 | Train Loss: 1.527 Vali Loss: 3.391 Vali Acc: 0.138 Test Loss: 3.391 Test Acc: 0.138
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 1.4202940
	speed: 0.2041s/iter; left time: 1205.8905s
Epoch: 12 cost time: 9.468502283096313
Epoch: 12, Steps: 154 | Train Loss: 1.491 Vali Loss: 3.626 Vali Acc: 0.102 Test Loss: 3.626 Test Acc: 0.102
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 1.0224226
	speed: 0.1589s/iter; left time: 914.3360s
Epoch: 13 cost time: 8.167072534561157
Epoch: 13, Steps: 154 | Train Loss: 1.475 Vali Loss: 3.072 Vali Acc: 0.120 Test Loss: 3.072 Test Acc: 0.120
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 1.0971525
	speed: 0.1619s/iter; left time: 906.6848s
Epoch: 14 cost time: 8.460254430770874
Epoch: 14, Steps: 154 | Train Loss: 1.433 Vali Loss: 3.208 Vali Acc: 0.168 Test Loss: 3.208 Test Acc: 0.168
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 1.1022824
	speed: 0.1811s/iter; left time: 986.3252s
Epoch: 15 cost time: 4.9814252853393555
Epoch: 15, Steps: 154 | Train Loss: 1.402 Vali Loss: 4.270 Vali Acc: 0.064 Test Loss: 4.270 Test Acc: 0.064
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 1.7842520
	speed: 0.1888s/iter; left time: 999.0198s
Epoch: 16 cost time: 7.97473669052124
Epoch: 16, Steps: 154 | Train Loss: 1.385 Vali Loss: 3.525 Vali Acc: 0.131 Test Loss: 3.525 Test Acc: 0.131
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 1.9048382
	speed: 0.2174s/iter; left time: 1116.8129s
Epoch: 17 cost time: 8.787698984146118
Epoch: 17, Steps: 154 | Train Loss: 1.352 Vali Loss: 3.802 Vali Acc: 0.070 Test Loss: 3.802 Test Acc: 0.070
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el5_dm768_df768_ps3_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3564476885644769
model parameter : 36486926
model size : 153.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el5_dm768_df768_ps4_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.7873440
	speed: 0.0852s/iter; left time: 647.3712s
Epoch: 1 cost time: 11.867381572723389
Epoch: 1, Steps: 154 | Train Loss: 2.204 Vali Loss: 2.194 Vali Acc: 0.330 Test Loss: 2.194 Test Acc: 0.330
Validation loss decreased (inf --> -0.330067).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.6228189
	speed: 0.2354s/iter; left time: 1752.7645s
Epoch: 2 cost time: 15.752771854400635
Epoch: 2, Steps: 154 | Train Loss: 2.110 Vali Loss: 2.298 Vali Acc: 0.169 Test Loss: 2.298 Test Acc: 0.169
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.9528304
	speed: 0.2889s/iter; left time: 2107.1234s
Epoch: 3 cost time: 15.304564714431763
Epoch: 3, Steps: 154 | Train Loss: 2.025 Vali Loss: 2.749 Vali Acc: 0.332 Test Loss: 2.749 Test Acc: 0.332
Validation loss decreased (-0.330067 --> -0.331684).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.6108027
	speed: 0.3378s/iter; left time: 2411.7361s
Epoch: 4 cost time: 11.889937400817871
Epoch: 4, Steps: 154 | Train Loss: 1.912 Vali Loss: 2.736 Vali Acc: 0.333 Test Loss: 2.736 Test Acc: 0.333
Validation loss decreased (-0.331684 --> -0.332495).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.9200953
	speed: 0.3222s/iter; left time: 2250.2653s
Epoch: 5 cost time: 15.540441274642944
Epoch: 5, Steps: 154 | Train Loss: 1.804 Vali Loss: 2.874 Vali Acc: 0.334 Test Loss: 2.874 Test Acc: 0.334
Validation loss decreased (-0.332495 --> -0.333710).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.6827792
	speed: 0.3251s/iter; left time: 2220.8418s
Epoch: 6 cost time: 13.02448558807373
Epoch: 6, Steps: 154 | Train Loss: 1.760 Vali Loss: 3.015 Vali Acc: 0.216 Test Loss: 3.015 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.8429747
	speed: 0.2482s/iter; left time: 1657.2715s
Epoch: 7 cost time: 11.853278636932373
Epoch: 7, Steps: 154 | Train Loss: 1.760 Vali Loss: 2.997 Vali Acc: 0.087 Test Loss: 2.997 Test Acc: 0.087
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.6910300
	speed: 0.2449s/iter; left time: 1597.4556s
Epoch: 8 cost time: 14.773554563522339
Epoch: 8, Steps: 154 | Train Loss: 1.609 Vali Loss: 3.203 Vali Acc: 0.336 Test Loss: 3.203 Test Acc: 0.336
Validation loss decreased (-0.333710 --> -0.335734).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.6265155
	speed: 0.2962s/iter; left time: 1886.4257s
Epoch: 9 cost time: 11.528101444244385
Epoch: 9, Steps: 154 | Train Loss: 1.542 Vali Loss: 3.154 Vali Acc: 0.179 Test Loss: 3.154 Test Acc: 0.179
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.8126302
	speed: 0.2888s/iter; left time: 1795.1828s
Epoch: 10 cost time: 14.558177947998047
Epoch: 10, Steps: 154 | Train Loss: 1.497 Vali Loss: 2.931 Vali Acc: 0.361 Test Loss: 2.931 Test Acc: 0.361
Validation loss decreased (-0.335734 --> -0.361285).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.1090026
	speed: 0.3912s/iter; left time: 2371.3463s
Epoch: 11 cost time: 12.304437398910522
Epoch: 11, Steps: 154 | Train Loss: 1.453 Vali Loss: 3.675 Vali Acc: 0.192 Test Loss: 3.675 Test Acc: 0.192
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.0905757
	speed: 0.3177s/iter; left time: 1876.7463s
Epoch: 12 cost time: 17.41199231147766
Epoch: 12, Steps: 154 | Train Loss: 1.392 Vali Loss: 4.652 Vali Acc: 0.114 Test Loss: 4.652 Test Acc: 0.114
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.2281734
	speed: 0.3299s/iter; left time: 1898.0063s
Epoch: 13 cost time: 15.939055442810059
Epoch: 13, Steps: 154 | Train Loss: 1.376 Vali Loss: 3.929 Vali Acc: 0.125 Test Loss: 3.929 Test Acc: 0.125
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 1.2939534
	speed: 0.3022s/iter; left time: 1692.0896s
Epoch: 14 cost time: 13.132189273834229
Epoch: 14, Steps: 154 | Train Loss: 1.307 Vali Loss: 4.727 Vali Acc: 0.069 Test Loss: 4.727 Test Acc: 0.069
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 2.3107326
	speed: 0.3250s/iter; left time: 1769.8065s
Epoch: 15 cost time: 15.613363265991211
Epoch: 15, Steps: 154 | Train Loss: 1.344 Vali Loss: 4.748 Vali Acc: 0.075 Test Loss: 4.748 Test Acc: 0.075
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 1.4322778
	speed: 0.3161s/iter; left time: 1672.5004s
Epoch: 16 cost time: 16.655646562576294
Epoch: 16, Steps: 154 | Train Loss: 1.321 Vali Loss: 4.594 Vali Acc: 0.123 Test Loss: 4.594 Test Acc: 0.123
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 1.5075610
	speed: 0.3036s/iter; left time: 1559.6058s
Epoch: 17 cost time: 15.593809366226196
Epoch: 17, Steps: 154 | Train Loss: 1.262 Vali Loss: 4.120 Vali Acc: 0.121 Test Loss: 4.120 Test Acc: 0.121
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 1.3342654
	speed: 0.2617s/iter; left time: 1303.9711s
Epoch: 18 cost time: 10.579991102218628
Epoch: 18, Steps: 154 | Train Loss: 1.244 Vali Loss: 4.218 Vali Acc: 0.213 Test Loss: 4.218 Test Acc: 0.213
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.9704556
	speed: 0.2178s/iter; left time: 1051.9761s
Epoch: 19 cost time: 12.746886968612671
Epoch: 19, Steps: 154 | Train Loss: 1.191 Vali Loss: 4.019 Vali Acc: 0.190 Test Loss: 4.019 Test Acc: 0.190
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.5049278
	speed: 0.2208s/iter; left time: 1032.3131s
Epoch: 20 cost time: 6.705036640167236
Epoch: 20, Steps: 154 | Train Loss: 1.158 Vali Loss: 4.771 Vali Acc: 0.085 Test Loss: 4.771 Test Acc: 0.085
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el5_dm768_df768_ps4_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3613138686131387
model parameter : 36758798
model size : 154.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el5_dm768_df768_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.6095723
	speed: 0.1083s/iter; left time: 823.4087s
Epoch: 1 cost time: 14.47040319442749
Epoch: 1, Steps: 154 | Train Loss: 2.128 Vali Loss: 2.271 Vali Acc: 0.320 Test Loss: 2.271 Test Acc: 0.320
Validation loss decreased (inf --> -0.319523).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8725935
	speed: 0.2308s/iter; left time: 1719.0150s
Epoch: 2 cost time: 14.014665842056274
Epoch: 2, Steps: 154 | Train Loss: 2.045 Vali Loss: 2.121 Vali Acc: 0.324 Test Loss: 2.121 Test Acc: 0.324
Validation loss decreased (-0.319523 --> -0.323580).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.1355925
	speed: 0.2724s/iter; left time: 1986.6801s
Epoch: 3 cost time: 12.246774911880493
Epoch: 3, Steps: 154 | Train Loss: 1.980 Vali Loss: 2.435 Vali Acc: 0.328 Test Loss: 2.435 Test Acc: 0.328
Validation loss decreased (-0.323580 --> -0.328037).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.8342626
	speed: 0.3197s/iter; left time: 2282.5956s
Epoch: 4 cost time: 14.135127782821655
Epoch: 4, Steps: 154 | Train Loss: 1.898 Vali Loss: 2.525 Vali Acc: 0.330 Test Loss: 2.525 Test Acc: 0.330
Validation loss decreased (-0.328037 --> -0.330469).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.0134048
	speed: 0.2665s/iter; left time: 1861.5711s
Epoch: 5 cost time: 13.52145004272461
Epoch: 5, Steps: 154 | Train Loss: 1.827 Vali Loss: 2.495 Vali Acc: 0.332 Test Loss: 2.495 Test Acc: 0.332
Validation loss decreased (-0.330469 --> -0.331686).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.7666860
	speed: 0.3147s/iter; left time: 2149.4850s
Epoch: 6 cost time: 15.066931009292603
Epoch: 6, Steps: 154 | Train Loss: 1.734 Vali Loss: 2.938 Vali Acc: 0.340 Test Loss: 2.938 Test Acc: 0.340
Validation loss decreased (-0.331686 --> -0.340198).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.8769246
	speed: 0.3023s/iter; left time: 2018.6506s
Epoch: 7 cost time: 13.617759466171265
Epoch: 7, Steps: 154 | Train Loss: 1.683 Vali Loss: 2.705 Vali Acc: 0.238 Test Loss: 2.705 Test Acc: 0.238
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 2.1934149
	speed: 0.2131s/iter; left time: 1389.7736s
Epoch: 8 cost time: 8.75648307800293
Epoch: 8, Steps: 154 | Train Loss: 1.614 Vali Loss: 3.634 Vali Acc: 0.045 Test Loss: 3.634 Test Acc: 0.045
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.8549774
	speed: 0.1891s/iter; left time: 1204.3599s
Epoch: 9 cost time: 9.707713603973389
Epoch: 9, Steps: 154 | Train Loss: 1.572 Vali Loss: 3.785 Vali Acc: 0.094 Test Loss: 3.785 Test Acc: 0.094
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.6409032
	speed: 0.1936s/iter; left time: 1203.5076s
Epoch: 10 cost time: 10.200745344161987
Epoch: 10, Steps: 154 | Train Loss: 1.505 Vali Loss: 4.564 Vali Acc: 0.103 Test Loss: 4.564 Test Acc: 0.103
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 1.7048720
	speed: 0.2729s/iter; left time: 1654.0298s
Epoch: 11 cost time: 12.983362674713135
Epoch: 11, Steps: 154 | Train Loss: 1.473 Vali Loss: 4.131 Vali Acc: 0.098 Test Loss: 4.131 Test Acc: 0.098
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 1.3638599
	speed: 0.1655s/iter; left time: 977.7010s
Epoch: 12 cost time: 5.2652270793914795
Epoch: 12, Steps: 154 | Train Loss: 1.430 Vali Loss: 4.434 Vali Acc: 0.125 Test Loss: 4.434 Test Acc: 0.125
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.9835499
	speed: 0.2021s/iter; left time: 1162.7174s
Epoch: 13 cost time: 10.143078804016113
Epoch: 13, Steps: 154 | Train Loss: 1.363 Vali Loss: 4.404 Vali Acc: 0.126 Test Loss: 4.404 Test Acc: 0.126
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 1.5152985
	speed: 0.1348s/iter; left time: 754.9257s
Epoch: 14 cost time: 6.5453526973724365
Epoch: 14, Steps: 154 | Train Loss: 1.351 Vali Loss: 5.077 Vali Acc: 0.187 Test Loss: 5.077 Test Acc: 0.187
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 1.2765981
	speed: 0.2103s/iter; left time: 1145.3464s
Epoch: 15 cost time: 10.274803400039673
Epoch: 15, Steps: 154 | Train Loss: 1.293 Vali Loss: 4.702 Vali Acc: 0.090 Test Loss: 4.702 Test Acc: 0.090
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.9142726
	speed: 0.2518s/iter; left time: 1332.4947s
Epoch: 16 cost time: 12.1763334274292
Epoch: 16, Steps: 154 | Train Loss: 1.263 Vali Loss: 4.725 Vali Acc: 0.202 Test Loss: 4.725 Test Acc: 0.202
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el5_dm768_df768_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3402270884022709
model parameter : 36562190
model size : 154.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el5_dm768_df768_ps4_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.8193383
	speed: 0.0472s/iter; left time: 358.9325s
Epoch: 1 cost time: 6.424994468688965
Epoch: 1, Steps: 154 | Train Loss: 2.114 Vali Loss: 2.171 Vali Acc: 0.319 Test Loss: 2.171 Test Acc: 0.319
Validation loss decreased (inf --> -0.318713).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0292821
	speed: 0.1114s/iter; left time: 829.6981s
Epoch: 2 cost time: 5.165510892868042
Epoch: 2, Steps: 154 | Train Loss: 2.032 Vali Loss: 2.131 Vali Acc: 0.328 Test Loss: 2.131 Test Acc: 0.328
Validation loss decreased (-0.318713 --> -0.327635).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9549078
	speed: 0.1442s/iter; left time: 1051.7031s
Epoch: 3 cost time: 6.0164594650268555
Epoch: 3, Steps: 154 | Train Loss: 1.953 Vali Loss: 2.243 Vali Acc: 0.326 Test Loss: 2.243 Test Acc: 0.326
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 2.1563535
	speed: 0.1339s/iter; left time: 955.5738s
Epoch: 4 cost time: 5.802156448364258
Epoch: 4, Steps: 154 | Train Loss: 1.899 Vali Loss: 2.665 Vali Acc: 0.326 Test Loss: 2.665 Test Acc: 0.326
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 1.3881440
	speed: 0.1389s/iter; left time: 969.9430s
Epoch: 5 cost time: 6.568142890930176
Epoch: 5, Steps: 154 | Train Loss: 1.811 Vali Loss: 2.673 Vali Acc: 0.330 Test Loss: 2.673 Test Acc: 0.330
Validation loss decreased (-0.327635 --> -0.330062).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.7960104
	speed: 0.1526s/iter; left time: 1042.0764s
Epoch: 6 cost time: 6.578665494918823
Epoch: 6, Steps: 154 | Train Loss: 1.744 Vali Loss: 2.645 Vali Acc: 0.340 Test Loss: 2.645 Test Acc: 0.340
Validation loss decreased (-0.330062 --> -0.340201).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.1142950
	speed: 0.1803s/iter; left time: 1203.6069s
Epoch: 7 cost time: 5.789108037948608
Epoch: 7, Steps: 154 | Train Loss: 1.683 Vali Loss: 2.580 Vali Acc: 0.333 Test Loss: 2.580 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.4015058
	speed: 0.1517s/iter; left time: 989.3230s
Epoch: 8 cost time: 6.368650913238525
Epoch: 8, Steps: 154 | Train Loss: 1.618 Vali Loss: 2.938 Vali Acc: 0.340 Test Loss: 2.938 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.2921152
	speed: 0.1210s/iter; left time: 770.6019s
Epoch: 9 cost time: 5.008993625640869
Epoch: 9, Steps: 154 | Train Loss: 1.612 Vali Loss: 2.780 Vali Acc: 0.339 Test Loss: 2.780 Test Acc: 0.339
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.2504050
	speed: 0.1072s/iter; left time: 665.9508s
Epoch: 10 cost time: 4.511254787445068
Epoch: 10, Steps: 154 | Train Loss: 1.529 Vali Loss: 2.960 Vali Acc: 0.357 Test Loss: 2.960 Test Acc: 0.357
Validation loss decreased (-0.340201 --> -0.357229).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.5626146
	speed: 0.1379s/iter; left time: 835.8606s
Epoch: 11 cost time: 4.548581123352051
Epoch: 11, Steps: 154 | Train Loss: 1.494 Vali Loss: 3.442 Vali Acc: 0.184 Test Loss: 3.442 Test Acc: 0.184
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.5148708
	speed: 0.1052s/iter; left time: 621.2401s
Epoch: 12 cost time: 4.860948324203491
Epoch: 12, Steps: 154 | Train Loss: 1.474 Vali Loss: 3.383 Vali Acc: 0.186 Test Loss: 3.383 Test Acc: 0.186
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.9893261
	speed: 0.1154s/iter; left time: 663.8578s
Epoch: 13 cost time: 4.07351016998291
Epoch: 13, Steps: 154 | Train Loss: 1.437 Vali Loss: 4.402 Vali Acc: 0.105 Test Loss: 4.402 Test Acc: 0.105
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 1.1899881
	speed: 0.1288s/iter; left time: 721.1697s
Epoch: 14 cost time: 5.651899576187134
Epoch: 14, Steps: 154 | Train Loss: 1.409 Vali Loss: 3.761 Vali Acc: 0.107 Test Loss: 3.761 Test Acc: 0.107
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 1.3250697
	speed: 0.1267s/iter; left time: 689.6676s
Epoch: 15 cost time: 5.625524282455444
Epoch: 15, Steps: 154 | Train Loss: 1.383 Vali Loss: 4.066 Vali Acc: 0.109 Test Loss: 4.066 Test Acc: 0.109
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 1.5485191
	speed: 0.1408s/iter; left time: 745.0233s
Epoch: 16 cost time: 6.168042421340942
Epoch: 16, Steps: 154 | Train Loss: 1.372 Vali Loss: 4.508 Vali Acc: 0.196 Test Loss: 4.508 Test Acc: 0.196
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 1.2876558
	speed: 0.1130s/iter; left time: 580.3353s
Epoch: 17 cost time: 4.949041128158569
Epoch: 17, Steps: 154 | Train Loss: 1.325 Vali Loss: 3.985 Vali Acc: 0.178 Test Loss: 3.985 Test Acc: 0.178
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 1.6257830
	speed: 0.1155s/iter; left time: 575.3961s
Epoch: 18 cost time: 4.397704601287842
Epoch: 18, Steps: 154 | Train Loss: 1.296 Vali Loss: 3.928 Vali Acc: 0.196 Test Loss: 3.928 Test Acc: 0.196
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 1.0433540
	speed: 0.1028s/iter; left time: 496.5977s
Epoch: 19 cost time: 4.877740859985352
Epoch: 19, Steps: 154 | Train Loss: 1.282 Vali Loss: 3.943 Vali Acc: 0.105 Test Loss: 3.943 Test Acc: 0.105
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 1.5625064
	speed: 0.0944s/iter; left time: 441.4729s
Epoch: 20 cost time: 3.936720609664917
Epoch: 20, Steps: 154 | Train Loss: 1.255 Vali Loss: 4.494 Vali Acc: 0.065 Test Loss: 4.494 Test Acc: 0.065
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el5_dm768_df768_ps4_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3572587185725872
model parameter : 36463886
model size : 153.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el5_dm768_df768_ps5_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.8447702
	speed: 0.0732s/iter; left time: 556.2909s
Epoch: 1 cost time: 10.614583969116211
Epoch: 1, Steps: 154 | Train Loss: 2.121 Vali Loss: 2.278 Vali Acc: 0.321 Test Loss: 2.278 Test Acc: 0.321
Validation loss decreased (inf --> -0.321145).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.5530548
	speed: 0.1558s/iter; left time: 1160.0467s
Epoch: 2 cost time: 6.6468119621276855
Epoch: 2, Steps: 154 | Train Loss: 2.020 Vali Loss: 2.211 Vali Acc: 0.327 Test Loss: 2.211 Test Acc: 0.327
Validation loss decreased (-0.321145 --> -0.326823).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.0873744
	speed: 0.1757s/iter; left time: 1281.2473s
Epoch: 3 cost time: 8.21229600906372
Epoch: 3, Steps: 154 | Train Loss: 1.940 Vali Loss: 2.399 Vali Acc: 0.333 Test Loss: 2.399 Test Acc: 0.333
Validation loss decreased (-0.326823 --> -0.332904).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.4351578
	speed: 0.1747s/iter; left time: 1247.0439s
Epoch: 4 cost time: 9.625530004501343
Epoch: 4, Steps: 154 | Train Loss: 1.843 Vali Loss: 2.862 Vali Acc: 0.334 Test Loss: 2.862 Test Acc: 0.334
Validation loss decreased (-0.332904 --> -0.333710).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.4484847
	speed: 0.1902s/iter; left time: 1328.8382s
Epoch: 5 cost time: 8.20045256614685
Epoch: 5, Steps: 154 | Train Loss: 1.754 Vali Loss: 2.558 Vali Acc: 0.335 Test Loss: 2.558 Test Acc: 0.335
Validation loss decreased (-0.333710 --> -0.334524).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.8825831
	speed: 0.1634s/iter; left time: 1116.2914s
Epoch: 6 cost time: 7.626783609390259
Epoch: 6, Steps: 154 | Train Loss: 1.713 Vali Loss: 2.813 Vali Acc: 0.350 Test Loss: 2.813 Test Acc: 0.350
Validation loss decreased (-0.334524 --> -0.350337).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.6195067
	speed: 0.2089s/iter; left time: 1394.7145s
Epoch: 7 cost time: 7.515242099761963
Epoch: 7, Steps: 154 | Train Loss: 1.611 Vali Loss: 3.068 Vali Acc: 0.352 Test Loss: 3.068 Test Acc: 0.352
Validation loss decreased (-0.350337 --> -0.351551).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.6600025
	speed: 0.2340s/iter; left time: 1526.2343s
Epoch: 8 cost time: 10.963651895523071
Epoch: 8, Steps: 154 | Train Loss: 1.607 Vali Loss: 3.247 Vali Acc: 0.173 Test Loss: 3.247 Test Acc: 0.173
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.3622932
	speed: 0.1620s/iter; left time: 1032.0932s
Epoch: 9 cost time: 8.042754411697388
Epoch: 9, Steps: 154 | Train Loss: 1.542 Vali Loss: 3.553 Vali Acc: 0.101 Test Loss: 3.553 Test Acc: 0.101
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.0604608
	speed: 0.1631s/iter; left time: 1013.7716s
Epoch: 10 cost time: 7.710319519042969
Epoch: 10, Steps: 154 | Train Loss: 1.501 Vali Loss: 3.842 Vali Acc: 0.193 Test Loss: 3.842 Test Acc: 0.193
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.2468054
	speed: 0.1656s/iter; left time: 1003.8659s
Epoch: 11 cost time: 7.39818811416626
Epoch: 11, Steps: 154 | Train Loss: 1.464 Vali Loss: 3.977 Vali Acc: 0.189 Test Loss: 3.977 Test Acc: 0.189
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 1.8476448
	speed: 0.1730s/iter; left time: 1022.1427s
Epoch: 12 cost time: 7.068535327911377
Epoch: 12, Steps: 154 | Train Loss: 1.416 Vali Loss: 3.956 Vali Acc: 0.320 Test Loss: 3.956 Test Acc: 0.320
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.9795485
	speed: 0.1757s/iter; left time: 1010.7898s
Epoch: 13 cost time: 8.731630086898804
Epoch: 13, Steps: 154 | Train Loss: 1.387 Vali Loss: 4.534 Vali Acc: 0.191 Test Loss: 4.534 Test Acc: 0.191
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 1.2793679
	speed: 0.1637s/iter; left time: 916.4702s
Epoch: 14 cost time: 5.977154731750488
Epoch: 14, Steps: 154 | Train Loss: 1.352 Vali Loss: 3.870 Vali Acc: 0.193 Test Loss: 3.870 Test Acc: 0.193
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 1.2856321
	speed: 0.1413s/iter; left time: 769.5174s
Epoch: 15 cost time: 6.85735297203064
Epoch: 15, Steps: 154 | Train Loss: 1.313 Vali Loss: 4.504 Vali Acc: 0.195 Test Loss: 4.504 Test Acc: 0.195
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 1.0264719
	speed: 0.1893s/iter; left time: 1001.7739s
Epoch: 16 cost time: 9.631680250167847
Epoch: 16, Steps: 154 | Train Loss: 1.304 Vali Loss: 4.790 Vali Acc: 0.188 Test Loss: 4.790 Test Acc: 0.188
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 1.1579394
	speed: 0.1572s/iter; left time: 807.5529s
Epoch: 17 cost time: 6.27679705619812
Epoch: 17, Steps: 154 | Train Loss: 1.284 Vali Loss: 4.565 Vali Acc: 0.189 Test Loss: 4.565 Test Acc: 0.189
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el5_dm768_df768_ps5_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3515815085158151
model parameter : 36563726
model size : 154.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el5_dm768_df768_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1954904
	speed: 0.0509s/iter; left time: 387.0697s
Epoch: 1 cost time: 7.470451593399048
Epoch: 1, Steps: 154 | Train Loss: 2.122 Vali Loss: 2.348 Vali Acc: 0.327 Test Loss: 2.348 Test Acc: 0.327
Validation loss decreased (inf --> -0.326822).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.2089653
	speed: 0.1627s/iter; left time: 1211.3890s
Epoch: 2 cost time: 8.335737705230713
Epoch: 2, Steps: 154 | Train Loss: 2.043 Vali Loss: 2.484 Vali Acc: 0.322 Test Loss: 2.484 Test Acc: 0.322
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.8364251
	speed: 0.1744s/iter; left time: 1272.1633s
Epoch: 3 cost time: 5.556185007095337
Epoch: 3, Steps: 154 | Train Loss: 1.942 Vali Loss: 2.306 Vali Acc: 0.338 Test Loss: 2.306 Test Acc: 0.338
Validation loss decreased (-0.326822 --> -0.337771).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.7647705
	speed: 0.1868s/iter; left time: 1333.8732s
Epoch: 4 cost time: 5.434555768966675
Epoch: 4, Steps: 154 | Train Loss: 1.819 Vali Loss: 2.361 Vali Acc: 0.335 Test Loss: 2.361 Test Acc: 0.335
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.6859512
	speed: 0.1581s/iter; left time: 1104.4800s
Epoch: 5 cost time: 5.957170248031616
Epoch: 5, Steps: 154 | Train Loss: 1.747 Vali Loss: 2.541 Vali Acc: 0.335 Test Loss: 2.541 Test Acc: 0.335
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 1.2489082
	speed: 0.1590s/iter; left time: 1086.3992s
Epoch: 6 cost time: 7.801306962966919
Epoch: 6, Steps: 154 | Train Loss: 1.695 Vali Loss: 2.435 Vali Acc: 0.350 Test Loss: 2.435 Test Acc: 0.350
Validation loss decreased (-0.337771 --> -0.349935).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.6261833
	speed: 0.2023s/iter; left time: 1350.9327s
Epoch: 7 cost time: 6.872324466705322
Epoch: 7, Steps: 154 | Train Loss: 1.625 Vali Loss: 2.976 Vali Acc: 0.112 Test Loss: 2.976 Test Acc: 0.112
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.5764942
	speed: 0.1749s/iter; left time: 1140.9712s
Epoch: 8 cost time: 7.191447496414185
Epoch: 8, Steps: 154 | Train Loss: 1.597 Vali Loss: 2.999 Vali Acc: 0.111 Test Loss: 2.999 Test Acc: 0.111
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.3714558
	speed: 0.1598s/iter; left time: 1017.7547s
Epoch: 9 cost time: 4.959527015686035
Epoch: 9, Steps: 154 | Train Loss: 1.526 Vali Loss: 3.473 Vali Acc: 0.181 Test Loss: 3.473 Test Acc: 0.181
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.2282560
	speed: 0.0947s/iter; left time: 588.7039s
Epoch: 10 cost time: 5.95842719078064
Epoch: 10, Steps: 154 | Train Loss: 1.512 Vali Loss: 3.662 Vali Acc: 0.052 Test Loss: 3.662 Test Acc: 0.052
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 1.2333651
	speed: 0.1890s/iter; left time: 1145.3597s
Epoch: 11 cost time: 7.919492244720459
Epoch: 11, Steps: 154 | Train Loss: 1.457 Vali Loss: 3.943 Vali Acc: 0.175 Test Loss: 3.943 Test Acc: 0.175
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 1.4935607
	speed: 0.1978s/iter; left time: 1168.6744s
Epoch: 12 cost time: 7.604086875915527
Epoch: 12, Steps: 154 | Train Loss: 1.427 Vali Loss: 3.825 Vali Acc: 0.186 Test Loss: 3.825 Test Acc: 0.186
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 1.1378689
	speed: 0.1845s/iter; left time: 1061.5502s
Epoch: 13 cost time: 7.515848159790039
Epoch: 13, Steps: 154 | Train Loss: 1.397 Vali Loss: 4.710 Vali Acc: 0.100 Test Loss: 4.710 Test Acc: 0.100
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.9455877
	speed: 0.1698s/iter; left time: 950.7592s
Epoch: 14 cost time: 5.901495456695557
Epoch: 14, Steps: 154 | Train Loss: 1.359 Vali Loss: 3.745 Vali Acc: 0.130 Test Loss: 3.745 Test Acc: 0.130
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 1.6213950
	speed: 0.1359s/iter; left time: 740.1404s
Epoch: 15 cost time: 6.214207649230957
Epoch: 15, Steps: 154 | Train Loss: 1.336 Vali Loss: 4.563 Vali Acc: 0.184 Test Loss: 4.563 Test Acc: 0.184
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 1.2437205
	speed: 0.1561s/iter; left time: 826.1831s
Epoch: 16 cost time: 6.236382246017456
Epoch: 16, Steps: 154 | Train Loss: 1.305 Vali Loss: 5.729 Vali Acc: 0.178 Test Loss: 5.729 Test Acc: 0.178
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el5_dm768_df768_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3499594484995945
model parameter : 36502286
model size : 153.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el5_dm768_df768_ps5_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0611796
	speed: 0.0597s/iter; left time: 453.7986s
Epoch: 1 cost time: 8.52967619895935
Epoch: 1, Steps: 154 | Train Loss: 2.136 Vali Loss: 2.136 Vali Acc: 0.319 Test Loss: 2.136 Test Acc: 0.319
Validation loss decreased (inf --> -0.318713).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.1617212
	speed: 0.1430s/iter; left time: 1065.1190s
Epoch: 2 cost time: 5.368184328079224
Epoch: 2, Steps: 154 | Train Loss: 2.015 Vali Loss: 2.158 Vali Acc: 0.322 Test Loss: 2.158 Test Acc: 0.322
Validation loss decreased (-0.318713 --> -0.321957).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.1579928
	speed: 0.1525s/iter; left time: 1112.0771s
Epoch: 3 cost time: 5.546385765075684
Epoch: 3, Steps: 154 | Train Loss: 1.954 Vali Loss: 2.545 Vali Acc: 0.322 Test Loss: 2.545 Test Acc: 0.322
Validation loss decreased (-0.321957 --> -0.322359).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.5210383
	speed: 0.1703s/iter; left time: 1215.4200s
Epoch: 4 cost time: 6.027505874633789
Epoch: 4, Steps: 154 | Train Loss: 1.876 Vali Loss: 2.451 Vali Acc: 0.331 Test Loss: 2.451 Test Acc: 0.331
Validation loss decreased (-0.322359 --> -0.331281).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.4932344
	speed: 0.1778s/iter; left time: 1242.1877s
Epoch: 5 cost time: 6.546098470687866
Epoch: 5, Steps: 154 | Train Loss: 1.771 Vali Loss: 2.480 Vali Acc: 0.331 Test Loss: 2.480 Test Acc: 0.331
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.6630261
	speed: 0.1548s/iter; left time: 1057.5277s
Epoch: 6 cost time: 6.413564205169678
Epoch: 6, Steps: 154 | Train Loss: 1.724 Vali Loss: 2.786 Vali Acc: 0.176 Test Loss: 2.786 Test Acc: 0.176
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.2389305
	speed: 0.1605s/iter; left time: 1071.6848s
Epoch: 7 cost time: 6.569746494293213
Epoch: 7, Steps: 154 | Train Loss: 1.660 Vali Loss: 2.903 Vali Acc: 0.174 Test Loss: 2.903 Test Acc: 0.174
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 1.6892568
	speed: 0.1525s/iter; left time: 994.5841s
Epoch: 8 cost time: 6.635502576828003
Epoch: 8, Steps: 154 | Train Loss: 1.614 Vali Loss: 3.546 Vali Acc: 0.176 Test Loss: 3.546 Test Acc: 0.176
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 1.8728340
	speed: 0.1679s/iter; left time: 1069.1202s
Epoch: 9 cost time: 6.680867433547974
Epoch: 9, Steps: 154 | Train Loss: 1.574 Vali Loss: 2.834 Vali Acc: 0.178 Test Loss: 2.834 Test Acc: 0.178
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 1.0651809
	speed: 0.1558s/iter; left time: 968.3787s
Epoch: 10 cost time: 5.617142915725708
Epoch: 10, Steps: 154 | Train Loss: 1.537 Vali Loss: 3.264 Vali Acc: 0.096 Test Loss: 3.264 Test Acc: 0.096
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 1.4597954
	speed: 0.1480s/iter; left time: 897.1798s
Epoch: 11 cost time: 5.157262563705444
Epoch: 11, Steps: 154 | Train Loss: 1.474 Vali Loss: 3.811 Vali Acc: 0.184 Test Loss: 3.811 Test Acc: 0.184
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 1.2709055
	speed: 0.1498s/iter; left time: 884.7880s
Epoch: 12 cost time: 5.716461420059204
Epoch: 12, Steps: 154 | Train Loss: 1.470 Vali Loss: 3.798 Vali Acc: 0.181 Test Loss: 3.798 Test Acc: 0.181
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 1.6300437
	speed: 0.1469s/iter; left time: 845.3006s
Epoch: 13 cost time: 5.408975839614868
Epoch: 13, Steps: 154 | Train Loss: 1.428 Vali Loss: 4.578 Vali Acc: 0.056 Test Loss: 4.578 Test Acc: 0.056
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 1.3675311
	speed: 0.1341s/iter; left time: 750.7450s
Epoch: 14 cost time: 5.206320524215698
Epoch: 14, Steps: 154 | Train Loss: 1.400 Vali Loss: 4.944 Vali Acc: 0.049 Test Loss: 4.944 Test Acc: 0.049
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el5_dm768_df768_ps5_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3313057583130576
model parameter : 36453134
model size : 153.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el5_dm768_df768_ps6_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.3223963
	speed: 0.0603s/iter; left time: 458.2222s
Epoch: 1 cost time: 8.312637567520142
Epoch: 1, Steps: 154 | Train Loss: 2.125 Vali Loss: 2.240 Vali Acc: 0.160 Test Loss: 2.240 Test Acc: 0.160
Validation loss decreased (inf --> -0.159751).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9723361
	speed: 0.2043s/iter; left time: 1521.2205s
Epoch: 2 cost time: 10.704633712768555
Epoch: 2, Steps: 154 | Train Loss: 2.035 Vali Loss: 2.393 Vali Acc: 0.321 Test Loss: 2.393 Test Acc: 0.321
Validation loss decreased (-0.159751 --> -0.321144).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.6832331
	speed: 0.2403s/iter; left time: 1752.3896s
Epoch: 3 cost time: 9.371469497680664
Epoch: 3, Steps: 154 | Train Loss: 1.966 Vali Loss: 2.220 Vali Acc: 0.330 Test Loss: 2.220 Test Acc: 0.330
Validation loss decreased (-0.321144 --> -0.330067).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.6805500
	speed: 0.2274s/iter; left time: 1623.5033s
Epoch: 4 cost time: 9.602511167526245
Epoch: 4, Steps: 154 | Train Loss: 1.869 Vali Loss: 2.528 Vali Acc: 0.338 Test Loss: 2.528 Test Acc: 0.338
Validation loss decreased (-0.330067 --> -0.337769).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.6650428
	speed: 0.2451s/iter; left time: 1712.3618s
Epoch: 5 cost time: 8.751796960830688
Epoch: 5, Steps: 154 | Train Loss: 1.772 Vali Loss: 2.806 Vali Acc: 0.337 Test Loss: 2.806 Test Acc: 0.337
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.3632761
	speed: 0.2237s/iter; left time: 1528.0735s
Epoch: 6 cost time: 10.658085584640503
Epoch: 6, Steps: 154 | Train Loss: 1.693 Vali Loss: 3.106 Vali Acc: 0.336 Test Loss: 3.106 Test Acc: 0.336
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.7895870
	speed: 0.2209s/iter; left time: 1474.9889s
Epoch: 7 cost time: 8.55965781211853
Epoch: 7, Steps: 154 | Train Loss: 1.621 Vali Loss: 3.046 Vali Acc: 0.361 Test Loss: 3.046 Test Acc: 0.361
Validation loss decreased (-0.337769 --> -0.360878).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.3250015
	speed: 0.2349s/iter; left time: 1532.4353s
Epoch: 8 cost time: 4.529923915863037
Epoch: 8, Steps: 154 | Train Loss: 1.559 Vali Loss: 3.460 Vali Acc: 0.183 Test Loss: 3.460 Test Acc: 0.183
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.7599396
	speed: 0.1689s/iter; left time: 1075.7946s
Epoch: 9 cost time: 7.537883520126343
Epoch: 9, Steps: 154 | Train Loss: 1.522 Vali Loss: 3.456 Vali Acc: 0.175 Test Loss: 3.456 Test Acc: 0.175
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.0934753
	speed: 0.1752s/iter; left time: 1088.9415s
Epoch: 10 cost time: 8.691816091537476
Epoch: 10, Steps: 154 | Train Loss: 1.461 Vali Loss: 3.673 Vali Acc: 0.191 Test Loss: 3.673 Test Acc: 0.191
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.4756594
	speed: 0.2229s/iter; left time: 1350.7201s
Epoch: 11 cost time: 11.400660991668701
Epoch: 11, Steps: 154 | Train Loss: 1.438 Vali Loss: 4.064 Vali Acc: 0.125 Test Loss: 4.064 Test Acc: 0.125
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 1.2253964
	speed: 0.2309s/iter; left time: 1364.0281s
Epoch: 12 cost time: 8.809932231903076
Epoch: 12, Steps: 154 | Train Loss: 1.400 Vali Loss: 4.215 Vali Acc: 0.180 Test Loss: 4.215 Test Acc: 0.180
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 1.4355754
	speed: 0.2315s/iter; left time: 1331.8207s
Epoch: 13 cost time: 10.292608499526978
Epoch: 13, Steps: 154 | Train Loss: 1.347 Vali Loss: 5.020 Vali Acc: 0.090 Test Loss: 5.020 Test Acc: 0.090
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 1.2295606
	speed: 0.1961s/iter; left time: 1098.1082s
Epoch: 14 cost time: 7.738481521606445
Epoch: 14, Steps: 154 | Train Loss: 1.316 Vali Loss: 4.964 Vali Acc: 0.156 Test Loss: 4.964 Test Acc: 0.156
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 1.5270554
	speed: 0.1647s/iter; left time: 896.9892s
Epoch: 15 cost time: 5.5703582763671875
Epoch: 15, Steps: 154 | Train Loss: 1.268 Vali Loss: 4.434 Vali Acc: 0.177 Test Loss: 4.434 Test Acc: 0.177
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 1.1799760
	speed: 0.1718s/iter; left time: 909.0263s
Epoch: 16 cost time: 10.147441625595093
Epoch: 16, Steps: 154 | Train Loss: 1.284 Vali Loss: 4.189 Vali Acc: 0.191 Test Loss: 4.189 Test Acc: 0.191
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 1.1819919
	speed: 0.2269s/iter; left time: 1165.3413s
Epoch: 17 cost time: 10.791205883026123
Epoch: 17, Steps: 154 | Train Loss: 1.257 Vali Loss: 6.340 Vali Acc: 0.056 Test Loss: 6.340 Test Acc: 0.056
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el5_dm768_df768_ps6_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3609083536090835
model parameter : 36577550
model size : 154.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el5_dm768_df768_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.9647477
	speed: 0.0605s/iter; left time: 459.5518s
Epoch: 1 cost time: 8.940251111984253
Epoch: 1, Steps: 154 | Train Loss: 2.147 Vali Loss: 2.131 Vali Acc: 0.320 Test Loss: 2.131 Test Acc: 0.320
Validation loss decreased (inf --> -0.319930).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.5286611
	speed: 0.1645s/iter; left time: 1224.9161s
Epoch: 2 cost time: 5.119519472122192
Epoch: 2, Steps: 154 | Train Loss: 2.042 Vali Loss: 2.109 Vali Acc: 0.327 Test Loss: 2.109 Test Acc: 0.327
Validation loss decreased (-0.319930 --> -0.327230).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.8932118
	speed: 0.1558s/iter; left time: 1136.4903s
Epoch: 3 cost time: 5.236173152923584
Epoch: 3, Steps: 154 | Train Loss: 1.960 Vali Loss: 2.305 Vali Acc: 0.325 Test Loss: 2.305 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.6445383
	speed: 0.1575s/iter; left time: 1124.7359s
Epoch: 4 cost time: 8.183550119400024
Epoch: 4, Steps: 154 | Train Loss: 1.879 Vali Loss: 2.448 Vali Acc: 0.330 Test Loss: 2.448 Test Acc: 0.330
Validation loss decreased (-0.327230 --> -0.330065).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.7420938
	speed: 0.1988s/iter; left time: 1388.5976s
Epoch: 5 cost time: 5.145944595336914
Epoch: 5, Steps: 154 | Train Loss: 1.794 Vali Loss: 2.692 Vali Acc: 0.344 Test Loss: 2.692 Test Acc: 0.344
Validation loss decreased (-0.330065 --> -0.343850).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.9604217
	speed: 0.2370s/iter; left time: 1619.2130s
Epoch: 6 cost time: 9.191604375839233
Epoch: 6, Steps: 154 | Train Loss: 1.724 Vali Loss: 2.755 Vali Acc: 0.331 Test Loss: 2.755 Test Acc: 0.331
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.8412105
	speed: 0.2158s/iter; left time: 1440.8429s
Epoch: 7 cost time: 8.497146368026733
Epoch: 7, Steps: 154 | Train Loss: 1.669 Vali Loss: 3.070 Vali Acc: 0.336 Test Loss: 3.070 Test Acc: 0.336
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 2.1493590
	speed: 0.1743s/iter; left time: 1136.8792s
Epoch: 8 cost time: 6.80841851234436
Epoch: 8, Steps: 154 | Train Loss: 1.612 Vali Loss: 3.321 Vali Acc: 0.102 Test Loss: 3.321 Test Acc: 0.102
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 1.5773660
	speed: 0.2067s/iter; left time: 1316.7569s
Epoch: 9 cost time: 7.451118469238281
Epoch: 9, Steps: 154 | Train Loss: 1.543 Vali Loss: 3.075 Vali Acc: 0.115 Test Loss: 3.075 Test Acc: 0.115
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 1.2881639
	speed: 0.1706s/iter; left time: 1060.0648s
Epoch: 10 cost time: 7.165328025817871
Epoch: 10, Steps: 154 | Train Loss: 1.523 Vali Loss: 3.388 Vali Acc: 0.195 Test Loss: 3.388 Test Acc: 0.195
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 1.7240137
	speed: 0.1760s/iter; left time: 1066.7148s
Epoch: 11 cost time: 8.282138347625732
Epoch: 11, Steps: 154 | Train Loss: 1.469 Vali Loss: 4.372 Vali Acc: 0.186 Test Loss: 4.372 Test Acc: 0.186
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 1.1098305
	speed: 0.1865s/iter; left time: 1101.5787s
Epoch: 12 cost time: 7.8107030391693115
Epoch: 12, Steps: 154 | Train Loss: 1.432 Vali Loss: 4.662 Vali Acc: 0.181 Test Loss: 4.662 Test Acc: 0.181
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.9646288
	speed: 0.1918s/iter; left time: 1103.6763s
Epoch: 13 cost time: 8.995391607284546
Epoch: 13, Steps: 154 | Train Loss: 1.400 Vali Loss: 4.398 Vali Acc: 0.178 Test Loss: 4.398 Test Acc: 0.178
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.5894454
	speed: 0.1844s/iter; left time: 1032.2901s
Epoch: 14 cost time: 8.676966428756714
Epoch: 14, Steps: 154 | Train Loss: 1.390 Vali Loss: 4.144 Vali Acc: 0.184 Test Loss: 4.144 Test Acc: 0.184
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 1.4709625
	speed: 0.2038s/iter; left time: 1109.9423s
Epoch: 15 cost time: 7.6481544971466064
Epoch: 15, Steps: 154 | Train Loss: 1.341 Vali Loss: 4.757 Vali Acc: 0.196 Test Loss: 4.757 Test Acc: 0.196
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el5_dm768_df768_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.34387672343876724
model parameter : 36516110
model size : 153.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el5_dm768_df768_ps6_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2990444
	speed: 0.0497s/iter; left time: 377.8031s
Epoch: 1 cost time: 7.339830160140991
Epoch: 1, Steps: 154 | Train Loss: 2.144 Vali Loss: 2.184 Vali Acc: 0.322 Test Loss: 2.184 Test Acc: 0.322
Validation loss decreased (inf --> -0.321957).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8210974
	speed: 0.1465s/iter; left time: 1091.1891s
Epoch: 2 cost time: 5.2232067584991455
Epoch: 2, Steps: 154 | Train Loss: 2.023 Vali Loss: 2.149 Vali Acc: 0.325 Test Loss: 2.149 Test Acc: 0.325
Validation loss decreased (-0.321957 --> -0.324796).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9260384
	speed: 0.1621s/iter; left time: 1182.1767s
Epoch: 3 cost time: 6.908106327056885
Epoch: 3, Steps: 154 | Train Loss: 1.956 Vali Loss: 2.278 Vali Acc: 0.322 Test Loss: 2.278 Test Acc: 0.322
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.6439965
	speed: 0.1547s/iter; left time: 1104.4082s
Epoch: 4 cost time: 7.119067430496216
Epoch: 4, Steps: 154 | Train Loss: 1.888 Vali Loss: 2.215 Vali Acc: 0.330 Test Loss: 2.215 Test Acc: 0.330
Validation loss decreased (-0.324796 --> -0.330067).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.6210170
	speed: 0.1670s/iter; left time: 1166.5290s
Epoch: 5 cost time: 7.245661973953247
Epoch: 5, Steps: 154 | Train Loss: 1.841 Vali Loss: 2.683 Vali Acc: 0.337 Test Loss: 2.683 Test Acc: 0.337
Validation loss decreased (-0.330067 --> -0.336551).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.7320542
	speed: 0.1785s/iter; left time: 1219.2645s
Epoch: 6 cost time: 6.429357528686523
Epoch: 6, Steps: 154 | Train Loss: 1.742 Vali Loss: 2.557 Vali Acc: 0.336 Test Loss: 2.557 Test Acc: 0.336
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.2528979
	speed: 0.1253s/iter; left time: 836.3542s
Epoch: 7 cost time: 4.85617733001709
Epoch: 7, Steps: 154 | Train Loss: 1.662 Vali Loss: 3.141 Vali Acc: 0.295 Test Loss: 3.141 Test Acc: 0.295
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.1563126
	speed: 0.1306s/iter; left time: 851.6944s
Epoch: 8 cost time: 6.53087592124939
Epoch: 8, Steps: 154 | Train Loss: 1.629 Vali Loss: 2.978 Vali Acc: 0.179 Test Loss: 2.978 Test Acc: 0.179
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 1.7238770
	speed: 0.1690s/iter; left time: 1076.5648s
Epoch: 9 cost time: 7.470794916152954
Epoch: 9, Steps: 154 | Train Loss: 1.562 Vali Loss: 3.383 Vali Acc: 0.185 Test Loss: 3.383 Test Acc: 0.185
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 1.9315118
	speed: 0.1342s/iter; left time: 833.9404s
Epoch: 10 cost time: 6.029354572296143
Epoch: 10, Steps: 154 | Train Loss: 1.526 Vali Loss: 2.996 Vali Acc: 0.193 Test Loss: 2.996 Test Acc: 0.193
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 1.4553696
	speed: 0.1448s/iter; left time: 877.8415s
Epoch: 11 cost time: 7.3425538539886475
Epoch: 11, Steps: 154 | Train Loss: 1.492 Vali Loss: 3.519 Vali Acc: 0.097 Test Loss: 3.519 Test Acc: 0.097
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 1.5323954
	speed: 0.1642s/iter; left time: 969.8331s
Epoch: 12 cost time: 7.506103277206421
Epoch: 12, Steps: 154 | Train Loss: 1.459 Vali Loss: 3.613 Vali Acc: 0.354 Test Loss: 3.613 Test Acc: 0.354
Validation loss decreased (-0.336551 --> -0.353978).  Saving model ...
	iters: 100, epoch: 13 | loss: 1.4591575
	speed: 0.1990s/iter; left time: 1144.6817s
Epoch: 13 cost time: 7.160700559616089
Epoch: 13, Steps: 154 | Train Loss: 1.428 Vali Loss: 3.630 Vali Acc: 0.179 Test Loss: 3.630 Test Acc: 0.179
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 1.4159279
	speed: 0.1495s/iter; left time: 836.8262s
Epoch: 14 cost time: 5.65068793296814
Epoch: 14, Steps: 154 | Train Loss: 1.398 Vali Loss: 3.682 Vali Acc: 0.189 Test Loss: 3.682 Test Acc: 0.189
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 1.1874775
	speed: 0.1213s/iter; left time: 660.6562s
Epoch: 15 cost time: 5.27455997467041
Epoch: 15, Steps: 154 | Train Loss: 1.371 Vali Loss: 4.127 Vali Acc: 0.192 Test Loss: 4.127 Test Acc: 0.192
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 1.6231922
	speed: 0.1234s/iter; left time: 652.7566s
Epoch: 16 cost time: 6.310655355453491
Epoch: 16, Steps: 154 | Train Loss: 1.330 Vali Loss: 3.895 Vali Acc: 0.124 Test Loss: 3.895 Test Acc: 0.124
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 1.2024366
	speed: 0.1539s/iter; left time: 790.6689s
Epoch: 17 cost time: 6.857822418212891
Epoch: 17, Steps: 154 | Train Loss: 1.297 Vali Loss: 4.648 Vali Acc: 0.185 Test Loss: 4.648 Test Acc: 0.185
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.9020370
	speed: 0.1490s/iter; left time: 742.5612s
Epoch: 18 cost time: 5.660789489746094
Epoch: 18, Steps: 154 | Train Loss: 1.295 Vali Loss: 4.330 Vali Acc: 0.187 Test Loss: 4.330 Test Acc: 0.187
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 1.0777245
	speed: 0.1359s/iter; left time: 656.4708s
Epoch: 19 cost time: 5.478677749633789
Epoch: 19, Steps: 154 | Train Loss: 1.258 Vali Loss: 4.325 Vali Acc: 0.113 Test Loss: 4.325 Test Acc: 0.113
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 1.2578379
	speed: 0.1055s/iter; left time: 493.3864s
Epoch: 20 cost time: 4.224286079406738
Epoch: 20, Steps: 154 | Train Loss: 1.238 Vali Loss: 4.592 Vali Acc: 0.176 Test Loss: 4.592 Test Acc: 0.176
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 1.0607383
	speed: 0.1405s/iter; left time: 635.0557s
Epoch: 21 cost time: 5.7640838623046875
Epoch: 21, Steps: 154 | Train Loss: 1.213 Vali Loss: 4.583 Vali Acc: 0.186 Test Loss: 4.583 Test Acc: 0.186
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 1.4962891
	speed: 0.1335s/iter; left time: 583.1901s
Epoch: 22 cost time: 5.409061431884766
Epoch: 22, Steps: 154 | Train Loss: 1.206 Vali Loss: 4.946 Vali Acc: 0.139 Test Loss: 4.946 Test Acc: 0.139
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el5_dm768_df768_ps6_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.354014598540146
model parameter : 36454670
model size : 153.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el5_dm768_df768_ps8_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0131788
	speed: 0.0677s/iter; left time: 514.3732s
Epoch: 1 cost time: 9.490805387496948
Epoch: 1, Steps: 154 | Train Loss: 2.139 Vali Loss: 2.176 Vali Acc: 0.320 Test Loss: 2.176 Test Acc: 0.320
Validation loss decreased (inf --> -0.320335).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.7895328
	speed: 0.1753s/iter; left time: 1305.3813s
Epoch: 2 cost time: 7.035380125045776
Epoch: 2, Steps: 154 | Train Loss: 2.027 Vali Loss: 2.288 Vali Acc: 0.328 Test Loss: 2.288 Test Acc: 0.328
Validation loss decreased (-0.320335 --> -0.327633).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.3843261
	speed: 0.2195s/iter; left time: 1600.5310s
Epoch: 3 cost time: 10.04085898399353
Epoch: 3, Steps: 154 | Train Loss: 1.966 Vali Loss: 2.222 Vali Acc: 0.328 Test Loss: 2.222 Test Acc: 0.328
Validation loss decreased (-0.327633 --> -0.328039).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.6885601
	speed: 0.2283s/iter; left time: 1630.1254s
Epoch: 4 cost time: 6.140325307846069
Epoch: 4, Steps: 154 | Train Loss: 1.868 Vali Loss: 2.680 Vali Acc: 0.328 Test Loss: 2.680 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.8197280
	speed: 0.1986s/iter; left time: 1387.2810s
Epoch: 5 cost time: 9.399497270584106
Epoch: 5, Steps: 154 | Train Loss: 1.771 Vali Loss: 2.547 Vali Acc: 0.351 Test Loss: 2.547 Test Acc: 0.351
Validation loss decreased (-0.328039 --> -0.350745).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.1583624
	speed: 0.2245s/iter; left time: 1533.4714s
Epoch: 6 cost time: 9.9479238986969
Epoch: 6, Steps: 154 | Train Loss: 1.683 Vali Loss: 3.416 Vali Acc: 0.078 Test Loss: 3.416 Test Acc: 0.078
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 2.0933831
	speed: 0.1924s/iter; left time: 1284.6314s
Epoch: 7 cost time: 8.487404108047485
Epoch: 7, Steps: 154 | Train Loss: 1.604 Vali Loss: 3.498 Vali Acc: 0.174 Test Loss: 3.498 Test Acc: 0.174
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 2.1038508
	speed: 0.1890s/iter; left time: 1232.9368s
Epoch: 8 cost time: 8.004968404769897
Epoch: 8, Steps: 154 | Train Loss: 1.555 Vali Loss: 3.473 Vali Acc: 0.183 Test Loss: 3.473 Test Acc: 0.183
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 1.1414602
	speed: 0.1699s/iter; left time: 1081.9384s
Epoch: 9 cost time: 7.492607355117798
Epoch: 9, Steps: 154 | Train Loss: 1.509 Vali Loss: 4.020 Vali Acc: 0.174 Test Loss: 4.020 Test Acc: 0.174
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 1.0873530
	speed: 0.2334s/iter; left time: 1450.2749s
Epoch: 10 cost time: 7.445282459259033
Epoch: 10, Steps: 154 | Train Loss: 1.435 Vali Loss: 4.217 Vali Acc: 0.154 Test Loss: 4.217 Test Acc: 0.154
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 1.3974110
	speed: 0.1794s/iter; left time: 1087.5480s
Epoch: 11 cost time: 7.934479236602783
Epoch: 11, Steps: 154 | Train Loss: 1.422 Vali Loss: 4.769 Vali Acc: 0.110 Test Loss: 4.769 Test Acc: 0.110
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.9369361
	speed: 0.1359s/iter; left time: 802.5940s
Epoch: 12 cost time: 9.306859254837036
Epoch: 12, Steps: 154 | Train Loss: 1.391 Vali Loss: 5.063 Vali Acc: 0.064 Test Loss: 5.063 Test Acc: 0.064
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 1.6050535
	speed: 0.2195s/iter; left time: 1262.9851s
Epoch: 13 cost time: 10.845656633377075
Epoch: 13, Steps: 154 | Train Loss: 1.309 Vali Loss: 4.928 Vali Acc: 0.113 Test Loss: 4.928 Test Acc: 0.113
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 1.6575357
	speed: 0.1987s/iter; left time: 1112.4746s
Epoch: 14 cost time: 7.817298889160156
Epoch: 14, Steps: 154 | Train Loss: 1.290 Vali Loss: 5.033 Vali Acc: 0.201 Test Loss: 5.033 Test Acc: 0.201
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 1.9219350
	speed: 0.2246s/iter; left time: 1223.0838s
Epoch: 15 cost time: 7.149441719055176
Epoch: 15, Steps: 154 | Train Loss: 1.247 Vali Loss: 4.992 Vali Acc: 0.065 Test Loss: 4.992 Test Acc: 0.065
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el5_dm768_df768_ps8_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.35077047850770476
model parameter : 36592910
model size : 154.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el5_dm768_df768_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2846251
	speed: 0.0510s/iter; left time: 387.5525s
Epoch: 1 cost time: 6.946485280990601
Epoch: 1, Steps: 154 | Train Loss: 2.121 Vali Loss: 2.203 Vali Acc: 0.318 Test Loss: 2.203 Test Acc: 0.318
Validation loss decreased (inf --> -0.317902).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.2420228
	speed: 0.1367s/iter; left time: 1018.2766s
Epoch: 2 cost time: 5.687197685241699
Epoch: 2, Steps: 154 | Train Loss: 2.008 Vali Loss: 2.441 Vali Acc: 0.323 Test Loss: 2.441 Test Acc: 0.323
Validation loss decreased (-0.317902 --> -0.322766).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9181130
	speed: 0.1390s/iter; left time: 1013.5878s
Epoch: 3 cost time: 5.38494873046875
Epoch: 3, Steps: 154 | Train Loss: 1.939 Vali Loss: 2.289 Vali Acc: 0.324 Test Loss: 2.289 Test Acc: 0.324
Validation loss decreased (-0.322766 --> -0.323984).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.5828133
	speed: 0.1696s/iter; left time: 1210.5056s
Epoch: 4 cost time: 6.155989170074463
Epoch: 4, Steps: 154 | Train Loss: 1.841 Vali Loss: 2.516 Vali Acc: 0.337 Test Loss: 2.516 Test Acc: 0.337
Validation loss decreased (-0.323984 --> -0.336958).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.6161900
	speed: 0.1916s/iter; left time: 1338.1928s
Epoch: 5 cost time: 7.041162967681885
Epoch: 5, Steps: 154 | Train Loss: 1.771 Vali Loss: 2.601 Vali Acc: 0.171 Test Loss: 2.601 Test Acc: 0.171
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 2.1186233
	speed: 0.1721s/iter; left time: 1175.3804s
Epoch: 6 cost time: 7.57593846321106
Epoch: 6, Steps: 154 | Train Loss: 1.704 Vali Loss: 2.634 Vali Acc: 0.133 Test Loss: 2.634 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.5198908
	speed: 0.1527s/iter; left time: 1019.5909s
Epoch: 7 cost time: 5.929518699645996
Epoch: 7, Steps: 154 | Train Loss: 1.615 Vali Loss: 3.003 Vali Acc: 0.168 Test Loss: 3.003 Test Acc: 0.168
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 1.9188145
	speed: 0.1255s/iter; left time: 818.7274s
Epoch: 8 cost time: 5.120423078536987
Epoch: 8, Steps: 154 | Train Loss: 1.571 Vali Loss: 3.642 Vali Acc: 0.169 Test Loss: 3.642 Test Acc: 0.169
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 1.6012518
	speed: 0.1294s/iter; left time: 824.1135s
Epoch: 9 cost time: 5.62688684463501
Epoch: 9, Steps: 154 | Train Loss: 1.506 Vali Loss: 3.376 Vali Acc: 0.177 Test Loss: 3.376 Test Acc: 0.177
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 1.4831070
	speed: 0.1117s/iter; left time: 694.1445s
Epoch: 10 cost time: 4.651537656784058
Epoch: 10, Steps: 154 | Train Loss: 1.476 Vali Loss: 3.605 Vali Acc: 0.056 Test Loss: 3.605 Test Acc: 0.056
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 1.6403559
	speed: 0.1161s/iter; left time: 703.7599s
Epoch: 11 cost time: 5.466673851013184
Epoch: 11, Steps: 154 | Train Loss: 1.427 Vali Loss: 5.180 Vali Acc: 0.057 Test Loss: 5.180 Test Acc: 0.057
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 1.2653567
	speed: 0.1415s/iter; left time: 835.7658s
Epoch: 12 cost time: 6.6352479457855225
Epoch: 12, Steps: 154 | Train Loss: 1.405 Vali Loss: 3.705 Vali Acc: 0.191 Test Loss: 3.705 Test Acc: 0.191
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 1.3328466
	speed: 0.1249s/iter; left time: 718.2726s
Epoch: 13 cost time: 5.524812698364258
Epoch: 13, Steps: 154 | Train Loss: 1.366 Vali Loss: 4.917 Vali Acc: 0.064 Test Loss: 4.917 Test Acc: 0.064
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 1.3010699
	speed: 0.1210s/iter; left time: 677.3698s
Epoch: 14 cost time: 5.552195310592651
Epoch: 14, Steps: 154 | Train Loss: 1.337 Vali Loss: 4.732 Vali Acc: 0.112 Test Loss: 4.732 Test Acc: 0.112
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el5_dm768_df768_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.33698296836982966
model parameter : 36506894
model size : 153.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           5                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el5_dm768_df768_ps8_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.3252745
	speed: 0.0503s/iter; left time: 382.0802s
Epoch: 1 cost time: 6.859400272369385
Epoch: 1, Steps: 154 | Train Loss: 2.157 Vali Loss: 2.168 Vali Acc: 0.318 Test Loss: 2.168 Test Acc: 0.318
Validation loss decreased (inf --> -0.317902).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.7499490
	speed: 0.1025s/iter; left time: 763.5167s
Epoch: 2 cost time: 4.107457637786865
Epoch: 2, Steps: 154 | Train Loss: 2.023 Vali Loss: 2.141 Vali Acc: 0.320 Test Loss: 2.141 Test Acc: 0.320
Validation loss decreased (-0.317902 --> -0.320335).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9777751
	speed: 0.1120s/iter; left time: 816.7519s
Epoch: 3 cost time: 4.492438793182373
Epoch: 3, Steps: 154 | Train Loss: 1.954 Vali Loss: 2.170 Vali Acc: 0.331 Test Loss: 2.170 Test Acc: 0.331
Validation loss decreased (-0.320335 --> -0.330879).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.5979116
	speed: 0.1570s/iter; left time: 1120.5191s
Epoch: 4 cost time: 4.381893634796143
Epoch: 4, Steps: 154 | Train Loss: 1.869 Vali Loss: 2.277 Vali Acc: 0.330 Test Loss: 2.277 Test Acc: 0.330
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.9013205
	speed: 0.1080s/iter; left time: 754.2113s
Epoch: 5 cost time: 6.446293592453003
Epoch: 5, Steps: 154 | Train Loss: 1.785 Vali Loss: 2.400 Vali Acc: 0.335 Test Loss: 2.400 Test Acc: 0.335
Validation loss decreased (-0.330879 --> -0.335337).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.8022684
	speed: 0.1775s/iter; left time: 1212.3980s
Epoch: 6 cost time: 6.109807014465332
Epoch: 6, Steps: 154 | Train Loss: 1.727 Vali Loss: 2.366 Vali Acc: 0.344 Test Loss: 2.366 Test Acc: 0.344
Validation loss decreased (-0.335337 --> -0.344259).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.3277023
	speed: 0.1641s/iter; left time: 1096.0029s
Epoch: 7 cost time: 5.077581882476807
Epoch: 7, Steps: 154 | Train Loss: 1.661 Vali Loss: 2.467 Vali Acc: 0.365 Test Loss: 2.467 Test Acc: 0.365
Validation loss decreased (-0.344259 --> -0.365344).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.6437927
	speed: 0.1468s/iter; left time: 957.3190s
Epoch: 8 cost time: 4.785199880599976
Epoch: 8, Steps: 154 | Train Loss: 1.589 Vali Loss: 2.794 Vali Acc: 0.278 Test Loss: 2.794 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.0085782
	speed: 0.1403s/iter; left time: 893.6326s
Epoch: 9 cost time: 7.246630907058716
Epoch: 9, Steps: 154 | Train Loss: 1.554 Vali Loss: 2.984 Vali Acc: 0.176 Test Loss: 2.984 Test Acc: 0.176
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.1522347
	speed: 0.1413s/iter; left time: 877.9686s
Epoch: 10 cost time: 7.1326985359191895
Epoch: 10, Steps: 154 | Train Loss: 1.517 Vali Loss: 3.092 Vali Acc: 0.176 Test Loss: 3.092 Test Acc: 0.176
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.4195497
	speed: 0.1696s/iter; left time: 1027.8678s
Epoch: 11 cost time: 6.592687368392944
Epoch: 11, Steps: 154 | Train Loss: 1.477 Vali Loss: 3.231 Vali Acc: 0.186 Test Loss: 3.231 Test Acc: 0.186
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 1.8572309
	speed: 0.1493s/iter; left time: 881.8817s
Epoch: 12 cost time: 6.719278812408447
Epoch: 12, Steps: 154 | Train Loss: 1.436 Vali Loss: 3.290 Vali Acc: 0.100 Test Loss: 3.290 Test Acc: 0.100
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 1.5935768
	speed: 0.1452s/iter; left time: 835.3541s
Epoch: 13 cost time: 5.349560499191284
Epoch: 13, Steps: 154 | Train Loss: 1.407 Vali Loss: 3.712 Vali Acc: 0.173 Test Loss: 3.712 Test Acc: 0.173
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 1.4731481
	speed: 0.1154s/iter; left time: 646.2607s
Epoch: 14 cost time: 4.394490957260132
Epoch: 14, Steps: 154 | Train Loss: 1.409 Vali Loss: 3.904 Vali Acc: 0.182 Test Loss: 3.904 Test Acc: 0.182
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.9412950
	speed: 0.1153s/iter; left time: 627.5939s
Epoch: 15 cost time: 5.331514835357666
Epoch: 15, Steps: 154 | Train Loss: 1.346 Vali Loss: 3.997 Vali Acc: 0.174 Test Loss: 3.997 Test Acc: 0.174
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 1.4495668
	speed: 0.1349s/iter; left time: 713.7934s
Epoch: 16 cost time: 5.434918165206909
Epoch: 16, Steps: 154 | Train Loss: 1.327 Vali Loss: 4.515 Vali Acc: 0.058 Test Loss: 4.515 Test Acc: 0.058
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 1.2912458
	speed: 0.1270s/iter; left time: 652.1713s
Epoch: 17 cost time: 5.946481943130493
Epoch: 17, Steps: 154 | Train Loss: 1.314 Vali Loss: 4.824 Vali Acc: 0.096 Test Loss: 4.824 Test Acc: 0.096
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el5_dm768_df768_ps8_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3653690186536902
model parameter : 36457742
model size : 153.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el4_dm768_df768_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1528435
	speed: 0.0766s/iter; left time: 581.9677s
Epoch: 1 cost time: 10.597396850585938
Epoch: 1, Steps: 154 | Train Loss: 2.130 Vali Loss: 2.283 Vali Acc: 0.319 Test Loss: 2.283 Test Acc: 0.319
Validation loss decreased (inf --> -0.319117).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8078604
	speed: 0.1883s/iter; left time: 1401.9757s
Epoch: 2 cost time: 9.369526863098145
Epoch: 2, Steps: 154 | Train Loss: 2.111 Vali Loss: 2.486 Vali Acc: 0.326 Test Loss: 2.486 Test Acc: 0.326
Validation loss decreased (-0.319117 --> -0.325604).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.1586392
	speed: 0.2255s/iter; left time: 1644.6892s
Epoch: 3 cost time: 10.898786306381226
Epoch: 3, Steps: 154 | Train Loss: 2.047 Vali Loss: 2.414 Vali Acc: 0.329 Test Loss: 2.414 Test Acc: 0.329
Validation loss decreased (-0.325604 --> -0.328849).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.6515417
	speed: 0.2235s/iter; left time: 1595.2734s
Epoch: 4 cost time: 8.600255966186523
Epoch: 4, Steps: 154 | Train Loss: 1.942 Vali Loss: 2.650 Vali Acc: 0.333 Test Loss: 2.650 Test Acc: 0.333
Validation loss decreased (-0.328849 --> -0.333307).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.8011132
	speed: 0.2001s/iter; left time: 1397.6097s
Epoch: 5 cost time: 9.258099794387817
Epoch: 5, Steps: 154 | Train Loss: 1.904 Vali Loss: 2.376 Vali Acc: 0.335 Test Loss: 2.376 Test Acc: 0.335
Validation loss decreased (-0.333307 --> -0.335337).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.2418175
	speed: 0.2430s/iter; left time: 1659.7451s
Epoch: 6 cost time: 11.742321968078613
Epoch: 6, Steps: 154 | Train Loss: 1.805 Vali Loss: 2.801 Vali Acc: 0.341 Test Loss: 2.801 Test Acc: 0.341
Validation loss decreased (-0.335337 --> -0.340605).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.9298435
	speed: 0.2189s/iter; left time: 1461.5191s
Epoch: 7 cost time: 9.27900767326355
Epoch: 7, Steps: 154 | Train Loss: 1.773 Vali Loss: 2.771 Vali Acc: 0.346 Test Loss: 2.771 Test Acc: 0.346
Validation loss decreased (-0.340605 --> -0.345877).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.9741238
	speed: 0.2228s/iter; left time: 1453.3274s
Epoch: 8 cost time: 10.77278208732605
Epoch: 8, Steps: 154 | Train Loss: 1.704 Vali Loss: 3.228 Vali Acc: 0.352 Test Loss: 3.228 Test Acc: 0.352
Validation loss decreased (-0.345877 --> -0.351955).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.7201924
	speed: 0.2211s/iter; left time: 1408.2399s
Epoch: 9 cost time: 9.544953107833862
Epoch: 9, Steps: 154 | Train Loss: 1.620 Vali Loss: 3.110 Vali Acc: 0.358 Test Loss: 3.110 Test Acc: 0.358
Validation loss decreased (-0.351955 --> -0.357633).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.8767171
	speed: 0.2378s/iter; left time: 1478.0100s
Epoch: 10 cost time: 10.062476396560669
Epoch: 10, Steps: 154 | Train Loss: 1.565 Vali Loss: 4.000 Vali Acc: 0.185 Test Loss: 4.000 Test Acc: 0.185
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.1131873
	speed: 0.2149s/iter; left time: 1302.7338s
Epoch: 11 cost time: 10.783689737319946
Epoch: 11, Steps: 154 | Train Loss: 1.496 Vali Loss: 3.497 Vali Acc: 0.189 Test Loss: 3.497 Test Acc: 0.189
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 2.0081561
	speed: 0.2030s/iter; left time: 1198.8764s
Epoch: 12 cost time: 9.030452251434326
Epoch: 12, Steps: 154 | Train Loss: 1.430 Vali Loss: 4.089 Vali Acc: 0.197 Test Loss: 4.089 Test Acc: 0.197
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.9337971
	speed: 0.1971s/iter; left time: 1133.8716s
Epoch: 13 cost time: 11.473870277404785
Epoch: 13, Steps: 154 | Train Loss: 1.434 Vali Loss: 3.783 Vali Acc: 0.227 Test Loss: 3.783 Test Acc: 0.227
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 1.5471203
	speed: 0.2453s/iter; left time: 1373.4011s
Epoch: 14 cost time: 12.50723648071289
Epoch: 14, Steps: 154 | Train Loss: 1.394 Vali Loss: 3.553 Vali Acc: 0.380 Test Loss: 3.553 Test Acc: 0.380
Validation loss decreased (-0.357633 --> -0.379932).  Saving model ...
	iters: 100, epoch: 15 | loss: 1.7770418
	speed: 0.2401s/iter; left time: 1307.4700s
Epoch: 15 cost time: 11.375818729400635
Epoch: 15, Steps: 154 | Train Loss: 1.318 Vali Loss: 4.767 Vali Acc: 0.203 Test Loss: 4.767 Test Acc: 0.203
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 1.0924498
	speed: 0.2497s/iter; left time: 1321.2233s
Epoch: 16 cost time: 11.286881923675537
Epoch: 16, Steps: 154 | Train Loss: 1.314 Vali Loss: 4.168 Vali Acc: 0.161 Test Loss: 4.168 Test Acc: 0.161
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 1.3381932
	speed: 0.2457s/iter; left time: 1262.2859s
Epoch: 17 cost time: 11.898338556289673
Epoch: 17, Steps: 154 | Train Loss: 1.267 Vali Loss: 6.196 Vali Acc: 0.204 Test Loss: 6.196 Test Acc: 0.204
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 1.1324341
	speed: 0.1684s/iter; left time: 839.1912s
Epoch: 18 cost time: 7.304141521453857
Epoch: 18, Steps: 154 | Train Loss: 1.227 Vali Loss: 7.386 Vali Acc: 0.189 Test Loss: 7.386 Test Acc: 0.189
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.9395692
	speed: 0.1622s/iter; left time: 783.3483s
Epoch: 19 cost time: 7.517891883850098
Epoch: 19, Steps: 154 | Train Loss: 1.246 Vali Loss: 7.702 Vali Acc: 0.087 Test Loss: 7.702 Test Acc: 0.087
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.8253012
	speed: 0.1396s/iter; left time: 652.4256s
Epoch: 20 cost time: 7.674301624298096
Epoch: 20, Steps: 154 | Train Loss: 1.223 Vali Loss: 9.641 Vali Acc: 0.087 Test Loss: 9.641 Test Acc: 0.087
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 1.3888811
	speed: 0.2179s/iter; left time: 985.3222s
Epoch: 21 cost time: 11.26340913772583
Epoch: 21, Steps: 154 | Train Loss: 1.200 Vali Loss: 6.940 Vali Acc: 0.085 Test Loss: 6.940 Test Acc: 0.085
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 1.0652870
	speed: 0.2045s/iter; left time: 893.0522s
Epoch: 22 cost time: 10.667716264724731
Epoch: 22, Steps: 154 | Train Loss: 1.150 Vali Loss: 8.133 Vali Acc: 0.082 Test Loss: 8.133 Test Acc: 0.082
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 1.5015455
	speed: 0.1681s/iter; left time: 708.3606s
Epoch: 23 cost time: 9.094343423843384
Epoch: 23, Steps: 154 | Train Loss: 1.134 Vali Loss: 10.012 Vali Acc: 0.082 Test Loss: 10.012 Test Acc: 0.082
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.6653132
	speed: 0.2297s/iter; left time: 932.3165s
Epoch: 24 cost time: 10.836560010910034
Epoch: 24, Steps: 154 | Train Loss: 1.094 Vali Loss: 8.829 Vali Acc: 0.089 Test Loss: 8.829 Test Acc: 0.089
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el4_dm768_df768_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3799675587996756
model parameter : 29667854
model size : 127.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el4_dm768_df768_ps2_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1946130
	speed: 0.0914s/iter; left time: 694.6357s
Epoch: 1 cost time: 11.359703779220581
Epoch: 1, Steps: 154 | Train Loss: 2.135 Vali Loss: 2.201 Vali Acc: 0.134 Test Loss: 2.201 Test Acc: 0.134
Validation loss decreased (inf --> -0.134203).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.7404157
	speed: 0.1697s/iter; left time: 1264.1244s
Epoch: 2 cost time: 8.16180682182312
Epoch: 2, Steps: 154 | Train Loss: 2.057 Vali Loss: 2.343 Vali Acc: 0.322 Test Loss: 2.343 Test Acc: 0.322
Validation loss decreased (-0.134203 --> -0.321955).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.7150379
	speed: 0.1924s/iter; left time: 1402.9817s
Epoch: 3 cost time: 7.017651557922363
Epoch: 3, Steps: 154 | Train Loss: 1.999 Vali Loss: 2.264 Vali Acc: 0.333 Test Loss: 2.264 Test Acc: 0.333
Validation loss decreased (-0.321955 --> -0.332500).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.0694129
	speed: 0.1679s/iter; left time: 1198.3635s
Epoch: 4 cost time: 6.585343599319458
Epoch: 4, Steps: 154 | Train Loss: 1.921 Vali Loss: 2.307 Vali Acc: 0.338 Test Loss: 2.307 Test Acc: 0.338
Validation loss decreased (-0.332500 --> -0.337771).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.9453794
	speed: 0.2012s/iter; left time: 1405.6040s
Epoch: 5 cost time: 8.107271432876587
Epoch: 5, Steps: 154 | Train Loss: 1.854 Vali Loss: 2.469 Vali Acc: 0.334 Test Loss: 2.469 Test Acc: 0.334
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.6225888
	speed: 0.1665s/iter; left time: 1137.5260s
Epoch: 6 cost time: 7.131728649139404
Epoch: 6, Steps: 154 | Train Loss: 1.802 Vali Loss: 2.918 Vali Acc: 0.336 Test Loss: 2.918 Test Acc: 0.336
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 2.4051850
	speed: 0.1663s/iter; left time: 1110.4853s
Epoch: 7 cost time: 9.551015615463257
Epoch: 7, Steps: 154 | Train Loss: 1.752 Vali Loss: 3.018 Vali Acc: 0.344 Test Loss: 3.018 Test Acc: 0.344
Validation loss decreased (-0.337771 --> -0.344252).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.7375325
	speed: 0.1948s/iter; left time: 1271.0048s
Epoch: 8 cost time: 6.19973087310791
Epoch: 8, Steps: 154 | Train Loss: 1.699 Vali Loss: 2.947 Vali Acc: 0.172 Test Loss: 2.947 Test Acc: 0.172
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.4472122
	speed: 0.1501s/iter; left time: 956.2558s
Epoch: 9 cost time: 8.891999959945679
Epoch: 9, Steps: 154 | Train Loss: 1.633 Vali Loss: 3.132 Vali Acc: 0.268 Test Loss: 3.132 Test Acc: 0.268
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.5641788
	speed: 0.1819s/iter; left time: 1130.4041s
Epoch: 10 cost time: 6.4290618896484375
Epoch: 10, Steps: 154 | Train Loss: 1.595 Vali Loss: 3.327 Vali Acc: 0.184 Test Loss: 3.327 Test Acc: 0.184
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.8905023
	speed: 0.1631s/iter; left time: 988.2731s
Epoch: 11 cost time: 10.547526359558105
Epoch: 11, Steps: 154 | Train Loss: 1.541 Vali Loss: 4.000 Vali Acc: 0.189 Test Loss: 4.000 Test Acc: 0.189
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 1.3219050
	speed: 0.1868s/iter; left time: 1103.2796s
Epoch: 12 cost time: 8.864721775054932
Epoch: 12, Steps: 154 | Train Loss: 1.509 Vali Loss: 3.496 Vali Acc: 0.103 Test Loss: 3.496 Test Acc: 0.103
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 1.3736398
	speed: 0.1137s/iter; left time: 654.2951s
Epoch: 13 cost time: 7.560397148132324
Epoch: 13, Steps: 154 | Train Loss: 1.482 Vali Loss: 3.921 Vali Acc: 0.057 Test Loss: 3.921 Test Acc: 0.057
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 1.7199363
	speed: 0.2125s/iter; left time: 1189.9258s
Epoch: 14 cost time: 9.215036153793335
Epoch: 14, Steps: 154 | Train Loss: 1.433 Vali Loss: 3.653 Vali Acc: 0.182 Test Loss: 3.653 Test Acc: 0.182
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 1.5383511
	speed: 0.2125s/iter; left time: 1156.8837s
Epoch: 15 cost time: 10.981009244918823
Epoch: 15, Steps: 154 | Train Loss: 1.410 Vali Loss: 3.588 Vali Acc: 0.356 Test Loss: 3.588 Test Acc: 0.356
Validation loss decreased (-0.344252 --> -0.356412).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.7961197
	speed: 0.2201s/iter; left time: 1164.5224s
Epoch: 16 cost time: 8.862195253372192
Epoch: 16, Steps: 154 | Train Loss: 1.426 Vali Loss: 3.628 Vali Acc: 0.347 Test Loss: 3.628 Test Acc: 0.347
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 1.4839436
	speed: 0.1365s/iter; left time: 700.9924s
Epoch: 17 cost time: 7.350288391113281
Epoch: 17, Steps: 154 | Train Loss: 1.351 Vali Loss: 4.385 Vali Acc: 0.084 Test Loss: 4.385 Test Acc: 0.084
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.9802505
	speed: 0.1400s/iter; left time: 697.3767s
Epoch: 18 cost time: 7.362333297729492
Epoch: 18, Steps: 154 | Train Loss: 1.319 Vali Loss: 3.966 Vali Acc: 0.112 Test Loss: 3.966 Test Acc: 0.112
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 1.1789417
	speed: 0.2052s/iter; left time: 991.1027s
Epoch: 19 cost time: 10.072744846343994
Epoch: 19, Steps: 154 | Train Loss: 1.295 Vali Loss: 4.550 Vali Acc: 0.186 Test Loss: 4.550 Test Acc: 0.186
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.7208810
	speed: 0.1804s/iter; left time: 843.2557s
Epoch: 20 cost time: 8.700741291046143
Epoch: 20, Steps: 154 | Train Loss: 1.270 Vali Loss: 5.452 Vali Acc: 0.065 Test Loss: 5.452 Test Acc: 0.065
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 1.5113363
	speed: 0.1641s/iter; left time: 741.7637s
Epoch: 21 cost time: 7.601092576980591
Epoch: 21, Steps: 154 | Train Loss: 1.284 Vali Loss: 5.853 Vali Acc: 0.063 Test Loss: 5.853 Test Acc: 0.063
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 1.0417644
	speed: 0.2078s/iter; left time: 907.5504s
Epoch: 22 cost time: 10.314836263656616
Epoch: 22, Steps: 154 | Train Loss: 1.205 Vali Loss: 6.587 Vali Acc: 0.064 Test Loss: 6.587 Test Acc: 0.064
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 1.4413447
	speed: 0.1755s/iter; left time: 739.4369s
Epoch: 23 cost time: 6.801604986190796
Epoch: 23, Steps: 154 | Train Loss: 1.206 Vali Loss: 5.442 Vali Acc: 0.070 Test Loss: 5.442 Test Acc: 0.070
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 1.5985707
	speed: 0.1303s/iter; left time: 528.9714s
Epoch: 24 cost time: 6.529859781265259
Epoch: 24, Steps: 154 | Train Loss: 1.211 Vali Loss: 7.174 Vali Acc: 0.071 Test Loss: 7.174 Test Acc: 0.071
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 2.1119974
	speed: 0.1518s/iter; left time: 592.8889s
Epoch: 25 cost time: 8.360552310943604
Epoch: 25, Steps: 154 | Train Loss: 1.166 Vali Loss: 7.623 Vali Acc: 0.067 Test Loss: 7.623 Test Acc: 0.067
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el4_dm768_df768_ps2_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3564476885644769
model parameter : 29458958
model size : 127.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el4_dm768_df768_ps3_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.7272105
	speed: 0.0798s/iter; left time: 606.2711s
Epoch: 1 cost time: 11.275098323822021
Epoch: 1, Steps: 154 | Train Loss: 2.189 Vali Loss: 2.221 Vali Acc: 0.320 Test Loss: 2.221 Test Acc: 0.320
Validation loss decreased (inf --> -0.319524).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.1234188
	speed: 0.2084s/iter; left time: 1552.3148s
Epoch: 2 cost time: 11.307912111282349
Epoch: 2, Steps: 154 | Train Loss: 2.117 Vali Loss: 2.451 Vali Acc: 0.321 Test Loss: 2.451 Test Acc: 0.321
Validation loss decreased (-0.319524 --> -0.320738).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.3476055
	speed: 0.2291s/iter; left time: 1671.0707s
Epoch: 3 cost time: 9.15941572189331
Epoch: 3, Steps: 154 | Train Loss: 2.042 Vali Loss: 2.496 Vali Acc: 0.326 Test Loss: 2.496 Test Acc: 0.326
Validation loss decreased (-0.320738 --> -0.325604).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.0199533
	speed: 0.2138s/iter; left time: 1526.1122s
Epoch: 4 cost time: 10.89772915840149
Epoch: 4, Steps: 154 | Train Loss: 1.959 Vali Loss: 2.450 Vali Acc: 0.333 Test Loss: 2.450 Test Acc: 0.333
Validation loss decreased (-0.325604 --> -0.333309).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.9775552
	speed: 0.2217s/iter; left time: 1548.8147s
Epoch: 5 cost time: 11.50558590888977
Epoch: 5, Steps: 154 | Train Loss: 1.856 Vali Loss: 2.694 Vali Acc: 0.333 Test Loss: 2.694 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.8331578
	speed: 0.2492s/iter; left time: 1701.9619s
Epoch: 6 cost time: 10.710198402404785
Epoch: 6, Steps: 154 | Train Loss: 1.775 Vali Loss: 2.799 Vali Acc: 0.351 Test Loss: 2.799 Test Acc: 0.351
Validation loss decreased (-0.333309 --> -0.350742).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.5186749
	speed: 0.2270s/iter; left time: 1515.9658s
Epoch: 7 cost time: 11.299570322036743
Epoch: 7, Steps: 154 | Train Loss: 1.674 Vali Loss: 2.739 Vali Acc: 0.360 Test Loss: 2.739 Test Acc: 0.360
Validation loss decreased (-0.350742 --> -0.359664).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.1820161
	speed: 0.2556s/iter; left time: 1667.4270s
Epoch: 8 cost time: 10.685246706008911
Epoch: 8, Steps: 154 | Train Loss: 1.611 Vali Loss: 3.154 Vali Acc: 0.197 Test Loss: 3.154 Test Acc: 0.197
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.4825668
	speed: 0.2454s/iter; left time: 1562.7877s
Epoch: 9 cost time: 10.985741376876831
Epoch: 9, Steps: 154 | Train Loss: 1.566 Vali Loss: 3.405 Vali Acc: 0.189 Test Loss: 3.405 Test Acc: 0.189
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.1681004
	speed: 0.1340s/iter; left time: 832.8472s
Epoch: 10 cost time: 5.697769403457642
Epoch: 10, Steps: 154 | Train Loss: 1.467 Vali Loss: 3.361 Vali Acc: 0.378 Test Loss: 3.361 Test Acc: 0.378
Validation loss decreased (-0.359664 --> -0.377906).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.3859965
	speed: 0.1906s/iter; left time: 1154.9919s
Epoch: 11 cost time: 8.490006923675537
Epoch: 11, Steps: 154 | Train Loss: 1.430 Vali Loss: 4.343 Vali Acc: 0.211 Test Loss: 4.343 Test Acc: 0.211
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.2378633
	speed: 0.1589s/iter; left time: 938.9029s
Epoch: 12 cost time: 7.747368574142456
Epoch: 12, Steps: 154 | Train Loss: 1.397 Vali Loss: 3.537 Vali Acc: 0.213 Test Loss: 3.537 Test Acc: 0.213
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.7670068
	speed: 0.1341s/iter; left time: 771.3826s
Epoch: 13 cost time: 7.6413960456848145
Epoch: 13, Steps: 154 | Train Loss: 1.348 Vali Loss: 4.700 Vali Acc: 0.178 Test Loss: 4.700 Test Acc: 0.178
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 1.2830040
	speed: 0.2058s/iter; left time: 1152.2441s
Epoch: 14 cost time: 11.023919105529785
Epoch: 14, Steps: 154 | Train Loss: 1.319 Vali Loss: 4.328 Vali Acc: 0.291 Test Loss: 4.328 Test Acc: 0.291
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.9095007
	speed: 0.2132s/iter; left time: 1160.9238s
Epoch: 15 cost time: 11.381333589553833
Epoch: 15, Steps: 154 | Train Loss: 1.278 Vali Loss: 6.762 Vali Acc: 0.067 Test Loss: 6.762 Test Acc: 0.067
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 1.4481591
	speed: 0.1939s/iter; left time: 1025.7394s
Epoch: 16 cost time: 10.532728672027588
Epoch: 16, Steps: 154 | Train Loss: 1.265 Vali Loss: 7.105 Vali Acc: 0.082 Test Loss: 7.105 Test Acc: 0.082
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 1.8553363
	speed: 0.1976s/iter; left time: 1015.2784s
Epoch: 17 cost time: 10.069056749343872
Epoch: 17, Steps: 154 | Train Loss: 1.202 Vali Loss: 8.095 Vali Acc: 0.071 Test Loss: 8.095 Test Acc: 0.071
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 1.4018878
	speed: 0.1843s/iter; left time: 918.4878s
Epoch: 18 cost time: 8.943444728851318
Epoch: 18, Steps: 154 | Train Loss: 1.173 Vali Loss: 8.772 Vali Acc: 0.077 Test Loss: 8.772 Test Acc: 0.077
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.2939805
	speed: 0.1741s/iter; left time: 840.5046s
Epoch: 19 cost time: 6.930191993713379
Epoch: 19, Steps: 154 | Train Loss: 1.179 Vali Loss: 10.890 Vali Acc: 0.070 Test Loss: 10.890 Test Acc: 0.070
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 1.0594256
	speed: 0.1472s/iter; left time: 687.9423s
Epoch: 20 cost time: 7.632612705230713
Epoch: 20, Steps: 154 | Train Loss: 1.173 Vali Loss: 9.486 Vali Acc: 0.079 Test Loss: 9.486 Test Acc: 0.079
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el4_dm768_df768_ps3_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.37793998377939986
model parameter : 29669390
model size : 127.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el4_dm768_df768_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.7707958
	speed: 0.0727s/iter; left time: 552.3302s
Epoch: 1 cost time: 9.948943138122559
Epoch: 1, Steps: 154 | Train Loss: 2.119 Vali Loss: 2.442 Vali Acc: 0.317 Test Loss: 2.442 Test Acc: 0.317
Validation loss decreased (inf --> -0.317088).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.3753378
	speed: 0.1868s/iter; left time: 1390.9031s
Epoch: 2 cost time: 8.92203664779663
Epoch: 2, Steps: 154 | Train Loss: 2.064 Vali Loss: 2.243 Vali Acc: 0.327 Test Loss: 2.243 Test Acc: 0.327
Validation loss decreased (-0.317088 --> -0.327228).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.3182893
	speed: 0.1914s/iter; left time: 1395.6921s
Epoch: 3 cost time: 6.199760913848877
Epoch: 3, Steps: 154 | Train Loss: 1.995 Vali Loss: 2.272 Vali Acc: 0.185 Test Loss: 2.272 Test Acc: 0.185
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.9193814
	speed: 0.1311s/iter; left time: 935.9414s
Epoch: 4 cost time: 5.996286153793335
Epoch: 4, Steps: 154 | Train Loss: 1.884 Vali Loss: 2.488 Vali Acc: 0.337 Test Loss: 2.488 Test Acc: 0.337
Validation loss decreased (-0.327228 --> -0.336958).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.6272655
	speed: 0.1783s/iter; left time: 1245.7229s
Epoch: 5 cost time: 9.387637853622437
Epoch: 5, Steps: 154 | Train Loss: 1.827 Vali Loss: 2.264 Vali Acc: 0.342 Test Loss: 2.264 Test Acc: 0.342
Validation loss decreased (-0.336958 --> -0.341827).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.0366380
	speed: 0.2208s/iter; left time: 1508.2608s
Epoch: 6 cost time: 9.899499893188477
Epoch: 6, Steps: 154 | Train Loss: 1.758 Vali Loss: 2.753 Vali Acc: 0.173 Test Loss: 2.753 Test Acc: 0.173
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.0527275
	speed: 0.2007s/iter; left time: 1340.0292s
Epoch: 7 cost time: 9.517576217651367
Epoch: 7, Steps: 154 | Train Loss: 1.677 Vali Loss: 2.949 Vali Acc: 0.182 Test Loss: 2.949 Test Acc: 0.182
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.2441220
	speed: 0.1689s/iter; left time: 1101.4994s
Epoch: 8 cost time: 8.892706155776978
Epoch: 8, Steps: 154 | Train Loss: 1.598 Vali Loss: 2.916 Vali Acc: 0.177 Test Loss: 2.916 Test Acc: 0.177
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 1.5090772
	speed: 0.1777s/iter; left time: 1131.5314s
Epoch: 9 cost time: 8.068435192108154
Epoch: 9, Steps: 154 | Train Loss: 1.617 Vali Loss: 3.095 Vali Acc: 0.101 Test Loss: 3.095 Test Acc: 0.101
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 1.6207782
	speed: 0.1485s/iter; left time: 923.0087s
Epoch: 10 cost time: 6.604417324066162
Epoch: 10, Steps: 154 | Train Loss: 1.534 Vali Loss: 3.520 Vali Acc: 0.194 Test Loss: 3.520 Test Acc: 0.194
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 1.5081320
	speed: 0.1653s/iter; left time: 1002.1463s
Epoch: 11 cost time: 8.170634269714355
Epoch: 11, Steps: 154 | Train Loss: 1.491 Vali Loss: 3.352 Vali Acc: 0.179 Test Loss: 3.352 Test Acc: 0.179
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 1.3055147
	speed: 0.1516s/iter; left time: 895.3881s
Epoch: 12 cost time: 6.303924083709717
Epoch: 12, Steps: 154 | Train Loss: 1.450 Vali Loss: 3.958 Vali Acc: 0.153 Test Loss: 3.958 Test Acc: 0.153
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 1.5245576
	speed: 0.1229s/iter; left time: 706.8073s
Epoch: 13 cost time: 5.494859933853149
Epoch: 13, Steps: 154 | Train Loss: 1.393 Vali Loss: 4.199 Vali Acc: 0.077 Test Loss: 4.199 Test Acc: 0.077
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.9139937
	speed: 0.1311s/iter; left time: 734.2849s
Epoch: 14 cost time: 8.546330213546753
Epoch: 14, Steps: 154 | Train Loss: 1.350 Vali Loss: 5.458 Vali Acc: 0.189 Test Loss: 5.458 Test Acc: 0.189
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 1.3847340
	speed: 0.1202s/iter; left time: 654.7344s
Epoch: 15 cost time: 4.530107498168945
Epoch: 15, Steps: 154 | Train Loss: 1.327 Vali Loss: 5.001 Vali Acc: 0.083 Test Loss: 5.001 Test Acc: 0.083
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el4_dm768_df768_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3418491484184915
model parameter : 29460494
model size : 127.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el4_dm768_df768_ps3_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.5532936
	speed: 0.0425s/iter; left time: 322.8921s
Epoch: 1 cost time: 6.349180221557617
Epoch: 1, Steps: 154 | Train Loss: 2.118 Vali Loss: 2.191 Vali Acc: 0.322 Test Loss: 2.191 Test Acc: 0.322
Validation loss decreased (inf --> -0.321551).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8151107
	speed: 0.1332s/iter; left time: 991.9914s
Epoch: 2 cost time: 5.256002902984619
Epoch: 2, Steps: 154 | Train Loss: 2.038 Vali Loss: 2.291 Vali Acc: 0.165 Test Loss: 2.291 Test Acc: 0.165
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.9176770
	speed: 0.1179s/iter; left time: 859.5093s
Epoch: 3 cost time: 4.677304744720459
Epoch: 3, Steps: 154 | Train Loss: 1.988 Vali Loss: 2.325 Vali Acc: 0.323 Test Loss: 2.325 Test Acc: 0.323
Validation loss decreased (-0.321551 --> -0.322767).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.8558360
	speed: 0.1460s/iter; left time: 1042.2169s
Epoch: 4 cost time: 5.074110269546509
Epoch: 4, Steps: 154 | Train Loss: 1.912 Vali Loss: 2.491 Vali Acc: 0.328 Test Loss: 2.491 Test Acc: 0.328
Validation loss decreased (-0.322767 --> -0.327631).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.4466033
	speed: 0.1296s/iter; left time: 904.9538s
Epoch: 5 cost time: 4.277687072753906
Epoch: 5, Steps: 154 | Train Loss: 1.835 Vali Loss: 2.745 Vali Acc: 0.336 Test Loss: 2.745 Test Acc: 0.336
Validation loss decreased (-0.327631 --> -0.335739).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.4370513
	speed: 0.1233s/iter; left time: 842.2983s
Epoch: 6 cost time: 4.16016697883606
Epoch: 6, Steps: 154 | Train Loss: 1.753 Vali Loss: 2.878 Vali Acc: 0.354 Test Loss: 2.878 Test Acc: 0.354
Validation loss decreased (-0.335739 --> -0.353580).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.5016474
	speed: 0.1026s/iter; left time: 685.3313s
Epoch: 7 cost time: 3.751600742340088
Epoch: 7, Steps: 154 | Train Loss: 1.696 Vali Loss: 2.719 Vali Acc: 0.354 Test Loss: 2.719 Test Acc: 0.354
Validation loss decreased (-0.353580 --> -0.354393).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.9392139
	speed: 0.1542s/iter; left time: 1005.9708s
Epoch: 8 cost time: 6.09785008430481
Epoch: 8, Steps: 154 | Train Loss: 1.631 Vali Loss: 3.140 Vali Acc: 0.178 Test Loss: 3.140 Test Acc: 0.178
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.3642061
	speed: 0.1498s/iter; left time: 954.1643s
Epoch: 9 cost time: 6.537169694900513
Epoch: 9, Steps: 154 | Train Loss: 1.590 Vali Loss: 3.319 Vali Acc: 0.184 Test Loss: 3.319 Test Acc: 0.184
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 2.0625446
	speed: 0.1349s/iter; left time: 838.4853s
Epoch: 10 cost time: 5.902645111083984
Epoch: 10, Steps: 154 | Train Loss: 1.571 Vali Loss: 3.499 Vali Acc: 0.183 Test Loss: 3.499 Test Acc: 0.183
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.5518963
	speed: 0.1171s/iter; left time: 710.0315s
Epoch: 11 cost time: 4.03462290763855
Epoch: 11, Steps: 154 | Train Loss: 1.510 Vali Loss: 3.371 Vali Acc: 0.187 Test Loss: 3.371 Test Acc: 0.187
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 1.2772753
	speed: 0.1240s/iter; left time: 732.6645s
Epoch: 12 cost time: 6.037034749984741
Epoch: 12, Steps: 154 | Train Loss: 1.487 Vali Loss: 3.570 Vali Acc: 0.118 Test Loss: 3.570 Test Acc: 0.118
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 1.0604891
	speed: 0.1479s/iter; left time: 850.9122s
Epoch: 13 cost time: 6.095491170883179
Epoch: 13, Steps: 154 | Train Loss: 1.433 Vali Loss: 3.497 Vali Acc: 0.321 Test Loss: 3.497 Test Acc: 0.321
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 1.2797246
	speed: 0.1227s/iter; left time: 687.0765s
Epoch: 14 cost time: 3.95027232170105
Epoch: 14, Steps: 154 | Train Loss: 1.394 Vali Loss: 4.402 Vali Acc: 0.138 Test Loss: 4.402 Test Acc: 0.138
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 1.1137172
	speed: 0.1142s/iter; left time: 621.8100s
Epoch: 15 cost time: 4.698582172393799
Epoch: 15, Steps: 154 | Train Loss: 1.384 Vali Loss: 4.020 Vali Acc: 0.184 Test Loss: 4.020 Test Acc: 0.184
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 1.6741918
	speed: 0.1167s/iter; left time: 617.6499s
Epoch: 16 cost time: 5.09261155128479
Epoch: 16, Steps: 154 | Train Loss: 1.340 Vali Loss: 4.084 Vali Acc: 0.119 Test Loss: 4.084 Test Acc: 0.119
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 1.9266903
	speed: 0.1137s/iter; left time: 583.9505s
Epoch: 17 cost time: 5.339174270629883
Epoch: 17, Steps: 154 | Train Loss: 1.336 Vali Loss: 4.184 Vali Acc: 0.135 Test Loss: 4.184 Test Acc: 0.135
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el4_dm768_df768_ps3_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3544201135442011
model parameter : 29399054
model size : 126.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el4_dm768_df768_ps4_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.8667265
	speed: 0.0516s/iter; left time: 392.5479s
Epoch: 1 cost time: 6.756565809249878
Epoch: 1, Steps: 154 | Train Loss: 2.206 Vali Loss: 2.209 Vali Acc: 0.329 Test Loss: 2.209 Test Acc: 0.329
Validation loss decreased (inf --> -0.328851).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.5617244
	speed: 0.1101s/iter; left time: 819.9426s
Epoch: 2 cost time: 7.211676120758057
Epoch: 2, Steps: 154 | Train Loss: 2.109 Vali Loss: 2.296 Vali Acc: 0.169 Test Loss: 2.296 Test Acc: 0.169
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.9428484
	speed: 0.2036s/iter; left time: 1485.0395s
Epoch: 3 cost time: 10.925886631011963
Epoch: 3, Steps: 154 | Train Loss: 2.056 Vali Loss: 2.798 Vali Acc: 0.330 Test Loss: 2.798 Test Acc: 0.330
Validation loss decreased (-0.328851 --> -0.330467).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.9788330
	speed: 0.2256s/iter; left time: 1610.3397s
Epoch: 4 cost time: 8.938610553741455
Epoch: 4, Steps: 154 | Train Loss: 1.953 Vali Loss: 2.708 Vali Acc: 0.333 Test Loss: 2.708 Test Acc: 0.333
Validation loss decreased (-0.330467 --> -0.332495).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.9968021
	speed: 0.1862s/iter; left time: 1300.5210s
Epoch: 5 cost time: 8.253988027572632
Epoch: 5, Steps: 154 | Train Loss: 1.846 Vali Loss: 2.830 Vali Acc: 0.341 Test Loss: 2.830 Test Acc: 0.341
Validation loss decreased (-0.332495 --> -0.340604).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.5638366
	speed: 0.2572s/iter; left time: 1756.5941s
Epoch: 6 cost time: 11.406579494476318
Epoch: 6, Steps: 154 | Train Loss: 1.766 Vali Loss: 3.026 Vali Acc: 0.207 Test Loss: 3.026 Test Acc: 0.207
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.6562523
	speed: 0.2019s/iter; left time: 1347.8473s
Epoch: 7 cost time: 7.515665292739868
Epoch: 7, Steps: 154 | Train Loss: 1.761 Vali Loss: 3.159 Vali Acc: 0.089 Test Loss: 3.159 Test Acc: 0.089
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.8801961
	speed: 0.1708s/iter; left time: 1114.4315s
Epoch: 8 cost time: 7.81864857673645
Epoch: 8, Steps: 154 | Train Loss: 1.624 Vali Loss: 3.296 Vali Acc: 0.338 Test Loss: 3.296 Test Acc: 0.338
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 1.4946538
	speed: 0.1516s/iter; left time: 965.7248s
Epoch: 9 cost time: 10.23014497756958
Epoch: 9, Steps: 154 | Train Loss: 1.552 Vali Loss: 3.427 Vali Acc: 0.105 Test Loss: 3.427 Test Acc: 0.105
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 1.5200460
	speed: 0.1999s/iter; left time: 1242.4186s
Epoch: 10 cost time: 10.253840446472168
Epoch: 10, Steps: 154 | Train Loss: 1.499 Vali Loss: 3.247 Vali Acc: 0.353 Test Loss: 3.247 Test Acc: 0.353
Validation loss decreased (-0.340604 --> -0.353171).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.1586677
	speed: 0.2147s/iter; left time: 1301.0190s
Epoch: 11 cost time: 10.227305889129639
Epoch: 11, Steps: 154 | Train Loss: 1.444 Vali Loss: 3.529 Vali Acc: 0.129 Test Loss: 3.529 Test Acc: 0.129
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.1070697
	speed: 0.2203s/iter; left time: 1301.0336s
Epoch: 12 cost time: 10.019160985946655
Epoch: 12, Steps: 154 | Train Loss: 1.412 Vali Loss: 4.756 Vali Acc: 0.105 Test Loss: 4.756 Test Acc: 0.105
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.1988683
	speed: 0.1782s/iter; left time: 1024.8977s
Epoch: 13 cost time: 9.056919574737549
Epoch: 13, Steps: 154 | Train Loss: 1.361 Vali Loss: 3.503 Vali Acc: 0.135 Test Loss: 3.503 Test Acc: 0.135
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 1.3501853
	speed: 0.1844s/iter; left time: 1032.3834s
Epoch: 14 cost time: 9.729681015014648
Epoch: 14, Steps: 154 | Train Loss: 1.326 Vali Loss: 4.433 Vali Acc: 0.067 Test Loss: 4.433 Test Acc: 0.067
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 2.1125979
	speed: 0.2166s/iter; left time: 1179.2500s
Epoch: 15 cost time: 9.925752639770508
Epoch: 15, Steps: 154 | Train Loss: 1.323 Vali Loss: 4.659 Vali Acc: 0.065 Test Loss: 4.659 Test Acc: 0.065
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 1.2195475
	speed: 0.1972s/iter; left time: 1043.5690s
Epoch: 16 cost time: 9.63259482383728
Epoch: 16, Steps: 154 | Train Loss: 1.296 Vali Loss: 5.064 Vali Acc: 0.105 Test Loss: 5.064 Test Acc: 0.105
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 1.8094915
	speed: 0.2115s/iter; left time: 1086.2815s
Epoch: 17 cost time: 12.441805124282837
Epoch: 17, Steps: 154 | Train Loss: 1.280 Vali Loss: 4.936 Vali Acc: 0.116 Test Loss: 4.936 Test Acc: 0.116
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 1.0527161
	speed: 0.2272s/iter; left time: 1132.0584s
Epoch: 18 cost time: 10.371012449264526
Epoch: 18, Steps: 154 | Train Loss: 1.238 Vali Loss: 4.597 Vali Acc: 0.191 Test Loss: 4.597 Test Acc: 0.191
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.9714263
	speed: 0.1917s/iter; left time: 925.5450s
Epoch: 19 cost time: 7.696156978607178
Epoch: 19, Steps: 154 | Train Loss: 1.201 Vali Loss: 4.457 Vali Acc: 0.199 Test Loss: 4.457 Test Acc: 0.199
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.7293023
	speed: 0.1875s/iter; left time: 876.4168s
Epoch: 20 cost time: 9.610273599624634
Epoch: 20, Steps: 154 | Train Loss: 1.202 Vali Loss: 5.431 Vali Acc: 0.079 Test Loss: 5.431 Test Acc: 0.079
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el4_dm768_df768_ps4_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.35320356853203566
model parameter : 29670926
model size : 127.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el4_dm768_df768_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.6301178
	speed: 0.0713s/iter; left time: 541.6632s
Epoch: 1 cost time: 10.469789743423462
Epoch: 1, Steps: 154 | Train Loss: 2.130 Vali Loss: 2.300 Vali Acc: 0.320 Test Loss: 2.300 Test Acc: 0.320
Validation loss decreased (inf --> -0.319523).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9881011
	speed: 0.2023s/iter; left time: 1506.8570s
Epoch: 2 cost time: 10.041246175765991
Epoch: 2, Steps: 154 | Train Loss: 2.045 Vali Loss: 2.140 Vali Acc: 0.324 Test Loss: 2.140 Test Acc: 0.324
Validation loss decreased (-0.319523 --> -0.323580).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.2426901
	speed: 0.1952s/iter; left time: 1423.7944s
Epoch: 3 cost time: 7.304823398590088
Epoch: 3, Steps: 154 | Train Loss: 1.976 Vali Loss: 2.377 Vali Acc: 0.325 Test Loss: 2.377 Test Acc: 0.325
Validation loss decreased (-0.323580 --> -0.325199).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.0295103
	speed: 0.2829s/iter; left time: 2019.7963s
Epoch: 4 cost time: 10.567433834075928
Epoch: 4, Steps: 154 | Train Loss: 1.922 Vali Loss: 2.370 Vali Acc: 0.330 Test Loss: 2.370 Test Acc: 0.330
Validation loss decreased (-0.325199 --> -0.329660).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.0789335
	speed: 0.2100s/iter; left time: 1466.5073s
Epoch: 5 cost time: 10.31651782989502
Epoch: 5, Steps: 154 | Train Loss: 1.836 Vali Loss: 2.263 Vali Acc: 0.339 Test Loss: 2.263 Test Acc: 0.339
Validation loss decreased (-0.329660 --> -0.339393).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.7552207
	speed: 0.2328s/iter; left time: 1590.1324s
Epoch: 6 cost time: 8.438673496246338
Epoch: 6, Steps: 154 | Train Loss: 1.735 Vali Loss: 2.583 Vali Acc: 0.350 Test Loss: 2.583 Test Acc: 0.350
Validation loss decreased (-0.339393 --> -0.349528).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.9380128
	speed: 0.1876s/iter; left time: 1252.8787s
Epoch: 7 cost time: 7.128544330596924
Epoch: 7, Steps: 154 | Train Loss: 1.708 Vali Loss: 2.307 Vali Acc: 0.366 Test Loss: 2.307 Test Acc: 0.366
Validation loss decreased (-0.349528 --> -0.365751).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.9136646
	speed: 0.1633s/iter; left time: 1065.2015s
Epoch: 8 cost time: 6.9927451610565186
Epoch: 8, Steps: 154 | Train Loss: 1.621 Vali Loss: 2.736 Vali Acc: 0.178 Test Loss: 2.736 Test Acc: 0.178
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.6982161
	speed: 0.1741s/iter; left time: 1109.1557s
Epoch: 9 cost time: 9.499056100845337
Epoch: 9, Steps: 154 | Train Loss: 1.592 Vali Loss: 2.967 Vali Acc: 0.347 Test Loss: 2.967 Test Acc: 0.347
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.4454859
	speed: 0.1247s/iter; left time: 775.0727s
Epoch: 10 cost time: 8.411888122558594
Epoch: 10, Steps: 154 | Train Loss: 1.534 Vali Loss: 3.151 Vali Acc: 0.365 Test Loss: 3.151 Test Acc: 0.365
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.6614931
	speed: 0.2128s/iter; left time: 1289.8988s
Epoch: 11 cost time: 9.63247013092041
Epoch: 11, Steps: 154 | Train Loss: 1.489 Vali Loss: 3.053 Vali Acc: 0.300 Test Loss: 3.053 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 1.2677020
	speed: 0.1824s/iter; left time: 1077.4224s
Epoch: 12 cost time: 9.299835443496704
Epoch: 12, Steps: 154 | Train Loss: 1.434 Vali Loss: 3.211 Vali Acc: 0.133 Test Loss: 3.211 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 1.0436879
	speed: 0.2082s/iter; left time: 1197.8050s
Epoch: 13 cost time: 9.60775876045227
Epoch: 13, Steps: 154 | Train Loss: 1.397 Vali Loss: 3.364 Vali Acc: 0.148 Test Loss: 3.364 Test Acc: 0.148
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 1.5396758
	speed: 0.1902s/iter; left time: 1064.8035s
Epoch: 14 cost time: 8.01399850845337
Epoch: 14, Steps: 154 | Train Loss: 1.362 Vali Loss: 3.662 Vali Acc: 0.152 Test Loss: 3.662 Test Acc: 0.152
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 1.5134027
	speed: 0.1774s/iter; left time: 965.7915s
Epoch: 15 cost time: 7.709783315658569
Epoch: 15, Steps: 154 | Train Loss: 1.341 Vali Loss: 3.167 Vali Acc: 0.380 Test Loss: 3.167 Test Acc: 0.380
Validation loss decreased (-0.365751 --> -0.379936).  Saving model ...
	iters: 100, epoch: 16 | loss: 1.1073338
	speed: 0.1928s/iter; left time: 1020.0908s
Epoch: 16 cost time: 9.30559515953064
Epoch: 16, Steps: 154 | Train Loss: 1.320 Vali Loss: 3.099 Vali Acc: 0.220 Test Loss: 3.099 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 1.3345855
	speed: 0.1933s/iter; left time: 992.9917s
Epoch: 17 cost time: 10.87349247932434
Epoch: 17, Steps: 154 | Train Loss: 1.260 Vali Loss: 3.675 Vali Acc: 0.100 Test Loss: 3.675 Test Acc: 0.100
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 1.0021600
	speed: 0.1861s/iter; left time: 927.3767s
Epoch: 18 cost time: 6.293485164642334
Epoch: 18, Steps: 154 | Train Loss: 1.244 Vali Loss: 4.299 Vali Acc: 0.130 Test Loss: 4.299 Test Acc: 0.130
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 1.3180194
	speed: 0.1375s/iter; left time: 664.1510s
Epoch: 19 cost time: 6.289325952529907
Epoch: 19, Steps: 154 | Train Loss: 1.240 Vali Loss: 5.527 Vali Acc: 0.087 Test Loss: 5.527 Test Acc: 0.087
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 1.6316044
	speed: 0.1745s/iter; left time: 815.7252s
Epoch: 20 cost time: 9.66196584701538
Epoch: 20, Steps: 154 | Train Loss: 1.181 Vali Loss: 4.938 Vali Acc: 0.208 Test Loss: 4.938 Test Acc: 0.208
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 1.5740362
	speed: 0.1683s/iter; left time: 760.7140s
Epoch: 21 cost time: 8.755151987075806
Epoch: 21, Steps: 154 | Train Loss: 1.187 Vali Loss: 4.429 Vali Acc: 0.193 Test Loss: 4.429 Test Acc: 0.193
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.9130318
	speed: 0.1488s/iter; left time: 649.7851s
Epoch: 22 cost time: 8.114380121231079
Epoch: 22, Steps: 154 | Train Loss: 1.150 Vali Loss: 4.281 Vali Acc: 0.114 Test Loss: 4.281 Test Acc: 0.114
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 1.1118150
	speed: 0.1847s/iter; left time: 778.3029s
Epoch: 23 cost time: 8.7125825881958
Epoch: 23, Steps: 154 | Train Loss: 1.110 Vali Loss: 5.862 Vali Acc: 0.086 Test Loss: 5.862 Test Acc: 0.086
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.6778145
	speed: 0.1696s/iter; left time: 688.5413s
Epoch: 24 cost time: 8.726196050643921
Epoch: 24, Steps: 154 | Train Loss: 1.104 Vali Loss: 4.752 Vali Acc: 0.091 Test Loss: 4.752 Test Acc: 0.091
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.8292248
	speed: 0.1441s/iter; left time: 562.7395s
Epoch: 25 cost time: 5.65490198135376
Epoch: 25, Steps: 154 | Train Loss: 1.070 Vali Loss: 6.228 Vali Acc: 0.084 Test Loss: 6.228 Test Acc: 0.084
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el4_dm768_df768_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3799675587996756
model parameter : 29474318
model size : 127.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el4_dm768_df768_ps4_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.8250399
	speed: 0.0428s/iter; left time: 325.0179s
Epoch: 1 cost time: 5.413928031921387
Epoch: 1, Steps: 154 | Train Loss: 2.117 Vali Loss: 2.161 Vali Acc: 0.318 Test Loss: 2.161 Test Acc: 0.318
Validation loss decreased (inf --> -0.317902).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0653474
	speed: 0.0858s/iter; left time: 639.3193s
Epoch: 2 cost time: 5.10076117515564
Epoch: 2, Steps: 154 | Train Loss: 2.028 Vali Loss: 2.141 Vali Acc: 0.327 Test Loss: 2.141 Test Acc: 0.327
Validation loss decreased (-0.317902 --> -0.326824).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.0011897
	speed: 0.1785s/iter; left time: 1301.6157s
Epoch: 3 cost time: 3.8494081497192383
Epoch: 3, Steps: 154 | Train Loss: 1.965 Vali Loss: 2.230 Vali Acc: 0.327 Test Loss: 2.230 Test Acc: 0.327
Validation loss decreased (-0.326824 --> -0.327228).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.1675584
	speed: 0.1446s/iter; left time: 1031.9474s
Epoch: 4 cost time: 5.303692579269409
Epoch: 4, Steps: 154 | Train Loss: 1.926 Vali Loss: 2.480 Vali Acc: 0.323 Test Loss: 2.480 Test Acc: 0.323
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.5461675
	speed: 0.1113s/iter; left time: 777.2819s
Epoch: 5 cost time: 4.1452178955078125
Epoch: 5, Steps: 154 | Train Loss: 1.834 Vali Loss: 2.908 Vali Acc: 0.329 Test Loss: 2.908 Test Acc: 0.329
Validation loss decreased (-0.327228 --> -0.329249).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.7383393
	speed: 0.1446s/iter; left time: 987.9710s
Epoch: 6 cost time: 5.025855779647827
Epoch: 6, Steps: 154 | Train Loss: 1.746 Vali Loss: 2.926 Vali Acc: 0.339 Test Loss: 2.926 Test Acc: 0.339
Validation loss decreased (-0.329249 --> -0.338576).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.1051301
	speed: 0.1440s/iter; left time: 961.3831s
Epoch: 7 cost time: 5.243375062942505
Epoch: 7, Steps: 154 | Train Loss: 1.695 Vali Loss: 2.739 Vali Acc: 0.186 Test Loss: 2.739 Test Acc: 0.186
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.3102114
	speed: 0.1353s/iter; left time: 882.6086s
Epoch: 8 cost time: 5.456045627593994
Epoch: 8, Steps: 154 | Train Loss: 1.624 Vali Loss: 3.082 Vali Acc: 0.088 Test Loss: 3.082 Test Acc: 0.088
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.3010842
	speed: 0.1179s/iter; left time: 750.9493s
Epoch: 9 cost time: 5.5365355014801025
Epoch: 9, Steps: 154 | Train Loss: 1.583 Vali Loss: 2.779 Vali Acc: 0.350 Test Loss: 2.779 Test Acc: 0.350
Validation loss decreased (-0.338576 --> -0.349932).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.3099513
	speed: 0.2046s/iter; left time: 1271.4459s
Epoch: 10 cost time: 3.7380101680755615
Epoch: 10, Steps: 154 | Train Loss: 1.522 Vali Loss: 3.384 Vali Acc: 0.181 Test Loss: 3.384 Test Acc: 0.181
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.7617868
	speed: 0.1143s/iter; left time: 692.8693s
Epoch: 11 cost time: 4.963147401809692
Epoch: 11, Steps: 154 | Train Loss: 1.464 Vali Loss: 3.811 Vali Acc: 0.187 Test Loss: 3.811 Test Acc: 0.187
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.1912061
	speed: 0.1155s/iter; left time: 682.2842s
Epoch: 12 cost time: 4.845576763153076
Epoch: 12, Steps: 154 | Train Loss: 1.466 Vali Loss: 3.684 Vali Acc: 0.192 Test Loss: 3.684 Test Acc: 0.192
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 2.0827022
	speed: 0.1262s/iter; left time: 726.2083s
Epoch: 13 cost time: 5.930348634719849
Epoch: 13, Steps: 154 | Train Loss: 1.402 Vali Loss: 4.949 Vali Acc: 0.100 Test Loss: 4.949 Test Acc: 0.100
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.9944300
	speed: 0.1282s/iter; left time: 717.7037s
Epoch: 14 cost time: 4.010826110839844
Epoch: 14, Steps: 154 | Train Loss: 1.383 Vali Loss: 4.436 Vali Acc: 0.082 Test Loss: 4.436 Test Acc: 0.082
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 1.1170559
	speed: 0.1150s/iter; left time: 626.4207s
Epoch: 15 cost time: 4.809161186218262
Epoch: 15, Steps: 154 | Train Loss: 1.352 Vali Loss: 4.395 Vali Acc: 0.101 Test Loss: 4.395 Test Acc: 0.101
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 1.7339075
	speed: 0.1148s/iter; left time: 607.5846s
Epoch: 16 cost time: 4.4603753089904785
Epoch: 16, Steps: 154 | Train Loss: 1.319 Vali Loss: 4.829 Vali Acc: 0.182 Test Loss: 4.829 Test Acc: 0.182
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 1.4749787
	speed: 0.0954s/iter; left time: 490.2009s
Epoch: 17 cost time: 4.397925615310669
Epoch: 17, Steps: 154 | Train Loss: 1.313 Vali Loss: 4.669 Vali Acc: 0.063 Test Loss: 4.669 Test Acc: 0.063
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 1.8159213
	speed: 0.0990s/iter; left time: 493.4795s
Epoch: 18 cost time: 4.062021017074585
Epoch: 18, Steps: 154 | Train Loss: 1.297 Vali Loss: 4.091 Vali Acc: 0.193 Test Loss: 4.091 Test Acc: 0.193
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.8449873
	speed: 0.1064s/iter; left time: 513.6737s
Epoch: 19 cost time: 4.781513214111328
Epoch: 19, Steps: 154 | Train Loss: 1.267 Vali Loss: 4.355 Vali Acc: 0.144 Test Loss: 4.355 Test Acc: 0.144
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el4_dm768_df768_ps4_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3499594484995945
model parameter : 29376014
model size : 126.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el4_dm768_df768_ps5_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.8514786
	speed: 0.0604s/iter; left time: 458.9966s
Epoch: 1 cost time: 8.890402555465698
Epoch: 1, Steps: 154 | Train Loss: 2.121 Vali Loss: 2.290 Vali Acc: 0.323 Test Loss: 2.290 Test Acc: 0.323
Validation loss decreased (inf --> -0.322767).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.5064358
	speed: 0.1508s/iter; left time: 1122.6639s
Epoch: 2 cost time: 8.311937808990479
Epoch: 2, Steps: 154 | Train Loss: 2.026 Vali Loss: 2.256 Vali Acc: 0.325 Test Loss: 2.256 Test Acc: 0.325
Validation loss decreased (-0.322767 --> -0.325200).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.1643705
	speed: 0.1924s/iter; left time: 1402.8847s
Epoch: 3 cost time: 6.37387752532959
Epoch: 3, Steps: 154 | Train Loss: 1.952 Vali Loss: 2.493 Vali Acc: 0.338 Test Loss: 2.493 Test Acc: 0.338
Validation loss decreased (-0.325200 --> -0.338175).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.5350044
	speed: 0.1903s/iter; left time: 1358.7013s
Epoch: 4 cost time: 8.685594320297241
Epoch: 4, Steps: 154 | Train Loss: 1.849 Vali Loss: 2.738 Vali Acc: 0.333 Test Loss: 2.738 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.5721846
	speed: 0.1514s/iter; left time: 1057.4927s
Epoch: 5 cost time: 6.735151767730713
Epoch: 5, Steps: 154 | Train Loss: 1.776 Vali Loss: 2.752 Vali Acc: 0.332 Test Loss: 2.752 Test Acc: 0.332
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 2.7433743
	speed: 0.1539s/iter; left time: 1051.0897s
Epoch: 6 cost time: 7.240577459335327
Epoch: 6, Steps: 154 | Train Loss: 1.707 Vali Loss: 2.779 Vali Acc: 0.346 Test Loss: 2.779 Test Acc: 0.346
Validation loss decreased (-0.338175 --> -0.346282).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.8147274
	speed: 0.1451s/iter; left time: 968.6267s
Epoch: 7 cost time: 4.795494079589844
Epoch: 7, Steps: 154 | Train Loss: 1.642 Vali Loss: 3.188 Vali Acc: 0.177 Test Loss: 3.188 Test Acc: 0.177
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.6237369
	speed: 0.0991s/iter; left time: 646.7187s
Epoch: 8 cost time: 4.996984958648682
Epoch: 8, Steps: 154 | Train Loss: 1.592 Vali Loss: 3.571 Vali Acc: 0.181 Test Loss: 3.571 Test Acc: 0.181
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.4429280
	speed: 0.0874s/iter; left time: 556.6567s
Epoch: 9 cost time: 3.4653878211975098
Epoch: 9, Steps: 154 | Train Loss: 1.553 Vali Loss: 4.251 Vali Acc: 0.096 Test Loss: 4.251 Test Acc: 0.096
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.9401980
	speed: 0.1512s/iter; left time: 939.9703s
Epoch: 10 cost time: 7.35798716545105
Epoch: 10, Steps: 154 | Train Loss: 1.495 Vali Loss: 3.880 Vali Acc: 0.187 Test Loss: 3.880 Test Acc: 0.187
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 1.3702711
	speed: 0.1522s/iter; left time: 922.4974s
Epoch: 11 cost time: 7.6486732959747314
Epoch: 11, Steps: 154 | Train Loss: 1.477 Vali Loss: 4.441 Vali Acc: 0.180 Test Loss: 4.441 Test Acc: 0.180
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 2.0725393
	speed: 0.1956s/iter; left time: 1155.4446s
Epoch: 12 cost time: 8.425428867340088
Epoch: 12, Steps: 154 | Train Loss: 1.404 Vali Loss: 4.230 Vali Acc: 0.199 Test Loss: 4.230 Test Acc: 0.199
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 1.0084375
	speed: 0.1805s/iter; left time: 1038.3421s
Epoch: 13 cost time: 7.896460294723511
Epoch: 13, Steps: 154 | Train Loss: 1.374 Vali Loss: 4.449 Vali Acc: 0.178 Test Loss: 4.449 Test Acc: 0.178
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 1.1343067
	speed: 0.1471s/iter; left time: 823.5430s
Epoch: 14 cost time: 6.550950050354004
Epoch: 14, Steps: 154 | Train Loss: 1.330 Vali Loss: 4.394 Vali Acc: 0.163 Test Loss: 4.394 Test Acc: 0.163
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 1.2205765
	speed: 0.1810s/iter; left time: 985.6408s
Epoch: 15 cost time: 9.152145862579346
Epoch: 15, Steps: 154 | Train Loss: 1.352 Vali Loss: 4.634 Vali Acc: 0.183 Test Loss: 4.634 Test Acc: 0.183
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 1.2328823
	speed: 0.1741s/iter; left time: 921.2906s
Epoch: 16 cost time: 7.229275941848755
Epoch: 16, Steps: 154 | Train Loss: 1.322 Vali Loss: 5.316 Vali Acc: 0.182 Test Loss: 5.316 Test Acc: 0.182
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el4_dm768_df768_ps5_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.34630981346309814
model parameter : 29475854
model size : 127.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el4_dm768_df768_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1470928
	speed: 0.0482s/iter; left time: 366.3331s
Epoch: 1 cost time: 6.197037935256958
Epoch: 1, Steps: 154 | Train Loss: 2.120 Vali Loss: 2.304 Vali Acc: 0.326 Test Loss: 2.304 Test Acc: 0.326
Validation loss decreased (inf --> -0.326011).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.1942406
	speed: 0.1576s/iter; left time: 1173.4374s
Epoch: 2 cost time: 5.7327189445495605
Epoch: 2, Steps: 154 | Train Loss: 2.047 Vali Loss: 2.436 Vali Acc: 0.324 Test Loss: 2.436 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.8438632
	speed: 0.1281s/iter; left time: 934.0852s
Epoch: 3 cost time: 5.970303058624268
Epoch: 3, Steps: 154 | Train Loss: 1.940 Vali Loss: 2.297 Vali Acc: 0.335 Test Loss: 2.297 Test Acc: 0.335
Validation loss decreased (-0.326011 --> -0.335338).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.7467020
	speed: 0.1788s/iter; left time: 1276.6780s
Epoch: 4 cost time: 4.586923122406006
Epoch: 4, Steps: 154 | Train Loss: 1.814 Vali Loss: 2.483 Vali Acc: 0.333 Test Loss: 2.483 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.6456069
	speed: 0.1285s/iter; left time: 897.4111s
Epoch: 5 cost time: 6.1779944896698
Epoch: 5, Steps: 154 | Train Loss: 1.751 Vali Loss: 2.712 Vali Acc: 0.336 Test Loss: 2.712 Test Acc: 0.336
Validation loss decreased (-0.335338 --> -0.336145).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.4012103
	speed: 0.1838s/iter; left time: 1255.7496s
Epoch: 6 cost time: 6.066894054412842
Epoch: 6, Steps: 154 | Train Loss: 1.677 Vali Loss: 2.561 Vali Acc: 0.348 Test Loss: 2.561 Test Acc: 0.348
Validation loss decreased (-0.336145 --> -0.347501).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.4745915
	speed: 0.1557s/iter; left time: 1039.7654s
Epoch: 7 cost time: 6.325906753540039
Epoch: 7, Steps: 154 | Train Loss: 1.602 Vali Loss: 3.161 Vali Acc: 0.090 Test Loss: 3.161 Test Acc: 0.090
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.5349851
	speed: 0.2025s/iter; left time: 1320.8145s
Epoch: 8 cost time: 8.153185844421387
Epoch: 8, Steps: 154 | Train Loss: 1.572 Vali Loss: 3.131 Vali Acc: 0.171 Test Loss: 3.131 Test Acc: 0.171
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.4727843
	speed: 0.1489s/iter; left time: 948.1946s
Epoch: 9 cost time: 4.970618486404419
Epoch: 9, Steps: 154 | Train Loss: 1.506 Vali Loss: 4.590 Vali Acc: 0.170 Test Loss: 4.590 Test Acc: 0.170
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.1547760
	speed: 0.1694s/iter; left time: 1052.7556s
Epoch: 10 cost time: 7.2911200523376465
Epoch: 10, Steps: 154 | Train Loss: 1.507 Vali Loss: 4.438 Vali Acc: 0.048 Test Loss: 4.438 Test Acc: 0.048
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 1.0858757
	speed: 0.1503s/iter; left time: 911.0112s
Epoch: 11 cost time: 4.442327976226807
Epoch: 11, Steps: 154 | Train Loss: 1.457 Vali Loss: 4.221 Vali Acc: 0.176 Test Loss: 4.221 Test Acc: 0.176
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 1.0355062
	speed: 0.1624s/iter; left time: 959.5166s
Epoch: 12 cost time: 5.241569519042969
Epoch: 12, Steps: 154 | Train Loss: 1.407 Vali Loss: 3.989 Vali Acc: 0.179 Test Loss: 3.989 Test Acc: 0.179
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 1.2318965
	speed: 0.1537s/iter; left time: 884.3801s
Epoch: 13 cost time: 6.371823072433472
Epoch: 13, Steps: 154 | Train Loss: 1.382 Vali Loss: 5.081 Vali Acc: 0.100 Test Loss: 5.081 Test Acc: 0.100
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 1.0151457
	speed: 0.1889s/iter; left time: 1057.9044s
Epoch: 14 cost time: 7.753148317337036
Epoch: 14, Steps: 154 | Train Loss: 1.324 Vali Loss: 4.989 Vali Acc: 0.062 Test Loss: 4.989 Test Acc: 0.062
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 1.5099336
	speed: 0.1793s/iter; left time: 976.3458s
Epoch: 15 cost time: 7.416554689407349
Epoch: 15, Steps: 154 | Train Loss: 1.318 Vali Loss: 5.538 Vali Acc: 0.067 Test Loss: 5.538 Test Acc: 0.067
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 1.2565116
	speed: 0.1963s/iter; left time: 1038.4231s
Epoch: 16 cost time: 7.8707427978515625
Epoch: 16, Steps: 154 | Train Loss: 1.264 Vali Loss: 6.046 Vali Acc: 0.181 Test Loss: 6.046 Test Acc: 0.181
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el4_dm768_df768_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3475263584752636
model parameter : 29414414
model size : 126.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el4_dm768_df768_ps5_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0088141
	speed: 0.0492s/iter; left time: 374.3395s
Epoch: 1 cost time: 7.209360122680664
Epoch: 1, Steps: 154 | Train Loss: 2.127 Vali Loss: 2.136 Vali Acc: 0.319 Test Loss: 2.136 Test Acc: 0.319
Validation loss decreased (inf --> -0.318713).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.1798482
	speed: 0.1328s/iter; left time: 988.9852s
Epoch: 2 cost time: 5.040411472320557
Epoch: 2, Steps: 154 | Train Loss: 2.026 Vali Loss: 2.151 Vali Acc: 0.323 Test Loss: 2.151 Test Acc: 0.323
Validation loss decreased (-0.318713 --> -0.323174).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.2416170
	speed: 0.1514s/iter; left time: 1104.1582s
Epoch: 3 cost time: 5.5592334270477295
Epoch: 3, Steps: 154 | Train Loss: 1.957 Vali Loss: 2.562 Vali Acc: 0.324 Test Loss: 2.562 Test Acc: 0.324
Validation loss decreased (-0.323174 --> -0.323981).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.5209814
	speed: 0.1720s/iter; left time: 1227.8564s
Epoch: 4 cost time: 6.30833625793457
Epoch: 4, Steps: 154 | Train Loss: 1.884 Vali Loss: 2.561 Vali Acc: 0.332 Test Loss: 2.561 Test Acc: 0.332
Validation loss decreased (-0.323981 --> -0.332091).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.4143167
	speed: 0.1514s/iter; left time: 1057.2691s
Epoch: 5 cost time: 4.641110897064209
Epoch: 5, Steps: 154 | Train Loss: 1.772 Vali Loss: 2.712 Vali Acc: 0.329 Test Loss: 2.712 Test Acc: 0.329
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.5192140
	speed: 0.1128s/iter; left time: 770.8780s
Epoch: 6 cost time: 5.212916374206543
Epoch: 6, Steps: 154 | Train Loss: 1.722 Vali Loss: 3.090 Vali Acc: 0.178 Test Loss: 3.090 Test Acc: 0.178
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.4605712
	speed: 0.1259s/iter; left time: 840.4931s
Epoch: 7 cost time: 5.386338710784912
Epoch: 7, Steps: 154 | Train Loss: 1.663 Vali Loss: 2.996 Vali Acc: 0.178 Test Loss: 2.996 Test Acc: 0.178
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 1.6922938
	speed: 0.1232s/iter; left time: 803.5883s
Epoch: 8 cost time: 4.711386203765869
Epoch: 8, Steps: 154 | Train Loss: 1.608 Vali Loss: 3.605 Vali Acc: 0.178 Test Loss: 3.605 Test Acc: 0.178
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 1.9046813
	speed: 0.1066s/iter; left time: 679.0592s
Epoch: 9 cost time: 4.64119291305542
Epoch: 9, Steps: 154 | Train Loss: 1.569 Vali Loss: 2.874 Vali Acc: 0.180 Test Loss: 2.874 Test Acc: 0.180
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 1.0759813
	speed: 0.1067s/iter; left time: 663.3001s
Epoch: 10 cost time: 4.823316812515259
Epoch: 10, Steps: 154 | Train Loss: 1.521 Vali Loss: 3.545 Vali Acc: 0.108 Test Loss: 3.545 Test Acc: 0.108
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 1.5612768
	speed: 0.1299s/iter; left time: 787.2586s
Epoch: 11 cost time: 5.641454458236694
Epoch: 11, Steps: 154 | Train Loss: 1.467 Vali Loss: 3.829 Vali Acc: 0.182 Test Loss: 3.829 Test Acc: 0.182
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 1.5282860
	speed: 0.1359s/iter; left time: 803.0412s
Epoch: 12 cost time: 6.059768199920654
Epoch: 12, Steps: 154 | Train Loss: 1.447 Vali Loss: 3.900 Vali Acc: 0.182 Test Loss: 3.900 Test Acc: 0.182
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 1.5160440
	speed: 0.1204s/iter; left time: 692.5498s
Epoch: 13 cost time: 6.687651872634888
Epoch: 13, Steps: 154 | Train Loss: 1.425 Vali Loss: 4.114 Vali Acc: 0.139 Test Loss: 4.114 Test Acc: 0.139
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 1.3261347
	speed: 0.1484s/iter; left time: 830.8721s
Epoch: 14 cost time: 6.136963367462158
Epoch: 14, Steps: 154 | Train Loss: 1.391 Vali Loss: 4.803 Vali Acc: 0.054 Test Loss: 4.803 Test Acc: 0.054
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el4_dm768_df768_ps5_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.33211678832116787
model parameter : 29365262
model size : 126.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el4_dm768_df768_ps6_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2972918
	speed: 0.0893s/iter; left time: 678.5125s
Epoch: 1 cost time: 12.742753744125366
Epoch: 1, Steps: 154 | Train Loss: 2.125 Vali Loss: 2.220 Vali Acc: 0.161 Test Loss: 2.220 Test Acc: 0.161
Validation loss decreased (inf --> -0.160562).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.9840469
	speed: 0.2019s/iter; left time: 1503.3421s
Epoch: 2 cost time: 7.921125173568726
Epoch: 2, Steps: 154 | Train Loss: 2.037 Vali Loss: 2.420 Vali Acc: 0.322 Test Loss: 2.420 Test Acc: 0.322
Validation loss decreased (-0.160562 --> -0.321549).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.8566215
	speed: 0.1671s/iter; left time: 1218.7864s
Epoch: 3 cost time: 7.978255271911621
Epoch: 3, Steps: 154 | Train Loss: 1.977 Vali Loss: 2.263 Vali Acc: 0.328 Test Loss: 2.263 Test Acc: 0.328
Validation loss decreased (-0.321549 --> -0.327633).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.7657666
	speed: 0.2253s/iter; left time: 1608.5437s
Epoch: 4 cost time: 7.945653915405273
Epoch: 4, Steps: 154 | Train Loss: 1.878 Vali Loss: 2.503 Vali Acc: 0.341 Test Loss: 2.503 Test Acc: 0.341
Validation loss decreased (-0.327633 --> -0.341013).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.5202835
	speed: 0.2254s/iter; left time: 1574.2560s
Epoch: 5 cost time: 9.43440866470337
Epoch: 5, Steps: 154 | Train Loss: 1.775 Vali Loss: 2.854 Vali Acc: 0.337 Test Loss: 2.854 Test Acc: 0.337
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.3640355
	speed: 0.2134s/iter; left time: 1457.7142s
Epoch: 6 cost time: 11.629111766815186
Epoch: 6, Steps: 154 | Train Loss: 1.699 Vali Loss: 2.865 Vali Acc: 0.344 Test Loss: 2.865 Test Acc: 0.344
Validation loss decreased (-0.341013 --> -0.344254).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.6864805
	speed: 0.2200s/iter; left time: 1468.9071s
Epoch: 7 cost time: 9.313722848892212
Epoch: 7, Steps: 154 | Train Loss: 1.628 Vali Loss: 3.022 Vali Acc: 0.187 Test Loss: 3.022 Test Acc: 0.187
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.4273627
	speed: 0.1562s/iter; left time: 1018.5824s
Epoch: 8 cost time: 6.802341938018799
Epoch: 8, Steps: 154 | Train Loss: 1.568 Vali Loss: 3.309 Vali Acc: 0.184 Test Loss: 3.309 Test Acc: 0.184
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.5885763
	speed: 0.1508s/iter; left time: 960.4232s
Epoch: 9 cost time: 7.168967247009277
Epoch: 9, Steps: 154 | Train Loss: 1.518 Vali Loss: 3.383 Vali Acc: 0.183 Test Loss: 3.383 Test Acc: 0.183
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.1903052
	speed: 0.1703s/iter; left time: 1058.5769s
Epoch: 10 cost time: 10.119922876358032
Epoch: 10, Steps: 154 | Train Loss: 1.455 Vali Loss: 3.826 Vali Acc: 0.195 Test Loss: 3.826 Test Acc: 0.195
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 1.4320197
	speed: 0.1905s/iter; left time: 1154.5620s
Epoch: 11 cost time: 8.214625597000122
Epoch: 11, Steps: 154 | Train Loss: 1.424 Vali Loss: 4.016 Vali Acc: 0.176 Test Loss: 4.016 Test Acc: 0.176
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 1.1922424
	speed: 0.1890s/iter; left time: 1116.5677s
Epoch: 12 cost time: 10.385472774505615
Epoch: 12, Steps: 154 | Train Loss: 1.370 Vali Loss: 4.443 Vali Acc: 0.186 Test Loss: 4.443 Test Acc: 0.186
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 1.4911582
	speed: 0.1861s/iter; left time: 1070.4056s
Epoch: 13 cost time: 9.971280336380005
Epoch: 13, Steps: 154 | Train Loss: 1.331 Vali Loss: 4.632 Vali Acc: 0.172 Test Loss: 4.632 Test Acc: 0.172
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 1.2525405
	speed: 0.2166s/iter; left time: 1212.5124s
Epoch: 14 cost time: 8.680547952651978
Epoch: 14, Steps: 154 | Train Loss: 1.327 Vali Loss: 4.544 Vali Acc: 0.188 Test Loss: 4.544 Test Acc: 0.188
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 1.2576489
	speed: 0.1729s/iter; left time: 941.2655s
Epoch: 15 cost time: 7.6222898960113525
Epoch: 15, Steps: 154 | Train Loss: 1.246 Vali Loss: 5.079 Vali Acc: 0.186 Test Loss: 5.079 Test Acc: 0.186
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 1.1048309
	speed: 0.1152s/iter; left time: 609.5589s
Epoch: 16 cost time: 6.035692930221558
Epoch: 16, Steps: 154 | Train Loss: 1.294 Vali Loss: 5.103 Vali Acc: 0.187 Test Loss: 5.103 Test Acc: 0.187
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el4_dm768_df768_ps6_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3442822384428224
model parameter : 29489678
model size : 127.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el4_dm768_df768_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.9709587
	speed: 0.0436s/iter; left time: 331.2265s
Epoch: 1 cost time: 5.934324026107788
Epoch: 1, Steps: 154 | Train Loss: 2.149 Vali Loss: 2.128 Vali Acc: 0.321 Test Loss: 2.128 Test Acc: 0.321
Validation loss decreased (inf --> -0.320741).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.5116500
	speed: 0.1093s/iter; left time: 813.9096s
Epoch: 2 cost time: 5.024206638336182
Epoch: 2, Steps: 154 | Train Loss: 2.037 Vali Loss: 2.112 Vali Acc: 0.325 Test Loss: 2.112 Test Acc: 0.325
Validation loss decreased (-0.320741 --> -0.325202).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9559481
	speed: 0.1901s/iter; left time: 1386.4045s
Epoch: 3 cost time: 6.1284661293029785
Epoch: 3, Steps: 154 | Train Loss: 1.958 Vali Loss: 2.366 Vali Acc: 0.325 Test Loss: 2.366 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.7651230
	speed: 0.1532s/iter; left time: 1093.8133s
Epoch: 4 cost time: 6.3693273067474365
Epoch: 4, Steps: 154 | Train Loss: 1.866 Vali Loss: 2.531 Vali Acc: 0.330 Test Loss: 2.531 Test Acc: 0.330
Validation loss decreased (-0.325202 --> -0.329658).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.5195329
	speed: 0.1782s/iter; left time: 1244.5234s
Epoch: 5 cost time: 6.274878978729248
Epoch: 5, Steps: 154 | Train Loss: 1.787 Vali Loss: 2.775 Vali Acc: 0.349 Test Loss: 2.775 Test Acc: 0.349
Validation loss decreased (-0.329658 --> -0.349121).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.0289648
	speed: 0.1759s/iter; left time: 1201.5480s
Epoch: 6 cost time: 6.162885665893555
Epoch: 6, Steps: 154 | Train Loss: 1.719 Vali Loss: 2.878 Vali Acc: 0.337 Test Loss: 2.878 Test Acc: 0.337
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.8506898
	speed: 0.1379s/iter; left time: 921.0889s
Epoch: 7 cost time: 5.467642784118652
Epoch: 7, Steps: 154 | Train Loss: 1.660 Vali Loss: 3.293 Vali Acc: 0.345 Test Loss: 3.293 Test Acc: 0.345
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 2.0372231
	speed: 0.1411s/iter; left time: 920.5298s
Epoch: 8 cost time: 5.9260382652282715
Epoch: 8, Steps: 154 | Train Loss: 1.577 Vali Loss: 4.036 Vali Acc: 0.086 Test Loss: 4.036 Test Acc: 0.086
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 1.5913815
	speed: 0.1328s/iter; left time: 846.0282s
Epoch: 9 cost time: 5.63712215423584
Epoch: 9, Steps: 154 | Train Loss: 1.525 Vali Loss: 3.837 Vali Acc: 0.100 Test Loss: 3.837 Test Acc: 0.100
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 1.3185012
	speed: 0.1492s/iter; left time: 927.1736s
Epoch: 10 cost time: 5.785830736160278
Epoch: 10, Steps: 154 | Train Loss: 1.489 Vali Loss: 3.540 Vali Acc: 0.187 Test Loss: 3.540 Test Acc: 0.187
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 1.3775680
	speed: 0.1136s/iter; left time: 688.4934s
Epoch: 11 cost time: 4.651101350784302
Epoch: 11, Steps: 154 | Train Loss: 1.459 Vali Loss: 4.217 Vali Acc: 0.182 Test Loss: 4.217 Test Acc: 0.182
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 1.0047387
	speed: 0.0965s/iter; left time: 569.7774s
Epoch: 12 cost time: 4.649491786956787
Epoch: 12, Steps: 154 | Train Loss: 1.402 Vali Loss: 4.178 Vali Acc: 0.171 Test Loss: 4.178 Test Acc: 0.171
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.8969164
	speed: 0.1009s/iter; left time: 580.3689s
Epoch: 13 cost time: 4.443034648895264
Epoch: 13, Steps: 154 | Train Loss: 1.360 Vali Loss: 4.082 Vali Acc: 0.162 Test Loss: 4.082 Test Acc: 0.162
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.4846504
	speed: 0.1029s/iter; left time: 576.0195s
Epoch: 14 cost time: 4.594887018203735
Epoch: 14, Steps: 154 | Train Loss: 1.349 Vali Loss: 4.592 Vali Acc: 0.133 Test Loss: 4.592 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 1.5667982
	speed: 0.1249s/iter; left time: 679.9110s
Epoch: 15 cost time: 6.3607354164123535
Epoch: 15, Steps: 154 | Train Loss: 1.343 Vali Loss: 4.880 Vali Acc: 0.187 Test Loss: 4.880 Test Acc: 0.187
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el4_dm768_df768_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3491484184914842
model parameter : 29428238
model size : 126.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el4_dm768_df768_ps6_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.3139572
	speed: 0.0414s/iter; left time: 314.4426s
Epoch: 1 cost time: 6.326266765594482
Epoch: 1, Steps: 154 | Train Loss: 2.137 Vali Loss: 2.186 Vali Acc: 0.321 Test Loss: 2.186 Test Acc: 0.321
Validation loss decreased (inf --> -0.320741).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8366386
	speed: 0.1187s/iter; left time: 884.2275s
Epoch: 2 cost time: 4.630528926849365
Epoch: 2, Steps: 154 | Train Loss: 2.023 Vali Loss: 2.137 Vali Acc: 0.324 Test Loss: 2.137 Test Acc: 0.324
Validation loss decreased (-0.320741 --> -0.323985).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9853455
	speed: 0.1255s/iter; left time: 915.4460s
Epoch: 3 cost time: 4.9884302616119385
Epoch: 3, Steps: 154 | Train Loss: 1.964 Vali Loss: 2.195 Vali Acc: 0.321 Test Loss: 2.195 Test Acc: 0.321
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.7253941
	speed: 0.1127s/iter; left time: 804.8505s
Epoch: 4 cost time: 5.040428400039673
Epoch: 4, Steps: 154 | Train Loss: 1.909 Vali Loss: 2.218 Vali Acc: 0.330 Test Loss: 2.218 Test Acc: 0.330
Validation loss decreased (-0.323985 --> -0.330067).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.7706565
	speed: 0.1109s/iter; left time: 774.4053s
Epoch: 5 cost time: 3.740992307662964
Epoch: 5, Steps: 154 | Train Loss: 1.842 Vali Loss: 2.365 Vali Acc: 0.328 Test Loss: 2.365 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.7999076
	speed: 0.0937s/iter; left time: 640.2401s
Epoch: 6 cost time: 4.288142681121826
Epoch: 6, Steps: 154 | Train Loss: 1.767 Vali Loss: 2.405 Vali Acc: 0.340 Test Loss: 2.405 Test Acc: 0.340
Validation loss decreased (-0.330067 --> -0.339798).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.2101789
	speed: 0.1046s/iter; left time: 698.2114s
Epoch: 7 cost time: 4.1784937381744385
Epoch: 7, Steps: 154 | Train Loss: 1.673 Vali Loss: 2.849 Vali Acc: 0.344 Test Loss: 2.849 Test Acc: 0.344
Validation loss decreased (-0.339798 --> -0.343848).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.1457615
	speed: 0.1306s/iter; left time: 852.0697s
Epoch: 8 cost time: 5.362616777420044
Epoch: 8, Steps: 154 | Train Loss: 1.629 Vali Loss: 2.757 Vali Acc: 0.324 Test Loss: 2.757 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.9560835
	speed: 0.1065s/iter; left time: 678.3592s
Epoch: 9 cost time: 5.193166017532349
Epoch: 9, Steps: 154 | Train Loss: 1.572 Vali Loss: 3.129 Vali Acc: 0.347 Test Loss: 3.129 Test Acc: 0.347
Validation loss decreased (-0.343848 --> -0.346684).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.0261750
	speed: 0.1236s/iter; left time: 768.3704s
Epoch: 10 cost time: 4.327658176422119
Epoch: 10, Steps: 154 | Train Loss: 1.546 Vali Loss: 3.024 Vali Acc: 0.350 Test Loss: 3.024 Test Acc: 0.350
Validation loss decreased (-0.346684 --> -0.349524).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.3508316
	speed: 0.1337s/iter; left time: 810.1781s
Epoch: 11 cost time: 5.693227052688599
Epoch: 11, Steps: 154 | Train Loss: 1.504 Vali Loss: 3.281 Vali Acc: 0.332 Test Loss: 3.281 Test Acc: 0.332
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 1.5602705
	speed: 0.1285s/iter; left time: 758.8804s
Epoch: 12 cost time: 5.481589078903198
Epoch: 12, Steps: 154 | Train Loss: 1.466 Vali Loss: 3.360 Vali Acc: 0.336 Test Loss: 3.360 Test Acc: 0.336
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.2876122
	speed: 0.1263s/iter; left time: 726.4366s
Epoch: 13 cost time: 4.055787801742554
Epoch: 13, Steps: 154 | Train Loss: 1.418 Vali Loss: 3.730 Vali Acc: 0.181 Test Loss: 3.730 Test Acc: 0.181
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 1.3553824
	speed: 0.1057s/iter; left time: 591.9529s
Epoch: 14 cost time: 4.002259969711304
Epoch: 14, Steps: 154 | Train Loss: 1.389 Vali Loss: 3.973 Vali Acc: 0.181 Test Loss: 3.973 Test Acc: 0.181
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 1.5636919
	speed: 0.0916s/iter; left time: 498.7709s
Epoch: 15 cost time: 4.212925434112549
Epoch: 15, Steps: 154 | Train Loss: 1.373 Vali Loss: 3.963 Vali Acc: 0.177 Test Loss: 3.963 Test Acc: 0.177
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 1.3504858
	speed: 0.1122s/iter; left time: 593.4288s
Epoch: 16 cost time: 5.8772828578948975
Epoch: 16, Steps: 154 | Train Loss: 1.354 Vali Loss: 3.663 Vali Acc: 0.173 Test Loss: 3.663 Test Acc: 0.173
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 1.3635629
	speed: 0.1168s/iter; left time: 599.8284s
Epoch: 17 cost time: 4.106039047241211
Epoch: 17, Steps: 154 | Train Loss: 1.312 Vali Loss: 4.630 Vali Acc: 0.163 Test Loss: 4.630 Test Acc: 0.163
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.8979073
	speed: 0.1146s/iter; left time: 571.0259s
Epoch: 18 cost time: 4.8629608154296875
Epoch: 18, Steps: 154 | Train Loss: 1.299 Vali Loss: 4.663 Vali Acc: 0.166 Test Loss: 4.663 Test Acc: 0.166
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.9908342
	speed: 0.0717s/iter; left time: 346.2072s
Epoch: 19 cost time: 3.4780898094177246
Epoch: 19, Steps: 154 | Train Loss: 1.256 Vali Loss: 4.461 Vali Acc: 0.073 Test Loss: 4.461 Test Acc: 0.073
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 1.2729545
	speed: 0.1078s/iter; left time: 503.9360s
Epoch: 20 cost time: 4.3109846115112305
Epoch: 20, Steps: 154 | Train Loss: 1.250 Vali Loss: 5.084 Vali Acc: 0.173 Test Loss: 5.084 Test Acc: 0.173
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el4_dm768_df768_ps6_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3495539334955393
model parameter : 29366798
model size : 126.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el4_dm768_df768_ps8_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.9901590
	speed: 0.0550s/iter; left time: 417.8985s
Epoch: 1 cost time: 8.25547981262207
Epoch: 1, Steps: 154 | Train Loss: 2.138 Vali Loss: 2.173 Vali Acc: 0.318 Test Loss: 2.173 Test Acc: 0.318
Validation loss decreased (inf --> -0.317902).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.7245340
	speed: 0.1659s/iter; left time: 1235.3380s
Epoch: 2 cost time: 6.677021026611328
Epoch: 2, Steps: 154 | Train Loss: 2.028 Vali Loss: 2.303 Vali Acc: 0.326 Test Loss: 2.303 Test Acc: 0.326
Validation loss decreased (-0.317902 --> -0.326011).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.4767884
	speed: 0.1814s/iter; left time: 1322.7316s
Epoch: 3 cost time: 6.601532220840454
Epoch: 3, Steps: 154 | Train Loss: 1.956 Vali Loss: 2.226 Vali Acc: 0.330 Test Loss: 2.226 Test Acc: 0.330
Validation loss decreased (-0.326011 --> -0.330067).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.6755327
	speed: 0.1450s/iter; left time: 1035.3841s
Epoch: 4 cost time: 4.879157066345215
Epoch: 4, Steps: 154 | Train Loss: 1.860 Vali Loss: 2.608 Vali Acc: 0.326 Test Loss: 2.608 Test Acc: 0.326
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.8008387
	speed: 0.1220s/iter; left time: 851.9255s
Epoch: 5 cost time: 5.469489574432373
Epoch: 5, Steps: 154 | Train Loss: 1.774 Vali Loss: 2.533 Vali Acc: 0.343 Test Loss: 2.533 Test Acc: 0.343
Validation loss decreased (-0.330067 --> -0.342635).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.1077476
	speed: 0.1599s/iter; left time: 1092.3460s
Epoch: 6 cost time: 6.202306509017944
Epoch: 6, Steps: 154 | Train Loss: 1.700 Vali Loss: 3.463 Vali Acc: 0.078 Test Loss: 3.463 Test Acc: 0.078
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 2.1211553
	speed: 0.1321s/iter; left time: 881.7099s
Epoch: 7 cost time: 5.777800559997559
Epoch: 7, Steps: 154 | Train Loss: 1.607 Vali Loss: 3.495 Vali Acc: 0.174 Test Loss: 3.495 Test Acc: 0.174
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 2.0176706
	speed: 0.1169s/iter; left time: 762.4741s
Epoch: 8 cost time: 4.754464149475098
Epoch: 8, Steps: 154 | Train Loss: 1.580 Vali Loss: 3.692 Vali Acc: 0.186 Test Loss: 3.692 Test Acc: 0.186
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 1.0863612
	speed: 0.1098s/iter; left time: 699.5815s
Epoch: 9 cost time: 4.819921255111694
Epoch: 9, Steps: 154 | Train Loss: 1.509 Vali Loss: 4.291 Vali Acc: 0.188 Test Loss: 4.291 Test Acc: 0.188
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 1.0979404
	speed: 0.1350s/iter; left time: 839.1812s
Epoch: 10 cost time: 6.063931465148926
Epoch: 10, Steps: 154 | Train Loss: 1.435 Vali Loss: 4.571 Vali Acc: 0.184 Test Loss: 4.571 Test Acc: 0.184
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 1.4689873
	speed: 0.1384s/iter; left time: 838.9030s
Epoch: 11 cost time: 5.631855249404907
Epoch: 11, Steps: 154 | Train Loss: 1.418 Vali Loss: 4.419 Vali Acc: 0.108 Test Loss: 4.419 Test Acc: 0.108
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.9967016
	speed: 0.1302s/iter; left time: 768.8040s
Epoch: 12 cost time: 4.993255376815796
Epoch: 12, Steps: 154 | Train Loss: 1.404 Vali Loss: 4.726 Vali Acc: 0.067 Test Loss: 4.726 Test Acc: 0.067
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 1.5914022
	speed: 0.1008s/iter; left time: 579.9435s
Epoch: 13 cost time: 4.502975225448608
Epoch: 13, Steps: 154 | Train Loss: 1.331 Vali Loss: 5.120 Vali Acc: 0.071 Test Loss: 5.120 Test Acc: 0.071
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 1.6735446
	speed: 0.0993s/iter; left time: 555.7200s
Epoch: 14 cost time: 4.524588346481323
Epoch: 14, Steps: 154 | Train Loss: 1.293 Vali Loss: 4.827 Vali Acc: 0.201 Test Loss: 4.827 Test Acc: 0.201
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 1.6254395
	speed: 0.1368s/iter; left time: 744.7032s
Epoch: 15 cost time: 6.0423479080200195
Epoch: 15, Steps: 154 | Train Loss: 1.262 Vali Loss: 5.236 Vali Acc: 0.118 Test Loss: 5.236 Test Acc: 0.118
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el4_dm768_df768_ps8_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3426601784266018
model parameter : 29505038
model size : 127.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el4_dm768_df768_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.3107102
	speed: 0.0460s/iter; left time: 349.7939s
Epoch: 1 cost time: 6.415094614028931
Epoch: 1, Steps: 154 | Train Loss: 2.119 Vali Loss: 2.197 Vali Acc: 0.318 Test Loss: 2.197 Test Acc: 0.318
Validation loss decreased (inf --> -0.317496).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.2304959
	speed: 0.1171s/iter; left time: 871.9675s
Epoch: 2 cost time: 4.81313157081604
Epoch: 2, Steps: 154 | Train Loss: 2.006 Vali Loss: 2.406 Vali Acc: 0.323 Test Loss: 2.406 Test Acc: 0.323
Validation loss decreased (-0.317496 --> -0.322766).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9384515
	speed: 0.1173s/iter; left time: 855.2899s
Epoch: 3 cost time: 4.540721893310547
Epoch: 3, Steps: 154 | Train Loss: 1.936 Vali Loss: 2.259 Vali Acc: 0.324 Test Loss: 2.259 Test Acc: 0.324
Validation loss decreased (-0.322766 --> -0.323984).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.4726053
	speed: 0.1202s/iter; left time: 858.4397s
Epoch: 4 cost time: 3.686666488647461
Epoch: 4, Steps: 154 | Train Loss: 1.850 Vali Loss: 2.691 Vali Acc: 0.347 Test Loss: 2.691 Test Acc: 0.347
Validation loss decreased (-0.323984 --> -0.347094).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.6884161
	speed: 0.0993s/iter; left time: 693.5133s
Epoch: 5 cost time: 3.810641050338745
Epoch: 5, Steps: 154 | Train Loss: 1.763 Vali Loss: 2.673 Vali Acc: 0.166 Test Loss: 2.673 Test Acc: 0.166
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.9057773
	speed: 0.0846s/iter; left time: 577.9325s
Epoch: 6 cost time: 3.619340419769287
Epoch: 6, Steps: 154 | Train Loss: 1.676 Vali Loss: 2.747 Vali Acc: 0.174 Test Loss: 2.747 Test Acc: 0.174
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.6856382
	speed: 0.0829s/iter; left time: 553.6207s
Epoch: 7 cost time: 3.758248805999756
Epoch: 7, Steps: 154 | Train Loss: 1.593 Vali Loss: 2.860 Vali Acc: 0.175 Test Loss: 2.860 Test Acc: 0.175
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 1.6922957
	speed: 0.0976s/iter; left time: 636.3888s
Epoch: 8 cost time: 4.6311354637146
Epoch: 8, Steps: 154 | Train Loss: 1.549 Vali Loss: 3.885 Vali Acc: 0.185 Test Loss: 3.885 Test Acc: 0.185
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 1.8003196
	speed: 0.1029s/iter; left time: 655.3041s
Epoch: 9 cost time: 3.771501064300537
Epoch: 9, Steps: 154 | Train Loss: 1.491 Vali Loss: 3.814 Vali Acc: 0.135 Test Loss: 3.814 Test Acc: 0.135
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 1.6195998
	speed: 0.0962s/iter; left time: 598.1701s
Epoch: 10 cost time: 3.2076542377471924
Epoch: 10, Steps: 154 | Train Loss: 1.469 Vali Loss: 3.536 Vali Acc: 0.109 Test Loss: 3.536 Test Acc: 0.109
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 1.8029690
	speed: 0.0910s/iter; left time: 551.5618s
Epoch: 11 cost time: 4.437799692153931
Epoch: 11, Steps: 154 | Train Loss: 1.412 Vali Loss: 4.488 Vali Acc: 0.058 Test Loss: 4.488 Test Acc: 0.058
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 1.5504264
	speed: 0.1212s/iter; left time: 715.9134s
Epoch: 12 cost time: 5.835053443908691
Epoch: 12, Steps: 154 | Train Loss: 1.394 Vali Loss: 3.751 Vali Acc: 0.193 Test Loss: 3.751 Test Acc: 0.193
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 1.3219702
	speed: 0.1281s/iter; left time: 737.2422s
Epoch: 13 cost time: 5.478915214538574
Epoch: 13, Steps: 154 | Train Loss: 1.326 Vali Loss: 4.647 Vali Acc: 0.063 Test Loss: 4.647 Test Acc: 0.063
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 1.2091475
	speed: 0.1157s/iter; left time: 647.7293s
Epoch: 14 cost time: 4.530416488647461
Epoch: 14, Steps: 154 | Train Loss: 1.294 Vali Loss: 4.479 Vali Acc: 0.185 Test Loss: 4.479 Test Acc: 0.185
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el4_dm768_df768_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3471208434712084
model parameter : 29419022
model size : 126.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el4_dm768_df768_ps8_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.3304269
	speed: 0.0419s/iter; left time: 318.1367s
Epoch: 1 cost time: 5.50093150138855
Epoch: 1, Steps: 154 | Train Loss: 2.160 Vali Loss: 2.164 Vali Acc: 0.318 Test Loss: 2.164 Test Acc: 0.318
Validation loss decreased (inf --> -0.317497).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.7351394
	speed: 0.0788s/iter; left time: 587.0745s
Epoch: 2 cost time: 4.132286071777344
Epoch: 2, Steps: 154 | Train Loss: 2.022 Vali Loss: 2.137 Vali Acc: 0.320 Test Loss: 2.137 Test Acc: 0.320
Validation loss decreased (-0.317497 --> -0.319524).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.0376647
	speed: 0.1200s/iter; left time: 875.3235s
Epoch: 3 cost time: 5.0370097160339355
Epoch: 3, Steps: 154 | Train Loss: 1.957 Vali Loss: 2.198 Vali Acc: 0.333 Test Loss: 2.198 Test Acc: 0.333
Validation loss decreased (-0.319524 --> -0.332500).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.5080788
	speed: 0.1206s/iter; left time: 860.8764s
Epoch: 4 cost time: 4.58594822883606
Epoch: 4, Steps: 154 | Train Loss: 1.867 Vali Loss: 2.330 Vali Acc: 0.332 Test Loss: 2.330 Test Acc: 0.332
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.8578017
	speed: 0.1078s/iter; left time: 753.3290s
Epoch: 5 cost time: 3.8273086547851562
Epoch: 5, Steps: 154 | Train Loss: 1.794 Vali Loss: 2.480 Vali Acc: 0.340 Test Loss: 2.480 Test Acc: 0.340
Validation loss decreased (-0.332500 --> -0.339797).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.7774225
	speed: 0.1242s/iter; left time: 848.5737s
Epoch: 6 cost time: 4.168943881988525
Epoch: 6, Steps: 154 | Train Loss: 1.715 Vali Loss: 2.432 Vali Acc: 0.341 Test Loss: 2.432 Test Acc: 0.341
Validation loss decreased (-0.339797 --> -0.341419).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.2161076
	speed: 0.1359s/iter; left time: 907.5886s
Epoch: 7 cost time: 4.801745653152466
Epoch: 7, Steps: 154 | Train Loss: 1.652 Vali Loss: 2.481 Vali Acc: 0.348 Test Loss: 2.481 Test Acc: 0.348
Validation loss decreased (-0.341419 --> -0.347907).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.4373291
	speed: 0.1473s/iter; left time: 961.0659s
Epoch: 8 cost time: 5.6482625007629395
Epoch: 8, Steps: 154 | Train Loss: 1.595 Vali Loss: 2.969 Vali Acc: 0.094 Test Loss: 2.969 Test Acc: 0.094
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.0929592
	speed: 0.1233s/iter; left time: 785.5715s
Epoch: 9 cost time: 5.510195255279541
Epoch: 9, Steps: 154 | Train Loss: 1.532 Vali Loss: 3.302 Vali Acc: 0.169 Test Loss: 3.302 Test Acc: 0.169
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.1708252
	speed: 0.1213s/iter; left time: 753.9998s
Epoch: 10 cost time: 5.764476299285889
Epoch: 10, Steps: 154 | Train Loss: 1.508 Vali Loss: 3.344 Vali Acc: 0.168 Test Loss: 3.344 Test Acc: 0.168
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.0102420
	speed: 0.1208s/iter; left time: 732.3022s
Epoch: 11 cost time: 5.34078574180603
Epoch: 11, Steps: 154 | Train Loss: 1.452 Vali Loss: 3.219 Vali Acc: 0.185 Test Loss: 3.219 Test Acc: 0.185
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 1.5898263
	speed: 0.1063s/iter; left time: 627.7906s
Epoch: 12 cost time: 4.152378559112549
Epoch: 12, Steps: 154 | Train Loss: 1.417 Vali Loss: 3.406 Vali Acc: 0.101 Test Loss: 3.406 Test Acc: 0.101
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 1.7241703
	speed: 0.0902s/iter; left time: 518.9973s
Epoch: 13 cost time: 3.7899739742279053
Epoch: 13, Steps: 154 | Train Loss: 1.407 Vali Loss: 3.758 Vali Acc: 0.108 Test Loss: 3.758 Test Acc: 0.108
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 1.3137704
	speed: 0.0899s/iter; left time: 503.2774s
Epoch: 14 cost time: 3.984426498413086
Epoch: 14, Steps: 154 | Train Loss: 1.378 Vali Loss: 3.912 Vali Acc: 0.185 Test Loss: 3.912 Test Acc: 0.185
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 1.0721865
	speed: 0.1093s/iter; left time: 595.3324s
Epoch: 15 cost time: 4.4922285079956055
Epoch: 15, Steps: 154 | Train Loss: 1.347 Vali Loss: 3.580 Vali Acc: 0.180 Test Loss: 3.580 Test Acc: 0.180
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 1.6178982
	speed: 0.1049s/iter; left time: 554.8551s
Epoch: 16 cost time: 4.160061359405518
Epoch: 16, Steps: 154 | Train Loss: 1.307 Vali Loss: 4.669 Vali Acc: 0.055 Test Loss: 4.669 Test Acc: 0.055
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 1.0920912
	speed: 0.1209s/iter; left time: 620.9296s
Epoch: 17 cost time: 5.090617656707764
Epoch: 17, Steps: 154 | Train Loss: 1.312 Vali Loss: 4.701 Vali Acc: 0.060 Test Loss: 4.701 Test Acc: 0.060
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el4_dm768_df768_ps8_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.34793187347931875
model parameter : 29369870
model size : 126.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el3_dm768_df768_ps2_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2868853
	speed: 0.0717s/iter; left time: 544.8827s
Epoch: 1 cost time: 10.724116325378418
Epoch: 1, Steps: 154 | Train Loss: 2.160 Vali Loss: 2.271 Vali Acc: 0.318 Test Loss: 2.271 Test Acc: 0.318
Validation loss decreased (inf --> -0.317901).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.7603377
	speed: 0.1627s/iter; left time: 1211.6773s
Epoch: 2 cost time: 6.229150295257568
Epoch: 2, Steps: 154 | Train Loss: 2.121 Vali Loss: 2.493 Vali Acc: 0.326 Test Loss: 2.493 Test Acc: 0.326
Validation loss decreased (-0.317901 --> -0.326415).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.2265627
	speed: 0.1749s/iter; left time: 1275.6322s
Epoch: 3 cost time: 9.778945684432983
Epoch: 3, Steps: 154 | Train Loss: 2.081 Vali Loss: 2.317 Vali Acc: 0.327 Test Loss: 2.317 Test Acc: 0.327
Validation loss decreased (-0.326415 --> -0.326822).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.6749933
	speed: 0.2423s/iter; left time: 1729.7960s
Epoch: 4 cost time: 9.869201898574829
Epoch: 4, Steps: 154 | Train Loss: 1.988 Vali Loss: 2.616 Vali Acc: 0.330 Test Loss: 2.616 Test Acc: 0.330
Validation loss decreased (-0.326822 --> -0.330469).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.5808012
	speed: 0.1992s/iter; left time: 1391.3412s
Epoch: 5 cost time: 9.022159814834595
Epoch: 5, Steps: 154 | Train Loss: 1.955 Vali Loss: 2.299 Vali Acc: 0.331 Test Loss: 2.299 Test Acc: 0.331
Validation loss decreased (-0.330469 --> -0.330877).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.4071829
	speed: 0.1805s/iter; left time: 1233.3094s
Epoch: 6 cost time: 6.310146331787109
Epoch: 6, Steps: 154 | Train Loss: 1.866 Vali Loss: 2.692 Vali Acc: 0.337 Test Loss: 2.692 Test Acc: 0.337
Validation loss decreased (-0.330877 --> -0.336551).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.2565136
	speed: 0.1888s/iter; left time: 1260.7091s
Epoch: 7 cost time: 9.62781310081482
Epoch: 7, Steps: 154 | Train Loss: 1.785 Vali Loss: 2.635 Vali Acc: 0.344 Test Loss: 2.635 Test Acc: 0.344
Validation loss decreased (-0.336551 --> -0.344256).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.7680933
	speed: 0.1876s/iter; left time: 1223.9829s
Epoch: 8 cost time: 8.663369178771973
Epoch: 8, Steps: 154 | Train Loss: 1.709 Vali Loss: 3.159 Vali Acc: 0.347 Test Loss: 3.159 Test Acc: 0.347
Validation loss decreased (-0.344256 --> -0.347089).  Saving model ...
	iters: 100, epoch: 9 | loss: 1.8068229
	speed: 0.1710s/iter; left time: 1089.2449s
Epoch: 9 cost time: 6.5062220096588135
Epoch: 9, Steps: 154 | Train Loss: 1.641 Vali Loss: 3.223 Vali Acc: 0.267 Test Loss: 3.223 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.6982327
	speed: 0.1531s/iter; left time: 951.3649s
Epoch: 10 cost time: 9.405149459838867
Epoch: 10, Steps: 154 | Train Loss: 1.580 Vali Loss: 3.623 Vali Acc: 0.192 Test Loss: 3.623 Test Acc: 0.192
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 1.3843241
	speed: 0.1622s/iter; left time: 983.2274s
Epoch: 11 cost time: 5.943967819213867
Epoch: 11, Steps: 154 | Train Loss: 1.522 Vali Loss: 3.337 Vali Acc: 0.198 Test Loss: 3.337 Test Acc: 0.198
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 1.9219905
	speed: 0.1613s/iter; left time: 952.9187s
Epoch: 12 cost time: 8.764665842056274
Epoch: 12, Steps: 154 | Train Loss: 1.458 Vali Loss: 3.801 Vali Acc: 0.196 Test Loss: 3.801 Test Acc: 0.196
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 1.0186352
	speed: 0.1406s/iter; left time: 808.9786s
Epoch: 13 cost time: 8.99713659286499
Epoch: 13, Steps: 154 | Train Loss: 1.445 Vali Loss: 3.743 Vali Acc: 0.381 Test Loss: 3.743 Test Acc: 0.381
Validation loss decreased (-0.347089 --> -0.380741).  Saving model ...
	iters: 100, epoch: 14 | loss: 1.2102619
	speed: 0.1844s/iter; left time: 1032.7295s
Epoch: 14 cost time: 8.29198694229126
Epoch: 14, Steps: 154 | Train Loss: 1.421 Vali Loss: 3.546 Vali Acc: 0.379 Test Loss: 3.546 Test Acc: 0.379
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 1.9182584
	speed: 0.1986s/iter; left time: 1081.3758s
Epoch: 15 cost time: 8.989880561828613
Epoch: 15, Steps: 154 | Train Loss: 1.374 Vali Loss: 4.361 Vali Acc: 0.187 Test Loss: 4.361 Test Acc: 0.187
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 1.0111363
	speed: 0.1900s/iter; left time: 1005.4898s
Epoch: 16 cost time: 9.810319185256958
Epoch: 16, Steps: 154 | Train Loss: 1.391 Vali Loss: 4.387 Vali Acc: 0.076 Test Loss: 4.387 Test Acc: 0.076
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 1.3792111
	speed: 0.1720s/iter; left time: 883.4068s
Epoch: 17 cost time: 6.23035454750061
Epoch: 17, Steps: 154 | Train Loss: 1.282 Vali Loss: 5.620 Vali Acc: 0.131 Test Loss: 5.620 Test Acc: 0.131
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 1.4160382
	speed: 0.1423s/iter; left time: 708.9970s
Epoch: 18 cost time: 6.089003562927246
Epoch: 18, Steps: 154 | Train Loss: 1.266 Vali Loss: 6.700 Vali Acc: 0.075 Test Loss: 6.700 Test Acc: 0.075
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 1.0532277
	speed: 0.1342s/iter; left time: 647.8369s
Epoch: 19 cost time: 6.684112787246704
Epoch: 19, Steps: 154 | Train Loss: 1.268 Vali Loss: 7.096 Vali Acc: 0.075 Test Loss: 7.096 Test Acc: 0.075
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.7997149
	speed: 0.1662s/iter; left time: 776.7715s
Epoch: 20 cost time: 8.847158432006836
Epoch: 20, Steps: 154 | Train Loss: 1.232 Vali Loss: 8.828 Vali Acc: 0.080 Test Loss: 8.828 Test Acc: 0.080
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 1.5354373
	speed: 0.1778s/iter; left time: 803.9968s
Epoch: 21 cost time: 9.742985725402832
Epoch: 21, Steps: 154 | Train Loss: 1.180 Vali Loss: 6.180 Vali Acc: 0.082 Test Loss: 6.180 Test Acc: 0.082
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 1.1264102
	speed: 0.1454s/iter; left time: 635.0708s
Epoch: 22 cost time: 6.178100824356079
Epoch: 22, Steps: 154 | Train Loss: 1.200 Vali Loss: 9.319 Vali Acc: 0.082 Test Loss: 9.319 Test Acc: 0.082
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 1.6965876
	speed: 0.1619s/iter; left time: 682.1766s
Epoch: 23 cost time: 8.620930194854736
Epoch: 23, Steps: 154 | Train Loss: 1.147 Vali Loss: 9.697 Vali Acc: 0.090 Test Loss: 9.697 Test Acc: 0.090
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el3_dm768_df768_ps2_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.38077858880778587
model parameter : 22579982
model size : 100.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el3_dm768_df768_ps2_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.1097422
	speed: 0.0551s/iter; left time: 419.0240s
Epoch: 1 cost time: 7.784513711929321
Epoch: 1, Steps: 154 | Train Loss: 2.153 Vali Loss: 2.238 Vali Acc: 0.131 Test Loss: 2.238 Test Acc: 0.131
Validation loss decreased (inf --> -0.130959).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8165336
	speed: 0.1495s/iter; left time: 1113.5857s
Epoch: 2 cost time: 4.6660544872283936
Epoch: 2, Steps: 154 | Train Loss: 2.063 Vali Loss: 2.324 Vali Acc: 0.320 Test Loss: 2.324 Test Acc: 0.320
Validation loss decreased (-0.130959 --> -0.320334).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.8209422
	speed: 0.1085s/iter; left time: 791.6484s
Epoch: 3 cost time: 5.1210036277771
Epoch: 3, Steps: 154 | Train Loss: 2.022 Vali Loss: 2.220 Vali Acc: 0.326 Test Loss: 2.220 Test Acc: 0.326
Validation loss decreased (-0.320334 --> -0.326012).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.0850234
	speed: 0.1252s/iter; left time: 893.7629s
Epoch: 4 cost time: 4.561859369277954
Epoch: 4, Steps: 154 | Train Loss: 1.947 Vali Loss: 2.236 Vali Acc: 0.332 Test Loss: 2.236 Test Acc: 0.332
Validation loss decreased (-0.326012 --> -0.332094).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.9238504
	speed: 0.1463s/iter; left time: 1021.9607s
Epoch: 5 cost time: 6.194834232330322
Epoch: 5, Steps: 154 | Train Loss: 1.888 Vali Loss: 2.335 Vali Acc: 0.329 Test Loss: 2.335 Test Acc: 0.329
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.5560527
	speed: 0.1557s/iter; left time: 1063.6340s
Epoch: 6 cost time: 7.6976542472839355
Epoch: 6, Steps: 154 | Train Loss: 1.846 Vali Loss: 2.778 Vali Acc: 0.334 Test Loss: 2.778 Test Acc: 0.334
Validation loss decreased (-0.332094 --> -0.333711).  Saving model ...
	iters: 100, epoch: 7 | loss: 2.4675539
	speed: 0.1344s/iter; left time: 897.2281s
Epoch: 7 cost time: 7.666618347167969
Epoch: 7, Steps: 154 | Train Loss: 1.806 Vali Loss: 2.958 Vali Acc: 0.336 Test Loss: 2.958 Test Acc: 0.336
Validation loss decreased (-0.333711 --> -0.336142).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.6626445
	speed: 0.1289s/iter; left time: 840.8697s
Epoch: 8 cost time: 3.9989736080169678
Epoch: 8, Steps: 154 | Train Loss: 1.730 Vali Loss: 2.979 Vali Acc: 0.174 Test Loss: 2.979 Test Acc: 0.174
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.3935241
	speed: 0.1517s/iter; left time: 966.2161s
Epoch: 9 cost time: 7.546544075012207
Epoch: 9, Steps: 154 | Train Loss: 1.656 Vali Loss: 3.460 Vali Acc: 0.081 Test Loss: 3.460 Test Acc: 0.081
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.6043354
	speed: 0.1677s/iter; left time: 1042.0231s
Epoch: 10 cost time: 7.956401586532593
Epoch: 10, Steps: 154 | Train Loss: 1.608 Vali Loss: 3.465 Vali Acc: 0.178 Test Loss: 3.465 Test Acc: 0.178
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.8608990
	speed: 0.1603s/iter; left time: 971.5655s
Epoch: 11 cost time: 7.879180431365967
Epoch: 11, Steps: 154 | Train Loss: 1.557 Vali Loss: 4.062 Vali Acc: 0.176 Test Loss: 4.062 Test Acc: 0.176
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 1.4154867
	speed: 0.1635s/iter; left time: 965.9422s
Epoch: 12 cost time: 7.321733713150024
Epoch: 12, Steps: 154 | Train Loss: 1.489 Vali Loss: 4.028 Vali Acc: 0.099 Test Loss: 4.028 Test Acc: 0.099
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 1.2990441
	speed: 0.1606s/iter; left time: 924.0988s
Epoch: 13 cost time: 7.861552000045776
Epoch: 13, Steps: 154 | Train Loss: 1.472 Vali Loss: 3.907 Vali Acc: 0.071 Test Loss: 3.907 Test Acc: 0.071
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 1.7157686
	speed: 0.1020s/iter; left time: 571.2116s
Epoch: 14 cost time: 4.6046154499053955
Epoch: 14, Steps: 154 | Train Loss: 1.436 Vali Loss: 4.578 Vali Acc: 0.178 Test Loss: 4.578 Test Acc: 0.178
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 1.6462194
	speed: 0.0792s/iter; left time: 431.2195s
Epoch: 15 cost time: 3.3768105506896973
Epoch: 15, Steps: 154 | Train Loss: 1.416 Vali Loss: 4.035 Vali Acc: 0.071 Test Loss: 4.035 Test Acc: 0.071
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.7842704
	speed: 0.0748s/iter; left time: 395.7874s
Epoch: 16 cost time: 3.0979909896850586
Epoch: 16, Steps: 154 | Train Loss: 1.375 Vali Loss: 3.935 Vali Acc: 0.191 Test Loss: 3.935 Test Acc: 0.191
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 1.7731553
	speed: 0.0756s/iter; left time: 388.5872s
Epoch: 17 cost time: 3.6286749839782715
Epoch: 17, Steps: 154 | Train Loss: 1.347 Vali Loss: 5.228 Vali Acc: 0.182 Test Loss: 5.228 Test Acc: 0.182
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el3_dm768_df768_ps2_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3361719383617194
model parameter : 22371086
model size : 100.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el3_dm768_df768_ps3_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.6436448
	speed: 0.0430s/iter; left time: 327.1218s
Epoch: 1 cost time: 5.2635109424591064
Epoch: 1, Steps: 154 | Train Loss: 2.209 Vali Loss: 2.247 Vali Acc: 0.318 Test Loss: 2.247 Test Acc: 0.318
Validation loss decreased (inf --> -0.317496).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.1156249
	speed: 0.1094s/iter; left time: 814.9302s
Epoch: 2 cost time: 6.923999547958374
Epoch: 2, Steps: 154 | Train Loss: 2.113 Vali Loss: 2.623 Vali Acc: 0.317 Test Loss: 2.623 Test Acc: 0.317
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 2.1487126
	speed: 0.1262s/iter; left time: 920.2970s
Epoch: 3 cost time: 4.943911075592041
Epoch: 3, Steps: 154 | Train Loss: 2.063 Vali Loss: 2.452 Vali Acc: 0.326 Test Loss: 2.452 Test Acc: 0.326
Validation loss decreased (-0.317496 --> -0.325604).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.9535934
	speed: 0.1553s/iter; left time: 1108.5070s
Epoch: 4 cost time: 5.703728437423706
Epoch: 4, Steps: 154 | Train Loss: 1.972 Vali Loss: 2.314 Vali Acc: 0.330 Test Loss: 2.314 Test Acc: 0.330
Validation loss decreased (-0.325604 --> -0.330066).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.9764149
	speed: 0.1623s/iter; left time: 1133.4124s
Epoch: 5 cost time: 5.193048000335693
Epoch: 5, Steps: 154 | Train Loss: 1.890 Vali Loss: 2.524 Vali Acc: 0.336 Test Loss: 2.524 Test Acc: 0.336
Validation loss decreased (-0.330066 --> -0.336147).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.9726658
	speed: 0.1424s/iter; left time: 972.5919s
Epoch: 6 cost time: 7.847512483596802
Epoch: 6, Steps: 154 | Train Loss: 1.820 Vali Loss: 2.580 Vali Acc: 0.354 Test Loss: 2.580 Test Acc: 0.354
Validation loss decreased (-0.336147 --> -0.354394).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.6705105
	speed: 0.1909s/iter; left time: 1274.7975s
Epoch: 7 cost time: 7.061599254608154
Epoch: 7, Steps: 154 | Train Loss: 1.711 Vali Loss: 2.460 Vali Acc: 0.361 Test Loss: 2.460 Test Acc: 0.361
Validation loss decreased (-0.354394 --> -0.360884).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.1036346
	speed: 0.1596s/iter; left time: 1041.3134s
Epoch: 8 cost time: 7.815746784210205
Epoch: 8, Steps: 154 | Train Loss: 1.664 Vali Loss: 2.955 Vali Acc: 0.194 Test Loss: 2.955 Test Acc: 0.194
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.3219349
	speed: 0.1536s/iter; left time: 977.9813s
Epoch: 9 cost time: 7.655863285064697
Epoch: 9, Steps: 154 | Train Loss: 1.624 Vali Loss: 3.680 Vali Acc: 0.177 Test Loss: 3.680 Test Acc: 0.177
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.1914965
	speed: 0.1521s/iter; left time: 945.5626s
Epoch: 10 cost time: 5.702537775039673
Epoch: 10, Steps: 154 | Train Loss: 1.534 Vali Loss: 3.342 Vali Acc: 0.191 Test Loss: 3.342 Test Acc: 0.191
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.4315946
	speed: 0.1091s/iter; left time: 661.3055s
Epoch: 11 cost time: 4.115400075912476
Epoch: 11, Steps: 154 | Train Loss: 1.499 Vali Loss: 4.865 Vali Acc: 0.203 Test Loss: 4.865 Test Acc: 0.203
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 1.1120206
	speed: 0.1056s/iter; left time: 623.6081s
Epoch: 12 cost time: 5.281577110290527
Epoch: 12, Steps: 154 | Train Loss: 1.450 Vali Loss: 4.527 Vali Acc: 0.108 Test Loss: 4.527 Test Acc: 0.108
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.7853589
	speed: 0.1309s/iter; left time: 753.2402s
Epoch: 13 cost time: 8.024213552474976
Epoch: 13, Steps: 154 | Train Loss: 1.404 Vali Loss: 5.027 Vali Acc: 0.191 Test Loss: 5.027 Test Acc: 0.191
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 1.4045948
	speed: 0.1322s/iter; left time: 740.4345s
Epoch: 14 cost time: 4.681387186050415
Epoch: 14, Steps: 154 | Train Loss: 1.364 Vali Loss: 5.108 Vali Acc: 0.082 Test Loss: 5.108 Test Acc: 0.082
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 1.6265581
	speed: 0.1438s/iter; left time: 783.0378s
Epoch: 15 cost time: 7.954922676086426
Epoch: 15, Steps: 154 | Train Loss: 1.308 Vali Loss: 7.295 Vali Acc: 0.073 Test Loss: 7.295 Test Acc: 0.073
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 1.2892096
	speed: 0.1612s/iter; left time: 852.9795s
Epoch: 16 cost time: 6.561227798461914
Epoch: 16, Steps: 154 | Train Loss: 1.324 Vali Loss: 7.371 Vali Acc: 0.075 Test Loss: 7.371 Test Acc: 0.075
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 1.7156289
	speed: 0.1153s/iter; left time: 592.5119s
Epoch: 17 cost time: 6.053830146789551
Epoch: 17, Steps: 154 | Train Loss: 1.253 Vali Loss: 6.138 Vali Acc: 0.083 Test Loss: 6.138 Test Acc: 0.083
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el3_dm768_df768_ps3_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3609083536090835
model parameter : 22581518
model size : 100.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el3_dm768_df768_ps3_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.7572244
	speed: 0.0678s/iter; left time: 515.4751s
Epoch: 1 cost time: 9.387620210647583
Epoch: 1, Steps: 154 | Train Loss: 2.130 Vali Loss: 2.409 Vali Acc: 0.316 Test Loss: 2.409 Test Acc: 0.316
Validation loss decreased (inf --> -0.316278).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.2746670
	speed: 0.1551s/iter; left time: 1155.3124s
Epoch: 2 cost time: 7.011766195297241
Epoch: 2, Steps: 154 | Train Loss: 2.072 Vali Loss: 2.262 Vali Acc: 0.324 Test Loss: 2.262 Test Acc: 0.324
Validation loss decreased (-0.316278 --> -0.323578).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.3106184
	speed: 0.1672s/iter; left time: 1219.6745s
Epoch: 3 cost time: 7.443610429763794
Epoch: 3, Steps: 154 | Train Loss: 2.031 Vali Loss: 2.250 Vali Acc: 0.325 Test Loss: 2.250 Test Acc: 0.325
Validation loss decreased (-0.323578 --> -0.324795).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.9253325
	speed: 0.1821s/iter; left time: 1300.3044s
Epoch: 4 cost time: 7.304780960083008
Epoch: 4, Steps: 154 | Train Loss: 1.932 Vali Loss: 2.439 Vali Acc: 0.331 Test Loss: 2.439 Test Acc: 0.331
Validation loss decreased (-0.324795 --> -0.331281).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.6908698
	speed: 0.1124s/iter; left time: 785.3936s
Epoch: 5 cost time: 4.780607223510742
Epoch: 5, Steps: 154 | Train Loss: 1.880 Vali Loss: 2.257 Vali Acc: 0.333 Test Loss: 2.257 Test Acc: 0.333
Validation loss decreased (-0.331281 --> -0.332500).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.1042559
	speed: 0.1166s/iter; left time: 796.4098s
Epoch: 6 cost time: 4.393218755722046
Epoch: 6, Steps: 154 | Train Loss: 1.795 Vali Loss: 2.647 Vali Acc: 0.343 Test Loss: 2.647 Test Acc: 0.343
Validation loss decreased (-0.332500 --> -0.343039).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.0866739
	speed: 0.1482s/iter; left time: 989.2213s
Epoch: 7 cost time: 6.9519171714782715
Epoch: 7, Steps: 154 | Train Loss: 1.719 Vali Loss: 2.726 Vali Acc: 0.182 Test Loss: 2.726 Test Acc: 0.182
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.2265677
	speed: 0.1385s/iter; left time: 903.2307s
Epoch: 8 cost time: 7.4448606967926025
Epoch: 8, Steps: 154 | Train Loss: 1.623 Vali Loss: 2.514 Vali Acc: 0.184 Test Loss: 2.514 Test Acc: 0.184
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.5001156
	speed: 0.1521s/iter; left time: 968.8682s
Epoch: 9 cost time: 6.567467927932739
Epoch: 9, Steps: 154 | Train Loss: 1.631 Vali Loss: 2.857 Vali Acc: 0.366 Test Loss: 2.857 Test Acc: 0.366
Validation loss decreased (-0.343039 --> -0.366151).  Saving model ...
	iters: 100, epoch: 10 | loss: 1.5865767
	speed: 0.1582s/iter; left time: 982.9633s
Epoch: 10 cost time: 6.37736701965332
Epoch: 10, Steps: 154 | Train Loss: 1.540 Vali Loss: 3.027 Vali Acc: 0.197 Test Loss: 3.027 Test Acc: 0.197
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.4923817
	speed: 0.1380s/iter; left time: 836.3785s
Epoch: 11 cost time: 7.59989333152771
Epoch: 11, Steps: 154 | Train Loss: 1.507 Vali Loss: 2.849 Vali Acc: 0.374 Test Loss: 2.849 Test Acc: 0.374
Validation loss decreased (-0.366151 --> -0.373856).  Saving model ...
	iters: 100, epoch: 12 | loss: 1.1643128
	speed: 0.1675s/iter; left time: 989.5419s
Epoch: 12 cost time: 7.725789785385132
Epoch: 12, Steps: 154 | Train Loss: 1.437 Vali Loss: 3.483 Vali Acc: 0.201 Test Loss: 3.483 Test Acc: 0.201
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.4080476
	speed: 0.1467s/iter; left time: 843.8725s
Epoch: 13 cost time: 7.637912273406982
Epoch: 13, Steps: 154 | Train Loss: 1.415 Vali Loss: 3.373 Vali Acc: 0.151 Test Loss: 3.373 Test Acc: 0.151
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.9312356
	speed: 0.1529s/iter; left time: 856.1210s
Epoch: 14 cost time: 6.3040080070495605
Epoch: 14, Steps: 154 | Train Loss: 1.355 Vali Loss: 4.222 Vali Acc: 0.193 Test Loss: 4.222 Test Acc: 0.193
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 1.4960731
	speed: 0.0814s/iter; left time: 443.4097s
Epoch: 15 cost time: 4.655318975448608
Epoch: 15, Steps: 154 | Train Loss: 1.314 Vali Loss: 4.580 Vali Acc: 0.077 Test Loss: 4.580 Test Acc: 0.077
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 1.3247501
	speed: 0.1033s/iter; left time: 546.5702s
Epoch: 16 cost time: 4.635217666625977
Epoch: 16, Steps: 154 | Train Loss: 1.336 Vali Loss: 4.013 Vali Acc: 0.092 Test Loss: 4.013 Test Acc: 0.092
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 1.0452161
	speed: 0.0971s/iter; left time: 499.0570s
Epoch: 17 cost time: 4.457402229309082
Epoch: 17, Steps: 154 | Train Loss: 1.277 Vali Loss: 4.538 Vali Acc: 0.082 Test Loss: 4.538 Test Acc: 0.082
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.9444174
	speed: 0.0976s/iter; left time: 486.1644s
Epoch: 18 cost time: 4.932419538497925
Epoch: 18, Steps: 154 | Train Loss: 1.234 Vali Loss: 3.764 Vali Acc: 0.188 Test Loss: 3.764 Test Acc: 0.188
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 1.2259350
	speed: 0.1175s/iter; left time: 567.2197s
Epoch: 19 cost time: 5.002394676208496
Epoch: 19, Steps: 154 | Train Loss: 1.234 Vali Loss: 4.628 Vali Acc: 0.084 Test Loss: 4.628 Test Acc: 0.084
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 1.0863477
	speed: 0.1191s/iter; left time: 556.6090s
Epoch: 20 cost time: 5.850709915161133
Epoch: 20, Steps: 154 | Train Loss: 1.228 Vali Loss: 4.169 Vali Acc: 0.150 Test Loss: 4.169 Test Acc: 0.150
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 1.2684946
	speed: 0.1371s/iter; left time: 619.8885s
Epoch: 21 cost time: 5.838582992553711
Epoch: 21, Steps: 154 | Train Loss: 1.185 Vali Loss: 4.976 Vali Acc: 0.081 Test Loss: 4.976 Test Acc: 0.081
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el3_dm768_df768_ps3_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.37388483373884834
model parameter : 22372622
model size : 100.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el3_dm768_df768_ps3_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.4862208
	speed: 0.0372s/iter; left time: 282.6581s
Epoch: 1 cost time: 4.667689085006714
Epoch: 1, Steps: 154 | Train Loss: 2.135 Vali Loss: 2.205 Vali Acc: 0.321 Test Loss: 2.205 Test Acc: 0.321
Validation loss decreased (inf --> -0.321146).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.8757677
	speed: 0.0713s/iter; left time: 530.6128s
Epoch: 2 cost time: 3.1321909427642822
Epoch: 2, Steps: 154 | Train Loss: 2.041 Vali Loss: 2.300 Vali Acc: 0.163 Test Loss: 2.300 Test Acc: 0.163
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.9208580
	speed: 0.0725s/iter; left time: 528.5964s
Epoch: 3 cost time: 3.5956814289093018
Epoch: 3, Steps: 154 | Train Loss: 2.002 Vali Loss: 2.289 Vali Acc: 0.321 Test Loss: 2.289 Test Acc: 0.321
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 1.9365302
	speed: 0.0701s/iter; left time: 500.2594s
Epoch: 4 cost time: 3.3960092067718506
Epoch: 4, Steps: 154 | Train Loss: 1.945 Vali Loss: 2.417 Vali Acc: 0.324 Test Loss: 2.417 Test Acc: 0.324
Validation loss decreased (-0.321146 --> -0.323982).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.5651860
	speed: 0.0940s/iter; left time: 656.5472s
Epoch: 5 cost time: 3.557659864425659
Epoch: 5, Steps: 154 | Train Loss: 1.868 Vali Loss: 2.526 Vali Acc: 0.330 Test Loss: 2.526 Test Acc: 0.330
Validation loss decreased (-0.323982 --> -0.330064).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.5514065
	speed: 0.1254s/iter; left time: 856.6707s
Epoch: 6 cost time: 4.197892189025879
Epoch: 6, Steps: 154 | Train Loss: 1.806 Vali Loss: 2.631 Vali Acc: 0.332 Test Loss: 2.631 Test Acc: 0.332
Validation loss decreased (-0.330064 --> -0.331685).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.5949819
	speed: 0.1216s/iter; left time: 812.1503s
Epoch: 7 cost time: 4.1970648765563965
Epoch: 7, Steps: 154 | Train Loss: 1.731 Vali Loss: 2.600 Vali Acc: 0.348 Test Loss: 2.600 Test Acc: 0.348
Validation loss decreased (-0.331685 --> -0.347906).  Saving model ...
	iters: 100, epoch: 8 | loss: 2.0324306
	speed: 0.1259s/iter; left time: 821.0840s
Epoch: 8 cost time: 4.210344552993774
Epoch: 8, Steps: 154 | Train Loss: 1.679 Vali Loss: 2.776 Vali Acc: 0.109 Test Loss: 2.776 Test Acc: 0.109
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.5215428
	speed: 0.0947s/iter; left time: 602.8875s
Epoch: 9 cost time: 3.742112636566162
Epoch: 9, Steps: 154 | Train Loss: 1.624 Vali Loss: 3.044 Vali Acc: 0.187 Test Loss: 3.044 Test Acc: 0.187
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 2.0847182
	speed: 0.1012s/iter; left time: 628.8760s
Epoch: 10 cost time: 3.8111205101013184
Epoch: 10, Steps: 154 | Train Loss: 1.596 Vali Loss: 3.203 Vali Acc: 0.186 Test Loss: 3.203 Test Acc: 0.186
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.5651574
	speed: 0.0955s/iter; left time: 578.6508s
Epoch: 11 cost time: 3.54563570022583
Epoch: 11, Steps: 154 | Train Loss: 1.524 Vali Loss: 3.444 Vali Acc: 0.185 Test Loss: 3.444 Test Acc: 0.185
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 1.4051651
	speed: 0.0989s/iter; left time: 584.0408s
Epoch: 12 cost time: 4.1294989585876465
Epoch: 12, Steps: 154 | Train Loss: 1.485 Vali Loss: 3.110 Vali Acc: 0.122 Test Loss: 3.110 Test Acc: 0.122
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 1.0883358
	speed: 0.1087s/iter; left time: 625.2458s
Epoch: 13 cost time: 4.519364595413208
Epoch: 13, Steps: 154 | Train Loss: 1.461 Vali Loss: 3.381 Vali Acc: 0.112 Test Loss: 3.381 Test Acc: 0.112
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 1.3358639
	speed: 0.0951s/iter; left time: 532.2544s
Epoch: 14 cost time: 3.5944297313690186
Epoch: 14, Steps: 154 | Train Loss: 1.426 Vali Loss: 4.063 Vali Acc: 0.167 Test Loss: 4.063 Test Acc: 0.167
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.9720936
	speed: 0.0905s/iter; left time: 492.7825s
Epoch: 15 cost time: 3.271108865737915
Epoch: 15, Steps: 154 | Train Loss: 1.377 Vali Loss: 4.168 Vali Acc: 0.191 Test Loss: 4.168 Test Acc: 0.191
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 1.9861221
	speed: 0.0821s/iter; left time: 434.3258s
Epoch: 16 cost time: 3.353670358657837
Epoch: 16, Steps: 154 | Train Loss: 1.363 Vali Loss: 4.267 Vali Acc: 0.122 Test Loss: 4.267 Test Acc: 0.122
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 2.0442262
	speed: 0.0949s/iter; left time: 487.4308s
Epoch: 17 cost time: 4.255546569824219
Epoch: 17, Steps: 154 | Train Loss: 1.349 Vali Loss: 4.762 Vali Acc: 0.070 Test Loss: 4.762 Test Acc: 0.070
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el3_dm768_df768_ps3_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.34793187347931875
model parameter : 22311182
model size : 99.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el3_dm768_df768_ps4_str1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.8940718
	speed: 0.0639s/iter; left time: 485.8993s
Epoch: 1 cost time: 8.56160855293274
Epoch: 1, Steps: 154 | Train Loss: 2.229 Vali Loss: 2.213 Vali Acc: 0.325 Test Loss: 2.213 Test Acc: 0.325
Validation loss decreased (inf --> -0.325201).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.4727128
	speed: 0.1494s/iter; left time: 1112.6721s
Epoch: 2 cost time: 5.371312141418457
Epoch: 2, Steps: 154 | Train Loss: 2.117 Vali Loss: 2.344 Vali Acc: 0.166 Test Loss: 2.344 Test Acc: 0.166
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.9934127
	speed: 0.1604s/iter; left time: 1170.1262s
Epoch: 3 cost time: 8.735757827758789
Epoch: 3, Steps: 154 | Train Loss: 2.056 Vali Loss: 2.793 Vali Acc: 0.326 Test Loss: 2.793 Test Acc: 0.326
Validation loss decreased (-0.325201 --> -0.326412).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.9151803
	speed: 0.1598s/iter; left time: 1140.6808s
Epoch: 4 cost time: 7.991878032684326
Epoch: 4, Steps: 154 | Train Loss: 1.991 Vali Loss: 2.700 Vali Acc: 0.328 Test Loss: 2.700 Test Acc: 0.328
Validation loss decreased (-0.326412 --> -0.327629).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.1643240
	speed: 0.1441s/iter; left time: 1006.7315s
Epoch: 5 cost time: 5.571542024612427
Epoch: 5, Steps: 154 | Train Loss: 1.859 Vali Loss: 2.876 Vali Acc: 0.330 Test Loss: 2.876 Test Acc: 0.330
Validation loss decreased (-0.327629 --> -0.330466).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.6672031
	speed: 0.1096s/iter; left time: 748.5972s
Epoch: 6 cost time: 3.8005623817443848
Epoch: 6, Steps: 154 | Train Loss: 1.793 Vali Loss: 3.109 Vali Acc: 0.179 Test Loss: 3.109 Test Acc: 0.179
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.7052956
	speed: 0.0791s/iter; left time: 528.3439s
Epoch: 7 cost time: 5.010174989700317
Epoch: 7, Steps: 154 | Train Loss: 1.753 Vali Loss: 3.302 Vali Acc: 0.090 Test Loss: 3.302 Test Acc: 0.090
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.6677586
	speed: 0.1575s/iter; left time: 1027.2616s
Epoch: 8 cost time: 7.0628931522369385
Epoch: 8, Steps: 154 | Train Loss: 1.589 Vali Loss: 3.248 Vali Acc: 0.210 Test Loss: 3.248 Test Acc: 0.210
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 1.2803159
	speed: 0.1599s/iter; left time: 1018.0895s
Epoch: 9 cost time: 8.828471183776855
Epoch: 9, Steps: 154 | Train Loss: 1.532 Vali Loss: 3.416 Vali Acc: 0.186 Test Loss: 3.416 Test Acc: 0.186
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 1.5424601
	speed: 0.1789s/iter; left time: 1111.7380s
Epoch: 10 cost time: 7.90921425819397
Epoch: 10, Steps: 154 | Train Loss: 1.483 Vali Loss: 3.167 Vali Acc: 0.372 Test Loss: 3.167 Test Acc: 0.372
Validation loss decreased (-0.330466 --> -0.371826).  Saving model ...
	iters: 100, epoch: 11 | loss: 1.0263524
	speed: 0.1718s/iter; left time: 1041.4031s
Epoch: 11 cost time: 7.228152751922607
Epoch: 11, Steps: 154 | Train Loss: 1.418 Vali Loss: 3.882 Vali Acc: 0.200 Test Loss: 3.882 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.9848512
	speed: 0.1262s/iter; left time: 745.6068s
Epoch: 12 cost time: 4.934939861297607
Epoch: 12, Steps: 154 | Train Loss: 1.386 Vali Loss: 5.413 Vali Acc: 0.089 Test Loss: 5.413 Test Acc: 0.089
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 1.0587487
	speed: 0.1490s/iter; left time: 857.0499s
Epoch: 13 cost time: 7.3023154735565186
Epoch: 13, Steps: 154 | Train Loss: 1.352 Vali Loss: 4.291 Vali Acc: 0.192 Test Loss: 4.291 Test Acc: 0.192
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 1.1902579
	speed: 0.1516s/iter; left time: 849.0741s
Epoch: 14 cost time: 5.858658790588379
Epoch: 14, Steps: 154 | Train Loss: 1.323 Vali Loss: 5.718 Vali Acc: 0.071 Test Loss: 5.718 Test Acc: 0.071
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 2.4205184
	speed: 0.1595s/iter; left time: 868.7410s
Epoch: 15 cost time: 7.780507802963257
Epoch: 15, Steps: 154 | Train Loss: 1.300 Vali Loss: 6.086 Vali Acc: 0.073 Test Loss: 6.086 Test Acc: 0.073
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 1.1766875
	speed: 0.1375s/iter; left time: 727.5559s
Epoch: 16 cost time: 5.592428207397461
Epoch: 16, Steps: 154 | Train Loss: 1.247 Vali Loss: 6.071 Vali Acc: 0.089 Test Loss: 6.071 Test Acc: 0.089
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 1.6584648
	speed: 0.1443s/iter; left time: 741.5232s
Epoch: 17 cost time: 6.101886987686157
Epoch: 17, Steps: 154 | Train Loss: 1.229 Vali Loss: 6.030 Vali Acc: 0.073 Test Loss: 6.030 Test Acc: 0.073
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 4.1936455
	speed: 0.1399s/iter; left time: 696.9266s
Epoch: 18 cost time: 7.083759784698486
Epoch: 18, Steps: 154 | Train Loss: 1.223 Vali Loss: 5.766 Vali Acc: 0.197 Test Loss: 5.766 Test Acc: 0.197
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.8568530
	speed: 0.1623s/iter; left time: 783.8268s
Epoch: 19 cost time: 9.088531494140625
Epoch: 19, Steps: 154 | Train Loss: 1.144 Vali Loss: 8.147 Vali Acc: 0.077 Test Loss: 8.147 Test Acc: 0.077
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.3794021
	speed: 0.1708s/iter; left time: 798.3346s
Epoch: 20 cost time: 8.610906839370728
Epoch: 20, Steps: 154 | Train Loss: 1.140 Vali Loss: 8.134 Vali Acc: 0.083 Test Loss: 8.134 Test Acc: 0.083
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el3_dm768_df768_ps4_str1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3718572587185726
model parameter : 22583054
model size : 100.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el3_dm768_df768_ps4_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.7125980
	speed: 0.0604s/iter; left time: 459.4471s
Epoch: 1 cost time: 9.107690572738647
Epoch: 1, Steps: 154 | Train Loss: 2.139 Vali Loss: 2.299 Vali Acc: 0.319 Test Loss: 2.299 Test Acc: 0.319
Validation loss decreased (inf --> -0.318712).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.7763832
	speed: 0.1759s/iter; left time: 1309.8210s
Epoch: 2 cost time: 6.307539463043213
Epoch: 2, Steps: 154 | Train Loss: 2.057 Vali Loss: 2.142 Vali Acc: 0.322 Test Loss: 2.142 Test Acc: 0.322
Validation loss decreased (-0.318712 --> -0.322363).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.1246037
	speed: 0.1367s/iter; left time: 996.6999s
Epoch: 3 cost time: 6.019982576370239
Epoch: 3, Steps: 154 | Train Loss: 1.999 Vali Loss: 2.350 Vali Acc: 0.322 Test Loss: 2.350 Test Acc: 0.322
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.9332105
	speed: 0.1218s/iter; left time: 869.4368s
Epoch: 4 cost time: 5.422124147415161
Epoch: 4, Steps: 154 | Train Loss: 1.930 Vali Loss: 2.470 Vali Acc: 0.325 Test Loss: 2.470 Test Acc: 0.325
Validation loss decreased (-0.322363 --> -0.325198).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.1345336
	speed: 0.1647s/iter; left time: 1150.3087s
Epoch: 5 cost time: 8.33238697052002
Epoch: 5, Steps: 154 | Train Loss: 1.863 Vali Loss: 2.387 Vali Acc: 0.331 Test Loss: 2.387 Test Acc: 0.331
Validation loss decreased (-0.325198 --> -0.331282).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.8556339
	speed: 0.1616s/iter; left time: 1103.8894s
Epoch: 6 cost time: 6.1102752685546875
Epoch: 6, Steps: 154 | Train Loss: 1.730 Vali Loss: 2.790 Vali Acc: 0.342 Test Loss: 2.790 Test Acc: 0.342
Validation loss decreased (-0.331282 --> -0.341821).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.7723887
	speed: 0.1922s/iter; left time: 1282.9948s
Epoch: 7 cost time: 6.998916864395142
Epoch: 7, Steps: 154 | Train Loss: 1.691 Vali Loss: 2.579 Vali Acc: 0.359 Test Loss: 2.579 Test Acc: 0.359
Validation loss decreased (-0.341821 --> -0.359261).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.9213579
	speed: 0.1552s/iter; left time: 1012.2945s
Epoch: 8 cost time: 6.495747804641724
Epoch: 8, Steps: 154 | Train Loss: 1.623 Vali Loss: 3.407 Vali Acc: 0.047 Test Loss: 3.407 Test Acc: 0.047
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.8058239
	speed: 0.1259s/iter; left time: 801.9392s
Epoch: 9 cost time: 5.545255422592163
Epoch: 9, Steps: 154 | Train Loss: 1.536 Vali Loss: 3.938 Vali Acc: 0.103 Test Loss: 3.938 Test Acc: 0.103
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.6296325
	speed: 0.1343s/iter; left time: 834.5872s
Epoch: 10 cost time: 7.671554088592529
Epoch: 10, Steps: 154 | Train Loss: 1.512 Vali Loss: 4.132 Vali Acc: 0.104 Test Loss: 4.132 Test Acc: 0.104
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.5689011
	speed: 0.1431s/iter; left time: 867.5443s
Epoch: 11 cost time: 6.936495304107666
Epoch: 11, Steps: 154 | Train Loss: 1.441 Vali Loss: 4.214 Vali Acc: 0.105 Test Loss: 4.214 Test Acc: 0.105
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 1.2606800
	speed: 0.1459s/iter; left time: 861.7751s
Epoch: 12 cost time: 7.137621641159058
Epoch: 12, Steps: 154 | Train Loss: 1.406 Vali Loss: 4.204 Vali Acc: 0.124 Test Loss: 4.204 Test Acc: 0.124
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.9660757
	speed: 0.1511s/iter; left time: 869.0482s
Epoch: 13 cost time: 6.733946800231934
Epoch: 13, Steps: 154 | Train Loss: 1.355 Vali Loss: 4.484 Vali Acc: 0.104 Test Loss: 4.484 Test Acc: 0.104
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 1.3721194
	speed: 0.1403s/iter; left time: 785.4837s
Epoch: 14 cost time: 5.558146953582764
Epoch: 14, Steps: 154 | Train Loss: 1.337 Vali Loss: 5.168 Vali Acc: 0.083 Test Loss: 5.168 Test Acc: 0.083
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 1.0544580
	speed: 0.1207s/iter; left time: 657.4545s
Epoch: 15 cost time: 5.453084707260132
Epoch: 15, Steps: 154 | Train Loss: 1.281 Vali Loss: 4.406 Vali Acc: 0.068 Test Loss: 4.406 Test Acc: 0.068
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 1.2827034
	speed: 0.1578s/iter; left time: 834.9233s
Epoch: 16 cost time: 7.794548034667969
Epoch: 16, Steps: 154 | Train Loss: 1.277 Vali Loss: 4.477 Vali Acc: 0.190 Test Loss: 4.477 Test Acc: 0.190
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 1.1786405
	speed: 0.1591s/iter; left time: 817.4034s
Epoch: 17 cost time: 8.246882677078247
Epoch: 17, Steps: 154 | Train Loss: 1.214 Vali Loss: 5.122 Vali Acc: 0.085 Test Loss: 5.122 Test Acc: 0.085
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el3_dm768_df768_ps4_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.35928629359286296
model parameter : 22386446
model size : 100.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el3_dm768_df768_ps4_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.8613342
	speed: 0.0441s/iter; left time: 335.3896s
Epoch: 1 cost time: 5.872917175292969
Epoch: 1, Steps: 154 | Train Loss: 2.133 Vali Loss: 2.161 Vali Acc: 0.318 Test Loss: 2.161 Test Acc: 0.318
Validation loss decreased (inf --> -0.318308).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0135646
	speed: 0.1244s/iter; left time: 926.1793s
Epoch: 2 cost time: 4.417212247848511
Epoch: 2, Steps: 154 | Train Loss: 2.042 Vali Loss: 2.157 Vali Acc: 0.325 Test Loss: 2.157 Test Acc: 0.325
Validation loss decreased (-0.318308 --> -0.324796).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9913408
	speed: 0.1489s/iter; left time: 1085.9592s
Epoch: 3 cost time: 5.275009632110596
Epoch: 3, Steps: 154 | Train Loss: 1.973 Vali Loss: 2.204 Vali Acc: 0.325 Test Loss: 2.204 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 2.1468735
	speed: 0.1215s/iter; left time: 867.4543s
Epoch: 4 cost time: 5.1871185302734375
Epoch: 4, Steps: 154 | Train Loss: 1.932 Vali Loss: 2.486 Vali Acc: 0.324 Test Loss: 2.486 Test Acc: 0.324
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 1.5252779
	speed: 0.1000s/iter; left time: 698.5285s
Epoch: 5 cost time: 3.9501936435699463
Epoch: 5, Steps: 154 | Train Loss: 1.848 Vali Loss: 2.527 Vali Acc: 0.328 Test Loss: 2.527 Test Acc: 0.328
Validation loss decreased (-0.324796 --> -0.327631).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.8551565
	speed: 0.1016s/iter; left time: 694.0317s
Epoch: 6 cost time: 3.870083808898926
Epoch: 6, Steps: 154 | Train Loss: 1.750 Vali Loss: 2.702 Vali Acc: 0.339 Test Loss: 2.702 Test Acc: 0.339
Validation loss decreased (-0.327631 --> -0.338984).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.1605399
	speed: 0.0928s/iter; left time: 619.3778s
Epoch: 7 cost time: 3.6968867778778076
Epoch: 7, Steps: 154 | Train Loss: 1.695 Vali Loss: 2.509 Vali Acc: 0.094 Test Loss: 2.509 Test Acc: 0.094
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.4482869
	speed: 0.0881s/iter; left time: 574.4777s
Epoch: 8 cost time: 3.878716468811035
Epoch: 8, Steps: 154 | Train Loss: 1.626 Vali Loss: 2.947 Vali Acc: 0.089 Test Loss: 2.947 Test Acc: 0.089
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.1011598
	speed: 0.0987s/iter; left time: 628.8440s
Epoch: 9 cost time: 3.9839890003204346
Epoch: 9, Steps: 154 | Train Loss: 1.587 Vali Loss: 2.818 Vali Acc: 0.099 Test Loss: 2.818 Test Acc: 0.099
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.2707605
	speed: 0.1131s/iter; left time: 703.0012s
Epoch: 10 cost time: 4.4735472202301025
Epoch: 10, Steps: 154 | Train Loss: 1.515 Vali Loss: 3.018 Vali Acc: 0.146 Test Loss: 3.018 Test Acc: 0.146
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 1.8113711
	speed: 0.1059s/iter; left time: 641.8906s
Epoch: 11 cost time: 3.8758835792541504
Epoch: 11, Steps: 154 | Train Loss: 1.460 Vali Loss: 3.439 Vali Acc: 0.190 Test Loss: 3.439 Test Acc: 0.190
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 1.2678198
	speed: 0.0922s/iter; left time: 544.8060s
Epoch: 12 cost time: 3.377634048461914
Epoch: 12, Steps: 154 | Train Loss: 1.433 Vali Loss: 3.369 Vali Acc: 0.193 Test Loss: 3.369 Test Acc: 0.193
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 2.0371821
	speed: 0.0619s/iter; left time: 356.3135s
Epoch: 13 cost time: 2.868913412094116
Epoch: 13, Steps: 154 | Train Loss: 1.408 Vali Loss: 3.876 Vali Acc: 0.106 Test Loss: 3.876 Test Acc: 0.106
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 1.4190922
	speed: 0.0701s/iter; left time: 392.6485s
Epoch: 14 cost time: 3.0228888988494873
Epoch: 14, Steps: 154 | Train Loss: 1.382 Vali Loss: 3.708 Vali Acc: 0.174 Test Loss: 3.708 Test Acc: 0.174
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 1.1437235
	speed: 0.0868s/iter; left time: 472.7460s
Epoch: 15 cost time: 3.2124733924865723
Epoch: 15, Steps: 154 | Train Loss: 1.343 Vali Loss: 4.422 Vali Acc: 0.114 Test Loss: 4.422 Test Acc: 0.114
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 1.5718141
	speed: 0.0890s/iter; left time: 471.0801s
Epoch: 16 cost time: 4.180751323699951
Epoch: 16, Steps: 154 | Train Loss: 1.320 Vali Loss: 4.636 Vali Acc: 0.192 Test Loss: 4.636 Test Acc: 0.192
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el3_dm768_df768_ps4_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.33901054339010545
model parameter : 22288142
model size : 99.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el3_dm768_df768_ps5_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 1.8677818
	speed: 0.0524s/iter; left time: 398.5969s
Epoch: 1 cost time: 6.687496185302734
Epoch: 1, Steps: 154 | Train Loss: 2.133 Vali Loss: 2.266 Vali Acc: 0.318 Test Loss: 2.266 Test Acc: 0.318
Validation loss decreased (inf --> -0.318307).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.5826931
	speed: 0.1082s/iter; left time: 806.1251s
Epoch: 2 cost time: 5.173400640487671
Epoch: 2, Steps: 154 | Train Loss: 2.039 Vali Loss: 2.241 Vali Acc: 0.323 Test Loss: 2.241 Test Acc: 0.323
Validation loss decreased (-0.318307 --> -0.323173).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.2347710
	speed: 0.1474s/iter; left time: 1074.7067s
Epoch: 3 cost time: 4.511525869369507
Epoch: 3, Steps: 154 | Train Loss: 1.977 Vali Loss: 2.273 Vali Acc: 0.327 Test Loss: 2.273 Test Acc: 0.327
Validation loss decreased (-0.323173 --> -0.326822).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.4450940
	speed: 0.1156s/iter; left time: 825.4002s
Epoch: 4 cost time: 4.424834251403809
Epoch: 4, Steps: 154 | Train Loss: 1.887 Vali Loss: 2.578 Vali Acc: 0.327 Test Loss: 2.578 Test Acc: 0.327
Validation loss decreased (-0.326822 --> -0.327225).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.5675015
	speed: 0.1139s/iter; left time: 795.4381s
Epoch: 5 cost time: 4.786651611328125
Epoch: 5, Steps: 154 | Train Loss: 1.796 Vali Loss: 2.598 Vali Acc: 0.335 Test Loss: 2.598 Test Acc: 0.335
Validation loss decreased (-0.327225 --> -0.334929).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.8624887
	speed: 0.1662s/iter; left time: 1135.4557s
Epoch: 6 cost time: 8.10006332397461
Epoch: 6, Steps: 154 | Train Loss: 1.754 Vali Loss: 2.747 Vali Acc: 0.343 Test Loss: 2.747 Test Acc: 0.343
Validation loss decreased (-0.334929 --> -0.342633).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.7197899
	speed: 0.1520s/iter; left time: 1014.9402s
Epoch: 7 cost time: 5.4121973514556885
Epoch: 7, Steps: 154 | Train Loss: 1.660 Vali Loss: 3.191 Vali Acc: 0.099 Test Loss: 3.191 Test Acc: 0.099
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.6054199
	speed: 0.1382s/iter; left time: 901.4917s
Epoch: 8 cost time: 6.6282572746276855
Epoch: 8, Steps: 154 | Train Loss: 1.582 Vali Loss: 3.567 Vali Acc: 0.178 Test Loss: 3.567 Test Acc: 0.178
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.4583629
	speed: 0.1480s/iter; left time: 942.4013s
Epoch: 9 cost time: 7.151544809341431
Epoch: 9, Steps: 154 | Train Loss: 1.540 Vali Loss: 4.183 Vali Acc: 0.100 Test Loss: 4.183 Test Acc: 0.100
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.0409788
	speed: 0.1078s/iter; left time: 670.2325s
Epoch: 10 cost time: 4.969921588897705
Epoch: 10, Steps: 154 | Train Loss: 1.486 Vali Loss: 4.062 Vali Acc: 0.187 Test Loss: 4.062 Test Acc: 0.187
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 1.1483837
	speed: 0.1062s/iter; left time: 643.4369s
Epoch: 11 cost time: 4.4071738719940186
Epoch: 11, Steps: 154 | Train Loss: 1.456 Vali Loss: 4.841 Vali Acc: 0.193 Test Loss: 4.841 Test Acc: 0.193
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 2.4733944
	speed: 0.1192s/iter; left time: 704.0093s
Epoch: 12 cost time: 5.308151006698608
Epoch: 12, Steps: 154 | Train Loss: 1.423 Vali Loss: 3.792 Vali Acc: 0.099 Test Loss: 3.792 Test Acc: 0.099
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.9709626
	speed: 0.1416s/iter; left time: 814.6129s
Epoch: 13 cost time: 7.706269264221191
Epoch: 13, Steps: 154 | Train Loss: 1.376 Vali Loss: 4.774 Vali Acc: 0.197 Test Loss: 4.774 Test Acc: 0.197
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 1.3729719
	speed: 0.1293s/iter; left time: 723.8625s
Epoch: 14 cost time: 5.570244312286377
Epoch: 14, Steps: 154 | Train Loss: 1.330 Vali Loss: 4.633 Vali Acc: 0.093 Test Loss: 4.633 Test Acc: 0.093
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 1.1078743
	speed: 0.1420s/iter; left time: 773.1693s
Epoch: 15 cost time: 5.969048261642456
Epoch: 15, Steps: 154 | Train Loss: 1.299 Vali Loss: 5.309 Vali Acc: 0.192 Test Loss: 5.309 Test Acc: 0.192
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 1.1443501
	speed: 0.1234s/iter; left time: 652.9405s
Epoch: 16 cost time: 6.234739303588867
Epoch: 16, Steps: 154 | Train Loss: 1.273 Vali Loss: 5.417 Vali Acc: 0.195 Test Loss: 5.417 Test Acc: 0.195
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el3_dm768_df768_ps5_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3426601784266018
model parameter : 22387982
model size : 100.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el3_dm768_df768_ps5_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2133172
	speed: 0.0399s/iter; left time: 303.4807s
Epoch: 1 cost time: 5.251848220825195
Epoch: 1, Steps: 154 | Train Loss: 2.123 Vali Loss: 2.297 Vali Acc: 0.323 Test Loss: 2.297 Test Acc: 0.323
Validation loss decreased (inf --> -0.322767).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.2959592
	speed: 0.1013s/iter; left time: 754.2025s
Epoch: 2 cost time: 3.5684406757354736
Epoch: 2, Steps: 154 | Train Loss: 2.048 Vali Loss: 2.405 Vali Acc: 0.319 Test Loss: 2.405 Test Acc: 0.319
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 1.9634360
	speed: 0.1081s/iter; left time: 788.5824s
Epoch: 3 cost time: 4.390038251876831
Epoch: 3, Steps: 154 | Train Loss: 1.965 Vali Loss: 2.276 Vali Acc: 0.333 Test Loss: 2.276 Test Acc: 0.333
Validation loss decreased (-0.322767 --> -0.333311).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.8108996
	speed: 0.1193s/iter; left time: 851.8254s
Epoch: 4 cost time: 4.577112674713135
Epoch: 4, Steps: 154 | Train Loss: 1.857 Vali Loss: 2.300 Vali Acc: 0.329 Test Loss: 2.300 Test Acc: 0.329
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 1.5786794
	speed: 0.1031s/iter; left time: 720.3059s
Epoch: 5 cost time: 4.120850086212158
Epoch: 5, Steps: 154 | Train Loss: 1.789 Vali Loss: 2.367 Vali Acc: 0.336 Test Loss: 2.367 Test Acc: 0.336
Validation loss decreased (-0.333311 --> -0.335743).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.3424098
	speed: 0.1198s/iter; left time: 818.3247s
Epoch: 6 cost time: 4.443552494049072
Epoch: 6, Steps: 154 | Train Loss: 1.718 Vali Loss: 2.508 Vali Acc: 0.344 Test Loss: 2.508 Test Acc: 0.344
Validation loss decreased (-0.335743 --> -0.344257).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.6989322
	speed: 0.1310s/iter; left time: 874.9706s
Epoch: 7 cost time: 4.066951751708984
Epoch: 7, Steps: 154 | Train Loss: 1.655 Vali Loss: 2.847 Vali Acc: 0.342 Test Loss: 2.847 Test Acc: 0.342
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.5469928
	speed: 0.0897s/iter; left time: 585.1182s
Epoch: 8 cost time: 3.718278646469116
Epoch: 8, Steps: 154 | Train Loss: 1.620 Vali Loss: 2.821 Vali Acc: 0.193 Test Loss: 2.821 Test Acc: 0.193
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.4050864
	speed: 0.0858s/iter; left time: 546.7555s
Epoch: 9 cost time: 3.6206018924713135
Epoch: 9, Steps: 154 | Train Loss: 1.545 Vali Loss: 3.729 Vali Acc: 0.135 Test Loss: 3.729 Test Acc: 0.135
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.3302891
	speed: 0.0939s/iter; left time: 583.7096s
Epoch: 10 cost time: 3.7791104316711426
Epoch: 10, Steps: 154 | Train Loss: 1.525 Vali Loss: 3.978 Vali Acc: 0.052 Test Loss: 3.978 Test Acc: 0.052
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 1.0380551
	speed: 0.0837s/iter; left time: 507.0201s
Epoch: 11 cost time: 3.182633399963379
Epoch: 11, Steps: 154 | Train Loss: 1.483 Vali Loss: 4.216 Vali Acc: 0.128 Test Loss: 4.216 Test Acc: 0.128
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 1.2105016
	speed: 0.0806s/iter; left time: 476.2996s
Epoch: 12 cost time: 3.3831489086151123
Epoch: 12, Steps: 154 | Train Loss: 1.437 Vali Loss: 4.252 Vali Acc: 0.172 Test Loss: 4.252 Test Acc: 0.172
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 1.2315300
	speed: 0.0750s/iter; left time: 431.7116s
Epoch: 13 cost time: 3.0079047679901123
Epoch: 13, Steps: 154 | Train Loss: 1.407 Vali Loss: 5.138 Vali Acc: 0.152 Test Loss: 5.138 Test Acc: 0.152
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 1.0649824
	speed: 0.1070s/iter; left time: 599.1672s
Epoch: 14 cost time: 3.2756941318511963
Epoch: 14, Steps: 154 | Train Loss: 1.336 Vali Loss: 5.420 Vali Acc: 0.096 Test Loss: 5.420 Test Acc: 0.096
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 1.4763672
	speed: 0.0594s/iter; left time: 323.2154s
Epoch: 15 cost time: 3.620171546936035
Epoch: 15, Steps: 154 | Train Loss: 1.355 Vali Loss: 5.785 Vali Acc: 0.182 Test Loss: 5.785 Test Acc: 0.182
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 1.4826585
	speed: 0.1069s/iter; left time: 565.5941s
Epoch: 16 cost time: 4.649491548538208
Epoch: 16, Steps: 154 | Train Loss: 1.330 Vali Loss: 5.997 Vali Acc: 0.188 Test Loss: 5.997 Test Acc: 0.188
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el3_dm768_df768_ps5_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3442822384428224
model parameter : 22326542
model size : 99.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el3_dm768_df768_ps5_str5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0367119
	speed: 0.0399s/iter; left time: 303.5342s
Epoch: 1 cost time: 5.144011974334717
Epoch: 1, Steps: 154 | Train Loss: 2.152 Vali Loss: 2.151 Vali Acc: 0.317 Test Loss: 2.151 Test Acc: 0.317
Validation loss decreased (inf --> -0.317091).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.1746385
	speed: 0.0928s/iter; left time: 691.2255s
Epoch: 2 cost time: 3.831211805343628
Epoch: 2, Steps: 154 | Train Loss: 2.034 Vali Loss: 2.174 Vali Acc: 0.319 Test Loss: 2.174 Test Acc: 0.319
Validation loss decreased (-0.317091 --> -0.318713).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.1655278
	speed: 0.0847s/iter; left time: 617.6595s
Epoch: 3 cost time: 3.010655164718628
Epoch: 3, Steps: 154 | Train Loss: 1.975 Vali Loss: 2.395 Vali Acc: 0.320 Test Loss: 2.395 Test Acc: 0.320
Validation loss decreased (-0.318713 --> -0.319927).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.5386343
	speed: 0.0965s/iter; left time: 688.5570s
Epoch: 4 cost time: 3.0418314933776855
Epoch: 4, Steps: 154 | Train Loss: 1.914 Vali Loss: 2.357 Vali Acc: 0.327 Test Loss: 2.357 Test Acc: 0.327
Validation loss decreased (-0.319927 --> -0.326822).  Saving model ...
	iters: 100, epoch: 5 | loss: 2.3835621
	speed: 0.0793s/iter; left time: 554.0613s
Epoch: 5 cost time: 3.5284838676452637
Epoch: 5, Steps: 154 | Train Loss: 1.819 Vali Loss: 2.485 Vali Acc: 0.329 Test Loss: 2.485 Test Acc: 0.329
Validation loss decreased (-0.326822 --> -0.329253).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.5696243
	speed: 0.0983s/iter; left time: 671.6800s
Epoch: 6 cost time: 3.650764226913452
Epoch: 6, Steps: 154 | Train Loss: 1.764 Vali Loss: 2.590 Vali Acc: 0.335 Test Loss: 2.590 Test Acc: 0.335
Validation loss decreased (-0.329253 --> -0.334929).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.2847761
	speed: 0.0879s/iter; left time: 587.1630s
Epoch: 7 cost time: 3.2539124488830566
Epoch: 7, Steps: 154 | Train Loss: 1.697 Vali Loss: 2.699 Vali Acc: 0.176 Test Loss: 2.699 Test Acc: 0.176
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.5043228
	speed: 0.0808s/iter; left time: 527.1185s
Epoch: 8 cost time: 3.161787986755371
Epoch: 8, Steps: 154 | Train Loss: 1.616 Vali Loss: 3.064 Vali Acc: 0.174 Test Loss: 3.064 Test Acc: 0.174
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 1.9198709
	speed: 0.0878s/iter; left time: 559.4992s
Epoch: 9 cost time: 3.5914499759674072
Epoch: 9, Steps: 154 | Train Loss: 1.575 Vali Loss: 2.769 Vali Acc: 0.181 Test Loss: 2.769 Test Acc: 0.181
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 1.1220847
	speed: 0.0877s/iter; left time: 544.8578s
Epoch: 10 cost time: 3.6330220699310303
Epoch: 10, Steps: 154 | Train Loss: 1.527 Vali Loss: 3.286 Vali Acc: 0.098 Test Loss: 3.286 Test Acc: 0.098
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 1.4297310
	speed: 0.0852s/iter; left time: 516.6510s
Epoch: 11 cost time: 3.587906837463379
Epoch: 11, Steps: 154 | Train Loss: 1.486 Vali Loss: 3.394 Vali Acc: 0.180 Test Loss: 3.394 Test Acc: 0.180
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 1.2546222
	speed: 0.0679s/iter; left time: 401.3225s
Epoch: 12 cost time: 2.7313883304595947
Epoch: 12, Steps: 154 | Train Loss: 1.465 Vali Loss: 3.608 Vali Acc: 0.185 Test Loss: 3.608 Test Acc: 0.185
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 1.7832744
	speed: 0.0572s/iter; left time: 328.8047s
Epoch: 13 cost time: 2.95967435836792
Epoch: 13, Steps: 154 | Train Loss: 1.435 Vali Loss: 4.166 Vali Acc: 0.176 Test Loss: 4.166 Test Acc: 0.176
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 1.5187389
	speed: 0.0629s/iter; left time: 352.4235s
Epoch: 14 cost time: 3.0691466331481934
Epoch: 14, Steps: 154 | Train Loss: 1.386 Vali Loss: 4.384 Vali Acc: 0.179 Test Loss: 4.384 Test Acc: 0.179
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 1.1516235
	speed: 0.0739s/iter; left time: 402.4818s
Epoch: 15 cost time: 3.5114951133728027
Epoch: 15, Steps: 154 | Train Loss: 1.368 Vali Loss: 4.147 Vali Acc: 0.096 Test Loss: 4.147 Test Acc: 0.096
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 1.2274668
	speed: 0.0842s/iter; left time: 445.6458s
Epoch: 16 cost time: 2.754702091217041
Epoch: 16, Steps: 154 | Train Loss: 1.347 Vali Loss: 4.508 Vali Acc: 0.182 Test Loss: 4.508 Test Acc: 0.182
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el3_dm768_df768_ps5_str5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.33495539334955393
model parameter : 22277390
model size : 99.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el3_dm768_df768_ps6_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.2872269
	speed: 0.0531s/iter; left time: 403.4298s
Epoch: 1 cost time: 7.258285760879517
Epoch: 1, Steps: 154 | Train Loss: 2.135 Vali Loss: 2.217 Vali Acc: 0.159 Test Loss: 2.217 Test Acc: 0.159
Validation loss decreased (inf --> -0.158940).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.0279832
	speed: 0.1142s/iter; left time: 850.5120s
Epoch: 2 cost time: 5.089751720428467
Epoch: 2, Steps: 154 | Train Loss: 2.048 Vali Loss: 2.389 Vali Acc: 0.318 Test Loss: 2.389 Test Acc: 0.318
Validation loss decreased (-0.158940 --> -0.317494).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.6841458
	speed: 0.1172s/iter; left time: 854.8729s
Epoch: 3 cost time: 3.7842495441436768
Epoch: 3, Steps: 154 | Train Loss: 2.002 Vali Loss: 2.245 Vali Acc: 0.323 Test Loss: 2.245 Test Acc: 0.323
Validation loss decreased (-0.317494 --> -0.323173).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.8097738
	speed: 0.1138s/iter; left time: 812.0619s
Epoch: 4 cost time: 4.181191444396973
Epoch: 4, Steps: 154 | Train Loss: 1.924 Vali Loss: 2.429 Vali Acc: 0.332 Test Loss: 2.429 Test Acc: 0.332
Validation loss decreased (-0.323173 --> -0.332093).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.6539448
	speed: 0.0937s/iter; left time: 654.6549s
Epoch: 5 cost time: 5.9310996532440186
Epoch: 5, Steps: 154 | Train Loss: 1.833 Vali Loss: 2.810 Vali Acc: 0.330 Test Loss: 2.810 Test Acc: 0.330
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 1.3807774
	speed: 0.1444s/iter; left time: 986.4029s
Epoch: 6 cost time: 6.916272878646851
Epoch: 6, Steps: 154 | Train Loss: 1.746 Vali Loss: 3.204 Vali Acc: 0.176 Test Loss: 3.204 Test Acc: 0.176
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.7014375
	speed: 0.1440s/iter; left time: 961.2569s
Epoch: 7 cost time: 6.0494232177734375
Epoch: 7, Steps: 154 | Train Loss: 1.653 Vali Loss: 3.138 Vali Acc: 0.365 Test Loss: 3.138 Test Acc: 0.365
Validation loss decreased (-0.332093 --> -0.364527).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.3674655
	speed: 0.1670s/iter; left time: 1089.5622s
Epoch: 8 cost time: 6.780523777008057
Epoch: 8, Steps: 154 | Train Loss: 1.591 Vali Loss: 3.244 Vali Acc: 0.192 Test Loss: 3.244 Test Acc: 0.192
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.4876188
	speed: 0.1279s/iter; left time: 814.4142s
Epoch: 9 cost time: 4.458811521530151
Epoch: 9, Steps: 154 | Train Loss: 1.512 Vali Loss: 3.740 Vali Acc: 0.180 Test Loss: 3.740 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 1.0468248
	speed: 0.0977s/iter; left time: 607.4029s
Epoch: 10 cost time: 4.315686225891113
Epoch: 10, Steps: 154 | Train Loss: 1.456 Vali Loss: 3.980 Vali Acc: 0.193 Test Loss: 3.980 Test Acc: 0.193
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 1.2179828
	speed: 0.0897s/iter; left time: 543.4228s
Epoch: 11 cost time: 3.8878891468048096
Epoch: 11, Steps: 154 | Train Loss: 1.411 Vali Loss: 4.439 Vali Acc: 0.074 Test Loss: 4.439 Test Acc: 0.074
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 1.2814395
	speed: 0.0779s/iter; left time: 460.3161s
Epoch: 12 cost time: 3.6154897212982178
Epoch: 12, Steps: 154 | Train Loss: 1.378 Vali Loss: 4.605 Vali Acc: 0.188 Test Loss: 4.605 Test Acc: 0.188
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 1.5767483
	speed: 0.0860s/iter; left time: 494.6253s
Epoch: 13 cost time: 3.5209741592407227
Epoch: 13, Steps: 154 | Train Loss: 1.337 Vali Loss: 5.424 Vali Acc: 0.083 Test Loss: 5.424 Test Acc: 0.083
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 1.1469901
	speed: 0.0803s/iter; left time: 449.8375s
Epoch: 14 cost time: 3.635110378265381
Epoch: 14, Steps: 154 | Train Loss: 1.326 Vali Loss: 5.016 Vali Acc: 0.170 Test Loss: 5.016 Test Acc: 0.170
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 1.3173482
	speed: 0.1230s/iter; left time: 669.8817s
Epoch: 15 cost time: 5.5099828243255615
Epoch: 15, Steps: 154 | Train Loss: 1.280 Vali Loss: 4.583 Vali Acc: 0.202 Test Loss: 4.583 Test Acc: 0.202
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 1.1662807
	speed: 0.1254s/iter; left time: 663.5336s
Epoch: 16 cost time: 7.007056713104248
Epoch: 16, Steps: 154 | Train Loss: 1.240 Vali Loss: 5.079 Vali Acc: 0.120 Test Loss: 5.079 Test Acc: 0.120
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 1.3922818
	speed: 0.1310s/iter; left time: 672.7746s
Epoch: 17 cost time: 4.998204469680786
Epoch: 17, Steps: 154 | Train Loss: 1.184 Vali Loss: 6.152 Vali Acc: 0.083 Test Loss: 6.152 Test Acc: 0.083
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el3_dm768_df768_ps6_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.36455798864557987
model parameter : 22401806
model size : 100.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el3_dm768_df768_ps6_str3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.9490132
	speed: 0.0431s/iter; left time: 327.7914s
Epoch: 1 cost time: 6.230994701385498
Epoch: 1, Steps: 154 | Train Loss: 2.166 Vali Loss: 2.146 Vali Acc: 0.318 Test Loss: 2.146 Test Acc: 0.318
Validation loss decreased (inf --> -0.318308).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.6396396
	speed: 0.1059s/iter; left time: 788.4756s
Epoch: 2 cost time: 3.2841796875
Epoch: 2, Steps: 154 | Train Loss: 2.050 Vali Loss: 2.124 Vali Acc: 0.324 Test Loss: 2.124 Test Acc: 0.324
Validation loss decreased (-0.318308 --> -0.323985).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.0838523
	speed: 0.1186s/iter; left time: 864.8630s
Epoch: 3 cost time: 4.954377174377441
Epoch: 3, Steps: 154 | Train Loss: 1.979 Vali Loss: 2.316 Vali Acc: 0.322 Test Loss: 2.316 Test Acc: 0.322
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.8746611
	speed: 0.1089s/iter; left time: 777.3812s
Epoch: 4 cost time: 4.7853100299835205
Epoch: 4, Steps: 154 | Train Loss: 1.910 Vali Loss: 2.364 Vali Acc: 0.326 Test Loss: 2.364 Test Acc: 0.326
Validation loss decreased (-0.323985 --> -0.325605).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.7096477
	speed: 0.1141s/iter; left time: 797.2659s
Epoch: 5 cost time: 5.174618721008301
Epoch: 5, Steps: 154 | Train Loss: 1.840 Vali Loss: 2.507 Vali Acc: 0.341 Test Loss: 2.507 Test Acc: 0.341
Validation loss decreased (-0.325605 --> -0.341013).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.2710099
	speed: 0.1345s/iter; left time: 919.0205s
Epoch: 6 cost time: 4.563517093658447
Epoch: 6, Steps: 154 | Train Loss: 1.769 Vali Loss: 2.700 Vali Acc: 0.330 Test Loss: 2.700 Test Acc: 0.330
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 1.8165442
	speed: 0.1155s/iter; left time: 771.0166s
Epoch: 7 cost time: 5.037653923034668
Epoch: 7, Steps: 154 | Train Loss: 1.709 Vali Loss: 3.113 Vali Acc: 0.339 Test Loss: 3.113 Test Acc: 0.339
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 2.2292886
	speed: 0.1108s/iter; left time: 723.0577s
Epoch: 8 cost time: 4.11072850227356
Epoch: 8, Steps: 154 | Train Loss: 1.616 Vali Loss: 3.542 Vali Acc: 0.090 Test Loss: 3.542 Test Acc: 0.090
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 1.6494937
	speed: 0.0950s/iter; left time: 605.2954s
Epoch: 9 cost time: 4.363378047943115
Epoch: 9, Steps: 154 | Train Loss: 1.531 Vali Loss: 3.345 Vali Acc: 0.110 Test Loss: 3.345 Test Acc: 0.110
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 1.3895984
	speed: 0.1045s/iter; left time: 649.1766s
Epoch: 10 cost time: 4.403315305709839
Epoch: 10, Steps: 154 | Train Loss: 1.495 Vali Loss: 3.591 Vali Acc: 0.194 Test Loss: 3.591 Test Acc: 0.194
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 1.4863176
	speed: 0.1056s/iter; left time: 640.1794s
Epoch: 11 cost time: 4.952240228652954
Epoch: 11, Steps: 154 | Train Loss: 1.457 Vali Loss: 4.181 Vali Acc: 0.194 Test Loss: 4.181 Test Acc: 0.194
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 1.1893959
	speed: 0.1235s/iter; left time: 729.8020s
Epoch: 12 cost time: 5.151991605758667
Epoch: 12, Steps: 154 | Train Loss: 1.404 Vali Loss: 4.508 Vali Acc: 0.178 Test Loss: 4.508 Test Acc: 0.178
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 1.1706542
	speed: 0.1242s/iter; left time: 714.2644s
Epoch: 13 cost time: 4.968908309936523
Epoch: 13, Steps: 154 | Train Loss: 1.376 Vali Loss: 4.108 Vali Acc: 0.139 Test Loss: 4.108 Test Acc: 0.139
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 1.0816277
	speed: 0.1382s/iter; left time: 773.5597s
Epoch: 14 cost time: 5.337839126586914
Epoch: 14, Steps: 154 | Train Loss: 1.357 Vali Loss: 4.166 Vali Acc: 0.107 Test Loss: 4.166 Test Acc: 0.107
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 1.6415076
	speed: 0.1178s/iter; left time: 641.5986s
Epoch: 15 cost time: 5.397653341293335
Epoch: 15, Steps: 154 | Train Loss: 1.309 Vali Loss: 4.744 Vali Acc: 0.193 Test Loss: 4.744 Test Acc: 0.193
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el3_dm768_df768_ps6_str3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3410381184103812
model parameter : 22340366
model size : 99.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el3_dm768_df768_ps6_str6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.3537161
	speed: 0.0433s/iter; left time: 329.0991s
Epoch: 1 cost time: 5.8457417488098145
Epoch: 1, Steps: 154 | Train Loss: 2.143 Vali Loss: 2.172 Vali Acc: 0.318 Test Loss: 2.172 Test Acc: 0.318
Validation loss decreased (inf --> -0.317902).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.7869006
	speed: 0.0991s/iter; left time: 737.9833s
Epoch: 2 cost time: 4.211959362030029
Epoch: 2, Steps: 154 | Train Loss: 2.034 Vali Loss: 2.133 Vali Acc: 0.320 Test Loss: 2.133 Test Acc: 0.320
Validation loss decreased (-0.317902 --> -0.320336).  Saving model ...
	iters: 100, epoch: 3 | loss: 2.0364017
	speed: 0.1262s/iter; left time: 920.5415s
Epoch: 3 cost time: 4.709309101104736
Epoch: 3, Steps: 154 | Train Loss: 1.981 Vali Loss: 2.171 Vali Acc: 0.320 Test Loss: 2.171 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1.7865317
	speed: 0.1122s/iter; left time: 800.6929s
Epoch: 4 cost time: 4.534148454666138
Epoch: 4, Steps: 154 | Train Loss: 1.932 Vali Loss: 2.160 Vali Acc: 0.328 Test Loss: 2.160 Test Acc: 0.328
Validation loss decreased (-0.320336 --> -0.327635).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.7343373
	speed: 0.1059s/iter; left time: 739.8271s
Epoch: 5 cost time: 3.721932888031006
Epoch: 5, Steps: 154 | Train Loss: 1.874 Vali Loss: 2.391 Vali Acc: 0.333 Test Loss: 2.391 Test Acc: 0.333
Validation loss decreased (-0.327635 --> -0.332498).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.9016461
	speed: 0.1010s/iter; left time: 690.2319s
Epoch: 6 cost time: 3.6081595420837402
Epoch: 6, Steps: 154 | Train Loss: 1.772 Vali Loss: 2.585 Vali Acc: 0.334 Test Loss: 2.585 Test Acc: 0.334
Validation loss decreased (-0.332498 --> -0.333713).  Saving model ...
	iters: 100, epoch: 7 | loss: 1.3088139
	speed: 0.0850s/iter; left time: 567.4613s
Epoch: 7 cost time: 3.5707850456237793
Epoch: 7, Steps: 154 | Train Loss: 1.687 Vali Loss: 2.876 Vali Acc: 0.345 Test Loss: 2.876 Test Acc: 0.345
Validation loss decreased (-0.333713 --> -0.345470).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.3981388
	speed: 0.1063s/iter; left time: 693.4094s
Epoch: 8 cost time: 3.785425901412964
Epoch: 8, Steps: 154 | Train Loss: 1.643 Vali Loss: 2.826 Vali Acc: 0.178 Test Loss: 2.826 Test Acc: 0.178
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 1.5821424
	speed: 0.0972s/iter; left time: 619.1090s
Epoch: 9 cost time: 4.236745595932007
Epoch: 9, Steps: 154 | Train Loss: 1.567 Vali Loss: 3.057 Vali Acc: 0.356 Test Loss: 3.057 Test Acc: 0.356
Validation loss decreased (-0.345470 --> -0.356417).  Saving model ...
	iters: 100, epoch: 10 | loss: 2.0866251
	speed: 0.1174s/iter; left time: 729.8009s
Epoch: 10 cost time: 4.161518096923828
Epoch: 10, Steps: 154 | Train Loss: 1.518 Vali Loss: 2.906 Vali Acc: 0.185 Test Loss: 2.906 Test Acc: 0.185
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 1.5047827
	speed: 0.0955s/iter; left time: 578.5680s
Epoch: 11 cost time: 4.111737251281738
Epoch: 11, Steps: 154 | Train Loss: 1.496 Vali Loss: 3.230 Vali Acc: 0.095 Test Loss: 3.230 Test Acc: 0.095
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 1.4740851
	speed: 0.0941s/iter; left time: 555.9825s
Epoch: 12 cost time: 4.299014568328857
Epoch: 12, Steps: 154 | Train Loss: 1.447 Vali Loss: 3.155 Vali Acc: 0.298 Test Loss: 3.155 Test Acc: 0.298
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 1.3739308
	speed: 0.1047s/iter; left time: 602.6148s
Epoch: 13 cost time: 4.46249794960022
Epoch: 13, Steps: 154 | Train Loss: 1.415 Vali Loss: 3.648 Vali Acc: 0.177 Test Loss: 3.648 Test Acc: 0.177
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 1.3529638
	speed: 0.0862s/iter; left time: 482.7462s
Epoch: 14 cost time: 3.2640602588653564
Epoch: 14, Steps: 154 | Train Loss: 1.390 Vali Loss: 3.440 Vali Acc: 0.188 Test Loss: 3.440 Test Acc: 0.188
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 1.3348044
	speed: 0.0954s/iter; left time: 519.4303s
Epoch: 15 cost time: 4.076562166213989
Epoch: 15, Steps: 154 | Train Loss: 1.366 Vali Loss: 3.687 Vali Acc: 0.115 Test Loss: 3.687 Test Acc: 0.115
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 1.7581193
	speed: 0.0944s/iter; left time: 499.7157s
Epoch: 16 cost time: 4.390519857406616
Epoch: 16, Steps: 154 | Train Loss: 1.341 Vali Loss: 3.555 Vali Acc: 0.104 Test Loss: 3.555 Test Acc: 0.104
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 1.2619963
	speed: 0.0924s/iter; left time: 474.5170s
Epoch: 17 cost time: 4.321645498275757
Epoch: 17, Steps: 154 | Train Loss: 1.286 Vali Loss: 3.961 Vali Acc: 0.188 Test Loss: 3.961 Test Acc: 0.188
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.9099048
	speed: 0.1072s/iter; left time: 534.0018s
Epoch: 18 cost time: 4.142178773880005
Epoch: 18, Steps: 154 | Train Loss: 1.274 Vali Loss: 3.912 Vali Acc: 0.189 Test Loss: 3.912 Test Acc: 0.189
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 1.1624191
	speed: 0.1030s/iter; left time: 497.2699s
Epoch: 19 cost time: 4.4706854820251465
Epoch: 19, Steps: 154 | Train Loss: 1.243 Vali Loss: 3.935 Vali Acc: 0.172 Test Loss: 3.935 Test Acc: 0.172
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el3_dm768_df768_ps6_str6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3564476885644769
model parameter : 22278926
model size : 99.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el3_dm768_df768_ps8_str2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.0722649
	speed: 0.0379s/iter; left time: 288.1084s
Epoch: 1 cost time: 5.157435178756714
Epoch: 1, Steps: 154 | Train Loss: 2.154 Vali Loss: 2.180 Vali Acc: 0.317 Test Loss: 2.180 Test Acc: 0.317
Validation loss decreased (inf --> -0.317091).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.7679248
	speed: 0.0910s/iter; left time: 677.5394s
Epoch: 2 cost time: 3.363813877105713
Epoch: 2, Steps: 154 | Train Loss: 2.036 Vali Loss: 2.293 Vali Acc: 0.321 Test Loss: 2.293 Test Acc: 0.321
Validation loss decreased (-0.317091 --> -0.321145).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.4774998
	speed: 0.1167s/iter; left time: 850.7910s
Epoch: 3 cost time: 5.110805511474609
Epoch: 3, Steps: 154 | Train Loss: 1.987 Vali Loss: 2.183 Vali Acc: 0.326 Test Loss: 2.183 Test Acc: 0.326
Validation loss decreased (-0.321145 --> -0.325607).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.8603061
	speed: 0.1385s/iter; left time: 989.0049s
Epoch: 4 cost time: 4.685887813568115
Epoch: 4, Steps: 154 | Train Loss: 1.904 Vali Loss: 2.432 Vali Acc: 0.333 Test Loss: 2.432 Test Acc: 0.333
Validation loss decreased (-0.325607 --> -0.332904).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.9708991
	speed: 0.1376s/iter; left time: 961.1454s
Epoch: 5 cost time: 4.709493398666382
Epoch: 5, Steps: 154 | Train Loss: 1.818 Vali Loss: 2.457 Vali Acc: 0.338 Test Loss: 2.457 Test Acc: 0.338
Validation loss decreased (-0.332904 --> -0.338175).  Saving model ...
	iters: 100, epoch: 6 | loss: 2.1379037
	speed: 0.1402s/iter; left time: 957.7585s
Epoch: 6 cost time: 4.941847085952759
Epoch: 6, Steps: 154 | Train Loss: 1.744 Vali Loss: 3.208 Vali Acc: 0.086 Test Loss: 3.208 Test Acc: 0.086
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 2.0256200
	speed: 0.1249s/iter; left time: 833.8017s
Epoch: 7 cost time: 5.13810658454895
Epoch: 7, Steps: 154 | Train Loss: 1.622 Vali Loss: 3.624 Vali Acc: 0.174 Test Loss: 3.624 Test Acc: 0.174
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 2.0167940
	speed: 0.1233s/iter; left time: 804.5754s
Epoch: 8 cost time: 4.530819892883301
Epoch: 8, Steps: 154 | Train Loss: 1.584 Vali Loss: 3.421 Vali Acc: 0.181 Test Loss: 3.421 Test Acc: 0.181
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 1.2327455
	speed: 0.1104s/iter; left time: 703.0225s
Epoch: 9 cost time: 3.593858480453491
Epoch: 9, Steps: 154 | Train Loss: 1.516 Vali Loss: 4.460 Vali Acc: 0.182 Test Loss: 4.460 Test Acc: 0.182
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 1.2092069
	speed: 0.0854s/iter; left time: 530.7514s
Epoch: 10 cost time: 3.229588508605957
Epoch: 10, Steps: 154 | Train Loss: 1.433 Vali Loss: 4.332 Vali Acc: 0.165 Test Loss: 4.332 Test Acc: 0.165
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 1.2721914
	speed: 0.0977s/iter; left time: 592.3489s
Epoch: 11 cost time: 3.8154406547546387
Epoch: 11, Steps: 154 | Train Loss: 1.418 Vali Loss: 4.067 Vali Acc: 0.193 Test Loss: 4.067 Test Acc: 0.193
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 1.0704567
	speed: 0.0866s/iter; left time: 511.6024s
Epoch: 12 cost time: 3.7683780193328857
Epoch: 12, Steps: 154 | Train Loss: 1.371 Vali Loss: 4.920 Vali Acc: 0.172 Test Loss: 4.920 Test Acc: 0.172
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 1.7321384
	speed: 0.0935s/iter; left time: 537.9676s
Epoch: 13 cost time: 4.042043209075928
Epoch: 13, Steps: 154 | Train Loss: 1.319 Vali Loss: 4.906 Vali Acc: 0.130 Test Loss: 4.906 Test Acc: 0.130
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 1.4297893
	speed: 0.0935s/iter; left time: 523.5255s
Epoch: 14 cost time: 5.319662809371948
Epoch: 14, Steps: 154 | Train Loss: 1.261 Vali Loss: 4.980 Vali Acc: 0.173 Test Loss: 4.980 Test Acc: 0.173
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 1.7342285
	speed: 0.1174s/iter; left time: 639.0028s
Epoch: 15 cost time: 4.048677921295166
Epoch: 15, Steps: 154 | Train Loss: 1.238 Vali Loss: 4.980 Vali Acc: 0.076 Test Loss: 4.980 Test Acc: 0.076
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el3_dm768_df768_ps8_str2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3381995133819951
model parameter : 22417166
model size : 100.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el3_dm768_df768_ps8_str4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.3615561
	speed: 0.0453s/iter; left time: 344.0303s
Epoch: 1 cost time: 5.865087509155273
Epoch: 1, Steps: 154 | Train Loss: 2.137 Vali Loss: 2.193 Vali Acc: 0.316 Test Loss: 2.193 Test Acc: 0.316
Validation loss decreased (inf --> -0.316280).  Saving model ...
	iters: 100, epoch: 2 | loss: 2.1997190
	speed: 0.1010s/iter; left time: 752.0146s
Epoch: 2 cost time: 4.549013137817383
Epoch: 2, Steps: 154 | Train Loss: 2.019 Vali Loss: 2.351 Vali Acc: 0.319 Test Loss: 2.351 Test Acc: 0.319
Validation loss decreased (-0.316280 --> -0.318711).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9979959
	speed: 0.1207s/iter; left time: 880.3983s
Epoch: 3 cost time: 3.8605265617370605
Epoch: 3, Steps: 154 | Train Loss: 1.969 Vali Loss: 2.274 Vali Acc: 0.322 Test Loss: 2.274 Test Acc: 0.322
Validation loss decreased (-0.318711 --> -0.322362).  Saving model ...
	iters: 100, epoch: 4 | loss: 1.6774290
	speed: 0.1195s/iter; left time: 853.1473s
Epoch: 4 cost time: 4.349455833435059
Epoch: 4, Steps: 154 | Train Loss: 1.880 Vali Loss: 2.413 Vali Acc: 0.325 Test Loss: 2.413 Test Acc: 0.325
Validation loss decreased (-0.322362 --> -0.325199).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.6634800
	speed: 0.1290s/iter; left time: 900.7272s
Epoch: 5 cost time: 4.608336687088013
Epoch: 5, Steps: 154 | Train Loss: 1.822 Vali Loss: 2.508 Vali Acc: 0.170 Test Loss: 2.508 Test Acc: 0.170
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 2.0078683
	speed: 0.0808s/iter; left time: 552.1885s
Epoch: 6 cost time: 3.4692225456237793
Epoch: 6, Steps: 154 | Train Loss: 1.714 Vali Loss: 2.501 Vali Acc: 0.170 Test Loss: 2.501 Test Acc: 0.170
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 1.7918190
	speed: 0.0787s/iter; left time: 525.2297s
Epoch: 7 cost time: 3.471212148666382
Epoch: 7, Steps: 154 | Train Loss: 1.640 Vali Loss: 3.020 Vali Acc: 0.172 Test Loss: 3.020 Test Acc: 0.172
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 1.6759576
	speed: 0.0795s/iter; left time: 518.6842s
Epoch: 8 cost time: 3.1438586711883545
Epoch: 8, Steps: 154 | Train Loss: 1.590 Vali Loss: 3.391 Vali Acc: 0.175 Test Loss: 3.391 Test Acc: 0.175
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 1.5761653
	speed: 0.0653s/iter; left time: 415.8335s
Epoch: 9 cost time: 3.006718635559082
Epoch: 9, Steps: 154 | Train Loss: 1.527 Vali Loss: 3.426 Vali Acc: 0.180 Test Loss: 3.426 Test Acc: 0.180
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 1.5006098
	speed: 0.0647s/iter; left time: 401.8271s
Epoch: 10 cost time: 3.3623459339141846
Epoch: 10, Steps: 154 | Train Loss: 1.481 Vali Loss: 3.569 Vali Acc: 0.102 Test Loss: 3.569 Test Acc: 0.102
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 1.5519196
	speed: 0.0939s/iter; left time: 569.0381s
Epoch: 11 cost time: 4.1422319412231445
Epoch: 11, Steps: 154 | Train Loss: 1.432 Vali Loss: 4.867 Vali Acc: 0.057 Test Loss: 4.867 Test Acc: 0.057
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 1.4877169
	speed: 0.0816s/iter; left time: 481.7767s
Epoch: 12 cost time: 3.841021776199341
Epoch: 12, Steps: 154 | Train Loss: 1.402 Vali Loss: 3.835 Vali Acc: 0.191 Test Loss: 3.835 Test Acc: 0.191
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 1.3378268
	speed: 0.0829s/iter; left time: 476.6386s
Epoch: 13 cost time: 4.106261253356934
Epoch: 13, Steps: 154 | Train Loss: 1.365 Vali Loss: 5.138 Vali Acc: 0.056 Test Loss: 5.138 Test Acc: 0.056
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 1.3616970
	speed: 0.0788s/iter; left time: 441.1421s
Epoch: 14 cost time: 3.3714892864227295
Epoch: 14, Steps: 154 | Train Loss: 1.333 Vali Loss: 4.258 Vali Acc: 0.114 Test Loss: 4.258 Test Acc: 0.114
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el3_dm768_df768_ps8_str4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.32522303325223034
model parameter : 22331150
model size : 99.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_LSST            Model:              GPT4TS              

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/LSST
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            768                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               768                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

2459
2466
>>>>>>>start training : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el3_dm768_df768_ps8_str8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
2459
2466
2466
	iters: 100, epoch: 1 | loss: 2.3537688
	speed: 0.0403s/iter; left time: 306.6712s
Epoch: 1 cost time: 5.115494251251221
Epoch: 1, Steps: 154 | Train Loss: 2.183 Vali Loss: 2.154 Vali Acc: 0.316 Test Loss: 2.154 Test Acc: 0.316
Validation loss decreased (inf --> -0.315875).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.7147949
	speed: 0.0850s/iter; left time: 633.2128s
Epoch: 2 cost time: 3.76328182220459
Epoch: 2, Steps: 154 | Train Loss: 2.041 Vali Loss: 2.141 Vali Acc: 0.319 Test Loss: 2.141 Test Acc: 0.319
Validation loss decreased (-0.315875 --> -0.319119).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.9690609
	speed: 0.1124s/iter; left time: 819.6667s
Epoch: 3 cost time: 4.153388023376465
Epoch: 3, Steps: 154 | Train Loss: 1.970 Vali Loss: 2.152 Vali Acc: 0.326 Test Loss: 2.152 Test Acc: 0.326
Validation loss decreased (-0.319119 --> -0.325607).  Saving model ...
	iters: 100, epoch: 4 | loss: 2.4695106
	speed: 0.0999s/iter; left time: 713.3915s
Epoch: 4 cost time: 3.9277946949005127
Epoch: 4, Steps: 154 | Train Loss: 1.898 Vali Loss: 2.398 Vali Acc: 0.328 Test Loss: 2.398 Test Acc: 0.328
Validation loss decreased (-0.325607 --> -0.328038).  Saving model ...
	iters: 100, epoch: 5 | loss: 1.8053609
	speed: 0.0967s/iter; left time: 675.6520s
Epoch: 5 cost time: 3.770296335220337
Epoch: 5, Steps: 154 | Train Loss: 1.779 Vali Loss: 2.506 Vali Acc: 0.336 Test Loss: 2.506 Test Acc: 0.336
Validation loss decreased (-0.328038 --> -0.336147).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.7655038
	speed: 0.0972s/iter; left time: 664.1047s
Epoch: 6 cost time: 2.8137874603271484
Epoch: 6, Steps: 154 | Train Loss: 1.677 Vali Loss: 2.825 Vali Acc: 0.083 Test Loss: 2.825 Test Acc: 0.083
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 2.1916547
	speed: 0.0724s/iter; left time: 483.4737s
Epoch: 7 cost time: 3.2960925102233887
Epoch: 7, Steps: 154 | Train Loss: 1.621 Vali Loss: 2.849 Vali Acc: 0.161 Test Loss: 2.849 Test Acc: 0.161
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 1.4120568
	speed: 0.0756s/iter; left time: 492.9447s
Epoch: 8 cost time: 3.3047378063201904
Epoch: 8, Steps: 154 | Train Loss: 1.558 Vali Loss: 3.082 Vali Acc: 0.090 Test Loss: 3.082 Test Acc: 0.090
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 1.1315352
	speed: 0.0733s/iter; left time: 467.0929s
Epoch: 9 cost time: 3.1647186279296875
Epoch: 9, Steps: 154 | Train Loss: 1.512 Vali Loss: 3.315 Vali Acc: 0.050 Test Loss: 3.315 Test Acc: 0.050
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 1.1916164
	speed: 0.0678s/iter; left time: 421.2083s
Epoch: 10 cost time: 3.587508201599121
Epoch: 10, Steps: 154 | Train Loss: 1.460 Vali Loss: 3.259 Vali Acc: 0.049 Test Loss: 3.259 Test Acc: 0.049
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 1.1987679
	speed: 0.0808s/iter; left time: 489.7105s
Epoch: 11 cost time: 3.0606746673583984
Epoch: 11, Steps: 154 | Train Loss: 1.431 Vali Loss: 3.272 Vali Acc: 0.103 Test Loss: 3.272 Test Acc: 0.103
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 1.7521361
	speed: 0.0765s/iter; left time: 451.8772s
Epoch: 12 cost time: 3.4995970726013184
Epoch: 12, Steps: 154 | Train Loss: 1.416 Vali Loss: 4.125 Vali Acc: 0.100 Test Loss: 4.125 Test Acc: 0.100
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 1.4895229
	speed: 0.0801s/iter; left time: 461.1012s
Epoch: 13 cost time: 3.1698834896087646
Epoch: 13, Steps: 154 | Train Loss: 1.370 Vali Loss: 4.254 Vali Acc: 0.102 Test Loss: 4.254 Test Acc: 0.102
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 1.2174860
	speed: 0.0753s/iter; left time: 421.8269s
Epoch: 14 cost time: 3.5601279735565186
Epoch: 14, Steps: 154 | Train Loss: 1.362 Vali Loss: 4.132 Vali Acc: 0.104 Test Loss: 4.132 Test Acc: 0.104
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.8244789
	speed: 0.0820s/iter; left time: 446.5093s
Epoch: 15 cost time: 3.886025905609131
Epoch: 15, Steps: 154 | Train Loss: 1.327 Vali Loss: 4.241 Vali Acc: 0.136 Test Loss: 4.241 Test Acc: 0.136
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_LSST_GPT4TS_UEA_ftM_sl36_ll0_pl0_el3_dm768_df768_ps8_str8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2466
test shape: torch.Size([2466, 14]) torch.Size([2466, 1])
accuracy:0.3361719383617194
model parameter : 22281998
model size : 99.66MB
